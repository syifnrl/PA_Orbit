'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1055:function(C,L,b){C.exports=b(1056)()?globalThis:b(1057)},1056:function(C){C.exports=function(){return"object"===typeof globalThis&&globalThis?globalThis.Array===Array:!1}},1057:function(C){function L(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw Error("Unable to resolve global `this`");}C.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,
"__global__",{get:function(){return this},configurable:!0})}catch(b){return L()}try{return __global__?__global__:L()}finally{delete Object.prototype.pZn}}()},1058:function(C,L,b){Object.defineProperty(L,"__esModule",{value:!0});L.J2i=void 0;var f=b(834);L.J2i=function(c){return function(u){var r=c[u];switch(typeof r){case "boolean":return(0,f.getBooleanFeatureGate)(u,r);case "number":return(0,f.SAi)(u,r);case "string":return(0,f.getStringFeatureGate)(u,r);default:throw Error("Wrong defaultValue type");
}}}},1059:function(C,L,b){Object.defineProperty(L,"__esModule",{value:!0});L.N2i=void 0;var f=b(835);L.N2i=function(){return function(c){return(0,f.isChangeGateEnabled)(c)}}},1060:function(C,L,b){function f(r){var t=(0,u.hXe)(void 0);void 0===t?(0,u.hXe)(void 0):(0,u.hXe)(function(){var k=t();return null===k?null:c.__assign(c.__assign({},k),r)});return t}Object.defineProperty(L,"__esModule",{value:!0});L.fNm=L.dNm=void 0;var c=b(87),u=b(835);L.dNm=f;L.fNm=function(r,t){return f(t)}},1061:function(C,
L,b){function f(r){function t(){return{}}for(var k,m,l={},x=0,w=Object.keys(r);x<w.length;x++){var G=w[x];l[G]=null===(k=r[G])||void 0===k?void 0:k.toString()}var D=null!==(m=(0,u.D0g)(void 0))&&void 0!==m?m:t;(0,u.D0g)(function(){return c.__assign(c.__assign({},D()),l)});return D}Object.defineProperty(L,"__esModule",{value:!0});L.gNm=L.eNm=void 0;var c=b(87),u=b(834);L.eNm=f;L.gNm=function(r,t){return f(t)}},1318:function(C,L,b){C=b(0);var f=b(23),c=b(62),u=b(51),r=b(2),t=b(661),k=b(130),m=b(192),
l=b(577),x=b(12),w=b(5),G=b(271),D=b(10),H=b(329),M=b(813),J=b(88),F=b(77),A=b(1587),N=b(1628),B=b(1629),E=b(17),P=b(6),T=b(552),V=b(8),I=b(244),R=b(214),ba=b(76),ha=b(1484);class na extends Sys.EventArgs{constructor(ja,Ma){super();this.graphNode=ja;this.gVk=Ma}}Object(C.a)(na,"OnCopyCommentEventArgs",Sys.EventArgs,[]);class da extends Sys.EventArgs{constructor(ja,Ma){super();this.graphNode=ja;this.ITk=Ma}}Object(C.a)(da,"OnPasteCommentEventArgs",Sys.EventArgs,[]);var ia=b(1052),ma=b(1381);class qa extends Sys.EventArgs{constructor(ja){super();
this.commentNode=ja}}Object(C.a)(qa,"OnDeleteEventArgs",Sys.EventArgs,[]);class ka extends Sys.EventArgs{constructor(ja){super();this.commentNode=ja}}Object(C.a)(ka,"OnPasteEventArgs",Sys.EventArgs,[]);b.d(L,"a",function(){return va});class va{static get characterPropertiesEditor(){return va.hc||(va.hc=f.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Zc(){return va.ka||(va.ka=new c.a)}static get yib(){return ma.a.instance}static get $i(){return x.App.oa.za.jc.kd}static get Ka(){return va.Ja||
(va.Ja=f.a.instance.sa("Box4.IFeatureHelper"))}static YEe(ja){return 40===ja.type}static Qmg(ja){return!!ja&&39===ja.Yc}static FGg(ja,Ma){Ma.property===E.a.jf&&(va.Dbc=!1)}static JGg(ja,Ma){Ma&&!ja.Db&&va.vfi(ja)}static vfi(ja){const Ma=ja.Wa.paragraph.Ib;ja=Ma.Ta(ja.vi);va.mqd();ja&&ja.anchor&&va.deleteComment(ja,Ma)}static ERf(ja){const Ma=new w.GraphIterator;Ma.set(ja.Zg());va.yib.vJb(Ma);return Ma}static deleteComment(ja,Ma){ja&&(va.mqd(),va.Gqe(ja,Ma),ja.anchor&&(va.Zc.raiseEvent(va.MJd,new qa(ja)),
Ma=ja.fa(P.a.IF,0),V.ULS.sendTraceTag(592188697,327,15,"Comment deleted by canvas anchor removal. DurableId:{0}",Ma),va.Brh.add(Ma.toString()),Ma=new w.GraphIterator,Ma.set(ja),Ma.La(39),Ma.wg()))}static Y9l(ja){return va.Brh.contains(ja)}static Gqe(ja,Ma){va.mqd();const Ha=va.Sla(ja,Ma,!0);ja=va.Sla(ja,Ma,!1);va.TLb(Ha);va.TLb(ja);Ha&&ja&&Ha.Wa===ja.Wa&&V.ULS.sendTraceTag(50619292,327,10,"comment start and end range objects belonged to same chp")}static TLb(ja){if(ja&&ja.Wa.fd){ja.Wa.fd.remove(ja);
const Ma=ja.Wa.paragraph;0<=ja.Qc&&ja.Qc<Ma.wordRunProperties.length&&(ja.Wa.cp||1!==Ma.wordRunProperties.length||(Ma.wordRunProperties.aQ(0,4),Ma.wordRunProperties.Qo.$(1,G.CharacterPropertiesEditor.KI),Ma.wordRunProperties.ir.$(1,G.CharacterPropertiesEditor.EK)),Ma.wordRunProperties.removeAt(ja.Qc,4));Ma.$j()}}static OCm(ja,Ma){if(Ma){var Ha=Ma.paragraph;ja=Ma.cpBegin;var X=Ma.cpEnd;if(Ha&&D.ParagraphReader.nb(Ha)&&(Ha=Ha.ja)){Ma.$u[va.Pne]||(Ma.$u[va.Pne]=[]);Ma=Ma.$u[va.Pne];for(let fa=0;fa<Ha.length;fa++){const ra=
Ha.J(fa).fd;if(!ra)continue;const Aa=ra.length;var W=Ha.J(fa).cp;if(W<ja||W>X)for(W=0;W<Aa;W++)Ma.push(ra.J(W))}}}}static mCm(ja,Ma){if(Ma&&(ja=Ma.$u[va.Pne]))for(Ma=0;Ma<ja.length;Ma++)va.vfi(ja[Ma])}static Sla(ja,Ma,Ha){if(!ja)return null;const X=ja.fa(Ha?P.a.mC:P.a.RA,u.a.nil);Ma=Ma.Ta(X);return Ma?va.rTa(Ma,ja.id,Ha):(Ha||V.ULS.sendTraceTag(4531344,327,100,"Comment anchor missing!"),null)}static rTa(ja,Ma,Ha){for(let X=0;X<ja.ja.length;X++){const W=ja.ja.J(X);if(W.fd)for(let fa=0;fa<W.fd.length;fa++)if(W.fd.J(fa).vi.equals(Ma)&&
Ha===W.fd.J(fa).Db)return W.fd.J(fa)}return null}static RGc(ja,Ma){if(!ja)return null;Ma=ja.fa(Ma?P.a.mC:P.a.RA,u.a.nil);return ja.Ib.Ta(Ma)}static D6f(ja,Ma,Ha,X=null){const W=!X;for(let fa=0;fa<ja.ja.length;fa++){const ra=ja.ja.J(fa);if(ra.cp>=Ma&&ra.fd)for(let Aa=0;Aa<ra.fd.length;Aa++){const Ba=ra.fd.J(Aa).vi.toString();if(ra.fd.J(Aa).Db===Ha&&(W||X.contains(Ba)))return ra.fd.J(Aa)}}return null}static dEl(ja,Ma,Ha,X){for(let W=0;W<ja.ja.length;W++){const fa=ja.ja.J(W);if(fa.cp>Ma)break;if(fa.cp===
Ma&&fa.fd)for(let ra=fa.fd.length-1;0<=ra;ra--){const Aa=fa.fd.J(ra).vi.toString();if(fa.fd.J(ra).Db===Ha&&X.contains(Aa))return fa.fd.J(ra)}}return null}static iyc(ja,Ma,Ha,X){let W=null;for(let fa=0;fa<ja.ja.length;fa++){let ra=ja.ja.J(fa);if(ra.cp>=Ha){ra.cp>Ha||!ra.formatting?(W=va.characterPropertiesEditor.zQ(ja,fa,Ha,W),ra=ja.ja.J(fa)):W=ra.formatting;ra.fd||(ra.fd=new H.a(ra));va.Qhe(Ma,ra.fd,W.ng,X);break}ra.formatting&&(W=ra.formatting)}}static Qhe(ja,Ma,Ha,X){Ha=Ma.Wa.paragraph;const W=
new M.a(Ma.Wa,null,ja,X);for(let fa=0;fa<Ma.length;fa++)if(Ma.J(fa).vi===ja&&Ma.J(fa).Db===X){V.ULS.sendTraceTag(589616028,327,10,"CommentRangeObject {0} already exists with isStart value {1} in commentRangeObjects",ja,X);break}Ma.add(W);Ha.$j();W.Qc?Ha.wordRunProperties.aQ(W.Qc-1,4):Ha.wordRunProperties.uma(W.Qc,4);Ha.wordRunProperties.Qo.$(W.Qc,G.CharacterPropertiesEditor.KI);Ha.wordRunProperties.ir.$(W.Qc,G.CharacterPropertiesEditor.EK);return W}static mqd(){if(!va.Dbc){var ja=new w.GraphIterator;
ja.set(x.App.oa.za.jc);va.yib.vJb(ja);if(ja.Va(1))for(;ja.Kd(1););va.Dbc=!0}}static Dkl(ja){const Ma=new w.GraphIterator;Ma.set(x.App.oa.za.jc);va.yib.vJb(Ma);if(39!==Ma.Yc)return!1;let Ha;if(Ha=Ma.Va(1)){if(Ha.id.equals(ja))return!0;for(;Ha=Ma.Kd(1);)if(Ha.id.equals(ja))return!0}return!1}static JWa(ja,Ma){va.kQd(Ma)}static kQd(ja){va.YTg(D.ParagraphReader.rFb(ja,0));let Ma=null;var Ha=new w.GraphIterator;Ha.set(ja);if(Ha.tn()&&(Ha=J.a.Yo(Ha,Ha.origin),Ha.moveNext()))for(;Ha.moveNext();)if(D.ParagraphReader.Zf(Ha.iterator)){Ma=
Ha.iterator.currentNode;break}if(Ma){ja=D.ParagraphReader.rFb(ja,0);for(let X of ja)X.Db&&(ja=X.Wa.paragraph.Ib.Ta(X.vi))&&(va.TLb(X),va.iyc(Ma,ja.id,0,!0),ja.setValue(P.a.mC,Ma.id))}}static YTg(ja){for(let Ma of ja)if(!Ma.Db){ja=Ma.Wa.paragraph.Ib;const Ha=ja.Ta(Ma.vi);va.deleteComment(Ha,ja)}}static Lye(ja,Ma){const Ha=[];if(!ja)return V.ULS.shipAssertTag(594908762,327,!1,"Trying to highlight null node."),Ha;if(!ja.isConnected)return V.ULS.shipAssertTag(51467871,327,!1,"Trying to highlight disconnected node."),
Ha;const X=va.Sla(ja,va.$i,!0);ja=va.Sla(ja,va.$i,!1);if(!X||!ja)return V.ULS.shipAssertTag(51467872,327,!1,"Missing comment achor."),Ha;let W=!1,fa=X.Wa.paragraph;for(;fa&&(!Ma||!Ma(fa,fa===X.Wa.paragraph));){fa===X.Wa.paragraph&&(W=!0);W&&Ha.push(fa);if(fa===ja.Wa.paragraph)break;fa=D.ParagraphReader.qh(fa,!1)}return Ha}static GGg(ja,Ma){Ma.$u.Comments||(Ma.$u.Comments={});va.uNe(Ma.operation,Ma.Zbj,Ma.original,Ma.clone,Ma.$u.Comments,!0)}static IGg(ja,Ma){Ma.$u.Comments||(Ma.$u.Comments={});va.uNe(Ma.operation,
Ma.Zbj,Ma.original,Ma.clone,Ma.$u.Comments,!1)}static HDm(ja,Ma){Ma.$u.Comments||(Ma.$u.Comments={});ja=Ma.$u.Comments;if((Ma=Object.keys(ja))&&0<Ma.length)for(let Ha=0;Ha<Ma.length;Ha++){const X=ja[Ma[Ha].toString()];X&&(X.vi=null,va.TLb(X))}}static uNe(ja,Ma,Ha,X,W,fa){const ra=Ha.Ib;var Aa=D.ParagraphReader.rFb(X,0);Aa.sort((Pa,fb)=>Pa.Wa.cp<fb.Wa.cp||Pa.Wa.cp===fb.Wa.cp&&Pa.Db?-1:Pa.Wa.cp===fb.Wa.cp&&Pa.Db===fb.Db?0:1);const Ba=new ba.a,ta=new R.a,xa=va.Ka.isFeatureEnabled(193);for(let Pa of Aa)if(Object(I.a)(ia.PageView,
F.InteractiveViewManager.instance.sc)){var za=ra.Ta(Pa.vi);if(za&&za.isConnected)if(Pa.Db)W[Pa.vi.toString()]=Pa;else{var la=za.fa(P.a.IF,0);Aa=fa?va.yNd(za,X,ja,Ma):va.FNd(za,X,ja,Ma);if(fa)xa&&(la=w.GraphIterator.ua(X),la.La(25)&&la.tc(25)&&ha.a.Zc.raiseEvent(ha.a.Y8i,new na(la.currentNode,Aa.getValue(P.a.IF))));else{if(xa){var Sa=Aa.fa(P.a.IF,0);la&&Sa&&(ta.Na(la)?ta.J(la)!==Sa&&V.ULS.sendTraceTag(589616029,327,10,"Failed to add Key {0}, Value {1} to clonedDurableIdMapping, since Key {0}, Value {2} already exists. This could affect copy/paste of tasks.",
la,Sa,ta.J(la)):ta.add(la,Sa))}Aa.setValue(P.a.rob,!0);za.fa(P.a.Mne,null)||(la=za.fa(P.a.KRa,null))&&Aa.setValue(P.a.Mne,la);Aa.setValue(P.a.KRa,r.AFrameworkApplication.userSessionId)}la=Pa.vi.toString();Sa=W[la];Pa.vi=Aa.id;if(!fa){Pa.Gv=null;za=za.getValue(P.a.gE);const fb=Aa.getValue(P.a.gE);W[za]=fb;if(za=Aa.fa(P.a.cK,null))Ba.Na(za)||Ba.add(za,[]),Ba.J(za).push(Aa)}Aa.setValue(P.a.RA,X.id);X.id||V.ULS.shipAssertTag(5564305,327,!1,"Comment node has no end anchor!");Sa?(Sa.vi=Aa.id,fa||(Sa.Gv=
null),Aa.setValue(P.a.mC,Sa.Wa.paragraph.id),delete W[la]):(va.iyc(X,Aa.id,Pa.Wa.cp,!0),Aa.setValue(P.a.mC,X.id))}else V.ULS.sendTraceTag(592188835,327,10,String.format("Node is null or not connected, IsNodeChildOfCommentContent:{0}, IsNull:{1}",va.Dkl(Pa.vi),!za)),Pa.vi=null,va.TLb(Pa)}else Pa.vi=null,va.TLb(Pa);if(!fa){for(let Pa of Ba){ja=Pa.key;Ma=Pa.value;for(let fb of Ma)fb.setValue(P.a.cK,W[ja])}0<ta.count&&xa&&(Ha=w.GraphIterator.ua(Ha),Ha.La(25)&&Ha.tc(25)&&ha.a.Zc.raiseEvent(ha.a.P$i,new da(Ha.currentNode,
ta)))}X.re()}static SZf(ja,Ma){if(ja.La(25)&&ja.tc(25)&&!ja.Bo(16)){const Ha=w.GraphIterator.ua(Ma);Ha.La(39);Ha.tc(39);Ma=T.a(Ha.currentNode,Ma.Zg().Ib,!0);ja.Re(Ma,16)}}static gQf(ja,Ma){var Ha=Ma.Zg().kd;Ha=T.a(ja,Ha,!0);Ma=w.GraphIterator.ua(Ma);va.SZf(Ma,ja);Ma.Va(16);Ma.E6(Ha,1,ja.id);return Ha}static yNd(ja,Ma,Ha,X){va.mqd();Ma=va.gQf(ja,Ma);va.jhl(ja,Ma,Ha,X);return Ma}static jhl(ja,Ma,Ha,X){ja=new A.a(w.GraphIterator.ua(ja),w.GraphIterator.ua(Ma),{});ja.Nlc=!0;Ha=new t.a(Ha,X,new N.a(ja,
null));Ha.Ce=!0;Ha.Pj("ExecuteInternalCommentCopy");Ha.run()}static FNd(ja,Ma,Ha,X){va.mqd();var W=Ma.Zg().kd;Ma=w.GraphIterator.ua(Ma);Ma.La(7);Ma.tc(7);Ma.Va(16);W=T.a(ja,W,!0);W.lf(P.a.gE,k.a.create().toString());W.lf(P.a.commentId,m.a.HH());va.DVi(W.Se(P.a.IF))||W.lf(P.a.IF,va.Y7f());Ma.Re(W,1);va.khl(ja,W,Ha,X);Ma.rg(W);Ma.Ht(1);Ma.THa(2);Ma.Va(2);W.setValue(P.a.gE,Ma.currentNode.Se(P.a.Ob).toString());va.Zc.raiseEvent(va.cIm,new ka(W));return W}static khl(ja,Ma,Ha,X){ja=new B.a(w.GraphIterator.ua(ja),
w.GraphIterator.ua(Ma),null,null);Ha=new t.a(Ha,X,ja);Ha.Ce=!0;Ha.Pj("ExecuteInternalCommentPaste");Ha.run()}static Y7f(){const ja=va.Ka.isFeatureEnabled(133)?m.a.e8a(1,this.m3i):m.a.HH();return va.DVi(ja)?ja:va.Y7f()}static DVi(ja){if(!ja)return!1;if(x.App.oa){const Ma=new w.GraphIterator;Ma.set(x.App.oa.za.jc);va.yib.vJb(Ma);let Ha=Ma.Rc();for(;Ha;){if(Ha.Se(P.a.IF)===ja)return!1;Ha=Ma.yg()}}return!0}static LCf(ja){va.Zc.addHandler(va.MJd,ja)}}va.cIm="OnPaste";va.MJd="OnDelete";va.Pne="CommentRangesToTrimOutsideSelection";
va.Brh=new l.a;va.hc=null;va.ka=null;va.Ja=null;va.Dbc=!1;va.m3i=2147483646;Object(C.a)(va,"CommentEditor",null,[])},1319:function(C,L,b){b.r(L);b.d(L,"Box4PasteSteward",function(){return ha});C=b(0);var f=b(23),c=b(2),u=b(16),r=b(135),t=b(58),k=b(6),m=b(8),l=b(29),x=b(75),w=b(12),G=b(115),D=b(122),H=b(10),M=b(3),J=b(18),F=b(5),A=b(65),N=b(227),B=b(40),E=b(83),P=b(39),T=b(43),V=b(30),I=b(486),R=b(838),ba=b(1577);class ha extends ba.a{constructor(na,da,ia,ma,qa,ka,va,ja=null,Ma=null){super(na,va,ja,
Ma);this._formatting=this.tpa=null;this.g0a=!1;this.AUb=null;this.itc=-1;this.IXb=0;this.vdd=new x.a;this.Num=4294967295;l.a(4223754,307,P.OutlineElementReader.gg(na));this.QUb=da;this.QUb.Bzc(this);this.qR=ia;this.qR.Bzc(this);this.dr=ma;this.es=qa;this.ssm=ka;this.Bqf=A.ListReader.Bh(this.pb);ha.S3l();ha.H3l();ha.j4l()}get tga(){return this.tpa||(this.tpa=f.a.instance.sa("Box4.IInternalLinkManager"))}get Wpe(){return this._formatting}get zBc(){return this.Bqf&&!this.qR.iSa}get o6b(){return 0<this.IXb}reset(){super.reset();
this._formatting=this.K7f(!1)}IEf(na){l.a(4223762,307,P.OutlineElementReader.gg(this.pb)||E.OutlineReader.yq(this.pb));this.OMc(!1);var da=new F.GraphIterator;da.Cb(this.pb);na=ba.a.Pg.vX(this.pb,this.rvd(na));this.Nje(da,!1);l.a(4223763,307,na===this.pb.currentNode);l.a(4223764,307,H.ParagraphReader.nb(na));-1!==this._formatting.Kt&&ha.paragraphEditor.NH(na,this._formatting.Kt);if(ha.paragraphEditor.dr&&!this.s9.KBj){if(this._formatting.textIndent){var ia=0;({unit:ia,returnValue:qa}=ha.ULd(this._formatting.textIndent,
ia));var ma=!1;if(qa||!A.ListReader.V3){if(0>qa){ma=!0;var qa=-1*qa}ia=ha.Koe(qa,ia);ma?ha.paragraphEditor.dr.XMb(na,ia):ha.paragraphEditor.dr.goa(na,ia)}}!this._formatting.marginLeft||ha.Oc.ZHb||A.ListReader.Bh(da)||(da=0,{unit:da,returnValue:ma}=ha.ULd(this._formatting.marginLeft,da),da=ha.Koe(ma,da),ha.paragraphEditor.dr.SKa(na,1,da))}(ha.hd.Jf||J.a.instance.J(3)&&w.App.Yq.MUc)&&na.setValue(k.a.QHb,!0);this._formatting.lineSpacing&&ha.paragraphEditor.cF(na,this._formatting.lineSpacing);if(this._formatting.TTc){da=
[];ma=[];ia=[];qa=this._formatting.TTc.split(" ");let ja=1,Ma=0;for(let Ha=0;Ha<qa.length;Ha++){var ka=ha.HYk(qa[Ha]),va=ha.GYk(qa[Ha]);if(-1!==ka)ja=ka;else if(-1!==va)Ma=va;else{ka=0;({unit:ka,returnValue:va}=ha.ULd(qa[Ha],ka));ka=ha.Koe(va,ka);if(0<=ka&&ka<=this.Num)da.push(ka),ma.push(ja),ia.push(Ma);else{l.b(555103310,307,15,"Invalid custom tab value. tabStops: "+this._formatting.TTc+" index: "+Ha);break}ja=1;Ma=0}}0<da.length&&ha.paragraphEditor.wuk(na,da,ma,ia)}this._formatting.paragraph=na;
this.g0a=!0}Nje(na,da){l.a(8128518,307,!da);this.R0&&(0<this.R0&&this.dr.Eod(na,this.R0),0>this.R0&&this.dr.yCa(na,this.R0,0));na&&this.es.eUd(na,this.o6b);this.R0=0}i2e(na){this.vdd.add(na)}mMf(){this.R0=0}xna(na,da=null){l.a(4223772,307,H.ParagraphReader.Zf(this.pb));const ia=this.pb.currentNode;this._formatting.jbh(ia);if(!this.s9.Bbh(this.pb,da,!1)){var ma=ia.ja.last,qa=V.a.kz(ia);this.g0a&&(ma.formatting=this._formatting.FN.Xc(ma),J.a.instance.J(6)&&ia.$j(),this.g0a=!1);na=this.s9.Efg(na,da);
this.s9.ZXa(this.pb.currentNode,this._formatting.Ina,da);this.characterPropertiesEditor.replaceTextRange(qa,na,void 0,void 0,M.a.paste)}}DWa(na){this.s9.BGe&&this.s9.EFe(na)?(this.HK(),this.IK(na)):(l.a(4223773,307,H.ParagraphReader.Zf(this.pb)),na=V.a.kz(this.pb.currentNode),this.characterPropertiesEditor.oga(na,da=>new I.a(da,I.a.ujb),G.AParagraphNode.ix))}lKb(){this.s9.Jfg(this.pb)}PJa(na){if(ha.Jcl(na)){const da=this.pb.currentNode;H.ParagraphReader.nb(da)&&(da.nrb=na.I0f)}else this.QUb.PJa(na)}zWa(na){this._formatting=
na;this.g0a=!0}f7a(na){l.a(4223774,307,H.ParagraphReader.Zf(this.pb));l.a(4223775,307,!this.AUb);l.a(4223776,307,0>this.itc);this.AUb=na;this.itc=H.ParagraphReader.textLength(this.pb.currentNode)}e7a(){l.a(4223777,307,H.ParagraphReader.Zf(this.pb));l.a(4223778,307,!!this.AUb);l.a(4223779,307,0<=this.itc);let na=V.a.createTextRange(this.pb.currentNode,this.itc,H.ParagraphReader.textLength(this.pb.currentNode)),da="",ia="";this.tga&&({KTg:da,wri:ia}=this.tga.kbh(D.HyperlinkReader.ega(this.AUb))).returnValue&&
(this.AUb=da,ia&&(this.characterPropertiesEditor.replaceTextRange(na,ia),na=V.a.createTextRange(this.pb.currentNode,this.itc,H.ParagraphReader.textLength(this.pb.currentNode))));ha.hyperlinkEditor.vP(na,this.AUb,!1);this.g0a=!0;this.AUb=null;this.itc=-1}IK(na){this.IEf(na);this._formatting.x2e(this.pb.currentNode);this.s9.ZXa(this.pb.currentNode,this._formatting.Ina,na)}HK(){l.a(4223808,307,H.ParagraphReader.Zf(this.pb));ha.hyperlinkEditor.Mfl(this.pb.currentNode);B.OutlineElementNavigator.Uc(this.pb)}iKb(){}hKb(){}m7a(){}Tqb(){}GWa(){l.a(4223809,
307,P.OutlineElementReader.gg(this.pb)||E.OutlineReader.yq(this.pb));let na=!1;this.o6b||(na=this.zBc||!0);na||(this.R0+=1);this.IXb++}EWa(){this.IXb--;let na=!1;this.o6b||(na=this.zBc||!0,this.es.lUg(this.vdd));na||--this.R0}l7a(na){l.a(4223810,307,P.OutlineElementReader.gg(this.pb)||E.OutlineReader.yq(this.pb));l.a(4223811,307,!!na.listStyleType);this.es.LXe(this.Qkm(na))}FWa(){l.a(4223813,307,P.OutlineElementReader.gg(this.pb));c.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");
if(ha.Oc.ZHb&&A.ListReader.Bh(this.pb)){const na=H.ParagraphReader.Im(this.pb.currentNode),da=this.ssm.Rlb(this.pb);R.a.Oc.hV||this.es.KXe(da,na,null)}}Wqb(na){this.QUb.Wqb(na)}wna(na){this.qR.wna(na)}tna(){this.qR.tna()}vna(na){this.qR.vna(na)}una(){this.qR.una()}sna(na){this.qR.sna(na)}rna(){this.qR.rna()}static get paragraphEditor(){return ha.Ki||(ha.Ki=f.a.instance.resolve("Box4.IParagraphEditor"))}static get hyperlinkEditor(){return ha.lk||(ha.lk=f.a.instance.resolve("Box4.IHyperlinkEditor"))}static get hd(){return ha.Eb||
(ha.Eb=f.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Kgh(){return ha.Xb||(ha.Xb=f.a.instance.resolve("Box4.Styles.IWACStyleReader"))}static get LTc(){return ha.hwf}static set LTc(na){ha.hwf=na}static get Oc(){return N.a.getInstance()}static S3l(){const na=J.a.instance.J(8);ha.jrb[1]=na?T.StyleReader.wordStyleIdHeading1:T.StyleReader.styleIdHeading1;ha.jrb[2]=na?T.StyleReader.wordStyleIdHeading2:T.StyleReader.styleIdHeading2;ha.jrb[3]=na?T.StyleReader.wordStyleIdHeading3:
T.StyleReader.styleIdHeading3;ha.jrb[4]=na?T.StyleReader.aEa:T.StyleReader.M8;ha.jrb[5]=na?T.StyleReader.bEa:T.StyleReader.Xha;ha.jrb[6]=na?T.StyleReader.cEa:T.StyleReader.Yha;ha.jrb[7]=na?null:T.StyleReader.cua}static H3l(){ha.sJa.unspecified=0;ha.sJa.defaultUnordered=1;ha.sJa.defaultOrdered=1;ha.sJa.none=0;ha.sJa.disc=1;ha.sJa.circle=2;ha.sJa.square=3;ha.sJa.decimal=1;ha.sJa.lowerAlpha=2;ha.sJa.lowerRoman=3;ha.sJa.upperAlpha=4;ha.sJa.upperRoman=5}static j4l(){ha.hwf=ha.Kgh.kn()}static HYk(na){let da=
-1;if(!na)return da;na=na.toLowerCase();switch(na){case "left":da=1;break;case "center":da=3;break;case "right":da=4;break;case "decimal":da=6;break;case "bar":da=7}return da}static GYk(na){let da=-1;if(!na)return da;na=na.toLowerCase();switch(na){case "blank":da=0;break;case "dotted":da=1;break;case "dashed":da=2;break;case "lined":da=3}return da}static B5b(na){const da=u.a.substring(na,0,2),ia=u.a.substring(na,2,4);return u.a.substring(na,4,6)+ia+da}static ULd(na,da){da=0;const ia=na.length;var ma=
u.a.substring(na,0,ia-2);ma=parseFloat(ma);na=u.a.substr(na,ia-2,2);switch(na){case "in":da=3;break;case "px":da=7;break;case "cm":da=1;break;case "pt":da=5;break;default:m.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",na),ma=0}return{returnValue:ma,unit:da}}static Koe(na,da){let ia=0;switch(da){case 3:ia=r.a.xE(na);break;case 7:ia=t.a.tx(na,0);break;case 1:ia=r.a.akd(na);break;case 5:ia=r.a.xE(r.a.uMd(na));break;default:m.ULS.sendTraceTag(8208451,
307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",na,da)}return ia}static Jcl(na){return!!na&&!!na.I0f&&""!==na.I0f}}ha.Ki=null;ha.lk=null;ha.Eb=null;ha.Xb=null;ha.jrb=Array(8);ha.sJa={};ha.hwf=null;Object(C.a)(ha,"Box4PasteSteward",ba.a,[])},1349:function(C,L,b){C=b(0);var f=b(2),c=b(1776),u=b(8);const r=(k,m)=>{const l={};let x=null;switch(k){case 0:x="HtmlProcessor";var w=m.a;null!=w&&(l.SessionID=w);var G=m.b.toString();null!=G&&(l.Elements=G);var D=
m.c.toString();null!=D&&(l.PrunedElements=D);var H=m.d.toString();null!=H&&(l.TransparentElements=H);var M=m.e.toString();null!=M&&(l.VoidElements=M);var J=m.f.toString();null!=J&&(l.UnknownElements=J);break;case 1:x="WordConverter";var F=m.a;null!=F&&(l.SessionID=F);var A=m.b.toString();null!=A&&(l.BulletsConverted=A);var N=m.c.toString();null!=N&&(l.NumberedConverted=N);break;case 2:x="FormattingSteward";var B=m.a;null!=B&&(l.SourceApp=B);var E=m.b;null!=E&&(l.Browser=E);var P=m.c;null!=P&&(l.OperationId=
P);var T=m.d.toString();null!=T&&(l.Lang=T);var V=m.e.toString();null!=V&&(l.TextDir=V);var I=m.f.toString();null!=I&&(l.Bold=I);var R=m.g.toString();null!=R&&(l.Math=R);var ba=m.h.toString();null!=ba&&(l.Italics=ba);var ha=m.i.toString();null!=ha&&(l.Underline=ha);var na=m.j.toString();null!=na&&(l.Strikethrough=na);var da=m.k.toString();null!=da&&(l.Subscript=da);var ia=m.l.toString();null!=ia&&(l.Superscript=ia);var ma=m.m.toString();null!=ma&&(l.Fontsize=ma);var qa=m.n.toString();null!=qa&&(l.Fontface=
qa);var ka=m.o.toString();null!=ka&&(l.GrowFontsize=ka);var va=m.p.toString();null!=va&&(l.ShrinkFontsize=va);var ja=m.q.toString();null!=ja&&(l.FontColor=ja);var Ma=m.r.toString();null!=Ma&&(l.FontHighlight=Ma);var Ha=m.s.toString();null!=Ha&&(l.ParagraphStyle=Ha);var X=m.t.toString();null!=X&&(l.TextAlign=X);var W=m.u.toString();null!=W&&(l.TextIndent=W);var fa=m.v.toString();null!=fa&&(l.MarginLeft=fa);var ra=m.w.toString();null!=ra&&(l.ParagraphSpaceBefore=ra);var Aa=m.x.toString();null!=Aa&&
(l.ParagraphSpaceAfter=Aa);var Ba=m.y.toString();null!=Ba&&(l.LineSpace=Ba);var ta=m.z.toString();null!=ta&&(l.CellShadingColor=ta);var xa=m.ba.toString();null!=xa&&(l.StyleDefinition=xa);var za=m.bb.toString();null!=za&&(l.TabStops=za);break;case 3:x="SemanticEvents";var la=m.a;null!=la&&(l.SessionID=la);var Sa=m.b.toString();null!=Sa&&(l.Text=Sa);var Pa=m.c.toString();null!=Pa&&(l.LineBreak=Pa);var fb=m.d.toString();null!=fb&&(l.Image=fb);var db=m.e.toString();null!=db&&(l.File=db);var Qa=m.f.toString();
null!=Qa&&(l.FormattingChange=Qa);var wb=m.g.toString();null!=wb&&(l.Anchor=wb);var ib=m.h.toString();null!=ib&&(l.Paragraph=ib);var Ta=m.i.toString();null!=Ta&&(l.Math=Ta);var jb=m.j.toString();null!=jb&&(l.List=jb);var $a=m.k.toString();null!=$a&&(l.ListItem=$a);var ya=m.l.toString();null!=ya&&(l.RenderAugmentation=ya);var wa=m.m.toString();null!=wa&&(l.Span=wa);break;case 4:x="SemanticTableEvents";var Fa=m.a;null!=Fa&&(l.SessionID=Fa);var bb=m.b.toString();null!=bb&&(l.Tables=bb);var Eb=m.c.toString();
null!=Eb&&(l.TableRow=Eb);var hb=m.d.toString();null!=hb&&(l.TableCell=hb);var nb=m.e.toString();null!=nb&&(l.TablePart=nb);break;case 5:x="HtmlEvents";var Pb=m.a;null!=Pb&&(l.OperationId=Pb);var bc=m.b;null!=bc&&(l.SourceApp=bc);var gb=m.c;null!=gb&&(l.Browser=gb);var Lb=null==m.d?null:m.d.toString();null!=Lb&&(l.Text=Lb);var Ic=null==m.e?null:m.e.toString();null!=Ic&&(l.A=Ic);var vb=null==m.f?null:m.f.toString();null!=vb&&(l.Abbr=vb);var xb=null==m.g?null:m.g.toString();null!=xb&&(l.Acronym=xb);
var Db=null==m.h?null:m.h.toString();null!=Db&&(l.Address=Db);var ab=null==m.i?null:m.i.toString();null!=ab&&(l.Applet=ab);var dc=null==m.j?null:m.j.toString();null!=dc&&(l.Area=dc);var tb=null==m.k?null:m.k.toString();null!=tb&&(l.B=tb);var yb=null==m.l?null:m.l.toString();null!=yb&&(l.Base=yb);var rc=null==m.m?null:m.m.toString();null!=rc&&(l.Basefont=rc);var fc=null==m.n?null:m.n.toString();null!=fc&&(l.Bdo=fc);var uc=null==m.o?null:m.o.toString();null!=uc&&(l.Big=uc);var Uc=null==m.p?null:m.p.toString();
null!=Uc&&(l.Blockquote=Uc);var tc=null==m.q?null:m.q.toString();null!=tc&&(l.Body=tc);var Tb=null==m.r?null:m.r.toString();null!=Tb&&(l.Br=Tb);var qb=null==m.s?null:m.s.toString();null!=qb&&(l.Button=qb);var Jb=null==m.t?null:m.t.toString();null!=Jb&&(l.Caption=Jb);var Zb=null==m.u?null:m.u.toString();null!=Zb&&(l.Center=Zb);var ec=null==m.v?null:m.v.toString();null!=ec&&(l.Cite=ec);var zc=null==m.w?null:m.w.toString();null!=zc&&(l.Code=zc);var Oc=null==m.x?null:m.x.toString();null!=Oc&&(l.Col=Oc);
var ud=null==m.y?null:m.y.toString();null!=ud&&(l.Colgroup=ud);var Ad=null==m.z?null:m.z.toString();null!=Ad&&(l.Dd=Ad);var xd=null==m.ba?null:m.ba.toString();null!=xd&&(l.Del=xd);var re=null==m.bb?null:m.bb.toString();null!=re&&(l.Dfn=re);var mc=null==m.bc?null:m.bc.toString();null!=mc&&(l.Dir=mc);var Ab=null==m.bd?null:m.bd.toString();null!=Ab&&(l.Div=Ab);var oc=null==m.be?null:m.be.toString();null!=oc&&(l.Dl=oc);var Mc=null==m.bf?null:m.bf.toString();null!=Mc&&(l.Dt=Mc);var Ec=null==m.bg?null:
m.bg.toString();null!=Ec&&(l.Em=Ec);var kd=null==m.bh?null:m.bh.toString();null!=kd&&(l.Fieldset=kd);var Xd=null==m.bi?null:m.bi.toString();null!=Xd&&(l.Font=Xd);var Bc=null==m.bj?null:m.bj.toString();null!=Bc&&(l.Form=Bc);var jd=null==m.bk?null:m.bk.toString();null!=jd&&(l.Frame=jd);var Vc=null==m.bl?null:m.bl.toString();null!=Vc&&(l.Frameset=Vc);var Ye=null==m.bm?null:m.bm.toString();null!=Ye&&(l.H=Ye);var Cd=null==m.bn?null:m.bn.toString();null!=Cd&&(l.Head=Cd);var of=null==m.bo?null:m.bo.toString();
null!=of&&(l.Hr=of);var Je=null==m.bp?null:m.bp.toString();null!=Je&&(l.Html=Je);var gd=null==m.bq?null:m.bq.toString();null!=gd&&(l.I=gd);var Te=null==m.br?null:m.br.toString();null!=Te&&(l.Iframe=Te);var cg=null==m.bs?null:m.bs.toString();null!=cg&&(l.Img=cg);var Jg=null==m.bt?null:m.bt.toString();null!=Jg&&(l.Input=Jg);var Ga=null==m.bu?null:m.bu.toString();null!=Ga&&(l.Ins=Ga);var Oa=null==m.bv?null:m.bv.toString();null!=Oa&&(l.Isindex=Oa);var Wb=null==m.bw?null:m.bw.toString();null!=Wb&&(l.Kbd=
Wb);var Ac=null==m.bx?null:m.bx.toString();null!=Ac&&(l.Label=Ac);var sd=null==m.by?null:m.by.toString();null!=sd&&(l.Legend=sd);var Xe=null==m.bz?null:m.bz.toString();null!=Xe&&(l.Li=Xe);var xe=null==m.ca?null:m.ca.toString();null!=xe&&(l.Link=xe);var we=null==m.cb?null:m.cb.toString();null!=we&&(l.Map=we);var bf=null==m.cc?null:m.cc.toString();null!=bf&&(l.Math=bf);var ch=null==m.cd?null:m.cd.toString();null!=ch&&(l.Menu=ch);var Pf=null==m.ce?null:m.ce.toString();null!=Pf&&(l.Meta=Pf);var Eg=null==
m.cf?null:m.cf.toString();null!=Eg&&(l.Noframes=Eg);var th=null==m.cg?null:m.cg.toString();null!=th&&(l.Noscript=th);var Ph=null==m.ch?null:m.ch.toString();null!=Ph&&(l.Object=Ph);var pf=null==m.ci?null:m.ci.toString();null!=pf&&(l.Ol=pf);var rk=null==m.cj?null:m.cj.toString();null!=rk&&(l.Optgroup=rk);var Xi=null==m.ck?null:m.ck.toString();null!=Xi&&(l.Option=Xi);var Vf=null==m.cl?null:m.cl.toString();null!=Vf&&(l.P=Vf);var Qc=null==m.cm?null:m.cm.toString();null!=Qc&&(l.Param=Qc);var pd=null==m.cn?
null:m.cn.toString();null!=pd&&(l.Pre=pd);var mf=null==m.co?null:m.co.toString();null!=mf&&(l.Q=mf);var ef=null==m.cp?null:m.cp.toString();null!=ef&&(l.S=ef);var Ae=null==m.cq?null:m.cq.toString();null!=Ae&&(l.Samp=Ae);var id=null==m.cr?null:m.cr.toString();null!=id&&(l.Script=id);var Ah=null==m.cs?null:m.cs.toString();null!=Ah&&(l.Select=Ah);var Bh=null==m.ct?null:m.ct.toString();null!=Bh&&(l.Small=Bh);var wg=null==m.cu?null:m.cu.toString();null!=wg&&(l.Span=wg);var li=null==m.cv?null:m.cv.toString();
null!=li&&(l.Strike=li);var Hh=null==m.cw?null:m.cw.toString();null!=Hh&&(l.Strong=Hh);var vj=null==m.cx?null:m.cx.toString();null!=vj&&(l.Style=vj);var uh=null==m.cy?null:m.cy.toString();null!=uh&&(l.Sub=uh);var ai=null==m.cz?null:m.cz.toString();null!=ai&&(l.Sup=ai);var pk=null==m.da?null:m.da.toString();null!=pk&&(l.Tables=pk);var fk=null==m.db?null:m.db.toString();null!=fk&&(l.Tbody=fk);var ak=null==m.dc?null:m.dc.toString();null!=ak&&(l.Td=ak);var Kg=null==m.dd?null:m.dd.toString();null!=Kg&&
(l.Textarea=Kg);var sk=null==m.de?null:m.de.toString();null!=sk&&(l.Tfoot=sk);var fh=null==m.df?null:m.df.toString();null!=fh&&(l.Th=fh);var Hf=null==m.dg?null:m.dg.toString();null!=Hf&&(l.Thead=Hf);var ui=null==m.dh?null:m.dh.toString();null!=ui&&(l.Title=ui);var Nf=null==m.di?null:m.di.toString();null!=Nf&&(l.Tr=Nf);var Mk=null==m.dj?null:m.dj.toString();null!=Mk&&(l.Tt=Mk);var Nj=null==m.dk?null:m.dk.toString();null!=Nj&&(l.U=Nj);var nj=null==m.dl?null:m.dl.toString();null!=nj&&(l.Ul=nj);var $k=
null==m.dm?null:m.dm.toString();null!=$k&&(l.Var=$k);var ql=null==m.dn?null:m.dn.toString();null!=ql&&(l.Unknown=ql);break;case 6:x="List";var Oj=m.a;null!=Oj&&(l.SessionID=Oj);var wm=m.b.toString();null!=wm&&(l.MaxListLevel=wm)}l.Table=x;return Sys.Serialization.JavaScriptSerializer.serialize(l)};b.d(L,"a",function(){return t});class t{static get VAa(){null==t.IVb&&(t.IVb=!!f.AFrameworkApplication.K&&f.AFrameworkApplication.K.ea("UsageEditorLoggingIsDisabled"));return t.IVb}static get FSi(){null==
t.Ejf&&(t.Ejf=!!f.AFrameworkApplication.K&&f.AFrameworkApplication.K.ea("WordUsageEditorLoggingIsEnabled"));return t.Ejf}static d8(k){u.ULS.sendTraceTag(5822145,307,50,k)}static nyi(k){const m={};m.a=k;m.b=0;m.c=0;m.d=0;m.e=0;m.f=0;return m}static Onm(k){t.VAa||t.d8(r(0,k))}static qui(k){const m={};m._sessionID=k;return m}static aeg(k){const m={};m.a=k;m.b=0;m.c=0;return m}static csm(k){t.VAa||t.d8(r(1,k))}static myi(k,m){const l={};l.c=c.a[k];l.a=m;return l}static Nnm(k,m){t.FSi&&k&&(k.b=m,t.d8(r(5,
k)))}static JDi(k){const m={};m.a=k;m.b=0;m.c=0;m.d=0;m.e=0;m.f=0;m.g=0;m.h=0;m.i=0;m.j=0;m.k=0;m.l=0;m.m=0;return m}static Mqm(k){t.VAa||t.d8(r(3,k))}static KDi(k){const m={};m.a=k;m.b=0;m.c=0;m.d=0;m.e=0;return m}static Nqm(k){t.VAa||t.d8(r(4,k))}static K8f(k,m){const l={};l.b=c.a[k];l.c=m;l.d=0;l.e=0;l.f=0;l.g=0;l.h=0;l.i=0;l.j=0;l.k=0;l.l=0;l.m=0;l.n=0;l.o=0;l.p=0;l.q=0;l.r=0;l.s=0;l.t=0;l.w=0;l.x=0;l.y=0;l.z=0;l.u=0;l.v=0;l.ba=0;l.bb=0;return l}static tnm(k,m){t.FSi&&k&&(k.a=m,t.d8(r(2,k)))}static gFl(k){const m=
{};m.a=k;m.b=-1;return m}static nom(k){!t.VAa&&k&&0<=k.b&&t.d8(r(6,k))}}t.IVb=null;t.Ejf=null;Object(C.a)(t,"UsageEditor",null,[])},1369:function(C,L,b){b.d(L,"a",function(){return u});C=b(0);var f=b(2),c=b(5);class u{static get KOb(){return!!f.AFrameworkApplication.K&&f.AFrameworkApplication.K.ea("WordDesignerTelemetryPerConstructIsEnabled")}static tFb(r,t=!1){const k=c.GraphIterator.ua(r);k.kc();return(t?k.Va(4):k.ZP(4))?4:c.GraphIterator.ua(r).La(36)?16:c.GraphIterator.ua(r).La(14)?2:c.GraphIterator.ua(r).La(38)?
32:1}}Object(C.a)(u,"ConstructTypeHelper",null,[])},1381:function(C,L,b){b.d(L,"a",function(){return u});C=b(0);var f=b(171),c=b(245);class u{vJb(r){u.Ze.pQ(r);return r.Va(16)}static Ao(){return new c.a(()=>new u)}static get instance(){return u.na.value}static get Ze(){return f.PageNavigator.instance}}u.na=u.Ao();Object(C.a)(u,"CommentNavigator",null,[318])},1389:function(C,L,b){b.d(L,"a",function(){return T});C=b(0);var f=b(75),c=b(143),u=b(23),r=b(187),t=b(2),k=b(192),m=b(6),l=b(90),x=b(68),w=b(12),
G=b(44),D=b(553),H=b(219),M=b(231),J=b(10),F=b(65),A=b(340),N=b(21),B=b(14),E=b(280),P=b(3);class T{static get jg(){return H.ContextSetEditor.instance}static get If(){return M.a.instance}static get Lb(){return c.a.instance}static sz(){return T.Wl||(T.Wl=u.a.instance.Ca("Box4.IExternalSelectionManager"))}static get tD(){return T.Ck||(T.Ck=u.a.instance.resolve("Box4.IParagraphIndentationReader"))}static lRl(){this.lU||(this.lU=new f.a,this.lU.add(P.a.ay),this.lU.add(P.a.font),this.lU.add(P.a.m5),this.lU.add(P.a.Fqa),
this.lU.add(P.a.bold),this.lU.add(P.a.setItalic),this.lU.add(P.a.superscript),this.lU.add(P.a.subscript),this.lU.add(P.a.LCb),this.lU.add(P.a.J2a),this.lU.add(P.a.fib),this.lU.add(P.a.mme),this.lU.add(P.a.gib),this.lU.add(P.a.KCb),this.lU.add(P.a.X_),this.lU.add(P.a.g1),this.lU.add(P.a.clearFormatting),this.lU.add(P.a.oib),this.lU.add(P.a.DAc));return this.lU}static uJc(V){return T.lRl().contains(V)?!0:!1}static Nz(V,I,R,ba,ha){var na=!0;if(!I.view.Yd)return 2;var da=I.view,ia=da.Oa;ia&&ia.ya.Ba||
(T.Lb.mb(l.a.af,{["Reason"]:x.a.noSelection}),na=!1);T.jg.Eya(N.ImageReader.Lob,da.Oa.Ag)&&(T.Lb.mb(l.a.af,{["Reason"]:x.a.amd}),na=!1);if(T.jg.Eya(N.ImageReader.aVa,da.Oa.Ag))return T.Lb.mb(l.a.af,{["Reason"]:x.a.g5b}),8;var ma=!T.uJc(V);T.If.Fbc(da.Oa.Ag,ma)&&(T.Lb.mb(l.a.af,{["Reason"]:x.a.CF}),na=!1);T.jg.Eya(N.ImageReader.Vbc,da.Oa.Ag)&&(T.Lb.mb(l.a.af,{["Reason"]:x.a.Xld}),na=!1);T.jg.Eya(E.c,da.Oa.Ag)&&(T.Lb.mb(l.a.af,{["Reason"]:x.a.Yld}),na=!1);T.jg.Eya(A.b,da.Oa.Ag)&&(T.Lb.mb(l.a.af,{["Reason"]:x.a.Wld}),
na=!1);T.jg.h9(J.ParagraphReader.wS,da.Oa.Ag)&&(T.Lb.mb(l.a.af,{["Reason"]:x.a.qP}),na=!1);T.sz()&&T.sz().instance&&T.sz().instance.l0(da.Oa.Ag)&&(T.Lb.mb(l.a.af,{["Reason"]:x.a.externalSelection}),na=!1);var qa=null;ia&&ia.ya.Ba&&(qa=ia.ya.Ba);V===P.a.uWd&&qa&&qa.IA&&J.ParagraphReader.eV(qa.ra.node)&&!F.ListReader.Jq&&(na=!1);if(1===R||!na||!qa)return na?32:8;na=V===P.a.mec||V===P.a.s4b||V===P.a.akc||V===P.a.y8b;da=V===P.a.bLb||V===P.a.ODb||V===P.a.hjc;ma=V===P.a.bYa||V===P.a.cYa||V===P.a.cF;const ka=
new G.GraphTransaction(15);ka.Sa(qa.ra.node);qa=new f.a;let va=!1;if(na||da||ma)r.a.mark(7121),I=T.jg.g4f(I.Am);else{r.a.mark(7119);I=D.OutlineElementGeneralizer.Kla(ia.ya,!0);if(!I)return T.Lb.mb(l.a.Yaa,{["Reason"]:x.a.jEc}),ka.dispose(),8;ia=V===P.a.u5a||V===P.a.Enb;I.Iq&&ia&&(va=T.cZl(qa,I))}(V===P.a.leftJustify||V===P.a.mec||V===P.a.centerJustify||V===P.a.s4b||V===P.a.rightJustify||V===P.a.akc||V===P.a.fullJustify||V===P.a.y8b)&&I.Iq&&1<I.length&&T.dZl(I)&&(ha||(ha={}),Object.getType(ha)===Object&&
(ha.InContextSet=!0));t.AFrameworkApplication.pa.rf(I,V,R,!0,ba,ha);va&&T.Zzm(qa,I,ha);ka.dispose();w.App.oa.updateCommandUI();na||da||ma?r.a.mark(7122):r.a.mark(7120);return 32}static cZl(V,I){if(!I.Iq)return!1;let R=!1,ba=!1;for(let na=0;na<I.length;na++)if(I.getContext(na).Cj){var ha=I.getContext(na).node;ha&&(ha=T.tD.Jlb(ha),2===ha.specialIndentType?(R=!0,V.add(na)):1!==ha.specialIndentType&&ha.specialIndentType||(ba=!0))}return ba&&R}static Zzm(V,I,R){if(I.Iq)for(let ha=0;ha<V.count;ha++){var ba=
I.getContext(V.J(ha));if(!ba.Cj)continue;ba=ba.node;const na=T.tD.Jlb(ba);2!==na.specialIndentType||k.a.r4(R.value,na.yE)||ba.setValue(m.a.Oj,na.yE-na.uoa)}}static b4g(V,I){let R=!0;I.contextId!==B.a.paragraph?R=!1:T.If.tVa(I)?(T.Lb.mb(l.a.oo,{["Reason"]:x.a.CF}),R=!1):T.sz()&&T.sz().instance&&T.sz().instance.l0(I)?(T.Lb.mb(l.a.oo,{["Reason"]:x.a.externalSelection}),R=!1):I.Cj&&(I=I.node,J.ParagraphReader.nb(I)&&I.rI&&(T.Lb.mb(l.a.oo,{["Reason"]:x.a.qP}),R=!1));return{returnValue:1!==V&&R,BA:R?32:
8}}static dZl(V){if(!V.Iq)return!1;let I=1;for(let ba=0;ba<V.length;ba++){var R=V.getContext(ba);if(R&&R.Cj&&R.contextId===B.a.paragraph&&(R=R.node))if(R=J.ParagraphReader.Jv(R),!ba)I=R;else if(R!==I)return!0}return!1}}T.Wl=null;T.Ck=null;T.lU=null;Object(C.a)(T,"FormattingActionHelper",null,[])},1391:function(C,L,b){b.d(L,"a",function(){return c});b.d(L,"b",function(){return u});var f=b(2);const c=r=>{switch(r){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;
case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},u=()=>{var r;return null===(r=f.AFrameworkApplication.K)||void 0===r?void 0:r.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}},1399:function(C,L,b){b.r(L);C=b(0);var f=b(23),c=b(99),u=b(2),r=b(58),t=b(349),k=b(41),m=b(44),l=b(5);class x{xVf(tc,Tb,qb){return 1===
qb?32:x.M8k(Tb.node)}static M8k(tc){const Tb=new l.GraphIterator;Tb.set(tc);Tb.tn();tc=new m.GraphTransaction(7);tc.Ir(Tb);Tb.wg();tc.dispose();return 32}}Object(C.a)(x,"DeleteOutlineLevelContentStrategy",null,[]);var w=b(127),G=b(171),D=b(69),H=b(219),M=b(19),J=b(24),F=b(10),A=b(105),N=b(40),B=b(205),E=b(83),P=b(30);class T{constructor(tc){this.Cq=this.Gj=this.Sy=this.pZ=this.sA=null;this.faa=tc}get q3b(){return this.pZ||(this.pZ=f.a.instance.sa("Box4.IAutoCorrectRules"))}get taa(){return this.Sy||
(this.Sy=f.a.instance.sa("Box4.IAutoCorrectScheduler"))}get gB(){return this.sA||(this.sA=f.a.instance.sa("Box4.Pages.IPageContentEditor"))}get ME(){return this.Cq||(this.Cq=f.a.instance.sa("Box4.IOutlineEditor"))}get eh(){return this.Gj||(this.Gj=this.faa())}evg(tc,Tb,qb){if(this.ME&&T.Xg){var Jb=H.ContextSetEditor.ZFc(Tb);tc=Jb.node;M.SelectionEditor.sg(Jb)&&(Jb=P.a.Kb(tc,F.ParagraphReader.textLength(tc)));var Zb=A.FormattingReader.language(A.FormattingReader.yr(Jb));Jb=l.GraphIterator.ua(qb.xc);
T.Ze.Fsb(Jb);var ec=tc=null;if(Jb)for(let zc=Jb.Va(1);zc&&!ec;zc=Jb.jh(1))E.OutlineReader.FS(zc)&&(ec=zc);if(Jb&&!ec){if(!this.gB||!this.ME)return;tc=new m.GraphTransaction(7);tc.Ir(Jb);ec=this.gB.pnd(Jb);this.ME.I6(Jb,!0);Zb&&(N.OutlineElementNavigator.Sd(Jb),Jb=P.a.Kb(Jb.currentNode,0),T.Xg.cUd(A.FormattingReader.yr(Jb),Zb))}Zb=J.SelectionFactory.Tm(ec,!0);qb.Oa.setSelection(Zb);M.SelectionEditor.Cd(Tb)&&(qb=l.GraphIterator.ua(Tb.node),qb.tn(),B.OutlineNavigator.HVe(qb),this.q3b&&this.taa&&E.OutlineReader.Hs(qb,
Tb,!0)&&(Tb=this.q3b.H1f(Tb,-1,!1,D.a.Nw))&&this.taa.Mtj(Tb));this.eh&&this.eh.$A();tc&&tc.dispose()}}static get Xg(){return T.Wd||(T.Wd=f.a.instance.sa("Box4.IFormattingEditor"))}static get instance(){return T.na||(T.na=T.al())}static al(){return new T(()=>f.a.instance.sa("Box4.IUndoManager"))}static get Ze(){return G.PageNavigator.instance}}T.na=null;T.Wd=null;Object(C.a)(T,"TitleViewEditor",null,[]);var V=b(49),I=b(412),R=b(598),ba=b(22),ha=b(14),na=b(280),da=b(3);class ia{constructor(){this.d7j=
new x}lb(tc){const Tb=Object(k.a)(this.Tfi,this.Tfi.Bod,"deleteView"),qb=Object(k.a)(this,this.xVf,"deleteOutlineLevelContent"),Jb=Object(k.a)(this.Gfi,this.Gfi.R8k,"deleteParagraphContent");this.RSg(tc,Tb,qb,Jb);tc.ma(da.a.backspace,ha.a.Ub,Jb);tc.ma(da.a.backspace,ha.a.Lc,Jb);tc.ma(da.a.backspace,ha.a.endOfParagraph,c.ActionManager.CX);tc.ma(da.a.backspace,ha.a.outline,qb);tc.ma(da.a.backspace,ha.a.view,Tb);tc.$b(da.a.backspace,1124);tc.ma(da.a.Vya,ha.a.Ub,c.ActionManager.CX);tc.ma(da.a.Vya,ha.a.Lc,
Jb);tc.ma(da.a.Vya,ha.a.endOfParagraph,c.ActionManager.CX);tc.ma(da.a.Vya,ha.a.outline,qb);tc.ma(da.a.Vya,ha.a.view,Tb);tc.Aa(da.a.Jnd,ha.a.view,Tb,1124);tc.ma(da.a.iK,ha.a.Ub,Jb);tc.ma(da.a.iK,ha.a.Lc,Jb);tc.ma(da.a.iK,ha.a.endOfParagraph,c.ActionManager.CX);tc.ma(da.a.iK,ha.a.outline,qb);tc.ma(da.a.iK,ha.a.view,Tb);tc.$b(da.a.iK,1124);tc.Aa(da.a.Tpe,ha.a.view,Tb,1124);tc.Aa(da.a.ara,ha.a.view,ia.ara,1028)}RSg(){}xVf(tc,Tb,qb,Jb,Zb){return this.d7j.xVf(tc,Tb,qb,Jb,Zb)}static get Ze(){return G.PageNavigator.instance}static get Pg(){return ia.Ee||
(ia.Ee=f.a.instance.resolve("Box4.IOutlineElementEditor"))}static get gB(){return ia.sA||(ia.sA=f.a.instance.resolve("Box4.Pages.IPageContentEditor"))}static get ME(){return ia.Cq||(ia.Cq=f.a.instance.resolve("Box4.IOutlineEditor"))}static get Ka(){return ia.Ja||(ia.Ja=f.a.instance.sa("Box4.IFeatureHelper"))}static ara(tc,Tb,qb,Jb,Zb){Jb=Tb.view;if(!Jb.Oa||!Jb.Oa.ya.Ba||M.SelectionEditor.qj(Jb.Oa.ya.Ba))return 8;if(1===qb)return 32;qb=Jb.Oa.ya;const ec=qb.Ba;var zc=ec.ra,Oc=null,ud=!1;if(qb.EE){if(zc.contextId===
ha.a.outline&&1===qb.length){for(tc=l.GraphIterator.ua(zc.node);tc.Rc();)tc.wg();ia.ME.I6(tc,!0);N.OutlineElementNavigator.Sd(tc);tc=J.SelectionFactory.Pc(tc.currentNode,0);Jb.Oa.setSelection(tc);return 32}var Ad=zc.node;Oc=null;if(na.c(zc)){var xd=Ad.Qd(Jb.Za);xd&&(xd=xd.C7n)&&0<=xd.width&&0<=xd.height&&(Oc=new I.a(r.a.hl(xd.x,0),r.a.hl(xd.y,1)));Oc||(Oc=R.a(Ad))}else Oc=R.a(zc.node);zc=l.GraphIterator.ua(zc.node);zc.tn();ia.Ze.Fsb(zc);Ad=ia.gB.pnd(zc);R.b(Ad,Oc.x,Oc.y);ia.ME.I6(zc,!0);Oc=J.SelectionFactory.Tm(Ad,
!0)}else if(1===qb.length){ud=qb.last;zc=V.a.s3a(ud);if(ia.Ka&&ia.Ka.isFeatureEnabled(39)&&H.ContextSetEditor.instance.a_e(zc).returnValue)return 2;ud=ud.Fb;ud=!qb.ym&&(M.SelectionEditor.sg(ud)||F.ParagraphReader.rh(ud)||M.SelectionEditor.SN(ud))}ud&&(ud=M.SelectionEditor.Xf(ec,!1,!1,void 0,!1),Jb.Oa.setSelection(ud),u.AFrameworkApplication.pa.rf(Tb,da.a.KE,2,!1,null,Zb),Oc=Jb.Oa.ya.Ba,Jb.Oa.setSelection(ec));Zb||(Zb=new t.DictionaryPropertySet);Zb.setValue(w.a.mDc,!0);u.AFrameworkApplication.pa.rf(Tb,
da.a.iK,2,!0,null,Zb);if(Oc&&Oc.ra.Yb)return Jb.Oa.setSelection(Oc),32;qb.EE&&T.instance.evg(tc,Tb.Am,Jb);M.SelectionEditor.qj(Jb.Oa.ya.Ba)||u.AFrameworkApplication.pa.rf(Tb,da.a.KE,2,!1,null,Zb);return 32}static L8k(tc,Tb){if(1===Tb)return 32;Tb=new m.GraphTransaction(7);Tb.Sa(tc);ia.Pg.isb(tc);Tb.dispose();return 32}}ia.sA=null;ia.Ee=null;ia.Cq=null;ia.Ja=null;Object(C.a)(ia,"ADeleteActor",null,[]);var ma=b(18),qa=b(12),ka=b(158),va=b(1318),ja=b(231);class Ma{i8k(tc,Tb,qb){({DeleteActor:tc}=b(1399));
if(1===qb)return 32;qb=qa.App.oa.Np.Pe("ModelUpdate","DeleteAnchoredObject");Tb=Tb.node;const Jb=new l.GraphIterator;Jb.set(Tb);Jb.La(12);const Zb=Jb.ul(12);if(Ma.If.Xob(Zb))return 2;tc.Txc(Zb);tc=new m.GraphTransaction(7);tc.Sa(Tb);Jb.wg();tc.dispose();qb.stop();return 32}static get If(){return ja.a.instance}}Object(C.a)(Ma,"DeleteAnchoredObjectStrategy",null,[]);var Ha=b(51),X=b(16),W=b(244),fa=b(70),ra=b(109),Aa=b(637);class Ba{get If(){return ja.a.instance}R8k(tc,Tb,qb,Jb,Zb){if(1===qb)return 32;
Jb=tc===da.a.backspace;if(this.If.ye){if(this.If.Uog(Tb)&&Ba.r5b&&(qb=Tb.clone(),qb.Xa+=1,--qb.Ma,this.If.opb(qb)))return Ba.r5b.nmj([qb]),32;if(this.If.gGe(Tb,Jb))return 2}if(Ba.sz()&&Ba.sz().instance&&Ba.sz().instance.l0(Tb))return 4;var ec=Tb.node;let zc=Tb.cpBegin;qb=Tb.cpEnd;let Oc=Tb.Ma,ud=Tb.Xa;const Ad=F.ParagraphReader.text(ec),xd=Ad.length;let re=!1;if(zc===qb){if(Jb&&!zc||!Jb&&zc===xd)return 2;Jb?({cp:zc,returnValue:re}=this.If.$Ag(ec,zc),re||({cp:zc,s3:Oc,returnValue:re}=this.If.YAg(Tb,
zc,Oc)),re||(zc--,X.a.Yr(Ad,zc)&&zc--),tc=da.a.Ake):({cp:qb,returnValue:re}=this.If.o5i(ec,qb),re||({cp:qb,s3:ud,returnValue:re}=this.If.n5i(Tb,qb,ud)),re||(qb++,X.a.Yr(Ad,qb)&&qb++),tc=da.a.nVf)}Tb=zc===qb?P.a.Kb(ec,zc):P.a.createTextRange(ec,zc,qb);re&&this.If.ye&&(Jb?Tb.Ma=Oc:Tb.Xa=ud);if(!this.If.opb(Tb))return 2;this.Txc(ec);Jb=new m.GraphTransaction(15);Jb.om=tc;Jb.Sa(ec);ec=Object(W.a)(Aa.a,Zb)&&Zb.clb;if(Ba.hd.Jf&&!ec){ec=Ba.hd.Jhb();try{const mc=Ba.Wi.CWd(Tb);let Ab;if(({type:Ab}=mc.sAe(Ab)).returnValue){const oc=
Object(fa.a)(90,Zb);oc&&oc.fa(ra.a.kFe,!1)||4===Ab?Ba.hd.J7a=Ab:Ba.hd.Ws(Ab)}Zb=0;for(let oc=mc.length-1;0<=oc;--oc){let Mc;const Ec=({EHe:Mc}=mc.getContext(oc)).returnValue;Mc?(Ba.hyperlinkEditor.Cqb(Ec,null),Zb+=Ba.Aj.tNb(Ec,2),Ba.Aj.ape=qb+Zb):this.Hfi(Ec)}}finally{ec&&ec.dispose()}}else this.Hfi(Tb);Jb.dispose();return 32}Txc(){}static get hd(){return Ba.Eb||(Ba.Eb=f.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Aj(){return Ba.tf||(Ba.tf=f.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Wi(){return Ba.zt||
(Ba.zt=f.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get hyperlinkEditor(){return Ba.lk||(Ba.lk=f.a.instance.resolve("Box4.IHyperlinkEditor"))}static sz(){return Ba.Wl||(Ba.Wl=f.a.instance.Ca("Box4.IExternalSelectionManager"))}static get r5b(){Ba.TTb||(Ba.TTb=f.a.instance.Ca("Box4.ContentControl.IContentControlOperator"));return Ba.TTb.instance}}Ba.Eb=null;Ba.tf=null;Ba.zt=null;Ba.lk=null;Ba.Wl=null;Ba.TTb=null;Object(C.a)(Ba,"ADeleteParagraphContentStrategy",
null,[]);var ta=b(173),xa=b(728),za=b(218),la=b(86),Sa=b(75),Pa=b(76);class fb extends Ba{constructor(){super();this.zk=this.pF=this.kk=this.hc=null}get characterPropertiesEditor(){return this.hc||(this.hc=f.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}get Tj(){return this.kk||(this.kk=f.a.instance.Ca("Box4.ContentControlConfigSettings"))}get FMc(){return this.pF||(this.pF=f.a.instance.resolve("Box4.Proofing.IModifiedRangeEditor"))}get rla(){return this.zk||(this.zk=f.a.instance.resolve("Box4.IContentControlChpHelper"))}Hfi(tc){this.m8k(tc)}GAk(tc,
Tb,qb,Jb){this.Tj.instance&&this.Tj.instance.ye&&(tc.cpBegin===Tb.cpBegin?tc.Ma=Tb.Ma:qb&&(tc.Ma=qb.Qa&&qb.Qa.length?0:-1),tc.Xa=Jb)}Txc(tc){const {DeleteActor:Tb}=b(1399);Tb.Txc(tc)}m8k(tc){var Tb=tc.node;const qb=za.b([new ta.a(tc.cpBegin,tc.cpEnd)],this.nSl(tc));var Jb=new Pa.a,Zb=[];fb.sUk(Tb,qb,Jb,Zb);for(let ec of Jb.keys)1<Jb.J(ec)&&xa.a.aNe(Ha.a.qe(ec));this.f6m(Tb,Zb);this.FMc.Dkd(Tb);Tb=tc.Xa;Jb=!!this.Tj.instance&&this.Tj.instance.ye;for(Zb=qb.length-1;0<=Zb;Zb--)Tb=this.deleteRange(tc,
qb[Zb],Tb,Jb)}nSl(tc){const Tb=[],qb=tc.node;var Jb=la.f(qb,zc=>zc.zU);for(var Zb of Jb)Jb=Zb.Wa.cp,Tb.push(new ta.a(Jb,Jb+1));Zb=F.ParagraphReader.Wla(qb);for(var ec of Zb)ec.vI&&fb.lam(ec,tc)||Tb.push(ec);ec=!!this.Tj.instance&&this.Tj.instance.Tba;this.Tj.instance&&this.Tj.instance.ye||!ec||!qb.Wr||(fb.J$h&&fb.J$h.l5m(tc),this.rla&&Tb.push(...this.rla.X6f(qb).toArray()));return za.a(Tb)}f6m(tc,Tb){const qb=new Sa.a;for(let Jb of Tb)for(Tb=0;Tb<Jb.length;){Tb=this.Dyi(Jb,Tb,0);if(-1===Tb)break;
let Zb=this.Dyi(Jb,Tb+1,3);if(-1===Zb)break;if(Jb.J(Tb).vI)for(;Zb>=Tb;){const ec=Jb.J(Zb);qb.add(ec.Qc);Jb.remove(ec);Zb--}Tb=Zb+1}tc.VY(ma.a.instance.J(6),qb)}Dyi(tc,Tb,qb){for(;Tb<tc.length;Tb++){const Jb=tc.J(Tb);if(1===Jb.CK&&Jb.hi===qb)return Tb}return-1}deleteRange(tc,Tb,qb,Jb){let Zb=Tb.begin,ec=Tb.end;Tb=null;Jb&&(Tb=tc.node.ja.Yg(Zb));Zb<ec&&(Jb=P.a.createTextRange(tc.node,Zb,ec),this.GAk(Jb,tc,Tb,qb),this.characterPropertiesEditor.replaceTextRange(Jb,"",void 0,void 0,da.a.uzc));return qb=
Tb&&Tb.Qa&&Tb.Qa.length?Tb.Qa.length:-1}static get J$h(){return fb.so||(fb.so=f.a.instance.sa("WordEditor.ContentControl.IContentControlOperator"))}static lam(tc,Tb){return tc.begin>=Tb.cpBegin&&tc.end<=Tb.cpEnd}static sUk(tc,Tb,qb,Jb){let Zb=0;tc=tc.ja;for(let ec of Tb)for(;Zb<tc.length;){Tb=tc.J(Zb);if(Tb.cp>=ec.begin&&Tb.cp<ec.end&&(Tb.Hc&&Tb.Hc.q$h&&Jb.push(Tb.Hc),Tb.qg))for(let zc=0;zc<Tb.qg.length;zc++){const Oc=Tb.qg.J(zc).pn.toString();qb.Na(Oc)?qb.$(Oc,qb.J(Oc)+1):qb.$(Oc,1)}++Zb}}}fb.so=
null;Object(C.a)(fb,"DeleteParagraphContentStrategy",Ba,[]);var db=b(239);class Qa{static get VH(){return db.a.instance}static g9k(tc,Tb,qb){if(1===qb)return 32;tc=Tb.node;return Qa.VH.fAc(tc)?ia.L8k(tc,qb):32}}Object(C.a)(Qa,"DeleteUnsupportedObjectStrategy",null,[]);var wb=b(187),ib=b(351),Ta=b(143),jb=b(288),$a=b(8),ya=b(65),wa=b(905),Fa=b(39),bb=b(140),Eb=b(864),hb=b(409),nb=b(503),Pb=b(553),bc=b(767),gb=b(174),Lb=b(138),Ic=b(274),vb=b(487),xb=b(33),Db=b(115);class ab{constructor(tc,Tb,qb,Jb){this.BRn=
tc;this.pO=qb;this.$c=Jb;this.actionId=Tb}}Object(C.a)(ab,"DeleteActionData",null,[]);var dc=b(887),tb=b(227);class yb{get ye(){yb.kk||(yb.kk=f.a.instance.sa("Box4.ContentControlConfigSettings"));return yb.kk?yb.kk.ye:!1}rKj(tc){return!M.SelectionEditor.Ch(tc)}Nbg(tc,Tb,qb){if(!tc)return null;if(!qb)return tc;Tb=M.SelectionEditor.Sfa(tc,!Tb,{jr:!1,ik:!0,gt:!0,nu:!0});return J.SelectionFactory.Mx(tc,Tb.ra,!1)}Bod(tc,Tb,qb,Jb,Zb){if(1===qb)return 32;var ec=!1;tc===da.a.Tpe&&(tc=da.a.iK,ec=!0);tc===
da.a.Jnd&&(tc=da.a.backspace,ec=!0);tc===da.a.Vya&&(Tb=new nb.a(qa.App.oa.za.Rb));if(!Tb.view.Yd)return 2;Lb.GrippersManager.instance.nt(!1);const zc=tc===da.a.iK,Oc=Ic.a.pxe(Tb);if(ec&&this.ye&&Oc&&M.SelectionEditor.qj(Oc)&&yb.If.gGe(Oc.ra,!zc,!0))return 2;ec=this.Nbg(Oc,zc,ec);return this.i9k(tc,Tb,qb,Jb,Zb,ec,zc)}i9k(tc,Tb,qb,Jb,Zb,ec,zc){const Oc=Tb.view,ud=Oc.Oa;var Ad=Zb,xd=Zb;tc===da.a.Vya&&(xd=Ad=null,ec=new gb.Selection(Zb,!0));if(!ec)return 32;const re=new ab(Tb,tc,Jb,xd),mc=this.hrn(Ad,
zc);Ad=!1;if(({W9l:Ad}={returnValue:!1,W9l:!1}).returnValue)return tc=Ad?da.a.deleteColumn:da.a.deleteRow,u.AFrameworkApplication.pa.rf(Tb,tc,qb,!1,Jb,Zb);if(this.ye&&yb.r5b&&1===ud.ya.length&&M.SelectionEditor.qj(ec)&&ec.IA&&yb.r5b.Mfn(ec.ra,zc))return 32;let Ab;zc?wb.a.mark(Ab=5009):wb.a.mark(Ab=5011);qb=new m.GraphTransaction(15);qb.om=tc;qb.Sa(Oc.xc);Ad=null;let oc=({Ien:Ad}=this.cwl(tc,Zb,ud,ec,Ad)).returnValue;xd=null;({$Nb:xd}=H.ContextSetEditor.instance.a_e(oc)).returnValue&&(oc=xd);if(!oc)return qb.dispose(),
32;this.ye&&yb.r5b&&(xd=H.ContextSetEditor.instance.yF(oc),yb.r5b.nmj(xd));this.wKj(oc);const Mc=this.crl(oc,ec,zc);let Ec=null;zc?Ec=new bc.a(ec):Mc&&(Ec=new bc.a(Mc));xd=!1;if(M.SelectionEditor.Cd(oc)){const kd=dc.a.xye(Oc.xc,mc);yb.mj.Fd(()=>{this.j8k(Tb,Jb,Zb,oc,zc,Ec,ec,kd,ud,mc,re,Mc)},"DVS:DAIPC")}else yb.hd.Jf?(this.HFn(tc,Oc.xc,oc,zc,ec,ud,mc,re,Ec),xd=!0):xd=this.mej(tc,Oc.xc,oc,ud,mc,re,Ec,Ad);yb.nml(ud);this.Kqj(oc);qb.dispose();wb.a.mark(Ab+1);return tc===da.a.Vya?xd?32:8:32}mej(tc,Tb,
qb,Jb,Zb,ec,zc,Oc){Tb=dc.a.xye(Tb,Zb);this.rKj(qb)&&Tb.evb(qb);tc=yb.Lb.mm(tc);tc.properties.$("CountOfParagraphsDeleted",yb.gs.Xoe(qb).toString());qb=yb.cbl(yb.prn,Object(k.a)(this,this.orn,"shouldDispatchNoSpecialize"),qb,Jb,Zb,Tb,ec,zc,Oc);tc.end();return qb}HFn(tc,Tb,qb,Jb,Zb,ec,zc,Oc,ud){var Ad=0,xd=null;const re=H.ContextSetEditor.instance.yF(qb),mc=re[re.length-1];if(mc.contextId===ha.a.paragraph||mc.contextId===ha.a.endOfParagraph){var Ab=l.GraphIterator.ua(mc.node);Ab.kc();N.OutlineElementNavigator.Uc(Ab);
N.OutlineElementNavigator.Mt(Ab,!0,!1)&&(xd=N.OutlineElementNavigator.Sd(Ab))&&(Ad=yb.gs.textLength(xd))}else Ad=yb.gs.textLength(mc.node)-mc.cpEnd;Ab=Object(fa.a)(90,Oc.$c);if(Ab=!!Ab&&Ab.fa(ra.a.kFe,!1))this.kej(tc,Tb,qb,ec,zc,Oc,ud,!1,Ab);else{Ab=yb.hd.Jhb();try{this.kej(tc,Tb,qb,ec,zc,Oc,ud,!0)}finally{Ab&&Ab.dispose()}}if(Jb){if(qb.Iq){tc=re.length-1;do Zb=re[tc],tc--;while(!Zb.node.isConnected&&0<=tc)}else Zb=qb;if(!yb.gs.nb(Zb.node))return;switch(mc.contextId){case ha.a.paragraph:case ha.a.endOfParagraph:Ad=
xd&&xd.isConnected?0:Ad;break;case ha.a.Ub:case ha.a.Lc:break;default:Ad=0}Ad=J.SelectionFactory.Pc(Zb.node,yb.gs.textLength(Zb.node)-Ad);Zb.Gm===Ad.ra.cpBegin&&(Ad.ra.Ma=Zb.Ma)}else{Ad=Zb.ra.node;if(!yb.gs.nb(Ad))return;xd=Zb.ra.contextId===ha.a.paragraph?0:Zb.ra.contextId===ha.a.endOfParagraph?yb.gs.textLength(Ad):Zb.ra.cpBegin;Ad=J.SelectionFactory.Pc(Ad,xd)}V.a.instance.setSelection(Ad)}kej(tc,Tb,qb,Jb,Zb,ec,zc,Oc,ud=!1){qb=this.opl(Jb,qb);qb=yb.Wi.CWd(qb);({type:xd}=qb.sAe(xd)).returnValue&&
(Oc&&4!==xd?yb.hd.Ws(xd):yb.hd.J7a=xd);for(Oc=qb.length-1;0<=Oc;--Oc){var Ad=void 0;var xd=({EHe:Ad}=qb.getContext(Oc)).returnValue;Ad?(Ad=ud&&xd.contextId===ha.a.endOfParagraph&&Oc===qb.length-1,yb.hyperlinkEditor.Cqb(xd,2),Ad||yb.Aj.tNb(xd,2)):this.mej(tc,Tb,xd,Jb,Zb,ec,zc,null)}}opl(tc,Tb){if(Object(W.a)(hb.a,Tb)){tc=Pb.OutlineElementGeneralizer.Kla(tc.ya,!0);for(let qb=0;qb<tc.length;qb++)if(tc.getContext(qb).contextId===ha.a.table)return tc}return Tb}cwl(tc,Tb,qb,Jb,Zb){tc===da.a.Vya?(tc=ib.a.Sqa(Tb),
Zb=vb.SelectionReferenceFactory.instance.u3a()):(Zb=null,tc=1===qb.ya.length?V.a.s3a(Jb):qb.Ag);return{returnValue:tc,Ien:Zb}}SNk(tc){return!tc.Cj||tc.contextId!==ha.a.paragraph||!yb.gs.nb(tc.node)||yb.hd.Jf||yb.If.GKc(tc)?!1:!0}wKj(tc){if(tc.Iq)for(let Tb=0;Tb<tc.length;Tb++)this.wKj(tc.getContext(Tb));else this.SNk(tc)&&(tc.node.gAc=!0)}Kqj(tc){if(tc.Iq)for(let Tb=0;Tb<tc.length;Tb++)this.Kqj(tc.getContext(Tb));else tc.Cj&&(tc=tc.node)&&yb.gs.nb(tc)&&(tc.gAc=!1)}j8k(tc,Tb,qb,Jb,Zb,ec,zc,Oc,ud,Ad,
xd,re){const mc=new l.GraphIterator,Ab=Jb.node;mc.set(Ab);mc.kc();!M.SelectionEditor.Hs(mc.currentNode,Jb,Zb)||yb.If.ye&&yb.If.Uog(Jb)?yb.G8k(Jb,Zb,ec,zc,Oc,ud,Ad,xd):this.F8k(tc,Tb,qb,Jb,Zb,ec,zc,Oc,ud,xd,re,mc,Ab)}tWl(tc,Tb,qb,Jb,Zb){if(tc||!ya.ListReader.Bh(Tb))return{returnValue:!1,response:Zb};tb.a.p0&&(Jb.$c||(Jb.$c=new t.DictionaryPropertySet),Jb.$c.setValue(ra.a.Lsa,"delete"),Jb.$c.setValue(ra.a.Yma,"backspace"));tc=Eb.a.njm;if(null===tc||void 0===tc?0:tc.tem(Tb,yb.Vb)){tb.a.p0&&Jb.$c.setValue(ra.a.Yma,
"backspace-autocorrect");Zb=tc.WKj+" ";let ec=P.a.Kb(qb,0);yb.characterPropertiesEditor.replaceTextRange(ec,Zb);qb=J.SelectionFactory.Pc(qb,Zb.length);V.a.instance.setSelection(qb);$a.ULS.sendTraceTag(540386467,393,50,"Unlisted list with trigger string: {0}",tc.WKj)}Zb=yb.Gta(Tb,Jb);return{returnValue:!0,response:Zb}}hWl(tc,Tb,qb,Jb,Zb,ec){return!tc&&0<Fa.OutlineElementReader.b4(Tb)?(ec=u.AFrameworkApplication.pa.rf(qb,da.a.hjc,2,!1,Jb,Zb),{returnValue:!0,response:ec}):{returnValue:!1,response:ec}}$Xl(tc,
Tb,qb,Jb,Zb,ec){return!tc&&0<Fa.OutlineElementReader.ML(Tb)?(ec=u.AFrameworkApplication.pa.rf(qb,da.a.xQc,2,!1,Jb,Zb),{returnValue:!0,response:ec}):{returnValue:!1,response:ec}}WWl(tc,Tb,qb,Jb,Zb,ec){return!tc&&yb.dr.f4b(Tb)?(ec=u.AFrameworkApplication.pa.rf(qb,da.a.NK,2,!1,Jb,Zb),{returnValue:!0,response:ec}):{returnValue:!1,response:ec}}TUl(tc,Tb,qb,Jb,Zb,ec,zc,Oc,ud,Ad){const xd=new bb.a;xd.Cb(Tb);return N.OutlineElementNavigator.hna(xd,!1,!tc,!1)?(Ad=!0,ud=32,(new l.GraphIterator).Cb(xd),N.OutlineElementNavigator.Sd(xd),
ec&&Jb&&M.SelectionEditor.SN(Jb.ra)?(qb.evb(Zb),N.OutlineElementNavigator.Sd(Tb),yb.Pg.isb(Tb.currentNode)):xd.currentNode.Ey?(qb.evb(Zb),N.OutlineElementNavigator.Uc(xd),xd.wg()):tc&&ec?yb.If.xGe(zc)&&!({iDa:Ad}=this.pgj(tc,zc,xd.currentNode,Jb,Ad)).returnValue&&(qb.evb(Zb),yb.es.Gta(Tb),this.Iqe&&this.Iqe.TSm(zc),Tb.wg()):xb.TableReader.isTable(xd)?(qb.evb(Zb),this.Sfi&&({response:ud,returnValue:Ad}=this.Sfi.l8k(tc,xd,Oc))):yb.gs.nb(xd.currentNode)&&(ec=la.e(xd.currentNode),1==ec.length&&8==ec[0].Qf&&
1==yb.gs.textLength(xd.currentNode)&&(ec=P.a.createTextRange(xd.currentNode,0,1),yb.characterPropertiesEditor.replaceTextRange(ec,"",void 0,void 0,da.a.uzc)),({iDa:Ad}=this.pgj(tc,zc,xd.currentNode,Jb,Ad)).returnValue||this.Iqe&&this.Iqe.k8k(tc,qb,Zb,Tb,zc,xd)),{returnValue:!0,response:ud,iDa:Ad}):{returnValue:!1,response:ud,iDa:Ad}}pgj(tc,Tb,qb,Jb,Zb){if(yb.hd.Jf){if(yb.XGa){const ec=Object(W.a)(Db.AParagraphNode,qb)?yb.XGa.UDd(qb):!1,zc=Object(W.a)(Db.AParagraphNode,Tb)?yb.XGa.UDd(Tb):!1;if(ec!==
zc)return{returnValue:!1,iDa:Zb};if(zc)return this.ye&&yb.SEk(Tb,qb,tc)&&yb.hd.Ws(4),{returnValue:!1,iDa:Zb}}tc=tc?Tb:qb;if(!Object(W.a)(Db.AParagraphNode,tc))return{returnValue:!1,iDa:Zb};Tb=tc.ja.last;qb=u.AFrameworkApplication.userName;if(!Tb.Af||Tb.Af.authorName!==qb)return yb.Aj.zlc(tc,2),Jb&&(V.a.instance.setSelection(Jb),Zb=!1),{returnValue:!0,iDa:Zb}}return{returnValue:!1,iDa:Zb}}pWl(tc,Tb,qb,Jb,Zb,ec,zc,Oc){Fa.OutlineElementReader.kRi(Tb,tc)||({response:zc,iDa:Oc}=yb.Kbl(qb,Jb,tc,ec,Zb,zc,
Oc));return{returnValue:!1,response:zc,iDa:Oc}}F8k(tc,Tb,qb,Jb,Zb,ec,zc,Oc,ud,Ad,xd,re,mc){let Ab=!1,oc=2;const Mc=yb.gs.isEmpty(re),Ec=re.currentNode;N.OutlineElementNavigator.Uc(re);({response:oc}=this.tWl(Zb,re,Ec,Ad,oc)).returnValue||({response:oc}=this.hWl(Zb,re,tc,Tb,qb,oc)).returnValue||({response:oc}=this.$Xl(Zb,re,tc,Tb,qb,oc)).returnValue||({response:oc}=this.WWl(Zb,re,tc,Tb,qb,oc)).returnValue||({response:oc,iDa:Ab}=this.TUl(Zb,re,Oc,xd,Jb,Mc,mc,ud,oc,Ab)).returnValue||({response:oc,iDa:Ab}=
this.pWl(Zb,re,Tb,qb,Oc,zc,oc,Ab));yb.M6i(Oc,32===oc);Ab&&yb.uha(ud,ec)}hrn(tc,Tb){return tc&&tc.hasProperty(w.a.mDc)?!tc.fa(w.a.mDc,!1):this.Gxl(Tb)}static get characterPropertiesEditor(){return yb.hc||(yb.hc=f.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Vb(){return yb.zc||(yb.zc=f.a.instance.resolve("Box4.List.IListReader"))}static get gs(){return yb.Ha||(yb.Ha=f.a.instance.resolve("Box4.IParagraphReader"))}static get hyperlinkEditor(){return yb.lk||(yb.lk=f.a.instance.resolve("Box4.IHyperlinkEditor"))}static get es(){return yb.Wq||
(yb.Wq=f.a.instance.resolve("Box4.List.IListEditor"))}static get Pg(){return yb.wIh||(yb.wIh=f.a.instance.resolve("Box4.IOutlineElementEditor"))}static get VH(){return db.a.instance}static get dr(){return wa.a.P9b}static get hd(){return yb.Eb||(yb.Eb=f.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Aj(){return yb.tf||(yb.tf=f.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Wi(){return yb.zt||(yb.zt=f.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get Lb(){return Ta.a.instance}static get If(){return ja.a.instance}static get r5b(){yb.TTb||
(yb.TTb=f.a.instance.Ca("Box4.ContentControl.IContentControlOperator"));return yb.TTb.instance}static get XGa(){return yb.Df||(yb.Df=f.a.instance.sa("Box4.IContentControlReader"))}static get XL(){return yb.XT||(yb.XT=f.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get mj(){return jb.a.instance}static nml(tc){if(1===tc.ya.length&&(tc=tc.ya.J(0),M.SelectionEditor.qj(tc))){var Tb=tc.ra;tc=Tb.node;Tb=Tb.cpBegin;var qb=yb.gs.text(tc);Tb<qb.length&&0<Tb&&" "===qb.charAt(Tb-1)&&" "===qb.charAt(Tb)&&
yb.characterPropertiesEditor.replaceTextRange(P.a.createTextRange(tc,Tb-1,Tb),"\u00a0")}}static mGk(tc,Tb){if(!Tb.hyperlink.UIa){const qb=new m.GraphTransaction(15);try{qb.Sa(tc.node),yb.XL.EV(tc,Tb)}finally{qb&&qb.dispose()}Tb.hyperlink.Yz&&yb.hd.Ws(2)}}static Gta(tc,Tb){tc=yb.Vb.ht(tc).Zr?da.a.bL:da.a.pC;return u.AFrameworkApplication.pa.rf(Tb.BRn,tc,2,!1,Tb.pO,Tb.$c)}static Kbl(tc,Tb,qb,Jb,Zb,ec,zc){if(qb=M.SelectionEditor.Sfa(Jb,!qb,{jr:!1,ik:!1,gt:!1,nu:!0})){Jb=J.SelectionFactory.Mx(Jb,qb.ra);
ec=32;for(qb=0;qb<Jb.length;++qb){Zb.evb(Jb.J(qb));const Oc=u.AFrameworkApplication.pa.rf(Jb.J(qb),da.a.iK,2,!0,tc,Tb);2!==Oc&&(ec=Oc)}32===ec&&(zc=!0)}return{response:ec,iDa:zc}}static cbl(tc,Tb,qb,Jb,Zb,ec,zc,Oc,ud){let Ad=!1;tc(qb)?(Ad=yb.kXf(qb,!0,Jb,Zb,ec,zc))&&yb.Ada(Oc,Jb,ud):Tb(qb)?(Ad=yb.kXf(qb,!1,Jb,Zb,ec,zc))&&yb.Ada(Oc,Jb,ud):(ec.normalize(),yb.Ada(Oc,Jb,ud));return Ad}static Ada(tc,Tb,qb){qb&&qb.uha()||yb.uha(Tb,tc)}static kXf(tc,Tb,qb,Jb,Zb,ec){Jb||E.OutlineReader.Aga(tc)||(qb=yb.hVc(qb))&&
Zb.Non(qb);tc=32===u.AFrameworkApplication.pa.rf(tc,ec.actionId,2,Tb,ec.pO,ec.$c);yb.M6i(Zb,tc);return tc}static M6i(tc,Tb){Tb?tc.normalize():tc.cancel()}static uha(tc,Tb){Tb&&(Tb=Tb.restore())&&tc.setSelection(Tb)}static G8k(tc,Tb,qb,Jb,Zb,ec,zc,Oc){let ud;!Tb&&({hyperlink:ud}=yb.XL.lcc(tc)).returnValue?(qb=new bc.a(Jb),yb.mGk(tc,ud),Zb.normalize(),yb.uha(ec,qb)):yb.kXf(tc,!1,ec,zc,Zb,Oc)&&(Tb&&yb.hd.Jf?(Tb=yb.Aj.ape)?(ec.setSelection(J.SelectionFactory.Pc(tc.node,Tb)),yb.Aj.ape=null):yb.uha(ec,
qb):yb.uha(ec,qb))}static SEk(tc,Tb,qb){qb?(qb=tc,tc=Tb):qb=Tb;Tb=yb.XGa.JKc(qb,!1);tc=yb.XGa.JKc(tc,!0);return!(Tb&&tc)}static prn(tc){return tc.Iq||E.OutlineReader.Aga(tc)||yb.gs.rh(tc)}static hVc(tc){return(tc=Pb.OutlineElementGeneralizer.Kla(tc.ya,!0))&&1===tc.length&&(tc=tc.getContext(0).node,xb.TableReader.GS(tc))?tc:null}}yb.zc=null;yb.hc=null;yb.wIh=null;yb.Ha=null;yb.lk=null;yb.Wq=null;yb.Eb=null;yb.tf=null;yb.zt=null;yb.TTb=null;yb.Df=null;yb.kk=null;yb.XT=null;Object(C.a)(yb,"ADeleteViewStrategy",
null,[]);class rc{k8k(tc,Tb,qb,Jb,Zb,ec){const zc=ec.currentNode;N.OutlineElementNavigator.Uc(ec);tc?(Tb.xKj(ec.currentNode),rc.If.Tpg(qb,Zb,zc,!1)||rc.Pg.merge(Jb,ec,!1,!1)):rc.If.Tpg(qb,zc,Zb,!0)||rc.Pg.merge(ec,Jb,!1,!1)}TSm(tc){tc&&F.ParagraphReader.nb(tc)&&(va.a.kQd(tc),rc.odl.tDf(tc))}static get Pg(){return rc.Ee||(rc.Ee=f.a.instance.resolve("Box4.IOutlineElementEditor"))}static get odl(){return rc.nsc||(rc.nsc=f.a.instance.resolve("Box4.IDynamicRangeEditor"))}static get If(){return ja.a.instance}}
rc.Ee=null;rc.nsc=null;Object(C.a)(rc,"DeleteParagraphNodeStrategy",null,[607]);class fc{l8k(tc,Tb,qb){tc&&(ba.moveToFirstRow(Tb),ba.moveToFirstColumn(Tb),B.OutlineNavigator.M4(Tb),N.OutlineElementNavigator.Sd(Tb),qb.setSelection((new bc.a(J.SelectionFactory.Pc(Tb.currentNode,0))).restore()));return{returnValue:!1,response:2}}}Object(C.a)(fc,"DeleteTableStrategy",null,[606]);class uc extends yb{constructor(){super();this.g7j=new fc;this.f7j=new rc}get Sfi(){return this.g7j}get Iqe(){return this.f7j}rKj(tc){return!M.SelectionEditor.Ch(tc)&&
!M.SelectionEditor.rK(tc)}Nbg(tc,Tb,qb){let Jb,Zb,ec,zc;return!Tb&&tc&&tc.IA&&(Jb=tc.ra)&&M.SelectionEditor.Cd(Jb)&&F.ParagraphReader.nb(Jb.node)&&(Zb=Jb.node.ja.Yg(Jb.cpBegin))&&Zb.Wh&&(ec=uc.Aul(Zb))&&ec.hyperlink.Yz&&(zc=uc.WNl(tc,ec.cp))?zc:super.Nbg(tc,Tb,qb)}orn(tc){return M.SelectionEditor.Ch(tc)||uc.rKn.IHe(tc)||M.SelectionEditor.rK(tc)}Gxl(tc){return!tc}crl(tc,Tb,qb){if(tc.Cj&&M.SelectionEditor.Cd(tc)&&!qb){const Jb=tc.node;let Zb=tc.cpBegin,ec=-1;if(({cp:Zb}=uc.Gwg.$Ag(Jb,Zb)).returnValue)return J.SelectionFactory.Pc(Jb,
Zb);if(({cp:Zb,s3:ec}=uc.Gwg.YAg(tc,Zb,ec)).returnValue)return Tb=J.SelectionFactory.Pc(Jb,Zb),Tb.ra.Ma=ec,Tb.ra.Xa=ec,Tb}Tb=M.SelectionEditor.Sfa(Tb,!qb,{jr:!0,ik:!1,gt:!1,nu:!0});uc.Gwg.ye&&M.SelectionEditor.Ch(tc)&&(Tb.ra.Xa=Tb.ra.Ma=qb?tc.Xa:tc.Ma);return Tb}static get rKn(){return db.a.instance}static get Gwg(){return ja.a.instance}static Aul(tc){const Tb=tc.paragraph.ja;let qb=null;tc=tc.cp;for(let Jb=0;Jb<Tb.length;Jb++){const Zb=Tb.J(Jb);if(Zb.cp>=tc)break;Zb.Wh&&(qb=null);Zb.hyperlink&&(qb=
Zb)}return qb}static WNl(tc,Tb){var qb=M.SelectionEditor.L_(tc,{jr:!1,ik:!1,gt:!0,nu:!0});if(!qb||!qb.IA||qb.ra.node!==tc.ra.node)return null;qb=qb.ra;if(qb.cpBegin!==qb.cpEnd)return null;const Jb=F.ParagraphReader.text(qb.node);for(let Zb=qb.cpBegin-1;Zb>=Tb;Zb--)if(!X.a.ep(Jb.charCodeAt(Zb)))return J.SelectionFactory.Mx(tc,P.a.Kb(qb.node,Zb+1),!1);return J.SelectionFactory.Mx(tc,P.a.Kb(qb.node,Tb),!1)}}Object(C.a)(uc,"DeleteViewStrategy",yb,[]);b.d(L,"DeleteActor",function(){return Uc});class Uc extends ia{constructor(tc,
Tb,qb,Jb,Zb){super();this.e7j=new fb;this.rth=new Ma;this.h7j=new uc;this.so=tc;this.f2c=Tb;this.oxh=qb;this.nsc=Jb;this.Tn=Zb}get ye(){return this.f2c.instance?this.f2c.instance.ye:!1}get Tfi(){return this.h7j}get Gfi(){return this.e7j}RSg(tc,Tb,qb,Jb){const Zb=Qa.g9k,ec=Object(k.a)(this.rth,this.rth.i8k,"deleteAnchoredObject");tc.ma(da.a.backspace,ha.a.anchoredObject,ec);tc.ma(da.a.backspace,ha.a.unsupportedObject,Zb);tc.ma(da.a.iK,ha.a.anchoredObject,ec);tc.ma(da.a.iK,ha.a.unsupportedObject,Zb);
tc.ma(da.a.backspace,ha.a.paragraph,Object(k.a)(this,this.deleteParagraph,"deleteParagraph"));tc.ma(da.a.iK,ha.a.paragraph,Object(k.a)(this,this.deleteParagraph,"deleteParagraph"));tc.ma(da.a.Vya,ha.a.paragraph,Object(k.a)(this,this.deleteParagraph,"deleteParagraph"));tc.$b(da.a.Vya,64);super.RSg(tc,Tb,qb,Jb)}deleteParagraph(tc,Tb){tc=Tb.node;va.a.kQd(tc);this.nsc.tDf(tc);this.Tn&&this.Tn.instance&&ka.App.R4e&&this.Tn.instance.vIg(tc);tc.Wr&&(this.so.k5m(tc,!this.ye),this.ye&&this.oxh.instance&&this.oxh.instance.bOj(tc));
return 0}static get instance(){return Uc.na||(Uc.na=new Uc(f.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),f.a.instance.Ca("Box4.ContentControlConfigSettings"),f.a.instance.Ca("Box4.IContentControlEditor"),f.a.instance.resolve("Box4.IDynamicRangeEditor"),f.a.instance.Ca("WordEditor.Bookmark.IBookmarkManager")))}static Txc(tc){ma.a.instance.J(4)&&qa.App.lc.eq&&qa.App.lc.Mp.MJ(tc)}}Uc.na=null;Object(C.a)(Uc,"DeleteActor",ia,[])},1400:function(C,L,b){b.r(L);C=b(0);var f=b(8),
c=b(1775),u=b(1413),r;(function(ja){ja[ja.external=0]="external";ja[ja.msa=1]="msa";ja[ja.aad=2]="aad"})(r||(r={}));Object(C.b)("AuthorityType",r);class t{}Object(C.a)(t,"OAuthResult",null,[]);class k{constructor(ja){this.agk=ja}initialize(){return Promise.resolve(0)}YJe(){return Promise.resolve(0)}xLa(){f.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new t,{IsSuccess:!0,Token:this.agk}))}H2e(){return Promise.resolve(Object.assign(new t,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}u0e(){return!1}Bwd(){return"MockAuthTokenStrategy"}}Object(C.a)(k,"MockAuthTokenStrategy",null,[333]);var m=b(1466);class l{static get(ja,Ma,Ha){if(!Ha)return ja;let X=0;return Promise.race([ja,new Promise(W=>{X=window.setTimeout(()=>{W(Ma)},Ha)})]).then(W=>{window.clearTimeout(X);return Promise.resolve(W)}).catch(()=>{window.clearTimeout(X);
return Promise.resolve(Ma)})}}Object(C.a)(l,"PromiseWithTimeout",null,[]);var x=b(2),w=b(1324);class G{constructor(ja,Ma,Ha,X,W){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=ja;this.scope=Ma;this.silentLogin=Ha;this.options=X;this.correlationId=W}}Object(C.a)(G,"TokenRequestParameters",null,[353]);var D=b(15),H=b(23);class M{constructor(){this.mSh=null;let ja=x.AFrameworkApplication.K.Ga(x.AFrameworkApplication.vda),Ma=x.AFrameworkApplication.K.Ga(x.AFrameworkApplication.TZd);
this.Twc=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",ja&&""!==ja?ja:"Unspecified",Ma&&""!==Ma?Ma:"Unspecified")}initialize(){return new Promise(ja=>{H.a.instance.Ca("Common.App.WopiIdentity.IWopiIdentity").execute(Ma=>{this.mSh=Ma;ja(0)})})}Kc(ja){const Ma=["HTTPS:","API:"];let Ha=!1;const X=ja.toLocaleUpperCase();for(const W of Ma)if(X.startsWith(W)){Ha=!0;break}return Ha||this.Vam(ja)?ja+"/.default":ja}Vam(ja){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(ja)}YJe(){return Promise.resolve(0)}xLa(ja,
Ma,Ha,X,W,fa,ra){if(D.a.hBa){W=w.a.QRn;if(!W)return Ma=Object.assign(new t,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Ma);if(!Array.contains(W,ja))return Ma=Object.assign(new t,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+ja}),Promise.resolve(Ma)}ja=this.Kc(Ha);Ha=new G(Ha,ja,!X,null,x.AFrameworkApplication.userSessionId);return this.mSh.getAccessToken(Ha,Ma,ra).then(Aa=>Object.assign(new t,{IsSuccess:!0,
Token:Aa.accessToken}),Aa=>Object.assign(new t,{IsSuccess:!1,ErrorCode:Aa}))}H2e(){return Promise.resolve(Object.assign(new t,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}u0e(){return!1}Bwd(){return this.Twc}}Object(C.a)(M,"ParentFrameTokenStrategy",null,[333]);var J=b(41),F=b(1348),A=b(75);class N{constructor(){this.reject=this.resolve=null;this.startTime=0;this.Rgj=this.q0h=null}}
Object(C.a)(N,"PromiseWrapper",null,[]);class B{constructor(ja=0){this.Bx=0;this.k$c=!1;this.Yl=new A.a;this._timeout=ja}enqueue(ja){return new Promise((Ma,Ha)=>{this.Yl.add(Object.assign(new N,{Rgj:ja,resolve:Ma,reject:Ha}));this.process()})}process(){if(this.k$c||this.Bx===this.Yl.count)return!1;const ja=this.Yl.J(this.Bx++);try{this.k$c=!0,ja.Rgj().then(Ma=>{this.k$c=!1;this.jOf(ja,Ma,null,!0)}).catch(Ma=>{this.k$c=!1;this.jOf(ja,null,Ma,!1)})}catch(Ma){this.k$c=!1,this.jOf(ja,null,Ma,!1)}return!0}jOf(ja,
Ma,Ha,X){if(X){const W=()=>{ja.resolve(Ma);this.process()};0<this._timeout?window.setTimeout(()=>{W()},this._timeout):W()}else{const W=()=>{ja.reject(Ha);this.process()};0<this._timeout?window.setTimeout(()=>{W()},this._timeout):W()}}}Object(C.a)(B,"PromiseQueue",null,[]);class E{constructor(){this.correlationId=this.resolve=null}}Object(C.a)(E,"ResolveWithCorrelation",null,[]);var P=b(70),T=b(149),V=b(844),I=b(89);class R extends T.a{constructor(ja,Ma,Ha,X,W,fa,ra){super(!1,!1,!0);this.Ith=this.WMa=
null;this.YFa=ja;this.Ujk=Ha;this.kw=X;this.Hqk=W;this.hVb=fa;this.sL=document.createElement("iframe");this.sL.id="SharedAuthInteractiveFrame";this.sL.setAttribute("name","SharedAuthInteractiveFrame");this.sL.setAttribute("title","SharedAuthInteractiveFrame");this.sL.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.sL.style.border="0";this.sL.style.height="48px";this.sL.style.width="190px";$addHandler(this.sL,"error",Object(J.a)(this,this.$Jm,"onSharedAuthFrameError"));
ja=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.YFa,Ma,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",x.AFrameworkApplication.userType);ra&&(ja+="&vnext=1");this.sL.src=ja;this.n7j=new Promise(Aa=>{this.Ith=Aa});this.Jth=!1}h9a(){this.WMa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.Ujk,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:x.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(J.a)(this,
this.Z0k,"createFrame"),["resolveDialogStyles"]:this.Ith}};this.wc=5;this.Ih(CommonUIStrings.l_SignIn,Object(J.a)(this,this.wqn,"sharedAuthConsentDialogHandler"),this.WMa)}PPj(ja=!1,Ma=5){this.WMa&&this.WMa.bodyControls&&(!0!==Object(P.a)(Object,this.WMa.bodyControls).frameLoaded&&(Object(P.a)(Object,this.WMa.bodyControls).frameLoaded=!0),ja!==Object(P.a)(Object,this.WMa.bodyControls).frameLoadSuccess&&(Object(P.a)(Object,this.WMa.bodyControls).frameLoadSuccess=ja),Ma!==this.WMa.dialogButtonsOption&&
(this.WMa.dialogButtonsOption=null,this.wc=Ma),this.update(this.WMa))}Xvn(ja,Ma){const Ha=new V.a(I.a.nAj);Ha.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:x.AFrameworkApplication.isRtl,["messageCorrelationId"]:ja,["dialogStyles"]:Ma};this.kw.mtb(Ha,this.sL.contentWindow,this.YFa)}Kqi(){this.PPj(!1,6)}get lAj(){return this.sL}get K$k(){return this.n7j.then(ja=>{this.Jth=!0;return ja})}get L$k(){return this.Jth}$Jm(){this.Kqi()}Z0k(){return this.sL}wqn(ja){0===
ja&&(this.Hqk.reject(Object.assign(new t,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.hVb(null))}}Object(C.a)(R,"SharedAuthConsentDialog",T.a,[348]);var ba=b(850),ha=b(79),na=b(36),da=b(130),ia=b(295);class ma{constructor(){this.sL=null;this.Y7d=0;this.Cuc=this.qxc=this.C9e=this.hVb=this.oka=this.IQh=null;this.kw=new ba.a(null,null);this.Vge=x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthVNext",!1);this.Twc=
"SharedAuthTokenStrategy "+(this.Vge?"BrowserAuth 1.20210701.2/MSAL 2.11.0":"BrowserAuth 1.20210426.1/MSAL 2.11.0");this.YFa=w.a.yqn;this.CNh=w.a.xqn;this.$uh=w.a.enableConsoleLogging;this.p8j=x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.iok=x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",this.Vge);this.mAb={};this.dck=new B(1500)}Bwd(){return this.Twc}initialize(){var {OAuthManager:ja}=
b(1400);if("loadFrame"in this.mAb)return this.mAb.loadFrame.q0h;if(!this.YFa)return ha.Health.instance.recordKpiFailure(ja.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),f.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);ja=this.$_e("loadFrame");this.Y7d=na.a.me();var Ma=this.YFa+this.CNh+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+x.AFrameworkApplication.userSessionId+"&WacUserType="+x.AFrameworkApplication.userType;
this.Vge&&(Ma+="&vnext=1");this.sL=document.createElement("iframe");this.eAd(this.sL);this.sL.style.cssText="height:0;width:0;display:none;";this.sL.id="SharedAuthFrame";this.sL.setAttribute("name","SharedAuthFrame");this.sL.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.sL.setAttribute("title","SharedAuthFrame");this.sL.src=Ma;document.body.appendChild(this.sL);Ma=na.a.me()-this.Y7d;f.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",
Ma,this.sL.src);return ja}YJe(ja){this.C9e=ja;const Ma=new V.a(I.a.r3g);Ma.Values=this.H_h(ja);ja=this.$_e("initFrame");this.kw.mtb(Ma,this.sL.contentWindow,this.YFa);f.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return ja}xLa(ja,Ma,Ha,X,W,fa){const ra=new V.a(I.a.oAj),Aa=this.dDi();ra.Values=this.JLj(ja,Ma,Ha,X,W,fa,Aa);ja=this.$_e(Aa);X&&x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",
!1)?this.dck.enqueue(()=>new Promise(Ba=>{this.HHn(fa,ra,Ba,Aa)})):(this.kw.mtb(ra,this.sL.contentWindow,this.YFa),f.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Ma));return ja}HHn(ja,Ma,Ha,X){const W=this.mAb[X];W&&(this.qxc=Ma,this.hVb=Object.assign(new E,{resolve:Ha,correlationId:X}),this.oka=new R(this.YFa,this.CNh,ja,this.kw,W,Ha,this.Vge),this.oka.h9a())}dDi(){return da.a.create().toString()}JLj(ja,Ma,Ha,X,W,fa,ra){const Aa={};Aa.appName=
ja;Aa.appId=Ma;Aa.target=Ha;Aa.withPopup=X;Aa.claims=W;Aa.promptMessage=fa;Aa.messageCorrelationId=ra;return Aa}eAd(ja){$addHandler(ja,"load",Object(J.a)(this,this.dGm,"onIFrameLoaded"));$addHandler(ja,"error",Object(J.a)(this,this.bKb,"onIFrameError"));this.kw.Tgb(this.YFa);this.kw.ax(I.a.u3g);this.kw.uD(I.a.u3g,Object(J.a)(this,this.GJm,"onScriptLoaded"));this.kw.ax(I.a.t3g);this.kw.uD(I.a.t3g,Object(J.a)(this,this.FJm,"onScriptInitialized"));this.kw.ax(I.a.p3g);this.kw.uD(I.a.p3g,Object(J.a)(this,
this.IFm,"onGetTokenResponse"));this.kw.ax(I.a.v3g);this.kw.uD(I.a.v3g,Object(J.a)(this,this.$Gm,"onLoginResponse"));this.kw.ax(I.a.s3g);this.kw.uD(I.a.s3g,Object(J.a)(this,this.yGm,"onInteractiveFlowReady"));this.kw.ax(I.a.q3g);this.kw.uD(I.a.q3g,Object(J.a)(this,this.QFm,"onHideDialog"));this.kw.ax(I.a.o3g);this.kw.uD(I.a.o3g,Object(J.a)(this,this.vGg,"onCloseDialog"))}$_e(ja){const Ma=new N;Ma.startTime=na.a.me();const Ha=new Promise((X,W)=>{Ma.resolve=X;Ma.reject=W});Ma.q0h=Ha;this.mAb[ja]=Ma;
return Ha}dGm(){const ja=na.a.me()-this.Y7d;f.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",ja)}bKb(ja){const {OAuthManager:Ma}=b(1400),Ha=na.a.me()-this.Y7d,X=Object.assign(new ia.a,{durationMs:Ha});ha.Health.instance.recordKpiFailure(Ma.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,X);f.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",Ha,this.$uh?JSON.stringify(ja):"")}GJm(ja){const {OAuthManager:Ma}=b(1400),Ha=
this.mAb.loadFrame;var X=na.a.me()-Ha.startTime,W=ja.Values.AuthLibrary.toString();ja=ja.Values.Success.toString();f.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",ja,W,X);W&&(this.Twc="SharedAuthTokenStrategy "+W);W=Boolean.parse(ja);W||(ja=this.SG(),void 0!==ja&&null!==ja&&(ja.set("AuthLibrary",this.Bwd()),X=Object.assign(new ia.a,{durationMs:X,extendedProperties:ja}),ha.Health.instance.recordKpiFailure(Ma.kpiName,"SharedAuthStrategyInitFailed",
!1,!0,X)));Ha.resolve(W?0:1)}FJm(ja){if(ja.Values.interactive&&this.qxc&&this.qxc.Values.messageCorrelationId){const Ha=this.qxc.Values.messageCorrelationId.toString();if(ja.Values.interactive&&this.oka){this.oka.K$k.then(X=>{this.kw.mtb(this.qxc,this.oka.lAj.contentWindow,this.YFa);this.oka.Xvn(Ha,X);this.oka.PPj(!0);this.qxc=null});return}}ja=this.mAb.initFrame;const Ma=na.a.me()-ja.startTime;f.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Ma);ja.resolve(0)}IFm(ja){if(ja.Values.messageCorrelationId&&
ja.Values.messageCorrelationId.toString()){var Ma=ja.Values.messageCorrelationId.toString(),Ha=this.mAb[Ma];if(Ha){var X=na.a.me()-Ha.startTime;f.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",X);ja.Values.isSuccess&&ja.Values.isSuccess?Ha.resolve(ja.Values.response):Ha.reject(ja.Values.response);this.$Lj(Ma)}else f.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else f.ULS.sendTraceTag(573112904,
3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}yGm(){if(this.oka.L$k)this.oka.Kqi();else if(this.C9e&&this.oka){const ja=new V.a(I.a.r3g);ja.Values=this.H_h(this.C9e,!0);this.kw.mtb(ja,this.oka.lAj.contentWindow,this.YFa)}}QFm(){this.oka&&this.oka.WHc()}vGg(ja){ja.Values.cancelled&&ja.Values.cancelled&&ja.Values.messageCorrelationId&&this.$Lj(ja.Values.messageCorrelationId.toString());this.oka&&this.oka.hide()}SG(){try{return new Map}catch(ja){return null}}H_h(ja,
Ma=!1){const Ha={};Ha.appIds=this.qsl();Ha.upn=ja.loginHint;Ha.authority=ja.authority;Ha.authorityType=Object(c.a)(r,ja.authorityType);Ha.tenantId=ja.tenantId;Ha.correlationId=x.AFrameworkApplication.userSessionId;Ha.enableConsoleLogging=this.$uh;Ha.enablePopupFlash=this.p8j;Ha.skipUpnCheck=this.iok;Ha.interactive=Ma;return Ha}qsl(){const ja=[],Ma=w.a.sEf;for(let Ha in Ma)Array.add(ja,Ma[Ha]);return ja}H2e(ja,Ma,Ha,X,W,fa){const ra=new V.a(I.a.mAj),Aa=this.dDi();ra.Values=this.JLj(ja,Ma,Ha,X,W,fa,
Aa);this.IQh=ra;ja=this.$_e(Aa);f.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Ma);this.eun();return ja}u0e(){return!0}eun(){this.Cuc||(this.Cuc=new F.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.Cuc.id=16,this.Cuc.nGe=!1,this.Cuc.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{f.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");
this.kw.mtb(this.IQh,this.sL.contentWindow,this.YFa)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),x.AFrameworkApplication.la.eb.f2a(this.Cuc,!0)||f.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}$Gm(ja){if(ja.Values.messageCorrelationId&&ja.Values.messageCorrelationId.toString()){var Ma=this.mAb[ja.Values.messageCorrelationId.toString()];if(Ma){var Ha=na.a.me()-Ma.startTime;f.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",
Ha);ja.Values.isSuccess&&ja.Values.isSuccess?Ma.resolve(ja.Values.response):Ma.reject(ja.Values.response)}else f.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else f.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}$Lj(ja){this.hVb&&this.hVb.correlationId===ja&&(this.hVb.resolve(null),this.hVb=null)}}Object(C.a)(ma,"SharedAuthTokenStrategy",null,[333]);
class qa{constructor(ja){this.Leb=ja;this.Twc="UnsupportedAuthTokenStrategy Reason="+u.a[this.Leb]}initialize(){return Promise.resolve(0)}YJe(){return Promise.resolve(0)}xLa(){return Promise.resolve(Object.assign(new t,{IsSuccess:!1,ErrorCode:u.a[this.Leb],ErrorMessage:"Unable to get a token. Reason: ["+u.a[this.Leb]+"]"}))}H2e(){return Promise.resolve(Object.assign(new t,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}u0e(){return!1}Bwd(){return this.Twc}}
Object(C.a)(qa,"UnsupportedAuthTokenStrategy",null,[333]);var ka=b(1307);b.d(L,"OAuthManager",function(){return va});class va{constructor(ja=null){this.cva=0;this.Uoa=null;this.UZb=0;const Ma=na.a.me();this.Lbk=this.f$k(ja).then(Ha=>Ha?this.d2l():(f.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.LP(),Math.floor(na.a.me()-Ma)),Ha=this.SG(),void 0!==Ha&&null!==Ha&&(Ha.set("AuthLibrary",this.LP()),Ha=Object.assign(new ia.a,
{durationMs:Math.floor(na.a.me()-Ma),extendedProperties:Ha}),ha.Health.instance.recordKpiFailure(va.kpiName,"StrategyPickFailed",!1,!0,Ha)),Promise.resolve(1))).then(Ha=>0!==Ha?Promise.resolve(Ha):this.nlm())}g$k(){var ja=w.a.wxm;ja&&0<ja.length?(this.cva=1,this.Uoa=new k(ja)):x.AFrameworkApplication.K.ea("IsO365ConsumerHost")||x.AFrameworkApplication.K.ea("IsO365CommercialHost")?x.AFrameworkApplication.K.ea("IsAnonymousUser")?(this.cva=2,this.Uoa=new qa(this.cva)):(ja=m.a.getAuthContext().loginHint)&&
ja.length?w.a.Pyd?(this.cva=1,this.Uoa=new M):(this.cva=1,this.Uoa=new ma):(this.cva=3,this.Uoa=new qa(this.cva)):(this.cva=4,this.Uoa=new qa(this.cva))}LP(){return this.Uoa?this.Uoa.Bwd()||"Unknown":"None"}f$k(ja=null){f.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const Ma=na.a.me();return x.AFrameworkApplication.K.Ixi().then(Ha=>{Ha?(this.g$k(),ja&&(this.Uoa=ja),f.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",
w.a.clientVersion,w.a.appVersion,w.a.rcl,this.LP(),Math.floor(na.a.me()-Ma))):f.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(na.a.me()-Ma));return Promise.resolve(Ha)},()=>{f.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(na.a.me()-Ma));return Promise.resolve(!1)})}d2l(){f.ULS.sendTraceTag(573390991,
3E3,50,"Initializing {0}",this.LP());const ja=na.a.me();return l.get(this.Uoa.initialize(),2,w.a.nPg).then(Ma=>{if(0===Ma)f.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.LP(),Math.floor(na.a.me()-ja));else if(1===Ma){f.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.LP(),Math.floor(na.a.me()-ja));var Ha=this.SG();void 0!==Ha&&null!==Ha&&(Ha.set("AuthLibrary",this.LP()),Ha=Object.assign(new ia.a,
{durationMs:Math.floor(na.a.me()-ja),extendedProperties:Ha}),ha.Health.instance.recordKpiFailure(va.kpiName,"StrategyInitFailed",!1,!0,Ha))}else 2===Ma&&(f.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.LP(),Math.floor(na.a.me()-ja)),Ha=this.SG(),void 0!==Ha&&null!==Ha&&(Ha.set("AuthLibrary",this.LP()),Ha=Object.assign(new ia.a,{durationMs:Math.floor(na.a.me()-ja),extendedProperties:Ha}),ha.Health.instance.recordKpiFailure(va.kpiName,
"StrategyInitTimedOut",!1,!0,Ha)));return Promise.resolve(Ma)},()=>{f.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.LP(),Math.floor(na.a.me()-ja));return Promise.resolve(1)})}nlm(){f.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.LP());const ja=na.a.me();return l.get(this.Uoa.YJe(m.a.getAuthContext()),2,w.a.nPg).then(Ma=>{if(0===Ma)f.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.LP(),
Math.floor(na.a.me()-ja));else if(1===Ma){f.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.LP(),Math.floor(na.a.me()-ja));var Ha=this.SG();void 0!==Ha&&null!==Ha&&(Ha.set("AuthLibrary",this.LP()),Ha=Object.assign(new ia.a,{durationMs:Math.floor(na.a.me()-ja),extendedProperties:Ha}),ha.Health.instance.recordKpiFailure(va.kpiName,"StrategyLoadFailed",!1,!0,Ha))}else 2===Ma&&(f.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.LP(),Math.floor(na.a.me()-ja)),Ha=this.SG(),void 0!==Ha&&null!==Ha&&(Ha.set("AuthLibrary",this.LP()),Ha=Object.assign(new ia.a,{durationMs:Math.floor(na.a.me()-ja),extendedProperties:Ha}),ha.Health.instance.recordKpiFailure(va.kpiName,"StrategyLoadTimedOut",!1,!0,Ha)));return Promise.resolve(Ma)},()=>{f.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.LP(),Math.floor(na.a.me()-ja));return Promise.resolve(1)})}xLa(ja,Ma,Ha=null){return this.aVc(ja,
Ma,!1,null,"",Ha)}KLj(ja,Ma,Ha,X,W=null){return this.aVc(ja,Ma,!0,Ha,X,W)}aVc(ja,Ma,Ha,X,W,fa,ra=0){ra+=1;f.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",ja,this.lkc(ja,Ma),this.LP(),ra);var Aa=this.SG();void 0!==Aa&&null!==Aa&&(Aa.set("AuthLibrary",this.LP()),Aa.set("AppName",ja),Aa.set("Target",this.lkc(ja,Ma)),ha.Health.instance.recordKpiUsage(va.kpiName,0,"WacOAuthFC",Aa));if(!w.a.isEnabled){var Ba;return this.bxg((Ba=
new t,Ba.IsSuccess=!1,Ba.Token=null,Ba.ErrorCode="NotEnabled",Ba.ErrorMessage="OAuthManager is disabled.",Ba),ja)}const ta=w.a.sEf[ja];if(void 0===ta||null===ta){f.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",ja);var xa;return this.bxg((xa=new t,xa.IsSuccess=!1,xa.Token=null,xa.ErrorCode="DisallowedApp",xa.ErrorMessage="Disallowed appName: "+ja,xa),ja)}const za=na.a.me(),la=this;Aa=this.Lbk.then(db=>la.N7l(ja,
ta,Ma,Ha,X,W,fa,db));Ba=Ha?0:w.a.nPg;let Sa;xa=(Sa=new t,Sa.IsSuccess=!1,Sa.Token=null,Sa.ErrorCode="authTokenStrategy_timeout",Sa.ErrorMessage="Auth Strategy timed out after ["+Ba+"] ms when fetching token",Sa);let Pa=this,fb=this;return l.get(Aa,xa,Ba).then(db=>ra<=va.ivm&&(db.ErrorCode===va.XIj||db.ErrorCode===va.oAn)?(f.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",ra,Math.floor(na.a.me()-za)),Pa.aVc(ja,Ma,Ha,X,W,fa,ra)):db.ErrorCode===va.ZVi&&!Ha&&
(f.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",ra,va.bki),va.Gel&&Pa.Uoa.u0e()&&Pa.Uoa.H2e(ja,ta,Ma,Ha,X,W).then(Qa=>Promise.resolve(Pa.CKe(Qa,ja,Ma,ta,za))).catch(()=>{let Qa;const wb=(Qa=new t,Qa.IsSuccess=!1,Qa.Token=null,Qa.ErrorCode="authTokenStrategy_failure",Qa.ErrorMessage="LoginPopup failed, GetToken could not be called",Qa);return Promise.resolve(Pa.CKe(wb,ja,Ma,ta,za))}),va.bki)?Pa.aVc(ja,Ma,!0,X,W,fa,ra):Promise.resolve(Pa.CKe(db,
ja,Ma,ta,za))).catch(()=>{let db;const Qa=(db=new t,db.IsSuccess=!1,db.Token=null,db.ErrorCode="authTokenStrategy_failure",db.ErrorMessage="Auth Strategy failed with an unknown error",db);return Promise.resolve(fb.CKe(Qa,ja,Ma,ta,za))})}N7l(ja,Ma,Ha,X,W,fa,ra,Aa){return 1===Aa||2===Aa?this.bxg(Object.assign(new t,{IsSuccess:!1,Token:null,ErrorCode:1===Aa?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),ja):this.Uoa.xLa(ja,Ma,Ha,X,W,fa,ra).then(Ba=>Promise.resolve(this.N6i(Ba,
!0,ja))).catch(Ba=>Promise.resolve(this.N6i(Ba,!1,ja)))}CKe(ja,Ma,Ha,X,W){const fa={};W=na.a.me()-W;fa.IsSuccess=ja.IsSuccess;fa.ErrorCode=ja.IsSuccess?"Success":ja.ErrorCode||"";fa.ErrorMessage=ja.IsSuccess?"Success":this.lkc(Ma,ja.ErrorMessage||"");fa.Target=this.lkc(Ma,Ha||"");fa.TimeInMS=Math.floor(W);fa.AuthLibrary=this.LP();fa.AppName=Ma;fa.AuthorityType=Object(c.a)(r,m.a.Tve());fa.UserType=this.SSl(m.a.getAuthContext());fa.IsAuthSupportedInSession=u.a[this.cva];fa.RequestCount=++this.UZb;fa.AppId=
X;f.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(fa));ja.IsSuccess||(Ha=this.SG(),void 0!==Ha&&null!==Ha&&(Ha.set("AppName",Ma),Ha.set("AuthLibrary",this.LP()),Ha.set("ErrorCode",ja.ErrorCode),Ha.set("ErrorMessage",this.lkc(Ma,ja.ErrorMessage)),Ma=Object.assign(new ia.a,{durationMs:W,extendedProperties:Ha}),ha.Health.instance.recordKpiFailure(va.kpiName,"TryGetTokenFailure",!1,!0,Ma)));return ja}bxg(ja,Ma){f.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",
Ma,this.lkc(Ma,ja.ErrorMessage));const Ha=this.SG();void 0!==Ha&&null!==Ha&&(Ha.set("AppName",Ma),Ha.set("AuthLibrary",this.LP()),Ha.set("ErrorCode",ja.ErrorCode),Ha.set("ErrorMessage",this.lkc(Ma,ja.ErrorMessage)),Ma=Object.assign(new ia.a,{extendedProperties:Ha}),ha.Health.instance.recordKpiFailure(va.kpiName,"FailureBeforeGetToken",!1,!0,Ma));return Promise.resolve(ja)}vRi(ja){return ja===ka.a.I1e}lkc(ja,Ma){return this.vRi(ja)&&Ma?"REDACTED":Ma}SSl(ja){return x.AFrameworkApplication.K.ea("IsAnonymousUser")?
"anonymous":!ja.loginHint||1>ja.loginHint.length?"empty":-1<ja.loginHint.indexOf("guest#")?"guest":-1<ja.loginHint.indexOf("ext#")?"external":0>ja.upn.indexOf("@")?"no-at":"supported"}o8l(){return 1===this.cva}N6i(ja,Ma,Ha){let X=null,W=null,fa=null,ra=null;ja?ja.ErrorCode||ja.ErrorMessage?(W=ja.ErrorCode?ja.ErrorCode:va.Lli,fa=ja.ErrorMessage?ja.ErrorMessage:"No message"):ja.Token?Ma?X=ja.Token:(W=va.d5m,fa="A rejected promise returned a token."):(W=va.Lli,fa=JSON.stringify(ja)):(W=va.Czm,fa="No result came from Auth Token Strategy");
ja&&ja.Telemetry&&!this.vRi(Ha)&&(ra=ja.Telemetry,f.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(ra)));if(W===va.Kxm||W===va.WEn)W=va.XIj,fa="Auth Library Timed Out";W===va.KFk&&-1<fa.indexOf(va.zsk)&&(W=va.ZVi);if(W||fa)X=null;return Object.assign(new t,{IsSuccess:!!X,Token:X,ErrorCode:W,ErrorMessage:fa,Telemetry:ra})}SG(){try{return new Map}catch(ja){return null}}static get bki(){return x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",
!1)}static get Gel(){return x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}va.WEn="token_renewal_error";va.Lli="Exception";va.Czm="NoResult";va.d5m="RejectToken";va.Kxm="monitor_window_timeout";va.XIj="Timeout";va.oAn="authTokenStrategy_timeout";va.KFk="login_required";va.zsk="AADSTS50058";va.ZVi="Cookies Disabled";va.kpiName="OAuthManager";va.ivm=2;Object(C.a)(va,"OAuthManager",null,[270])},1405:function(C,L,b){C=b(0);class f{constructor(k,
m,l,x){this.q6j=k;this.Clk=m;this.Alk=l;this.Dlk=x}get yPf(){return this.q6j}get tXg(){return this.Clk}get qXg(){return this.Alk}get resultType(){return this.Dlk}}Object(C.a)(f,"SearchContext",null,[1047]);class c{kSf(k,m,l,x){var w=l-m;let G;if(100<=w)w=m,G=l;else{w=Math.max(0,m+Math.ceil(w/2)-50);G=Math.min(k.length,w+100);w=Math.max(0,G-100);let H;if(w&&" "!==k.charAt(w-1)){H=Math.min(m,w+10);for(var D=w;D<H;++D)if(" "===k.charAt(D)){w=D+1;break}}if(G!==k.length&&" "!==k.charAt(G))for(H=Math.max(l,
G-10),D=G-1;D>=H;--D)if(" "===k.charAt(D)){G=D;break}}k=k.substring(w,G);return new f(k,m-w,l-w,x)}Gpe(k){return this.kSf(k.iBi(),k.begin,k.end,"")}}Object(C.a)(c,"SearchContextFactory",null,[1023]);var u=b(115),r=b(1391);b.d(L,"a",function(){return t});class t extends c{constructor(){super()}Gpe(k){let m=k.begin,l=k.end;const x=({begin:m,end:l}=t.VIl(k,m,l)).returnValue;k=r.a(k.type);return this.kSf(x,m,l,k)}static get instance(){return t.na||(t.na=new t)}static VIl(k,m,l){k=k.iBi();return t.Wmj(k,
m,l)}static Wmj(k,m,l){const x=u.AParagraphNode.V0(k);if(x.length<k.length){k=k.substring(0,m);const w=u.AParagraphNode.V0(k);k=k.length-w.length;m-=k;l-=k}return{returnValue:x,begin:m,end:l}}}t.na=null;Object(C.a)(t,"EditorSearchContextFactory",c,[])},1407:function(C,L,b){C=b(0);var f=b(2),c=b(23),u=b(301),r=b(652),t=b(24),k=b(12),m=b(123),l=b(49),x=b(644),w=b(205),G=b(246),D=b(83),H=b(30),M=b(10),J=b(3),F=b(6),A=b(552),N=b(924);class B{create(){return new N.a}}Object(C.a)(B,"FootnoteEndnoteContainerNodeFactory",
null,[244]);var E=b(504);b.d(L,"a",function(){return P});class P{constructor(T,V,I,R,ba,ha,na,da,ia){this.Ige=null;P.ga=T;this.xJ=I;this.Zpf=R;this.Y5j=ha;this.mc=na;this.Da=ba;this.lgk=da;this.S6j=ia;P.gh=V}ULe(T,V){this.Gfl(T);T.Va(7);this.xJ.tRi(T,V)||T.Kd(7)}Gfl(T){if(this.Zpf.wGe(T)){var V=!1,I=!1;if(T.Va(7)){do{const R=T.currentNode;if(37===R.type)switch(R.getValue(F.a.Vfa)){case 0:I=!0;break;case 1:V=!0}}while(T.jh(7))}I||this.WTh(T,0);V||this.WTh(T,1)}}WTh(T,V){const I=this.Y5j.create(1074135124);
I.setValue(F.a.Vfa,V);T.Re(I,7)}Wfn(T){T&&this.xuj(T.uza)}xuj(T){T&&(T=t.SelectionFactory.Pc(T.Wa.paragraph,T.Wa.cp+1),this.Da.setSelection(T))}Lym(T){let V=this.lgk(T);void 0!==V&&null!==V?this.xJ.OAa(V)&&(V=this.xJ.JBi(V)):V=T;return this.S6j(V)}uwn(){this.Ige?P.gh.notificationBar.removeEntry(this.Ige):this.Ige=P.gh.notificationBar.Qqa(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);P.gh.notificationBar.BB(this.Ige)}tDk(T,V){T=this.mc.CTa(T,37,37);let I=!1;
if(T.Rc()){do{const R=T.currentNode;this.xJ.ssg(R)?this.UYh(R,V):I=!0}while(T.yg())}I&&this.uwn()}UYh(T,V){A.e(T,I=>{P.Gol(I,V);return!0},12)}KYl(T,V){T=this.xJ.qxe(T,V);return T?(T=this.mc.Dg(T))?T.Vz():!1:!1}nxi(T,V){T=this.xJ.qxe(T,V);T=this.mc.Dg(T);if(T.Rc()){do if(V=T.currentNode,1===V.getValue(F.a.vra))return V;while(T.yg())}return null}static qud(){return new P(f.AFrameworkApplication.pa,k.App.oa,E.a.instance,m.PageReader.instance,l.a.instance,new B,new x.a,w.OutlineNavigator.P5i,G.WordSectionNavigator.mod)}static get instance(){return P.na||
(P.na=P.qud())}static get paragraphEditor(){return P.Ki||(P.Ki=c.a.instance.resolve("Box4.IParagraphEditor"))}static Gol(T,V){V.vGb?P.paragraphEditor.dr.goa(T,D.OutlineReader.OP(T)):P.paragraphEditor.dr.goa(T,0);T=H.a.createTextRange(T,0,M.ParagraphReader.textLength(T));P.ga.rf(T,J.a.font,2,!0,new u.a,new r.a(V.fontName));P.ga.rf(T,J.a.ay,2,!0,new u.a,new r.a(V.fontSize))}}P.ga=null;P.gh=null;P.na=null;P.Ki=null;Object(C.a)(P,"FootnoteEndnoteEditor",null,[326])},1413:function(C,L,b){b.d(L,"a",function(){return f});
C=b(0);var f;(function(c){c[c.unknown=0]="unknown";c[c.supported=1]="supported";c[c.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";c[c.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";c[c.hostUnsupported=4]="hostUnsupported"})(f||(f={}));Object(C.b)("SupportStatus",f)},1434:function(C,L,b){b.d(L,"a",function(){return M});C=b(0);var f=b(349),c=b(51),u=b(23),r=b(127),t=b(8),k=b(244),m=b(70),l=b(14),x=b(105),w=b(503),G=b(115),D=b(122),H=b(10);class M{constructor(J,F,A,N,B,E=null,P=
"",T=!0,V=!1){this.OEb=this.M_e=this.Nsb=this.Wgj=this.WUe=null;this.jcc=!1;this.Wig=null;this.hFg=0;this.context=J;this.Tc=J.view;this.aE=F;this.$c=B;this.OY=A;this.pO=N;this.IKa=this.failed=!1;this.JPe=null;this.O5a=this.BKc=!1;this.Uwn=M.sPf(J);this.browserName=P;this.XQj=T;this.Usg=V;this.zua=!1;this.DBc=0;if(J=Object(k.a)(90,B)?B:null){this.Wgj=new f.DictionaryPropertySet;this.Wgj.hn(J);A=J.fa(r.a.WLd,c.a.nil);this.Okd=A!=c.a.nil?A.toString():c.a.create().toString();if(J.fa(r.a.mMg,!1)){this.BKc=
!0;this.O5a=J.fa(r.a.O5a,!1);this.JPe=E;for(E=this.Tc.Oa.Ag;E.Iq;)E=E.getContext(0);if(B=Object(m.a)(G.AParagraphNode,E.node)){A=0;N=H.ParagraphReader.textLength(B);switch(E.contextId){case l.a.Lc:A=E.cpBegin;N=E.cpEnd;break;case l.a.endOfParagraph:A=N}this.WUe=x.FormattingReader.eud(E.node,A,E.Ma);t.ULS.shipAssertTag(6305503,307,!!this.WUe);B=D.HyperlinkReader.UFc(B);for(const I of B)I.cpEnd<=A||I.cpBegin>=N||M.hyperlinkEditor.EV(E.node,I.hyperlink)}}this.IKa=J.fa(r.a.IKa,!1);this.zua=J.fa(r.a.zua,
!1);this.Nsb=J.fa(r.a.Nsb,null)}else this.Okd=c.a.create().toString();F&64&&(this.IKa=!0)}static get hyperlinkEditor(){return M.lk||(M.lk=u.a.instance.resolve("Box4.IHyperlinkEditor"))}static sPf(J){if(J){if(J.Iq){for(let F=0;F<J.length;F++)if(M.sPf(J.getContext(F)))return!0;return!1}if(Object(k.a)(w.a,J))return M.sPf(J.Am);if(H.ParagraphReader.nb(J.node)&&J.node.OG)return!0}return!1}}M.lk=null;Object(C.a)(M,"ClipboardActionArguments",null,[])},1436:function(C,L,b){b.d(L,"a",function(){return N});
C=b(0);var f=b(23),c=b(51),u=b(44),r=b(601),t=b(123),k=b(644),m=b(171),l=b(18),x=b(12),w=b(103),G=b(115),D=b(6),H=b(646),M=b(700),J=b(504),F=b(1356),A=b(1407);class N{constructor(B,E,P,T,V,I){this.xJ=B;this.f0a=P;this.Zpf=T;this.wcf=V;this.mc=I}F5l(B,E,P){const T=this.ezi(E,B.node),V=B.node.Ib;if(!V)return null;const I=new u.GraphTransaction(15);I.Sa(B.node);I.om=P;P=this.G5l(T,E);N.H5l(P,V,B,E);I.dispose();return P}ezi(B,E){const P=this.mc.Sl();P.set(E);P.La(7);P.tc(7);this.f0a.ULe(P,B);return P}G5l(B,
E){const P=M.a.createNode();P.properties.setValue(D.a.Vfa,E);B.Re(P,8);this.wcf.l0k(P,E);return P}static get characterPropertiesEditor(){return N.hc||(N.hc=f.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Lda(){return N.$D||(N.$D=new r.WACStyleSet)}static set Lda(B){N.$D=B}static qud(){const {FootnoteEndnoteDefaultContentInserter:B}=b(1519);return new N(J.a.instance,F.a.instance,A.a.instance,t.PageReader.instance,B.instance,new k.a)}static get instance(){return N.na||(N.na=N.qud())}static get Ze(){return N.vA||
(N.vA=m.PageNavigator.instance)}static set Ze(B){N.vA=B}static H5l(B,E,P,T){l.a.instance.J(4)&&x.App.lc.eq&&x.App.lc.Mp.MJ(P.node);const V=new w.a;V.setValue(D.a.alb,B.id);V.setValue(D.a.Vfa,T);const I=E.Mu(V,c.a.create());N.characterPropertiesEditor.oga(P,R=>H.a.getInstance(R,I,B.id),G.AParagraphNode.ix,N.pui(P.node,T))}static pui(B,E){let P=null;(B=N.Ze.kt(B))&&(B=N.Lda.VL(B))&&(P=B.dma(E?Box4Intl.Box4Strings.L_StyleWordFootnoteReference:Box4Intl.Box4Strings.L_StyleWordEndnoteReference));return P}}
N.na=null;N.hc=null;N.$D=null;N.vA=null;Object(C.a)(N,"FootnoteEndnoteInserter",null,[345])},1439:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{static Q9m(c,u){f.Cpf=c;f.ysf=u}static N9m(c,u){f.wsf=c;f.dgb=u}static bDi(){return f.wsf===f.dgb?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,f.dgb,f.Cpf,f.ysf):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,f.wsf,f.dgb,f.Cpf,f.ysf)}}f.wsf=0;f.dgb=0;f.Cpf=null;f.ysf=null;Object(C.a)(f,"ReplaceAllContext",
null,[])},1460:function(C,L,b){b.r(L);C=b(0);var f=b(1783),c=b(51),u=b(2),r=b(435),t=b(23),k=b(1716),m=b(12),l=b(8),x=b(245),w=b(1785),G=b(13),D=b(20),H=b(1405);class M{constructor(Ta="",jb="",$a=!1,ya=!1){this.Jcm=$a;this.bfm=ya;this.actionId=Ta;this.cLa=jb}}Object(C.a)(M,"SearchEntryPointContext",null,[]);class J{constructor(Ta){this.Spa=null;this.Sw=!1;this.DM=Ta}initialize(){this.K6();this.jC();this.mfa(0)}jC(){this.Spa.jC()}dispose(){this.DM=null}kwd(){return!1}get gK(){return this.Spa?this.Spa.gK:
0}mfa(Ta){this.Spa.mfa(Ta)}get isVisible(){return this.Sw}TBf(Ta){this.Spa&&this.Spa.RZn(Ta)}Qnj(Ta){this.Spa&&this.Spa.A7n(Ta)}YPj(Ta){this.Spa&&this.Spa.Z$n(Ta)}Y6h(){this.Spa&&this.Spa.a0n()}HWe(Ta){this.Spa&&this.Spa.HWe(Ta)}}Object(C.a)(J,"FindReplacePane",null,[325,12]);var F=b(53),A=b(1652),N=b(1199),B=b(151),E=b(191),P=b(1380),T=b(79),V=b(57),I=b(1285),R=b(323),ba=b(1314),ha=b(431),na=b(1337),da=b(641),ia=b(41),ma=b(76),qa=b(955);class ka{constructor(Ta){this.Jge=new ma.a;this.qEa=new ma.a;
this.annotationType=ba.RoleDetectionAnnotation.getTypeName();Ta.b2m(Object(ia.a)(this,this.$uk,"addHeadingAnnotationEventResponder"))}$uk(Ta,jb){this.Jge.Na(Ta)?this.Jge.$(Ta,jb):this.Jge.add(Ta,jb);(Ta=this.csl(Ta))&&this.VOi(jb,Ta,this.hai(ha.a.getTypeName()))}sS(Ta,jb){let $a;const ya=Ta.parentPath.substr(Ta.parentPath.lastIndexOf("\\")+1),wa=Ta.content;if(!wa||this.Pem(wa))""!==ya&&({value:$a}=this.Jge.Ab(ya,$a)).returnValue&&this.VOi($a,Ta,this.hai(jb)),jb===ha.a.getTypeName()?(jb=null,({value:jb}=
this.qEa.Ab(ya,jb)).returnValue?this.qEa.$(ya,Ta):this.qEa.add(ya,Ta)):jb===na.a.getTypeName()&&this.qEa.remove(ya)}VOi(Ta,jb,$a){const ya=this.rEl(jb);jb=this.dsl(jb);0<jb&&Ta($a,ya,jb)}dsl(Ta){try{return Number.parseInvariant(Ta.id.substr(2))}catch(jb){l.ULS.sendTraceTag(554747009,367,10,jb.toString())}return-1}csl(Ta){let jb;return({value:jb}=this.qEa.Ab(Ta,jb)).returnValue?jb:null}LNg(Ta){if(Ta)for(const jb of Ta)this.sS(jb,"AugLoop_Core_AddOperation")}rEl(Ta){if(Ta=Ta.content)switch(Ta.roleType){case ba.RoleType.Heading1:return 1;
case ba.RoleType.Heading2:return 2;case ba.RoleType.Heading3:return 3;case ba.RoleType.Heading4:return 4;case ba.RoleType.Heading5:return 5;case ba.RoleType.Heading6:return 6;case ba.RoleType.Heading7:return 7;case ba.RoleType.Heading8:return 8;case ba.RoleType.Heading9:return 9}return-1}Pem(Ta){Ta=Ta.roleType;return Ta===ba.RoleType.Heading1||Ta===ba.RoleType.Heading2||Ta===ba.RoleType.Heading3||Ta===ba.RoleType.Heading4||Ta===ba.RoleType.Heading5||Ta===ba.RoleType.Heading6||Ta===ba.RoleType.Heading7||
Ta===ba.RoleType.Heading8||Ta===ba.RoleType.Heading9}hai(Ta){if(Ta===ha.a.getTypeName()||Ta===da.a.getTypeName())return qa.a.MUh;if(Ta===na.a.getTypeName())return qa.a.vVf;throw Error.create("Invalid operation type");}}Object(C.a)(ka,"RoleDetectionAnnotationHandler",null,[280]);var va=b(77),ja=b(1575),Ma=b(49),Ha=b(75),X=b(182),W=b(171),fa=b(512);class ra extends X.a{constructor(Ta,jb){super(Ta,jb,m.App.rT);this.lDh=0;this.oIe=null;this.$mb=this.Fzc=0;this.headingsReady=!1;this.dXa=this.Fhb=0;this.z1i=
!1;this.qGh=this.Myh=this.xvh=null}get UHe(){return!0}get rmi(){return this.xvh}get cMe(){return this.qGh}VRj(){this.lDh=Date.now();window.setTimeout(Object(ia.a)(this,this.Hnm,"logHeadings"),6E4);this.headingsReady&&(this.Myh.style.display="none",this.$mb||this.Fzc?(this.rmi.style.display="none",this.container.style.display="block"):(this.container.style.display="none",this.rmi.style.display="block"))}get iY(){return super.iY|496}Hnm(){6E4<=Date.now()-this.lDh&&l.ULS.sendTraceTag(42780191,367,50,
"HeadingsCount: {0} AutoDetectedHeadingsCount: {1} , PurelyAutoDetectedHeadingsCount: {2}",this.$mb,this.Fhb,this.dXa)}static Y3k(Ta,jb,$a){var ya=m.App.oa.za.jc;if(ya&&(ya=W.PageNavigator.instance.RL(ya))){const wa=new ra(new fa.a,t.a.instance.resolve("Box4.IHtmlViewRootFactory"));wa.$mb=0;wa.Fzc=0;wa.oIe=null;wa.Mhb(Ta);wa.xvh=jb;wa.Myh=$a;wa.fz(ya);wa.headingsReady=!0;wa.VRj();wa.qGh=null;return wa}return null}}Object(C.a)(ra,"WordNavigationPaneHeadingsView",X.a,[362,363,147,12]);var Aa=b(3);class Ba{constructor(Ta){this.ga=
Ta}rDm(){this.cancelSearch()}iFm(Ta){this.ga.ob(D.a.GAe,2,Ta)}sIg(){this.cancelSearch()}cancelSearch(){this.ga.processAction(Aa.a.bib,2)}HJm(){this.ga.processAction(Aa.a.findOnPage,2)}onSearchQueryChanged(Ta){this.ga.ob(Aa.a.uEc,2,Ta)}fLm(){this.ga.processAction(D.a.replace,2)}gLm(){this.ga.processAction(D.a.replaceAll,2)}bLm(){this.ga.processAction(G.a.pue,2)}cLm(){this.ga.processAction(G.a.zue,2)}eLm(){this.ga.processAction(Aa.a.mPc,2)}dLm(){this.ga.processAction(Aa.a.ZMc,2)}VPc(Ta){this.ga.ob(D.a.VPc,
2,Ta)}}Object(C.a)(Ba,"FindReplaceActions",null,[341]);X=b(368);class ta{}ta.NV=X.a.SEb;ta.HOc=0;ta.lHa="FindReplaceTaskPaneData";ta.bZ=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(C.a)(ta,"FindReplaceConstants",null,[]);var xa=b(1439);class za{constructor(Ta){this.Nek=Ta}get Yj(){return this.Nek.value}lHl(Ta){Ta=this.Yj.$lb(Ta);return this.wam(Ta)?null:Ta}wam(Ta){return Ta.id===this.Yj.bTa.id}static get instance(){return za.na||(za.na=za.FF())}static FF(){const Ta=new x.a(()=>k.FindManager.instance.Yj);
return new za(Ta)}}za.na=null;Object(C.a)(za,"SearchResultOrder",null,[]);var la=b(10),Sa=b(274);class Pa{constructor(Ta){this.Vlf=Ta}get Rta(){return this.Vlf.value}getSelectedText(){var Ta=this.Rta.rza;if(Ta){const jb=Ta.cpBegin,$a=Ta.cpEnd-jb;if(0<$a&&(Ta=Ta.node,la.ParagraphReader.nb(Ta)))return Ta.characterData.substr(jb,$a)}return null}static getInstance(){return Pa.al()}static al(){const Ta=new x.a(()=>Sa.a.instance);return new Pa(Ta)}}Object(C.a)(Pa,"SelectionHelper",null,[]);var fb=b(35),
db=b(236);class Qa extends J{constructor(Ta,jb,$a,ya,wa,Fa,bb,Eb,hb){super(Ta);this.CTb=ta.NV;this.Epk="FindReplaceTaskPaneProps";this.ib=F.FocusManager.instance();this.v1a=this.m6=this.fwf=null;this.z9e=u.AFrameworkApplication.K.ea("AugLoopOperationsAreEnabled");this.l3d=u.AFrameworkApplication.K.ea("AutoDetectedHeadingsIsEnabled");this.YD=new A.a;this.Nxh=jb;this.Sxb=w.a.headings;this.Hed=f.a.initial;this.$Ea=new Ha.a;this.CZ="";this.D1c={matchCase:!1,matchWholeWord:!1};this.xsf="";this.Qtf=null;
this.YW=$a;this.gOh=!1;this.x_b=ya;this.Da=wa;this.ygk=Fa;this.Y1a=bb;this.nL=Eb;this.Xae=!0;this.Dea=this.Cea=!1;this.lg=hb;this.w9e&&this.Y1a.R4m(()=>{this.Mw()})}get Lwf(){return 1}get w9e(){return this.z9e&&this.l3d&&!!this.lg}TOj(){this.isVisible&&this.Ype===w.a.intelligentPlaceholder&&this.Mw()}get headingsReady(){return this.G7d?this.G7d.headingsReady:!1}set headingsReady(Ta){this.G7d&&(this.G7d.headingsReady=Ta)}get Ype(){return this.Sxb}uCj(){this.Sxb=w.a.headings;this.Mw()}oCj(){this.Sxb=
w.a.find;V.a("NavigationPaneFind");this.Mw()}$Cj(){this.Sxb=w.a.replace;this.Mw()}GCj(){this.Sxb=w.a.intelligentPlaceholder;this.Mw()}CVd(Ta){this.gOh=Ta;this.Mw()}kwd(){return this.Ype===w.a.replace}get gK(){return this.Hed}mfa(Ta){this.Hed=Ta;this.Mw()}TBf(Ta){this.Bwk(Ta);this.Mw()}Bwk(Ta){const jb=this.ygk(Ta[Ta.length-1]);if(jb){let $a=-1;for(let ya=0;ya<this.$Ea.count;ya++)if(jb.id===this.$Ea.J(ya).id){$a=ya;break}-1===$a?l.ULS.sendTraceTag(40776785,313,50,"Taskpane AddSearchResult gave illegal -1 index"):
this.$Ea.$B($a,this.Eai(Ta))}else this.$Ea.addRange(this.Eai(Ta))}Qnj(Ta){for(let jb of Ta)for(Ta=this.$Ea.count-1;0<=Ta;Ta--)if(this.$Ea.J(Ta).id===jb.id){this.$Ea.removeAt(Ta);break}this.Mw()}YPj(Ta){for(let jb of Ta)for(Ta=this.$Ea.count-1;0<=Ta;Ta--)if(this.$Ea.J(Ta).id===jb.id){this.$Ea.$(Ta,this.Dai(jb));break}this.Mw()}Y6h(){this.$Ea.clear();this.Qtf=null;this.Mw()}HWe(Ta){this.Qtf=Ta?Ta.id:null;this.Mw()}Eai(Ta){if(!Ta)return new Ha.a;const jb=new Ha.a;for(let $a of Ta)jb.add(this.Dai($a));
return jb}Dai(Ta){const jb=this.x_b.Gpe(Ta);return{id:Ta.id,searchBeginIndex:jb.tXg,searchEndIndex:jb.qXg,searchResult:jb.yPf}}y3e(){}tPn(){var Ta={};this.DM.VPc(Ta);Ta=Ta[N.a.Value];this.fwf=I.c(Ta)?"":Ta;this.Mw()}J4a(){return this.CZ}$9b(){return this.xsf}F0g(Ta){this.CZ=Ta;this.Mw()}clearSearch(){}initialize(){this.Iee=window.performance.now();const Ta=this.ib.Kc(this.CTb);Ta.parent=B.AFrame.hp;Ta.uK=!0;this.K6();this.mfa(f.a.initial)}HV(){this.isVisible?(l.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),
E.UISurfaces.Nv().then(Ta=>{Ta.setSelectedTaskPane(this.CTb,this.Lwf);this.Fha();this.Xae&&this.Eyj(!0);return null}).catch(Ta=>{Qa.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Ta)})):(this.JVd(),this.Xae&&this.Eyj(!1))}Eyj(Ta){const jb=this.Nxh();jb?this.CZ=jb:Ta&&this.CZ||(this.CZ="");this.DM.onSearchQueryChanged(this.CZ)}jAa(){E.UISurfaces.Nv().then(Ta=>{Ta.hideTaskPane(this.CTb,this.Lwf);return null}).catch(Ta=>{Qa.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],
Ta)})}K6(){this.YW.t3a();this.m6=this.YW.gCc(this.ib);this.Suk()}JVd(){E.UISurfaces.Nv().then(Ta=>{this.Iee=window.performance.now();Ta.showTaskPane(this.CTb,this.GF());Ta=[Object.assign(new fb.a,{name:"Tab",string:this.Sxb})];const jb=window.performance.now()-this.Iee;V.a("NavigationPaneOpen",!0,jb,Ta);return null}).catch(Ta=>{Qa.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Ta)})}Mw(){E.UISurfaces.Nv().then(Ta=>{Ta.updateTaskPane(this.CTb,this.GF());return null}).catch(Ta=>
{Qa.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],Ta)})}GF(){const Ta={activeTab:w.a.initial};this.YD.klc(Ta);return Object.assign(new P.a,{title:ta.bZ,hideHeader:!1,width:320,location:this.Lwf,contentProps:Ta,onOpen:()=>{this.Sw=!0;this.v4m();this.Xae&&this.Fha();m.App.oa.updateCommandUI();m.App.oa.m2a(Object(ia.a)(this,this.TOj,"updateIntelligentPlaceholderEntries"))},onClose:()=>{var jb=window.performance.now();this.hoa();this.Sw=!1;this.SJn();try{this.DM.sIg()}catch($a){Qa.recordQosError("NavPaneCloseActionFailure",
["NavPaneInteractionFailed"],$a)}this.fwf="";this.Hed=f.a.initial;m.App.oa.sjc(Object(ia.a)(this,this.TOj,"updateIntelligentPlaceholderEntries"));m.App.oa.updateCommandUI();jb=window.performance.now()-jb;V.a("NavigationPaneClose",!0,jb)},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,isModernPane:!0})}v4m(){this.w9e&&!this.v1a&&R.a.ar().then(()=>{this.v1a=new ka(this.Y1a);this.lg.Ea(this.v1a,this.v1a.annotationType);this.lg.getAnnotationsByType(this.v1a.annotationType).then(Ta=>{this.v1a.LNg(Ta)})})}SJn(){this.w9e&&
this.v1a&&(this.lg.kb(this.v1a,this.v1a.annotationType),this.v1a=null)}Suk(){this.YD.vQ(this.Vzl());this.YD.vQ(this.Xzl());this.YD.vQ(this.RBl());this.YD.vQ(this.tDl());this.YD.vQ(this.Iql());this.YD.vQ(this.onLinkExecute());this.YD.vQ(this.onPivotTabExecute());this.YD.vQ(this.AOl());this.YD.vQ(this.UBl());this.YD.vQ(this.DQl());this.YD.vQ(this.hDl());this.YD.vQ(this.oRl());this.YD.vQ(this.fMl())}oRl(){return Ta=>{Ta.autoDetectedHeadingsToggleDisabled=this.Y1a?!this.Y1a.RFk():!0}}DQl(){return Ta=>
{Ta.type=this.Epk}}onLinkExecute(){return Ta=>{Ta.onLinkExecute=()=>{this.DM.HJm()}}}onPivotTabExecute(){return Ta=>{Ta.onPivotTabExecute=jb=>{switch(jb){case w.a.headings:this.uCj();break;case w.a.replace:this.$Cj();break;case w.a.intelligentPlaceholder:this.GCj();break;default:this.oCj()}I.b(this.CZ)&&(this.CZ=this.Nxh(),this.CZ||(this.CZ=""),I.b(this.CZ)||(this.DM.onSearchQueryChanged(this.CZ),this.Mw()))}}}AOl(){return Ta=>{Ta.showOutOfSyncNotification=this.gOh}}UBl(){return Ta=>{Ta.headingsContent.headingsReady=
this.headingsReady}}Xzl(){return Ta=>{Ta.findSearchBoxContent={onSearchQueryChanged:jb=>{this.CZ=jb;this.Mw();this.DM.onSearchQueryChanged(jb)},findOptions:this.D1c,matchCase:this.Cea,matchWholeWord:this.Dea,findSearchText:this.CZ,onClearButtonExecute:()=>{void 0!==this.CZ&&null!==this.CZ&&""!==this.CZ&&(this.CZ="",this.Da.setSelection(null),this.DM.rDm())},onMatchCaseExecute:()=>{this.D1c.matchCase=!this.D1c.matchCase;this.Cea=!this.Cea;this.Mw();this.DM.bLm()},onMatchWholeWordExecute:()=>{this.D1c.matchWholeWord=
!this.D1c.matchWholeWord;this.Dea=!this.Dea;this.Mw();this.DM.cLm()},onMenuClose:()=>{if(this.m6)this.m6.onMenuClose()},onMenuOpen:()=>{if(this.m6)this.m6.onMenuOpen()}}}}Iql(){return Ta=>{Ta.activeTab=this.Ype}}hDl(){return Ta=>{Ta.autoDetectedHeadingsToggleState=this.Y1a?this.Y1a.xGf:!1;Ta.autoDetectedHeadingsToggleState||this.Y1a.IYd(!1)}}Vzl(){return Ta=>{const jb={onReplaceAllExecute:()=>{this.DM.gLm()},onReplaceExecute:()=>{this.DM.fLm()},onReplaceQueryChanged:$a=>{this.xsf=$a;this.Mw()},replaceSearchText:this.xsf};
Ta.findReplaceContent={searchResults:this.$Ea.toArray(),replaceSearchBoxContent:jb,onNextSearchResultExecute:()=>{this.DM.dLm()},onPrevSearchResultExecute:()=>{this.DM.eLm()},onSearchResultSelected:$a=>{const {FindReplaceUIManager:ya}=b(1460);this.DM.iFm($a);ya.g1i(1)},selectedResultId:this.Qtf,summaryLabel:this.fwf,explanationText:this.szl(this.Hed),haveTooManySearchResults:this.Hed===f.a.tooManyResults}}}szl(Ta){switch(Ta){case f.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;
case f.a.noMatchesFound:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;case f.a.replaceAllComplete:return xa.a.bDi();case f.a.tooManyResults:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;default:return""}}fMl(){return Ta=>{Ta.replaceFollowUpsWithCommentsIsEnabled=!0}}tDl(){return Ta=>{var jb=this.nL.trl();const $a=[];for(let ya of jb)jb=this.nL.Mve(ya.Ib,ya.id),$a.push({id:ya.id.toString(),intelligentPlaceholderAnchorText:jb});Ta.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:$a,
onIntelligentPlaceholderInputExecute:ya=>{this.CZ=ya;this.Sxb=w.a.find;this.Mw();this.DM.onSearchQueryChanged(ya)},onSearchResultSelected:ya=>{this.Mw();ya=c.a.qe(ya);this.nL.Xfn(ya)}}}}RBl(){return Ta=>{let jb=()=>{};this.Y1a&&(jb=Object(ia.a)(this.Y1a,this.Y1a.IYd,"toggleAutoDetectedHeadings"));Ta.headingsContent={onHeaderInputExecute:$a=>{this.CZ=$a;this.Sxb=w.a.find;this.Mw();V.a("NavigationPaneFind");this.DM.onSearchQueryChanged($a)},renderHeadingContent:($a,ya,wa)=>{setTimeout(()=>{var Fa=window.performance.now()-
this.Iee;this.G7d=ra.Y3k($a,ya,wa);this.Mw();const bb=window.performance.now()-this.Iee;V.a("NavigationPaneHeadingsLoaded",!0,bb);Fa=[Object.assign(new fb.a,{name:"HeadingFetchStart",double:Fa}),Object.assign(new fb.a,{name:"HeadingFetchFinished",double:bb})];V.a("NavigationPaneHeadingsLoadDetails",!0,void 0,Fa)},70)},autoDetectedHeadingsToggle:jb,onHeadingsUnmounted:()=>{this.headingsReady=!1}}}}cyj(Ta){this.Xae=Ta}Fha(){this.ib.wf(this.CTb);l.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}hoa(){if(this.jpb()){var Ta;
(Ta=va.InteractiveViewManager.instance.sc)?(Ta=Ta.qE,l.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):(Ta=this.ib.uI,l.ULS.sendTraceTag(40469192,312,50,"Taskpane now hidden with focus on default scope."));this.ib.wf(Ta)}}jpb(){return!!this.ib.Zd&&this.ib.Zd.name===this.CTb}static getInstance(){return Qa.al()}static al(){return new Qa(new Ba(u.AFrameworkApplication.pa),Object(ia.a)(Pa.getInstance(),Pa.getInstance().getSelectedText,"getSelectedText"),
ja.a.instance,H.a.instance,Ma.a.instance,Object(ia.a)(za.instance,za.instance.lHl,"getNextSearchResult"),t.a.instance.sa("Box4.NavigationPaneViewElementManager.INavigationPaneViewElementManager"),t.a.instance.sa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),t.a.instance.sa("Box4.AugmentationLoop.IAnnotationStorage"))}static recordQosError(Ta,jb,$a){var ya;if(null===(ya=u.AFrameworkApplication.K)||void 0===ya?0:ya.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneQosLogging",
!1))ya=Object.assign(new db.a,{extendedProperties:new Map,inStaging:!0}),$a&&ya.extendedProperties.set("exception",$a),T.Health.instance.recordQosError(Ta,jb,!1,!0,!1,!1,ya)}}Object(C.a)(Qa,"ReactFindReplacePane",J,[324,325,12]);var wb=b(1391);b.d(L,"FindReplaceUIManager",function(){return ib});class ib{constructor(Ta,jb,$a=null,ya=null,wa=null,Fa=null){this.X4d=this.d$=0;this.Dea=this.Cea=this.K0b=!1;this.an=this.LGh=this.Sua=null;this.jVa=this.mkf=!1;this.hh=Ta;this.jk=$a;this.x_b=ya;this.YDh=wa;
this.Ad=Fa;ib.bAc=new M}get Grg(){return this.mkf}set Grg(Ta){Ta!==this.mkf&&(this.mkf=Ta,this.$5h())}rYe(Ta){this.d$=Ta;this.update();this.d$||this.gK!==f.a.searchComplete&&this.gK!==f.a.tooManyResults?0<this.d$&&this.gK===f.a.noMatchesFound?this.mfa(f.a.searchComplete):this.d$>ib.CJj&&this.gK!==f.a.tooManyResults&&(l.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.mfa(f.a.tooManyResults)):this.mfa(f.a.noMatchesFound)}aXe(Ta){this.X4d=Ta;this.jVa&&this.update();this.YDh&&!this.YDh.value.$Qd&&
this.R_g()}reset(){}X1f(){this.Ad&&(this.an=this.Ad.Pe("UserAction","Find"));if(this.jVa||!this.gK)this.jVa=!1,l.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.mfa(f.a.searching)}rEc(){var Ta;this.jVa=!0;let jb=this.d$?f.a.searchComplete:f.a.noMatchesFound;if(this.gK!==f.a.tooManyResults&&k.FindManager.instance){const $a=k.FindManager.instance.Yj;0<$a.qua&&($a.qua>ib.CJj?jb=f.a.tooManyResults:this.LOn($a))}this.mfa(jb);this.update();this.an&&(this.an.stop(),this.an=null);ib.$tj=c.a.create().toString();
ib.g1i(0,this.IDb,this.J4a().length,this.d$);Object(wb.b)()&&(null===(Ta=this.hh)||void 0===Ta?0:Ta.isVisible)&&(Ta={},u.AFrameworkApplication.pa.ob(G.a.KOd,2,Ta),Ta[r.a.On]&&u.AFrameworkApplication.pa.ob(G.a.gBd,2,{CommandValueId:{query:this.J4a(),matchCase:this.Cea,matchWholeWordOnly:this.Dea,totalResultLimit:-1}}))}LOn(Ta){const jb=Ta.bTa;let $a=jb;const ya=[];do ya[ya.length]=$a,$a=Ta.$lb($a);while(jb!==$a);this.hh.TBf(ya);this.Sua&&this.hh.HWe(this.Sua)}update(){this.hh&&this.hh.tPn()}get gK(){return this.hh.gK}get IDb(){return this.hh.Ype}fNb(Ta){this.Grg=
Ta}$5h(){if(this.Grg)switch(this.gK){case f.a.searchComplete:case f.a.noMatchesFound:case f.a.tooManyResults:this.hh.CVd(!0)}else this.hh.CVd(!1)}mfa(Ta){if(this.hh.isVisible){switch(Ta){case f.a.noMatchesFound:case f.a.searchComplete:this.gK===f.a.tooManyResults&&(Ta=f.a.tooManyResults)}this.hh&&(this.hh.mfa(Ta),this.$5h());this.update();this.R_g()}}k4a(Ta,jb){const $a=this.jVa&&this.gK!==f.a.tooManyResults;switch(Ta){case 0:$a&&this.hh.TBf(jb);break;case 1:$a&&this.hh.Qnj(jb);break;case 4:$a&&this.hh.YPj(jb);
break;case 2:this.hh.Y6h();break;case 3:this.Sua=jb[0],$a&&0<this.d$&&this.hh.HWe(this.Sua)}}get matchCase(){return this.Cea}set matchCase(Ta){this.Cea!==Ta&&(this.Cea=Ta,this.COj())}get matchWholeWord(){return this.Dea}set matchWholeWord(Ta){this.Dea!==Ta&&(this.Dea=Ta,this.COj())}COj(){this.hh.y3e()}J4a(){return this.hh.J4a()}$9b(){return this.hh.$9b()}F0g(Ta){this.hh.F0g(Ta)}clearSearch(){this.hh.clearSearch()}get aDj(){return 0<this.d$&&this.gK!==f.a.replaceAllInProgress&&this.gK!==f.a.replaceAllComplete}Jin(Ta){let jb=
"";Ta?jb=0<this.d$?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.J4a(),this.$9b()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,this.J4a(),this.$9b()):Ta||0<this.d$&&(jb=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);this.R_g(jb)}dispose(){this.hh.dispose()}kwd(){return this.hh.kwd()}Cmn(Ta,jb=!0){Ta!==this.IDb&&(Ta===w.a.headings?(l.ULS.sendTraceTag(9056651,367,50,""),this.hh.uCj()):Ta===
w.a.find?this.hh.oCj():Ta===w.a.replace?this.hh.$Cj():Ta===w.a.intelligentPlaceholder&&(jb||this.hh.cyj(jb),this.hh.GCj()))}nt(Ta,jb=!0){this.hh.cyj(jb);Ta?(this.K0b||this.bkg(),this.hh.HV(),this.d$||this.gK===f.a.noMatchesFound?u.AFrameworkApplication.K&&u.AFrameworkApplication.K.ea("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.hh.mfa(f.a.searchComplete):this.mfa(f.a.initial)):this.hh.jAa()}bkg(){this.K0b||(this.hh.initialize(),this.K0b=!0)}R_g(Ta=""){var jb=this.rMl();jb&&(Ta=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,
Ta,jb));this.x_b&&jb&&this.Sua&&this.gK!==f.a.tooManyResults&&this.gK!==f.a.replaceAllInProgress&&(jb=this.x_b.Gpe(this.Sua),Ta=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Ta,jb.yPf));(jb=this.rzl())&&(Ta=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Ta,jb));this.jk&&Ta&&this.LGh!==Ta&&(this.LGh=Ta,this.jk.sendNotification(Ta,!0))}rMl(){let Ta="";switch(this.gK){case f.a.startSearch:Ta=WordEditorIntl.WordEditorStrings.l_SummarySearching;
break;case f.a.searchComplete:Ta=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.X4d,this.d$);break;case f.a.tooManyResults:this.jVa&&(Ta=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.X4d,this.d$));break;case f.a.noMatchesFound:Ta=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case f.a.replaceAllInProgress:Ta=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;case f.a.replaceAllComplete:Ta=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return Ta}rzl(){let Ta=
"";switch(this.gK){case f.a.initial:Ta=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,this.Qzl());break;case f.a.noMatchesFound:Ta=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;break;case f.a.replaceAllComplete:Ta=xa.a.bDi();break;case f.a.tooManyResults:Ta=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return Ta}Qzl(){let Ta="";this.Cea&&this.Dea?Ta=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,
WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.Cea?Ta=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchCase):this.Dea&&(Ta=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return Ta}static getInstance(Ta){return ib.al(Ta)}static al(Ta){const jb=Qa.getInstance();return new ib(jb,Ta,t.a.instance.resolve("Common.Utils.IAriaNotifier"),
H.a.instance,new x.a(()=>k.FindManager.instance.xjc),m.App.oa.Np)}static g1i(Ta,jb=-1,$a=-1,ya=-1){l.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:Ta,["SearchComplete.ResultsCount"]:ya,["SearchOpsCorrelation"]:ib.$tj,["ActionId"]:ib.bAc.actionId,["SourceControlId"]:ib.bAc.cLa,["IsNavPanOpenedAlready"]:ib.bAc.Jcm,["IsSearchFromNavPane"]:ib.bAc.bfm,["CurrentTab"]:jb,["QueryLength"]:$a})}static WLk(Ta,jb,$a){jb=void 0!==jb&&null!==jb?void 0===jb.SourceControlId||null===jb.SourceControlId?"Unknown":
jb.SourceControlId:Ta===D.a.TNb?"FindKeyboardShorcut":Ta===D.a.WNb?"ReplaceKeyboardShorcut":"Unknown";switch(Ta){case D.a.eTc:Ta="ShowHeadingsPane";break;case D.a.TNb:Ta="ShowFindPane";break;case D.a.WNb:Ta="ShowReplacePane";break;case D.a.hTc:Ta="ShowIntelligentPlaceholderPane";break;case D.a.$ub:Ta="ToggleNavigationPane";break;default:Ta="Unknown"}ib.bAc=new M(Ta,jb,$a,!0)}}ib.CJj=100;ib.$tj=null;ib.bAc=null;Object(C.a)(ib,"FindReplaceUIManager",null,[277,278,12])},1461:function(C,L,b){b.r(L);C=
b(0);var f=b(92),c=b(69),u=b(2),r=b(151),t=b(23),k=b(53),m=b(958),l=b(125),x=b(12),w=b(8),G=b(41),D=b(20),H=b(368),M=b(461),J=b(1356),F=b(1633),A=b(59),N=b(287),B=b(7),E=b(436),P=b(273),T=b(19),V=b(49),I=b(504),R=b(1520);class ba{constructor(Qa,wb,ib,Ta,jb,$a,ya){this.yGh=this.hKh=this.exh=this.VO=this.Mwb=this.Ypc=this.yff=this.Vbf=this.hdf=this.d2=this.wFa=this.LFa=null;this.ib=Qa;this.ga=Ta;this.ag=jb;this.Cc=$a;this.Da=ya;this.gPa=ib;this.zfa=document.createElement("div");this.zfa.classList.add("FootnoteEndnoteActionBarControl");
this.zfa.style.zIndex=String(P.a.LYf);this.zfa.style.position="relative";this.l0c=document.createElement("div");this.l0c.classList.add("FootnoteEndnoteActionBarControlDividerElement");this.zfa.appendChild(this.l0c);this.JZk();this.zfa.appendChild(this.Ypc);this.zfa.appendChild(this.Mwb);this.d6=f.KeyInputManager.$a(c.a.G5,0);this.t3l();this.s3l()}nra(Qa){w.ULS.shipAssertTag(4520065,308,this.gPa.OAa(Qa));this.VO!==Qa&&(this.VO=Qa,this.n3e(),Qa=this.gPa.EHb(this.VO),this.Y0k(Qa),this.VO.qWh(Object(G.a)(this,
this.n3e,"updateActionBarControl")),Qa?(this.wFa.title=WordEditorIntl.WordEditorStrings.L_NextFootnote,this.LFa.title=WordEditorIntl.WordEditorStrings.L_PrevFootnote):(this.wFa.title=WordEditorIntl.WordEditorStrings.L_NextEndnote,this.LFa.title=WordEditorIntl.WordEditorStrings.L_PrevEndnote),this.qXa())}n3e(){const Qa=this.gPa.pud(this.VO),wb=this.gPa.LAl(this.VO);this.Vbf.innerText=Qa.toString();this.yff.innerText=wb.toString();F.a.OMb(this.LFa,1===Qa?!1:!0);F.a.OMb(this.wFa,Qa===wb?!1:!0)}F6b(){this.VO&&
(this.d2&&this.d2.parentNode===this.Ypc&&this.Ypc.removeChild(this.d2),this.tua(),this.VO.R7m(Object(G.a)(this,this.n3e,"updateActionBarControl")),this.VO=null)}dispose(){this.ib.Kc(H.a.$kb).zq(this.d6)}Y0k(Qa){3===this.ga.mode&&(Qa=Qa?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.d2=this.sQf("FootnoteEndnoteFormattingOptionButton","FootnoteEndnoteActionBarFormattingButton",Qa,null),A.a.Qq(this.d2,A.a.Vka,Qa),this.Ypc.appendChild(this.d2))}zkn(){const Qa=
this.ib.getRegion(H.a.$kb);let wb;if(this.wFa.disabled)if(this.LFa.disabled)if(this.d2&&!this.d2.disabled)wb=this.d2;else return;else wb=this.LFa;else wb=this.wFa;wb.focus();Qa.Tf.ou(wb)}JZk(){this.Ypc=document.createElement("div");this.Ypc.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");this.Mwb=document.createElement("div");this.Mwb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarRightDiv");this.LFa=this.sQf("FootnoteEndnotePreviousButton",
"FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");this.Mwb.appendChild(this.LFa);this.Vbf=E.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");this.Mwb.appendChild(this.Vbf);this.hdf=E.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.hdf.innerText=" / ";this.Mwb.appendChild(this.hdf);this.yff=E.b("span","FootnoteEndnoteActionBarTotalCount","FootnoteEndnoteActionBar");this.Mwb.appendChild(this.yff);this.wFa=this.sQf("FootnoteEndnoteNextButton",
"FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");this.Mwb.appendChild(this.wFa)}sQf(Qa,wb,ib,Ta){Qa=F.a.Sib(Qa,wb,ib,Ta,void 0===Ta||null===Ta);Qa.setAttribute(A.a.ig,A.a.l3);return Qa}t3l(){const Qa=this.ib.Kc(H.a.$kb);Qa.parent=l.AppFrame.hp;Qa.bindAction(this.d6,D.a.fra);Qa.naa(Object(G.a)(this,this.zkn,"setFocusOnEnabledButton"))}s3l(){var Qa=new N.DOMFocusListing(()=>this.zfa);Qa.Una=!1;Qa.Ln(2);Qa.Ln(1);Qa=this.ib.ple(this.zfa,this.ib.Kc(H.a.$kb),Qa);Qa.wKa();Qa.MS=!0}qXa(){this.d2&&
(this.ag.Ea(B.a.click,this.d2,Object(G.a)(this,this.BMf,"clickFormattingOptionsButtonEvent")),this.exh=this.Cc.bsb(this.d2,Object(G.a)(this,this.BMf,"clickFormattingOptionsButtonEvent"),c.a.Ms));this.ag.Ea(B.a.click,this.LFa,Object(G.a)(this,this.DMf,"clickPrevButtonEvent"));this.hKh=this.Cc.bsb(this.LFa,Object(G.a)(this,this.DMf,"clickPrevButtonEvent"),c.a.Ms);this.ag.Ea(B.a.click,this.wFa,Object(G.a)(this,this.CMf,"clickNextButtonEvent"));this.yGh=this.Cc.bsb(this.wFa,Object(G.a)(this,this.CMf,
"clickNextButtonEvent"),c.a.Ms);this.Da.dE(Object(G.a)(this,this.wCa,"processSetSelectionFinished"))}tua(){this.d2&&(this.ag.kb(B.a.click,this.d2,Object(G.a)(this,this.BMf,"clickFormattingOptionsButtonEvent")),this.Cc.yvb(this.d2,this.exh));this.ag.kb(B.a.click,this.LFa,Object(G.a)(this,this.DMf,"clickPrevButtonEvent"));this.Cc.yvb(this.LFa,this.hKh);this.ag.kb(B.a.click,this.wFa,Object(G.a)(this,this.CMf,"clickNextButtonEvent"));this.Cc.yvb(this.wFa,this.yGh);this.Da.Vna(Object(G.a)(this,this.wCa,
"processSetSelectionFinished"))}wCa(Qa,wb){(Qa=wb.zi.Ba)&&this.d2&&F.a.OMb(this.d2,T.SelectionEditor.qj(Qa)?!0:!1)}CMf(){if(!this.wFa.disabled){const Qa=this.gPa.EHb(this.VO)?D.a.zDg:D.a.yDg;this.ga.processAction(Qa,2)}return!0}DMf(){if(!this.LFa.disabled){const Qa=this.gPa.EHb(this.VO)?D.a.BDg:D.a.ADg;this.ga.processAction(Qa,2)}return!0}BMf(){this.d2&&!this.d2.disabled&&this.ga.processAction(D.a.bXi,2);return!0}static GAl(){return ba.HAl()}static HAl(){return new ba(k.FocusManager.instance(),R.a.instance,
I.a.instance,u.AFrameworkApplication.pa,x.App.oa.Qu,x.App.oa.oB,V.a.instance)}}Object(C.a)(ba,"FootnoteEndnoteActionBarControl",null,[352]);var ha=b(238),na=b(13),da=b(1407),ia=b(1599);class ma{constructor(Qa,wb,ib,Ta,jb,$a,ya,wa,Fa,bb,Eb,hb){this.hI=null;this.GZ=!1;this.Bg=this.iy=null;this.rvc=Qa;this.xDc=wb;this.jXc=ib;this.Mhk=Ta;this.Zof=jb;this.Kl=$a;this.Lyb=ya;this.ag=wa;this.TIh=Fa;this.z7j=Eb;this.Ym=this.rvc.ownerDocument.createElement("div");this.Ym.id="FootnoteEndnoteControlOverlay";
this.Ym.className="EditingSurfaceOverlay";this.JM=this.fwl();this.E8(!1);this.rvc.appendChild(this.Ym);this.rvc.appendChild(this.JM);this.xDc.bind();this.$d=null;this.ga=hb;this.f0a=bb}Man(){const Qa=this.TIh();Qa&&Qa.gj&&(Qa.aoa=0,Qa.XBb())}DNj(Qa){if(this.Zhd){const wb=this.Zhd.uza;wb&&(wb.Oog=Qa)}}get $L(){return this.GZ}get Zhd(){return this.hI}get dialog(){return this.$d}get wm(){return this.Bg||(this.Bg=t.a.instance.Ca("Common.IZoomManager"))}jRf(){this.$d=ia.a.PAl()}xRd(){this.$d=null}show(Qa=
!0){this.GZ||(this.DNj(!0),this.z7j(),this.E8(!0),this.jC(),Qa&&this.setFocus())}setFocus(){this.GZ&&(this.xDc.setInitialSelection(),this.Mhk())}update(){this.GZ&&(this.hI.isConnected?this.jXc.n3e():this.dismiss())}dismiss(Qa=!1,wb=!1){this.GZ&&(this.DNj(!1),this.jia(),this.Man(),this.E8(!1),this.Zof(wb),this.$d&&(this.ga.processAction(na.a.E3a,2),this.$d=null),!Qa&&this.hI&&this.hI.isConnected&&this.f0a.Wfn(this.hI),this.F6b())}M$m(Qa){const wb=null!==this.wm.instance?this.wm.instance.Ei:1;this.JM.style.width=
Qa.o$h*wb+"px";this.iy.style.width=Qa.hmd*wb+"px";this.JM.style.marginLeft=Qa.jBc*wb+"px";this.Kl?this.iy.style.marginRight=Qa.qPf*wb+"px":this.iy.style.marginLeft=Qa.xBc*wb+"px";if(Qa=this.TIh())Qa=Qa.Xv,this.JM.style.bottom=Qa.offsetHeight-Qa.clientHeight+"px"}nra(Qa){w.ULS.shipAssertTag(4520073,308,this.Lyb.OAa(Qa));this.hI!==Qa&&(this.hI=Qa,this.xDc.nra(Qa),this.jXc.nra(this.hI))}dispose(){this.dismiss();this.xDc.dispose();this.jXc.dispose()}jC(){this.ag&&this.ag.Ea(B.a.click,this.Ym,Object(G.a)(this,
this.onClick,"onClick"))}jia(){this.ag&&this.ag.kb(B.a.click,this.Ym,Object(G.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss(!1,!0);return!0}fwl(){let Qa;Qa=document.createElement("div");Qa.classList.add("FootnoteEndnoteControl");this.iy=document.createElement("div");this.iy.classList.add("FootnoteEndnoteContent");this.iy.appendChild(this.xDc.zfa);this.iy.appendChild(this.jXc.zfa);Qa.appendChild(this.iy);return Qa}E8(Qa){Qa=(this.GZ=Qa)?"":"none";this.Ym.style.display=Qa;this.JM.style.display=
Qa}F6b(){this.hI&&(this.xDc.F6b(),this.jXc.F6b(),this.hI=null)}static Hye(){const Qa=x.App.oa.za.Rb;return Qa&&Qa.gj?Qa:null}static KAl(Qa,wb,ib,Ta,jb){return new ma(Qa,wb,ib,Ta,jb,u.AFrameworkApplication.isRtl,I.a.instance,ha.a.instance,ma.Hye,da.a.instance,ma.Xal,u.AFrameworkApplication.pa)}static Xal(){u.AFrameworkApplication.pa.ob(na.a.cnb,2,!0)}}Object(C.a)(ma,"FootnoteEndnoteControl",null,[351]);var qa=b(735),ka=b(5),va=b(205),ja=b(40),Ma=b(10),Ha=b(24),X=b(86),W=b(1519),fa=b(381),ra=b(860),
Aa=b(537),Ba=b(1260),ta=b(77),xa=b(244);class za extends fa.a{constructor(Qa,wb,ib,Ta,jb,$a,ya,wa,Fa,bb,Eb,hb,nb,Pb,bc,gb){super(H.a.ura,ib,Ta,jb,ya,wa,Fa,bb,Eb,hb,nb,Pb,bc,gb);this.Zrh=Qa;this.Veb=$a;this.Veb.XXd=this;wb(this);this.features.o0e=!0}get Mog(){return!0}gxd(){const Qa=this.Zrh.s4f(this);return ra.ViewReference.QB(Qa)}hpd(Qa){Object(xa.a)(za,Qa)||this.Zrh.cXf()}lmb(){return Aa.a.DAg}onResize(){super.onResize();this.Veb.$ki()}fz(Qa,wb=null){super.fz(Qa,wb);this.Veb.Mki(this.xc.Bf)}detach(){this.Veb.Zki();
super.detach()}ksd(){this.onResize()}static Y6(){const {FootnoteEndnoteControlManager:Qa}=b(1461);return new za(Qa.instance,Ba.a.JOf,x.App.oa.za,ta.InteractiveViewManager.instance,()=>t.a.instance.resolve("Box4.IUndoManager"),t.a.instance.resolve("WordEditor.SectionAlignedViewRepositioner"),u.AFrameworkApplication.pa,t.a.instance.resolve("Box4.IHtmlViewRootFactory"),t.a.instance.resolve("Box4.IInteractiveEventNotifier"),t.a.instance.Ca("Box4.ITextMetricsAdapter"),t.a.instance.resolve("Box4.IRotatingCoordinateConverter"),
t.a.instance.sa("Box4.IContentControlViewElementManager"),t.a.instance.sa("Box4.CpConversionManagerImpl"),t.a.instance.sa("Box4.ContentControlConfigSettings"),t.a.instance.sa("Box4.IContentControlReader"),t.a.instance.sa("Box4.IContentControlBoundaryNavigator"))}}Object(C.a)(za,"FootnoteEndnoteEditView",fa.a,[]);class la{constructor(Qa,wb,ib,Ta=!1){this.LTb=null;this.fjf=this.Aph=!1;this.jk=null;this.ib=Qa;this.gPa=wb;this.jpa=ib();this.Q8d=Ta;this.zfa=document.createElement("div");this.zfa.classList.add("FootnoteEndnoteEditControl");
this.l0c=document.createElement("div");this.l0c.classList.add("FootnoteEndnoteEditControlDividerElement");this.K1b=(new qa.a(this.zfa,"WACViewPanel_FootnoteEndnoteEditControl")).sC;this.zfa.appendChild(this.l0c);this.zfa.appendChild(this.K1b)}get Au(){return this.jk||(this.jk=t.a.instance.resolve("Common.Utils.IAriaNotifier"))}nra(Qa){w.ULS.shipAssertTag(4520077,308,this.gPa.OAa(Qa));this.LTb!==Qa&&(this.LTb=Qa,this.kGf(this.LTb),this.fjf=this.gPa.EHb(this.LTb),this.Q8d?(this.jpa.ttb(A.a.Khd),this.ib.Kc(H.a.ura).maa(Object(G.a)(this,
this.gol,"footnoteEndnoteOnFocus"))):this.jpa.q0g(this.fjf?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,A.a.Khd))}gol(){const Qa=String.format("{0} {1}",this.fjf?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,
WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);this.Au.sendNotification(Qa,!0)}F6b(){const Qa=I.a.instance.EHb(this.LTb)?"Footnote":"Endnote";w.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:Qa,["CalloutHeight"]:this.zfa.scrollHeight});this.RDb();this.LTb=null}bind(){this.Aph||(this.jpa.Mhb(this.K1b),this.Aph=!0)}setInitialSelection(){const Qa=this.VNl();Qa?this.jpa.setSelection(Qa):this.jpa.qlc()}dispose(){this.RDb()}kGf(Qa){this.RDb();this.jpa.fz(Qa,Qa.Bf)}RDb(){this.jpa.detach()}VNl(){let Qa=
0;var wb=null,ib=ka.GraphIterator.ua(this.LTb);va.OutlineNavigator.M4(ib);if((ib=ja.OutlineElementNavigator.Sd(ib))&&Ma.ParagraphReader.nb(ib)){if(wb=la.ZDl(ib)){Qa=wb.Wa.cp+1;wb=W.FootnoteEndnoteDefaultContentInserter.cfi;const Ta=wb.length;Qa+Ta<=Ma.ParagraphReader.textLength(ib)&&ib.characterData.substr(Qa,Ta)===wb&&(Qa+=Ta)}wb=Ha.SelectionFactory.Pc(ib,Qa)}return wb}static MAl(){return la.NAl()}static NAl(){return new la(k.FocusManager.instance(),I.a.instance,()=>za.Y6(),u.AFrameworkApplication.K.ea("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static ZDl(Qa){Qa=
X.i(Qa,10);return 0<Qa.length?Qa[Qa.length-1]:null}}Object(C.a)(la,"FootnoteEndnoteEditControl",null,[350]);var Sa=b(1026);class Pa{constructor(Qa,wb){this.aPa=Qa;this.Kl=wb}OGc(Qa,wb){Qa=this.aPa.OGc(Qa);var ib=wb.clientWidth;const Ta=wb.scrollLeft,jb=Qa.o$h;let $a=Qa.jBc,ya=Qa.jBc,wa=Pa.vAg,Fa=Pa.wAg,bb=jb,Eb=Qa.hmd;this.Kl?Fa=Qa.qPf-ya:wa=Qa.xBc-$a;ib<jb&&($a=Math.max($a-Ta,0),bb=ib-$a,this.Kl?(ib=wb.scrollWidth-Ta-ib,ya=wb.scrollWidth-Qa.jBc-jb,Fa=Math.max(Qa.qPf-ib-ya,Pa.wAg),Eb=bb-Fa-Pa.vAg):
(wa=Math.max(Qa.xBc-Ta-$a,Pa.vAg),Eb=bb-wa-Pa.wAg));return new Sa.a($a,bb,wa,Fa,Eb)}}Pa.vAg=25;Pa.wAg=50;Object(C.a)(Pa,"FootnoteEndnoteViewPositionProvider",null,[]);class fb{constructor(Qa,wb=0,ib=0){this.clientWidth=Qa;this.scrollLeft=wb;this.scrollWidth=ib?ib:Qa}}Object(C.a)(fb,"PageViewScrollContainerSizeInfo",null,[]);b.d(L,"FootnoteEndnoteControlManager",function(){return db});class db{constructor(Qa,wb,ib,Ta,jb,$a,ya,wa){this.rJ=null;this.ib=Qa;this.Bq=wb;this.q$j=ib;this.r$j=Ta;this.p$j=
jb;this.aPa=$a;this.cFa=ya;this.wA=wa;this.d6=f.KeyInputManager.$a(c.a.G5,0);this.Mjg();this.CR()}get control(){return this.rJ}get dialog(){return this.control.dialog}get qQi(){return this.control.$L}jRf(){this.control.jRf()}xRd(){this.control.xRd()}bind(Qa){this.iXk(Qa)}l5g(Qa){if(this.control.Zhd!==Qa.Jib)this.control.dismiss();else if(this.qQi)return;this.$Cc();this.control.nra(Qa.Jib);this.control.show(Qa.RYe)}$Cc(){if(this.wA){const Qa=new m.a(!0);this.wA.iXa(Qa)}}l5(){this.control.setFocus()}u_d(){this.control.update()}cXf(Qa,
wb=!1){this.$Cc();this.control.dismiss(Qa,wb)}K$m(Qa){const wb=db.Hye().Xv;Qa=this.aPa.OGc(Qa,new fb(wb.clientWidth,wb.scrollLeft,wb.scrollWidth));this.control.M$m(Qa)}dispose(){this.control.dispose();this.ib.Kc(H.a.ura).zq(this.d6)}s4f(Qa){w.ULS.shipAssertTag(4520074,308,!!this.control);w.ULS.shipAssertTag(4520075,308,!!this.control.Zhd);return this.t4f(this.control.Zhd.id,Qa)}iXk(Qa){const wb=this.r$j(),ib=this.p$j();this.rJ=this.q$j(Qa,wb,ib,Object(G.a)(this,this.Fha,"setFocusScopeForShow"),Object(G.a)(this,
this.Hkn,"setFocusScopeForDismiss"))}Mjg(){const Qa=this.ib.Kc(H.a.ura);Qa.parent=3===u.AFrameworkApplication.pa.mode?l.AppFrame.lE:l.AppFrame.ALb;this.ib.aie(H.a.ura);Qa.bindAction(this.d6,D.a.fra)}CR(){this.Bq.CR(H.a.ura);this.Bq.CR(H.a.$kb)}Fha(){this.Bq.bE(H.a.ura);this.Bq.bE(H.a.$kb);this.Bq.gx(r.AFrame.ao);this.ib.Wxc(H.a.ura);this.ib.wf(H.a.ura)}Hkn(Qa){this.Bq.gx(H.a.ura);this.Bq.gx(H.a.$kb);this.Bq.bE(r.AFrame.ao);this.ib.wCc(H.a.ura);(Qa||this.ib.Zd&&(this.ib.Zd.name===H.a.ura||this.ib.Zd.name===
H.a.$kb))&&this.ib.wf(r.AFrame.ao)}t4f(Qa,wb){return()=>{const ib=db.Hye().xc.Ib.Ta(Qa);this.cFa.TDc();if(!ib.isConnected)return w.ULS.sendTraceTag(4520076,308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),null;this.l5g(new M.a(ib,!0));return wb}}static al(){const Qa=new Pa(t.a.instance.resolve("Box4.SectionAlignedViewPositionProvider"),u.AFrameworkApplication.isRtl);return new db(k.FocusManager.instance(),x.App.oa.rn,ma.KAl,la.MAl,ba.GAl,Qa,J.a.instance,t.a.instance.resolve("Box4.IPasteFloatieEventSource"),
t.a.instance.resolve("Common.IAppSettingsManager"))}static Hye(){const Qa=x.App.oa.za.Rb;return Qa&&Qa.gj?Qa:null}static get instance(){return db.na||(db.na=db.al())}}db.na=null;Object(C.a)(db,"FootnoteEndnoteControlManager",null,[330])},1484:function(C,L,b){b.d(L,"a",function(){return c});C=b(0);var f=b(62);class c{static get Zc(){return c.ka||(c.ka=new f.a)}static oyk(u){c.Zc.addHandler(c.Y8i,u)}static Lyk(u){c.Zc.addHandler(c.P$i,u)}}c.Y8i="OnCopyComment";c.P$i="OnPasteComment";c.ka=null;Object(C.a)(c,
"CommentEventsManager",null,[])},1485:function(C,L,b){b.d(L,"a",function(){return c});b.d(L,"b",function(){return u});b.d(L,"c",function(){return r});var f=b(2);const c=(t,k)=>{const m=RegExp("mailto:(.*)").exec(t.url);k.email=m&&2===m.length?m[1]:t.url;k.resolveState=t.Xs.charAt(35)===b(1586).ACommentFormatTranslator.nFk?1:0},u=(t,k)=>{k.contentId=t.Xs},r=(t,k,m)=>{k.contentId=t.Xs;k.isCurrentUser=m.email===f.AFrameworkApplication.K.Ga("UserPrincipalName")}},1513:function(C,L,b){b.d(L,"a",function(){return c});
C=b(0);L=b(154);var f=b(104);class c extends L.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new f.a,{T_:c.getTypeName(),B_:c.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(C.a)(c,"DocumentTypeClassifierAnnotation",L.a,[])},1516:function(C,L,b){b.d(L,"a",function(){return l});C=b(0);var f=b(2),c=b(79),u=b(8),r=b(41),t=b(90),k=b(68),m=b(594);
class l{constructor(x,w,G,D,H,M){this.uqf=null;this.bKh=0;this.Bc=D;this.rd=w;this.Xda=H;this.phf=G;this.ZYc=f.AFrameworkApplication.fZe();this.jaf=x.appSettings.ChromeClipboardAccessOperationTimeout;this.OM=0;this.b5j=M;this.N8j=x.ea("EnableExternalPasteSupportOnMobileIsEnabled")}get I7a(){return this.Xda.I7a}process(x,w){if(!this.OM)return this.IPm(w);if(1===this.OM)return this.prepareForPaste(x,w);if(2===this.OM)return this.OM=3,this.uqf(x,w);3===this.OM&&this.Xda.Kyj(x,w);return!1}IPm(x){let w=
!0;this.N8j&&(w=!(x.aE&1));this.rd.v4&&w||x.aE&512?(this.uqf=x.aE&2?Object(r.a)(this.Xda,this.Xda.paste,"paste"):Object(r.a)(this.Xda,this.Xda.Xdj,"pasteInternal"),this.OM=2):(this.ZYc?(this.OM=1,this.bKh=Date.now()):this.OM=2,this.uqf=Object(r.a)(this.Xda,this.Xda.paste,"paste"));m.a.Fpm(x);return!0}prepareForPaste(x,w){x=!0;if(this.phf.value.Kfj())this.OM=2;else{const G=Date.now()-this.bKh;G>this.jaf&&(u.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",G),this.Bc.mb(t.a.Yaa,{["Reason"]:k.a.tKg}),
w.OY&&(w.OY.fail("Prepare for paste timed out",!1),c.Health.instance.recordQosError("PreparePasteTimedOut",[m.a.EQe],!1,!0,!0,!1,null)),w.failed=!0,x=!1,this.b5j.cbn())}return x}}Object(C.a)(l,"ClipboardOperationPasteProcessor",null,[498])},1517:function(C,L,b){b.d(L,"a",function(){return P});C=b(0);L=b(222);var f=b(2),c=b(79),u=b(57),r=b(127),t=b(8),k=b(244),m=b(70),l=b(1775),x=b(41),w=b(18),G=b(3),D=b(90),H=b(68),M=b(960),J=b(19),F=b(49),A=b(1434),N=b(1518),B=b(594),E=b(236);class P extends L.a{constructor(T,
V,I,R,ba,ha,na,da,ia,ma,qa,ka,va,ja,Ma,Ha,X,W,fa,ra,Aa,Ba,ta,xa,za,la,Sa,Pa=!0){super();this.jva=this.tF=null;this.KQ=this.GC=0;this.eBb=this.Stf=this.Qja=this.oc=null;this.k2=!1;this.TZ=!0;this.vyh=!1;this.init(T);this.Pj("ClipboardOperation");this.AIa(ia,V,ba,ha,na);this.Bc=ma;this.ud=qa;this.rd=ka;this.Nb=va;this.Yqh=ja;this.$qh=Ma;this.Zqh=Ha;this.waf=X;this.Uqc=W;this.xaf=fa;this.ZYc=da;this.NYc=ra;this.G1a=Aa;this.vrk=Pa;this.zt=Ba;this.Eb=ta;this.Gj=xa;this.wA=za;this._context=R;this.W$=la;
this.Cwc=Sa;na&&Object(k.a)(90,na)&&(this.Qja=Object(m.a)(503,na.fa(r.a.pya,null)));this.Qja||(this.Qja=this.W$.NWd());this.aQb=void 0===I||null===I?"NotAvailable":Object(l.a)(N.a,I);this.Qja.ECk(this.aQb.split(", "));T=this._context;if(this.Cwc){if(!P.m4h(T,this.waf,this.Bc,this.Qja,Pa)){this.Zl=8;this.finish();return}this.oc=T.view;this.k2=3===this.oc.x6a;this.GC=0;this.KQ=I;this.eBb=X.I7a}else{if(!T.view.Yd){this.Bc.mb(D.a.af,{["Reason"]:H.a.Bqb});this.Qja.fail("Not in interactive view",!0);this.Zl=
8;this.finish();return}this.oc=T.view;if(!this.oc.Oa){this.Bc.mb(D.a.af,{["Reason"]:H.a.noSelection});this.Qja.fail("No selection manager",!0);this.Zl=8;this.finish();return}this.k2=3===this.oc.x6a;this.GC=0;this.KQ=I;this.eBb=X.I7a;if(Pa&&!(this.eBb&&this.eBb.Ba&&this.eBb.length)){this.Bc.mb(D.a.af,{["Reason"]:H.a.noSelection});this.Qja.fail("No selection when one required",!0);this.Zl=8;this.finish();return}}X=J.SelectionEditor.qj(this.eBb.Ba);X=!(this.KQ&16&&X);X=fa.Q8l(I,this.Ag)&&X;1!==this.behavior&&
X||(X||this.Qja.fail("Clipboard operation disabled for selection",!0),this.Zl=X?32:8,this.b1());!this.vyh&&this.rd.tg&&(u.b("IPadCCP"),this.vyh=!0)}get Ag(){this.Stf||(this.Stf=F.a.Xzc(this.eBb));return this.Stf}IH(){super.IH();this.eBb=null}run(){this.GC||this.setup();1===this.GC&&this.process();2===this.GC&&this.teardownSync();3===this.GC&&this.teardownAsync();4===this.GC&&this.finish()}setup(){if(this.KQ&256&&this.ZYc){this.fx||this.Uqc.eRk(this,this.KQ,this.aQb);this.fx.run();if(this.fx.inProgress)return;
this.TZ=this.fx.S4;this.AAc();if(!this.TZ){this.Qja.fail("No access to system clipboard",!0);this.Zl=8;this.GC=4;this.pKe();return}}else t.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",this.KQ,this.aQb,this.rd.qI,this.actionId);this.KQ&32&&!this.ud.Jbc(this.oc.Oa.Ag)?(t.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.Bc.mb(D.a.af,{["Reason"]:H.a.Und}),this.Qja.fail("Cut not allowed",!0),this.NYc.show(),this.Zl=8,this.GC=4):(this.KQ&16||this.KQ&32)&&
w.a.instance.J(3)&&this.zt.aHe(this.oc.Oa.ya.Ba)?(this.Qja.fail("Selected content deleted in coauthoring",!0),this.Eb.lmc(),this.Zl=8,this.GC=4):(this.KQ&4096&&(this.wA.zTe(Object.assign(new M.a,{Cog:!0,Q0:this.aQb})),this.Gj.undo()),this.xaf.ZSm(this.KQ),!this.oc.xc&&f.AFrameworkApplication.K&&f.AFrameworkApplication.K.ea("WordEditorPasteFailuresImprovementIsEnabled")?(this.Qja.fail("Interactive view has null target node",!0),this.Zl=8,this.GC=4):(this.tF=this.Nb.Wb(15),this.tF.om=this.actionId,
this.tF.Sa(this.oc.xc),this.GC=1))}process(){if(!this.fx){t.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.KQ,this.aQb,this.rd.qI);t.ULS.shipAssertTag(6305507,307,!this.jva);this.jva=new A.a(this._context,this.KQ,this.Qja,this.pO,this.Ru,void 0,this.rd.qI,this.vrk,this.k2);let T;T=this.KQ&65536?Object(x.a)(this.Yqh,this.Yqh.process,"process"):this.KQ&64?Object(x.a)(this.$qh,this.$qh.process,"process"):this.KQ&1?Object(x.a)(this.waf,this.waf.process,"process"):
Object(x.a)(this.Zqh,this.Zqh.process,"process");this.KQ&16&&this.oc.Oa.$ha.t3f();this.G1a.create(this,T,this.jva).Pj("ClipboardAction")}t.ULS.shipAssertTag(6305536,307,!!this.fx);this.fx.run();this.fx.inProgress||(this.AAc(),this.GC=this.Ce?2:3)}teardownSync(){this.jva.BKc&&(this.tF.om=G.a.typing);this.jva.jcc&&this.tF.AJa(this.jva.Wig,this.jva.hFg);this.tF.dispose();this.Zl=this.jva.failed?8:32;this.GC=4}teardownAsync(){if(this.fx){if(this.fx.run(),this.fx.inProgress)return}else if(this.jva.BKc&&
(this.tF.om=G.a.typing),this.tF.Bha(this),this.jva.jcc&&this.tF.AJa(this.jva.Wig,this.jva.hFg),this.tF.dispose(),this.Yxc)return;this.Zl=this.jva.failed?8:32;this.GC=4}finish(){this.wA.zTe(Object.assign(new M.a,{Cog:!1}));this.b1();32===this.response?t.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.KQ,this.aQb,this.rd.qI):t.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",
+this.endTime-+this.startTime,this.KQ,this.aQb,this.rd.qI);this.W$.Uaa(this.Qja);P.L_m&&this.Imm()}pKe(){const T=!!(this.KQ&1),V=this._context.view;V&&B.a.pKe(T,V.Oa,this.rd.qI)}Imm(){if(!(this.KQ&4||this.KQ&64)){var T=new Map;T.set("isCopy",String.format("{0}",!!(this.KQ&16)));T.set("isIPad",String.format("{0}",this.rd.tg));c.Health.instance.recordKpiUsage(B.a.q5h,0,B.a.QKf,T);this.TZ||(T=Object.assign(new E.a,{extendedProperties:T}),c.Health.instance.recordKpiFailure(B.a.q5h,B.a.SOk,!0,!0,T))}}static get L_m(){null==
P.hsf&&(P.hsf=!!f.AFrameworkApplication.K&&f.AFrameworkApplication.K.ea("RecordCcpErrorDialogKpiIsEnabled"));return P.hsf}static LRg(T,V,I,R){T&&T.mb(D.a.af,{["Reason"]:I});V&&V.fail(R,!0)}static m4h(T,V,I=null,R=null,ba=!0){return T.view.Yd?T.view.Oa?!ba||V.I7a&&V.I7a.Ba&&V.I7a.length?!0:(P.LRg(I,R,H.a.noSelection,"Paste target is invalid"),!1):(P.LRg(I,R,H.a.noSelection,"No selection manager"),!1):(P.LRg(I,R,H.a.Bqb,"Not in interactive view"),!1)}}P.hsf=null;Object(C.a)(P,"ClipboardOperation",L.a,
[])},1518:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);var f;(function(c){c[c.paste=1]="paste";c[c.textOnly=2]="textOnly";c[c.overtype=4]="overtype";c[c.copy=16]="copy";c[c.deleteSelection=32]="deleteSelection";c[c.move=64]="move";c[c.useSystemClipboard=256]="useSystemClipboard";c[c.forceInternalClipboard=512]="forceInternalClipboard";c[c.reformatPastedContent=4096]="reformatPastedContent";c[c.pasteAsPlainText=8192]="pasteAsPlainText";c[c.showPlaceholderGlossary=65536]="showPlaceholderGlossary"})(f||
(f={}));Object(C.b)("ClipboardActionFlags",f)},1519:function(C,L,b){b.r(L);b.d(L,"FootnoteEndnoteDefaultContentInserter",function(){return H});C=b(0);var f=b(23),c=b(51),u=b(2),r=b(40),t=b(644),k=b(30),m=b(6),l=b(17),x=b(41),w=b(1038),G=b(648),D=b(1436);class H{constructor(M,J,F,A,N=null){this.mc=M;this.W4j=J;this.Kl=F;H.Ee=A;this.ush=N||H.L1k}get ME(){return H.Cq||(H.Cq=f.a.instance.resolve("Box4.IOutlineEditor"))}l0k(M,J){var F=this.mc.Sl();F.set(M);this.ME.WGb(F,null,!0);H.Ee.plc(F.currentNode,
this.Kl);M=r.OutlineElementNavigator.Sd(F);H.Wha.gYe(J?Box4Intl.Box4Strings.L_StyleWordFootnoteText:Box4Intl.Box4Strings.L_StyleWordEndnoteText,M);F=this.ush(F.currentNode);H.characterPropertiesEditor.replaceTextRange(F,H.cfi);this.I5l(M,J)}I5l(M,J){var F=this.W4j(131073);F.setValue(m.a.Jp,1===J?36:35);F.setValue(m.a.zU,!0);F.setValue(l.a.w5,!0);const A=M.Ib.Mu(F,c.a.create());F=this.ush(M);H.characterPropertiesEditor.oga(F,N=>G.a.getInstance(N,A,!0),G.a.dFb,D.a.pui(M,J))}static al(){return new H(new t.a,
Object(x.a)(w.a.instance,w.a.instance.createInstance,"createInstance"),u.AFrameworkApplication.isRtl,f.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Wha(){return H.Kz||(H.Kz=f.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}static get characterPropertiesEditor(){return H.hc||(H.hc=f.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get instance(){return H.na||(H.na=H.al())}static L1k(M){return k.a.Kb(M,0)}}H.cfi=" ";H.Ee=null;H.na=null;H.Cq=null;H.Kz=null;H.hc=null;Object(C.a)(H,
"FootnoteEndnoteDefaultContentInserter",null,[356])},1520:function(C,L,b){b.d(L,"a",function(){return t});C=b(0);var f=b(644),c=b(504),u=b(1356),r=b(1436);class t{constructor(k,m){this.cFa=m}JAe(k,m,l){return(k=this.cFa.zAi(k.node,l?k.cpBegin:k.cpEnd,m))?k.sba():null}nHi(k,m){return(k=this.cFa.QKl(k.node,k.cpBegin,m))?k.sba():null}static qud(){return new t(c.a.instance,u.a.instance,new f.a,r.a.instance)}static get instance(){return t.na||(t.na=t.qud())}}t.na=null;Object(C.a)(t,"FootnoteEndnoteNavigator",
null,[344])},1529:function(C,L,b){b.d(L,"a",function(){return t});C=b(0);var f=b(1579),c=b(2),u=b(34),r=b(23);class t{constructor(k,m,l,x,w,G){this.AFa=k;this.BFa=m;this.qhf=l;this.O5=x;this.w5d=w;this.qqc=G}get vCj(){return!this.BFa&&!this.qhf}get E7i(){return 2===this.qqc?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get sli(){return CommonUIStrings.l_OICErrorMessageNoOffice}get nLi(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get DGb(){return CommonUIStrings.l_OICErrorHelpLink}get aKi(){return"OICFailure"}get icon(){return 3}get yhe(){return 2===
this.qqc?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get F3a(){return CommonUIStrings.l_DefaultDialogTitle}QZm(k){this.U7i(k)}skm(k){this.U7i(k)}U7i(k){let m=10;1===k?(r.a.instance.resolve("Common.IOfficeTrialExperience").Sug(this.qqc),m=3):2===k&&((!this.qhf||this.qhf(this.O5))&&this.BFa&&f.a.instance.L2k(this.BFa,this.AFa,this.O5),m=5);(0===k||1===k)&&this.AFa&&this.AFa(this.O5);c.AFrameworkApplication.Ejc(u.a.yPe,this.w5d,m);this.dispose()}dispose(){this.O5=
this.BFa=this.AFa=null}}Object(C.a)(t,"AOICErrorDialogWithTrial",null,[12])},1577:function(C,L,b){C=b(0);var f=b(2),c=b(15),u=b(23),r=b(551),t=b(1349),k=b(1223),m=b(29);class l{constructor(za,la=null){this.zgk=za;this.b3=la||t.a.K8f(c.a.Qhb,"")}get fB(){return this.zgk}get Mb(){return this.b3}e1g(za){this.Mb.d++;return this.fB.e1g(za)}ESc(za){this.Mb.e++;return this.fB.ESc(za)}tO(za){this.Mb.f++;return this.fB.tO(za)}aNb(za){this.Mb.h++;return this.fB.aNb(za)}cda(za){this.Mb.i++;return this.fB.cda(za)}Lha(za){this.Mb.j++;
return this.fB.Lha(za)}eDa(za){this.Mb.k++;return this.fB.eDa(za)}koa(za){this.Mb.l++;return this.fB.koa(za)}vXe(za){this.Mb.m++;return this.fB.vXe(za)}wtb(za,la=!1){this.Mb.n++;return this.fB.wtb(za,la)}dfg(){this.Mb.o++;return this.fB.dfg()}l6g(){this.Mb.p++;return this.fB.l6g()}$v(za){this.Mb.q++;return this.fB.$v(za)}PKa(za){this.Mb.r++;return this.fB.PKa(za)}rSc(za){this.Mb.g++;return this.fB.rSc(za)}BUd(za){return this.fB.BUd(za)}dNb(za){this.Mb.s++;return this.fB.dNb(za)}YXe(za){this.Mb.s++;
return this.fB.YXe(za)}tSf(za){this.Mb.ba++;return this.fB.tSf(za)}iXe(za){this.Mb.s++;return this.fB.iXe(za)}cNb(za){this.Mb.s++;return this.fB.cNb(za)}wlc(za){this.Mb.t++;return this.fB.wlc(za)}mYe(za){this.Mb.u++;return this.fB.mYe(za)}ioa(za){this.Mb.v++;return this.fB.ioa(za)}n2g(za){this.Mb.bb++;return this.fB.n2g(za)}ZXa(za){return this.fB.ZXa(za)}Yca(za){this.Mb.z++;return this.fB.Yca(za)}JWg(){return this.fB.JWg()}Vta(za,la){this.Mb.w++;this.Mb.x++;return this.fB.Vta(za,la)}cF(za){this.Mb.y++;
return this.fB.cF(za)}clearFormatting(){return this.fB.clearFormatting()}clone(){return new l(this.fB.clone(),this.Mb)}}Object(C.a)(l,"FormattingStewardUsageCollector",null,[191]);class x extends l{constructor(za,la=null){super(za,la)}get Vga(){return this.fB}get Kt(){return this.Vga.Kt}set Kt(za){this.Vga.Kt=za}get textIndent(){return this.Vga.textIndent}get marginLeft(){return this.Vga.marginLeft}get TTc(){return this.Vga.TTc}get WWa(){return this.Vga.WWa}get lineSpacing(){return this.Vga.lineSpacing}get tM(){return this.Vga.tM}get leftIndent(){return this.Vga.leftIndent}get Ina(){return this.Vga.Ina}get paragraph(){return this.Vga.paragraph}set paragraph(za){this.Vga.paragraph=
za}get FN(){return this.Vga.FN}get aUc(){return this.Vga.aUc}x2e(za){return this.Vga.x2e(za)}jbh(za){return this.Vga.jbh(za)}clone(){const za=this.fB.clone();return new x(za,this.Mb)}}Object(C.a)(x,"FormattingStewardUsageCollector",l,[541,191]);var w=b(10),G=b(65),D=b(325),H=b(783),M=b(40),J=b(205),F=b(83),A=b(39),N=b(51),B=b(349),E=b(137),P=b(16),T=b(79),V=b(58),I=b(17),R=b(6),ba=b(42),ha=b(236),na=b(481),da=b(350),ia=b(18),ma=b(180),qa=b(43),ka=b(74),va=b(179),ja=b(1417),Ma=b(133),Ha=b(30),X=b(1156),
W=b(630);class fa{constructor(za,la,Sa,Pa,fb,db,Qa,wb,ib,Ta,jb=null){this.ZH=this._paragraph=null;this.Fbe=0;this.sqh=this.Gbe=null;this.dwa=0;this.JYb=this.aUc=this.leftIndent=this.tM=this.H6c=this.WWa=this._tabStops=this._marginLeft=this._textIndent=null;this.paragraph=za;this.Wd=la;this.Kz=Sa;this.nk=Pa;this.ky=fb;this.fcb=db;this.fI=Qa;this.cW=wb;this.QEa=ib;this.JTb=Ta;jb?(m.a(4223818,307,!!jb.ZH),this.ZH=jb.ZH.rya(this.paragraph),this.Fbe=jb.LOc,this.Gbe=jb.CLg,jb.WWa&&(this.WWa=new X.a,this.WWa.afterSpacing.value=
jb.WWa.afterSpacing.value,this.WWa.beforeSpacing.value=jb.WWa.beforeSpacing.value),jb.lineSpacing&&(this.H6c=jb.lineSpacing.clone()),this.dwa=jb.dwa,this.aUc=jb.aUc.clone(),this._textIndent=jb.textIndent,this._marginLeft=jb.marginLeft,this._tabStops=jb.TTc,this.tM=jb.tM,this.leftIndent=jb.leftIndent,jb.Ina&&(this.JYb=jb.Ina)):(this.ZH=new va.a(this.paragraph,0),this.ZH.formatting=new Ma.a(this.ZH,N.a.nil),la=Ha.a.kz(za),la=this.ky.yr(la),this.Tjn(la),this.Ntn(za)?(this.fcb.Vkn(this.ZH.formatting,
la),za.hasProperty(I.a.Mj)?this.dwa=za.getValue(I.a.Mj):this.dwa=0):this.dwa=-1,this.Fbe=0,this.WWa=this.Gbe=null,this.JTb&&(this.WWa=this.fcb.cIa(za),this.H6c=this.fcb.P4a(za),this.tM=this.fcb.QGc(za),this.leftIndent=this.fcb.x7(za)),this.aUc=new B.DictionaryPropertySet)}get paragraph(){return this._paragraph}set paragraph(za){m.a(4223816,307,!!za&&w.ParagraphReader.nb(za));this._paragraph=za}get FN(){return this.ZH.formatting}get LOc(){return this.Fbe}get CLg(){return this.Gbe}get GA(){return this.sqh}get Kt(){return this.dwa}set Kt(za){m.a(4223817,
307,1===za||2===za||3===za||6===za);this.dwa=za}get textIndent(){return this._textIndent}get marginLeft(){return this._marginLeft}get TTc(){return this._tabStops}get lineSpacing(){return this.H6c}get Ina(){return this.JYb}get gb(){return this.nk}Tjn(za){const la=this.ky.language(za);la&&this.Wd.g1g(this.ZH.formatting,la,0,za.cache.RHb,!1)}Ntn(za){if(!ia.a.instance.J(10))return!0;za=this.gb.Jd(this.gb.im(za));return za===qa.StyleReader.owb||za===qa.StyleReader.wordStyleIdNormal||za===qa.StyleReader.TLa||
za===qa.StyleReader.styleIdNormal}e1g(za){(za=r.a.yf(za))&&this.Wd.cUd(this.ZH.formatting,za.LCID);return!0}ESc(){return!1}tO(za){this.Wd.tO(this.ZH.formatting,za);return!0}aNb(za){this.Wd.setItalic(this.ZH.formatting,za);return!0}cda(za){this.Wd.cda(this.ZH.formatting,za);return!0}Lha(za){this.Wd.Lha(this.ZH.formatting,za);return!0}eDa(za){this.Wd.eDa(this.ZH.formatting,za);return!0}koa(za){this.Wd.koa(this.ZH.formatting,za);return!0}vXe(za){if(0>=za)return!1;this.Wd.ay(this.ZH.formatting,za);return!0}wtb(za,
la){if(!za||""===za)return!1;if(({Uue:Sa}=E.FontUtils.bch(za)).returnValue)return this.Wd.n5(this.ZH.formatting,Sa.fontName),!0;var Sa=!1;const Pa=E.FontUtils.O4(za);la&&this.iIb(Pa,this.fI)&&(this.fI.Rqa(za),Sa=!0);if(this.iIb(Pa,this.cW)||this.iIb(Pa,this.QEa))Sa=!0;Sa&&this.Wd.n5(this.ZH.formatting,Pa);return Sa}iIb(za,la){return!!la&&la.isEnabled&&la.iIb(za)}dfg(){this.Wd.RHi(this.ZH.formatting);return!0}l6g(){this.Wd.rDj(this.ZH.formatting);return!0}$v(za){var {Box4PasteSteward:la}=b(1319);if(null===
za||""===za)return!1;za=la.B5b(za);la=null;this.Ina&&this.Ina.hasOwnProperty(R.a.je.id.toString())&&(la=this.Ina[R.a.je.id.toString()]);this.Wd.$v(this.ZH.formatting,za,la);return!0}PKa(za){const {Box4PasteSteward:la}=b(1319);if(!za||""===za||!fa.RTl().contains(za))return!1;this.Wd.PKa(this.ZH.formatting,la.B5b(za));return!0}rSc(za){this.Wd.rSc(this.ZH.formatting,za);return!0}BUd(za){let la=0;switch(P.a.He(za)){case "small-caps":la=1;break;case "uppercase":la=2}this.Wd.Sn(this.ZH.formatting,ba.a.capitalization,
la);return!0}Yca(za){const {Box4PasteSteward:la}=b(1319);if(!za||""===za)return!1;this.aUc.setValue(I.a.BL,parseInt(la.B5b(za),16));return!0}cNb(za){return 0>=za?!1:this.YXe(this.gb.jcg(za))}dNb(za){this.clearFormatting();this.Fbe=za;return!0}tSf(za){var {Box4PasteSteward:la}=b(1319),Sa=new Map;Sa.set("Source","CreateStyleCCP_FormattingSteward");T.Health.instance.recordKpiUsage(ma.a.shh,0,ma.a.aH,Sa);Sa=ka.a.yEi(za);za=[];za.push(Sa);(za=ka.a.kyc(za,this.paragraph))?(la.LTc=this.gb.kn(),m.b(593078085,
3017,50,"Custom style created via paste.")):(la=new Map,la.set("Source","CreateStyleCCP_FormattingSteward"),la.set("IsStyleNull",(!Sa).toString()),la=Object.assign(new ha.a,{extendedProperties:la}),T.Health.instance.recordKpiFailure(ma.a.shh,"UnableToCreateStyle",!1,!0,la));return za}YXe(za){const {Box4PasteSteward:la}=b(1319);return za&&0<za.length&&la.LTc&&la.LTc.Mf(za)?(this.Gbe=za,!0):!1}iXe(za){const {Box4PasteSteward:la}=b(1319);return za&&0<za.length&&la.LTc&&la.LTc.Mf(za)?(this.sqh=za,!0):
!1}jbh(za){if(this.GA){za=this.gb.rz(za);if(!za)return m.a(41968715,307,!1),!1;(za=za.Mf(this.GA))&&this.Wd.Ltb(this.ZH.formatting,za);return!0}return!1}Vta(){return!1}cF(za){if(!za)return!1;const la=parseFloat(P.a.substring(za,0,P.a.He(za).indexOf("px")));if(!isNaN(la))return this.H6c=new W.a(3,V.a.tx(la,1)),!0;za=parseFloat(P.a.substring(za,0,P.a.He(za).indexOf("%")));return isNaN(za)?!1:(this.H6c=new W.a(2,za/100),!0)}wlc(za){let la=0;if(!za||""===za)return!1;switch(za){case "left":la=1;break;
case "center":la=2;break;case "right":la=3;break;case "justify":la=6}if(!la)return!1;this.Kt=la;return!0}mYe(za){this._textIndent=za;return!0}ioa(za){this._marginLeft=za;return!0}n2g(za){this._tabStops=za;return!0}ZXa(za){this.JYb=JSON.parse(za);return this.Ina?!0:!1}clearFormatting(){this.ZH.formatting=new Ma.a(this.ZH,N.a.nil);return!0}JWg(){this.dwa=0;return!0}x2e(za){var {Box4PasteSteward:la}=b(1319);if(!ia.a.instance.J(10))return!1;if(0<this.LOc&&la.jrb[this.LOc]){m.a(4223819,307,1<=this.LOc);
m.a(4223820,307,7>=this.LOc);la=this.gb.rz(za);if(!la)return m.a(4223821,307,!1),!1;la=la.Mf(b(1319).Box4PasteSteward.jrb[this.LOc]);this.Kz.hT(la,za,!1);return!0}if(this.CLg){la=this.gb.rz(za);if(!la)return m.a(41968716,307,!1),!1;la=la.Mf(this.CLg);this.Kz.hT(la,za,!1);return!0}return!1}clone(){return new fa(this.paragraph,this.Wd,this.Kz,this.nk,this.ky,this.fcb,this.fI,this.cW,this.QEa,this.JTb,this)}static RTl(){fa.B6||(fa.B6=new na.a(da.a.Xi()),fa.B6.add(ja.a.yellow),fa.B6.add(ja.a.EXi),fa.B6.add(ja.a.GZh),
fa.B6.add(ja.a.Dri),fa.B6.add(ja.a.blue),fa.B6.add(ja.a.red),fa.B6.add(ja.a.X5i),fa.B6.add(ja.a.teal),fa.B6.add(ja.a.green),fa.B6.add(ja.a.purple),fa.B6.add(ja.a.f3i),fa.B6.add(ja.a.a8i),fa.B6.add(ja.a.gray),fa.B6.add(ja.a.WDj),fa.B6.add(ja.a.black));return fa.B6}}fa.B6=null;Object(C.a)(fa,"FormattingSteward",null,[541,191]);class ra{Bbh(){return!1}Efg(za){return za}Jfg(){}ZXa(){}LXe(){}EFe(){return!1}get BGe(){return!1}cF(){}Vta(){}eYe(){}get KBj(){return!1}}Object(C.a)(ra,"NoOpPasteStewardBridge",
null,[540]);var Aa=b(75);class Ba{constructor(za,la){this.lAm=za;this.mAm=la||"Normal"}}Object(C.a)(Ba,"NoteTagInfoBox4",null,[]);const ta=za=>{const la=new Aa.a;for(const Sa of za)za=new Ba(Sa.lAm,Sa.mAm),la.add(za);return la};b.d(L,"a",function(){return xa});class xa{constructor(za,la,Sa=null,Pa=null){this.QEa=this.cW=this.fI=null;this.Qnl=f.AFrameworkApplication.K.ea("FollowDestinationFormattingPasteIsEnabled");this.CJh=0;this.pb=za;this.$O=la;this.s9=Pa||new ra;this.Mb=Sa||t.a.K8f(c.a.Qhb,"")}get characterPropertiesEditor(){return xa.hc||
(xa.hc=u.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}get fontService(){return this.fI||(this.fI=u.a.instance.sa("Box4.IFontService"))}get Laa(){return this.cW||(this.cW=u.a.instance.sa("Box4.CustomFontService"))}get lel(){return this.QEa||(this.QEa=u.a.instance.sa("Box4.IEmbeddedFontService"))}reset(){}get iod(){return this.K7f(!1)}K7f(za){m.a(4223770,307,A.OutlineElementReader.gg(this.pb));const la=M.OutlineElementNavigator.Sd(this.pb);M.OutlineElementNavigator.Uc(this.pb);m.a(4223771,
307,!!la&&w.ParagraphReader.nb(la));za=new fa(la,xa.Xg,xa.kZ,xa.gb,xa.K3f,xa.Ool,this.fontService,this.Laa,this.lel,this.Qnl,void 0,za);return new x(za,this.Mb)}xna(){}DWa(){}lKb(){}PJa(){}zWa(){}f7a(){}e7a(){}IK(){}HK(){}iKb(){}hKb(){}m7a(){}Tqb(){}GWa(){}EWa(){}l7a(){}FWa(){}Wqb(){}OMc(za){A.OutlineElementReader.gg(this.pb)?(xa.Pg.EIa(this.pb,!0),M.OutlineElementNavigator.Mt(this.pb,!1,!1)):F.OutlineReader.yq(this.pb)?J.OutlineNavigator.M4(this.pb)?za?(this.pb.wg(),xa.ME.I6(this.pb,!1)):xa.Pg.gjc(this.pb):
xa.ME.I6(this.pb,!1):m.a(8128524,307,!1,"Unexpected node type {0} encountered",this.pb.Yc)}rvd(za){let la=null;if(za&&za.dha&&za.cultureName)try{la=Object.assign(new H.a,{languageId:r.a.yf(za.cultureName).LCID})}catch(Sa){m.a(8128526,307,!1,"Setting up culture {0} encountered {1}",za.cultureName,Sa)}la||null==this.$O||(la=Object.assign(new H.a,{languageId:this.$O}));return la}get R0(){return this.CJh}set R0(za){this.CJh=za}Nje(){}i2e(){}mMf(){}get zBc(){return!1}get o6b(){return!1}Qkm(za){let la=
1;if(za.ySi){var Sa=0;switch(za.listStyleType){case 1:la=0;break;case 7:la=1;break;case 8:la=2;break;case 9:la=3;break;case 10:la=4;break;case 11:la=5}}else switch(Sa=1,za.listStyleType){case 1:la=0;break;case 3:la=1;break;case 4:la=2;break;case 5:la=3}let Pa;Sa=(Pa=G.ListReader.V3)?D.a.TR(Sa,la,ta(za.ota),za.listId,za.je,za.levelText,za.font):D.a.TR(Sa,la,ta(za.ota));3!==za.gq&&(Sa.s1=za.gq);za.ySi&&!za.wPi&&(Sa.cA=Pa&&0<za.listId&&0<=za.je&&!za.OOc?za.zTc:za.e6k);!Sa.Zr||3!==Sa.listStyle&&5!==Sa.listStyle||
(Sa.Kt="right");k.a.rDd&&((za=za.Bvg)&&Sa.propertySet.hn(za),Sa.w8b=!0);this.s9.LXe(this.pb);return Sa}wna(){}tna(){}vna(){}una(){}sna(){}rna(){}static get Pg(){return xa.Ee||(xa.Ee=u.a.instance.resolve("Box4.IOutlineElementEditor"))}static get ME(){return xa.Cq||(xa.Cq=u.a.instance.resolve("Box4.IOutlineEditor"))}static get Xg(){return xa.Wd||(xa.Wd=u.a.instance.resolve("Box4.IFormattingEditor"))}static get kZ(){return xa.Kz||(xa.Kz=u.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}static get gb(){return xa.nk||
(xa.nk=u.a.instance.resolve("Box4.Styles.IWACStyleReader"))}static get K3f(){return xa.ky||(xa.ky=u.a.instance.resolve("Box4.IFormattingReader"))}static get Ool(){return xa.fcb||(xa.fcb=u.a.instance.resolve("Box4.Actors.IFormattingStewardBridge"))}}xa.Ee=null;xa.Cq=null;xa.hc=null;xa.Wd=null;xa.Kz=null;xa.nk=null;xa.ky=null;xa.fcb=null;xa.zc=null;Object(C.a)(xa,"Box4PasteStewardBase",null,[536,179,180])},1579:function(C,L,b){C=b(0);var f=b(41),c=b(8),u=b(2),r=b(34),t=b(334),k=b(23);class m{constructor(A,
N,B,E){this.Ymf=null;this.w5d=E;this.AFa=A;this.BFa=N;this.O5=B;this.PNh=this.Uec.ksn;A=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.rfk=A[0];this.qfk=A[1]}get Uec(){return this.Ymf||(this.Ymf=k.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get DGb(){return CommonUIStrings.l_OICErrorHelpLink}get fVd(){return this.PNh}get D2i(){return this.rfk}get C2i(){return this.qfk}get B2i(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.PNh?
3:2}get Bqd(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get toe(){return!!this.BFa}get Cqd(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get F3a(){return CommonUIStrings.l_DefaultDialogTitle}jRg(A){this.wJd(A)}lvg(A){this.wJd(A)}wJd(A){let N=10;this.BFa&&1===A&&(this.BFa(this.O5),N=1);this.AFa&&this.AFa(this.O5);this.KH(N)}cgc(){t.Redirect.showHelp("OICFailure");this.KH(2)}yFg(){this.Uec.dXi();this.KH(4)}KH(A){c.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.w5d,A);u.AFrameworkApplication.Ejc(r.a.wPe,this.w5d,A)}dispose(){this.O5=this.AFa=this.BFa=null}}Object(C.a)(m,"AOICErrorDialog",null,[12]);var l=b(25),x=b(129);class w extends m{constructor(A,N,B,E){super(A,N,B,E);this.Gzb=this.ly=null;A=document.createElement("span");A.id="errorMessageText";A.innerText=this.errorMessage;A.appendChild(document.createElement("br"));A.appendChild(document.createElement("br"));this.ly=document.createElement("a");this.ly.href="#";this.ly.innerText=this.DGb;A.appendChild(this.ly);
l.a.addHandler(this.ly,"click",Object(f.a)(this,this.cgc,"oicErrorHelpLinkHandler"));N=new x.StandardDialog;N.Je=this.id;this.fVd?(B=document.createElement("span"),E=document.createElement("span"),B.innerText=this.D2i,E.innerText=this.C2i,this.Gzb=document.createElement("a"),this.Gzb.href="#",this.Gzb.innerText=this.B2i,A.appendChild(document.createElement("br")),A.appendChild(B),A.appendChild(this.Gzb),A.appendChild(E),l.a.addHandler(this.Gzb,"click",Object(f.a)(this,this.yFg,"oicErrorMacOfferLinkHandler"))):
this.toe&&(A.appendChild(document.createElement("br")),A.appendChild(document.createElement("br")),B=document.createElement("span"),B.innerText=this.Bqd,A.appendChild(B));this.toe?(N.wc=1,N.ee(1,this.Cqd)):N.wc=0;N.iu(this.F3a,null,this.icon,Object(f.a)(this,this.lvg,"legacyOICErrorDialogHandler"),A);N.k5("errorMessageText")}dispose(){this.ly&&(l.a.removeHandler(this.ly,"click",Object(f.a)(this,this.cgc,"oicErrorHelpLinkHandler")),this.ly=null);this.Gzb&&(l.a.removeHandler(this.Gzb,"click",Object(f.a)(this,
this.yFg,"oicErrorMacOfferLinkHandler")),this.Gzb=null);super.dispose()}}Object(C.a)(w,"OICErrorDialog",m,[]);class G{constructor(A,N,B){this.AFa=N;this.BFa=A;this.O5=B}get id(){return"OICErrorDialogWithDownload"}get tli(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get DGb(){return CommonUIStrings.l_OICErrorHelpLink}get Bqd(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get Cqd(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get F3a(){return CommonUIStrings.l_DefaultDialogTitle}jRg(A){this.wJd(A)}lvg(A){this.wJd(A)}wJd(A){let N=
10;1===A&&(this.BFa(this.O5),N=1);this.AFa&&this.AFa(this.O5);this.KH(N)}cgc(){t.Redirect.showHelp("OICFailure");this.KH(2)}KH(A){u.AFrameworkApplication.Ejc(r.a.xPe,3,A)}dispose(){this.O5=this.BFa=this.AFa=null}}Object(C.a)(G,"AOICErrorDialogWithDownload",null,[12]);class D extends G{constructor(A,N,B){super(A,N,B);this.ly=null;A=document.createElement("span");A.id="errorMessageText";A.innerText=this.tli;A.appendChild(document.createElement("br"));A.appendChild(document.createElement("br"));this.ly=
document.createElement("a");this.ly.href="#";this.ly.innerText=this.DGb;A.appendChild(this.ly);l.a.addHandler(this.ly,"click",Object(f.a)(this,this.cgc,"oicErrorHelpLinkHandler"));A.appendChild(document.createElement("br"));A.appendChild(document.createElement("br"));N=document.createElement("span");N.innerText=this.Bqd;A.appendChild(N);N=new x.StandardDialog;N.Je=this.id;N.wc=1;N.ee(1,this.Cqd);N.iu(this.F3a,null,this.icon,Object(f.a)(this,this.lvg,"legacyOICErrorDialogHandler"),A);N.k5("errorMessageText")}dispose(){this.ly&&
(l.a.removeHandler(this.ly,"click",Object(f.a)(this,this.cgc,"oicErrorHelpLinkHandler")),this.ly=null);super.dispose()}}Object(C.a)(D,"OICErrorDialogWithDownload",G,[]);var H=b(149);class M extends m{constructor(A,N,B,E){super(A,N,B,E);N={["errorMessage"]:this.errorMessage};N.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.DGb,["onExecute"]:P=>{this.cgc(P)}};this.fVd?(N.macOfficePreLinkText=this.D2i,N.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.B2i,
["onExecute"]:P=>{this.yFg(P)}},N.macOfficePostText=this.C2i):this.toe&&(N.errorFileDownloadOffer=this.Bqd);A=new H.a(!1,!1,!0);this.toe?(A.wc=1,A.ee(1,this.Cqd)):A.wc=0;A.Je=this.id;N={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:N};A.Ih(this.F3a,Object(f.a)(this,this.jRg,"reactOICErrorDialogHandler"),N)}}Object(C.a)(M,"ReactOICErrorDialog",m,[]);class J extends G{constructor(A,N,B){super(A,N,B);N={["errorMessage"]:this.tli,["errorFileDownloadOffer"]:this.Bqd};N.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.DGb,["onExecute"]:E=>{this.cgc(E)}};A=new H.a(!1,!1,!0);A.wc=1;A.ee(1,this.Cqd);A.Je=this.id;N={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:N};A.Ih(this.F3a,Object(f.a)(this,this.jRg,"reactOICErrorDialogHandler"),N)}}Object(C.a)(J,"ReactOICErrorDialogWithDownload",G,[]);b.d(L,"a",function(){return F});class F{constructor(){this.sFa=!!u.AFrameworkApplication.la&&u.AFrameworkApplication.la.eb.wz}K2k(A,N,B){this.sFa?new M(A,N,null,B):new w(A,N,null,B)}L2k(A,
N,B){this.sFa?new J(A,N,B):new D(A,N,B)}M2k(A,N,B,E,P){const {ReactOICErrorDialogWithTrial:T}=b(1669),{OICErrorDialogWithTrial:V}=b(1670);this.sFa?new T(A,N,B,null,E,P):new V(A,N,B,null,E,P)}static get instance(){return F.na||(F.na=new F)}}F.na=null;Object(C.a)(F,"OICErrorDialogFactory",null,[989])},1581:function(C,L,b){b.r(L);C=b(0);var f=b(435),c=b(23),u=b(99),r=b(92),t=b(69),k=b(1194),m=b(349),l=b(2),x=b(51),w=b(1253),G=b(143),D=b(36),H=b(15),M=b(257),J=b(127),F=b(8),A=b(41),N=b(245),B=b(244),
E=b(70),P=b(302),T=b(14),V=b(30),I=b(3),R=b(12),ba=b(125),ha=b(503),na=b(49),da=b(1517),ia=b(1516),ma=b(594),qa=b(222);class ka extends qa.a{constructor(Aa,Ba,ta,xa,za,la){super();this.init(Aa);this.Pj("DummyClipboardOperation");this.AIa(l.AFrameworkApplication.pa,Ba,xa,za,la);this._context=ta;this.Zl=8;this.b1()}run(){this.xea=!0;this.rtb(this._context);this.Kca();this.Zl=32}}Object(C.a)(ka,"DummyClipboardOperation",qa.a,[]);qa=b(1388);class va extends qa.a{constructor(Aa,Ba,ta,xa,za){super(Aa,Ba,
za);this.xk=ta;this.xuf=xa}dVc(Aa){let Ba;if(this.PW&&!Aa)return F.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,qHa:null};Ba=null;if(this.xuf&&!this.PW){const ta=this.properties.fa(J.a.eMg,"");ta&&(Ba=this.xk.DKb(ta))}Ba||(Ba=this.xk.DKb(Aa));return{returnValue:!0,qHa:Ba}}}Object(C.a)(va,"HtmlStringImportStrategy",qa.a,[]);var ja=b(1655);class Ma extends ja.a{constructor(Aa,Ba,ta,xa,za){super(Aa,Ba,ta,xa,za)}VBi(){return this.properties.fa(J.a.thc,
"")}dVc(Aa){l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordUseClipboardDataHelperInMultiLineImportSettings");if(this.$Nh){if(this.xk)return Aa=this.xk.VLg(Aa,!0),{returnValue:!0,qHa:Aa};F.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.dVc(Aa)}gGd(Aa){Aa=super.gGd(Aa);return Aa.length&&" "!==Aa?Aa:"\u00a0"}}Object(C.a)(Ma,"MultiLinePlainTextImportStrategy",ja.a,[]);class Ha extends qa.a{constructor(Aa,Ba,ta){super(Aa,Ba,ta)}dVc(Aa){({ClipboardActor:Ba}=
b(1581));if(this.PW&&!Aa)return F.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,qHa:null};var Ba=Ba.JPm;Ba.innerText=Aa;return{returnValue:!0,qHa:Ba}}}Object(C.a)(Ha,"PlainTextImportStrategy",qa.a,[]);var X=b(90),W=b(68);class fa{constructor(Aa){this.eJa=this.$qg=!1;this.Xpa=Aa}Kfj(){this.$qg||(this.$qg=!0,this.eJa=!1,this.Xpa.prepareForPaste(()=>{this.eJa=!0}));return this.eJa}yLj(Aa){this.$qg=!1;Aa=this.Xpa.paste();return Aa?Aa.hasChildNodes()?{returnValue:!0,Boe:Aa}:(F.ULS.sendTraceTag(7891019,
307,50,"DOM innerText empty."),fa.Lb.mb(X.a.u1,{["Reason"]:W.a.Uqd}),{returnValue:!1,Boe:Aa}):(F.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),fa.Lb.mb(X.a.HEb,{["Reason"]:W.a.CXd}),{returnValue:!1,Boe:Aa})}static get Lb(){return G.a.instance}}Object(C.a)(fa,"SystemClipboardImportStrategy",null,[504]);b.d(L,"ClipboardActor",function(){return ra});class ra{constructor(Aa,Ba,ta,xa,za,la,Sa,Pa,fb,db,Qa,wb,ib,Ta,jb){this.Mph=null;this.kuc=0;this.u7d=this.xed=this.q5c=!1;this.Dqc=f.a.On;
this.W$=this.vfe=null;this.f5j=Aa;this.Xpa=Ba;this.Bc=ta;this.xk=xa;this.ga=la;this.W3d=db;this.Uqc=Qa;this.ld=wb;this.fg=ib;this.ib=fb;this.Cwc=Ta;this.Dwc=jb;Pa&&(this.q5c=Pa.ea("SupportImageDragDropExternalIsEnabled"),this.xed=Pa.ea("UseClipboardDataHelperInMultiLineImportIsEnabled"),this.u7d=this.Dwc&&Pa.ea("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));this.OD=new P.a;this.OD.$(I.a.paste,257);this.OD.$(I.a.Jna,8449);this.OD.$(I.a.hfa,1);this.OD.$(I.a.Nnb,1);this.OD.$(I.a.cCb,1);this.OD.$(I.a.Rxa,
1);this.OD.$(I.a.UAd,513);this.OD.$(I.a.reformatPastedContent,4097);this.OD.$(I.a.ILb,12289);this.OD.$(I.a.FQe,7);this.OD.$(I.a.aMg,1);this.OD.$(I.a.XLd,8193);this.OD.$(I.a.copy,272);this.OD.$(I.a.BCb,16);this.OD.$(I.a.Sya,304);this.OD.$(I.a.gle,48);this.OD.$(I.a.zfc,64);this.OD.$(I.a.wId,64);this.OD.$(I.a.showPlaceholderGlossary,65536);this.q5c&&this.OD.$(I.a.$re,1);this.u7d&&this.OD.$(I.a.shc,this.OD.J(I.a.XLd))}get D9a(){return this.vfe||(this.vfe=c.a.instance.sa("Box4.Clipboard.ISystemClipboardAccessManager"))}get telemetry(){return this.W$||
(this.W$=c.a.instance.sa("Common.Utils.Telemetry.ITelemetry"))}get cne(){return this.f5j.value}get FBn(){return this.Xpa}lb(){this.ga.Aa(I.a.Fhj,T.a.application,Object(A.a)(this,this.Ghj,"queryPasteOptions"),97);this.ga.Aa(I.a.Hhj,T.a.application,Object(A.a)(this,this.Ghj,"queryPasteOptions"),97);this.ga.Aa(I.a.SSe,T.a.application,Object(A.a)(this,this.Jhj,"queryReformatPasteOptions"),97);this.ga.Aa(I.a.TSe,T.a.application,Object(A.a)(this,this.Jhj,"queryReformatPasteOptions"),97);this.ga.dX(I.a.gle,
T.a.view,Object(A.a)(this,this.x3,"clipboardAction"),1028);this.ga.Ugb(I.a.BCb,T.a.view,Object(A.a)(this,this.x3,"clipboardAction"));this.q5c&&this.ga.dX(I.a.$re,T.a.view,Object(A.a)(this,this.$cl,"dropBrowserContent"),1028);this.ga.dX(I.a.hfa,T.a.view,Object(A.a)(this,this.x3,"clipboardAction"),1028);this.ga.dX(I.a.Nnb,T.a.view,Object(A.a)(this,this.x3,"clipboardAction"),1028);this.ga.dX(I.a.cCb,T.a.view,Object(A.a)(this,this.x3,"clipboardAction"),1028);this.ga.dX(I.a.Rxa,T.a.view,Object(A.a)(this,
this.x3,"clipboardAction"),1028);this.Cwc&&this.ga.Aa(I.a.F2a,T.a.view,Object(A.a)(this,this.xUm,"processCallExecCommandPasteOperation"),1028);this.Dwc&&this.ga.Aa(I.a.Xhb,T.a.view,Object(A.a)(this,this.yUm,"processCallExecCommandPasteOperationTextOnly"),1028);this.ga.dX(I.a.paste,T.a.view,Object(A.a)(this,this.x3,"clipboardAction"),1028);this.ga.dX(I.a.Jna,T.a.view,Object(A.a)(this,this.x3,"clipboardAction"),1028);this.ga.dX(I.a.XLd,T.a.view,Object(A.a)(this,this.x3,"clipboardAction"),1028);this.ga.dX(I.a.aMg,
T.a.view,Object(A.a)(this,this.x3,"clipboardAction"),1028);this.ga.dX(I.a.FQe,T.a.view,Object(A.a)(this,this.x3,"clipboardAction"),1028);this.ga.dX(I.a.reformatPastedContent,T.a.view,Object(A.a)(this,this.x3,"clipboardAction"),1028);this.ga.dX(I.a.ILb,T.a.view,Object(A.a)(this,this.x3,"clipboardAction"),1028);this.ga.ma(I.a.aMb,T.a.view,u.ActionManager.Ke);this.ga.ma(I.a.lMg,T.a.view,u.ActionManager.Ke);this.ga.ma(I.a.iMg,T.a.view,u.ActionManager.Ke);this.ga.ma(I.a.jMg,T.a.view,u.ActionManager.Ke);
this.ga.ma(I.a.kMg,T.a.view,u.ActionManager.Ke);this.ga.ma(I.a.hMg,T.a.view,u.ActionManager.Ke);this.ga.Ugb(I.a.zfc,T.a.view,Object(A.a)(this,this.x3,"clipboardAction"));this.ga.Ugb(I.a.wId,T.a.view,Object(A.a)(this,this.wId,"moveSelectedContentWithinCurrentParagraph"));this.ga.Ugb(I.a.UAd,T.a.view,Object(A.a)(this,this.x3,"clipboardAction"));this.ga.Ugb(I.a.showPlaceholderGlossary,T.a.view,Object(A.a)(this,this.x3,"clipboardAction"));this.u7d&&(this.ga.Aa(I.a.$3b,T.a.view,Object(A.a)(this,this.zUm,
"processCallExecCommandPasteOperationTextOnlyShortcut"),1028),this.ga.dX(I.a.shc,T.a.view,Object(A.a)(this,this.x3,"clipboardAction"),1028));this.ga.ma(I.a.nTf,T.a.view,u.ActionManager.Ke);this.ga.ma(I.a.cUf,T.a.view,u.ActionManager.Ke)}DV(){if(this.ib){const Aa=this.ib.Kc(ba.AppFrame.lE);this.u7d&&Aa.bindAction(r.KeyInputManager.$a(t.a.$La,r.KeyInputManager.mh|4),I.a.$3b)}else F.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}Ghj(Aa,Ba,ta,xa,za){if(1===
ta)return 32;za[k.a.On]=!1;return 32}$cl(Aa,Ba,ta,xa,za,la){F.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var Sa=la.DataTransfer;la=Sa.getData("text/html");Sa=Sa.getData("text/plain");let Pa=!1;const fb=new m.DictionaryPropertySet;0<la.length?(F.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),fb.setValue(J.a.wV,la),Pa=!0):0<Sa.length&&(F.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),fb.setValue(J.a.thc,Sa),Pa=!0);
if(Pa){const db=this.OD.J(Ba);return this.cne.create(Aa,Ba,db,new N.a(()=>this.Lod(db,fb)),ta,xa,za,fb)}return null}Jhj(Aa,Ba,ta,xa,za){if(Ba="object"===typeof za?za:null)this.Dwc?this.ajn(Aa,this.kuc,Ba):Aa===I.a.SSe?(Aa=this.kuc!==I.a.reformatPastedContent&&this.kuc!==I.a.ILb,Ba[this.Dqc]=this.kuc===I.a.reformatPastedContent||Aa):Aa===I.a.TSe&&(Ba[this.Dqc]=this.kuc===I.a.ILb);return 32}ajn(Aa,Ba,ta){switch(Ba){case I.a.ILb:case I.a.Jna:case I.a.shc:Ba=I.a.TSe;break;default:Ba=I.a.SSe}ta[this.Dqc]=
Aa===Ba}x3(Aa,Ba,ta,xa,za,la){if(l.AFrameworkApplication.protectFile||R.App.A4b(ta)&&this.lbm())return new ka(Aa,Ba,ta,xa,za,la);let Sa=this.OD.J(Ba);1!==xa&&Sa&1&&(this.kuc=Ba);if(1!==xa){var Pa=Object(B.a)(90,la)?la:null;la?(Sa&1&&(this.Mph=Pa),Pa=Pa?Pa.fa(J.a.Q0,0):0,Ba===I.a.paste&&Pa===I.a.F2a?Sa=this.OD.J(I.a.hfa):Ba===I.a.Jna&&Pa===I.a.Xhb&&(Sa=this.OD.J(I.a.XLd))):!la&&Sa&4096&&(la=this.Mph,Pa=Object(B.a)(90,la)?la:null)&&(Pa=Pa.fa(J.a.WLd,x.a.nil),F.ULS.sendTraceTag(575255109,307,50,"Reformatting operation occurred. CorrelationId: {0}",
Pa))}return this.cne.create(Aa,Ba,Sa,new N.a(()=>this.Lod(Sa,la)),ta,xa,za,la)}zUm(Aa,Ba,ta,xa,za){return this.ZJf(Aa,Ba,ta,za)}yUm(Aa,Ba,ta,xa,za){return this.ZJf(Aa,Ba,ta,za)}xUm(Aa,Ba,ta,xa,za){return this.ZJf(Aa,Ba,ta,za)}ZJf(Aa,Ba,ta,xa){if(1===ta){if(!Object(B.a)(ha.a,Ba)||!this.W3d)return 8;ta=new N.a(()=>this.Lod(this.OD.J(I.a.hfa),xa));const za=this.W3d.create(ta,Object(E.a)(90,xa));ta=new ia.a(l.AFrameworkApplication.K,w.a.instance,ta,G.a.instance,za,this.Uqc);return da.a.m4h(Ba,ta)?32:
8}if(2===ta){if(this.vrn(R.App.d2a))return this.F2a(Aa);R.App.Wic(()=>{this.F2a(Aa)});return 32}return 2}F2a(Aa){if(!this.ld)return F.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),8;var Ba=this.ld.G4a();if(!Ba)return F.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;Ba=Ba.Lo;if(!Ba)return F.ULS.sendTraceTag(592454659,307,10,"No document"),8;F.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",Aa);this.fg.yel(Aa);Aa=D.a.AEb(Ba,"paste");Ba=this.fg.cal();F.ULS.sendTraceTag(573388233,
307,50,"PasteEventHandled: {0}",Ba);if(Aa)return F.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),32;this.OVl();F.ULS.sendTraceTag(592454662,307,10,"execCommand failed");return 8}OVl(){this.D9a&&(this.D9a.omc(),ma.a.pKe(!0,na.a.instance,H.a.qI));if(this.telemetry){const Aa=this.telemetry.NWd();Aa.Wyc("CallExecCommandPasteOperation");Aa.fail("call to execCommand('paste') failed",!0);this.telemetry.Uaa(Aa)}}vrn(Aa){let Ba=!1;this.ib?this.ib.Zd?Ba=!this.ib.LJc(this.ib.Zd.name):F.ULS.sendTraceTag(573388235,
307,10,"No CurrentScope"):F.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(Ba){F.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",this.ib.Zd.name);if(1>Aa)return F.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.ib.K2f();return!1}return!0}wId(Aa,Ba,ta,xa,za,la){la=V.a.Kb(na.a.instance.ya.Ba.ra.node,la);return this.x3(Aa,Ba,ta,xa,za,la)}lbm(){return l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableRibbonItemsOnIframeSelection",
!1)?this.ib&&this.ib.Zd.name.startsWith("IFrame-"):!1}Lod(Aa,Ba){return Aa&256?new fa(this.FBn):Aa&2?Aa&4096?new va(Ba,this.Bc,this.xk,R.App.instance.dKc,R.App.instance.iYa):new Ha(Ba,this.Bc,R.App.instance.iYa):Ba.hasProperty(J.a.thc)?new Ma(Ba,this.Bc,this.xk,this.xed,R.App.instance.iYa):new va(Ba,this.Bc,this.xk,R.App.instance.dKc,R.App.instance.iYa)}static get JPm(){return M.a.e$b("Box4PasteScratchPad")}l4h(Aa,Ba,ta,xa){return(Aa=this.x3(null,Aa?I.a.Sya:I.a.copy,Ba,1,ta,xa))?Aa.response:8}}Object(C.a)(ra,
"ClipboardActor",null,[])},1586:function(C,L,b){b.r(L);C=b(0);var f=b(16),c=b(1777),u=b(1634);class r extends u.a{constructor(){super();this.isCurrentUser=!1}}Object(C.a)(r,"IsMeAtMentionOptionalAttributes",u.a,[]);class t{constructor(){this.atmention=this.altText=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.color=this.highlight=null}}Object(C.a)(t,"DeltaAttributes",null,[]);var k=b(1418),m=b(10),l=b(72),x=b(17),w=b(8),G=b(1485);b.d(L,"ACommentFormatTranslator",
function(){return D});class D{constructor(H){this.xe=H}FCk(H,M){const J=m.ParagraphReader.text(M);let F=null,A=null,N=null,B=0;var E=0,P=!1;let T="";for(M.ja||J&&J.length&&"\n"!==J||w.ULS.sendTraceTag(50870150,327,10,"paragraph chps are null and paragraph text is null or empty");B<M.ja.length;){const I=M.ja.J(B),R=I.cp;var V=I.formatting?I.formatting.gm:null;T+=f.a.substring(J,P?E+1:E,R);I.Wh&&F&&(E=new c.a,E.fullName=T.startsWith("@")?T.substr(1):T,G.a(F,E),P=new r,G.c(F,P,E),H.pkg(T,E,P,!0),T="",
F=null);I.Wh&&A&&(E=N||new t,E.link=A.url,H.ENi(T,E),T="",A=null);F&&A||""===T||(this.xe.x3b&&N?(H.TNi(T,N),N=null):H.FIa(T),T="");I.hyperlink&&(I.hyperlink.Xs?F=I.hyperlink:I.hyperlink.url&&(A=I.hyperlink));this.xe.x3b&&V&&(N=new t,N.weight=V.fa(x.a.bold,!1)?k.a.uAg:0,N.italic=V.fa(x.a.italic,!1),N.underline=V.fa(x.a.underline,!1),N.strikethrough=V.fa(x.a.strikethrough,!1),this.xe.bKc&&(V.hasProperty(x.a.highlight)&&(E=V.getValue(x.a.highlight),N.highlight=l.a.LA(E)),V.hasProperty(x.a.fontColor)&&
(V=V.getValue(x.a.fontColor),N.color=l.a.LA(V))));E=R;P=!!I.blob;B++}}}D.mFk="_@_";D.nFk="Z";Object(C.a)(D,"ACommentFormatTranslator",null,[321])},1599:function(C,L,b){C=b(0);var f=b(149),c=b(16),u=b(59),r=b(23),t=b(2),k=b(41),m=b(230),l=b(158);class x{static get Lf(){return f.a.oz(x.fm,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}x.fm="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(C.a)(x,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var w=b(20),G=b(3);b.d(L,"a",function(){return D});class D extends f.a{constructor(H,M,J){super();this.nyh=!1;this.lL=null;this.rw=M;this.wZ=!1;this.ccb=D.Unl;this.gh=H;this.ga=J;this.Je="FootnoteEndnoteFormattingOptionsDialog";this.wc=2;this.Lf=x.Lf;this.ee(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);this.ee(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);
this.Ih(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,Object(k.a)(this,this.dol,"footnoteEndnoteFormattingOptionsHandler"),null);this.vGb=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.lL}set fontName(H){this.lL=H;if(H=document.getElementById("FontSizeComboBox"))H.focus(),this.gh.updateCommandUI()}get fontSize(){return this.ccb}get vGb(){return this.nyh}set vGb(H){this.nyh=H;this.ZQm()}rV(){this.lle("FontStyleComboBox","FontPlaceholder",
w.a.Zue.toString(),w.a.phj.toString(),w.a.CMd.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.lle("FontSizeComboBox","FontPlaceholder",w.a.$ue.toString(),G.a.zPc.toString(),w.a.DMd.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const H=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
c.a.FI(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),M=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',c.a.FI(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.gjd("NoStyle","IndentPlaceholderStyles",
w.a.uqi.toString(),w.a.qhj.toString(),H,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.gjd("FirstLineIndent","IndentPlaceholderStyles",w.a.tqi.toString(),w.a.aQg.toString(),M,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}lle(H,M,J,F,A,N,B){J=m.c(H,J,!0,!0,F,A,c.a.Vd(N),!0,B);this.npe(H,M,J,"Medium")}gjd(H,M,J,F,A,N,B){J=m.i(H,J,F,c.a.Vd(A),c.a.Vd(N),B);this.npe(H,M,J,"Large",N)}npe(H,M,J,F,A=null){M=document.getElementById(M);
this.rw.e2a(H,J);J=this.rw.xFb(H,F);A&&u.a.$2b(J,String.format("{0}Label",H),A);M.appendChild(J);this.rw.T0(H)}ZQm(){this.rw.T0("NoStyle");this.rw.T0("FirstLineIndent")}dol(H){switch(H){case 1:this.ga.processAction(w.a.qqi,2);break;case 2:this.ga.processAction(w.a.rqi,2);break;case 0:this.ga.processAction(w.a.sqi,2)}}dispose(){this.wZ||(this.rw.WI("FontStyleComboBox"),this.rw.WI("FontSizeComboBox"),this.rw.WI("NoStyle"),this.rw.WI("FirstLineIndent"),this.wZ=!0);this.gh.updateCommandUI();super.dispose()}static get Q9a(){return r.a.instance.resolve("Common.IStandaloneRootController").e1}static QAl(){return new D(l.App.wn,
D.Q9a,t.AFrameworkApplication.pa)}static PAl(){return D.QAl()}}D.Unl=-1;Object(C.a)(D,"FootnoteEndnoteFormattingOptionsDialog",f.a,[])},1634:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{constructor(){this.contentId=""}}Object(C.a)(f,"AtMentionOptionalAttributes",null,[])},1663:function(C,L){Object.defineProperty(L,"__esModule",{value:!0});L.Z0j={About:"About",AboutFollowUps:"AboutFollowUps",AboutFollowUpsLearnMore:"AboutFollowUpsLearnMore",AboutKeytip:"AboutKeytip",Above:"Above",
AcceptChange:"AcceptChange",AcceptChangeKeytip:"AcceptChangeKeytip",Accessibility:"Accessibility",AccessibilityHelp:"AccessibilityHelp",AccessibilityHelpDescription:"AccessibilityHelpDescription",AccessibilityHelpKeytip:"AccessibilityHelpKeytip",AccessibilityMode:"AccessibilityMode",AccessibilityTab:"AccessibilityTab",AccessibilityTabKeyTip:"AccessibilityTabKeyTip",Acronyms:"Acronyms",AcronymsKeytip:"AcronymsKeytip",Activity:"Activity",ActivityContextMenuLabel:"ActivityContextMenuLabel",AdaptiveGroupTitle:"AdaptiveGroupTitle",
AddFromFiles:"AddFromFiles",AddFromFilesKeytip:"AddFromFilesKeytip",AddInsKeytipPrefix:"AddInsKeytipPrefix",AdditionalControls:"AdditionalControls",AddSpaceAfterParagraph:"AddSpaceAfterParagraph",AddSpaceAfterParagraphKeytip:"AddSpaceAfterParagraphKeytip",AddSpaceBeforeParagraph:"AddSpaceBeforeParagraph",AddSpaceBeforeParagraphKeytip:"AddSpaceBeforeParagraphKeytip",AddSpacingAfter:"AddSpacingAfter",AddSpacingBefore:"AddSpacingBefore",AddToHeaderOrFooter:"AddToHeaderOrFooter",AlignLeft:"AlignLeft",
AlignLeftKeytip:"AlignLeftKeytip",AlignRight:"AlignRight",AlignRightKeytip:"AlignRightKeytip",AlignTextLeft:"AlignTextLeft",AlignTextLeftKeytip:"AlignTextLeftKeytip",AlignTextRight:"AlignTextRight",AlignTextRightKeytip:"AlignTextRightKeytip",AlignmentMenuLabel:"AlignmentMenuLabel",AllBookmarks:"AllBookmarks",AllBookmarksKeytip:"AllBookmarksKeytip",AllBorders:"AllBorders",AllBordersKeyTip:"AllBordersKeyTip",AltText:"AltText",AltTextPictureStandalone:"AltTextPictureStandalone",AltTextTableStandalone:"AltTextTableStandalone",
AltTextKeytip:"AltTextKeytip",ApplyStyle:"ApplyStyle",ApplyStylesKeytip:"ApplyStylesKeytip",AtAGlance:"AtAGlance",AtAGlanceKeytip:"AtAGlanceKeytip",AutoCorrectOptions:"AutoCorrectOptions",AutoCorrectOptionsKeytip:"AutoCorrectOptionsKeytip",AutoDetectedHeadingsFeatureName:"AutoDetectedHeadingsFeatureName",AutoDetectedHeadingsShow:"AutoDetectedHeadingsShow",AutoDetectedHeadingsHide:"AutoDetectedHeadingsHide",AutoDetectedHeadingsMoreInfo:"AutoDetectedHeadingsMoreInfo",AutoDetectedHeadingsDisabledMoreInfo:"AutoDetectedHeadingsDisabledMoreInfo",
AutoDetectedHeadingsLearnMore:"AutoDetectedHeadingsLearnMore",AutomaticFontColor:"AutomaticFontColor",BarTab:"BarTab",BarTabStop:"BarTabStop",Below:"Below",BevelEdgeRectangle:"BevelEdgeRectangle",BeveledMatteWhite:"BeveledMatteWhite",BeveledOvalBlack:"BeveledOvalBlack",BevelPerspective:"BevelPerspective",BevelPerspectiveLeftWhite:"BevelPerspectiveLeftWhite",Bing:"Bing",Bold:"Bold",BoldKeytip:"BoldKeytip",Bookmarks:"Bookmarks",BookmarksKeytip:"BookmarksKeytip",BorderColor:"BorderColor",BorderColorKeytip:"BorderColorKeytip",
BorderLineStyle:"BorderLineStyle",BorderLineStyleKeyTip:"BorderLineStyleKeyTip",BorderLineWeight:"BorderLineWeight",BorderLineWeightKeyTip:"BorderLineWeightKeyTip",BorderSelection:"BorderSelection",BorderSelectionKeytip:"BorderSelectionKeytip",BottomBorder:"BottomBorder",BottomBorderKeyTip:"BottomBorderKeyTip",BtnHeaderFooter:"BtnHeaderFooter",BtnHeaderFooterKeytip:"BtnHeaderFooterKeytip",BulletLibraryTitle:"BulletLibraryTitle",BulletsInDocumentTitle:"BulletsInDocumentTitle",BulletStyle1:"BulletStyle1",
BulletStyle1Keytip:"BulletStyle1Keytip",BulletStyle2:"BulletStyle2",BulletStyle2Keytip:"BulletStyle2Keytip",BulletStyle3:"BulletStyle3",BulletStyle3Keytip:"BulletStyle3Keytip",BusinessBarCompatMessage:"BusinessBarCompatMessage",BusinessBarCompatTitle:"BusinessBarCompatTitle",BusinessBarContainsMalformedHyperlinkUris:"BusinessBarContainsMalformedHyperlinkUris",BusinessBarMarkedAsFinal:"BusinessBarMarkedAsFinal",BusinessBarODTDocument:"BusinessBarODTDocument",BusinessBarODTDocumentDetailsLink:"BusinessBarODTDocumentDetailsLink",
BusinessBarODTDocumentTitle:"BusinessBarODTDocumentTitle",BusinessBarReadOnlyRecommended:"BusinessBarReadOnlyRecommended",BusinessBarSigned:"BusinessBarSigned",ButtonOfficeAddins:"ButtonOfficeAddins",ButtonOfficeAddinsKeytip:"ButtonOfficeAddinsKeytip",Cancel:"Cancel",CatchUpActivity:"CatchUpActivity",CatchUpActivityKeytip:"CatchUpActivityKeytip",Cell:"Cell",CenterTab:"CenterTab",CenterTabStop:"CenterTabStop",CenterShadowRectangle:"CenterShadowRectangle",CentimeterUnitPlaceholder:"CentimeterUnitPlaceholder",
ChangeCase:"ChangeCase",ChangeCaseKeytip:"ChangeCaseKeytip",ChangeCaseCapitalizeEachWord:"ChangeCaseCapitalizeEachWord",ChangeCaseLower:"ChangeCaseLower",ChangeCaseSentence:"ChangeCaseSentence",ChangeCaseToggle:"ChangeCaseToggle",ChangeCaseUpper:"ChangeCaseUpper",ChangePicture:"ChangePicture",ChangePictureKeytip:"ChangePictureKeytip",ChangePictureFromBingPicture:"ChangePictureFromBingPicture",ChangePictureFromBingPictureKeytip:"ChangePictureFromBingPictureKeytip",ChangePictureFromHost:"ChangePictureFromHost",
ChangePictureFromHostKeytip:"ChangePictureFromHostKeytip",ChangePictureFromLocalDevice:"ChangePictureFromLocalDevice",ChangePictureFromLocalDeviceKeytip:"ChangePictureFromLocalDeviceKeytip",ChangePictureFromMobileDevice:"ChangePictureFromMobileDevice",ChangePictureFromMobileDeviceKeytip:"ChangePictureFromMobileDeviceKeytip",ChangePictureFromOneDrive:"ChangePictureFromOneDrive",ChangePictureFromOneDriveKeytip:"ChangePictureFromOneDriveKeytip",ChangePictureFromOnlineM365Picture:"ChangePictureFromOnlineM365Picture",
ChangePictureFromOnlineM365PictureKeytip:"ChangePictureFromOnlineM365PictureKeytip",CharacterUnitPlaceholder:"CharacterUnitPlaceholder",Checklist:"Checklist",ChecklistKeytip:"ChecklistKeytip",ClassicView:"ClassicView",ClassicViewKeytip:"ClassicViewKeytip",Clear:"Clear",ClearAllTabStops:"ClearAllTabStops",ClearButtonTooltip:"ClearButtonTooltip",ClearFormatting:"ClearFormatting",ClearFormattingKeytip:"ClearFormattingKeytip",ClearFormattingOneLineRibbonKeytip:"ClearFormattingOneLineRibbonKeytip",ClearPictureStyle:"ClearPictureStyle",
ClearPictureStyleStandalone:"ClearPictureStyleStandalone",ClearSearch:"ClearSearch",ClearTableFormatting:"ClearTableFormatting",ClearTableFormattingStandalone:"ClearTableFormattingStandalone",ClearTableFormattingKeytip:"ClearTableFormattingKeytip",ClipArt:"ClipArt",ClipArtKeytip:"ClipArtKeytip",ClipboardKeytip:"ClipboardKeytip",Close:"Close",CloseMenu:"CloseMenu",CoauthorGalleryGroupChat:"CoauthorGalleryGroupChat",CoauthorGalleryGroupChatKeytip:"CoauthorGalleryGroupChatKeytip",CoauthorGalleryKeytip:"CoauthorGalleryKeytip",
CoauthorGalleryStatusLabel:"CoauthorGalleryStatusLabel",CoauthorGalleryOverflowTitle:"CoauthorGalleryOverflowTitle",CoauthorGalleryTooltip:"CoauthorGalleryTooltip",CoauthorEnterString:"CoauthorEnterString",Column:"Column",ContinueNumbering:"ContinueNumbering",Conversation:"Conversation",Comment:"Comment",CommentKeytip:"CommentKeytip",Comments:"Comments",CommentsKeytip:"CommentsKeytip",CommentsTooltip:"CommentsTooltip",CompoundFrameBlack:"CompoundFrameBlack",ContactCardButton:"ContactCardButton",ContactCardButtonKeytip:"ContactCardButtonKeytip",
ContactSupport:"ContactSupport",ContactSupportKeytip:"ContactSupportKeytip",ContinuousView:"ContinuousView",ContinuousViewKeytip:"ContinuousViewKeytip",ConvertToPresentation:"ConvertToPresentation",ConvertToPresentationDescription:"ConvertToPresentationDescription",ConvertToPresentationKeytip:"ConvertToPresentationKeytip",Copy:"Copy",CopyHeadingLink:"CopyHeadingLink",CopyHyperlink:"CopyHyperlink",CopyKeyboardShortcutMac:"CopyKeyboardShortcutMac",CopyKeyboardShortcutWindows:"CopyKeyboardShortcutWindows",
CopyKeytip:"CopyKeytip",CopyLinkKeytip:"CopyLinkKeytip",CopyLinkMenuButtonKeytip:"CopyLinkMenuButtonKeytip",CopyTo:"CopyTo",Corrections:"Corrections",CreateNewStyle:"CreateNewStyle",CreateNewStyleKeytip:"CreateNewStyleKeytip",CreatePullQuote:"CreatePullQuote",Crop:"Crop",CropKeytip:"CropKeytip",CropMoreOptions:"CropMoreOptions",CropMoreOptionsKeytip:"CropMoreOptionsKeytip",CropOptions:"CropOptions",CustomTables:"CustomTables",CustomDictionary:"CustomDictionary",Cut:"Cut",CutKeyboardShortcutMac:"CutKeyboardShortcutMac",
CutKeyboardShortcutWindows:"CutKeyboardShortcutWindows",CutKeytip:"CutKeytip",DarkModeGroupTitle:"DarkModeGroupTitle",DarkModeGroupTitleTooltip:"DarkModeGroupTitleTooltip",DarkModeToggle:"DarkModeToggle",DarkModeToggleKeytip:"DarkModeToggleKeytip",DarkModeSwitchBackground:"DarkModeSwitchBackground",DarkModeSwitchBackgroundAriaLabel:"DarkModeSwitchBackgroundAriaLabel",DarkModeSwitchBackgroundKeytip:"DarkModeSwitchBackgroundKeytip",DarkModeSwitchBackgroundTooltipDark:"DarkModeSwitchBackgroundTooltipDark",
DarkModeSwitchBackgroundTooltipLight:"DarkModeSwitchBackgroundTooltipLight",DecimalTab:"DecimalTab",DecimalTabStop:"DecimalTabStop",DecreaseIndent:"DecreaseIndent",DecreaseIndentKeytip:"DecreaseIndentKeytip",DefineNewBullet:"DefineNewBullet",DefineNewBulletKeytip:"DefineNewBulletKeytip",DegreeUnitPlaceholder:"DegreeUnitPlaceholder",Delete:"Delete",DeleteAllComments:"DeleteAllComments",DeleteAllCommentsKeytip:"DeleteAllCommentsKeytip",DeleteAllResolvedComments:"DeleteAllResolvedComments",DeleteAllResolvedCommentsKeytip:"DeleteAllResolvedCommentsKeytip",
DeleteBookmark:"DeleteBookmark",DeleteBookmarkFloatieLabel:"DeleteBookmarkFloatieLabel",DeleteCells:"DeleteCells",DeleteCellsKeytip:"DeleteCellsKeytip",DeleteColumn:"DeleteColumn",DeleteColumnKeytip:"DeleteColumnKeytip",DeleteComment:"DeleteComment",DeleteCommentStandalone:"DeleteCommentStandalone",DeleteCommentKeytip:"DeleteCommentKeytip",DeleteKeytip:"DeleteKeytip",DeleteEntireColumn:"DeleteEntireColumn",DeleteEntireRow:"DeleteEntireRow",DeleteRepeatedWord:"DeleteRepeatedWord",DeleteRow:"DeleteRow",
DeleteRowKeytip:"DeleteRowKeytip",DeleteStyles:"DeleteStyles",DeleteStylesKeytip:"DeleteStylesKeytip",DeleteSavedStyles:"DeleteSavedStyles",DeleteTable:"DeleteTable",DeleteTableKeytip:"DeleteTableKeytip",DeleteTableMenuKeytip:"DeleteTableMenuKeytip",DesignIdeas:"DesignIdeas",Designer:"Designer",DesignerKeytip:"DesignerKeytip",DesignerTooltip:"DesignerTooltip",DesignerProactiveTitle:"DesignerProactiveTitle",DesignerProactiveMessage:"DesignerProactiveMessage",DesignerFullPaneErrorMessage:"DesignerFullPaneErrorMessage",
DesignerUnsupportedWarningTitle:"DesignerUnsupportedWarningTitle",DesignerUnsupportedWarningMessage:"DesignerUnsupportedWarningMessage",DesignerDocumentTooLongWarningTitle:"DesignerDocumentTooLongWarningTitle",DesignerDocumentTooLongWarningMessage:"DesignerDocumentTooLongWarningMessage",DesignerMultipleAuthorsErrorTitle:"DesignerMultipleAuthorsErrorTitle",DesignerMultipleAuthorsErrorMessage:"DesignerMultipleAuthorsErrorMessage",DesignerTryAnywayLabel:"DesignerTryAnywayLabel",DesignerLearnMoreLabel:"DesignerLearnMoreLabel",
DesignerShowAllLabel:"DesignerShowAllLabel",DesignerFRETitle:"DesignerFRETitle",DesignerFREMessage:"DesignerFREMessage",DesignerSuggestionCardHeader:"DesignerSuggestionCardHeader",DesignerFixAndReviewAllTextFormattingLabel:"DesignerFixAndReviewAllTextFormattingLabel",DesignerReviewLabel:"DesignerReviewLabel",DesignerReviewAllAfterApplyingThemeLabel:"DesignerReviewAllAfterApplyingThemeLabel",DesignerParagraphSingular:"DesignerParagraphSingular",DesignerParagraphPlural:"DesignerParagraphPlural",DesignerSuggestionSingular:"DesignerSuggestionSingular",
DesignerSuggestionPlural:"DesignerSuggestionPlural",DesignerOKLabel:"DesignerOKLabel",DesignerNoSuggestionsLabel:"DesignerNoSuggestionsLabel",DesignerFixSingular:"DesignerFixSingular",DesignerFixPlural:"DesignerFixPlural",DesignerIssueSingular:"DesignerIssueSingular",DesignerIssuePlural:"DesignerIssuePlural",DesignerFixAndReviewAllLabel:"DesignerFixAndReviewAllLabel",DesignerFixAllLabel:"DesignerFixAllLabel",DesignerReviewAllLabel:"DesignerReviewAllLabel",DesignerReviewAllTooltip:"DesignerReviewAllTooltip",
DesignerReviewingLabel:"DesignerReviewingLabel",DesignerNoIssuesFoundLabel:"DesignerNoIssuesFoundLabel",DesignerKeepAllLabel:"DesignerKeepAllLabel",DesignerUndoAllLabel:"DesignerUndoAllLabel",DesignerAcceptAllLabel:"DesignerAcceptAllLabel",DesignerRejectAllLabel:"DesignerRejectAllLabel",DesignerTitleFontText:"DesignerTitleFontText",DesignerSubtitleFontText:"DesignerSubtitleFontText",DesignerHeadingFontText:"DesignerHeadingFontText",DesignerBodyFontText:"DesignerBodyFontText",DesignerTitlePreviewText:"DesignerTitlePreviewText",
DesignerHeadingPreviewText:"DesignerHeadingPreviewText",DesignerBodyPreviewText1:"DesignerBodyPreviewText1",DesignerBodyPreviewText2:"DesignerBodyPreviewText2",DesignerAuthorPreviewText:"DesignerAuthorPreviewText",DesignerCompanyInstitutionPreviewText:"DesignerCompanyInstitutionPreviewText",DesignerDatePreviewText:"DesignerDatePreviewText",DesignerThemesSectionHeader:"DesignerThemesSectionHeader",DesignerThemesHeader:"DesignerThemesHeader",DesignerCoverPagesSectionHeader:"DesignerCoverPagesSectionHeader",
DesignerThemesWithText2ImageSectionHeader:"DesignerThemesWithText2ImageSectionHeader",DesignerTemplatesSectionHeader:"DesignerTemplatesSectionHeader",DesignerShowMoreThemesLabel:"DesignerShowMoreThemesLabel",DesignerMoreThemesLoadedAlert:"DesignerMoreThemesLoadedAlert",DesignerSendFeedbackHeadingLabel:"DesignerSendFeedbackHeadingLabel",DesignerSendFeedbackLabel:"DesignerSendFeedbackLabel",DesignerSendFeedbackTooltip:"DesignerSendFeedbackTooltip",DesignerJoinTestingGroupHeadingLabel:"DesignerJoinTestingGroupHeadingLabel",
DesignerJoinTestingGroupLabel:"DesignerJoinTestingGroupLabel",DesignerJoinTestingGroupTooltip:"DesignerJoinTestingGroupTooltip",DesignerFeedbackCallout:"DesignerFeedbackCallout",DesignerStyleAriaLabel:"DesignerStyleAriaLabel",DesignerStyleThemeWithDecoratorAriaLabel:"DesignerStyleThemeWithDecoratorAriaLabel",DesignerStyleTabularTitleDecoratorAriaLabel:"DesignerStyleTabularTitleDecoratorAriaLabel",DesignerStyleThemeImageDecoratorAriaLabel:"DesignerStyleThemeImageDecoratorAriaLabel",DesignerText2ImageDecoratorAriaLabel:"DesignerText2ImageDecoratorAriaLabel",
DesignerStyleCoverPageDecoratorAriaLabel:"DesignerStyleCoverPageDecoratorAriaLabel",DesignerStyleTabularTitleDecoratorAltTextTitle:"DesignerStyleTabularTitleDecoratorAltTextTitle",DesignerStyleImageD10TIAltTextTitle:"DesignerStyleImageD10TIAltTextTitle",DesignerStyleImageD1TIAltTextTitle:"DesignerStyleImageD1TIAltTextTitle",DesignerStyleImageD6TIAltTextTitle:"DesignerStyleImageD6TIAltTextTitle",DesignerLoadingStyleAriaLabel:"DesignerLoadingStyleAriaLabel",DesignerStyleFontAvenir:"DesignerStyleFontAvenir",
DesignerStyleFontCentury:"DesignerStyleFontCentury",DesignerStyleFontSitka:"DesignerStyleFontSitka",DesignerStyleFontWalbaum:"DesignerStyleFontWalbaum",DesignerStyleFontRockwellNova:"DesignerStyleFontRockwellNova",DesignerStyleFontUnivers:"DesignerStyleFontUnivers",DesignerStyleFontSagona:"DesignerStyleFontSagona",DesignerStyleFontFranklin:"DesignerStyleFontFranklin",DesignerStyleFontPerpetua:"DesignerStyleFontPerpetua",DesignerStyleFontAmasisMTPro:"DesignerStyleFontAmasisMTPro",DesignerStyleFontSabonNextLT:"DesignerStyleFontSabonNextLT",
DesignerStyleFontTradeGothicNext:"DesignerStyleFontTradeGothicNext",DesignerStyleFontCooperBlack:"DesignerStyleFontCooperBlack",DesignerStyleFontNeueHaasGroteskTextPro:"DesignerStyleFontNeueHaasGroteskTextPro",DesignerStyleFontTisaOffcSerifPro:"DesignerStyleFontTisaOffcSerifPro",DesignerStyleFontQuireSans:"DesignerStyleFontQuireSans",DesignerStyleFontGillSansNova:"DesignerStyleFontGillSansNova",DesignerStyleFontSagonaBook:"DesignerStyleFontSagonaBook",DesignerStyleFontAvenirNextDemiBold:"DesignerStyleFontAvenirNextDemiBold",
DesignerStyleFontTheHand:"DesignerStyleFontTheHand",DesignerStyleFontGoudyType:"DesignerStyleFontGoudyType",DesignerStyleFontPlantagenetCherokee:"DesignerStyleFontPlantagenetCherokee",DesignerStyleFontFootlightMTLight:"DesignerStyleFontFootlightMTLight",DesignerStyleFontBaskervilleOldFace:"DesignerStyleFontBaskervilleOldFace",DesignerStyleFontLucidaCalligraphy:"DesignerStyleFontLucidaCalligraphy",DesignerStyleFontEbrima:"DesignerStyleFontEbrima",DesignerStyleFontCorbel:"DesignerStyleFontCorbel",DesignerStyleColorBlueAccent:"DesignerStyleColorBlueAccent",
DesignerStyleColorOrangeAccent:"DesignerStyleColorOrangeAccent",DesignerStyleColorGreenAccent:"DesignerStyleColorGreenAccent",DesignerStyleColorMediumSlateBlue:"DesignerStyleColorMediumSlateBlue",DesignerStyleColorRoyalBlue:"DesignerStyleColorRoyalBlue",DesignerStyleColorPacificBlue:"DesignerStyleColorPacificBlue",DesignerErrorStateTitle:"DesignerErrorStateTitle",DesignerErrorStateMessage:"DesignerErrorStateMessage",DesignerTemporaryIssueTitle:"DesignerTemporaryIssueTitle",DesignerTrackChangeUnsupportedMessage:"DesignerTrackChangeUnsupportedMessage",
DesignerErrorStateTryAgainButton:"DesignerErrorStateTryAgainButton",DesignerRevertButtonLabel:"DesignerRevertButtonLabel",Diagnostics:"Diagnostics",DiagnosticsBuild:"DiagnosticsBuild",DiagnosticsDescription:"DiagnosticsDescription",DiagnosticsSessionId:"DiagnosticsSessionId",DialogMove:"DialogMove",DictationLabel:"DictationLabel",DictationKeytip:"DictationKeytip",DigitalPrintKeytip:"DigitalPrintKeytip",DirectPrintJewelButton:"DirectPrintJewelButton",DirectPrintJewelButtonKeytip:"DirectPrintJewelButtonKeytip",
DirectPrintJewelDescription:"DirectPrintJewelDescription",DistributeColumns:"DistributeColumns",DistributeColumnsKeytip:"DistributeColumnsKeytip",DistributeMenu:"DistributeMenu",DistributeMenuKeytip:"DistributeMenuKeytip",DistributeRows:"DistributeRows",DistributeRowsKeytip:"DistributeRowsKeytip",DocChatLabel:"DocChatLabel",DocChatKeytip:"DocChatKeytip",DoNotCheckForThisIssue:"DoNotCheckForThisIssue",DoNotCheckSpellingOrGrammar:"DoNotCheckSpellingOrGrammar",DoubleFrameBlack:"DoubleFrameBlack",Download:"Download",
DownloadACopy:"DownloadACopy",DownloadACopyKeytip:"DownloadACopyKeytip",DownloadAsODT:"DownloadAsODT",DownloadAsODTDescription:"DownloadAsODTDescription",DownloadAsODTKeytip:"DownloadAsODTKeytip",DownloadAsPDF:"DownloadAsPDF",DownloadAsPDFDescription:"DownloadAsPDFDescription",DownloadAsPDFKeytip:"DownloadAsPDFKeytip",DownloadDescription:"DownloadDescription",DownloadErrorReport:"DownloadErrorReport",DraftView:"DraftView",DraftViewKeytip:"DraftViewKeytip",Drawing:"Drawing",DrawingKeytip:"DrawingKeytip",
DropShadowRectangle:"DropShadowRectangle",Edit:"Edit",EditBookmark:"EditBookmark",EditBookmarkFloatieLabel:"EditBookmarkFloatieLabel",EditDocument:"EditDocument",EditHyperlink:"EditHyperlink",EditIllustration:"EditIllustration",EditInWord:"EditInWord",EditInWordFileMenu:"EditInWordFileMenu",EditInWordFileMenuDescription:"EditInWordFileMenuDescription",EditInWordKeytip:"EditInWordKeytip",EditInWordOneLineRibbonKeytip:"EditInWordOneLineRibbonKeytip",EditInWordWebAppDescription:"EditInWordWebAppDescription",
Editor:"Editor",EditorKeytip:"EditorKeytip",EditorScoreInStatusBarTooltip:"EditorScoreInStatusBarTooltip",EditorScorePercent:"EditorScorePercent",EditorSettings:"EditorSettings",EditView:"EditView",EditViewKeytip:"EditViewKeytip",EmailLink:"EmailLink",EmailLinkKeytip:"EmailLinkKeytip",Embed:"Embed",EmbedDescription:"EmbedDescription",EmbedKeytip:"EmbedKeytip",EmojiPlural:"EmojiPlural",EmojiSingle:"EmojiSingle",EmojiSingleKeytip:"EmojiSingleKeytip",Endnote:"Endnote",EndnoteKeytip:"EndnoteKeytip",Endnotes:"Endnotes",
EndnotesKeytip:"EndnotesKeytip",Enterlink:"Enterlink",EnterlinkKeytip:"EnterlinkKeytip",EquationTools:"EquationTools",EquationToolsKeyTip:"EquationToolsKeyTip",EquationToolsGroup:"EquationToolsGroup",EquationToolsShortHandName:"EquationToolsShortHandName",Error:"Error",Exit:"Exit",ExitKeytip:"ExitKeytip",Explore:"Explore",Export:"Export",ExportToPresentation:"ExportToPresentation",ExportToPresentationDescription:"ExportToPresentationDescription",ExternalContentChangeDefaultDialogDescription:"ExternalContentChangeDefaultDialogDescription",
ExternalContentChangeDefaultDialogInformation:"ExternalContentChangeDefaultDialogInformation",ExternalContentChangeDefaultDialogTitle:"ExternalContentChangeDefaultDialogTitle",ExternalContentGalleryChangeDefault:"ExternalContentGalleryChangeDefault",ExternalContentGalleryContent:"ExternalContentGalleryContent",ExternalContentGalleryHyperLink:"ExternalContentGalleryHyperLink",ExternalContentGalleryLabel:"ExternalContentGalleryLabel",FileAboutKeytip:"FileAboutKeytip",FileHomeKeytip:"FileHomeKeytip",
FileInfoKeytip:"FileInfoKeytip",FileMenuBackButton:"FileMenuBackButton",FileMenuBackButtonAriaLabel:"FileMenuBackButtonAriaLabel",FileMenuBlankDocument:"FileMenuBlankDocument",FileMenuPrintToWeb:"FileMenuPrintToWeb",FileMenuPrintToWebDescription:"FileMenuPrintToWebDescription",FileNewKeytip:"FileNewKeytip",FileOpenKeytip:"FileOpenKeytip",FilePrintKeytip:"FilePrintKeytip",FileSaveAsKeytip:"FileSaveAsKeytip",FileShareKeytip:"FileShareKeytip",FileTransformKeytip:"FileTransformKeytip",Find:"Find",FindKeytip:"FindKeytip",
FindReplace:"FindReplace",FindTooltip:"FindTooltip",FindReplaceToolTip:"FindReplaceToolTip",FindResultText:"FindResultText",FindWholeWords:"FindWholeWords",FirstLineIndent:"FirstLineIndent",Fit:"Fit",FlipHorizontalKeytip:"FlipHorizontalKeytip",FlipVerticalKeytip:"FlipVerticalKeytip",FollowPresenter:"FollowPresenter",FontColorAutomaticKeytip:"FontColorAutomaticKeytip",FontColorYellow:"FontColorYellow",FontColorGreen:"FontColorGreen",FontColorCyan:"FontColorCyan",FontColorMagenta:"FontColorMagenta",
FontColorBlue:"FontColorBlue",FontColorRed:"FontColorRed",FontColorDarkBlue:"FontColorDarkBlue",FontColorDarkCyan:"FontColorDarkCyan",FontColorDarkGreen:"FontColorDarkGreen",FontColorDarkMagenta:"FontColorDarkMagenta",FontColorDarkRed:"FontColorDarkRed",FontColorDarkYellow:"FontColorDarkYellow",FontColorGrey:"FontColorGrey",FontColorLightGrey:"FontColorLightGrey",FontColorBlack:"FontColorBlack",FontName:"FontName",FontNameKeytip:"FontNameKeytip",FontPickerAllFontsSection:"FontPickerAllFontsSection",
FontPickerPinnedFontsSection:"FontPickerPinnedFontsSection",FontPickerMruSection:"FontPickerMruSection",FontPickerOrganizationSection:"FontPickerOrganizationSection",FontPickerInfoCommand:"FontPickerInfoCommand",FontPickerPinnedTooltip:"FontPickerPinnedTooltip",FontPickerUnpinnedTooltip:"FontPickerUnpinnedTooltip",FontPickerThemeFontTooltip:"FontPickerThemeFontTooltip",FontPickerEmbeddedFontTooltip:"FontPickerEmbeddedFontTooltip",FontPickerPremiumFontTooltip:"FontPickerPremiumFontTooltip",FontPickerMissingFontTooltip:"FontPickerMissingFontTooltip",
FontPickerCompatibilityFontTooltip:"FontPickerCompatibilityFontTooltip",FontPickerNewFontHeader:"FontPickerNewFontHeader",FontPickerSearchNoResult:"FontPickerSearchNoResult",FontPickerNoActionLabel:"FontPickerNoActionLabel",FontPickerPremiumFontsTitle:"FontPickerPremiumFontsTitle",FontPickerPremiumFontsBody:"FontPickerPremiumFontsBody",FontPickerPremiumFontsBody2:"FontPickerPremiumFontsBody2",FontPickerHelpContentTitle:"FontPickerHelpContentTitle",FontPickerPinnedFontAnnouncement:"FontPickerPinnedFontAnnouncement",
FontPickerUnPinnedFontAnnouncement:"FontPickerUnPinnedFontAnnouncement",FontPickerNumberOfSuggestionsAnnouncement:"FontPickerNumberOfSuggestionsAnnouncement",FontPickerNoSuggestionsAnnouncement:"FontPickerNoSuggestionsAnnouncement",FontPickerNumberOfSuggestionsInGroupAnnouncement:"FontPickerNumberOfSuggestionsInGroupAnnouncement",FontPickerPinnedDescription:"FontPickerPinnedDescription",FontPickerUnpinnedDescription:"FontPickerUnpinnedDescription",FontPickerFontPinningTooltip:"FontPickerFontPinningTooltip",
FontPickerFontMissingFontTooltip:"FontPickerFontMissingFontTooltip",FontPickerFontOtherActionTooltip:"FontPickerFontOtherActionTooltip",FontSize:"FontSize",FontSizeKeytip:"FontSizeKeytip",FontSize8:"FontSize8",FontSize9:"FontSize9",FontSize10:"FontSize10",FontSize11:"FontSize11",FontSize12:"FontSize12",FontSize14:"FontSize14",FontSize16:"FontSize16",FontSize18:"FontSize18",FontSize20:"FontSize20",FontSize24:"FontSize24",FontSize26:"FontSize26",FontSize28:"FontSize28",FontSize36:"FontSize36",FontSize48:"FontSize48",
FontSize72:"FontSize72",Footnote:"Footnote",FootnoteKeytip:"FootnoteKeytip",FootnotesMenu:"FootnotesMenu",FormatPainter:"FormatPainter",FormatPainterKeytip:"FormatPainterKeytip",FormatPicture:"FormatPicture",FormatPictureAltSectionTitle:"FormatPictureAltSectionTitle",FormatPictureAltDescriptionLabel:"FormatPictureAltDescriptionLabel",FormatPictureAltTitleLabel:"FormatPictureAltTitleLabel",FormatPictureCropSectionTitle:"FormatPictureCropSectionTitle",FormatPictureCropBottomLabel:"FormatPictureCropBottomLabel",
FormatPictureCropLeftLabel:"FormatPictureCropLeftLabel",FormatPictureCropRightLabel:"FormatPictureCropRightLabel",FormatPictureCropTopLabel:"FormatPictureCropTopLabel",FormatPictureKeytip:"FormatPictureKeytip",FormatPictureEllipses:"FormatPictureEllipses",FormatPictureRotationSectionTitle:"FormatPictureRotationSectionTitle",FormatPictureRotationDegreeLabel:"FormatPictureRotationDegreeLabel",FrenchAccessibilityStatementLinkText:"FrenchAccessibilityStatementLinkText",FullJustify:"FullJustify",FullJustifyKeytip:"FullJustifyKeytip",
GetLink:"GetLink",GrammarSettings:"GrammarSettings",GrammarSettingsKeytip:"GrammarSettingsKeytip",GiveFeedback:"GiveFeedback",GiveFeedbackShort:"GiveFeedbackShort",GiveFeedbackDescription:"GiveFeedbackDescription",GiveFeedbackKeytip:"GiveFeedbackKeytip",GoToLocation:"GoToLocation",GoToLocationKeytip:"GoToLocationKeytip",GridTables:"GridTables",GroupAlignment:"GroupAlignment",GroupAlignmentStandalone:"GroupAlignmentStandalone",GroupApps:"GroupApps",GroupArrange:"GroupArrange",GroupClipboard:"GroupClipboard",
GroupChanges:"GroupChanges",GroupCommentsKeytip:"GroupCommentsKeytip",GroupDelete:"GroupDelete",GroupDictation:"GroupDictation",GroupDocumentViews:"GroupDocumentViews",GroupDocumentViewsTooltip:"GroupDocumentViewsTooltip",GroupEditing:"GroupEditing",GroupFindReplaceKeytip:"GroupFindReplaceKeytip",GroupFont:"GroupFont",GroupFontKeytip:"GroupFontKeytip",GroupFontTooltip:"GroupFontTooltip",GroupFootnoteEndnote:"GroupFootnoteEndnote",GroupHeaderFooter:"GroupHeaderFooter",GroupHeaderFooterKeytip:"GroupHeaderFooterKeytip",
GroupHomeParagraphKeytip:"GroupHomeParagraphKeytip",GroupImageAdjust:"GroupImageAdjust",GroupImageSize:"GroupImageSize",GroupImageSizeFlyout:"GroupImageSizeFlyout",GroupImageSizeKeytip:"GroupImageSizeKeytip",GroupImageText:"GroupImageText",GroupInsert:"GroupInsert",GroupInsertTooltip:"GroupInsertTooltip",GroupLanguage:"GroupLanguage",GroupLinks:"GroupLinks",GroupMedia:"GroupMedia",GroupMerge:"GroupMerge",GroupMergeKeytip:"GroupMergeKeytip",GroupMultimedia:"GroupMultimedia",GroupPageBreak:"GroupPageBreak",
GroupPageLayoutParagraph:"GroupPageLayoutParagraph",GroupPageLayoutParagraphKeytip:"GroupPageLayoutParagraphKeytip",GroupPageSetup:"GroupPageSetup",GroupPageSetupTooltip:"GroupPageSetupTooltip",GroupParagraph:"GroupParagraph",GroupParagraphTooltip:"GroupParagraphTooltip",GroupParagraphKeytip:"GroupParagraphKeytip",GroupPictureFormat:"GroupPictureFormat",GroupPictureFormatTooltip:"GroupPictureFormatTooltip",GroupPictureKeytip:"GroupPictureKeytip",GroupProofing:"GroupProofing",GroupProofingTooltip:"GroupProofingTooltip",
GroupSelect:"GroupSelect",GroupShading:"GroupShading",GroupSpelling:"GroupSpelling",GroupStyles:"GroupStyles",GroupStylesTooltip:"GroupStylesTooltip",GroupStylesKeytip:"GroupStylesKeytip",GroupTable:"GroupTable",GroupTableBorders:"GroupTableBorders",GroupTableDeleteKeytip:"GroupTableDeleteKeytip",GroupTableTooltip:"GroupTableTooltip",GroupTableOfContents:"GroupTableOfContents",GroupTableOfContentsKeytip:"GroupTableOfContentsKeytip",GroupTableOptionsKeytip:"GroupTableOptionsKeytip",GroupTables:"GroupTables",
GroupTableSelectKeytip:"GroupTableSelectKeytip",GroupTableStyleOptions:"GroupTableStyleOptions",GroupTableStyles:"GroupTableStyles",GroupTracking:"GroupTracking",GroupTrackingKeytip:"GroupTrackingKeytip",GroupTrackMarkup:"GroupTrackMarkup",GroupTrackMarkupKeytip:"GroupTrackMarkupKeytip",GroupUndoRedo:"GroupUndoRedo",GroupUndoRedoTooltip:"GroupUndoRedoTooltip",GroupWordCount:"GroupWordCount",Grow:"Grow",GrowFont:"GrowFont",GrowFontSize:"GrowFontSize",GrowFontSizeKeytip:"GrowFontSizeKeytip",GrowKeytip:"GrowKeytip",
HangingIndent:"HangingIndent",HeadingDetectionInIdeas:"HeadingDetectionInIdeas",HeadingsExplanationFirst:"HeadingsExplanationFirst",HeadingsExplanationSecond:"HeadingsExplanationSecond",HeadingsExplanationThird:"HeadingsExplanationThird",HeadingsTab:"HeadingsTab",Help:"Help",HelpButtonDescription:"HelpButtonDescription",HelpButtonKeytip:"HelpButtonKeytip",HelpButtonTitle:"HelpButtonTitle",HelpButtonTitleKeytip:"HelpButtonTitleKeytip",HelpImproveOffice:"HelpImproveOffice",HelpKeytip:"HelpKeytip",HelpTabKeytip:"HelpTabKeytip",
HideRuler:"HideRuler",Highlight:"Highlight",HighlightColor:"HighlightColor",Hyperlink:"Hyperlink",HyperlinkKeytip:"HyperlinkKeytip",Ideas:"Ideas",IdeasKeytip:"IdeasKeytip",Ignore:"Ignore",IgnoreAll:"IgnoreAll",IgnoreOnce:"IgnoreOnce",Illustrations:"Illustrations",IllustrationsKeytip:"IllustrationsKeytip",ImmersiveReaderKeytip:"ImmersiveReaderKeytip",ImmersiveView:"ImmersiveView",InchUnitPlaceholder:"InchUnitPlaceholder",IncludePageCount:"IncludePageCount",IncludePageCountKeytip:"IncludePageCountKeytip",
IncreaseIndent:"IncreaseIndent",IncreaseIndentKeytip:"IncreaseIndentKeytip",Info:"Info",InfoKeytip:"InfoKeytip",Information:"Information",InsertAbove:"InsertAbove",InsertAboveStandalone:"InsertAboveStandalone",InsertAboveKeytip:"InsertAboveKeytip",InsertBelow:"InsertBelow",InsertBelowStandalone:"InsertBelowStandalone",InsertBelowKeytip:"InsertBelowKeytip",InsertBookmark:"InsertBookmark",InsertBookmarkKeytip:"InsertBookmarkKeytip",InsertFilesLink:"InsertFilesLink",InsertFilesLinkKeyTip:"InsertFilesLinkKeyTip",
InsertHyperlink:"InsertHyperlink",InsertHyperlinkKeytip:"InsertHyperlinkKeytip",InsertIntelligentPlaceholder:"InsertIntelligentPlaceholder",InsertLeft:"InsertLeft",InsertLeftStandalone:"InsertLeftStandalone",InsertLeftKeytip:"InsertLeftKeytip",InsertPictureFrom:"InsertPictureFrom",InsertRight:"InsertRight",InsertRightStandalone:"InsertRightStandalone",InsertRightKeytip:"InsertRightKeytip",InsertTableMenuKeytip:"InsertTableMenuKeytip",InsertTableDialogKeytip:"InsertTableDialogKeytip",InsertTableOfContents:"InsertTableOfContents",
InsertTableOfContentsKeytip:"InsertTableOfContentsKeytip",InsertTabStop:"InsertTabStop",InsideBorders:"InsideBorders",InsideBordersKeyTip:"InsideBordersKeyTip",InsideHorizontalBorder:"InsideHorizontalBorder",InsideHorizontalBorderKeyTip:"InsideHorizontalBorderKeyTip",InsideVerticalBorder:"InsideVerticalBorder",InsideVerticalBorderKeyTip:"InsideVerticalBorderKeyTip",Insights:"Insights",InsightsDictionary:"InsightsDictionary",InsightsMenu:"InsightsMenu",InsightsMenuKeytip:"InsightsMenuKeytip",InsightsMenuSimplification:"InsightsMenuSimplification",
IntelligentPlaceholderTabExplanationFirst:"IntelligentPlaceholderTabExplanationFirst",IntelligentPlaceholderTabExplanationSecond:"IntelligentPlaceholderTabExplanationSecond",IntelligentPlaceholderTabExplanationThird:"IntelligentPlaceholderTabExplanationThird",IntelligentPlaceholderTabKeyboardShortcut:"IntelligentPlaceholderTabKeyboardShortcut",IntelligentPlaceholderTab:"IntelligentPlaceholderTab",Italic:"Italic",ItalicKeytip:"ItalicKeytip",JewelText:"JewelText",JewelTextKeytip:"JewelTextKeytip",JustifyBottomCenter:"JustifyBottomCenter",
JustifyBottomCenterKeytip:"JustifyBottomCenterKeytip",JustifyBottomLeft:"JustifyBottomLeft",JustifyBottomLeftKeytip:"JustifyBottomLeftKeytip",JustifyBottomRight:"JustifyBottomRight",JustifyBottomRightKeytip:"JustifyBottomRightKeytip",JustifyCenter:"JustifyCenter",JustifyCenterKeytip:"JustifyCenterKeytip",JustifyMiddleCenter:"JustifyMiddleCenter",JustifyMiddleCenterKeytip:"JustifyMiddleCenterKeytip",JustifyMiddleLeft:"JustifyMiddleLeft",JustifyMiddleLeftKeytip:"JustifyMiddleLeftKeytip",JustifyMiddleRight:"JustifyMiddleRight",
JustifyMiddleRightKeytip:"JustifyMiddleRightKeytip",JustifyTopCenter:"JustifyTopCenter",JustifyTopCenterKeytip:"JustifyTopCenterKeytip",JustifyTopLeft:"JustifyTopLeft",JustifyTopLeftKeytip:"JustifyTopLeftKeytip",JustifyTopRight:"JustifyTopRight",JustifyTopRightKeytip:"JustifyTopRightKeytip",KeypointsInIdeas:"KeypointsInIdeas",KeytipStartSequence:"KeytipStartSequence",KeytipStartKeyMac:"KeytipStartKeyMac",KeytipStartKeyWindows:"KeytipStartKeyWindows",LabelIndent:"LabelIndent",LabelIndentAfterLtr:"LabelIndentAfterLtr",
LabelIndentBeforeLtr:"LabelIndentBeforeLtr",LabelSpacing:"LabelSpacing",LabelSpacingAfter:"LabelSpacingAfter",LabelSpacingBefore:"LabelSpacingBefore",LanguageDialogDescription:"LanguageDialogDescription",LearnMore:"LearnMore",Left:"Left",LeftBorder:"LeftBorder",LeftBorderKeyTip:"LeftBorderKeyTip",LeftIndent:"LeftIndent",LeftTab:"LeftTab",LeftTabStop:"LeftTabStop",LegacyView:"LegacyView",LegacyViewKeytip:"LegacyViewKeytip",LineSpacing:"LineSpacing",LineSpacing_1_0:"LineSpacing_1_0",LineSpacing_1_15:"LineSpacing_1_15",
LineSpacing_1_5:"LineSpacing_1_5",LineSpacing_2_0:"LineSpacing_2_0",LineSpacing_2_5:"LineSpacing_2_5",LineSpacing_3_0:"LineSpacing_3_0",LineSpacingKeytip:"LineSpacingKeytip",LineSpacingOptions:"LineSpacingOptions",LineSpacingOptionsKeytip:"LineSpacingOptionsKeytip",LineUnitPlaceholder:"LineUnitPlaceholder",ListLibraryTitle:"ListLibraryTitle",ListTables:"ListTables",LiveViewInBrowser:"LiveViewInBrowser",LoadingMessage:"LoadingMessage",LockAspectRatio:"LockAspectRatio",LockAspectRatioKeytip:"LockAspectRatioKeytip",
LoopComponent:"LoopComponent",LoopComponentKeytip:"LoopComponentKeytip",LoopComponentPoll:"LoopComponentPoll",LoopComponentPollKeytip:"LoopComponentPollKeytip",ManageAccess:"ManageAccess",ManageAccessKeytip:"ManageAccessKeytip",ManageDefaultStyle:"ManageDefaultStyle",MarkAsRead:"MarkAsRead",MarkAsReadTooltip:"MarkAsReadTooltip",MarkAsReadKeytip:"MarkAsReadKeytip",MarkSelectedText:"MarkSelectedText",MarkupOnPage:"MarkupOnPage",MarkupOnPageKeytip:"MarkupOnPageKeytip",MarkupOnPageTooltip:"MarkupOnPageTooltip",
MarkupOnPageAllMarkup:"MarkupOnPageAllMarkup",MarkupOnPageAllMarkupDescription:"MarkupOnPageAllMarkupDescription",MarkupOnPageAllMarkupKeytip:"MarkupOnPageAllMarkupKeytip",MarkupOnPageAllMarkupTooltip:"MarkupOnPageAllMarkupTooltip",MarkupOnPageSimpleMarkupDescription:"MarkupOnPageSimpleMarkupDescription",MarkupOnPageSimpleMarkup:"MarkupOnPageSimpleMarkup",MarkupOnPageSimpleMarkupKeytip:"MarkupOnPageSimpleMarkupKeytip",MarkupOnPageSimpleMarkupTooltip:"MarkupOnPageSimpleMarkupTooltip",MatchCase:"MatchCase",
MenuBullets:"MenuBullets",MenuClipboard:"MenuClipboard",MenuClipboardTooltip:"MenuClipboardTooltip",MenuBulletsKeytip:"MenuBulletsKeytip",MenuFootnoteKeytip:"MenuFootnoteKeytip",MenuFontColor:"MenuFontColor",MenuFontColorFullDesc:"MenuFontColorFullDesc",MenuFontColorKeytip:"MenuFontColorKeytip",MenuHighlightColor:"MenuHighlightColor",MenuHighlightColorKeytip:"MenuHighlightColorKeytip",MenuInsertTable:"MenuInsertTable",MenuInsertTableDialog:"MenuInsertTableDialog",MenuInsertTableFull:"MenuInsertTableFull",
MenuInsertTableGrid:"MenuInsertTableGrid",MarkIntelligentPlaceholderComplete:"MarkIntelligentPlaceholderComplete",MenuMoreStyles:"MenuMoreStyles",MenuMoreStylesKeytip:"MenuMoreStylesKeytip",MenuMultilevelList:"MenuMultilevelList",MenuMultilevelListKeytip:"MenuMultilevelListKeytip",MenuNumbering:"MenuNumbering",MenuNumberingKeytip:"MenuNumberingKeytip",MenuShadingColor:"MenuShadingColor",MenuShadingColorKeytip:"MenuShadingColorKeytip",MenuSpellingAndGrammarKeytip:"MenuSpellingAndGrammarKeytip",MenuStyles:"MenuStyles",
MenuTableAlignKeytip:"MenuTableAlignKeytip",MenuTableTheme:"MenuTableTheme",MenuTableThemeKeytip:"MenuTableThemeKeytip",MergeCells:"MergeCells",MergeCellsKeytip:"MergeCellsKeytip",MetalFrame:"MetalFrame",MetalOval:"MetalOval",MetalRoundedRectangle:"MetalRoundedRectangle",MobileDevice:"MobileDevice",MobileDeviceKeytip:"MobileDeviceKeytip",ModerateFrameBlack:"ModerateFrameBlack",ModerateFrameWhite:"ModerateFrameWhite",ModernUXOptIn:"ModernUXOptIn",More:"More",MoreDocuments:"MoreDocuments",MoreTemplates:"MoreTemplates",
ModernTranslator:"ModernTranslator",ModernTranslatorDocumentTitle:"ModernTranslatorDocumentTitle",ModernTranslatorDocumentKeytip:"ModernTranslatorDocumentKeytip",ModernTranslatorKeytip:"ModernTranslatorKeytip",ModernTranslatorSelectionTitle:"ModernTranslatorSelectionTitle",ModernTranslatorSelectionKeytip:"ModernTranslatorSelectionKeytip",ModernTranslatorSettingsTitle:"ModernTranslatorSettingsTitle",ModernTranslatorSettingsKeytip:"ModernTranslatorSettingsKeytip",ModernTranslatorTaskPaneTitle:"ModernTranslatorTaskPaneTitle",
ModeSwitcherCalloutTextMarkedAsFinal:"ModeSwitcherCalloutTextMarkedAsFinal",ModeSwitcherCalloutTextOpenReadOnly:"ModeSwitcherCalloutTextOpenReadOnly",ModeSwitcherCalloutTextViewOnly:"ModeSwitcherCalloutTextViewOnly",ModeSwitcherCalloutTextIsReviewer:"ModeSwitcherCalloutTextIsReviewer",ModeSwitcherCalloutTextTrackChangeForEveryoneEnabled:"ModeSwitcherCalloutTextTrackChangeForEveryoneEnabled",ModeSwitcherCalloutTitleMarkedAsFinal:"ModeSwitcherCalloutTitleMarkedAsFinal",ModeSwitcherCalloutTitleOpenReadOnly:"ModeSwitcherCalloutTitleOpenReadOnly",
ModeSwitcherCalloutTitleViewOnly:"ModeSwitcherCalloutTitleViewOnly",ModeSwitcherCalloutTitleIsReviewer:"ModeSwitcherCalloutTitleIsReviewer",ModeSwitcherCalloutTitleTrackChangeForEveryoneEnabled:"ModeSwitcherCalloutTitleTrackChangeForEveryoneEnabled",ModeSwitcherEditModeInMenuDescription:"ModeSwitcherEditModeInMenuDescription",ModeSwitcherEditModeInMenuLabel:"ModeSwitcherEditModeInMenuLabel",ModeSwitcherEditModeLabel:"ModeSwitcherEditModeLabel",ModeSwitcherEditModeKeytip:"ModeSwitcherEditModeKeytip",
ModeSwitcherEditModeTooltip:"ModeSwitcherEditModeTooltip",ModeSwitcherFlyoutAnchorKeytip:"ModeSwitcherFlyoutAnchorKeytip",ModeSwitcherMenuTitle:"ModeSwitcherMenuTitle",ModeSwitcherSuggestModeInMenuDescription:"ModeSwitcherSuggestModeInMenuDescription",ModeSwitcherSuggestModeInMenuLabel:"ModeSwitcherSuggestModeInMenuLabel",ModeSwitcherSuggestModeLabel:"ModeSwitcherSuggestModeLabel",ModeSwitcherSuggestModeKeytip:"ModeSwitcherSuggestModeKeytip",ModeSwitcherSuggestModeTooltip:"ModeSwitcherSuggestModeTooltip",
ModeSwitcherViewModeInMenuDescription:"ModeSwitcherViewModeInMenuDescription",ModeSwitcherViewModeInMenuLabel:"ModeSwitcherViewModeInMenuLabel",ModeSwitcherViewModeLabel:"ModeSwitcherViewModeLabel",ModeSwitcherViewModeKeytip:"ModeSwitcherViewModeKeytip",ModeSwitcherViewModeTooltip:"ModeSwitcherViewModeTooltip",ModeSwitcherWarningPromptTrackChangesOff:"ModeSwitcherWarningPromptTrackChangesOff",ModeSwitchSuggestingContextMenu:"ModeSwitchSuggestingContextMenu",MoreEmojis:"MoreEmojis",MoreEmojisKeytip:"MoreEmojisKeytip",
MoreColors:"MoreColors",MoreColorsKeytip:"MoreColorsKeytip",MorePanes:"MorePanes",MoreStyles:"MoreStyles",MoreStylesKeytip:"MoreStylesKeytip",MoreSymbols:"MoreSymbols",MoreSymbolsKeytip:"MoreSymbolsKeytip",MoreTabs:"MoreTabs",MoveTo:"MoveTo",MRUErrorMessage:"MRUErrorMessage",MRUMoreLink:"MRUMoreLink",MultilevelList:"MultilevelList",MultilevelListLabelNumericalStyle:"MultilevelListLabelNumericalStyle",MultilevelListLabelAlphanumericalStyle:"MultilevelListLabelAlphanumericalStyle",MultilevelListLabelBulletedStyle:"MultilevelListLabelBulletedStyle",
Navigation:"Navigation",NavigationStandalone:"NavigationStandalone",NavigationPaneButtonText:"NavigationPaneButtonText",NavigationPaneButtonTextKeytip:"NavigationPaneButtonTextKeytip",NegativeSign:"NegativeSign",New:"New",NewBlankDocument:"NewBlankDocument",NewComment:"NewComment",NewCommentKeytip:"NewCommentKeytip",NewKeytip:"NewKeytip",NextChange:"NextChange",NextChangeStandalone:"NextChangeStandalone",NextChangeKeytip:"NextChangeKeytip",NextComment:"NextComment",NextCommentStandalone:"NextCommentStandalone",
NextCommentKeytip:"NextCommentKeytip",NewDocuments:"NewDocuments",NextProofingError:"NextProofingError",NextSearchResult:"NextSearchResult",NextSpellingError:"NextSpellingError",NextSpellingErrorKeytip:"NextSpellingErrorKeytip",No:"No",NoBorder:"NoBorder",NoBorderKeyTip:"NoBorderKeyTip",NoHighlight:"NoHighlight",NoHighlightKeytip:"NoHighlightKeytip",NoSuggestions:"NoSuggestions",NoneListStyle:"NoneListStyle",NoneListStyleKeytip:"NoneListStyleKeytip",NumberDecimalDigits:"NumberDecimalDigits",NumberDecimalSeparator:"NumberDecimalSeparator",
NumberNegativePattern:"NumberNegativePattern",NumberGroupSeparator:"NumberGroupSeparator",NumberGroupSizes:"NumberGroupSizes",NumberingLibraryTitle:"NumberingLibraryTitle",NumberingInDocumentTitle:"NumberingInDocumentTitle",NumberStyle1:"NumberStyle1",NumberStyle2:"NumberStyle2",NumberStyle3:"NumberStyle3",NumberStyle4:"NumberStyle4",NumberStyle5:"NumberStyle5",Ok:"Ok",OneDrive:"OneDrive",OneDriveKeytip:"OneDriveKeytip",OnlinePicture:"OnlinePicture",OnlinePictureFromBing:"OnlinePictureFromBing",OnlinePictureFromBingKeytip:"OnlinePictureFromBingKeytip",
OnlinePictureFromBingSingular:"OnlinePictureFromBingSingular",OnlinePictureFromHost:"OnlinePictureFromHost",OnlinePictureFromHostKeytip:"OnlinePictureFromHostKeytip",OnlinePictureFromHostSingular:"OnlinePictureFromHostSingular",OnlinePictureKeytip:"OnlinePictureKeytip",OnlineVideo:"OnlineVideo",OnlineVideoKeytip:"OnlineVideoKeytip",Open:"Open",OpenAccessibilityCheckerPane:"OpenAccessibilityCheckerPane",OpenAccessibilityCheckerPaneKeytip:"OpenAccessibilityCheckerPaneKeytip",OpenCommentPane:"OpenCommentPane",
OpenCommentPaneKeytip:"OpenCommentPaneKeytip",ToggleContextualComments:"ToggleContextualComments",ToggleContextualCommentsKeytip:"ToggleContextualCommentsKeytip",ToggleCommentsPane:"ToggleCommentsPane",ToggleCommentsPaneKeytip:"ToggleCommentsPaneKeytip",OpenHyperlink:"OpenHyperlink",OpenHyperlinkInSidebar:"OpenHyperlinkInSidebar",OpenInApp:"OpenInApp",OpenInBrowser:"OpenInBrowser",OpenInDesktop:"OpenInDesktop",OpenInRichClientDescription:"OpenInRichClientDescription",OpenKeytip:"OpenKeytip",OpenNavPaneIntelligentPlaceholderTab:"OpenNavPaneIntelligentPlaceholderTab",
Options:"Options",OutsideBorders:"OutsideBorders",OutsideBordersKeyTip:"OutsideBordersKeyTip",OverflowWell0Keytip:"OverflowWell0Keytip",OverflowWell1Keytip:"OverflowWell1Keytip",OverflowWell2Keytip:"OverflowWell2Keytip",OverflowWell3Keytip:"OverflowWell3Keytip",OverflowWell4Keytip:"OverflowWell4Keytip",OverflowWell5Keytip:"OverflowWell5Keytip",OverflowWellLabel:"OverflowWellLabel",PageA4:"PageA4",PageA5:"PageA5",PageCountTooltip:"PageCountTooltip",PageCustomMargins:"PageCustomMargins",PageCustomMarginsDescription:"PageCustomMarginsDescription",
PageCustomMarginsKeytip:"PageCustomMarginsKeytip",PageCustomSizes:"PageCustomSizes",PageCustomSizesDescription:"PageCustomSizesDescription",PageCustomSizesKeytip:"PageCustomSizesKeytip",PageExecutive:"PageExecutive",PageLandscape:"PageLandscape",PageLandscapeKeytip:"PageLandscapeKeytip",PageLegal:"PageLegal",PageLetter:"PageLetter",PageMargins:"PageMargins",PageMarginsKeytip:"PageMarginsKeytip",PageMarginsTop:"PageMarginsTop",PageMarginsBottom:"PageMarginsBottom",PageMarginsLeft:"PageMarginsLeft",
PageMarginsRight:"PageMarginsRight",PageModerate:"PageModerate",PageNarrow:"PageNarrow",PageNormal:"PageNormal",PageNumbers:"PageNumbers",PageNumbersKeytip:"PageNumbersKeytip",PageOffice2003:"PageOffice2003",PageOrientation:"PageOrientation",PageOrientationKeytip:"PageOrientationKeytip",PagePortrait:"PagePortrait",PagePortraitKeytip:"PagePortraitKeytip",PageSize:"PageSize",PageSizeKeytip:"PageSizeKeytip",PageWide:"PageWide",PaginationGroupTitle:"PaginationGroupTitle",PaginationGroupTitleTooltip:"PaginationGroupTitleTooltip",
ParagraphOptions:"ParagraphOptions",ParagraphOptionsToolTip:"ParagraphOptionsToolTip",Paste:"Paste",PasteFloatieFlyout:"PasteFloatieFlyout",PasteKeyboardShortcutMac:"PasteKeyboardShortcutMac",PasteKeyboardShortcutWindows:"PasteKeyboardShortcutWindows",PasteKeepFormatting:"PasteKeepFormatting",PasteKeytip:"PasteKeytip",PasteOptions:"PasteOptions",PasteTextOnly:"PasteTextOnly",PasteTextOnlyKeyboardShortcutMac:"PasteTextOnlyKeyboardShortcutMac",PasteTextOnlyKeyboardShortcutWindows:"PasteTextOnlyKeyboardShortcutWindows",
PasteTextOnlyKeytip:"PasteTextOnlyKeytip",PasteWithMergedFormatting:"PasteWithMergedFormatting",PeopleWellFlyoutLabel:"PeopleWellFlyoutLabel",PeripheralCommentsButton:"PeripheralCommentsButton",PerspectiveShadowWhite:"PerspectiveShadowWhite",Picture:"Picture",PictureBorder:"PictureBorder",PictureBorderDashes:"PictureBorderDashes",PictureBorderKeytip:"PictureBorderKeytip",PictureBorderNoOutline:"PictureBorderNoOutline",PictureBorderStyleSolid:"PictureBorderStyleSolid",PictureBorderStyleRoundDot:"PictureBorderStyleRoundDot",
PictureBorderStyleDash:"PictureBorderStyleDash",PictureBorderWeight:"PictureBorderWeight",PictureBorderWeightFourPointFive:"PictureBorderWeightFourPointFive",PictureBorderWeightOne:"PictureBorderWeightOne",PictureBorderWeightOnePointFive:"PictureBorderWeightOnePointFive",PictureBorderWeightThree:"PictureBorderWeightThree",PictureBorderWeightTwoPointTwoFive:"PictureBorderWeightTwoPointTwoFive",PictureBorderWeightZeroPointFive:"PictureBorderWeightZeroPointFive",PictureBorderWeightZeroPointSevenFive:"PictureBorderWeightZeroPointSevenFive",
PictureBorderWeightZeroPointTwoFive:"PictureBorderWeightZeroPointTwoFive",PictureStandalone:"PictureStandalone",PictureFromDevice:"PictureFromDevice",PictureHeightLabel:"PictureHeightLabel",PictureHeightTooltip:"PictureHeightTooltip",PictureHeightTooltipKeytip:"PictureHeightTooltipKeytip",PictureKeytip:"PictureKeytip",PictureScaleLabel:"PictureScaleLabel",PictureScaleTooltip:"PictureScaleTooltip",PictureScaleTooltipKeytip:"PictureScaleTooltipKeytip",PictureSizeDialogLauncherKeytip:"PictureSizeDialogLauncherKeytip",
PictureStyles:"PictureStyles",PictureWidthLabel:"PictureWidthLabel",PictureWidthTooltip:"PictureWidthTooltip",PictureWidthTooltipKeytip:"PictureWidthTooltipKeytip",PinRibbonTooltip:"PinRibbonTooltip",PixelsUnitPlaceholder:"PixelsUnitPlaceholder",PlainTables:"PlainTables",PointUnitPlaceholder:"PointUnitPlaceholder",PreviousChange:"PreviousChange",PreviousChangeStandalone:"PreviousChangeStandalone",PreviousChangeKeytip:"PreviousChangeKeytip",PreviousComment:"PreviousComment",PreviousCommentStandalone:"PreviousCommentStandalone",
PreviousCommentKeytip:"PreviousCommentKeytip",PreviousSearchResult:"PreviousSearchResult",PreviousVersions:"PreviousVersions",PreviousVersionsDescription:"PreviousVersionsDescription",PreviousVersionsKeytip:"PreviousVersionsKeytip",Print:"Print",PrintKeytip:"PrintKeytip",PrintToPdf:"PrintToPdf",PrintToPdfDescription:"PrintToPdfDescription",PrintToPdfKeytip:"PrintToPdfKeytip",PrintView:"PrintView",PrintViewKeytip:"PrintViewKeytip",Privacy:"Privacy",PrivacyDescription:"PrivacyDescription",PrivacyKeytip:"PrivacyKeytip",
ProofingSplitButton:"ProofingSplitButton",ProtectDocument:"ProtectDocument",ProtectDocumentKeytip:"ProtectDocumentKeytip",PublishKeytip:"PublishKeytip",Question:"Question",QuickStyles:"QuickStyles",QuickStylesKeytip:"QuickStylesKeytip",ReadingTimeToggle:"ReadingTimeToggle",ReadView:"ReadView",ReadViewKeytip:"ReadViewKeytip",Recent:"Recent",RecentColors:"RecentColors",RecentDocuments:"RecentDocuments",RecentLinks:"RecentLinks",RecentLinksError:"RecentLinksError",RecentLinksKeyTip:"RecentLinksKeyTip",
Recommended:"Recommended",Redo:"Redo",RedoKeytip:"RedoKeytip",References:"References",Refinements:"Refinements",ReflectedBevelBlack:"ReflectedBevelBlack",ReflectedBevelWhite:"ReflectedBevelWhite",ReflectedPerspectiveRight:"ReflectedPerspectiveRight",ReflectedRoundedRectangle:"ReflectedRoundedRectangle",RejectChange:"RejectChange",RejectChangeKeytip:"RejectChangeKeytip",RelaxedPerspectiveWhite:"RelaxedPerspectiveWhite",RemoveHyperlink:"RemoveHyperlink",RemovePageNumbers:"RemovePageNumbers",RemovePageNumbersKeytip:"RemovePageNumbersKeytip",
RemoveSpaceAfterParagraph:"RemoveSpaceAfterParagraph",RemoveSpaceAfterParagraphKeytip:"RemoveSpaceAfterParagraphKeytip",RemoveSpaceBeforeParagraph:"RemoveSpaceBeforeParagraph",RemoveSpaceBeforeParagraphKeytip:"RemoveSpaceBeforeParagraphKeytip",RemoveTableOfContents:"RemoveTableOfContents",RemoveTableOfContentsKeytip:"RemoveTableOfContentsKeytip",RenameButtonDescription:"RenameButtonDescription",RenameButtonTitle:"RenameButtonTitle",RenameButtonTitleKeytip:"RenameButtonTitleKeytip",Replace:"Replace",
ReplaceAll:"ReplaceAll",ReplaceBoxPlaceholder:"ReplaceBoxPlaceholder",ReplaceKeytip:"ReplaceKeytip",ReplaceTooltip:"ReplaceTooltip",ReplyWithChanges:"ReplyWithChanges",ReplyWithChangesDescription:"ReplyWithChangesDescription",ReplyWithChangesKeytip:"ReplyWithChangesKeytip",ReportAbuse:"ReportAbuse",ReportAbuseDescription:"ReportAbuseDescription",ReportAbuseKeytip:"ReportAbuseKeytip",Reset:"Reset",ResetPicture:"ResetPicture",ResetPictureKeytip:"ResetPictureKeytip",Resize:"Resize",ResizeCurrentValue:"ResizeCurrentValue",
ResizeMaxValue:"ResizeMaxValue",ResizeMinValue:"ResizeMinValue",ResizeModeOff:"ResizeModeOff",ResizeModeOn:"ResizeModeOn",ResumeAssistantAsCV:"ResumeAssistantAsCV",ResumeAssistantAsCVKeytip:"ResumeAssistantAsCVKeytip",ResumeAssistantAsResume:"ResumeAssistantAsResume",ResumeAssistantAsResumeKeytip:"ResumeAssistantAsResumeKeytip",ResetToMSDefault:"ResetToMSDefault",Retry:"Retry",ReuseFiles:"ReuseFiles",ReuseFilesKeyTip:"ReuseFilesKeyTip",Rewrite:"Rewrite",RewriteKeytip:"RewriteKeytip",RewriteSuggestionsString:"RewriteSuggestionsString",
RibbonInsertPageBreak:"RibbonInsertPageBreak",RibbonInsertPageBreakKeytip:"RibbonInsertPageBreakKeytip",RibbonLabel:"RibbonLabel",RibbonOptionTextDirection:"RibbonOptionTextDirection",RibbonScalingData:"RibbonScalingData",RibbonToggleKeytip:"RibbonToggleKeytip",Right:"Right",RightBorder:"RightBorder",RightBorderKeyTip:"RightBorderKeyTip",RightIndent:"RightIndent",RightTab:"RightTab",RightTabStop:"RightTabStop",Rotate:"Rotate",RotatedWhite:"RotatedWhite",RotateFlipHorizontal:"RotateFlipHorizontal",
RotateFlipVertical:"RotateFlipVertical",RotateLeft90:"RotateLeft90",RotateLeft90Keytip:"RotateLeft90Keytip",RotateMoreOptions:"RotateMoreOptions",RotateMoreOptionsKeytip:"RotateMoreOptionsKeytip",RotateOptions:"RotateOptions",RotateRight90:"RotateRight90",RotateRight90Keytip:"RotateRight90Keytip",RotateShapeKeytip:"RotateShapeKeytip",RoundedDiagonalCornerWhite:"RoundedDiagonalCornerWhite",Row:"Row",Ruler:"Ruler",RulerTextKeytip:"RulerTextKeytip",Save:"Save",SaveACopyOnline:"SaveACopyOnline",SaveAs:"SaveAs",
SaveAsButtonDescription:"SaveAsButtonDescription",SaveAsKeytip:"SaveAsKeytip",SaveStyles:"SaveStyles",SaveStylesKeytip:"SaveStylesKeytip",SaveATranslatedCopyAndEditDescription:"SaveATranslatedCopyAndEditDescription",SearchableMenuRegionLabel:"SearchableMenuRegionLabel",SearchableMenuSearchBoxLabel:"SearchableMenuSearchBoxLabel",SearchAgain:"SearchAgain",SearchAgainExplanation:"SearchAgainExplanation",SearchButtonTooltip:"SearchButtonTooltip",SearchPlaceholder:"SearchPlaceholder",SearchDocumentFor:"SearchDocumentFor",
Select:"Select",SelectCell:"SelectCell",SelectCellKeytip:"SelectCellKeytip",SelectColumn:"SelectColumn",SelectColumnKeytip:"SelectColumnKeytip",SelectHyperlink:"SelectHyperlink",SelectKeytip:"SelectKeytip",SelectRow:"SelectRow",SelectRowKeytip:"SelectRowKeytip",SelectTable:"SelectTable",SelectTableKeytip:"SelectTableKeytip",Sensitivity:"Sensitivity",SensitivityKeytip:"SensitivityKeytip",SetLanguageMenu:"SetLanguageMenu",SetLanguageMenuKeytip:"SetLanguageMenuKeytip",SetNumberingValue:"SetNumberingValue",
Share:"Share",SharedNotes:"SharedNotes",ShareKeytip:"ShareKeytip",ShareMenuButtonKeytip:"ShareMenuButtonKeytip",SharePeripheralKeytip:"SharePeripheralKeytip",ShareWithPeople:"ShareWithPeople",ShareWithPeopleDescription:"ShareWithPeopleDescription",ShareWithPeopleKeytip:"ShareWithPeopleKeytip",ShiftCellsLeft:"ShiftCellsLeft",ShiftCellsUp:"ShiftCellsUp",ShiftCellsRight:"ShiftCellsRight",ShowActivity:"ShowActivity",ShowActivityKeytip:"ShowActivityKeytip",ShowBookmarks:"ShowBookmarks",ShowBookmarksKeytip:"ShowBookmarksKeytip",
ShowEndnotes:"ShowEndnotes",ShowEndnotesKeytip:"ShowEndnotesKeytip",ShowFootnotes:"ShowFootnotes",ShowFootnotesKeytip:"ShowFootnotesKeytip",ShowHideFormattingMarks:"ShowHideFormattingMarks",ShowHideFormattingMarksKeytip:"ShowHideFormattingMarksKeytip",ShowIntentSuggestion:"ShowIntentSuggestion",ShowIntentSuggestionShortcut:"ShowIntentSuggestionShortcut",ShowWordCountKeytip:"ShowWordCountKeytip",ShowReadingTimeKeytip:"ShowReadingTimeKeytip",Shrink:"Shrink",ShrinkFont:"ShrinkFont",ShrinkFontSize:"ShrinkFontSize",
ShrinkFontSizeKeytip:"ShrinkFontSizeKeytip",ShrinkKeytip:"ShrinkKeytip",SimpleFrameBlack:"SimpleFrameBlack",SimpleFrameWhite:"SimpleFrameWhite",SnipDiagonalCornerWhite:"SnipDiagonalCornerWhite",SmartLookup:"SmartLookup",SmartLookupKeytip:"SmartLookupKeytip",SmartLookupContextMenuSearchZeroTerm:"SmartLookupContextMenuSearchZeroTerm",SmartLookupSynonyms:"SmartLookupSynonyms",SoftEdgeOval:"SoftEdgeOval",SoftEdgeRectangle:"SoftEdgeRectangle",SpbWordCountAlt:"SpbWordCountAlt",SpbWordCountLabel:"SpbWordCountLabel",
SpbWordCountTip:"SpbWordCountTip",SpecialIndent:"SpecialIndent",SpecialIndentFirstLine:"SpecialIndentFirstLine",SpecialIndentFirstLineKeytip:"SpecialIndentFirstLineKeytip",SpecialIndentHanging:"SpecialIndentHanging",SpecialIndentHangingKeytip:"SpecialIndentHangingKeytip",SpecialIndentNone:"SpecialIndentNone",SpecialIndentNoneKeytip:"SpecialIndentNoneKeytip",SpecialIndentTooltip:"SpecialIndentTooltip",SpecialIndentTooltipKeytip:"SpecialIndentTooltipKeytip",SpinnerAuto:"SpinnerAuto",SpinnerDecrementButtonAriaLabel:"SpinnerDecrementButtonAriaLabel",
SpinnerIncrementButtonAriaLabel:"SpinnerIncrementButtonAriaLabel",SpinnerIndentAfterLtr:"SpinnerIndentAfterLtr",SpinnerIndentAfterLtrKeytip:"SpinnerIndentAfterLtrKeytip",SpinnerIndentBeforeLtr:"SpinnerIndentBeforeLtr",SpinnerIndentBeforeLtrKeytip:"SpinnerIndentBeforeLtrKeytip",SpinnerSpacingAfter:"SpinnerSpacingAfter",SpinnerSpacingAfterKeytip:"SpinnerSpacingAfterKeytip",SpinnerSpacingBefore:"SpinnerSpacingBefore",SpinnerSpacingBeforeKeytip:"SpinnerSpacingBeforeKeytip",SplitButtonRoleDescription:"SplitButtonRoleDescription",
SplitCells:"SplitCells",SplitCellsKeytip:"SplitCellsKeytip",StandardColors:"StandardColors",StartNewList:"StartNewList",StatsInIdeas:"StatsInIdeas",StockImages:"StockImages",StockImagesKeytip:"StockImagesKeytip",Strikethrough:"Strikethrough",StrikethroughKeytip:"StrikethroughKeytip",StyleOptions:"StyleOptions",SubmitFailed:"SubmitFailed",SubmitFailedDetails:"SubmitFailedDetails",SubmitSucceeded:"SubmitSucceeded",SubmitSucceededDetails:"SubmitSucceededDetails",Subscript:"Subscript",SubscriptKeytip:"SubscriptKeytip",
Superscript:"Superscript",SuperscriptKeytip:"SuperscriptKeytip",SwitchToClassicViewMode:"SwitchToClassicViewMode",SwitchToClassicViewModeKeytip:"SwitchToClassicViewModeKeytip",SwitchToUnifiedReadMode:"SwitchToUnifiedReadMode",SwitchToUnifiedReadModeKeytip:"SwitchToUnifiedReadModeKeytip",SymbolPlural:"SymbolPlural",SymbolSingle:"SymbolSingle",SymbolSingleKeytip:"SymbolSingleKeytip",TabDesign:"TabDesign",TabDesignKeytip:"TabDesignKeytip",TabDesignOneLineRibbonKeytip:"TabDesignOneLineRibbonKeytip",TabDeveloper:"TabDeveloper",
TabDeveloperKeytip:"TabDeveloperKeytip",TabFileKeytip:"TabFileKeytip",TabFormatPicture:"TabFormatPicture",TabFormatPictureKeytip:"TabFormatPictureKeytip",TabForYou:"TabForYou",TabForYouKeytip:"TabForYouKeytip",TabHome:"TabHome",TabHomeKeytip:"TabHomeKeytip",TabInsert:"TabInsert",TabInsertKeytip:"TabInsertKeytip",TabLayout:"TabLayout",TabLayoutKeytip:"TabLayoutKeytip",TabReferencesKeytip:"TabReferencesKeytip",Table:"Table",TableDesignGroupName:"TableDesignGroupName",TableDesignOverflowName:"TableDesignOverflowName",
TableKeytip:"TableKeytip",TabTableKeytip:"TabTableKeytip",TableLayoutGroupName:"TableLayoutGroupName",TableLayoutOverflowName:"TableLayoutOverflowName",TableStyleOptionBandedColumn:"TableStyleOptionBandedColumn",TableStyleOptionBandedColumnKeytip:"TableStyleOptionBandedColumnKeytip",TableStyleOptionBandedRow:"TableStyleOptionBandedRow",TableStyleOptionBandedRowKeytip:"TableStyleOptionBandedRowKeytip",TableStyleOptionFirstColumn:"TableStyleOptionFirstColumn",TableStyleOptionFirstColumnKeytip:"TableStyleOptionFirstColumnKeytip",
TableStyleOptionFirstRow:"TableStyleOptionFirstRow",TableStyleOptionFirstRowKeytip:"TableStyleOptionFirstRowKeytip",TableStyleOptionLastColumn:"TableStyleOptionLastColumn",TableStyleOptionLastColumnKeytip:"TableStyleOptionLastColumnKeytip",TableStyleOptionLastRow:"TableStyleOptionLastRow",TableStyleOptionLastRowKeytip:"TableStyleOptionLastRowKeytip",TableStyleOptionsKeytip:"TableStyleOptionsKeytip",TableStyles:"TableStyles",TableStylesKeytip:"TableStylesKeytip",TabMailings:"TabMailings",TabMailingsKeytip:"TabMailingsKeytip",
TabPageLayout:"TabPageLayout",TabPageLayoutKeytip:"TabPageLayoutKeytip",TabPictureTools:"TabPictureTools",TabReview:"TabReview",TabReviewKeytip:"TabReviewKeytip",TabTableTools:"TabTableTools",TabView:"TabView",TabViewKeytip:"TabViewKeytip",TaskPaneRoleDescription:"TaskPaneRoleDescription",TaskPaneTabs:"TaskPaneTabs",TaskPaneOpening:"TaskPaneOpening",TaskList:"TaskList",TaskListKeytip:"TaskListKeytip",TermsOfUse:"TermsOfUse",TellMeSearchPlaceholder:"TellMeSearchPlaceholder",TellMeSearchPlaceholderOnMac:"TellMeSearchPlaceholderOnMac",
TellMeSearchUnifiedAppPlaceholder:"TellMeSearchUnifiedAppPlaceholder",TellMeAlternativePlaceholder:"TellMeAlternativePlaceholder",TellMeAnswerForSearchLabel:"TellMeAnswerForSearchLabel",TellMeDefinition:"TellMeDefinition",TellMeKeytip:"TellMeKeytip",TellMeLabel:"TellMeLabel",TellMePlaceholder:"TellMePlaceholder",TellMeSuggestedQuery1:"TellMeSuggestedQuery1",TellMeSuggestedQuery2:"TellMeSuggestedQuery2",TellMeSuggestedQuery3:"TellMeSuggestedQuery3",TellMeSuggestedQuery4:"TellMeSuggestedQuery4",TellMeSuggestedQuery5:"TellMeSuggestedQuery5",
TellMeGetHelpLabel:"TellMeGetHelpLabel",TellMeSelectAll:"TellMeSelectAll",TellMeSmartLookupLabel:"TellMeSmartLookupLabel",TellMeSynonym:"TellMeSynonym",TellMeUpsellTrackChanges:"TellMeUpsellTrackChanges",TellMeUpsellInsertShapes:"TellMeUpsellInsertShapes",TellMeUpsellLabels:"TellMeUpsellLabels",TellMeUpsellInsertCitations:"TellMeUpsellInsertCitations",TellMeUpsellTextBox:"TellMeUpsellTextBox",TellMeUpsellTableOfContents:"TellMeUpsellTableOfContents",TellMeUpsellSmartArt:"TellMeUpsellSmartArt",TellMeUpsellWordArt:"TellMeUpsellWordArt",
TellMeUpsellMultiColumnLayout:"TellMeUpsellMultiColumnLayout",TellMeUpsellInsertEquations:"TellMeUpsellInsertEquations",TellMeDesktopFeature:"TellMeDesktopFeature",TellMeOpenInWord:"TellMeOpenInWord",TellMeOpenInDesktopDescription:"TellMeOpenInDesktopDescription",TellMeUpsellDesktopTitle:"TellMeUpsellDesktopTitle",TellMeUpsellDesktopDescription:"TellMeUpsellDesktopDescription",TemplateMoreLink:"TemplateMoreLink",TemplateSectionErrorMessage:"TemplateSectionErrorMessage",TermsOfUseDescription:"TermsOfUseDescription",
TermsOfUseKeytip:"TermsOfUseKeytip",TextAlignment:"TextAlignment",TextAlignmentAnchorKeytip:"TextAlignmentAnchorKeytip",TextDirLTR:"TextDirLTR",TextDirLTRKeytip:"TextDirLTRKeytip",TextDirLTRTooltip:"TextDirLTRTooltip",TextDirRTL:"TextDirRTL",TextDirRTLKeytip:"TextDirRTLKeytip",TextDirRTLTooltip:"TextDirRTLTooltip",TextHighlightColor:"TextHighlightColor",ThemeColors:"ThemeColors",ThemeColorsMCU:"ThemeColorsMCU",ThickMatteBlack:"ThickMatteBlack",ThisDevice:"ThisDevice",ThirdPartyNotices:"ThirdPartyNotices",
ThirdPartyNoticesDescription:"ThirdPartyNoticesDescription",ThirdPartyNoticesKeytip:"ThirdPartyNoticesKeytip",TimeToReadTooltip:"TimeToReadTooltip",TogglePageEnds:"TogglePageEnds",TogglePageEndsKeytip:"TogglePageEndsKeytip",ToggleProofingOn:"ToggleProofingOn",ToggleProofingOff:"ToggleProofingOff",ToggleProofingTooltipOn:"ToggleProofingTooltipOn",ToggleProofingTooltipOff:"ToggleProofingTooltipOff",ToggleProofingInRibbonEnable:"ToggleProofingInRibbonEnable",ToggleProofingInRibbonDisable:"ToggleProofingInRibbonDisable",
ToggleProofingOnExpB:"ToggleProofingOnExpB",ToggleProofingOffExpB:"ToggleProofingOffExpB",ToggleProofingTooltipOnExpB:"ToggleProofingTooltipOnExpB",ToggleProofingTooltipOffExpB:"ToggleProofingTooltipOffExpB",ToggleProofingInRibbonEnableExpB:"ToggleProofingInRibbonEnableExpB",ToggleProofingInRibbonDisableExpB:"ToggleProofingInRibbonDisableExpB",ToggleRibbonControl:"ToggleRibbonControl",ToggleRibbonControlKeytip:"ToggleRibbonControlKeytip",ToggleRibbonGroup:"ToggleRibbonGroup",TopBorder:"TopBorder",
TopBorderKeyTip:"TopBorderKeyTip",Transform:"Transform",TransformToWeb:"TransformToWeb",TransformDescription:"TransformDescription",ReviewDesignerSuggestion:"ReviewDesignerSuggestion",RibbonTabsGroupLabel:"RibbonTabsGroupLabel",TrackChanges:"TrackChanges",TrackChangesModeDropDown:"TrackChangesModeDropDown",TrackChangesModeDropDownSimpleMarkup:"TrackChangesModeDropDownSimpleMarkup",TrackChangesModeDropDownAllMarkup:"TrackChangesModeDropDownAllMarkup",TrackChangesModeKeytip:"TrackChangesModeKeytip",
TrackChangesModeHideTrackChanges:"TrackChangesModeHideTrackChanges",TrackChangesModeShowTrackChanges:"TrackChangesModeShowTrackChanges",TrackChangesLabel:"TrackChangesLabel",TrackChangesTooltip:"TrackChangesTooltip",TrackChangesForEveryone:"TrackChangesForEveryone",TrackChangesForEveryoneKeytip:"TrackChangesForEveryoneKeytip",TrackChangesJustMine:"TrackChangesJustMine",TrackChangesJustMineKeytip:"TrackChangesJustMineKeytip",TrackChangesKeytip:"TrackChangesKeytip",TrackChangesOff:"TrackChangesOff",
TrackChangesOffKeytip:"TrackChangesOffKeytip",Training:"Training",TrainingKeytip:"TrainingKeytip",TranscriptionLabel:"TranscriptionLabel",TranscriptionKeytip:"TranscriptionKeytip",TrustCenter:"TrustCenter",TrustCenterDescription:"TrustCenterDescription",TrustCenterKeytip:"TrustCenterKeytip",TryMacOffice:"TryMacOffice",TryMacOfficeDescription:"TryMacOfficeDescription",TryMacOfficeKeytip:"TryMacOfficeKeytip",TryOffice:"TryOffice",TryOfficeDescription:"TryOfficeDescription",TryOfficeKeytip:"TryOfficeKeytip",
Underline:"Underline",UnderlineKeytip:"UnderlineKeytip",Undo:"Undo",UndoKeytip:"UndoKeytip",UnpinRibbonTooltip:"UnpinRibbonTooltip",UpdateTableOfContents:"UpdateTableOfContents",UpdateTableOfContentsKeytip:"UpdateTableOfContentsKeytip",UpgradeOffice:"UpgradeOffice",UpgradeOfficeDescription:"UpgradeOfficeDescription",UserInterfaceFontName:"UserInterfaceFontName",UserInterfaceFontSize:"UserInterfaceFontSize",VersionHistory:"VersionHistory",ViewMoreOptionsGroupName:"ViewMoreOptionsGroupName",ViewOriginal:"ViewOriginal",
ViewPrevious:"ViewPrevious",Warning:"Warning",WebView:"WebView",WebViewKeytip:"WebViewKeytip",WhatsNew:"WhatsNew",WhatsNewKeytip:"WhatsNewKeytip",WheresTheSaveButton:"WheresTheSaveButton",WheresTheSaveButtonDescription:"WheresTheSaveButtonDescription",WheresTheSaveButtonKeytip:"WheresTheSaveButtonKeytip",WordCountKeytip:"WordCountKeytip",WordCountMenuItem:"WordCountMenuItem",WordCountToggle:"WordCountToggle",WordCountTooltip:"WordCountTooltip",WordPrediction:"WordPrediction",WordPredictionKeytip:"WordPredictionKeytip",
WordPredictionButtonToolTip:"WordPredictionButtonToolTip",WordPredictionDialogTitle:"WordPredictionDialogTitle",WordPredictionDialogButtonDescription:"WordPredictionDialogButtonDescription",WordPredictionDialogDescription:"WordPredictionDialogDescription",WordPredictionDialogSubDescription:"WordPredictionDialogSubDescription",WordPredictionDialogLearnMore:"WordPredictionDialogLearnMore",WordPredictionDialogFeedback:"WordPredictionDialogFeedback",WordPredictionDialogSeparator:"WordPredictionDialogSeparator",
WordTestFeature:"WordTestFeature",WrapText:"WrapText",WrapTextBehindText:"WrapTextBehindText",WrapTextBehindTextKeytip:"WrapTextBehindTextKeytip",WrapTextInFrontOfText:"WrapTextInFrontOfText",WrapTextInFrontOfTextKeytip:"WrapTextInFrontOfTextKeytip",WrapTextInLine:"WrapTextInLine",WrapTextInLineKeytip:"WrapTextInLineKeytip",WrapTextKeytip:"WrapTextKeytip",WrapTextSquareLeft:"WrapTextSquareLeft",WrapTextSquareLeftKeytip:"WrapTextSquareLeftKeytip",WrapTextSquareRight:"WrapTextSquareRight",WrapTextSquareRightKeytip:"WrapTextSquareRightKeytip",
Yes:"Yes",Zoom:"Zoom",ZoomInTooltip:"ZoomInTooltip",ZoomKeytip:"ZoomKeytip",ZoomLevel:"ZoomLevel",ZoomOutTooltip:"ZoomOutTooltip",ZoomTo100:"ZoomTo100",ZoomTo100Keytip:"ZoomTo100Keytip",TrackChangesForEveryoneLabel:"TrackChangesForEveryoneLabel",TrackChangesJustMineLabel:"TrackChangesJustMineLabel",ZoomTo100Label:"ZoomTo100Label",ZoomToFitPageWidthTooltip:"ZoomToFitPageWidthTooltip",NeedDesktopAppLabel:"NeedDesktopAppLabel",TellMeUpsellBibliography:"TellMeUpsellBibliography",TellMeUpsellWatermark:"TellMeUpsellWatermark",
TellMeUpsellSignature:"TellMeUpsellSignature",TellMeUpsellMailMerge:"TellMeUpsellMailMerge",TellMeUpsellTabStop:"TellMeUpsellTabStop",TellMeUpsellEnvelope:"TellMeUpsellEnvelope",TellMeUpsellBookmark:"TellMeUpsellBookmark",CommentPaneLabel:"CommentPaneLabel",CommentContextualLabel:"CommentContextualLabel"};C.exports.WordRibbonStrings||Object.defineProperty(C.exports,"WordRibbonStrings",{enumerable:!0,get:function(){return C.exports.Z0j}})},1664:function(C,L,b){var f=this&&this.L5||(Object.create?function(u,
r,t,k){void 0===k&&(k=t);Object.defineProperty(u,k,{enumerable:!0,get:function(){return r[t]}})}:function(u,r,t,k){void 0===k&&(k=t);u[k]=r[t]}),c=this&&this.__exportStar||function(u,r){for(var t in u)"default"===t||Object.prototype.hasOwnProperty.call(r,t)||f(r,u,t)};Object.defineProperty(L,"__esModule",{value:!0});c(b(1665),L);c(b(1666),L);C.exports.SearchSuggestionAnnotation||Object.defineProperty(C.exports,"SearchSuggestionAnnotation",{enumerable:!0,get:function(){return C.exports.SearchSuggestionAnnotation}});
C.exports.SearchSuggestionSignal||Object.defineProperty(C.exports,"SearchSuggestionSignal",{enumerable:!0,get:function(){return C.exports.SearchSuggestionSignal}})},1665:function(C,L){Object.defineProperty(L,"__esModule",{value:!0})},1666:function(C,L,b){Object.defineProperty(L,"__esModule",{value:!0});L.SearchSuggestionAnnotation=L.SearchSuggestionSignal=void 0;const f=b(204);class c{constructor(r){f.SchemaObject.assign(c,this,r)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(r){return f.SchemaObject.matchesTypesFor(r,
[c.getTypeName()])}}L.SearchSuggestionSignal=c;c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(r){f.SchemaObject.assign(u,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=r}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(r){return f.SchemaObject.matchesTypesFor(r,[u.getTypeName()])}}L.SearchSuggestionAnnotation=u;u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()}},1669:function(C,
L,b){b.r(L);b.d(L,"ReactOICErrorDialogWithTrial",function(){return r});C=b(0);var f=b(41);L=b(1529);var c=b(334),u=b(149);class r extends L.a{constructor(t,k,m,l,x,w){super(t,k,m,l,x,w);k={["errorMessage"]:this.sli,["offerString"]:this.E7i};t=new u.a(!1,!1,!0);this.vCj?(t.wc=1,k.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.DGb,["onExecute"]:()=>{c.Redirect.showHelp(this.aKi)}}):(t.wc=4,t.ee(2,this.nLi));t.ee(1,this.yhe);t.Je=this.id;k={["id"]:this.id,["dialogIcon"]:this.icon,
["bodyControls"]:k};t.Ih(this.F3a,Object(f.a)(this,this.QZm,"reactOICErrorDialogWithTrialHandler"),k)}}Object(C.a)(r,"ReactOICErrorDialogWithTrial",L.a,[])},1670:function(C,L,b){b.r(L);b.d(L,"OICErrorDialogWithTrial",function(){return u});C=b(0);var f=b(41);L=b(1529);var c=b(129);class u extends L.a{constructor(r,t,k,m,l,x){super(r,t,k,m,l,x);r=document.createElement("span");r.innerText=this.sli;r.appendChild(document.createElement("br"));r.appendChild(document.createElement("br"));t=document.createElement("span");
t.innerText=this.E7i;r.appendChild(t);t=new c.StandardDialog;this.vCj?(t.wc=1,t.Kfd(this.DGb,this.aKi)):(t.wc=4,t.ee(2,this.nLi));t.ee(1,this.yhe);t.Je=this.id;t.iu(this.F3a,null,this.icon,Object(f.a)(this,this.skm,"legacyOICErrorDialogWithTrialHandler"),r)}}Object(C.a)(u,"OICErrorDialogWithTrial",L.a,[])},1672:function(C,L,b){var f=this&&this.L5||(Object.create?function(u,r,t,k){void 0===k&&(k=t);Object.defineProperty(u,k,{enumerable:!0,get:function(){return r[t]}})}:function(u,r,t,k){void 0===k&&
(k=t);u[k]=r[t]}),c=this&&this.__exportStar||function(u,r){for(var t in u)"default"===t||Object.prototype.hasOwnProperty.call(r,t)||f(r,u,t)};Object.defineProperty(L,"__esModule",{value:!0});c(b(1673),L);c(b(1674),L);C.exports.SearchProviderSignal||Object.defineProperty(C.exports,"SearchProviderSignal",{enumerable:!0,get:function(){return C.exports.SearchProviderSignal}})},1673:function(C,L){Object.defineProperty(L,"__esModule",{value:!0})},1674:function(C,L,b){Object.defineProperty(L,"__esModule",
{value:!0});L.SearchProviderAnnotation=L.SearchProviderSignal=void 0;const f=b(204);class c{constructor(r){f.SchemaObject.assign(c,this,r)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(r){return f.SchemaObject.matchesTypesFor(r,[c.getTypeName()])}}L.SearchProviderSignal=c;c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(r){f.SchemaObject.assign(u,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=
r}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(r){return f.SchemaObject.matchesTypesFor(r,[u.getTypeName()])}}L.SearchProviderAnnotation=u;u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()}},1727:function(C,L,b){C=b(0);var f=b(23),c=b(2),u=b(16),r=b(51),t=b(192),k=b(79),m=b(143),l=b(17),x=b(42),w=b(6),G=b(8),D=b(41),H=b(70),M=b(57),J=b(35),F=b(302),A=b(18),N=b(14),B=b(5),E=b(65),P=b(105),T=b(21),V=
b(227),I=b(40),R=b(246),ba=b(39),ha=b(262),na=b(22),da=b(86),ia=b(133),ma=b(788),qa=b(838),ka=b(3),va=b(90),ja=b(68),Ma=b(12),Ha=b(100),X=b(44),W=b(468),fa=b(553),ra=b(219),Aa=b(19),Ba=b(49),ta=b(33),xa=b(231),za=b(10),la=b(1369),Sa=b(1389),Pa=b(222),fb=b(187),db=b(53),Qa=b(487);class wb extends Pa.a{constructor(ya,wa,Fa,bb,Eb,hb,nb,Pb){super();this.UMh=this.tF=null;this.init(ya);this.Pj("FormattingViewOperation");this.AIa(c.AFrameworkApplication.pa,wa,bb,Eb,hb);this._context=Fa;this.Jwb=0;this.$h=
!0;this.o9j=nb;this.Wl=Pb}get HX(){return this.Wl.instance}run(){const ya=this._context.view;var wa=null;ya.Yd&&(wa=ya.Oa);if(wa){var Fa=wa.ya.Ba,bb=!Sa.a.uJc(this.actionId);!Fa||wb.If.$Ge(Fa,bb)?(wb.Lb.mb(va.a.af,{["Reason"]:ja.a.CF}),this.$h=!1):this.HX&&this.HX.Sbc(Fa)?(wb.Lb.mb(va.a.af,{["Reason"]:ja.a.externalSelection}),this.$h=!1):wb.jg.h9(za.ParagraphReader.wS,wa.Ag)&&(wb.Lb.mb(va.a.af,{["Reason"]:ja.a.qP}),this.$h=!1)}else wb.Lb.mb(va.a.af,{["Reason"]:ja.a.Wga}),this.$h=!1;1!==this.behavior&&
this.$h||(this.$h&&(Fa=wa.ya.Ba,1===wa.ya.length&&1===Fa.length&&Aa.SelectionEditor.Ch(Fa.ra)&&da.b(Fa.ra)&&(wb.Lb.mb(va.a.af,{["Reason"]:ja.a.k5b}),this.$h=!1)),(Fa=this.$h)&&this.actionId===ka.a.Zca&&((Fa=Array.from(wa.ya.Ba).some(P.FormattingReader.cPf))||wb.Lb.mb(va.a.af,{["Reason"]:ja.a.tpd})),this.Zl=Fa?32:8,this.Jwb=3);this.Jwb||(fb.a.mark(5730),this.UMh=Qa.SelectionReferenceFactory.instance.u3a(),Fa=wa.ya.Ba.ra,this.tF=new X.GraphTransaction(15),this.tF.Sa(Fa.node),this.tF.om=this.actionId,
this.Jwb=1);if(1===this.Jwb){this.fx||this.rtb(this._context.Am);if(1===this.Kca())return;this.Jwb=2}if(2===this.Jwb){if(this.actionId===ka.a.Zca)if(wa=wa.Ag,wa.Iq)for(Fa=0;Fa<wa.length;Fa++)bb=wa.getContext(Fa),this.fMj(bb);else this.fMj(wa);this.UMh.uha(this.actionId===ka.a.m5||this.actionId===ka.a.Fqa);(wa=Object(H.a)(28,this.$c))&&!wa.c9a||db.FocusManager.instance().wf(ya.qE);this.tF.dispose();this.tF=null;Ma.App.oa.updateCommandUI();fb.a.mark(5731);this.Jwb=3;this.Zl=32}3===this.Jwb&&(this.o9j.process(this.actionId,
this._context,this.behavior,this.response),this.b1())}fMj(ya){(Aa.SelectionEditor.Tl(ya)||Aa.SelectionEditor.sg(ya))&&Ma.App.UH.Tha(ya.node)}static get If(){return xa.a.instance}static get jg(){return ra.ContextSetEditor.instance}static get Lb(){return m.a.instance}}Object(C.a)(wb,"FormattingViewOperation",Pa.a,[]);var ib=b(906),Ta=b(780),jb=b(72);b.d(L,"a",function(){return $a});class $a{constructor(ya,wa,Fa=null){this.kpiName="ChangeCaseCommandUsage";this.G_="wwaengidc";this.u0=new Map;this.Q9j=
ya;this.sea=wa;this.VM=Fa}get recentColors(){return $a.vAb||($a.vAb=f.a.instance.sa("Box4.UI.RecentColorsSectionHandler"))}get Vue(){return!!this.VM&&this.VM.enabled}lb(){const ya=c.AFrameworkApplication.pa,wa=Object(D.a)(this,this.DXm,"queryNonParagraphFormatting");($a.Ka?$a.Ka.fq(66):c.AFrameworkApplication.K&&c.AFrameworkApplication.K.ea("Box4EndOfParagraphFormattingIsEnabled"))?(ya.ma(ka.a.font,N.a.endOfParagraph,Object(D.a)(this,this.g_,"applyFormattingEOP")),ya.ma(ka.a.ay,N.a.endOfParagraph,
Object(D.a)(this,this.g_,"applyFormattingEOP")),ya.ma(ka.a.X_,N.a.endOfParagraph,Object(D.a)(this,this.g_,"applyFormattingEOP")),ya.ma(ka.a.g1,N.a.endOfParagraph,Object(D.a)(this,this.g_,"applyFormattingEOP")),ya.ma(ka.a.$v,N.a.endOfParagraph,Object(D.a)(this,this.g_,"applyFormattingEOP")),ya.ma(ka.a.Uta,N.a.endOfParagraph,Object(D.a)(this,this.g_,"applyFormattingEOP")),ya.ma(ka.a.yaa,N.a.endOfParagraph,Object(D.a)(this,this.g_,"applyFormattingEOP")),ya.ma(ka.a.m5,N.a.endOfParagraph,Object(D.a)(this,
this.g_,"applyFormattingEOP")),ya.ma(ka.a.Gha,N.a.endOfParagraph,Object(D.a)(this,this.g_,"applyFormattingEOP")),ya.ma(ka.a.Fqa,N.a.endOfParagraph,Object(D.a)(this,this.g_,"applyFormattingEOP")),ya.ma(ka.a.bold,N.a.endOfParagraph,Object(D.a)(this,this.g_,"applyFormattingEOP")),ya.ma(ka.a.setItalic,N.a.endOfParagraph,Object(D.a)(this,this.g_,"applyFormattingEOP")),ya.ma(ka.a.underline,N.a.endOfParagraph,Object(D.a)(this,this.g_,"applyFormattingEOP")),ya.ma(ka.a.noa,N.a.endOfParagraph,Object(D.a)(this,
this.g_,"applyFormattingEOP")),ya.ma(ka.a.superscript,N.a.endOfParagraph,Object(D.a)(this,this.g_,"applyFormattingEOP")),ya.ma(ka.a.subscript,N.a.endOfParagraph,Object(D.a)(this,this.g_,"applyFormattingEOP")),ya.ma(ka.a.strikethrough,N.a.endOfParagraph,Object(D.a)(this,this.g_,"applyFormattingEOP")),ya.ma(ka.a.eo,N.a.endOfParagraph,Object(D.a)(this,this.g_,"applyFormattingEOP")),ya.ma(ka.a.Zca,N.a.endOfParagraph,Object(D.a)(this,this.g_,"applyFormattingEOP")),ya.ma(ka.a.clearFormatting,N.a.endOfParagraph,
Object(D.a)(this,this.g_,"applyFormattingEOP"))):Ma.App.A6a&&(ya.ma(ka.a.font,N.a.endOfParagraph,Object(D.a)(this,this.Txa,"applyListFormattingEOP")),ya.ma(ka.a.ay,N.a.endOfParagraph,Object(D.a)(this,this.Txa,"applyListFormattingEOP")),ya.ma(ka.a.$v,N.a.endOfParagraph,Object(D.a)(this,this.Txa,"applyListFormattingEOP")),ya.ma(ka.a.Uta,N.a.endOfParagraph,Object(D.a)(this,this.Txa,"applyListFormattingEOP")),ya.ma(ka.a.yaa,N.a.endOfParagraph,Object(D.a)(this,this.Txa,"applyListFormattingEOP")),E.ListReader.Jq&&
(ya.ma(ka.a.bold,N.a.endOfParagraph,Object(D.a)(this,this.Txa,"applyListFormattingEOP")),ya.ma(ka.a.setItalic,N.a.endOfParagraph,Object(D.a)(this,this.Txa,"applyListFormattingEOP")),ya.ma(ka.a.superscript,N.a.endOfParagraph,Object(D.a)(this,this.Txa,"applyListFormattingEOP")),ya.ma(ka.a.subscript,N.a.endOfParagraph,Object(D.a)(this,this.Txa,"applyListFormattingEOP")),ya.ma(ka.a.strikethrough,N.a.endOfParagraph,Object(D.a)(this,this.Txa,"applyListFormattingEOP")),ya.ma(ka.a.eo,N.a.endOfParagraph,Object(D.a)(this,
this.Txa,"applyListFormattingEOP"))),ya.ma(ka.a.X_,N.a.endOfParagraph,Object(D.a)(this,this.Txa,"applyListFormattingEOP")),ya.ma(ka.a.g1,N.a.endOfParagraph,Object(D.a)(this,this.Txa,"applyListFormattingEOP")));const Fa=Ma.App.P9a.jpe(bb=>fa.OutlineElementGeneralizer.Kla(bb.ya,!0));ya.Aa(ka.a.mme,N.a.view,Object(D.a)(this,this.iVl,"handleChangeCaseMenu"),100);ya.Aa(ka.a.zUc,N.a.Lc,Object(D.a)(this,this.zUc,"toggleChangeCase"),1028);ya.ma(ka.a.X7a,N.a.view,Object(D.a)(this,this.jhj,"queryCharacterFormatting"));
ya.ma(ka.a.APc,N.a.view,Object(D.a)(this,this.jhj,"queryCharacterFormatting"));ya.ma(ka.a.ACa,N.a.view,Fa);ya.ma(ka.a.ACa,N.a.paragraph,Object(D.a)(this,this.ACa,"queryParagraphFormatting"));ya.ma(ka.a.ACa,N.a.image,Object(D.a)(this,this.wXm,"queryImageFormatting"));ya.ma(ka.a.ACa,N.a.unsupportedObject,wa);ya.ma(ka.a.ACa,N.a.table,Object(D.a)(this,this.QXm,"queryTableFormatting"));ya.ma(ka.a.a8a,N.a.view,Fa);ya.ma(ka.a.a8a,N.a.paragraph,Object(D.a)(this,this.a8a,"queryParagraphIndentation"));ya.ma(ka.a.a8a,
N.a.table,Object(D.a)(this,this.RXm,"queryTableIndentation"));ya.$b(ka.a.X7a,99);ya.$b(ka.a.APc,1127);ya.$b(ka.a.ACa,97);ya.$b(ka.a.a8a,97);this.AR(ya,ka.a.font);this.AR(ya,ka.a.ay);this.AR(ya,ka.a.X_);this.AR(ya,ka.a.g1);ya.Ugb(ka.a.O2f,N.a.view,Object(D.a)(this,this.QEf,"applyCharacterFormattingViewAsync"));ya.$b(ka.a.O2f,1092);this.AR(ya,ka.a.$v);this.AR(ya,ka.a.Uta);this.AR(ya,ka.a.yaa);this.AR(ya,ka.a.m5);this.AR(ya,ka.a.Gha);this.AR(ya,ka.a.KCb);this.AR(ya,ka.a.fib);this.AR(ya,ka.a.gib);this.AR(ya,
ka.a.J2a);this.AR(ya,ka.a.LCb);this.AR(ya,ka.a.Fqa);this.AR(ya,ka.a.bold);ya.NMb(ka.a.bold,Object(D.a)(this,this.z8b,"generateActionArguments"));this.AR(ya,ka.a.setItalic);ya.NMb(ka.a.setItalic,Object(D.a)(this,this.z8b,"generateActionArguments"));this.AR(ya,ka.a.underline);ya.NMb(ka.a.underline,Object(D.a)(this,this.z8b,"generateActionArguments"));this.AR(ya,ka.a.noa);this.AR(ya,ka.a.superscript);ya.NMb(ka.a.superscript,Object(D.a)(this,this.z8b,"generateActionArguments"));this.AR(ya,ka.a.subscript);
ya.NMb(ka.a.subscript,Object(D.a)(this,this.z8b,"generateActionArguments"));this.AR(ya,ka.a.strikethrough);ya.NMb(ka.a.strikethrough,Object(D.a)(this,this.z8b,"generateActionArguments"));this.AR(ya,ka.a.eo);ya.NMb(ka.a.eo,Object(D.a)(this,this.z8b,"generateActionArguments"));ya.Aa(ka.a.eob,N.a.Lc,Object(D.a)(this,this.Gje,"applyCharacterFormatting"),96);ya.Ugb(ka.a.Zca,N.a.view,Object(D.a)(this,this.QEf,"applyCharacterFormattingViewAsync"));ya.ma(ka.a.Zca,N.a.paragraph,Object(D.a)(this,this.dFf,"applyParagraphFormatting"));
ya.ma(ka.a.Zca,N.a.Lc,Object(D.a)(this,this.Gje,"applyCharacterFormatting"));ya.ma(ka.a.Zca,N.a.Ub,Object(D.a)(this,this.YEf,"applyFormattingIp"));ya.ma(ka.a.clearFormatting,N.a.view,Object(D.a)(this,this.iSk,"clearFormattingView"));ya.ma(ka.a.clearFormatting,N.a.paragraph,Object(D.a)(this,this.hSk,"clearFormattingParagraph"));ya.ma(ka.a.clearFormatting,N.a.Lc,Object(D.a)(this,this.Gje,"applyCharacterFormatting"));ya.ma(ka.a.clearFormatting,N.a.Ub,Object(D.a)(this,this.YEf,"applyFormattingIp"));ya.$b(ka.a.clearFormatting,
1036);ya.ma(ka.a.oib,N.a.Lc,Object(D.a)(this,this.oib,"clearFormattingParagraphLevel"));ya.ma(ka.a.oib,N.a.Ub,Object(D.a)(this,this.oib,"clearFormattingParagraphLevel"));ya.ma(ka.a.DAc,N.a.view,Object(D.a)(this,this.DAc,"clearFormattingMultiParagraphLevel"));ya.ma(ka.a.rNb,N.a.view,Sa.a.Nz);ya.ma(ka.a.rNb,N.a.paragraph,Object(D.a)(this,this.dFf,"applyParagraphFormatting"));ya.ma(ka.a.rNb,N.a.unsupportedObject,Object(D.a)(this,this.vZh,"applyTextDirectionToNonParagraph"));ya.$b(ka.a.rNb,1028);ya.ma(ka.a.sNb,
N.a.view,Sa.a.Nz);ya.ma(ka.a.sNb,N.a.paragraph,Object(D.a)(this,this.dFf,"applyParagraphFormatting"));ya.ma(ka.a.sNb,N.a.unsupportedObject,Object(D.a)(this,this.vZh,"applyTextDirectionToNonParagraph"));ya.$b(ka.a.sNb,1028)}AR(ya,wa){ya.Ugb(wa,N.a.view,Object(D.a)(this,this.QEf,"applyCharacterFormattingViewAsync"));ya.ma(wa,N.a.Lc,Object(D.a)(this,this.Gje,"applyCharacterFormatting"));ya.ma(wa,N.a.Ub,Object(D.a)(this,this.YEf,"applyFormattingIp"));ya.$b(wa,1036)}z8b(){return new ma.a(2)}jhj(ya,wa,
Fa,bb,Eb){bb=!0;wa.contextId!==N.a.view&&(bb=!1);if(1===Fa&&!bb)return 8;if(ya===ka.a.APc)ya=Eb.formatting,Eb=Eb.C6g;else{if(!wa.view||!wa.view.Yd)return 2;wa=wa.view;if(!wa.Oa||!wa.Oa.ya.Ba)return 8;ya=Eb;Eb=wa.Oa.ya}this.uWk(Eb,ya);return 32}uWk(ya,wa){for(const Pb of ya)for(const bc of Pb){ya=null;if(bc.contextId===N.a.Lc){if(da.b(bc))continue;ya=[];var Fa=bc.node.ja;if(Fa){var bb=Fa.length-1;const gb=bc.cpBegin,Lb=bc.cpEnd;let Ic=!1;const vb=bc.node.characterData;if(vb&&""!==vb){var Eb=vb.substr(gb,
Lb-gb);Eb&&""!==Eb&&u.a.yoe(Eb,0,Eb.length)&&(Ic=!0)}Eb=!1;for(let xb=0;xb<bb;xb++){var hb=Fa.J(xb).cp,nb=Fa.J(xb+1).cp;if(Fa.J(xb).formatting&&Math.max(hb,gb)<Math.min(nb,Lb)){if(vb&&""!==vb&&(hb=hb<gb?gb:hb,nb=vb.substr(hb,(nb<Lb?nb:Lb)-hb),!Ic&&u.a.yoe(nb,0,nb.length)))continue;Eb=!0;ya.push(Fa.J(xb).formatting)}else if(Eb)break}Fa.J(bb).formatting&&bc.cpEnd>Fa.J(bb).cp&&ya.push(Fa.J(bb).formatting)}}else if(bc.contextId===N.a.paragraph&&!za.ParagraphReader.wS(bc)){if(ya=[],Fa=bc.node.ja)for(bb=
0;bb<Fa.length;bb++)Fa.J(bb).formatting&&ya.push(Fa.J(bb).formatting)}else if(bc.contextId===N.a.endOfParagraph)ya=[P.FormattingReader.yr(bc)];else if(bc.contextId===N.a.Ub){this.gXm(bc,wa);return}if(ya&&0<ya.length)for(const gb of ya)if(P.FormattingReader.r3e(wa,gb.cache,bc))return}}gXm(ya,wa){if(ya=P.FormattingReader.yr(ya)){ya=ya.cache;var Fa=$a.pj.mS(l.a.bold,ya.isBold);wa.bold=Fa?1:0;Fa=$a.pj.mS(l.a.italic,ya.isItalic);wa.italic=Fa?1:0;Fa=$a.pj.mS(l.a.underline,ya.isUnderline);wa.underline=Fa?
1:0;wa.underlineType=$a.pj.mS(l.a.underlineType,ya.underlineType);Fa=$a.pj.mS(l.a.superscript,ya.isSuperscript);wa.superscript=Fa?1:0;Fa=$a.pj.mS(l.a.subscript,ya.isSubscript);wa.subscript=Fa?1:0;Fa=$a.pj.mS(l.a.strikethrough,ya.isStrikethrough);wa.strikethrough=Fa?1:0;Fa=$a.pj.mS(x.a.eo,ya.isDoubleStrikethrough);wa.eo=Fa?1:0;Fa=$a.pj.mS(l.a.font,ya.bD);wa.fontName=Ha.a.Dra(Fa);wa.m1=ya.PV;wa.fontSize=$a.pj.mS(l.a.fontSize,ya.fontSize);wa.fontColor=$a.pj.mS(l.a.fontColor,ya.fontColor);wa.highlight=
$a.pj.mS(l.a.highlight,ya.highlight)}}QEf(ya,wa,Fa,bb,Eb,hb){return new wb(ya,wa,Fa,bb,Eb,hb,this.Q9j,$a.sz())}Gje(ya,wa,Fa,bb,Eb){var hb,nb;let Pb=!0,bc=wa;const gb=!Sa.a.uJc(ya);wa.contextId!==N.a.Lc&&wa.contextId!==N.a.Ub?Pb=!1:($a.If.t4(bc,!1,gb)&&($a.Lb.mb(va.a.oo,{["Reason"]:ja.a.CF}),Pb=!1),$a.sz()&&$a.sz().instance&&$a.sz().instance.l0(bc)&&(Pb=!1),Pb&&Aa.SelectionEditor.Ch(wa)&&da.b(bc)&&($a.Lb.mb(va.a.oo,{["Reason"]:ja.a.k5b}),Pb=!1),za.ParagraphReader.wS(wa)&&($a.Lb.mb(va.a.af,{["Reason"]:ja.a.qP}),
Pb=!1));if(1===Fa||!Pb)return Pb?32:8;if(wa.contextId===N.a.Ub)return 2;this.ztn(ya)&&(wa=Aa.SelectionEditor.lvb(bc),Aa.SelectionEditor.Cd(wa)||(bc=wa));wa="boolean"===typeof Eb&&Eb;(null===(hb=this.sea)||void 0===hb?0:hb.annotateRange)&&(null===(nb=this.sea)||void 0===nb?0:nb.zGe(bc.node))?(hb=P.FormattingReader.yr(bc),hb=this.ZAl(bc.node,hb,ya,Eb),this.sea.annotateRange(bc.node,bc.cpBegin,bc.cpEnd,hb)):$a.lUc.Tka(bc,Lb=>{this.gSc(Lb,ya,Eb,bc.cpEnd)},wa);bc.node.ko&&(hb=[Object.assign(new J.a,{name:"Source",
string:"CharacterFormatting"})],M.a("TOCFormatting",!0,void 0,hb));this.I8l(ya)&&this.lme(bc,ya);bb&&la.a.KOb&&(bb.vq|=la.a.tFb(bc.node));return 32}ztn(ya){return ya===ka.a.underline||ya===ka.a.noa||ya===ka.a.strikethrough||ya===ka.a.eo||ya===ka.a.m5}zUc(ya,wa,Fa){return 1!==Fa&&2===Fa?(this.u0.set("Source","Shortcut"),ya=wa.node.characterData.substr(wa.cpBegin,wa.cpEnd-wa.cpBegin),$a.qsg(ya,0,ya.length)?this.lme(wa,ka.a.fib):$a.Tfm(ya,ya.length)?this.lme(wa,ka.a.J2a):this.lme(wa,ka.a.gib)):32}static E8f(ya){return"string"===
typeof ya?{fontName:ya,m1:-1,bold:2,italic:2}:ya}ZAl(ya,wa,Fa,bb){const Eb={},hb=Object(H.a)(28,bb);wa=wa.cache;switch(Fa){case ka.a.bold:2===bb.value&&(bb.value=wa.isBold?0:1);Eb[l.a.bold.id]=1===bb.value;break;case ka.a.setItalic:2===bb.value&&(bb.value=wa.isItalic?0:1);Eb[l.a.italic.id]=1===bb.value;break;case ka.a.underline:2===bb.value&&(bb.value=wa.isUnderline?0:1);Eb[l.a.underline.id]=1===bb.value;break;case ka.a.noa:Eb[l.a.underlineType.id]=bb.number;break;case ka.a.superscript:2===bb.value&&
(bb.value=wa.isSuperscript?0:1);Eb[l.a.superscript.id]=1===bb.value;break;case ka.a.subscript:2===bb.value&&(bb.value=wa.isSubscript?0:1);Eb[l.a.subscript.id]=1===bb.value;break;case ka.a.strikethrough:6!==c.AFrameworkApplication.pa.gz?G.ULS.sendTraceTag(529090079,340,50,"User used strikethrough from ribbon"):G.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===bb.value&&(bb.value=wa.isStrikethrough?0:1);Eb[l.a.strikethrough.id]=1===bb.value;break;case ka.a.eo:2===
bb.value&&(bb.value=wa.isDoubleStrikethrough?0:1);Eb[x.a.eo.id]=1===bb.value;break;case ka.a.font:if(hb&&hb.$c){const {fontName:nb,m1:Pb,bold:bc,italic:gb}=$a.E8f(hb.$c);bb=nb.substr(0,$a.s3i);this.Vue&&(Eb[w.a.n3.id]=bb,Eb[w.a.h7.id]=bb,Eb[w.a.T6.id]=bb,Eb[w.a.E7.id]=bb,Eb[w.a.$ea.id]=Pb,Eb[w.a.Lfa.id]=Pb,Eb[w.a.tfa.id]=Pb,Eb[w.a.lga.id]=Pb);Eb[l.a.font.id]=bb;Eb[w.a.PV.id]=Pb;Object(W.a)()&&(bb=1==bc,ya=1==gb,bb||ya)&&(Eb[l.a.bold.id]=bb,Eb[l.a.italic.id]=ya)}break;case ka.a.$v:bb=Ta.a.instance.IRa(ya,
bb);Eb[l.a.fontColor.id]=bb;break;case ka.a.Uta:ya=Ta.a.instance.IRa(ya,bb);Eb[l.a.fontColor.id]=ya;this.recentColors.LBb(bb)||G.ULS.sendTraceTag(529006977,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ka.a.yaa:Eb[l.a.fontColor.id]=jb.a.auto;break;case ka.a.m5:Eb[l.a.highlight.id]=parseInt(bb,16);break;case ka.a.Gha:Eb[l.a.highlight.id]=parseInt(bb,16);this.recentColors.LBb(bb)||G.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");
break;case ka.a.Fqa:Eb[l.a.highlight.id]=jb.a.auto;break;case ka.a.ay:Eb[l.a.fontSize.id]=$a.Xg.joe(hb.$c)}return Eb}gSc(ya,wa,Fa,bb){var Eb=ya.cache;const hb=Object(H.a)(28,Fa);switch(wa){case ka.a.bold:2===Fa.value&&(Fa.value=Eb.isBold?0:1);$a.Xg.tO(ya,1===Fa.value);break;case ka.a.setItalic:2===Fa.value&&(Fa.value=Eb.isItalic?0:1);$a.Xg.setItalic(ya,1===Fa.value);break;case ka.a.underline:2===Fa.value&&(Fa.value=Eb.isUnderline?0:1);$a.Xg.cda(ya,1===Fa.value);break;case ka.a.noa:$a.Xg.noa(ya,Fa);
break;case ka.a.superscript:2===Fa.value&&(Fa.value=Eb.isSuperscript?0:1);$a.Xg.koa(ya,1===Fa.value);break;case ka.a.subscript:2===Fa.value&&(Fa.value=Eb.isSubscript?0:1);$a.Xg.eDa(ya,1===Fa.value);break;case ka.a.strikethrough:6!==c.AFrameworkApplication.pa.gz?G.ULS.sendTraceTag(539305613,340,50,"User used strikethrough from ribbon"):G.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");2===Fa.value&&(Fa.value=Eb.isStrikethrough?0:1);$a.Xg.Lha(ya,1===Fa.value);break;
case ka.a.eo:2===Fa.value&&(Fa.value=Eb.isDoubleStrikethrough?0:1);$a.Xg.jSc(ya,1===Fa.value);break;case ka.a.font:if(hb&&hb.$c){const {fontName:nb,m1:Pb,bold:bc,italic:gb}=$a.E8f(hb.$c);$a.Xg.n5(ya,nb.substr(0,$a.s3i));$a.Xg.GSc(ya,Pb);Object(W.a)()&&(Fa=1==bc,bb=1==gb,Fa||bb)&&($a.Xg.tO(ya,Fa),$a.Xg.setItalic(ya,bb))}break;case ka.a.$v:G.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");$a.Xg.$v(ya,Fa,null);break;case ka.a.Uta:$a.Xg.$v(ya,Fa,null);this.recentColors.LBb(Fa)||
G.ULS.sendTraceTag(594899727,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ka.a.yaa:$a.Xg.yaa(ya);break;case ka.a.m5:G.ULS.sendTraceTag(594899726,340,50,"Font background color is selected from Standard colors.");$a.Xg.PKa(ya,Fa);break;case ka.a.Gha:$a.Xg.PKa(ya,Fa);this.recentColors.LBb(Fa)||G.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ka.a.Fqa:$a.Xg.Tme(ya);break;case ka.a.ay:$a.Xg.ay(ya,hb.$c);break;case ka.a.X_:$a.Xg.RHi(ya);
break;case ka.a.g1:$a.Xg.rDj(ya);break;case ka.a.Zca:Eb=Fa.fa(w.a.gO,!1);$a.Xg.g1g(ya,Fa.getValue(l.a.Sv),bb,Eb);break;case ka.a.eob:$a.Xg.wXe(ya);break;case ka.a.clearFormatting:$a.Xg.mya(ya);break;case ka.a.fib:case ka.a.gib:case ka.a.KCb:case ka.a.J2a:case ka.a.LCb:Eb.Zza&&2===Eb.capitalization&&$a.Xg.aSk(ya)}}oib(ya,wa,Fa){let bb=!0;ya=!Sa.a.uJc(ya);wa.contextId!==N.a.Lc&&wa.contextId!==N.a.Ub?bb=!1:($a.If.t4(wa,!1,ya)&&($a.Lb.mb(va.a.oo,{["Reason"]:ja.a.CF}),bb=!1),bb&&Aa.SelectionEditor.Ch(wa)&&
da.b(wa)&&($a.Lb.mb(va.a.oo,{["Reason"]:ja.a.k5b}),bb=!1),bb&&za.ParagraphReader.wS(wa)&&($a.Lb.mb(va.a.af,{["Reason"]:ja.a.qP}),bb=!1));if(1===Fa||!bb)return bb?32:8;wa=wa.node;$a.paragraphEditor.FAc(wa,!1);wa.ko&&(wa=[Object.assign(new J.a,{name:"Source",string:"ClearFormatting"})],M.a("TOCFormatting",!0,void 0,wa));return 32}DAc(ya,wa,Fa,bb,Eb){ya={};ya[ib.a.TZa]=6168;ya[ib.a.SZa]=6169;const hb=wa.view;var nb=null;hb.gj&&(nb=hb);var Pb=!0;let bc=32;nb&&(nb=nb.Oa.ya.Ba)&&($a.If.$Ge(nb)?($a.Lb.mb(va.a.af,
{["Reason"]:ja.a.CF}),bc=8,Pb=!1):1===Fa&&(bc=32,Pb=!1));Pb&&(Pb=new X.GraphTransaction(1===Fa?3:15),Pb.Sa(hb.root),bc=ib.a.mCa(ka.a.oib,wa,Fa,bb,Eb,ya,12),Pb.dispose());return bc}YEf(ya,wa,Fa,bb,Eb){var hb=!0,nb=32;const Pb=!Sa.a.uJc(ya);wa.contextId!==N.a.Ub?hb=!1:$a.If.t4(wa,!1,Pb)&&($a.Lb.mb(va.a.oo,{["Reason"]:ja.a.CF}),hb=!1);if(1===Fa||!hb)return hb?32:8;Fa=wa.node;A.a.instance.J(8)&&ya===ka.a.clearFormatting&&($a.es.EAc(Fa),$a.paragraphEditor.C7h(Fa),hb=$a.Vmc.rz(Fa).Mf($a.Vmc.wordStyleIdNormal),
$a.Wha.hT(hb,Fa,!0));if(Fa=$a.pj.Lbg(wa))nb=Ba.a.s3a(Fa),nb=c.AFrameworkApplication.pa.rf(nb,ya,2,!1,bb,Eb);else{bb=Object(H.a)(28,Eb);wa=P.FormattingReader.yr(wa);if(!wa)return 16;wa=wa.cache;switch(ya){case ka.a.font:if(bb&&bb.$c){const {fontName:bc,m1:gb,bold:Lb,italic:Ic}=$a.E8f(bb.$c);$a.pj.uXe(bc);$a.pj.GSc(gb);Object(W.a)()&&(ya=1==Lb,Eb=1==Ic,ya||Eb)&&($a.pj.tO(ya),$a.pj.setItalic(Eb))}break;case ka.a.$v:G.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");
$a.pj.$v(Eb);break;case ka.a.Uta:$a.pj.$v(Eb);this.recentColors.LBb(Eb)||G.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ka.a.yaa:$a.pj.yaa();break;case ka.a.m5:G.ULS.sendTraceTag(594899722,340,50,"Font background color is selected from Standard colors.");$a.pj.PKa(Eb);break;case ka.a.Gha:$a.pj.PKa(Eb);this.recentColors.LBb(Eb)||G.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ka.a.Fqa:$a.pj.Tme();
break;case ka.a.ay:$a.pj.ay(bb.$c);break;case ka.a.X_:ya=$a.pj.mS(l.a.fontSize,wa.fontSize);$a.pj.ay($a.Xg.X_(ya));break;case ka.a.g1:ya=$a.pj.mS(l.a.fontSize,wa.fontSize);$a.pj.ay($a.Xg.g1(ya));break;case ka.a.bold:ya=$a.pj.mS(l.a.bold,wa.isBold);$a.pj.tO(!ya);break;case ka.a.setItalic:ya=$a.pj.mS(l.a.italic,wa.isItalic);$a.pj.setItalic(!ya);break;case ka.a.underline:ya=$a.pj.mS(l.a.underline,wa.isUnderline);$a.pj.cda(!ya);break;case ka.a.noa:$a.pj.noa(Eb);break;case ka.a.superscript:ya=$a.pj.mS(l.a.superscript,
wa.isSuperscript);$a.pj.koa(!ya);break;case ka.a.subscript:ya=$a.pj.mS(l.a.subscript,wa.isSubscript);$a.pj.eDa(!ya);break;case ka.a.strikethrough:ya=$a.pj.mS(l.a.strikethrough,wa.isStrikethrough);$a.pj.Lha(!ya);break;case ka.a.eo:ya=$a.pj.mS(x.a.eo,wa.isDoubleStrikethrough);$a.pj.jSc(!ya);break;case ka.a.clearFormatting:$a.pj.B8a();break;case ka.a.Zca:Eb.hasProperty(l.a.Sv)&&$a.pj.Zca(Eb.getValue(l.a.Sv)),Eb.hasProperty(w.a.gO)&&(ya=Eb.getValue(w.a.gO),$a.pj.Jmn(ya))}}Ma.App.oa.updateCommandUI();
return nb}h7m(ya,wa){ka.a.clearFormatting===wa&&I.OutlineElementNavigator.Fl(ya).properties.removeProperty(l.a.OI)}g_(ya,wa,Fa,bb,Eb){bb=$a.Lb.mm(ka.a.Qwj);var hb=!0;wa.contextId!==N.a.endOfParagraph&&(hb=!1);if(1===Fa||!hb)return hb?32:8;Fa=wa.node;hb=B.GraphIterator.ua(wa.node);hb.kc();var nb=hb.ZP(4);if((hb=!!nb&&$a.Vb.o0(nb))&&!Ma.App.A6a)return 8;var Pb=!za.ParagraphReader.textLength(Fa);bb.properties.$("Action",ya.toString());bb.properties.$("ListContext",hb.toString());bb.properties.$("IsEmptyParagraph",
Pb.toString());G.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",ya,hb,Pb);hb&&!qa.a.Oc.hV&&this.dPj(ya,Eb,nb);if(!hb||hb&&$a.Oc&&$a.Oc.qVa){hb=Fa.ja.last;this.h7m(Fa,ya);c.AFrameworkApplication.Zi("Microsoft.Office.WordOnline.EOPNoFormattingFixEnabled");if(c.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EOPNoFormattingFixEnabled",!1)){Pb=!!hb.formatting;const bc=Fa.getValue(w.a.endOfParagraphFormatting);nb=$a.characterPropertiesEditor.vHa(Fa);
Pb=!Pb&&bc&&bc.equals(r.a.nil)?new ia.a(hb,r.a.nil):nb.Xc(nb.Wa)}else nb=$a.characterPropertiesEditor.vHa(Fa),Pb=nb.Xc(nb.Wa);this.gSc(nb,ya,Eb,hb.cp);A.a.instance.J(3)&&$a.Aj.alc(Fa,hb,wa.cpBegin,wa.cpEnd,Pb,nb,$a.hd.Jf)}bb.end();return 32}dPj(ya,wa,Fa){const bb=Object(H.a)(28,wa);switch(ya){case ka.a.$v:$a.tBa.$v(Fa,wa);break;case ka.a.Uta:$a.tBa.$v(Fa,wa);break;case ka.a.ay:$a.tBa.ay(Fa,bb.$c);break;case ka.a.yaa:$a.tBa.yaa(Fa);break;case ka.a.X_:$a.tBa.X_(Fa);break;case ka.a.g1:$a.tBa.g1(Fa);
break;case ka.a.font:$a.tBa.Nkn(Fa,bb.$c);break;case ka.a.bold:ya=this.WQc(wa,l.a.bold,Fa);$a.tBa.tO(Fa,ya);break;case ka.a.setItalic:ya=this.WQc(wa,l.a.italic,Fa);$a.tBa.setItalic(Fa,ya);break;case ka.a.subscript:ya=this.WQc(wa,l.a.subscript,Fa);$a.tBa.eDa(Fa,ya);break;case ka.a.superscript:ya=this.WQc(wa,l.a.superscript,Fa);$a.tBa.koa(Fa,ya);break;case ka.a.strikethrough:ya=this.WQc(wa,l.a.strikethrough,Fa);$a.tBa.Lha(Fa,ya);break;case ka.a.eo:ya=this.WQc(wa,x.a.eo,Fa),$a.tBa.jSc(Fa,ya)}}WQc(ya,
wa,Fa){2===ya.value&&(ya.value=Fa?Fa.fa(wa,!1)?0:1:0);return 1===ya.value}Txa(ya,wa,Fa,bb,Eb){bb=!0;const hb=B.GraphIterator.ua(wa.node);hb.kc();wa.contextId===N.a.endOfParagraph&&hb.ZP(4)||($a.Lb.mb(va.a.oo,{["Reason"]:ja.a.wGd}),bb=!1);wa=hb.currentNode;if(!$a.Vb.o0(wa))return 8;if(1===Fa||!bb)return bb?32:8;qa.a.Oc.hV||this.dPj(ya,Eb,wa);return 32}ACa(ya,wa,Fa,bb,Eb){ya=!0;wa.contextId!==N.a.paragraph&&(ya=!1);if(1===Fa&&!ya)return 8;Fa=wa.node;-1!==Eb.Mj?Eb.Mj!==za.ParagraphReader.Jv(Fa)&&(Eb.Mj=
0):Eb.Mj=za.ParagraphReader.Jv(Fa);A.a.instance.J(7)&&(ya=$a.tD.Jlb(Fa),Eb.fu?(!Eb.bZl&&this.eZl(Eb.fu,ya)&&2===Eb.fu.specialIndentType&&(Eb.fu.specialIndentType=0),Eb.fu.Gac===ya.Gac&&t.a.r4(Eb.fu.yE,ya.yE)||(Eb.fu.yE=Number.MAX_VALUE),Eb.fu.Hac===ya.Hac&&t.a.r4(Eb.fu.sAa,ya.sAa)||(Eb.fu.sAa=Number.MAX_VALUE)):Eb.fu=ya,wa=$a.jg.tke(wa.Am),void 0!==wa&&null!==wa&&(wa=wa.node,void 0!==wa&&null!==wa&&(wa=R.WordSectionNavigator.instance.BK(wa),void 0!==wa&&null!==wa&&(wa=$a.pi.Gt(wa)-($a.pi.UP(wa)+$a.pi.VP(wa)+
Ma.App.$Da),ya.Kzd=wa-ya.yE,ya.Izd=wa-ya.sAa,Eb.fu.Izd=Math.min(Eb.fu.Izd,ya.Izd),Eb.fu.Kzd=Math.min(Eb.fu.Kzd,ya.Kzd)))));A.a.instance.J(7)&&(wa=$a.w0.cIa(Fa),Eb.vO?(Eb.vO.beforeSpacing=$a.lXh(wa.beforeSpacing,Eb.vO.beforeSpacing),Eb.vO.afterSpacing=$a.lXh(wa.afterSpacing,Eb.vO.afterSpacing),Eb.vO.lineSpacing.unit===wa.lineSpacing.unit&&t.a.r4(Eb.vO.lineSpacing.value,wa.lineSpacing.value)||(Eb.vO.lineSpacing.unit=0,Eb.vO.lineSpacing.value=0)):Eb.vO=wa);wa=new B.GraphIterator;wa.set(Fa);wa.La(11);
if(Fa=wa.tc(11))Eb.isRtl=ba.OutlineElementReader.wi(Fa);Fa=$a.Vb.ht(wa);wa=16;void 0!==Fa&&null!==Fa&&(wa=Fa.listType);Eb.listType=$a.Twl(Eb.listType,wa);Eb.Tx=16===Eb.listType?null:Fa;return 32}eZl(ya,wa){return this.OZh(ya,wa)||this.OZh(wa,ya)}OZh(ya,wa){return(1===ya.specialIndentType||!ya.specialIndentType)&&2===wa.specialIndentType}DXm(ya,wa,Fa,bb,Eb){Eb.isRtl=ba.OutlineElementReader.wi(I.OutlineElementNavigator.Fl(wa.node));return 32}vZh(ya,wa,Fa){if(ya===ka.a.sNb)ya=!0;else if(ya===ka.a.rNb)ya=
!1;else return 2;ya&&this.f1i(wa);if(1===Fa)return 32;$a.Pg.olc(I.OutlineElementNavigator.Fl(wa.node),ya);return 32}wXm(ya,wa,Fa,bb,Eb){ya=wa.node;Eb.isRtl=ba.OutlineElementReader.isRtl(I.OutlineElementNavigator.Fl(ya));Eb.Mj=T.ImageReader.Jv(ya);return 32}QXm(ya,wa,Fa,bb,Eb){ya=wa.node;Eb.isRtl=ba.OutlineElementReader.isRtl(I.OutlineElementNavigator.Fl(ya));Eb.Mj=ta.TableReader.Jv(ya);-1!==Eb.Mj&&Eb.Mj||(Eb.Mj=Eb.isRtl?3:1);return 32}dFf(ya,wa,Fa,bb,Eb){let hb;if(!({BA:hb}=Sa.a.b4g(Fa,wa)).returnValue)return hb;
const nb=wa.node;switch(ya){case ka.a.rNb:$a.Pg.ESc(nb,!1);break;case ka.a.sNb:this.f1i(wa);$a.Pg.ESc(nb,!0);break;case ka.a.Zca:hb=c.AFrameworkApplication.pa.rf(wa.Am,ya,Fa,!0,bb,Eb),32===hb&&za.ParagraphReader.rh(wa)&&$a.ONd&&$a.ONd.Tha(nb)}return 32}iSk(ya,wa,Fa,bb,Eb){const hb={};hb[ib.a.TZa]=6168;hb[ib.a.SZa]=6169;var nb=wa.view;const Pb=new X.GraphTransaction(1===Fa?3:15);Pb.Sa(nb.root);let bc=ib.a.mCa(ya,wa,Fa,bb,Eb,hb,0),gb=null;nb.gj&&(gb=nb);nb=!0;let Lb=null;gb&&(Lb=gb.Oa.ya.Ba)&&(ya=!Sa.a.uJc(ya),
$a.If.$Ge(Lb,ya)?($a.Lb.mb(va.a.af,{["Reason"]:ja.a.CF}),bc=8,nb=!1):1===Fa&&(bc=32,nb=!1),$a.jg.h9(za.ParagraphReader.wS,gb.Oa.Ag)&&($a.Lb.mb(va.a.af,{["Reason"]:ja.a.qP}),bc=8,nb=!1));nb&&this.Xfm(Lb)&&(bc=ib.a.mCa(ka.a.oib,wa,Fa,bb,Eb,hb,12));Pb.dispose();return bc}hSk(ya,wa,Fa){ya=!0;wa.contextId!==N.a.paragraph&&wa.contextId!==N.a.Ub?ya=!1:$a.If.tVa(wa)&&($a.Lb.mb(va.a.oo,{["Reason"]:ja.a.CF}),ya=!1);if(1===Fa||!ya)return ya?32:8;wa=wa.node;Fa=new X.GraphTransaction(15);Fa.Sa(wa);$a.es.EAc(wa);
$a.paragraphEditor.FAc(wa,!0);$a.Wha.sMf(wa);Fa.dispose();return 2}iVl(ya,wa,Fa){ya=!0;wa.contextId!==N.a.view&&(ya=!1);if(1===Fa&&!ya)return 8;if(!wa.view||!wa.view.Yd)return 2;wa=wa.view;if(!wa.Oa||!wa.Oa.ya.Ba)return 8;if($a.jg.h9(za.ParagraphReader.wS,wa.Oa.Ag))return $a.Lb.mb(va.a.af,{["Reason"]:ja.a.qP}),8;wa=wa.Oa.ya;for(const bb of wa)for(const Eb of bb)if(Eb&&Eb.contextId!==N.a.Lc&&Eb.contextId!==N.a.Ub&&Eb.contextId!==N.a.paragraph&&Eb.contextId!==N.a.endOfParagraph)return 2;return 32}a8a(ya,
wa,Fa,bb,Eb){ya=!0;wa.contextId!==N.a.paragraph&&(ya=!1);if(1===Fa&&!ya)return 8;Eb.fu||(wa=wa.node,Fa=$a.tD.Jlb(wa),Eb.fu=Fa,Fa=new B.GraphIterator,Fa.set(wa),Fa.La(11),wa=Fa.tc(11),Eb.isRtl=wa?ba.OutlineElementReader.wi(wa):!1);return 32}RXm(ya,wa,Fa,bb,Eb){wa=wa.node;ya=I.OutlineElementNavigator.Fl(wa);Eb.fu||(wa=this.nJl(wa),wa=$a.tD.Jlb(wa),Eb.fu=wa,Eb.isRtl=ba.OutlineElementReader.isRtl(ya));return 32}nJl(ya){ya=B.GraphIterator.ua(ya);ya.La(11);na.moveToCell(ya,0,0);ya.Rc();ya.QN();return ya.currentNode}Xfm(ya){return!ya||
Aa.SelectionEditor.qj(ya)||1===ya.length&&Aa.SelectionEditor.Ch(ya.ra)&&!Aa.SelectionEditor.OIa(ya.ra)?!1:!0}f1i(ya){$a.tMh.Na(ya.contextId)||(G.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",ya.contextId),$a.tMh.$(ya.contextId,!0))}I8l(ya){return ya===ka.a.KCb||ya===ka.a.fib||ya===ka.a.gib||ya===ka.a.J2a||ya===ka.a.LCb}lme(ya,wa){const Fa=ya.node,bb=Fa.characterData.substr(ya.cpBegin,ya.cpEnd-ya.cpBegin);this.u0.set("Command",wa.toString());k.Health.instance.recordKpiUsage(this.kpiName,1,this.G_,
this.u0);wa=$a.gDn(bb,wa);Fa.qM(Fa.characterData.substr(0,ya.cpBegin)+wa+Fa.characterData.substr(ya.cpEnd));return 32}static get Xg(){return $a.Wd||($a.Wd=f.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return $a.hc||($a.hc=f.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return $a.Ki||($a.Ki=f.a.instance.resolve("Box4.IParagraphEditor"))}static get w0(){return $a.DC||($a.DC=f.a.instance.resolve("Box4.ILineSpacingHelper"))}static get Vmc(){return $a.nk||
($a.nk=f.a.instance.resolve("Box4.Styles.IWACStyleReader"))}static get Wha(){return $a.Kz||($a.Kz=f.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}static get Pg(){return $a.Ee||($a.Ee=f.a.instance.resolve("Box4.IOutlineElementEditor"))}static get pj(){return $a.Xn||($a.Xn=f.a.instance.resolve("Box4.IInsertionPointFormatting"))}static get tBa(){return $a.mOa||($a.mOa=f.a.instance.resolve("Box4.List.IListFormattingEditor"))}static get tD(){return $a.Ck||($a.Ck=f.a.instance.resolve("Box4.IParagraphIndentationReader"))}static sz(){return $a.Wl||
($a.Wl=f.a.instance.Ca("Box4.IExternalSelectionManager"))}static get Oc(){return V.a.getInstance()}static get jg(){return ra.ContextSetEditor.instance}static get If(){return xa.a.instance}static get Lb(){return m.a.instance}static get Ka(){return $a.Ja||($a.Ja=f.a.instance.sa("Box4.IFeatureHelper"))}static get ONd(){return Ma.App.UH}static get hd(){return $a.Eb||($a.Eb=f.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Aj(){return $a.tf||($a.tf=f.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get lUc(){return $a.kU||
($a.kU=f.a.instance.resolve("Box4.TextFormattingHelper"))}static get Vb(){return $a.zc||($a.zc=f.a.instance.resolve("Box4.List.IListReader"))}static get es(){return $a.Wq||($a.Wq=f.a.instance.resolve("Box4.List.IListEditor"))}static get pi(){return ha.a.instance}static Twl(ya,wa){return 42===ya?wa:ya!==wa||16===ya?16:ya}static lXh(ya,wa){ya.eFe||(wa.eFe?wa=ya:wa.unit===ya.unit&&t.a.r4(wa.value,ya.value)||(wa.value=-1));return wa}static gDn(ya,wa){switch(wa){case ka.a.fib:return ya.toLowerCase();case ka.a.gib:return 6!==
c.AFrameworkApplication.pa.gz?G.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):G.ULS.sendTraceTag(539305616,340,50,"User changed the case from keyboard shortcut"),ya.toUpperCase();case ka.a.KCb:case ka.a.J2a:return $a.sPk(ya,wa===ka.a.J2a);case ka.a.LCb:return $a.QEn(ya);default:return ya}}static QEn(ya){let wa="";for(let Fa=0;Fa<ya.length;Fa++)wa=ya.charAt(Fa)===ya.charAt(Fa).toUpperCase()?wa+ya.charAt(Fa).toLowerCase():wa+ya.charAt(Fa).toUpperCase();return wa}static sPk(ya,
wa){let Fa,bb,Eb=!0,hb=ya.length,nb=0,Pb=$a.qsg(ya,nb,hb);for(;0<hb;){bb=Fa=!1;var bc=hb;let Lb;var gb=void 0;for(gb=0;0<bc&&$a.tRk(ya.charAt(nb+gb));gb++,bc--)bb=$a.bHe(ya.charAt(nb+gb));for(Lb=gb;0<bc&&!(Fa=$a.bHe(ya.charAt(nb+gb)))&&" "!==ya.charAt(nb+gb)&&"/"!==ya.charAt(nb+gb);gb++,bc--);bc=gb-Lb;if(0>=bc)break;nb+=Lb;gb=ya.substr(nb,bc);gb=gb===gb.toUpperCase();if(Pb||!gb)ya=Eb||bb||wa?ya.substr(0,nb)+ya.charAt(nb).toUpperCase()+ya.substr(nb+1,bc-1).toLowerCase()+ya.substr(nb+bc):ya.substr(0,
nb)+ya.substr(nb,bc).toLowerCase()+ya.substr(nb+bc);hb-=bc+Lb;nb+=bc;if(Eb=Fa)nb++,hb--,Pb=$a.qsg(ya,nb,hb)}return ya}static qsg(ya,wa,Fa){for(;0<Fa&&!$a.bHe(ya.charAt(wa));){if(ya.charAt(wa)!==ya.charAt(wa).toUpperCase())return!1;wa++;Fa--}return!0}static Tfm(ya,wa){for(var Fa=0;0<wa&&!$a.bHe(ya.charAt(Fa));){if(ya.charAt(Fa)!==ya.charAt(Fa).toLowerCase())return!1;Fa++;wa--}return!0}static bHe(ya){return"."===ya||"!"===ya||"?"===ya?!0:!1}static tRk(ya){return-1==="0123456789".indexOf(ya)&&ya.toUpperCase()===
ya.toLowerCase()}}$a.Wd=null;$a.Ee=null;$a.tMh=new F.a;$a.DC=null;$a.hc=null;$a.Ki=null;$a.nk=null;$a.Kz=null;$a.Xn=null;$a.mOa=null;$a.Ck=null;$a.Wl=null;$a.Ja=null;$a.Eb=null;$a.tf=null;$a.kU=null;$a.vAb=null;$a.zc=null;$a.Wq=null;$a.s3i=31;Object(C.a)($a,"TextFormattingActor",null,[])},1775:function(C,L,b){b.d(L,"a",function(){return f});const f=(c,u)=>{var r=c.B1j;if(!r){r=[];for(var t in c)"string"===typeof t&&r.push({key:t,value:c[t]});r.sort((k,m)=>k.value-m.value);c.B1j=r}r=[];for(t=1;0<u;)u&
1&&c[t]&&r.push(c[t]),t<<=1,u>>=1;if(r.length&&0===u)return r.reverse().join(", ")}},1776:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);var f;(function(c){c[c.chrome=0]="chrome";c[c.edge=1]="edge";c[c.firefox=2]="firefox";c[c.IE=3]="IE";c[c.safari=4]="safari";c[c.others=5]="others";c[c.unknown=6]="unknown";c[c.electron=7]="electron";c[c.chromiumEdge=8]="chromiumEdge";c[c.teamsElectron=9]="teamsElectron"})(f||(f={}));Object(C.b)("BrowserCode",f)},1777:function(C,L,b){b.d(L,"a",function(){return f});
C=b(0);class f{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(C.a)(f,"AtMentionAttributes",null,[])},1783:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);var f;(function(c){c[c.initial=0]="initial";c[c.startSearch=1]="startSearch";c[c.searching=2]="searching";c[c.searchComplete=3]="searchComplete";c[c.replaceAllInProgress=4]="replaceAllInProgress";c[c.replaceAllComplete=5]="replaceAllComplete";c[c.tooManyResults=6]="tooManyResults";c[c.noMatchesFound=7]="noMatchesFound"})(f||
(f={}));Object(C.b)("FindReplaceViewType",f)},1785:function(C,L,b){b.d(L,"a",function(){return f});var f;(function(c){c[c.initial=0]="initial";c[c.headings=1]="headings";c[c.find=2]="find";c[c.replace=3]="replace";c[c.intelligentPlaceholder=4]="intelligentPlaceholder"})(f||(f={}))},1792:function(C,L,b){function f(a,d){d=Object.assign(new ba.a,{name:"LinkType",string:d});c(Mb.a.FNi,a,[d])}function c(a,d,n,z=!0){d&&d.UILocation&&Object(we.d)(a,z,we.e,0,d.UILocation,0,n)}function u(a,d){var n;return a===
Bs.none?"none":null===(n=nu[a])||void 0===n?void 0:n[d]}function r(a,d,n){return{type:"ShortcutDiscoverySettingsModel",actionId:a,vAj:d,label:n}}b.r(L);var t=b(0),k=b(8),m=b(41),l=b(2),x=b(32),w=b(16),G=b(164),D=b(89);class H{constructor(a){this.$$g=0;this.kac=this.tPc=this.gub=null;this.JV=l.AFrameworkApplication.la.Np;this.$_=a;this.$_.ax(D.a.k0g);this.$_.uD(D.a.k0g,Object(m.a)(this,this.IIm,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.kac)return k.ULS.sendTraceTag(589050652,344,
100,"Returning existing promise"),this.kac;this.gub=this.JV.Pe("ComponentAttach","getCustomAuthConfig");return this.kac=new Promise((a,d)=>{const n={};let z=!1,O=!1,ca=0;this.$$g=window.setInterval(()=>{4>ca?(ca++,this.$_.Eh(D.a.getCustomAuthConfig,n)):(window.clearInterval(this.$$g),z=!0,k.ULS.sendTraceTag(588087303,344,10,x.c({["error"]:"Request timeout after 4 retries."})),d("Request timeout."))},1E3);this.tPc=(Da,Xa)=>{window.clearInterval(this.$$g);z||O||(O=!0,Da?(k.ULS.sendTraceTag(589050653,
344,50,"Resolving Promise with authConfig"),a(Da)):(k.ULS.sendTraceTag(589050654,369,10,x.c({["error"]:Xa.toString()})),d(Xa)))};this.$_.Eh(D.a.getCustomAuthConfig,n)})}IIm(a){try{const d=x.a(a.Values[G.a.d3h]);let n=l.AFrameworkApplication.K.Ga("Application")||"";n=w.a.He(n);d.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+n+"%3Facctsw%3D1&prompt=select_account";d.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+n+"%3Facctsw%3D1";d.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+
n+"%3Facctsw%3D1&prompt=select_account";d.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+n+"%3Facctsw%3D1";this.gub&&(this.gub.stop(),this.gub=null);this.tPc(d,"")}catch(d){k.ULS.sendTraceTag(589050655,344,10,x.c({["error"]:d.message,["stack"]:d.stack})),this.tPc(null,d.message)}}}Object(t.a)(H,"AccountSwitchingManager",null,[156]);var M=b(167);class J{get name(){return"Common.App.AccountSwitching"}Hb(a){a.register(H,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").singleInstance().zd(()=>
new H(a.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){M.a.instance.Sb(new J)}}Object(t.a)(J,"AccountSwitchingPackage",null,[1,2]);var F;(function(a){a[a.generalException=0]="generalException";a[a.invalidArgument=1]="invalidArgument";a[a.notAllowed=2]="notAllowed";a[a.apiNotAvailable=3]="apiNotAvailable";a[a.unresolvedPendingRequest=4]="unresolvedPendingRequest";a[a.timeout=5]="timeout";a[a.adalTimeout=6]="adalTimeout";a[a.userNotSignedIn=7]="userNotSignedIn";a[a.userAborted=
8]="userAborted";a[a.silentSignInFailed=9]="silentSignInFailed";a[a.invalidResourceUrl=10]="invalidResourceUrl";a[a.invalidGrant=11]="invalidGrant";a[a.connectionLost=12]="connectionLost";a[a.clientError=13]="clientError";a[a.serverError=14]="serverError"})(F||(F={}));Object(t.b)("ErrorCodes",F);b(1623);class A{constructor(a,d){this.requestCallback=this.requestParameters=null;this.requestParameters=a;this.requestCallback=d}}Object(t.a)(A,"OutstandingRequest",null,[]);class N{}N.Gzm="AADSTS50058";
N.invalidResourceUrl="AADSTS50001";N.Bzm="AADSTS65001";N.gAm="AADSTS70011";N.userAborted="13002";N.RRm="Popup Window is null";N.QRm="Popup Window closed";N.adalTimeout="Token renewal operation failed due to timeout";N.XEn="tokenRevoked";Object(t.a)(N,"WopiHostErrorType",null,[]);var B=b(1324),E=b(51),P=b(1622);class T{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(t.a)(T,"WopiIdentityInfo",null,[773]);class V{constructor(a,d,n){this.expiration=
this.authority=this.accessToken=null;this.accessToken=a;this.authority=d;this.expiration=n}}Object(t.a)(V,"WopiIdentityToken",null,[772]);var I=b(15),R=b(131),ba=b(35),ha=b(168);class na{constructor(a){this._initialized=!1;this.zOc={};this.Y_e={};this.JV=l.AFrameworkApplication.la.Np;this.Ohg=a}i_f(a){this._initialized||(a.ax(D.a.pNg),a.uD(D.a.pNg,Object(m.a)(this,this.HIm,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(a,d,n=null){this.cWa(a,d);return new Promise((z,O)=>{if(this.Vlg(d))if(d in
this.zOc)O("unresolvedPendingRequest");else{var ca=window.setTimeout(()=>{k.ULS.sendTraceTag(37856032,344,10,x.c({["error"]:"Request timeout.",["callerId"]:d}));O("timeout")},12E4);this.R4f(a,d,n,(Da,Xa)=>{window.clearTimeout(ca);Da?z(Da):(k.ULS.sendTraceTag(37856033,369,15,x.c({["error"]:F[Xa]})),O(Xa))})}else k.ULS.sendTraceTag(37856034,344,10,x.c({["error"]:"Caller is not allowed."})),O("notAllowed")})}getPrimaryIdentityInfo(a){return new Promise((d,n)=>{this.Vlg(a)?this.$Kl((z,O)=>{z?d(z):(k.ULS.sendTraceTag(37856064,
369,10,x.c({["error"]:O.toString()})),n(O))}):(k.ULS.sendTraceTag(37856065,344,10,x.c({["error"]:"Caller is not allowed."})),n("notAllowed"))})}getAuthContext(a){return new Promise((d,n)=>{const z=this.getAuthContextSync(a);z?d(z):n("notAllowed")})}getAuthContextSync(a){if(this.Vlg(a)){const d=new P.a;d.upn=l.AFrameworkApplication.K.Ga("UserPrincipalName");d.userId=l.AFrameworkApplication.K.Ga("LoggableUserId");d.authority=l.AFrameworkApplication.K.Ga("HostAuthAuthority");d.tenantId=l.AFrameworkApplication.K.Ga("TenantId");
d.isAnonymous=l.AFrameworkApplication.K.ea("IsAnonymousUser");d.supportsAuthToken=this.Y_l(a);a=l.AFrameworkApplication.K.Ga("HostAuthType");d.authorityType="aad"===a.toLowerCase()?2:"msa"===a.toLowerCase()?1:0;return d}k.ULS.sendTraceTag(40751647,344,10,x.c({["error"]:"Caller is not allowed."}));return null}Y_l(a){const d=B.a.Pyd;return I.a.hBa?d&&B.a.fIj?Array.contains(B.a.fIj,a.toLowerCase()):!1:d}R4f(a,d,n,z){var O=[];Array.add(O,Object.assign(new ba.a,{name:"CallerId",string:d}));Array.add(O,
Object.assign(new ba.a,{name:G.a.E_e,string:a.correlationId}));R.a.sendTelemetryEvent(Object.assign(new ha.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:O}));O=E.a.create().toString();const ca="getAccessToken_"+O,Da=this.JV.Pe("ComponentAttach",ca);this.Y_e[ca]=Da;const Xa={};Xa[G.a.F_e]=O;Xa[G.a.REj]=a.resource;Xa[G.a.SEj]=a.scope;Xa[G.a.v7g]=l.AFrameworkApplication.K.Ga("HostAuthType");Xa[G.a.VEj]=l.AFrameworkApplication.K.Ga("UserPrincipalName");Xa[G.a.TEj]=
a.silentLogin;Xa[G.a.OEj]=a.options;Xa[G.a.E_e]=a.correlationId;Xa[G.a.PEj]=d;n&&(Xa[G.a.addinName]=n.AddinName,Xa[G.a.NEj]=n.AddinTrustId);this.Ohg.execute(zb=>{this.i_f(zb);zb.Eh(D.a.getAuthToken,Xa)});this.zOc[O]=new A(a,z)}$Kl(a){const d=l.AFrameworkApplication.K.Ga("UserName"),n=l.AFrameworkApplication.K.Ga("UserPrincipalName"),z=l.AFrameworkApplication.K.Ga("LoggableUserIdSpace"),O=new T;O.email=n;O.displayName=d;switch(z){case "OrgIdPuid":O.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":O.authority=
"MicrosoftAccount";break;default:O.authority=z}a(O,null)}HIm(a){let d=null;try{let z=a.Values[G.a.F_e];const O=a.Values[G.a.MEj],ca=a.Values[G.a.v7g],Da=a.Values[G.a.UEj];let Xa=null,zb=null;const Vb=this.zOc[z];if("undefined"!==typeof Vb&&Vb){var n=[];Array.add(n,Object.assign(new ba.a,{name:G.a.E_e,string:Vb.requestParameters.correlationId}));R.a.sendTelemetryEvent(Object.assign(new ha.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:n}));d=Vb.requestCallback;
delete this.zOc[z];"undefined"!==typeof O&&O&&O.length?zb=new V(O,ca,Da):Xa=F[this.Atm(a)];n="getAccessToken_"+z;n in this.Y_e&&(this.Y_e[n].stop(),delete this.Y_e[n]);d(zb,Xa)}else k.ULS.sendTraceTag(37856066,344,10,x.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:z}))}catch(z){a=a.Values[G.a.F_e],a in this.zOc&&delete this.zOc[a],this.jKe(),k.ULS.sendTraceTag(37856067,344,10,x.c({["error"]:z.message,["stack"]:z.stack})),d&&d(null,"generalException")}}Vlg(a){var d=l.AFrameworkApplication.XGi();
a=a.toLowerCase();for(const n of d)if(a===n.toLowerCase())return!0;d=B.a.sEf;for(let n in d)if(a===d[n].toLowerCase())return!0;return!1}Atm(a){a=a.Values[G.a.QEj];this.jKe();k.ULS.sendTraceTag(39068821,344,15,x.c({["error"]:a}));return a?-1<a.indexOf(N.Gzm)?9:-1<a.indexOf(N.RRm)||-1<a.indexOf(N.QRm)?12:-1<a.indexOf(N.invalidResourceUrl)?10:-1<a.indexOf(N.userAborted)?8:-1<a.indexOf(N.gAm)||-1<a.indexOf(N.Bzm)||a===N.XEn?11:-1<a.indexOf(N.adalTimeout)?6:0:13}cWa(a,d){a=this.w1m(a.resource);k.ULS.sendTraceTag(39921882,
344,50,x.c({["callerId"]:d,["resource"]:a}))}jKe(){k.ULS.sendTraceTag(39068822,344,50,x.c({["userAgent"]:window.navigator.userAgent}))}w1m(a){return(a?a:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(t.a)(na,"WopiIdentityManager",null,[746]);class da{constructor(){this.Z=null}get name(){return"Common.App.WopiIdentity"}Hb(a){this.Z=a;a.register(na,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").singleInstance().zd(()=>
new na(a.Ca("Postmessage.IHostPostmessenger")))}init(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.wq(Object(m.a)(this,this.Gw,"onFullAppSettingsReady"))}Gw(){try{this.Z.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(a){k.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+a)}}dispose(){}static main(){M.a.instance.Sb(new da)}}Object(t.a)(da,"WopiIdentityPackage",null,[1,2]);var ia=b(500),ma=b(350),qa=b(70),ka;(function(a){a[a.applicationFeatureHelperHandler=
0]="applicationFeatureHelperHandler";a[a.cloudPolicySettings=1]="cloudPolicySettings";a[a.alternateAuthToken=2]="alternateAuthToken"})(ka||(ka={}));Object(t.b)("ApplicationFeatureHelperRequestType",ka);class va{constructor(){this.message=null;this.httpStatusCode=0}}Object(t.a)(va,"HttpRequstToPromiseRejectData",null,[]);var ja=b(79),Ma=b(175);class Ha{constructor(a,d){this.va=a;this.nf=d}vRf(a,d,n,z=null,O=null,ca=null,Da=null,Xa=null){const zb=ka[n],Vb=zb+"RequestFailure";ja.Health.instance.recordKpiUsage(Vb,
0,"jpittsdirects",null);return new Promise((Fc,Yc)=>{k.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",zb);const yd=null!=Da?Da:this.va.jb("ApplicationFeatureHelperRequestQueueTimeout",15E3),je=null!=Xa?Xa:this.va.jb("ApplicationFeatureHelperRequestSentTimeout",3E4);this.nf.MBb(a,1,null,this.JBl(n,z),ca,!1,1,Le=>{k.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",
zb);try{if(void 0===Le||null===Le||void 0===Le.data||null===Le.data||void 0===Le.data.Rd||null===Le.data.Rd){ja.Health.instance.recordKpiFailure(Vb,"Invalid RequestSucceededEventArgs",!1,!0,null);let gg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",zb);Yc(this.hwd(gg,Le))}else if(Le.data.Ge!==Ma.a.HD){ja.Health.instance.recordKpiFailure(Vb,"HttpStatusCode_"+Le.data.Ge.toString(),!1,!0,null);let gg=
String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Le.data.Ge,zb);Yc(this.hwd(gg,Le))}else{void 0!==O&&null!==O&&void 0!==Le.data.Ri&&null!==Le.data.Ri&&O(Le.data.Ri);var Ve=d(Le.data.Rd);if(Ve)k.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",zb),Fc(Ve);else{ja.Health.instance.recordKpiFailure(Vb,
"Parse Failure",!1,!0,null);let gg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",zb);Yc(this.hwd(gg,Le))}}}catch(gg){ja.Health.instance.recordKpiFailure(Vb,"Unexpected Failure",!1,!0,null),Ve=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",gg,zb),Yc(this.hwd(Ve,Le))}},Le=>{k.ULS.sendTraceTag(50622691,3004,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",
zb);let Ve;Le.data?(ja.Health.instance.recordKpiFailure(Vb,"HttpStatusCode_"+Le.data.Ge.toString(),!1,!0,null),Ve=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",Le.data.Ge,Le.data.Rd||"No Data",zb)):(ja.Health.instance.recordKpiFailure(Vb,"Invalid RequestFailedEventArgs",!1,!0,null),Ve=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
zb));Yc(this.hwd(Ve,Le))},null,void 0,void 0,yd,je)})}hwd(a,d){const n=new va;n.message=a;n.httpStatusCode=d&&d.data?d.data.Ge:-1;return n}JBl(a,d){const n={};n["x-UserDataSignature"]=this.va.Ga("UserDataSignature");n["x-LicensingIsEnabled"]=this.va.ea("LicensingIsEnabled").toString();n["x-CacheIsEnabled"]=this.va.ea("LicensingRedisIsEnabled").toString();n["x-OcpsIsEnabled"]=this.va.ea("OcpsIsEnabled").toString();n["x-LicensingAADIdIsEnabled"]=this.va.ea("LicensingAadIdIsEnabled").toString();0===
a&&(n["x-LicenseCheckOnTenantEnabled"]=this.va.ea("LicensingForSafeLinksIsEnabled").toString(),n["x-SupportUserConsentDependentFeatures"]=this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1).toString(),n["x-AFHUserConsentGroupValue"]=this.va.getIntFeatureGate("Microsoft.Office.SharedOnline.AFHUserConsentGroupValue",0).toString(),n["x-UseShellServiceForUserConsentGroup"]=this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseShellServiceForUserConsentGroup",
!1).toString(),n["x-UseSALForLicensing"]=this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseSALForLicensingAFHS",!1).toString(),n["x-SMBUserLicensingEnabled"]=this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SMBUserLicensingEnabled",!1).toString());if(d)for(let z of d.keys)n[z]=d.J(z);return n}}Object(t.a)(Ha,"HttpRequestToPromiseUtility",null,[]);var X;(function(a){a[a.loki=0]="loki";a[a.augloopACLP=1]="augloopACLP"})(X||(X={}));Object(t.b)("AlternateAuthSupportApp",X);class W{constructor(){this.Token=
null;this.ExpirationTime=0}}Object(t.a)(W,"WacAlternateAuthToken",null,[]);class fa{constructor(a,d){this.VEn=3E5;if(void 0===a||null===a||void 0===d||null===d)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.va=a;this.a3d=new ia.a(ma.a.Xi());this.l3c=new Ha(a,d);void 0!==B.a.$xg&&null!==B.a.$xg&&void 0!==B.a.HKe&&null!==B.a.HKe&&0<B.a.HKe&&(a=new W,a.Token=B.a.$xg,a.ExpirationTime=B.a.HKe,this.a3d.$("loki",a))}Wrl(){let a=null;this.a3d.Na(X[0])&&(a=this.a3d.J(X[0]));return void 0===
a||null===a||this.Ngm(a)?this.ajl():Promise.resolve(a.Token)}Ngm(a){return a.ExpirationTime-Date.now()<this.VEn}ajl(){const a=new ia.a(ma.a.Xi());a.$("X-AlternateAuthApp",X[0]);return this.l3c.vRf(this.AFb("/afhs/AlternateAuthHelperHandler.ashx"),Object(m.a)(this,this.JOm,"parseAlternateAuthTokenResponse"),2,a).then(d=>{k.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",X[0]);this.a3d.$(X[0],d);return d.Token},d=>{d=Object(qa.a)(va,
d);k.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",d.message,d.httpStatusCode);return null})}JOm(a){let d=null;({at:d}=x.d(a));k.ULS.sendTraceTag(545821457,3004,d?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",a);return d}AFb(a){return String.format("{0}{1}?{2}",this.va.Ga("WebServiceBase"),a,l.AFrameworkApplication.Fk)}}Object(t.a)(fa,"AlternateAuthHelper",null,[732]);var ra=b(441);class Aa{constructor(a,
d,n){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=a;this.isEnabled=d;this.tierName=n}}Object(t.a)(Aa,"FeatureStateChangeArgs",null,[]);var Ba=b(196),ta=b(73),xa=b(130),za;(function(a){a[a.Enabled=0]="Enabled";a[a.Disabled=1]="Disabled"})(za||(za={}));Object(t.b)("FeatureState",za);var la=b(23),Sa=b(13),Pa=b(295);class fb{constructor(a,d,n=null,z=null,O=null){this.LEb=this.H$=this.FLh=this.yzb=this.efe=null;this.l3c=new Ha(a,d);this.va=a;this.Tek=a.jb("LicensingMaxRetryAttempts",
0);this.Njf=a.ea("IsO365ConsumerHost");this.Mjf=a.ea("IsO365CommercialHost");this.p9d=a.ea("PremiumUpsellIsEnabled");this.brh=n;this.JRh=z;this.ga=O;this.xzb=a.ea("LicensingIsEnabled");this.UXb=a.ea("OcpsIsEnabled")&&this.Mjf;this.Lyf=a.ea("ShowPrivacyDialog")&&!!z;this.kVb=a.ea("IsAnonymousUser");this.Y0f=new Promise(ca=>{ca(!1)});this.dPb=new Promise(ca=>{ca(!0)});this.KEb=new ia.a(ma.a.Xi());this.Xge=this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",
!1);this.hEh=this.yEl();this.rqg()&&!this.kVb?(void 0!==l.AFrameworkApplication.la&&null!==l.AFrameworkApplication.la&&(this.efe=l.AFrameworkApplication.la.Np,void 0!==this.efe&&null!==this.efe&&(this.yzb=this.efe.L6a("WebServiceCall","ApplicationFeatureHelperService"))),this.LEb=this.Dbh()):this.LEb=new Promise(ca=>{ca({})});this.LEb.catch(ca=>{k.ULS.sendTraceTag(42513088,3004,10,JSON.stringify(ca))});this.Xge&&(this.p9d=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(ca=>{this.p9d=this.va.ea("PremiumUpsellIsEnabled")&&
ca;return null}))}yEl(){const a=this.va.iz("AllLicensedFeatures")?this.va.kx("AllLicensedFeatures"):[],d=new ra.a;for(let n=0;n<a.length;n++)d.add(a[n]);return d}rqg(){return this.Mjf||this.Njf}Dbh(a=0,d=!1){k.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",d);const n=this.Vbi();n&&(n.set("retryAttempt",a.toString()),n.set("forceRefresh",d.toString()),n.set("isO365ConsumerHost",this.Njf.toString()),n.set("isO365CommercialHost",this.Mjf.toString()),
n.set("isFreemiumUpsellEnabled",this.p9d.toString()));ja.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",n);ja.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",n);void 0!==this.yzb&&null!==this.yzb&&this.yzb.start();let z=null;d&&(z=new ia.a(ma.a.Xi()),z.$("x-LicensingForceRefresh","true"));this.FLh=new Date;return(this.xzb?this.l3c.vRf(this.AFb("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(m.a)(this,this.OOm,"parseApplicationFeatureHelperResponse"),
0,z,Object(m.a)(this,this.qUm,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(O=>{const ca=Object.assign(new Pa.a,{durationMs:this.LFj()});ca.extendedProperties=n;ca.extendedProperties&&O&&(ca.extendedProperties.set("featureCount",ta.a.count(O).toString()),ca.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in O).toString()),ca.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in O).toString()),this.H$&&ca.extendedProperties.set("fromCache",
(this.H$<this.FLh).toString()));ja.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",ca);return O},O=>{const ca=Object.assign(new Pa.a,{durationMs:this.LFj()}),Da=Object(qa.a)(va,O);if(!Da)return k.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),ja.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,ca),new Promise((Xa,zb)=>{zb(O)});ca.extendedProperties=
n;ca.extendedProperties&&ca.extendedProperties.set("status",Da.httpStatusCode.toString());ja.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,ca);return 408===Da.httpStatusCode&&++a<=this.Tek?this.Dbh(a):new Promise((Xa,zb)=>{zb(Da)})})}OOm(a){(a=x.b(a))?(k.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),k.ULS.sendTraceTag(50938594,3004,50,"{0}",a)):k.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return a.Features}AFb(a){var d=String.format("{0}{1}",this.va.Ga("WebServiceBase"),a);this.va.iz("ApplicationFeatureHelperHttpCachingEnabled")&&this.va.ea("ApplicationFeatureHelperHttpCachingEnabled")&&(a=fb.mye(this.va))&&0<a.length&&(this.Xge&&(a+="ucbf"),d=new Ba.QueryStringBuilder(d),d.Xd("afhskey",a),d=d.toString());return d}isFeatureEnabled(a,d){if(!this.UXb&&!this.Lyf&&!this.xzb)return this.dPb;k.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
a);if("ConnectedServices"===a){var n=this.UXb?this.brh.Ara("ControllerConnectedServicesEnabled"):this.dPb;const ca=this.Lyf?this.JRh.getSettings().then(Da=>2!==Da.KA,()=>d):this.dPb;return n.then(Da=>Da?ca:this.Y0f)}n=null;n=this.UXb?this.brh.isFeatureEnabled(a):this.dPb;let z=null;z=this.xzb?this.gam(a,d):this.dPb;let O=null;O=this.Lyf?this.JRh.isFeatureEnabled(a):this.dPb;return n.then(ca=>ca?O.then(Da=>Da?z:this.Y0f):this.Y0f).then(ca=>{this.o0i(a,ca,!0);return ca},()=>{this.o0i(a,d,!1);return d})}o0i(a,
d,n){k.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",a,d,n)}getFeatureTier(a,d){if(!this.xzb)return new Promise(n=>{n(2)});k.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",a);return this.LEb.then(n=>this.hAe(a,n,d),()=>d)}isFreemiumUpsellEnabled(){return this.p9d&&this.Njf&&!this.kVb}launchUpsellExperience(a,d=null){k.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",
a));var n=this.Vbi();n&&(n.set("experienceId",a),d&&n.set("campaignId",d));ja.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",n);if(n=la.a.instance.sa("Common.IInProductMessagingUIManager")){const z=Object(m.a)(this,this.CVl,"handleDimeTaskComplete");n.XWi(a,z,d)}else k.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),ja.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.ga.ob(Sa.a.tsd,
2,{["experience"]:a})}oXa(a,d){if(!this.xzb)return null;if(!a||!d)return k.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const n=xa.a.create().toString();this.KEb.Na(a)||this.KEb.$(a,new ia.a(ma.a.Xi()));this.KEb.J(a).add(n,d);k.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",n,a));return n}vQc(a,d){this.xzb&&(a&&this.KEb.Na(a)?
d&&xa.a.Yb(d)?this.KEb.J(a).Na(d)?(k.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",d,a)),this.KEb.J(a).remove(d)):k.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",d,a)):k.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",
d,a)):k.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",a)))}hAe(a,d,n){return this.Xge?a in d?d[a].LicenseTier:n:a in d?this.uPm(d[a],n):n}uPm(a,d){switch(a.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return d}}CVl(){k.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.LEb.then(a=>{this.elj(a)}).catch(()=>
{this.elj({})})}elj(a){k.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const d=this.Dbh(0,!0);d.then(n=>{this.LEb=d;ta.a.count(n)>ta.a.count(a)?ja.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):ja.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let z of this.KEb.keys)if(z in n){const O=this.hAe(z,n,0);z in a?this.hAe(z,a,0)!==O&&this.OEg(z,!0,O):this.OEg(z,!0,O)}else z in
a&&this.OEg(z,!1,this.hAe(z,a,0))}).catch(n=>{ja.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);k.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(n))})}OEg(a,d,n){k.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",a,d,n);d=new Aa(a,d,n);n=this.KEb.J(a);for(let z of n)try{z.value(d)}catch(O){k.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",
a,z.key,O.message))}}eam(a,d){if(this.xzb){const n=this.hEh.contains(a);let z=!0,O="",ca=!1;return this.LEb.then(Da=>{a in Da?(Da=Da[a],O=za[Da.FeatureState],z=1!==Da.FeatureState):z=!n;this.B0i(a,n,O,ca,d,z);return z},()=>{ca=!0;n&&(z=d);this.B0i(a,n,O,ca,d,z);return z})}return this.dPb}B0i(a,d,n,z,O,ca){k.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",a,d,z,n,O,ca)}gam(a,d){if(this.Xge)return this.eam(a,
d);if(this.xzb){if(this.hEh.contains(a))return this.LEb.then(n=>a in n,()=>d);k.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",a)}return this.dPb}qUm(a){try{a&&"Date"in a&&(this.H$=new Date(a.Date),k.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.H$.toString()))}catch(d){k.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",
d)}}Vbi(){try{return new Map}catch(a){return null}}LFj(){if(void 0!==this.yzb&&null!==this.yzb){const a=this.yzb.ti;this.yzb.stop();return a}return null}static mye(a){try{if(I.a.uXd){const d=a.Ga("UserDataSignature").split(".");if(1<d.length){const n=window.self.atob(d[1]),z=JSON.parse(n).LocalStorageKey;if(void 0!==z&&null!==z&&0<z.length)return z}}}catch(d){k.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",d.toString())}return null}}Object(t.a)(fb,"ApplicationFeatureHelper",
null,[733]);var db=b(75);class Qa{constructor(a,d){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=a.PolicySettings;a=new Date;a.setMinutes(a.getMinutes()+d);this.ExpirationTime=a.getTime()}}Object(t.a)(Qa,"CloudPolicySettingsCacheData",null,[]);var wb=b(1190),ib=b(353),Ta=b(221);class jb{static wDj(){return l.AFrameworkApplication.K.ea("SideCarIsEnabled")?jb.wWe&&jb.IJc?new Promise(a=>{a(!0)}):new Promise((a,d)=>{jb.wWe=Ta.a.create(l.AFrameworkApplication.K.Ga("SideCarUrl"));ib.a.BP(jb.wWe);
jb.wWe.QJ((n,z)=>{(jb.IJc=z.succeeded)?a(z.succeeded):d(z.succeeded)})}):new Promise(a=>{a(!1)})}}jb.IJc=!1;jb.wWe=null;Object(t.a)(jb,"SideCarLoader",null,[]);class $a{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(t.a)($a,"CloudPolicySettingsData",null,[]);class ya{constructor(a,d){this.aaf=0;this.mne=null;this.l3c=new Ha(a,d);this.va=a;d=a.Ga("HostAuthType");this.UXb=a.ea("OcpsIsEnabled")&&a.ea("IsO365CommercialHost")&&!(void 0===d||null===d)&&"aad"===
d.toLowerCase();this.dHh=x.b(a.Ga("OcpsDefaultSettings")||"{}");this.V6c=this.mye();d=this.va.iz("ServicesControlsMicrosoftControllerServicesList")?this.va.kx("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.E4d=new ra.a;for(let n=0;n<d.length;n++)this.E4d.add(d[n]);this.UXb&&!a.ea("IsAnonymousUser")&&a.ea("SideCarIsEnabled")?this.mne=this.LHn():this.mne=this.Cbh(this.UXb,this.AFb("/afhs/CloudPolicySettings.ashx"),Object(m.a)(this,this.SOm,"parseCloudPolicySettingsResponse"));this.mne.then(()=>
null).catch(n=>{k.ULS.sendTraceTag(50622685,3004,10,JSON.stringify(n))})}Ara(a,d=!0){if(!this.UXb){const ca=this;return new Promise(Da=>{Da(ca.Cvd(a))})}let n=this,z=this;const O=this.mne.then(ca=>{try{let Da=null;ca.PolicySettings&&"unknown"in ca.PolicySettings&&(Da=ca.PolicySettings.unknown);if(Da){if(a in Da&&void 0!==Da[a]&&null!==Da[a])return new Promise(zb=>{zb("0"!==Da[a])});const Xa=a.toLowerCase();if(Xa in Da&&void 0!==Da[Xa]&&null!==Da[Xa])return new Promise(zb=>{zb("0"!==Da[Xa])});k.ULS.sendTraceTag(51512667,
3004,50,"Policy"+a+" not found, using default");return new Promise(zb=>{zb(n.Cvd(a))})}return new Promise(Xa=>{Xa(n.Cvd(a))})}catch(Da){return k.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+a+" policy value. Error Message: {0}",Da.message),n.handleError(Da.toString(),d,n.Cvd(a))}},ca=>z.handleError(ca,d,z.Cvd(a)));O.then(ca=>{k.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",a,ca);return null});return O}isFeatureEnabled(a,d=!0){if(this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1))return this.iam(a,d);let n=new Promise(O=>{O(!0)}),z="";this.E4d.contains(a)&&(z="ControllerConnectedServicesEnabled",n=this.Ara(z,d));n.then(O=>{k.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",a,O,z);return null});return n}iam(a,d=!0){let n=new Promise(O=>{O(!0)}),z="";"mso_sendASmile"===a?z="Enabled":"Survey"===a||"FloodgateSurvey"===a?z="SurveyEnabled":this.E4d.contains(a)&&(z="ControllerConnectedServicesEnabled");
""!==z&&(n=this.Ara(z,d));n.then(O=>{k.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",a,O,z);return null});return n}handleError(a,d,n){return d?new Promise(z=>{z(n)}):new Promise((z,O)=>{O(a)})}Cbh(a,d,n){if(!a)return Promise.resolve(new $a);let z=!1,O=null;ja.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let ca=this.BQf("GetCloudPolicySettings");return(new Promise((Da,Xa)=>{if(void 0!==
this.V6c&&null!==this.V6c&&0<this.V6c.length){const zb=this.pHn();if(void 0!==zb&&null!==zb){z=!0;Da(zb);return}}this.l3c.vRf(d,n,1,null,Object(m.a)(this,this.DUm,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.va.jb("CloudPolicySettingsRequestQueueTimeout",15E3),this.va.jb("CloudPolicySettingsRequestSentTimeout",3E4)).then(zb=>{k.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.lIn(zb);Da(zb);return zb},zb=>{Xa(zb);return null})})).then(Da=>
{({dF:ca,returnValue:O}=this.T_e(ca));var Xa=this.SG();Xa&&Xa.set("FromCache",z.toString());Xa=Object.assign(new Pa.a,{durationMs:O,extendedProperties:Xa});ja.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Xa);return Da})}LHn(){return jb.wDj().then(()=>{k.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}AFb(a){return String.format("{0}{1}",this.va.Ga("WebServiceBase"),
a)}SOm(a){let d=null;({at:d}=x.d(a));k.ULS.sendTraceTag(50622687,3004,d?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",a);return d}DUm(a){try{if(void 0!==a&&null!==a&&"CheckIn-Interval"in a){const d=parseInt(a["CheckIn-Interval"]);void 0!==d&&null!==d&&0<d&&(this.aaf=d)}}catch(d){k.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",d)}}Cvd(a){return a in this.dHh?"0"!==this.dHh[a]:!0}pHn(){try{const a=wb.a.instance.getItem(this.V6c);
if(void 0===a||null===a)return k.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;k.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",a);const d=JSON.parse(a);if(void 0===d||null===d)return k.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===d.ExpirationTime||null===d.ExpirationTime)return k.ULS.sendTraceTag(51662939,
3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(d.ExpirationTime)).getTime()<Date.now())return k.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const n=new $a;n.PolicySettings=d.PolicySettings;n.ControllerConnectedServicesFeatureNames=new db.a;this.va.iz("ServicesControlsMicrosoftControllerServicesList")&&this.va.kx("ServicesControlsMicrosoftControllerServicesList");for(let z of this.E4d)n.ControllerConnectedServicesFeatureNames.add(z);
k.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return n}catch(a){return k.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",a.toString()),null}}lIn(a){try{if(void 0===a||null===a||void 0===a.PolicySettings||null===a.PolicySettings)k.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.aaf)k.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");
else{const d=new Qa(a,this.aaf),n=JSON.stringify(d);k.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",n);wb.a.instance.setItem(this.V6c,n);k.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(d){k.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",d.toString())}}mye(){const a=fb.mye(this.va);return a&&0<a.length?"OCPS"+a:null}SG(){try{return new Map}catch(a){return null}}BQf(a){const d=
la.a.instance.sa("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==d&&null!==d?d.Pe("WebServiceCall",a):null}T_e(a){if(void 0!==a&&null!==a){const d=a.ti;a.stop();return{returnValue:d,dF:null}}return{returnValue:null,dF:a}}}Object(t.a)(ya,"CloudPolicySettingsHelper",null,[730]);class wa{constructor(){this.Fii=this.fRj=this.KA=0;this.Gii=this.gRj=this.h3a="";this.svf=this.Aua=2}clone(){const a=new wa;a.KA=this.KA;a.fRj=this.fRj;a.Fii=this.Fii;a.h3a=this.h3a;a.gRj=this.gRj;a.Gii=
this.Gii;a.Aua=this.Aua;a.svf=this.src;return a}get src(){return this.svf}serialize(a=null){const d={};if(!a||a.contains(wa.agc))d[wa.agc]=this.KA;if(!a||a.contains(wa.tJd))d[wa.tJd]=this.h3a;if(!a||a.contains(wa.uJd))d[wa.uJd]=this.Aua;return JSON.stringify(d)}static create(a,d=null){const n=new wa;n.svf=a;void 0!==d&&null!==d&&(wa.agc in d&&(n.KA=d[wa.agc]),wa.tJd in d&&(n.h3a=d[wa.tJd]),wa.uJd in d&&(n.Aua=d[wa.uJd]));return n}static deserialize(a,d){try{const n=JSON.parse(a);if(void 0!==n&&null!==
n)return wa.create(d,n);k.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",a);throw Error.argument("settingsData");}catch(n){throw k.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",n.toString()),n;}}}wa.agc="CCS";wa.tJd="CCSTime";wa.uJd="OfficePrivacyRoamedNoticeShown";Object(t.a)(wa,"UserPrivacySettings",null,[]);var Fa=b(163);class bb{constructor(a,d){if(void 0===a||null===a||void 0===d||null===d)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.va=a;this.nf=d;this.kuf=this.xd=null}AFb(a){var d=String.format("{0}RoamingServiceHandler.ashx?action=",this.va.appSettings.RoamingServiceHandlerWebServiceBase||"");d=new Sys.StringBuilder(d);d.append(a);d.append("&");d.append(l.AFrameworkApplication.Fk);return d.toString()}executeRequest(a,d,n,z=null){return this.nf.z2b(a,d,z,null,!1,2,null,n,"33",!1,null,6E4)}saveSettings(a){return new Promise((d,n)=>{try{if(void 0===this.xd||null===this.xd||void 0===a||null===a)k.ULS.sendTraceTag(51258443,
3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),n("Can't determine setting changes to save");else{var z=this.xd.KA!==a.KA;if(2===this.xd.src&&z)this.Cen(a),d(!0);else{var O=this.gin(a);if(void 0===O||null===O||!O.length)k.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),n("No changes to save");else if(1===this.xd.src)d(this.bMj(O));else if(0===this.xd.src){k.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",
O);const ca=this.executeRequest(this.AFb("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",O);ca.continueWith(()=>{if(ca.Jm||ca.Vh)k.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),d(!1);else{var Da=ca.result;void 0!==Da.args&&null!==Da.args&&void 0!==Da.args.data&&null!==Da.args.data&&Da.args.data.Ge===Ma.a.HD?(k.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),d(!0)):(k.ULS.sendTraceTag(51258446,3004,
10,"SaveUserPrivacySettings: Roaming Request Failed"),d(!1))}})}}}}catch(ca){k.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",ca.toString()),d(!1)}})}gin(a){if(void 0===this.xd||null===this.xd||void 0===a||null===a)throw Error.invalidOperation("User Privacy settings have not been initialized");const d=new db.a;0===a.src?(this.xd.KA!==a.KA&&(d.add(wa.agc),d.add(wa.tJd)),this.xd.Aua!==a.Aua&&d.add(wa.uJd)):1===a.src&&this.xd.KA!==a.KA&&d.add(wa.agc);return d.count?a.serialize(d):
(k.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.kuf){const a=this;this.kuf=new Promise(d=>{try{a.xd?d(a.xd.clone()):a.GHn().then(n=>{a.xd=n;d(a.xd.clone());return null},()=>{a.EHn().then(n=>{a.xd=n;d(a.xd.clone());return null},()=>{a.FHn().then(n=>{a.xd=n;d(a.xd.clone());return null},()=>{k.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");a.xd=new wa;d(a.xd.clone());
return null});return null});return null})}catch(n){k.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",n.toString()),a.xd=new wa,d(a.xd.clone())}})}return this.kuf}GHn(){return new Promise((a,d)=>{try{const z=-1!==window.location.href.indexOf("&wd_pn=2");if(this.va.ea("PrivacyDialogShouldCheckRoaming")||z){var n=this.executeRequest(this.AFb("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");n.continueWith(()=>{try{if(n.Jm||n.Vh)k.ULS.sendTraceTag(50860934,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const O=n.result;if(O&&O.args&&O.args.data)if(O.args.data.Ge!==Ma.a.HD)k.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",O.args.data.Ge);else{if(O.args.data.Rd){a(bb.parse(O.args.data.Rd,0));k.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",O.args.data.Rd);return}k.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else k.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");d("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(O){k.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",O.toString()),d("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else k.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),d("Roaming should not be used")}catch(z){k.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",z.toString()),d("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}EHn(){return new Promise((a,d)=>{try{const n=Fa.a.get("WacUPToggleState");let z=null;void 0!==n&&null!==n&&0<n.length&&(z=decodeURIComponent(n));if(void 0!==z&&null!==z&&0<z.length){const O=bb.parse(z,1);k.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",O.toString());a(O)}else{const O=wa.create(1),ca=new db.a;
ca.add(wa.agc);const Da=O.serialize(ca);this.bMj(Da)?(k.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Da),a(O)):(k.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Da),d("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(n){k.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",n.toString()),
d("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}FHn(){return new Promise(a=>{try{var d=-1!==window.location.href.indexOf("&wdccsoff=1");let n=wa.create(2);d?(n.KA=2,l.AFrameworkApplication.WWf(),k.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",n.toString())):(n.KA=1,k.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",n.toString()));a(n)}catch(n){k.ULS.sendTraceTag(50967431,
3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",n.toString()),d=wa.create(2),d.KA=1,a(d)}})}Cen(a){k.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===a.KA?l.AFrameworkApplication.WWf():l.AFrameworkApplication.Zji();k.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",a)}bMj(a){try{k.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",a);const d=this.va.Ga("PrivacyCookieDomain")||
"";if(!d||!d.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");k.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",a);return Fa.a.xYe("WacUPToggleState",a,Fa.a.FBa,"/",d)}catch(d){return k.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",d.toString()),!1}}isFeatureEnabled(a){return this.getSettings().then(d=>{const n=this.va.iz("ServicesControlsMicrosoftControllerServicesList")?this.va.kx("ServicesControlsMicrosoftControllerServicesList"):
[],z=new ra.a;for(let O=0;O<n.length;O++)z.add(n[O]);return z.contains(a)?2!==d.KA:!0},()=>{k.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",a);return!0})}static parse(a,d){try{return k.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",a,d),wa.deserialize(a,d)}catch(n){throw k.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",n.toString()),n;}}}Object(t.a)(bb,"UserPrivacySettingsHelper",null,[731]);class Eb{constructor(){this.Z=
null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}Hb(a){this.Z=a;this.Z.register(730,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").singleInstance().zd(()=>new ya(l.AFrameworkApplication.K,l.AFrameworkApplication.Gd));this.Z.register(731,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").singleInstance().zd(()=>new bb(l.AFrameworkApplication.K,l.AFrameworkApplication.Gd));this.Z.register(732,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").singleInstance().zd(()=>
new fa(l.AFrameworkApplication.K,l.AFrameworkApplication.Gd));this.Z.register(733,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").singleInstance().zd(()=>new fb(l.AFrameworkApplication.K,l.AFrameworkApplication.Gd,this.Z.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Z.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),l.AFrameworkApplication.pa))}init(){l.AFrameworkApplication.K.wq(()=>{const a=this.Z.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");
l.AFrameworkApplication.K.ea("LicensingIsEnabled")&&(a.isFeatureEnabled("LicensingTestFeature",!1).then(d=>{k.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",d,l.AFrameworkApplication.K.Ga("IsAnonymousUser"));return null}),a.getFeatureTier("LicensingTestFeature",0).then(d=>{k.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",
d,l.AFrameworkApplication.K.Ga("IsAnonymousUser"));return null}));this.Z.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.TCn()})}dispose(){}TCn(){try{l.AFrameworkApplication.K.ea("SideCarIsEnabled")&&jb.wDj().then(a=>{k.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",a);return a})}catch(a){}}static main(){M.a.instance.Sb(new Eb)}}Object(t.a)(Eb,"ApplicationFeatureHelperPackage",null,[1,2]);var hb=b(173);class nb{oye(a,
d){let n;const z=[];for(;n=d.exec(a);){const O=n.index;z.push(new hb.a(O,O+n[0].length))}return z}isEndPuncSpecialCase(a){const d=this.oye(a,nb.Pxn);for(const n of d)if(n.end===a.length)return!0;return!1}Tqd(a){for(const d of nb.Jhl){const n=this.oye(a,d);if(0<n.length&&!n[0].begin)return n[0].end-1}return 0}findBeginBoundary(a,d,n){var z=a.substring(n,d);a=this.oye(z,nb.tki);for(d=a.length-1;0<=d;d--){const O=z.substring(0,a[d].end);if(!this.isEndPuncSpecialCase(O))return z=z.substring(a[d].begin,
z.length),n+a[d].end+this.Tqd(z)}return n}findEndBoundary(a,d,n){var z=a.substring(d,n);a=this.oye(z,nb.tki);for(n=0;n<a.length;n++){const O=z.substring(0,a[n].end);if(!this.isEndPuncSpecialCase(O))return z=z.substring(a[n].begin,z.length),d+a[n].end+this.Tqd(z)}return-1}}nb.s0f="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";
nb.t0f="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";nb.u0f="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";nb.Jhl=
[new RegExp(nb.s0f,"ig"),new RegExp(nb.t0f,"ig"),new RegExp(nb.u0f,"ig")];nb.W6g="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";nb.Z6g="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";nb.Y6g="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
nb.X6g=nb.Z6g+"|"+nb.Y6g;nb.$6g="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";nb.a7g="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";nb.b7g="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
nb.c7g="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";nb.p_g="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
nb.X6g+"|"+nb.$6g+"|"+nb.a7g+")";nb.o_g="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
nb.b7g+")";nb.tEg=nb.W6g+"|"+nb.c7g;nb.V6g=nb.tEg+"|"+nb.p_g+"|"+nb.o_g;nb.tki=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");nb.Pxn=new RegExp(nb.V6g,"g");Object(t.a)(nb,"ProofingSentenceSeparatorScriptSharp",null,[727]);class Pb{$1d(a,d){const n=[];let z;for(;null!=(z=d.exec(a));){const O=z.index;n.push({begin:O,end:O+z[0].length})}return n}isEndPuncSpecialCase(a){return this.$1d(a,Pb.S_j).some(d=>
d.end==a.length)}Tqd(a){for(const d of Pb.JXj){const n=this.$1d(a,d);if(0<n.length&&0==n[0].begin)return n[0].end-1}return 0}findBeginBoundary(a,d,n){var z=a.substring(n,d);a=this.$1d(z,Pb.Tih);for(d=a.length-1;0<=d;d--){const O=z.substring(0,a[d].end);if(!this.isEndPuncSpecialCase(O))return z=z.substring(a[d].begin,z.length),n+a[d].end+this.Tqd(z)}return n}findEndBoundary(a,d,n){var z=a.substring(d,n);a=this.$1d(z,Pb.Tih);for(n=0;n<a.length;n++){const O=z.substring(0,a[n].end);if(!this.isEndPuncSpecialCase(O))return z=
z.substring(a[n].begin,z.length),d+a[n].end+this.Tqd(z)}return-1}}Pb.$Wj="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";Pb.N_j="[\u2639\u263a\u263b]";Pb.clh="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";Pb.zXj="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
Pb.LZj="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";Pb.Hlh="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
Pb.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
Pb.blh="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";Pb.SYj="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";Pb.RYj="[\uff21-\uff3a\uff41-\uff5a]";Pb.PYj="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
Pb.OYj="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";Pb.QYj="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";Pb.k6e="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";Pb.Sih="[\u3002\uff61]";Pb.r2d="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";Pb.SXj="[\u00bb\u2019\u201d\u203a\"']";Pb.J6e=Pb.$Wj+"|"+Pb.N_j;Pb.TYj="[\u2028\u2029\n\r]";Pb.NYj="("+Pb.r2d+"|"+Pb.clh+"|"+Pb.Hlh+"|"+Pb.blh+
")";Pb.MYj="("+Pb.r2d+"|"+Pb.clh+"|"+Pb.Hlh+"|"+Pb.Symbol+"|"+Pb.blh+"|"+Pb.zXj+"|"+Pb.LZj+")";Pb.s0f="("+Pb.k6e+"("+Pb.J6e+"|"+Pb.SXj+"|"+Pb.r2d+")*"+Pb.TYj+")";Pb.t0f="("+Pb.k6e+"("+Pb.J6e+")*("+Pb.r2d+")+)";Pb.u0f="("+Pb.Sih+"("+Pb.J6e+")*)";Pb.JXj=[new RegExp(Pb.s0f,"ig"),new RegExp(Pb.t0f,"ig"),new RegExp(Pb.u0f,"ig")];Pb.W6g="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Pb.Z6g="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
Pb.Y6g="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";Pb.X6g=Pb.Z6g+"|"+Pb.Y6g;Pb.$6g="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Pb.a7g="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
Pb.b7g="(("+Pb.SYj+"|"+Pb.PYj+"|"+Pb.QYj+")[.])+|(("+Pb.OYj+")[.\ufe52\uff0e])+";Pb.c7g="("+Pb.RYj+")[.\ufe52\uff0e]";Pb.p_g=Pb.NYj+"("+Pb.X6g+"|"+Pb.$6g+"|"+Pb.a7g+")";Pb.o_g=Pb.MYj+"("+Pb.b7g+")";Pb.tEg=Pb.W6g+"|"+Pb.c7g;Pb.V6g=Pb.tEg+"|"+Pb.p_g+"|"+Pb.o_g;Pb.Tih=new RegExp(Pb.k6e+"|"+Pb.Sih,"ig");Pb.S_j=new RegExp(Pb.V6g,"g");Object(t.a)(Pb,"ProofingSentenceSeparator",null,[727]);class bc{constructor(){this.Z=null}get name(){return"Box4.ProofingGrammarCheck"}Hb(a){this.Z=a;l.AFrameworkApplication.K.ea("ProofingSentenceSeparatorTypeScriptIsEnabled")?
a.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new Pb).singleInstance():a.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new nb).singleInstance()}init(){this.Z.resolve("Box4.Proofing.IProofingSentenceSeparator")}dispose(){}static main(){M.a.instance.Sb(new bc)}}Object(t.a)(bc,"Box4GrammarCheckPackage",null,[1,2]);var gb=b(92),Lb=b(12),Ic=b(77),vb=b(7),xb=b(69);class Db{constructor(a,d,n,z){this.Ksf=this.Q9d=this.kif=this.Cc=null;this.RCh=this.fVb=this.WNa=this.rFa=this.W9e=!1;this.zpa=0;this.ld=
a;this.sj=d;this.bYc=n;this.ic=z;this.reset()}hid(a,d){this.rFa||(this.rFa=!0,a.IIa?this.oCb(d):a.mqa(()=>{this.rFa||this.oCb(d)}))}dispose(){this.fVb&&(Lb.App.oa.POb.kb(vb.a.input,this.ic.editingView.editingElement,Object(m.a)(this,this.DDa,"textInputHandler")),this.fVb=!1);this.W9e&&(this.Cc.kb(vb.a.Hhb,this.ic.editingView.editingElement,Object(m.a)(this,this.y0h,"beforeKeyUpHandler")),this.W9e=!1);this.RCh&&(this.Cc.kb(vb.a.UJ,this.ic.editingView.editingElement,Object(m.a)(this,this.nCb,"beforeKeyDownHandler")),
this.Cc.kb(vb.a.Of,this.ic.editingView.editingElement,Object(m.a)(this,this.qJa,"keyUpHandler")));Lb.App.oa.c5(Object(m.a)(this,this.Wgc,"onWindowResize"));this.MFj()}Wgc(){this.reset()}Klj(a){this.kif=a}Ylj(a){this.Ksf=a}Llj(a){this.Q9d=a}KGk(){this.WNa=!0;l.AFrameworkApplication.Yi("ContextIQAtMentionEntryPoint-Treatment;ContextIQAtMentionEntryPoint-Control")}MFj(){this.WNa=!1}oCb(a){this.Cc=a;this.ic.sc?this.ic.sc.gj&&(Lb.App.J3b&&I.a.rXd||I.a.xm?(Lb.App.oa.POb.Ea(vb.a.input,this.ic.editingView.editingElement,
Object(m.a)(this,this.DDa,"textInputHandler"),null),this.fVb=!0):this.Cc&&I.a.Ah&&(this.Cc.Ea(vb.a.Hhb,this.ic.editingView.editingElement,Object(m.a)(this,this.y0h,"beforeKeyUpHandler")),this.W9e=!0),this.Cc&&(this.Cc.Ea(vb.a.UJ,this.ic.editingView.editingElement,Object(m.a)(this,this.nCb,"beforeKeyDownHandler")),this.Cc.Ea(vb.a.Of,this.ic.editingView.editingElement,Object(m.a)(this,this.qJa,"keyUpHandler")),this.RCh=!0),this.bYc.aWh(Object(m.a)(this,this.IGf,"backspaceDeleteHandler")),Lb.App.oa.sU(Object(m.a)(this,
this.Wgc,"onWindowResize"))):k.ULS.sendTraceTag(593376530,324,10,"SelectionView is null. AtMentions will not work in this session")}nCb(a){this.zpa=a.Ua.keyCode;if(!this.WNa||!this.Q9d)return!1;if(a.Ua.keyCode===xb.a.G5||a.Ua.keyCode===xb.a.Ms||a.Ua.keyCode===xb.a.Nw){let d=!1;a.Ua.keyCode===xb.a.G5?(k.ULS.sendTraceTag(41178049,324,50,"@ mention People Picker dismissed via escape"),d=!0):a.Ua.keyCode===xb.a.Ms?k.ULS.sendTraceTag(41178050,324,50,"@ mention People Picker enter pressed while picker is up"):
a.Ua.keyCode===xb.a.Nw&&k.ULS.sendTraceTag(51451662,324,50,"@ mention People Picker tab pressed while picker is up");this.Q9d(a);d&&this.reset();return!0}return a.Ua.keyCode===xb.a.Fda||a.Ua.keyCode===xb.a.H5||a.Ua.keyCode===xb.a.ED||a.Ua.keyCode===xb.a.FD?(this.Q9d(a),!0):!1}DDa(a){const d=this.Ovd(),n=this.Ntd(a.Ua.target),z=a.Ua.rawEvent.inputType;return(void 0!==z&&null!==z||this.zpa!==xb.a.rC&&this.zpa!==xb.a.iZ)&&"deleteContentBackward"!==z&&"deleteContentForward"!==z?this.JIi(d,n,a.Ua.target):
!1}JIi(a,d,n){if(1>d)return!1;a=a.replace(new RegExp(Db.KE,"g"),"");const z=a.charAt(d-1);this.WNa&&z!==Db.qN?this.Afg(a,d,n):this.WNa||z!==Db.qN?this.WNa&&z===Db.qN&&k.ULS.sendTraceTag(41178052,324,50,"Tried to type @ while already in at mention mode"):this.kif&&(this.reset(),this.UTm(d,a)&&(this.KGk(),this.Afg(a,d,n),k.ULS.sendTraceTag(41178051,324,50,"@ typed.  Beginning of paragraph?: {0}",1===d?"true":"false")));return this.WNa}y0h(a){if(1!==a.Ua.rawEvent.key.length)return!1;const d=this.Ovd(),
n=this.Ntd(a.Ua.target);return this.JIi(d,n,a.Ua.target)}qJa(a){if(!this.WNa)return!1;const d=this.Ovd(),n=this.Ntd(a.Ua.target);(a.Ua.keyCode===xb.a.rC||a.Ua.keyCode===xb.a.iZ||(a.Ua.keyCode===xb.a.lEa||a.Ua.keyCode===xb.a.Hwb)&&a.Ua.ctrlKey)&&this.Afg(d,n,a.Ua.target);return!1}reset(){this.rFa=!1;this.MFj();this.Ksf&&this.Ksf()}Ntd(a){return this.sj.lFc(2,a)}Ovd(){return this.ld.Eq().innerText}UTm(a,d){return 0>a-2||this.xPk(d.charAt(a-2))?!0:!1}xPk(a){return w.a.Fga(a)||"("===a}Afg(a,d,n){if(!a||
""===a||0>d)this.reset();else{const {buj:z,o_h:O}=this.Mim(a,d);this.kif(z,n,O)}}Mim(a,d){let n=this.ysl(a,d);if(0<=n&&d<=a.length)return{buj:a.substring(n,d),o_h:n};this.reset();return{buj:"",o_h:n}}ysl(a,d){let n=-1;for(let z=d;0<=z&&63>=d-z;z--)if(a.charAt(z)===Db.qN){n=z;break}return n}aVl(a){a=this.Ntd(a.Ua.target);a=this.Ovd().charAt(a-1);this.WNa&&a===Db.qN&&this.reset()}vVl(a){a=this.Ntd(a.Ua.target);a=this.Ovd().charAt(a);this.WNa&&a===Db.qN&&this.reset()}IGf(a,d){this.zpa=d.nmg?xb.a.rC:
d.isDelete?xb.a.iZ:this.zpa;this.WNa&&(d.nmg?this.aVl(d.jWi):d.isDelete&&this.vVl(d.jWi))}}Db.qN="@";Db.KE="\n";Object(t.a)(Db,"AtMentionsListener",null,[726]);class ab{constructor(){this.Z=null}get name(){return"Box4.AtMentions"}Hb(a){this.Z=a;this.Z.ha("Box4.AtMentions.IAtMentionsListener",()=>new Db(this.Z.resolve("Box4.IEditingDomManager"),this.Z.resolve("Box4.ICaretPositionManager"),this.Z.resolve("Box4.BackspaceDeleteEventSource"),Ic.InteractiveViewManager.instance)).singleInstance()}init(){l.AFrameworkApplication.K.ea("CanvasAtMentionDetectionIsEnabled")&&
l.AFrameworkApplication.K.wq(()=>{this.Z.resolve("Box4.AtMentions.IAtMentionsListener").hid(Lb.App.oa.za,gb.KeyInputManager.instance)})}dispose(){this.Z.resolve("Box4.AtMentions.IAtMentionsListener").dispose()}static main(){M.a.instance.Sb(new ab)}}Object(t.a)(ab,"Box4AtMentionsPackage",null,[1,2]);class dc{get name(){return"Box4.Workers"}Hb(){}init(){}dispose(){}static main(){M.a.instance.Sb(new dc)}}Object(t.a)(dc,"Box4WorkersPackage",null,[1,2]);var tb=b(302),yb=b(76);class rc{constructor(){this.g_a=
new yb.a}Xca(a,d){this.g_a.$(a,d)}Y4f(a){({value:a}=this.g_a.Ab(a));return a}}Object(t.a)(rc,"AggregationMethodsForActivityName",null,[]);var fc=b(233);class uc{constructor(){this.wce=new tb.a;this.g_a=new tb.a}Xca(a,d,n){this.g_a.Na(a)&&this.g_a.J(a)||this.g_a.$(a,new rc);this.g_a.J(a).Xca(d,n)}Y4f(a,d){return this.g_a.Na(a)&&this.g_a.J(a)?this.g_a.J(a).Y4f(d):null}awd(a){this.wce.Na(a)&&this.wce.J(a)||this.wce.$(a,new fc.a);return this.wce.J(a)}Dei(a,d){this.awd(a).add(d)}}Object(t.a)(uc,"ActivityAggregationInfo",
null,[762]);var Uc=b(244),tc=b(873),Tb=b(888);class qb extends tc.a{constructor(a,d){super(a);this.kyf=(this.S1j=d)?d.qAl():Tb.a.J4f()}get FQa(){return this.S1j}get activityName(){return this.FQa.name}get startTime(){return this.FQa.startTime}get endTime(){return this.FQa.endTime}end(){}cancel(){}m3f(){}tMn(){this.SEc.$("AM",this.FQa.mode.toString());this.SEc.$("C",this.FQa.count.toString());this.SEc.$("DA",this.FQa.Rii.toFixed(2));this.SEc.$("DV",this.FQa.jdl.toFixed(2))}abg(a){return this.FQa.abg(a)}Ebg(){return this.FQa.Ebg()}vyc(){for(let a of this.FQa.GQa)a.vyc()}}
Object(t.a)(qb,"AggregatedActivity",tc.a,[]);class Jb{constructor(a,d){this.K8e=0;this.Qda=a;this.H$a=d}WAk(a,d){this.K8e=d;for(d=0;d<a.count;d++){const n=a.J(d);this.XAk(n)}}XAk(a){const d=Object(qa.a)(qb,a);if(d)if(1===this.K8e)this.VAk(d);else if(2===this.K8e){this.YAk(d);for(let n of this.H$a.awd(this.Qda)){const z=d.FQa.GQa.J(0);z.properties.Na(n)&&a.properties.$(n,z.properties.J(n))}}}VAk(a){for(let d of this.H$a.awd(this.Qda))this.Isj(a,d)}YAk(a){for(let d of a.Ebg())this.Isj(a,d)}Isj(a,d){const n=
this.H$a.Y4f(this.Qda,d);if(n){const z=a.abg(d);a.properties.$(d,n(z))}}}Object(t.a)(Jb,"PropertyAggregationHelper",null,[]);var Zb=b(952);class ec{constructor(a,d,n,z,O){this.jqc=a;this.H$a=d;this.Drh=O;this.w8e=z;this.uek=n}get nTh(){return this.uek.value}qld(a){if(Object(Uc.a)(Zb.a,a))a.qld();else if(Object(Uc.a)(qb,a)&&this.w8e.q4h(a.activityName.toString())){a=Object(qa.a)(qb,a);a.tMn();a=a.L2i();var d=[];Array.add(d,a);a=x.c(d);k.ULS.sendTraceTag(6907266,213,50,a)}}TQa(a,d){const n=(new Date).getTime();
var z=this.Drh.list.J(a);const O=({$Ak:z}=this.hrl(z)).returnValue;this.Drh.list.$(a,new db.a);d&&(z=this.rZk(z,n,this.jqc.oHi));0<z.count&&(new Jb(a,this.H$a)).WAk(z,O)}rZk(a,d,n){const z=new db.a;for(let O=0;O<a.count;O++){const ca=a.J(O);ca.startTime>d-n?ca.vyc():z.add(ca)}return z}hrl(a){const d=this.nTh.UIj(a);a=this.nTh.aEn(a);const n=this.aBk(d,a);return{returnValue:n,$Ak:1===n?d:a}}aBk(a,d){return a.count*this.jqc.R4i<d.count?1:2}get enabled(){return this.jqc.enabled}vyc(){}}Object(t.a)(ec,
"ActivityAggregationManager",null,[760]);class zc{constructor(a){this.enabled=!1;this.w3i=500;this.B4i=2;this.R4i=5;this.oHi=3E4;this.$qd(a.appSettings)}$qd(a){this.enabled=Boolean.parse(a[zc.uZf]||"false");this.w3i=parseInt(a[zc.Oum]||"500");this.B4i=parseInt(a[zc.axm]||"2");this.R4i=parseInt(a[zc.yxm]||"5");this.oHi=parseInt(a[zc.dUl]||"30000")}}zc.uZf="ActivityAggregationEnabled";zc.Oum="ActivityAggregationMaxInterval";zc.axm="ActivityAggregationMinChain";zc.yxm="ActivityAggregationModeFactor";
zc.dUl="ActivityAggregationGraceWindow";Object(t.a)(zc,"ActivityAggregationParams",null,[]);class Oc{constructor(a,d){this.H$a=a;this.Fnh=d}UIj(a,d=1){if(!a||!a.count)return a;const n=new db.a;var z=null;for(let O=0;O<a.count;O++){const ca=a.J(O);if(!ca)continue;const Da=ca.activityName;z?z.Nhm(ca)?z.add(ca):(z=z.process(),n.addRange(z),z=this.Fnh(Da,d),z.add(ca)):(z=this.Fnh(Da,d),z.add(ca))}z&&(a=z.process(),n.addRange(a));return n}aEn(a){if(!a||!a.count)return a;const d={};var n=null;for(let O=
0;O<a.count;O++){const ca=a.J(O);if(ca){if(!n){n=new db.a;var z=this.H$a.awd(ca.activityName);for(let Da of z)n.add(Da)}z=this.rLl(ca,n);null!==z&&(z in d&&d[z]||(d[z]=new db.a),d[z].add(ca))}}a=new db.a;for(const O of ta.a.NF(d))n=this.UIj(d[O],2),a.addRange(n);return a}rLl(a,d){let n="";for(let z of d)n+=z,n=a.properties.Na(z)&&void 0!==a.properties.J(z)&&null!==a.properties.J(z)?n+a.properties.J(z):n+"null";return n}}Object(t.a)(Oc,"ActivityAggregationSchemes",null,[753]);class ud{constructor(a,
d,n,z,O){this.Pp=this.lh=0;this.jqc=n;this.sXc=z;this.H$a=O;this.name=a;this.Tw=d;this.GQa=new db.a}get mode(){return this.Tw}get count(){return this.GQa.count}get startTime(){return this.lh}get endTime(){return this.Pp}get Rii(){if(!this.count)return 0;let a=0;for(let d of this.GQa)a+=d.endTime-d.startTime;return a/this.count}get jdl(){if(!this.count)return 0;let a=0;const d=this.Rii;for(let n of this.GQa){const z=n.endTime-n.startTime;a+=(z-d)*(z-d)}return a/this.count}add(a){this.count?this.Pp=
a.endTime>this.endTime?a.endTime:this.endTime:(this.lh=a.startTime,this.Pp=a.endTime);this.GQa.add(a)}Nhm(a){return 0>=this.count?!1:a.startTime-this.endTime<=this.jqc.w3i}process(){if(this.count>=this.jqc.B4i){const a=new db.a,d=this.sXc(this);a.add(d);return a}return this.GQa}abg(a){const d=new db.a;for(let n of this.GQa)if(n.properties.Na(a)){const z=n.properties.J(a);d.add(z)}else d.add(null);return d}Ebg(){const a=this.H$a.awd(this.name),d=new fc.a;for(let n of this.Hrl())a.contains(n)||d.add(n);
return d}Hrl(){const a=new fc.a;if(!this.GQa)return a;for(let d of this.GQa)for(let n of d.properties.keys)a.add(n);return a}qAl(){return this.GQa.J(0).uniqueID}}Object(t.a)(ud,"ActivityCollection",null,[752]);class Ad{constructor(){this.xRb=new tb.a}get list(){return this.xRb}add(a){const d=a.activityName;if(this.xRb.Na(d)&&this.xRb.J(d)){const n=this.WCl(this.xRb.J(d),a);this.xRb.J(d).insert(n,a)}else this.xRb.$(d,new db.a),this.xRb.J(d).add(a)}WCl(a,d){for(let n=a.count-1;0<=n;n--)if(d.startTime>
a.J(n).startTime)return n+1;return 0}}Object(t.a)(Ad,"CompletedActivitiesHelper",null,[744]);class xd{constructor(){this.Z=null}get name(){return"Common.App.ActivityAggregator"}init(){l.AFrameworkApplication.QH(()=>{this.Z.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}Hb(a){this.Z=a;const d=z=>new qb(()=>a.sa("Common.App.Activities.IActivityAggregationManager"),z),n=(z,O)=>new ud(z,O,a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),d,a.resolve("Common.IActivityAggregationInfo"));
a.register(ec,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").singleInstance().zd(()=>new ec(a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),a.resolve("Common.IActivityAggregationInfo"),a.vf("Common.App.ActivityAggregator.IActivityAggregationSchemes"),a.resolve("Common.App.Activities.IActivityThrottler"),a.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));a.register(zc,"Common.App.ActivityAggregator.ActivityAggregationParams").singleInstance().zd(()=>
new zc(l.AFrameworkApplication.K));a.register(uc,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").singleInstance().zd(()=>new uc);a.register(Oc,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").singleInstance().zd(()=>new Oc(a.resolve("Common.IActivityAggregationInfo"),n));a.register(Ad,"Common.App.ActivityAggregator.CompletedActivitiesHelper").singleInstance().zd(()=>new Ad)}static main(){M.a.instance.Sb(new xd)}}
Object(t.a)(xd,"ActivityAggregatorPackage",null,[1,2]);var re=b(550),mc=b(1203);class Ab{constructor(a){this.pKh=0;this.X$e=null;this.zkk=a}get chat(){return window.swc}get isInitialized(){return!!this.chat}get N3g(){return this.zkk.value}lb(){this.isInitialized?this.jQc():this.N3m(Object(m.a)(this,this.jQc,"registerActionsInternal"))}jQc(){k.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(a=>{a.getChatsContainer(Object(m.a)(this,
this.jDm,"onChatContainerReady"))}).catch(a=>{k.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",a)}),this.chat.getChatsCounter().then(a=>{a.onChatsCountChange(Object(m.a)(this,this.APk,"chatCountChanged"))}).catch(a=>{k.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",a)}),this.chat.getKeyboard().then(a=>{a.onKeyDown(Object(m.a)(this,this.mDm,"onChatKeyPress"))}).catch(a=>{k.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",
a)}))}catch(a){k.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",a)}}APk(a){k.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",a);if(!a)this.N3g.iDm();else if(1===a&&!this.pKh){const d=document.getElementById(this.X$e?this.X$e:mc.a.x4b);d?this.N3g.nDm(d,Object(m.a)(this,this.XFn,"transferFocusToChat")):k.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.pKh=a}jDm(a){this.X$e=a}mDm(a){a.ctrlKey&&"f6"===a.key.toLowerCase()&&this.WFn(a.shiftKey)}N3m(a){re.a.instance.Ea(vb.a.bHj,
window.self,()=>{a();return!0})}XFn(){k.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(a=>{a.focusConversationInput()}).catch(a=>{k.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",a)})}catch(a){k.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",a)}}WFn(a){k.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.N3g.kDm(a)}}Object(t.a)(Ab,"ChatManager",null,[743]);var oc=
b(62);class Mc{constructor(){this.ka=new oc.a;this.qqk=!1}bzk(a){this.ka.addHandler("OnTopRowControlsCreatedEvent",a)}Pyk(a){this.ka.addHandler("OnRenameTextboxStatusChangedEventKey",a)}get jFn(){return this.qqk}djj(a){this.ka.raiseEvent("OnRenameTextboxStatusChangedEventKey",a?"true":"false")}}Object(t.a)(Mc,"HeaderEventSource",null,[]);var Ec=b(151),kd=b(287);class Xd{constructor(a,d,n,z,O){this.qge=null;this.ib=a;this.Bq=d;this.mk=n;this.sqk=z;this.ga=O}Alj(a,d,n,z=null){const O=this.ib.Kc(d);
O.parent=n;O.uK=!0;z&&O.maa(z);this.mk.Gxa(d,a,!1);this.sqk.Gxa(d,a,!1);d=new kd.DOMFocusListing(()=>a);d.Ln(2);d.Ln(1);d.Ln(8);d.Ln(5);d.Ln(3);d.Ln(6);this.ib.jfa(()=>a,O,d).MS=!0;d=gb.KeyInputManager.$a(xb.a.Nw,0);n=gb.KeyInputManager.$a(xb.a.Nw,4);O.zq(d);O.zq(n)}onFlexPaneOpen(a){this.Alj(a,mc.a.tMc,mc.a.Yra);this.ib.wf(mc.a.tMc);this.Bq.Ixa(mc.a.tMc)}onFlexPaneClose(){this.Bq.gx(mc.a.tMc);this.ib.wf(mc.a.Yra)}nDm(a,d){this.qge||(this.qge=d,this.Alj(a,mc.a.x4b,Ec.AFrame.wy,Object(m.a)(this,this.lDm,
"onChatFocus")));this.ib.wf(mc.a.x4b);this.Bq.Ixa(mc.a.x4b)}lDm(){this.qge&&this.qge()}iDm(){this.Bq.gx(mc.a.x4b);this.ib.NEc(Ec.AFrame.ao)}kDm(a){this.ga.processAction(a?Sa.a.iEc:Sa.a.Gpc,2)}}Object(t.a)(Xd,"ReactSharedHeaderFocusManager",null,[729]);var Bc=b(99),jd=b(922),Vc=b(46),Ye=b(36),Cd=b(66);class of{constructor(a){this.ga=a}lb(){this.ga.ma(Sa.a.tsd,Cd.a.frame,Object(m.a)(this,this.T5i,"navigateToUpsellPage"));this.ga.ma(Sa.a.tri,Cd.a.frame,Object(m.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));
this.ga.ma(Sa.a.Qpj,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Sa.a.bWg,Cd.a.frame,Bc.ActionManager.Ke)}T5i(a,d,n,z,O){if(1===n)return 32;a=8;2===n&&(n=this.A6f(O,"experience","gopremiumribbon"),O=Vc.a.d4("2116536"),O=Vc.a.tl(O,"ocid",jd.b(l.AFrameworkApplication.la.eb.Bm,l.AFrameworkApplication.la.eb.tca,n)),Ye.a.Tk(O,"_blank",void 0,"NavigateToUpsellPage"),a=32,this.ga.processAction(Sa.a.bWg,2),k.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return a}launchUpsellExperience(a,d,n,z,O){if(1===
n)return 32;var ca=8;2===n&&(k.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(ca=la.a.instance.sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(a=this.A6f(O,"experience","gopremium"),O=this.A6f(O,"dimeCampaignId",null),ca.launchUpsellExperience(a,O),ca=32):(k.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),ca=this.T5i(a,d,n,z,O)));return ca}A6f(a,d,n){a&&a[d]&&(n=Object(qa.a)(String,a[d]));return n}}Object(t.a)(of,"UpsellActor",
null,[728]);class Je{constructor(){this.Z=null}get name(){return"Common.App.Header"}init(){la.a.instance.resolve("Common.App.Header.IUpsellActor").lb();la.a.instance.resolve("Common.App.Header.IChatManager").lb()}dispose(){}Hb(a){this.Z=a;this.Z.register(Mc,"Common.App.Header.HeaderEventSource").singleInstance();this.Z.register(of,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").singleInstance().zd(()=>new of(l.AFrameworkApplication.pa));this.Z.register(Xd,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").singleInstance().zd(()=>
new Xd(l.AFrameworkApplication.la.Zh,l.AFrameworkApplication.la.rn,l.AFrameworkApplication.la.dZ,l.AFrameworkApplication.la.pUc,l.AFrameworkApplication.pa));this.Z.register(Ab,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").singleInstance().zd(()=>new Ab(this.Z.vf("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){M.a.instance.Sb(new Je)}}Object(t.a)(Je,"CommonAppHeaderPackage",null,[1,2]);var gd=b(1348);class Te{static hti(a,d){switch(a){case 3:return Te.ATl(d);
case 2:return Te.vIl(d);case 1:return Te.ozl(d)}return""}static ATl(a){switch(a){case 1:return l.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return l.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static vIl(a){switch(a){case 1:return l.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return l.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static ozl(a){switch(a){case 1:return l.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString();
case 2:return l.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(a,d,n){if(I.a.tg||I.a.Px)window.setTimeout(()=>{Te.Ykj(n,Te.xAe())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Te.HYh(n),a,0,!1)}static kTk(a,d,n,z){d&&z&&z();Te.openInClient(a,d,n)}static xAe(){return I.a.tg?1:I.a.Px?2:I.a.pJa?3:I.a.Pi?4:0}static qTl(a){switch(a){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";
default:return""}}static rTl(a){switch(a){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get sDd(){return"zh-CN"===window.navigator.language}static Ykj(a,d){1===d?(k.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),a=Te.hti(a,d),8<I.a.mAa?Ye.a.Tk(a,void 0,void 0,"RedirectToAppStore"):Ye.a.Vkb(a)):document.hidden||(Te.sDd?(a=l.AFrameworkApplication.K.appSettings.WildFireUrlChinaStoreAndroid.toString())?
(k.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),Ye.a.Vkb(a)):k.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(k.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(Te.hti(a,d),null,null)))}static HYh(a){switch(a){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get eZe(){return(I.a.pJa||I.a.Pi)&&I.a.el}static get itn(){return I.a.tg||I.a.Px}static Ati(a){switch(a){case 3:return"WordBizBarDismiss";
case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static CSi(a){return(a=Te.FDl(a))&&""!==a?Boolean.parse(a):!1}static A2g(a){Te.Iln(a)}static FDl(a){try{return localStorage.getItem(a)}catch(d){return k.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+d.message),null}}static Iln(a){try{localStorage.setItem(a,"true")}catch(d){k.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+
d.message)}}}Te.D6h="ChromeExtensionBarDismiss";Object(t.a)(Te,"WildFireUtilities",null,[]);var cg=b(362);class Jg{constructor(){this.Y8e=new cg.a;this.V8e=new cg.a;this.U8e=new cg.a;this.rIk(this.Y8e);this.qIk(this.V8e);this.pIk(this.U8e);this.thf=new cg.a;this.shf=new cg.a;this.rhf=new cg.a;this.lLk(this.thf);this.kLk(this.shf);this.jLk(this.rhf);this.kaf=new cg.a;this.IIk(this.kaf);this.l2b(this.kaf);this.l2b(this.U8e);this.l2b(this.V8e);this.l2b(this.Y8e);this.l2b(this.shf);this.l2b(this.thf);
this.l2b(this.rhf)}Oze(a,d){switch(a){case 1:return this.STl(d);case 2:return this.bsl(d)}return Te.eZe?this.kaf:null}rIk(a){a.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);a.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);a.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}qIk(a){a.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);a.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);a.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}pIk(a){a.add("Headline",
CommonUIStrings.l_WildFireExcelBizBarHeadline);a.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);a.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}lLk(a){a.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);a.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);a.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);a.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);a.add("CallToAction",
CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);a.add("OverlayBig","Get the Word app");a.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");a.add("OverlaySmallSplit1","Discover Word");a.add("OverlaySmallSplit2","designed for the iPad.");a.add("SkipButton","Skip for now")}IIk(a){a.add("Headline","Get the Office Online extension for Chrome");a.add("UseAppButton","Get the extension");a.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}kLk(a){a.add("Headline",
CommonUIStrings.l_WildFirePPTBizBarHeadline);a.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);a.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);a.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);a.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);a.add("OverlayBig","Get the PowerPoint app");a.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");a.add("OverlaySmallSplit1",
"Discover PowerPoint");a.add("OverlaySmallSplit2","designed for the iPad.");a.add("SkipButton","Skip for now")}jLk(a){a.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);a.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);a.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);a.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);a.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}l2b(a){a.add("Corporation",
"Microsoft Corporation")}STl(a){switch(a){case 3:return this.thf;case 2:return this.shf;case 1:return this.rhf}return null}bsl(a){switch(a){case 3:return this.Y8e;case 2:return this.V8e;case 1:return this.U8e}return null}static get instance(){Jg.na||(Jg.na=new Jg);return Jg.na}}Jg.na=null;Object(t.a)(Jg,"WildFireStringFactory",null,[]);class Ga{constructor(a,d,n,z,O=null,ca=null){this.upf=null;this._id=a;this.Rqf=d;this.X$j=O;this.v4c=z;this.obd=ca;this.$wb=null;this.Ced=n;this.$cd=Jg.instance.Oze(d,
a)}x_k(){this.$wb=new gd.a(this.title,this.message,null);this.$wb.addButton(this.zLk,Object(m.a)(this,this.SCm,"onButtonOneClick"),"");this.Ced&&this.$wb.fVh(this.FLk,Object(m.a)(this,this.XCm,"onButtonTwoClick"));this.$wb.nla=Object(m.a)(this,this.Gal,"dismissBar");this.$wb.image=3;this.$wb.id=16;this.$wb.closeable=!0}get title(){return this.$cd.J("Headline")}get message(){return this.$cd.J("CallToAction")}get zLk(){return this.Ced?this.$cd.J("InstallButton"):this.$cd.J("UseAppButton")}get FLk(){return this.Ced?
this.$cd.J("OpenAppButton"):""}SCm(){this.Ced?this.C6l():this.mQn()}XCm(){this.Ced&&this.QLm()}get O2h(){return this.$wb}get Bna(){this.upf||(this.upf=this.X$j());return this.upf}C6l(){k.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.v4c&&this.obd&&this.obd();Te.Ykj(this._id,this.Rqf)}QLm(){this.Bna&&(k.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.v4c&&this.obd&&this.obd(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Te.HYh(this._id),
this.Bna,0,!1))}mQn(){Te.eZe?this.vLk():(k.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),Te.A2g("BizBarClicked"),1!==this.Rqf&&2!==this.Rqf||Te.kTk(this.Bna,this.v4c,this._id,this.obd))}vLk(){this.v4c?k.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):k.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Ye.a.Vkb(l.AFrameworkApplication.K.appSettings.WildFireChromeExtensionUrl.toString())}Hal(){this.v4c?k.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):k.ULS.sendTraceTag(17571977,
301,50,"ChromeExtBannerDismissed");Te.A2g(Te.D6h)}Gal(){Te.eZe?this.Hal():(Te.A2g(Te.Ati(this._id)),k.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static NSf(){const a=l.AFrameworkApplication.la.eb;new Ga(a.Bm,Te.xAe(),8<I.a.mAa,1===a.tca,()=>a.vN,a.nWe());k.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(t.a)(Ga,"WildFireBusinessBar",null,[]);class Oa{get name(){return"Common.App.WildFire"}JAf(a){const d=l.AFrameworkApplication.la.eb;let n=!1;a&&(a.x_k(),a.O2h&&
(n=d.f2a(a.O2h,!0)));return n}F_k(){var a=l.AFrameworkApplication.la.eb;a=new Ga(a.Bm,Te.xAe(),!1,1===a.tca);this.JAf(a)&&k.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}NSf(a,d,n,z,O,ca){a=new Ga(a,n,z,d,O,ca);this.JAf(a)&&k.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}p5k(){const a=l.AFrameworkApplication.la.eb;var d=l.AFrameworkApplication.K;const n=a.Bm,z=1===a.tca;if(d.ea(Te.qTl(n))){var O=Te.xAe(),ca=8<I.a.mAa;if(2!==n||2!==O||!z){d=d.ea(Te.rTl(n));var Da=a.nWe(),
Xa=()=>a.vN;d&&!Te.CSi(Te.Ati(n))&&this.NSf(n,z,O,ca,Xa,Da)}}}init(){var a=l.AFrameworkApplication.K;const d=a.ea("WildFireChromeExtensionEnabled");a=a.ea("WildFireChromeExtensionBar")&&d;Te.eZe&&a&&!Te.CSi(Te.D6h)?this.F_k():(document.body&&Te.itn&&this.p5k(),l.AFrameworkApplication.pa.ma(Sa.a.FIe,Cd.a.frame,Object(m.a)(this,this.FIe,"launchWildFireBusinessBar")))}FIe(a,d,n,z,O){if(1===n)return 32;if(!O)return 8;this.NSf(O.app,O.mode,O.platform,O.useTwoButton,null,null);return 32}dispose(){}Hb(){}static main(){M.a.instance.Sb(new Oa)}}
Object(t.a)(Oa,"PackageManager",null,[1,2]);class Wb{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=
!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(t.a)(Wb,"BrowserInfo",null,[]);class Ac{constructor(){this.Version=this.Name=null}}Object(t.a)(Ac,"PluginInfo",null,[]);class sd{static VGd(){if(l.AFrameworkApplication.K.ea("LogBrowserInfoIsEnabled")){var a=sd.npl();try{const d=JSON.stringify(a);k.ULS.sendTraceTag(6903563,102,50,d)}catch(d){k.ULS.sendTraceTag(6903564,102,15,d.message)}}else k.ULS.sendTraceTag(6903562,
102,50,"Detailed browser info logging is turned off")}static oKl(){const a=window.navigator.plugins;if(!a||!a.length)return null;const d=[];for(let n=0;n<a.length;n++){const z=a[n].name,O=a[n].version;Array.add(d,Object.assign(new Ac,{Name:z,Version:O}))}return d}static npl(){const a=new Wb,d=new Sys.StringBuilder;sd.NL(n=>{a.DocElemClientHeight=n},()=>document.documentElement.clientHeight,d);sd.NL(n=>{a.DocElemClientWidth=n},()=>document.documentElement.clientWidth,d);sd.NL(n=>{a.DocElemOffsetHeight=
n},()=>document.documentElement.offsetHeight,d);sd.NL(n=>{a.DocElemOffsetWidth=n},()=>document.documentElement.offsetWidth,d);sd.NL(n=>{a.ScreenAvailHeight=n},()=>window.screen.availHeight,d);sd.NL(n=>{a.ScreenAvailWidth=n},()=>window.screen.availWidth,d);sd.NL(n=>{a.ScreenWidth=n},()=>window.screen.width,d);sd.NL(n=>{a.ScreenHeight=n},()=>window.screen.height,d);sd.NL(n=>{a.ScreenLogicalXdpi=n},()=>window.screen.logicalXDPI,d);sd.NL(n=>{a.ScreenLogicalYdpi=n},()=>window.screen.logicalYDPI,d);sd.NL(n=>
{a.ScreenDeviceXdpi=n},()=>window.screen.deviceXDPI,d);sd.NL(n=>{a.ScreenDeviceYdpi=n},()=>window.screen.deviceYDPI,d);sd.NL(n=>{a.WinInnerHeight=n},()=>window.self.innerHeight,d);sd.NL(n=>{a.WinInnerWidth=n},()=>window.self.innerWidth,d);sd.NL(n=>{a.WinOuterHeight=n},()=>window.self.outerHeight,d);sd.NL(n=>{a.WinOuterWidth=n},()=>window.self.outerWidth,d);sd.NL(n=>{a.WinOrientation=n},()=>window.self.orientation,d);sd.NL(n=>{a.WinDevicePixelRatio=n},()=>window.self.devicePixelRatio,d);sd.NL(n=>{a.SupportsTouch=
n},()=>I.a.uOb,d);sd.NL(n=>{a.NavAppName=n},()=>window.navigator.appName,d);sd.NL(n=>{a.NavAppVersion=n},()=>window.navigator.appVersion,d);sd.NL(n=>{a.NavLanguage=n},()=>window.navigator.browserLanguage||window.navigator.language,d);sd.NL(n=>{a.NavUserAgent=n},()=>window.navigator.userAgent,d);sd.NL(n=>{a.NavPlatform=n},()=>window.navigator.platform,d);sd.NL(n=>{a.NavPlugins=n},sd.oKl,d);sd.NL(n=>{a.CalculatedDevicePixelRatio=n},()=>sd.devicePixelRatio,d);a.Error=d.toString();return a}static get devicePixelRatio(){const a=
window.devicePixelRatio;return isNaN(a)?window.screen.deviceXDPI/window.screen.logicalXDPI:a}static NL(a,d,n){try{const z=d();a(z)}catch(z){n.isEmpty()||n.append(" | "),n.append(z.message||"null")}}}Object(t.a)(sd,"BrowserInfoLogger",null,[]);class Xe{get name(){return"Common.App.BrowserInfoLogger"}Hb(){}init(){sd.VGd()}dispose(){}static main(){M.a.instance.Sb(new Xe)}}Object(t.a)(Xe,"BrowserInfoLoggerPackage",null,[1,2]);class xe{constructor(){this.ka=new oc.a}Byc(a){this.ka.addHandler("OnEditHappenedEvent",
a)}KQd(a){this.ka.removeHandler("OnEditHappenedEvent",a)}zYm(){this.ka.raiseEvent("OnEditHappenedEvent")}}Object(t.a)(xe,"EditNotificationEventSource",null,[]);var we=b(57),bf=b(81);class ch{constructor(a,d,n,z,O,ca,Da=0){this.Hdf=!1;this.Gdf=this.PXb=null;this.ERh=!1;this.fb=d;this.Bae=a;this.Tyb=n;this.fea=z;this.CRh=O;this.a8j=ca;this.P5d=0;this.w7d=!1;try{0<Da&&(this.P5d=Da,3E5>this.P5d&&(this.P5d=3E5),this.fb&&!this.Gdf&&(this.Gdf=new bf.a(3,2,this.P5d,Object(m.a)(this,this.A$m,"reportEditDocumentUserActionTelemetryIfNecessary")),
this.fb.rb(this.Gdf)))}catch(Xa){k.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+Xa)}}get jRj(){return this.ERh}hse(){this.jRj?this.w7d=!0:(this.ERh=!0,ja.Health.instance.addQosPillar("Save"),ja.Health.instance.addQosPillar("ContentCreation"),we.c(Sa.a.editDocument));this.Hdf=!0;this.CRh&&this.CRh.pTh();this.fea&&this.fea.zYm();l.AFrameworkApplication.qf&&l.AFrameworkApplication.qf.W2i();this.a8j&&!this.PXb&&(this.kTd(null),
this.PXb=new bf.a(3,2,this.Bae,Object(m.a)(this,this.kTd,"sendPostMessageIfNecessary"),113),this.fb.rb(this.PXb))}kTd(){this.Hdf&&(this.Tyb.CWR(()=>this.Tyb.result.Eh(D.a.editNotification,null)),k.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.Hdf=!1)}A$m(){try{this.w7d&&(we.c(Sa.a.editDocument),this.w7d=!1)}catch(a){this.w7d=!1,k.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+a)}}}Object(t.a)(ch,
"EditNotificationManager",null,[736]);class Pf{constructor(a,d,n,z,O){this.Fgf=this.PXb=null;this.mcb=this.t8e=!1;this.fb=d;this.Bae=a;this.Tyb=n;this.mk=z;this.Wof=O;this.Glj(null)}Glj(){const a=document.getElementById(l.AFrameworkApplication.rhb);!this.mcb&&this.mk&&a&&(this.mk.Ea(vb.a.jM,a,Object(m.a)(this,this.NAg,"mouseActivityHandler"),null),this.mcb=!0);this.Wof(()=>{this.dispose()})}NAg(){this.mcb&&(this.mk.kb(vb.a.jM,document.getElementById(l.AFrameworkApplication.rhb),Object(m.a)(this,this.NAg,
"mouseActivityHandler")),this.mcb=!1);this.pTh();return!1}pTh(){this.t8e=!0;this.Fgf||(this.Fgf=new bf.a(3,2,this.Bae,Object(m.a)(this,this.Glj,"registerHandlerTask"),112),this.fb.rb(this.Fgf));this.PXb||(this.kTd(null),this.PXb=new bf.a(3,2,this.Bae,Object(m.a)(this,this.kTd,"sendPostMessageIfNecessary"),111),this.fb.rb(this.PXb))}kTd(){this.t8e&&(this.Tyb.CWR(()=>this.Tyb.result.Eh(D.a.cRj,null)),k.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),
this.t8e=!1)}dispose(){this.mcb&&(this.mk.kb(vb.a.jM,document.getElementById(l.AFrameworkApplication.rhb),Object(m.a)(this,this.NAg,"mouseActivityHandler")),this.mcb=!1)}}Object(t.a)(Pf,"UserActivityHostNotificationManager",null,[735,12]);var Eg=b(162),th=b(78),Ph=b(679);class pf{constructor(){this.Z=null}get name(){return"Common.App.EditNotification"}init(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.wq(Object(m.a)(this,this.Gw,"onFullAppSettingsReady"))}Gw(){pf.zdl&&0<pf.HYf&&(this.Z.register(xe,
"Common.App.HostNotification.EditNotificationEventSource").singleInstance(),this.Z.register(Pf,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").singleInstance().zd(()=>new Pf(6E4,th.a.instance,Ph.a.ot(this.Z.Ca("Postmessage.IHostPostmessenger")),Eg.a.instance,l.AFrameworkApplication.QH)),this.Z.register(ch,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").singleInstance().zd(()=>
new ch(pf.HYf,th.a.instance,Ph.a.ot(this.Z.Ca("Postmessage.IHostPostmessenger")),this.Z.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.Z.sa("Common.Interface.IUserActivityHostNotificationManager"),pf.Adl,pf.vdl)),this.Z.resolve("Common.Interface.IEditNotificationManager"),k.ULS.shipAssertTag(38086291,209,0<pf.HYf,"EditNotification Interval is less than or equal to 0."))}Hb(a){this.Z=a}dispose(){}static get HYf(){return l.AFrameworkApplication.K?parseInt(l.AFrameworkApplication.K.appSettings.EditNotificationTimeIntervalMs||
"300000"):3E5}static get vdl(){return l.AFrameworkApplication.K?parseInt(l.AFrameworkApplication.K.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get zdl(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("EditNotificationIsEnabled")}static get Adl(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("EditNotificationPostMessageIsEnabled")}static main(){M.a.instance.Sb(new pf)}}Object(t.a)(pf,"CommonHostNotificationPackage",null,
[1,2]);class rk{constructor(a,d,n){this.$_b=null;this.fb=a;this.ga=d;this.Fwh=n.create()}rXa(){this.$_b?k.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(k.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.$_b=new bf.a(2,1,3E4,Object(m.a)(this,this.yVd,"showFloatPane"),67),this.fb.rb(this.$_b))}yVd(){this.$_b=null;k.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.Fwh.display()}Oca(){this.ga.ma(Sa.a.yVd,
Cd.a.frame,Object(m.a)(this,this.Qun,"showFloatPaneHandler"))}Qun(a,d,n,z,O){return a!==Sa.a.yVd?2:1===n?32:2===n&&O?(k.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",O),O?this.rXa():(this.$_b?(k.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.fb.ie(this.$_b)):(k.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.Fwh.remove(null)),this.$_b=null),32):8}}Object(t.a)(rk,"FloatPaneActor",null,[737]);
var Xi=b(91),Vf=b(97),Qc=b(25),pd=b(59);class mf{constructor(a,d,n,z,O){this.pmf=this.U2c=this.Rce=this.Oeb=this.Gpa=this.rab=this.j$e=this.Yja=this.T9c=this.P6c=this.Q6c=this.mff=null;this.fb=d;this.va=a;this.ag=n;this.Z=O;this.Zua=z}Ibi(){this.Yja=document.createElement("div");this.Yja.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.Yja.style.width=this.Gpa.width+"px";(this.pmf=this.HHl(this.Zua))?(this.Oeb=document.createElement("a"),this.Oeb.setAttribute(pd.a.ig,pd.a.Ix),
this.ag.Ea(vb.a.click,this.Oeb,Object(m.a)(this,this.haj,"onRedirectClick")),this.Oeb.href=this.pmf,this.Oeb.target="_blank",this.Oeb.appendChild(this.Gpa),this.Yja.appendChild(this.Oeb)):this.Yja.appendChild(this.Gpa);this.rab=document.createElement("a");this.rab.setAttribute(pd.a.ig,pd.a.l3);this.rab.className="StandardButton WACFloatPaneCloseButton";this.rab.title=CommonUIStrings.l_Close;this.rab.tabIndex=-1;this.j$e=Vf.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",
!0,null);this.j$e.setAttribute(pd.a.ig,pd.a.Ix);this.rab.appendChild(this.j$e);this.ag.Ea(vb.a.click,this.rab,Object(m.a)(this,this.onClose,"onClose"));this.Yja.appendChild(this.rab);this.T9c.appendChild(this.Yja)}LCl(a){const d=this.va.ea("O365PromotionHasStarted");switch(a){case 2:return Xi.a.A3(String.format("adppt{0}.png",d?"sale":""));case 1:return Xi.a.A3(String.format("adxls{0}.png",d?"sale":""));case 3:return Xi.a.A3(String.format("addoc{0}.png",d?"sale":""))}return null}HHl(a){const d=this.va.Ga("O365AdPaneRedirectedURL");
switch(a){case 1:return String.format(d,"Excel");case 2:return String.format(d,"PowerPoint");case 3:return String.format(d,"Word")}return null}hide(a=null){this.U2c=null;this.Yja&&!this.Rce&&(a?k.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):k.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.Yja.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.Yja.style.height="0px",this.Rce=new bf.a(2,1,1E3,Object(m.a)(this,
this.remove,"remove"),67),this.fb.rb(this.Rce))}remove(){this.Yja&&this.T9c&&(this.Oeb&&this.ag.kb(vb.a.click,this.Oeb,Object(m.a)(this,this.haj,"onRedirectClick")),this.ag.kb(vb.a.click,this.rab,Object(m.a)(this,this.onClose,"onClose")),this.T9c.removeChild(this.Yja),this.Yja=null);this.Rce=null}display(){if(this.mff=this.Z.sa("Common.IFloatPaneContainer"))if(this.T9c=this.mff.container){var a=this.LCl(this.Zua);a?(k.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",a),
this.Gpa=document.createElement("img"),this.Gpa.className="WACFloatPaneImage",this.Q6c=Object(m.a)(this,this.ZGm,"onLoadImageFinish"),Qc.a.addHandler(this.Gpa,vb.a.load,this.Q6c),this.P6c=Object(m.a)(this,this.YGm,"onLoadImageError"),Qc.a.addHandler(this.Gpa,vb.a.error,this.P6c),this.Gpa.src=a):k.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else k.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else k.ULS.sendTraceTag(23674905,
207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}ZGm(){const a=this.va.jb("O365AdPaneShowingDuration",60);this.Ibi();this.Yja.style.display="block";this.Yja.style.height=this.Gpa.height+"px";this.U2c=new bf.a(2,1,1E3*a,Object(m.a)(this,this.hide,"hide"),67);this.fb.rb(this.U2c);this.knj()}YGm(){k.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.knj();this.Gpa=null}knj(){this.Q6c&&this.Gpa&&Qc.a.removeHandler(this.Gpa,
vb.a.load,this.Q6c);this.Q6c=null;this.P6c&&this.Gpa&&Qc.a.removeHandler(this.Gpa,vb.a.error,this.P6c);this.P6c=null}haj(){k.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.U2c&&this.fb.ie(this.U2c);this.hide();return!0}dispose(){this.hide()}}Object(t.a)(mf,"FloatPane",null,[747]);class ef{constructor(a,d,n,z,O){this.fb=d;this.va=a;this.ag=n;this.Z=O;this.Zua=z}create(){return new mf(this.va,this.fb,this.ag,this.Zua,this.Z)}}
Object(t.a)(ef,"FloatPaneFactory",null,[734]);var Ae=b(238);class id{constructor(){this.Z=null}get name(){return"Common.App.FloatPane"}get pRi(){return l.AFrameworkApplication.K.ea("O365AdvertisementIsEnabled")&&l.AFrameworkApplication.K.ea("IsShowAdvertisementPaneEnabled")}init(){this.pRi&&(k.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.Z.resolve("Common.App.FloatPane.IFloatPaneActor").rXa(),k.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),
this.Z.resolve("Common.App.FloatPane.IFloatPaneActor").Oca())}Hb(a){this.Z=a;this.pRi&&(this.Z.register(ef,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").zd(()=>new ef(l.AFrameworkApplication.K,l.AFrameworkApplication.tb,Ae.a.instance,l.AFrameworkApplication.la.eb.Bm,this.Z)).singleInstance(),this.Z.register(rk,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").zd(()=>new rk(l.AFrameworkApplication.tb,l.AFrameworkApplication.pa,
this.Z.resolve("Common.App.FloatPane.IFloatPaneFactory"))).singleInstance())}dispose(){}static main(){M.a.instance.Sb(new id)}}Object(t.a)(id,"FloatPanePackage",null,[1,2]);var Ah=b(1466);class Bh{}Object(t.a)(Bh,"LokiTokenResult",null,[]);class wg{constructor(a){this.Fae=a}a$f(){const a=this.pFl();return a?wg.rqg?new Promise((d,n)=>{this.Fae.continueWith(()=>{this.Fae.Jm||this.Fae.Vh?n(Error.create("Error downloading auth library")):this.Fae.result.xLa("Loki",a).then(z=>{z=l.AFrameworkApplication.K.ea("ForceLokiFallbackToACLPTokenIsEnabled")?
this.sFl():z.IsSuccess&&z.Token?Object.assign(new Bh,{isSuccess:!0,token:z.Token,errorMessage:null}):Object.assign(new Bh,{isSuccess:!1,token:null,errorMessage:JSON.stringify(z)});d(z);return z})})}):Promise.resolve(Object.assign(new Bh,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new Bh,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",Ah.a.qti())}))}sFl(){const a=
l.AFrameworkApplication.K.Ga("LokiUserDataSignature")||"";return Object.assign(new Bh,{isSuccess:!0,token:a,errorMessage:null})}pFl(){let a=null;const d=Ah.a.Tve();2===d?a=l.AFrameworkApplication.K.Ga("LokiAADAppId"):1===d&&(a=l.AFrameworkApplication.K.Ga("LokiMSAAppId"));return a}static get rqg(){return l.AFrameworkApplication.K.ea("IsO365CommercialHost")||l.AFrameworkApplication.K.ea("IsO365ConsumerHost")}}Object(t.a)(wg,"LokiTokenManager",null,[761]);class li{get name(){return"Common.App.LivePersonaUtils"}init(){la.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}Hb(a){a.register(wg,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").singleInstance().zd(()=>new wg(Ph.a.ot(a.Ca("Common.App.OAuth.IOAuthManager"))))}static main(){M.a.instance.Sb(new li)}}Object(t.a)(li,"LivePersonaUtilsPackage",null,[1,2]);class Hh{constructor(a){this.S8e=a}OQi(a){if(!this.S8e)return!0;a=Vc.a.Dxe(a);if(!a)return!1;a=a.toLowerCase();for(let d=0;d<this.S8e.length;d++)if(a.endsWith(this.S8e[d]))return!0;return!1}}Object(t.a)(Hh,"DomainAllowListManager",null,[]);class vj{constructor(a,
d){this.$Tf=null;this.oxf=a;this.url=d}get dfh(){return Vc.a.A8(this.url)}get jv(){return this.oxf}lah(){const a={},d=this.jv;a.a=this.dfh;a.b=this.round(d.navigationStart);a.c=this.round(d.unloadEventStart);a.d=this.round(d.unloadEventEnd);a.e=this.round(d.redirectStart);a.f=this.round(d.redirectEnd);a.g=this.round(d.fetchStart);a.h=this.round(d.domainLookupStart);a.i=this.round(d.domainLookupEnd);a.j=this.round(d.connectStart);a.k=this.round(d.connectEnd);a.l=void 0!==d.secureConnectionStart&&null!==
d.secureConnectionStart?this.round(d.secureConnectionStart):0;a.m=this.round(d.requestStart);a.n=this.round(d.responseStart);a.o=this.round(d.responseEnd);a.q=this.round(d.domInteractive);a.r=this.round(d.domContentLoadedEventStart);a.s=this.round(d.domContentLoadedEventEnd);a.t=this.round(d.domComplete);a.u=this.round(d.loadEventStart);a.v=this.round(d.loadEventEnd);a.w=this.$Tf;return a}round(a){return Math.round(1E3*a)/1E3}}Object(t.a)(vj,"PerformanceTimingEntry",null,[]);const uh=(a,d)=>{const n=
{};let z=null;switch(a){case 0:z="ResourceTiming";a=d.a;null!=a&&(n.Url=a);a=d.b;null!=a&&(n.InitiatorType=a);a=null==d.c?null:d.c.toString();null!=a&&(n.RedirectStart=a);a=null==d.d?null:d.d.toString();null!=a&&(n.RedirectEnd=a);a=null==d.e?null:d.e.toString();null!=a&&(n.FetchStart=a);a=null==d.f?null:d.f.toString();null!=a&&(n.DomainLookupStart=a);a=null==d.g?null:d.g.toString();null!=a&&(n.DomainLookupEnd=a);a=null==d.h?null:d.h.toString();null!=a&&(n.ConnectStart=a);a=null==d.i?null:d.i.toString();
null!=a&&(n.ConnectEnd=a);a=null==d.j?null:d.j.toString();null!=a&&(n.SecureConnectionStart=a);a=null==d.k?null:d.k.toString();null!=a&&(n.RequestStart=a);a=null==d.l?null:d.l.toString();null!=a&&(n.ResponseStart=a);a=null==d.m?null:d.m.toString();null!=a&&(n.ResponseEnd=a);a=d.n;null!=a&&(n.CustomText=a);a=null==d.o?null:d.o.toString();null!=a&&(n.DecodedBodySize=a);a=null==d.p?null:d.p.toString();null!=a&&(n.EncodedBodySize=a);d=null==d.q?null:d.q.toString();null!=d&&(n.TransferSize=d);break;case 1:z=
"PerformanceTiming",a=d.a,null!=a&&(n.Url=a),a=null==d.b?null:d.b.toString(),null!=a&&(n.NavigationStart=a),a=null==d.c?null:d.c.toString(),null!=a&&(n.UnloadEventStart=a),a=null==d.d?null:d.d.toString(),null!=a&&(n.UnloadEventEnd=a),a=null==d.e?null:d.e.toString(),null!=a&&(n.RedirectStart=a),a=null==d.f?null:d.f.toString(),null!=a&&(n.RedirectEnd=a),a=null==d.g?null:d.g.toString(),null!=a&&(n.FetchStart=a),a=null==d.h?null:d.h.toString(),null!=a&&(n.DomainLookupStart=a),a=null==d.i?null:d.i.toString(),
null!=a&&(n.DomainLookupEnd=a),a=null==d.j?null:d.j.toString(),null!=a&&(n.ConnectStart=a),a=null==d.k?null:d.k.toString(),null!=a&&(n.ConnectEnd=a),a=null==d.l?null:d.l.toString(),null!=a&&(n.SecureConnectionStart=a),a=null==d.m?null:d.m.toString(),null!=a&&(n.RequestStart=a),a=null==d.n?null:d.n.toString(),null!=a&&(n.ResponseStart=a),a=null==d.o?null:d.o.toString(),null!=a&&(n.ResponseEnd=a),a=null==d.p?null:d.p.toString(),null!=a&&(n.DomLoading=a),a=null==d.q?null:d.q.toString(),null!=a&&(n.DomInteractive=
a),a=null==d.r?null:d.r.toString(),null!=a&&(n.DomContentLoadedEventStart=a),a=null==d.s?null:d.s.toString(),null!=a&&(n.DomContentLoadedEventEnd=a),a=null==d.t?null:d.t.toString(),null!=a&&(n.DomComplete=a),a=null==d.u?null:d.u.toString(),null!=a&&(n.LoadEventStart=a),a=null==d.v?null:d.v.toString(),null!=a&&(n.LoadEventEnd=a),d=d.w,null!=d&&(n.CustomText=d)}n.Table=z;return Sys.Serialization.JavaScriptSerializer.serialize(n)};var ai=b(37),pk=b(186),fk=b(148);class ak{constructor(a,d=null,n=null){this.ae=
a;this.cfh=this;this.f$j=d||(()=>window.location.href);this.qdf=new Hh(n)}run(){if(ak.cya(window.performance))try{const O=this.f$j();if(ak.Aqk.exec(O)&&this.qdf.OQi(O)){var a=new vj(window.performance.timing,O);fk.a.instance.fkj(a.jv.fetchStart);fk.a.instance.gkj(a.jv.navigationStart);fk.a.instance.iM(ai.a.cri,"connectStart","requestStart");fk.a.instance.iM(ai.a.lri,"requestStart","responseStart");fk.a.instance.iM(ai.a.ori,"responseStart","responseEnd");this.cfh.YIb(1,a.lah());this.ae.Hd(ai.a.OHa,
a.jv.fetchStart);this.ae.Hd(ai.a.hri,a.jv.domainLookupStart);this.ae.Hd(ai.a.gri,a.jv.domainLookupEnd);this.ae.Hd(ai.a.eri,a.jv.connectStart);this.ae.Hd(ai.a.rri,a.jv.secureConnectionStart);this.ae.Hd(ai.a.dri,a.jv.connectEnd);this.ae.Hd(ai.a.mri,a.jv.requestStart);this.ae.Hd(ai.a.REc,a.jv.responseStart);this.ae.Hd(ai.a.iri,a.jv.responseEnd-a.jv.responseStart);this.ae.Hd(ai.a.nri,a.jv.responseStart-a.jv.requestStart);var d=0,n=0,z=0;({transferSize:d,wZf:n,vUf:z}=this.VHn(O)).returnValue&&(this.ae.Hd(ai.a.sri,
d),this.ae.Hd(ai.a.fri,z),this.ae.Hd(ai.a.jri,n));this.ae.Hd(ai.a.kri,a.jv.navigationStart)}}catch(O){k.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",O)}}VHn(a){let d,n,z;z=n=d=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:d,wZf:n,vUf:z};a=window.performance.getEntriesByName(a,"navigation");if(void 0===a||null===a||1!==a.length)return{returnValue:!1,transferSize:d,wZf:n,vUf:z};
a=a[0];var O=a.transferSize;void 0!==d&&null!==d&&(d=O);O=a.decodedBodySize;void 0!==O&&null!==O&&(z=O);a=a.encodedBodySize;void 0!==a&&null!==a&&(n=a);return{returnValue:!0,transferSize:d,wZf:n,vUf:z}}YIb(a,d){k.ULS.sendTraceTag(4551815,306,50,uh(a,d))}static get instance(){return ak.na||(ak.na=new ak(pk.a.instance,null,l.AFrameworkApplication.K.ea("PerfTimingLoggerFilterDomainsIsEnabled")?l.AFrameworkApplication.K.kx("ResourceLoggerDomainAllowList"):null))}static cya(a){return!(void 0===a||null===
a)&&!(void 0===a.timing||null===a.timing)}}ak.na=null;ak.Aqk=RegExp("^https?://.*","i");Object(t.a)(ak,"PerformanceTimingLogger",null,[764]);class Kg{constructor(a,d){this.$Tf=null;this.oxf=a;this.behavior=d;this.url=this.jv.name}get dfh(){return 2===this.behavior?this.url:Vc.a.A8(this.url)}get jv(){return this.oxf}lah(){const a={},d=this.jv;a.a=this.dfh;a.b=d.initiatorType;a.c=this.round(d.redirectStart);a.d=this.round(d.redirectEnd);a.e=this.round(d.fetchStart);a.f=this.round(d.domainLookupStart);
a.g=this.round(d.domainLookupEnd);a.h=this.round(d.connectStart);a.i=this.round(d.connectEnd);a.j=void 0!==d.secureConnectionStart&&null!==d.secureConnectionStart?this.round(d.secureConnectionStart):0;a.k=this.round(d.requestStart);a.l=this.round(d.responseStart);a.m=this.round(d.responseEnd);a.o=this.round(Kg.DGc(d,"decodedBodySize"));a.p=this.round(Kg.DGc(d,"encodedBodySize"));a.q=this.round(Kg.DGc(d,"transferSize"));a.n=this.$Tf;return a}round(a){return Math.round(1E3*a)/1E3}static DGc(a,d){return a[d]}}
Object(t.a)(Kg,"ResourceTimingEntry",null,[780]);class sk{constructor(a,d=null,n=100){this.noh=a;this.cfe=d;this.iqc={};this.B4j=n}VGn(a){var d=a.name.toLowerCase();const n=Vc.a.rGc(d);this.zbn(n,d)&&(n in this.iqc?k.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",n):(d={},d.fetchstart=a.fetchStart,d.responseend=a.responseEnd,d.iscached=this.Kgm(a),d.encodedsize=Kg.DGc(a,"encodedBodySize"),d.decodedsize=Kg.DGc(a,"decodedBodySize"),this.iqc[n]=d))}zbn(a,
d){if(this.noh)return Array.contains(this.noh,a);if(this.cfe)for(a=Vc.a.JN(d),d=0;d<this.cfe.length;d++)if(this.cfe[d]&&a.endsWith(this.cfe[d]))return!0;return!1}Kgm(a){try{const d=Kg.DGc(a,"transferSize");if(d)return!d;k.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return a.responseEnd-a.fetchStart<this.B4j}catch(d){k.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",
d.message)}return!1}e1m(){if(ta.a.le(this.iqc))k.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var a=l.AFrameworkApplication.cH?l.AFrameworkApplication.cH.split(";"):[],d=Object.assign(new Pa.a,{extendedProperties:this.vzl()});d.extendedProperties.set("Flights",x.c(a));this.D0i(d,this.iqc,ja.Health.instance)}}vzl(){try{return new Map}catch(a){return null}}D0i(a,d,n){if(d){var z=0,O=0,ca=0,Da=0,Xa=0,zb=0,Vb=0,Fc=0,Yc=0,yd=0,je=0;for(let Ve in d){var Le=
d[Ve];try{const gg=Object(qa.a)(Object,Le);if(!gg)continue;const Lh=gg.iscached?Boolean.parse(gg.iscached.toString()):!1,Ki=gg.fetchstart?this.parseFloat(gg.fetchstart.toString()):0,Ak=(gg.responseend?this.parseFloat(gg.responseend.toString()):0)-Ki,Uk=gg.encodedsize?this.parseFloat(gg.encodedsize.toString()):0,Rl=gg.decodedsize?this.parseFloat(gg.decodedsize.toString()):0;z+=Ak;Da+=Uk;Vb+=Rl;yd++;Lh?(ca+=Ak,zb+=Uk,Yc+=Rl,je++):(O+=Ak,Xa+=Uk,Fc+=Rl)}catch(gg){k.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",
gg.message)}}a.extendedProperties.set("StaticResources",x.c(d));a.extendedProperties.set("TotalResourceDownloadLatency",z.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",O.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",ca.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",Da.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Xa.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",
zb.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Vb.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Fc.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Yc.toString());a.extendedProperties.set("TotalNumberOfResourcesDownloaded",yd.toString());a.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",je.toString());n.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",
null);n.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",a)}}parseFloat(a){if(!a)return 0;a=parseFloat(a);return isNaN(a)?0:a}}Object(t.a)(sk,"AppStaticResourceManager",null,[]);class fh extends Sys.EventArgs{constructor(a){super();this.entries=a}}Object(t.a)(fh,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class Hf{constructor(a,d,n=null,z=null,O=100){this.Lkf=!1;this.Kj=null;this.YZc=0;this.ka=new oc.a;this.pqc=null;this.i6=!1;this.gQh=0;this.fb=a;this.fth=0;this.cfh=this;this.qdf=new Hh(n);
this.GG=d;z&&(this.pqc=new sk(null,z,O))}get Z1h(){try{return!(void 0===this.GG||null===this.GG)&&!(void 0===this.GG.getEntriesByType||null===this.GG.getEntriesByType)}catch(a){return k.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",a),!1}}get k7k(){return this.fth}get isActive(){return this.i6}get aah(){return this.gQh}NVh(a){this.ka.addHandler(Hf.B_f,a)}ooj(a){this.ka.removeHandler(Hf.B_f,a)}Hb(a,d){const n=this.aah!==a;this.gQh=
a;this.isActive&&this.fb&&n&&(this.ie(),this.rb());this.fth=d}tfd(){!this.isActive&&this.Z1h&&(this.rb(),this.i6=!0)}deactivate(a){this.isActive&&(this.ie(),a&&this.flush(),this.i6=!1)}flush(){if(this.isActive&&this.Z1h)try{var a=window.performance.getEntriesByType("resource");0<a.length-this.YZc&&k.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",a.length-this.YZc);const d=!(void 0===window.performance.clearResourceTimings||
null===window.performance.clearResourceTimings);d&&(window.performance.clearResourceTimings(),this.YZc=0);const n=[];for(let z=this.YZc;z<a.length;z++)this.qdf.OQi(a[z].name)&&(this.pqc&&this.pqc.VGn(a[z]),n.push(new Kg(a[z],this.k7k)));d||(this.YZc=a.length);this.ka.raiseEvent(Hf.B_f,new fh(n));for(a=0;a<n.length;a++)0!==n[a].behavior&&2!==n[a].behavior||this.cfh.YIb(0,n[a].lah());0<n.length&&k.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",
n.length)}catch(d){k.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",d)}}YIb(a,d){k.ULS.sendTraceTag(4310804,306,50,uh(a,d))}dkj(){this.pqc.e1m()}rb(){this.fb&&0<this.aah&&(this.Kj=new bf.a(3,2,1E3*this.aah,()=>{this.flush()},5),this.fb.rb(this.Kj),this.Lkf=!0)}ie(){this.Lkf&&(this.fb.ie(this.Kj),this.Kj=null,this.Lkf=!1)}}Hf.B_f="EntriesAvailable";Object(t.a)(Hf,"ResourceTimingLogger",null,[711,764]);class ui{constructor(){this.Z=null}get name(){return"Common.ResourceTiming"}init(){this.Z.resolve("Common.NetworkTiming.IResourceTimingLogger");
ak.instance.run()}dispose(){}Hb(a){this.Z=a;let d=null;if(l.AFrameworkApplication.K.ea("ResourceLoggerFilterDomainsIsEnabled"))try{d=l.AFrameworkApplication.K.kx("ResourceLoggerDomainAllowList")}catch(O){k.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const n=[];n.push(Vc.a.JN(Xi.a.XK).toLowerCase());n.push(Vc.a.JN(Xi.a.$8a).toLowerCase());const z=l.AFrameworkApplication.K.jb("AppStaticResourceMonitorCacheThresholdInMs",100);a.register(711,"Common.NetworkTiming.IResourceTimingLogger").singleInstance().zd(()=>
new Hf(l.AFrameworkApplication.tb,window.performance,d,n,z))}static main(){M.a.instance.Sb(new ui)}}Object(t.a)(ui,"ResourceTimingPackage",null,[1,2]);var Nf=b(245);class Mk{constructor(){this.p8e={}}jtk(a){this.p8e[a.id.toString()]=a}uAm(a){const d=this.p8e;for(let n in d)d[n].notify(a,!1);this.p8e={}}qXm(a,d){d&&this.jtk(d);return this.raj(a,d)}fZf(a){this.uAm(a)}Kji(a,d){a.notify(d,!0)}}Object(t.a)(Mk,"AEventEmitter",null,[517]);var Nj;(function(a){a[a.notStarted=0]="notStarted";a[a.waiting=1]=
"waiting";a[a.shouldRetry=2]="shouldRetry";a[a.complete=3]="complete"})(Nj||(Nj={}));Object(t.b)("EventResultState",Nj);class nj{constructor(){this._state=0}get state(){return this._state}set state(a){k.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:Nj[this._state],["NewState"]:Nj[a]},"ResultType",this.hDi());this._state=a}}Object(t.a)(nj,"AEventResult",null,[515]);class $k extends nj{constructor(){super();this.Uvf=this.r$c=null;this.state=0;this.zif=this.jAh=!1}get Mna(){return this.r$c}get iub(){return this.Uvf}get H6l(){return this.jAh}hDi(){return"GetMoreInfo Result"}}
Object(t.a)($k,"GetMoreInfoResult",nj,[767,515]);var ql=b(1387),Oj=b(1366),wm=b(923);class rl{constructor(a,d,n,z,O,ca,Da,Xa){this.ga=a;this.nf=d;this.gh=n;this.Zua=z;this.fb=O;this.PD=ca;this.uak=Da;this.y0b=Xa}i2m(){this.TMc.ma(Sa.a.$gc,Cd.a.frame,Object(m.a)(this,this.$gc,"openUrlInNewTab"));this.TMc.ma(Sa.a.tPe,Cd.a.frame,Object(m.a)(this,this.tPe,"openDocumentUrl"));l.AFrameworkApplication.aS?this.J0i():this.TMc.Aa(Sa.a.qDc,Cd.a.frame,Object(m.a)(this,this.qDc,"documentLoaded"),96)}$gc(a,d,n,
z,O){O&&O.MenuItemId&&(k.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:O.SourceControlId,["AppType"]:wm.a[this.Y6a]}),Ye.a.Tk(O.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}tPe(a,d,n,z,O){if(O&&O.MenuItemId){const ca=l.AFrameworkApplication.K.ea("WacInTabOpenMRUIsEnabledForUiHost"),Da=l.AFrameworkApplication.K.ea("UiHostSupportsDocRebootFeatures");k.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",
ca,Da);if(ca&&Da){k.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:O.SourceControlId,["AppType"]:wm.a[this.Y6a]});a=O.MenuItemId.toString();const Xa={};Xa[G.a.CLb]="1";Xa[G.a.documentUrl]=a;Xa[G.a.reason]=Oj.a.open;k.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");l.AFrameworkApplication.jH().execute(zb=>{zb.Eh(D.a.Mjb,Xa)})}else this.$gc(a,d,n,z,O)}return 32}qDc(){this.J0i();return 32}Gec(a,d,n=""){if(d&&d.px){const z=ql.a[d.status];d=d.px.getTime();
const O=this.du()-d;k.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:a,["RequestStatus"]:z,["ElapsedMs"]:O,["StartTime"]:d,["Notes"]:n})}else k.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:a})}J0i(){var a=l.AFrameworkApplication.K.ea("QPGVCI"),d=Vc.a.UL(document.URL,"wdNewAndOpenCt",a);if(d){d=parseInt(d);var n=Vc.a.UL(document.URL,"wdPreviousSession",a);a=Vc.a.UL(document.URL,"wdPreviousCorrelation",
a);var z=l.AFrameworkApplication.K.ea("NAOPLP");if(l.AFrameworkApplication.aS){var O=l.AFrameworkApplication.aS.getTime();!d||d>O?k.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:d,["DocumentLoadedTime"]:O,["SessionId"]:n,["Correlation"]:a}):k.ULS.sendTraceTag(5849683,202,z?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:O-d,["ClickTimestamp"]:d,["SessionId"]:n,["Correlation"]:a})}else k.ULS.sendTraceTag(5849681,
202,z?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:d,["SessionId"]:n,["Correlation"]:a})}}get TMc(){return this.ga.value}get RId(){return this.nf.value}get e6i(){return this.gh.value}get Y6a(){return this.Zua.value}get gMe(){return this.fb.value}get du(){return this.PD}get rWa(){return this.uak.value}get y9a(){return this.y0b.value}static get instance(){return rl.na||(rl.na=rl.Ao())}static Ao(){return new rl(new Nf.a(()=>
l.AFrameworkApplication.pa),new Nf.a(()=>l.AFrameworkApplication.Gd),new Nf.a(()=>l.AFrameworkApplication.la),new Nf.a(()=>l.AFrameworkApplication.la.eb.Bm),new Nf.a(()=>l.AFrameworkApplication.tb),()=>(new Date).getTime(),new Nf.a(()=>l.AFrameworkApplication.la.eb.rWa),new Nf.a(()=>l.AFrameworkApplication.y9a))}}rl.na=null;Object(t.a)(rl,"NewAndOpenCommonHelpers",null,[510]);class Hl{constructor(a,d,n){this.cee=this.Kj=null;this.Usf=0;this.Emk=a;this.fb=d;this.zth=n}OAk(){this.Usf=this.eRc+1}PWg(a){this.Kj&&
(this.fb.ie(this.Kj),this.Kj=null);a&&(this.Usf=0)}jzn(a){const d=this.jEn;0<=d?(this.OAk(),this.PWg(!1),this.Kj=new bf.a(4,1,d,a,107),this.fb.rb(this.Kj)):(this.PWg(!0),k.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.zth}))}get eRc(){return this.Usf}get jEn(){return this.eRc>=this.yvj.length?-1:this.yvj[this.eRc]}get yvj(){if(!this.cee){const a=(this.Emk.value||"0").split(",");this.cee=[];for(let d=0;d<a.length;d++){const n=parseInt(a[d]);isNaN(n)?k.ULS.sendTraceTag(5849677,
202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.zth,["Entry"]:a[d]}):Array.add(this.cee,n)}}return this.cee}}Object(t.a)(Hl,"RetryHelper",null,[]);class vi extends Mk{constructor(a,d){super();this.FOa=a;this.Uad=new Hl(d,this.qId.gMe,"GetMoreInfo");this.Vo=new $k}btm(){this.Tyg("Document opened")}g2k(a){return()=>{this.Tyg(a,!0)}}raj(a,d=null){k.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:a});3===this.Vo.state?(d&&this.Kji(d,
this.Vo),k.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:a})):this.Tyg(a);return this.Vo}Tyg(a,d=!1){this.Uad.PWg(!d);1===this.Vo.state?k.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:a,["RetryIndex"]:this.Uad.eRc}):(k.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:a,["RetryIndex"]:this.Uad.eRc}),this.Vo.state=1,d=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.qId.rWa,
l.AFrameworkApplication.Fk),this.qId.RId.MBb(d,1,null,null,[vi.LJh,vi.SOh],!1,5,this.i1k(),this.h1k(a),null))}i1k(){return a=>{var d=!1;let n=!1;var z=!1,O;l.AFrameworkApplication.K.ea("GetMoreInfoDataFromResponseBody")&&(a.data.Rd?({at:O}=x.d(a.data.Rd)).returnValue?O?(z=!0,this.Vo.Uvf=O.StorageServiceDisplayName,this.Vo.r$c=vi.LVi(O.PersonalFileStorageUrl)?O.PersonalFileStorageUrl:"",""===this.Vo.Mna&&"SharePointOnlineConsumer"===l.AFrameworkApplication.K.Ga("FileSource")&&(this.Vo.r$c=Vc.a.A8(l.AFrameworkApplication.breadcrumbFolderUrl)),
d=""===this.Vo.Mna&&""!==this.Vo.iub):k.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):k.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):k.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));z||((O=a.data.Ri)?(this.Vo.Uvf=
(O[vi.SOh]||"").toString(),d=(O[vi.LJh]||"").toString(),this.Vo.r$c=vi.LVi(d)?d:"",""===this.Vo.Mna&&"SharePointOnlineConsumer"===l.AFrameworkApplication.K.Ga("FileSource")?(this.Vo.r$c=Vc.a.A8(l.AFrameworkApplication.breadcrumbFolderUrl),d=""===this.Vo.Mna&&""!==this.Vo.iub):d=""===d&&""!==this.Vo.iub):(k.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),n=!0));z=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.Uad.eRc,n,d,z);this.qId.Gec("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",a.data,z);this.Mvj(3,d,n)}}h1k(a){return d=>{this.qId.Gec("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",d.data,"Failure");this.Mvj(2);this.Uad.jzn(this.g2k(a))}}Mvj(a,d=!1,n=!1){this.Vo.state=a;this.Vo.jAh=d;this.Vo.zif=n;this.fZf(this.Vo)}get qId(){return this.FOa.value}static get instance(){return vi.na||(vi.na=vi.Ao())}static Ao(){return new vi(new Nf.a(()=>rl.instance),new Nf.a(()=>l.AFrameworkApplication.nAi))}static LVi(a){if(!a)return k.ULS.sendTraceTag(5849624,
202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(w.a.He(a).startsWith("https://"))return!0;k.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}vi.LJh="PersonalFileStorageUrl";vi.SOh="StorageServiceDisplayName";vi.na=null;Object(t.a)(vi,"GetMoreInfoActor",Mk,[]);class Pj{constructor(a,d,n,z,O){this.ybk=6E4;this.cMi="inactive";this.jTh="active";this.i6=!0;this.fb=a;this.E$j=d;this.PD=n;this.Y0b=z;this.ka=new oc.a;O&&this.azn();this.aDh=this.vzi()}FAf(a){this.ka.addHandler(this.jTh,
a)}Ivk(a){this.ka.addHandler(this.cMi,a)}azn(){const a=new bf.a(5,2,this.ybk,Object(m.a)(this,this.v1l,"inactiveLoop"),108);this.w1l.rb(a)}v1l(){const a=this.vzi(),d=this.du()-a;d>this.zYd&&this.i6&&(k.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:d}),this.i6=!1,this.ka.raiseEvent(this.cMi));a-this.aDh>this.zYd&&(this.i6=!0,this.ka.raiseEvent(this.jTh));this.aDh=a}get w1l(){return this.fb.value}get vzi(){return this.E$j}get du(){return this.PD}get zYd(){return this.Y0b.value}static get instance(){return Pj.na||
(Pj.na=Pj.Ao())}static Ao(){return new Pj(new Nf.a(()=>th.a.instance),()=>l.AFrameworkApplication.DLc.getTime(),()=>(new Date).getTime(),new Nf.a(()=>l.AFrameworkApplication.zYd),!0)}}Pj.na=null;Object(t.a)(Pj,"InactivityManager",null,[]);var kl=b(1510);class ag extends nj{constructor(){super();this.hgk=this.lGh=this.kGh=null;this.state=this.iQh=0;this.zif=!1}get lBg(){return this.kGh}get D5i(){return this.lGh}get nEn(){return this.iQh}hDi(){return"MruActor Result"}}Object(t.a)(ag,"MruResult",nj,
[514,515]);class bo{constructor(a,d,n){this.task=null;this.Sac=a;this.Czg=d;this.taskManager=n;this.retryCount=this.WAd=0;this.trf=this.DFd=null}Odm(a,d){return a===Ma.a.blb||20===d||18===d||3===d}Mem(a){return 3===a||5===a||6===a||7===a||9===a||10===a||11===a||12===a||13===a||14===a||15===a||16===a||23===a||26===a||27===a||28===a}get KRe(){return this.trf}reset(){this.WAd=this.retryCount=0;this.trf=this.DFd=null;this.task&&(this.taskManager.ie(this.task),this.task=null)}B4l(a,d,n,z){this.trf=String.format("{0}_{1}",
n,z);if(this.retryCount>=this.Czg)return k.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.Odm(n,z))return k.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.Mem(z)&&1<=this.WAd)return this.DFd=n,!1;d=Math.max(d,this.Sac*Math.pow(2,this.WAd));if(26===z)d=Math.max(d,3E4);else if(27===z||28===z)d=Math.max(d,6E4);9===z||412===n&&(null==this.DFd||412!==this.DFd)?d=500:this.WAd+=1;this.DFd=n;this.retryCount+=1;this.task&&this.taskManager.ie(this.task);
k.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",d);this.task=new bf.a(2,1,d,a,107);this.taskManager.rb(this.task);return!0}}Object(t.a)(bo,"RetryManager",null,[]);var xh=b(170);class Xl{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(t.a)(Xl,"WriteOptions",null,[]);var Ih=b(551);class Aj extends Mk{constructor(a,d,n,z,O,ca,Da){super();this.FOa=a;this.ffk=d;this.uAb=new bo(l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.K0.gMe);this.yBb=new bo(l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.K0.gMe);this.Ckk=n;this.xSh=z;this.rsk={};this.rwa=new ag;this.b$j=O;this.kae="";this.UQ=ca;this.dvh=Da;this.dsf="";this.Ikk=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",
25)}get q5e(){return this.rsk}X4m(){this.K0.TMc.ma(Sa.a.hVg,Cd.a.frame,Object(m.a)(this,this.z8m,"renameMruEntry"))}z8m(){return this.Xhh("Rename")}otm(){this.O2i("File Opened")}ptm(){this.O2i("IntervalUpdate")}O2i(a){k.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:a});this.Xhh(a)}yTa(a){(a=w.a.yTa(a))&&a.startsWith(".")&&(a=a.substring(1,a.length));return a}eti(){switch(this.K0.Y6a){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";
case 4:return"OneNote";default:return"Unknown"}}WSl(a){var d=this.b$j();if(!d)return null;const n=new Xl;n.documentUrl=this.dvh.value?encodeURI(d):d;n.mruItemId=this.kae;n.app=this.eti();if(d=this.UQ())n.folderName=d.breadcrumbFolderName,d=d.EB,n.documentName=w.a.HN(d),n.documentExt=this.yTa(d);a&&(n.documentName?n.documentName.length?255<=n.documentName.length?a.set("DocumentNameLength","Long"):2084<=n.documentName.length&&a.set("DocumentNameLength","VeryLong"):a.set("DocumentNameLength","0"):a.set("DocumentNameLength",
"Null"));return JSON.stringify(n)}Xhh(a,d=!1){if(4===this.K0.Y6a&&!l.AFrameworkApplication.V6b)return 2;var n=this.SG();n&&(n.set("Trigger",a),n.set("IsRetry",d?"true":"false"),n.set("MruIdSent",this.kae?"true":"false"),n.set("URLEncoded",this.dvh.value?"true":"false"));ja.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",n);a=this.WSl(n);if(!a)return d=!l.AFrameworkApplication.NLa,n&&(n.set("WebEditingIsEnabled",l.AFrameworkApplication.NLa?"true":"false"),n.set("ProtectedFile",l.AFrameworkApplication.protectFile?
"true":"false")),ja.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",d,!1,Object.assign(new Pa.a,{extendedProperties:n})),2;this.yBb&&!d&&this.yBb.reset();n=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.K0.rWa,this.Cwg);this.xSh?this.q5e["X-FileId"]=l.AFrameworkApplication.Fk:n+=String.format("&{0}",l.AFrameworkApplication.Fk);l.AFrameworkApplication.sessionStartInfoSettings&&(this.q5e["X-Office-AudienceGroup"]=Object(qa.a)(String,l.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||
"");this.q5e["X-Timeout"]=15E3;return this.K0.RId.Ni(n,2,a,this.q5e,!0,5,Object(m.a)(this,this.qTn,"writeMruV2EntryOnServerSuccessCallback"),Object(m.a)(this,this.t5k,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}qTn(a){this.oIi(a.data)}oIi(a){const d=this.SG();this.yBb&&(d&&this.yBb.KRe&&(d.set("LastError",this.yBb.KRe),d.set("NumRetries",this.yBb.retryCount.toString())),this.yBb.reset());const n=kl.c(a.Rd);n&&n.diagnostics_data&&(this.kae=n.diagnostics_data.mru_id);
a=+a.hE-+a.px;d&&d.set("RequestDuration",a.toString());ja.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Pa.a,{extendedProperties:d}))}t5k(a){if(a.data.Ge===Ma.a.jCc)this.oIi(a.data);else{var d=a.data.Ge===Ma.a.u8,n=this.SG();this.wIi(this.yBb,a,this.f5k(),n);n&&(n.set("StatusCode",a.data.Ge.toString()),d||this.TAf(a.data,n));ja.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",a.data.Ge),d,!1,Object.assign(new Pa.a,{extendedProperties:n}))}}f5k(){return()=>
{this.Xhh("Retry",!0)}}BGl(){this.kMc("Polling")}AGl(){this.kMc("Retry",!0)}etm(){this.kMc("Open")}dtm(){this.kMc("Activity")}ctm(){this.kMc("OpenRecentLinks",!1,!0)}I2i(){this.kMc("ActivityRecentLinks",!1,!0)}kMc(a,d=!1,n=!1){k.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:a});const z=this.SG();z&&(z.set("Trigger",a),z.set("IsRetry",d?"true":"false"));ja.Health.instance.recordKpiUsage("GetMru",0,"smartfio",z);this.uAb&&!d&&this.uAb.reset();n?this.gci(Object(m.a)(this,this.CGl,
"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(m.a)(this,this.xGl,"getMruForRecentLinksFromServerFailureCallback"),!0):this.gci(Object(m.a)(this,this.DGl,"getMruV2FromServerSuccessCallback"),Object(m.a)(this,this.zGl,"getMruFromServerFailureCallback"))}TAf(a,d){a&&a.Ri&&(a=a.Ri["X-CorrelationId"])&&d.set("ServerCorrelationId",a)}SG(){try{return new Map}catch(a){return null}}znm(a,d){a&&(d&&d.set("RequestDuration",(+a.hE-+a.px).toString()),ja.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Pa.a,
{extendedProperties:d})))}DGl(a){this.rAi(a)}rAi(a,d=!1){var n="";let z=null,O=null,ca=null;const Da=kl.c(a.data.Rd);Da&&(z=Da.places?Da.places.items:[],O=Da.documents?Da.documents.items:[],(ca=kl.a(Da,d))&&(n=x.c(ca)));l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.xVa&&xh.c()&&(d?this.dsf=n:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(n,!0)));n=this.SG();this.uAb&&(n&&this.uAb.KRe&&(n.set("LastError",this.uAb.KRe),n.set("NumRetries",this.uAb.retryCount.toString())),this.uAb.reset());
d&&n&&n.set("RecentLinks","true");ca||z||O?(this.K0.Gec("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Success"),this.E3e(3,ca,z,O),this.znm(a.data,n)):(this.K0.Gec("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Failure: Invalid JSON"),n&&this.TAf(a.data,n),ja.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Pa.a,{extendedProperties:n})),this.E3e(3,null,null,null,!0));this.fZf(this.rwa)}CGl(a){this.rAi(a,!0)}wIi(a,d,n,z){let O=0,ca=0;const Da=kl.c(d.data.Rd);
Da&&(null!=Da.response_code&&(O=Da.response_code,z&&z.set("MruResponseCode",O.toString()),9===O&&(this.kae="")),Da.error_data&&null!=Da.error_data.retry_after_ms&&(ca=Da.error_data.retry_after_ms,z&&z.set("ExpectedRetryAfter",ca.toString())));a&&(d=a.B4l(n,ca,d.data.Ge,O),z&&(z.set("CurrentRetryCount",a.retryCount.toString()),z.set("RetryScheduled",d?"true":"false")))}zGl(a){this.qAi(a)}qAi(a){const d=a.data.Ge===Ma.a.u8,n=this.SG();n&&(n.set("StatusCode",a.data.Ge.toString()),d||this.TAf(a.data,
n));this.K0.Gec("MruActor.GetMruFromServerFailureCallback",a.data,"Failure");this.E3e(2);this.wIi(this.uAb,a,Object(m.a)(this,this.AGl,"getMruFromServerRetryTask"),n);ja.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",a.data.Ge),d,!1,Object.assign(new Pa.a,{extendedProperties:n}));this.fZf(this.rwa);l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.xVa&&xh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))}xGl(a){this.qAi(a)}E3e(a,d=null,n=null,z=null,O=!1){if(3!==this.rwa.state||3===a)this.rwa.kGh=d,this.rwa.lGh=n,this.rwa.hgk=z,this.rwa.state=a,this.rwa.zif=O,this.rwa.iQh=this.K0.du()}raj(a,d){k.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:a,["ResultState"]:this.rwa.state});d&&3===this.rwa.state&&this.Kji(d,this.rwa);return this.rwa}gci(a,d,n=!1){this.E3e(1);let z;const O={};z=n?String.format(this.K0.rWa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",
this.Ikk,"OfficeSuite",this.Cwg,"ClassicMru"):String.format(this.K0.rWa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.eti(),this.Cwg);this.Ckk.value||(z+="&entity=docs");l.AFrameworkApplication.sessionStartInfoSettings&&(O["X-Office-AudienceGroup"]=Object(qa.a)(String,l.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");n&&(O["X-Office-Application"]="147");this.xSh?O["X-FileId"]=l.AFrameworkApplication.Fk:z+=String.format("&{0}",l.AFrameworkApplication.Fk);
this.K0.RId.Ni(z,1,null,O,!0,5,a,d,null)}get K0(){return this.FOa.value}get Cwg(){return this.ffk.value}static get instance(){return Aj.na||(Aj.na=Aj.Ao())}static Ao(){return new Aj(new Nf.a(()=>rl.instance),new Nf.a(()=>Ih.a.yf(l.AFrameworkApplication.lcid).name),new Nf.a(()=>l.AFrameworkApplication.la.eb.wz),l.AFrameworkApplication.K.ea("MruWriteFileIdInHeader"),()=>l.AFrameworkApplication.la.eb.vN,()=>l.AFrameworkApplication.Bs,new Nf.a(()=>l.AFrameworkApplication.K.ea("OICEncodeUrlIsEnabled")))}}
Aj.na=null;Object(t.a)(Aj,"MruActor",Mk,[]);class Be{constructor(){this.qed=this.RKh=this.Z=null;this.gf=!1}get name(){return"Common.App.NewAndOpen.Core"}Hb(a){this.Z=a;a.register(510,"Common.INewAndOpenCommonHelpers").singleInstance().zd(()=>rl.instance);a.register(517,"Common.IEventEmitter<Common.IGetMoreInfoResult>").singleInstance().zd(()=>vi.instance);a.register(517,"Common.IEventEmitter<Common.IMruResult>").singleInstance().zd(()=>Aj.instance)}init(){l.AFrameworkApplication.K.wq(()=>{this.Pac()})}Pac(){this.Z.resolve("Common.INewAndOpenCommonHelpers");
this.Z.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.Z.resolve("Common.IEventEmitter<Common.IMruResult>");var a=!1;rl.instance.i2m();l.AFrameworkApplication.LJa&&(a=!0);l.AFrameworkApplication.FTe&&(Aj.instance.etm(),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&Aj.instance.ctm(),0<l.AFrameworkApplication.mBg&&this.vUh(),this.kqn(),a=!0);l.AFrameworkApplication.y9a&&a&&vi.instance.btm();l.AFrameworkApplication.mPj&&(a=Aj.instance,
a.X4m(),a.otm(),th.a.instance.rb(this.RNn))}kqn(){Pj.instance.FAf(Object(m.a)(Aj.instance,Aj.instance.dtm,"makeGetMruRequestActivityTrigger"));l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&Pj.instance.FAf(Object(m.a)(Aj.instance,Aj.instance.I2i,"makeGetMruForRecentLinksRequestActivityTrigger"));Pj.instance.FAf(Object(m.a)(this,this.vUh,"addGetMruFromServerTask"));Pj.instance.Ivk(Object(m.a)(this,this.H8k,"deleteGetMruFromServerTask"))}H8k(){th.a.instance.ie(this.E5i)}vUh(){th.a.instance.rb(this.E5i)}get E5i(){return this.RKh||
(this.RKh=new bf.a(5,2,l.AFrameworkApplication.mBg,Object(m.a)(Aj.instance,Aj.instance.BGl,"getMruFromServerTask"),109))}get RNn(){return this.qed||(this.qed=new bf.a(2,2,6E4*l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(m.a)(Aj.instance,Aj.instance.ptm,"makeUpdateMruTask"),197))}dispose(){this.gf||(this.gf=!0,this.qed&&(th.a.instance.ie(this.qed),this.qed=null))}}Object(t.a)(Be,"CorePackageManager",null,[1,2,12]);var Sd=b(1361),
Rd=b(102);class ng{static Nel(a){return ng.G2h("New",a)}static Oel(a){return ng.G2h("Open",a)}static n2h(a,d){return ng.Thb("LoadingMenuSection",ng.Wlm,a,ng.ijd("lblLoading",d))}static kjd(a,d,n=null,z=null){return ng.Thb("MessageMenuSection",ng.C5i,d,ng.ijd("lblMessage",a,n,z))}static QJk(a){return ng.n2h(a,CommonUIStrings.l_VoicedLoadingText)}static RJk(a,d){return ng.kjd(CommonUIStrings.l_NewCreationLocationMessage,a.labelText,d.Mna,d.iub)}static PJk(a,d){return ng.kjd(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,
d.iub,"\n\n"),a.labelText)}static q2h(a){return ng.kjd(CommonUIStrings.l_NewGenericErrorMessage,a.labelText)}static NJk(a,d,n){return ng.Thb("menuNewBlank",ng.MZl,n?a.labelText:null,ng.ajd(a.RJi,a.SJi,a.TJi,null,a.onb,a.jzd,d,"blank"))}static WKk(){return ng.ijd("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static B2h(){return ng.ijd("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static XKk(a,d){return ng.Thb("menuNewTemplates",a,null,d)}static LJk(a,d){return ng.Thb("menuNewMoreTemplates",
ng.oqi,null,ng.ajd("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,a,d))}static xIk(a,d,n){let z="";n&&d&&(z=ng.Thb("BrowseMoreMenuSection",ng.oqi,null,ng.ajd("btnBrowseMore",d,d,null,null,null,a||"1959943459",n)));return z}static ijd(a,d,n=null,z=null){let O=z;d&&0<d.length&&(O=ng.l6i.hKa(d).trimEnd(),O=0<=O.indexOf("{0}")?String.format(O,z):String.format("{0} {1}",O,z));n=n&&z?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',
w.a.Vd(n),w.a.Vd(z),w.a.Vd(O)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',w.a.Vd(a||""),ng.l6i.hKa(w.a.Vd(d||"")),n)}static ajd(a,d,n,z,O,ca,Da,Xa){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',w.a.Vd(a||""),w.a.Vd(d||""),w.a.Vd(n||
""),z||"32by32",w.a.Vd(O||""),w.a.Vd(ca||""),Da,w.a.Vd(Xa||""))}static G2h(a,d){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',a,d)}static Thb(a,d,n,z){n=n?String.format('Title="{0}"',w.a.Vd(n)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',w.a.Vd(a||""),w.a.Vd(d||""),
n,z)}}ng.C5i="MenuMru";ng.Wlm="MenuLoading";ng.MZl="MenuHeader";ng.oqi="MenuFooter";ng.l6i=Rd.a.zn("\n","&#10;");Object(t.a)(ng,"NewAndOpenXmlUtilities",null,[]);class Al{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(t.a)(Al,"HostInformation",null,[]);class sl{constructor(a,d,n,z,O,ca){this.Qwf=this.Ty=this.F3d=null;this.Jee=this.Suf=!1;this.DFh=0;this.zuf=this.ekf=!1;this.FOa=a;this.s1c=d;this.kcb=new Nf.a(()=>new Sd.a(n.value,Object(m.a)(this,this.H9b,"getMoreInfoEventReceived")));
this.fgk=z;this.GOa=O;this.Jnk=ca;this.pcd=this.aZe;2===this.Uga.Y6a&&(this.zuf=!0)}get Ska(){switch(this.Uga.Y6a){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}lb(){const a=this.Uga.TMc;a.ma(Sa.a.newDocument,Cd.a.frame,Object(m.a)(this,this.newDocument,"newDocument"));a.Aa(Sa.a.GMd,Cd.a.frame,Object(m.a)(this,this.GMd,"populateNewMenu"),96)}newDocument(a,d,n,z,O){return 1===n?32:2===n&&O&&O.MenuItemId&&O.SourceControlId?this.UBc(O.MenuItemId,
O.SourceControlId):8}UBc(a,d){var n=this.lMe.Hci;if(null===n)return 8;var z=l.AFrameworkApplication.K.ea("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(l.AFrameworkApplication.qpb&&z){k.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const O={};O[G.a.template]=a;O[G.a.Ska]=this.Ska;O[G.a.lcid]=l.AFrameworkApplication.lcid.toString();O[G.a.reason]=Oj.a.knd;l.AFrameworkApplication.jH().execute(ca=>{ca.Eh(D.a.UBc,O)})}else z=(new Date).getTime(),
d=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",n,w.a.Xh(this.LJa),w.a.Xh(a),w.a.Xh(this.Ska),w.a.Xh(l.AFrameworkApplication.lcid.toString()),w.a.Xh(z.toString()),w.a.Xh(d),w.a.Xh(l.AFrameworkApplication.canary),l.AFrameworkApplication.Fk),(n=l.AFrameworkApplication.K.Ga("ScenarioId"))&&""!==n&&(d+="&wdscenarioid="+w.a.Xh(n)),d+="&"+l.AFrameworkApplication.NGc(),l.AFrameworkApplication.Ima&&(d+="&"+l.AFrameworkApplication.eGc()),
(n=this.Ty?this.Ty.Mna:null)&&(d+="&DestinationUrl="+w.a.Xh(n)),Ye.a.Tk(d,"_blank",void 0,"CreateNewDocument");2===this.Uga.Y6a&&k.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:wm.a[this.Uga.Y6a],["Template"]:a});return 32}jrm(a){let d=Number.MAX_VALUE,n=Number.MIN_VALUE;const z=window.performance;if(z&&"undefined"!==typeof z.getEntriesByName){for(let ca=0;ca<a.length;ca++){var O=z.getEntriesByName(a[ca]);O&&0<O.length&&(O=O[0],d=Math.min(parseInt(String(O.fetchStart)),
d),n=Math.max(parseInt(String(O.responseEnd)),n))}n>d&&k.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:n-d,["MinFetchStart"]:d,["MaxResponseEnd"]:n})}}GMd(a,d,n,z,O){if(1===n)return this.zuf&&(l.AFrameworkApplication.b8("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.zuf=!1),32;2!==n||this.ekf||(this.DFh=(new Date).getTime(),k.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.aZe,
["CachedNewMenuXmlExists"]:!!this.F3d,["ShouldCallGetMoreInfo"]:this.Uga.y9a}));return this.FRm(O)}FRm(a){a&&(this.F3d?a.PopulationXML=this.F3d:(this.Uga.y9a&&!this.Ty&&this.izm.sk("Opened New menu",!0),a.PopulationXML=this.nql(this.getTemplateListJson())));return 32}VTi(){return!this.Uga.y9a||!!this.Ty&&3===this.Ty.state&&!!this.Ty.iub&&!!this.Ty.Mna}oem(){return l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.xVa?!0:this.VTi()}getTemplateListJson(){if(!this.aZe||!this.oem())return null;
if(this.pcd&&!this.Jee){var a="9";const d=l.AFrameworkApplication.K.appSettings;"NumberOfTemplatesInBackstage"in d&&(a=d.NumberOfTemplatesInBackstage);let n=this.Ska;"TemplateCollectionId"in d&&(n=d.TemplateCollectionId);a=String.format(this.Uga.rWa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",w.a.Xh(l.AFrameworkApplication.lcid.toString()),w.a.Xh(n),a);Boolean.parse(d.AppendOriginQueryParam||"false")&&(a+="&org=backstage");a+="&"+l.AFrameworkApplication.NGc();l.AFrameworkApplication.Ima&&
(a+="&"+l.AFrameworkApplication.eGc());this.Uga.RId.Ni(a,1,null,null,!1,2,z=>{this.Uga.Gec("CreateNewActor.GetTemplateListJson",z.data);this.SCn(z.data.Rd)},z=>{this.Uga.Gec("CreateNewActor.GetTemplateListJson",z.data);this.RCn()},null,void 0,void 0,void 0,void 0,"5");this.pcd=!1}return this.Qwf}SCn(a){this.Qwf=a;this.pcd=!1;this.NPd();if(l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.xVa&&xh.c()){a=l.AFrameworkApplication.K.ea("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const d=
l.AFrameworkApplication.qpb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.Qwf,!0,a&&d))}}RCn(){this.Jee=this.pcd=!0;this.NPd();l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.xVa&&xh.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));ja.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}Ycg(a){var d=0;for(var n=0;n<a.length;n++)if("ST"===a[n].ImageType){d=n;break}const z=a.length?
a[d]:null;a=z?z.Url||"":"";var O;let ca=n=d=!1;if(z&&(O=z.AspectRatio))O=parseFloat(O),1>O?d=!0:1.5<O?n=!0:1===O&&(ca=!0);else switch(k.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:a}),this.Uga.Y6a){case 3:d=!0;break;case 2:n=!0;break;case 5:ca=!0}return{returnValue:a,f1l:d?"95by123":n?"123by69":ca?"100by100":"123by95"}}nql(a){a=({PYe:d}=this.OJk(a,this.lMe,this.lMe.qjd||"1056925771")).returnValue;if(d){this.F3d=a;var d=(new Date).getTime()-this.DFh;k.ULS.sendTraceTag(5849604,
202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:d})}return a}H9b(a,d){k.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Ty||3!==a.state?2===a.state&&(k.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.Suf=!0,this.NPd()):(this.Ty=a,d||this.NPd(),l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.xVa&&xh.c()&&xh.d("setFileMenuHostInformation")&&(a=Object.assign(new Al,{hostUrl:this.Ty.Mna,hostName:this.Ty.iub,
folderUrl:l.AFrameworkApplication.breadcrumbFolderUrl,folderName:l.AFrameworkApplication.breadcrumbFolderName}),k.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(a))))}OJk(a,d,n){let z;z=!1;const O=this.VTi();let ca="";this.Uga.y9a&&(this.Suf?(ca=ng.q2h(d),this.Suf=!1,k.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Ty?O?ca=ng.RJk(d,this.Ty):
this.Ty.H6l?(z=!0,this.pcd=!1,ca=ng.PJk(d,this.Ty),k.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(z=!0,ca=ng.q2h(d),k.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Ty.Mna,["StorageServiceDisplayNameIsSet"]:!!this.Ty.iub})):(ca=ng.QJk(d.labelText),k.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));O&&(ca+=ng.NJk(d,
n,!ca)+({PYe:z}=this.VKk(a,n)).returnValue);return{returnValue:ng.Nel(ca),PYe:z}}VKk(a,d){let n;n=!1;if(!this.aZe)return n=!0,k.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",PYe:n};let z="",O="",ca="MenuTemplate";if(this.Jee)z=ng.B2h(),this.Jee=!1,k.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(a){try{const Da=Sys.Serialization.JavaScriptSerializer.deserialize(a,!0);z=this.UKk(Da,d);k.ULS.sendTraceTag(5849612,
202,50,"Rendering File>New with template buttons");l.AFrameworkApplication.fEg&&"OneDrive"===this.LJa&&(O=ng.LJk(this.jzm,l.AFrameworkApplication.fEg))}catch(Da){k.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:a}),z=ng.B2h()}n=!0}else ca="MenuLoading",z=ng.WKk(),k.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:ng.XKk(ca,z)+O,PYe:n}}UKk(a,d){let n="";const z=[];for(let ca=0;ca<a.length;ca++){var O=
a[ca];let Da="";if(O){const Xa=O.Title,zb=O.AssetId;O=O.Thumbnails;zb&&Xa&&O&&({f1l:O,returnValue:Da}=this.Ycg(O),n+=ng.ajd("jbtnNewTemplate"+ca,Xa,null,O,null,Da,d,zb))}z[ca]=Da}a=new bf.a(4,1,5E3,()=>{this.jrm(z)},106);this.Uga.gMe.rb(a);return n}NPd(){this.ekf=!0;this.Uga.e6i.vua(this.lMe.$rd);this.ekf=!1}get Uga(){return this.FOa.value}get lMe(){return this.s1c.value}get izm(){return this.kcb.value}get jzm(){return this.fgk.value}get LJa(){return this.GOa.value}get aZe(){return this.Jnk.value}}
Object(t.a)(sl,"CreateNewActor",null,[]);class Bl{constructor(){this._initialized=!1;this.Yvf={}}getString(a){this.bli();return this.get(a)}contains(a){this.bli();return a.toString()in this.Yvf}bli(){this._initialized||(this.Qwk(),this._initialized=!0)}NBb(a,d){this.Yvf[a.toString()]=d}get(a){return this.Yvf[a.toString()]}}Object(t.a)(Bl,"AIntlHelper",null,[]);class Ai extends Bl{constructor(){super()}Qwk(){this.NBb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.NBb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);
this.NBb(2,CommonUIStrings.l_Open);this.NBb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.NBb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.NBb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return Ai.na||(Ai.na=new Ai)}static gMm(a){return Ai.instance.getString(a)}}Ai.na=null;Object(t.a)(Ai,"MruActorIntlHelper",Bl,[]);var Tf;(function(a){a[a.success=0]="success";a[a.failure=1]="failure";a[a.spinner=2]="spinner";a[a.none=3]="none"})(Tf||(Tf={}));Object(t.b)("DisplayState",Tf);class de{constructor(a,
d,n,z,O,ca,Da,Xa){this.t$e=null;this.kzf=!0;this.E3d="";this.kqk=0;this.ouc=null;this.tlf=3;this.va=Xa;this.FOa=a;this.cGa=d;this.b9j=n;this.f4j=z;this.e4j=O;this.kcb=new Nf.a(()=>new Sd.a(ca.value,null));this.H$j=new Nf.a(()=>new Sd.a(Da.value,Object(m.a)(this,this.rym,"mruEventResultReceived")));this.va.ea("WacInTabOpenMRUIsEnabledForUiHost");this.va.ea("UiHostSupportsDocRebootFeatures")}rym(a,d){this.ouc=a;d||this.ilj()}j4m(){this.K0.TMc.Aa(Sa.a.pRe,Cd.a.frame,Object(m.a)(this,this.pRe,"populateMruMenu"),
96)}pRe(a,d,n,z,O){return 1!==n&&O?this.ERm(O):32}ERm(a){this.mfl();this.lfl();a.PopulationXML=ng.Oel(this.E3d+this.t$e);return 32}mfl(){var a=3;let d=!1;if(this.E3d&&this.kqk===this.ouc.nEn)k.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),a=this.tlf;else{k.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var n=this.K0.du();this.ouc=this.qym.sk("File Open opened",
!0);this.E3d&&2!==this.tlf&&3!==this.ouc.state?d=!0:(a=this.iOl(this.ouc),l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.xVa&&xh.c()&&a&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(a,!0)),this.E3d=({Zym:a}=this.oql(this.ouc)).returnValue);n=this.K0.du()-n;k.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:n})}2!==a&&(n={["DisplayState"]:Tf[a]},1!==a&&(n.IsStale=d),k.ULS.sendTraceTag(5849630,202,
50,"MRU section display state {0}",n));this.tlf=a}iOl(a){let d;try{d=x.c(a.lBg)}catch(n){d=null,k.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",n)}return d}lfl(){this.kzf?(k.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.t$e=({bSn:this.kzf}=this.Zsm()).returnValue):k.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");k.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",
{["WaitingOnLinkInfo"]:this.kzf,["NotDisplayingLink"]:!this.t$e})}oql(a){let d;1===a.state||0===a.state?(k.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),a=2,d=ng.n2h(this.rmb(2),this.rmb(5))):3===a.state&&a.lBg?(d=this.MJk(a.lBg),a=0):(k.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),d=ng.kjd(this.rmb(1),this.rmb(2)),a=1);return{returnValue:d,Zym:a}}MJk(a){let d;const n=this.$Hd.qjd||"2155708348";if(a.length){d=ng.ijd("lblRecentDocuments",
this.rmb(3));let z=0;for(let O=0;O<a.length;O++){const ca=a[O];"FileName"in ca&&"DocumentUrl"in ca&&"Path"in ca&&(d+=ng.ajd("MruButton"+O,ca.FileName.toString(),ca.Path.toString(),null,this.$Hd.onb,this.$Hd.jzd,n,ca.DocumentUrl.toString()),ca.IsPinned&&z++)}d=ng.Thb("RecentDocumentsMenuSection",ng.C5i,this.rmb(2),d);k.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:a.length,["NumPinnedDocuments"]:z})}else d=ng.kjd(this.rmb(0),this.rmb(2)),k.ULS.sendTraceTag(5849664,
202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return d}Zsm(){let a;a=!0;let d=this.dIk;var n=this.cIk;if(d&&n||!this.K0.y9a)a=!1;else{const z=this.rye.sk("File Open",!1);3===z.state&&(d=z.Mna,n=z.iub,a=!1)}n=n?String.format(this.rmb(4),n):null;return{returnValue:ng.xIk(this.$Hd.qjd,n,d),bSn:a}}ilj(){this.K0.e6i.vua(this.$Hd.$rd)}get K0(){return this.FOa.value}get rmb(){return this.cGa.value}get $Hd(){return this.b9j.value}get dIk(){return this.f4j.value}get cIk(){return this.e4j.value}get rye(){return this.kcb.value}get qym(){return this.H$j.value}}
Object(t.a)(de,"MruRenderer",null,[]);var bk=b(1367);class fj{constructor(a,d,n,z,O,ca,Da){this.Ty=null;this.OMh=!1;this.ZEa=this.u9=0;this.rgk=a;this.Luc=d;this.pae=n;this.s1c=z;this.GOa=O;this.FOa=ca;this.kcb=new Nf.a(()=>new Sd.a(Da.value,Object(m.a)(this,this.H9b,"getMoreInfoEventReceived")))}UBc(){!this.Ty&&this.XDg.y9a?this.rye.sk("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}H9b(a){if(!this.Ty&&3===a.state)this.Ty=a;else if(2===a.state){this.OMh?k.ULS.sendTraceTag(24904471,
202,10,"After second try GetMoreResult still fail."):(this.rye.sk("NewDocumentFromStream",!0),this.OMh=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.u9=(new Date).getTime();var a=this.pjl.Hci;if(null===a)this.Luc(null);else{var d=this.pae.menuItemId,n=this.pae.cLa,z=this.pae.pAn,O=this.pae.vjl;this.ZEa="streamBase64"===z?O.length/1024:0;k.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.Ska,this.ZEa);var ca=(new Date).getTime();a=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
a,w.a.Xh(this.LJa),w.a.Xh(d),w.a.Xh(this.Ska),w.a.Xh(l.AFrameworkApplication.lcid.toString()),w.a.Xh(ca.toString()),w.a.Xh(n),w.a.Xh(l.AFrameworkApplication.canary),l.AFrameworkApplication.Fk,w.a.Xh(z));a+="&"+l.AFrameworkApplication.NGc();l.AFrameworkApplication.Ima&&(a+="&"+l.AFrameworkApplication.eGc());(d=this.Ty?this.Ty.Mna:null)&&(a+="&DestinationUrl="+w.a.Xh(d));this.XDg.RId.Ni(a,2,O,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(m.a)(this,this.bzm,"newDocumentFromStreamSuccessHandler"),
Object(m.a)(this,this.azm,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}bzm(a){if(a&&a.data&&a.data.Rd)if(({at:d}=x.d(a.data.Rd)).returnValue)if(a=d,a.StatusCode!==Ma.a.HD&&a.StatusCode!==Ma.a.jCc)k.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.Ska,this.ZEa,a.StatusCode),this.Luc(null);else if(a.NewDocumentUrl&&""!==a.NewDocumentUrl){var d=(new Date).getTime()-this.u9;k.ULS.sendTraceTag(35156359,
202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.Ska,this.ZEa,d);this.rgk(a.NewDocumentUrl)}else k.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.Ska,this.ZEa),this.Luc(null);else k.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.Ska,this.ZEa,{["ResponseData"]:bk.a.oZd(a.data.Rd)}),this.Luc(null);else k.ULS.sendTraceTag(24904473,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.Ska,this.ZEa),this.Luc(null)}azm(a){a&&a.data&&k.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.Ska,this.ZEa,a.data.status);this.Luc(null)}get Ska(){switch(this.XDg.Y6a){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get pjl(){return this.s1c.value}get LJa(){return this.GOa.value}get XDg(){return this.FOa.value}get rye(){return this.kcb.value}}
Object(t.a)(fj,"NewDocumentFromStreamOperation",null,[]);class Pe{constructor(a,d,n,z){this.s1c=a;this.GOa=d;this.FOa=n;this.G$j=z}create(a,d,n){return new fj(a,d,n,this.s1c,this.GOa,this.FOa,this.G$j)}}Object(t.a)(Pe,"NewDocumentFromStreamOperationFactory",null,[745]);var Jh=b(113);class Kj{get name(){return"Common.App.NewAndOpen.UX"}Hb(a){a.register(Pe,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").singleInstance().zd(()=>
new Pe(new Nf.a(()=>l.AFrameworkApplication.la.eb.ixe()),new Nf.a(()=>l.AFrameworkApplication.LJa),new Nf.a(()=>a.sa("Common.INewAndOpenCommonHelpers")),new Nf.a(()=>a.sa("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){l.AFrameworkApplication.K.wq(()=>{this.Pac()})}Pac(){const a=Ph.a.ot(la.a.instance.Ca("Common.INewAndOpenCommonHelpers")),d=Ph.a.ot(la.a.instance.Ca("Common.IEventEmitter<Common.IGetMoreInfoResult>"));l.AFrameworkApplication.LJa&&Jh.Task.WAA.call(null,a,d).continueWith(()=>
{const n=new sl(new Nf.a(()=>a.result),new Nf.a(()=>l.AFrameworkApplication.la.eb.ixe()),new Nf.a(()=>d.result),new Nf.a(()=>l.AFrameworkApplication.la.eb.jxe().qjd||"1959943459"),new Nf.a(()=>l.AFrameworkApplication.LJa),new Nf.a(()=>l.AFrameworkApplication.XSi));n.lb();n.NPd()});if(l.AFrameworkApplication.FTe){const n=Ph.a.ot(la.a.instance.Ca("Common.IEventEmitter<Common.IMruResult>"));Jh.Task.WAA.call(null,a,d,n).continueWith(()=>{const z=new de(new Nf.a(()=>a.result),new Nf.a(()=>Ai.gMm),new Nf.a(()=>
l.AFrameworkApplication.la.eb.jxe()),new Nf.a(()=>l.AFrameworkApplication.Qbj),new Nf.a(()=>l.AFrameworkApplication.Pbj),new Nf.a(()=>d.result),new Nf.a(()=>n.result),l.AFrameworkApplication.K);z.j4m();z.ilj()})}}dispose(){}}Object(t.a)(Kj,"UXPackageManager",null,[1,2,12]);var $g=b(129);class Nk extends $g.StandardDialog{constructor(){super();this.wc=0;this.ee(1,CommonUIStrings.l_DialogClose)}v_(a){this.aw(a,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}uXf(a){this.aw(a,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(t.a)(Nk,"ErrorDialog",$g.StandardDialog,[765]);var df=b(407);class tk{ati(){k.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const a=new df.a;a.mf("api.onedrive.com");return a.task}}Object(t.a)(tk,"OneDriveConsumerEndpointHelper",null,[710]);var Ng=b(34);class yh{constructor(a,d,n,z){this.$Xb=this.yWa=null;this.juf=this.luf=!1;this.Wuc=null;this.va=a;this.i3d=d;this.MWb=n;this.kL=z}get tYh(){return this.i3d}get K(){return this.va}mGc(){this.Wuc||
(this.Wuc=this.rOc?Ta.a.create(this.rOc,null,null,null,!1):null);return this.Wuc}setup(a){this.$Xb=a;this.luf||this.juf?this.luf&&this.$Xb&&this.$Xb(!0):(a=this.mGc())?(this.juf=!0,a.C6a.continueWith(d=>{this.EHm(d)}),ib.a.BP(a)):(k.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.$Xb(!1))}MHg(a){k.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",a.exception?a.exception.toString():"No error detail.")}EHm(a){this.juf=
!1;if(a.Vh)this.MHg(a),this.$Xb(!1);else try{this.luf=!0,k.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Ejg(),k.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.$Xb(!0)}catch(d){k.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",d.toString()),this.$Xb(!1)}}PWd(a){this.yWa=a;this.MWb?k.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(k.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(m.a)(this,this.WFg,"onApiReady")))}WFg(a){a?this.BIe():this.jq()}jq(){this.kL().v_(Ng.a.Bbj)}onSuccess(a){k.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.yWa&&this.yWa(!0,a)}dispose(){this.Wuc&&this.Wuc.dispose()}}Object(t.a)(yh,"AOneDriveFilePickerApiManager",null,[779,12]);class Bj extends yh{constructor(a,d,n,z,O,ca){super(d,n,z,ca);this.Yn=null;this.ZFa=a;this.Rnk=O}get rOc(){return this.K.Ga("OneDriveApiUrl")}start(a,d){this.Yn=
a;this.PWd(d)}Ejg(){WL.init(1===this.tYh||2===this.tYh?{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}PWd(a){this.yWa=a;!this.MWb&&this.ZFa.nJc?(k.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(m.a)(this,this.WFg,"onApiReady"))):(k.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.Rnk())}BIe(){try{k.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.Yn).then(Object(m.a)(this,this.onSuccess,"onSuccess"),Object(m.a)(this,this.onFailure,"onFailure"))}catch(a){k.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",a,a.stack),this.jq()}}onFailure(a){if(a&&a.error){if("user_canceled"===a.error.code){k.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}k.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",a.error.code,
a.error.message)}else k.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.yWa&&this.yWa(!1,a);this.jq()}}Object(t.a)(Bj,"OneDriveFilePickerApiManagerV5",yh,[]);class xi extends yh{constructor(a,d,n,z,O){super(a,d,n,z);this.L7d=this.jIh=null;this.s8j=O;this.options={};this.options.clientId=this.K.Ga("OneDriveApiV7ClientId");this.options.cancel=Object(m.a)(this,this.Q1e,"toggleHostDivVisibility")}get rOc(){return this.K.Ga("OneDriveApiV72Url")}start(a,d){this.L7d=d;const n=
this.s8j.ati();n.continueWith(()=>{k.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.jIh=n.result;this.PWd((z,O)=>{this.Q1e();a(z,O)})},3);n.continueWith(()=>{k.ULS.sendTraceTag(24134242,352,15,n.exception.message);this.Q1e()},5)}Ejg(){this.options.success=a=>{const d={};d.data=a;this.onSuccess(d)};this.options.error=a=>{const d={};d.error=a;this.onFailure(d)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=
this.jIh;this.options.advanced.iframeParentDiv=this.L7d}BIe(){try{k.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.Q1e(),OneDrive.open(this.options)}catch(a){k.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",a.message),this.jq()}}onFailure(a){this.yWa&&this.yWa(!1,a);this.jq()}Q1e(){this.L7d.style.visibility="hidden"===this.L7d.style.visibility?"":"hidden"}}Object(t.a)(xi,"OneDriveFilePickerApiManagerV7",yh,[]);class Ue extends yh{constructor(a,
d,n,z){super(a,d,n,z);this.D2j=a;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.K.Ga("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get rOc(){return this.K.Ga("OneDriveApiV72Url")}start(a,d,n,z){this.options.advanced.iframeParentDiv=n;this.options.advanced.endpointHint=z;this.options.cancel=d;this.D2j.ea("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.PWd(a)}PWd(a){this.yWa=a;this.MWb?k.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(k.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(m.a)(this,this.WFg,"onApiReady")))}Ejg(){this.options.success=a=>{const d={};d.data=a;this.onSuccess(d)};this.options.error=a=>{const d={};d.error=a;this.onFailure(d)}}BIe(){try{k.ULS.sendTraceTag(23881879,
216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(a){k.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",a.message,a.stack),this.jq()}}MHg(a){k.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",a.exception?a.exception.toString():"No error detail.");ib.a.Jnj(this.rOc);this.Wuc=null}jq(){this.kL().uXf(Ng.a.Zsj)}onFailure(a){this.yWa&&this.yWa(!1,a)}}Object(t.a)(Ue,"OneDriveFilePickerApiManagerV72",
yh,[]);class sf{constructor(a){this.olsSessionId=this.value=this.key=null;this.olsSessionId=a}}Object(t.a)(sf,"IExtraData",null,[]);class lm extends Ue{constructor(a,d,n,z){super(a,d,n,z);this.options.advanced.filter=a.Ga("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=l.AFrameworkApplication.uje;a.ea("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=a.Ga("OneDriveApiV72CommandMode")||"none");a.ea("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new sf(l.AFrameworkApplication.userSessionId))}get rOc(){return this.K.Ga("OneDriveApiV72Url")}BIe(){try{k.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",l.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(a){k.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",a.message,a.stack),this.jq()}}}Object(t.a)(lm,"OneDriveFilePickerApiOpenManagerV72",Ue,[]);class Sc{constructor(a){this.Ko=null;this.nf=a;this.Tsf=3}ati(){this.Ko=new df.a;k.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.ZZg();return this.Ko.task}ZZg(a=null){const d=String.format("GetMoreInfoHandler.ashx?{0}",l.AFrameworkApplication.Zqa);this.nf.MBb(d,1,null,a,["PersonalFileStorageUrl",
"X-NewKey"],!1,2,Object(m.a)(this,this.vGl,"getMoreInfoSucceeded"),Object(m.a)(this,this.uGl,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")}uGl(a){if(a.data.Ge===Ma.a.u8&&"X-NewKey"in a.data.Ri){k.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const d={};d["X-Key"]=a.data.Ri["X-NewKey"];this.ZZg(d)}else 0<this.Tsf?(k.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",
this.Tsf),this.Tsf--,this.ZZg()):(k.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Ko.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}vGl(a){"PersonalFileStorageUrl"in a.data.Ri&&""!==a.data.Ri.PersonalFileStorageUrl?(k.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Ko.mf(a.data.Ri.PersonalFileStorageUrl)):(k.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),
this.Ko.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(t.a)(Sc,"OneDriveForBusinessEndpointHelper",null,[710]);var De=b(682);class uk{constructor(){this.Z=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Hb(a){this.Z=a;this.Z.register(Bj,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").singleInstance().zd(()=>new Bj(De.a.instance,l.AFrameworkApplication.K,
l.AFrameworkApplication.Fla,l.AFrameworkApplication.Ksa,l.AFrameworkApplication.PZe,()=>new Nk));l.AFrameworkApplication.fpb?this.Z.register(710,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().zd(()=>new tk):this.Z.register(710,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().zd(()=>new Sc(l.AFrameworkApplication.Gd));this.Z.register(xi,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").singleInstance().zd(()=>new xi(l.AFrameworkApplication.K,
l.AFrameworkApplication.Fla,l.AFrameworkApplication.Ksa,()=>new Nk,this.Z.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.Z.register(Ue,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").singleInstance().zd(()=>new Ue(l.AFrameworkApplication.K,l.AFrameworkApplication.Fla,l.AFrameworkApplication.Ksa,()=>new Nk));this.Z.register(lm,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").singleInstance().zd(()=>new lm(l.AFrameworkApplication.K,
l.AFrameworkApplication.Fla,l.AFrameworkApplication.Ksa,()=>new Nk))}static main(){M.a.instance.Sb(new uk)}}Object(t.a)(uk,"PackageManager",null,[1,2]);class Th{constructor(a,d,n,z,O,ca){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=a;this.WebAffinitizedUrl=d;this.PolicyCookie=n;this.PolicyCookieTTL=z;this.WasServiceDown=O;this.AffinitizedUrl=ca}}Object(t.a)(Th,"SafeLinksData",null,
[]);class kc{constructor(a,d){this.f1e=a;this.dF=d}}Object(t.a)(kc,"SafeLinksGetUrlReputationRequestData",null,[]);class ei{constructor(a,d,n,z){this.va=a;this.nf=d;this.Y$j=n;ei.Ad=z}cVc(a,d,n){try{var z=null;ei.Ad&&(z=ei.Ad.Pe("WebServiceCall","SafeLinksGetUrlReputation"));const O=new kc(d,z);z={};z.AffinitizedUrl=a;z.TargetUrl=d;z.PolicyCookie=n;const ca=x.c(z);this.nf.Ni(this.Y$j,2,ca,null,!1,2,Object(m.a)(this,this.KFm,"onGetUrlReputationSuccessCallback"),Object(m.a)(this,this.JFm,"onGetUrlReputationFailureCallback"),
O,void 0,void 0,3E3,3E3,"36");return!0}catch(O){k.ULS.sendTraceTag(588788033,378,10,O.message)}return!1}KFm(a){let d="OnGetUrlReputationSuccessCallback: ",n=10;const z=a.data.state;try{const O=x.b(a.data.Rd).reputationResults[0],ca=O.navigateUrl.length,Da=z.f1e.length,Xa=O.navigateUrl===z.f1e;O.navigateUrl&&0<O.navigateUrl.length&&(z.f1e=O.navigateUrl);d+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",a.data.Ge,O.verdict,
Da.toString(),ca.toString(),Xa.toString());n=50}catch(O){d+=String.format("Exception {0}",O.message)}this.dIi(z,d,n)}JFm(a){let d="OnGetUrlReputationFailureCallback: ";const n=a.data.state;try{d+=String.format("HttpStatus {0}",a.data.Ge)}catch(z){d+=String.format("Exception {0}",z.message)}this.dIi(n,d,10)}dIi(a,d,n){a.dF&&(a.dF.stop(),a.dF=null);k.ULS.sendTraceTag(588788034,378,n,d);Ye.a.Tk(a.f1e,void 0,"noopener,noreferrer","SafeLinksNav")}}ei.Ad=null;Object(t.a)(ei,"SafeLinksNavigationHelper",
null,[]);var jg;(function(a){a[a.enabledByPolicy=0]="enabledByPolicy";a[a.disabledByPolicy=1]="disabledByPolicy";a[a.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";a[a.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(jg||(jg={}));Object(t.b)("SafeLinksNavigationState",jg);class gj{constructor(a,d,n,z=!1,O=null,ca=null){this.dUb=this.cUb=0;this.GCd=this.m7d=!1;this.cAb=null;this.$tc=!0;this.dee=null;k.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");
this.va=a;this.nf=d;this.i_a=n;gj.Ad=ca;this.fsk=z?this.va.Ga("SafeLinksHandlerWebServiceBase"):this.va.Ga("WebServiceBase");this.Ark=this.va.Ga("SafeLinksHashedUserId");this.iTn=this.va.Ga("SafeLinksWorkloadIdHeaderValue");this.N$d=this.va.jb("SafeLinksMaxGetPolicyBootRetries",2);this.O$d=this.va.jb("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.i9d=this.Wem();this.h9d=this.Vem();k.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.i9d,this.h9d);
if(this.i9d&&this.h9d){d=(a=this.kFc())?a.IsSafeLinksEnabled.toLowerCase():"";n=this.Wqg();k.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",d,n);var Da=!a||"unknown"===d||a.WasServiceDown||n,Xa=this.SG();Xa&&(Xa.set("shouldGetSafeLinksDataFromServer",Da.toString()),Xa.set("isSafeLinksEnabledCacheValue",d.toString()));this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksLicenseCheck",!1)&&O?(this.$tc=!1,O.execute(zb=>{zb.isFeatureEnabled("MsoUrlreputation",
!0).then(Vb=>{this.$tc=Vb;Xa.set("isUserLicensedForSafeLinks",this.$tc.toString());ja.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Xa);this.$tc&&Da&&this.Bze(!0);return null})})):(ja.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Xa),Da&&this.Bze(!0))}}get appName(){return this.i_a}get I4e(){return this.fsk}get userId(){return this.Ark}get qKl(){const a=this.I4e?this.I4e+"/":"",d=new Ba.QueryStringBuilder("SafeLinksHandler.ashx");d.Xd("app",this.appName);
this.va.ea("SafeLinksUseDebugHeader")&&d.Xd("action","debug");this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&d.Xd("s2satpop","1");this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&d.Xd("s2saat","1");this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&d.Xd("s2se03","1");return String.format("{0}{1}&{2}",a,d.toString(),l.AFrameworkApplication.Fk)}get DSl(){const a=this.I4e?this.I4e+
"/":"",d=new Ba.QueryStringBuilder("SafeLinksHandler.ashx");d.Xd("app",this.appName);this.va.ea("SafeLinksUseDebugHeader")&&d.Xd("action","debug");this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&d.Xd("s2satpop","1");this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&d.Xd("s2saat","1");this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&d.Xd("s2se03","1");d.Xd("slrt","GetUrlReputation");
return String.format("{0}{1}&{2}",a,d.toString(),l.AFrameworkApplication.Fk)}get Mym(){gj.wtf||(gj.wtf=new ei(this.va,this.nf,this.DSl,gj.Ad));return gj.wtf}cVc(a){if(!a)return k.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var d=this.fbm(a);k.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",d,this.i9d,this.h9d,this.$tc);if(!(d&&
this.i9d&&this.h9d&&this.$tc))return!1;d=0;const n=({state:d}=this.Atn()).returnValue;k.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",jg[d]);const z=this.SG();z&&z.set("SafeLinksNavigationState",jg[d]);ja.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",z);if(!n)return 2!==d&&3!==d||ja.Health.instance.recordKpiFailure("SafeLinksNavigations",jg[d],!1,!0,null),!1;k.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");
if(this.Rtn())return this.Wqg()?!1:this.Mym.cVc(this.grl(),a,this.gCi());if(!this.Wqg())return this.RLj(a),!0;this.cAb=a;k.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.GCd=!1;this.Bze();return!0}fbm(a){a=a.toLowerCase();const d=this.va.kx("SafeLinksUnsupportedProtocols");if(d)for(let n=0;n<d.length;n++)if(a.startsWith(d[n]))return!1;return!0}Bze(a=!1){var d=this.SG();d&&d.set("isOnBootRequest",a.toString());ja.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",
1,"jpittsdirects",d);ja.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",d);d=this.BQf("SafeLinksGetPolicy");this.nf.Ni(this.qKl,1,null,null,!0,2,Object(m.a)(this,this.nNl,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(m.a)(this,this.mNl,"getSafeLinksDataFromServer_OnFailureCallback"),d,void 0,void 0,void 0,void 0,"23");this.GCd=a;this.m7d=!0;a?this.cUb++:this.dUb++}nNl(a){let d=Ma.a.P6i,n="";try{this.m7d=this.GCd=!1;var z=a.data.state;const yd=({dF:z}=this.T_e(z)).returnValue,
je=Object.assign(new Pa.a,{durationMs:yd});ja.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",je);k.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",a.data.Ge,a.data.Rd.length,yd);if(a.data.Ge!==Ma.a.HD)n="Unexpected httpStatus: "+a.data.Ge.toString();else{z=null;try{z=x.b(a.data.Rd)}catch(Le){n="Exception:"+Le.toString()+" deserializing response";return}if(z){var O=z.IsSafeLinksEnabled;if(void 0===
O||null===O||0>=O.length)n="Invalid isSafeLinksEnabledString";else{k.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",O);var ca=gj.WLg(O);if(void 0===z.WebAffinitizedUrl||null===z.WebAffinitizedUrl||0>=z.WebAffinitizedUrl.length)n="Invalid WebAffinitizedUrl";else if(void 0===z.PolicyCookie||null===z.PolicyCookie||0>=z.PolicyCookie.length)n="Invalid PolicyCookie";else if(void 0===z.PolicyCookieTTL||null===z.PolicyCookieTTL)n="Invalid PolicyCookieTTL";else{var Da=z.WebAffinitizedUrl,
Xa=z.PolicyCookie,zb=z.AffinitizedUrl,Vb=new Date;Vb.setMinutes(Vb.getMinutes()+(5<z.PolicyCookieTTL?z.PolicyCookieTTL-5:0));var Fc=Vb.getTime(),Yc=new Th(O,Da,Xa,Fc,!1,zb);this.bwj(Yc);d=a.data.Ge;this.cAb&&(ca?(this.RLj(this.cAb),this.dUb=this.cUb=0):(k.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),ja.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),Ye.a.Vkb(this.cAb)),this.cAb=null)}}}else n="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(yd){n=
"GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+yd.toString()}finally{d!==Ma.a.HD&&this.cIi(d,n)}}mNl(a){this.m7d=!1;let d=500,n="";try{let z=a.data.state;const O=({dF:z}=this.T_e(z)).returnValue,ca=Object.assign(new Pa.a,{durationMs:O});d=a.data.Ge;ja.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+d.toString(),!1,!0,ca);n="Request Failed, Status="+ql.a[a.data.status]+" Duration: "+O}catch(z){n="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+
z.toString()}finally{this.cIi(d,n)}}cIi(a,d=""){try{if(k.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",a,d),this.cUb<this.N$d&&this.dUb<this.O$d)this.Bze(this.GCd);else{this.GCd=!1;k.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",this.cUb,this.dUb,a,d);d=null;const n=this.SG();n&&(n.set("HttpStatus",a.toString()),d=Object.assign(new Pa.a,{extendedProperties:n}));
ja.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,d);const z=new Th("false","","",0,!0,"");this.bwj(z);this.cAb&&(k.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),ja.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",!1,!0,null),Ye.a.Vkb(this.cAb),this.cAb=null)}}catch(n){k.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",
n.toString())}}RLj(a){const d=this.gCi(),n=this.nTl(),z={};z.Url=a;z.SafeLinksCookie=d;z.CorrelationId=xa.a.create().toString();z.WorkloadId=this.iTn;z.UserAgentInfo=I.a.qI+"|"+this.appName;k.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",z.CorrelationId);Ye.a.ePc(Ye.a.Mda(4),n,z)}Wem(){const a=this.va.Ga("IsSafeLinksEnabledForUser");return a?gj.WLg(a):!1}Vem(){const a=this.va.kx("SafeLinksDisabledBrowsers");if(I.a.dV){if(this.va.iz("SafeLinksForTeamsIsEnabled")&&
this.va.ea("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(a,"Electron"))return!1}else if(Array.contains(a,I.a.qI))return!1;return"officecomhwa"===(this.va.Ga(l.AFrameworkApplication.vda)||"").toLowerCase()?!1:!0}Rtn(){return-1!==window.location.href.indexOf("&wd_slnh=1")?!0:I.a.dV}Atn(){let a;a=0;const d=this.kFc(),n=d?d.IsSafeLinksEnabled:"";if(""!==n)return d.WasServiceDown?(k.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===n.toLowerCase()?
(k.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:gj.WLg(n),state:a};if(this.m7d)return a=3,k.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:a};if(this.cUb>=this.N$d||this.dUb>=this.O$d)return a=2,k.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.cUb,this.N$d,this.dUb,this.O$d),{returnValue:!1,state:a};k.ULS.sendTraceTag(23900182,
378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this.N$d+this.O$d-(this.cUb+this.dUb));return{returnValue:!0,state:a}}gCi(){const a=this.kFc();return a?a.PolicyCookie:""}nTl(){const a=this.kFc();return a?a.WebAffinitizedUrl:""}grl(){const a=this.kFc();return a?a.AffinitizedUrl:""}qzl(){const a=new Date;try{const d=this.kFc();a.setTime(d?d.PolicyCookieTTL:0)}catch(d){k.ULS.sendTraceTag(24462658,
378,10,"Exception occured while fetching expiration time from cache: {0}",d)}return a}Wqg(){const a=this.qzl();return!!a&&a.getTime()<Date.now()}kFc(){if(!this.dee){const a=wb.a.instance.getItem(this.userId);if(!a||""===a)return null;this.dee=JSON.parse(a)}return this.dee}bwj(a){if(void 0===a||null===a)throw Error.argumentNull("safeLinksData");if(void 0===a.IsSafeLinksEnabled||null===a.IsSafeLinksEnabled||0>=a.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");
this.dee=a;a.WasServiceDown||this.sTn(a)}sTn(a){a=JSON.stringify(a);wb.a.instance.setItem(this.userId,a)}BQf(a){return void 0!==gj.Ad&&null!==gj.Ad?gj.Ad.Pe("WebServiceCall",a):null}T_e(a){if(void 0!==a&&null!==a){const d=a.ti;a.stop();return{returnValue:d,dF:null}}return{returnValue:null,dF:a}}SG(){try{return new Map}catch(a){return null}}static WLg(a){return"false"!==a.toLowerCase()?!0:!1}}gj.Ad=null;gj.wtf=null;Object(t.a)(gj,"SafeLinksManager",null,[766]);const Vk=a=>{switch(a){case 3:return"Word";
case 1:return"Excel";case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},Ef=a=>{switch(a){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};class tn{constructor(){this.Z=null}get name(){return"Common.App.SafeLinks"}Hb(a){this.Z=a}init(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.wq(Object(m.a)(this,this.Gw,"onFullAppSettingsReady"))}dispose(){}Gw(){l.AFrameworkApplication.K.ea("WACSafeLinksIsEnabled")&&
(this.Z.register(gj,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").singleInstance().zd(()=>new gj(l.AFrameworkApplication.K,l.AFrameworkApplication.Gd,String.format("{0}-{1}",Vk(l.AFrameworkApplication.la.eb.Bm),Ef(l.AFrameworkApplication.la.eb.tca)),!1,this.Z.Ca("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),l.AFrameworkApplication.la.Np)),this.Z.sa("Common.App.SafeLinks.ISafeLinksManager"))}static main(){M.a.instance.Sb(new tn)}}Object(t.a)(tn,
"SafeLinksPackage",null,[1,2]);var kh=b(172);class Qe{constructor(a){this.ka=new oc.a;this.gh=a}SBb(a){this.ka.addHandler(Qe.LKa,a)}LQd(a){this.ka.removeHandler(Qe.LKa,a)}UBb(a){this.ka.addHandler(Qe.S9a,a)}BQc(a){this.ka.removeHandler(Qe.S9a,a)}ZCf(a){this.ka.addHandler(Qe.DUc,a)}p5g(){this.ka.raiseEvent(Qe.LKa)}rgg(){return kh.a.instance.aca(l.AFrameworkApplication.ys)}}Qe.LKa="SE";Qe.rTd="SEP";Qe.S9a="SER";Qe.DUc="TRP";Object(t.a)(Qe,"NullSessionExpirationManager",null,[620,621]);class Nn{constructor(){this.ccd=
this.O_b=!1;const a=l.AFrameworkApplication.ys;0>=a||(this.ys=a,k.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.ys,["NowGetTime"]:(new Date).getTime(),["BootTime"]:l.AFrameworkApplication.WJ}),kh.a.instance.bDf(Object(m.a)(this,this.jOc,"onSessionExpiredDetected")),kh.a.instance.aDf(Object(m.a)(this,this.QOe,"onSessionExpiringDetected")))}jOc(){kh.a.instance.dVg(Object(m.a)(this,this.jOc,"onSessionExpiredDetected"));k.ULS.sendTraceTag(19247381,
217,50,"SessionExpiredDetected");this.Ifg()}QOe(){kh.a.instance.Roj(Object(m.a)(this,this.QOe,"onSessionExpiringDetected"));this.ccd||this.O_b||(k.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.ccd=!0,this.b6g())}Ifg(){this.O_b||(l.AFrameworkApplication.KH(Ng.a.MMb),this.O_b=!0,this.SZe())}}Object(t.a)(Nn,"ASessionExpirationManager",null,[]);var xg=b(149),el=b(432);class jh{constructor(a,d,n,z){this.K$g="";this.WPb=a;this.kNh=n;this.hNh=z;this.fBh=d;a=
(new Date(this.WPb)).format(l.AFrameworkApplication.XUd);this.K$g=this.fBh?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,a)}aSc(a){1===a?this.kNh&&this.kNh(this.fBh):0===a&&l.AFrameworkApplication.pa.ob(Sa.a.close,2,el.g)}dispose(){this.hNh&&this.hNh()}}jh.id="SessionExpirationDialog";Object(t.a)(jh,"SessionExpirationDialogSharedProperties",null,[]);class gh{}gh.Lf="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";
Object(t.a)(gh,"SessionExpirationDialogHtml",null,[]);class Ed extends xg.a{constructor(a,d,n,z){super(d);const O={};this.Bfb=new jh(a,d,n,z);this.Je=jh.id;l.AFrameworkApplication.kKf?(this.wc=1,this.ee(0,CommonUIStrings.l_DialogClose)):(this.wc=0,this.Hq=!1);d||1===l.AFrameworkApplication.la.mode?this.ee(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.ee(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Lf=gh.Lf;O.WACSessionExpirationText=this.Bfb.K$g;this.Ih(CommonUIStrings.l_DefaultDialogTitle,
Object(m.a)(this,this.aSc,"sessionExpirationDialogHandler"),O);this.k5(this.Kg("WACSessionExpirationText"))}aSc(a){this.Bfb.aSc(a)}Ugg(){this.hide()}dispose(){super.dispose();this.Bfb&&this.Bfb.dispose()}}Object(t.a)(Ed,"LegacySessionExpirationDialog",xg.a,[670]);class Vj extends $g.StandardDialog{constructor(a,d,n,z){super(d);this.Bfb=new jh(a,d,n,z);this.Je=jh.id;l.AFrameworkApplication.kKf?(this.wc=1,this.ee(0,CommonUIStrings.l_DialogClose)):(this.wc=0,this.Hq=!1);d||1===l.AFrameworkApplication.la.mode?
this.ee(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.ee(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.iu(CommonUIStrings.l_DefaultDialogTitle,this.Bfb.K$g,0,Object(m.a)(this,this.aSc,"sessionExpirationDialogHandler"))}aSc(a){this.Bfb.aSc(a)}Ugg(){this.hide()}dispose(){super.dispose();this.Bfb&&this.Bfb.dispose()}}Object(t.a)(Vj,"SessionExpirationDialog",$g.StandardDialog,[670]);const hj=(a,d,n,z)=>l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.wz&&l.AFrameworkApplication.K.ea("ReactStandardSessionExpirationDialogIsEnabled")?
new Vj(a,d,n,z):new Ed(a,d,n,z);var zf=b(144);class Ke extends Nn{constructor(a){super();this.Gee=this.Fwc=!0;this.v6=null;this.ka=new oc.a;this.gh=a}SBb(a){this.ka.addHandler(Ke.LKa,a)}LQd(a){this.ka.removeHandler(Ke.LKa,a)}UBb(a){this.ka.addHandler(Ke.S9a,a)}BQc(a){this.ka.removeHandler(Ke.S9a,a)}ZCf(a){this.ka.addHandler(Ke.DUc,a)}rgg(){return kh.a.instance.aca(l.AFrameworkApplication.ys)}p5g(a){this.Fwc=a}b6g(){if(!this.v6&&!zf.a.Yu){if(this.Gee){const a=Object(m.a)(this,this.fDc,"disposeCallback");
this.v6=hj(this.ys,!1,Object(m.a)(this,this.bSc,"sessionExpirationHandler"),a)}this.ka.raiseEvent(Ke.rTd)}}SZe(){this.v6&&(this.v6.bca&&this.v6.Ugg(),this.v6=null);if(this.Fwc){const a=Object(m.a)(this,this.fDc,"disposeCallback");this.v6=hj(this.ys,!0,Object(m.a)(this,this.bSc,"sessionExpirationHandler"),a)}this.ka.raiseEvent(Ke.LKa)}fDc(){this.v6=null}bSc(a){(a||this.gh.gid())&&this.gh.refreshDocument(null)}}Ke.LKa="SE";Ke.rTd="SEP";Ke.S9a="SER";Ke.DUc="TRP";Object(t.a)(Ke,"SessionExpirationManager",
Nn,[620,621]);class Bg{}Bg.Bsk="Aborting";Bg.Ihe="ActivityDuration";Bg.error="Error";Bg.Ngl="Errors";Bg.failed="Failed";Bg.d8b="FirstActivity";Bg.initialized="Initialized";Bg.kickedOut="KickedOut";Bg.ajm="LastActivity";Bg.wcn="RetryOverride";Bg.mVe="RequestGroups";Bg.xsb="Requests";Bg.AVe="Responses";Bg.YWe="SessionDuration";Bg.status="Status";Bg.success="Success";Bg.IAn="Successful";Bg.Ioa="Tokens";Bg.XMg="PollingDuration";Object(t.a)(Bg,"SessionExpirationStrings",null,[]);class wj{constructor(a){this.Ps=
{};this.Uua={};this.iAb={};this.z0i=15;this.vCh=!1;this.Fmk=new Date;this.Z9d=new Date;this.fb=a;this.PC=new bf.a(2,2,6E4*this.z0i,Object(m.a)(this,this.IVj,"writeMeasures"),135,"SL",!1);this.fb.rb(this.PC);this.J3l()}IVj(){k.ULS.sendTraceTag(41964821,217,50,k.ULS.tIb({["Aggregate"]:this.Uua,["Current"]:this.Ps}))}J3l(){this.Uua[Bg.mVe]=0;this.Uua[Bg.xsb]=0;this.Uua[Bg.AVe]=0;this.Uua[Bg.status]=Bg.initialized;this.Uua[Bg.d8b]=new Date;this.Uua[Bg.YWe]=0;this.Uua[Bg.Ihe]=0;this.Uua[Bg.YWe]=0;this.Ps[Bg.YWe]=
0;this.Uua[Bg.Ihe]=0;this.Ps[Bg.Ihe]=0}get fRm(){this.iAb[Bg.XMg]=+new Date-+this.iAb[Bg.d8b];return this.iAb}Vig(a,d){var n=a[d];n=n?n:0;n++;a[d]=n;this.i1g(a)}i1g(a){const d=new Date;a[Bg.Ihe]=+d-+this.Z9d;this.Z9d=d;a[Bg.YWe]=+this.Z9d-+this.Fmk;a[Bg.ajm]=this.Z9d}X8a(a,d){this.Ps[a]=d;this.i1g(this.Ps)}xwj(a,d){this.Ps[a]=d;this.i1g(this.Ps)}zIc(a){this.Vig(this.Ps,a);this.Vig(this.Uua,a);this.Vig(this.iAb,a)}flush(){this.vCh||(this.Uua[Bg.status]=this.Ps[Bg.status],this.IVj(this.PC),this.fb.FV(this.PC,
6E4*this.z0i))}Aan(){const a=this.Ps[Bg.status];a&&(this.Uua[Bg.status]=a);this.Ps={}}Oan(){this.iAb={};this.iAb[Bg.XMg]=0;this.iAb[Bg.d8b]=new Date}stop(){k.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.vCh=!0;this.fb.ie(this.PC)}}Object(t.a)(wj,"SessionLogger",null,[616]);class Ok{constructor(a,d){this.ige=a;this.syb=d}get Ioa(){return this.ige}get errors(){return this.syb}}Object(t.a)(Ok,"TokenRefreshArgs",null,[654]);var Yb=b(354);class Ua extends Sys.EventArgs{constructor(a,
d,n,z,O,ca,Da){super();this.iAb=a;this.Yej=d;this.mVe=z;this.failed=O;this.xsb=ca;this.AVe=Da}}Object(t.a)(Ua,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);class Hb{constructor(a,d=null,n=null){this.ccd=this.O_b=!1;this.Gee=this.Fwc=!0;this.ka=new oc.a;this.icd=this.b$d=this.Nce=!1;this.ZYb=null;this.SJh=10;this.C9d=!1;this.wxf=a;this.Nkf=l.AFrameworkApplication.RVi;this.fb=th.a.instance;k.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:l.AFrameworkApplication.ys,
["NowGetTime"]:(new Date).getTime(),["BootTime"]:l.AFrameworkApplication.WJ});this.jd=d||new wj(th.a.instance);this.dxa=n;kh.a.instance.bDf(Object(m.a)(this,this.ysk,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));kh.a.instance.aDf(Object(m.a)(this,this.ESh,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));Yb.SessionStatusManager.instance.GWh(Object(m.a)(this,this.ESh,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));Yb.SessionStatusManager.instance.OWh(Object(m.a)(this,
this.BSm,"preemptiveTokenRefresh"));this.pDh=new Date;l.AFrameworkApplication.QVi&&(kh.a.instance.lAc=Object(m.a)(this,this.x1m,"refreshAccessTokenWhenSessionExpired"));l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.SJh=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",
!1))}SBb(a){this.ka.addHandler(Hb.LKa,a)}LQd(a){this.ka.removeHandler(Hb.LKa,a)}UBb(a){this.ka.addHandler(Hb.S9a,a)}BQc(a){this.ka.removeHandler(Hb.S9a,a)}ZCf(a){this.ka.addHandler(Hb.DUc,a)}rgg(){return kh.a.instance.aca(l.AFrameworkApplication.ys)}x1m(){this.iCe(!1);return!kh.a.instance.aca(l.AFrameworkApplication.ys)}ysk(a,d){kh.a.instance.Wcc?this.jOc(a,d):this.Nkf?(this.b$d=!1,this.iCe(!1)):this.jOc(a,d)}ESh(a,d){kh.a.instance.BEd?this.QOe(a,d):this.iCe(!0)}iCe(a){if(!this.Nce&&!this.b$d)if(this.dxa&&
this.dxa.Gp)this.icd=!0,this.jd.X8a(Bg.status,Bg.kickedOut),this.jd.flush(),this.jd.stop();else if(k.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",a,this.icd),this.icd)this.SZe();else{this.jd.flush();this.jd.Aan();this.jd.zIc(Bg.mVe);this.Nce=!0;this.C9d||(this.jd.Oan(),this.C9d=!0,this.c_k());const d=this.wxf.N1m(a);d.continueWith(()=>{if(this.wxf.QVm(d))this.jd.zIc(Bg.IAn),this.jd.X8a(Bg.status,Bg.success),this.Gee=!1,this.Nkf&&(this.Fwc=!1),this.b$d=!1,
this.pDh=new Date,this.eAn(),this.ka.raiseEvent(Hb.S9a,new Ok(d.result.Ioa,null));else{const n=d.result.errors;this.jd.zIc(Bg.failed);this.jd.X8a(Bg.status,Bg.failed);a||(this.icd=this.wxf.CGe(n));this.icd&&this.jd.X8a(Bg.Bsk,JSON.stringify(n));this.b$d=!0;this.ka.raiseEvent(Hb.S9a,new Ok(null,n))}this.jd.flush();this.Nce=!1})}}jOc(){this.Nkf||kh.a.instance.dVg(Object(m.a)(this,this.jOc,"onSessionExpiredDetected"));k.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.Ifg(kh.a.instance.Wcc)}QOe(){this.ccd||
this.O_b||(k.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.ccd=!0,this.b6g(kh.a.instance.BEd))}Ifg(a){if(!this.O_b){var d=a?Ng.a.Dvj:Ng.a.MMb;const n=Object.assign(new Pa.a,{extendedProperties:new Map});n.extendedProperties.set("ErrorCode",String.format("{0}",d));l.AFrameworkApplication.KH(d,void 0,["SessionExpired"],n);a||(a=new Date,d=new Date(l.AFrameworkApplication.WJ),k.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",
d,a,+a-+d),864E5>+a-+d&&ja.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,n),2592E5>+a-+d&&ja.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,n));this.O_b=!0;this.SZe()}}eAn(){this.C9d&&(this.fb.ie(this.ZYb),this.C9d=!1)}c_k(){this.ZYb=new bf.a(2,2,1E3*this.SJh,Object(m.a)(this,this.UEn,"tokenRefreshPolling"),135);this.fb.rb(this.ZYb)}UEn(){const a=this.jd.fRm;k.ULS.sendTraceTag(555255521,
217,50,"{0}",x.c(a));this.ka.raiseEvent(Hb.DUc,new Ua(a,a[Bg.XMg],a[Bg.d8b],a[Bg.mVe],a[Bg.failed],a[Bg.xsb],a[Bg.AVe]))}BSm(){3E5<+new Date-+this.pDh?(k.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.iCe(!1)):k.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}Hb.LKa="SE";Hb.rTd="SEP";Hb.S9a="SER";Hb.DUc="TRP";Object(t.a)(Hb,"ASessionExpirationManagerWithRefresh",null,[]);class $b extends Hb{constructor(a,
d,n=null,z=null){super(d,n,z);this.v6=null;this.gh=a}p5g(a){this.Fwc=a}b6g(a){if(!this.v6&&!zf.a.Yu){if(a){var d=Object(m.a)(this,this.fDc,"disposeCallback");this.v6=hj(l.AFrameworkApplication.Nta,!1,Object(m.a)(this,this.bSc,"sessionExpirationHandler"),d)}else if(this.Gee){if(this.Nce)return;d=Object(m.a)(this,this.fDc,"disposeCallback");this.v6=hj(l.AFrameworkApplication.ys,!1,Object(m.a)(this,this.bSc,"sessionExpirationHandler"),d)}k.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",
Hb.rTd,a);this.ka.raiseEvent(Hb.rTd)}}SZe(){this.v6&&(this.v6.bca&&this.v6.Ugg(),this.v6=null);if(this.Fwc){this.jd.stop();if(this.dxa&&this.dxa.Gp)return;const a=Object(m.a)(this,this.fDc,"disposeCallback");this.v6=hj(l.AFrameworkApplication.ys,!0,Object(m.a)(this,this.bSc,"sessionExpirationHandler"),a)}k.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",Hb.LKa);this.ka.raiseEvent(Hb.LKa)}fDc(){this.v6=null}bSc(a){(a||this.gh.gid())&&this.gh.refreshDocument(null)}}Object(t.a)($b,"SessionExpirationManagerWithRefresh",
Hb,[620,621]);class sc{constructor(a,d,n=null,z=null){this.sRh=!1;this.na=null;this._frame=a;this.Om=d;this.jd=n||new wj(th.a.instance);this.dxa=z}create(){this.sRh=l.AFrameworkApplication.Gga;if(!this.sRh)return new Ke(this._frame);l.AFrameworkApplication.Zi("WOPITokenRefreshIsEnabled");k.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this.na)switch(l.AFrameworkApplication.TSj){case 1:k.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");
this.na=new Qe(this._frame);break;case 2:k.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this.na=new $b(this._frame,this.Om,this.jd,this.dxa);break;default:k.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this.na=new Ke(this._frame)}k.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this.na).getName());return this.na}}Object(t.a)(sc,"SessionExpirationManagerFactory",null,
[619]);class Wc{}Object(t.a)(Wc,"Error",null,[]);class dd{}Object(t.a)(dd,"NamedResult",null,[]);class td extends dd{}Object(t.a)(td,"ErrorInfo",dd,[]);var oe=b(940),Ld=b(29);class Mf{constructor(a,d,n,z=null,O=!1,ca=null,Da=!1){this.afb=0;this.fBb=this.Kj=null;this.ige=new db.a;this.syb=new db.a;this.Ko=null;this.Mkf=!1;this.fb=a;this.WJh=d;this.WJh.execute(Xa=>{Xa.uD(D.a.VCe,Object(m.a)(this,this.XFm,"onHostResponseReceived"))});this.o1a=n;this.nQh=new oe.a("WebServiceCall","TokenRefresh");this.jd=
z||new wj(a);this.Amk=O;this.Ng=ca?ca:Yb.SessionStatusManager.instance;this.bvh=Da}XFm(a){if(a.MessageId!==D.a.VCe)Ld.b(39408099,306,15,"Unexpected message.");else{var d=new db.a,n=new db.a;this.jd.zIc(Bg.AVe);var z=a.Values[G.a.z_g];if(!z||0>=z.length)Ld.b(40122317,306,15,"Found no tokens in the dictionary"),z=a.Values;Ld.b(40122318,306,100,"The Tokens array contains {0} tokens",z.length);this.jd.X8a("Correlation",a.CorrelationId);var O="";for(let Xa=0;Xa<z.length;Xa++){this.jd.xwj(Bg.Ioa,z.length);
var ca=z[Xa],Da=ca;if(!Da||!Da.Name)continue;this.jd.zIc(Da.Name);const zb=ca;if(zb&&zb.Value)Ld.b(39408128,306,100,"Received token with name: {0}",zb.Name),d.add(zb),this.ige.add(zb),this.jd.X8a(Bg.status,Bg.success),this.bvh&&this.Ng&&this.Ng.Rqj();else if(ca=this.vNl(ca),Ld.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",Da.Name,JSON.stringify(ca),this.fBb),n.add(ca),this.syb.add(ca),O=JSON.stringify(ca),this.jd.X8a(Bg.error,JSON.stringify(ca)),this.jd.X8a(Bg.status,
Bg.failed),this.bvh)for(const Vb of ca.Errors)Da=this.ezl(Vb),this.Ng&&this.Ng.xVh(Da)}0<n.count&&""!==O?(z=Object.assign(new Pa.a,{extendedProperties:new Map}),z.extendedProperties.set("Errors",O),ja.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,z)):ja.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Ld.b(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",d.count,n.count,a.CorrelationId,this.fBb);0<n.count&&
!this.CGe(n)?(a=this.o1a.uMl(n),a!==this.o1a.CXg&&(this.jd.xwj(Bg.wcn,a),this.fb.FV(this.Kj,a))):(this.jd.flush(),this.Kj&&(Ld.b(39408131,306,100,"Deleting task {0} from task manager",this.Kj.name),this.fb.ie(this.Kj)),this.Ko&&!this.Ko.task.isCompleted&&this.Ko.mf(new Ok(d,n)))}}vNl(a){if(!a)return null;const d=Object.assign(new td,{Name:a.Name,Errors:[]});for(const n of a.Errors)a=new Wc,a.Id=n.Id,a.Details=this.uNl(n.Details),d.Errors.push(a);return d}uNl(a){if(!a)return"";const d=a.toLowerCase();
return 0<d.indexOf("<!doctype")?this.kbg("Seems to contain HTML - Contains <!DOCTYPE"):0<d.indexOf("<html")?this.kbg("Seems to contain HTML - Contains <html>"):500<d.length?this.kbg(String.format("Error details content too long: Length: {0}",d.length)):a}kbg(a){return String.format("{0} - Reason: [{1}]","### REDACTED ###",a)}requestTokensOnce(){this.rqj()}rqj(){l.AFrameworkApplication.Yi("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.afb>=this.o1a.Dzg?(Ld.b(39408132,306,
15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.fBb),this.I0k(this.Ko)):(ja.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.Egn())}Egn(){const a={};a[G.a.z_g]=this.o1a.Ioa;const d=xa.a.create().toString();Ld.b(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.o1a.Ioa),this.afb+1,d,this.fBb);this.WJh.execute(n=>{n.Eh(D.a.sje,a,d)});this.afb++;this.jd.zIc(Bg.xsb)}I0k(a){const d=new db.a;for(let n=0;n<this.o1a.Ioa.length;n++){const z=
Object.assign(new td,{Name:this.o1a.Ioa[n],Errors:[Object.assign(new Wc,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});d.add(z);this.syb.add(z)}this.fb.ie(this.Kj);this.jd.X8a(Bg.Ngl,JSON.stringify(this.syb));this.jd.X8a(Bg.status,Bg.failed);a&&!a.task.isCompleted&&a.mf(new Ok(new db.a,this.syb))}N1m(a){this.nQh.start();this.Mkf=a;this.fBb=xa.a.create().toString();Ld.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",
this.fBb,this.Mkf);this.afb=0;this.syb.clear();this.ige.clear();this.Ko=new df.a;this.Kj=new bf.a(this.o1a.priority,2,this.o1a.CXg,Object(m.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,D.a.sje,!0);this.Amk&&this.rqj();this.fb.rb(this.Kj);return this.Ko.task}QVm(a){this.nQh.stop();const d=this.GYl(a.result.errors);k.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!d,this.fBb,this.Mkf,this.afb,this.syb.count,0<a.result.errors.count?a.result.errors.J(0).Name:"",0<a.result.errors.count&&0<a.result.errors.J(0).Errors.length?a.result.errors.J(0).Errors[0].Id:"",0<a.result.errors.count&&0<a.result.errors.J(0).Errors.length?a.result.errors.J(0).Errors[0].Details:"");return d?!1:this.PVm(a.result.Ioa)}CGe(a){return this.o1a.CGe(a)}PVm(a){for(let d=0;d<a.count;d++){const n=a.J(d);if(n.Name===G.a.accessToken){const z=(new Date).getTime();n.Expiry>l.AFrameworkApplication.ys?
(k.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:n.Expiry,["NowGetTime"]:z,["BootTime"]:l.AFrameworkApplication.WJ},"PreviousAccessTokenTtl",l.AFrameworkApplication.ys),l.AFrameworkApplication.accessToken=n.Value,l.AFrameworkApplication.ys=Math.floor(n.Expiry),l.AFrameworkApplication.fWc=z,l.AFrameworkApplication.D6=Math.floor(n.Expiry)):k.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:n.Expiry,
["NowGetTime"]:z,["BootTime"]:l.AFrameworkApplication.WJ},"PreviousAccessTokenTtl",l.AFrameworkApplication.ys)}}return!0}GYl(a){let d=!1;for(let n=0;n<a.count;n++){d=!0;const z=a.J(n);k.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",z.Name,JSON.stringify(z.Errors),this.fBb)}return d}ezl(a){let d=Ng.a.MMb;a=parseInt(a.Id);if(isNaN(a))d=Ng.a.chh;else{switch(a){case 401:d=Ng.a.l1d;break;case 403:d=Ng.a.ahh;break;case 500:d=Ng.a.bhh;break;case 503:d=Ng.a.ehh}d===
Ng.a.MMb&&(d=500<a?Ng.a.dhh:Ng.a.$gh)}return d}}Object(t.a)(Mf,"TokenRefreshManager",null,[618]);class Rf{constructor(){this.CXg=l.AFrameworkApplication.O4e;this.Dzg=l.AFrameworkApplication.USj;this.Ioa=l.AFrameworkApplication.ZGi();this.priority=l.AFrameworkApplication.WSj;this.RLh=this.Onn();this.tzf=l.AFrameworkApplication.YGi();this.nkf=!1;this.ULh=l.AFrameworkApplication.O4e;l.AFrameworkApplication.K&&(this.nkf=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RetryOverrideOnServerErrorIsEnabled",
!1))&&(this.ULh=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.RetryOverrideOnServerErrorMilliseconds",l.AFrameworkApplication.O4e))}CGe(a){const d=JSON.stringify(a);if(this.tzf&&0<this.tzf.length)for(const n of this.tzf)if(0<n.length&&0<=d.indexOf(n))return!0;if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.StopTokenRefreshOn403",!1))for(let n of a)if(n.Errors)for(const z of n.Errors)if(z&&"403"===z.Id)return!0;return!1}uMl(a){try{if(a)for(let d of a)if(d.Errors)for(const n of d.Errors){if(n.Id in
this.RLh)return Number.parseInvariant(this.RLh[n.Id].toString());if(this.nkf)try{if(500<=Number.parseInvariant(n.Id))return l.AFrameworkApplication.Yi("RetryIntervalOverrideOnServerError;RetryIntervalOverrideOnServerErrorcf"),this.ULh}catch(z){k.ULS.sendTraceTag(540541017,217,50,"Unable to parse Error id to int. Exception {0}, ErrorId: {1}",z.toString(),n.Id)}}}catch(d){k.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",d.toString())}return this.CXg}Onn(){const a=
{};try{if(!l.AFrameworkApplication.uxd()||0>=l.AFrameworkApplication.uxd().length||""===l.AFrameworkApplication.uxd()[0])return a;for(const d of l.AFrameworkApplication.uxd())0<d.length&&(a[d]=l.AFrameworkApplication.VSj)}catch(d){k.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",d.toString())}return a}}Object(t.a)(Rf,"TokenRefreshPolicy",null,[617]);class yi{constructor(){this.Z=null}get name(){return"Common.App.SessionExpiration"}init(){l.AFrameworkApplication.K.wq(()=>
{this.Pac()})}Pac(){this.Z.resolve("Common.ISessionExpirationManagerFactory");this.Z.resolve("Common.ISessionExpirationManager");this.Z.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}Hb(a){this.Z=a;a.register(616,"Common.App.SessionExpiration.ISessionLogger").singleInstance().zd(()=>new wj(th.a.instance));a.register(617,"Common.App.SessionExpiration.ITokenRefreshPolicy").singleInstance().zd(()=>new Rf);a.register(618,"Common.App.SessionExpiration.ITokenRefreshManager").singleInstance().zd(()=>
new Mf(th.a.instance,l.AFrameworkApplication.jH(),a.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),a.resolve("Common.App.SessionExpiration.ISessionLogger"),l.AFrameworkApplication.K.ea("WopiTokenRefreshSendTokenRequestWithoutTasks"),a.sa("Common.ISessionStatus"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1)));a.register(619,"Common.ISessionExpirationManagerFactory").singleInstance().zd(()=>new sc(l.AFrameworkApplication.la,
a.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),a.resolve("Common.App.SessionExpiration.ISessionLogger"),a.sa("Common.ISessionStatus")));a.register(620,"Common.ISessionExpirationManagerWithDialog").singleInstance().zd(()=>a.resolve("Common.ISessionExpirationManagerFactory").create());a.register(621,"Common.ISessionExpirationManager").singleInstance().zd(()=>a.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){M.a.instance.Sb(new yi)}}Object(t.a)(yi,"SessionExpirationPackage",
null,[1,2]);var $i=b(685),he=b(410),fi=b(337),Xg=b(216);class Lm extends Xg.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(t.a)(Lm,"PersonaButtonProps",Xg.a,[]);class Fi{$Bc(a,d){if(a&&!(1>a.length)&&d){var n=Object.assign(new fi.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.U0k(a,n.ControlList);d.push(n)}}U0k(a,d){const n=Object.assign(new $i.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,
Menu:Object.assign(new he.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(d,n);d=Object.assign(new fi.a,{Title:"",ControlList:[]});Array.add(n.Menu.MenuSectionList,d);this.h3k(a,d.ControlList)}h3k(a,d){for(let n=0;n<a.length;n++){const z=Object.assign(new Lm,{ExternalId:String.format("CoauthorPersona_{0}",n),Command:"336231556",DisplayName:a[n].userName,LabelText:a[n].userName,ImageBackColor:a[n].color,PersonaId:a[n].email,IsAnonymous:a[n].isAnonymous});
Array.add(d,z)}}}Object(t.a)(Fi,"PresenceContextMenuSectionBuilder",null,[639]);var Ja=b(71);class sb{constructor(a,d,n,z){this.xEa=this.Mr=this.Kj=this.$d=this.r_a=null;this.Lee=a;this.Onk=z;this.Lee.nJc&&(this.Kj=new bf.a(3,2,5E3,Object(m.a)(this,this.LFk,"authenticationCheckTask"),2),l.AFrameworkApplication.tb.rb(this.Kj),this.lb(d,n));this.Lee.IVh(()=>{this.g7a()});this.Lee.rCf(()=>{this.h7a()})}get zL(){return this.Mr||(this.Mr=la.a.instance.sa("CommonUI.IBusinessBar"))}get P2h(){return this.xEa||
(this.xEa=la.a.instance.sa("CommonUI.IBusinessBarEntryFactory"))}lb(a,d){const n=l.AFrameworkApplication.pa;n.Aa(Sa.a.rGf,Cd.a.frame,a,96);n.Aa(Sa.a.sGf,Cd.a.frame,d,96);n.ma(Sa.a.HKf,Cd.a.frame,Bc.ActionManager.CX);n.ma(Sa.a.IKf,Cd.a.frame,Bc.ActionManager.CX);n.ma(Sa.a.DIe,Cd.a.frame,Bc.ActionManager.CX)}g7a(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);l.AFrameworkApplication.pa.processAction(Sa.a.rGf,2)}h7a(){this.ECn();l.AFrameworkApplication.pa.processAction(Sa.a.sGf,2)}LFk(){this.Lee.authenticationCheck()}ECn(){this.$d&&
(this.$d.hide(),this.$d.dispose(),this.$d=null);this.r_a&&this.zL&&(l.AFrameworkApplication.mi||this.zL.removeEntry(this.r_a),this.r_a.dispose(),this.r_a=null)}showDialog(a){Ja.a.np(this.$d);this.$d=new $g.StandardDialog;this.Onk||(this.$d.Hq=!1,this.$d.wc=0);this.$d.ee(1,CommonUIStrings.l_SignIn);this.$d.kT(CommonUIStrings.l_DefaultDialogTitle,a,Object(m.a)(this,this.zX,"dialogHandler"))}zX(a){1===a?(De.a.gMd(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),l.AFrameworkApplication.pa.processAction(Sa.a.DIe,
2)):(this.dun(),l.AFrameworkApplication.pa.processAction(Sa.a.IKf,2))}dun(){this.zL&&this.P2h&&(this.r_a=this.P2h.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.r_a.closeable=!0,this.r_a.addButton(CommonUIStrings.l_SignIn,sb.Q3b,""),this.r_a.nla=Object(m.a)(this,this.rLk,"businessBarEntryCloseHandler"),this.zL.BB(this.r_a,!1))}rLk(){this.sal();l.AFrameworkApplication.pa.processAction(Sa.a.HKf,2)}sal(){this.Kj&&(l.AFrameworkApplication.tb.ie(this.Kj),
this.Kj=null)}dispose(){this.Kj=this.$d=this.r_a=null}static Q3b(){De.a.gMd();l.AFrameworkApplication.pa.processAction(Sa.a.DIe,2)}}Object(t.a)(sb,"SignOutResponseUI",null,[12]);class ub{get name(){return"Common.App.UI"}Hb(a){a.register(Fi,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").singleInstance()}init(){}dispose(){Ja.a.np(ub.ZFa);ub.ZFa=null}static main(){M.a.instance.Sb(new ub)}static w2l(a,d,n){ub.Stn()&&(ub.ZFa=new sb(De.a.instance,
a,d,n))}static Stn(){return l.AFrameworkApplication.SMc&&!l.AFrameworkApplication.yma}}ub.ZFa=null;Object(t.a)(ub,"CommonAppUIPackage",null,[1,2]);class Cc{get name(){return"Common.App.DialogWithLinkToResource"}Hb(){}init(){}dispose(){}static main(){M.a.instance.Sb(new Cc)}}Object(t.a)(Cc,"CommonAppDialogWithLinkToResourcePackage",null,[1,2]);var ic=b(53);class Ud{constructor(a){this.zA=a;this.Bx=Array.indexOf(this.zA,this.VU)}dispose(){this.zA=null}get VG(){return this.zA[this.Bx]}ou(a){this.SMb(a,
!1);return!0}MHa(a){this.SMb(a,!0)}SMb(a,d){a&&(this.VG!==a||d)&&(a.tabIndex=0,ic.FocusManager.iJ(a));Array.contains(this.zA,a)&&(this.Bx=Array.indexOf(this.zA,a))}get JRe(){let a=this.Bx;do if(a)if(0<a&&a<this.zA.length)a--;else break;else a=this.zA.length-1;while(!kd.DOMFocusListing.fza(this.zA[a])&&a!==this.Bx);return this.zA[a]}get sMe(){let a=this.Bx;do if(a===this.zA.length-1)a=0;else if(0<=a&&a<this.zA.length-1)a++;else break;while(!kd.DOMFocusListing.fza(this.zA[a])&&a!==this.Bx);return this.zA[a]}get VU(){let a=
0;for(;!kd.DOMFocusListing.fza(this.zA[a])&&a<this.zA.length;)a++;return kd.DOMFocusListing.fza(this.zA[a])?this.zA[a]:null}get QVa(){let a=this.zA.length-1;for(;!kd.DOMFocusListing.fza(this.zA[a])&&0<a;)a--;return kd.DOMFocusListing.fza(this.zA[a])?this.zA[a]:null}}Object(t.a)(Ud,"DialogFocusListing",null,[101]);var ae=b(54);class He extends $g.StandardDialog{constructor(a,d,n,z=null){super();this.Ipa=this.Zy=this.yyb=null;this.zA=[];this.Nbe=d;this.mk=a;this.Lak=n;this.aee=z;this.an=new oe.a("LoadResource",
"LoadPrintablePdf")}BSa(){this.wc=5;this.width=40;const a=document.createElement("span");a.id=this.Kg("DirectPrintHeaderContent");const d=document.createElement("span");d.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(d,"DirectPrintHeader");this.Ipa=document.createElement("iframe");this.Ipa.name="pdfObjectFrame";this.Ipa.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.Ipa.onload=Object(m.a)(this,this.bUm,"printablePdfLoaded");if(this.aee&&0<this.aee.count){var n=
Vc.a.Pye(this.Nbe,this.aee);const z=Vc.a.sUe(this.Nbe,this.aee);this.Zy=document.createElement("form");this.Zy.id="printPreviewPostForm";this.Zy.method="POST";this.Zy.target=this.Ipa.name;this.Zy.action=z;for(let O of n)n=document.createElement("input"),n.type="hidden",n.name=O.key,n.value=O.value,this.Zy.appendChild(n)}else this.Ipa.setAttribute("src",this.Nbe);Sys.UI.DomElement.addCssClass(this.Ipa,zf.a.Hae);this.Lak?(Sys.UI.DomElement.addCssClass(this.Ipa,"DirectPrintPdfObjectHidden"),d.innerText=
CommonUIStrings.l_DirectPrintDialogSuccessText,pd.a.Qq(this.Ipa,pd.a.Xu,pd.a.Rm)):(Sys.UI.DomElement.addCssClass(this.Ipa,"DirectPrintPdfObject"),this.zA.push(this.Ipa));a.appendChild(d);a.appendChild(document.createElement("br"));a.appendChild(this.Ipa);this.Zy&&a.appendChild(this.Zy);a.appendChild(document.createElement("br"));a.appendChild(this.fXk(this.Zy?"#":this.Nbe));this.an.start();this.P6a(CommonUIStrings.l_AppTitle,null,null,null,null,a);this.k5(this.Kg("DirectPrintHeaderContent"));this.Zy&&
this.Zy.submit();this.V0k();k.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}fXk(a){const d=document.createElement("span");var n=document.createElement("span");n.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;d.appendChild(n);l.AFrameworkApplication.K&&(2===l.AFrameworkApplication.la.eb.Bm&&l.AFrameworkApplication.K.ea("PPTDisableDirectPrintDialogDownloadPDFLink")||1===l.AFrameworkApplication.la.eb.Bm&&l.AFrameworkApplication.K.ea("XLODisableDirectPrintDialogOpenPDFLink"))?
(a=document.createElement("span"),2===l.AFrameworkApplication.la.eb.Bm?a.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===l.AFrameworkApplication.la.eb.Bm&&(a.innerText=CommonUIStrings.l_InternalError_Directive,k.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.yyb=a,d.appendChild(document.createElement("br")),d.appendChild(a)):(n=document.createElement("a"),n.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,n.href=a,n.target=
"_blank",n.id="PrintPDFLink",n.className="AllowBrowserClick",this.yyb=n,d.appendChild(document.createElement("br")),d.appendChild(n),this.Zy&&Qc.a.addHandler(n,"click",Object(m.a)(this,this.sKm,"onSubmit")),this.mk.Ea(vb.a.click,this.yyb,Object(m.a)(this,this.Iii,"downloadPDFLinkClicked"),null));this.zA.push(this.yyb);return d}sKm(a){this.Zy&&(this.Zy.target="_blank",this.Zy.submit());a.preventDefault()}V0k(){if(0<this.zA.length){const a=new Ud(this.zA),d=ic.FocusManager.instance().rk();d&&(this.yyb.focus(),
d.Tf=a,d.MS=!0)}}Iii(){k.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}RGd(){k.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}bUm(){k.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.an&&this.an.stop()}dispose(){this.yyb&&(this.mk.kb(vb.a.click,this.yyb,Object(m.a)(this,this.Iii,"downloadPDFLinkClicked")),this.yyb=null);ae.a.Fr(this.Ipa);this.Ipa=null;super.dispose()}}Object(t.a)(He,"DirectPrintDialog",
$g.StandardDialog,[664]);class lf{constructor(a){this.mk=a}dyl(a,d,n=null){return new He(this.mk,a,d,n)}}Object(t.a)(lf,"DirectPrintDialogFactory",null,[653]);class Of{constructor(a,d){this._url=a;this.iik=d}zhi(){this.iik?Ye.a.downloadFile(this._url):Ye.a.Tk(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(t.a)(Of,"OpenUrlInTabDialogDownloadBehavior",null,[668,12]);class hf extends $g.StandardDialog{constructor(a,d=!0,n=!1,z=null,O=null,ca=!1){super();
this.Tsc=this.Ssc=this.Zy=this.o$=null;var Da=this.eah?this.eah:CommonUIStrings.l_DefaultDialogTitle;hf.VHc=ca;this.sdf=z||new Of(a,!0);const Xa=[],zb=[];hf.FQ&&(this.Yie&&this.Yie.forEach(Yc=>{Array.add(Xa,Yc)}),this.aXh&&this.aXh.forEach(Yc=>{Array.add(zb,Yc)}));d?n?(this.wc=4,this.ee(1,this.buttonText),this.ee(2,CommonUIStrings.l_DialogClose)):(this.wc=6,this.ee(0,CommonUIStrings.l_DialogClose)):this.wc=5;ca=document.createElement("span");this.Hnd&&(ca.className=this.Hnd);z=document.createElement("a");
z.innerText=this.PLc;z.href=a;z.target="_blank";z.id=this.kGd;z.className=Ec.AFrame.eje;var Vb=!I.a.dV&&!!O&&0<O.count;if(Vb){const Yc=Vc.a.Pye(a,O);O=Vc.a.sUe(a,O);z.href="#";z.target="_self";this.Zy=document.createElement("form");this.Zy.id="printPreviewPostForm1";this.Zy.method="post";this.Zy.target="_blank";this.Zy.action=O;for(var Fc of Yc)O=document.createElement("input"),O.type="hidden",O.name=Fc.key,O.value=Fc.value,this.Zy.appendChild(O)}else this.Zy=null;this.Zy||hf.VHc?hf.VHc||Array.add(zb,
{["type"]:"AppLinkProps",["id"]:this.kGd,["text"]:this.PLc,["onExecute"]:()=>{this.Gjj()}}):Array.add(zb,{["type"]:"AppLinkProps",["id"]:this.kGd,["text"]:this.PLc,["handler"]:{["href"]:Vb?"#":a,["target"]:Vb?"_self":"_blank"}});this.lqb&&Array.add(Xa,this.lqb);n?(a=document.createElement("span"),a.innerText=this.lqb.replace("{0}",""),ca.appendChild(a)):this.t4i?(a=document.createElement("span"),a.id=this.Kg("message"),Fc=document.createElement("span"),O=document.createElement("span"),Vb=this.lqb.split("{0}"),
Fc.innerText=Vb[0],O.innerText=Vb[1],a.appendChild(Fc),a.appendChild(z),a.appendChild(O),ca.appendChild(a)):(a=document.createElement("span"),a.innerText=this.lqb,ca.appendChild(a),ca.appendChild(document.createElement("br")),ca.appendChild(document.createElement("br")),ca.appendChild(z),hf.VHc||Array.add(Xa,"{0}"));this.Zy&&ca.appendChild(this.Zy);hf.FQ&&(this.JIb&&(this.UFd?this.cie(this.JIb,this.UFd):(Array.add(Xa,"{0}"),Array.add(zb,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.JIb,
["onExecute"]:()=>{}}))),this.k2b(Xa,zb));this.P6a(Da,null,this.Xhg,null,Object(m.a)(this,this.zX,"dialogHandler"),hf.FQ?null:ca);this.k5(this.Kg("message"));!hf.FQ&&this.UFd&&this.JIb&&(Da=document.createElement("div"),Da.className="WACDialogLearnMoreLinkContainer",this.o$=document.createElement("a"),this.o$.innerText=this.JIb,this.o$.href=this.UFd,this.o$.target="_blank",this.o$.id=this.Kg("LearnMoreLinkId"),this.o$.className=Ec.AFrame.eje,Da.appendChild(this.o$),d?this.xb.insertBefore(Da,this.xb.lastChild):
this.xb.appendChild(Da),this.k5(String.format("{0} {1}",this.Kg("message"),this.Kg("LearnMoreLinkId"))));this.w0c=z;n?this.$Y(this.Tu):this.$Y(this.w0c);this.Wwg();l.AFrameworkApplication.la.dZ.Ea(vb.a.click,this.w0c,Object(m.a)(this,this.Hii,"downloadLinkClicked"),null);this.o$&&l.AFrameworkApplication.la.dZ.Ea(vb.a.click,this.o$,Object(m.a)(this,this.uXi,"learnMoreLinkClicked"),null);this.fW=!1}get Xhg(){return null}get eah(){return null}get lqb(){return null}get UFd(){return null}get JIb(){return null}get t4i(){return!1}get buttonText(){return CommonUIStrings.l_Open}get Hnd(){return null}get Yie(){return null}get aXh(){return null}Yka(){this.Zy&&
(this.Ssc||(this.Ssc=Object(m.a)(this,this.MBm,"onActionButtonClicked"),this.Jl.Ea(vb.a.click,this.Tu,this.Ssc)),this.Tsc||(this.Tsc=Object(m.a)(this,this.NBm,"onActionButtonKeyUp"),this.Cc.Ea(vb.a.Of,this.Tu,this.Tsc)));super.Yka()}MBm(a){this.Sli(a);return!0}NBm(a){return this.Kdc(a,Object(m.a)(this,this.Sli,"executeDismissActionButtonFromArgs"))}Sli(a){this.Zy&&this.Zy.submit();this.USa(a.Ec)}RGd(){}Hii(){this.Xwg();this.Zy?this.Zy.submit():this.sdf.zhi();return!0}uXi(){return!1}dispose(){this.sdf.dispose();
this.w0c&&(l.AFrameworkApplication.la.dZ.kb(vb.a.click,this.w0c,Object(m.a)(this,this.Hii,"downloadLinkClicked")),this.w0c=null);this.o$&&(l.AFrameworkApplication.la.dZ.kb(vb.a.click,this.o$,Object(m.a)(this,this.uXi,"learnMoreLinkClicked")),this.o$=null);this.Jl&&this.Ssc&&(this.Jl.kb(vb.a.click,this.Tu,this.Ssc),this.Ssc=null);this.Cc&&this.Tsc&&(this.Cc.kb(vb.a.Of,this.Tu,this.Tsc),this.Tsc=null);super.dispose()}Gjj(){this.Zy&&(document.body.appendChild(this.Zy),this.Zy.submit(),document.body.removeChild(this.Zy))}zX(a){1===
a&&(this.RGd(),this.Zy?hf.FQ&&this.Gjj():this.sdf.zhi());this.dispose()}static get FQ(){return l.AFrameworkApplication.la.eb.wz&&l.AFrameworkApplication.la.eb.trg}static get VHc(){return hf.Qyh}static set VHc(a){hf.Qyh=a}}hf.Qyh=!1;Object(t.a)(hf,"ADialogWithLinkToResource",$g.StandardDialog,[]);class rh extends hf{constructor(a,d,n=null,z=!0,O=!1){super(a,!0,!(rh.sPb&&z),new Of(a,d),n,O);rh.sPb=rh.sPb&&z;if(rh.sPb){d=document.createElement("iframe");z=null;O=this.xgi;d.name="pdfObjectFrame";d.id=
"pdfObjectIFrame";if(n&&0<n.count){const ca=Vc.a.Pye(a,n);a=Vc.a.sUe(a,n);z=document.createElement("form");z.id="printPreviewPostForm";z.method="POST";z.target=d.name;z.action=a;for(let Da of ca)a=document.createElement("input"),a.type="hidden",a.name=Da.key,a.value=Da.value,z.appendChild(a)}else d.src=a;O.appendChild(d);z&&(O.appendChild(z),z.submit());Sys.UI.DomElement.addCssClass(d,"DirectPrintPdfObjectHidden");pd.a.Qq(d,pd.a.Xu,pd.a.Rm)}}get Xhg(){return"Print_32x32x32"}get eah(){return rh.sPb?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get lqb(){return rh.sPb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get Yie(){const a=[];Array.add(a,CommonUIStrings.l_PrintDialogCanCloseDocument);if(hf.VHc){let d=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==l.AFrameworkApplication.la.eb.UTf&&(d=l.AFrameworkApplication.la.eb.UTf);Array.add(a,d)}return rh.sPb?a:null}get PLc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get kGd(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get Hnd(){return l.AFrameworkApplication.zSa?
"UIFontDialogTextLarge":null}Wwg(){k.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}Xwg(){l.AFrameworkApplication.ug.dsa(9540,1);k.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}RGd(){k.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get sPb(){return!!l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.wz&&l.AFrameworkApplication.K.ea("DirectPrintDialogAsStandardDialogIsEnabled")&&!(I.a.dV||I.a.Ah||I.a.Og||I.a.Qcc)&&!l.AFrameworkApplication.ldc&&
l.AFrameworkApplication.K.ea("ShouldHostDefaultToNativeBrowserPrintExperience")}static set sPb(a){}}Object(t.a)(rh,"PrintDialogWithLinkToPdf",hf,[]);class Li{constructor(a){this.isEnabled=Boolean.parse(a.DirectPrintIsEnabled||"false");this.aem=Boolean.parse(a.DirectPrintProbeIsEnabled||"false");this.Nbm=Boolean.parse(a.DirectPrintEnabledForInternetExplorer||"false");this.Zmc=(a.DirectPrintSupportedMimeTypes||"").split(Li.SWf);this.sOb=(a.DirectPrintSupportedPlugins||"").split(Li.SWf);this.o1l=(a.DirectPrintImmersivePreviewPlugins||
"").split(Li.SWf);this.UQi=Boolean.parse(a.DirectPrintEnabledForEdge||"false");this.K8l=Boolean.parse(a.ChromePrintLayoutFixIsEnabled||"false");this.wRk=parseInt(a.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.xAg=14;this.E4i=14394;if(a=a.DirectPrintMinimalSupportedEdgeVersion){const d=a.split(".");2===d.length?(this.xAg=parseInt(d[0]),this.E4i=parseInt(d[1])):k.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",a)}else k.ULS.sendTraceTag(20734113,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}Li.SWf=",";Object(t.a)(Li,"DirectPrintBrsSettings",null,[]);class Jj{constructor(a,d){this.T8g=a;this.sOb=d}}Object(t.a)(Jj,"DirectPrintProbeResults",null,[]);var Fg=b(185);class Ni{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb){this.Uge=null;this.s7j=a;this.f8c=d;this.Vnf=n;this.Ock=z;this.Kdk=O;this.M$c=new Nf.a(Object(m.a)(this,this.cLl,"getProbeResults"));this.Yxb=ca;this.fEh=zb;this.Q2=Da;this.r5c=Xa;this.aek=
Vb}get BX(){return this.s7j}start(){}mUm(){this.BX.aem&&this.Upm()}MXm(){const a=Array(this.BX.Zmc.length);if(void 0!==this.f8c&&null!==this.f8c)for(let d=0;d<this.BX.Zmc.length;d++)a[d]=this.BX.Zmc[d]in this.f8c&&this.Ock(this.f8c[this.BX.Zmc[d]]);return a}NXm(){const a=Array(this.BX.sOb.length),d=!(void 0===this.Vnf||null===this.Vnf);for(let n=0;n<this.BX.sOb.length;n++){const z=this.BX.sOb[n];a[n]=d&&z in this.Vnf?!0:this.Kdk(z)}return a}LPl(){const a=this.MXm(),d=Array(a.length);for(let n=0;n<
a.length;n++)d[n]=a[n]?this.sil(this.f8c[this.BX.Zmc[n]]):null;return d}sil(a){if(void 0===a||null===a)return null;a=a.enabledPlugin;return void 0===a||null===a?null:a.name}Upm(){k.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.M$c.value.T8g,this.M$c.value.sOb)}cLl(){var a=this.LPl();const d=this.NXm(),n={},z={};for(let O=0;O<this.BX.Zmc.length;O++)n[this.BX.Zmc[O]]=a[O];for(a=0;a<this.BX.sOb.length;a++)z[this.BX.sOb[a]]=d[a];return new Jj(n,z)}Mtn(){return this.aek||!this.BX.isEnabled||
l.AFrameworkApplication.ldc?!1:this.SAn()}Qtn(){if(null!=this.Uge)return this.Uge;const a=Ni.TQi(this.BX);return this.Uge=this.BX.UQi&&a||this.J8l()}J8l(){return I.a.el&&this.BX.K8l&&I.a.E6h>=this.BX.wRk?!0:!1}SAn(){if(!this.r5c(this.BX))return!1;var a=ta.a.getValues(this.M$c.value.T8g);for(const d of a)if(void 0!==d&&null!==d)return!0;a=ta.a.getValues(this.M$c.value.sOb);for(const d of a)if(d)return!0;return!1}RYl(){const a=ta.a.getValues(this.M$c.value.T8g);for(const d of a)if(Fg.a.contains(this.BX.o1l,
d))return!0;return!1}Nvn(a,d=null){l.AFrameworkApplication.la&&l.AFrameworkApplication.K.ea("DirectPrintDialogAsStandardDialogIsEnabled")?this.fEh(a,d):this.Mtn()?this.lbl(a,this.RYl()&&!0,d):this.fEh(a,d)}lbl(a,d,n=null){const z=this.Q2.Pe("UserAction","OpenDirectPrintDialog");this.Yxb.dyl(a,d,n).BSa();z.stop()}static Yfm(a){try{return new ActiveXObject(a),!0}catch(d){k.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",a)}return!1}static R$l(a){return void 0===a||
null===a?!1:!(void 0===a.enabledPlugin||null===a.enabledPlugin)}static create(a){const d=new Li(l.AFrameworkApplication.K.appSettings);let n=null;try{n=window.navigator.mimeTypes}catch(Vb){k.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let z=null;try{z=window.navigator.plugins}catch(Vb){k.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const O=Ni.R$l,ca=Ni.Yfm;a=a.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const Da=l.AFrameworkApplication.la.Np,
Xa=Ni.$fm,zb=!!l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.wz&&!l.AFrameworkApplication.K.ea("PrintDialogFallbackLinkEnabled");return new Ni(d,n,z,O,ca,a,Da,Xa,(Vb,Fc)=>new rh(Vb,!1,Fc,!0,zb),l.AFrameworkApplication.yma)}static $fm(a){return I.a.el||I.a.Ah&&a.Nbm||a.UQi&&Ni.TQi(a)?!0:!1}static TQi(a){var d=I.a.gEb;if(d){var n=d.split(".");if(2===n.length)return d=parseInt(n[0]),n=parseInt(n[1]),d>a.xAg||d===a.xAg&&n>=a.E4i}return!1}}Object(t.a)(Ni,"DirectPrintManager",null,[638]);class di{constructor(){this.GSb=
this.Z=null}get name(){return"Common.App.DirectPrint"}Hb(a){this.Z=a;a.register(lf,"Common.App.DirectPrint.DirectPrintDialogFactory").singleInstance().zd(()=>new lf(l.AFrameworkApplication.la.dZ));a.register(638,"Common.App.DirectPrint.IDirectPrintManager").singleInstance().zd(()=>Ni.create(this.Z))}init(){this.GSb=this.Z.resolve("Common.App.DirectPrint.IDirectPrintManager");this.GSb.start()}dispose(){}}Object(t.a)(di,"PackageManager",null,[1,2]);class Il{constructor(a,d=3E4){this.rah=9E5;this.tah=
1E4;this.S1i=this.jMc=null;this.oyg=0;this.Znd=Date.now;this.jAe=a;this.X1e=d;this.Ove()}QFi(a=!0){const d=this.Znd();if(d<this.oyg+this.rah)return d>this.oyg+this.tah&&this.Ove(),this.S1i;a&&this.Ove();return null}getToken(a=!0){return(a=this.QFi(a))?Promise.resolve(a):this.Ove()}Ove(){return this.jMc=this.jMc||new Promise(a=>{this.jAe().then(d=>{this.jMc=null;""!==d&&d&&(this.S1i=d,this.oyg=this.Znd(),a(d));a(null)}).catch(()=>{this.jMc=null;a(null)});window.setTimeout(()=>{this.jMc=null;a(null)},
this.X1e)})}}Object(t.a)(Il,"OAuthCacheManager",null,[]);class Jc{static RHa(a){return""!==a&&a?Jc.oCk[a.toLowerCase()]:""}static rRl(a,d){const n=Date.now();var z=Jc.rXk();const O=l.AFrameworkApplication.K.Ga("UserPrincipalName"),ca=Jc.RHa(a);k.ULS.sendTraceTag(593862986,1300,50,"Begin SSO Request for app: "+a);if(""===O||!O)return k.ULS.sendTraceTag(593862985,1300,10,"Missing login hint for silent oAuth"),Promise.resolve("");if(""===ca||!ca)return k.ULS.sendTraceTag(593862984,1300,10,"Missing AAD appId for appName: "+
a),Promise.resolve("");const Da=xa.a.create().toString();z=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&login_hint={3}&redirect_uri={4}&state={5}&prompt=none","https://login.microsoftonline.com",ca,encodeURIComponent(d),encodeURIComponent(O),encodeURIComponent(z),Da);const Xa=document.createElement("iframe");Xa.style.display="none";Xa.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin");Xa.src=z;document.body.appendChild(Xa);
return new Promise(zb=>{Jc.Jxm(Xa.contentWindow).then(Vb=>{document.body.removeChild(Xa);const Fc=new yb.a,Yc=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let yd;for(;yd=Yc.exec(Vb);)3!==yd.length&&(k.ULS.sendTraceTag(593862983,1300,10,"Unexpected Hash respones in OAuth header! Match length: {0}",yd.length),zb("")),Fc.$(yd[1],yd[2]);Fc.Na("access_token")?(k.ULS.sendTraceTag(593862982,1300,50,"SSO Request successful for resource: {0} for app: {1} Latency: {2}",d,a,Date.now()-n),zb(Fc.J("access_token"))):
(k.ULS.sendTraceTag(526668183,1300,10,"SSO Request failure for resource: {0} for app: {1}. Latency: {2}",d,a,(Date.now()-n).toString()),zb(""))}).catch(Vb=>{try{document.body.removeChild(Xa)}catch(Fc){}k.ULS.sendTraceTag(593862980,1300,10,"SSO Request failure for resource: {0} for app: {1} Error: {2} Latency: {3}",d,a,JSON.stringify(Vb),(Date.now()-n).toString());zb("")})})}static rXk(){const a=window.location.protocol,d=window.location.host;var n=l.AFrameworkApplication.K.Ga("OAuthManagerHostPathOverride");
if(void 0===n||null===n){n=window.location.pathname;const z=n.lastIndexOf("/");n=0<=z?n.substring(0,z+1):""}return a+"//"+d+n+"WacOAuth.html"}static Jxm(a){return new Promise((d,n)=>{let z=0,O=0;O=window.setInterval(()=>{if(200<z++)window.clearInterval(O),n("Exceeded 10000ms timeout after 200 polls");else{var ca=null,Da=null;try{if(!a||a.closed){window.clearInterval(O);n("Window or Frame is closed before completion");return}ca=a.location.href;Da=a.location.hash}catch(Xa){}ca&&"about:blank"!==ca&&
Da&&""!==Da&&(window.clearInterval(O),d(Da))}},50)})}}Jc.oCk={["smartlookup"]:"4d5c2d63-cf83-4365-853c-925fd1a64357",["search"]:"a9b49b65-0a12-430b-9540-c80b3332c127"};Object(t.a)(Jc,"OAuthHelper",null,[]);class wf{constructor(a,d){this.token=a;this.source=d}}Object(t.a)(wf,"TokenResult",null,[]);var Ze=b(96),Yh=b(232);class en{constructor(){this.CBa=null;this.gvh={};this.BUc=new ia.a(ma.a.Xi())}getToken(a,d,n=!1){if(this.BUc.Na(d))return this.BUc.J(d).getToken();const z=new Il(()=>n?this.RFi(a,d):
this.jAe(a,d));this.BUc.$(d,z);return z.getToken()}pRl(a,d=!1){if(this.BUc.Na(a))return this.BUc.J(a).QFi();const n=new Il(()=>d?this.RFi("SmartLookup",a):this.jAe("SmartLookup",a));this.BUc.$(a,n);return null}jAe(a,d){const n=Date.now();return Jc.rRl(a,d).then(z=>new wf(z,"SSOStack")).then(z=>new Promise(O=>{z.token&&""!==z.token?(k.ULS.sendTraceTag(593862979,1300,50,"{0}: SSO Token resolved from {1}. Latency: {2}",a,z.source,Date.now()-n),this.IMb("GetTokenInternal",!0,Date.now()-n,a,"","",d),O(z.token)):
(k.ULS.sendTraceTag(593862978,1300,50,"{0}: SSO Token provider failed! Latency: {1}",a,Date.now()-n),this.IMb("GetTokenInternal",!1,Date.now()-n,a,"GetTokenSilent Failed","SSO Token provider failed!",d),O(""))}))}RFi(a,d){if(!this.CBa)try{this.CBa=la.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(n){k.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+n)}return this.CBa?new Promise(n=>{const z=Date.now();this.CBa.xLa(a,d).then(O=>{const ca=O.Token;!O.IsSuccess||this.Mgm(ca)?
(this.IMb("GetTokenInternalImplicitJS",!1,Date.now()-z,a,O.ErrorCode,O.ErrorMessage,d),n(null)):(this.IMb("GetTokenInternalImplicitJS",!0,Date.now()-z,a,O.ErrorCode,O.ErrorMessage,d),n(ca))}).catch(O=>{O=O?x.c(O):"";this.IMb("GetTokenInternalImplicitJS",!1,Date.now()-z,a,"Caught Exception",O,d);n(null)})}):new Promise(n=>{this.IMb("GetTokenInternalImplicitJS",!1,0,a,"Null OAuthManager","OAuthManager not set");n(null)})}IMb(a,d,n,z,O="",ca="",Da=""){var Xa="Search"===z;const zb=[];a=Ze.a.v7(Xa?"Event":
"EventName",a,2);z=Ze.a.v7("AppName",z,2);Array.add(zb,a);Array.add(zb,z);Xa&&(z=Ze.a.v7("LatencyType","FetchToken",2),Array.add(zb,z));O&&""!==O&&(O=Ze.a.v7("ErrorCode",O,2),Array.add(zb,O));ca&&""!==ca&&(ca=Ze.a.v7("ErrorMessage",ca,2),Array.add(zb,ca));Da&&""!==Da&&(ca=!(Da in this.gvh),this.gvh[Da]=ca,ca=Ze.a.v7("WarmUpCall",ca.toString(),1),Array.add(zb,ca),Da=Ze.a.v7("Service",this.mOl(Da),2),Array.add(zb,Da));Xa=Xa?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";
d=Object.assign(new Yh.a,{name:Xa,samplingPolicy:2,dataFields:zb,succeeded:d,durationMs:n});R.a.sendActivityEvent(d)}mOl(a){return a===l.AFrameworkApplication.kHd?"Loki":a===l.AFrameworkApplication.kXd?"Substrate":l.AFrameworkApplication.K&&a===l.AFrameworkApplication.K.Ga("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}Mgm(a){return!a||!a.length}}Object(t.a)(en,"SearchOAuthManager",null,[615]);class wi{constructor(){this.Z=null}get name(){return"Common.App.SearchOAuthManager"}Hb(a){this.Z=
a;this.Z.register(615,"Common.App.SearchCommon.ISearchOAuthManager").singleInstance().zd(()=>new en)}init(){}dispose(){}static main(){M.a.instance.Sb(new wi)}}Object(t.a)(wi,"SearchOAuthPackage",null,[1,2]);var Uj=b(199),Dd=b(5),Kd=b(21),Qd=b(19),Bd=b(10);class Ei{constructor(a,d,n){this.Qof=this.NZb=this.Mof=this.LZb=this.Dlf=null;this.jk=a;this.e8j=d;this.Da=n;this.init()}init(){this.e8j.Ea(Object(m.a)(this,this.HVl,"handleEditingViewUpdatesSafe"));this.LZb=new cg.a;this.Mof=new cg.a;this.NZb=new cg.a;
this.Qof=new Uj.a}Pca(a){this.LZb.add(a.key,a)}lQc(a){this.NZb.add(a.key,a)}HVl(a){try{this.GVl(a)}catch(d){a=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",d.message,d.stack),k.ULS.sendTraceTag(5285580,334,10,a)}}GVl(a){let d;({ETf:d}=Ei.IHn(this.Da.ya.Ba,d)).returnValue&&(a=Ei.dwl(a,this.Dlf,d),this.FUm(a,d),this.Dlf=d)}FUm(a,d){a=this.krl(a,d);let n;({notification:n}=Ei.zHn(a,n)).returnValue&&this.jk.sendNotification(n,!1)}krl(a,d){const n=
new cg.a;n.$(1,new Uj.a);n.$(0,new Uj.a);a.forEach(z=>{3===z?(Ei.r4g(d.node)||this.kan(d),this.kJl(n,d)):z||this.zwl(n,d);return!0});return n}kan(a){this.LZb.forEach((d,n)=>{n.reset(a);return!0})}zwl(a,d){let n=new cg.a;Ei.r4g(d.node)||(n=this.xwl(d.cpBegin));this.ywl(a,this.Mof,n,Ei.Puj(this.Dlf,d));this.Mof=n}xwl(a){const d=new cg.a;this.LZb.forEach((n,z)=>{n=null;({wL:n}=z.oZa(a)).returnValue&&d.$(z.key,n);return!0});return d}ywl(a,d,n,z){const O=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;
d.forEach((ca,Da)=>{const Xa=this.LZb.J(ca).jz||Da.title;let zb;({value:zb}=n.Ab(ca)).returnValue?z&&zb.contentObject!==Da.contentObject&&(Xa&&a.J(1).add(Xa),ca=this.LZb.J(ca).jz,ca=String.format(O,zb.title,ca),zb.description&&(ca+=", "+zb.description),a.J(0).add(ca)):Xa&&a.J(1).add(Xa);return!0});n.forEach((ca,Da)=>{d.Na(ca)||(ca=this.LZb.J(ca).jz,ca=String.format(O,Da.title,ca),Da.description&&(ca+=", "+Da.description),a.J(0).add(ca));return!0})}kJl(a,d){d=this.kPl(d.node);d=this.jUk(d);this.lPl(a,
this.Qof,d);this.Qof=d}kPl(a){const d=new Dd.GraphIterator;d.set(a);if(!d.La(1))return null;const n=new Uj.a;for(;1!==d.Yc;)this.NZb.forEach((z,O)=>{let ca;({Bya:ca}=O.$Uc(d)).returnValue&&n.add(ca);return!0}),d.hb();n.reverse();return n}jUk(a){a=a.toArray();let d=0;for(;d<a.length-1;){var n=a[d];if(n.PK===a[d+1].PK&&(this.NZb.J(n.PK),({lUk:n}={returnValue:!1,lUk:null}).returnValue)){a.splice(d,2,n);continue}d++}return new Uj.a(a)}lPl(a,d,n){var z;for(z=0;z<Math.min(n.length,d.length)&&n.J(z).contentId.equals(d.J(z).contentId);z++){var O=
this.NZb.J(n.J(z).PK).Z8b(n.J(z),d.J(z));O&&(n.J(z).description&&(O+=", "+n.J(z).description),a.J(0).add(O))}for(O=z;O<n.length;O++){let ca=this.NZb.J(n.J(O).PK).Z8b(n.J(O),null);ca&&(n.J(O).description&&(ca+=", "+n.J(O).description),a.J(0).add(ca))}for(n=z;n<d.length;n++)(z=this.NZb.J(d.J(n).PK).jz)&&a.J(1).add(z)}static dwl(a,d,n){const z=new Uj.a;(a=a||Ei.tgn(d,n))?(z.add(3),z.add(0)):Ei.Puj(d,n)&&z.add(0);return z}static tgn(a,d){return!a||!a.node.id.equals(d.node.id)}static Puj(a,d){return!a||
!a.equals(d)}static IHn(a,d){d=null;if(!a||!(Qd.SelectionEditor.qj(a)||(a=Qd.SelectionEditor.Xf(a,!0,!1),Qd.SelectionEditor.qj(a)||a.ra&&Ei.r4g(a.ra.node))))return{returnValue:!1,ETf:d};d=a.ra;return{returnValue:!!d,ETf:d}}static zHn(a,d){const n=new Uj.a;a.J(1).forEach(z=>{z=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,z);n.add(z);return!0});a.J(0).forEach(z=>{z=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,z);n.add(z);return!0});d=n.toArray().join(" ");
return{returnValue:0<n.length,notification:d}}static r4g(a){return Kd.ImageReader.Xr(a)||Bd.ParagraphReader.qla(a)}}Object(t.a)(Ei,"AccessibilityContextManager",null,[613]);class mo{constructor(a,d){this.gCh=!1;this.sbd=null;this.Zde=this.Oge=!1;this.Fuh=null;this.fb=a;this.rZ=d}get xZl(){return!!this.sbd}Ea(a){this.gCh||(this.rZ.YVh(Object(m.a)(this,this.aje,"afterEditingViewValidateEventHandler")),this.gCh=!0);this.Fuh=a}aje(a,d){(d.QV||d.Qta)&&this.EAm(d.QV,d.Qta)}EAm(a,d){this.xZl&&this.fb.ie(this.sbd);
this.Oge=this.Oge||a;this.Zde=this.Zde||d;this.sbd=new bf.a(5,1,mo.Zgl,()=>{this.Fuh(this.Oge,this.Zde);this.reset()},126);this.fb.rb(this.sbd)}reset(){this.sbd=null;this.Zde=this.Oge=!1}}mo.Zgl=100;Object(t.a)(mo,"EditingViewOnAfterValidateEventsConsolidator",null,[612]);var Lg=b(49);class co{constructor(){this.Z=null}get name(){return"Box4.Accessibility"}init(){Lb.App.ike&&this.Z.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}Hb(a){this.Z=a;a.ha("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",
()=>new mo(l.AFrameworkApplication.tb,a.resolve("Box4.ContentEditableViewEventSource"))).as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").singleInstance();a.ha("Box4.Accessibility.AccessibilityContextManager",()=>new Ei(a.resolve("Common.Utils.IAriaNotifier"),a.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),Lg.a.instance)).as("Box4.Accessibility.IAccessibilityContextManager").singleInstance()}static main(){M.a.instance.Sb(new co)}}Object(t.a)(co,
"Box4AccessibilityPackage",null,[1,2]);var Ch=b(143),vk=b(911),qf=b(1458),Mm=b(797),Mh=b(187),uo=b(1339),Ff=b(44),ye=b(24),hg=b(122),fe=b(30),Mb=b(3);class Nh extends uo.a{constructor(){super(...arguments);this.UJh=this.tpa=null}get tga(){return this.tpa||(this.tpa=la.a.instance.sa("Box4.IInternalLinkManager"))}get rfj(){return this.UJh||(this.UJh=la.a.instance.sa("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy"))}get WF(){return!0}get commandId(){return Mb.a.P_h}bza(a){Mh.a.mark(7012);const d=
new Ff.GraphTransaction(15);d.Sa(a);var n=this.zK,z=this.h8,O=Bd.ParagraphReader.text(a),ca=O.substring(n,z);const Da=({xqb:Xa}=w.a.bXd(ca)).returnValue;ca!==Da&&(n+=Xa,z=n+Da.length);ca=fe.a.createTextRange(a,n,z);var Xa=O.substring(n,z);Nh.Ibm(O,n,z)&&(this.hc.replaceTextRange(fe.a.createTextRange(a,n-1,z+1),Xa,!0,!1),--n,--z,ca=fe.a.createTextRange(a,n,z),n=ye.SelectionFactory.Pc(a,z),Lg.a.instance.setSelection(n));n=hg.HyperlinkReader.ega(Xa);Nh.hyperlinkEditor.vP(ca,n,!1);O=Xa="";z=!1;this.tga&&
({KTg:Xa,wri:O}=this.tga.kbh(n)).returnValue&&(n=Xa,z=!0,Xa=hg.HyperlinkReader.vw(ca,!1),Nh.hyperlinkEditor.EV(Xa[0].paragraph,Xa[0].hyperlink),""!==O&&(this.hc.replaceTextRange(ca,O,!0,!1),ca=fe.a.createTextRange(a,this.zK,this.zK+O.length),a=ye.SelectionFactory.Pc(a,this.zK+this.zK+O.length),Lg.a.instance.setSelection(a)),Nh.hyperlinkEditor.vP(ca,n,!1));d.dispose();!z&&this.rfj&&this.rfj.fSm(ca,n);Mh.a.mark(7013)}set WF(a){super.WF=a}static get hyperlinkEditor(){return Nh.lk||(Nh.lk=la.a.instance.resolve("Box4.IHyperlinkEditor"))}static Ibm(a,
d,n){n=n!==a.length&&('"'===a.charAt(n)||"\u201d"===a.charAt(n));return!!d&&('"'===a.charAt(d-1)||"\u201c"===a.charAt(d-1))&&n}}Nh.lk=null;Object(t.a)(Nh,"HyperlinkAction",uo.a,[]);class zg{constructor(a){this.hc=a}u1k(a,d,n){return new Nh(null,a,d,n,this.hc)}}Object(t.a)(zg,"HyperlinkActionFactory",null,[602]);var aj=b(231);class oh{constructor(){this.Z=null}get name(){return"Box4.AutoCorrect"}Hb(a){this.Z=a;a.ha("Box4.AutoCorrect.AutoCorrectRules",()=>new qf.a(a.resolve("Box4.IHyperlinkActionFactory"),
a.resolve("Box4.ICharacterPropertiesEditor"),aj.a.instance,l.AFrameworkApplication.pa,l.AFrameworkApplication.K,a.resolve("Box4.IAutoCorrectOptionsInfo"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)).as("Box4.IAutoCorrectRules").singleInstance();a.ha("Box4.AutoCorrect.AutoCorrectOptionsInfo",()=>new vk.a(a.resolve("Box4.IRoamingServiceRequestManager"),l.AFrameworkApplication.K.ea("ReplaceQuoteWithSmartQuoteIsEnabled"))).as("Box4.IAutoCorrectOptionsInfo").singleInstance();a.ha("Box4.AutoCorrect.AutoCorrectScheduler",
()=>new Mm.a(a.resolve("Box4.IAutoCorrectRules"),Lg.a.instance,Ch.a.instance,l.AFrameworkApplication.K,a.resolve("Box4.IAutoCorrectOptionsInfo"),a.resolve("Box4.IUndoManager"),a.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AParagraphNode>"))).as("Box4.IAutoCorrectScheduler").singleInstance();a.ha("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new zg(a.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.IHyperlinkActionFactory").singleInstance()}init(){this.Z.resolve("Box4.IAutoCorrectRules").slm();
const a=l.AFrameworkApplication.K;a.ea("AutoCorrectOptionSettingIsEnabledForWordOnline")&&a.ea("IsRoamingServiceEnabled")&&this.Z.resolve("Box4.IAutoCorrectOptionsInfo").Dsl()}dispose(){}static main(){M.a.instance.Sb(new oh)}}Object(t.a)(oh,"Box4AutoCorrectPackage",null,[1,2]);class Pk{get name(){return"Box4.Clipboard"}init(){}dispose(){}Hb(){}static main(){M.a.instance.Sb(new Pk)}}Object(t.a)(Pk,"Box4ClipboardPackage",null,[1,2]);class Ck{get name(){return"Box4.ImageEditors"}Hb(){}init(){}dispose(){}static main(){M.a.instance.Sb(new Ck)}}
Object(t.a)(Ck,"Box4ImageEditorsPackage",null,[1,2]);class ck{hBj(){return{gBj:!0,NSj:!1}}}Object(t.a)(ck,"CursorMovementValidator",null,[600]);class gi{kgj(a,d,n,z,O,ca){return a?l.AFrameworkApplication.pa.rf(a,d,n,!0,O,ca):8}}Object(t.a)(gi,"ListContextManager",null,[599]);class xj{get name(){return"Box4.ListEditors"}Hb(a){a.ha("Box4.ListEditors.CursorMovementValidator",()=>new ck).as("Box4.List.ICursorMovementValidator").singleInstance();a.ha("Box4.ListEditors.ListContextManager",()=>new gi).as("Box4.ListEditors.IListContextManager")}init(){}dispose(){}static main(){M.a.instance.Sb(new xj)}}
Object(t.a)(xj,"Box4ListEditorsPackage",null,[1,2]);class Qh{get name(){return"Box4.NotebookLevelEditors"}Hb(){}init(){}dispose(){}static main(){M.a.instance.Sb(new Qh)}}Object(t.a)(Qh,"Box4NotebookLevelEditorsPackage",null,[1,2]);var Yl=b(1353),og=b(125),em=b(707),Kb=b(14);const Hp=(a,d,n,z,O)=>{if(d.contextId===Kb.a.view)switch(a){case Mb.a.search:return Lb.App.oa.za.NBa.hHn(),Lb.App.aL.Vxj(),32;case Mb.a.findOnPage:return 1!==n&&(Lb.App.oa.za.NBa.hHn(),Lb.App.aL.s1g()),32;case Mb.a.uVe:return Lb.App.oa.za.Rb&&
Lb.App.oa.za.Rb.gj?(1!==n&&(em.a.NXa?Lb.App.aL.Jan():Lb.App.aL.s1g()),a=32):a=8,a;case Mb.a.bib:case Mb.a.Rle:return 1===n?a=em.a.NXa?32:8:(Lb.App.aL.Jan(),a=32),a;case Mb.a.mPc:return 1!==n&&Lb.App.aL.IAe(),32;case Mb.a.LRe:return(a=Ye.a.Nla(document.body.ownerDocument))&&a.id===og.AppFrame.jZg&&Lb.App.aL.IAe(),32;case Mb.a.ZMc:return 1!==n&&Lb.App.aL.HAe(),32;case Mb.a.tMe:return(a=Ye.a.Nla(document.body.ownerDocument))&&a.id===og.AppFrame.jZg&&Lb.App.aL.HAe(),32;case Mb.a.sXe:return Lb.App.aL.F8n(),
32;case Mb.a.Ojc:return Lb.App.aL.Ojc(),32;case Mb.a.Ryd:return 1!==n&&"string"===typeof O&&Lb.App.aL.Ryd(O),32;case Mb.a.uWe:return 1!==n&&Lb.App.aL.s1g(),32;case Mb.a.vWe:return 1!==n&&Lb.App.aL.Vxj(),32;case Mb.a.Hhe:return Lb.App.aL.s3n(),32;case Mb.a.CWe:return Lb.App.aL.Vxj(),"string"===typeof O&&(Lb.App.aL.fXm(O),em.a.NXa=!0),32;case Mb.a.uEc:return Lb.App.aL.s1g(),"string"===typeof O&&(Lb.App.aL.fXm(O),em.a.NXa=!0),32}return 2};class zd{get name(){return"Box4.Search"}Hb(a){a.ha("Box4.Search.FindManagerHelper",
()=>Yl.FindManagerHelper.instance).as("Box4.Search.IFindManagerHelper").singleInstance()}init(){ib.a.kQc(Hp)}dispose(){}}Object(t.a)(zd,"PackageManager",null,[1,2]);class ie{get name(){return"Box4.TableEditors"}Hb(){}init(){}dispose(){}static main(){M.a.instance.Sb(new ie)}}Object(t.a)(ie,"Box4TableEditorsPackage",null,[1,2]);class Gi{get name(){return"Box4.TextLevelEditors"}Hb(){}init(){}dispose(){}static main(){M.a.instance.Sb(new Gi)}}Object(t.a)(Gi,"Box4TextLevelEditorsPackage",null,[1,2]);var Ag=
b(107),dh=b(349),Xc=b(127),ug=b(790),wk=b(1354);class dk{constructor(a,d,n){this.ny=this.Cva=this.cxa=null;this.oG=this.kcf=this.u_a=0;this.cwa=this.q9d=this.acb=this.$bb=!1;this.q8d=this.Azh=this.Czh=0;this.H1a=!1;this.sja=a;this.ga=d;this.Ek=n;this.H1a=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SingleImageDragAdapterIsEnabled",!1)}Ov(a){return!Lb.App.oa.za.isEditingAllowed||Yb.SessionStatusManager.instance.oj?!1:""!==this.zud(a.Ec)}Ly(a){if(!this.Ov(a))return!1;
this.H1a&&this.Bln(a);this.oG=this.sja.d9b();this.Hnn(a);this.Inn();({cKc:this.q9d,oLc:this.cwa}=this.vyj(this.kcf));this.Jnn();this.cxa=a.Gr;this.ny=new Sys.UI.Point(0,0);[this.Czh,this.Azh]=this.sja.getDimensions();k.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}Ky(a){this.Cva=a.Gr;this.bMk();this.q8d=wk.b(this.ny.x,this.ny.y,this.Czh,this.Azh,this.q9d,this.cwa,this.q8d,l.AFrameworkApplication.K.ea("SmoothImageHelperGetScaleIsEnabled"));this.sja.leh(this.q8d,this.q9d,this.cwa);
return!0}hr(){this.setSize();k.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}rx(){this.sja.OWg();k.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}Bln(a){this.sja=Ag.a.Ta(a.Ec,ug.a)}Inn(){this.kcf=(Math.floor((this.oG+22)/45)%8+this.u_a)%8}vyj(a){let d,n;if(this.oG&&90!==this.oG&&180!==this.oG&&270!==this.oG&&360!==this.oG||this.Lbm(a))return{cKc:!0,oLc:!0};d=n=!1;switch(a){case 1:case 5:d=!0;break;case 3:case 7:n=!0}return{cKc:n,oLc:d}}Jnn(){this.acb=this.$bb=!1;
switch(this.kcf){case 0:this.acb=this.$bb=!0;break;case 1:case 2:this.acb=!0;break;case 7:case 6:this.$bb=!0}}Lbm(a){return!(a%2)}zud(a){var d=a.className;-1===d.indexOf("WACImageResizeHandle")&&a.parentNode&&(d=a.parentNode.className);a=d.split(" ");for(d=0;d<a.length;d++){const n=a[d].toString();if(n.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==n)return n}return""}Hnn(a){switch(this.zud(a.Ec)){case "WACImageResizeHandleNW":this.u_a=0;break;case "WACImageResizeHandleN":this.u_a=
1;break;case "WACImageResizeHandleNE":this.u_a=2;break;case "WACImageResizeHandleE":this.u_a=3;break;case "WACImageResizeHandleSE":this.u_a=4;break;case "WACImageResizeHandleS":this.u_a=5;break;case "WACImageResizeHandleSW":this.u_a=6;break;case "WACImageResizeHandleW":this.u_a=7}}bMk(){var a=1;this.Ek.instance&&(a=this.Ek.instance.Ei);const d=(this.Cva.x-this.cxa.x)/a;a=(this.Cva.y-this.cxa.y)/a;this.ny.x=this.$bb?-d:d;this.ny.y=this.acb?-a:a}setSize(){const a=new dh.DictionaryPropertySet;a.setValue(Xc.a.tIc,
100*this.q8d);a.setValue(Xc.a.Aig,!0);if(90===this.oG||270===this.oG){let d,n;({cKc:d,oLc:n}=this.vyj(this.u_a));a.setValue(Xc.a.jDe,d);a.setValue(Xc.a.kDe,n)}else a.setValue(Xc.a.jDe,this.q9d),a.setValue(Xc.a.kDe,this.cwa);this.ga.ob(Mb.a.zac,2,a)}}Object(t.a)(dk,"ImageResizeDragAdapter",null,[161]);class To{constructor(a,d){this.ga=a;this.Ek=d}MCl(a){return new dk(a,this.ga,this.Ek)}}Object(t.a)(To,"ImageResizeDragAdapterFactory",null,[590]);var Jl=b(638),Cl=b(549),Qk=b(132),Wf=b(135);class Ho{constructor(a,
d,n,z,O,ca){this.LC=this.ZD=this.SUb=this.Cva=this.cxa=this.ifb=null;this.Vdb=this.Hgb=0;this.Ya=null;this.gf=this.etf=!1;this.ga=a;this.Da=d;this.oc=n;this.sja=z;this.Ek=O;this.T6c=this.nR=0;this.kka=ca}Fpe(){this.kka?Yb.SessionStatusManager.instance.oj||(this.LC=Jl.a.createElement(this.kka.ownerDocument,Cl.a.span),this.LC.className="WacImgRotateHandle WacImgRotateBase",this.ZD=Vf.createClusteredImage(24,24,"RotationArrow_24x24x32","WacImgRotateArrow",!1,""),this.ZD.style.left="-12px",this.ZD.style.position=
"absolute",this.LC.appendChild(this.ZD),this.kka.appendChild(this.LC),this.etf=!0):k.ULS.sendTraceTag(50868820,322,15,"_selectElement is null when creating rotate handle")}DEc(a){this.etf&&!this.gf||k.ULS.sendTraceTag(50597971,322,15,"{0}",{["Message"]:"FlipRotateGripper called before create gripper or after dispose",["RotationGripperCreated"]:this.etf,["IsDisposed"]:this.gf});this.LC&&this.ZD||(k.ULS.sendTraceTag(50597972,322,15,"{0}",{["Message"]:"_rotateHandle or _rotateGripper is null. Call CreateRotationHandle again",
["SelectElementIsNull"]:!this.kka,["RotateHandleIsNull"]:!this.LC,["RotateGripperIsNull"]:!this.ZD}),this.Fpe());a?(this.ZD&&this.ZD.classList.add("Flipped"),this.LC&&this.LC.classList.add("Flipped"),Qk.a.LTd(this.ZD,!0,!0)):(this.ZD&&this.ZD.classList.remove("Flipped"),this.LC&&this.LC.classList.remove("Flipped"),Qk.a.LTd(this.ZD,!1,!1))}tze(){this.Fpe();return this.ZD}Ov(a){return Lb.App.oa.za.isEditingAllowed&&a&&!Yb.SessionStatusManager.instance.oj?(this.ifb=this.Da.Ag)?!0:!1:!1}Ly(a){if(!this.Ov(a))return!1;
this.ifb=this.Da.Ag;if(this.Ya=Kd.ImageReader.$k(this.ifb))return this.cxa=this.RX(a),this.SUb=Sys.UI.DomElement.getBounds(this.kka),this.Hgb=0<Kd.ImageReader.VFc(this.Ya)?Kd.ImageReader.VFc(this.Ya):0,this.Vdb=Kd.ImageReader.Kxe(this.Ya),k.ULS.sendTraceTag(22052886,322,50,"Image rotate drag event started."),!0;k.ULS.sendTraceTag(24496074,322,15,"Drag start cancelled. Attempted to rotate with null img. properties.");return!1}Ky(a){this.Cva=this.RX(a);this.MJf();if(this.sja)return this.sja.AVc(this.nR,
this.T6c),k.ULS.sendTraceTag(25179723,322,100,"Image rotate drag move is happening."),!0;k.ULS.sendTraceTag(25179724,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}hr(){this.Hgb=this.nR=wk.c(this.nR);this.ada();k.ULS.sendTraceTag(22052887,322,50,"Image rotate drag event ended.")}rx(){this.sja.AVc(this.Vdb,0);k.ULS.sendTraceTag(22052888,322,50,"Image rotate drag event canceled.")}RX(a){return this.oc.hba(a)}MJf(){var a=1;this.Ek&&this.Ek.instance&&(a=this.Ek.instance.Ei);
var d=new Sys.UI.Point(this.SUb.x+this.kka.clientWidth/2*a,this.SUb.y+this.kka.clientHeight/2*a);a=wk.a(this.cxa,d);d=wk.a(this.Cva,d);this.nR=Math.round(Wf.a.DQg(d-a));0<this.Hgb&&(this.nR+=this.Hgb-this.Vdb);this.T6c=this.nR;this.nR+=this.Vdb}ada(){const a=new dh.DictionaryPropertySet;a.setValue(Xc.a.sIc,0);a.setValue(Xc.a.pH,this.nR);this.ga.ob(Mb.a.imageRotate,2,a)}dispose(){k.ULS.sendTraceTag(50597973,322,50,"ImageRotateDragAdapter is disposed.");this.gf||(this.LC&&(this.ZD&&this.LC.contains(this.ZD)&&
(this.LC.removeChild(this.ZD),this.ZD=null),this.kka&&this.kka.contains(this.LC)&&(this.kka.removeChild(this.LC),this.LC=null)),this.gf=!0)}}Object(t.a)(Ho,"ImageRotateDragAdapter",null,[587,161,12]);class fn{constructor(a,d,n){this.ga=a;this.Da=d;this.Ek=n}create(a,d,n){return new Ho(this.ga,this.Da,a,d,this.Ek,n)}}Object(t.a)(fn,"ImageRotateDragAdapterFactory",null,[589]);var Rk=b(963),oj=b(38);class pb{constructor(a,d,n,z){this.SUb=this.Cva=this.cxa=this.ifb=null;this.Vdb=this.Hgb=0;this.Ya=null;
this.ga=a;this.Da=d;this.Ek=n;this.T6c=this.nR=0;this.ic=z}Ov(a){return Lb.App.oa.za.isEditingAllowed&&!Yb.SessionStatusManager.instance.oj&&a&&this.Rem(a.Ec)?(this.ifb=this.Da.Ag)?!0:!1:!1}DEc(){}tze(){return null}Ly(a){if(!this.Ov(a))return!1;this.sja=Ag.a.Ta(a.Ec,ug.a);if(!this.sja)return!1;this.kka=this.sja.MZg;if(!this.kka)return!1;this.ifb=this.Da.Ag;this.Ya=Kd.ImageReader.$k(this.ifb);if(!this.Ya)return!1;this.cxa=this.RX(a);this.SUb=Sys.UI.DomElement.getBounds(this.kka);this.Hgb=0<Kd.ImageReader.VFc(this.Ya)?
Kd.ImageReader.VFc(this.Ya):0;this.Vdb=Kd.ImageReader.Kxe(this.Ya);return!0}Ky(a){this.Cva=this.RX(a);this.MJf();if(this.sja)return this.sja.AVc(this.nR,this.T6c),!0;k.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}hr(){this.Hgb=this.nR=wk.c(this.nR);this.ada()}rx(){this.sja.AVc(this.Vdb,0)}Rem(a){return Object(oj.a)(a,Rk.c)||Object(oj.a)(a,Rk.b)||Object(oj.a)(a,Rk.a)||!!a.parentElement&&Object(oj.a)(a.parentElement,Rk.a)}RX(a){return this.ic.sc.hba(a)}MJf(){var a=
1;this.Ek&&this.Ek.instance&&(a=this.Ek.instance.Ei);var d=new Sys.UI.Point(this.SUb.x+this.kka.clientWidth/2*a,this.SUb.y+this.kka.clientHeight/2*a);a=wk.a(this.cxa,d);d=wk.a(this.Cva,d);this.nR=Math.round(Wf.a.DQg(d-a));0<this.Hgb&&(this.nR+=this.Hgb-this.Vdb);this.T6c=this.nR;this.nR+=this.Vdb}ada(){const a=new dh.DictionaryPropertySet;a.setValue(Xc.a.sIc,0);a.setValue(Xc.a.pH,this.nR);this.ga.ob(Mb.a.imageRotate,2,a)}}Object(t.a)(pb,"ImageRotateDragAdapterSimplified",null,[587,161]);class pc{constructor(){this.Z=
null}get name(){return"Box4.Images"}Hb(a){this.Z=a;this.Z.ha("Box4.Images.ImageResizeDragAdapter",()=>new dk(null,l.AFrameworkApplication.pa,la.a.instance.Ca("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapter").singleInstance();this.Z.ha("Box4.Images.ImageRotateDragAdapterUpdated",()=>new pb(l.AFrameworkApplication.pa,Lg.a.instance,la.a.instance.Ca("Common.IZoomManager"),Ic.InteractiveViewManager.instance)).as("Box4.Images.IImageRotateDragAdapter").singleInstance();this.Z.ha("Box4.Images.ImageResizeDragAdapterFactory",
()=>new To(l.AFrameworkApplication.pa,la.a.instance.Ca("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapterFactory").singleInstance();this.Z.ha("Box4.Images.ImageRotateDragAdapterFactory",()=>new fn(l.AFrameworkApplication.pa,Lg.a.instance,la.a.instance.Ca("Common.IZoomManager"))).as("Box4.Images.IImageRotateDragAdapterFactory").singleInstance()}init(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SingleImageDragAdapterIsEnabled",
!1)?(this.Z.resolve("Box4.Images.IImageResizeDragAdapter"),this.Z.resolve("Box4.Images.IImageRotateDragAdapter")):(this.Z.resolve("Box4.Images.IImageResizeDragAdapterFactory"),this.Z.resolve("Box4.Images.IImageRotateDragAdapterFactory"))}dispose(){}static main(){M.a.instance.Sb(new pc)}}Object(t.a)(pc,"Box4ImagesPackage",null,[1,2]);var Tc=b(269),bd=b(109),Qb=b(6),be=b(628),Me=b(446),tf=b(626),uf=b(18),Xf=b(252),Re=b(253),bg=b(1588),Qf=b(1638),vh=b(1051);class al extends Qf.a{constructor(a,d,n){super(a,
d,n);this.ace=this.qBb=null}get JV(){return l.AFrameworkApplication.la.Np}$we(a){switch(a){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}hgh(a){return al.APb(a,this.pGi())}pGi(){return al.Pyf}APb(a,d){a=this.hgh(a);return 0!==a?(d&&d.Yhe(),2===a&&(d=this.$we(a),this.jq(this.Qwi(a),d)),!1):!0}h4a(a,d){k.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.TJg=d;Mh.a.mark(5576);this.ace=
this.JV.Pe("LoadResource","PictureUploadTime");this.eEe()?this.XUe(a):this.$Kd()}jq(a,d){const n=new $g.StandardDialog;n.wc=0;n.aw(a,CommonUIStrings.l_ImageUploadFailedTitle,d,null)}$Kd(){k.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.$Kd();this.ace&&(this.ace.stop(),this.ace=null)}iTc(){this.qBb=(new vh.a).create();this.qBb.message=CommonUIStrings.l_ImageUploadWait;this.qBb.wc=5;this.qBb.Hq=!1;this.qBb.yQ(null,null,null)}TMf(){this.qBb&&(this.qBb.close(),this.qBb=null)}static HZl(a,
d){a=w.a.He(a);for(let n=0;n<d.length;++n)if(a.endsWith(d[n]))return!0;return!1}static APb(a,d=null){d||(d=al.Pyf);return a?al.HZl(a,d)?0:2:1}}al.Pyf=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(t.a)(al,"PictureUploader",Qf.a,[]);var Fh;(function(a){a[a.validPicture=0]="validPicture";a[a.noPictureSpecified=1]="noPictureSpecified";a[a.invalidExtension=2]="invalidExtension";a[a.pictureTooLarge=3]="pictureTooLarge"})(Fh||(Fh={}));Object(t.b)("PictureValidationResult",Fh);var rf=b(58),Vd=
b(17),lh=b(42),Sg=b(236);class un{constructor(){this.J_=null}}Object(t.a)(un,"ImageData",null,[]);var tl=b(48),bj=b(1589),Uo=b(1429),vn=b(1463);class mm extends xg.a{constructor(a,d=!0){super(!1,!1,mm.FQ);this.Rvc=null;this.jwh=!1;this.zA=[];this.kv=null;this.sBb=a;this.Mmk=d;this.XO=this.xfe=!1;this.rgb=null;this.Jef=!1;this.Lf=this.I$k;this.Je="InsertFileDialog";this.ee(1,this.yhe);mm.FQ?(this.Rvc={["id"]:this.Je,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,
["onExecute"]:Object(m.a)(this,this.oLm,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:Object(m.a)(this,this.xFm,"onFrameReady")},this.Ih(this.titleText,Object(m.a)(this,this.SDe,"insertDialogHandler"),this.Rvc),this.fW=!0):(this.showDialog(this.titleText,Object(m.a)(this,this.SDe,"insertDialogHandler")),d&&this.qpn(),(a=this.P8b(1))&&this.zA.push(a),(a=this.P8b(0))&&this.zA.push(a),this.kPj(),this.fW=!1)}get LQj(){return this.sBb}validate(){this.kv.J_||
k.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.kv.J_.value?!0:(mm.aw(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}xFm(a){this.Mmk&&(this.kv=this.tzj(a,this.sBb))}oLm(){this.kv&&this.kv.J_&&(this.jwh||(this.kv.P3m(Object(m.a)(this,this.cHg,"onFileChosen")),this.jwh=!0),this.kv.Cni())}cHg(a){this.Rvc.uploadStatusLabel=a;this.yda(this.titleText,Object(m.a)(this,this.SDe,"insertDialogHandler"),this.Rvc)}SDe(a){1===a&&this.isEnabled()?mm.FQ&&this.kv.J_&&!this.kv.J_.value?
(this.Rvc.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.yda(this.titleText,Object(m.a)(this,this.SDe,"insertDialogHandler"),this.Rvc)):(this.WHc(),this.sBb.h4a(this.kv,Object(m.a)(this,this.dispose,"dispose"))):0===a&&this.hide()}qpn(){this.Jef=!1;this.kv=this.tzj(document.getElementById("uploadFrameContainer"),this.sBb);l.AFrameworkApplication.K.ea("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.rgb=Object(m.a)(this,this.VJg,"onUploadFrameLoad"),Qc.a.addHandler(this.kv.iFrame,
"load",this.rgb));this.kv.J_||k.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.rgj()}VJg(){this.rgj()}rgj(){if(this.kv&&!this.Jef){var a=this.kv.J_;a&&(Qc.a.addHandler(a,vb.a.Nf,Object(m.a)(this,this.onKeyDown,"onKeyDown")),a=[a],this.zA=a.concat.apply(a,this.zA),this.kPj(),this.Jef=!0)}}dispose(){if(this.kv&&!mm.FQ){const a=this.kv.J_;a&&Qc.a.removeHandler(a,vb.a.Nf,Object(m.a)(this,this.onKeyDown,"onKeyDown"));this.rgb&&Qc.a.removeHandler(this.kv.iFrame,"load",this.rgb)}this.kv=
null;super.dispose()}kPj(){if(0<this.zA.length){const a=new Ud(this.zA),d=ic.FocusManager.instance().rk();d&&(this.zA[0].focus(),d.Tf=a,d.MS=!0)}}onKeyDown(a){4!==ic.FocusManager.instance().SRe(a)&&a.preventDefault()}static get FQ(){return l.AFrameworkApplication.la.eb.wz&&l.AFrameworkApplication.la.eb.wrg}static aw(a){const d=document.getElementById("errorText");d.innerText=a;d.style.display="inline-block"}}Object(t.a)(mm,"InsertFileDialog",xg.a,[]);class On{static get Lf(){return xg.a.oz(On.fm,
CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}On.fm="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(t.a)(On,"InsertImageDialogHtml",null,[]);class Kl extends mm{constructor(a,d=!0){super(a,d)}get yhe(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get I$k(){return On.Lf}validate(){this.kv.J_||
k.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var a=Object(qa.a)(al,this.LQj);const d=a.hgh(this.kv.J_.value);return 0!==d?(a=a.$we(d),mm.aw(a),!1):!0}}Object(t.a)(Kl,"InsertImageDialog",mm,[]);class wn extends Kl{constructor(a){super(a)}tzj(a,d){const n=l.AFrameworkApplication.la.eb.wz&&l.AFrameworkApplication.la.eb.wrg;return new vn.a(a,Object(m.a)(d,d.oOc,"onUploadFrameInitialized"),Object(m.a)(d,d.ELa,"uploadResponseReceived"),l.AFrameworkApplication.K,!n)}isEnabled(){return wn.vz.KGa(this.LQj.context)}static get vz(){return wn.si||
(wn.si=la.a.instance.resolve("Box4.Images.IImageEditor"))}}wn.si=null;Object(t.a)(wn,"Box4InsertImageDialog",Kl,[]);const Sl=["ImageInsertFailed"];class ll extends al{constructor(a,d,n,z,O,ca,Da=!0){super(a,d,n);this.TNa=this.Fm=this.Bz=this.he=null;this.Ymi="wwaengidc";this.kpiName="ImageFileExtension";this.R5c="LocalDeviceUpload";this.u0=new Map;this.Kni=0;this.rBb=null;this.Hef="";this.ZEa=0;this.jk=null;this.I3c="";this.jFh=50;this.g1c=this.ycd=this.A8c=!1;this.wfk=19922944;this.XGh=0;this.Lef=
[];this.iwh=[];this.YGh=0;this.Zb=z;this.Gj=O;this.ga=ca;this.vEh=n.ea("WACLocalRenderingForInsertLocalImageIsEnabled");this.tFh=l.AFrameworkApplication.K.jb("ImageUploadMaxByteSize",Number.MAX_VALUE);Da&&this.showDialog();Lb.App.oYd.addHandler(this)}get kSi(){return this.K.ea("JfifImageInsertIsEnabled")}get gca(){return this.R5c}get fileExtension(){return this.Hef}get fileSize(){return this.ZEa}get KQj(){return this.rBb}get Au(){return this.jk||(this.jk=la.a.instance.resolve("Common.Utils.IAriaNotifier"))}get Bkg(){return!I.a.Fy&&
this.gca===this.R5c}showDialog(){Uo.a(this.K)?(this.SCc=!1,this.kv=new vn.a(document.body,Object(m.a)(this,this.oOc,"onUploadFrameInitialized"),Object(m.a)(this,this.ELa,"uploadResponseReceived"),this.K,!1,void 0,!0)):Uo.b()||this.Gfc&&I.a.cB?(this.SCc=!1,this.kv=new vn.a(document.body,Object(m.a)(this,this.oOc,"onUploadFrameInitialized"),Object(m.a)(this,this.ELa,"uploadResponseReceived"),this.K,!1)):(this.SCc=!0,this.kv=(new wn(this)).kv)}Qwi(a){switch(a){case Fh.noPictureSpecified:return tl.a.noPictureSpecified;
case Fh.invalidExtension:return tl.a.SNi;case Fh.pictureTooLarge:return tl.a.rwg}return Ng.a.unknown}XUe(a){this.Bkg||(this.he.Zg()?(k.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),bj.a.instance.$eh(this.he.Zg()),this.he.Zg().contentReplicator.forceOutbound(Object(m.a)(this,this.BIg,"onPlaceholderNodeSaved"),Object(m.a)(this,this.Arb,"processFailure"),a)):this.Arb(a,157))}Qdm(){return Uo.c(this.he)}BIg(a){k.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");
if(a){var d={},n=this.Bz?this.Bz.properties.Jb.toString():this.he.Jb.toString();d[Me.a.nc]=this.Bz?this.Bz.id.toString():this.he.id.toString();d[Me.a.classId]=n;this.Zb.hasProperty(Qb.a.imageType)&&(d[be.a.imageType]=this.Zb.getValue(Qb.a.imageType));this.Zb.hasProperty(Qb.a.$U)&&(d[be.a.$U]=this.Zb.getValue(Qb.a.$U));this.Zb.hasProperty(bd.a.Mfa)&&(d[be.a.Mfa]=this.Zb.getValue(bd.a.Mfa));uf.a.instance.J(4)&&this.Zb.hasProperty(Qb.a.F6a)&&(d[be.a.F6a]=this.Zb.getValue(Qb.a.F6a));Uo.d(a,this.he,this.Fm,
d)&&(this.jXd(a),ll.lNc++)}else k.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")}jXd(a){a.jXd();this.rBb=a.rBb}ELa(a){this.Kni=+new Date-+this.KQj;this.sKe();k.ULS.sendTraceTag(36783364,322,50,"Box4PictureUploader.UploadResponseReceived");Uo.e(this,a,this.he)}jQn(){k.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.$Kd();ll.lNc--;this.ga.processAction(Sa.a.c$a,2);this.he?bj.a.instance.EVc(this.he.Zg(),0):k.ULS.sendTraceTag(42468439,339,50,"Not able to notify upload notifier for completion");
this.Au.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}Arb(a,d){if(this.xcn(a))k.ULS.sendTraceTag(16798870,352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",this.retryCount,d.toLocaleString());else{a=Object.assign(new Sg.a,{extendedProperties:new Map});a.extendedProperties.set("result",d.toLocaleString());ja.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",Sl,!1,!0,!1,!1,a);a=this.M_f(d);k.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",
this.retryCount,d.toLocaleString());var n=this.he.dD(),z=new Ff.GraphTransaction(15,Mb.a.G7);z.Sa(this.he);ll.vz.Hha(this.Zb,a);ll.vz.e7m(this.he,this.Bz);Kd.ImageReader.V0g(this.Zb,2);z.dispose();this.ICj(a);this.Gj.HAc(n,!1);this.$Kd();ll.lNc--;bj.a.instance.EVc(this.he.Zg(),d)}}ICj(a){const d=new $g.StandardDialog;d.wc=0;d.aw(tl.a.invalidImageFile,CommonUIStrings.l_ImageUploadFailedTitle,a,null)}M_f(a){switch(a){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}UZj(a){return new Promise(d=>
{const n=new FileReader;n.addEventListener("load",()=>{n.result.length>this.wfk?(this.ycd=!0,k.ULS.sendTraceTag(545093779,322,10,"Box4PictureUploader.PopulateImagePasteHTML : Image filesize exceeded max supported limit. Base64 size produced = {0}",n.result.length),ja.Health.instance.recordQosError("PictureFromLocalInvalid",Sl,!0,!0,!1,!1,null)):(this.I3c+=String.format('<img src="{0}"></img>',n.result),this.YGh++);d()},!1);n.addEventListener("error",()=>{k.ULS.sendTraceTag(545093780,322,10,"Box4PictureUploader.PopulateImagePasteHTML fileReader errror {0}",
n.error);d()});n.readAsDataURL(a)})}qYj(){if(this.I3c&&0<this.I3c.length){const a=new dh.DictionaryPropertySet;a.setValue(Xc.a.wV,this.I3c);a.setValue(Xc.a.wga,!0);this.ga.ob(Mb.a.hfa,2,a)}this.Iun()}Iun(){let a="";this.A8c&&this.g1c&&this.ycd?a=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.A8c&&this.g1c?a=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.A8c&&this.ycd?a=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:
this.ycd&&this.g1c?a=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.ycd?a=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.g1c?a=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.A8c&&(a=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==a&&(this.ICj(a),this.ZYj())}v5l(){const a=[];if(this.kv.J_.files){this.XGh=this.kv.J_.files.length;this.kv.J_.files.length>this.jFh&&(this.A8c=!0);for(let d=0;d<this.kv.J_.files.length&&this.jFh;d++){const n=
this.kv.J_.files[d];this.Lef.push(n.name);this.iwh.push(n.size);n&&(this.hgh(n.name)!=Fh.validPicture?(this.g1c=!0,k.ULS.sendTraceTag(545093781,322,10,"Box4PictureUploader.insertImagesUsingPasteFlow : Image filetype not supported"),ja.Health.instance.recordQosError("PictureFromLocalInvalid",Sl,!0,!0,!1,!1,null)):a.push(this.UZj(n)))}}Promise.all(a).then(()=>this.qYj());return!0}f6l(){this.Fm=xa.a.create();this.Zb||(this.Zb=new dh.DictionaryPropertySet);this.vEh&&this.TNa&&this.Zb.setValue(bd.a.xwg,
this.TNa);var a=480;let d=320;var n=this.context.view;this.K.ea("WordEditorAutoResizeImageIsEnabled")&&(n=n.Yf.editingElement.clientWidth,0<n&&n<a&&(d=Math.floor(1*n/a*d),a=n,this.Zb.setValue(bd.a.Mfa,n)));this.Zb.setValue(Vd.a.ica,rf.a.hl(a,0));this.Zb.setValue(Vd.a.Jsa,rf.a.hl(d,1));this.Zb.setValue(lh.a.n4,1);this.Zb.setValue(Xc.a.wga,!0);uf.a.instance.J(4)&&this.Zb.setValue(Qb.a.F6a,Box4Intl.Box4Strings.l_Picture);a=ll.vz.Bhi(this.context,this.Zb,this.Fm);if(!a)return!1;this.he=a.node;this.Zb=
(this.Bz=a.blob)?this.Bz.properties:this.he.properties;uf.a.instance.J(4)&&Lb.App.lc.eq&&Lb.App.lc.Mp.MJ(this.he);return!0}eEe(){return this.Bkg?this.v5l():this.f6l()}ZYj(){this.u0.set("FileExtensions",this.qvl());this.u0.set("FileSizeInBytes",this.iwh.toString());this.u0.set("Source",this.gca);this.u0.set("NumberOfImagesAttemptedToInsert",this.XGh.toString());this.u0.set("NumberOfImagesPasted",this.YGh.toString());ja.Health.instance.recordKpiUsage("MultipleImageInsert",0,this.Ymi,this.u0)}qvl(){let a=
"";for(let d=0;d<this.Lef.length;++d)a=a+this.dxi(this.Lef[d])+",";return a}h4a(a,d){this.vEh&&(this.TNa=new un,this.TNa.J_=a.J_);super.h4a(a,d)}oOc(a){this.kv=a;if(!this.SCc){if(this.$3e){if(Uo.a(this.K)||this.Gfc&&I.a.cB){a.wre(Object(m.a)(this,this.hFm,"onFileChosen$2"));return}const d=a.wre(null),n=this.exi(a);n&&(this.Hef=n.name,this.ZEa=n.size);if(!this.APb(d,a)||!this.ggh(n,a)){ja.Health.instance.recordQosError("PictureFromLocalInvalid",Sl,!0,!0,!1,!1,null);this.sKe();return}}this.h4a(a,null)}}hFm(a){if(!this.Bkg){const d=
this.exi(this.kv);d&&(this.Hef=d.name,this.ZEa=d.size);if(!this.APb(a,this.kv)||!this.ggh(d,this.kv)){ja.Health.instance.recordQosError("PictureFromLocalInvalid",Sl,!0,!0,!1,!1,null);this.sKe();return}}this.h4a(this.kv,null)}tyd(){return!!ll.lNc}sKe(){this.u0.set("FileExtension",this.dxi(this.fileExtension));this.u0.set("Source",this.gca);this.u0.set("FileSizeInBytes",this.fileSize.toString());this.u0.set("RequestTimeInMs",this.Kni.toString());ja.Health.instance.recordKpiUsage(this.kpiName,0,this.Ymi,
this.u0)}dxi(a){return a&&(a=a.split("."),1<a.length)?a[a.length-1].substring(0,4):""}pGi(){return this.kSi?ll.Irk:al.Pyf}exi(a){return(a=a.J_)?a.files[0]:null}ggh(a,d){return a&&a.size>this.tFh?(d&&d.Yhe(),a=this.$we(Fh.pictureTooLarge),this.jq(this.Qwi(Fh.pictureTooLarge),a),!1):!0}$we(a){switch(a){case Fh.noPictureSpecified:return CommonUIStrings.l_ImageUploadNoFileSpecified;case Fh.invalidExtension:return this.kSi?CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;
case Fh.pictureTooLarge:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.tFh/1E6));default:return""}}static get vz(){return ll.si||(ll.si=la.a.instance.resolve("Box4.Images.IImageEditor"))}}ll.Irk=".jpg .jpeg .png .gif .bmp .tif .tiff .jfif".split(" ");ll.Jrk=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");ll.si=null;ll.lNc=0;Object(t.a)(ll,"Box4PictureUploader",al,[451,452]);var Vo=b(875),ul=b(94);class pj{constructor(){this.Ex=this.At=this.gZb=this.YPh=this.sqc=
this.$4j=null;this.Nsf=0;this.U1=this.zof=this.BZb=null;this.Qrh=0;this.v9e=this.C$=this.flf=null;this.GAh=!1;this.G8e=this.D8e=this.H8e=null}get assetId(){return this.sqc}get thumbnailUrl(){return this.YPh}get TTm(){return this.gZb}get displayName(){return this.U1}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,this.At,this.Ex)}get kAk(){if(this.D8e&&this.G8e&&this.H8e){const a=document.createElement("a");a.setAttribute("href",this.H8e);a.setAttribute("target",
"_blank");a.innerText=this.G8e;return a}return null}get ZWh(){return this.D8e}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.Qrh)}get CZm(){const a=document.createElement("span");var d=0;if(this.BZb&&0<this.BZb.length){var n=this.BZb.indexOf("."),z=0>n?this.BZb:this.BZb.substring(0,n);for(z=Number.parseInvariant(z);d<z&&5>d;d++)a.appendChild(Vf.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",ul.a.$e("box42.png"),"","",!0,""));0<n&&(n=Number.parseInvariant(this.BZb.substr(n+
1)),3>n?a.appendChild(Vf.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",ul.a.$e("box42.png"),"","",!0,"")):8>n?a.appendChild(Vf.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",ul.a.$e("box42.png"),"","",!0,"")):a.appendChild(Vf.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",ul.a.$e("box42.png"),"","",!0,"")),d++)}for(;5>d;d++)a.appendChild(Vf.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",ul.a.$e("box42.png"),"","",!0,""));this.zof&&
(d=document.createElement("span"),d.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.zof),a.appendChild(d));return a}get kbn(){return 0<this.Nsf?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.Nsf):""}get JFk(){if(this.GAh){var a=document.createElement("span");a.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;return a}if(this.v9e&&this.C$)return pj.T1k(this.v9e,this.C$);a=document.createElement("span");a.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;
return a}get keywords(){let a;if(this.flf){const d=this.flf.split(",");a=Array(d.length);for(let n=0;n<d.length;n++)a[n]=d[n].trim()}else a=[];return a}static ipl(a){const d=new pj;for(let n=0;n<a.childNodes.length;n++){const z=a.childNodes[n];if(1===z.nodeType)try{const O=z.firstChild.nodeValue;switch(z.nodeName){case "src":d.$4j=O;break;case "assetid":d.sqc=O;break;case "thumb":"64x64"===z.attributes.getNamedItem("size").nodeValue?d.YPh=pj.dLj(O):"192x192"===z.attributes.getNamedItem("size").nodeValue&&
(d.gZb=pj.dLj(O));break;case "imagedim":if(O){const Da=O.indexOf("x");0<Da&&Da<O.length&&(d.At=O.substr(0,Da),d.Ex=O.substr(Da+1))}break;case "resolution":d.Nsf=Number.parseInvariant(O);break;case "rating":d.BZb=O;break;case "numofratings":d.zof=O;break;case "displayname":d.U1=O;break;case "contentlength":d.Qrh=Number.parseInvariant(O)/1024;break;case "subject":d.flf=O;break;case "provider":d.C$=O;break;case "attributionlink":d.v9e=O;break;case "iscsc":d.GAh=1===Number.parseInvariant(O);break;case "additional":const ca=
z.firstChild;if(z.hasChildNodes()&&ca&&"id"===ca.nodeName&&1===Number.parseInvariant(ca.text))for(let Da=0;Da<z.childNodes.length;Da++){const Xa=z.childNodes[Da];switch(Xa.nodeName){case "caption":d.D8e=Xa.text;break;case "value":d.H8e=Xa.text;break;case "string":d.G8e=Xa.text}}}}catch(O){}}return d}static T1k(a,d){const n=document.createElement("a");n.setAttribute("href",a);n.setAttribute("target","_blank");n.innerText=d;return n}static dLj(a){let d;return a&&0<(d=a.indexOf("://"))?a.substr(d+1):
a}}Object(t.a)(pj,"ClipArtSearchResult",null,[]);class ym{static get Lf(){return xg.a.oz(ym.fm,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}ym.fm="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(t.a)(ym,"InsertClipartDialogHtml",null,[]);class Wo extends xg.a{constructor(a){super();this.RNa=this.FUb=0;this.iKh=null;this.orf=!1;this.Dvc=this.zeb=this.YT=null;this.Wqh=a;this.Lf=ym.Lf;this.Je="InsertClipartDialog";this.ee(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,Object(m.a)(this,this.U4l,"insertClipartDialogHandler"));this.wt=document.getElementById("clipartsearchresults");this.Sde=Object(m.a)(this,this.onKeyDown,
"onKeyDown");Qc.a.addHandler(this.wt,"keydown",this.Sde);this.Rde=Object(m.a)(this,this.onScroll,"onScroll");Qc.a.addHandler(this.wt,"scroll",this.Rde);this.U2=document.getElementById("textInput");this.Qfe=Object(m.a)(this,this.KJm,"onSearchQueryKeyDown");Qc.a.addHandler(this.U2,"keydown",this.Qfe);this.Rfe=Object(m.a)(this,this.Gaj,"onSearchQueryAddCharacters");Qc.a.addHandler(this.U2,"keypress",this.Rfe);this.Sfe=Object(m.a)(this,this.Gaj,"onSearchQueryAddCharacters");Qc.a.addHandler(this.U2,"paste",
this.Sfe);this.uYc=document.getElementById("btnSearch");this.uYc.setAttribute("src",ul.a.$e("search.16x16x32.png"));this.Qde=Object(m.a)(this,this.Faj,"onSearchButton");Qc.a.addHandler(this.uYc,"click",this.Qde);this.bsc=document.getElementById("clipartpreviewimage");this.edf=document.getElementById("clipartattributedisplayname");this.fyb=document.getElementById("clipartseesimilar");this.ddf=document.getElementById("clipartdimensions");this.j0c=document.getElementById("clipartadditionalvalue");this.fdf=
document.getElementById("clipartratingvalue");this.nbb=document.getElementById("clipartattributionvalue");this.obb=document.getElementById("clipartkeywords");this.bdf=document.getElementById("clipartadditionalname");this.gdf=document.getElementById("clipartratingname");this.cdf=document.getElementById("clipartattributionname");this.prf=Object(m.a)(this,this.uIm,"onPreviewClip");this.fxf=Object(m.a)(this,this.KKm,"onThumbnailLoadError");this.W7d=Object(m.a)(this,this.P9i,"onHyperlinkClick");this.X7d=
Object(m.a)(this,this.cGm,"onHyperlinkKeyDown");this.dlf=Object(m.a)(this,this.e$i,"onKeywordClick");this.elf=Object(m.a)(this,this.IGm,"onKeywordKeyDown");this.Tde=Object(m.a)(this,this.Iaj,"onSeeSimilarClick");this.Ude=Object(m.a)(this,this.LJm,"onSeeSimilarKeyDown");this.U2.focus();this.Cha(1,!1)}dispose(){this.wt&&this.W6h();this.wt&&this.Sde&&(Qc.a.removeHandler(this.wt,"keydown",this.Sde),this.Sde=null);this.wt&&this.Rde&&(Qc.a.removeHandler(this.wt,"scroll",this.Rde),this.Rde=null);this.wt=
null;this.U2&&this.Qfe&&(Qc.a.removeHandler(this.U2,"keydown",this.Qfe),this.Qfe=null);this.U2&&this.Rfe&&(Qc.a.removeHandler(this.U2,"keypress",this.Rfe),this.Rfe=null);this.U2&&this.Sfe&&(Qc.a.removeHandler(this.U2,"paste",this.Sfe),this.Sfe=null);this.U2=null;this.uYc&&this.Qde&&(Qc.a.removeHandler(this.uYc,"click",this.Qde),this.uYc=this.Qde=null);this.cdf=this.gdf=this.bdf=this.obb=this.nbb=this.fdf=this.j0c=this.ddf=this.fyb=this.edf=this.bsc=this.Ude=this.Tde=this.elf=this.dlf=this.X7d=this.W7d=
this.Dvc=this.fxf=this.prf=null;this.zeb&&(this.zeb.dispose(),this.zeb=null);super.dispose()}IV(){super.IV();document.getElementById(this.Kg("WACDialogPanel")).style.width=String.format("{0}px",656)}Faj(a){const d=this.U2.value;d&&0<d.trim().length&&(this.search(this.U2.value),this.Cha(1,!1));a.preventDefault();a.stopPropagation()}search(a){this.Ikc(a,!1,Object(m.a)(this,this.Hgj,"processSearchResults"))}Ikc(a,d,n){this.RNa=this.FUb=0;this.W6h();if(this.YT&&a===this.iKh&&this.orf===d)window.setTimeout(Object(m.a)(this,
this.lhi,"displaySearchResults"),500);else{this.YT&&(Array.clear(this.YT),this.YT=null);this.iKh=a;this.orf=d;var z=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');z.append("<query>");z.append(w.a.Vd(a));z.append("</query>");z.append("<mediatype>Illustration</mediatype>");z.append("<mediatype>Photo</mediatype>");z.append("<filetype>jpg</filetype>");z.append("<filetype>jpeg</filetype>");z.append("<filetype>gif</filetype>");z.append("<filetype>bmp</filetype>");z.append("<filetype>tif</filetype>");
z.append("<filetype>tiff</filetype>");z.append("<filetype>png</filetype>");z.append("</search>");a=l.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let O=a.length;4>O;O++)a="0"+a;l.AFrameworkApplication.Gd.Ni(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",Lb.App.webServiceBase,a,be.a.ADj,d.toString()),2,z.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,n,Object(m.a)(this,this.onError,"onError"),null)}}Ifn(a){this.Ikc(a.assetId,!0,Object(m.a)(this,
this.Hgj,"processSearchResults"));this.YT||(this.YT=[],this.YT.push(a))}KJm(a){(a?a.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.Faj(a),a.preventDefault(),a.stopPropagation())}Gaj(a){100<=this.U2.value.length&&(a.preventDefault(),a.stopPropagation())}uIm(a){a=Number.parseInvariant(a.target.parentNode.id.substr(4));this.agj(a);this.I0g(a)}onScroll(){if(this.wt&&this.wt.children&&!(2>this.wt.children.length)){var a=this.wt.children[0].children[0],d=this.wt.clientHeight-(a.clientHeight-a.children[0].clientHeight+
2)+this.wt.scrollTop,n=a.clientHeight+2,z=parseInt(String(this.wt.scrollTop/n));a=parseInt(String(d/n));var O=parseInt(String(this.wt.clientWidth/n));a<d/n&&a<parseInt(String(this.YT.length/O))&&a++;for(d=z;d<a;d++)for(n=0;n<O;n++){var ca=d*O+n;z=this.YT[ca];(ca=document.getElementById("clip"+ca))&&!ca.childNodes.length&&(z=this.Ndi(z),ca.appendChild(z))}}}Ndi(a){const d=document.createElement("img");d.classList.add("ClipartThumbImage");d.setAttribute("src",a.thumbnailUrl);a=a.displayName?a.displayName:
Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;d.setAttribute("title",a);d.setAttribute("alt",a);Qc.a.addHandler(d,"click",this.prf);Qc.a.addHandler(d,"error",this.fxf);return d}f9k(a){1===a.childNodes.length&&(a=a.childNodes[0],Qc.a.removeHandler(a,"click",this.prf),Qc.a.removeHandler(a,"error",this.fxf))}KKm(a){a.target.setAttribute("src",ul.a.$e("phthumb.64x64x32.png"))}vIm(a){a.target.setAttribute("src",ul.a.$e("phpreview.96x96x32.png"))}agj(a){const d=this.YT[a];var n=d.TTm;this.U6h();this.Dvc=
Object(m.a)(this,this.vIm,"onPreviewLoadError");var z=document.createElement("img");z.setAttribute("src",n);if(d.displayName)n=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,d.displayName);else{n=new Sys.StringBuilder;for(let O=0;O<d.keywords.length&&5>O;O++)O&&n.append(", "),n.append(d.keywords[O]);n=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,n.toString())}z.setAttribute("title",n);z.setAttribute("alt",n);Qc.a.addHandler(z,"error",this.Dvc);this.bsc.appendChild(z);
z=document.getElementById("clip"+this.FUb);z.classList.remove("ClipartSelectedImage");z=document.getElementById("clip"+a);z.classList.add("ClipartSelectedImage");this.FUb=a;d.displayName&&(this.edf.innerText=d.displayName);a=document.createElement("a");a.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;a.setAttribute("href",'""');Qc.a.addHandler(a,"click",this.Tde);Qc.a.addHandler(a,"keydown",this.Ude);this.fyb.appendChild(a);this.ddf.innerText=String.format("{0} | {1} | {2}",d.dimensions,d.kbn,
d.fileSize);(a=d.kAk)&&d.ZWh?(this.j0c.parentNode.style.display="block",this.bdf.innerText=d.ZWh,this.j0c.appendChild(a)):this.j0c.parentNode.style.display="none";this.fdf.appendChild(d.CZm);ae.a.P6(this.nbb);if(a=d.JFk)this.nbb.appendChild(a),"a"===a.nodeName.toLowerCase()&&(Qc.a.addHandler(a,"click",this.W7d),Qc.a.addHandler(a,"keydown",this.X7d));this.obb.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(a=0;a<d.keywords.length;a++)z=d.keywords[a],n=document.createElement("a"),n.innerText=z,
n.setAttribute("href",'""'),Qc.a.addHandler(n,"click",this.dlf),Qc.a.addHandler(n,"keydown",this.elf),this.obb.appendChild(n),a<d.keywords.length-1&&(z=document.createElement("span"),z.innerText=", ",this.obb.appendChild(z));this.gdf.innerText=Box4Intl.Box4Strings.l_ClipartRating;this.cdf.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.Cha(1,!0)}U6h(){this.bsc&&1===this.bsc.childNodes.length&&(this.Dvc&&(Qc.a.removeHandler(this.bsc.childNodes[0],"error",this.Dvc),this.Dvc=null),ae.a.P6(this.bsc));
this.nbb&&0<this.nbb.childNodes.length&&"a"===this.nbb.childNodes[0].nodeName.toLowerCase()&&(this.W7d&&Qc.a.removeHandler(this.nbb.childNodes[0],"click",this.W7d),this.X7d&&Qc.a.removeHandler(this.nbb.childNodes[0],"keydown",this.X7d));this.fyb&&0<this.fyb.children.length&&"a"===this.fyb.children[0].nodeName.toLowerCase()&&(this.Tde&&Qc.a.removeHandler(this.fyb.children[0],"click",this.Tde),this.Ude&&Qc.a.removeHandler(this.fyb.children[0],"keydown",this.Ude),ae.a.P6(this.fyb));if(this.obb){for(let a=
0;a<this.obb.childNodes.length;a++){const d=this.obb.childNodes[a];"a"===d.nodeName.toLowerCase()&&(Qc.a.removeHandler(d,"click",this.dlf),Qc.a.removeHandler(d,"keydown",this.elf))}ae.a.P6(this.obb)}this.edf.innerText="";this.ddf.innerText="";ae.a.P6(this.j0c);ae.a.P6(this.fdf);ae.a.P6(this.nbb);this.obb.innerText="";this.bdf.innerText="";this.gdf.innerText="";this.cdf.innerText=""}P9i(a){Ye.a.Tk(a.target.attributes.getNamedItem("href").value,a.target.attributes.getNamedItem("target").value,void 0,
"InsertClipartDialog");a.stopPropagation();a.preventDefault()}cGm(a){(a?a.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.P9i(a)}e$i(a){const d=a.target.innerText;this.U2&&(this.U2.value=d);this.search(d);a.stopPropagation();a.preventDefault();this.Cha(1,!1)}IGm(a){(a?a.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.e$i(a)}Iaj(a){this.YT&&(this.Ifn(this.YT[this.FUb]),a.stopPropagation(),a.preventDefault(),this.U2.value="",this.Cha(1,!1))}LJm(a){(a?a.keyCode:window.event.keyCode)===
Sys.UI.Key.enter&&this.Iaj(a)}onKeyDown(a){if(a.keyCode>=Sys.UI.Key.left&&a.keyCode<=Sys.UI.Key.down){let d=0;switch(a.keyCode){case Sys.UI.Key.up:d=-5;break;case Sys.UI.Key.down:d=5;break;case Sys.UI.Key.left:d=-1;break;case Sys.UI.Key.right:d=1}this.RNa=this.RNa+d<this.wt.children.length-1?0>this.RNa+d?0:this.RNa+d:this.wt.children.length-1;this.I0g(this.RNa);a.preventDefault();a.stopPropagation()}else a.keyCode===Sys.UI.Key.enter?(a=Number.parseInvariant(a.target.id.substr(4)),0<=a&&a<this.wt.children.length&&
this.Duj(a)):a.keyCode===Sys.UI.Key.tab&&(this.RNa=a.shiftKey?Math.max(0,this.RNa-1):Math.min(this.RNa+1,this.wt.children.length-1))}Duj(a){if(!(this.wt.children.length<=a||0>a)){var d=this.wt.children[a],n=this.wt.children[0];n=n.clientHeight-n.children[0].clientHeight+2;this.wt.scrollTop+this.wt.clientHeight<d.offsetTop+d.clientHeight?this.wt.scrollTop=d.offsetTop-3*d.clientHeight-n:this.wt.scrollTop>d.offsetTop&&(this.wt.scrollTop=d.offsetTop-n/2);this.agj(a)}}validate(){return!0}onError(){this.wt&&
(this.wt.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)}Hgj(a){if(this.wt)if(a.data.X0){var d=a.data.X0.lastChild.childNodes;this.YT||(this.YT=[]);for(a=0;a<d.length&&100>this.YT.length;a++){var n=d[a];1===n.nodeType&&"image"===n.nodeName&&(n=pj.ipl(n),this.YT.push(n))}this.lhi();this.YT.length||(this.wt.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(a.data.Rd){a=w.a.u8g(a.data.Rd);try{d=parseInt(a)}catch(z){d=14}this.wt.innerText=26===d?Box4Intl.Box4Strings.l_ClipartCannotConnect:
Box4Intl.Box4Strings.l_ClipartNoResultsFound}}lhi(){if(this.YT){ae.a.P6(this.wt);this.zeb&&(this.zeb.dispose(),this.zeb=null);this.wt.focus();this.wt.classList.remove("ClipartSearchInProgress");for(let d=0;d<this.YT.length;d++){var a=document.createElement("a");a.setAttribute("href","#");a.id="itab"+d;const n=document.createElement("span");n.id="clip"+d;n.classList.add("ClipartImageContainer");a.appendChild(n);this.wt.appendChild(a);d<parseInt(String(this.wt.clientHeight/n.clientHeight))*parseInt(String(this.wt.clientWidth/
n.clientWidth))&&(a=this.Ndi(this.YT[d]),n.appendChild(a))}this.orf&&(this.Duj(this.FUb),this.I0g(this.FUb))}}W6h(){if(ic.FocusManager.jA()){var a=ic.FocusManager.instance().getRegion(this.OB);a&&a.Tf.ou(this.U2)}else this.U2.focus();for(a=0;a<this.wt.childNodes.length;a++){const d=this.wt.childNodes[a];1===d.childNodes.length&&this.f9k(d.childNodes[0])}ae.a.P6(this.wt);this.U6h();this.Cha(1,!1);this.zeb=new Vo.a(Box4Intl.Box4Strings.l_ClipartSearching);this.zeb.gHe=!1;this.wt.appendChild(this.zeb.element);
this.wt.classList.add("ClipartSearchInProgress")}U4l(a){1===a&&this.YT&&Wo.vz.KGa(this.Wqh.context)&&(a=this.YT[this.FUb])&&this.Wqh.tYa(a)}I0g(a){this.RNa=a;a=this.wt.children[this.RNa];ic.FocusManager.jA()?ic.FocusManager.instance().getRegion(this.OB).Tf.ou(a):a.focus()}static get vz(){return Wo.si=Wo.si||la.a.instance.resolve("Box4.Images.IImageEditor")}}Wo.si=null;Object(t.a)(Wo,"InsertClipartDialog",xg.a,[]);class Mq extends ll{constructor(a,d,n,z,O,ca){super(a,d,n,z,O,ca,!1);new Wo(this)}tYa(a){this.eEe()&&
this.he.Zg().contentReplicator.forceOutbound(Object(m.a)(this,this.lIm,"onPlaceholderNodeSaved$3"),null,a)}lIm(a){if(this.Qdm()){var d=this.he.Zg(),n=d.contentReplicator.Bw.toString(),z=new Sys.Net.WebRequest;z.set_url("ClipArtUpload.ashx");z=new Sys.StringBuilder(z.getResolvedUrl());this.xL(z,be.a.assetId,a.assetId,!0);this.xL(z,Me.a.lcid,l.AFrameworkApplication.lcid.toString());this.xL(z,Me.a.nc,this.Bz?this.Bz.id.toString():this.he.id.toString());this.xL(z,Me.a.cellId,d.gl.toString());this.xL(z,
Me.a.fileId,d.Ds);this.xL(z,Me.a.Vxa,n);this.xL(z,Me.a.t_,this.Fm.toString());a=Re.a.Do;uf.a.instance.J(4)&&(a=this.he.fa(bd.a.wH,Re.a.Do));this.xL(z,Me.a.wH,a.toString());this.xL(z,Me.a.k$a,"1");d.ZG&&this.xL(z,Me.a.ZG,d.ZG);this.xL(z,Me.a.classId,this.Bz?this.Bz.properties.Jb.toString():this.he.Jb.toString());this.Zb.hasProperty(Qb.a.imageType)&&this.xL(z,be.a.imageType,this.Zb.getValue(Qb.a.imageType).toString());Xf.a.instance.sVh(z);l.AFrameworkApplication.Gd.Ni(z.toString(),2,"",{},!1,2,Object(m.a)(this,
this.kQn,"uploadFinished"),Object(m.a)(this,this.uploadFailed,"uploadFailed"),null);ll.lNc++}}xL(a,d,n,z){a.append(z?"?":"&");a.append(w.a.Xh(d));a.append("=");a.append(w.a.Xh(n))}kQn(a){if(({group:d}=tf.a.b9(a.data.Rd,d)).returnValue){var d=d.Responses[0];d.usb=a.data.px;d.Xt=a.data.Ri?a.data.Ri[Tc.a.tP]:"";this.ELa(d)}else this.uploadFailed(null)}uploadFailed(){const a=new bg.a;a.StatusCode=14;this.ELa(a)}M_f(a){switch(a){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;
default:return super.M_f(a)}}ELa(a){super.ELa(a);ll.lNc--}}Object(t.a)(Mq,"ClipartUploader",ll,[]);class Nm{constructor(a,d,n){this.si=a;this.Gj=d;this.ga=n}lb(){this.ga.Aa(Mb.a.ukg,Kb.a.view,Object(m.a)(this,this.V4l,"insertClipartDialogView"),260)}V4l(a,d,n,z,O){a=this.si.KGa(d);return 2===n&&a?(new Mq(d,th.a.instance,l.AFrameworkApplication.K,O,this.Gj,this.ga),32):1===n?a&&Lb.App.bne?32:8:2}}Object(t.a)(Nm,"ClipArtActor",null,[]);class Wm{constructor(){this.Z=null}get name(){return"Box4.ClipArt"}Hb(a){this.Z=
a;a.ha("Box4.ClipArt.ClipArtActor",()=>new Nm(a.resolve("Box4.Images.IImageEditor"),a.resolve("Box4.IUndoManager"),l.AFrameworkApplication.pa)).singleInstance()}init(){this.Z.resolve("Box4.ClipArt.ClipArtActor").lb();const a=Lb.App.oa;a&&a.updateCommandUI()}dispose(){}}Object(t.a)(Wm,"ClipartPackage",null,[1,2]);class ml{constructor(a){this.efb=this.Ieb=this.ofb=this.nfb=null;this.mDh=this.wh=this.Bja=!1;this.Csf=this.JDh=null;this.xDh=0;this.va=this.FDh=null;this.fea=a;this.mZ=3;this.k4c=!0}initialize(a,
d,n){this.nfb=this.Abg(a,d);this.ofb=CommonUIStrings.l_SavingStatus;this.Ieb=CommonUIStrings.l_ReadOnlyStatus;this.efb=CommonUIStrings.l_ReviewModeStatus;this.fea&&this.fea.execute(z=>{z.Byc(Object(m.a)(this,this.$_d,"updateToSavingStatus"))});this.wh=!0;this.va=n;return!0}Mvb(a,d){this.Bja=a;this.mZ=d;this.d$a(this.k4c)}d$a(a){!this.k4c&&a&&(this.FDh=new Date);this.k4c=a;a=null;3===this.mZ&&(a=this.k4c?this.nfb:this.ofb);this.dbl(a)}Abg(a,d){return a?String.format(CommonUIStrings.l_SavedToStatus,
CommonUIStrings.l_OneDriveName):d&&d.length?String.format(CommonUIStrings.l_SavedToStatus,d):CommonUIStrings.l_SavedStatus}$_d(){this.d$a(!1)}iGl(){switch(this.mZ){case 1:return this.Ieb;case 2:return this.efb;default:return null}}r$l(a){return this.mDh===this.Bja&&this.xDh===this.mZ&&this.JDh===a}bhi(a){appChrome.getHeaderApi().then(d=>{d.updateDocumentTitleStatus(this.Bja,a,this.iGl(),this.FDh,this.k4c);return null});this.Csf=null}dbl(a){this.wh&&xh.c()&&!this.r$l(a)&&(Ye.a.rRd()?(this.Csf&&k.ULS.sendTraceTag(595146389,
340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.Csf=window.requestIdleCallback(()=>{this.bhi(a)})):window.requestAnimationFrame(()=>{this.bhi(a)}),this.mDh=this.Bja,this.JDh=a,this.xDh=this.mZ)}}Object(t.a)(ml,"ReactSaveStatusUIHandler",null,[651]);class Ej{constructor(a,d){this.$_=null;this.nfb=CommonUIStrings.l_SavedStatus;this.ofb=CommonUIStrings.l_SavingStatus;this.Ieb=CommonUIStrings.l_ReadOnlyStatus;this.efb=CommonUIStrings.l_ReviewModeStatus;this.QNa=d;this.fea=
a;this.mZ=3;this.GAb=!0}wD(){this.fea&&this.fea.execute(a=>{a.Byc(Object(m.a)(this,this.$_d,"updateToSavingStatus"))});this.QNa.execute(a=>{this.$_=a})}Mvb(a,d){this.mZ=d;3===d?this.d$a(this.GAb):2===d?this.Ybh(this.efb):this.Ybh(this.Ieb)}$_d(){this.d$a(!1)}d$a(a){this.GAb=a;this.Ybh(this.GAb?this.nfb:this.ofb)}Ybh(a){this.$_&&this.$_.Eh(D.a.vMj,this.oXk(a))}oXk(a){const d={};d.StatusText=a;return d}}Object(t.a)(Ej,"SaveStatusPostMessageHandler",null,[651]);var qj=b(904);class nm{constructor(a,d,
n,z){this.efb=this.Ieb=this.ofb=this.nfb=null;this.pXb=0;this.t6=this.ytf=this.yQb=this.n9e=this.pxf=null;this.uc=a;this.Pyb=d;this.fea=n;this.Kl=z;this.lBh=!0;this.Bja=!1;this.mZ=3;this.GAb=!0}initialize(a,d){if(!this.uc)return!1;this.nfb=this.Abg(a,d);this.ofb=CommonUIStrings.l_SavingStatus;this.Ieb=CommonUIStrings.l_ReadOnlyStatus;this.efb=CommonUIStrings.l_ReviewModeStatus;this.wD();return!0}Abg(a,d){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):d&&d.length?
String.format(CommonUIStrings.l_SavedToStatus,d):CommonUIStrings.l_SavedStatus}wD(){this.Pyb&&this.Pyb.execute(a=>{a.bzk(Object(m.a)(this,this.Bdi,"createStatusAndModeElements"));a.Pyk(Object(m.a)(this,this.dvn,"showHideSaveStatusElement"));a.jFn&&this.Bdi(null,null)});this.fea&&this.fea.execute(a=>{a.Byc(Object(m.a)(this,this.$_d,"updateToSavingStatus"))})}v1(){this.t6&&this.uc&&this.uc.sua(this.t6)}dvn(a,d){this.Mvb("true"===d,this.mZ)}Mvb(a,d){this.Bja=a;this.mZ=d;this.n9e&&(this.n9e.style.display=
this.Bja||3===this.mZ||!this.pxf?"none":"");this.yQb&&(this.yQb.style.display=this.Bja||3===this.mZ?"none":"",this.yQb.innerText=1===this.mZ?this.Ieb:this.efb,this.yQb.title=1===this.mZ?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.ytf&&(this.ytf.style.display=this.Bja||1===this.mZ||!this.pxf&&!this.yQb?"none":"");this.t6&&(this.t6.style.display=this.Bja||1===this.mZ?"none":"",this.d$a(this.GAb),this.t6.title=CommonUIStrings.l_SaveStatusTooltip)}Bdi(a,d){a=
document.getElementById(qj.CuiHelper.NZl);d&&d.wSn||!a||""===this.nfb||""===this.ofb||""===this.Ieb||""===this.efb||(this.pxf=document.getElementById(qj.CuiHelper.wIf),this.n9e=qj.CuiHelper.gpe(a,"BreadcrumbAppModeDash","-"),this.yQb=qj.CuiHelper.gpe(a,"BreadcrumbAppModeStatus",1===this.mZ?this.Ieb:this.efb),this.yOj(this.yQb),this.ytf=qj.CuiHelper.gpe(a,"BreadcrumbSaveStatusDash","-"),this.t6=qj.CuiHelper.gpe(a,"BreadcrumbSaveStatus",this.nfb),this.yOj(this.t6),this.Mvb(this.Bja,this.mZ))}$_d(){this.d$a(!1)}d$a(a){this.GAb=
a;this.VOn(this.GAb?this.nfb:this.ofb)}VOn(a){!this.t6||3!==this.mZ&&2!==this.mZ||(this.lBh&&!this.GAb?(this.pXb=this.t6.offsetWidth<this.pXb?this.pXb:this.t6.offsetWidth,this.BKn(this.ofb),this.lBh=!1):this.t6.innerText=a)}yOj(a){a.style.direction=this.Kl?"rtl":"ltr";a.style.width="auto";a.style.textAlign=this.Kl?"right":"left";a.style.display=this.Bja?"none":"";a.setAttribute("Unselectable","on")}BKn(a){this.t6&&(this.t6.style.width="",this.t6.innerText=a,this.pXb=this.t6.offsetWidth<this.pXb?this.pXb:
this.t6.offsetWidth,a=Qk.a.Hv(this.t6),this.t6.style.width=this.pXb-ae.a.kO(a.paddingLeft)-ae.a.kO(a.paddingRight)+1+"px")}}Object(t.a)(nm,"SaveStatusUIHandler",null,[651]);var Io=b(67);class eo{constructor(){this.ztf=this.Zrf=this.B1a=this.Z=null}get name(){return"Common.App.SaveStatus"}Hb(a){this.Z=a;l.AFrameworkApplication.K.ea("PostMessageEmbedded")&&l.AFrameworkApplication.nH?this.Z.register(Ej,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().zd(()=>
new Ej(this.Z.Ca("Common.App.HostNotification.EditNotificationEventSource"),this.Z.Ca("Postmessage.IHostPostmessenger"))):l.AFrameworkApplication.la.eb.uHe||(l.AFrameworkApplication.la.eb.eM?this.Z.register(ml,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().zd(()=>new ml(this.Z.Ca("Common.App.HostNotification.EditNotificationEventSource"))):this.Z.register(nm,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().zd(()=>
new nm(Io.EventHandlerManager.instance,this.Z.Ca("Common.App.Header.HeaderEventSource"),this.Z.Ca("Common.App.HostNotification.EditNotificationEventSource"),l.AFrameworkApplication.isRtl)))}init(){l.AFrameworkApplication.K.wq(Object(m.a)(this,this.Gw,"onFullAppSettingsReady"))}Gw(){const a=l.AFrameworkApplication.K,d=!!l.AFrameworkApplication.la.eb&&4===l.AFrameworkApplication.la.eb.Bm;if(a.ea("WordEditorAutoSaveImprovementIsEnabled")||a.ea("PptEditorSaveStatusInHeaderEnabled")||d&&a.ea("SimplifiedReactRibbonUxIsEnabled")||
a.ea("ExcelSaveStatusInHeaderEnabled")||a.ea("VisioSaveStatusInHeaderEnabled"))l.AFrameworkApplication.K.ea("PostMessageEmbedded")&&l.AFrameworkApplication.nH?(this.ztf=this.Z.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.ztf.wD():l.AFrameworkApplication.la.eb.uHe||(l.AFrameworkApplication.la.eb.eM?(this.Zrf=this.Z.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.Zrf.initialize(a.ea("IsSkyDrive"),a.Ga("HostNameToIncludeInSavedStatus"),l.AFrameworkApplication.K):
(this.B1a=this.Z.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.B1a.initialize(a.ea("IsSkyDrive"),a.Ga("HostNameToIncludeInSavedStatus")))}dispose(){this.B1a&&this.B1a.v1()}}Object(t.a)(eo,"PackageManager",null,[1,2]);var fm=b(1469);class Fn{get name(){return"Common.App.EventsCachePackage"}Hb(){}init(){fm.a.instance.init()}dispose(){}static main(){M.a.instance.Sb(new Fn)}}Object(t.a)(Fn,"EventsCachePackage",null,[1,2]);var Bi=b(119),bi=b(190),Ri=b(1292),rg=b(1193),Yf=b(435),Si=b(1331),
Om=b(1310),ze=b(1285),rj=b(276),Ne=b(1288);class cj{constructor(a){this.LAh=!1;this.R2d=this.Ro=null;this.o8e=!1;this.rJ=a}get control(){return this.rJ}get yd(){return this.control.yd}get root(){return this.control.root}get nM(){return this.control.nM}get Pgb(){return this.control.Pgb}get Sk(){return this.control.Sk}get tI(){return this.control.tI}rN(){}initialize(){}mz(a,d,n){this.control.Lbl(a,d,n)}Km(){ze.c(this.control.Hh.Command)||this.Vv(this.control.Hh.Command,null,null)}Vv(a,d,n){let z=0;
this.root&&(z=this.root.rCa(a,d,n));this.control.enabled=0<(z&1);return z}ODa(){let a=this.control.visible;this.root.z9a&&(a=this.yd[rj.a.visible],a!==this.control.visible&&(this.control.visible=a,this.root.RMc=!0));return a}Vdh(){const a=Ne.a.TDa(this.yd[rj.a.labelText],this.control.Hh.LabelText);this.FXe(a)}FXe(a){this.control.labelText!==a&&(this.tI.forEach(d=>{d.FXe(a)}),this.control.labelText=a,this.root.uqb=!0)}Noc(){const a=Ne.a.TDa(this.yd[rj.a.alt],this.control.Hh.Alt);this.HSc(a)}HSc(a){this.control.EJj!==
a&&(this.tI.forEach(d=>{d.HSc(a)}),this.control.EJj=a)}uua(){const a=Ne.a.TDa(this.yd[rg.a.Image16by16Class],this.control.Hh.Image16by16Class),d=Ne.a.TDa(this.yd[rg.a.Image32by32Class],this.control.Hh.Image32by32Class);var n=Ne.a.TDa(this.yd[rg.a.Image48by48Class],this.control.Hh.Image48by48Class);n=ze.b(n)?d:n;this.xhd(this.tI.small,a);this.xhd(this.tI.medium,a);this.xhd(this.tI.large,d);this.xhd(this.tI.nxn,a);this.xhd(this.tI.wLc,n)}xhd(a,d){!a||ze.c(a.EX)||ze.c(d)||a.EX.className===d||(a.EX.className=
d)}QLn(a){if(!ze.b(a)&&this.root.V8g){for(const d of this.control.rOf){const n=d.w_===a;n&&(this.control.oAf=d);this.control.visible&&(d.GD=n)}this.control.visible&&(this.root.uqb=!0)}}zAk(){if(this.tI.wLc&&this.tI.wLc.OU&&this.tI.wLc.mEb){const a=this.tI.wLc.OU,d=Ne.a.TDa(this.yd[Yf.a.Description],this.control.Hh.Description);ze.b(d)&&(a.style.position="relative",a.style.top=(a.parentNode.offsetHeight-a.offsetHeight)/2+"px",a.style.padding="0px")}}onFocus(){const a=this.Sk;Object(Uc.a)(Si.a,a)?this.nM.lPb(a):
this.root.z5b=this.control;return!1}onBlur(){const a=this.Sk;this.control.bdc()&&Ne.a.gv(a.Pb,"cui-ctl-menu-hovered-without-focus");this.root.z5b=null;return!1}R4(a){if(this.control.bdc()){var d=this.nM.oDa;const n=d===this.root.kfc-1;d=n?null:this.root.YF[d+1];this.RMf(!1);n||this.control===d||Ne.a.gv(d.bec,Om.MenuLauncher.YHd);this.control.enabled&&this.control.uw?n?this.control.l5():(Ne.a.uf(this.Sk.Pb,"cui-ctl-menu-hovered-without-focus"),d.kra=this.control.uw):n?this.nM.setFocus(a.ed):(d.kra=
this.nM.Pb,this.nM.JCa())}return!1}sV(){this.control.bdc()&&Ne.a.gv(this.Sk.Pb,"cui-ctl-menu-hovered-without-focus");return!1}onKeyDown(a){let d=!1;if(!ze.c(a.Ua)&&!ze.c(a.Ua.rawEvent)){const n=a.Ua.keyCode;a=a.Ua.rawEvent.shiftKey;n===Sys.UI.Key.enter&&(d=!0);if(Object(Uc.a)(Si.a,this.Sk)){const z=this.nM;if(!ze.c(z)){const O=z.oDa,ca=0===this.root.Q8,Da=!ze.c(this.control.EOm);if(n!==Sys.UI.Key.tab&&n!==Sys.UI.Key.left&&n!==Sys.UI.Key.right&&n!==Sys.UI.Key.up&&n!==Sys.UI.Key.down&&n!==Sys.UI.Key.esc)return d;
Ye.a.GAc();n!==Sys.UI.Key.tab||a?n===Sys.UI.Key.tab&&a?(z.JP(1),d=!0):n===Sys.UI.Key.left&&ca||n===Sys.UI.Key.right&&!ca?(Da?z.JP(2):0<O&&this.root.uib(O,!0,!1),d=!0):n===Sys.UI.Key.right&&ca||n===Sys.UI.Key.left&&!ca?(Da&&z.JP(4),d=!0):n===Sys.UI.Key.up?(z.JP(5),d=!0):n===Sys.UI.Key.down?(z.JP(6),d=!0):n===Sys.UI.Key.esc&&(this.root.uib(O,!0,!1),d=!0):(z.JP(0),d=!0)}}}return d}eC(a){let d=!1;if(!ze.c(a.Ua)&&!ze.c(a.Ua.rawEvent)){const n=a.Ua.keyCode;gb.KeyInputManager.kgg(a)||n!==Sys.UI.Key.enter&&
n!==Sys.UI.Key.space||(d=this.qfg(a),d||(this.mz(a.Ec,1,a.Ua),d=!0))}return d}ZF(a){this.cOf();if(this.Pgb){let d=!0;2===a.ed&&(d=a.oV===Sys.UI.MouseButton.leftButton);d&&this.Sk&&this.Che(this.Sk.Pb)}(a.Ua.type.toLowerCase()!==vb.a.hw||this.Pgb)&&a.Ua.preventDefault();return!1}get Smg(){return this.LAh}Ael(){this.LAh=!0}cOf(){this.Smg&&this.control.root.eDb()}kta(a){Object(Uc.a)(Si.a,this.Sk)&&!this.Pgb&&2===a.ed&&a.oV===Sys.UI.MouseButton.leftButton?(this.mz(a.Ec,a.ed,a.Ua),a=!0):a=this.control.mHa(a);
return a}onClick(a){let d=!1;Object(Uc.a)(Si.a,this.Sk)&&!this.Pgb&&3===a.ed&&(this.mz(a.Ec,a.ed,a.Ua),d=!0);return I.a.tg?!1:d}MWa(a){return this.ZMe(a)}yna(a){this.mHa(a);return!1}ZMe(a){return ze.c(this.Ro)?!1:(this.C_g(Ye.a.Icc(this.lTh,a.clientPoint)),!0)}RNc(a){let d=!1;this.mHa(a)&&(d=!0);3!==a.ed&&(a=!0,!this.root&&cj.ZEg&&(k.ULS.sendTraceTag(588084884,207,50,"Root is null"),a=!1),a&&this.root.Gqa(),d=!0);return d}UNc(a){return this.mHa(a)}SNc(a){return this.ZMe(a)}TNc(a){return this.mHa(a)}PNc(a){return 3===
a.ed?(this.root.Gqa(),!0):!1}QNc(){return!1}get lTh(){!ze.c(this.Ro)&&ze.c(this.R2d)&&(this.R2d=Ye.a.getElementBounds(this.Ro));return this.R2d}C_g(a){this.o8e!==a&&(this.o8e=a,this.pAf(this.o8e))}pAf(a){ze.c(this.Ro)||Ne.a.A5(this.Ro,Ri.Control.Ghe,a)}Che(a){this.control.enabled&&(this.Ro=a,this.root.wfd=this.control,this.C_g(!0),this.root.o3(this.control,!1))}mHa(a){if(!ze.c(this.Ro)){this.C_g(!1);let d=!!this.root;if(cj.ZEg){const n=Bc.ActionManager.haa(parseInt(this.control.Hh.Command))||"";k.ULS.sendTraceTag(588084885,
207,50,"Root not null: {0}, Action: {1}",d,n)}d&&this.root.z_(this.control,!1);ze.c(a)||Ye.a.Icc(this.lTh,a.clientPoint)&&this.mz(this.Ro,a.ed,a.Ua);d=!!this.root;cj.ZEg&&k.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",d);d&&(this.root.wfd=null);this.R2d=this.Ro=null;return!0}return!1}JP(a){return Object(Uc.a)(Si.a,this.Sk)&&2!==a&&4!==a&&!Ye.a.vbc(this.control.uw)?this.l5():!1}l5(){try{if(this.control.visible){const a=this.control.uw;if(!ze.c(a))return a.focus(),!0}}catch(a){}return!1}RMf(a){const d=
this.nM;ze.c(d)||this.root.uib(d.oDa+1,a)}$Ba(){}qfg(){return!1}fma(a){let d=null;a&&a.rawEvent&&(d={},d[cj.triggerTime]=a.rawEvent.timeStamp);return d}static get ZEg(){null==cj.vof&&(cj.vof=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return cj.vof}}cj.triggerTime="TriggerTime";cj.vof=null;Object(t.a)(cj,"ControlBehavior",null,[645]);var Pm=b(126);class fo extends cj{constructor(a){super(a)}get button(){return this.control}get properties(){return this.control.Hh}rN(a){const d=
a.Nn;a=a.w_;ze.c(d)||(re.a.instance.Ea(vb.a.focus,d,Object(m.a)(this,this.onFocus,"onFocus")),re.a.instance.Ea(vb.a.blur,d,Object(m.a)(this,this.onBlur,"onBlur")),bi.a.instance.Ea(vb.a.pointerOver,d,Object(m.a)(this,this.R4,"onPointerOver")),bi.a.instance.Ea(vb.a.pointerOut,d,Object(m.a)(this,this.sV,"onPointerOut")),gb.KeyInputManager.instance.vD(vb.a.Nf,d,Object(m.a)(this,this.onKeyDown,"onKeyDown"),a),gb.KeyInputManager.instance.vD(vb.a.Bn,d,Object(m.a)(this,this.GK,"onKeyPress"),a),gb.KeyInputManager.instance.vD(vb.a.Of,
d,Object(m.a)(this,this.eC,"onKeyUp"),a),bi.a.instance.Ea(vb.a.pointerDown,d,Object(m.a)(this,this.ZF,"onPointerDown")),bi.a.instance.Ea(vb.a.UE,d,Object(m.a)(this,this.kta,"onPointerUp")),Ae.a.instance.Ea(vb.a.click,d,Object(m.a)(this,this.onClick,"onClick")),Pm.a.instance.Ea(vb.a.hA,d,Object(m.a)(this,this.MWa,"onTouchMove")),Pm.a.instance.Ea(vb.a.vx,d,Object(m.a)(this,this.yna,"onTouchEnd")))}mz(a,d,n){this.control.enabled&&(a=null,this.Sk&&this.Sk.yDd()&&this.nM&&(a=this.root.YF[this.nM.oDa])&&
!this.Smg&&(a.Q8a(this.button),a=null),this.executeCommand(this.control.Hh.Command,d,!0,n),a&&a.Q8a(this.button))}executeCommand(a,d,n,z){if(!ze.c(a)){const O=this.yd;O.CommandValueId=this.button.T8b();O.MenuItemId=this.button.Hh.MenuItemId;O.SourceControlId=this.control.id;this.root.executeCommand(a,O,this.Sk,d,n,null,this.fma(z))}}Km(){ze.c(this.control.Hh.Command)||0<(this.Vv(this.properties.Command,this.properties.QueryCommand,this.yd)&2)&&this.ODa()&&this.b$a()}b$a(){this.Vdh();this.Noc();this.uua()}onFocus(a){super.onFocus(a);
this.E7g();return!1}onBlur(a){super.onBlur(a);this.DZf();return!1}onKeyDown(a){let d=super.onKeyDown(a);ze.c(a.Ua)||this.X3g(a.Dm,a.Ua.keyCode)&&(d=!1);return d}GK(a){let d=!1;ze.c(a.Ua)||ze.c(a.Ua.rawEvent)||(this.X3g(a.Dm,a.Ua.rawEvent.keyCode)?(this.mz(a.Ec,a.ed,a.Ua),d=!0):a.Ua.preventDefault());return d}X3g(a,d){if(I.a.Ah&&d===Sys.UI.Key.enter)switch(a){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}eC(a){let d=!1;ze.c(a.Ua)||this.X3g(a.Dm,a.Ua.keyCode)||
(d=super.eC(a));return d}E7g(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}DZf(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(t.a)(fo,"ButtonBehavior",cj,[]);var er=b(1422);class Gm{}Gm.Color="Color";Gm.IndexColorSelected="ColorSelected";Object(t.a)(Gm,"ColorPickerCommandProperties",null,[]);class vl extends cj{constructor(a){super(a);this.Ibd=this.Dx=-1}get colorPicker(){return this.control}get U2a(){return this.colorPicker.EUk.U2a}get properties(){return this.colorPicker.Hh}mz(a,
d,n){if(this.control.enabled){const z=this.yd;z.Color=vl.tye(a)[er.ColorPicker.Cne];a=null;Ne.a.Jt(this.properties.Stateful)&&this.Sk&&this.Sk.yDd()&&this.nM&&(a=this.root.YF[this.nM.oDa]);this.root.executeCommand(this.properties.Command,z,this.Sk,d,!0,null,this.fma(n));a&&a.Q8a(this.colorPicker)}}Km(){var a=this.yd;a.SourceControlId=this.properties.Id;if(0<(this.Vv(this.properties.Command,this.properties.QueryCommand,a)&2)&&(a=-1,Gm.IndexColorSelected in this.yd&&(a=this.yd[Gm.IndexColorSelected]),
a!==this.Ibd)){const d=this.U2a;0<=a&&a<d.length&&this.PNj(d[a],!0);0<=this.Ibd&&this.Ibd<d.length&&this.PNj(d[this.Ibd],!1);this.Ibd=a}}PNj(a,d){d?Ne.a.uf(a,"cui-colorpicker-selected"):Ne.a.gv(a,"cui-colorpicker-selected")}rN(a){for(let d=0;d<a.Pzf.length;++d){const n=a.Pzf[d];re.a.instance.Ea(vb.a.focus,n,Object(m.a)(this,this.oGg,"onCellFocus"));re.a.instance.Ea(vb.a.blur,n,Object(m.a)(this,this.eDm,"onCellBlur"));gb.KeyInputManager.instance.Ea(vb.a.Nf,n,Object(m.a)(this,this.onKeyDown,"onKeyDown"));
gb.KeyInputManager.instance.Ea(vb.a.Of,n,Object(m.a)(this,this.eC,"onKeyUp"));Ae.a.instance.Ea(vb.a.click,n,Object(m.a)(this,this.fDm,"onCellClick"));bi.a.instance.Ea(vb.a.UE,n,Object(m.a)(this,this.qGg,"onCellPointerUp"));bi.a.instance.Ea(vb.a.pointerOver,n,Object(m.a)(this,this.pGg,"onCellPointerOver"));bi.a.instance.Ea(vb.a.pointerDown,n,Object(m.a)(this,this.gDm,"onCellPointerDown"))}}oGg(a){a=vl.tye(a.Ec);this.nM.lPb(this.Sk);this.q3e(a,!0);return!0}eDm(a){this.q3e(vl.tye(a.Ec),!1);return!0}q3e(a,
d){d?(this.Dx=parseInt(a.getAttribute("arrayPosition")),Ne.a.uf(a,"cui-colorpicker-hoveredOver"),this.E7g(a)):(this.Dx=-1,this.DZf(a),Ne.a.gv(a,"cui-colorpicker-hoveredOver"))}fDm(a){3===a.ed&&this.mz(a.Ec,a.ed,a.Ua);return!0}qGg(a){3!==a.ed&&this.mz(a.Ec,a.ed,a.Ua);return!0}pGg(a){this.RMf(!1);a=parseInt(vl.tye(a.Ec).getAttribute("arrayPosition"));this.MTd(a);return!0}gDm(){return!1}E7g(a){if(this.control.enabled){const d=this.properties.CommandPreview;if(!ze.b(d)){const n=this.yd;n.Color=a[er.ColorPicker.Cne];
this.root.executeCommand(d,n,this.Sk,0,!1)}}}DZf(a){if(this.control.enabled){const d=this.properties.CommandRevert;if(!ze.b(d)){const n=this.yd;n.Color=a[er.ColorPicker.Cne];this.root.executeCommand(d,n,this.Sk,0,!1)}}}JP(a){a=Ri.Control.L2f(this.Dx,this.colorPicker.width,this.U2a.length,a);if(a!==this.Dx&&this.MTd(a))return!0;this.q3e(this.U2a[this.Dx],!1);return!1}l5(){return this.MTd(0)}MTd(a){return this.U2a&&this.U2a.length>a&&(a=this.U2a[a],a.firstChild)?(a.firstChild.focus(),!0):!1}$Ba(){-1!==
this.Dx&&this.q3e(this.U2a[this.Dx],!1)}static tye(a){return vl.JGl(a)}static JGl(a){var d=["td"];const n=d.length;if(!a)return null;for(var z=0;z<n;z++)if(a.tagName.toLowerCase()===d[z].toLowerCase())return a;for(a=a.parentNode;a;){for(z=0;z<n;z++)if(a.tagName.toLowerCase()===d[z].toLowerCase())return a;a=a.parentNode}return null}}Object(t.a)(vl,"ColorPickerBehavior",cj,[]);var np=b(261),xm=b(306),Yp=b(1511),op=b(634),sa=b(1317),Za=b(1499);class Bb{constructor(a,d){this.Tpk=a;this.zAh=d}qXe(a,d,
n,z){if(ze.c(a)||ze.c(d))return null;const O=new Za.a;const ca=z.x;var Da=z.y;const Xa=z.width;var zb=z.height;let Vb;Bb.TCc(d,"flyoutWidth");z=Bb.TCc(d,"flyoutRealHeight");const Fc=Bb.TCc(d,"viewportWidth");var Yc=Bb.TCc(d,"viewportHeight"),yd=Bb.TCc(d,"viewableLeft");const je=Bb.TCc(d,"viewableTop"),Le=this.Tpk;let Ve=!1,gg=!1;const Lh=1===n,Ki=4===n,Ak=this.zAh;a.style.maxHeight="none";a.style.top="0px";a.style.overflowY="visible";a.style.width="auto";Vb=this.P3i(a);O.fSj=Yc;O.Cgh=Fc;if(Lh)Le?
d=ca+Xa:(d=ca-Vb,O.HIb=!0),zb=Da;else{var Uk="";Xa>Vb&&(Vb=Xa,Uk=(Vb-2*sa.Menu.uLe).toString());Le?d=ca:(d=ca+Xa-Vb,O.HIb=!0);zb=Da+zb;""!==Uk&&(a.style.minWidth=Uk+"px")}Ak&&(zb+=je,d+=yd);a.style.top=zb+"px";a.style.left=d+"px";let Rl=!1;Uk=!1;Vb<=Fc?d+Vb>yd+Fc?(Lh&&Le&&ca-Vb>yd||Ki&&ca-Vb>yd?(d=ca-Vb,Ak&&(d+=yd),Uk=O.HIb=!0):(d=yd+Fc-Vb,Ve=!0),Rl=!0):d<yd&&(Lh&&!Le&&ca+Xa+Vb<yd+Fc?(d=ca+Xa,Ak&&(d+=yd),O.HIb=!1,Uk=!0):(d=yd,gg=!0,O.HIb=!0),Rl=!0):Le?(d=yd,Rl=!0,O.HIb=!0):(d=yd+Fc-Vb,Rl=!0,O.HIb=
!1);Rl&&(a.style.left=d+"px");O.GEc=zb;zb+z<=je+Yc&&3!==n||(O.Vug=!0,{ezm:n,unl:Da,xam:Yc,$em:yd}=this.m2f(n,zb,z,Da,je,Yc),zb!==n&&(a.style.top=n+"px",O.GEc=n),-1<Da&&(a.style.maxHeight=Da+"px"),Yc&&(a.style.bottom="0px",a.style.height="auto"),yd&&this.atm(a,Le,Lh,Uk,gg,Ve,Fc,ca,Xa));O.asd=d;O.J2f=Vb;O.G2f=z;return O}m2f(a,d,n,z,O,ca){let Da,Xa,zb;Da=-1;zb=Xa=!1;const Vb=d,Fc=O+ca-d;d=z-n;const Yc=this.zAh;let yd=!1;0>d&&(d=O);Yc||(z-=O);n<=z&&1!==a||(4===a||1===a?n<ca?(d=ca-n,Xa=!0):(d=O,yd=zb=
Xa=!0):(z<Fc&&3!==a?(d=Vb,Xa=!0):Da=z,zb=!0));Yc&&(Xa=!1,yd?Da=ca:d+=O);return{ezm:d,unl:Da,xam:Xa,$em:zb}}atm(a,d,n,z,O,ca,Da,Xa,zb){a.style.overflowY="scroll";a.style.width="auto";if(d){if(ca||z)a.style.left="",a.style.right=(ca?0:Da-Xa)+"px"}else O||z||(a.style.left="",a.style.right=(n?Da-Xa:Da-Xa-zb)+"px")}cyl(a){const d={};if(ze.c(a))return d;d.viewportWidth=ae.a.VTa();d.viewportHeight=ae.a.ima();ze.c(d.viewportWidth)&&(d.viewportWidth=document.documentElement.clientWidth,d.viewportHeight=document.documentElement.clientHeight);
ze.c(d.viewportWidth)&&(d.viewportWidth=document.body.clientWidth,d.viewportHeight=document.body.clientHeight);d.viewableTop=window.pageYOffset;d.viewableLeft=window.pageXOffset;ze.c(d.viewableTop)&&(d.viewableTop=document.documentElement.scrollTop,d.viewableLeft=document.documentElement.scrollLeft);ze.c(d.viewableTop)&&(d.viewableTop=document.body.scrollTop,d.viewableLeft=document.body.scrollLeft);d.flyoutRealHeight=a.scrollHeight!==a.offsetHeight?a.scrollHeight+2*sa.Menu.uLe:a.scrollHeight;const n=
a.style.overflowY;a.style.overflowY="visible";d.flyoutWidth=this.P3i(a);a.style.overflowY=n;return d}P3i(a){return a.offsetWidth}static TCc(a,d){return ze.c(a)?0:a[d]}}Object(t.a)(Bb,"MenuPositioner",null,[]);var ac=b(1335),yc=b(1376),Hc=b(1502),cd=b(1500),Hd=b(1497),le=b(1498),mb=b(1505),gc=b(1326),Gc=b(1419);class Zc extends cj{constructor(a){super(a);this.vnf=0;this.iDh=null;this.Dqf=-1;this.S5d=null;this.WMg=this.iyh=!1;this.Rfk=new Bb(0===this.root.Q8,Ne.a.Jt(this.root.properties.DivSyndicated))}get X3i(){return this.Rfk}get Ew(){return this.control}get properties(){return this.control.Hh}get menu(){return this.Ew.menu}set menu(a){this.Ew.menu=
a}get oQ(){return this.Ew.oQ}set oQ(a){this.Ew.oQ=a}get j0h(){ze.c(this.S5d)&&(this.S5d=Zc.q1k());return this.S5d}get vBj(){let a=!this.root.Lig;Object(Uc.a)(272,this.root)&&1===this.root.kfc&&(a=!0);return a}mz(a,d){Object(Uc.a)(272,this.root)&&this.root.UZf();this.Ew.z4(d)}z4(a){if(this.Ew.enabled&&!this.oQ){var d=Ch.a.instance.mm(Sa.a.z4);d.properties.add("Id",this.Ew.Hh.Id);d.properties.add("InputMethod",np.a[a]);d.end();Mh.a.mark(10326);Ye.a.UHd(this.Ew.Hh.Id,"MenuOpen");this.Ew.uw&&(this.Ew.kra=
Ye.a.Nla(this.Ew.uw.ownerDocument));this.vnf=a;this.cfj(a);this.SWe();this.Ew.Cvb(this.Ew.uw,!0)}}SWe(){ze.c(this.properties.PopulateAsyncTriggerCommand)||this.iyh||(this.vAm(),this.iyh=!0)}vAm(){const a={};a[Yp.a.Callback]=Object(m.a)(this,this.glj,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,a,this.Sk,0,!1)}glj(){this.Ew.m8a()}m8a(){this.oQ&&this.cfj(this.vnf,!0)}cfj(a,d=!1){var n=!0;if(Ne.a.Jt(this.properties.PopulateDynamically)){n=!1;const z=this.vMd(a);
z!==this.iDh&&(n=this.iNg(z,d));n=n||!this.oQ}n&&(d=l.AFrameworkApplication.la.Np,n=null,d&&(n=d.Pe("LoadResource","Menu Initialization")),this.Jnb(a),n&&n.stop(),this.lOe())}Jnb(a){if(!ze.c(this.menu)){if(this.Ew.krb){var d=this.Ew.Sk;if(d&&d.keytip){var n=d.keytip.key.toLocaleLowerCase();this.menu.gnn(String.format("{0} {1}",this.Ew.krb,d.keytip.XYf),this.Ew.H7a&&""!==this.Ew.H7a?String.format("{0}-{1}",this.Ew.H7a,n):n)}}this.menu.kza();Ne.a.uf(this.menu.Pb,this.Ew.qDf);Ne.a.A5(this.menu.Pb,"cui-touch",
3===a||this.root.b2e);if(this.menu.hasItems()){this.menu.rN();d=this.Sk;d.Fki();d.fzd=!0;d.Re(this.menu);d.fzd=!1;this.menu.afj();n=Object(Uc.a)(Gc.a,this.root);var z=null,O=!1;n&&(z=this.root,O=z.Rtb,z.Rtb=!1);var ca=this.menu.Pb;ca.style.visibility="hidden";ca.style.position="absolute";ca.style.top="0px";ca.style.left="0px";I.a.Ah&&!I.a.Q7&&(ca.style.maxHeight="100px",ca.style.overflowY="scroll");document.body.appendChild(ca);this.CAk();this.XRm(ca);Sys.Browser.agent===Sys.Browser.InternetExplorer&&
this.vtk();Ne.a.uf(this.Ew.bec,Om.MenuLauncher.YHd);var Da=this.root.kfc;this.Trn&&this.root.o3(this.control,!0);ca.style.zIndex=String(l.AFrameworkApplication.la.hqa);this.root.vvk(this.Ew);this.menu.oDa=Da;ca.style.visibility="visible";Da=this.vui();if(Object(Uc.a)(le.a,this.menu)){ca.style.position="fixed";const Xa=this.root.YF[0];Xa&&Xa.menu&&Xa.menu.Pb?100!==Ye.a.T4a(this.root.YF[0].menu.Pb)&&xm.a.IZe(ca,Da,Object(m.a)(this,this.GDf,"afterShowMenu")):xm.a.IZe(ca,Da,Object(m.a)(this,this.GDf,
"afterShowMenu"))}else xm.a.IZe(ca,Da,Object(m.a)(this,this.GDf,"afterShowMenu"));this.oQ=!0;this.menu.Uug=!0;!I.a.tg&&this.Ew.Xgn&&this.menu.setFocus(a);n&&(z.Rtb=O);n=this.properties.CommandMenuOpen;ze.b(n)||this.root.executeCommand(n,null,d,a,!1)}}Mh.a.mark(10327)}lOe(){}vtk(){this.Dqf=Ne.a.l4b(this.Dqf);this.Dqf=window.setTimeout(Object(m.a)(this,this.wtk,"addAndPositionBackFrameInternal"),50)}wtk(){this.menu&&this.menu.Pb&&(document.body.appendChild(this.j0h),this.TRm())}TRm(){const a=this.j0h;
var d=this.menu.Pb;a.style.position="absolute";a.style.visibility="hidden";a.style.left=d.style.left;a.style.right=d.style.right;a.style.top=d.style.top;a.style.bottom=d.style.bottom;let n=d.offsetWidth;d=d.offsetHeight;I.a.Q7&&(n-=4,d-=4);a.style.width=n.toString()+"px";a.style.height=d.toString()+"px";a.style.visibility="visible"}get Trn(){return this.root.kfc?!1:!0}GDf(a){a.element&&(a.element.style.filter="",a.element.style.opacity="",this.menu&&this.menu.Pb===a.element&&Object(Uc.a)(Hd.a,this.menu)&&
xm.a.$Xh(this.vui()))}vui(){const a=this.menu.children,d=[];if(Object(Uc.a)(Hd.a,this.menu))for(let n=0;n<a.count;n++){const z=a.J(n);Array.add(d,z.separator);for(let O=0;O<z.children.count;O++){const ca=z.children.J(O);Array.add(d,ca.Pb)}}return d}CAk(){var a=this.menu.children;for(let n=0;n<a.count;n++){const z=a.J(n).children;for(let O=0;O<z.count;O++){var d=z.J(O);if(Object(Uc.a)(Si.a,d)){const ca=d;if("Menu32"===ca.w_||"Menu48"===ca.w_)d=d.control,d.behavior&&(Object(Uc.a)(yc.a,d)||Object(Uc.a)(cd.a,
d))&&d.behavior.zAk()}}}0<a.count&&(a=a.J(0),ze.c(a.separator)||(a.separator.style.display="none"),ze.c(a.L1e)||Ne.a.uf(a.L1e,"cui-menusection-titleAtTop"))}XRm(a){if(!ze.c(a)){a.style.top="0px";a.style.left="0px";a.style.bottom="";a.style.right="";a.style.width="";a.style.minWidth="";var d=op.a.create();try{const n=this.X3i.cyl(a),z=this.dvd();let O=this.root.qXe(a,n,this.Ew.vLe,z);O||(O=this.X3i.qXe(a,n,this.Ew.vLe,z));this.root.Y3i=O}finally{d&&d.dispose()}}}dvd(){const a=Ye.a.getElementBounds(this.Ew.bec);
var d=this.nM;ze.c(d)||ze.c(d.Pb)||(d=Ye.a.getElementBounds(d.Pb),a.x=d.x+sa.Menu.uLe,a.width=d.width-2*sa.Menu.uLe);Object(Uc.a)(gc.a,this.Ew.GIe)&&(a.height=0);return a}PGa(){if(this.Ew.oQ){k.ULS.sendTraceTag(6688860,207,50,"Menu closing {0}",{["Id"]:this.Ew.Hh.Id});this.menu.$Ba();this.vnj();this.oQ=!1;this.menu.Uug=!1;this.root.z_(this.control,!0);this.vBj?l.AFrameworkApplication.la.iMb(this.Ew.kra,this.vnf):this.Gbn();this.Ew.kra=null;var a=this.Ew.bec;Ne.a.gv(a,Om.MenuLauncher.YHd);this.Ew.Cvb(this.Ew.uw,
!1);Ne.a.gv(a,"cui-ctl-menu-hovered-without-focus");this.menu.JCa();ze.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.Sk,0,!1);this.unj()}}Gbn(){const a=this.Ew.kra;if(a)try{a.focus()}catch(d){}}unj(){ae.a.Fr(this.menu.Pb);ae.a.Fr(this.S5d);Ne.a.sua(this.menu.Pb)}vMd(a){if(this.WMg&&Ne.a.Jt(this.properties.PopulateOnlyOnce)||ze.c(this.properties.PopulateQueryCommand))return null;if(void 0===a||null===a)a=0;const d=this.Ew.B6f();return 0<(this.root.rCa(this.properties.PopulateQueryCommand,
this.properties.PopulateQueryCommand,d,a)&1)?d.PopulationXML:null}iNg(a,d=!1){if(this.WMg&&Ne.a.Jt(this.properties.PopulateOnlyOnce))return!0;let n=null;this.iDh=a;ze.c(a)||(n=this.l2k(a));ze.c(n)||(this.WMg=!0);if(d){this.root.wSk(this.Ew);if(ze.c(n)||!n.hasItems())return this.PGa(),!1;this.vnj();this.unj()}this.smn(n);return!0}m9i(){}l2k(a){a=ac.Builder.Moe(a);if(!ze.c(a)){const d=new mb.a;d.L7h=!0;d.parentId=this.control.id;let n;n=Object(Uc.a)(Hc.a,this.control);return this.root.yU.Shb(a,d,n)}return null}smn(a){ze.c(a)||
(ze.c(this.menu)||this.menu.dispose(),this.menu=a,this.m9i())}vnj(){const a=this.menu.parent;a?(a.fzd=!0,a.removeChild(this.menu.id),a.fzd=!1):k.ULS.sendTraceTag(572330335,207,10,"Parent not found for the Menu component {0}",this.menu.id)}onKeyDown(a){let d=!1;ze.c(a.Ua)||ze.c(a.Ua.rawEvent)||Object(Uc.a)(Si.a,this.Sk)||!a.Ua.rawEvent.altKey||a.Ua.keyCode!==Sys.UI.Key.down||(this.mz(a.Ec,1,a.Ua),d=!0);d||(d=super.onKeyDown(a));return d}ZF(a){this.cOf();2===a.ed&&a.oV!==Sys.UI.MouseButton.leftButton||
this.mz(a.Ec,a.ed,a.Ua);a.Ua.preventDefault();return!1}qfg(a){if(!this.nM||!this.nM.inKeytipMode||!this.Ew.l$i)return!1;this.Ew.l$i(this.Sk,a);return!0}static q1k(){const a=Ne.a.createElement("iframe");a.style.position="absolute";a.style.visibility="hidden";a.style.borderWidth="0px";return a}}Object(t.a)(Zc,"MenuLauncherBehavior",cj,[659,645]);var vd=b(1503);class Id extends Zc{constructor(a){super(a)}get Lu(){return this.Epd.properties}get Epd(){return this.control}get K3a(){return this.Epd.K3a}rN(){bi.a.instance.Ea(vb.a.pointerDown,
this.K3a.Nn,Object(m.a)(this,this.ZF,"onPointerDown"));gb.KeyInputManager.instance.Ea(vb.a.Nf,this.K3a.Nn,Object(m.a)(this,this.onKeyDown,"onKeyDown"));gb.KeyInputManager.instance.Ea(vb.a.Of,this.K3a.Nn,Object(m.a)(this,this.eC,"onKeyUp"))}Km(){const a=this.yd[vd.a.SelectedItemId];if(0<(this.Vv(this.Lu.Command,this.Lu.QueryCommand,this.yd)&2)){const d=this.yd[vd.a.SelectedItemId];ze.c(d)||a===d||this.Epd.RSd(d)||(this.yd[vd.a.SelectedItemId]=null)}}}Object(t.a)(Id,"DropDownBehavior",Zc,[]);var Yd=
b(581),nf=b(1329);class Zf extends Id{constructor(a){super(a);this.Dbb=null;this.Wnf=this.eVb=this.BOa=!1;this.j$c=null;this.h$c=-1}get zaa(){return this.control}get oX(){return this.zaa.oX}get AL(){return this.zaa.AL}get FFe(){return this.yd[Yd.a.IsFreeForm]}set FFe(a){this.yd[Yd.a.IsFreeForm]=a}rN(a){bi.a.instance.Ea(vb.a.pointerDown,a.Nn,Object(m.a)(this,this.ZF,"onPointerDown"));const d=a.ft;re.a.instance.Ea(vb.a.focus,d,Object(m.a)(this,this.cKb,"onInputFocus"));re.a.instance.Ea(vb.a.blur,d,
Object(m.a)(this,this.QJa,"onInputBlur"));gb.KeyInputManager.instance.Ea(vb.a.Nf,d,Object(m.a)(this,this.qGm,"onInputKeyDown"));gb.KeyInputManager.instance.Ea(vb.a.Bn,d,Object(m.a)(this,this.rGm,"onInputKeyPress"));Eg.a.instance.Ea(vb.a.QS,d,Object(m.a)(this,this.BHg,"onInputMouseUp"));bi.a.instance.Ea(vb.a.pointerDown,d,Object(m.a)(this,this.tGm,"onInputPointerDown"));bi.a.instance.Ea(vb.a.pointerDown,a.rji,Object(m.a)(this,this.ZHg,"onMenuButtonPointerDown"))}Km(){0<(this.Vv(this.AL.Command,this.AL.QueryCommand,
this.yd)&2)&&(this.eVb||this.CQj(),this.oMn())}m9i(){this.zaa.menuItems=null;var a;var d=a=null;if(!ze.c(this.menu)){this.cXe();for(let z of this.menu.children)for(let O of z.children)if(Object(Uc.a)(Si.a,O)){var n=O;n=n.control;Object(Uc.a)(657,n)&&(a=n,a=a.Hh.MenuItemId);Object(Uc.a)(647,n)&&(d=n,d=d.pmb());ze.c(a)||ze.c(d)||(this.zaa.menuItems[d]=a,a=d=null)}}}tGm(a){Object(Uc.a)(272,this.root)&&2===a.ed&&(this.Dbb=Ye.a.Nla(this.control.uw.ownerDocument),this.control.uw.focus());return!1}ZF(a){this.cOf();
let d=!1;3===a.ed&&(d=super.ZF(a),this.cXe());d&&a.Ua.preventDefault();return!1}ZHg(a){let d=!1;if(2!==a.ed||a.oV===Sys.UI.MouseButton.leftButton)this.mz(a.Ec,a.ed,a.Ua),this.cXe(),d=!0;d&&a.Ua.preventDefault();return!1}qGm(a){let d=!1;if(!ze.c(a.Ua)&&!ze.c(a.Ua.rawEvent)){const n=a.Ua.keyCode;a=a.Ua.rawEvent.shiftKey;Ne.a.Jt(this.AL.AutoComplete);if(n===Sys.UI.Key.enter)this.n_(),this.jXg(),Object(Uc.a)(nf.Ribbon,this.root)&&this.root.f7(),d=!0;else if(n===Sys.UI.Key.tab){if(this.n_(),this.jXg(),
Object(Uc.a)(nf.Ribbon,this.root)&&(d=this.root.k5e(this.Sk.Pb,!a)),Object(Uc.a)(272,this.root))return!0}else n===Sys.UI.Key.backspace||n===Sys.UI.Key.del?this.control.enabled?(this.EKf(),this.j$c=null):d=!0:n===Sys.UI.Key.esc?(this.pXg(),this.jXg(),Object(Uc.a)(nf.Ribbon,this.root)&&this.root.f7(),d=!0):n===Sys.UI.Key.down&&(this.z4(1),this.cXe(),d=!0)}return d}rGm(a){if(!this.control.enabled)return!0;!ze.c(a.Ua)&&a.Ua.charCode&&this.S7k();return!1}BHg(){return this.BOa?!1:this.BOa=!0}dhl(){this.h$c=
-1;const a=this.oX.ft,d=a.value,n=this.hAl(d);if(n){a.value=n.key;if(a.setSelectionRange)a.setSelectionRange(d.length,a.value.length);else if(a.createTextRange){const z=a.createTextRange();z.moveStart("character",d.length);z.moveEnd("character",a.value.length);z.select()}this.j$c=n.value}else this.j$c=null}hAl(a){const d=this.zaa.menuItems;for(let n in d){const z={key:n,value:d[n]};if(z.key.toLowerCase().startsWith(a.toLowerCase()))return z}return null}S7k(){Ne.a.Jt(this.AL.AutoComplete)&&-1===this.h$c&&
(this.Wnf&&(this.vMd(0),this.Wnf=!1),this.h$c=window.setTimeout(Object(m.a)(this,this.dhl,"executeAutoComplete"),this.zaa.OFk))}EKf(){Ne.a.Jt(this.AL.AutoComplete)&&(this.h$c=Ne.a.l4b(this.h$c))}cKb(a){if(this.oQ)return this.menu.setFocus(0),!0;Object(Uc.a)(272,this.root)&&(ic.FocusManager.instance().Wv("ribbon"),this.root.qyd=!1);this.onFocus(a);this.eVb=!0;Ne.a.uf(this.oX.Nn,"cui-cb-focus");Ne.a.Jt(this.AL.PopulateDynamically)&&(this.Wnf=!0);Ye.a.DRc(this.oX.ft);ze.c(this.menu)||this.menu.Cn();
return this.BOa=!1}QJa(){this.eVb=!1;this.n_();Ne.a.gv(this.oX.Nn,"cui-cb-focus");return!1}jXg(){Object(Uc.a)(272,this.root)&&(void 0!==this.Dbb&&null!==this.Dbb&&l.AFrameworkApplication.la.iMb(this.Dbb,2),this.Dbb=null)}n_(){if(this.control.enabled){this.EKf();var a=this.oX.ft;if(void 0===this.yd[Yd.a.Value]||null===this.yd[Yd.a.Value]||a.value!==this.yd[Yd.a.Value].toString())if(this.zaa.RSd(this.j$c))this.FFe=!1,this.yd[Yd.a.Value]=a.value,a={["IsFreeForm"]:!1,["CommandValueId"]:this.zaa.XSd.T8b(),
["MenuItemId"]:this.zaa.XSd.Hh.MenuItemId},this.root.executeCommand(this.AL.Command,a,this.Sk,0,!1);else{if(!Ne.a.Jt(this.AL.AutoComplete)){var d=this.zaa.menuItems[a.value];if(!ze.b(d)&&this.zaa.RSd(d)){this.FFe=!1;this.yd[Yd.a.Value]=a.value;a={["IsFreeForm"]:!1,["CommandValueId"]:this.zaa.XSd.T8b(),["MenuItemId"]:d};this.root.executeCommand(this.AL.Command,a,this.Sk,0,!1);return}}d=!ze.b(a.value)&&""!==w.a.qha(a.value);this.zaa.MXh&&d?(this.FFe=!0,this.yd[Yd.a.Value]=a.value,this.root.executeCommand(this.AL.Command,
{["IsFreeForm"]:!0,["Value"]:a.value},this.Sk,0,!1)):this.pXg()}}else this.pXg()}pXg(){this.EKf();this.j$c=null;this.CQj()}CQj(){const a=this.yd[Yd.a.Value]||"";a!==this.oX.ft.value&&(this.oX.ft.value=a);this.zaa.RSd(this.zaa.menuItems[a])}oMn(){const a=this.yd[Yd.a.FontStyle]||"normal";a!==this.oX.ft.style.fontStyle&&(this.oX.ft.style.fontStyle=a)}cXe(){this.control.uw&&this.menu&&this.control.uw.setAttribute(pd.a.OFf,this.menu.id)}}Object(t.a)(Zf,"ComboBoxBehavior",Id,[]);class ig extends Zc{constructor(a){super(a)}get Eoe(){return this.control}dvd(){let a=
0;this.menu&&this.menu.Pb&&2===this.menu.horizontalAlignment&&(a=this.menu.Pb.clientWidth);return new Sys.UI.Bounds(this.Eoe.x-a,this.Eoe.y,this.Eoe.Xug,this.Eoe.Wug)}}Object(t.a)(ig,"ContextMenuLauncherBehavior",Zc,[]);class Qj extends Zc{constructor(a){super(a)}get Zqe(){return this.control}dvd(){return new Sys.UI.Bounds(this.Zqe.x,this.Zqe.y,this.Zqe.Xug,this.Zqe.Wug)}}Object(t.a)(Qj,"DialogMenuLauncherBehavior",Zc,[]);var hh=b(1191);class ah extends Zc{constructor(a){super(a);this.Znf=!1;this.Cnk=
!Ne.a.osa(this.Lu.ShouldRefreshWhenDropped)}get KHa(){return this.control}get Lu(){return this.control.Hh}rN(a){a=a.Nn;ze.c(a)||(re.a.instance.Ea(vb.a.focus,a,Object(m.a)(this,this.onFocus,"onFocus")),re.a.instance.Ea(vb.a.blur,a,Object(m.a)(this,this.onBlur,"onBlur")),bi.a.instance.Ea(vb.a.pointerOver,a,Object(m.a)(this,this.R4,"onPointerOver")),gb.KeyInputManager.instance.Ea(vb.a.Nf,a,Object(m.a)(this,this.onKeyDown,"onKeyDown")),gb.KeyInputManager.instance.Ea(vb.a.Of,a,Object(m.a)(this,this.eC,
"onKeyUp")),bi.a.instance.Ea(vb.a.pointerDown,a,Object(m.a)(this,this.ZF,"onPointerDown")))}Km(){ze.c(this.control.Hh.Command)||(this.KHa.oQ&&!this.Cnk?this.Znf=!0:(0<(this.Vv(this.Lu.Command,this.Lu.QueryCommand,this.yd)&2)&&this.ODa()&&this.b$a(),Ne.a.Jt(this.Lu.RefreshableMenu)&&this.oQ&&this.menu.aRm()))}b$a(){this.lMn();this.uua();this.PMn();this.KHa.sig=this.yd[hh.a.ImageIsVisible]}lMn(){const a=Ne.a.TDa(this.yd[hh.a.LabelText],this.Lu.LabelText),d=this.yd[hh.a.LabelTextUserGeneratedPlaceholderReplacements];
if(this.control.labelText!==a||this.Lu.LabelTextUserGeneratedPlaceholderReplacements!==d)this.tI.medium&&this.mMn(this.tI.medium.OU,a,d),this.root.uqb=!0,this.control.labelText=a,this.Lu.LabelTextUserGeneratedPlaceholderReplacements=d}mMn(a,d,n){const z=a.lastChild;Ne.a.wwj(a,d+" ",n);d=ze.c(z);k.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",d?"":z.nodeType.toString());d||a.appendChild(z)}PMn(){const a=this.yd[hh.a.ImageBackColor];this.tI.forEach(d=>
{ah.cDk(d.EX,a)})}z4(a){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&(l.AFrameworkApplication.b8("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),l.AFrameworkApplication.pa.processAction(Sa.a.Yod,2));"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||l.AFrameworkApplication.pa.processAction(Sa.a.Yod,2);Object(Uc.a)(Si.a,this.Sk)&&(this.oQ||this.RMf(!0),this.control.enabled&&
this.l5());super.z4(a)}PGa(){super.PGa();this.Znf&&(this.Znf=!1,this.Km())}R4(a){return this.control.bdc()?(this.KHa.oQ?(this.root.F4h(),Ne.a.uf(this.KHa.bec,Om.MenuLauncher.YHd),this.KHa.kra=this.control.uw):(super.R4(a),this.mz(a.Ec,a.ed,a.Ua)),!1):super.R4(a)}onKeyDown(a){let d=!1;if(!ze.c(a.Ua)&&!ze.c(a.Ua.rawEvent)){if(Object(Uc.a)(Si.a,this.Sk)){const n=a.Ua.rawEvent,z=a.Ua.keyCode,O=0===this.root.Q8;n.shiftKey||n.ctrlKey||!(z===Sys.UI.Key.right&&O||z===Sys.UI.Key.left&&!O)||(d=this.qfg(a),
d||(this.mz(a.Ec,1,a.Ua),d=!0))}d||(d=super.onKeyDown(a))}return d}static cDk(a,d){ze.c(a)||ze.c(d)||a.style.backgroundColor===d||(a.style.backgroundColor=d)}}Object(t.a)(ah,"FlyoutAnchorBehavior",Zc,[]);var Dg=b(1194);class Oi extends cj{constructor(a){super(a)}get VEc(){return this.control}get properties(){return this.VEc.properties}get Lqa(){return this.VEc.Lqa}rN(a){a=a.k7b;re.a.instance.Ea(vb.a.focus,a,Object(m.a)(this,this.onFocus,"onFocus"));re.a.instance.Ea(vb.a.blur,a,Object(m.a)(this,this.onBlur,
"onBlur"));bi.a.instance.Ea(vb.a.pointerOver,a,Object(m.a)(this,this.R4,"onPointerOver"));bi.a.instance.Ea(vb.a.pointerOut,a,Object(m.a)(this,this.sV,"onPointerOut"));gb.KeyInputManager.instance.Ea(vb.a.Nf,a,Object(m.a)(this,this.onKeyDown,"onKeyDown"));gb.KeyInputManager.instance.Ea(vb.a.Of,a,Object(m.a)(this,this.eC,"onKeyUp"));bi.a.instance.Ea(vb.a.pointerDown,a,Object(m.a)(this,this.ZF,"onPointerDown"));bi.a.instance.Ea(vb.a.UE,a,Object(m.a)(this,this.kta,"onPointerUp"));Pm.a.instance.Ea(vb.a.hA,
a,Object(m.a)(this,this.MWa,"onTouchMove"));Pm.a.instance.Ea(vb.a.vx,a,Object(m.a)(this,this.yna,"onTouchEnd"))}Km(){const a=this.yd[Dg.a.On],d=this.yd[Dg.a.IsRtl];this.fQj();if(0<(this.Vv(this.properties.Command,this.properties.QueryCommand,this.yd)&2)){var n=!ze.c(this.yd[Dg.a.InnerHTML])||!ze.c(this.properties.InnerHTML),z=!ze.c(this.properties.Image);n||z||(this.control.enabled=!1);z=this.Lqa.k7b;if(!ze.c(z)){if(n){n=Ne.a.TDa(this.yd[Dg.a.InnerHTML],this.properties.InnerHTML);if(null===z.innerHTML||
null===n||w.a.He(z.innerHTML)!==w.a.He(n))z.innerHTML=n;""===n&&(this.control.enabled=!1)}n=z.title;const O=Ne.a.TDa(this.yd[Dg.a.Alt],this.properties.Alt);O===n||this.control.j4g||(z.title=O)}z=this.yd[Dg.a.IsRtl];a===this.yd[Dg.a.On]&&d===z||this.control.Pgc()}}fQj(){const a=this.yd;a[Dg.a.CommandValueId]=this.control.T8b();a.MenuItemId=this.control.Hh.MenuItemId;a.SourceControlId=this.properties.Id}mz(a,d,n){if((a=this.Sk)&&this.control.enabled){const z=this.root;if(l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.ea("ExcelBorderMenuCompactionEnabled")&&a.yDd()&&this.nM){const O=z.YF[this.nM.oDa];O?O.Q8a(this.VEc):k.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.fQj();this.yd[Dg.a.On]||(this.yd[Dg.a.On]=!0,this.control.Pgc());"Menu"===a.w_&&Ne.a.gv(this.Lqa.Nn,"cui-gallerybutton-focused");z.executeCommand(this.properties.Command,this.yd,a,d,!0,null,this.fma(n))}}onFocus(a){super.onFocus(a);Ne.a.uf(this.Lqa.Nn,
"cui-gallerybutton-focused");return!1}onBlur(a){super.onBlur(a);Ne.a.gv(this.Lqa.Nn,"cui-gallerybutton-focused");return!1}}Object(t.a)(Oi,"GalleryButtonBehavior",cj,[]);var ij=b(1506),yj=b(1206),wl=b(1352);class Jd extends cj{constructor(a){super(a);this.Ndb=-1}get RIc(){return this.control}get properties(){return this.RIc.Hh}get hld(){return this.RIc.hld}get Jhg(){var a=null;if(this.Sk&&(a=this.Sk.parent,!Object(Uc.a)(wl.a,a)))throw Error.create("InsertTable must live inside of a MenuSection.");
return a}get gbc(){return this.RIc.hEe.gbc}get sLd(){return this.RIc.hEe.sLd}mz(a,d,n){if(this.control.enabled){a=this.n9f(this.mFc(a));const z=this.fwe(a);this.hld[yj.a.Rows]=this.vze(a)+1;this.hld[yj.a.Columns]=z+1;this.root.executeCommand(this.properties.Command,this.hld,this.Sk,d,!0,null,this.fma(n))}}rN(a){var d=a.Nn;const n=a.r5h;a=a.cells;bi.a.instance.Ea(vb.a.pointerOut,d,Object(m.a)(this,this.eEm,"onControlPointerOut"));Pm.a.instance.Ea(vb.a.hA,d,Object(m.a)(this,this.gEm,"onControlTouchMove"));
Pm.a.instance.Ea(vb.a.vx,d,Object(m.a)(this,this.fEm,"onControlTouchEnd"));for(d=0;d<a.length;++d)this.rFk(n[d],a[d])}rFk(a,d){re.a.instance.Ea(vb.a.focus,a,Object(m.a)(this,this.oGg,"onCellFocus"));bi.a.instance.Ea(vb.a.pointerOver,d,Object(m.a)(this,this.pGg,"onCellPointerOver"));bi.a.instance.Ea(vb.a.UE,d,Object(m.a)(this,this.qGg,"onCellPointerUp"));gb.KeyInputManager.instance.Ea(vb.a.Nf,d,Object(m.a)(this,this.onKeyDown,"onKeyDown"));gb.KeyInputManager.instance.Ea(vb.a.Of,d,Object(m.a)(this,
this.eC,"onKeyUp"));Pm.a.instance.Ea(vb.a.hw,d,Object(m.a)(this,this.hDm,"onCellTouchStart"))}n9f(a){return parseInt(a.id.substr(this.RIc.id.length+1))}fIi(a){this.eIi(this.n9f(a))}vze(a){return Math.floor(a/ij.a.jJd)}fwe(a){return a%ij.a.jJd}eIi(a){if(a!==this.Ndb){var d=this.fwe(a),n=this.vze(a),z=-1;let O=-1;-1!==this.Ndb&&(z=this.vze(this.Ndb),O=this.fwe(this.Ndb));for(;z!==n||O!==d;)z<n?this.Ayj(++z,O,!0):z>n?(this.Ayj(z,O,!1),z--):O<d?this.mwj(++O,z,!0):O>d&&(this.mwj(O,z,!1),O--);this.Jhg?
this.Jhg.nzj(this.dui(n+1,d+1)):(n=(d=this.control.rOf)&&0<d.length?d[0]:null,z=this.Sk,k.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",{["CtrlComps"]:!!d,["FirstComp"]:!!n,["FirstCompPar"]:!!n&&!!n.parent,["DispComp"]:!!z,["DispCompPar"]:!!z&&!!z.parent}));this.Ndb=a}}Ayj(a,d,n){for(let z=0;z<=d;z++)this.dwj(a,z,n)}mwj(a,d,n){for(let z=0;z<=d;z++)this.dwj(z,a,n)}dwj(a,d,n){d=a*ij.a.jJd+d;a=this.gbc[d];d=this.sLd[d];n?(a.className="cui-it-activeCell",d.className="cui-it-activeCellOuter"):
(a.className="cui-it-inactiveCell",d.className="cui-it-inactiveCellOuter")}qGg(a){this.mz(a.Ec,a.ed,a.Ua);return!0}mFc(a){for(;a.hasChildNodes();)a=a.childNodes[0];return ze.c(a.tagName)||"a"!==a.tagName.toLowerCase()?null:a.parentNode.parentNode}ozj(a){const d=this.n9f(a);a.childNodes[0].childNodes[0].title=this.dui(this.vze(d)+1,this.fwe(d)+1)}dui(a,d){let n=this.properties.Alt;ze.c(n)&&(n=this.properties.MenuSectionTitle);return n=String.format(n,d.toString(),a.toString())}eMb(){if(this.Sk){for(var a=
0;a<ij.a.iNc;a++)this.gbc[a].className="cui-it-inactiveCell",this.sLd[a].className="cui-it-inactiveCellOuter";this.Ndb=-1;a=this.properties.MenuSectionInitialTitle;ze.c(a)&&(a="");this.Jhg.nzj(a)}}pGg(a){this.control.enabled&&(a=this.mFc(a.Ec),this.MTd(a),this.EXf(a));return!1}EXf(a){this.ozj(a);this.fIi(a)}oGg(a){if(!this.control.enabled)return!1;a=this.mFc(a.Ec);this.ozj(a);this.fIi(a);return!1}eEm(a){Ye.a.$Dd(this.RIc.hEe.Nn,a.clientPoint)||this.eMb();return!1}hDm(a){if(!this.control.enabled)return!1;
a=this.mFc(a.Ec);this.EXf(a);return!0}gEm(a){if(!this.control.enabled)return!1;a=Ye.a.i9b(a.clientPoint);if(!a||"table"===a.tagName.toLowerCase())return!1;(a=this.mFc(a))?this.EXf(a):this.eMb();return!0}fEm(a){if(!this.control.enabled)return!1;var d=Ye.a.i9b(a.clientPoint);if(!d||"table"===d.tagName.toLowerCase())return this.eMb(),!0;(d=this.mFc(d))?this.mz(d,3,a.Ua):this.eMb();return!0}JP(a){a=Ri.Control.L2f(this.Ndb,ij.a.jJd,ij.a.iNc,a);if(a!==this.Ndb)return this.gbc[a].firstChild.focus(),this.eIi(a),
!0;this.eMb();this.Ndb=-1;return!1}l5(){const a=this.gbc[0];if(ze.c(a))return!1;a.firstChild.focus();return!0}MTd(a){if(ze.c(a))return!1;a.firstChild.firstChild.focus();return!0}$Ba(){this.eMb()}}Object(t.a)(Jd,"InsertTableBehavior",cj,[]);class fl extends Zc{constructor(a){super(a)}Km(){this.control.enabled=!!this.menu}mz(a,d,n){l.AFrameworkApplication.pa.ob(Sa.a.RVa,2,d,this.fma(n))}}Object(t.a)(fl,"JewelMenuLauncherBehavior",Zc,[]);var go=b(1199);class Zp extends cj{constructor(a){super(a)}get properties(){return this.control.Hh}Km(){0<
(this.Vv(this.properties.Command,this.properties.QueryCommand,this.yd)&2)&&this.ODa()&&this.b$a()}b$a(){this.FPn();this.uua();this.Noc()}FPn(){const a=this.control.labelText;let d=this.yd[go.a.Value];ze.c(d)&&(d=this.properties.LabelText,ze.c(d)&&(d=""));d!==a&&this.FXe(d)}rN(a){a=a.Nn;ze.c(a)||(bi.a.instance.Ea(vb.a.pointerDown,a,Object(m.a)(this,this.ZF,"onPointerDown")),bi.a.instance.Ea(vb.a.pointerOver,a,Object(m.a)(this,this.R4,"onPointerOver")),bi.a.instance.Ea(vb.a.pointerOut,a,Object(m.a)(this,
this.sV,"onPointerOut")))}}Object(t.a)(Zp,"LabelBehavior",cj,[]);var zm=b(1386),yp=b(1301),xn=b(1501);class gm extends Zc{constructor(a){super(a);this.Vhf=this.Baf=!1;this.otc=this.bqc=null;if(this.Ptc=l.AFrameworkApplication.K.ea("TellMeRedesignIsEnabled"))this.bqc=this.Yv.Lta.LightImage16by16Class,this.otc=this.Yv.Lta.DarkImage16by16Class}get Yv(){return this.control}GMe(a,d,n,z){d&&(this.Yv.kra=n,l.AFrameworkApplication.la.OKa());if(Object(Uc.a)(yp.a,a)&&z){n=new zm.a;n.CommandLocation=this.root.xha;
n.InvocationMethod=0;const O={};(a=a.control)&&a.Hh&&(O.CommandId=a.Hh.Command,O.ControlId=a.Hh.Id,O.CloseAllMenus=d,a.nM&&a.nM.parent&&a.nM.parent.id&&(O.ParentControlId=a.nM.parent.id.split("-")[0]),this.root.XI&&this.root.XI.V3a(z,O,n))}}PGa(){this.Yv.kra||(this.Yv.kra=this.Yv.ZA);!this.Yv.Nxm&&this.Ptc&&(Ne.a.gv(this.Yv.ZA,"cui-sb-focus"),Ne.a.gv(this.Yv.Y8,"cui-sb-focus"),Ne.a.gv(this.Yv.FKa,this.bqc),Ne.a.uf(this.Yv.FKa,this.otc));this.Baf=!0;super.PGa();this.Baf=!1;this.MQg()}get vBj(){return!this.Yv.T7a}lOe(){this.Yv.lOe()}xTe(){this.Vhf||
this.Baf||(this.Vhf=!0,this.Yv.raiseEvent(xn.a.aob,null))}MQg(){this.oQ||this.Yv.mkg||(this.Vhf=!1,this.Yv.raiseEvent(xn.a.qbc,null))}yHg(a){Ne.a.gv(this.Yv.ZA,"cui-sb-focus");Ne.a.gv(this.Yv.Y8,"cui-sb-focus");this.Ptc&&!this.Yv.oQ&&(Ne.a.gv(this.Yv.FKa,this.bqc),Ne.a.uf(this.Yv.FKa,this.otc));this.Yv.raiseEvent(xn.a.blur,a);this.MQg();this.Yv.kra=this.Yv.ZA;return!1}zHg(a){Ne.a.uf(this.Yv.ZA,"cui-sb-focus");Ne.a.uf(this.Yv.Y8,"cui-sb-focus");this.Ptc&&(Ne.a.gv(this.Yv.FKa,this.otc),Ne.a.uf(this.Yv.FKa,
this.bqc));this.Yv.raiseEvent(xn.a.focus,a);this.xTe();return!1}jJg(){this.Ptc&&(Ne.a.uf(this.Yv.Y8,"cui-sb-hover"),Ne.a.uf(this.Yv.ZA,"cui-sb-hover"),Ne.a.gv(this.Yv.FKa,this.otc),Ne.a.uf(this.Yv.FKa,this.bqc));return!1}iJg(){this.Ptc&&(Ne.a.gv(this.Yv.Y8,"cui-sb-hover"),Ne.a.gv(this.Yv.ZA,"cui-sb-hover"),this.Yv.oQ||this.Yv.mkg||(Ne.a.gv(this.Yv.FKa,this.bqc),Ne.a.uf(this.Yv.FKa,this.otc)));return!1}}Object(t.a)(gm,"SearchBoxBehavior",Zc,[650,645]);class ek{}ek.Value="value";ek.MinValue="MinValue";
ek.MaxValue="MaxValue";ek.Text="Text";Object(t.a)(ek,"SliderCommandProperties",null,[]);class wr extends cj{constructor(a){super(a)}get z6g(){return this.control}get eda(){return this.z6g.eda}get properties(){return this.control.Hh}initialize(){}mz(){}rN(a){a=a.ft;re.a.instance.Ea(vb.a.focus,a,Object(m.a)(this,this.onFocus,"onFocus"));re.a.instance.Ea(vb.a.blur,a,Object(m.a)(this,this.onBlur,"onBlur"));re.a.instance.Ea(vb.a.change,a,Object(m.a)(this,this.nna,"onChange"));re.a.instance.Ea(vb.a.input,
a,Object(m.a)(this,this.nna,"onChange"))}onFocus(a){this.eda.Nn&&Sys.UI.DomElement.addCssClass(this.eda.Nn,"cui-sldr-onfocus");return super.onFocus(a)}onBlur(a){this.eda.Nn&&Sys.UI.DomElement.removeCssClass(this.eda.Nn,"cui-sldr-onfocus");return super.onBlur(a)}nna(){this.OVk(this.eda.ft.value);return!0}OVk(a){this.yd[ek.Value]=parseFloat(a);this.root.executeCommand(this.properties.Command,this.yd,this.Sk,0,!1)}Km(){const a=this.yd[ek.Value],d=this.yd[ek.MaxValue],n=this.yd[ek.Text];var z=this.Vv(this.properties.Command,
this.properties.QueryCommand,this.yd);this.eda&&this.eda.ft&&(this.eda.ft.disabled=!this.control.enabled);if(0<(z&2)){z=this.yd[ek.Value];const O=this.yd[ek.MaxValue],ca=this.yd[ek.Text];(O!==d||z!==a||n!==ca)&&this.eda&&this.eda.ft&&(this.eda.ft.setAttribute(pd.a.Shd,String.format("{0}",O)),this.eda.ft.setAttribute("max",String.format("{0}",O)),this.eda.ft.value=z,this.eda.OU.innerText=this.yd[ek.Text])}}}Object(t.a)(wr,"SliderBehavior",cj,[]);var Tg=b(1198);class vo extends cj{constructor(a){super(a);
this.Eae=0;this.oBb=null;this.J9d=!1;this.MRh=null;this.qvf=!1;this.Yce=this.Obe=-1;this.BOa=!1}get spinner(){return this.control}get VK(){return this.spinner.VK}get properties(){return this.control.Hh}initialize(){const a=this.spinner.Zfh;this.MRh=this.kJn(a);this.Eae=a[0].min;this.oBb=a[0];this.J9d=!1}mz(){}rN(a){const d=a.ft,n=a.GDc;a=a.Opd;re.a.instance.Ea(vb.a.focus,d,Object(m.a)(this,this.onFocus,"onFocus"));re.a.instance.Ea(vb.a.blur,d,Object(m.a)(this,this.onBlur,"onBlur"));gb.KeyInputManager.instance.Ea(vb.a.Nf,
d,Object(m.a)(this,this.onKeyDown,"onKeyDown"));gb.KeyInputManager.instance.Ea(vb.a.Bn,d,Object(m.a)(this,this.GK,"onKeyPress"));gb.KeyInputManager.instance.Ea(vb.a.Of,d,Object(m.a)(this,this.eC,"onKeyUp"));re.a.instance.Ea(vb.a.change,d,Object(m.a)(this,this.nna,"onChange"));Eg.a.instance.Ea(vb.a.QS,d,Object(m.a)(this,this.BHg,"onInputMouseUp"));bi.a.instance.Ea(vb.a.pointerDown,n,Object(m.a)(this,this.u8i,"onArrowPointerDown"));bi.a.instance.Ea(vb.a.pointerDown,a,Object(m.a)(this,this.u8i,"onArrowPointerDown"));
bi.a.instance.Ea(vb.a.UE,n,Object(m.a)(this,this.v8i,"onArrowPointerUp"));bi.a.instance.Ea(vb.a.UE,a,Object(m.a)(this,this.v8i,"onArrowPointerUp"));Pm.a.instance.Ea(vb.a.hA,n,Object(m.a)(this,this.x8i,"onArrowTouchMove"));Pm.a.instance.Ea(vb.a.hA,a,Object(m.a)(this,this.x8i,"onArrowTouchMove"));Pm.a.instance.Ea(vb.a.vx,n,Object(m.a)(this,this.w8i,"onArrowTouchEnd"));Pm.a.instance.Ea(vb.a.vx,a,Object(m.a)(this,this.w8i,"onArrowTouchEnd"))}onFocus(a){super.onFocus(a);Ne.a.uf(this.VK.Nn,"cui-spn-focus");
this.control.enabled&&Ye.a.DRc(this.VK.ft);return this.BOa=!1}onBlur(a){super.onBlur(a);Ne.a.gv(this.VK.Nn,"cui-spn-focus");return!1}onKeyDown(a){let d=!1;if(!ze.c(a.Ua)&&!ze.c(a.Ua.rawEvent)){const n=a.Ua.keyCode,z=a.Ua.rawEvent.shiftKey;if(n===Sys.UI.Key.up||n===Sys.UI.Key.down)this.root.nng(this.control)||this.wFj(n===Sys.UI.Key.up,a.ed),d=!0;else if(n===Sys.UI.Key.enter)this.n_(),Object(Uc.a)(nf.Ribbon,this.root)&&this.root.f7(),d=!0;else if(n===Sys.UI.Key.tab)this.n_(),Object(Uc.a)(nf.Ribbon,
this.root)&&(d=this.root.k5e(this.Sk.Pb,!z));else if(n===Sys.UI.Key.esc)this.TQc(),Object(Uc.a)(nf.Ribbon,this.root)&&this.root.f7(),d=!0;else if(n===Sys.UI.Key.backspace||n===Sys.UI.Key.del)d=!this.control.enabled}return d}GK(){return!this.control.enabled}eC(){this.Y6k();return!1}nna(){this.n_();return!1}BHg(){return this.BOa?!1:this.BOa=!0}u8i(a){var d=!1;let n=!0;2===a.ed&&(n=a.oV===Sys.UI.MouseButton.leftButton);n&&(d=a.Ec,this.wFj(d===this.VK.GDc||d===this.VK.Cji||d===this.VK.Bji,a.ed),d=!0);
return d}v8i(a){return this.mHa(a)}x8i(a){return this.ZMe(a)}w8i(a){return this.mHa(a)}A1l(a){if(this.control.enabled){var d=!1;if(!this.J9d){var n=this.TCl(a);n=a?n+this.oBb.step:n-this.oBb.step;n=Math.min(n,this.oBb.max);n=Math.max(n,this.oBb.min);n!==this.Eae&&(this.bOf(n,this.oBb),this.root.executeCommand(this.properties.Command,this.yd,this.Sk,0,!1),d=!0)}d||(d=this.properties.SpinCommand,n=this.yd,n.Increment=a,ze.c(d)||this.root.executeCommand(d,n,this.Sk,0,!1))}}TCl(a){const d=Math.pow(10,
l.AFrameworkApplication.numberFormat.NJb),n=Math.round(this.oBb.step*d);let z=Math.round(this.Eae*d)/n;z=a?Math.floor(z):Math.ceil(z);return z*n/d}wFj(a,d){if(this.control.enabled){this.n_();const n=a?this.VK.GDc:this.VK.Opd;switch(d){case 2:case 3:this.qvf=a;this.Che(n);break;case 1:this.qvf=a,this.itk(n)}}}WFj(){this.G4h();this.zOk()}lfi(){-1===this.Obe&&(this.Obe=window.setTimeout(Object(m.a)(this,this.M9m,"repeatSpin"),500))}G4h(){this.Obe=Ne.a.l4b(this.Obe)}M9m(){this.G4h();-1===this.Yce&&(this.w_e(),
this.Yce=window.setInterval(Object(m.a)(this,this.w_e,"spin"),50))}zOk(){this.Yce=Ne.a.wOk(this.Yce)}w_e(){this.A1l(this.qvf)}itk(a){this.root.o3(this.control,!1);Ne.a.uf(a,Ri.Control.Ghe);this.w_e();this.lfi()}Y6k(){this.root.z_(this.control,!1);this.WFj();Ne.a.gv(this.VK.GDc,Ri.Control.Ghe);Ne.a.gv(this.VK.Opd,Ri.Control.Ghe)}pSc(a){this.VK.ft.value!==a&&(this.VK.ft.value=a)}TQc(){this.pSc(this.yd[Tg.a.Text])}Awj(a){this.pSc(a);this.yd[Tg.a.Text]=a;this.J9d=!0}Mjn(a,d,n){this.pSc(n);this.yd[Tg.a.Text]=
n;this.yd[Tg.a.Number]=a;this.yd[Tg.a.UnitType]=d.type;this.Eae=a;this.oBb=d;this.VK.ft.setAttribute(pd.a.mke,n);this.VK.ft.setAttribute(pd.a.WFf,String.format("{0}",d.min));this.VK.ft.setAttribute(pd.a.Shd,String.format("{0}",d.max));this.J9d=!1}h9h(a){var d;if(({eAm:d}=this.Hfm(a)).returnValue)this.Awj(d);else{({number:a,xZa:d}=w.a.ULg(a,this.MRh,l.AFrameworkApplication.numberFormat));let n=this.e3e(d);0===d&&ze.c(n)&&(n=this.e3e(this.yd[Tg.a.UnitType]));this.bOf(a,n)}}bOf(a,d){a=this.DEg(a,d);
if(isNaN(a)||ze.c(d))this.TQc();else{const n=l.AFrameworkApplication.numberFormat;let z;z=w.a.xza(a,d.type,n);z=z.replace(6===d.type?n.OJb:n.QOc,"");this.Mjn(a,d,z)}}Hfm(a){let d,n=!1;d="";a=a.trim();const z=this.spinner.xRj;if(!ze.c(z))for(let O=0;O<z.length;O++)if(z[O].toLowerCase()===a.toLowerCase()){d=z[O];n=!0;break}return{returnValue:n,eAm:d}}DEg(a,d){return isNaN(a)||ze.c(d)?Number.NaN:d.DEg(a)}e3e(a){let d=null;const n=this.spinner.Zfh;for(let z=0;z<n.length;z++)if(n[z].type===a){d=n[z];break}return d}kJn(a){const d=
a.length,n=Array(d);for(let z=0;z<d;z++)n[z]=a[z].type;return n}n_(){if(this.control.enabled){const a=this.yd[Tg.a.Text],d=this.VK.ft.value;d!==a&&(this.h9h(d),this.yd[Tg.a.Text]!==a&&this.root.executeCommand(this.properties.Command,this.yd,this.Sk,0,!1))}else this.TQc()}Km(){var a=this.yd[Tg.a.Text],d=this.yd[Tg.a.Number];const n=this.yd[Tg.a.UnitType],z=this.yd[Tg.a.MaxValue];if(0<(this.Vv(this.properties.Command,this.properties.QueryCommand,this.yd)&2)){const O=this.yd[Tg.a.Text],ca=this.yd[Tg.a.Number],
Da=this.yd[Tg.a.UnitType],Xa=this.yd[Tg.a.MaxValue];Xa!==z&&(this.e3e(Da).max=Xa,this.VK.ft.setAttribute(pd.a.Shd,String.format("{0}",Xa)));O!==a?""===O?this.Awj(O):this.h9h(O):isNaN(ca)||ca===d&&Da===n||this.bOf(ca,this.e3e(Da));a=this.VK.Nn.title;d=Ne.a.TDa(this.yd[Tg.a.Alt],this.properties.Alt);d!==a&&(this.VK.ft.title=d,this.VK.GDc.title=d,this.VK.Opd.title=d)}}pAf(a){super.pAf(a);a?(this.w_e(),this.lfi()):this.WFj()}}Object(t.a)(vo,"SpinnerBehavior",cj,[649,645]);var Gn=b(305),Sk=b(1054);class om extends Zc{constructor(a){super(a);
this.Euc=!0;this.VQb=!1}get gda(){return this.control}get Lu(){return this.gda.properties}rN(a){const d=a.Nn,n=a.lEb;a=a.Qpd;re.a.instance.Ea(vb.a.focus,d,Object(m.a)(this,this.onFocus,"onFocus"));re.a.instance.Ea(vb.a.blur,d,Object(m.a)(this,this.onBlur,"onBlur"));gb.KeyInputManager.instance.Ea(vb.a.Nf,d,Object(m.a)(this,this.onKeyDown,"onKeyDown"));gb.KeyInputManager.instance.Ea(vb.a.Of,d,Object(m.a)(this,this.eC,"onKeyUp"));I.a.xm&&16>this.Eyl()&&(bi.a.instance.Ea(vb.a.pointerDown,d,Object(m.a)(this,
this.Yaj,"onSplitbuttonPointerDownPointerUp")),bi.a.instance.Ea(vb.a.UE,d,Object(m.a)(this,this.Yaj,"onSplitbuttonPointerDownPointerUp")));bi.a.instance.Ea(vb.a.pointerOver,n,Object(m.a)(this,this.UCm,"onButtonPointerOver"));bi.a.instance.Ea(vb.a.pointerOut,n,Object(m.a)(this,this.TCm,"onButtonPointerOut"));bi.a.instance.Ea(vb.a.pointerDown,n,Object(m.a)(this,this.K8i,"onButtonPointerDown"));bi.a.instance.Ea(vb.a.UE,n,Object(m.a)(this,this.L8i,"onButtonPointerUp"));Pm.a.instance.Ea(vb.a.hA,n,Object(m.a)(this,
this.WCm,"onButtonTouchMove"));Pm.a.instance.Ea(vb.a.vx,n,Object(m.a)(this,this.VCm,"onButtonTouchEnd"));bi.a.instance.Ea(vb.a.pointerDown,a,Object(m.a)(this,this.ZHg,"onMenuButtonPointerDown"));bi.a.instance.Ea(vb.a.pointerOver,a,Object(m.a)(this,this.fHm,"onMenuButtonPointerOver"));bi.a.instance.Ea(vb.a.pointerOut,a,Object(m.a)(this,this.eHm,"onMenuButtonPointerOut"))}mz(a,d,n){Sys.UI.DomElement.containsCssClass(a,"cui-ctl-a1")?this.VQb&&(this.gda.on=!this.gda.on,a=this.yd,a.CommandValueId=this.control.T8b(),
this.root.executeCommand(this.Lu.Command,a,this.Sk,d,!0,null,this.fma(n))):this.Euc&&super.mz(a,d,n)}eC(a){const d=a.Ua.keyCode;return d===Sys.UI.Key.enter||d===Sys.UI.Key.space?(a=this.yd,a.CommandValueId=this.control.T8b(),this.root.executeCommand(this.Lu.Command,a,this.Sk,1,!0),!0):super.eC(a)}Km(){const a=this.root.rCa(this.Lu.Command,this.Lu.QueryCommand,this.yd),d=0<(a&1);let n=!0;n=ze.c(this.Lu.CommandMenuOpen)?d:0<(this.root.rCa(this.Lu.CommandMenuOpen,null,null)&1);if(n!==this.Euc||d!==this.VQb||
(n||d)!==this.control.enabled)this.control.enabled=n||d,d!==this.VQb&&this.SEm(d),n!==this.Euc&&this.TEm(n),this.Euc=n,this.VQb=d;if(0<(a&2)){this.uua();const z=Ne.a.TDa(this.yd[Sk.a.LabelText],this.Lu.LabelText);this.yd[Sk.a.ApplyLabelTextToControlOnly]?this.gda.LEc(O=>{O.Nn.title=z;O.lEb.removeAttribute("title");O.Qpd.removeAttribute("title")}):this.gda.LEc(O=>{O.lEb.title=z});this.yd[Sk.a.EnsureControlRoleIsButton]&&this.gda.LEc(O=>{pd.a.Qq(O.Nn,pd.a.ig,pd.a.l3)});ze.c(this.yd[Sk.a.Visible])||
this.ODa()&&this.b$a()}this.gda.Ij(this.gda.on&&d)}b$a(){this.Vdh();this.Noc();this.uua()}TEm(a){this.gda.LEc(d=>{Ne.a.VXa(d.Qpd,a)});this.mQd();this.Euc=a}SEm(a){this.gda.LEc(d=>{Ne.a.VXa(d.lEb,a)});this.mQd();this.VQb=a}mQd(){const a=this.gda.yFb();ze.c(a)||(Ne.a.gv(a.childNodes[0],"cui-ctl-split-hovered-primary"),Ne.a.gv(a.childNodes[0],"cui-ctl-split-hovered-secondary"),Ne.a.gv(a.childNodes[1],"cui-ctl-split-hovered-primary"),Ne.a.gv(a.childNodes[1],"cui-ctl-split-hovered-secondary"))}Yaj(a){if(0!==
Gn.a(a.Ua))return!1;let d=!1;a.eventName===vb.a.pointerDown?d=this.K8i(a):a.eventName===vb.a.UE&&(d=this.L8i(a));return d}K8i(a){let d=!1;const n=a.ed;switch(n){case 3:this.Otn()?this.mz(this.Sk.Pb,n,a.Ua):this.Che(this.gda.ohi);d=!0;break;case 2:a.oV===Sys.UI.MouseButton.leftButton&&(this.Che(this.gda.ohi),d=!0)}d&&a.Ua.preventDefault();return!1}Otn(){const a=this.Sk.w_;return"Small"===a||"Medium"===a||"Menu16"===a||"MenuTellMe"===a}L8i(a){return this.mHa(a)}WCm(a){return this.ZMe(a)}VCm(a){return this.mHa(a)}onFocus(a){super.onFocus(a);
this.jhg(!0,!0);return!1}onBlur(a){super.onFocus(a);this.mQd();return!1}UCm(){this.control.enabled&&this.VQb&&this.jhg(!0,this.gda.on);return!1}TCm(){this.control.enabled&&this.VQb&&this.mQd();return!1}ZHg(a){let d=!1;if(2!==a.ed||a.oV===Sys.UI.MouseButton.leftButton)this.mz(a.Ec,a.ed,a.Ua),d=!0;d&&a.Ua.preventDefault();return!1}fHm(){this.control.enabled&&this.Euc&&this.jhg(this.gda.on,!0);return!1}eHm(){this.mQd();return!1}jhg(a,d){const n=this.control.yFb();ze.c(n)||(Ne.a.uf(n.childNodes[0],a?
"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),Ne.a.uf(n.childNodes[1],d?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}Eyl(){var a=I.a.gEb;return a&&(a=a.split("."),2===a.length)?parseInt(a[0]):0}}Object(t.a)(om,"SplitButtonBehavior",Zc,[]);var Hn=b(1205);class no extends cj{constructor(a){super(a);this.eVb=this.BOa=!1;this.F8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("ExcelTableRenameEnabled")}get textBox(){return this.control}get Doa(){return this.textBox.Doa}get k$g(){return this.textBox.Hh}rN(a){a=
a.ft;re.a.instance.Ea(vb.a.focus,a,Object(m.a)(this,this.onFocus,"onFocus"));re.a.instance.Ea(vb.a.blur,a,Object(m.a)(this,this.onBlur,"onBlur"));gb.KeyInputManager.instance.Ea(vb.a.Nf,a,Object(m.a)(this,this.onKeyDown,"onKeyDown"));gb.KeyInputManager.instance.Ea(vb.a.Bn,a,Object(m.a)(this,this.GK,"onKeyPress"));gb.KeyInputManager.instance.Ea(vb.a.Of,a,Object(m.a)(this,this.eC,"onKeyUp"));re.a.instance.Ea(vb.a.change,a,Object(m.a)(this,this.nna,"onChange"));Eg.a.instance.Ea(vb.a.QS,a,Object(m.a)(this,
this.n7a,"onMouseUp"))}onFocus(a){super.onFocus(a);this.eVb=!0;Ne.a.uf(this.Doa.Nn,"cui-tb-focus");this.control.enabled&&Ye.a.DRc(this.Doa.ft);return this.BOa=!1}onBlur(a){this.eVb=!1;super.onBlur(a);Ne.a.gv(this.Doa.Nn,"cui-tb-focus");return!1}onKeyDown(a){let d=super.onKeyDown(a);if(!ze.c(a.Ua)&&!ze.c(a.Ua.rawEvent)){const n=a.Ua.keyCode,z=a.Ua.rawEvent.shiftKey;n===Sys.UI.Key.tab?(this.n_(),Object(Uc.a)(nf.Ribbon,this.root)&&(d=this.root.k5e(this.Sk.Pb,!z))):n===Sys.UI.Key.enter?this.F8j&&(this.n_(),
Object(Uc.a)(nf.Ribbon,this.root)&&this.root.f7(),d=!0):n===Sys.UI.Key.esc?(this.TQc(),Object(Uc.a)(nf.Ribbon,this.root)&&this.root.f7(),d=!0):n===Sys.UI.Key.backspace||n===Sys.UI.Key.del?d=!this.control.enabled:a.l_&&(Qc.a.BKf(a.Ua),d=!1)}return d}GK(){return!this.control.enabled}eC(){return!1}nna(){this.n_();return!1}n7a(){return this.Doa.isEditable?this.BOa?!1:this.BOa=!0:(Ye.a.DRc(this.Doa.ft),!0)}pSc(a){this.Doa.ft.value!==a&&(this.Doa.ft.value=a)}TQc(){this.pSc(this.yd[Hn.a.Text])}n_(){if(this.control.enabled&&
this.Doa.isEditable){const a=this.Doa.ft.value;a!==this.yd[Hn.a.Text]&&(this.yd[Hn.a.Text]=a,this.root.executeCommand(this.k$g.Command,this.yd,this.Sk,0,!1))}else this.TQc()}Km(){const a=this.yd[Hn.a.Text];if(0<(this.Vv(this.k$g.Command,this.k$g.QueryCommand,this.yd)&2)&&!this.eVb){const d=this.yd[Hn.a.Text];d!==a&&this.pSc(d)}}}Object(t.a)(no,"TextBoxBehavior",cj,[644,645]);var $p=b(1330);class Qm extends cj{constructor(a){super(a)}get toggleButton(){return this.control}get properties(){return this.control.Hh}mz(a,
d,n){this.control.enabled&&(Ne.a.osa(this.properties.TogglesWhenExecuted)||this.toggle(),this.yd.CommandValueId=this.toggleButton.T8b(),this.yd.MenuItemId=this.toggleButton.Hh.MenuItemId,this.yd.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.yd,this.Sk,d,!Ne.a.osa(this.properties.CloseMenuWhenExecuted),z=>{Ne.a.Jt(this.properties.UpdateHtmlPostToggle)&&(32===z?this.zJj():this.xJj())},this.fma(n)))}xJj(){this.yd[Yf.a.On]=!this.yd[Yf.a.On]}zJj(){this.toggleButton.Ij(this.yd[Yf.a.On]);
(this.toggleButton.FLa&&this.toggleButton.e4e||Ne.a.Jt(this.properties.UpdateHtmlPostToggle))&&this.b$a()}toggle(){this.xJj();Ne.a.Jt(this.properties.UpdateHtmlPostToggle)||this.zJj()}onKeyDown(a){const d=super.onKeyDown(a);if(!d&&!ze.c(a.Ua)&&this.nM){const n=a.Ua.keyCode;n!==Sys.UI.Key.enter&&n!==Sys.UI.Key.space||a.Ua.preventDefault()}return d}Km(){ze.c(this.properties.MenuItemId)||(this.yd.MenuItemId=this.properties.MenuItemId);0<(this.Vv(this.properties.Command,this.properties.QueryCommand,this.yd)&
2)&&this.ODa()&&this.b$a()}b$a(){this.toggleButton.Ij(this.yd[Yf.a.On]);this.QLn(Ne.a.TDa(this.yd[Yf.a.DisplayMode],""));this.Vdh();this.uua();this.hNn();Yf.a.Alt in this.yd&&this.Noc()}hNn(){const a=this.tI.wLc;if(a&&a.mEb){var d=Ne.a.TDa(this.yd[Yf.a.Description],this.properties.Description);d!==a.mEb.innerText&&(a.mEb.innerText=d,a.OU&&!Object(Uc.a)($p.Jewel,this.root)&&(d=!ze.b(d),Ne.a.A5(a.OU,"UIFontBold",d),Ne.a.A5(a.OU,"cui-ctl-mediumlabel-nodescription",!d)))}}rN(a){a=a.Nn;re.a.instance.Ea(vb.a.focus,
a,Object(m.a)(this,this.onFocus,"onFocus"));re.a.instance.Ea(vb.a.blur,a,Object(m.a)(this,this.onBlur,"onBlur"));bi.a.instance.Ea(vb.a.pointerOver,a,Object(m.a)(this,this.R4,"onPointerOver"));bi.a.instance.Ea(vb.a.pointerOut,a,Object(m.a)(this,this.sV,"onPointerOut"));gb.KeyInputManager.instance.Ea(vb.a.Nf,a,Object(m.a)(this,this.onKeyDown,"onKeyDown"));gb.KeyInputManager.instance.Ea(vb.a.Of,a,Object(m.a)(this,this.eC,"onKeyUp"));bi.a.instance.Ea(vb.a.pointerDown,a,Object(m.a)(this,this.ZF,"onPointerDown"));
bi.a.instance.Ea(vb.a.UE,a,Object(m.a)(this,this.kta,"onPointerUp"));Ae.a.instance.Ea(vb.a.click,a,Object(m.a)(this,this.onClick,"onClick"));Pm.a.instance.Ea(vb.a.hA,a,Object(m.a)(this,this.MWa,"onTouchMove"));Pm.a.instance.Ea(vb.a.vx,a,Object(m.a)(this,this.yna,"onTouchEnd"))}}Object(t.a)(Qm,"ToggleButtonBehavior",cj,[]);class gl{constructor(a){this.F5j=a;this.zef={["Button"]:d=>new fo(d),["FileMenuButton"]:d=>new fo(d),["ColorPicker"]:d=>new vl(d),["ComboBox"]:d=>new Zf(d),["ContextMenuControl"]:d=>
new ig(d),["ContextMenuLauncher"]:d=>new ig(d),["DialogMenuLauncher"]:d=>new Qj(d),["DropDown"]:d=>new Id(d),["FlyoutAnchor"]:d=>new ah(d),["GalleryButton"]:d=>new Oi(d),["StatefulColorFlyoutAnchor"]:d=>new ah(d),["JewelMenuLauncher"]:d=>new fl(d),["Label"]:d=>new Zp(d),["Placeholder"]:d=>new cj(d),["SearchBox"]:d=>new gm(d),["Separator"]:d=>new cj(d),["SplitButton"]:d=>new om(d),["StatefulColorSplitButton"]:d=>new om(d),["StatefulImageSplitButton"]:d=>new om(d),["TextBox"]:d=>new no(d),["ToggleButton"]:d=>
new Qm(d)}}aki(){this.zef[Ri.Control.ZNi]=a=>new Jd(a)}rZf(){this.zef[Ri.Control.rEj]=a=>new vo(a)}Psl(a){const d=this.zef[a.controlType];(a=d?d(a):null)&&this.F5j&&a.Ael();return a}static get instance(){return gl.na||(gl.na=new gl(!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("CUICommitChangeFixIsEnabled")))}}gl.na=null;Object(t.a)(gl,"ControlBehaviorFactory",null,[630]);var ph=b(1420),Mr=b(1297);class Ti extends Om.MenuLauncher{constructor(a,d,n,z){super(a,d,n,z);this.UDh=null;this.AQa=
this.afd=0;this.XI=null;this.A6c=this.z6c=0;this.ih("Menu");this.enabled=!0}get x(){return this.afd}get y(){return this.AQa}get Wug(){return this.z6c}get Xug(){return this.A6c}get controlType(){return"DialogMenuLauncher"}ytb(){}Cvb(){}B6f(){const a={};a.MenuId=this.id;a.DialogMoveCommand=this.Lu.DialogMoveCommand;a.DialogCloseCommand=this.Lu.DialogCloseCommand;return a}yjm(a,d){this.afd=a.x;this.AQa=a.y;this.z6c=a.height;this.A6c=a.width;this.z4(d)}tX(a){this.UDh=Ne.a.createElement("span");return new Mr.a(a,
this.UDh)}get Lu(){return this.Hh}UGa(a,d,n){return new Ti(a,this.id,d,n)}}Object(t.a)(Ti,"DialogMenuLauncher",Om.MenuLauncher,[]);var pi=b(1421);class wo extends ph.a{constructor(a,d){super(a,d);this.Qwb=null}get sAf(){return this.Qwb}get wgi(){return this.properties}get xha(){return 20}Cn(){super.Cn();ze.c(this.Pb)&&this.MF();this.Pb=Ne.a.q8a(this.Pb);this.k3(this.Pb);this.M3=!1}RU(a){if(!Object(Uc.a)(pi.a,a))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");
}kpe(a,d,n,z){n=new sa.Menu(this,d,n,z,null);a||(a={});a.CommandMenuOpen=this.wgi.CommandMenuOpen;a.CommandMenuClose=this.wgi.CommandMenuClose;a=new Ti(this,d,a,n);this.b6b[d]=a;d=new pi.a(this,"dock"+d);d.Re(a.uX("Menu"));this.Re(d);this.refresh()}sZe(a,d,n,z){const O=this.b6b[a];if(ze.c(O))throw Error.create('The dialog menu "'+a+'" does not exist');O.yjm(new Sys.UI.Bounds(d,n,0,0),z);this.Qwb=O.menu}hne(a){a=this.b6b[a];ze.c(a)||(a.PGa(),this.Qwb=null)}mOe(){this.Qwb=null}dispose(){const a=this.b6b;
for(let d in a)a[d].dispose();super.dispose()}}Object(t.a)(wo,"DialogMenuRoot",ph.a,[]);class rq{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=
this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(t.a)(rq,"RootProperties",null,[]);class ho extends rq{constructor(){super()}}Object(t.a)(ho,"StandaloneRootProperties",rq,[]);class In extends ho{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(t.a)(In,"DialogMenuRootProperties",ho,[]);class Og{constructor(){const a=new In;a.ImageSideArrow=l.AFrameworkApplication.ln;a.ImageSideArrowClass=Vf.getImageClass("SubmenuFlyoutArrow_13x13x32");
a.TextDirection=l.AFrameworkApplication.isRtl?"rtl":"ltr";this.pc=new wo("DialogMenuRootId",a);this.pc.XI=this;this.pc.refresh();l.AFrameworkApplication.pa.Aa(Sa.a.kRe,Cd.a.frame,Object(m.a)(this,this.kRe,"populateDialogMenu"),96)}get U8(){return this.pc}V3a(a,d,n,z,O=null){a=parseInt(a);z=l.AFrameworkApplication.pa;n&&(z.gz=n.CommandLocation,z.cQ=n.InvocationMethod);d=z.ob(a,2,d,O);this.pc.refresh();return 32===d}yVa(a){return a?32===l.AFrameworkApplication.pa.processAction(parseInt(a),1):!0}Vv(){this.U8.root.Km()}kpe(a,
d,n){const z={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};z.DialogMoveCommand=d;z.DialogCloseCommand=n;this.U8.kpe(z,a,"","")}sZe(a,d,n,z){this.U8.sZe(a,d,n,z)}hne(a){this.U8.hne(a)}kRe(a,d,n,z,O){if(1===n)return 32;a=new Sys.StringBuilder;a.append('<Menu Id="dialogMenu">');a.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');a.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',
O.DialogMoveCommand,CommonUIStrings.l_DialogMove));a.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',O.DialogCloseCommand,CommonUIStrings.l_DialogClose));a.append("</Controls></MenuSection>");a.append("</Menu>");O.PopulationXML=a.toString();return 32}dispose(){this.pc&&(this.pc.dispose(),this.pc=null)}}Object(t.a)(Og,"DialogMenuRootUser",null,[223,12,583]);class xr{constructor(a,d,n){this.TRb=this.Zee=this.X7c=this.vl=null;this.Yhf=this.see=!1;this.Y1c=a;
this.Cc=d;this.Pt=n;this.Otc=l.AFrameworkApplication.isRtl}get pDe(){return this.Yhf}nli(a){a?(this.vl=a,this.Yhf=!0,this.see=!1,this.Cc.capture(Object(m.a)(this,this.Dim,"keyEventHandler"),null),this.Pt.Ea(vb.a.pointerDown,this.Y1c,Object(m.a)(this,this.N7a,"pointerDownHandler")),this.X7c||this.s2k(),this.vl.appendChild(this.X7c),this.f3l()):k.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}vte(){this.Yhf=!1;this.Zee=this.TRb=null;this.R6m();this.MTg();this.vl=null}MTg(){this.Cc.releaseCapture();
this.Pt.kb(vb.a.pointerDown,this.Y1c,Object(m.a)(this,this.N7a,"pointerDownHandler"))}f3l(){if(this.vl.style.left.endsWith("px")&&this.vl.style.right.endsWith("px"))this.TRb=new Sys.UI.Point(Qk.a.P0(this.Otc?this.vl.style.right:this.vl.style.left),Qk.a.P0(this.vl.style.top));else{const a=this.Otc?this.Y1c.offsetWidth-(this.vl.offsetLeft+this.vl.offsetWidth+Qk.a.P0(this.vl.style.marginRight)):this.vl.offsetLeft-Qk.a.P0(this.vl.style.marginLeft),d=this.vl.offsetTop-Qk.a.P0(this.vl.style.marginTop);
this.Xyj(a,d);this.TRb=new Sys.UI.Point(a,d)}this.Zee=this.TRb}s2k(){this.X7c=Vf.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}R6m(){this.X7c.parentNode===this.vl&&this.vl.removeChild(this.X7c)}Dim(a){if(!this.pDe)return!1;a.Ua.preventDefault();if(a.eventName===vb.a.Nf){const d=a.Ua.ctrlKey?1:10;let n;switch(a.Ua.keyCode){case xb.a.H5:this.IMc(0,-1*d);break;case xb.a.Fda:this.IMc(0,1*d);break;case xb.a.Xvb:n=this.Otc?1:-1;this.IMc(n*d,0);break;case xb.a.Zvb:n=this.Otc?
-1:1;this.IMc(n*d,0);break;case xb.a.Cua:this.j5i(this.Zee.x,this.Zee.y);this.see=!0;break;case xb.a.Ms:this.see=!0}}a.eventName===vb.a.Of&&this.see&&this.vte();return!0}N7a(a){if(!this.pDe)return!1;a.Ua.preventDefault();this.vte();return!0}IMc(a,d){this.j5i(this.TRb.x+a,this.TRb.y+d)}j5i(a,d){a=this.DAk(a,d);this.Xyj(a.x,a.y);this.TRb=a}Xyj(a,d){this.Otc?this.vl.style.right=a+"px":this.vl.style.left=a+"px";this.vl.style.top=d+"px"}DAk(a,d){const n=this.Otc?Qk.a.P0(this.vl.style.marginRight):Qk.a.P0(this.vl.style.marginLeft),
z=Qk.a.P0(this.vl.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-n,a),this.Y1c.offsetWidth-this.vl.offsetWidth-n),Math.min(Math.max(-z,d),this.Y1c.offsetHeight-this.vl.offsetHeight-z))}}Object(t.a)(xr,"KeyMoveAdapter",null,[584]);var fr=b(1488),Nr=b(1363);class ms{get name(){return"CUI.Behavior"}Hb(a){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("AccessibleMovingDialogsEnabled")&&(a.register(583,"Common.UI.IDialogMenuRootUser").singleInstance().zd(()=>new Og),a.register(584,
"Common.IKeyMoveAdapter").singleInstance().zd(()=>new xr(l.AFrameworkApplication.la.Q_(),gb.KeyInputManager.instance,bi.a.instance)));a.register(Nr.a,"CommandUI.RootManager").as("Common.IRootManager").singleInstance().zd(()=>Nr.a.instance)}init(){fr.a.BPf=gl.instance;const a=Nr.a.instance.psj;for(let d=0;d<a.length;++d){const n=Object(qa.a)(585,a[d]);n&&n.R3a()}Bi.a.get_instance().dG(6)}dispose(){}static main(){M.a.instance.Sb(new ms,5)}}Object(t.a)(ms,"CuiBehaviorPackage",null,[1,2]);class Nq{constructor(a){const d=
new ho;d.ImageUpArrow=d.ImageDownArrow=d.ImageSideArrow=d.ImageCheckMark=d.ImageUncheckMark=d.ImageDownArrow8by8=d.ImageUpArrow8by8=a;d.ImageUpArrowClass=Vf.getImageClass("RibbonUpArrow_5x3x32");d.ImageDownArrowClass=Vf.getImageClass("SplitButtonArrow_5x3x32");d.ImageUpArrow8by8Class=Vf.getImageClass("RibbonUpArrow_8x8x32");d.ImageDownArrow8by8Class=Vf.getImageClass("SplitButtonArrow_8x8x32");d.ImageSideArrowClass=Vf.getImageClass("SubmenuFlyoutArrow_13x13x32");d.ImageCheckMarkClass=Vf.getImageClass("CheckboxChecked_16x16x32");
d.ImageUncheckMarkClass=Vf.getImageClass("CheckboxUnchecked_16x16x32");d.TextDirection=l.AFrameworkApplication.isRtl?"rtl":"ltr";this.$y=ph.a.y4k(d);this.$y.refresh()}get e1(){return this.$y}dispose(){this.$y.dispose()}}Object(t.a)(Nq,"StandaloneRootController",null,[834,12]);var zp=b(1575),Uh=b(230);class pm{constructor(a){this.yad=a}create(a,d){const n=new Sys.StringBuilder;this.eCc(n,a,d);this.yRf(n,a);return n.toString()}T5b(a,d){const n=[];this.pSf(n,a,d);this.zRf(n,a);return n}eCc(a,d,n){switch(d.errorType){case 0:a.append(this.yad.build());
break;case 1:case 2:a.append(this.PIf(d,n))}}pSf(a,d,n){switch(d.errorType){case 0:a.push(this.yad.v2h());break;case 1:case 2:a.push(this.QIk(d,n))}}yRf(a,d){a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');a.append(Uh.a("btnIgrnoreSpellingError",(2===d.errorType?Mb.a.ALa:Mb.a.nAa).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null));a.append("</Controls></MenuSection>")}zRf(a,d){const n=Object.assign(new fi.a,{ControlList:[]});d=2===d.errorType?"UnknownSpellingError":
"IgnoreSpellingError";Array.add(n.ControlList,Object.assign(new Xg.a,{ExternalId:d}));a.push(n)}PIf(a,d){a=this.Zpl(a.suggestions,d);return 0<a.length?Uh.j("msUnknownWord",Uh.e(null,a),"Menu16"):Uh.j("msUnknownWord",Uh.e(null,[Uh.a("btnNoSuggestions",Mb.a.ALa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}Zpl(a,d){const n=[];if(a){const z=Math.min(d.length,a.length);for(let O=0;O<z;++O)a[O]&&n.push(Uh.a("btnCorrectWord"+O,d[O].toString(),a[O]))}return n}QIk(a,d){const n=Object.assign(new fi.a,
{Id:"Suggestions",ControlList:[]});this.Ypl(a.suggestions,d,n.ControlList);0>=n.ControlList.length&&(a=Object.assign(new Xg.a,{ExternalId:"NoSuggestions"}),n.ControlList.push(a));return n}Ypl(a,d,n){if(a){const z=Math.min(d.length,a.length);for(let O=0;O<z;++O){if(!a[O])continue;const ca=Object.assign(new Xg.a,{ExternalId:"btnCorrectWord"+O,Command:d[O].toString(),LabelText:a[O]});n.push(ca)}}}}Object(t.a)(pm,"DefaultProofingContextMenuCreator",null,[]);var Mi=b(643);class oo{constructor(a,d){this.gth=
a;this.Luh=d;this.hxa=[Mb.a.Mub,Mb.a.Nub,Mb.a.Oub,Mb.a.HOb,Mb.a.IOb]}create(a,d){return d?Object(Uc.a)(Mi.a,d)?this.Luh.create(a,d,this.hxa):this.gth.create(d,this.hxa):""}$Bc(a,d){return d?Object(Uc.a)(Mi.a,d)?this.Luh.T5b(a,d,this.hxa):this.gth.T5b(d,this.hxa):null}}Object(t.a)(oo,"ProofingContextMenuSectionFactory",null,[593]);class Am{build(){const a=[Uh.a("btnDeleteRepeatedWord",Mb.a.nHa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return Uh.j("msRepeatedWord",Uh.e(null,a),"Menu16")}v2h(){const a=
Object.assign(new fi.a,{ControlList:[]}),d=Object.assign(new Xg.a,{ExternalId:"DeleteRepeatedWord"});a.ControlList.push(d);return a}}Object(t.a)(Am,"ProofingRepeatedWordSectionBuilder",null,[592]);var yg=b(576);class nl{static get Lf(){return xg.a.oz(nl.fm,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,
Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}nl.fm="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(t.a)(nl,"AutoCorrectOptionsDialogHTML",null,[]);class Jo{static get Lf(){return xg.a.oz(Jo.fm,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}Jo.fm="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(t.a)(Jo,"AutoCorrectOptionsDialogHTML2",null,[]);class Ip extends xg.a{constructor(a,d){super();this.C1=a;this.Mpa=d;this.Je="AutoCorrectOptionsDialog"}J5g(){k.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.Lf=this.Mpa?Jo.Lf:nl.Lf;const a={};a.ReplaceTextAsYouType=this.C1.t8a;a.CapitalizeFirstLetterOfSentences=this.C1.Tle;a.ReplaceOrdianalsWithSuperscript=this.C1.RUe;a.ReplaceHyphensWithDash=this.C1.ZQd;a.ReplaceFractionsWithFractionCharacter=this.C1.QUe;this.Mpa&&
(a.ReplaceQuoteWithSmartQuote=this.C1.HVg);this.Ih(Box4Intl.Box4Strings.l_AutoCorrectOptions,Object(m.a)(this,this.Min,"setAutoCorrectOptionsHandler"),a)}Min(a,d){uf.a.instance.J(9)&&(1!==a?k.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):d.ReplaceTextAsYouType!==this.C1.t8a||d.CapitalizeFirstLetterOfSentences!==this.C1.Tle||d.ReplaceOrdianalsWithSuperscript!==this.C1.RUe||d.ReplaceHyphensWithDash!==this.C1.ZQd||d.ReplaceFractionsWithFractionCharacter!==
this.C1.QUe||this.Mpa&&d.ReplaceQuoteWithSmartQuote!==this.C1.HVg?(a={},a.ReplaceTextAsYouType=d.ReplaceTextAsYouType,a.CapitalizeFirstLetterOfSentences=d.CapitalizeFirstLetterOfSentences,a.ReplaceOrdianalsWithSuperscript=d.ReplaceOrdianalsWithSuperscript,a.ReplaceHyphensWithDash=d.ReplaceHyphensWithDash,a.ReplaceFractionsWithFractionCharacter=d.ReplaceFractionsWithFractionCharacter,this.Mpa&&(a.ReplaceQuoteWithSmartQuote=d.ReplaceQuoteWithSmartQuote),this.C1.nen(a),k.ULS.sendTraceTag(24523524,324,
50,"User close the option dialog and trigger to save the setting: {0}"+{["ReplaceTextAsYouType"]:d.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:d.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:d.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:d.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:d.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.Mpa,["ReplaceQuoteWithSmartQuote"]:this.Mpa&&d.ReplaceQuoteWithSmartQuote}),
Lb.App.oa.updateCommandUI(!0)):k.ULS.sendTraceTag(24523523,324,50,"User close the option dialog or cancle it without do any changes."))}}Object(t.a)(Ip,"AutoCorrectOptionsDialog",xg.a,[591]);class Xo{static get Lf(){return xg.a.oz(Xo.fm,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}Xo.fm="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(t.a)(Xo,"AltTextDialogWithDescriptionHtml",null,[]);class Xm extends xg.a{constructor(){super();this.Lf=Xo.Lf;this.Je="BaseAltTextDialogWithDescription"}yQf(a){const d={};d[Xm.XDf]=this.f5f(a);d[Xm.WDf]=this.Oxl(a)||"";this.Ih(CommonUIStrings.l_AlternativeTextDialogTitle,Object(m.a)(this,this.DBk,"altTextDialogHandler"),d);a=document.getElementById(Xm.XDf);a.focus();a.select()}YR(a){return a.Ec.id===Xm.WDf?!1:super.YR(a)}}Xm.XDf="titleText";Xm.WDf="descriptionText";Object(t.a)(Xm,"BaseAltTextDialogWithDescription",
xg.a,[]);var If=b(33);class sq extends Xm{constructor(a,d,n,z,O){super();this.cBb=this.s4d=null;this.Rk=d;this.yk=n;this.Nb=z;this.Eb=O;this.yQf(a)}Oxl(a){this.s4d=a.node;this.cBb=If.TableReader.Dcg(a);return If.TableReader.Rze(this.cBb)}f5f(a){this.s4d=a.node;this.cBb=If.TableReader.Dcg(a);return If.TableReader.Sze(this.cBb)}DBk(a,d){if(1===a){a=If.TableReader.Sze(this.cBb);const n=If.TableReader.Rze(this.cBb),z=d[Xm.XDf];d=d[Xm.WDf];this.hide();const O=this.Nb.Wb(15);try{O.Sa(this.s4d),this.Rk.hYe(this.cBb,
z),this.Rk.azj(this.cBb,d)}finally{O&&O.dispose()}z===a&&d===n||this.Eb.Ws(16)}uf.a.instance.J(4)&&this.yk.eq&&this.yk.Mp.MJ(this.s4d)}}Object(t.a)(sq,"TableAltTextDialog",Xm,[]);class Jp{constructor(a,d,n){this.Rk=a;this.Nb=d;this.Eb=n}create(a){return new sq(a,this.Rk,Lb.App.lc,this.Nb,this.Eb)}}Object(t.a)(Jp,"TableAltTextDialogFactory",null,[]);const Rm=()=>{Lb.App.UDf=!0;return 32},po=(a,d,n,z,O)=>{if(1===n)return 32;if(!({point:a,UF:d}=Oq(O)).returnValue)return 16;Lb.App.oa.i9a(a,d);return 32},
Ws=(a,d,n,z,O)=>{if(1===n)return 32;if(!({point:a,UF:d}=Oq(O)).returnValue)return 16;Lb.App.oa.mB(a,d);return 32},Oq=a=>{let d=null,n=0;if(!a)return{returnValue:!1,point:d,UF:n};a=a.split(",");if(3>a.length)return{returnValue:!1,point:d,UF:n};d=new Sys.UI.Point(parseInt(a[0]),parseInt(a[1]));n=parseInt(a[2]);return{returnValue:!0,point:d,UF:n}};var gn=b(1639);class gr extends Sys.EventArgs{constructor(a,d,n,z,O){super();this.controlId=a;this.commandId=z;this.time=O}}Object(t.a)(gr,"CommandClickEventArgs",
Sys.EventArgs,[]);class Pn{constructor(a,d){this.jFa=a.t7f();this.VZc=a;this.Nwb=d}V3a(a,d,n,z=null,O=null){n&&(this.Nwb.gz=n.CommandLocation,this.Nwb.cQ=n.InvocationMethod,this.Nwb.ola=n.CommandTabName);a=parseInt(a);let ca=this.VZc.Twi(a,d,n);ca.tDg&&(ca=this.VZc.Twi(ca.yR,d,n));if(void 0!==ca.Ojb&&null!==ca.Ojb)return ca.Ojb;if(ca.T$b)O=32;else{var Da=null;this.jFa&&this.jFa.wNg&&(Da=this.jFa.wNg(ca,O));ca.Csa||ca.hEd?ca.zHa?O=16:(O=this.Nwb.ob(ca.yR,ca.LKc?2:1,ca.$c,O),2===O&&(O=32)):ca.zHa?O=
this.Nwb.Nna(null,ca.yR,2,ca.$c,Xa=>{z&&z(Xa.response)},null,O):(O=this.Nwb.ob(ca.yR,2,ca.$c,O),z&&z(O));this.jFa&&this.jFa.rNg&&this.jFa.rNg(ca,O,Da);if(d&&n&&-1!==n.InvocationMethod&&n.InvocationMethod){n=d.LegacyId;if(void 0===n||null===n)n="";Da=d.ParentMenuId;void 0!==Da&&null!==Da||!d.MenuId||(Da=d.MenuId);let Xa=d.SqmControlId;void 0!==Xa&&null!==Xa||!d.SourceControlId||(Xa=d.SourceControlId);(void 0!==Xa&&null!==Xa||void 0!==Da&&null!==Da)&&gn.a.sYm(new gr(Xa,n,Da,Bc.ActionManager.haa(a),
Date.now()))}}ca.Csa&&32===O&&this.jFa&&this.jFa.eRa&&this.jFa.eRa(ca,d);ca.hEd&&32===O&&this.jFa&&this.jFa.shb&&this.jFa.shb(ca,d);return 32===O||1===O}yVa(a,d=null){if(l.AFrameworkApplication.mi||th.a.instance.fp)return!1;null!=d&&null!=d.UILocation&&(this.Nwb.gz=d.UILocation);const n=parseInt(a);if(!a||n===Bc.ActionManager.vse)return!0;a=this.VZc.Kwi(n,d);a.tDg&&(a=this.VZc.Kwi(a.yR,d));if(void 0!==a.Ojb&&null!==a.Ojb)return a.Ojb;n===Sa.a.s2b&&d&&(a.$c=d);return 32===this.Nwb.ob(a.yR,1,a.$c)}clearCache(){this.VZc.clearCache()}}
Object(t.a)(Pn,"GeneralCuiUser",null,[222,223]);var Hm=b(178),sj=b(74),Gh=b(43),ol=b(704);class Zl{constructor(a,d,n,z){this.nI=null;this.iuh="DocumentProofingFailed";this.Ywf=a;this.Zpa=d;this.IQb=n;this.$M=z}get kZ(){return this.nI||(this.nI=la.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}FNl(a){a=this.$M.iLl(this.Ywf);return{returnValue:this.$M.Plb(this.Ywf),kWm:a}}gNn(a,d){const n=sj.a.qz();if(n){var z=new Hm.ScriptSharpLegacyMap;z.add(Vd.a.Sv,a);z.add(Qb.a.gO,d);a=new Ff.GraphTransaction(15);
a.Sa(n);this.kZ.HMc(Gh.StyleReader.wordStyleIdNormal,z,n)?this.bFd&&ol.a.jZd():(k.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),ol.a.recordQosError(this.iuh,[ol.a.Kvc],"Style could not be modified"));a.dispose()}else k.ULS.sendTraceTag(555775182,375,10,"PageContentNode not found"),ol.a.recordQosError(this.iuh,[ol.a.Kvc],"PageContentNode not found")}get bFd(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateDocumentProofingBehavior",
!1)}akn(a,d){this.gNn(a,d)}don(a,d){if(this.Zpa){var n=new dh.DictionaryPropertySet;this.IQb.execute(z=>{z.lqd(a)});n.setValue(Vd.a.Sv,a);n.setValue(Qb.a.gO,d);d=new Ff.GraphTransaction(15);d.set(Lb.App.jj.Cm);this.Zpa.Zca(n);d.dispose()}}Cd(){return Qd.SelectionEditor.Cd(this.Ywf)}}Object(t.a)(Zl,"LanguageEditor",null,[586]);var hl=b(577),hn=b(214),sg=b(85);class Yo{constructor(a=!1,d=0){this.languages=Yo.dEi(Ih.a.Qvi(1));this.u$d=new hn.a;this.i8a=[];this.Tvc=new hl.a;this.$jj=a;this.UKh=0>=d?7:
d;this.TKh=this.gsf=0;this.qyh=!1;a&&(this.Z3l(),l.AFrameworkApplication.QH(()=>{this.pqm()}))}Z3l(){for(var a of this.languages)this.u$d.$(a.LCID,a);a=[];try{const z=Fa.a.get("RecentlyUsedLcids");if(z&&""!==z){const O=decodeURIComponent(z).split(",").slice(0,this.UKh);for(const ca of O){let Da;({value:Da}=this.u$d.Ab(parseInt(ca),Da)).returnValue&&a.push(Da)}}}catch(z){k.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",z.message),
Array.clear(a)}if(a.length)for(var d of a){var n=d.LCID;this.Tvc.contains(n)||(this.i8a.push(d),this.Tvc.add(n))}else d=l.AFrameworkApplication.lcid,({value:n}=this.u$d.Ab(d,n)).returnValue&&(this.i8a.push(n),this.Tvc.add(d));this.mtj()}mtj(){const a=sg.toArray(sg.select(sg.asEnumerable(this.i8a),d=>d.LCID)).join(",");Fa.a.UKa("RecentlyUsedLcids",a,180)}UDl(a,d,n){let z=-1,O=null;d=Yo.dEi(this.i8a);this.$jj&&0<d.length&&(O=sg.toArray(sg.Si(sg.asEnumerable(d),(Xa,zb)=>{a===Xa.LCID&&-1===z&&(z=zb);
return{["key"]:zb,["text"]:Xa.displayName,["value"]:Xa.LCID.toString()}})));let ca=0;O&&(ca=O.length);n=ca;const Da=sg.toArray(sg.Si(sg.asEnumerable(this.languages),(Xa,zb)=>{a===Xa.LCID&&-1===z&&(z=ca+zb);return{["key"]:ca+zb,["text"]:Xa.displayName,["value"]:Xa.LCID.toString()}}));d=z;return 0<ca?{returnValue:O.concat.apply(O,Da),selectedIndex:d,r5:n}:{returnValue:Da,selectedIndex:d,r5:n}}Kln(a,d){if(this.$jj&&({value:n}=this.u$d.Ab(a,n)).returnValue){d=a!==d;if(this.Tvc.contains(a))a=Array.indexOf(this.i8a,
n),0<=a&&(Array.removeAt(this.i8a,a),this.i8a.push(n)),d&&this.gsf++;else{this.Tvc.add(a);this.i8a.push(n);if(this.i8a.length>this.UKh){var n=this.i8a.shift();this.Tvc.remove(n.LCID)}d&&this.TKh++}this.mtj()}}pqm(){const a=this.gsf+this.TKh;!this.qyh&&0<a&&(k.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.gsf/a),this.qyh=!0)}static dEi(a){a=Array.clone(a);a.sort((d,n)=>d.displayName.localeCompare(n.displayName));return a}}Object(t.a)(Yo,"LanguageListHelper",null,
[581]);var io=b(184);class Ap extends io.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(t.a)(Ap,"NumberButtonProps",io.a,[]);var bl=b(219);class $l{static get fda(){return $l.RAb||($l.RAb=la.a.instance.sa("Box4.ISpacingCommands"))}static get jg(){return bl.ContextSetEditor.instance}static get w0(){return $l.DC||($l.DC=la.a.instance.sa("Box4.ILineSpacingHelper"))}static get lBj(){return!!$l.fda}static lb(){const a=l.AFrameworkApplication.pa;a.ma(Mb.a.Ghc,Kb.a.view,
$l.Ghc);a.$b(Mb.a.Ghc,1124);a.ma(Mb.a.Ghc,Kb.a.paragraph,$l.lNn)}static Ghc(a,d,n,z,O){if(1===n||!$l.lBj)return $l.lBj?32:8;if(!$l.KSi){var ca=[];ca.push(Object.assign(new Ap,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));ca.push(Object.assign(new Ap,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));ca.push(Object.assign(new Ap,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));ca.push(Object.assign(new Ap,{ExternalId:"LineSpacing2_00",Number:2,Type:0}));ca.push(Object.assign(new Ap,{ExternalId:"LineSpacing2_50",
Number:2.5,Type:0}));ca.push(Object.assign(new Ap,{ExternalId:"LineSpacing3_00",Number:3,Type:0}));O.MenuItems=Uh.g(ca);$l.KSi=!0}k.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");d=d.view.Oa;ca=null;d&&d.ya.Ba&&(ca=d.ya.Ba);d=$l.jg.g4f(ca.ra);l.AFrameworkApplication.pa.rf(d,a,n,!0,z,O);return 32}static lNn(a,d){let n=a=!0;d=$l.w0.cIa(d.node);var z=d.beforeSpacing;let O=!1;1===z.unit&&(O=!0);if(O||0<z.value)a=!1;d=d.afterSpacing;z=!1;1===d.unit&&(z=!0);if(z||0<d.value)n=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState($l.Owk,
!a));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState($l.s7m,a));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState($l.Nwk,!n));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState($l.r7m,n));return 32}}$l.Owk="AddSpaceBeforeParagraph";$l.Nwk="AddSpaceAfterParagraph";$l.s7m="RemoveSpaceBeforeParagraph";$l.r7m="RemoveSpaceAfterParagraph";$l.KSi=!1;$l.RAb=null;$l.DC=null;Object(t.a)($l,"LineSpacingRibbonMenu",null,[]);var xk=b(191),Kp=b(1653),aq=b(1200);
const Lp=(a,d,n)=>{if(1===n)return 32;a=Lb.App.oa.notificationBar.Qqa("Automation test",!1);a.image=3;Lb.App.oa.notificationBar.BB(a);return 32},Ko=(a,d,n,z,O)=>{let ca;if(!({YQj:ca}=Pq(O)).returnValue)return 16;xk.UISurfaces.oK().then(Da=>{let Xa=null;var zb=Object.assign(new Kp.a,{label:"OK",onExecute:()=>{Xa&&Da.removeNotification(Xa)}});zb=Object.assign(new aq.a,{target:"#"+og.AppFrame.bSd,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:zb,useTeachingStyles:ca});
zb=Da.callout(zb);Xa=Da.addNotification(zb);return null},Da=>{k.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",Da);return null});return 32},Pq=a=>{let d=!1;if(!a)return{returnValue:!1,YQj:d};d=Boolean.parse(a);return{returnValue:!0,YQj:d}};var Sm=b(1781);let cl,am,Tl,Qn;class il{constructor(){this.iPa=new db.a;this.fCh=!1}LBb(a){const d=this.iPa.indexOf(a);let n=!0;if(-1!==d){n=!1;if(!d)return n;this.iPa.removeAt(d)}this.iPa.insert(0,a);k.ULS.sendTraceTag(594899716,340,
50,"{0} is added at the start of recent color list.",a);11===this.iPa.count&&(k.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.iPa.J(10)),this.iPa.removeAt(10));this.yOn();return n}yOn(){k.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const a=[];for(let n=0;n<this.iPa.count;n++){var d="#"+this.iPa.J(n).substring(4,6)+this.iPa.J(n).substring(2,4)+this.iPa.J(n).substring(0,2);d=Object.assign(new Sm.a,{Color:this.iPa.J(n),
Alt:d,DisplayColor:d});a.push(appChrome.api.colorPickerCell(d.Color,d.DisplayColor,d.Alt))}for(const n of il.Gkk)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(n,a));this.fCh||this.INn();this.fCh=!0}INn(){for(const a of Object.keys(il.EFh)){k.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",a);const d=il.EFh[a],n=[];for(const z of d)n.push(appChrome.api.menuSection([z],z in il.wnf?il.wnf[z].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(a,
n,il.wnf[a].toString()))}}}il.EFh={["FontColor"]:(Qn=new db.a,Qn.add("AutomaticFontColor"),Qn.add("ThemeFontColorPickerMCU"),Qn.add("ThemeFontColorPicker"),Qn.add("StandardFontColorPicker"),Qn.add("RecentFontColorPicker"),Qn.add("MoreFontColors"),Qn),["CellShading"]:(Tl=new db.a,Tl.add("ThemeShadingColorPickerMCU"),Tl.add("ThemeShadingColorPicker"),Tl.add("StandardShadingColorPicker"),Tl.add("RecentCellShadingColorPicker"),Tl.add("ClearShadingColor"),Tl.add("MoreCellShadingColors"),Tl),["PictureBorders"]:(am=
new db.a,am.add("ThemePictureBorderColorPickerMCU"),am.add("ThemePictureBorderColorPicker"),am.add("StandardPictureBorderColorPicker"),am.add("RecentPictureBorderColorPicker"),am.add("MorePictureBorderColors"),am.add("NoPictureBorder"),am.add("PictureBorderWeightOptions"),am.add("PictureBorderStyleOptions"),am)};il.wnf={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,
["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["FontColor"]:Box4Intl.Box4Strings.L_FontColor,["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:"Picture Border"};il.Gkk=(cl=new db.a,cl.add("RecentFontColorPicker"),cl.add("RecentCellShadingColorPicker"),
cl.add("RecentPictureBorderColorPicker"),cl);Object(t.a)(il,"RecentColorsSectionHandler",null,[]);var Lo=b(1652),yk=b(1380);class Qq{constructor(a){this.Uik=a}n8(){}m8(a){this.Uik.rAm(a)}}Object(t.a)(Qq,"DataBuddyActionListener",null,[33]);class yr{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(t.a)(yr,"DataBuddyTaskPaneProps",null,[]);class bq{constructor(a){this.isVisible=!1;this.YH=new db.a;this.l8e=null;this.YW=a;this.YD=new Lo.a;
this.ib=ic.FocusManager.instance()}initialize(){this.l8e=new Qq(this);this.YW.t3a();this.YD.vQ(this.ewk());this.YD.vQ(this.Wtk())}toggle(){this.isVisible?this.hide():this.show()}rAm(a){if(2===a.behavior){const d=Bc.ActionManager.haa(a.actionId)||a.actionId.toString();d.startsWith("Query")||(this.YH.add(d+": "+bq.Dql(a.response)),this.Mw())}}hide(){xk.UISurfaces.Nv().then(a=>{a.hideTaskPane(bq.nB,2);return null})}show(){xk.UISurfaces.Nv().then(a=>{a.showTaskPane(bq.nB,this.GF());return null});this.isVisible&&
xk.UISurfaces.Nv().then(a=>{a.setSelectedTaskPane(bq.nB);return null})}ewk(){return a=>{a.actions=this.YH.toArray();a.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}Wtk(){return a=>{a.onClearClick=()=>{this.YH.clear();this.Mw()}}}lb(){l.AFrameworkApplication.pa.b5(this.l8e)}wvb(){l.AFrameworkApplication.pa.qVc(this.l8e)}GF(){const a=new yr;this.YD.klc(a);return Object.assign(new yk.a,{title:"Data Buddy",hideHeader:!1,width:bq.width,location:2,contentProps:a,onOpen:()=>{this.Fha();
this.lb();this.isVisible=!0;l.AFrameworkApplication.la.updateCommandUI()},onClose:()=>{this.hoa();this.wvb();this.isVisible=!1;this.Mw();l.AFrameworkApplication.la.updateCommandUI()},isModernPane:!0})}Mw(){xk.UISurfaces.Nv().then(a=>{a.updateTaskPane(bq.nB,this.GF());return null})}Fha(){this.ib.wf(bq.nB)}hoa(){this.jpb()&&this.ib.wf(this.ib.uI)}jpb(){return!!this.ib.Zd&&this.ib.Zd.name===bq.nB}static Dql(a){switch(a){case 0:return"Unattempted";case 1:return"In Progress";case 2:return"Not Handled";
case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return a.toString()}}}bq.nB="DataBuddyTaskPane";bq.width=300;Object(t.a)(bq,"Box4DataBuddyTaskPane",null,[582]);class Or{constructor(a){this.gh=a}Evb(a){this.gh&&this.gh.jF(a)}u_d(){this.gh&&this.gh.Ioc(void 0)}}Object(t.a)(Or,"RibbonButtonUpdater",null,[580]);var jn=b(367);class pp{constructor(){this.vvf=this.Z=null}get name(){return"Box4.UI"}Hb(a){this.Z=a;a.ha("Box4.IGeneralCuiUser",
()=>new Pn(a.resolve("Box4.UI.CuiActionBridge"),l.AFrameworkApplication.pa)).singleInstance();a.ha("Box4.UI.TableAltTextDialogFactory",()=>new Jp(a.resolve("Box4.ITableEditor"),new jn.a,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();a.ha("Box4.UI.ILanguageEditor",()=>new Zl(Lg.a.instance.Ag,a.sa("Box4.ITextFormattingCommands"),a.Ca("Box4.IAutoCorrectRules"),a.resolve("Box4.ILanguageReader")));a.ha("CommandUI.StandaloneRootController",()=>new Nq(l.AFrameworkApplication.ln)).as("Common.IStandaloneRootController").singleInstance();
a.ha("Box4.UI.IAutoCorrectOptionsDialog",()=>new Ip(a.resolve("Box4.IAutoCorrectOptionsInfo"),l.AFrameworkApplication.K.ea("ReplaceQuoteWithSmartQuoteIsEnabled")));a.ha("Box4.UI.LanguageListHelper",()=>new Yo(l.AFrameworkApplication.K.ea("RecentlyUsedLanguagesListIsEnabled"))).as("Box4.UI.ILanguageListHelper").singleInstance();a.register(Am,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").singleInstance();a.ha("Box4.UI.DefaultProofingContextMenuCreator",
()=>new pm(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"))).singleInstance();a.ha("Box4.UI.ProofingContextMenuSectionFactory",()=>new oo(a.resolve("Box4.UI.DefaultProofingContextMenuCreator"),a.resolve("Box4.UI.EditorServiceProofingContextMenuCreator"))).as("Box4.UI.IProofingContextMenuSectionFactory").singleInstance();a.ha("Box4.RibbonButtonUpdater",()=>new Or(this.Z.resolve("Box4.IAppFrame"))).as("Common.IRibbonButtonUpdater").singleInstance();a.ha("Box4.UI.RecentColorsSectionHandler",
()=>new il).singleInstance();a.ha("Common.IDataBuddyTaskPane",()=>new bq(zp.a.instance)).singleInstance()}init(){var a=Lb.App.oa;const d=a.eb;ub.w2l(Object(m.a)(d,d.g7a,"onAuthenticationLost"),Object(m.a)(d,d.h7a,"onAuthenticationRestored"),a.A4h);yg.a.lb();a=l.AFrameworkApplication.pa;a.ma(Mb.a.$fj,Kb.a.application,Rm);a.Aa(Mb.a.gCj,Kb.a.application,po,96);a.Aa(Mb.a.qCj,Kb.a.application,Ws,96);a=l.AFrameworkApplication.pa;a.Aa(Mb.a.lDj,Kb.a.application,Lp,96);a.Aa(Mb.a.ZBj,Kb.a.application,Ko,96);
$l.lb();this.e4l();this.vvf=this.Z.resolve("Common.IStandaloneRootController")}e4l(){this.Z.Ca("Box4.IGeneralCuiUser").execute(a=>{this.Z.Ca("Common.IStandaloneRootController").execute(d=>{d.e1.XI=a})})}dispose(){this.vvf.dispose();this.vvf=null}static main(){M.a.instance.Sb(new pp,6)}}Object(t.a)(pp,"Box4UIPackage",null,[1,2]);var Zo=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",
Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},Mo=b(1654);class hr{get name(){return"Box4.Insights"}init(){}dispose(){}Hb(a){a.ha("Box4.Insights.Box4InsightsSelection",()=>new Mo.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance()}}Object(t.a)(hr,"Box4InsightsPackage",null,[1,2]);const Tk=a=>{window.performance&&"function"===typeof window.performance.mark&&
window.performance.mark("CatchUpInit."+a)};var lk=b(408),No=b(324);class qm{constructor(a,d){this.lh=this.s$d=0;this.Qxh=d;this.xpk=a}zJb(){return this.s$d-this.lh>=this.xpk}reset(){this.lh=this.s$d=this.Qxh()}update(){this.s$d=this.Qxh()}}Object(t.a)(qm,"TimeBasedTaskYieldStrategy",null,[697]);class Bm{zJb(){return!1}reset(){}update(){}}Object(t.a)(Bm,"NullTaskYieldStrategy",null,[697]);var Cm=b(1224);class zr{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=
this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(t.a)(zr,"CatchUpConfiguration",null,[]);class ir{constructor(){this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=
this.activityContentManager=null}}Object(t.a)(ir,"SharedControllerFactoryParameters",null,[]);var Rj=b(158),Dc=b(20);class tq{constructor(a,d,n,z){this.nA=a;this.jk=d;this.ga=n;this.ib=z;this.$9d=this.a$d=null;this.R8d=!1;this.ga.ma(Dc.a.hJj,Kb.a.view,Object(m.a)(this,this.SKm,"onToggleActivityAnnouncements"));this.ib.Kc(Ec.AFrame.hp).bindAction(gb.KeyInputManager.$a(xb.a.Hwb,6),Dc.a.hJj)}SKm(a,d){(this.R8d=!this.R8d)&&d.Am&&d.Am.contextId===Kb.a.Ub&&this.k6h(d.Am.node,d.Am.Gm);return 32}H0(a,d){this.R8d&&
this.jk&&d&&d.zi&&d.zi.Ba&&d.zi.Ba.ra&&d.zi.Ba.ra.node&&d.zi.Ba.ra.contextId===Kb.a.Ub&&this.k6h(d.zi.Ba.ra.node,d.zi.Ba.ra.Gm)}k6h(a,d){a&&(this.E6i(a)?(this.a$d&&this.a$d.id.equals(a.id)||(this.jk.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,!1),this.a$d=a),this.Ysm(a,d)):this.$9d=this.a$d=null)}E6i(a){return 0<this.nA.J9b(a).count}Ysm(a,d){if(a){var n=-1,z=null,O=null;for(let ca=0;ca<a.ja.length;ca++){const Da=a.ja.J(ca);if(!(null==O||Da.changeStart&&
Da.changeStart.equals(z))&&d>=n&&d<=Da.cp&&!z.equals(this.$9d))if(this.nA.xcc(z)){(a=this.nA.Hsd(z,a.id))&&0<a.actors.length&&a.displayTimestamp&&(a=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,a.actors[0].displayName,a.displayTimestamp.toLocaleString()),this.jk.sendNotification(a,!1),this.$9d=z);break}else this.$9d=null;Da.changeStart&&!Da.changeStart.equals(z)&&(n=Da.cp,z=Da.changeStart);O=Da.changeStart}}}}Object(t.a)(tq,"ActivityAnnouncementManager",
null,[]);var hm=b(1201),rm=b(684),Hk=b(696),qi=b(481);class yn{constructor(){this.activityId=null;this.type=0;this.priorityId=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(t.a)(yn,"Activity",null,[]);var Wk=b(402);class Dm extends yn{constructor(){super();this.Bv=this.objectId=null}static iG(a){const d=new qi.a(new Wk.a);if(a.Bv)for(let n of a.Bv)d.add(n);return d}}Object(t.a)(Dm,"RevisionSetActivity",yn,[]);class jj{constructor(a,d,n){this.hbf=null;
this.t3=a;this.Tb=d;this.Y6i=n}WHn(a){if(a)switch(a.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:this.Tb.ob(Sa.a.b7a,2,null);break;default:this.wAm()}else k.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}wAm(){this.Y6i.then(a=>{var d=Object.assign(new aq.a,{target:'[data-unique-id~="CatchUpWithChanges"]',showCloseIcon:!0,content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new hm.a,{directionalHint:6,
gapSpace:4,isBeakVisible:!1})});d=a.callout(d);const n=Object.assign(new rm.a,{expirationOptions:Object.assign(new Hk.a,{displayTimeoutSeconds:10,onExpire:Object(m.a)(this,this.dismiss,"dismiss")})});this.hbf=a.addNotification(d,n)})}dismiss(){this.Y6i.then(a=>{a.removeNotification(this.hbf);return this.hbf=null})}doesContentExist(a){if(!a)return k.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(a.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!a.navigationId)return k.ULS.sendTraceTag(593049025,
3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const d={};d.NavigationId=atob(a.navigationId);if(8===this.Tb.ob(Sa.a.spd,2,d))return!1;break;case 1:return this.gcl(a)}return!0}gcl(a){a=Dm.iG(a);return a?0<this.t3.xud(a).count:(k.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(t.a)(jj,"ActivityContentManager",null,[634]);var kj=b(1277),zn=b(1778),Pg=b(1015),kn=b(642);class Wj{constructor(){this.Bv=this.k4=null}compare(a){if(!a)return!1;
if(this.k4&&a.k4){if(this.k4.count!==a.k4.count)return!1;for(let d of this.k4)if(!a.k4.contains(d))return!1}else if(!a.k4&&this.k4||!this.k4&&a.k4)return!1;if(a.Bv&&this.Bv){if(a.Bv.count!==this.Bv.count)return!1;for(let d of this.Bv)if(!a.Bv.contains(d))return!1}else if(!this.Bv&&a.Bv||!a.Bv&&this.Bv)return!1;return!0}}Object(t.a)(Wj,"ActivityHighlightableObject",null,[]);class An extends kj.a{constructor(a,d){super();this.rrf=this.Gvc=null;this.U2d=a;this.nA=d;this.lja=[new zn.a(Pg.a.a5h,Pg.a.$4h),
new zn.a(Pg.a.Y4h,Pg.a.X4h),new zn.a(Pg.a.Yle,Pg.a.Zle),new zn.a(Pg.a.$le,Pg.a.LKf)]}get eac(){return 1}get HGb(){return this.lja}get kAa(){return!0}VFb(a,d){if(a=Object(qa.a)(Wj,a))if(a.k4)for(let n of a.k4)d.add(n);else k.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}o7a(a,d){if(this.YB.z3a){var n=this.U2d.ftb,z=this.U2d.KGb,O=!!n&&n.compare(z),ca=this.YB.z3a,Da=ca.action,Xa=this.Vrn(ca,a),zb=!1;2!==Da&&Da&&(zb=(zb=this.YB.wIe)?1===zb.type:!!n||!!z);d=d.xic("*");
for(let Vb=0,Fc=d.length;Vb<Fc;Vb++){const Yc=d[Vb],yd=this.Oyl(Yc,Pg.a.bme);if(yd&&yd.Wt)if(this.y6m(Yc),1===ca.type)switch(Da){case 0:Xa&&n.Bv.contains(yd.Wt)&&this.Jje(Yc,2,yd,!1);break;case 2:Xa&&z.Bv.contains(yd.Wt)&&this.Jje(Yc,O?2:1,yd,!1);break;default:this.aIc(a,Yc,yd,!1)}else zb?this.aIc(a,Yc,yd,!1):this.aIc(a,Yc,yd,!0)}this.Gvc&&(this.Gvc.classList.add(Pg.a.$le),this.rrf=this.Gvc=null)}}Oyl(a,d){return Ag.a.Ta(a,d)}Vrn(a,d){if(a&&a.pK){const n=a.pK,z=a.action;if(1===a.type&&(2===z||!z)&&
n.k4)return n.k4.contains(d);if(n.Bv)for(let O of n.Bv){a=this.nA.RFc(O);for(let ca of a)if(ca===d)return!0}}return!1}aIc(a,d,n,z){const O=this.U2d.ftb,ca=this.U2d.KGb;O&&O.Bv.contains(n.Wt)&&(!O.k4||O.k4.contains(a))?this.Jje(d,2,n,z):ca&&ca.Bv.contains(n.Wt)&&(!ca.k4||ca.k4.contains(a))&&this.Jje(d,1,n,z)}Jje(a,d,n,z){a&&kn.a(a)&&(a.classList.add(this.dCl(2===d,z)),this.hln(a,n,z))}hln(a,d,n){this.Gvc?-1!==d.cpEnd&&this.rrf.cpEnd!==d.cpBegin&&(this.Gvc.classList.add(n?Pg.a.LKf:Pg.a.$le),a.classList.add(n?
Pg.a.Zle:Pg.a.Yle)):a.classList.add(n?Pg.a.Zle:Pg.a.Yle);a.classList.add(Pg.a.Z4h);this.Gvc=a;this.rrf=d}y6m(a){this.YB.gsb(a);this.D5m(a)}D5m(a){a.classList.remove(Pg.a.Yle,Pg.a.Zle,Pg.a.Z4h,Pg.a.$le,Pg.a.LKf)}dCl(a,d){return d?a?Pg.a.X4h:Pg.a.$4h:a?Pg.a.Y4h:Pg.a.a5h}}Object(t.a)(An,"ActivityHighlightActor",kj.a,[]);var Y=b(1779),pa=b(174);class lb{constructor(a,d,n,z,O,ca,Da,Xa){this.uea=a;this.iU=d;this.nA=n;this.Pik=O;this.Da=ca;this.jk=Xa;this.ib=Da;this.iU.HGe=!1}Kaj(a,d,n){a?this.B_l(a,d,n):
this.iU.ftb&&(a=Object.assign(new Y.a,{action:1,type:1,pK:null,zV:this.iU.ftb}),this.iU.ftb=null,this.uea.rM(a))}B_l(a,d,n){if(d){a=new qi.a(new Wk.a);for(O of d){var z=this.nA.mtd(O);for(let ca=0;ca<z.length;ca++){const Da=z[ca];this.nA.xcc(Da)&&a.add(Da)}}var O=this.nA.xud(a);O=this.nbi(O,a);z=this.iU.ftb;this.iU.ftb=O;O=Object.assign(new Y.a,{action:0,type:1,pK:this.iU.ftb,zV:z});this.uea.rM(O);n&&!this.sfn(d.J(0),a)||this.Fgn(d.J(0),a)}else k.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",
a.activityId)}sfn(a,d){if(!a)return k.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==a.type)return k.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),!1;d=this.Awl(a,d);return this.Pik.ukc(a.id,d)?this.setSelection(a,d)?!0:!1:(k.ULS.sendTraceTag(587239563,377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}Fgn(a,d){a=this.eCl(a,d);d=new Sys.StringBuilder;for(let n=
0;n<a.count;n++)d.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,n+1,a.count,a.J(n)));this.jk.sendNotification(d.toString(),!0)}setSelection(a,d){if(!a||!Bd.ParagraphReader.nb(a))return k.ULS.sendTraceTag(579396806,377,10,"SetSelection: Invalid node provided"),!1;if(0>d)return k.ULS.sendTraceTag(579396807,377,10,"SetSelection: Invalid cp provided"),!1;this.iU.HGe=!0;a=fe.a.Kb(a,d);a=new pa.Selection([a],!0);this.Da.setSelection(a);ic.FocusManager.jA()&&
this.ib.wf(Ec.AFrame.ao);return!0}Awl(a,d){if(d&&0<d.count)for(let n=0;n<a.ja.length;n++){const z=a.ja.J(n);if(z.changeStart&&d.contains(z.changeStart))return z.cp}k.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");return 0}eCl(a,d){const n=new db.a;if(d&&0<d.count&&a){let z=-1;for(let O=0;O<a.ja.length;O++){const ca=a.ja.J(O);if(-1!==z&&ca.isChangeEnd)if(ca.changeStart&&d.contains(ca.changeStart))continue;else n.add(a.characterData.substring(z,
ca.cp)),z=-1;ca.changeStart&&d.contains(ca.changeStart)&&(z=ca.cp)}}return n}daj(a,d){if(a)switch(a.type){case 1:if(d){a=new qi.a(new Wk.a);for(var n of d){d=this.nA.mtd(n);for(let z=0;z<d.length;z++){const O=d[z];this.nA.xcc(O)&&a.add(O)}}}else a=Dm.iG(a);d=this.nA.xud(a);this.iU.KGb=this.nbi(d,a);n=Object.assign(new Y.a,{action:2,type:1,pK:this.iU.KGb,zV:null});this.uea.rM(n)}else this.iU.KGb&&(n=Object.assign(new Y.a,{action:3,type:1,pK:null,zV:this.iU.KGb}),this.iU.KGb=null,this.uea.rM(n))}nbi(a,
d){var n=null;if(a){n=new ra.a;for(let z of a)12===z.type&&n.add(z)}a=new Wj;a.k4=n;a.Bv=d?d:this.OGl(n);return a}OGl(a){const d=new qi.a(new Wk.a);if(!a)return d;for(let n of a)for(let z of this.nA.J9b(n))d.add(z);return d}}Object(t.a)(lb,"ActivityHighlightManager",null,[]);var Sb=b(1275),jc=b(121),Lc=b(61);class rd{constructor(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(t.a)(rd,"CreateIndicatorTooltipParameters",null,[]);class Fd{constructor(){this.clearSticky=
!1}}Object(t.a)(Fd,"DismissIndicatorTooltipParameters",null,[]);class pe{constructor(){this.target=null;this.isSticky=!1}}Object(t.a)(pe,"UpdateIndicatorTooltipParameters",null,[]);class Ie extends Sys.EventArgs{constructor(a,d,n){super();this.d8b=a;this.uMi=d;this.Ksn=n}}Object(t.a)(Ie,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class pg{constructor(){this.vMi=new Map;this.wMi=new Set}NFn(a,d){this.wMi.add(a);this.vMi.set(a,d)}ybm(a){return this.XQi(a.htmlElement)}iTl(){let a=new Set;for(let d of this.wMi){const n=
this.vMi.get(d);n&&this.xbm(n)&&a.add(d)}return a}xbm(a){return a.parentElement&&this.XQi(a.parentElement)}XQi(a){const d=ae.a.ima();a=Ye.a.oTa(a);return 0<=a&&a<=d}}Object(t.a)(pg,"IndicatorVisibilityTracker",null,[]);class Rg extends Sb.a{constructor(a,d,n,z,O,ca,Da,Xa,zb){super();this.ka=new oc.a;this.$Ub=this.wja=null;this.nA=a;this.u8e=d;this.Qzh=n;this.Jbk=z;this.tm=O;this.mea=null;this.fb=Da;this.tXc=Xa;this.bif=new pg;this.Gz=zb;this.ef&&(this.ef.h3(Object(m.a)(this,this.cQe,"pageViewOnScrolledEvent")),
this.ef.QCf(Object(m.a)(this,this.ddj,"pageViewOnResizeEvent")));ca&&ca.execute(Vb=>{Vb.pha(Object(m.a)(this,this.ju,"onZoomChanged"))})}get ef(){return this.tm&&this.tm.gj?this.tm:(k.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}Zib(a,d,n){if(this.wja){var z=Lc.a(this.wja);if(a===z)return this.wja}const O=a.Cf.ownerDocument;z=Jl.a.createElement(O,Cl.a.div);z.className=Pg.a.OOk;z.style.left=d+"px";z.style.top=n+"px";d=Jl.a.createElement(O,Cl.a.div);d.className=this.Gz?
Pg.a.h5h:Pg.a.b5h;z.style.cursor="pointer";d.style.cursor="pointer";z.appendChild(d);Eg.a.instance.Ea(vb.a.xz,z,Object(m.a)(this,this.onMouseEnter,"onMouseEnter"));Eg.a.instance.Ea(vb.a.Fw,z,Object(m.a)(this,this.aCa,"onMouseLeave"));Ae.a.instance.Ea(vb.a.click,z,Object(m.a)(this,this.YBa,"onClickEvent"));Eg.a.instance.Ea(vb.a.contextMenu,z,Object(m.a)(this,this.hO,"onContextMenu"));k.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");this.Znm(a);d=this.sHl(a);this.bif.NFn(d,
z);this.bif.ybm(a)&&this.U9i(d);return z}Olc(a){return this.brn(a)}Q5b(a){const d=this.CMk(a),n=[];n.push(this.Zib(a.bha,d,a.U0d[0].y-a.IUa[0].y));return n}CMk(a){let d=Pg.a.Y1l+(0>a.WFd?-a.WFd:0);const n=rf.a.Rh(a.leftMargin,0)/2;1>=n&&k.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");d=d>n?n:d;d=d<Pg.a.c5h?Pg.a.c5h:d;return l.AFrameworkApplication.isRtl?a.IUa[0].width/this.zoom+d:-d}FAj(a){if(a&&393230===a.Jb||393251===a.Jb){const d=this.nA.J9b(a);if(d)for(let n of d)if(a===
this.nA.KFc(n))return!0}return!1}brn(a){for(let d of Bd.ParagraphReader.VB(a.Ia,!0,!1))if(this.FAj(d))return!0;return!1}lb(a){a.ma(Dc.a.aCj,Kb.a.Ub,Object(m.a)(this,this.oXl,"handleShowCatchUpActivitiesForParagraph"));a.ma(Dc.a.G5g,Kb.a.Ub,Object(m.a)(this,this.qXl,"handleShowIndicatorFlyoutForActivity"))}qXl(a,d,n,z,O){if(!O)return k.ULS.sendTraceTag(592540299,377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;d=Dm.iG(O.Activity);a=null;if(O.NodeId&&(O=jc.b(O.NodeId),!E.a.Ap(O,E.a.nil)&&
(O=this.nA.Sxi(O),this.Nbh(O,!1))))return 32;for(let ca of d)if(this.nA.xcc(ca)){O=this.nA.KFc(ca);if(this.Nbh(O,!0))return 32;O&&!a&&(a=O)}if(this.Nbh(a,!1))return 32;k.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");return 8}oXl(a,d,n,z,O){k.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");O&&d&&d.Cj&&(a=d.node)&&((a=this.tXc.Nxe(a))?this.Bhe(a,!1,!1):k.ULS.sendTraceTag(595126289,
377,50,"Unable to obtain indicator container for node after context menu action."));return 32}Nbh(a,d){if(!a)return!1;const n=this.tXc.Nxe(a);if(n)return this.Bhe(n,!1,!0),!0;if(!d){let z;this.WOd((z=new db.a,z.add(a),z),!1,!0,!0);d=new bf.a(3,1,0,Object(m.a)(this,this.jwn,"showTooltipForIndicatorTask"),181);d.customData=a;this.fb.rb(d);return!0}return!1}jwn(a){(a=this.tXc.Nxe(a.customData))&&this.Bhe(a,!1,!1)}y1k(a,d=!1){d&&this.Ume(!0);if(a&&a.parentNode){var n=this.Icg(a);n=this.Mql(n);this.mea||
(this.mea=document.createElement("Div"),document.getElementById(l.AFrameworkApplication.rhb).appendChild(this.mea));this.u8e.createActivityIndicatorTooltip(Object.assign(new rd,{target:a,container:this.mea,activityIds:n,isSticky:d,dirHint:9}));d&&(this.wja=a)}else k.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}efl(a){a&&a.classList.add(Pg.a.ame)}y$i(a,d){return this.Bhe(a,d,!1)}Bhe(a,d,n){if(d&&
a===this.wja)return!0;const z=this.Icg(a);d||this.m6g();this.y1k(a,!d);this.efl(a.getElementsByClassName(this.Gz?Pg.a.h5h:Pg.a.b5h)[0]);this.WOd(z,d,!0,n);this.v0i(z,d?1:2);d&&(this.$Ub=a);return!0}onMouseEnter(a){return this.y$i(a.qk,!0)}Ume(a=!1){this.u8e.dismissActivityIndicatorTooltips(Object.assign(new Fd,{clearSticky:a}));this.$Ub=null;a&&(this.wja=null)}sDj(a){a&&a.classList.remove(Pg.a.ame)}m6g(){this.wja&&this.sDj(this.wja.getElementsByClassName(Pg.a.ame)[0])}aCa(a){a=a.qk;if(a===this.wja)return!0;
this.Vmj(a);return!0}Vmj(a){const d=this.Icg(a);this.WOd(d,!0,!1,!1);this.sDj(a.getElementsByClassName(Pg.a.ame)[0]);this.Ume(!1);this.$Ub=null}Icg(a){let d=null;(a=(a=Lc.a(a))?a.Ia:null)&&11===a.type&&(d=Bd.ParagraphReader.VB(a,!0,!1));return d}YBa(a){this.$Ub=null;return this.y$i(a.qk,!1)}hO(){this.m6g();this.Ume(!0);return!1}YLf(){const a=!!this.$Ub;if(this.wja||a)this.m6g(),this.Ume(!0),this.WOd(null,!1,!1,!1),this.WOd(null,!0,!1,!1)}ju(){this.ddj()}uxk(a){this.ka.addHandler(Rg.rTh,a)}vxk(a){this.ka.addHandler(Rg.sTh,
a)}WOd(a,d,n,z){let O=null;if(n&&a){for(let ca of a)if(n=this.nA.mtd(ca))for(let Da=0;Da<n.length;Da++){const Xa=n[Da];if(this.nA.xcc(Xa)){O=this.nA.Hsd(Xa,ca.id);break}}if(!O){k.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}d?this.ka.raiseEvent(Rg.rTh,new Ie(O,a,!1)):this.ka.raiseEvent(Rg.sTh,new Ie(O,a,z))}Mql(a){const d=[];if(a)for(let z of a){var n=this.nA.J9b(z);for(let O of n)(n=this.nA.Hsd(O,z.id))&&d.push(n.activityId)}!d.length&&
a&&a.count&&k.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");return d}SOj(a){a&&a.parentNode?(this.u8e.updateActivityIndicatorTooltip(Object.assign(new pe,{target:a,isSticky:!0})),this.wja=a):k.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}cQe(){this.wja&&this.SOj(this.wja);this.$Ub&&this.Vmj(this.$Ub);this.nGm()}ddj(){this.wja?
this.SOj(this.wja):this.YLf()}nGm(){let a=this.bif.iTl();for(let d of a)this.U9i(d)}U9i(a){this.Qzh.u0i(a,3);this.Jbk.Oxg()}sHl(a){return(a=Bd.ParagraphReader.VB(a.Ia,!0,!1))&&a.count?a.J(0).id:null}Znm(a){a=Bd.ParagraphReader.VB(a.Ia,!0,!1);this.v0i(a,0)}v0i(a,d){a&&a.count&&this.Ynm(a.J(0).id,d)}Ynm(a,d){this.Qzh.u0i(a,d)}}Rg.rTh="ActivityIndicatorPreviewed";Rg.sTh="ActivityIndicatorSelected";Object(t.a)(Rg,"ActivityIndicatorActor",Sb.a,[]);var qe=b(40);class Wh{constructor(a,d,n){this.nA=a;this.fge=
d;this.tm=n}get ef(){return this.tm&&this.tm.gj?this.tm:(k.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}Nxe(a){k.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");const d=this.Fyi(a);if(!d){k.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");a=this.nA.J9b(a);for(let n of a)if(a=this.nA.KFc(n),a=this.Fyi(a))return a}return d}Fyi(a){if(!a||
12!==a.type)return k.ULS.sendTraceTag(539779146,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!a)return k.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),null;var d=this.fge.lAe(a);if(!d||11!==d.type)return k.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;d=d.Qd(this.ef.Za);if(!d||!d.htmlElement)return k.ULS.sendTraceTag(539779149,
377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),null;var n=ae.a.qTa(d.htmlElement,Wh.qTh);if(n)return n;d=d.L1f();if(!d)return k.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),null;d=ae.a.Bui(d,Wh.qTh);if(!d)return k.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(n=0;n<d.length;n++){const z=Lc.a(d[n]),O=qe.OutlineElementNavigator.Fl(a);
if(z&&z.Ia&&O&&z.Ia.id.equals(O.id))return d[n]}k.ULS.sendTraceTag(539779152,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}fDl(a){a=this.nA.Sxi(a);if(!a||12!==a.type)return k.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),E.a.nil;a=this.Nxe(a);if(!a)return k.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),
E.a.nil;a=Lc.a(a);return a?a.Ia.id:(k.ULS.sendTraceTag(555356865,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),E.a.nil)}}Wh.qTh="CatchUpActivityIndicatorContainer";Object(t.a)(Wh,"ActivityIndicatorHelper",null,[]);var Ik=b(1433);class Sj{constructor(a,d,n,z,O,ca){this.DIc=a;this.wAf=n;this.pageContentNode=d;this.Tb=z;this.t3=O;this.Gf=ca;this.DIc.MLb(this.wAf)}initialize(){this.Tb.ma(Dc.a.X2i,Cd.a.frame,Object(m.a)(this,this.Ptm,"markCatchUpChangeRead"))}get tJi(){return!!this.t3.KY&&
0<this.t3.KY.count||!!this.t3.UMc&&0<this.t3.UMc.count}bKg(a){let d=new Map;d.set("activityCount",(a&&a.wywaActivities?a.wywaActivities.length:0).toString());this.Gf.Lq("CatchUpActivitiesReady",0,{extendedProperties:d});a?this.PBm(a.wywaActivities):(k.ULS.shipAssertTag(36538305,377,!1),Object(Ik.a)(),this.Gf.fl("CatchUpActivitiesReady","nullPayload",null,{name:"CatchUpExperienceDegraded",Zo:"CatchUpActivitiesMissing"}))}PBm(a){a?(k.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),
this.Wpn(a),a=this.t3.hxk(a),this.Xpn(a)):k.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}Ptm(a,d,n){if(1===n)return this.tJi?32:8;2===n&&(this.tJi&&(this.wAf.YLf(),this.TRk()),k.ULS.sendTraceTag(38138719,377,50,x.c({["MarkAsRead invoked"]:!0})));Lb.App.oa.updateCommandUI();return 8}Wpn(a){if(a){var d=new db.a;for(let n of a)switch(n.type){case 2:case 3:case 4:case 10:a=4===n.type?n.Ddj:n.contentId,d.add(a),this.t3.UMc.add(a)}0<d.count&&(k.ULS.sendTraceTag(51196435,377,50,"{0}",
d.count),this.Tb.ob(Sa.a.YDg,2,d.toArray()))}}Xpn(a){const d=new qi.a(new Wk.a),n=new Ff.GraphTransaction(3);try{n.Sa(this.pageContentNode);for(let z of a){const O=this.t3.KFc(z);O&&this.wAf.FAj(O)&&(d.add(O.id),this.DIc.cJc(O,!0))}}finally{n&&n.dispose()}0<a.count&&Lb.App.oa.updateCommandUI();a={};a.highlightedNodeCount=d.count;k.ULS.sendTraceTag(36509257,377,50,"{0}",x.c(a))}TRk(){k.ULS.sendTraceTag(36509258,377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.t3.UMc.count&&(this.Tb.ob(Sa.a.fXf,
2,this.t3.UMc.toArray()),this.t3.UMc.clear());const a=this.vTk(this.t3.KY);this.y5m(a)}y5m(a){k.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");const d=new Ff.GraphTransaction(3);try{d.Sa(this.pageContentNode);for(let n of a){this.t3.KY.remove(n);for(let z of this.t3.RFc(n))this.DIc.cJc(z,!0)}this.t3.L6h()}finally{d&&d.dispose()}}vTk(a){const d=new qi.a(new Wk.a);for(let n of a)d.add(n);return d}}Object(t.a)(Sj,"ActivityIndicatorManager",null,[]);class xl{constructor(){this.KGb=
this.ftb=null;this.isFirstDocumentOpen=this.HGe=!1}}Object(t.a)(xl,"ActivityStateManager",null,[632]);var Yi=b(88);class dq{constructor(a,d){this.N3d={};this.iab=a;this.oy=d;this.UMc=new db.a}get KY(){return this.iab.KY}initialize(){if(this.oy){k.ULS.sendTraceTag(41302109,377,15,"Build ChangeIdCache with graph tree traversal");this.iab.initialize(null);var a=new Ff.GraphTransaction(0);try{a.Sa(this.oy);const d=Yi.a.Ql(this.oy);for(;d.moveNext();)(Bd.ParagraphReader.Zf(d.iterator)||Kd.ImageReader.eQ(d.currentNode))&&
this.iab.sVc(d.currentNode)}finally{a&&a.dispose()}}else k.ULS.sendTraceTag(36824331,377,15,"PageContentNode is null")}oFc(a){return this.iab.oFc(a)}J9b(a){const d=new qi.a(new Wk.a);if(!a)return d;a=this.iab.oFc(a);for(let n=0;n<a.length;n++){const z=a[n];this.xcc(z)&&d.add(z)}return d}RFc(a){return this.iab.RFc(a)}xud(a){const d=new db.a;if(a)for(let n of a)d.addRange(this.RFc(n));return d}hxk(a){const d=new qi.a(new Wk.a);if(a)for(let n of a)if(1===n.type&&(a=n))for(let z of a.Bv){d.add(z);this.KY.add(z);
const O=z.toString();this.N3d[O]||(this.N3d[O]=new db.a);this.N3d[O].add(a)}this.L6h();return d}xcc(a){return this.KY&&a?this.KY.contains(a):!1}Hsd(a,d){if(a&&(a=this.N3d[a.toString()])&&0<a.count){for(let n of a)if(n.objectId.equals(d))return n;return a.J(0)}return null}KFc(a){return this.iab.KFc(a)}L6h(){this.iab.GRk()}mtd(a){return this.iab.mtd(a)}Sxi(a){if(!this.oy)return null;const d=this.oy.Ib;return d?d.Ta(a):null}}Object(t.a)(dq,"ChangeIdCache",null,[]);var Op=b(154),wq=b(104);class Un extends Op.a{constructor(){super();
this.activityClassifications=this.inferences=this.correspondingRequest=null;this.H_=Object.assign(new wq.a,{T_:Un.getTypeName(),B_:Un.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(t.a)(Un,"ChangeSummariesResponse",Op.a,[]);var eq=b(433);class fq extends eq.a{constructor(){super();this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new wq.a,{T_:fq.getTypeName(),
B_:fq.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(t.a)(fq,"ChangeSummariesRequest",eq.a,[]);var Jn=b(431),Sq=b(451),Gj=b(200),Na=b(452);class cb{constructor(){this.nQc=this.BRd=null}}Object(t.a)(cb,"ActionPair",null,[]);class Cb{constructor(a,d,n,z){this.Qea=a;this.Xwb=d;this.lg=n;this.fb=z;this.eif=null;this.Arf=new yb.a;this.GLh=new yb.a}CAn(a){const d=Object.assign(new Jn.a,{parentPath:["Signal",
fq.getTypeName()],items:[Object.assign(new Sq.a,{body:a})]});return this.initialize().then(()=>{const n=new Promise((z,O)=>{this.Arf.$(a.requestId,Object.assign(new cb,{BRd:z,nQc:O}))});this.GLh.$(a.requestId,new Date);k.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",Cb.qqj);this.Xwb.getAugLoopRuntimeManager().submitOperation(Object.assign(new Na.a,{operation:d}));this.Fnn(a.requestId);return n})}initialize(){this.eif||
(this.eif=this.Qea.ar().then(()=>{this.lg.Ea(this,Un.getTypeName())}));return this.eif}sS(a,d){if(a&&Gj.a.getTypeNameFor(a.content)===Un.getTypeName())if(a=a.content){var n=this.vmj(a.correspondingRequest);n?d!==Jn.a.getTypeName()?n.nQc("Invalid operation type"):(k.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.n$f(a.correspondingRequest)),n.BRd(a)):k.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",
this.n$f(a.correspondingRequest))}else k.ULS.sendTraceTag(589083080,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else k.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}Fnn(a){const d=new bf.a(3,1,Cb.qqj,Object(m.a)(this,this.Zel,"endRequestWithTimeout"),176);d.CBb=0;d.customData=a;this.fb.rb(d)}Zel(a){a=a.customData;const d=this.vmj(a);d&&(k.ULS.sendTraceTag(579745163,377,
15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.n$f(a)),d.nQc("Request timeout"))}vmj(a){if(!a)return null;let d;if(!({value:d}=this.Arf.Ab(a,d)).returnValue)return null;this.Arf.remove(a);return d}n$f(a){if(!a)return-1;let d;return({value:d}=this.GLh.Ab(a,d)).returnValue?(new Date).getTime()-d.getTime():-1}static get qqj(){return l.AFrameworkApplication.K.jb("ChangeSummariesRequestTimeoutMs",5E3)}}Object(t.a)(Cb,"ChangeSummariesAugloopProvider",
null,[280]);class hc{constructor(){this.activityGroups=null}}Object(t.a)(hc,"FeaturedActivityGroupPayload",null,[]);class vc{constructor(a,d,n,z,O){this.plk=a;this.l3j=d;this.Q4j=n;this.Q7j=z;this.hQb=O}getFeaturedActivityGroups(a){return a&&a.wywaActivities&&a.wywaActivities.length?this.Q7j.mZb.then(()=>this.Hzl(a)):vc.hZf}jVl(a,d,n){if(!d)return k.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;Tk("TranslateFeaturedActivityGroups");
n=this.Q4j.qGn(a,d,n.wywaActivities);k.ULS.sendTraceTag(542942800,377,50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",0<a.activityChanges.length,0<d.inferences.length,0<n.length);this.hQb.set(d.correspondingRequest,n);return Object.assign(new hc,{activityGroups:n})}Hzl(a){Tk("BuildFeaturedActivityGroupRequest");const d=this.plk.GIk();if(!d||!d.documentContent||!d.activityChanges)return k.ULS.sendTraceTag(588379905,
377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),vc.hZf;if(!d.documentContent.length||!d.activityChanges.length)return vc.hZf;k.ULS.sendTraceTag(578954499,377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+d.requestId);Tk("SubmitFeaturedActivityGroupRequest");return this.l3j.CAn(d).then(n=>this.jVl(d,n,a))}}vc.hZf=Promise.resolve(Object.assign(new hc,{activityGroups:[]}));Object(t.a)(vc,"ChangeSummariesDataProvider",
null,[631]);class hd{constructor(a,d){this.nA=a;this.Fpk=d}GIk(){const a=new db.a,d=new db.a,n=new qi.a(new Wk.a);var z=this.nA.KY;if(!z||!z.count)return hd.kZf;z=this.nA.xud(z);if(!z||!z.count)return k.ULS.sendTraceTag(592056450,377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),hd.kZf;for(let O of z)n.contains(O.id)||(n.add(O.id),this.lVm(O,a,d));return d.count&&a.count?Object.assign(new fq,{activityChanges:d.toArray(),documentContent:a.toArray(),
requestId:jc.a(E.a.create())}):hd.kZf}lVm(a,d,n){if(Bd.ParagraphReader.nb(a)){var z=Bd.ParagraphReader.plainText(a);if(z&&z.length){d.add(z);z=this.nA.J9b(a);z=this.vUl(z);for(let O of z){z=new db.a;const ca=this.getTextRanges(a,O);for(let Da of ca)z.add({changeEnd:Da.Dse,changeSpanId:Da.hin,changeStart:Da.startIndex,contentIndex:d.count-1,locationId:jc.a(a.id)});(z=this.MZk(O,z.toArray()))&&n.add(z)}}else k.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else k.ULS.sendTraceTag(592056452,
377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}vUl(a){const d=new yb.a;for(let n of a)(a=this.YBi(n))?(d.Na(a)||d.$(a,new qi.a(new Wk.a)),d.J(a).add(n)):k.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");return d.values}MZk(a,d){const n=[];let z=null;for(let O of a)if(a=this.nA.Hsd(O,E.a.nil)){if(!z){const ca=this.YBi(O);if(!ca||!ca.length){k.ULS.sendTraceTag(579712272,377,
15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}z=ca}n.push(a)}else k.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");return n.length?z?d.length?{activityId:n[0].activityId,changes:d,personId:z,timestamp:n[0].displayTimestamp.toISOString()}:(k.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),
null):(k.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),null):(k.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),null)}YBi(a){a=this.nA.Hsd(a,E.a.nil);if(!a)return k.ULS.sendTraceTag(579712274,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;a=a.actors;if(!a||!a.length||
!a[0])return k.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),null;let d=a[0].id;d&&d.length||(d=a[0].email);return d}getTextRanges(a,d){const n=new db.a;if(!d||!d.count||!a)return n;let z=-1,O=new qi.a(new Wk.a);for(let ca=0;ca<a.ja.length;ca++){const Da=a.ja.J(ca);if(-1!==z&&Da.isChangeEnd){if(Da.changeStart&&d.contains(Da.changeStart)){O.add(Da.changeStart);continue}n.add({startIndex:z,
Dse:Da.cp,hin:this.Fpk.uvj(O)});z=-1;O=new qi.a(new Wk.a)}Da.changeStart&&d.contains(Da.changeStart)&&(z=Da.cp,O.add(Da.changeStart))}return n}}hd.kZf=Object.assign(new fq,{activityChanges:[],documentContent:[],requestId:jc.a(E.a.nil)});Object(t.a)(hd,"ChangeSummariesRequestBuilder",null,[]);class od{constructor(){this.changes=this.content=null}}Object(t.a)(od,"ContentChange",null,[]);class Md{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(t.a)(Md,
"FeaturedActivityGroup",null,[]);class jf{constructor(){this.end=this.start=0}}Object(t.a)(jf,"TextRange",null,[]);class cf{constructor(a){this.tXc=a}qGn(a,d,n){if(!d)return k.ULS.sendTraceTag(588379906,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),cf.wse;if(!d.inferences)return k.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),cf.wse;if(!d.activityClassifications)return k.ULS.sendTraceTag(588379908,
377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),cf.wse;if(!d.inferences.length||!d.activityClassifications.length)return k.ULS.sendTraceTag(561111455,377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),cf.wse;const z=[],O=new ia.a(new Wk.a);for(let ca of d.inferences){const Da=this.pGn(ca,a,d,n);if(!Da)continue;const Xa=this.tXc.fDl(jc.b(Da.locationId));Xa.equals(E.a.nil)?z.push(Da):
O.Na(Xa)?O.J(Xa).ranking>Da.ranking&&O.$(Xa,Da):O.add(Xa,Da)}a=[...Array.from(O.values),...z];a.sort((ca,Da)=>ca.ranking-Da.ranking);return a.slice(0,cf.Jum)}pGn(a,d,n,z){if(!a||Fg.a.le(a.activitiesInGroup))return k.ULS.sendTraceTag(588379909,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),null;const O=new db.a,ca=new yb.a;let Da=null;for(let zb of a.activitiesInGroup){if(!zb){k.ULS.sendTraceTag(588379910,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");
continue}if(0>zb.activityIndex||zb.activityIndex>=n.activityClassifications.length){k.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");continue}const Vb=n.activityClassifications[zb.activityIndex];if(!Vb||Fg.a.le(Vb.contents))k.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");else{var Xa=this.Xjl(z,Vb.activityId);if(Xa){O.add(Xa);
for(let Fc of zb.changes){if(!Fc){k.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Xa=Fc.value;if(0>Xa||Xa>=Vb.contents.length){k.ULS.sendTraceTag(576251592,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");continue}Xa=Vb.contents[Xa];if(!Xa){k.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");
continue}const Yc=d.documentContent[Xa.contentIndex],yd=Object.assign(new jf,{start:Xa.changeStart,end:Xa.changeEnd});if(ca.Na(Yc))ca.J(Yc).add(yd);else{let je;ca.$(Yc,(je=new db.a,je.add(yd),je))}Da||(Da=Xa.locationId)}}else k.ULS.sendTraceTag(588379913,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!O.count)return k.ULS.sendTraceTag(588379914,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;d=
this.aSl(ca);return d.count?Object.assign(new Md,{ranking:a.ranking.value,reasons:[1],activities:O.toArray(),contentChanges:d.toArray(),locationId:Da}):(k.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),null)}Xjl(a,d){for(let n of a)if(n&&n.activityId&&n.activityId===d)return n;return null}aSl(a){const d=new db.a;for(let z of a){a=z.key;const O=z.value;O.Sc((ca,Da)=>ca.start-Da.start);var n=O.J(0).start;if(n>cf.x3i){n-=
cf.x3i;a=a.substring(n,a.length);for(let ca of O)ca.start-=n,ca.end-=n}d.add(Object.assign(new od,{content:a,changes:O.toArray()}))}return d}}cf.wse=[];cf.x3i=10;cf.Jum=4;Object(t.a)(cf,"ChangeSummariesResponseTranslator",null,[]);class kg{constructor(){this.hQb=new yb.a;this.Bsf=new yb.a}set(a,d){if(d.length&&a){this.hQb.$(a,d);for(let n of d)if(n.activities)for(let z of n.activities)z&&z.activityId?this.Bsf.$(z.activityId,a):k.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");
else k.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(a){return a&&this.hQb.Na(a)?this.hQb.J(a):null}nsm(a){return a&&this.Bsf.Na(a)?this.Bsf.J(a):null}}Object(t.a)(kg,"FeaturedActivityGroupCache",null,[]);class sh{constructor(a){this.hQb=a;this.pqh=new Map}lb(a){a.ma(Dc.a.iKe,Cd.a.frame,Object(m.a)(this,this.iKe,"logActivityNavigationDetails"))}iKe(a,d,n,z,O){if(!O)return k.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),
8;a=O.Activity;if(!a)return k.ULS.sendTraceTag(574103577,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;d=this.hQb.nsm(a.activityId);if(!d)return k.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),8;n=Dm.iG(a);k.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",d,a.activityId,
this.uvj(n));return 32}uvj(a){let d=0;const n=Array(a.count);for(let z of a)a=this.cIl(z),n[d]=jc.a(a),d++;return n.join(",")}cIl(a){let d=this.pqh.get(a);if(d&&d!=E.a.nil)return d;d=E.a.create();this.pqh.set(a,d);return d}}Object(t.a)(sh,"FeaturedActivityGroupTelemetryActor",null,[]);class Cj extends Sys.EventArgs{constructor(a){super();this.node=a}}Object(t.a)(Cj,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class zj{constructor(a,d,n){this.SZ=null;this.fb=a;this.Lgb=d;this.oy=n;this.ka=new oc.a;this.mZb=
new Promise(z=>{this.SZ=z})}Kyk(a){this.ka.addHandler("OPV",a)}NGk(){this.zVh(null)}zVh(a){const d=new bf.a(3,1,0,Object(m.a)(this,this.uGn,"traverseDocument"),182);d.customData=a;this.fb.rb(d)}uGn(a){this.Lgb.reset();a=this.SRl(a.customData);let d=null;for(;a.moveNext();){const n=a.currentNode;if(n&&(Bd.ParagraphReader.nb(n)&&this.ka.raiseEvent("OPV",new Cj(n)),this.Lgb.update(),this.Lgb.zJb())){d=n;break}}d?this.zVh(d):this.SZ(!0)}SRl(a){if(!a)return Yi.a.Ql(this.oy);a=Dd.GraphIterator.ua(a);a.La(7);
return Yi.a.Yo(a,this.oy)}}Object(t.a)(zj,"DocumentTraverser",null,[]);class Oo{constructor(a,d){this.Bq=a;this.ib=d}initialize(){const a=this.ib.Kc(Ec.AFrame.o4b);a.uK=!0;a.parent=Ec.AFrame.hp;a.naa(Object(m.a)(this,this.Gnl,"focusOnFirstFlyoutItem"));this.Bq.CR(Ec.AFrame.o4b)}enableF6Focus(){this.Bq.bE(Ec.AFrame.o4b)}disableF6Focus(){this.Bq.gx(Ec.AFrame.o4b)}Gnl(){const a=document.getElementById("flyoutItem0");a&&(k.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),
a.focus())}}Object(t.a)(Oo,"FlyoutFocus",null,[628]);var mn=b(791);class $e{constructor(a,d,n){this.Lph=this.jyh=this.D4c=this.m9d=!1;this.rff=this.D3d=null;this.ga=a;this.Gwh=d;this.ib=n}get I2f(){return this.rff?this.rff:(k.ULS.sendTraceTag(578401728,3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),new Date)}set I2f(a){this.rff=a}initialize(){this.lb()}registerButtonClickedEvent(a){this.D3d&&k.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");
this.D3d=a.buttonClickedCallback}onFlyoutInitialized(){var a;this.m9d&&k.ULS.sendTraceTag(588129367,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const d=(new Date).getTime()-this.I2f.getTime();k.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",d);this.m9d=!0;(null===(a=l.AFrameworkApplication.K)||void 0===a?0:a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1))||mn.a.Eqb("ribbon","catchUp");
we.c(Sa.a.e5h,!0,void 0,void 0,void 0,d)}onFlyoutVisibilityChanged(a){this.D4c!==a.flyoutIsVisible&&(this.D4c=a.flyoutIsVisible,Lb.App.oa&&Lb.App.oa.updateCommandUI(!0),this.D4c&&this.Lph&&this.ib.wf(Ec.AFrame.o4b),this.D4c||this.Gwh&&this.Gwh.T_i())}logFlightTriggers(a){a.hasFlyoutData&&l.AFrameworkApplication.Yi("WoCha187;WoCha187cf")}lb(){this.ga.ma(Sa.a.nah,Cd.a.frame,Object(m.a)(this,this.UKm,"onToggleCatchUpFlyout"));this.ga.Aa(Sa.a.rQg,Cd.a.frame,Object(m.a)(this,this.AIm,"onQueryToggleCatchUpFlyout"),
96)}AIm(a,d,n,z,O){O[Yf.a.Visible]=!0;O[Yf.a.On]=this.D4c&&this.m9d;return 32}UKm(a,d,n){if(1===n)return this.m9d?(this.jyh||(this.jyh=!0,k.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.D3d)return k.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),8;this.Lph=!0;this.D3d();return 32}}Object(t.a)($e,"FlyoutRibbonButton",null,[625]);var me=b(139);class vf{constructor(a,d){this.KY=
null;this.DEe=this.zTi=!1;this.t3=a;this.Gf=d;this.iHb=new me.a;this.rEe=new Map;this.iHb.$(1,new qi.a(new Wk.a));this.iHb.$(0,new qi.a(new Wk.a));this.iHb.$(2,new qi.a(new Wk.a));this.iHb.$(3,new qi.a(new Wk.a));this.rEe.set(3,"CatchUpIndicatorVisible");this.rEe.set(1,"CatchUpIndicatorPreviewed");this.rEe.set(2,"CatchUpIndicatorSelected");this.MUe=0}u0i(a,d){if(this.iHb.J(d).add(a)){this.$nm(d);switch(d){case 0:k.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;
case 1:k.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");break;case 2:k.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:k.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.h6h()}}aIm(a){this.Sfl();a=this.t3.J9b(a);for(let d of a)if(this.KY.remove(d)){this.MUe++;break}}Sfl(){if(!this.KY){this.KY=new qi.a(new Wk.a);for(let a of this.t3.KY)this.KY.add(a)}}qBk(){k.ULS.sendTraceTag(590890074,377,50,
"Total number of renderable indicators: {0}",this.MUe);this.h6h()}h6h(){this.MUe&&(this.nQk(),this.$Pk())}nQk(){!this.zTi&&.5<=this.iHb.J(0).count/this.MUe&&(this.zTi=!0,we.c(Sa.a.g5h),k.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}$Pk(){if(!this.DEe){var a="";1<=this.iHb.J(1).count&&(this.DEe=!0,a="previews");1<=this.iHb.J(2).count&&(this.DEe=!0,a="selections");this.DEe&&(we.c(Sa.a.W4h),k.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",
a))}}$nm(a){(a=this.rEe.get(a))&&this.Gf.Lq(a,0)}}Object(t.a)(vf,"IndicatorTelemetryActor",null,[]);var Gg=b(574);b(936);class dg{constructor(a,d){this.Ntb=a;this.Xjd=d}kTl(){return this.Xjd.promise.then(a=>a.getWywaActivitiesResponse)}getActivities(a,d){return Gg.b(this.Ntb.requestActivities(a,d))}getRelevantActivities(a,d){return this.Xjd.promise.then(n=>n.getWywaActivitiesResponse.WywaWaterline===a?Promise.resolve(n.getRelevantActivitiesResponse):Gg.b(this.Ntb.requestRelevantActivities(a,d)))}getActivityFeed(){return this.Xjd.promise.then(a=>
void 0!==a.activityFeed?Promise.resolve(a.activityFeed):Gg.b(this.Ntb.requestActivityFeed()))}updateWaterline(){return Gg.b(this.Ntb.tqj())}}Object(t.a)(dg,"ActivityRepository",null,[]);var Hg=b(938);class ji{constructor(a){this.Cg=a}get ef(){return this.Cg&&this.Cg.gj?this.Cg:null}ukc(a,d){return this.ef?this.ef.Ole(a,!0)?this.ef.ukc(a,d,!0,!0):(k.ULS.sendTraceTag(579396803,377,15,"ScrollToHighlightParagraph: unable to scroll to desired paragraph"),null):null}}Object(t.a)(ji,"PageViewWrapper",null,
[]);const Xk=()=>l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCatchUpP1TelemetryEnabled",!1);class pl{constructor(a,d,n,z){this.activityContentManager=a;this.Tb=d;this.Dcl=n;this.Gf=z}Krm(a){if(Xk()){var d=new Map;d.set("activityType",a.type.toString());this.Gf.Lq("CatchUpNavigateToActivity",0,{extendedProperties:d})}}cxg(a){Xk()&&this.Gf.fl("CatchUpNavigateToActivity",a,null,{name:"CatchUpExperienceDegraded",Zo:"NavigateToActivityFailed"})}Hym(a){try{const d=a.activity;
this.Krm(a.activity);if(!this.activityContentManager.doesContentExist(d))return this.activityContentManager.WHn(d),this.cxg("Content does not exist"),Promise.resolve(2);const n={};let z=0;switch(d.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:n.ActivityId=d.activityId;n.NavigationId=atob(d.navigationId);z=this.Tb.ob(Sa.a.ild,2,n);break;case 1:n.Activity=d,n.NodeId=a.locationId,z=this.Tb.ob(Dc.a.G5g,2,n),n.NodeId&&this.Tb.ob(Dc.a.iKe,2,n)}8==z&&this.cxg("Action failed")}catch(d){return k.ULS.sendTraceTag(592237846,
3012,10,"Exception thrown trying to navigate to an activity. {0}",d),this.cxg("Exception was thrown"),Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(a){return this.Dcl.mZb.then(()=>this.Hym(a))}}Object(t.a)(pl,"WordActivityNavigationManager",null,[623]);var mk;(function(a){a[a.default=0]="default";a[a.D48X48=1]="D48X48";a[a.D64X64=2]="D64X64";a[a.D96X96=3]="D96X96";a[a.D120X120=4]="D120X120";a[a.D240X240=5]="D240X240";a[a.D360X360=6]="D360X360";a[a.D432X432=7]="D432X432";a[a.D504X504=
8]="D504X504";a[a.D648X648=9]="D648X648"})(mk||(mk={}));Object(t.b)("ProfilePhotoDimension",mk);var sm=b(719),Ao=b(1276),Tq=b(555);class Br{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(t.a)(Br,"ActivityRequestPayload",null,[]);class yl{constructor(){this.color=this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(t.a)(yl,"Person",null,[]);class fv extends yn{constructor(){super();
this.relationship=0}}Object(t.a)(fv,"TaskActivity",yn,[]);class tm extends yn{constructor(){super();this.contentId=null}}Object(t.a)(tm,"CommentActivity",yn,[]);class Cr extends tm{constructor(){super()}}Object(t.a)(Cr,"CommentReplyActivity",tm,[]);class ns extends tm{constructor(){super();this.Ddj=null}}Object(t.a)(ns,"MentionActivity",tm,[]);class im{constructor(a,d,n,z){this.dqc=a;this.dAb=d;this.zrf=n;this.iU=z;this.iU.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.dqc.kTl().then(a=>
{if(!a||a.StatusCode&&155!==a.StatusCode)throw this.TRf("GetWYWAActivities",a);155===a.StatusCode&&(k.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.iU.isFirstDocumentOpen=!0);const d=this.Wah(a.People);return Object.assign(new Br,{activities:this.l2e(a.Activities,d),actors:d,hasMore:!a.AllWYWA,highWaterline:a.HighWaterline,lowWaterline:a.LowWaterline,wywaWaterline:a.WywaWaterline,isFirstDocumentOpen:155===a.StatusCode})})}requestActivities(a,d){return this.dqc.getActivities(a,
d).then(n=>{if(!n||n.StatusCode)throw this.TRf("GetActivities",n);const z=this.Wah(n.People);return Object.assign(new Br,{activities:this.l2e(n.Activities,z),actors:z,hasMore:!n.RequestedRetrieved,highWaterline:n.HighWaterline,lowWaterline:n.LowWaterline})})}requestRelevantActivities(a){return this.dqc.getRelevantActivities(a,this.iU.isFirstDocumentOpen).then(d=>{if(!d||d.StatusCode)throw this.TRf("GetRelevantActivities",d);const n=this.Wah(d.People),z=this.l2e(d.NewActivities,n,2);d=this.l2e(d.OutstandingActivities,
n,3);for(let O of d)z.push(O);return Object.assign(new Br,{activities:z,actors:n})})}requestActivityFeed(){return this.dqc.getActivityFeed().then(a=>({activityFeedItems:a}))}l2e(a,d,n=1){const z=[];if(!a)return z;for(let Da of a){var O=null;a=[];a.push(d[Da.CreatorIndex]);switch(Da.ActivityType){case 1:O=Da;var ca=new Dm;ca.Bv=new db.a;for(let Xa of O.ChangeIds)ca.Bv.add(jc.b(Xa));ca.objectId=jc.b(O.ObjectId);O=ca;break;case 2:O=Da;ca=new tm;ca.contentId=O.ContentId;ca.navigationId=O.NavigationId;
O=ca;break;case 4:O=Da;ca=new ns;a.push(d[O.MentioneeIndex]);ca.Ddj=O.ParentContentId;ca.navigationId=O.NavigationId;O=ca;break;case 3:case 10:O=Da;ca=new Cr;a.push(d[O.RepliedIndex]);ca.contentId=O.ContentId;ca.navigationId=O.NavigationId;O=ca;break;case 6:case 7:case 8:case 9:O=Da,ca=new fv,a.push(d[O.MentioneeIndex]),ca.navigationId=O.NavigationId,ca.relationship=O.Relationship,O=ca}O&&(O.actors=a,O.displayTimestamp=new Date(Da.DisplayTimestamp),O.activityId=jc.b(Da.ActivityId).toString(),O.type=
Da.ActivityType,1!==n&&(O.relevancy=n),z.push(O))}return z}gcn(a,d,n){return this.zrf&&!ze.b(a)&&this.zrf.MHe?this.zrf.iCc(d,n,l.AFrameworkApplication.Fk,mk.default):a}Wah(a){if(!a)return null;const d=Array(a.length);for(let n=0;n<a.length;n++){if(!a[n])continue;const z=new yl;z.id=a[n].Id;z.provider=a[n].Provider;z.displayName=a[n].DisplayName;z.email=a[n].Email;z.imageUrl=this.gcn(a[n].PictureUrl,a[n].Email,a[n].Provider);this.dAb&&(z.color=this.dAb.axd(new sm.a(z.email,void 0,z.displayName),Ao.a.catchUpFlyout));
d[n]=z}return d}TRf(a,d){let n="null";d&&(n=Tq.a[d.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",a,n))}}Object(t.a)(im,"WordActivityRequestManager",null,[622]);class Fu{constructor(a,d,n){this.oae=0;this.bad=!1;this.nDh=null;this.va=a;this.dqc=n;d.VCf(()=>{this.bad=!0;this.nDh=new Date;this.oae=0})}start(){this.sWe()}updateWaterline(){if(Lb.App.lostSession)k.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");else if(this.bad||
3>=this.oae){this.bad?this.bad=!1:this.oae++;const a=Math.max(this.va.jb("WordEditorActivityManagementMaturityMiliSeconds",30001)+5E3-(+new Date-+this.nDh),0);k.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",a);Jh.Task.delay(a).continueWith(()=>{this.dqc.updateWaterline().then(()=>{this.sWe();return null}).catch(()=>{this.sWe();this.bad=!0;this.oae=0})})}else this.sWe()}sWe(){window.setTimeout(Object(m.a)(this,this.updateWaterline,"updateWaterline"),6E4)}}Object(t.a)(Fu,"WordEditorActivityScheduler",
null,[]);class Dr{constructor(){this.resolve=null;this.promise=new Promise(a=>{this.resolve=a})}cjn(a){this.resolve(a)}}Object(t.a)(Dr,"CatchUpNetworkRequestWorkerCache",null,[]);class Gs{constructor(a,d){this.k6k=a;this.K=d}bKg(a){a&&a.authors&&this.Xnm(a.authors)}Xnm(a){for(let d of a)d&&d.displayName===this.k6k&&(Object(Ik.a)(),ja.Health.instance.recordQosError("CatchUpShowsChangesFromCurrentAuthor",["CatchUpExperienceDegraded"],!1,!1,!0,!1,null),k.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",
d.id===this.K.Ga("PresenceUserId"),d.email===this.K.Ga("UserPrincipalName")))}}Object(t.a)(Gs,"WywaAuthorComparator",null,[]);class Vn{constructor(a){this.lJi=!1;this.kDa=a}Oxg(){this.kDa&&!this.lJi&&(this.kDa.execute(a=>a.logActivity("CatchUpIndicatorSurveyNomination",null)),this.lJi=!0)}}Object(t.a)(Vn,"IndicatorSurveyActor",null,[]);var Pp=b(917),Qr=b(908);class ap{constructor(){this.n4b=this.container=null;this.POk={fjb:"webasynccollabeng",featureName:"CatchUp",GUc:"CatchUpFeatureUsage",gpc:7}}get name(){return"WordEditor.CatchUpActivity"}get NOk(){return l.AFrameworkApplication.K.ea("CatchUpActivityIsEnabled")}get Hmg(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ChangeSummariesEnabled",
!1)}get QQi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get xQi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",!1)}get Qlg(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get ahm(){return l.AFrameworkApplication.K.ea("IsUserFromDifferentTenant")}Hb(a){Tk("Configure");this.container=
a;a.ha("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache",()=>new Dr).singleInstance()}init(){Tk("Init");this.NOk&&(M.a.instance.registerOnPackageInit("WordEditor.Workers",()=>{this.container.resolve("Box4.Workers.IWebWorkerRouter").Eh(2,4,l.AFrameworkApplication.rootQuerySignature,Lb.App.webServiceBase+"OneNote.ashx",2,this.Qlg)}),Tk("HotStore"),Lb.App.Eoa.Qac.execute(()=>{Tk("ChromeReady");Bi.a.get_instance().Ik(7,()=>{Tk("ScriptDownload");(l.AFrameworkApplication.K.ea("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve("Common.IDynamicScriptLoaderProvider").uG.loadScript("catchUpActivity")).catch(a=>{k.ULS.sendTraceTag(592233361,377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",a)}).then(()=>this.dDm()).catch(a=>{k.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",a)})})}))}dDm(){Tk("CreateObjectsAndInitializeState");this.gnm();this.$Zk();return this.m3l()}gnm(){k.ULS.sendTraceTag(592217358,
377,50,"CatchUpActivity feature enabled successfully");k.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");k.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled");this.Hmg&&k.ULS.sendTraceTag(588130079,3012,50,"ChangeSummaries is enabled");this.QQi&&k.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");this.xQi&&k.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");k.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",
this.ahm);this.Qlg&&k.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}m3l(){this.M3l();this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").I2f=new Date;Tk("InitializeCatchUpApp");return this.n4b.initialize(Object.assign(new zr,{featuredActivityGroupsEnabled:this.Hmg,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.QQi,customDynamicEntryPointEnabled:this.xQi,activityFeedDataEnabled:this.Qlg})).then(()=>{this.container.resolve("WordEditor.CatchUpActivity.WordEditorActivityScheduler").start()})}$Zk(){this.container.ha("WordEditor.CatchUpActivity.ChangeIdCache",
()=>new dq(this.container.resolve("WordEditor.CatchUpActivity.IChangeIdObjectIdCache"),Rj.App.wn.za.Rb.xc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger",()=>new Pp.a(ja.Health.instance,new Qr.a,this.POk)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IActivityStateManager",()=>new xl).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityContentManager",()=>new jj(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
l.AFrameworkApplication.pa,xk.UISurfaces.oK(),l.AFrameworkApplication.K.ea("CatchUpFlyoutMockDataIsEnabled"))).as("Common.App.CatchUpActivity.IActivityContentManager").singleInstance();this.container.ha("WordEditor.CatchUpActivity.Network.ActivityRepository",()=>new dg(new Hg.a(Ph.a.eJj(this.container.Ca("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper")),()=>l.AFrameworkApplication.rootQuerySignature,Lb.App.webServiceBase+"OneNote.ashx",2,Ph.a.eJj(this.container.Ca("Common.App.CatchUpActivity.ICatchUpRequestHandler"))),
this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityRequestManager",()=>new im(this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"),this.container.resolve("Common.App.People.IPeopleColorUtils"),this.container.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),l.AFrameworkApplication.K.ea("CatchUpFlyoutMockDataIsEnabled"))).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightManager",()=>new lb(this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),Rj.App.wn.za.Rb,new ji(Rj.App.wn.za.Rb),Lg.a.instance,ic.FocusManager.instance(),this.container.resolve("Common.Utils.IAriaNotifier"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.DocumentTraverser",
()=>{let a;a=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new qm(50,Ye.a.me):new Bm;return new zj(l.AFrameworkApplication.tb,a,Rj.App.wn.za.Rb.xc)}).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityNavigationManager",()=>new pl(this.container.resolve("WordEditor.CatchUpActivity.ActivityContentManager"),l.AFrameworkApplication.pa,this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),
this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),l.AFrameworkApplication.K.ea("CatchUpFlyoutMockDataIsEnabled"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.FlyoutRibbonButton",()=>new $e(l.AFrameworkApplication.pa,this.container.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"),ic.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutRibbonButton").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FlyoutFocus",()=>
new Oo(lk.a.instance,ic.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutFocus").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupCache",()=>new kg).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorHelper",()=>new Wh(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),Rj.App.wn.za.Rb)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor",
()=>new sh(this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IChangeSummariesDataProvider",()=>new vc(new hd(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor")),new Cb(this.container.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.container.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.container.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
l.AFrameworkApplication.tb),new cf(this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper")),this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"),l.AFrameworkApplication.K.ea("CatchUpFlyoutMockDataIsEnabled"))).singleInstance();this.n4b=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new ir,{activityContentManager:this.container.resolve("Common.App.CatchUpActivity.IActivityContentManager"),
activityNavigationManager:this.container.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),activityRequestManager:this.container.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),appColorUpdateIsEnabled:l.AFrameworkApplication.K.ea("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve("Common.App.CatchUpActivity.IChangeSummariesDataProvider"),dataCulture:l.AFrameworkApplication.dataCulture,flyoutRibbonButton:this.container.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),
flyoutFocus:this.container.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),uiCulture:l.AFrameworkApplication.uiCulture,ulsLogger:new No.a}));this.n4b.setWebpackPublicPath(l.AFrameworkApplication.BQ);this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightActor",()=>new An(this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WordEditorActivityScheduler",
()=>new Fu(l.AFrameworkApplication.K,Cm.a.instance,this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorTelemetryActor",()=>new vf(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorSurveyActor",()=>new Vn(this.container.Ca("Common.ISystemInitiatedFeedback"))).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorActor",()=>new Rg(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.n4b.getActivityIndicatorTooltipManager(),this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),Rj.App.wn.za.Rb,this.container.Ca("Common.IZoomManager"),l.AFrameworkApplication.tb,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper"),
!!Lb.App.instance&&Lb.App.instance.Bsa)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorManager",()=>new Sj(this.container.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,Rj.App.wn.za.Rb.xc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor"),l.AFrameworkApplication.pa,this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.ActivityAnnouncementManager",()=>new tq(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("Common.Utils.IAriaNotifier"),l.AFrameworkApplication.pa,ic.FocusManager.instance())).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WywaAuthorComparator",()=>new Gs(l.AFrameworkApplication.userName,l.AFrameworkApplication.K)).singleInstance()}M3l(){var a=this.container.resolve("Box4.Highlight.IHighlightManager"),
d=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightActor");a.LLb(d);const n=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightManager");a=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager");const z=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor");d=this.container.resolve("WordEditor.CatchUpActivity.ActivityAnnouncementManager");const O=this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),
ca=Lg.a.instance,Da=this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser");ca.dE(()=>{O.HGe?O.HGe=!1:(O.ftb&&n.Kaj(null,null,!1),O.KGb&&n.daj(null,null),z.YLf())});ca.dE(Object(m.a)(d,d.H0,"onSelectionChanged"));this.n4b.getWywaEvent().addListener(Object(m.a)(a,a.bKg,"onWywaActivityReady"));a=this.container.resolve("WordEditor.CatchUpActivity.WywaAuthorComparator");this.n4b.getWywaEvent().addListener(Object(m.a)(a,a.bKg,"onWywaActivityReady"));Da.Kyk((Xa,zb)=>{zb&&this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor").aIm(zb.node)});
Da.mZb.then(()=>{this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor").qBk()});this.n4b.getWywaEvent().addListener(()=>{Da.NGk()});z.uxk((Xa,zb)=>{zb&&n.daj(zb.d8b,zb.uMi)});z.vxk((Xa,zb)=>{zb&&n.Kaj(zb.d8b,zb.uMi,zb.Ksn)});z.lb(l.AFrameworkApplication.pa);this.Hmg&&this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor").lb(l.AFrameworkApplication.pa);this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").initialize();this.container.resolve("WordEditor.CatchUpActivity.FlyoutFocus").initialize();
this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager").initialize();this.Uvn()}Uvn(){xh.c()&&(k.ULS.sendTraceTag(591673372,3012,50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(t.a)(ap,"WordEditorCatchUpActivityPackageManager",null,[1,2]);var Hs=b(1315),jr=b(443),os=b(1430),bp=b(1314),ps=b(1512),Qp=b(1431),Vl=b(599),U=b(141),Ea=b(323),kb=b(773),
Nb=b(176),nc=b(1327);class ad{constructor(){this.qD=this.annotation=null}}Object(t.a)(ad,"AnnotationChangedData",null,[]);class Od{constructor(a,d,n,z,O,ca,Da,Xa=!1,zb){this.annotationType=a;this.YQa=d;this.nm=n;this.g0e=z;this.G0d=O;this.HQn=ca;this.za=Da;this.EAj=Xa;this.K=zb;this.dF=null;this.BTi=!1;this.Zc=new oc.a;this.mJd=0}jP(a){this.Zc.addHandler("AnnotationChangedEvent",a)}aT(a){this.Zc.removeHandler("AnnotationChangedEvent",a)}register(){return this.G0d().then(()=>{0===this.mJd&&(this.EAj&&
(this.dF=this.nm.Pe("WebServiceCall",this.annotationType)),this.YQa.Ea(this,this.annotationType));this.mJd++})}unregister(){return this.G0d().then(()=>(new Promise(a=>setTimeout(a,this.K.jb(Nb.a.$9k,3E3)))).then(()=>{0<this.mJd&&(this.mJd--,0===this.mJd&&this.YQa.kb(this,this.annotationType))}))}Rsd(){return this.G0d().then(()=>this.YQa.getAnnotationsByType(this.annotationType))}jsl(a){a=Ea.a.L9b(a);return(a=this.YQa.$si(a))&&0<a.count?a.toArray().filter(d=>Gj.a.matchesTypesFor(d.content,[this.annotationType])):
[]}getParent(a){return a?a.parent?a.parent:a.parentPath?this.HQn(this.za.jc.kd,a.parentPath):null:(k.ULS.shipAssertTag(575930380,3016,!1),null)}lra(a){a.timestamp||(a.timestamp=Date.now());a=Object.assign(new kb.a,{parentPath:["Signal",Gj.a.getTypeNameFor(a)],items:[Object.assign(new Sq.a,{body:a})]});this.g0e.submitOperation(a)}oel(a,d){a=Object.assign(new Jn.a,{parentPath:["Signal",d],items:[Object.assign(new Sq.a,{body:a})]});this.g0e.submitOperation(a)}sS(a,d){a?d?(this.EAj&&!this.BTi&&(this.dF.stop(),
this.BTi=!0),this.Zc.j4&&(a=new nc.a(Object.assign(new ad,{annotation:a,qD:d})),this.Zc.raiseEvent("AnnotationChangedEvent",a))):k.ULS.shipAssertTag(575930382,3016,!1):k.ULS.shipAssertTag(575930381,3016,!1)}}Object(t.a)(Od,"AnnotationManager",null,[663,280]);class af{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb){this.s0c=a;this.Ylk=d;this.P9j=n;this.Usc=z;this.hyb=O;this.hBb=ca;this.$pk=Da;this.Zpk=Xa;this.P7j=zb;this.pkk=Vb}get zN(){return this.s0c}get TVe(){return this.Ylk}get rsd(){return this.P9j}get glb(){return this.Usc}get Ala(){return this.hyb}get rYd(){return this.hBb}get Foa(){return this.$pk}get Gnc(){return this.Zpk}get sDc(){return this.P7j}get kic(){return this.pkk}}
Object(t.a)(af,"AnnotationManagerHolder",null,[662]);class ve{constructor(a,d){this.bBk=a;this.G0d=d}submitOperation(a){return this.G0d().then(()=>{this.bBk.getAugLoopRuntimeManager().submitOperation(Object.assign(new Na.a,{operation:a}))})}}Object(t.a)(ve,"SubmitOperationHelper",null,[]);var eh=b(786),Ci=b(1513),Hj=b(934),Bf=b(65),Vi=b(115),Lj=b(86);class ro{constructor(a,d,n){this.Ala=a;this.Fq=d;this.ZPe=n;this.DSa={};this.Whi=!1;this.XJb=(z,O)=>{O.data.qD===Jn.a.getTypeName()&&O.data.annotation&&
O.data.annotation.annotationType===Ci.a.getTypeName()&&(z=O.data.annotation.content)&&z.documentTypeConfidences.length&&(this.Vhi=z.documentTypeConfidences[0].documentTypeLabel,k.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",this.Vhi))};this.Ala.jP(this.XJb);this.Ala.register();this.DSa={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}Uud(){this.Whi||
(this.Ala.lra(new Hj.a),k.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.Whi=!0);this.acl();this.DSa.docType=this.Vhi;this.DSa.characterCount=this.characterCount;this.DSa.paragraphCount=this.s8;this.DSa.imageCount=this.rma;this.DSa.tableCount=this.tDa;this.DSa.listElementsCount=this.RXi;this.DSa.blobsCount=this.I0h;this.DSa.pageCount=this.ZPe.Vwd();this.DSa.currentPage=this.ZPe.CBi();return this.DSa}acl(){this.s8=this.I0h=this.RXi=this.tDa=this.rma=this.characterCount=
0;var a=this.Fq.CTa(Rj.App.wn.za.Rb.xc,7,7).currentNode,d=Dd.GraphIterator.ua(a);for(a=Yi.a.Yo(d,a);a.moveNext();)if(d=a.currentNode)if(Kd.ImageReader.Xr(d))this.rma++;else if(If.TableReader.GS(d))this.tDa++;else if(Bf.ListReader.rY(d))this.RXi++;else if(Bd.ParagraphReader.nb(d)){var n=Lj.e(d);for(let z=0;z<n.length;z++)5===n[z].Qf?this.rma++:this.I0h++;n=Vi.AParagraphNode.V0(d.characterData);n=n.trim();this.characterCount+=n.length;0<n.length&&!Bd.ParagraphReader.Xba(d)&&!Bd.ParagraphReader.eV(d)&&
this.s8++}}}Object(t.a)(ro,"LoggingDocumentInfo",null,[635]);class gq{constructor(){this.ka=new oc.a}Zyk(a){this.ka.addHandler("OnTaskPaneReviewStateChanged",a)}c8m(a){this.ka.removeHandler("OnTaskPaneReviewStateChanged",a)}lyk(a){this.ka.addHandler("BlueDotClickedEvent",a)}Q7m(a){this.ka.removeHandler("BlueDotClickedEvent",a)}uyk(a){this.ka.addHandler("OnFormattingMarkedForReview",a)}wyk(a){this.ka.addHandler("OnFormattingReviewCompleted",a)}tyk(a){this.ka.addHandler("OnFormattingAccept",a)}vyk(a){this.ka.addHandler("OnFormattingReject",
a)}Syk(a){this.ka.addHandler("OnReviewInvalidated",a)}LWh(a){this.ka.addHandler("OnTraigeAction",a)}UCf(a){this.ka.addHandler("OnReviewVisibilityChanged",a)}X7m(a){this.ka.removeHandler("OnReviewVisibilityChanged",a)}kyk(a){this.ka.addHandler("OnBeforeReviewNavigation",a)}Oyk(a){this.ka.addHandler("OnRegisterEnhancement",a)}azk(a){this.ka.addHandler("onTooltipVisibilityChanged",a)}d8m(a){this.ka.removeHandler("onTooltipVisibilityChanged",a)}bPd(a){a?this.ka.raiseEvent("OnTaskPaneReviewStateChanged",
new nc.a(a)):k.ULS.shipAssertTag(575930374,3016,!1)}QYm(a){a?this.ka.raiseEvent("BlueDotClickedEvent",new nc.a(a)):k.ULS.shipAssertTag(575930375,3016,!1)}TYm(a){a?this.ka.raiseEvent("OnFormattingMarkedForReview",new nc.a(a)):k.ULS.shipAssertTag(575930376,3016,!1)}VYm(a){a?this.ka.raiseEvent("OnFormattingReviewCompleted",new nc.a(a)):k.ULS.shipAssertTag(573850377,3016,!1)}SYm(a){a?this.ka.raiseEvent("OnFormattingAccept",new nc.a(a)):k.ULS.shipAssertTag(575930377,3016,!1)}UYm(a){a?this.ka.raiseEvent("OnFormattingReject",
new nc.a(a)):k.ULS.shipAssertTag(575930378,3016,!1)}WYm(a){a?this.ka.raiseEvent("OnReviewInvalidated",new nc.a(a)):k.ULS.shipAssertTag(575930379,3016,!1)}PQg(a){a?this.ka.raiseEvent("OnTraigeAction",new nc.a(a)):k.ULS.shipAssertTag(573850378,3016,!1)}Wij(a){a?this.ka.raiseEvent("OnReviewVisibilityChanged",new nc.a(a)):k.ULS.shipAssertTag(573850379,3016,!1)}PYm(a){a?this.ka.raiseEvent("OnBeforeReviewNavigation",new nc.a(a)):k.ULS.shipAssertTag(573687395,3016,!1)}Hic(a){a?this.ka.raiseEvent("OnRegisterEnhancement",
new nc.a(a)):k.ULS.shipAssertTag(555055117,3016,!1)}mjj(a){a?this.ka.raiseEvent("onTooltipVisibilityChanged",new nc.a(a)):k.ULS.shipAssertTag(540587343,3016,!1)}}Object(t.a)(gq,"ReviewEvents",null,[614]);class xq{constructor(a){this.Z=null;if(!a)throw U.a.argument("Workspace is null");this.xs=a}get name(){return"WordEditor.Designer.Common"}init(){}Hb(a){a?(this.Z=a,a.ha("WordEditor.Designer.Common.AL.ISubmitOperationHelper",()=>new ve(this.Z.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),Ea.a.ar)).singleInstance(),
a.ha("WordEditor.Designer.IDesignerControl",()=>new eh.a(a.resolve("Box4.IFeatureHelper"),a.resolve("Common.IAppSettingsManager"),l.AFrameworkApplication.uiCulture)).singleInstance(),a.ha("WordEditor.Designer.Common.Review.IReviewEvents",()=>new gq).singleInstance(),a.ha("WordEditor.Designer.Common.AL.IAnnotationManagerHolder",()=>new af(this.l3a(bp.DocumentRoleDetectionAnnotation.getTypeName()),this.l3a(bp.RoleDetectionAnnotation.getTypeName()),this.l3a(Hs.FormattingSuggestionsSummaryAnnotation.getTypeName(),
!0),this.l3a(Hs.FormattingSuggestionsAnnotation.getTypeName()),this.l3a(jr.DocumentTypeClassifierAnnotation.getTypeName()),this.l3a(Qp.ThemeExtractorAnnotation.getTypeName()),this.l3a(Vl.ThemeGeneratorAnnotation.getTypeName()),this.l3a(ps.TextToImageAnnotation.getTypeName()),this.l3a(os.DocumentPullQuoteAnnotation.getTypeName()),this.l3a(os.PullQuoteAnnotation.getTypeName()))).singleInstance(),a.ha("WordEditor.Designer.DocumentInfo",()=>new ro(a.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Ala,
a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("WordEditor.IPageNumberFinder"))).singleInstance()):k.ULS.shipAssertTag(575767060,3016,!1)}dispose(){}l3a(a,d=!1){return new Od(a,this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.Z.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),Ea.a.ar,Ea.a.bmb,this.xs,d,this.Z.resolve("Common.IAppSettingsManager"))}}Object(t.a)(xq,"PackageManager",null,[1,2]);
var Rp=b(1337),lt=b(1303),Is=b(1514);class gv extends Sys.EventArgs{constructor(a,d){super();this.node=a;this.kEg=d}}Object(t.a)(gv,"RoleChangeArgs",Sys.EventArgs,[]);class Wn{constructor(a){this.gf=!1;this.gN=a;this.gN.P8d++}dispose(){this.gf||(this.gf=!0,this.gN.P8d--)}}Object(t.a)(Wn,"InvalidationSuspension",null,[12]);class Ig{constructor(){this.yXd=null;this.role=this.ILe=0;this.h3b=this.TGe=this.SAa=this.fFd=!1;this.$yg=this.aLe=this.flb=null;this.placeholder=!1;this.imageId=null;this.removed=
!1;this.TSf=null}get FHb(){return!this.role||!this.flb||!this.flb.length}d7l(){this.h3b=this.TGe=!0}mhm(){return!!this.role||!!this.flb||!!this.yXd}}Object(t.a)(Ig,"RoleState",null,[334]);class $m{constructor(a,d,n,z,O){this.wh=!1;this.zEe=null;this.Zyg=new cg.a;this.Tyh=0;this.edn=(ca,Da)=>{Da.data.qD===Jn.a.getTypeName()&&(Da=Da.data.annotation,(ca=Da.content)?(Da=this.gwc.getParent(Da))&&this.E1g(Da,lt.e(ca.roleType),!1,void 0,null!=ca.listID?ca.listID:0,ca.listItemlevel,ca.listItemPrefix):k.ULS.shipAssertTag(575813856,
3016,!1))};this.zcl=(ca,Da)=>{if(Da.data.qD===Jn.a.getTypeName())if(ca=Da.data.annotation.content)for(k.ULS.sendTraceTag(556074199,3016,50,ca.confidence.toString()),this.Zyg=new cg.a,Da=0;ca.listInfos&&Da<ca.listInfos.length;Da++){const Xa=ca.listInfos[Da];this.Zyg.$(Xa.listID,Xa)}else k.ULS.shipAssertTag(556323522,3016,!1)};this.JSi=(ca,Da)=>{ca=ca.JO;if(!ca||ca.fa(Qb.a.CCc,!1))return!1;ca=ca.getValue(Qb.a.w1);if(!ca)return!1;ca=lt.f(ca);return 1!=ca&&ca!=Da.role};this.Qol=(ca,Da)=>{ca=Da.data.annotation;
const Xa=this.Usc.getParent(ca);if(Xa)if(Da.data.qD===Jn.a.getTypeName()){const zb=Da.data.annotation.content;zb?this.joa(Xa,Vb=>{this.zEe&&Vb.TSf&&this.zEe>Vb.TSf&&!Vb.h3b||Vb.role!==Vb.ILe||this.JSi(Xa,Vb)?(k.ULS.sendTraceTag(572301727,3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",this.zEe,Vb.h3b,Vb.role===Vb.ILe),Vb.yXd=zb.suggestions):(Vb.flb=zb.suggestions,Vb.h3b=!1)}):k.ULS.shipAssertTag(575813859,3016,!1)}else Da.data.qD===Rp.a.getTypeName()&&this.joa(Xa,
zb=>{zb.flb=null;zb.yXd=null});else k.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${ca.id} parentPath: ${ca.parentPath}`)};this.tFm=(ca,Da)=>{(ca=Da.data.paragraphNode)?this.joa(ca,Xa=>{Xa.SAa=!0}):k.ULS.shipAssertTag(575930368,3016,!1)};this.vFm=(ca,Da)=>{(ca=Da.data.paragraphNode)?this.joa(ca,Xa=>{Xa.SAa=!1;5!==Da.data.state&&(Xa.flb=null)}):k.ULS.shipAssertTag(573850380,3016,!1)};this.rFm=(ca,Da)=>{(ca=Da.data.paragraphNode)?this.joa(ca,Xa=>{Xa.SAa=!0}):k.ULS.shipAssertTag(575930369,
3016,!1)};this.uFm=(ca,Da)=>{(ca=Da.data.paragraphNode)?this.E1g(ca,1,!0,!0):k.ULS.shipAssertTag(575930370,3016,!1)};this.LJg=(ca,Da)=>{(ca=Da.data.paragraphNode)?this.E1g(ca,Da.data.kEg,!0,!0):k.ULS.shipAssertTag(575484484,3016,!1)};this.iUl=(ca,Da)=>{if(Da.node){var Xa=Da.node;ca=this.XP(Xa);27==ca.role&&k.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");ca.SAa&&27!==ca.role&&28!==ca.role&&this.Tzj(this.pMb-1);ca.FHb||27===ca.role||28===ca.role||this.Nzj(this.inconsistenciesCount-
1);this.joa(Xa,zb=>{zb.removed=!0});setTimeout(()=>this.removeNode(Xa),1E4)}else k.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=ca=>{let Da;({value:Da}=this.Qs.Ab(ca.id));(null===Da||void 0===Da?0:Da.removed)&&this.Qs.remove(ca.id)};this.hUl=(ca,Da)=>{Da.node?(ca=Da.node,this.yGe(ca)?this.joa(ca,Xa=>{Xa.removed=!1}):this.joa(ca,Xa=>{Xa.h3b=!1})):k.ULS.shipAssertTag(540672206,3016,!1)};this.jUl=(ca,Da)=>{Da.node?this.f4g(Da.property,Da.node)&&(ca=Da.node,this.P8d||ca.jPc?this.joa(ca,Xa=>{Xa.h3b=
!1}):this.joa(ca,Xa=>{Xa.d7l();Xa.yXd&&(Xa.flb=Xa.yXd,Xa.role=Xa.ILe)}).SAa&&this.dfb.WYm(new Is.a(Da.node))):k.ULS.shipAssertTag(575930372,3016,!1)};this.OIm=(ca,Da)=>{switch(Da.data.role){case 27:const Xa=Da.data;this.joa(Da.data.paragraphNode,Vb=>{Vb.role=27;Vb.fFd=!0;Vb.placeholder=Xa.placeholder});break;case 28:const zb=Da.data;this.joa(Da.data.paragraphNode,Vb=>{Vb.role=28;Vb.fFd=!0;Vb.placeholder=zb.placeholder;Vb.imageId=zb.imageId});break;case 2:this.joa(Da.data.paragraphNode,Vb=>{Vb.role=
2})}};this.Usc=a;this.gwc=d;this.kdf=n;this.Nm=z;this.dfb=O;this.Qs=new cg.a;this.ka=new oc.a;this.P8d=this.yde=this.x8d=0}get s7l(){return this.P8d}yyk(a){this.ka.addHandler($m.T9i,a)}Tyk(a){this.ka.addHandler($m.yaj,a)}EWh(a){this.ka.addHandler($m.YIg,a)}Y7m(a){this.ka.removeHandler($m.YIg,a)}get inconsistenciesCount(){return this.x8d}Nzj(a){this.x8d!==a&&(this.x8d=a,this.ka.raiseEvent($m.T9i,new nc.a(this.x8d)))}get pMb(){return this.yde}Tzj(a){this.yde!==a&&(this.yde=a,this.ka.raiseEvent($m.yaj,
new nc.a(this.yde)))}get ihg(){return this.Tyh}yGe(a){return this.Qs.Na(a.id)}CFl(a){var d,n;return null===(n=null===(d=this.Zyg)||void 0===d?void 0:d.Ab(a))||void 0===n?void 0:n.value}yJl(a){var d=new Set([2,3]),n,z,O;const ca=new Map;for(const Da of a)if(a=Da){const Xa=null!==(O=null===(z=null===(n=this.Qs.Ab(a.id))||void 0===n?void 0:n.value)||void 0===z?void 0:z.role)&&void 0!==O?O:1;d.has(Xa)&&(ca.has(Xa)?ca.get(Xa).add(a):ca.set(Xa,new db.a([a])))}return ca}XP(a){if(!a)return k.ULS.shipAssertTag(575813855,
3016,!1),null;let d;return({value:d}=this.Qs.Ab(a.id)).returnValue?d:Object.assign(new Ig,{role:1,fFd:!1})}R$m(){this.zEe=new Date;return new Wn(this)}register(){this.Usc.register();this.gwc.register();this.kdf.register()}unregister(){this.Usc.unregister();this.gwc.unregister();this.kdf.unregister()}initialize(){if(!this.wh){const a=this.Nm.Oe(12);a.vy(this.iUl);a.Rt(this.hUl);a.tq(this.jUl);this.Usc.jP(this.Qol);this.gwc.jP(this.edn);this.kdf.jP(this.zcl);this.dfb.vyk(this.uFm);this.dfb.tyk(this.rFm);
this.dfb.uyk(this.tFm);this.dfb.wyk(this.vFm);this.dfb.LWh(this.LJg);this.dfb.Oyk(this.OIm);this.wh=!0}}Ae(){}E1g(a,d,n,z=!1,O=0,ca=0,Da){let Xa=0,zb=!1;this.joa(a,Vb=>{const Fc=Vb.TGe||!Vb.role;n||(Vb.ILe=d);if(z||Fc)zb=Vb.role!==d,Xa=Vb.role,Vb.role=d,Vb.fFd=n,Vb.TGe=!1,Vb.aLe=O,Vb.$yg=ca,Vb.listItemPrefix=Da,Vb.TSf=new Date});if(zb){const Vb=d-4;Vb>this.ihg&&8>Vb&&(this.Tyh=Vb);1===d&&this.joa(a,Fc=>{Fc.flb=null});this.ka.raiseEvent($m.YIg,new nc.a(new gv(a,d,Xa)))}}joa(a,d){let n;if(({value:n}=
this.Qs.Ab(a.id)).returnValue){a=n.FHb;const z=n.SAa;d(n);if(27!==n.role&&28!==n.role){if(n.removed)return n;a!==n.FHb&&this.Nzj(this.inconsistenciesCount+(a?1:-1));z!==n.SAa&&this.Tzj(this.pMb+(z?-1:1))}}else d(n=new Ig),n.mhm()&&this.Qs.add(a.id,n);return n}f4g(a,d){({value:d}=this.Qs.Ab(d.id));return 28===(null===d||void 0===d?void 0:d.role)?!(null===d||void 0===d?0:d.placeholder)&&a===Vd.a.wk:!(null===d||void 0===d?0:d.placeholder)&&(a===Vd.a.wk||a===Vd.a.qn||Array.contains(Vi.AParagraphNode.WL(),
a))}}$m.T9i="OnInconsistenciesChanged";$m.yaj="OnRoleReviewCount";$m.YIg="OnRoleChanged";Object(t.a)($m,"RoleLifecycleManager",null,[312,313,314]);class Ys{constructor(a,d,n,z,O,ca){this.dfb=a;this.gwc=d;this.lg=n;this.va=z;this.Nm=O;this.gN=ca;this.wh=!1;this.LJg=(Da,Xa)=>{(Da=Xa.data.paragraphNode)?this.nOj(Da,()=>!0,zb=>zb.userSetRole=lt.d(Xa.data.kEg)):k.ULS.shipAssertTag(557057378,3016,!1)};this.CKd=(Da,Xa)=>{0<this.gN.s7l||this.f4g(Xa.property)&&this.nOj(Xa.node,zb=>!(zb&&zb.isInvalidated),
zb=>zb.isInvalidated=!0)}}initialize(){!this.wh&&this.va.getBooleanFeatureGate(Ys.BYe,!1)&&(this.dfb.LWh(this.LJg),this.Nm.Oe(12).tq(this.CKd),this.wh=!0)}Ae(){}nOj(a,d,n){if(a=(a=this.gwc.jsl(a))&&1===a.length&&a[0]){var z=a.content;z=z&&z.M_&&z.M_.customMetadata;d(z)&&(d=new bp.RoleDetectionCustomMetadata,d.isInvalidated=z&&z.isInvalidated,d.userSetRole=z&&z.userSetRole,n(d),this.lg.EKn(a,d))}}f4g(a){return a===Vd.a.wk||a===Vd.a.qn||Array.contains(Vi.AParagraphNode.WL(),a)}}Ys.BYe="Microsoft.Office.WordOnline.Augloop.UpdateRoleDetectionMetadata";
Object(t.a)(Ys,"RoleDetectionMetadataUpdater",null,[311]);var Mj=b(956);class mt{constructor(a,d,n){this.g0e=a;this.Y6b=d;this.SJd=(z,O)=>{z=O.data;if(z.qD==Mj.a.getTypeName()||z.qD==Mj.n.getTypeName())if(z=z.annotation&&z.annotation.content)this.runId=z.runId};this.isEnabled=n.getBooleanFeatureGate(Ys.BYe,!1);this.revisionId=0}initialize(){this.isEnabled&&this.Y6b.jP(this.SJd)}Ae(){this.isEnabled&&this.Y6b.aT(this.SJd)}ACm(){if(this.isEnabled&&void 0!==this.runId){var a=new bp.RoleDetectionSettings({acceptedRunId:this.runId});
a=new Mj.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:a,revId:(this.revisionId++).toString()}]});this.g0e.submitOperation(a)}else Promise.resolve()}}Object(t.a)(mt,"RoleDetectionSettingsUpdater",null,[]);class Dt{constructor(a,d,n){this.F6l=a;this.YQa=d;this.Qh=n;this.kOi=this.initialized=!1;this.s8i=()=>{this.aBj()&&(this.YMi(),this.YQa.P7m(this.s8i))}}initialize(){this.initialized||(this.Sjg(),this.initialized=!0)}Ae(){}Sjg(){this.aBj()?this.YMi():this.YQa.dyk(this.s8i)}aBj(){return!this.kOi&&
(this.Qh.BQi()||this.YQa.KEe(bp.DocumentRoleDetectionAnnotation.getTypeName())||this.YQa.KEe(bp.RoleDetectionAnnotation.getTypeName()))}YMi(){for(const a of this.F6l)a.initialize();this.kOi=!0}}Object(t.a)(Dt,"RLMInitializer",null,[]);class Et{constructor(a,d,n){this.M5=a;this.xs=d;this.BQb=n;this.Z=null;this.$ta=()=>{this.TAd();this.xs.YLb(this.$ta)};if(!a)throw U.a.argument("AppLifecycleManager is null");if(!d)throw U.a.argument("Workspace is null");if(!n)throw U.a.argument("ApplicationInstance is null");
}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.Z.resolve("Box4.IFeatureHelper").tk.continueWith(()=>this.Po())}Hb(a){this.Z=a;a.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater",()=>new mt(this.Z.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),a.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").zN,a.resolve("Common.IAppSettingsManager"))).singleInstance();a.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater",
()=>new Ys(a.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),a.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").TVe,a.resolve("Box4.AugmentationLoop.IAnnotationStorage"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.Graph.IGraphInstance"),a.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();a.ha("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager",()=>new $m(a.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").glb,
a.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").TVe,a.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").zN,a.resolve("Box4.Graph.IGraphInstance"),a.resolve("WordEditor.Designer.Common.Review.IReviewEvents"))).singleInstance();a.ha("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader",()=>a.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager")).singleInstance();a.ha("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer",()=>new Dt([this.Z.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),
this.Z.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater")],a.resolve("Box4.AugmentationLoop.IAnnotationStorage"),a.resolve("WordEditor.Designer.IDesignerControl"))).singleInstance()}dispose(){}Po(){this.BQb.eM?this.M5.Ik(16,()=>this.Zzd()):this.Zzd()}Zzd(){this.xs.IIa?this.TAd():this.xs.mqa(this.$ta)}TAd(){this.Z.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater").initialize();this.Z.resolve("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer").initialize()}}
Object(t.a)(Et,"PackageManager",null,[1,2]);class Ut{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(a,d){const n=new Ut;n.ContractVersion=a;n.FileName=d;n.Paragraphs=[];return n}}Object(t.a)(Ut,"DocumentSwayPreviewContent",null,[]);class Js{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static hYk(a,d,n,z){const O=new Js;O.RawText=a;O.ParagraphFormatting=d;O.TextRuns=n;O.IsRTL=z;O.ParagraphIndex=
0;return O}}Object(t.a)(Js,"ParagraphContent",null,[]);var nn=b(100),Rr=b(1047);class Vt{constructor(){this.Name=null;this.Size=0}static construct(a,d){const n=new Vt;n.Name=a;n.Size=d;return n}}Object(t.a)(Vt,"FontData",null,[]);class Ka{constructor(){this.IsUppercase=this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(a,d,n,z,O,ca){const Da=new Ka;Da.IsBold=a;Da.IsUnderline=d;Da.IsUppercase=n;Da.Font=z;Da.Alignment=O;Da.LeftIndent=ca;return Da}}Object(t.a)(Ka,
"TextFormatting",null,[]);class Va{constructor(){this.RunFormatting=this.RawText=null}static construct(a,d){const n=new Va;n.RawText=a;n.RunFormatting=d;return n}}Object(t.a)(Va,"TextRunContent",null,[]);var La=b(105),Ia=b(39);class eb{constructor(a,d){this.qrc=null;this.Jek=a;this.QT=d||""}get JNm(){return this.Jek.value}pil(){const a=Date.now(),d=Ut.construct(2,this.QT);d.Paragraphs=this.Crl();const n={};n.ExtractionDurationInMs=(Date.now()-a).toString();k.ULS.sendTraceTag(25268374,382,50,"{0}",
n);return d}Crl(){const a=new db.a;var d=0;let n=0,z=!1;var O=new Dd.GraphIterator;O.set(this.JNm);O=Yi.a.Ql(O.currentNode);const ca=new cg.a(0);for(;O.moveNext()&&2100>n&&25>d;){var Da=O.currentNode;if(Bd.ParagraphReader.nb(Da)&&!Bd.ParagraphReader.Xba(Da)){!z&&Bd.ParagraphReader.eV(Da)&&(z=!0);let Xa=Vi.AParagraphNode.V0(Da.characterData);Xa=Xa.trim();if(0<Xa.length){const zb=this.bJl(Da);zb.ParagraphIndex=d;d++;n+=Xa.length;a.add(zb);this.fNn(ca,Bd.ParagraphReader.language(Da))}}}this.qrc=this.Swl(ca);
d={};d.documentHasList=z;k.ULS.sendTraceTag(25776736,382,50,"{0}",d);return a.toArray()}Swl(a){let d=-1,n=1033;for(let z of a.keys.toArray())z&&a.J(z)>d&&(d=a.J(z),n=z);return Ih.a.yf(n)}fNn(a,d){a.Na(d)?a.$(d,a.J(d)+1):a.$(d,1)}bJl(a){const d=Vi.AParagraphNode.V0(a.characterData),n=this.fJl(a),z=this.WQl(a);a=this.zdm(a);return Js.hYk(d,n,z,a)}fJl(a){const d=Bd.ParagraphReader.jn(a,Vd.a.bold,!1),n=Bd.ParagraphReader.jn(a,Vd.a.underline,!1);var z=Bd.ParagraphReader.jn(a,Vd.a.fontSize,nn.a.NA);const O=
Bd.ParagraphReader.jn(a,Vd.a.font,nn.a.Pz);var ca=Bd.ParagraphReader.Jv(a);ca=this.Z4f(ca);const Da=!!Bd.ParagraphReader.jn(a,lh.a.capitalization,0);a=(new Rr.a).x7(a).value/20;z=Vt.construct(O,z);return Ka.construct(d,n,Da,z,ca,a)}WQl(a){const d=new db.a;for(let O=0;O<a.ja.length-1;O++){var n=a.ja.J(O),z=a.ja.J(O+1);n.formatting&&(z=Vi.AParagraphNode.V0(a.characterData.substr(n.cp,z.cp-n.cp)),n=this.XQl(n.formatting),n=Va.construct(z,n),d.add(n))}return d.toArray()}XQl(a){const d=La.FormattingReader.WGc(a,
Vd.a.bold,!1),n=La.FormattingReader.WGc(a,Vd.a.underline,!1);var z=La.FormattingReader.WGc(a,Vd.a.fontSize,nn.a.NA);const O=La.FormattingReader.WGc(a,Vd.a.font,nn.a.Pz);z=Vt.construct(O,z);a=!!La.FormattingReader.WGc(a,lh.a.capitalization,0);return Ka.construct(d,n,a,z,5,0)}Z4f(a){switch(a){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}zdm(a){const d=new Dd.GraphIterator;d.set(a);d.La(11);return(a=d.tc(11))?Ia.OutlineElementReader.wi(a):!1}}Object(t.a)(eb,
"DocumentContentExtractor",null,[269]);class Ib{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}Hb(a){a.ha("WordEditor.DocumentContentExtractor.DocumentContentExtractor",()=>new eb(new Nf.a(()=>Rj.App.wn.za.Rb.xc),l.AFrameworkApplication.Bs.EB)).as("Box4.DocumentContentExtractor.IDocumentContentExtractor").singleInstance()}static main(){M.a.instance.Sb(new Ib)}}Object(t.a)(Ib,"DocumentContentExtractorPackage",null,[1,2]);class Rb{}Rb.Lf="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";
Object(t.a)(Rb,"EmbedDialogHtml",null,[]);class cc{constructor(a,d,n,z){this.uOc=a;this.znb=d;this.HPe=n;this.value=z}}Object(t.a)(cc,"OptionInfo",null,[]);class xc{constructor(a,d,n){this.rZg=a;this.qIc=d;this.znb=n}}Object(t.a)(xc,"SectionInfo",null,[]);var Kc=b(241);class Rc extends xg.a{constructor(a,d=!1){super(!1,!1,d);this.a6d=476;this.vsc=288;this.Ncf=798;this.Pjk=476;this.Ojk=288;this.QLd={};this.EMb=[];this.X1=this.qeb=this.mYb=this.FSb=this.fbe=this.Evc=null;this.P0c=l.AFrameworkApplication.jac;
this.gZb=a;this.ypf=Object(m.a)(this,this.sMm,"optionClickHandler");this.p9c=Object(m.a)(this,this.tMm,"optionKeyHandler");this.r9e=Object(m.a)(this,this.bFk,"arrowClickHandler");this.rqc=Object(m.a)(this,this.cFk,"arrowKeyHandler");this.Pfe=Object(m.a)(this,this.eDn,"textAreaOnFocusHandler");this.wdk=d;this.Lf=Rb.Lf;this.wc=0;this.Je="EmbedDialog"}get Ex(){return this.vsc}set Ex(a){this.vsc=a}ZCj(a){const d={["id"]:this.Je,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,
["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:Vc.a.Qm(this.gZb,"wdPreview","1"),["initialEmbedUrl"]:this.P0c,["getEmbedCode"]:Rc.Iwi,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const n of Object.keys(a))d[n]=a[n];this.wc=1;this.ee(1,CommonUIStrings.l_CopyAction);this.ee(0,CommonUIStrings.l_Close);this.Ih(CommonUIStrings.l_Embed,null,d)}aTc(){if(this.wdk)this.ZCj({});
else{this.showDialog(CommonUIStrings.l_Embed,null);this.Evc=document.getElementById("embedpreviewpane");this.fbe=document.getElementById("embedoptionpane");this.Evc.style.width=String.format("{0}px",this.Pjk);this.qeb=document.createElement("iframe");this.qeb.className=Rc.Njk;this.qeb.frameBorder="0";this.qeb.style.height=String.format("{0}px",this.Ojk);this.qeb.tabIndex=-1;this.Evc.appendChild(this.Hpe(CommonUIStrings.l_Preview,this.qeb,Rc.kKh,Rc.jKh,Rc.kKh,!0));this.X1=document.createElement("textarea");
this.X1.className=Rc.i8j;Sys.UI.DomElement.addCssClass(this.X1,Kc.a.vgd);this.X1.id=Rc.Suh;I.a.tg||(this.X1.readOnly=!0);this.X1.rows=4;this.X1.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.X1.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.X1.setAttribute(pd.a.m3,String.format("{0} {1}",Rc.Ruh,Rc.Quh));this.Evc.appendChild(this.Hpe(CommonUIStrings.l_EmbedCode,this.X1,Rc.Ruh));Qc.a.addHandler(this.X1,"focus",this.Pfe);var a=document.createElement("span");a.className=Rc.G9j;
a.innerText=CommonUIStrings.l_CopyText;a.id=Rc.Quh;this.Evc.appendChild(a);this.FSb=document.createElement("div");this.FSb.className=Rc.r7j;this.fbe.appendChild(this.Hpe(CommonUIStrings.l_Dimensions,this.FSb));this.mYb=document.createElement("div");this.fbe.appendChild(this.K_k(Rc.pIh,this.mYb));this.wc=0;this.ee(1,CommonUIStrings.l_Close);this.Cdh();this.MPj();I.a.tg||this.X1.focus()}}dispose(){if(this.QLd){var a=this.QLd;for(let d in a){const n=a[d];this.Jl.kb(vb.a.click,n.uOc,this.ypf);this.Cc.kb(vb.a.Nf,
n.uOc,this.p9c);this.Cc.kb(vb.a.Of,n.uOc,this.p9c)}this.p9c=this.ypf=this.QLd=null}if(this.EMb){for(a=0;a<this.EMb.length;++a)this.Jl.kb(vb.a.click,this.EMb[a].qIc,this.r9e),this.Cc.kb(vb.a.Nf,this.EMb[a].qIc,this.rqc),this.Cc.kb(vb.a.Bn,this.EMb[a].qIc,this.rqc),this.Cc.kb(vb.a.Of,this.EMb[a].qIc,this.rqc);this.Cc=this.r9e=this.EMb=null}this.Pfe&&this.X1&&(Qc.a.removeHandler(this.X1,"focus",this.Pfe),this.Pfe=null);this.X1=this.qeb=this.mYb=this.FSb=this.fbe=this.Evc=null;super.dispose()}a5(){super.a5();
this.xb.style.width=String.format("{0}px",this.Ncf);this.I2a()}ULn(a,d){const n=Vc.a.Qm(this.P0c,a,d);return this.P0c!==n?(this.P0c=n,this.gZb=Vc.a.Qm(this.gZb,a,d),!0):!1}Cdh(){this.X1&&(this.X1.innerText=Rc.Iwi(this.P0c,this.a6d,this.vsc))}MPj(){this.qeb&&this.qeb.contentWindow.location.replace(Vc.a.Qm(this.gZb,"wdPreview","1"))}x3e(a,d){this.ULn(a,d)&&(this.Cdh(),this.MPj())}Hpe(a,d,n=null,z=null,O=null,ca=!1){const Da=document.createElement("div");Da.className=Rc.pmk;z&&(Da.id=z);O&&Da.setAttribute(pd.a.m3,
O);ca&&(Da.tabIndex=0);z=document.createElement("span");z.className=Rc.qmk;z.innerText=a;n&&(z.id=n);Da.appendChild(z);Da.appendChild(d);return Da}K_k(a,d){const n=this.Hpe(CommonUIStrings.l_Interaction,d),z=this.ff.createElement("div");z.className=Rc.T2j;z.id=Rc.yoh+a;z.setAttribute(pd.a.ig,pd.a.l3);z.tabIndex=0;n.insertBefore(z,d);a=Vf.createClusteredImage(16,16,Rc.U2j,Rc.V2j,!0,"");z.appendChild(a);a=a.childNodes[0];a.className=Vf.getImageClass(Rc.ouh);a.title=CommonUIStrings.l_Expand;z.title=
CommonUIStrings.l_Expand;d.style.visibility="hidden";d=new xc(d,z,a);Array.add(this.EMb,d);this.Jl.vD(vb.a.click,z,this.r9e,d);this.Cc.vD(vb.a.Nf,z,this.rqc,d);this.Cc.vD(vb.a.Bn,z,this.rqc,d);this.Cc.vD(vb.a.Of,z,this.rqc,d);return n}bFk(a){this.A5h(a);return!0}cFk(a){return this.Kdc(a,Object(m.a)(this,this.A5h,"changeArrowState"))}A5h(a){a=a.Dm;"visible"===a.rZg.style.visibility?(a.rZg.style.visibility="hidden",a.znb.className=Vf.getImageClass(Rc.ouh),a.znb.title=CommonUIStrings.l_Expand,a.qIc.title=
CommonUIStrings.l_Expand):(a.rZg.style.visibility="visible",a.znb.className=Vf.getImageClass(Rc.Zqk),a.znb.title=CommonUIStrings.l_Collapse,a.qIc.title=CommonUIStrings.l_Collapse)}Bbi(a,d){const n=document.createElement("div");n.className=Rc.mIh;n.id=a+Rc.nIh;var z=this.ff.createElement("div");z.tabIndex=0;z.className=Rc.tqh;z.id=a+Rc.VYc;z.setAttribute(pd.a.ig,pd.a.cke);z.setAttribute(pd.a.zGa,pd.a.Rm);z.setAttribute(pd.a.m3,a+Rc.Prc);n.appendChild(z);n.setAttribute(pd.a.ig,pd.a.Ix);var O=Vf.createClusteredImage(16,
16,Rc.Bqh,Rc.Aqh,!0,"");z.appendChild(O);O=O.childNodes[0];O.id=a+Rc.oIh;O.className=Vf.getImageClass(Rc.daf);z=new cc(n,O,z,1);this.QLd[a]=z;this.Jl.vD(vb.a.click,n,this.ypf,a);z=document.createElement("span");z.className=Rc.Prc;z.innerText=d;z.id=a+Rc.Prc;n.appendChild(z);this.Cc.vD(vb.a.Nf,n,this.p9c,a);this.Cc.vD(vb.a.Of,n,this.p9c,a);return n}sMm(a){this.acj(a);return!0}tMm(a){return this.Kdc(a,Object(m.a)(this,this.acj,"optionHandler"))}acj(a){const d=this.QLd[a.Dm.toString()];d.value?(d.value=
0,d.znb.className=Vf.getImageClass(Rc.gyf),d.HPe.setAttribute(pd.a.zGa,pd.a.yL)):(d.value=1,d.znb.className=Vf.getImageClass(Rc.daf),d.HPe.setAttribute(pd.a.zGa,pd.a.Rm));this.x3e(a.Dm.toString(),d.value.toString())}eDn(){this.X1.select()}static Iwi(a,d,n){if(!Rc.iof){const z=String.format('<a target="_blank" href="{0}">{1}</a>',w.a.gIc("https://office.com"),CommonUIStrings.l_Office),O=String.format('<a target="_blank" href="{0}">{1}</a>',w.a.gIc("https://office.com/webapps"),CommonUIStrings.l_WebAppName);
Rc.iof=String.format(CommonUIStrings.l_NoFrames,z,O)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',w.a.gIc(a),d,n,Rc.iof)}}Rc.iof=null;Rc.daf="CheckboxChecked_16x16x32";Rc.gyf="CheckboxUnchecked_16x16x32";Rc.Zqk="OutlookSearchChevronUp_16x16x32";Rc.ouh="OutlookSearchChevronDown_16x16x32";Rc.Bqh="CommentChecked";Rc.U2j="UpArrowServer";Rc.Prc="EmbedDescription";Rc.pmk="EmbedSectionHeader";Rc.qmk="EmbedSectionName UIFontBold";Rc.G9j="EmbedCodeFooter";
Rc.Aqh="EmbedOptionImage";Rc.Njk="EmbedPreviewFrame";Rc.i8j="EmbedCodeTextArea";Rc.mIh="EmbedOption";Rc.r7j="EmbedDimensionSection";Rc.V2j="EmbedArrowIcon";Rc.T2j="WACGlyph EmbedArrowHolder";Rc.tqh="EmbedCheckBoxHolder";Rc.nIh="Option";Rc.oIh="OptionImage";Rc.Suh="EmbedCode";Rc.Ruh="EmbedCodeHeader";Rc.kKh="Preview";Rc.jKh="PreviewHeader";Rc.pIh="Options";Rc.yoh="Arrow";Rc.VYc="Check";Rc.Quh="EmbedCodeFooter";Object(t.a)(Rc,"EmbedDialog",xg.a,[]);class fd extends cc{constructor(a,d,n,z,O){super(a,
d,n,z);this.Knb=O}}Object(t.a)(fd,"OptionInputInfo",cc,[]);class ed extends Rc{constructor(a,d){super(a,ed.FQ);this.ska=null;this.b0c=[];this.Yee=Object(m.a)(this,this.kzn,"startOnOptionClickHandler");this.Pwc=Object(m.a)(this,this.lzn,"startOnOptionKeyHandler");this.ube=Object(m.a)(this,this.RHm,"onPageNumberChanged");this.Wcf=Object(m.a)(this,this.EEm,"onDimensionChanged");this.iL=d}aTc(){if(ed.FQ){var a=ed.WZm,d=[];d.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.iL.mOg,
["urlTransformFunctionOnChange"]:a},{["id"]:"wdEmbedCode",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.iL.FSg,["urlTransformFunctionOnChange"]:a},{["id"]:"wdStartOn",["checkboxInitialValue"]:!1,["checkboxLabel"]:this.iL.H7g,["urlTransformFunctionOnChange"]:a,["textInputProps"]:{["title"]:this.iL.I7g}});this.ZCj({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.a6d,["defaultHeight"]:this.vsc,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.iL.Ygh,["heightLabel"]:this.iL.Ogg},
["interactionOptions"]:d})}else super.aTc(),this.gUh(this.iL.Ygh,"EmbedWidthInput",this.a6d),this.gUh(this.iL.Ogg,"EmbedHeightInput",this.vsc),this.mYb.appendChild(this.Bbi("wdPrint",this.iL.mOg)),this.mYb.appendChild(this.Bbi("wdEmbedCode",this.iL.FSg)),this.Stk(this.iL.H7g),this.I2a(),ic.FocusManager.jA()&&(a=ic.FocusManager.instance(),d=[document.getElementById(Rc.Suh),document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById(Rc.yoh+Rc.pIh),
document.getElementById("wdPrint"+Rc.VYc),document.getElementById("wdEmbedCode"+Rc.VYc),document.getElementById("wdStartOn"+Rc.VYc),document.getElementById("wdStartOnText"),document.getElementById(zf.a.Zpc),document.getElementById(Rc.jKh)],d=new Ud(d),a.rk().Tf=d,I.a.tg?this.$Y(document.getElementById(zf.a.Zpc)):this.X1.select())}dispose(){if(!ed.FQ){if(this.b0c){for(let a=0;a<this.b0c.length;++a)Qc.a.removeHandler(this.b0c[a],"change",this.Wcf);this.b0c=this.Wcf=null}this.ube&&(Qc.a.removeHandler(this.ska.Knb,
"change",this.ube),this.ube=null);this.Yee&&(this.Jl.kb(vb.a.click,this.ska.uOc,this.Yee),this.Yee=null);this.Pwc&&(this.Cc.kb(vb.a.Nf,this.ska.uOc,this.Pwc),this.Cc.kb(vb.a.Of,this.ska.uOc,this.Pwc),this.Pwc=null);this.ska=null}super.dispose()}gUh(a,d,n){const z=document.createElement("label");z.className="EmbedInputPrefix";z.innerText=a;this.FSb.appendChild(z);a=document.createElement("input");a.className=d;a.id=d;a.value=n.toString();a.type="text";a.setAttribute("data-lpignore","true");z.setAttribute("for",
d);this.FSb.appendChild(a);this.b0c.push(a);Qc.a.addHandler(a,"change",this.Wcf);this.FSb.appendChild(document.createElement("br"))}EEm(a){"EmbedWidthInput"===a.target.id?this.a6d=this.Wse(a.target,375):this.vsc=this.Wse(a.target,250);this.Cdh()}Wse(a,d){let n=parseInt(a.value);if(isNaN(n)||n<d)n=d;a.value=n.toString();return n}RHm(a){a=this.Wse(a.target,1);1===this.ska.value&&this.x3e("wdStartOn",a.toString())}Stk(a){const d=document.createElement("div");d.className=Rc.mIh+" EmbedInlineOption";d.id=
"wdStartOn"+Rc.nIh;const n=this.ff.createElement("div");n.tabIndex=0;n.className=Rc.tqh;n.id="wdStartOn"+Rc.VYc;n.setAttribute(pd.a.ig,pd.a.cke);n.setAttribute(pd.a.zGa,pd.a.yL);n.setAttribute(pd.a.m3,"wdStartOn"+Rc.Prc);d.appendChild(n);d.setAttribute(pd.a.ig,pd.a.Ix);var z=Vf.createClusteredImage(16,16,Rc.Bqh,Rc.Aqh,!0,"");n.appendChild(z);z=z.childNodes[0];z.id="wdStartOn"+Rc.oIh;z.className=Vf.getImageClass(Rc.gyf);const O=document.createElement("span");O.className=Rc.Prc;O.innerText=a;O.id="wdStartOn"+
Rc.Prc;d.appendChild(O);this.mYb.appendChild(d);a=document.createElement("input");a.className="EmbedPageNumberInput";a.id="wdStartOnText";a.type="text";a.title=this.iL.I7g;a.setAttribute("data-lpignore","true");this.mYb.appendChild(a);Qc.a.addHandler(a,"change",this.ube);this.ska=new fd(d,z,n,0,a);this.x3e("wdStartOn","1");this.Jl.Ea(vb.a.click,d,this.Yee);this.Cc.Ea(vb.a.Nf,d,this.Pwc);this.Cc.Ea(vb.a.Of,d,this.Pwc)}kzn(a){this.pFj(a);return!0}lzn(a){return this.Kdc(a,Object(m.a)(this,this.pFj,"startOnOptionHandler"))}pFj(){let a=
1;this.ska.value?(this.ska.value=0,this.ska.znb.className=Vf.getImageClass(Rc.gyf),this.ska.HPe.setAttribute(pd.a.zGa,pd.a.yL)):(this.ska.value=1,this.ska.znb.className=Vf.getImageClass(Rc.daf),a=this.Wse(this.ska.Knb,1),this.ska.HPe.setAttribute(pd.a.zGa,pd.a.Rm));this.x3e("wdStartOn",a.toString())}static get FQ(){return l.AFrameworkApplication.la.eb.wz}static WZm(a,d,n,z=null){if("wdPrint"===d||"wdEmbedCode"===d)return Vc.a.Qm(a,d,n?"1":"0");if("wdStartOn"===d){let O="1";n&&z&&(z=parseInt(z),!isNaN(z)&&
1<=z&&(O=z.toString()));return Vc.a.Qm(a,d,n?O:"1")}return a}}Object(t.a)(ed,"WordEmbedDialog",Rc,[]);class md{constructor(a,d,n,z,O){this.npa=null;this.ga=a;this.QNa=d;this.wx=n;this.iL=z;this.sEa=O}lb(){this.ga.ma(this.wx,Cd.a.frame,Object(m.a)(this,this.Eun,"showEmbedCode"));this.QNa.execute(Object(m.a)(this,this.uHg,"onHostPostmessengerCreated"))}uHg(a){k.ULS.shipAssertTag(4994850,332,!!a);this.npa=a;l.AFrameworkApplication.yma||(this.npa.ax(D.a.jKf),this.npa.uD(D.a.jKf,Object(m.a)(this,this.aTc,
"showEmbedDialog")))}aTc(a){a=a.Values.HostEmbeddedViewUrl.toString();l.AFrameworkApplication.jac=a;this.sEa.cZf=a;(new ed(a,this.iL)).aTc()}Eun(a,d,n){if(2===n)if(l.AFrameworkApplication.jac)(new ed(this.sEa.cZf,this.iL)).aTc();else return l.AFrameworkApplication.ug.dsa(md.pXj,1),l.AFrameworkApplication.n0d&&this.npa.Eh(D.a.Ani,null)?32:l.AFrameworkApplication.la.j8(!0,l.AFrameworkApplication.prd);return 32}}md.pXj=10381;Object(t.a)(md,"EmbedActor",null,[]);class ee{constructor(){this.I7g=this.H7g=
this.FSg=this.mOg=this.Ogg=this.Ygh=null}}Object(t.a)(ee,"WordEmbedDialogStrings",null,[]);var Zd=b(249);class $d extends md{constructor(a,d){super(a,d,Dc.a.w5g,Object.assign(new ee,{Ygh:WordEditorIntl.WordEditorStrings.l_Width,Ogg:WordEditorIntl.WordEditorStrings.l_Height,mOg:WordEditorIntl.WordEditorStrings.l_PrintOption,FSg:WordEditorIntl.WordEditorStrings.l_ReembedOption,H7g:WordEditorIntl.WordEditorStrings.l_StartOnOption,I7g:WordEditorIntl.WordEditorStrings.l_StartPage}),Zd.WoncaApp.instance)}}
Object(t.a)($d,"EmbedActor",md,[]);class ge{constructor(){this.Z=null}get name(){return"WordEditor.Embed"}Hb(a){this.Z=a;a.ha("WordEditor.Embed.EmbedActor",()=>new $d(l.AFrameworkApplication.pa,a.Ca("Postmessage.IHostPostmessenger"))).singleInstance()}init(){this.Z.resolve("WordEditor.Embed.EmbedActor").lb()}dispose(){}}Object(t.a)(ge,"EmbedPackage",null,[1,2]);class Fe{constructor(a,d,n){this.ny=this.Cva=this.cxa=null;this.O_a=0;this.Stc=this.Ktc=this.ztc=this.Ztc=this.acb=this.$bb=!1;this.si=a;
this.Ek=n}Ov(a){return Lb.App.oa.za.isEditingAllowed?""!==this.zud(a.Ec):!1}Ly(a){if(!this.Ov(a))return!1;this.Gjn(a);this.Hjn();this.Ijn();this.cxa=a.Gr;this.ny=new Sys.UI.Point(0,0);k.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}Ky(a){this.Cva=a.Gr;this.pMk();this.si.ROj(this.ny.x,this.ny.y,this.Ztc,this.ztc,this.Ktc,this.Stc,!1);return!0}hr(){this.si.ROj(this.ny.x,this.ny.y,this.Ztc,this.ztc,this.Ktc,this.Stc,!0);k.ULS.sendTraceTag(22381024,322,50,"Image Crop drag succeeded")}rx(){this.si.AOk();
k.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}Hjn(){this.Stc=this.Ktc=this.ztc=this.Ztc=!1;switch(this.O_a){case 1:this.Ztc=!0;break;case 5:this.ztc=!0;break;case 3:this.Stc=!0;break;case 7:this.Ktc=!0;break;case 0:this.Ktc=this.Ztc=!0;break;case 2:this.Stc=this.Ztc=!0;break;case 6:this.Ktc=this.ztc=!0;break;case 4:this.Stc=this.ztc=!0}}Ijn(){this.acb=this.$bb=!1;switch(this.O_a){case 0:this.acb=this.$bb=!0;break;case 1:case 2:this.acb=!0;break;case 7:case 6:this.$bb=!0}}zud(a){var d=
a.className;-1===d.indexOf("WACImageCropHandle")&&a.parentNode&&(d=a.parentNode.className);a=d.split(" ");for(d=0;d<a.length;d++){const n=a[d].toString();if(n.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==n)return n}return""}Gjn(a){switch(this.zud(a.Ec)){case "WACImageCropHandleNW":this.O_a=0;break;case "WACImageCropHandleN":this.O_a=1;break;case "WACImageCropHandleNE":this.O_a=2;break;case "WACImageCropHandleE":this.O_a=3;break;case "WACImageCropHandleSE":this.O_a=4;break;case "WACImageCropHandleS":this.O_a=
5;break;case "WACImageCropHandleSW":this.O_a=6;break;case "WACImageCropHandleW":this.O_a=7}}pMk(){var a=1;this.Ek.instance&&(a=this.Ek.instance.Ei);const d=(this.Cva.x-this.cxa.x)/a;a=(this.Cva.y-this.cxa.y)/a;this.ny.x=this.$bb?-d:d;this.ny.y=this.acb?-a:a}}Object(t.a)(Fe,"ImageCropDragAdapter",null,[161]);class Se{constructor(a,d){this.ga=a;this.Ek=d}DCl(a){return new Fe(a,this.ga,this.Ek)}}Object(t.a)(Se,"ImageCropDragAdapterFactory",null,[268]);var ff=b(224),gf=b(192),eg=b(429),We=b(639),Ee=b(90),
Jf=b(68),hk=b(409),Hi=b(782),Qg=b(527),mi=b(123),Dk=b(359),Yj=b(340),Dh=b(783),Ll=b(205),qh=b(83),Uf=b(22),ih=b(280),El=b(371),Pi=b(140);class zk{constructor(a,d,n,z,O,ca,Da,Xa){this.GAd=this.Xb=this.yx=null;this.Cq=a;this.Ee=d;this.Nb=n;this.Ki=z;this.hc=O;this.Da=ca;this.Wl=Da;this.HG=Xa}get u3(){return this.yx||(this.yx=la.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}get gb(){return this.Xb||(this.Xb=la.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get yc(){return mi.PageReader.instance}uln(a,
d,n){const z=this.Nb.Wb(15);z.Sa(d.node);this.Hha(a,n);z.dispose()}tln(a,d,n){const z=this.Nb.Wb(15);z.Sa(d.node);this.YMb(a,n);z.dispose()}Hha(a,d){a.setValue(Vd.a.imageAltText,d)}YMb(a,d){a.setValue(Qb.a.dY,d)}Aln(a,d){a.setValue(Vd.a.sIa,d)}wxj(a,d){a.setValue(Qb.a.uS,d)}xln(a,d,n,z,O){let ca=0;var Da=0;({width:ca,height:Da}=Kd.ImageReader.ETa(a,ca,Da));Da-=(d+n)/1E5*Da;this.ZCa(a,ca-(z+O)/1E5*ca);this.YCa(a,Da);this.Fxj(a);a.setValue(Qb.a.xnb,d);a.setValue(Qb.a.unb,n);a.setValue(Qb.a.vnb,z);a.setValue(Qb.a.wnb,
O)}Syj(a,d,n,z){const O=this.Nb.Wb(15);O.Sa(d.node);this.lXe(a,n,z);O.dispose()}lXe(a,d,n){this.ZCa(a,d);this.YCa(a,n);this.Fxj(a);a.removeProperty(Xc.a.qMd);a.removeProperty(Xc.a.pMd)}ZCa(a,d){a.setValue(Vd.a.ica,d);a.setValue(Xc.a.wIa,-1)}YCa(a,d){a.setValue(Vd.a.Jsa,d);a.setValue(Xc.a.vIa,-1)}NH(a,d){a.setValue(Qb.a.gac,d);a.setValue(Vd.a.Mj,d);a.setValue(Vd.a.wK,d)}apn(a,d){a.setValue(Qb.a.Vub,d)}Oin(a,d){a.setValue(Qb.a.iid,d)}dpn(a){if(!Kd.ImageReader.m0(a)&&a.Cj){var d=a.node;if(Kd.ImageReader.eQ(d)){const O=
this.Nb.Wb(15);O.Sa(a.node);a=Dd.GraphIterator.ua(d);a.La(12);a=a.parentNode;var n=a.properties.Se(Qb.a.Qo),z=d.properties.getValue(Qb.a.runId);d.fa(Qb.a.Ob,Re.a.IQ);const ca=a.ja;d.oe.apply(d,[Qb.a.gac,Vd.a.Mj,Vd.a.wK,Qb.a.iid,Qb.a.Vub,Qb.a.ohb]);n=this.h7f(z,n,ca);z=fe.a.Kb(a,n);this.Ki.FPf(d,z);(d=this.HG.wX(a,n,n+1))&&this.Da.setSelection(d);this.u3.foa(a,n,n+1);O.dispose()}}}L_g(a,d){if(a.properties.hasProperty(Qb.a.H6)){const n=a.properties.Se(Qb.a.H6);n.push(d);a.properties.setValue(Qb.a.H6,
Array.clone(n))}else a.properties.setValue(Qb.a.H6,[d])}pYe(a,d,n=0,z=!1){if(a.Cj){var O=this.Nb.Wb(15),ca=a.node;O.Sa(ca);if(Kd.ImageReader.m0(a)){const Vb=new Qg.a;Vb.hn(Kd.ImageReader.$k(a));var Da=ca.ja,Xa=this.Ekl(a.cpBegin,Da);this.MEk(a.cpEnd,Da,Xa)&&k.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");Da=Da.J(Xa).blob;Xa=Da.Qc;var zb=ca.properties.Se(Qb.a.Qo);zb=this.HZm(zb);Xa=zb[Xa];zb=ca.fa(Qb.a.Ob,Re.a.IQ);if(Da=Object(qa.a)(Hi.ImageBlobObject,Da))Da.Mlc=
!1;this.hc.replaceTextRange(a,"");Da&&(Da.Mlc=!0);Vb.properties.setValue(Qb.a.runId,Xa);Vb.properties.setValue(Qb.a.Ob,zb);a=Dd.GraphIterator.ua(ca);a.La(12);a.Re(Vb,6);this.L_g(a.currentNode,Vb.anchor.node.id);ca=Vb}n&&this.NH(ca.properties,n);this.Oin(ca.properties,z);this.apn(ca.properties,d);this.u3.fSc(ca);(d=this.HG.Bl(ca))&&this.Da.setSelection(d);O.dispose()}}TYg(a,d){if(!(0>=d)){var n=rf.a.hl(d,0),z=Kd.ImageReader.Tz(a),O=Kd.ImageReader.UA(a);z>n&&(O*=n/z,this.ZCa(a,n),this.YCa(a,O),k.ULS.sendTraceTag(37843205,
322,50,"Scale image width and height to fit constraining width {0} : ",d))}}MEk(a,d,n){const z=d.length;if(n>=z||!d.J(n).fd)return!1;const O=new hl.a;for(;n<z;n++){const ca=d.J(n);if(ca.cp>a||!ca.fd)break;for(let Da=0;Da<ca.fd.length;Da++){if(O.contains(ca.fd.J(Da).vi))return!0;O.add(ca.fd.J(Da).vi)}}return!1}HZm(a){for(var d=0;d<a.length&&!a[d];)d++;if(d===a.length)for(var n=0;n<a.length;)a[n]=n+1,n++;else{var z=a[d];n=d-1;for(var O=z-1;0<=n;)a[n]=O,n--,O--;O=0;for(n=d+1;n<a.length;)(d=a[n])?d<z?
(z=d+O,a[n]=z):z=d:(O+=2,z++,a[n]=z),n++}return a}V1f(a,d){let n=0;for(;n<d.length&&!(a<d[n]);)n++;return n}h7f(a,d,n){let z=0;const O=this.V1f(a,d);let ca=0;if(O===d.length)ca=n.length-1;else for(;ca<n.length;){d=n.J(ca);if(d.formatting&&d.formatting.Qc===O)break;ca++}ca<n.length?z=n.J(ca).cp:k.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:ca,["RunId"]:a,["CharacterPropertiesArrayLength"]:n.length});return z}Ekl(a,d){let n=0;for(;n<d.length&&d.J(n).cp!==a;)n++;
n===d.length&&k.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",{["Index"]:n,["CharacterPropertiesArrayLength"]:d.length});return n}Fxj(a){a.setValue(Vd.a.u4,!0)}CRe(a,d,n,z=!1){d&&n?(d=Math.max(d,We.a.yAg),n=Math.max(n,We.a.yAg)):n=d=We.a.HUf;a.setValue(Vd.a.ica,rf.a.hl(d,0));a.setValue(Vd.a.Jsa,rf.a.hl(n,1));a.setValue(Vd.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);a.setValue(lh.a.n4,1);a.setValue(Qb.a.Cma,z)}dEe(){return null}Bhi(a,
d,n){let z=null;d=({Nfc:z}=this.Chi(a,d,n)).returnValue;z&&a.view.Oa.setSelection(z);return d}Chi(a,d,n){var z=null;if(!this.KGa(a))return{returnValue:null,Nfc:z};var O=a.view;const ca=this.Nb.Wb(15,Mb.a.XGb);ca.Sa(O.xc);d||(d=new dh.DictionaryPropertySet);d.setValue(Xc.a.Aii,!0);let Da=O.Oa.Ag;var Xa=new Dh.a;if(!Qd.SelectionEditor.Cd(Da)){if(2===l.AFrameworkApplication.pa.processAction(Mb.a.ara,2))return ca.dispose(),{returnValue:null,Nfc:z};Da=O.Oa.Ag}else if(Da.Cj&&Bd.ParagraphReader.nb(Da.node)){uf.a.instance.J(4)&&
Lb.App.lc.eq&&Lb.App.lc.Mp.MJ(Da.node);O=La.FormattingReader.yr(Da);if(!O)return ca.dispose(),{returnValue:null,Nfc:z};O.cache.av&&(O=O.Xc(null),zk.Xg.QK(O));Xa.formatting=O.ng;Xa.languageId=La.FormattingReader.language(O);uf.a.instance.J(10)&&(Xa.VZa=this.gb.im(Da.node))}if(!Da.Cj)return ca.dispose(),{returnValue:null,Nfc:z};if(!this.Ikg(a.Am,d))return ca.dispose(),this.GAd=null,{returnValue:null,Nfc:z};a=this.GAd;this.GAd=null;1===a.location?(z=a.node,d=El.a.instance.qAe(z),qe.OutlineElementNavigator.Mt(d,
!1,!1)||(Ll.OutlineNavigator.Wjc(d),this.Cq.I6(d,!0,Xa)),qe.OutlineElementNavigator.Sd(d),If.TableReader.isTable(d)&&(Object(Uc.a)(Pi.a,d)||Object(Uc.a)(Dk.a,d)?(Xa=new Dd.GraphIterator,Xa.set(d.currentNode),Uf.moveToCellContent(Xa,0,0),d.set(Xa.currentNode)):Uf.moveToCellContent(d,0,0),Ia.OutlineElementReader.gg(d)?qe.OutlineElementNavigator.Sd(d):d=El.a.instance.qAe(z)),z=Bd.ParagraphReader.yl(d.currentNode)?this.HG.Pc(d.currentNode,0):this.HG.Bl(d.currentNode)):a.location||(Xa=a.blob.Wa.cp+1,z=
this.HG.wX(a.node,Xa-1,Xa));ca.AJa(n,1);ca.om=Mb.a.XGb;ca.dispose();return{returnValue:a,Nfc:z}}Ikg(){return!1}KGa(a){a.contextId===Kb.a.view&&a.view.Yd&&a.view.Oa&&(a=a.view.Oa.Ag);if(!a)return zk.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.noSelection}),!1;if(zk.If.E3(a))return zk.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.CF}),!1;if(this.Wl&&this.Wl.instance&&this.Wl.instance.l0(a))return zk.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.externalSelection}),!1;if(this.yc.L7)return zk.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.compatMode}),!1;if(a.Cj)return qh.OutlineReader.Ccc(a)?
(zk.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.bmd}),!1):Kd.ImageReader.Vbc(a)?(zk.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.Xld}),!1):ih.c(a)?(zk.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.Yld}),!1):Yj.b(a)?(zk.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.Wld}),!1):Bd.ParagraphReader.wS(a)||Kd.ImageReader.JEe(a)?(zk.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.qP}),!1):!0;if(hk.a.oGe(a)){let d=!0;for(let n=0;n<a.length;++n){const z=a.getContext(n);if(!z.Cj)return!1;d&&!Bd.ParagraphReader.wS(z)&&(d=!1)}return d?(zk.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.qP}),!1):!0}return!1}e7m(a,
d){const n=this.Nb.Wb(7);n.Sa(a);if(12===a.type){d=d.Wa.cp;var z=Bd.ParagraphReader.textLength(a);z=fe.a.NR(d,d+1,d+1===z?!0:!1,a);this.hc.replaceTextRange(z,"");a=fe.a.Kb(a,d);this.Da.setSelection(ye.SelectionFactory.uj(a))}else this.Ee.isb(a);n.dispose()}static get Xg(){return zk.Wd||(zk.Wd=la.a.instance.resolve("Box4.IFormattingEditor"))}static get If(){return aj.a.instance}static get Lb(){return Ch.a.instance}}zk.Wd=null;Object(t.a)(zk,"ImageEditor",null,[267]);class um{constructor(a,d,n,z=0){this.node=
a;this.blob=d;this.location=n;this.$U=z}}Object(t.a)(um,"InsertPictureResult",null,[]);var yq=b(281),qs=b(1018),Em=b(103),Ml=b(1017),rs=b(761),ss=b(1034);class Wt extends zk{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je){super(a,d,n,z,O,ca,Da,Xa);this.C6j="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");this.Lxb="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");
this.QO=this.u0a=this.iNa=null;this.nva=Array(8);this.k8d=this.VNa=null;this.v0a=!1;this.j8d=this.Ohf=null;this.P4d=this.wbb=!1;this.KZ=this.JZ=this.IZ=this.LZ=this.N1=this.M1=this.L1=this.O1=this.w2=this.x2=0;this.wzh=yd;ca.dE(Object(m.a)(this,this.H0,"onSelectionChanged"));this.Cc=Yc;this.vJ=ff.a.instance;this.ga=l.AFrameworkApplication.pa;this.Eb=Vb;this.tf=zb;this.Ja=je}AXe(a,d,n,z,O){a.hasProperty(Xc.a.$ma)&&a.removeProperty(Xc.a.$ma);const ca=Array(4);ca[0]=d;ca[1]=n;ca[2]=z;ca[3]=O;a.setValue(Qb.a.TY,
ca)}n6m(a){a.setValue(Qb.a.oAa,0);a.setValue(Qb.a.zhc,"");this.AXe(a,0,0,0,0)}zXe(a,d,n,z,O){a.setValue(Qb.a.xnb,d);a.setValue(Qb.a.unb,n);a.setValue(Qb.a.vnb,z);a.setValue(Qb.a.wnb,O)}CXe(a,d,n,z){a.setValue(Qb.a.pH,d);a.setValue(Qb.a.xGb,n);a.setValue(Qb.a.BGb,z);a.setValue(Xc.a.pH,-1)}cEe(a,d){a=a.node;const n=Dd.GraphIterator.ua(a);if(Bd.ParagraphReader.nb(a)&&Bd.ParagraphReader.isEmpty(n)){var z=a.properties.Se(Qb.a.Ob);d.setValue(Qb.a.Ob,z);d.setValue(Qb.a.runId,1);z=new ss.a;d&&z.hn(d);n.Re(z,
6);this.L_g(a,z.anchor.node.id);this.u3.fSc(z);return new um(z,null,3)}return null}dEe(a,d){var n=this.Lxe();d&&n.hn(d);n.setValue(Qb.a.imageType,1);let z=0;uf.a.instance.J(5)&&(z=gf.a.HH(),n.setValue(Qb.a.$U,z));const O=a.node.Ib.Mu(n,n.id);n=this.hc.oga(a,ca=>new Hi.ImageBlobObject(ca,O),Vi.AParagraphNode.Xjb);yq.GraphTransactionManager.instance.bKd(a.node);if(this.Eb.Jf){const ca=new Ff.GraphTransaction(15);ca.Sa(a.node);this.tf.moa(a.node,a.cpBegin,a.cpBegin+1,1,null);ca.dispose()}this.u3.zRa&&
!d.fa(Qb.a.Cma,!1)&&this.u3.foa(a.node,a.cpBegin,a.cpBegin+1);return new um(a.node,n,0,z)}Ikg(a,d){if(!this.KGa(a))return!1;const n=this.Nb.Wb(7);n.Sa(a.node);l.AFrameworkApplication.K.ea("ContentAppIsEnabled")&&d.fa(Qb.a.$lg,!1)?this.GAd=this.cEe(a,d):this.GAd=this.dEe(a,d);n.dispose();return!0}jjc(a,d,n,z){if(!n.nb(a))return!1;n=this.Nb.Wb(7,Mb.a.EHi);n.Sa(a);var O=a.properties.fa(Vd.a.Vi,[]);O.push(0);for(let ca of O)if((O=z.Vve(a,ca))&&5===O.Qf&&O.id.equals(d))return this.hc.replaceTextRange(fe.a.createTextRange(a,
ca,ca+1),""),n.dispose(),!0;n.dispose();k.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}G5m(a,d,n,z){if(!Kd.ImageReader.eQ(a))return!1;d.set(a);d.La(12);const O=d.ul(12);if(!O)return k.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(n.Xob(O))return k.ULS.sendTraceTag(588817115,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),
!1;z(a);n=this.Nb.Wb(7);n.Sa(a);d.wg();n.dispose();return!0}a$m(a,d,n,z){return Kd.ImageReader.aVa(a)?this.R9m(a,n):Kd.ImageReader.m0(a)?this.b$m(a,d,n,z):!1}b$m(a,d,n,z){const O=this.Lxe();n&&O.hn(n);n=0;uf.a.instance.J(5)&&(n=gf.a.HH(),O.setValue(Qb.a.$U,n));n=a.node.Ib;a=a.node;z=z.fFc(a,5);for(let ca of z)if(ca.id.equals(d)){this.hc.replaceTextRange(fe.a.createTextRange(a,ca.Wa.cp,ca.Wa.cp+1),"");const Da=n.Mu(O,O.id);d=fe.a.Kb(a,ca.Wa.cp);this.hc.oga(d,Xa=>new Hi.ImageBlobObject(Xa,Da),Vi.AParagraphNode.Xjb);
return!0}return!1}R9m(a,d){if(!Kd.ImageReader.aVa(a))return!1;uf.a.instance.J(5)&&d.setValue(Qb.a.$U,gf.a.HH());a=a.node;var n=a.anchor.node.id;a=Dd.GraphIterator.ua(a);a.La(12);const z=a.parentNode;let O;z.properties.hasProperty(Qb.a.H6)?(O=z.properties.Se(Qb.a.H6),n=E.a.indexOf(O,n),-1!==n&&Array.removeAt(O,n)):O=[];z.properties.setValue(Qb.a.H6,Array.clone(O));a.wg();n=this.Ja&&this.Ja.isFeatureEnabled(78)?new qs.a:new Qg.a;n.hn(d);a.Re(n,6);this.L_g(z,n.anchor.node.id);return!0}KYd(a,d){this.v0a?
this.BZf():this.Ryn(a,d)}Cln(a,d){a.setValue(Xc.a.pH,d)}ICl(a){let d=null,n=null;if(!a)return k.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),{returnValue:null,view:d,$i:n};if(!Ic.InteractiveViewManager.instance.sc)return k.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:d,$i:n};const z=a.node;if(!z)return k.ULS.sendTraceTag(22381056,322,15,"Unable to obtain Image Element Container for Crop due to null Context Node."),
{returnValue:null,view:d,$i:n};n=z.Ib;const O=z.Qd(Ic.InteractiveViewManager.instance.sc.Za);if(!O)return k.ULS.sendTraceTag(23961792,322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),{returnValue:null,view:d,$i:n};d=O.Cf;if(a.Cj&&Kd.ImageReader.m0(a)){a=Kd.ImageReader.Yfa(a);if(!a)return k.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),{returnValue:null,view:d,$i:n};a=a.W4a(d);if(!a)return k.ULS.sendTraceTag(22381058,
322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,view:d,$i:n};a=a.element}else if(Kd.ImageReader.Xr(z))a=O.htmlElement;else return k.ULS.sendTraceTag(22381059,322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:d,$i:n};return{returnValue:a,view:d,$i:n}}$pn(a){for(let z=0;z<this.nva.length;z++){this.nva[z]=a.Yk(Cl.a.span);this.nva[z].className="WACImageCropHandles "+
this.C6j[z];if(2>=z){var d=a.Yk(Cl.a.span);d.className=this.Lxb[0];var n=a.Yk(Cl.a.span);n.className=this.Lxb[1];this.nva[z].appendChild(d);this.nva[z].appendChild(n)}else 4<z&&(d=a.Yk(Cl.a.span),d.className=this.Lxb[2],n=a.Yk(Cl.a.span),n.className=this.Lxb[3],this.nva[z].appendChild(d),this.nva[z].appendChild(n));if(!z||3===z||5===z)d=a.Yk(Cl.a.span),d.className=this.Lxb[4],n=a.Yk(Cl.a.span),n.className=this.Lxb[5],this.nva[z].appendChild(d),this.nva[z].appendChild(n);else if(2===z||4===z||7===
z)d=a.Yk(Cl.a.span),d.className=this.Lxb[6],n=a.Yk(Cl.a.span),n.className=this.Lxb[7],this.nva[z].appendChild(d),this.nva[z].appendChild(n)}}Ryn(a,d){k.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.v0a)k.ULS.sendTraceTag(22381061,322,100,"Attempted to start Crop Mode when it was already On.");else{var n=null,z=null;if((this.VNa=({view:n,$i:z}=this.ICl(d)).returnValue)&&n){this.VNa.classList.add("ImageCropMode");this.iNa=n.Yk(Cl.a.div);this.iNa.className="WACImageCropMode";
this.u0a=n.Yk(Cl.a.Aac);this.u0a.className="WACImageCropBase";this.QO=n.Yk(Cl.a.span);this.QO.className="WACImageCropSrcRect";this.$pn(n);this.iNa.appendChild(this.QO);for(n=0;n<this.nva.length;n++)this.QO.appendChild(this.nva[n]);this.iNa.appendChild(this.u0a);this.u0a.style.visibility="";this.u0a.style.display="";this.VNa.appendChild(this.iNa);this.WRm(a);z=Kd.ImageReader.$la(a,z);n=Kd.ImageReader.r1(a,Xc.a.gCa,null);this.u0a.src=n?n:Kd.ImageReader.ZHa(z);this.wzh&&this.wzh.execute(O=>{this.k8d||
(this.k8d=O.DCl(this))});this.wbb||(this.vJ.Er(this.VNa,this.k8d),this.wbb=!0);this.Cc&&this.Cc.Ea(vb.a.UJ,Ic.InteractiveViewManager.instance.editingView.editingElement,Object(m.a)(this,this.OJa,"onBeforeKeyDown"));this.v0a=!0;this.Ohf=a;this.j8d=d;this.P4d=!1;a=new Ff.GraphTransaction(4);a.Sa(this.j8d.node);this.Ohf.setValue(Xc.a.rsa,this.v0a);a.dispose()}else k.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}WRm(a){const d=
rf.a.ze(Kd.ImageReader.Tz(a),0),n=rf.a.ze(Kd.ImageReader.UA(a),1),z=Math.max(Kd.ImageReader.zba(a),0),O=Math.max(Kd.ImageReader.wba(a),0),ca=Math.max(Kd.ImageReader.xba(a),0),Da=Math.max(Kd.ImageReader.yba(a),0);this.x2=1E5*d/(1E5-(ca+Da));this.w2=1E5*n/(1E5-(z+O));this.O1=Math.floor(z*this.w2/1E5);this.L1=Math.floor(O*this.w2/1E5);this.M1=Math.floor(ca*this.x2/1E5);this.N1=Math.floor(Da*this.x2/1E5);this.QO.style.top=this.O1+"px";this.QO.style.bottom=this.L1+"px";this.QO.style.left=this.M1+"px";
this.QO.style.right=this.N1+"px";this.u0a.style.width=this.x2+"px";this.u0a.style.height=this.w2+"px";Kd.ImageReader.Aw(a)&&(this.iNa.style.width=this.x2+"px",this.iNa.style.height=this.w2+"px");this.LZ=this.O1;this.IZ=this.L1;this.JZ=this.M1;this.KZ=this.N1}BZf(a=!1){k.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.v0a?(a||this.JVk(),this.u0a?ae.a.HA(this.u0a):k.ULS.sendTraceTag(23961793,322,15,"Unable to clear imageCropBase dom element because it was already null."),this.VNa?
(this.iNa?this.iNa.parentNode===this.VNa?this.VNa.removeChild(this.iNa):k.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):k.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.VNa.classList.remove("ImageCropMode"),this.v0a=!1,a=new Ff.GraphTransaction(4),a.Sa(this.j8d.node),this.Ohf.setValue(Xc.a.rsa,this.v0a),a.dispose(),this.wbb&&(this.vJ.Lr(this.VNa,this.k8d),
this.wbb=!1),this.Cc&&this.Cc.kb(vb.a.UJ,Ic.InteractiveViewManager.instance.editingView.editingElement,Object(m.a)(this,this.OJa,"onBeforeKeyDown")),this.VNa=this.iNa=null):k.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):k.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}H0(){this.v0a&&this.BZf()}OJa(a){this.v0a&&a.Ua.keyCode!==xb.a.Ms&&this.BZf(!0);return!1}ROj(a,
d,n,z,O,ca,Da){if(n){n=Math.max(this.O1-d,0);let Xa=Math.floor(this.w2)-this.L1-n;5<=Xa?(this.LZ=n,this.IZ=this.L1):5>Xa&&0<=Xa||0>Xa&&!this.L1?(this.LZ=n-(5-Xa),this.IZ=this.L1):0>Xa&&5>=Math.abs(Xa)?(this.LZ=Math.floor(this.w2)-this.L1,this.IZ=Math.max(this.L1-(n-(this.w2-this.L1))-(5-Math.abs(Xa)),0)):(this.LZ=Math.floor(this.w2)-this.L1,this.IZ=Math.max(this.L1-(n-(this.w2-this.L1)),0));this.QO.style.top=this.LZ+"px";this.QO.style.bottom=this.IZ+"px";Da&&(this.O1=this.LZ,this.L1=this.IZ)}z&&(d=
Math.max(this.L1-d,0),z=Math.floor(this.w2)-this.O1-d,5<=z?(this.IZ=d,this.LZ=this.O1):5>z&&0<=z||0>z&&!this.O1?(this.IZ=d-(5-z),this.LZ=this.O1):0>z&&5>=Math.abs(z)?(this.IZ=Math.floor(this.w2)-this.O1,this.LZ=Math.max(this.O1-(d-(this.w2-this.O1))-(5-Math.abs(z)),0)):(this.IZ=Math.floor(this.w2)-this.O1,this.LZ=Math.max(this.O1-(d-(this.w2-this.O1)),0)),this.QO.style.top=this.LZ+"px",this.QO.style.bottom=this.IZ+"px",Da&&(this.O1=this.LZ,this.L1=this.IZ));O&&(O=Math.max(this.M1-a,0),d=Math.floor(this.x2)-
this.N1-O,5<=d?(this.JZ=O,this.KZ=this.N1):5>d&&0<=d||0>d&&!this.N1?(this.JZ=O-(5-d),this.KZ=this.N1):0>d&&5>=Math.abs(d)?(this.JZ=Math.floor(this.x2)-this.N1,this.KZ=Math.max(this.N1-(O-(this.x2-this.N1))-(5-Math.abs(d)),0)):(this.JZ=Math.floor(this.x2)-this.N1,this.KZ=Math.max(this.N1-(O-(this.x2-this.N1)),0)),this.QO.style.left=this.JZ+"px",this.QO.style.right=this.KZ+"px",Da&&(this.M1=this.JZ,this.N1=this.KZ));ca&&(a=Math.max(this.N1-a,0),ca=Math.floor(this.x2)-this.M1-a,5<=ca?(this.KZ=a,this.JZ=
this.M1):5>ca&&0<=ca||0>ca&&!this.M1?(this.KZ=a-(5-ca),this.JZ=this.M1):0>ca&&5>=Math.abs(ca)?(this.KZ=Math.floor(this.x2)-this.M1,this.JZ=Math.max(this.M1-(a-(this.x2-this.M1))-(5-Math.abs(ca)),0)):(this.KZ=Math.floor(this.x2)-this.M1,this.JZ=Math.max(this.M1-(a-(this.x2-this.M1)),0)),this.QO.style.left=this.JZ+"px",this.QO.style.right=this.KZ+"px",Da&&(this.M1=this.JZ,this.N1=this.KZ));Da&&(this.P4d=!0,Lb.App.oa.updateCommandUI())}AOk(){this.LZ=this.O1;this.IZ=this.L1;this.JZ=this.M1;this.KZ=this.N1;
this.QO.style.top=this.LZ+"px";this.QO.style.bottom=this.IZ+"px";this.QO.style.left=this.JZ+"px";this.QO.style.right=this.KZ+"px"}JVk(){if(this.P4d){k.ULS.sendTraceTag(22381066,322,50,"Commiting new Image Cropping Properties.");var a=Math.floor(1E5*this.O1/this.w2),d=Math.floor(1E5*this.L1/this.w2),n=Math.floor(1E5*this.M1/this.x2),z=Math.floor(1E5*this.N1/this.x2),O=new dh.DictionaryPropertySet;O.setValue(Xc.a.tnb,a);O.setValue(Xc.a.qnb,d);O.setValue(Xc.a.rnb,n);O.setValue(Xc.a.snb,z);this.ga.rf(this.j8d,
Dc.a.JLi,2,!1,null,O)}else k.ULS.sendTraceTag(23070481,322,50,"No New Cropping Properties To Commit.")}rsa(){return this.v0a}Wwl(){return{top:this.LZ,bottom:this.IZ,left:this.JZ,right:this.KZ}}RMn(a,d){if(0>a)k.ULS.sendTraceTag(22552777,322,15,"Unexpected negative value for new Crop properties.");else{switch(d){case 0:this.O1=this.LZ=Math.min(Math.floor(this.w2)-this.IZ-5,a);this.QO.style.top=this.LZ+"px";break;case 1:this.L1=this.IZ=Math.min(Math.floor(this.w2)-this.LZ-5,a);this.QO.style.bottom=
this.IZ+"px";break;case 2:this.M1=this.JZ=Math.min(Math.floor(this.x2)-this.KZ-5,a);this.QO.style.left=this.JZ+"px";break;case 3:this.N1=this.KZ=Math.min(Math.floor(this.x2)-this.JZ-5,a),this.QO.style.right=this.KZ+"px"}this.P4d=!0}}Lxe(){if(!this.Ja)return new Em.a;const a=this.Ja.isFeatureEnabled(208),d=this.Ja.isFeatureEnabled(78);return a?d?new Ml.a:new rs.a:new Em.a}}Object(t.a)(Wt,"ImageEditor",zk,[266,267]);class zq{constructor(){this.Z=null}get name(){return"WordEditor.ImageEditors"}Hb(a){this.Z=
a;this.Z.ha("WordEditor.ImageEditors.ImageCropDragAdapterFactory",()=>new Se(l.AFrameworkApplication.pa,la.a.instance.Ca("Common.IZoomManager"))).as("WordEditor.IImageCropDragAdapterFactory").singleInstance();this.Z.ha("WordEditor.ImageEditors.ImageEditor",()=>new Wt(a.resolve("Box4.IOutlineEditor"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.IParagraphEditor"),a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.ISelectionManager"),
a.Ca("Box4.IExternalSelectionManager"),a.resolve("Box4.ISelectionFactory"),a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.CatchUpActivity.IChangeIdEditor"),gb.KeyInputManager.instance,a.Ca("WordEditor.IImageCropDragAdapterFactory"),a.sa("Box4.IFeatureHelper"))).as("WordEditor.IImageEditor").as("Box4.Images.IImageEditor").singleInstance()}init(){this.Z.resolve("WordEditor.IImageCropDragAdapterFactory")}dispose(){}static main(){M.a.instance.Sb(new zq)}}
Object(t.a)(zq,"WordEditorImageEditorsPackage",null,[1,2]);class hq{}Object(t.a)(hq,"FolderContentEditor",null,[1238]);class Ks{}Object(t.a)(Ks,"PageEditor",null,[1138]);var jm=b(171);class Sr extends Ks{constructor(){super()}get Ze(){return jm.PageNavigator.instance}}Object(t.a)(Sr,"PageEditor",Ks,[]);class kr{get name(){return"WordEditor.NotebookLevelEditors"}Hb(a){a.ha("Box4.NotebookLevelEditors.FolderContentEditor",()=>new hq).as("Box4.Folder.IFolderContentEditor").singleInstance();a.ha("WordEditor.NotebookLevelEditors.PageEditor",
()=>new Sr).as("Box4.Pages.IPageEditor").singleInstance()}init(){}dispose(){}static main(){M.a.instance.Sb(new kr)}}Object(t.a)(kr,"WordEditorNotebookLevelEditorsPackage",null,[1,2]);class Tj{get aXa(){return l.AFrameworkApplication.vCa}i_(){k.ULS.sendTraceTag(37034014,342,50,"User clicked on the Privacy statement.");Ye.a.Tk(this.aXa,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(t.a)(Tj,"PrivacyLinkHandler",null,[742]);class Zs{constructor(a,d){this.xHh=null;this.Cmk=a;this.Bmk=
d}showDialog(a){this.xHh=a;this.Bmk.create().Ih(Object(m.a)(this,this.BVl,"handleDialog"))}BVl(a){1===a&&this.Cmk.ivj();this.xHh()}}Object(t.a)(Zs,"SendUsYourFileController",null,[724]);class Uq extends $g.StandardDialog{constructor(a,d,n){super();this.Ivc=null;this.ag=a;this.L$c=d;this.iL=n}Ih(a){this.wc=1;this.ee(1,this.iL.send);this.ee(0,this.iL.Fzm);k.ULS.shipAssertTag(37034013,342,!this.Ivc,"privacy anchor should be null before initializing it.");const d=this.H$k();this.P6a(this.iL.sCk,null,
"CancelRequest_32x32x32",null,a,d);this.k5(this.Kg(Uq.qvj))}H$k(){const a=document.createElement("span");a.innerText=this.iL.nUm;const d=document.createElement("span");d.innerText=this.iL.OCn;d.style.fontWeight=this.iL.EQn;const n=document.createElement("span");n.innerText=this.iL.Shn;const z=this.pXk(),O=document.createElement("span");O.id=this.Kg(Uq.qvj);O.appendChild(a);O.appendChild(document.createElement("br"));O.appendChild(document.createElement("br"));O.appendChild(d);O.appendChild(document.createElement("br"));
O.appendChild(n);O.appendChild(document.createElement("br"));O.appendChild(document.createElement("br"));O.appendChild(document.createElement("br"));O.appendChild(z);return O}pXk(){const a=document.createElement("span"),d=document.createElement("a");d.innerText=this.iL.fUm;d.href=this.L$c.aXa;a.appendChild(d);this.Ivc=d;this.ag.Ea(vb.a.click,this.Ivc,Object(m.a)(this.L$c,this.L$c.i_,"clickHandler"));return a}dispose(){this.Ivc&&(this.ag.kb(vb.a.click,this.Ivc,Object(m.a)(this.L$c,this.L$c.i_,"clickHandler")),
this.Ivc=null);super.dispose()}}Uq.qvj="sendUsYourFileId";Object(t.a)(Uq,"SendUsYourFileDialog",$g.StandardDialog,[741]);class Nl{create(){return la.a.instance.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialog")}}Object(t.a)(Nl,"Factory",null,[740]);var Jk=b(546);class Kf extends Jk.a{constructor(){super();this.FileId=null}Jk(){return 38}static construct(a){const d=new Kf;d.FileId=a;return d}}Object(t.a)(Kf,"CreateSendUsYourFileRequest",Jk.a,[]);var Ek=b(954);class Fl{constructor(a,d,n){this.Voa=
a;this.DZ=d;this.kfk=n}ivj(a=!1){if(this.DZ){const d=Kf.construct(this.DZ()),n=new Ek.a;n.Pq=d;n.status=1;n.RE="BootErrorReport";a=a?this.Voa(null):this.Voa(z=>{this.GRd(n,z)});a.PJ(n);a.yP();this.kfk()}}GRd(a){5===a.statusCode&&this.ivj(!0)}}Object(t.a)(Fl,"SendUsYourFileManager",null,[723]);class Ge{constructor(a,d){this.Z=null;this.iL=a;this.DZ=d}Hb(a){this.Z=a;this.Z.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings",()=>this.iL).singleInstance();this.Z.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialog",
()=>new Uq(Ae.a.instance,new Tj,this.Z.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings")));this.Z.ha("Wac.Common.SendUsYourFile.ISendUsYourFileManager",()=>new Fl(d=>this.Pla(0,d),this.DZ,()=>{k.ULS.sendTraceTag(42022664,342,50,"send us your file request is now sent.")}));this.Z.ha("Wac.Common.SendUsYourFile.ISendUsYourFileController",()=>{const d=new Nl;return new Zs(this.Z.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileManager"),d)}).singleInstance()}init(){this.Z.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileController")}dispose(){}}
Object(t.a)(Ge,"SendUsYourFilePackageManager",null,[]);var Ls=b(523),cp=b(902),Ft;(function(a){a[a.none=0]="none";a[a.oneNote=1]="oneNote";a[a.word=2]="word";a[a.wordViewer=3]="wordViewer";a[a.powerPoint=4]="powerPoint"})(Ft||(Ft={}));Object(t.b)("AppMode",Ft);class ts{get sCk(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get Fzm(){return CommonUIStrings.l_NoThanks}get nUm(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get OCn(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get EQn(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get Shn(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get fUm(){return CommonUIStrings.l_PrivacyStatement}}
Object(t.a)(ts,"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class Xt extends Ge{constructor(){super(new ts,()=>l.AFrameworkApplication.rootQuerySignature)}Pla(a,d){return new cp.a(a,d,"SendUsYourFile.ashx",Ft.word,Lb.App.webServiceBase,void 0,void 0,Ls.a.amIAlone,Ls.a.zVe,Ls.a.nVe)}get name(){return"WordEditor.SendUsYourFile"}static main(){M.a.instance.Sb(new Xt)}}Object(t.a)(Xt,"PackageManager",Ge,["__INTERFACE__@1js/msoserviceplatform:IPackage",
"__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);var so=b(644),Vq=b(607),Aq=b(411);class Zh extends Aq.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(t.a)(Zh,"IconGalleryButtonProps",Aq.a,[]);var zh=b(118),Sf=b(28),an=b(153),zl=b(72),on=b(780),mg=b(165),Xn=b(1515);class Sp{constructor(a,d,n,z,O,ca){this.Jri=a;this.gallerySectionId=d;this.bil=n;this.mBk=z;this.commandId=O;this.queryCommandId=ca}}
Object(t.a)(Sp,"BorderStyleMenuPropsArguments",null,[]);class Yk{constructor(a,d,n,z,O,ca,Da){this.Jzc=a;this.lGj=d;this.width=n;this.p7i=z;this.height=O;this.KXi=ca;this.altText=Da}}Object(t.a)(Yk,"TableBorderStyleProperties",null,[]);class Cf{constructor(){this.o1h=[new Yk(Cf.cEj,"","2",1,8,0,"Solid Line"),new Yk(Cf.zei,"5,3","1",1,8,0,"Dashed Line"),new Yk(Cf.Bii,"1,1","1",1,8,0,"Dotted Line"),new Yk(Cf.Cii,"","1",2,8,3,"Double Line")];this.p1h=[new Yk(Cf.w1h,"","1",1,8,0,"0.25pt"),new Yk(Cf.t1h,
"","1",1,8,0,"0.5pt"),new Yk(Cf.z1h,"","2",1,8,0,"0.75pt"),new Yk(Cf.u1h,"","2",1,8,0,"1pt"),new Yk(Cf.s1h,"","3",1,8,0,"1.5pt"),new Yk(Cf.A1h,"","4",1,8,0,"2.25pt"),new Yk(Cf.y1h,"","4",1,8,0,"3pt"),new Yk(Cf.r1h,"","5",1,8,0,"4.5pt"),new Yk(Cf.x1h,"","6",1,8,0,"6pt")]}initialize(){this.o3m()}Jpl(){const a=new Sp("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.o1h,Mb.a.Itb,Mb.a.gTe);return this.$ri(a)}Kpl(){const a=new Sp("Line Weight gallery","DefaultLineWeightOptions",
"LineWeightOptionsGallery",this.p1h,Mb.a.Jtb,Mb.a.hTe);return this.$ri(a)}Iti(a){switch(a){case Cf.cEj:return mg.a.Kzc;case Cf.zei:return mg.a.xCb;case Cf.Bii:return mg.a.Jid;case Cf.Cii:return mg.a.vaa;default:return mg.a.p3}}Jti(a){switch(a){case Cf.w1h:return mg.a.v1h;case Cf.t1h:return mg.a.NHf;case Cf.z1h:return mg.a.Hzc;case Cf.u1h:return mg.a.w2a;case Cf.s1h:return mg.a.Zxa;case Cf.A1h:return mg.a.mRa;case Cf.y1h:return mg.a.ffa;case Cf.r1h:return mg.a.Ohb;case Cf.x1h:return mg.a.$xa;default:return mg.a.YJ}}$ri(a){const d=
new he.a,n=new fi.a,z=Object.assign(new Vq.a,{Id:a.Jri,ExternalId:a.gallerySectionId,ExternalGalleryId:a.bil,Type:4,Width:1,GalleryItems:[]});for(let ca of a.mBk){var O={};const Da={};Da.width=Cf.Gkm;Da.height=Cf.Fkm;O.root=Da;O=Object.assign(new Zh,{Id:ca.Jzc,ExternalId:String.format("{0}_GalleryButton",ca.Jzc),Icon:ca.Jzc,Command:a.commandId.toString(),QueryCommand:a.queryCommandId.toString(),MenuItemId:ca.Jzc,FullIconStyle:O,ShouldSetTitle:"true",Alt:ca.altText});z.GalleryItems.push(O)}n.ControlList=
[];d.MenuSectionList=[];n.ControlList.push(z);d.MenuSectionList.push(n);d.UpdateDynamically=!0;return d}o3m(){const a={};for(let d of this.o1h)a[d.Jzc]=appChrome.buildBorderStyleIcon(d.lGj,d.width,d.p7i,d.height,d.KXi);for(let d of this.p1h)a[d.Jzc]=appChrome.buildBorderStyleIcon(d.lGj,d.width,d.p7i,d.height,d.KXi);appChrome.api.registerIconProvider(()=>a)}Win(a,d,n){if(!a)return k.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(a.contextId!==Kb.a.dJ)return k.ULS.sendTraceTag(577910617,
306,15,"Context should be of type table border. Getting context of type: {0}",a.contextId),!1;switch(a.border){case 2:this.H8(zh.a.VX(a),a.node,5,n,d);break;case 0:this.H8(zh.a.VX(a),a.node,3,n,d);break;case 1:this.H8(zh.a.VX(a),a.node,4,n,d);break;case 3:this.H8(zh.a.VX(a),a.node,0,n,d);break;case 7:this.H8(zh.a.VX(a),a.node,1,n,d);break;case 8:this.H8(zh.a.VX(a),a.node,2,n,d);break;case 6:this.H8(zh.a.VX(a),a.node,1,n,d);this.H8(zh.a.VX(a),a.node,2,n,d);break;case 5:this.H8(zh.a.VX(a),a.node,3,
n,d);this.H8(zh.a.VX(a),a.node,5,n,d);this.H8(zh.a.VX(a),a.node,4,n,d);this.H8(zh.a.VX(a),a.node,0,n,d);break;case 4:this.H8(zh.a.VX(a),a.node,3,n,d),this.H8(zh.a.VX(a),a.node,5,n,d),this.H8(zh.a.VX(a),a.node,4,n,d),this.H8(zh.a.VX(a),a.node,0,n,d),this.H8(zh.a.VX(a),a.node,1,n,d),this.H8(zh.a.VX(a),a.node,2,n,d)}return!0}X_g(a,d,n,z){if(!d)return k.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(d.contextId!==Kb.a.eJ)return k.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",
d.contextId),!1;var O=d.node;const ca=new Dd.GraphIterator;ca.set(O);ca.La(14);O=Sf.TableCellReader.pTa(ca);switch(d.border){case 2:this.S8a(a,d.node,5,z,n,O);this.SXe(d.node,5,n);this.bXe(a,d.q4a(),3,n,z,O);break;case 0:this.S8a(a,d.node,3,z,n,O);this.SXe(d.node,3,n);this.bXe(a,d.q4a(),1,n,z,O);break;case 1:this.S8a(a,d.node,4,z,n,O);this.SXe(d.node,4,n);this.bXe(a,d.q4a(),0,n,z,O);break;case 3:this.S8a(a,d.node,0,z,n,O),this.SXe(d.node,0,n),this.bXe(a,d.q4a(),2,n,z,O)}return!0}OXm(a,d){if(Qd.SelectionEditor.kIb(a)&&
d)switch(a=Object(qa.a)(an.TableNodeBorderContext,a),a.border){case 2:this.ZU(a.node,Cf.$n.pS(5),d);break;case 0:this.ZU(a.node,Cf.$n.pS(3),d);break;case 3:this.ZU(a.node,Cf.$n.pS(0),d);break;case 1:this.ZU(a.node,Cf.$n.pS(4),d);break;case 7:this.ZU(a.node,Cf.$n.pS(1),d);break;case 8:this.ZU(a.node,Cf.$n.pS(2),d);break;case 5:d=this.ZU(a.node,Cf.$n.pS(5),d);d=this.ZU(a.node,Cf.$n.pS(3),d);d=this.ZU(a.node,Cf.$n.pS(0),d);this.ZU(a.node,Cf.$n.pS(4),d);break;case 6:d=this.ZU(a.node,Cf.$n.pS(1),d);this.ZU(a.node,
Cf.$n.pS(2),d);break;case 4:d=this.ZU(a.node,Cf.$n.pS(5),d),d=this.ZU(a.node,Cf.$n.pS(3),d),d=this.ZU(a.node,Cf.$n.pS(0),d),d=this.ZU(a.node,Cf.$n.pS(4),d),d=this.ZU(a.node,Cf.$n.pS(1),d),this.ZU(a.node,Cf.$n.pS(2),d)}}dXm(a,d){if(Qd.SelectionEditor.hpb(a)&&d)switch(a=Object(qa.a)(an.TableNodeBorderContext,a),a.border){case 2:this.ZU(a.node,Cf.$n.XU(5),d);break;case 0:this.ZU(a.node,Cf.$n.XU(3),d);break;case 3:this.ZU(a.node,Cf.$n.XU(0),d);break;case 1:this.ZU(a.node,Cf.$n.XU(4),d)}}L5f(a,d,n){n=
null;if(!a)return k.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),n;a.properties.hasProperty(d.size)&&(n=new Xn.a,n.weight=a.properties.fa(d.size,mg.a.YJ),n.style=a.properties.fa(d.style,mg.a.p3),n.color=a.properties.fa(d.color,0));return n}W_g(a,d,n){a?n?(a.properties.setValue(d.size,n.weight),a.properties.setValue(d.style,n.style),a.properties.setValue(d.color,n.color)):k.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):k.ULS.sendTraceTag(575980877,306,
15,"Node should not be null")}ejc(a,d){a?(a.properties.removeProperty(d.size),a.properties.removeProperty(d.style),a.properties.removeProperty(d.color)):k.ULS.sendTraceTag(575980879,306,15,"Node should not be null")}H8(a,d,n,z,O){O=this.vPn(a,d,n,z,O);this.eSc(d,Cf.$n.pS(n),O);switch(n){case 5:this.p8a(d,2,z,O);break;case 4:this.p8a(d,1,z,O);break;case 0:this.p8a(d,3,z,O);break;case 3:this.p8a(d,0,z,O);break;case 1:this.p8a(d,7,z,O);break;case 2:this.p8a(d,8,z,O)}}vPn(a,d,n,z,O){if(3!==z){var ca=
Cf.De.Twe(a,d,n,3);void 0!==ca&&null!==ca&&ca!==mg.a.FR&&(ca=zl.a.Zjc(ca),O.color=Cf.qUc.IRa(d,ca))}1!==z&&(ca=Cf.De.Twe(a,d,n,1),void 0!==ca&&null!==ca&&ca!==mg.a.XJ&&(O.weight=parseFloat(ca)*mg.a.Izc));2!==z&&(a=Cf.De.Twe(a,d,n,2),void 0!==a&&null!==a&&a!==mg.a.XJ&&(O.style=a));return O}S8a(a,d,n,z,O,ca){z&&(O=this.fLn(a,d,ca,n,z,O));this.eSc(d,Cf.$n.XU(n),O)}fLn(a,d,n,z,O,ca){if(3!==O){var Da="",Xa=Cf.De.h9b(a,d,z,!1,!0,n,3);Xa&&(Da=Xa.I3b);void 0!==Da&&null!==Da&&Da!==mg.a.FR&&(Da=zl.a.Zjc(Da),
ca.color=Cf.qUc.IRa(d,Da))}if(1!==O){Da="";if(Xa=Cf.De.h9b(a,d,z,!1,!0,n,1))Da=Xa.I3b;void 0!==Da&&null!==Da&&Da!==mg.a.XJ&&(ca.weight=parseFloat(Da)*mg.a.Izc)}if(2!==O){O="";if(a=Cf.De.h9b(a,d,z,!1,!0,n,2))O=a.I3b;void 0!==O&&null!==O&&O!==mg.a.XJ&&(ca.style=O)}return ca}Ixm(a){let d=0,n=0;({mxm:d,lvm:n}=this.dGl(a.style,d,n));a.weight<d&&(a.weight=d);a.weight>n&&(a.weight=n);return a}dGl(a,d,n){switch(a){case mg.a.Kzc:case mg.a.xCb:case mg.a.Jid:d=2;n=48;break;case mg.a.vaa:d=2;n=24;break;default:d=
2,n=48}return{mxm:d,lvm:n}}bXe(a,d,n,z,O,ca){if(d)if(z)for(let Da=0;Da<d.length;Da++)switch(n){case 2:this.S8a(a,d[Da],5,O,z,ca);break;case 0:this.S8a(a,d[Da],3,O,z,ca);break;case 1:this.S8a(a,d[Da],4,O,z,ca);break;case 3:this.S8a(a,d[Da],0,O,z,ca)}else k.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else k.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}SXe(a,d,n){const z=new Dd.GraphIterator;z.set(a);z.La(14);const O=Sf.TableCellReader.nS(a);
a=Sf.TableCellReader.Sz(a);Uf.forEachCell(z,O,a,(ca,Da,Xa)=>{ca=ca.currentNode;Sf.TableCellReader.jo(ca)&&0==Xa&&0<Da&&this.eSc(ca,Cf.$n.XU(d),n)})}eSc(a,d,n){a?(n=this.Ixm(n),a.properties.setValue(d.color,n.color),a.properties.setValue(d.size,n.weight),a.properties.setValue(d.style,n.style)):k.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}p8a(a,d,n,z){if(a){var O=If.TableReader.Sf(a),ca=If.TableReader.nh(a),Da=new Dd.GraphIterator,Xa=[];for(let zb=0;zb<O;zb++)for(let Vb=0;Vb<
ca;Vb++)if(Da.set(a),Uf.moveToCell(Da,zb,Vb),Da&&Da.currentNode&&!Sf.TableCellReader.we(Da))switch(d){case 2:Sf.TableCellReader.AS(Da)&&Array.add(Xa,an.TableNodeBorderContext.xN(Da.currentNode,2));break;case 0:Sf.TableCellReader.Wba(Da)&&Array.add(Xa,an.TableNodeBorderContext.xN(Da.currentNode,0));break;case 3:Sf.TableCellReader.hDd(a,Da.currentNode)&&Array.add(Xa,an.TableNodeBorderContext.xN(Da.currentNode,3));break;case 1:Sf.TableCellReader.iDd(a,Da.currentNode)&&Array.add(Xa,an.TableNodeBorderContext.xN(Da.currentNode,
1));break;case 7:Sf.TableCellReader.iDd(a,Da.currentNode)||Array.add(Xa,an.TableNodeBorderContext.xN(Da.currentNode,1));break;case 8:Sf.TableCellReader.hDd(a,Da.currentNode)||Array.add(Xa,an.TableNodeBorderContext.xN(Da.currentNode,3))}for(a=0;a<Xa.length;a++)switch(d=Xa[a],d.border){case 2:this.jQd(d.node,Cf.$n.XU(5),n,z);this.fUe(d.q4a(),Cf.$n.XU(0),n,z);break;case 0:this.jQd(d.node,Cf.$n.XU(3),n,z);this.fUe(d.q4a(),Cf.$n.XU(4),n,z);break;case 1:this.jQd(d.node,Cf.$n.XU(4),n,z);this.fUe(d.q4a(),
Cf.$n.XU(3),n,z);break;case 3:this.jQd(d.node,Cf.$n.XU(0),n,z),this.fUe(d.q4a(),Cf.$n.XU(5),n,z)}}else k.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}fUe(a,d,n,z){if(a)for(let O=0;O<a.length;O++)this.jQd(a[O],d,n,z);else k.ULS.sendTraceTag(578062292,306,15,"Adjacent cell array should not be null")}jQd(a,d,n,z){if(a){var O=a.fa(d.color,Cf.BUf),ca=a.fa(d.size,Cf.DUf),Da=a.fa(d.style,Cf.CUf),Xa=new Xn.a;Xa.weight=z.weight;Xa.style=z.style;Xa.color=z.color;2!==n||O===Cf.BUf&&ca===
Cf.DUf?3!==n||Da===Cf.CUf&&ca===Cf.DUf?1!==n||O===Cf.BUf&&Da===Cf.CUf?(a.properties.removeProperty(d.color),a.properties.removeProperty(d.size),a.properties.removeProperty(d.style)):(Xa.color=O,Xa.style=Da,this.eSc(a,d,Xa)):(Xa.style=Da,Xa.weight=ca,this.eSc(a,d,Xa)):(Xa.color=O,Xa.weight=ca,this.eSc(a,d,Xa))}else k.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}ZU(a,d,n){var z=a.properties.fa(d.style,mg.a.XJ);z!==mg.a.XJ&&(n.fGd!==mg.a.XJ?n.fGd!==z&&(n.fGd=mg.a.PHk):n.fGd=z);
z=a.properties.fa(d.size,mg.a.YJ);z!==mg.a.YJ&&(n.hGd!==mg.a.YJ?n.hGd!==z&&(n.hGd=mg.a.MHk):n.hGd=z);a=a.properties.fa(d.color,0);a=zl.a.LA(a);a!==mg.a.FR&&(n.borderColor!==mg.a.FR?n.borderColor!==a&&(n.borderColor=mg.a.KHk):n.borderColor=a);return n}static get $n(){return Cf.WV||(Cf.WV=mg.a.instance)}static get De(){return Cf.qq||(Cf.qq=la.a.instance.sa("WordEditor.IWACTableStyleReader"))}static get qUc(){return Cf.Idd||(Cf.Idd=on.a.instance)}}Cf.Gkm="110px";Cf.Fkm="20px";Cf.cEj="SolidLineStyle";
Cf.zei="DashedLineStyle";Cf.Bii="DottedLineStyle";Cf.Cii="DoubleLineStyle";Cf.w1h="BorderPointSizeOneQuarter";Cf.t1h="BorderPointSizeOneHalf";Cf.z1h="BorderPointSizeThreeQuarters";Cf.u1h="BorderPointSizeOne";Cf.s1h="BorderPointSizeOneAndHalf";Cf.A1h="BorderPointSizeTwoAndQuarter";Cf.y1h="BorderPointSizeThree";Cf.r1h="BorderPointSizeFourAndHalf";Cf.x1h="BorderPointSizeSix";Cf.CUf="single";Cf.DUf=4;Cf.BUf=0;Cf.WV=null;Cf.qq=null;Cf.Idd=null;Object(t.a)(Cf,"TableBorderManager",null,[431]);var sp=b(824),
km=b(56),Tr=b(193);class lr{constructor(a,d){this.aLh=this.GGh=null;this.N6=a;this.BIh=d}get scj(){return this.BIh}get RBa(){return this.GGh}get HSg(){return this.aLh}tyj(a,d){this.aLh=a;this.GGh=d}Umn(a){this.BIh=a}}Object(t.a)(lr,"CellNodeAndOutlineElementInfoForInsertion",null,[]);var wh=b(98),$s=b(195),Ur=b(360),iq=b(142),jq=b(262),Bq=b(552),Vr=b(82),Cq=b(413),Wr=b(846);class Xh extends sp.a{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc=null,Yc=null){var yd;super(a,d,n,Yc,Fc);this.uub=!1;this.Dxb=Wr.a.instance;
this.ka=new oc.a;this.SKf=[Qb.a.Jub,Qb.a.QYa,Qb.a.Iub,Qb.a.Eub,Qb.a.OYa,Qb.a.Dub,Qb.a.Cub,Qb.a.NYa,Qb.a.Bub,Qb.a.Gub,Qb.a.PYa,Qb.a.Fub];this.O4j=[Qb.a.GE,Qb.a.Lt,Vd.a.Mj,Vd.a.wK];this.aj=z;this.E0b=O;this.mc=ca;this.Da=Da;this.b2=Xa;this.so=zb;this.f2c=Vb;this.yQh=Fc;this.tqk=Yc;this.uub=null===(yd=l.AFrameworkApplication.K)||void 0===yd?void 0:yd.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableAriaAttributesDuringRender",!1)}get $i(){return this.aj.value}get Zt(){return this.b2?this.b2.instance:
null}TCf(a){this.ka.addHandler("OnParagraphDelete",a)}get ye(){return!!this.f2c.instance&&this.f2c.instance.ye}EAd(a,d,n,z,O){d.setValue(Qb.a.Ob,gf.a.HH());d.setValue(Qb.a.gQi,O);Bq.b(z,d,[Qb.a.pT]);super.EAd(a,d,n,z,O)}ODe(a,d,n,z,O){const ca=this.Vxd(d,n,z,O);this.Ooe(ca,d,!1);return super.ODe(a,d,n,z,O)}Ohe(a,d,n,z,O){const ca=this.Vxd(d,n,z,O);this.Ooe(ca,d,!0);super.Ohe(a,d,n,z,O);return ca}cQf(a,d,n,z){d=this.Vxd(a,d,n,z);this.Ooe(d,a,!0);return d}insertRows(a,d,n,z){const O=km.a.hm(a),ca=new Dd.GraphIterator;
ca.Cb(a);const Da=ca.currentNode;ca.Va(1);let Xa;Xa=d?a.$p(1):a.currentNode;const zb=a.hb();if(!zb)throw Error.create("table row insertion cannot be performed on a null tableNode");const Vb=If.TableReader.Sf(zb),Fc=zb.p_.De;let Yc=!1;try{zb.NCa=1;const yd=this.Dxb.mFb(zb,Fc.gD(zb));this.fDa(a.currentNode);this.NDa(a);this.Fvk(n,a,Xa,ca,Da,d,z);const je=this.Dxb.mFb(zb,Fc.gD(zb));this.Dtb(zb,If.TableReader.Sf(zb)+n);Yc=!0;this.yEe(zb,yd,je)}finally{zb.NCa=0,Yc||this.Dtb(zb,If.TableReader.Sf(zb)+n)}O+
1!==Vb||d?!O&&d&&Xh.slg(zb,n):Xh.slg(zb,O);d=O+n+(d?0:1);d<Vb+n&&this.SOi(zb,d);return a.currentNode}Fvk(a,d,n,z,O,ca,Da){let Xa=null,zb=null;for(var Vb=0;Vb<a;++Vb){var Fc=Tr.a.instance.createInstance(393251);zb||(zb=Fc);Xa=Fc;this.EAd(d,Fc,n,O,ca)}a=If.TableReader.nh(d.currentNode);n=!0;do{n?(d.rg(Xa),n=!1):d.Kd(1);O=Array(a);for(Vb=0;Vb<a;++Vb){Fc=this.w3a();const Yc=this.cQf(Fc,z.currentNode,ca,!0);let yd=null;Yc.we||(yd=Da(Yc));O[Vb]=new lr(Fc,yd);O[Vb].tyj(Yc,null);z.Kd(1)}for(Vb=0;Vb<a;++Vb)Fc=
O[Vb].N6,d.E6(Fc,1,sp.a.m0a?sp.a.m0a():null),Sf.TableCellReader.jo(Fc)||(this.a3b(d,Fc,O[Vb].scj),this.Lai(O[Vb].HSg,Fc,!0));z.ZP(1)}while(d.currentNode!==zb)}insertColumns(a,d,n,z,O){let ca=a.currentNode,Da=!1,Xa=If.TableReader.nh(a.currentNode);const zb=Xa;try{this.fDa(a.currentNode);this.NDa(a);const Vb=ca.p_.De;ca.NCa=1;const Fc=this.Dxb.mFb(ca,Vb.gD(ca));Xa=If.TableReader.nh(a.currentNode);-1===d&&(d=Xa);this.Dvk(a,z,n,d,O);ca=a.currentNode;Xa+=z;this.BRg(a,Xa,z,d);Da=!0;const Yc=this.Dxb.mFb(ca,
Vb.gD(ca));this.yEe(ca,Fc,Yc)}finally{ca.NCa=0,Da||this.BRg(a,Xa,z,d)}d!==zb||n?!d&&n&&Xh.rlg(ca,z):Xh.rlg(ca,d-1)}Dvk(a,d,n,z,O){var ca=a.currentNode;z=n?z:z-1;a.Va(1);var Da=new db.a;do{var Xa=a.Vr(z,1);a.hb();var zb=Array(d);for(let Fc=0;Fc<d;++Fc){var Vb=this.w3a();const Yc=this.tHl(a,Xa,n),yd=this.cQf(Vb,Xa,n,!1);Vb=new lr(Vb,null);Vb.tyj(yd,Yc);zb[Fc]=Vb}Da.add(zb)}while(a.jh(1));n=Da.toArray();for(z=0;z<n.length;z++)for(Da=0;Da<d;Da++)Xa=n[z][Da],zb=Xa.HSg,zb.we||Xa.Umn(O(zb));a.set(ca);a.Va(1);
O=0;do{for(ca=0;ca<d;++ca)z=n[O][ca],Da=z.N6,a.Mnb(Da,z.RBa,1,sp.a.m0a?sp.a.m0a():null),Sf.TableCellReader.jo(Da)||(this.a3b(a,Da,z.scj),this.Lai(z.HSg,Da,!1));O++}while(a.jh(1))}yEe(a,d,n){if(d){var z=2===a.NCa,O=[],ca=new Dd.GraphIterator;ca.set(a);for(var Da=ca.Va(1);Da;){for(Da=ca.Va(1);Da;){const Xa=Da.id.toString();Xa in d&&d[Xa]===n[Xa]&&(!z||!Sf.TableCellReader.Wba(ca)&&!Sf.TableCellReader.AS(ca))||O.push(Da);Da=ca.jh(1)}Da=ca.jh(1)}if(0<O.length){d=new Ff.GraphTransaction(3);try{d.set(a.Bf);
for(let Xa of O)Xa.$Ad(4)}finally{d&&d.dispose()}}}}deleteRows(a,d){const n=km.a.hm(a),z=n+d;let O=a.hb();const ca=O.p_.De;let Da=!1;k.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",O.id.toString(),O.type,n,d);const Xa=If.TableReader.Sf(O);try{O.NCa=2;const zb=this.Dxb.mFb(O,ca.gD(O));this.fDa(a.currentNode);this.NDa(a);for(let Fc=z-1;Fc>=n;--Fc){a.Vr(Fc,1);let Yc=a.Va(1);for(;Yc;)this.HJd(Yc,!0),Yc=a.jh(1);
this.Kmb(a);k.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",a.currentNode.id.toString(),a.Yc);a.wg()}O=a.currentNode;const Vb=this.Dxb.mFb(O,ca.gD(O));this.Dtb(O,If.TableReader.Sf(O)-d);this.zNe(a);Da=!0;this.yEe(O,zb,Vb)}finally{O.NCa=0,Da||(this.Dtb(a.currentNode,If.TableReader.Sf(a.currentNode)-d),this.zNe(a))}Xa===z&&0<=n-1&&Xh.slg(O,n-1);n<Xa-d&&this.SOi(O,n)}deleteColumns(a,d,n){a=Object(qa.a)(Dd.GraphIterator,a);let z=Object(qa.a)(Cq.a,a.currentNode),O=If.TableReader.nh(a.currentNode);
const ca=z.p_.De;let Da=!1;k.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",z.id.toString(),z.type,d,n);const Xa=O;try{z.NCa=2;const zb=this.Dxb.mFb(z,ca.gD(z));this.fDa(a.currentNode);this.NDa(a);-1===d&&(d=O-n);a.Va(1);do for(let Fc=d+n-1;Fc>=d;--Fc)a.Vr(Fc,1),this.HJd(a.currentNode,!1),this.Kmb(a),a.wg();while(a.jh(1));O-=n;this.ARg(a,O,d,n);Da=!0;z=Object(qa.a)(Cq.a,a.currentNode);const Vb=this.Dxb.mFb(z,
ca.gD(z));this.yEe(z,zb,Vb);this.yNe(a)}finally{z&&(z.NCa=0),Da||(this.ARg(a,O,d,n),this.yNe(a))}Xa===d+n&&0<=d-1&&Xh.rlg(z,d-1)}mergeCells(a,d,n){if(a&&(1!==d||1!==n)){var z=new Dd.GraphIterator;z.Cb(a);z.La(14);this.QRf(z,d,n);this.PKn(z,d,n);z.hb();z.hb();this.m$i(z)}}CEj(a,d,n){if(a&&(1!==d||1!==n)){var z=new Dd.GraphIterator;z.Cb(a);z.La(14);this.x4k(z,d,n);z.hb();z.hb();this.Xaj(z)}}HJd(a,d){k.ULS.sendTraceTag(579479250,341,50,"Table cell getting deleted. ID:{0}, Type:{1}",a.id.toString(),a.type);
this.tVl(a,d,Object(m.a)(this,this.rPg,"promoteToNonGhostCellImpl"))}rPg(a,d){const n=a.currentNode;n.we=!1;this.Ooe(d.currentNode,a.currentNode,!0);n.removeProperty(Qb.a.skippedCell);n.removeProperty(Qb.a.renderCell);1===n.colSpan&&1===n.rowSpan&&n.F4b();sp.a.Cq.I6(a,!0,sp.a.lBi(d.currentNode));Uf.returnToCell(a)}wfg(a,d,n){super.wfg(a,d,n);1===d.controlCell.colSpan&&1===d.controlCell.rowSpan?d.controlCell.F4b():!n&&d.VVe&&(a.bAa?1<a.colSpan&&(d=new Dd.GraphIterator,d.set(a),d.La(15),Uf.moveToNextColumn(d),
d.currentNode.colSpan=a.colSpan-1):(n=new Dd.GraphIterator,n.set(d.controlCell),n.La(15),d=Vr.a(n),n=new Dd.GraphIterator,n.set(a),n.La(15),Uf.moveToColumnByIndex(n,d),--n.currentNode.colSpan))}Vxd(a,d,n,z){const O=super.Vxd(a,d,n,z);if(a.we&&!z){var ca=d.N6a;ca.VVe&&(z=sp.a.nFc(ca.controlCell,z),!ca.xne&&n||ca.xne===z-1&&!n?a.colSpan=1:(n=new Dd.GraphIterator,n.set(ca.controlCell),n.La(15),ca=Vr.a(n),n=new Dd.GraphIterator,n.set(d),n.La(15),Uf.moveToColumnByIndex(n,ca),n.currentNode.colSpan+=1))}O.fa(Qb.a.skippedCell,
!1)&&(a.we=!0,a.kV=!0,a.f9a=!0);return O}zNe(a){this.Doc(a,Qb.a.complexTable)}yNe(a){this.Doc(a,Qb.a.complexTable)}m$i(a){this.Doc(a,Qb.a.complexTable)}Xaj(a){this.Doc(a,Qb.a.complexTable)}Ooe(a,d,n){a&&(Bq.b(a,d,this.SKf),Bq.b(a,d,[Vd.a.BL]),n&&Bq.b(a,d,[Qb.a.gG,Qb.a.fJ,Qb.a.jua,Qb.a.iua,Qb.a.Aoa,Qb.a.skippedCell,Qb.a.renderCell]))}Lai(a,d,n){a&&(a=Dd.GraphIterator.ua(a),a.kc(),a.Rc(),d=Dd.GraphIterator.ua(d),d.kc(),d.Rc(),Ia.OutlineElementReader.gg(a)&&qe.OutlineElementNavigator.Sd(a)&&Ia.OutlineElementReader.gg(d)&&
qe.OutlineElementNavigator.Sd(d)&&Bq.b(a.currentNode,d.currentNode,this.O4j),n&&(qe.OutlineElementNavigator.Uc(a),qe.OutlineElementNavigator.Uc(d),Bf.ListReader.Bh(a)&&(n=Xh.clm.ht(a),n.cA=wh.a.uh,{JUa:n}=Xh.es.wGa(n.propertySet,d,n))))}Kmb(a){this.ye&&this.so.m5m(a.currentNode);for(a=$s.a.Ep(a);a.moveNext();)if(Bd.ParagraphReader.nb(a.currentNode)){const d=Lj.e(a.currentNode);for(let n of d)n.xca();this.ka.raiseEvent("OnParagraphDelete",a.currentNode)}else Bf.ListReader.Bh(a.iterator)&&this.Zt&&
this.Zt.Gta(a.iterator)}NH(a,d){let n=null;if(this.yQh.Jf){const z=Object(qa.a)(Cq.a,a);z&&(n=z.VE())}If.TableReader.wi(a)&&(1===d?d=3:3===d&&(d=1));super.NH(a,d);this.yQh.Jf&&this.tqk.bda(a,n);Object(Uc.a)(Cq.a,a)&&sp.a.Ee.ezj(Object(qa.a)(Cq.a,a),(new Ur.a(1,0)).pu)}w1g(a,d){const n=Array(d),z=this.gFi(a)/d;for(let O=0;O<d;O++)n[O]=Math.max(rf.a.hl(iq.a.s5,0),z);a.setValue(Vd.a.Ks,n)}Yxj(a){a.setValue(Qb.a.tableLayout,0)}jXh(a,d,n,z,O){const ca=Array(n);for(var Da=0,Xa=0;Da<z;++Da)ca[Da]=d[Da],
Xa+=ca[Da];for(;Da<n;++Da)ca[Da]=0>Da-O?d[0]:d[Da-O],Xa+=ca[Da];Da=this.gFi(a.currentNode);if(Xa>Da)for(Xa=Da/Xa,Da=0;Da<n;++Da)ca[Da]=Math.max(rf.a.hl(iq.a.s5,0),ca[Da]*Xa);return ca}gFi(a){var d=Dd.GraphIterator.ua(a);a=rf.a.hl(rf.a.Rh(If.TableReader.Ccg(d),0),0);if(d.La(16))return Uf.returnToCell(d),d=iq.a.Ync(d.currentNode),rf.a.hl(rf.a.Rh(d,0),0)-a;d=jq.a.KUc(d);return rf.a.hl(rf.a.Rh(d,0),0)-a}Sz(a,d,n){const z=new Dd.GraphIterator;z.set(a);Uf.moveToCell(z,d,n);return z.currentNode.fa(Qb.a.colSpan,
1)}FTd(a){var d=Lb.App.oa.za.tw;if(d.Yd&&(d=a.Qd(d.Za))){var n=!1,z=If.TableReader.nh(a),O=a.fa(Vd.a.Ks,Array(z));for(var ca of O)if(!ca){n=!0;break}if(n){O=Fg.a.clone(O);ca=a.fa(Qb.a.complexTable,!1);k.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",z,O,ca);n=1;var Da=0;for(let zb=0;zb<z;)if(ca&&(n=this.Sz(a,0,zb)),1<n){for(var Xa=0;Xa<n;Xa++)O[zb]||(O[zb]=this.$zi(0)),zb++;Da+=n-1}else(Xa=d.Vwl(zb-Da))||k.ULS.sendTraceTag(36726404,
341,50,"Got no width for graph column {0} (ghost cells {1})",zb,Da),O[zb]||(O[zb]=this.$zi(Xa)),zb++;a.setValue(Vd.a.Ks,O)}}}$zi(a){return rf.a.hl(Math.max(a,iq.a.s5),0)}fDa(a){a=Dd.GraphIterator.ua(a);this.FTd(a.currentNode);a.La(14)&&(Uf.returnToContainingTable(a),this.FTd(a.currentNode))}azj(a,d){d&&a.setValue(Qb.a.u5,d)}hYe(a,d){d&&a.setValue(Qb.a.Aub,d)}cMf(a,d){const n=If.TableReader.nh(a);sp.a.cSk(a,d,n)}Rjn(a,d,n){let z;if(!({tableNode:z}=this.fLc(a)).returnValue)return!1;if(d&&n&&d.length===
n.length){if(!this.Ibl(z,d))return!1;for(let O=0;O<d.length;++O){const ca=this.E0b.ITd(a,d[O],n[O]);if(ca)return k.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",ca),!1}this.RLe(z);return!0}return!1}HCk(a,d){let n;if(!({tableNode:n}=this.fLc(a)).returnValue||If.TableReader.Qx(n))return!1;var z=Object(qa.a)(Dd.GraphIterator,this.mc.Dg(n));Uf.moveToLastRow(z);var O=If.TableReader.Sf(n);if(d&&0<d.length){this.insertRows(z,!1,d.length,
()=>null);z=If.TableReader.Sf(n);var ca=this.mc.Dg(n);O=this.SEi(ca,O,z-1);for(z=0;z<O.length;++z){ca=O[z];const Da=d[z];for(let Xa=0;Xa<ca.length;++Xa){let zb;if(zb=Da&&Da[Xa]?this.E0b.ITd(a,ca[Xa],Da[Xa].toString()):this.E0b.ITd(a,ca[Xa],""))return k.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",zb),!1}}}this.RLe(n);return!0}xCk(a,d){let n;if(!({tableNode:n}=this.fLc(a)).returnValue||If.TableReader.Qx(n))return!1;var z=this.mc.Dg(n),
O=If.TableReader.nh(n);if(d&&0<d.length){this.insertColumns(Object(qa.a)(Dd.GraphIterator,z),O,!1,d[1].length,()=>null);var ca=If.TableReader.nh(n);z=this.$Pl(z,O,ca-1);for(O=0;O<z.length;++O){ca=d[O];const Da=z[O];for(let Xa=0;Xa<Da.length;++Xa){let zb;if(zb=ca&&ca[Xa]?this.E0b.ITd(a,Da[Xa],ca[Xa].toString()):this.E0b.ITd(a,Da[Xa],""))return k.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",zb),!1}}}this.RLe(n);return!0}e8k(a){let d;
if(!({tableNode:d}=this.fLc(a)).returnValue)return!1;let n=this.Glb(d);const z=If.TableReader.Sf(d);var O=this.mc.Dg(d);O=this.SEi(O,n,z-1);for(let ca=0;ca<O.length;++ca){const Da=O[ca];for(let Xa=0;Xa<Da.length;++Xa){const zb=this.E0b.lmj(a,Da[Xa]);if(zb)return k.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",zb),!1}}n=n?n:1;a=this.mc.Dg(d);a.YP(n)&&15===a.Yc&&this.deleteRows(Object(qa.a)(Dd.GraphIterator,a),z-n);this.RLe(d);return!0}Glb(a){let d=
0;const n=this.mc.Dg(a);let z=n.Rc();for(;z&&z.fa(Qb.a.j6a,!1);)d++,z=n.Fs();return!d&&Gh.StyleReader.TYa.U_(a)&32?1:d}PKn(a,d,n){var z,O;const ca=a.currentNode,Da=new Dd.GraphIterator;Da.Cb(a);let Xa=null,zb=null,Vb=null;const Fc=mg.a.instance.XU(3),Yc=mg.a.instance.XU(4),yd=mg.a.instance.XU(5),je=mg.a.instance.XU(0);Uf.forEachCell(Da,d,n,(Le,Ve,gg)=>{Le=Le.currentNode;Ve||gg||(Xa=Xh.nC.L5f(Le,Fc,Xa));Ve||gg!==n-1||(zb=Xh.nC.L5f(Le,Yc,zb));0<Ve&&!gg&&(Xa?Xh.nC.W_g(Le,Fc,Xa):Xh.nC.ejc(Le,Fc),zb?Xh.nC.W_g(Le,
Yc,zb):Xh.nC.ejc(Le,Yc),Xh.nC.ejc(Le,yd),Ve!==d-1&&Xh.nC.ejc(Le,je));gg||Ve!==d-1||(Vb=Xh.nC.L5f(Le,je,Vb))});a=null===(O=null===(z=null===Lb.App||void 0===Lb.App?void 0:Lb.App.oa)||void 0===z?void 0:z.za)||void 0===O?void 0:O.tw;zb?(z=an.TableNodeBorderContext.xN(ca,1),Xh.nC.X_g(zh.a.Um(a),z,zb,0)):Xh.nC.ejc(ca,Yc);z=an.TableNodeBorderContext.xN(ca,0);if(Xa)Xh.nC.X_g(zh.a.Um(a),z,Xa,0);else for(z=Object(qa.a)(an.TableNodeBorderContext,z).q4a(),O=0;O<z.length;O++)Xh.nC.ejc(z[O],Yc);Vb?Xh.nC.W_g(ca,
je,Vb):Xh.nC.ejc(ca,je)}Ibl(a,d){for(let z=0;z<d.length;++z){var n=this.mc.Dg(d[z]);if(n.La(14)&&(n=n.tc(14),a.id===n.id))continue;return!1}return!0}fLc(a){let d=null;if(a&&a.fi.toString()!==a.vj.toString())return{returnValue:!1,tableNode:d};d=this.$i.Ta(a.fi);return 14===d.type&&this.E0b.fLc(a)?{returnValue:!0,tableNode:d}:{returnValue:!1,tableNode:d}}SEi(a,d,n){const z=[];Uf.forEachCellInTable(Object(qa.a)(Dd.GraphIterator,a),(O,ca,Da)=>{if(ca>=d&&ca<=n)Da||z.push([]),Sf.TableCellReader.we(O)||
Array.add(z[ca-d],O.currentNode);else if(ca>n)return!1;return!0});return z}$Pl(a,d,n){const z=[];Uf.forEachCellInTable(Object(qa.a)(Dd.GraphIterator,a),(O,ca,Da)=>{Da>=d&&Da<=n&&(Da===d&&z.push([]),Sf.TableCellReader.we(O)||Array.add(z[ca],O.currentNode));return!0});return z}RLe(a){if(a&&14===a.type){a=Object(qa.a)(Dd.GraphIterator,this.mc.Dg(a));const d=new db.a;Bd.ParagraphReader.emb(a,!0,!1,d);a=ye.SelectionFactory.Pc(d.J(d.count-1),0);this.Da.setSelection(a)}}static get characterPropertiesEditor(){return Xh.hc||
(Xh.hc=la.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get nC(){Xh.eGa||(Xh.eGa=la.a.instance.sa("WordEditor.ITableBorderManager"));return Xh.eGa}static get clm(){return Xh.zc||(Xh.zc=la.a.instance.resolve("Box4.List.IListReader"))}static get es(){return Xh.Wq||(Xh.Wq=la.a.instance.resolve("Box4.List.IListEditor"))}SOi(a,d){l.AFrameworkApplication.Yi("faa3a672;64506943");if(this.uub){var n=new Dd.GraphIterator;n.set(a);Uf.moveToFirstRow(n);Uf.moveToRowByIndex(n,d);do n.currentNode.Fi(4,
!0);while(Uf.moveToNextRow(n))}}static slg(a,d){if(a){var n=If.TableReader.Sf(a),z=If.TableReader.nh(a);if(!(!Lb.App.oa.za.tw.Yd||0>d||d>=n))for(n=new Dd.GraphIterator,n.set(a),a=0;a<z;a++){a?Uf.moveToNextColumn(n):Uf.moveToCell(n,d,a);if(!n||!n.currentNode||16!==n.currentNode.type)continue;let O=n.currentNode;Sf.TableCellReader.jo(O)&&(O=Sf.TableCellReader.UU(O));O&&O.Fi(4,!0)}}else k.ULS.sendTraceTag(577868247,306,15,"Can not invalidate row when there is no table node")}static rlg(a,d){if(a){var n=
If.TableReader.Sf(a),z=If.TableReader.nh(a),O=new Dd.GraphIterator;if(!(!Lb.App.oa.za.tw.Yd||0>d||d>=z))for(z=0;z<n;z++){O.set(a);Uf.moveToCell(O,z,d);if(!O||!O.currentNode)continue;let ca=O.currentNode;Sf.TableCellReader.jo(ca)&&(ca=Sf.TableCellReader.UU(ca));ca&&ca.Fi(4,!0)}}else k.ULS.sendTraceTag(577868248,306,15,"Can not invalidate column when there is no table node")}}Xh.hc=null;Xh.eGa=null;Xh.zc=null;Xh.Wq=null;Object(t.a)(Xh,"TableEditor",sp.a,[264,265]);class Gu{get name(){return"WordEditor.TableEditors"}Hb(a){l.AFrameworkApplication.K.ea("TableEditorsDelayInitializationEnabled")&&
(a.ha("WordEditor.TableEditors.TableEditor",()=>new Xh(a.resolve("Box4.IOutlineEditor"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("WordEditor.IWACTableStyleReader"),new Nf.a(()=>Lb.App.oa.za.jc.kd),a.resolve("WordEditor.ContentControl.ITableContentControlEditor"),new so.a,Lg.a.instance,a.Ca("WordEditor.IFlatListEditor"),a.resolve("Box4.ContentControl.IContentControlOperator"),a.Ca("Box4.ContentControlConfigSettings"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)).as("WordEditor.ITableEditor").as("Box4.ITableEditor").singleInstance(),
a.ha("WordEditor.TableEditors.TableBorderManager",()=>new Cf).as("WordEditor.ITableBorderManager").singleInstance())}init(){}dispose(){}static main(){M.a.instance.Sb(new Gu)}}Object(t.a)(Gu,"WordEditorTableEditorsPackage",null,[1,2]);class Yt{get name(){return"WordEditor.TextLevelEditors"}Hb(){}init(){}dispose(){}static main(){M.a.instance.Sb(new Yt)}}Object(t.a)(Yt,"WordEditorTextLevelEditorsPackage",null,[1,2]);var Tx=b(1717),kq=b(412),us=b(699),bn=b(210),Zt=b(246);class Bp{constructor(a){this.xik=
a}U2k(){const a=Tr.a.instance.createInstance(393228);a.setValue(Vd.a.NI,bn.a.first);a.setValue(Vd.a.uHf,0);a.setValue(Vd.a.ica,qh.OutlineReader.uqe);(new us.OutlineIndentInfo(!0)).PYg(a);return a}I6(a,d,n=null){const z=a.currentNode;if(!a.Ht(1))return this.WGb(a,null,d,n);Ia.OutlineElementReader.bB(a)&&qe.OutlineElementNavigator.PMc(a,!0);return Ia.OutlineElementReader.gg(a)?Bp.Pg.BE(a,!1,d,n):(a.Dsb(z),null)}aOk(a){return qh.OutlineReader.AKc(a.currentNode)||Ia.OutlineElementReader.gg(a)||Ia.OutlineElementReader.bB(a)||
Sf.TableCellReader.isTableCell(a)}WGb(a,d=null,n=!1,z=null){if(!this.aOk(a))return null;const O=Bp.Pg.V5b();this.aon(O,a);a.Mnb(O,d,1,null);a.rg(O);n&&(Bp.Pg.vX(a,z),qe.OutlineElementNavigator.Uc(a));return O}aon(a,d){if(d=this.YMl(d))switch(d.type){case 11:Bp.Pg.BYf(d,a,!0);break;case 8:d=Bp.yc.isRtl(d),Bp.Pg.plc(a,d)}}YMl(a){return this.xik.ZMl(a)}olc(a,d){a.setValue(Vd.a.wK,d?11:9)}Wjn(a,d){const n=Zt.WordSectionNavigator.instance.BK(a);return n?qh.OutlineReader.OP(a)!==d?(n.setValue(Qb.a.DCc,
d),!0):!1:null}static get yc(){return mi.PageReader.instance}static get Pg(){return Bp.Ee||(Bp.Ee=la.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Pg(a){Bp.Ee=a}}Bp.Ee=null;Bp.Wd=null;Object(t.a)(Bp,"OutlineEditor",null,[316]);const Ug=a=>{a.ha("Box4.OutlineLevelEditors.OutlineEditor",()=>new Bp(a.resolve("Box4.IOutlineElementNodeIdFactory"))).as("Box4.IOutlineEditor").singleInstance();a.ha("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new Tx.a(a.vf("Box4.IOutlineEditor"),a.vf("Box4.List.IListEditor"),
a.vf("Box4.List.IListReader"),a.resolve("Box4.ICreateParagraphStrategy"),a.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),a.resolve("Box4.IBox4GraphWriter"),a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.resolve("Box4.Styles.IWACStyleEditor"),a.resolve("Box4.Styles.IWACStyleReader"))).as("Box4.IOutlineElementEditor").singleInstance()};class Cv{get name(){return"Box4.OutlineLevelEditors"}Hb(a){Ug(a)}init(){}dispose(){}static main(){M.a.instance.Sb(new Cv)}}Object(t.a)(Cv,"Box4OutlineLevelEditorsPackage",
null,[1,2]);class Tp{constructor(a){this.cqe=null;this.P7i=a.Ga("OfficeOnlineChromeExtensionId");this.W7i=a.Ga("ChromeClipboardAccessExtensionId");this.A8l=a.ea("OfficeOnlineChromeExtensionIsEnabled");this.FNh=!this.Ycm();this.cqe=this.DNb?this.W7i:this.P7i}xan(){this.cqe===this.P7i&&this.BSi&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.cqe=this.W7i;this.FNh=!0}get DNb(){return this.FNh}Ycm(){if(this.A8l&&this.BSi){var a=localStorage.getItem("IsOfficeOnlineExtensionInstalled");
if(a&&"true"===a)return a=localStorage.getItem("IsCopyPasteSupported"),!!a&&"true"===a}return!1}get BSi(){let a=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),a="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(d){k.ULS.sendTraceTag(19452045,307,50,d.toString())}return a}}Object(t.a)(Tp,"ChromeExtensionHelper",null,[942]);var $t=b(1253),Gt=b(474),Wq=b(1213);
class Xr{create(a){return new Wq.a(a)}}Object(t.a)(Xr,"Factory",null,[543]);var Fm=b(180);class mr{constructor(a,d,n){this.krk=a;this.Xb=d;this.nxa=n}lb(){this.nxa.Aa(Mb.a.JMd,Kb.a.application,this.JMd.bind(this),96);this.nxa.ma(Mb.a.pPb,Kb.a.view,this.qPn.bind(this));this.nxa.Aa(Mb.a.tQg,Kb.a.view,this.rPn.bind(this),96)}JMd(a,d,n,z,O){if(1===n)return 32;a=Object.assign(new he.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});d=[];n=Object.assign(new fi.a,{ControlList:[]});
Array.add(n.ControlList,Object.assign(new Xg.a,{ExternalId:"UpdateStyle",QueryCommand:"QueryUpdateStyle"}));d.push(n);Array.addRange(a.MenuSectionList,d);O.MenuItems=a;return 32}rPn(a,d,n,z,O){if(1===n)return 32;a=sj.a.y8g();null==a&&8;a=this.Xb.Lv(a);O[rg.a.LabelText]=String.format(w.a.Vd(Box4Intl.Box4Strings.l_UpdateStyleCommand),a);return 32}qPn(a,d,n){a=sj.a.eLc(d);if(1===n||a)return a?8:32;n=new Map;n.set("Source","StyleContextMenuActor");n.set("Action","UpdateStyle");ja.Health.instance.recordKpiUsage(Fm.a.rwb,
0,Fm.a.aH,n);this.krk.sPn(d)?Ld.b(539842578,3018,50,"User Successfully Updated styles from UI"):(d=new Map,d.set("Source","StyleContextMenuActor"),d.set("Action","UpdateStyle"),d=Object.assign(new Sg.a,{extendedProperties:d}),ja.Health.instance.recordKpiFailure(Fm.a.rwb,"UpdateStyleFailed",!1,!0,d),Ld.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));return 32}}Object(t.a)(mr,"StyleContextMenuActor",null,[]);var nt=b(905),Hu=b(1319),Cp=b(486),nk=b(1577);
class dp extends nk.a{constructor(a,d,n,z,O,ca,Da=null,Xa=null){super(a,ca,Da,Xa);this._formatting=this.Ki=null;this.g0a=!1;this.JTb=l.AFrameworkApplication.K.ea("FollowDestinationFormattingPasteIsEnabled");this.IXb=0;this.vdd=new db.a;Ld.a(8128527,307,Ia.OutlineElementReader.gg(a));this.qR=d;this.qR.Bzc(this);this.dr=n;this.es=z;this.Vb=O;this.rIf=Xa;this.Bqf=Bf.ListReader.Bh(this.pb)}get paragraphEditor(){return this.Ki||(this.Ki=la.a.instance.resolve("Box4.IParagraphEditor"))}get Wpe(){return null}get zBc(){return this.Bqf&&
!this.qR.iSa}get o6b(){return 0<this.IXb}xna(a,d){if(!this.s9.Bbh(this.pb,d,!0)){Ld.a(8701077,307,Bd.ParagraphReader.Zf(this.pb));var n=this.pb.currentNode,z=fe.a.kz(n);this.JTb&&this._formatting.FN&&(n=n.ja.last,this.g0a&&(n.formatting=this._formatting.FN.Xc(n),this.g0a=!1),a=this.s9.Efg(a,d),this.s9.ZXa(this.pb.currentNode,this._formatting.Ina,d));this.characterPropertiesEditor.replaceTextRange(z,a)}}DWa(){Ld.a(8701078,307,Bd.ParagraphReader.Zf(this.pb));const a=fe.a.kz(this.pb.currentNode);this.characterPropertiesEditor.oga(a,
d=>new Cp.a(d,Cp.a.ujb),Vi.AParagraphNode.ix)}lKb(){this.s9.Jfg(this.pb)}zWa(){this.JTb&&(this.g0a=!0)}f7a(){Ld.a(8701079,307,Bd.ParagraphReader.Zf(this.pb))}e7a(){Ld.a(8701080,307,Bd.ParagraphReader.Zf(this.pb))}IK(a){this.qR.iSa||(this.JTb?(this.IEf(a),this._formatting.x2e(this.pb.currentNode),a&&"P"===a.dha.YCe&&this.rIf.Vta(this.pb.currentNode,this._formatting.WWa),this.s9.ZXa(this.pb.currentNode,this._formatting.Ina,a)):this.PGk(a))}HK(){this.qR.iSa||this.bqd()}m7a(){}Tqb(){}GWa(){Ld.a(8701081,
307,Ia.OutlineElementReader.gg(this.pb)||qh.OutlineReader.yq(this.pb)||Bd.ParagraphReader.Zf(this.pb)&&this.qR.iSa);let a=!1;this.o6b||(a=this.zBc||!0);a||(this.R0+=1);this.IXb++}EWa(){this.IXb--;let a=!1;this.o6b||(a=this.zBc||!0,this.es.lUg(this.vdd));a||--this.R0}l7a(a){Ld.a(8701082,307,Ia.OutlineElementReader.gg(this.pb)||qh.OutlineReader.yq(this.pb)||Bd.ParagraphReader.Zf(this.pb)&&this.qR.iSa);Ld.a(8701083,307,!!a.listStyleType)}FWa(){Ld.a(8701084,307,Ia.OutlineElementReader.gg(this.pb)||Bd.ParagraphReader.Zf(this.pb)&&
this.qR.iSa);this.qR.iSa||Ld.a(8701085,307,this.pb.Bo(2))}wna(a){this.qR.wna(a)}tna(){this.qR.tna()}i2e(a){this.vdd.add(a)}vna(a){this.qR.vna(a)}una(){this.qR.una()}sna(a){this.qR.sna(a)}rna(){this.qR.rna()}PGk(a){this.OMc(!1);(new Dd.GraphIterator).Cb(this.pb);a=nk.a.Pg.vX(this.pb,this.rvd(a));Ld.a(8128534,307,a===this.pb.currentNode);Ld.a(8128535,307,Bd.ParagraphReader.nb(a))}bqd(){Ld.a(8128536,307,Bd.ParagraphReader.Zf(this.pb));qe.OutlineElementNavigator.Uc(this.pb)}reset(){this.JTb&&(super.reset(),
this._formatting=this.K7f(!0))}IEf(a){this.OMc(!1);(new Dd.GraphIterator).Cb(this.pb);a=nk.a.Pg.vX(this.pb,this.rvd(a));Ld.a(36577367,307,a===this.pb.currentNode);Ld.a(36577368,307,Bd.ParagraphReader.nb(a));-1!==this._formatting.Kt&&this.paragraphEditor.NH(a,this._formatting.Kt);this._formatting.lineSpacing&&this.rIf.cF(a,this._formatting.lineSpacing);this._formatting.tM&&this.rIf.eYe(a,this._formatting.tM);this.g0a=!0;this._formatting.paragraph=a}static Koe(a,d){let n=0;switch(d){case 3:n=Wf.a.xE(a);
break;case 7:n=rf.a.tx(a,0);break;case 1:n=Wf.a.akd(a);break;case 5:n=Wf.a.xE(Wf.a.uMd(a));break;default:k.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",a,d)}return n}}Object(t.a)(dp,"TextOnlyBox4PasteSteward",nk.a,[]);class Tm{constructor(a,d,n,z){this.tYb=a;this.Wq=d;this.zc=n;this.s9=z}create(a,d,n,z,O=null,ca=null,Da=null){return 1===a?new dp(d,z,this.tYb,this.Wq,this.zc,O,ca,this.s9):new Hu.Box4PasteSteward(d,n,z,this.tYb,
this.Wq,this.zc,O,ca,this.s9,Da)}}Object(t.a)(Tm,"Box4PasteStewardFactory",null,[542]);var Xq=b(220),Zi=b(369),Dq=b(647),Yr=b(457),Ux=b(705);class ci{static get b0l(){return ci.Yak}static get i0l(){return ci.bbk}static get g0l(){return ci.abk}static get jg(){return ci.Vu||(ci.Vu=bl.ContextSetEditor.instance)}static cVm(a,d){const n=a.currentNode;Uf.forEachCell(a,d.rowSpan,d.colSpan,(z,O,ca)=>{const Da=z.currentNode;Da!==n&&(Da.we=!0,ci.jgi(z),!ca&&1<=d.colSpan&&(Da.colSpan=d.colSpan),ci.ixj(z,d.hua,
O,ca,d.rowSpan,d.colSpan))})}static HVm(a,d){Uf.forEachCell(a,d.rowSpan,d.colSpan,n=>{ci.iEk(n);ci.jgi(n)})}static iEk(a){a=a.currentNode;a.we=!0;a.kV=!0;a.f9a=!0}static jgi(a){a&&(a.Va(1),Object(Uc.a)(Dq.a,a.currentNode)&&a.wg())}static GEk(a,d,n){0<d&&(a=Object(qa.a)(Xq.TableCellNode,a.currentNode))&&(a.width=n?d:rf.a.hl(d,0))}static xDk(a,d,n){if(a=Object(qa.a)(Zi.TableNode,a.currentNode))0<d&&(a.Oj=rf.a.tx(d,0)),0<n&&(a.sD=rf.a.tx(n,0))}static EEk(a,d){void 0!==d&&null!==d&&a.currentNode.properties.setValue(Qb.a.Aoa,
ci.i0l[d+""])}static hEk(a,d){void 0!==d&&null!==d&&""!==d&&(d=parseInt(Hu.Box4PasteSteward.B5b(d),16),a.currentNode.properties.setValue(Vd.a.BL,d))}static iXh(a){if(!a)k.ULS.sendTraceTag(537997910,3022,15,"Table cell should not be null");else if(16==a.type){var d=new Dd.GraphIterator;d.set(a);if(d.La(14)){var n=Vr.a(d),z=Sf.TableCellReader.Sz(a);if(d.tc(14)){a=d.currentNode;var O=If.TableReader.s7(d),ca=Array.clone(O);d=If.TableReader.qye(d);var Da=0,Xa=0;for(var zb=0;zb<O.length;zb++)zb>=n&&zb<
n+z?d[zb]>O[zb]&&(Da+=d[zb]-O[zb],ca[zb]=d[zb]):Xa+=O[zb]>d[zb]?O[zb]-d[zb]:0;if(Xa<Da)for(n=0;n<O.length;n++)ca[n]=d[n];else for(zb=0;zb<O.length;zb++)(zb<n||zb>=n+z)&&O[zb]>d[zb]&&(ca[zb]-=(O[zb]-d[zb])/Xa*Da);a.wN=ca}}}}static ESl(a){var d=new Dd.GraphIterator;d.Cb(a);if((a=Ll.OutlineNavigator.HVe(d))&&qh.OutlineReader.yq(d)){d=a.Se(Qb.a.iq);const n=a.Se(Qb.a.marginLeft);a=a.Se(Qb.a.marginRight);return d-n-a}return 0}static yem(a){return!(void 0===a||null===a||1===a)}static Yin(a,d,n,z,O){if(void 0===
d||null===d||""!==d){switch(d){case "thin":d=Wf.a.tMd(.25);break;case "initial":case "medium":d=Wf.a.tMd(.5);break;case "thick":d=Wf.a.tMd(1);break;default:d=ci.gPl(d,n,z)}O.currentNode.properties.setValue(a,d)}}static Xin(a,d,n){void 0!==d&&null!==d&&d&&n.currentNode.properties.setValue(a,ci.g0l[d+""])}static Vin(a,d,n){void 0!==d&&null!==d&&""!==d&&(d=parseInt(Hu.Box4PasteSteward.B5b(d),16),n.currentNode.properties.setValue(a,d))}static gPl(a,d,n){let z=0,O=0;a=({unit:O}=Hu.Box4PasteSteward.ULd(a,
O)).returnValue;switch(O){case 5:z=Wf.a.tMd(a);break;case 1:z=Wf.a.y5h(a);break;case 3:z=Wf.a.tDe(a);break;case 7:z=rf.a.Oej(a,n)}if(6===d||7===d||10===d)z/=3;return Math.round(z)}static hPl(a,d){let n=0,z=0;a=({unit:z}=Hu.Box4PasteSteward.ULd(a,z)).returnValue;switch(z){case 5:n=Wf.a.qCa(a);break;case 1:n=Wf.a.jme(a);break;case 3:n=Wf.a.Nba(a);break;case 7:n=rf.a.hl(a,d)}return n}static fXe(a,d,n,z,O,ca,Da){if(O&&(!Da||16===O.Yc||Da||14!==O.Yc)&&12!==n){if(Da)switch(z){case 5:z=Qb.a.yub;var Xa=Qb.a.I9a;
var zb=Qb.a.LYa;var Vb=0;break;case 4:z=Qb.a.xub;Xa=Qb.a.H9a;zb=Qb.a.JYa;Vb=1;break;case 0:z=Qb.a.vub;Xa=Qb.a.F9a;zb=Qb.a.DYa;Vb=0;break;case 3:z=Qb.a.wub;Xa=Qb.a.G9a;zb=Qb.a.HYa;Vb=1;break;default:return}else switch(z){case 5:z=Qb.a.Iub;Xa=Qb.a.QYa;zb=Qb.a.Jub;Vb=0;break;case 4:z=Qb.a.Fub;Xa=Qb.a.PYa;zb=Qb.a.Gub;Vb=1;break;case 0:z=Qb.a.Bub;Xa=Qb.a.NYa;zb=Qb.a.Cub;Vb=0;break;case 3:z=Qb.a.Dub;Xa=Qb.a.OYa;zb=Qb.a.Eub;Vb=1;break;default:return}void 0!==O.currentNode&&null!==O.currentNode&&(ci.yem(n)?
(ci.Vin(z,a,O),ci.Xin(Xa,n,O),ci.Yin(zb,d,n,Vb,O)):ca||Da||O.currentNode.properties.setValue(Xa,"nil"))}}static ixj(a,d,n,z,O,ca){z||(ci.cZh(d,a,!1,!1),ci.fFf(d,a,!0,!1));z===ca-1&&ci.fFf(d,a,!0,!1);n||ci.xZh(d,a,!0,!1);n===O-1&&ci.NYh(d,a,!0,!1)}static MYh(a,d,n,z){a&&(ci.xZh(a,d,n,z),ci.fFf(a,d,n,z),ci.NYh(a,d,n,z),ci.cZh(a,d,n,z))}static xZh(a,d,n,z){ci.fXe(a.borderTopColor,a.borderTopWidth,a.borderTopStyle,5,d,n,z)}static fFf(a,d,n,z){ci.fXe(a.borderRightColor,a.borderRightWidth,a.borderRightStyle,
4,d,n,z)}static NYh(a,d,n,z){ci.fXe(a.borderBottomColor,a.borderBottomWidth,a.borderBottomStyle,0,d,n,z)}static cZh(a,d,n,z){ci.fXe(a.borderLeftColor,a.borderLeftWidth,a.borderLeftStyle,3,d,n,z)}static gXe(a,d,n){if(n&&16===n.Yc&&""!==a){switch(d){case 3:d=Qb.a.jua;var z=0;break;case 2:d=Qb.a.fJ;z=1;break;case 0:d=Qb.a.iua;z=0;break;case 1:d=Qb.a.gG;z=1;break;default:return}(a=ci.hPl(a,z))&&n.currentNode.properties.setValue(d,a)}}static TCk(a,d){d&&(ci.yEk(d,a),ci.eEk(d,a),ci.ZCk(d,a),ci.JDk(d,a))}static yEk(a,
d){ci.gXe(a.ZOk,3,d)}static eEk(a,d){ci.gXe(a.YOk,2,d)}static ZCk(a,d){ci.gXe(a.WOk,0,d)}static JDk(a,d){ci.gXe(a.XOk,1,d)}static dDk(a,d,n,z){var O=0;const ca=Array(a.length);var Da=0;z&&(Da=(Da=Wf.a.LZd(ci.ESl(d)))?Da:1);for(z=0;z<a.length;z++)ca[z]=0<Da?Da/100*a[z]:rf.a.hl(a[z],0),O+=ca[z];a=n.getValue(Vd.a.Ks);z=new Dd.GraphIterator;z.Cb(d);d=0;if(Sf.TableCellReader.cM(z)){if(a=Uf.returnToContainingCell(z))d=a.width;Da=Vr.a(z);z=Uf.returnToContainingTable(z);if(-1!==Da&&Da<=z.wN.length){let Xa=
0;for(let zb=Da;zb<Da+a.colSpan&&zb<z.wN.length;zb++)Xa+=z.wN[zb];d=Math.min(d,Xa);d===Xa&&(d-=rf.a.hl(ci.Sym,0))}}else if(a)for(Da=0;Da<a.length;Da++)d+=a[Da];if(0<d&&O>d&&O)for(O=d/O,d=0;d<ca.length;d++)ca[d]*=O;n.setValue(Vd.a.Ks,ca)}static fEk(a,d){a.currentNode.setValue(Qb.a.pT,rf.a.hl(d,1))}static oon(a){var d,n,z=a.ya,O=a.Ag;a=ci.jg.NX(O,16);if(O=ci.jg.xU(O,14))if(O=O.node,!O||14!==O.type)k.ULS.sendTraceTag(537507990,306,15,"Table node must be present");else if(!a)k.ULS.sendTraceTag(537507991,
306,15,"Cell context must be present");else{if(!((null===(n=null===(d=null===z||void 0===z?void 0:z.Ba)||void 0===d?void 0:d.fc)||void 0===n?0:n.ra)&&z.Ba.fc.ra.contextId===Kb.a.eJ&&Yr.TableBorderSelectionCache.lIa()&&0<Yr.TableBorderSelectionCache.lIa().length)){Yr.TableBorderSelectionCache.cbc(O);d=Yr.TableBorderSelectionCache.$0;d.vH=Number.MAX_SAFE_INTEGER;d.cG=Number.MIN_SAFE_INTEGER;d.tT=Number.MAX_SAFE_INTEGER;d.nP=Number.MIN_SAFE_INTEGER;for(n=0;n<a.length;n++){if(a.getContext(n).contextId!==
Kb.a.tableCell)return;z=a.getContext(n).node;if(!Sf.TableCellReader.jo(z)){var ca=new Dd.GraphIterator;ca.set(z);if(ca.La(14)&&Uf.getContainingTable(ca)===O){ca.tc(14);ca=Sf.TableCellReader.Bza(ca,z);if(!ca)return;Array.add(Yr.TableBorderSelectionCache.lIa(),new Ux.a(z,ca.rowIndex,ca.Yp,z.rowSpan,z.colSpan));d.vH=Math.min(d.vH,ca.Yp);d.cG=Math.max(d.cG,ca.Yp);d.tT=Math.min(d.tT,ca.rowIndex);d.nP=Math.max(d.nP,ca.rowIndex)}}}Yr.TableBorderSelectionCache.$0=d}}else k.ULS.sendTraceTag(537145810,306,
15,"IP in table should be there")}}ci.Sym=8;ci.dfi="Table Grid";ci.Vu=null;ci.Yak=ta.a.X8("MsoNormalTable","Normal Table","MsoTableGrid",ci.dfi,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2",
"MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5",
"MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2",
"MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5",
"MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6",
"MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1",
"List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3",
"MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4",
"MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3",
"MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5",
"List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6",
"List Table 7 Colorful Accent 6");ci.bbk=ta.a.X8("0","center","1","top","2","center","3","bottom");ci.abk=ta.a.X8("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(t.a)(ci,"Box4TableStewardHelper",null,[]);class Ol{constructor(a,d,n){this.rB=null;this.JXb=0;this.i2=null;this.pb=a;this.$f=n}Bzc(a){this.rB=a}get iSa(){return 0<this.JXb}wna(a){Ld.a(7869459,307,!!this.rB);Ld.a(7869460,307,Ia.OutlineElementReader.gg(this.pb)||
qh.OutlineReader.yq(this.pb));Ld.b(38563978,307,50,"Table pasting started");this.rB.OMc(!0);const d=new Dd.GraphIterator;d.Cb(this.pb);var n=ci.b0l[a.styleId];n||(n=ci.dfi);n=this.$f.o1m(this.pb,a.rowCount,a.$Cb,n,a.tableLook,this.rB.rvd(a),a.HPi);a.y9g&&(Ld.b(573691298,3022,100,"Applying table border properties"),ci.MYh(a.y9g,this.pb,!1,!0));a.CDe&&(Ld.b(573691299,3022,100,"Applying indentation properties"),ci.xDk(this.pb,a.CDe.spaceBefore,a.CDe.spaceAfter));a.yne&&(Ld.b(573691328,3022,100,"Applying column widths"),
ci.dDk(a.yne,this.pb,Object(qa.a)(Zi.TableNode,n),a.$ob));this.rB.Nje(d,!1);this.JXb++;Bf.ListReader.Bh(d)&&this.rB.i2e(d.currentNode);Ld.a(7869461,307,If.TableReader.isTable(this.pb))}tna(){Ld.a(7869462,307,!!this.rB);Ld.a(7869463,307,km.a.isTableRow(this.pb));Ld.b(38563979,307,50,"Table pasting finished");if(this.r0&&this.pb.Rn(14)){let z=this.pb.Hm;var a=new Dd.GraphIterator;a.Cb(this.pb);let O=z.wN;a=If.TableReader.qye(a);let ca=0;for(var d=0;d<O.length;d++)O[d]=Math.max(O[d],a[d]),ca+=O[d];var n=
Uf.getContainingTableCell(this.pb);if(n){let Da=Uf.getContainingTable(this.pb);d=n.width;const Xa=iq.a.hH(n,Da,Qb.a.gG,Qb.a.v5,0);n=iq.a.hH(n,Da,Qb.a.fJ,Qb.a.lda,0);d-=rf.a.hl(Xa+n,0);ca>d&&(O=Array.clone(a));z.wN=O}}qe.OutlineElementNavigator.Uc(this.pb);this.JXb--}vna(a){Ld.a(7869464,307,!!this.rB);Ld.b(573691329,3022,100,"Table row pasting started");If.TableReader.isTable(this.pb)?Uf.moveToFirstRow(this.pb):km.a.isTableRow(this.pb)&&Uf.moveToNextRow(this.pb);a.height&&(Ld.b(573691330,3022,100,
"Applying table row height"),ci.fEk(this.pb,a.height));Ld.a(7869465,307,km.a.isTableRow(this.pb))}una(){Ld.a(7869466,307,!!this.rB);Ld.a(7869467,307,Sf.TableCellReader.isTableCell(this.pb));Uf.returnToContainingRow(this.pb)}sna(a){Ld.a(7869468,307,!!this.rB);Ld.a(7869469,307,!this.rB.R0);km.a.isTableRow(this.pb)?Uf.moveToFirstColumn(this.pb):Sf.TableCellReader.isTableCell(this.pb)?Uf.moveToNextColumn(this.pb):Ld.a(7869471,307,!1);if(this.pb.currentNode){Ld.b(573691331,3022,100,"Table cell pasting started");
var d=Object(qa.a)(Xq.TableCellNode,this.pb.currentNode);Ld.a(50689760,307,!d&&16!==this.pb.currentNode.type||!!d&&16===this.pb.currentNode.type);if(d){var n=new Dd.GraphIterator;n.Cb(this.pb);if(a.bLc)Ld.b(573691332,3022,100,"Processing skipped cell"),ci.HVm(n,a);else{if(1<a.colSpan||1<a.rowSpan){const z=Uf.returnToContainingTable(n);if(!z)return;z.setValue(Qb.a.complexTable,!0);n.Cb(this.pb);Ld.b(573691333,3022,100,"Processing merged cell");ci.cVm(n,a);d.rowSpan=a.rowSpan;d.colSpan=a.colSpan}ci.hEk(this.pb,
a.shadingColor);ci.EEk(this.pb,a.verticalAlignment);ci.TCk(this.pb,a.J0e);ci.MYh(a.hua,this.pb,!a.colSpan&&!a.rowSpan,!1);(new Dd.GraphIterator).Cb(this.pb);Uf.forEachCell(n,a.rowSpan,a.colSpan,(z,O,ca)=>{Ld.b(573691334,3022,100,"Setting ghost cell borders");ci.ixj(z,a.hua,O,ca,a.rowSpan,a.colSpan)});ci.GEk(this.pb,a.width,a.$ob);Ld.a(7869472,307,qh.OutlineReader.yq(this.pb))}}}}rna(){Ld.a(7869473,307,!!this.rB);Ld.a(7869474,307,Ia.OutlineElementReader.gg(this.pb)||Sf.TableCellReader.isTableCell(this.pb));
Uf.returnToCell(this.pb);Ld.a(7869475,307,0>=this.rB.R0);this.rB.mMf()}get r0(){null==this.i2&&(l.AFrameworkApplication.Yi("he991617;3eed2178"),this.i2=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.i2}}Object(t.a)(Ol,"Box4TableSteward",null,[516,180]);class lg{constructor(a,d,n){this.rB=null;this.JXb=0;this.pb=a;this.$f=n}Bzc(a){this.rB=a}get iSa(){return 0<this.JXb}wna(){this.iSa&&(Ld.a(8787101,
307,Bd.ParagraphReader.Zf(this.pb)),qe.OutlineElementNavigator.Uc(this.pb));Ld.a(8701086,307,!!this.rB);Ld.a(8701087,307,Ia.OutlineElementReader.gg(this.pb)||qh.OutlineReader.yq(this.pb));this.JXb++}tna(){Ld.a(8701088,307,!!this.rB);qe.OutlineElementNavigator.Uc(this.pb);this.JXb--;if(this.iSa){this.rB.OMc(!0);const a=lg.Pg.vX(this.pb);Ld.a(8787102,307,a===this.pb.currentNode);Ld.a(8787103,307,Bd.ParagraphReader.Zf(this.pb))}}vna(a){Ld.a(8701089,307,!!this.rB);this.rB.OMc(!0);const d=new Dd.GraphIterator;
d.Cb(this.pb);this.rB.Nje(d,!1);Bf.ListReader.Bh(d)&&this.rB.i2e(d.currentNode);a=lg.Pg.vX(this.pb,this.rB.rvd(a));Ld.a(8701090,307,a===this.pb.currentNode);Ld.a(8701091,307,Bd.ParagraphReader.Zf(this.pb))}una(){Ld.a(8701120,307,!!this.rB);Ld.a(8701121,307,Bd.ParagraphReader.Zf(this.pb));qe.OutlineElementNavigator.Uc(this.pb)}sna(){Ld.a(8701122,307,!!this.rB);Ld.a(8701123,307,Bd.ParagraphReader.Zf(this.pb));Ld.a(8701124,307,!this.rB.R0);var a=this.pb.currentNode;Bd.ParagraphReader.textLength(a)&&
(a=fe.a.kz(a),this.rB.characterPropertiesEditor.replaceTextRange(a,", "))}rna(){Ld.a(8701125,307,!!this.rB);Ld.a(8701126,307,Bd.ParagraphReader.Zf(this.pb));Ld.a(8701127,307,0>=this.rB.R0);this.rB.mMf()}static get Pg(){return lg.Ee||(lg.Ee=la.a.instance.resolve("Box4.IOutlineElementEditor"))}}lg.Ee=null;Object(t.a)(lg,"TextOnlyBox4TableSteward",null,[516,180]);class Az{constructor(a,d,n=!1,z=!1){this.Wq=a;this.Rk=d;this.bjk=n;this.jjk=z}create(a,d){return 1===a?new lg(d,this.Wq,this.Rk):new Ol(d,
this.Wq,this.Rk,this.bjk,this.jjk)}}Object(t.a)(Az,"Box4TableStewardFactory",null,[491]);class Iu{create(){return new Pi.a}}Object(t.a)(Iu,"Factory",null,[489]);class Ju{constructor(a){this.ga=a}Uxm(a){if(4===a)a=Mb.a.B4;else if(2===a)a=Mb.a.xQ;else if(1===a)a=Mb.a.BLa;else if(3===a)a=Mb.a.Kfa;else return;this.ga.processAction(a,2)}mkb(){this.ga.processAction(Mb.a.mkb,2)}}Object(t.a)(Ju,"SelectionCommands",null,[488]);var tp=b(247),jw=b(962),ot=b(138),Kk=b(597);class Vx{constructor(){this.lFd=!1;
this.LRn=l.AFrameworkApplication.K.Ga("WordEditorVisiFontFileUri");this.NRn=l.AFrameworkApplication.K.Ga("WordEditorVisiRtlFontFileUri");this.MRn=l.AFrameworkApplication.K.Ga("WordEditorVisiPilcrowFontFileUri");this.IRn=l.AFrameworkApplication.K.Ga("WordEditorVisiCarriageReturnFontFileUri");this.KRn=l.AFrameworkApplication.K.Ga("WordEditorVisiCarriageReturnRtlFontFileUri")}SEn(){this.lFd=!this.lFd}REn(a){this.SEn();let d=a.getElementsByClassName("VisiFontStyle")[0],n=a.getElementsByClassName("VisiFontRtlStyle")[0],
z=a.getElementsByClassName("VisiFontPilcrowStyle")[0],O=a.getElementsByClassName("VisiFontCarriageReturnStyle")[0],ca=a.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];d||(d=document.createElement("Style"),d.className="VisiFontStyle",ae.a.dA(d,""),a.appendChild(d));n||(n=document.createElement("Style"),n.className="VisiFontRtlStyle",ae.a.dA(n,""),a.appendChild(n));z||(z=document.createElement("Style"),z.className="VisiFontPilcrowStyle",ae.a.dA(z,""),a.appendChild(z));O||(O=document.createElement("Style"),
O.className="VisiFontCarriageReturnStyle",ae.a.dA(O,""),a.appendChild(O));ca||(ca=document.createElement("Style"),ca.className="VisiFontCarriageReturnRtlStyle",ae.a.dA(ca,""),a.appendChild(ca));if(this.lFd)return k.ULS.sendTraceTag(593294047,324,50,"Formatting markers are inserted"),this.Ahd(d)&&this.Ahd(n)&&this.Ahd(z)&&this.Ahd(O)&&this.Ahd(ca);k.ULS.sendTraceTag(593294046,324,50,"Formatting markers are removed");return this.GQd(d)&&this.GQd(n)&&this.GQd(z)&&this.GQd(O)&&this.GQd(ca)}Ahd(a){return""===
ae.a.SA(a)?("VisiFontStyle"===a.className?ae.a.dA(a,this.lud("WordVisi_MSFontService",this.LRn)):"VisiFontRtlStyle"===a.className?ae.a.dA(a,this.lud("WordVisiRtl_MSFontService",this.NRn)):"VisiFontPilcrowStyle"===a.className?ae.a.dA(a,this.lud("WordVisiPilcrow_MSFontService",this.MRn)):"VisiFontCarriageReturnStyle"===a.className?ae.a.dA(a,this.lud("WordVisiCarriageReturn_MSFontService",this.IRn)):"VisiFontCarriageReturnRtlStyle"===a.className&&ae.a.dA(a,this.lud("WordVisiCarriageReturnRtl_MSFontService",
this.KRn)),!0):!1}GQd(a){return""!==ae.a.SA(a)?(ae.a.dA(a,""),!0):!1}lud(a,d){return"@font-face { font-family: "+a+"; src: url('"+d+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(t.a)(Vx,"VisiMarkersOperation",null,[486]);var Wx=b(1351),to=b(833);class tg extends Wx.a{constructor(a,d){super(a,d);this.gif=-1;this.GTb=0;this.nff=null;this.Ezh=!1;this.zgf=[];this.w9d=!1;this.sGh=!0;this.bpf=this.H7d=null;this.preventDismissOnScroll=this.GRe=this.kPc=!1;this.xfa=null;
this.oge=!1;this.qyd=!0;this.Sw=!1;this.oBh=l.AFrameworkApplication.K.ea("FloatieLightDismissIsEnabled");tg.gLh||(l.AFrameworkApplication.pa.ma(Sa.a.showFloatie,Cd.a.frame,Bc.ActionManager.Ke),tg.gLh=!0)}get Gpi(){return this.yU}set Gpi(a){this.yU=a}get QJj(){return this.oge}get yzd(){return this.Ezh}set yzd(a){this.Ezh=a;this.GTb=0}get GD(){return!0}get cssClass(){return l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.vY?"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.Sw}T8a(){for(let a of this.children)if(a.T8a())return!0;
return!1}get xha(){return 9}Re(a){this.zgf[this.zgf.length]=a;super.Re(a)}Cn(){super.Cn();ze.c(this.Pb)&&this.MF();this.Pb=Ne.a.q8a(this.Pb);this.k3(this.Pb);this.M3=!1}RNc(a){3===a.ed||this.GRe||this.OA(a);return!1}UNc(){return!1}SNc(a){3!==a.ed&&this.qyd&&!this.kPc&&this.VNn(a);return!1}TNc(){return!1}PNc(a){3===a.ed&&this.OA(a);return!1}QNc(a){void 0!==this.xfa&&null!==this.xfa||this.preventDismissOnScroll||this.OA(a);return!1}ZF(){this.UZf();return!1}mOe(){this.yzd=!0}VNn(a){if(a=gf.a.aEb(a.clientPoint,
this.nff)){if(this.yzd){if(!this.GTb||a<this.GTb)this.GTb=a;a-=this.GTb}a-=this.gif;0>a&&(a=0);const d=255-4*a;0>=d&&63.75<=a?this.OA():I.a.setOpacity(this.Pb,Math.max(d/255,0))}else this.yzd=!1,this.GTb=0,I.a.setOpacity(this.Pb,1)}CMn(a){let d=null;void 0!==this.H7d&&null!==this.H7d&&(d=this.H7d(a));a=null;for(const n of this.zgf){let z=!this.QJj&&n.oVi;if(!z&&void 0!==d&&null!==d)for(let O=0;O<d.length;O++)if(n.id===d[O]){z=!0;break}n.Pb.style.display=z?"none":"";n.dDc=!z;z||(a=n)}a&&(a.dDc=!1)}yxi(){const a=
this.Pb.style.top,d=this.Pb.style.left;this.Pb.style.top="0px";this.Pb.style.left="0px";const n=this.r9b();this.Pb.style.top=a;this.Pb.style.left=d;return n}r9b(){const a=this.Pb.style.visibility,d=this.Pb.style.display;this.Pb.style.visibility="hidden";this.Pb.style.display="";const n=Ye.a.getElementBounds(this.Pb);this.Pb.style.display=d;this.Pb.style.visibility=a;return n}clj(a){3===a||this.b2e?(Sys.UI.DomElement.addCssClass(this.Pb,to.a.YOb),this.oge=!0):(Sys.UI.DomElement.removeCssClass(this.Pb,
to.a.YOb),this.oge=!1);this.CMn(a)}j9a(a,d,n,z=!1){this.isVisible||(this.xfa||!this.sGh&&this.preventDismissOnScroll||(this.sGh=!1,Ye.a.UHd("ShowLegacyFloatie",""),l.AFrameworkApplication.pa.processAction(Sa.a.showFloatie,2)),this.clj(n),this.qyd=!0,this.GTb=0,this.yzd=!1,!this.oBh||void 0!==this.xfa&&null!==this.xfa?(this.w9d=!1,this.o3(this,!1)):(this.w9d=!0,this.OGk(this)),d=z?a:this.URm(a,d),this.Pb.style.top=d.y.toString()+"px",this.Pb.style.left=d.x.toString()+"px",this.Vv(),this.nff=this.r9b(),
this.gif=gf.a.aEb(a,this.nff),I.a.setOpacity(this.Pb,1),this.Pb.style.zIndex=String(l.AFrameworkApplication.la.hqa),this.Pb.style.display="",this.Sw=!0)}URm(a,d){const n=this.QJj?30:17,z=this.yxi(),O=ae.a.VTa(),ca=ae.a.ima();a=new Sys.UI.Point(a.x,a.y);1===d?a.y-=z.height:3===d?(a.y-=z.height,a.x-=z.width):2===d&&(a.x-=z.width);a.x+z.width>O&&(a.x=Math.floor(O-z.width));0>a.x&&(a.x=0);a.y=3===d||1===d?a.y-n:a.y+n;0>a.y&&(a.y=0);a.y+z.height>ca&&(a.y=ca-z.height);return a}VRm(a,d){const n=a.Y3i;if(n){this.clj(d);
var z=this.yxi();this.xfa=a;a=n.Cgh-n.asd>z.width;var O=n.asd+n.J2f>z.width,ca=n.GEc>z.height+17,Da=n.fSj-(n.GEc+n.G2f)>z.height+17;z=new Sys.UI.Point(n.asd,n.GEc);O||a||(O=!0,z.x=n.Cgh);a=n.HIb?n.Vug?Da?O?2:0:O?3:1:ca?O?3:1:O?2:0:n.Vug?Da?a?0:2:a?1:3:ca?a?1:3:a?0:2;if(3===a||2===a)z.x=n.asd+n.J2f;if(2===a||0===a)z.y=n.GEc+n.G2f;this.j9a(z,a,d);this.qyd=!1;d=this.xfa.sAf.Pb;void 0!==d&&null!==d&&(d.style.zIndex=String(l.AFrameworkApplication.la.hqa))}}N3(){let a=super.N3();this.OA()&&(a=!0);return a}OA(a=
null){if(!this.isVisible)return!1;void 0!==this.wfd&&null!==this.wfd&&this.wfd.mHa(null);void 0!==this.xfa&&null!==this.xfa&&this.xfa.Gqa();this.Gqa();this.oBh&&this.w9d?this.Tel(this):this.z_(this,!1);this.w9d=!1;this.gif=-1;this.xfa=null;this.Pb.style.display="none";this.Sw=!1;this.bpf&&this.bpf(a);return!0}UZf(){void 0!==this.xfa&&null!==this.xfa&&(this.xfa.Qgb=null,this.xfa.Gqa(),this.xfa=null,this.HLe.style.zIndex=String(l.AFrameworkApplication.la.e3),this.Pb.style.zIndex=String(l.AFrameworkApplication.la.hqa))}l3m(a){this.H7d=
a}Q3m(a){this.bpf=a}set GD(a){super.GD=a}}tg.gLh=!1;Object(t.a)(tg,"Floatie",Wx.a,[643,272,273]);class Po{constructor(a,d){this.ut=this.ipa=null;this.K1i=a;this.Esj=d}get Hpi(){return this.ipa}Gpn(a){this.ipa=a}r9b(){return this.ut.r9b()}PIa(){return this.ut?this.ut.isVisible:!1}B0h(a){this.Gpn(a)}showFloatie(a,d){this.j9a(d.location,d.UF,d.isRtl)}j9a(a,d,n){n=n?this.Esj:this.K1i;this.Use();this.ut&&this.ut.j9a(a,n,d)}OA(){this.ut&&this.ut.OA()}Use(){this.ipa&&!this.ut&&(this.ut=Object(qa.a)(tg,this.ipa()))}Ate(){}}
Object(t.a)(Po,"AFloatieManager",null,[507]);class Er extends Po{constructor(){super(1,3);this.rIj=!1}j9a(a,d,n){n=n?this.Esj:this.K1i;this.Use();this.ut&&(this.ut.isVisible&&this.ut.OA(),this.rIj||this.ut.Km(),this.ut.j9a(a,n,d,!0))}Use(){this.Hpi&&!this.ut&&(this.ut=this.ipa())}Ate(){if(this.ut&&this.ut.isVisible){const a=Object(qa.a)(Ri.Control,this.ut.controls["PasteFloatie.FlyoutAnchor"]);a.behavior.mz(a.yFb(),1,null)}}}Object(t.a)(Er,"PasteFloatieManager",Po,[]);var cn=b(914);class Ms{constructor(){this.Wc=
null}get jz(){return null}getTitle(){return null}kwi(){return null}reset(a){this.Wc=a.node}oZa(a){a=Lj.d(this.Wc,a);let d=null;if(!a||a.Qf!==this.Qf)return{returnValue:!1,wL:d};d=Object.assign(new cn.a,{PK:this.key,contentObject:a,title:this.getTitle(a),description:this.kwi(a)});return{returnValue:!0,wL:d}}}Object(t.a)(Ms,"BlobDetailsProvider",null,[287,288]);class Ku extends Ms{constructor(){super()}get key(){return"EQUATION"}get Qf(){return 11}get jz(){return Box4Intl.Box4Strings.l_EquationContentTitle}}
Object(t.a)(Ku,"EquationDetailsProvider",Ms,[]);class Lu{constructor(){this.nzh=null}get key(){return"LINK"}get jz(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(a){this.nzh=hg.HyperlinkReader.UFc(a.node)}oZa(a){let d=null;for(const n of this.nzh)if(n.cpBegin<=a&&a<n.cpEnd)return d=Object.assign(new cn.a,{PK:this.key,contentObject:n.hyperlink}),{returnValue:!0,wL:d};return{returnValue:!1,wL:d}}}Object(t.a)(Lu,"HyperlinkDetailsProvider",null,[287,288]);var ri=b(1192),Im=b(809);class pt{constructor(){this.KCh=
!1}get key(){return"IFRAMENODE"}get jz(){return this.KCh?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}$Uc(a){let d=null;a=a?Bd.ParagraphReader.WHa(a.currentNode):null;if(!a)return{returnValue:!1,Bya:d};d=Object.assign(new ri.a,{PK:this.key,contentId:a.id,contentObject:a});return{returnValue:!0,Bya:d}}Z8b(a,d){a=a?Object(qa.a)(Im.a,a.contentObject):null;d=d?Object(qa.a)(Im.a,d.contentObject):null;let n="";d&&a.id===d.id||(this.KCh=a.upb,n=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,
a.jz,this.jz));return n}}Object(t.a)(pt,"IFrameDetailsProvider",null,[506,288]);class qt extends Ms{constructor(){super()}get key(){return"IMAGE"}get Qf(){return 5}get jz(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(a){return Kd.ImageReader.e4(a.properties)}kwi(a){return Kd.ImageReader.XHa(a.properties)}}Object(t.a)(qt,"ImageDetailsProvider",Ms,[]);class vm{get key(){return"IMAGENODE"}get jz(){return Box4Intl.Box4Strings.l_ImageContentTitle}$Uc(a){let d=null;if(!a||!Kd.ImageReader.Xr(a.currentNode))return{returnValue:!1,
Bya:d};d=Object.assign(new ri.a,{PK:this.key,contentId:a.currentNode.id,contentObject:a.currentNode});return{returnValue:!0,Bya:d}}Z8b(a,d){a=a.contentObject;const n=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let z="";d&&a.id===d.contentObject.id||(z=String.format(n,Kd.ImageReader.e4(a.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return z}}Object(t.a)(vm,"ImageNodeDetailsProvider",null,[506,288]);let hi,Dv;class ep{constructor(a,d){this.nvh=null;this.Ak=d;this.Grf=a;this.key=
ep.keys.J(a);this.jz=ep.NXk.J(a)}reset(a){this.nvh=this.Ak.mba(a.node)}oZa(a){var d=ep.Zll(this.nvh||[],n=>this.F9l(a,n));d=this.b0k(d);return{returnValue:!!d,wL:d}}F9l(a,d){return d.begin<=a&&a<d.end&&(!d.errorDetails||this.Grf===d.errorDetails.proofingType)}b0k(a){return a?Object.assign(new cn.a,{PK:this.key,contentObject:a.errorDetails,description:this.wFb()}):null}wFb(){return l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:
null}static Zll(a,d){for(const n of a)if(d(n))return n;return null}}ep.keys=(Dv=new me.a,Dv.add(1,"SPELLINGERROR"),Dv.add(2,"GRAMMATICALERROR"),Dv.add(3,"ADVANCEDERROR"),Dv);ep.NXk=(hi=new me.a,hi.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),hi.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),hi.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),hi);Object(t.a)(ep,"ProofingDetailsProvider",null,[287,288]);class rt{constructor(){this.tableNode=null;this.wne=this.UVe=
this.columns=this.rows=0}}Object(t.a)(rt,"TableInfo",null,[]);class Mu{get key(){return"TABLE"}get jz(){return Box4Intl.Box4Strings.l_TableContentTitle}$Uc(a){var d=null;if(!Sf.TableCellReader.isTableCell(a))return{returnValue:!1,Bya:d};d=new Dd.GraphIterator;d.Cb(a);a=new rt;a.UVe=km.a.hm(d)+1;a.wne=Vr.a(d)+1;Uf.returnToContainingTable(d);a.tableNode=d.currentNode;a.columns=If.TableReader.nh(a.tableNode);a.rows=If.TableReader.Sf(a.tableNode);d=Object.assign(new ri.a,{PK:this.key,contentId:a.tableNode.id,
contentObject:a});return{returnValue:!0,Bya:d}}Z8b(a,d){a=a.contentObject;const n=new Uj.a;d||n.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,a.columns,a.rows));d&&d.contentObject.wne===a.wne||n.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,a.wne));d&&d.contentObject.UVe===a.UVe||n.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,a.UVe));return n.toArray().join(" ")}}Object(t.a)(Mu,"TableDetailsProvider",null,[506,288]);class Ii{constructor(a,
d){this.i0a=a;this.Ak=d}XSg(){this.i0a.execute(a=>{a.Pca(new Lu);a.Pca(new ep(1,this.Ak));a.Pca(new ep(2,this.Ak));a.Pca(new ep(3,this.Ak));a.Pca(new Ku);a.Pca(new qt);a.lQc(new Mu);a.lQc(new vm);a.lQc(new pt)})}}Object(t.a)(Ii,"AccessibilityActor",null,[]);class au{constructor(a,d,n){this.nxa=a;this.r3j=n}lb(){this.nxa.Aa(Mb.a.eKg,Kb.a.view,Object(m.a)(this,this.RLm,"openAutoCorrectOptionsView"),1028)}RLm(a,d,n){if(1===n)return 32;this.r3j().J5g();return 32}}Object(t.a)(au,"AutoCorrectActor",null,
[]);var Eq=b(1718);class ik{constructor(){this.pLe=!0}PJa(){}Wqb(){}Bzc(){}yIg(){}BXe(){}get HKb(){return!1}get KJb(){return 0}get D3i(){return!1}get t_(){return xa.a.nil}}Object(t.a)(ik,"TextOnlyBox4ImageSteward",null,[505]);class pn{constructor(a,d,n,z,O,ca,Da=!1,Xa=!1,zb=!1,Vb=!1){this.si=a;this.fb=d;this.Gj=n;this.J3c=z;this.cU=O;this.$zb=Da;this.wqf=Xa;this.Fhf=zb;this.Jmf=Vb;this.Ja=ca}create(a,d,n,z){return 1===a?new ik:new Eq.a(d,this.si,this.fb,this.Gj,this.Ja,this.J3c,this.cU,this.$zb,this.wqf,
this.Fhf,this.Jmf,n,z)}}Object(t.a)(pn,"Box4ImageStewardFactory",null,[485]);var Ji=b(47);class bx{constructor(a){this.BGe=a}ndm(a){if(!a||!a.vE||1>a.vE.count)return!1;const d=[Ji.a.eei,Ji.a.dei];return!!this.ewe(a.vE,1,n=>this.ooe(n,d))}RQi(a){return!a||!a.vE||1>a.vE.count?!1:!!this.ewe(a.vE,1,d=>this.ooe(d,[Ji.a.EP]))}tbm(a){return!a||!a.vE||1>a.vE.count?!1:!!this.ewe(a.vE,2,d=>this.ooe(d,[Ji.a.SIe]))}Zf(a){return!a||!a.vE||1>a.vE.count?!1:!!this.ewe(a.vE,1,d=>this.ooe(d,[Ji.a.r8]))}EFe(a){if(!a||
!a.vE)return!1;a=a.vE;for(let d=0;d<a.count;++d)if(!a.J(d)||0<a.J(d).IFk)return!1;return!0}Ogl(a,d){return this.RQi(d)||this.tbm(d)?"":a}ewe(a,d,n){if(a&&0<a.count)for(let z=a.count-1;0<=z;--z){if(n(a.J(z)))return a.J(z);if(a.count-z>=d)break}return null}ooe(a,d){a=a&&a.$Ki?a.$Ki.split(" "):null;if(!a)return!1;for(const n of d)if(0<=Array.indexOf(a,n))return!0;return!1}}Object(t.a)(bx,"Box4PasteStewardUtils",null,[484]);var Bo=b(661);class cx{constructor(){this.oYi={};this.bqe=-1}}Object(t.a)(cx,
"LevelLists",null,[]);class dx{constructor(){this.level=0;this.nwb=null;this.iia=0;this.Tmi=this.qLd=null;this.OOc=!1}}Object(t.a)(dx,"ListItemMetadata",null,[]);class Xx{constructor(){this.iia=0;this.tagName="UL";this.Hrd=null;this.ignore=!1;this.lJd=0}}Object(t.a)(Xx,"ListMetadata",null,[]);class Pd{constructor(a){this.nodes=a;this.Jaa=0;this.lists={};this.uBa=[];this.yLc=null;this.bSa=[];this.bSa[0]=new cx}}Object(t.a)(Pd,"WordConverterArguments",null,[]);var Co=b(1349);class Zg{constructor(a=
null){this.n8c=1;this.b3=a||Co.a.aeg("")}get Mb(){return this.b3}process(a,d){a&&a.querySelectorAll&&(a=a.querySelectorAll("p"))&&0<a.length&&(a=new Bo.a(d,Object(m.a)(this,this.OOg,"processNodesDiscovery"),new Pd(a)),a.Pj("Word Converter Operation"),a.Ce=!d||d.Ce,a.run())}OOg(a,d){const n=d.nodes[d.Jaa];var z=Zg.R9f(n);if(z){let O=d.bSa[z.level-1];O||(O=new cx,d.bSa[z.level-1]=O);d.yLc&&Zg.dwd(n)!==d.yLc&&Zg.ran(d);let ca=O.oYi[z.nwb];if(!ca)ca=new Xx,ca.iia=this.n8c++,ca.Hrd=Zg.k8f(n,5),ca.ignore=
!ca.Hrd||!ca.Hrd.length,ca.tagName=Zg.exe(ca.Hrd),O.oYi[z.nwb]=ca,d.lists[ca.iia.toString()]=ca;else if(!ca.ignore&&1===ca.lJd){const Da=Zg.k8f(n,5);ca.tagName=ca.Hrd===Da?"UL":"OL"}z.iia=ca.iia;ca.ignore||"OL"===ca.tagName&&0<ca.lJd&&O.bqe!==z.iia?(ca.ignore=!0,d.bSa[0].bqe=-1,d.bSa=d.bSa.slice(0,1)):(d.bSa.length>z.level&&(d.bSa=d.bSa.slice(0,z.level)),O.bqe=z.iia,d.uBa[d.uBa.length]=z,ca.lJd++);d.yLc=n}else if((z=d.yLc)&&Zg.dwd(n)===z&&n.tagName===z.tagName&&n.className===z.className){z.appendChild(z.ownerDocument.createElement("BR"));
for(z.appendChild(z.ownerDocument.createElement("BR"));n.firstChild;)z.appendChild(n.firstChild);n.parentNode.removeChild(n)}d.Jaa++;if(d.nodes.length<=d.Jaa){if(!d.uBa.length)return!1;d.Jaa=0;a.ui(Object(m.a)(this,this.NOg,"processNodeConvert"))}return!0}NOg(a,d){var n=d.uBa[d.Jaa];a=n.qLd;const z=d.lists[n.iia.toString()];if(!z.ignore&&(n=Zg.eIl(a,n,z))){Zg.Bkd(a,5);const O=a.ownerDocument.createElement("LI");for(;a.firstChild;)O.appendChild(a.firstChild);n.appendChild(O);a.parentNode.removeChild(a);
"UL"===z.tagName?this.Mb.b++:this.Mb.c++}d.Jaa++;return d.Jaa<d.uBa.length}static eIl(a,d,n){let z=Zg.Wkj(a,d.level,n);const O=Ag.a.Ta(z,"UniqueListId");if(O&&O!==d.iia||!O&&z.firstChild)a=a.ownerDocument.createElement(n.tagName),z.parentNode.insertBefore(a,z.nextSibling),z=a;Ag.a.ql(z,"UniqueListId",d.iia);return Zg.UPf(z,n)}static UPf(a,d){if(d.tagName!==a.tagName){d=a.ownerDocument.createElement(d.tagName);for(Ag.a.ql(d,"UniqueListId",Ag.a.Ta(a,"UniqueListId"));a.firstChild;)d.appendChild(a.firstChild);
a.parentNode.insertBefore(d,a);a.parentNode.removeChild(a);a=d}return a}static Wkj(a,d,n){let z=null,O;1===d?O=Zg.dwd(a):(z=Zg.Wkj(a,d-1,null),O=z.lastChild);if(O&&1===O.nodeType){const ca=O.tagName.toUpperCase();if("UL"===ca||"OL"===ca)return O}n=a.ownerDocument.createElement(n?n.tagName:"UL");1===d?a.parentNode.insertBefore(n,a):z.appendChild(n);return n}static Bkd(a,d){for(let n=0;n<a.childNodes.length;n++){const z=a.childNodes[n];1===z.nodeType&&1<d&&Zg.Bkd(z,d-1);if(Zg.Wng(z)||Zg.QCd(z))a.removeChild(z),
n--}}static R9f(a){if(1===a.nodeType){const d=Zg.UGc(a,"mso-list");if(d&&0<d.length)try{const n=d.split(" ");if(3===n.length){const z=new dx;z.level=Number.parseInvariant(n[1].substr(5));z.nwb=d;z.qLd=a;return z}}catch(n){}}return null}static exe(a){return"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static k8f(a,d){let n=null;for(let z=0;!n&&z<a.childNodes.length;z++){const O=a.childNodes[z];Zg.QCd(O)?(n="string"===typeof O.innerText?O.innerText.trim():O.textContent.trim(),n.length||(n=
"o")):1===O.nodeType&&1<d&&(n=Zg.k8f(O,d-1))}return n}static QCd(a){return 1===a.nodeType&&(a=Zg.UGc(a,"mso-list"))&&0<a.length&&"ignore"===a.trim().toLowerCase()?!0:!1}static Wng(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static UGc(a,d){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(d)){a=a.split(";");for(let n=0;n<a.length;n++){const z=a[n].split(":");if(2===z.length&&z[0].trim()===d)return z[1].trim()}}return null}static dwd(a){do a=a.previousSibling;
while(a&&Zg.wCd(a));return a}static wCd(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(Zg.nmf,""),!a.trim().length):1!==a.nodeType||a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:Zg.wCd(a.firstChild):!0}static ran(a){for(let d=0;d<a.bSa.length;d++){const n=a.bSa[d];n&&(n.bqe=-1)}}}Zg.nmf=RegExp("[\n|\r]","gi");Object(t.a)(Zg,"WordConverter",null,[182]);class hv{constructor(){this.iia=0;this.ULc=Array(9)}}Object(t.a)(hv,"FullListMetadata",null,[]);var bu=b(920);class kw{constructor(){this.level=
0;this.tagName="UL";this.rJb=null;this.ignore=!1;this.lJd=0;this.listStyle="BulletListStyle1";this.uBa=new bu.a;this.font=this.levelText=""}}Object(t.a)(kw,"ListLevelMetadata",null,[]);var lw=b(1223),cu=b(543);class bm{constructor(a=null){this.b3=a||Co.a.aeg("");this.n8c=Number.parseInvariant((new Date).format("HHmmss"))}get Mb(){return this.b3}process(a,d){if(a&&a.querySelectorAll){const ca=a.querySelectorAll("p");if(ca&&0<ca.length){for(var n=0,z=!1,O=ca[0].parentNode;5>n&&O&&O!==a;){n++;const Da=
O.id.toLowerCase();if(Da&&Da.length&&-1!==Da.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(O,"WACEditing")&&Sys.UI.DomElement.containsCssClass(O,"EditingSurfaceBody")){z=!0;break}O=O.parentNode}if(z&&O!==a){n=a.firstChild;for(z=!1;0<O.children.length&&O.children[0]!==n;)a.insertBefore(O.children[0],n),z=!0;if(z)for(;n;)O=n.nextSibling,a.removeChild(n),n=O}a=new Bo.a(d,Object(m.a)(this,this.OOg,"processNodesDiscovery"),new Pd(ca));a.Pj("Word Converter Operation");a.Ce=!d||d.Ce;a.run()}}}OOg(a,
d){const n=d.nodes[d.Jaa];var z=bm.R9f(n);if(z){let ca=z.nwb.replace(RegExp("level[0-9]"),"").trim();ca=ca&&ca.length?ca:z.nwb;let Da=d.lists[ca];Da||(Da=new hv,Da.iia=this.n8c++);let Xa=Da.ULc[z.level-1];Xa||(Xa=new kw,Xa.level=z.level);var O=n.parentNode;if(O&&"li"===O.tagName.toLowerCase()){if(O=O.parentNode)!(O=O.tagName.toUpperCase())||"OL"!==O&&"UL"!==O||(Xa.tagName=O)}else Xa.rJb=bm.Ywi(n,5),Xa.rJb&&Xa.rJb.length||(Xa.rJb=bm.qcg(n,5)),Xa.ignore=!Xa.rJb||!Xa.rJb.length,Xa.tagName=bm.exe(Xa.rJb),
"UL"===Xa.tagName&&(Xa.font=this.Dxi(n,5));z.iia=Da.iia;Xa.lJd++;Xa.ignore||"li"===n.parentNode.tagName.toLowerCase()||(O=(O=bm.qcg(n,5))?O:Xa.rJb)&&O.length&&(z.Tmi=O,(O=bm.jmn(n,O,Xa.listStyle,z.level-1))&&O.length&&(Xa.listStyle=O));d.uBa[d.uBa.length]=z;Xa.uBa.contains(z)||Xa.uBa.add(z);if(void 0===Da.ULc[z.level-1]||null===Da.ULc[z.level-1]||Da.ULc[z.level-1]!==Xa)Da.ULc[z.level-1]=Xa;d.lists[ca]&&d.lists[ca]===Da||(d.lists[ca]=Da);d.yLc=n}else if((z=d.yLc)&&bm.dwd(n)===z&&n.tagName===z.tagName&&
n.className===z.className){z.appendChild(z.ownerDocument.createElement("BR"));for(z.appendChild(z.ownerDocument.createElement("BR"));n.firstChild;)z.appendChild(n.firstChild);n.parentNode.removeChild(n)}d.Jaa++;if(d.nodes.length<=d.Jaa){if(!d.uBa.length)return!1;d.Jaa=0;a.ui(Object(m.a)(this,this.NOg,"processNodeConvert"))}return!0}NOg(a,d){a=d.uBa[d.Jaa];var n=a.qLd,z=a.nwb.replace(RegExp("level[0-9]"),"").trim();z=z&&z.length?z:a.nwb;z=d.lists[z];var O=z.ULc[a.level-1],ca=n.parentNode.tagName.toLowerCase();
if(!O.ignore&&n.parentNode&&"li"!==ca){if(ca=bm.W1k(n,O)){bm.Bkd(n,5);const Da=n.ownerDocument.createElement("LI");Da.setAttribute("data-aria-level",String.format("{0}",a.level));Da.setAttribute(cu.a.rGd,String.format("{0}",z.iia));"UL"===O.tagName&&(Da.setAttribute(cu.a.ZIe,String.format("{0}",a.Tmi)),Da.setAttribute(cu.a.Cvg,String.format("{0}",O.font)));for(;n.firstChild;)Da.appendChild(n.firstChild);ca.appendChild(Da);n.parentNode.removeChild(n);"UL"===O.tagName?this.Mb.b++:this.Mb.c++}}else"li"===
ca&&(O=O.tagName,n=n.parentNode,a.OOc&&(a=n.parentNode)&&a.tagName.toUpperCase()===O&&a.setAttribute("data-pasteFromRc","true"),n.setAttribute(cu.a.rGd,String.format("{0}",z.iia)),"UL"===O?this.Mb.b++:this.Mb.c++);d.Jaa++;return d.Jaa<d.uBa.length}Dxi(a,d){let n=null;for(let z=0;!n&&z<a.childNodes.length;z++){const O=a.childNodes[z];n=bm.BAl(O);!n&&1===O.nodeType&&1<d&&(n=this.Dxi(O,d-1))}return n}static W1k(a,d){a=bm.U1k(a,d.tagName);return bm.UPf(a,d)}static UPf(a,d){if(d.tagName!==a.tagName){for(d=
a.ownerDocument.createElement(d.tagName);a.firstChild;)d.appendChild(a.firstChild);a.parentNode.insertBefore(d,a);a.parentNode.removeChild(a);a=d}return a}static U1k(a,d){d=a.ownerDocument.createElement(d?d:"UL");var n=a.getAttribute("start");n&&0<n.length&&(d.setAttribute("start",n),a.removeAttribute("start"));(n=a.className)&&0<n.length&&(n="OL"===d.tagName?lw.a.rAe(n,"NumberListStyle"):lw.a.rAe(n,"BulletListStyle"),0<n.length&&(Sys.UI.DomElement.addCssClass(d,n),Sys.UI.DomElement.removeCssClass(a,
n)));a.parentNode.insertBefore(d,a);return d}static Bkd(a,d){for(let n=0;n<a.childNodes.length;n++){const z=a.childNodes[n];1===z.nodeType&&1<d&&bm.Bkd(z,d-1);if(bm.Wng(z)||bm.QCd(z))a.removeChild(z),n--}}static R9f(a){if(1===a.nodeType){var d=bm.UGc(a,"mso-list");if(d&&0<d.length)try{var n=d.split(" ");if(3===n.length){var z=new dx;z.level=Number.parseInvariant(n[1].substr(5));z.nwb=d;z.qLd=a;z.OOc=!0;return z}}catch(O){}else if((n=a.parentNode)&&"li"===n.tagName.toLocaleLowerCase()&&(d=n.getAttribute("data-"+
pd.a.Phd),n=n.getAttribute(cu.a.rGd),d&&n&&0<d.length&&0<n.length))return z=new dx,z.level=Number.parseInvariant(d),z.nwb=n+" level"+d,z.qLd=a,z.OOc=!1,z}return null}static jmn(a,d,n,z){if("p"===a.tagName.toLowerCase()&&d&&d.length){if("UL"===bm.exe(d))return n=bm.Ftl(d),Sys.UI.DomElement.addCssClass(a,n),n;var O;return(O=d.match(RegExp("^[0-9]+")))&&O.length?(n="NumberListStyle1",Sys.UI.DomElement.addCssClass(a,n),a.setAttribute("start",O[0]),n):(O=d.match(RegExp("^[a-zA-Z]+")))&&O.length&&(O=O[0],
z=(d=O.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&d.length?bm.MMl(n,z):1,1!==z&&((n=bm.Ioe(a,O,RegExp("^[ivxlcdm]+"),w.a.RPf,"NumberListStyle3"))||(n=bm.Ioe(a,O,RegExp("^[IVXLCDM]+"),w.a.RPf,"NumberListStyle5")))||z&&((n=bm.Ioe(a,O,RegExp("^[a-z]+"),w.a.MPf,"NumberListStyle2"))||(n=bm.Ioe(a,O,RegExp("^[A-Z]+"),w.a.MPf,"NumberListStyle4"))))?n:"NumberListStyle1"}return null}static Ftl(a){switch(a){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static MMl(a,
d){a&&a.length||(a="");switch(a){case "NumberListStyle2":case "NumberListStyle4":a=1;break;case "NumberListStyle3":case "NumberListStyle5":a=0;break;default:a=-1}if(0>a)switch(d%3){case 0:a=0;break;case 1:a=1;break;case 2:a=0;break;default:a=0}return a}static Ioe(a,d,n,z,O){return(d=d.match(n))&&d.length?(z=z(d[0]),z=1>z?1:z,Sys.UI.DomElement.addCssClass(a,O),a.setAttribute("start",z+""),O):null}static exe(a){return bm.B8l(a)?"UL":"OL"}static B8l(a){return!a||"\u00a7"===a||"\u00b7"===a||"o"===a||
"-"===a||"\u00d8"===a||"v"===a||"\u00fc"===a||"\u2666"===a||"\u00a8"===a}static qcg(a,d){let n=null;var z;let O,ca;for(let Da=-1;!n&&Da<a.childNodes.length;Da++){const Xa=-1===Da?a:a.childNodes[Da];if(Xa)if((z=Xa.innerHTML)&&0<z.length){if(O=z.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=O&&(ca=z.indexOf("\x3c!--[endif]--\x3e"),0<=ca)){z=z.substring(O,ca+14);Xa.innerHTML=Xa.innerHTML.replace(z,"");if(z.length){a=a.ownerDocument.createElement("span");a.innerHTML=z;n=a.innerText.trim();break}n&&n.length||
(n="o")}}else 0<=Da&&1===Xa.nodeType&&1<d&&(n=bm.qcg(Xa,d-1))}return n}static BAl(a){let d=null;1===a.nodeType&&((d=bm.Cxi(a,"font-family"))||(d=bm.Cxi(a,"mso-ascii-font-family")));return d}static Cxi(a,d){return(a=bm.UGc(a,d))&&0<a.length?a.trim():null}static Ywi(a,d){let n=null;for(let z=0;!n&&z<a.childNodes.length;z++){const O=a.childNodes[z];bm.QCd(O)?(n="string"===typeof O.innerText?O.innerText.trim():O.textContent.trim(),n.length||(n="o"),O.parentNode.removeChild(O)):1===O.nodeType&&1<d&&(n=
bm.Ywi(O,d-1))}return n}static QCd(a){return 1===a.nodeType&&(a=bm.UGc(a,"mso-list"))&&0<a.length&&"ignore"===a.trim().toLowerCase()?!0:!1}static Wng(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static UGc(a,d){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(d)){a=a.split(";");for(let n=0;n<a.length;n++){const z=a[n].split(":");if(2===z.length&&z[0].trim()===d)return z[1].trim()}}return null}static dwd(a){do a=a.previousSibling;while(a&&bm.wCd(a));return a}static wCd(a){return a?
3===a.nodeType?(a=a.nodeValue,a=a.replace(bm.nmf,""),!a.trim().length):1!==a.nodeType||a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:bm.wCd(a.firstChild):!0}}bm.nmf=RegExp("[\n|\r]","gi");Object(t.a)(bm,"WacAndRichClientWordConverter",null,[182]);class ex{constructor(a){this.V3=a.ea("ExternalPasteImprovementsEnabled")&&a.ea("ListMarkerIsEnabled")}create(a=null){return this.V3?new bm(a):new Zg(a)}}Object(t.a)(ex,"Box4WordConverterFactory",null,[483]);var Yx=b(1581);class Nu{constructor(a,
d,n,z,O){this.ivh=0;this.Bc=a;this.rd=d;this.jaf=O;this.Xpa=n;this.G1a=z}eRk(a,d,n){k.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",d,n,this.rd.qI);a.Ce&&this.rd.el&&window.chrome&&k.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",d);this.Xpa.wqd(!!(d&16));this.G1a.create(a,Object(m.a)(this,this.aSn,"waitingForEnsureAccessOperationResult"),null).Pj("ClipboardPreProcess");this.ivh=Date.now()}cbn(){this.Xpa.reset()}aSn(a){let d=
!0;const n=this.Xpa.Vfl;null!=n?(a.S4=n,d=!1):Date.now()-this.ivh>this.jaf&&(k.ULS.sendTraceTag(18354843,307,50,null),this.Bc.mb(Ee.a.Yaa,{["Reason"]:Jf.a.tKg}),d=a.S4=!1);return d}}Object(t.a)(Nu,"ClipboardOperationClipboardAccessHelper",null,[481]);class Zx{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le,Ve){this.Pcb=null;this.ga=a;this.Bc=d;this.zC=n;this.Ee=z;this.Da=O;this.Xpa=ca;this.Ha=Da;this.ud=Xa;this.pq=zb;this.mc=Vb;this.Xdb=Fc;this.Uce=Yc;this.HG=yd;this.xk=Le;this.mtc=je?je.ea("ImageDataURLSkippedForSafari12IsEnabled"):
!1;this.B9d=je?je.ea("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.Ja=Ve}get Pg(){return this.Ee}get Lb(){return this.Bc}get gCd(){if(null==this.Pcb)if(this.Ja)if(this.Ja.tk.isCompleted)this.Pcb=this.Ja.isFeatureEnabled(44)&&this.Ja.isFeatureEnabled(4);else return!1;else this.Pcb=!1;return this.Pcb}WRn(a){a.BM();return!0}Nai(a,d){a=d.aE;k.ULS.shipAssertTag(18130960,307,!!(a&16));if(a&256){let z=!1,O;I.a.fJa&&l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");
this.gCd&&d.Tc&&d.Tc.Yf&&(z=this.xk.AUh(d.Tc.Yf.editingElement));O=this.xk.Ofg(d.Tc.Yf.editingElement,!1);var n=d.Tc.Yf.editingElement;this.xk.Elg(n,!1,1);this.mtc&&I.a.fJa?(n=d.Tc.Yf.editingElement,this.xk.EVg(n,"data-src","data-srcurl"),a=this.Xpa.copy(),this.xk.EVg(n,"data-srcurl","data-src")):this.B9d&&d.Tc&&d.Tc.Yf?(n=this.xk.bLf(d.Tc.Yf.editingElement,d.Tc.dt,!0),a=this.Xpa.copy(),n&&this.xk.bLf(d.Tc.Yf.editingElement,d.Tc.dt,!1)):(this.xk.goj(d.Tc.Yf.editingElement),a=this.Xpa.copy());this.gCd&&
z&&this.xk.u7m(d.Tc.Yf.editingElement);O&&this.xk.Ofg(d.Tc.Yf.editingElement,!0);n=d.Tc.Yf.editingElement;this.xk.Elg(n,!1,0);if(!a)return k.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),this.Lb.mb(Ee.a.HEb,{["Reason"]:Jf.a.CXd}),d.OY&&d.OY.fail("SystemClipboard did not copy",!1),d.failed=!0,!1}return!0}fQf(a,d){const n=d.Tc;k.ULS.shipAssertTag(18130961,307,!!(d.aE&16));d.Uwn?this.zC.j7h():this.zC.Roe(n,a);return!0}Bfi(a,d){var n=d.context,z=d.$c;const O=d.pO;var ca=!1;a=this.Da.ya.Ba.Fb;
if(this.Ha.rh(a)||this.ud.sg(a)){const Da=this.mc.Dg(a.node),Xa=Da.kc();k.ULS.shipAssertTag(18130962,307,Xa);this.pq.Uc(Da);this.Xdb.X5a(Da)&&(ca=!0)}z=d.aE&64?new dh.DictionaryPropertySet:z||new dh.DictionaryPropertySet;z.setValue(Xc.a.mDc,!1);n=this.ga.rf(n,Mb.a.iK,2,!0,O,z);8===n&&(k.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Lb.mb(Ee.a.Yaa,{["Reason"]:Jf.a.Hqe}),d.OY&&d.OY.fail("DeleteKey failed",!1),d.failed=!0);32===n&&ca&&(d=this.Da.ya.Ba,this.ud.qj(d)&&d.ra.node===a.node&&!this.Ha.textLength(d.ra.node)&&
(d=this.mc.Dg(d.ra.node),a=this.ud.Vm(d),k.ULS.shipAssertTag(18130964,307,a),this.pq.Uc(d),this.Xdb.RJc(d)||(a=this.Uce.create(),a.Cb(d),this.pq.D0(a,!1,!1),ca=this.pq.Sd(a),this.Ha.nb(ca)&&(this.pq.Uc(a),this.Pg.merge(a,d,!1,!1),this.Da.setSelection(this.HG.Pc(ca,this.Ha.textLength(ca)))))));return!0}}Object(t.a)(Zx,"ClipboardOperationCutCopy",null,[501]);class Yq{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le,Ve){this.ga=a;this.Bc=d;this.zC=n;this.Xpa=ca;this.Da=O;this.Ee=z;this.Ha=Da;this.ud=
Xa;this.pq=zb;this.mc=Vb;this.Xdb=Fc;this.Uce=Yc;this.HG=yd;this.va=je;this.xk=Le;this.Ja=Ve}create(){return new Zx(this.ga,this.Bc,this.zC,this.Ee,this.Da,this.Xpa,this.Ha,this.ud,this.pq,this.mc,this.Xdb,this.Uce,this.HG,this.va,this.xk,this.Ja)}}Object(t.a)(Yq,"Factory",null,[480]);class fx{}Object(t.a)(fx,"ClipboardOperationCutStrategy",null,[479]);var Vg=b(1517);class nr{constructor(a,d){this.t4d=null;this.zC=a;this.Xda=d;this.OM=0}process(a,d){this.OM||(this.t4d=[Object(m.a)(this,this.XYk,"copyGlossarySelection"),
Object(m.a)(this.Xda,this.Xda.GPm,"pasteGlossaryPlaceholder")]);let n=!0;this.OM<this.t4d.length&&(n=this.t4d[this.OM++](a,d));return n?this.OM<this.t4d.length:!1}XYk(a,d){if(!Object(Uc.a)(90,d.$c))return!1;const n=Object(qa.a)(90,d.$c);if(!n.hasProperty(Xc.a.FAe))return!1;const z=n.getValue(Xc.a.FAe),O=d.Tc,ca=O.Oa;this.zC.$Qj();ca.sMb(()=>{ca.setSelection(z,void 0,!0);this.zC.Roe(O,a)},!0);return!0}}Object(t.a)(nr,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[502]);var Kn=b(594);
class Do{constructor(a){this.bSb=null;this.w9=a;this.OM=-1}process(a,d){-1===this.OM&&(this.B6k(a,d),this.OM=0);let n=!1;this.OM<this.bSb.length&&(n=this.bSb[this.OM++](a,d));return n?this.OM<this.bSb.length:!1}B6k(a,d){I.a.v4||d.aE&512?(this.bSb=[Object(m.a)(this.w9,this.w9.fQf,"copyInternal")],k.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!a.Ce&&d.aE&256?(this.bSb=[Object(m.a)(this.w9,this.w9.WRn,"waitBeforeCopy"),Object(m.a)(this.w9,this.w9.Nai,
"copyExternal"),Object(m.a)(this.w9,this.w9.fQf,"copyInternal")],k.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.bSb=[Object(m.a)(this.w9,this.w9.Nai,"copyExternal"),Object(m.a)(this.w9,this.w9.fQf,"copyInternal")],k.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));d.aE&32&&(a=Object(m.a)(this.w9,this.w9.Bfi,"deleteForCut"),this.bSb.push(a),
k.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));Kn.a.Hmm(d)}}Object(t.a)(Do,"ClipboardOperationCutCopyProcessor",null,[500]);class Ev{constructor(a,d,n,z){this.iae=null;this.zC=a;this.Da=d;this.w9=n;this.Xda=z;this.OM=0}process(a,d){this.OM||(this.iae=[Object(m.a)(this,this.$Yk,"copyMovedSelection"),Object(m.a)(this.w9,this.w9.Bfi,"deleteForCut"),Object(m.a)(this,this.tId,"moveIp"),Object(m.a)(this.Xda,this.Xda.Xdj,"pasteInternal"),
Object(m.a)(this.Xda,this.Xda.Kyj,"setSelectionAfterPaste")]);let n=!0;this.OM<this.iae.length&&(n=this.iae[this.OM++](a,d));return n?this.OM<this.iae.length:!1}$Yk(a,d){d=d.Tc;this.zC.nQn();this.zC.Roe(d,a);return!0}tId(a,d){d=new pa.Selection([d.$c],!0);this.Da.setSelection(d,a);return!0}}Object(t.a)(Ev,"ClipboardOperationMoveProcessor",null,[499]);var vs=b(1516);class mw{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le,Ve,gg,Lh){this.zC=a;this.ga=d;this.ZYc=n;this.Bc=z;this.ud=O;this.rd=ca;
this.Nb=Da;this.W3d=Xa;this.e5j=zb;this.Uqc=Vb;this.xaf=Fc;this.NYc=Yc;this.G1a=yd;this.zt=je;this.Eb=Le;this.Gj=Ve;this.wA=gg;this.W$=Lh}create(a,d,n,z,O,ca,Da,Xa,zb=!0){const Vb=this.W3d.create(z,Object(qa.a)(90,Xa));var Fc=this.e5j.create();const Yc=new nr(this.zC,Vb),yd=new Ev(this.zC,Lg.a.instance,Fc,Vb);Fc=new Do(Fc);z=new vs.a(l.AFrameworkApplication.K,$t.a.instance,z,Ch.a.instance,Vb,this.Uqc);return new Vg.a(a,d,n,O,ca,Da,Xa,this.ZYc,this.ga,this.Bc,this.ud,this.rd,this.Nb,Yc,yd,Fc,z,this.Uqc,
this.xaf,this.NYc,this.G1a,this.zt,this.Eb,this.Gj,this.wA,this.W$,l.AFrameworkApplication.mZe(),zb)}}Object(t.a)(mw,"Factory",null,[478]);class Zr{constructor(a,d){this.G$b=a.S8f(d);this.pQf=a.Dwl(d);this.D4b=a.r6f(d);this.rCb=a.G5f(d)}static QB(a){return Zr.Ao(a)}static Ao(a){return new Zr(Kk.a.instance,a)}}Object(t.a)(Zr,"CpUsageHelper",null,[]);class $x{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc){this.i2=null;this.Bc=a;this.zC=d;this.f$c=n;this.jGa=z;this.Da=O;this.ga=ca;this.phf=Da;this.hyf=
zb;this.xqf=Xa;this.ndf=Vb;this.vaf=Fc;this.Eb=Yc;this.uJh=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("WordEditorPasteFailuresImprovementIsEnabled")}get eh(){return this.hyf.value}get QDa(){return this.jGa}get Lb(){return this.Bc}get I7a(){return this.xqf.I7a}paste(a,d){const n=this.Eb.Jhb();try{const z=d.Tc,O=d.aE;this.r0&&ci.oon(this.Da);k.ULS.shipAssertTag(18131010,307,!!(O&1));Object(Uc.a)(90,d.$c)&&d.$c.setValue(bd.a.Mfa,z.Yf.editingElement.clientWidth);this.vaf.nIn(a,d);let ca;
if(!({Boe:ca}=this.phf.value.yLj(ca)).returnValue)return this.ZGd(d,"HTML import strategy failed",!1),ja.Health.instance.recordQosError("HtmlImportStrategyFailed",[Kn.a.EQe],!1,!0,!0,!1,null),!1;this.eh.$A();let Da=!0,Xa=null;const zb=this.ndf.create(ca),Vb=d.XQj;if((!z||!z.Oa)&&this.uJh)return this.ZGd(d,"Fail to set selection.",!1),ja.Health.instance.recordQosError("SetSelectionFailed",[Kn.a.EQe],!1,!0,!0,!1,null),!1;z.Oa.sMb(()=>{Vb&&2===this.ga.processAction(Mb.a.ara,2)?Da=!1:(Xa=Vb?this.Da&&
this.Da.ya&&this.Da.ya.Ba?this.Da.ya.Ba.ra:null:d.$c)?(k.ULS.shipAssertTag(18158338,307,Qd.SelectionEditor.Cd(Xa)),this.F0i(Xa,"paste")):k.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Vb)},this.xqf.ATi);if(!Da)return this.ZGd(d,"fail to deleteForReplace.",!0),!1;if(!Xa&&this.uJh)return this.ZGd(d,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!Xa.node||!Xa.node.isConnected)return this.ZGd(d,"node is null or not connected in ip context.",!0),!1;z.editingView.disable(!0,
25);zb.restore();this.f$c.CPm(ca,Xa,a);return!0}finally{n&&n.dispose()}}ZGd(a,d,n){a.failed=!0;a.OY&&a.OY.fail(d,n)}GPm(a,d){const n=Object(qa.a)(90,d.$c).getValue(Xc.a.Ceg);k.ULS.shipAssertTag(20492440,307,Qd.SelectionEditor.Cd(n));if(!this.v6h(n,d))return!1;this.eh.$A();d=(new jn.a).Wb(15);d.Sa(this.zC.oua);this.f$c.DOi(n,a);this.zC.j7h();d.dispose();return!0}Xdj(a,d){const n=this.Da.ya.Ba.ra;if(!this.v6h(n,d))return!1;this.eh.$A();this.ga.processAction(Mb.a.ara,2);this.F0i(n,"intPaste");this.f$c.DOi(n,
a);return!0}v6h(a,d){if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("AbortClipboardOperationForInvalidIpContext")){if(!a||!a.Yb)return k.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!d&&d.Usg),d.OY&&(d.OY.fail("Invalid ipContext before InternalPasteAtIp",!0),d.failed=!0),!1;if(!Qd.SelectionEditor.Cd(a))return k.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",!!d&&
d.Usg,a.contextId,!!a.node,!!a.node&&!!a.node.anchor),d.OY&&(d.OY.fail("ipContext is not insertion point in InternalPasteAtIp",!0),d.failed=!0),!1}return!0}F0i(a,d){d=Zr.QB(d);this.QDa.R_m(d,a.node,a.cpBegin);this.QDa.Jmm(d.pQf);this.QDa.kxg(d.G$b);this.QDa.Rwg(d.D4b);this.QDa.Owg(d.rCb)}Kyj(a,d){if(!d.XQj)return!1;d.aE&64&&this.zC.ZQj();if(!d.OEb)return k.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Lb.mb(Ee.a.u1,{["Reason"]:Jf.a.F5a}),d.OY&&d.OY.fail("No selection after paste",
!1),d.failed=!0,!1;this.xqf.iQn(d);this.eh.$A();return!1}get r0(){null==this.i2&&(l.AFrameworkApplication.Yi("he991617;3eed2178"),this.i2=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.i2}}Object(t.a)($x,"ClipboardOperationPaste",null,[497]);class ay{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc){this.Bc=a;this.zC=d;this.f$c=n;this.jGa=z;this.Da=O;this.ga=ca;this.hyf=Xa;this.hjk=Da;this.ndf=zb;this.vaf=
Vb;this.Eb=Fc}create(a,d){d=this.hjk.create(this.Da,d);return new $x(this.Bc,this.zC,this.f$c,this.jGa,this.Da,this.ga,a,d,this.hyf,this.ndf,this.vaf,this.Eb)}}Object(t.a)(ay,"Factory",null,[476]);var by=b(1434);class Ou{constructor(a,d){this.uAn=a;this.HOm=d}}Object(t.a)(Ou,"ParagraphFormatStore",null,[]);class Bz{constructor(a,d,n,z){this.Da=a;this.Ha=d;this.Xb=n;this.Dkf=z}nIn(a,d){if(d.BKc&&this.Dkf){d=a.S4;var n=this.Da.ya.Ba.ra.node,z=null;this.Ha.nb(n)&&(z=this.Xb.im(n),n=this.Ha.V4a(n),z=
new Ou(z,n));d=new by.a(d.context,d.aE,d.OY,d.pO,d.$c,z);a.S4=d}}}Object(t.a)(Bz,"ClipboardOperationPasteOvertypeStrategy",null,[477]);class Jm{constructor(a){this.Bmf=null;this.Da=a;a.sMb(d=>{this.Bmf=d},!1)}get ATi(){return!1}iQn(a){a=this.ADf(a);this.setSelection(this.Da,a)}ADf(a){let d=a.OEb;(a.zua||a.IKa)&&a.M_e&&(d=ye.SelectionFactory.Mx(a.M_e,d.ra));return d}setSelection(a,d){a.setSelection(d)}}Object(t.a)(Jm,"AClipboardOperationPasteStrategy",null,[520]);class nw extends Jm{constructor(a){super(a)}get I7a(){return this.Bmf}}
Object(t.a)(nw,"ClipboardOperationPasteToLiveSelectionStrategy",Jm,[]);class Fv extends Jm{constructor(a,d){super(a);this.ezf=null;this.J7c=d;a.sMb(n=>{this.ezf=n},!0)}get ATi(){return!0}get I7a(){return this.ezf}ADf(a){let d=super.ADf(a);a.$c.setValue(Xc.a.dMg,d);return d=this.J7c.iAi(this.Bmf.Ba,this.ezf.Ba,d)}}Object(t.a)(Fv,"ClipboardOperationPasteToVirtualSelectionStrategy",Jm,[]);class ow{constructor(a){this.J7c=null;this.Ked=a.ea("EnableVirtualSelectionInSelectionManager")}create(a,d){return d&&
d.fa(Xc.a.zua,!1)&&this.Ked?new Fv(a,this.FRn):new nw(a)}get FRn(){this.J7c||(this.J7c=la.a.instance.sa("Box4.Actors.IVirtualSelectionMerger"));return this.J7c}}Object(t.a)(ow,"ClipboardOperationPasteStrategyFactory",null,[475]);class My{constructor(a,d,n,z,O){this.Bc=a;this.Da=d;this.yk=n;this.vn=z;this.$dk=O}ZSm(a){this.$dk&&(a&1||a&32)&&this.yk.eq&&this.Da.h2b()}Q8l(a,d){return a&1&&this.vn.E3(d,!0)?(this.Bc.mb(Ee.a.af,{["Reason"]:Jf.a.CF}),!1):!0}}Object(t.a)(My,"ClipboardOperationWordStrategy",
null,[]);class Ny{constructor(){}FYk(a,d){if(d)if(d=d.sheet)if(d=d.cssRules){var n=Array.clone(d);n.reverse();var z=d=0,O=0,ca=0;for(const Xa of n){n=Xa.style;var Da=Xa.selectorText;n=n?n.cssText:null;Da=Da?Da.split(","):null;if(n&&Da&&Xa.type===Xa.STYLE_RULE){ca+=Da.length;for(const zb of Da){0<=zb.indexOf("#")&&d++;0<=zb.indexOf(".")&&z++;0>zb.indexOf("#")&&0>zb.indexOf(".")&&O++;Da=null;try{Da=a.querySelectorAll(zb)}catch(Vb){k.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",
zb,Vb.message)}if(Da)for(let Vb=0;Vb<Da.length;Vb++)Da[Vb].setAttribute("style",n+(Da[Vb].getAttribute("style")||""))}}}k.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",ca,d,z,O)}else this.l1i();else this.l1i()}l1i(){k.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",I.a.qI)}}Object(t.a)(Ny,"ExternalPasteCssConverter",null,
[474]);var Ht=b(1028);class Cz{constructor(a,d=null,n=null){this.Ve=a;this.b3=d||Co.a.JDi("");this.vpk=n||Co.a.KDi("")}get Mb(){return this.b3}get T9g(){return this.vpk}wna(a){this.T9g.b++;this.Ve.wna(a)}tna(){this.Ve.tna()}vna(a){this.T9g.c++;this.Ve.vna(a)}una(){this.Ve.una()}sna(a){this.T9g.d++;this.Ve.sna(a)}rna(){this.Ve.rna()}reset(){this.Ve.reset()}get iod(){return this.Ve.iod}xna(a,d){this.Mb.b++;this.Ve.xna(a,d)}DWa(a){this.Mb.c++;this.Ve.DWa(a)}lKb(a){this.Mb.b++;this.Ve.lKb(a)}PJa(a){this.Mb.d++;
this.Ve.PJa(a)}zWa(a){this.Mb.f++;this.Ve.zWa(a)}f7a(a,d){this.Mb.g++;this.Ve.f7a(a,d)}e7a(){this.Ve.e7a()}IK(a){this.Mb.h++;this.Ve.IK(a)}HK(){this.Ve.HK()}iKb(){this.Ve.iKb()}hKb(){this.Ve.hKb()}m7a(a,d){this.Mb.i++;this.Ve.m7a(a,d)}Tqb(){this.Ve.Tqb()}GWa(a){this.Mb.j++;this.Ve.GWa(a)}EWa(){this.Ve.EWa()}l7a(a){this.Mb.k++;this.Ve.l7a(a)}FWa(){this.Ve.FWa()}Wqb(a){this.Mb.l++;this.Ve.Wqb(a)}}Object(t.a)(Cz,"SemanticEventUsageCollector",null,[179,180]);var jo=b(585);class cy{constructor(a,d=null,
n=null,z=null){this.I5j="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");this.Ve=a;this.b3=d||Co.a.myi(I.a.Qhb,"");this.Rw=n;this.xnk=z?z.ea("ParseStyleForHtmlTagEventIsEnabled"):!1;this.ynk=z?z.ea("ParseStyleForUncommonHtmlTagEventIsEnabled"):!1;this.Crh=new qi.a(ma.a.Xi());for(const O of this.I5j)this.Crh.add(O)}get Mb(){return this.b3}get Sm(){return this.Rw}yh(a){return a?a+1:1}reset(){this.Ve.reset()}fNe(){this.Ve.fNe()}lfg(a){if(a&&this.Sm&&
(a.getAttribute&&(a.getAttribute(jo.a.P6k)&&(this.Sm.Zqi=!0),a.getAttribute(jo.a.jqe)&&(this.Sm.Sol=!0),a.getAttribute(jo.a.Wnd)&&(this.Sm.FMf=a.getAttribute(jo.a.Wnd)),a.getAttribute(jo.a.T6k)&&(this.Sm.$qi=!0)),a.id&&a.id.startsWith&&a.id.startsWith(jo.a.bUl)&&(this.Sm.Uol=!0),a.className&&a.className.split))for(const d of a.className.split(" ")){d.startsWith(jo.a.ILm)&&(this.Sm.Wol=!0);d.startsWith(jo.a.oSm)&&(this.Sm.ari=!0);d.startsWith(jo.a.USn)&&(this.Sm.bri=!0);if(d.startsWith(I.a.Sid)&&d.length===
I.a.Sid.length+1){const n=parseInt(w.a.substring(d,d.length-1,d.length));isNaN(n)||(this.Sm.Cmd=n)}if(d===jo.a.xym||d===jo.a.yym)this.Sm.tve=!0}return this.Ve.lfg(a)}onClose(){this.Ve.onClose()}xna(a,d){this.Sm&&(this.Sm.Xol=!0);this.Mb.d=this.yh(this.Mb.d);this.Ve.xna(a,d)}YMe(a){this.Mb.e=this.yh(this.Mb.e);this.ni(a);return this.Ve.YMe(a)}CFg(a){this.Mb.f=this.yh(this.Mb.f);this.ni(a);return this.Ve.CFg(a)}EFg(a){this.Mb.g=this.yh(this.Mb.g);this.ni(a);return this.Ve.EFg(a)}IFg(a){this.Mb.h=this.yh(this.Mb.h);
this.ni(a);return this.Ve.IFg(a)}XFg(a){this.Mb.i=this.yh(this.Mb.i);this.ni(a);return this.Ve.XFg(a)}YFg(a){this.Mb.j=this.yh(this.Mb.j);this.ni(a);this.Ve.YFg(a)}dNe(a){this.Mb.k=this.yh(this.Mb.k);this.ni(a);return this.Ve.dNe(a)}ZFg(a){this.Mb.l=this.yh(this.Mb.l);this.ni(a);this.Ve.ZFg(a)}$Fg(a){this.Mb.m=this.yh(this.Mb.m);this.ni(a);this.Ve.$Fg(a)}aGg(a){this.Mb.n=this.yh(this.Mb.n);this.ni(a);return this.Ve.aGg(a)}hNe(a){this.Mb.o=this.yh(this.Mb.o);this.ni(a);return this.Ve.hNe(a)}jNe(a){this.Mb.p=
this.yh(this.Mb.p);this.ni(a);return this.Ve.jNe(a)}kGg(a){this.Mb.q=this.yh(this.Mb.q);this.ni(a);return this.Ve.kGg(a)}kNe(a){this.Mb.r=this.yh(this.Mb.r);this.ni(a);this.Ve.kNe(a)}mGg(a){this.Mb.s=this.yh(this.Mb.s);this.ni(a);return this.Ve.mGg(a)}mNe(a){this.Mb.t=this.yh(this.Mb.t);this.ni(a);return this.Ve.mNe(a)}nNe(a){this.Mb.u=this.yh(this.Mb.u);this.ni(a);return this.Ve.nNe(a)}pNe(a){this.Mb.v=this.yh(this.Mb.v);this.ni(a);return this.Ve.pNe(a)}qNe(a){this.Mb.w=this.yh(this.Mb.w);this.ni(a);
return this.Ve.qNe(a)}yGg(a){this.Mb.x=this.yh(this.Mb.x);this.ni(a);this.Ve.yGg(a)}zGg(a){this.Mb.y=this.yh(this.Mb.y);this.ni(a);return this.Ve.zGg(a)}wNe(a){this.Mb.z=this.yh(this.Mb.z);this.ni(a);return this.Ve.wNe(a)}xNe(a){this.Mb.ba=this.yh(this.Mb.ba);this.ni(a);return this.Ve.xNe(a)}BNe(a){this.Mb.bb=this.yh(this.Mb.bb);this.ni(a);return this.Ve.BNe(a)}CNe(a){this.Mb.bc=this.yh(this.Mb.bc);this.ni(a);return this.Ve.CNe(a)}ENe(a){this.Mb.bd=this.yh(this.Mb.bd);this.ni(a);return this.Ve.ENe(a)}FNe(a){this.Mb.be=
this.yh(this.Mb.be);this.ni(a);return this.Ve.FNe(a)}HNe(a){this.Mb.bf=this.yh(this.Mb.bf);this.ni(a);return this.Ve.HNe(a)}JNe(a){this.Mb.bg=this.yh(this.Mb.bg);this.ni(a);return this.Ve.JNe(a)}bHg(a){this.Mb.bh=this.yh(this.Mb.bh);this.ni(a);return this.Ve.bHg(a)}PNe(a){this.Mb.bi=this.yh(this.Mb.bi);this.ni(a);return this.Ve.PNe(a)}gHg(a){this.Mb.bj=this.yh(this.Mb.bj);this.ni(a);return this.Ve.gHg(a)}iHg(a){this.Mb.bk=this.yh(this.Mb.bk);this.ni(a);this.Ve.iHg(a)}jHg(a){this.Mb.bl=this.yh(this.Mb.bl);
this.ni(a);return this.Ve.jHg(a)}SNe(a){this.Mb.bm=this.yh(this.Mb.bm);this.ni(a);return this.Ve.SNe(a)}TNe(a){this.Mb.bm=this.yh(this.Mb.bm);this.ni(a);return this.Ve.TNe(a)}UNe(a){this.Mb.bm=this.yh(this.Mb.bm);this.ni(a);return this.Ve.UNe(a)}VNe(a){this.Mb.bm=this.yh(this.Mb.bm);this.ni(a);return this.Ve.VNe(a)}WNe(a){this.Mb.bm=this.yh(this.Mb.bm);this.ni(a);return this.Ve.WNe(a)}XNe(a){this.Mb.bm=this.yh(this.Mb.bm);this.ni(a);return this.Ve.XNe(a)}qHg(a){this.Mb.bn=this.yh(this.Mb.bn);return this.Ve.qHg(a)}YNe(a){this.Mb.bo=
this.yh(this.Mb.bo);this.ni(a);this.Ve.YNe(a)}vHg(a){this.Mb.bp=this.yh(this.Mb.bp);return this.Ve.vHg(a)}ZNe(a){this.Mb.bq=this.yh(this.Mb.bq);this.ni(a);return this.Ve.ZNe(a)}wHg(a){this.Mb.br=this.yh(this.Mb.br);this.ni(a);return this.Ve.wHg(a)}aOe(a){this.Sm&&(this.Sm.Vol=!0);this.ni(a);this.Mb.bs=this.yh(this.Mb.bs);this.Ve.aOe(a)}CHg(a){this.Mb.bt=this.yh(this.Mb.bt);this.ni(a);this.Ve.CHg(a)}bOe(a){this.Mb.bu=this.yh(this.Mb.bu);this.ni(a);return this.Ve.bOe(a)}GHg(a){this.Mb.bv=this.yh(this.Mb.bv);
this.ni(a);return this.Ve.GHg(a)}fOe(a){this.Mb.bw=this.yh(this.Mb.bw);this.ni(a);return this.Ve.fOe(a)}gOe(a){this.Mb.bx=this.yh(this.Mb.bx);this.ni(a);return this.Ve.gOe(a)}iOe(a){this.Mb.by=this.yh(this.Mb.by);this.ni(a);return this.Ve.iOe(a)}jOe(a){this.Sm&&(this.Sm.tve=!0);this.Mb.bz=this.yh(this.Mb.bz);this.ni(a);return this.Ve.jOe(a)}SHg(a){this.Mb.ca=this.yh(this.Mb.ca);this.ni(a);this.Ve.SHg(a)}XHg(a){this.Mb.cb=this.yh(this.Mb.cb);this.ni(a);return this.Ve.XHg(a)}kOe(a){this.Sm&&(this.Sm.Tol=
!0);this.Mb.cc=this.yh(this.Mb.cc);this.ni(a);return this.Ve.kOe(a)}onMenuOpen(a){this.Mb.cd=this.yh(this.Mb.cd);this.ni(a);return this.Ve.onMenuOpen(a)}aIg(a){this.Mb.ce=this.yh(this.Mb.ce);this.Ve.aIg(a)}iIg(a){this.Mb.cf=this.yh(this.Mb.cf);this.ni(a);return this.Ve.iIg(a)}kIg(a){this.Mb.cg=this.yh(this.Mb.cg);this.ni(a);return this.Ve.kIg(a)}lIg(a){this.Mb.ch=this.yh(this.Mb.ch);this.ni(a);return this.Ve.lIg(a)}tOe(a){this.Sm&&(this.Sm.tve=!0);this.Mb.ci=this.yh(this.Mb.ci);this.ni(a);return this.Ve.tOe(a)}nIg(a){this.Mb.cj=
this.yh(this.Mb.cj);this.ni(a);return this.Ve.nIg(a)}uOe(a){this.Mb.ck=this.yh(this.Mb.ck);this.ni(a);return this.Ve.uOe(a)}xOe(a){this.Mb.cl=this.yh(this.Mb.cl);this.ni(a);return this.Ve.xOe(a)}xIg(a){this.Mb.cm=this.yh(this.Mb.cm);this.ni(a);this.Ve.xIg(a)}AOe(a){this.Mb.cn=this.yh(this.Mb.cn);this.ni(a);return this.Ve.AOe(a)}HIg(a){this.Mb.co=this.yh(this.Mb.co);this.ni(a);return this.Ve.HIg(a)}JOe(a){this.Mb.cp=this.yh(this.Mb.cp);this.ni(a);return this.Ve.JOe(a)}KOe(a){this.Mb.cq=this.yh(this.Mb.cq);
this.ni(a);return this.Ve.KOe(a)}fJg(a){this.Mb.cr=this.yh(this.Mb.cr);return this.Ve.fJg(a)}lJg(a){this.Mb.cs=this.yh(this.Mb.cs);this.ni(a);return this.Ve.lJg(a)}TOe(a){this.Mb.ct=this.yh(this.Mb.ct);this.ni(a);return this.Ve.TOe(a)}UOe(a){this.Mb.cu=this.yh(this.Mb.cu);this.ni(a);return this.Ve.UOe(a)}WOe(a){this.Mb.cv=this.yh(this.Mb.cv);this.ni(a);return this.Ve.WOe(a)}XOe(a){this.Mb.cw=this.yh(this.Mb.cw);this.ni(a);return this.Ve.XOe(a)}uJg(a){this.Mb.cx=this.yh(this.Mb.cx);return this.Ve.uJg(a)}YOe(a){this.Mb.cy=
this.yh(this.Mb.cy);this.ni(a);return this.Ve.YOe(a)}$Oe(a){this.Mb.cz=this.yh(this.Mb.cz);this.ni(a);return this.Ve.$Oe(a)}aPe(a){this.Sm&&(this.Sm.QEc=!0);this.Mb.da=this.yh(this.Mb.da);this.ni(a);return this.Ve.aPe(a)}yJg(a){this.Sm&&(this.Sm.QEc=!0);this.Mb.db=this.yh(this.Mb.db);this.ni(a);return this.Ve.yJg(a)}VKd(a){this.Sm&&(this.Sm.QEc=!0);this.Mb.dc=this.yh(this.Mb.dc);this.ni(a);return this.Ve.VKd(a)}BJg(a){this.Mb.dd=this.yh(this.Mb.dd);this.ni(a);return this.Ve.BJg(a)}CJg(a){this.Mb.de=
this.yh(this.Mb.de);this.ni(a);return this.Ve.CJg(a)}bPe(a){this.Sm&&(this.Sm.QEc=!0);this.Mb.df=this.yh(this.Mb.df);this.ni(a);return this.Ve.bPe(a)}DJg(a){this.Sm&&(this.Sm.QEc=!0);this.Mb.dg=this.yh(this.Mb.dg);this.ni(a);return this.Ve.DJg(a)}HJg(a){this.Mb.dh=this.yh(this.Mb.dh);this.ni(a);return this.Ve.HJg(a)}fPe(a){this.Sm&&(this.Sm.QEc=!0);this.Mb.di=this.yh(this.Mb.di);this.ni(a);return this.Ve.fPe(a)}gPe(a){this.Mb.dj=this.yh(this.Mb.dj);this.ni(a);return this.Ve.gPe(a)}hPe(a){this.Mb.dk=
this.yh(this.Mb.dk);this.ni(a);return this.Ve.hPe(a)}iPe(a){this.Sm&&(this.Sm.tve=!0);this.Mb.dl=this.yh(this.Mb.dl);this.ni(a);return this.Ve.iPe(a)}lPe(a){this.Mb.dm=this.yh(this.Mb.dm);this.ni(a);return this.Ve.lPe(a)}ni(a){const d=a.Fe;if(d&&this.Sm){var n=d.tagName.toLowerCase();if(this.xnk&&this.eQi(n)||this.ynk&&!this.eQi(n))if("font"===n&&this.tPm(a),d.style&&(a=d.style))for(const z of a)z&&0<z.length&&this.Sm.yDe(d.tagName,z)}}tPm(a){if((a=a.Fe)&&"font"===a.tagName.toLowerCase()&&this.Sm){var d=
a.getAttribute("face");d&&0<d.length&&this.Sm.yDe(a.tagName,"font-attr-face");(d=a.getAttribute("color"))&&0<d.length&&this.Sm.yDe(a.tagName,"font-attr-color");(d=a.getAttribute("size"))&&0<d.length&&this.Sm.yDe(a.tagName,"font-attr-size")}}eQi(a){return this.Crh.contains(a)}}Object(t.a)(cy,"HtmlEventUsageCollector",null,[190]);class ws{constructor(a,d,n=!1){this.Fe=a;this.vE=d;this.QCk=n}}Object(t.a)(ws,"TagEventParam",null,[]);class gx{constructor(a,d=null){this.I5d=this._prunedElements=this.Uxf=
this._voidElements=null;this.Ic=a;this.b3=d||Co.a.nyi("");this.ppn()}get Mb(){return this.b3}RAm(a,d,n){this.Uxf[d]?this.d7i():(this.Mb.e++,(d=this.I5d[d])&&d(new ws(a,n,!1)),this.Mb.b++)}d7i(){this.Mb.d++}NAm(){this.Mb.c++}FAm(a,d,n){if(this.Uxf[d])this.d7i();else{if(d=this.I5d[d])return this.Mb.b++,d(new ws(a,n,!1));this.Mb.f++}return 2}ppn(){this._voidElements=ta.a.X8("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.Uxf=
ta.a.X8("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=ta.a.X8("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const a=this.Ic,d=this.Ic,n=this.Ic,z=this.Ic,O=this.Ic,ca=this.Ic,Da=this.Ic,Xa=this.Ic,
zb=this.Ic,Vb=this.Ic,Fc=this.Ic,Yc=this.Ic,yd=this.Ic,je=this.Ic,Le=this.Ic,Ve=this.Ic,gg=this.Ic,Lh=this.Ic,Ki=this.Ic,Ak=this.Ic;this.I5d=ta.a.X8("A",Object(m.a)(this.Ic,this.Ic.YMe,"onAOpen"),"ABBR",Object(m.a)(this.Ic,this.Ic.CFg,"onAbbrOpen"),"ACRONYM",Object(m.a)(this.Ic,this.Ic.EFg,"onAcronymOpen"),"ADDRESS",Object(m.a)(this.Ic,this.Ic.IFg,"onAddressOpen"),"APPLET",Object(m.a)(this.Ic,this.Ic.XFg,"onAppletOpen"),"AREA",Object(m.a)(this.Ic,this.Ic.YFg,"onAreaTag"),"B",Object(m.a)(this.Ic,this.Ic.dNe,
"onBOpen"),"BASE",Object(m.a)(this.Ic,this.Ic.ZFg,"onBaseTag"),"BASEFONT",Object(m.a)(this.Ic,this.Ic.$Fg,"onBasefontTag"),"BDO",Object(m.a)(this.Ic,this.Ic.aGg,"onBdoOpen"),"BIG",Object(m.a)(this.Ic,this.Ic.hNe,"onBigOpen"),"BLOCKQUOTE",Object(m.a)(this.Ic,this.Ic.jNe,"onBlockquoteOpen"),"BODY",Object(m.a)(this.Ic,this.Ic.kGg,"onBodyOpen"),"BR",Object(m.a)(this.Ic,this.Ic.kNe,"onBrTag"),"BUTTON",Object(m.a)(this.Ic,this.Ic.mGg,"onButtonOpen"),"CAPTION",Object(m.a)(this.Ic,this.Ic.mNe,"onCaptionOpen"),
"CENTER",Object(m.a)(this.Ic,this.Ic.nNe,"onCenterOpen"),"CITE",Object(m.a)(this.Ic,this.Ic.pNe,"onCiteOpen"),"CODE",Object(m.a)(this.Ic,this.Ic.qNe,"onCodeOpen"),"COL",Object(m.a)(this.Ic,this.Ic.yGg,"onColTag"),"COLGROUP",Object(m.a)(this.Ic,this.Ic.zGg,"onColgroupOpen"),"DD",Object(m.a)(this.Ic,this.Ic.wNe,"onDdOpen"),"DEL",Object(m.a)(this.Ic,this.Ic.xNe,"onDelOpen"),"DFN",Object(m.a)(this.Ic,this.Ic.BNe,"onDfnOpen"),"DIR",Object(m.a)(this.Ic,this.Ic.CNe,"onDirOpen"),"DIV",Object(m.a)(this.Ic,
this.Ic.ENe,"onDivOpen"),"DL",Object(m.a)(this.Ic,this.Ic.FNe,"onDlOpen"),"DT",Object(m.a)(this.Ic,this.Ic.HNe,"onDtOpen"),"EM",Object(m.a)(this.Ic,this.Ic.JNe,"onEmOpen"),"FIELDSET",Object(m.a)(this.Ic,this.Ic.bHg,"onFieldsetOpen"),"FONT",Object(m.a)(this.Ic,this.Ic.PNe,"onFontOpen"),"FORM",Object(m.a)(this.Ic,this.Ic.gHg,"onFormOpen"),"FRAME",Object(m.a)(this.Ic,this.Ic.iHg,"onFrameTag"),"FRAMESET",Object(m.a)(this.Ic,this.Ic.jHg,"onFramesetOpen"),"H1",Object(m.a)(this.Ic,this.Ic.SNe,"onH1Open"),
"H2",Object(m.a)(this.Ic,this.Ic.TNe,"onH2Open"),"H3",Object(m.a)(this.Ic,this.Ic.UNe,"onH3Open"),"H4",Object(m.a)(this.Ic,this.Ic.VNe,"onH4Open"),"H5",Object(m.a)(this.Ic,this.Ic.WNe,"onH5Open"),"H6",Object(m.a)(this.Ic,this.Ic.XNe,"onH6Open"),"HEAD",Object(m.a)(this.Ic,this.Ic.qHg,"onHeadOpen"),"HR",Object(m.a)(this.Ic,this.Ic.YNe,"onHrTag"),"HTML",Object(m.a)(this.Ic,this.Ic.vHg,"onHtmlOpen"),"I",Object(m.a)(this.Ic,this.Ic.ZNe,"onIOpen"),"IFRAME",Object(m.a)(this.Ic,this.Ic.wHg,"onIframeOpen"),
"IMG",Object(m.a)(this.Ic,this.Ic.aOe,"onImgTag"),"INPUT",Object(m.a)(this.Ic,this.Ic.CHg,"onInputTag"),"INS",Object(m.a)(this.Ic,this.Ic.bOe,"onInsOpen"),"ISINDEX",Object(m.a)(this.Ic,this.Ic.GHg,"onIsindexOpen"),"KBD",Object(m.a)(this.Ic,this.Ic.fOe,"onKbdOpen"),"LABEL",Object(m.a)(this.Ic,this.Ic.gOe,"onLabelOpen"),"LEGEND",Object(m.a)(this.Ic,this.Ic.iOe,"onLegendOpen"),"LI",Object(m.a)(this.Ic,this.Ic.jOe,"onLiOpen"),"LINK",Object(m.a)(this.Ic,this.Ic.SHg,"onLinkTag"),"MAP",Object(m.a)(this.Ic,
this.Ic.XHg,"onMapOpen"),"MATH",Object(m.a)(this.Ic,this.Ic.kOe,"onMathOpen"),"MENU",Object(m.a)(this.Ic,this.Ic.onMenuOpen,"onMenuOpen"),"META",Object(m.a)(this.Ic,this.Ic.aIg,"onMetaTag"),"NOFRAMES",Object(m.a)(this.Ic,this.Ic.iIg,"onNoframesOpen"),"NOSCRIPT",Object(m.a)(this.Ic,this.Ic.kIg,"onNoscriptOpen"),"OBJECT",Object(m.a)(this.Ic,this.Ic.lIg,"onObjectOpen"),"OL",Object(m.a)(this.Ic,this.Ic.tOe,"onOlOpen"),"OPTGROUP",Object(m.a)(this.Ic,this.Ic.nIg,"onOptgroupOpen"),"OPTION",Object(m.a)(this.Ic,
this.Ic.uOe,"onOptionOpen"),"P",Object(m.a)(this.Ic,this.Ic.xOe,"onPOpen"),"PARAM",Object(m.a)(this.Ic,this.Ic.xIg,"onParamTag"),"PRE",Object(m.a)(this.Ic,this.Ic.AOe,"onPreOpen"),"Q",Object(m.a)(this.Ic,this.Ic.HIg,"onQOpen"),"S",Object(m.a)(this.Ic,this.Ic.JOe,"onSOpen"),"SAMP",Object(m.a)(this.Ic,this.Ic.KOe,"onSampOpen"),"SCRIPT",Object(m.a)(this.Ic,this.Ic.fJg,"onScriptOpen"),"SELECT",Object(m.a)(this.Ic,this.Ic.lJg,"onSelectOpen"),"SMALL",Object(m.a)(a,a.TOe,"onSmallOpen"),"SPAN",Object(m.a)(d,
d.UOe,"onSpanOpen"),"STRIKE",Object(m.a)(n,n.WOe,"onStrikeOpen"),"STRONG",Object(m.a)(z,z.XOe,"onStrongOpen"),"STYLE",Object(m.a)(O,O.uJg,"onStyleOpen"),"SUB",Object(m.a)(ca,ca.YOe,"onSubOpen"),"SUP",Object(m.a)(Da,Da.$Oe,"onSupOpen"),"TABLE",Object(m.a)(Xa,Xa.aPe,"onTableOpen"),"TBODY",Object(m.a)(zb,zb.yJg,"onTbodyOpen"),"TD",Object(m.a)(Vb,Vb.VKd,"onTdOpen"),"TEXTAREA",Object(m.a)(Fc,Fc.BJg,"onTextareaOpen"),"TFOOT",Object(m.a)(Yc,Yc.CJg,"onTfootOpen"),"TH",Object(m.a)(yd,yd.bPe,"onThOpen"),"THEAD",
Object(m.a)(je,je.DJg,"onTheadOpen"),"TITLE",Object(m.a)(Le,Le.HJg,"onTitleOpen"),"TR",Object(m.a)(Ve,Ve.fPe,"onTrOpen"),"TT",Object(m.a)(gg,gg.gPe,"onTtOpen"),"U",Object(m.a)(Lh,Lh.hPe,"onUOpen"),"UL",Object(m.a)(Ki,Ki.iPe,"onUlOpen"),"VAR",Object(m.a)(Ak,Ak.lPe,"onVarOpen"))}}Object(t.a)(gx,"AHtmlProcessor",null,[]);class pw{constructor(a,d){this.childNodes=a.childNodes;this.vE=d;this.rTf=0;this.hFe=!1}}Object(t.a)(pw,"HtmlProcessorArguments",null,[]);var du=b(919);class qn extends gx{constructor(a,
d=null){super(a,d);this.Tjf=null}get Hdm(){null==this.Tjf&&(this.Tjf=l.AFrameworkApplication.K?l.AFrameworkApplication.K.ea("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.Tjf}process(a,d=null){a&&(this.Ic.reset(),this.igj(new pw(a,new bu.a),d))}igj(a,d){a.childNodes.length&&(a=new Bo.a(d,Object(m.a)(this,this.CUm,"processChild"),a),a.Pj("HTML Processing Operation"),d||(a.Ce=!0),a.run())}CUm(a,d){const n=d.childNodes[d.rTf];if(3===n.nodeType)return this.Ic.fNe(),this.Ic.xna(n.nodeValue,
new ws(n,d.vE.Fvi())),qn.iVc(d);if(1!==n.nodeType)return qn.iVc(d);if(!d.hFe){const O=w.a.gw(n.tagName);if(!qn.oYl(n))if(this._prunedElements[O])this.NAm();else{qn.Otm(n);this.Ic.fNe();var z=n.id;const ca=n.tagName,Da=d.vE.Fvi(),Xa=n.getAttribute?n.getAttribute("class"):null;z=new du.a(z,ca,Xa?Xa:"",n.attributes?n.attributes.length:0);z.Yb&&Da.add(z);if(this._voidElements[O])return this.RAm(n,O,Da),qn.iVc(d);z=!1;switch(this.FAm(n,O,Da)){case 1:z=!0;break;case 3:return qn.iVc(d)}switch(this.Ic.lfg(n)){case 1:z=
!0}d.hFe=z;this.igj(new pw(n,Da),a);if(!a.Ce)return!0}}if(d.hFe){if(this.Hdm&&!this.I5d[w.a.gw(n.tagName)])return qn.iVc(d);this.Ic.onClose()}return qn.iVc(d)}static Otm(a){3!==a.nodeType&&Ag.a.ql(a,"alreadyPasted",!0)}static oYl(a){return 3!==a.nodeType&&Ag.a.Ta(a,"alreadyPasted")}static iVc(a){a.rTf++;a.hFe=!1;return a.rTf<a.childNodes.length}}Object(t.a)(qn,"HtmlProcessor",gx,[]);var or=b(972);class Oy{constructor(a){this.Jaa=0;this.G7h=null;this.node=a}}Object(t.a)(Oy,"ChartConverterArguments",
null,[]);class rA{constructor(a=null){this._imgNodesConverted=0;this.b3=a||Co.a.qui("")}get Mb(){return this.b3}process(a,d){a&&(this._imgNodesConverted=0,a.querySelectorAll&&(a=a.querySelectorAll("div"),1===a.length&&(a=new Bo.a(d,this.kil.bind(this),new Oy(a[0])),a.Pj("Chart Converter Operation"),a.Ce=!d||d.Ce,a.run())))}kil(a,d){var n=d.node;if(1<d.Jaa)return!1;if(1===n.nodeType&&"DIV"===n.tagName){const z=n.getAttribute(jo.a.jqe);if(z){const O=n.getAttribute(jo.a.kUf),ca=n.getAttribute(jo.a.lUf),
Da=n.getAttribute(jo.a.iUf),Xa=n.getAttribute(jo.a.jUf),zb=n.getAttribute(jo.a.Wnd);n=n.getAttribute(jo.a.mUf);O&&Xa&&ca&&"chart"===ca&&zb&&"XLO"===zb&&(d.G7h=new or.a(z,O,ca,Da,Xa,zb,n))}}a.ui(this.Exm.bind(this));return!0}Exm(a,d){var n=d.node;if(a=d.G7h)1===n.childElementCount&&1===n.firstChild.nodeType&&"IMG"===n.firstChild.tagName?(n=n.firstChild,n.setAttribute(jo.a.jqe,a.ccpId),n.setAttribute(jo.a.kUf,a.pKey),n.setAttribute(jo.a.lUf,a.type),n.setAttribute(jo.a.jUf,a.dc),n.setAttribute(jo.a.Wnd,
a.client),a.version&&n.setAttribute(jo.a.mUf,a.version),a.count&&n.setAttribute(jo.a.iUf,a.count),this._imgNodesConverted++):k.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.b3._imgNodesConverted=this._imgNodesConverted;d.Jaa++;return!1}}Object(t.a)(rA,"ChartConverter",null,[]);var sA=b(1776);class tA{constructor(){this.aE=0;this.Cmd=6;this.Sol=this.Zqi=!1;this.FMf=null;this.bri=this.ari=this.Wol=this.Uol=this.$qi=!1;this.Pgj=null;this.Vol=this.QEc=this.tve=this.Tol=this.Xol=!1;this.SPm=
this.NOc=0;this.sKg=this.platform=null;this.BUb={}}get B6g(){if(null!==this.FMf)switch(this.FMf){case "XLO":return"Excel Online"}if(this.bri)return"Word Online";if(this.ari||this.$qi)return"PowerPoint Online";if(this.Zqi)return"Excel Online";switch(this.Pgj){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}Lnm(){k.ULS.sendTraceTag(51406241,307,50,JSON.stringify(this.oJk()))}Mnm(){const a=
this.BUb;for(const n in a){var d=n;const z=a[n];z&&(z.SourceApp=this.B6g,z.Browser=sA.a[this.NOc],z.TagName=d,z.OperationId=this.sKg,k.ULS.sendTraceTag(51406242,307,50,JSON.stringify(z)))}}yDe(a,d){a&&a.length&&d&&d.length&&(a=a.toLowerCase(),d=d.toLowerCase(),a in this.BUb||(this.BUb[a]={}),this.BUb[a][d]=this.oPl(a,d)+1)}oPl(a,d){if(!(a&&a.length&&d&&d.length&&this.BUb&&a in this.BUb))return 0;a=a.toLowerCase();d=d.toLowerCase();return(a=this.BUb[a])&&d in a?a[d]:0}oJk(){const a={};a.ActionIdFlags=
this.aE;a.SourceApp=this.B6g;a.CopySourceBrowser=this.Cmd;a.PasteBrowser=this.NOc;a.IsSameBrowserPaste=this.Xem(this.Cmd,this.NOc);a.IsCrossBrowserPaste=this.H9l(this.Cmd,this.NOc);a.IsUncategorizedBrowserPaste=this.Tgm(this.Cmd,this.NOc);a.Platform=this.platform;a.OperationId=this.sKg;return a}Xem(a,d){return 5===a||6===a?!1:a===d}H9l(a,d){return 6===a?!1:a!==d}Tgm(a,d){return 5===a&&5===d}}Object(t.a)(tA,"HtmlContentMetadata",null,[]);var hx=b(1775),Fr=b(932),$r=b(325),at=b(227),bt=b(1518);class Pl{constructor(a,
d,n,z,O,ca){this.oF=this.Uce=this.Aqf=this.yx=this.Eb=this.zt=this.tf=this.IJj=this.Vp=this.PAb=this.Wq=this.zc=this.Ki=this.Xb=this.nI=null;this.ZUa=a;this.N2f=this.O7a=null;this.rj=d;this.transaction=n;this.V5=z;this.xs=O;this.oea=ca}get Gg(){return this.Vp||(this.Vp=la.a.instance.sa("Box4.Styles.StyleSettings"))}get K(){return l.AFrameworkApplication.K}get yqf(){return!!this.K&&this.K.ea("PasteTextOnlyKeepDestinationStyleIsEnabled")}get Ljk(){return!!this.K&&this.K.ea("PreserveEopFormattingPasteIsEnabled")}get jx(){return this.oF||
(this.oF=la.a.instance.resolve("Box4.IFontStylesGalleryCache"))}get isProgressiveStyleEnabled(){return this.Gg&&this.Gg.isProgressiveStyleEnabled}get kZ(){return this.nI||(this.nI=la.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}get gb(){return this.Xb||(this.Xb=la.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get paragraphEditor(){return this.Ki||(this.Ki=la.a.instance.resolve("Box4.IParagraphEditor"))}get Vb(){return this.zc||(this.zc=la.a.instance.resolve("Box4.List.IListReader"))}get es(){return this.Wq||
(this.Wq=la.a.instance.resolve("Box4.List.IListEditor"))}get bOb(){return this.PAb||(this.PAb=la.a.instance.sa("Box4.List.ISingleLevelListEditor"))}get Aj(){return this.tf||(this.tf=la.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get Wi(){return this.zt||(this.zt=la.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}get hd(){return this.Eb||(this.Eb=la.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get u3(){return this.yx||
(this.yx=la.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}get HQe(){return this.Aqf||(this.Aqf=la.a.instance.sa("Box4.IPastedParagraphSpaceHandler"))}set HQe(a){this.Aqf=a}get cej(){return!1}get UAj(){return this.K.ea("WordEditorAutoResizeImageIsEnabled")}$li(){}get mog(){return!1}$dj(a){var d=void 0===this.rj.aE||null===this.rj.aE?"not available":Object(hx.a)(bt.a,this.rj.aE);k.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.rj.aE,d);k.ULS.shipAssertTag(6305487,307,Qd.SelectionEditor.Cd(this.ZUa));
if(this.FMe)return k.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.rj.OEb=ye.SelectionFactory.uj(this.ZUa),a.ui(Object(m.a)(this,this.FKb,"pasteTeardown")),!0;if(!this.ZUa.node)return k.ULS.sendTraceTag(572330334,307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),!1;d=new Dd.GraphIterator;d.set(this.ZUa.node);Qd.SelectionEditor.Vm(d);qe.OutlineElementNavigator.Uc(d);this.IJj=d.origin;if(this.cej)return d.Rn(10),this.$li(d,a),a.ui(Object(m.a)(this,this.mon,"setSelectionAfterPastingOutlines")),
!0;this.V5&&this.V5.NCm(this.ZUa);if(!this.xyn(this.ZUa))return this.rj.OY&&(this.rj.OY.fail("SplitLine Failed",!0),this.rj.failed=!0),this.rj.OEb=ye.SelectionFactory.uj(this.ZUa),a.ui(Object(m.a)(this,this.FKb,"pasteTeardown")),!0;const n=new Pi.a;n.Cb(d);qe.OutlineElementNavigator.Mt(n,!1,!1);this.O7a=new Fr.a(d);this.N2f=new Fr.a(n);a.ui(Object(m.a)(this,this.FPm,"pasteExecution"));return!0}FPm(a){Mh.a.mark(5568);this.Zli(a);let d=Object(m.a)(this,this.Ovm,"mergeAfterPaste");if(this.LSi){const n=
this.HBj();n&&(d=Object(m.a)(this,this.FKb,"pasteTeardown"));k.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",n)}a.ui(d);return!0}HBj(){return!1}get LSi(){return this.K.ea("PptCcpFix2IsEnabled")}get Nrn(){return this.K.ea("CopyAndPasteOneParagraphIndentationFixIsEnabled")}Ovm(a){Mh.a.mark(5569);var d=new Dd.GraphIterator;this.O7a.restore(d);Pl.r0||(this.O7a=null);var n=new Dd.GraphIterator;this.N2f.restore(n);this.N2f=null;k.ULS.shipAssertTag(6305489,307,Ia.OutlineElementReader.gg(d));
k.ULS.shipAssertTag(6305490,307,Ia.OutlineElementReader.gg(n));qe.OutlineElementNavigator.Sd(d);var z=Bd.ParagraphReader.Zf(d)?Bd.ParagraphReader.textLength(d.currentNode):0;qe.OutlineElementNavigator.Uc(d);qe.OutlineElementNavigator.Sd(n);k.ULS.shipAssertTag(6305491,307,Bd.ParagraphReader.Zf(n));var O=Bd.ParagraphReader.textLength(n.currentNode);qe.OutlineElementNavigator.Uc(n);let ca=this.eVd;var Da=new Pi.a;Da.Cb(d);qe.OutlineElementNavigator.Mt(Da,!1,!1);var Xa=Da.currentNode===n.currentNode,
zb=!!this.rj&&!!(this.rj.aE&8192);let Vb=!1;!zb&&this.rj.$c&&Object(Uc.a)(dh.DictionaryPropertySet,this.rj.$c)&&(zb=(zb=this.rj.$c.Se(Xc.a.thc))&&""!==zb?!0:!1);if(Xa){z=Dd.GraphIterator.ua(d.currentNode);Bd.ParagraphReader.yl(qe.OutlineElementNavigator.Sd(z))||(d=n);d.currentNode.id!==n.currentNode.id&&(k.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",Bf.ListReader.Bh(d),Bf.ListReader.Bh(n)),zb=Pl.Pg.merge(d,n,!0,zb),k.ULS.shipAssertTag(6305492,
307,zb));n=d;var Fc=!0}else{Xa=!!(this.rj.aE&4);Fc=this.hd.Jf&&Xa&&this.rj.O5a;this.HQe&&this.rj&&!Xa&&(this.HQe.BIi(d,!1),this.HQe.BIi(n,!0));qe.OutlineElementNavigator.Sd(Da);Xa=Bd.ParagraphReader.Zf(Da)?Bd.ParagraphReader.textLength(Da.currentNode):0;qe.OutlineElementNavigator.Uc(Da);this.zEk(Da,d,n);if(this.u3.zRa||this.Nrn){var Yc=new Pi.a;Yc.Cb(Da);qe.OutlineElementNavigator.Mt(Yc,!1,!1);if(Yc.Hm.id!==n.Hm.id){for(;Da.currentNode.id!==n.currentNode.id;)qe.OutlineElementNavigator.Sd(Da,!1),this.u3.UXa(fe.a.create(Da.currentNode)),
Da.hb(),qe.OutlineElementNavigator.Mt(Da,!1,!1);Da.Cb(d);qe.OutlineElementNavigator.Mt(Da,!1,!1)}else Vb=!0}this.V5&&({eVd:ca,IHa:Da}=this.V5.qVm(d,n,ca,Da));if(this.rj.WUe&&(k.ULS.shipAssertTag(6305493,307,this.rj.BKc),Yc=new Dd.GraphIterator,Yc.Cb(Da),Yc=qe.OutlineElementNavigator.Sd(Yc))){var yd=this.rj.WUe.Xc(Yc.ja.J(0));Yc.ja.J(0).formatting=yd}Yc=0;zb&&this.yqf&&(Yc=1);yd=this.gsn(d,Da,Yc);this.rj.M_e=null;if(this.rj.IKa||this.rj.zua)this.rj.M_e=this.aPl(yd?d.currentNode:Da.currentNode,yd);
var je=!1;yd&&(je=Bf.ListReader.Bh(d),k.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",je,Bf.ListReader.Bh(n)),je=Pl.Pg.merge(d,Da,!0,zb,n,void 0,Vb,Fc,this.yqf),this.hsn(d,Yc)&&this.hwm(d,n,Yc,zb));Yc=Pl.RPm.T3l(d,Da,n,z,je,this.mog);var Le=!1;if(ca){const Ve=new Pi.a;Ve.Cb(n);qe.OutlineElementNavigator.D0(Ve,!1,!1);Le=Bf.ListReader.Bh(Ve);const gg=Bf.ListReader.Bh(n);Fc=Pl.Pg.merge(Ve,n,!0,zb,void 0,!0,void 0,Fc,this.yqf,this.Ljk);
k.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",Le,gg,Fc?"True":"False, will cause IP to reset to zero.");n=(Le=Fc)?Ve:n}else Fc=!1,k.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");this.u3.zRa&&Vb&&(yd&&!this.vam(Yc,je)?(Da=new Dd.GraphIterator,Da.Cb(d),d=qe.OutlineElementNavigator.Sd(Da),this.u3.foa(d,z,z+Xa)):ca&&!this.$bm(Yc,Le)?(d=new Dd.GraphIterator,d.Cb(Da),d=qe.OutlineElementNavigator.Sd(d),
this.u3.foa(d,0,Xa)):(d=new Dd.GraphIterator,d.Cb(Da),d=qe.OutlineElementNavigator.Sd(d),this.u3.UXa(fe.a.create(d))));this.gSm(Yc);this.isProgressiveStyleEnabled&&!zb&&this.jx.tVm(Yc)}k.ULS.shipAssertTag(6305494,307,n.Yb);zb=qe.OutlineElementNavigator.Sd(n);O=Fc?Bd.ParagraphReader.textLength(zb)-O:0;d=!1;Object(Uc.a)(90,this.rj.$c)&&(d=this.rj.$c.fa(Xc.a.wga,!1));this.rj.OEb=d?ye.SelectionFactory.wX(zb,O-1,O):ye.SelectionFactory.Pc(zb,O);uf.a.instance.J(10)&&this.rj&&this.rj.BKc&&Bd.ParagraphReader.nb(zb)&&
this.rj.JPe&&((O=this.rj.JPe.uAn)&&this.kZ.hT(O,zb,!0),(O=this.rj.JPe.HOm)&&this.paragraphEditor.jZh(zb,O));a.ui(Object(m.a)(this,this.FKb,"pasteTeardown"));return!0}vam(a,d){return!d&&!!a&&Ia.OutlineElementReader.gg(a.IHa)&&Ia.OutlineElementReader.WGa(a.IHa)}$bm(a,d){return!d&&!!a&&Ia.OutlineElementReader.gg(a.BIb)&&Ia.OutlineElementReader.WGa(a.BIb)}gSm(a){Pl.ufj&&a&&Pl.ufj.oVm(a)}gsn(a,d,n){Bf.ListReader.Bh(a)?(Pl.Oc.EVa&&this.bOb&&this.bOb.ajg(a),d=Bf.ListReader.Bh(d)?this.fBj:!0):Ia.OutlineElementReader.isEmpty(a,
!0)&&!n?(Pl.Pg.Gjb(a),d=!1):d=Bf.ListReader.Jq||!Bf.ListReader.Bh(d);this.V5&&(d=this.V5.XQk(a,d));return d}hsn(a,d){return Bf.ListReader.Bh(a)||1===d?!0:!1}hwm(a,d,n,z){const O=Bf.ListReader.Bh(a);if(O){if(z=new Pi.a,z.Cb(a),qe.OutlineElementNavigator.Mt(z,!1,!1),z.Hm.id!==d.Hm.id){n=this.Vb.ht(a);this.Vb.dC(a);var ca=a.currentNode.fa(Qb.a.listID,0);a.hb();var Da=this.Vb.v6g,Xa=!0;for(n.cA=wh.a.uh;z.currentNode.id!==d.currentNode.id;){if(!Da||!Ia.OutlineElementReader.IBj(z))if(!Bf.ListReader.Bh(z))({JUa:n}=
this.es.wGa(n.propertySet,z,n)),Xa=!1;else if(O){Xa=this.Vb.gye(z);var zb=this.Vb.ww(a.currentNode,ca,Xa);zb=zb?$r.a.QR(zb,null):n;Xa=$r.a.TR(zb.listType,n.listStyle,null,0,Xa,"","");Xa.Lqb=a.currentNode;this.es.mnn(Xa);this.es.eUd(z,!0);Xa=!1}qe.OutlineElementNavigator.Mt(z,!1,!1)}Da&&Xa&&this.es.S_h()}}else if(1===n)for(n=new Pi.a,n.Cb(a),qe.OutlineElementNavigator.Sd(n),a=Bd.ParagraphReader.Zf(n)?n.currentNode:null,ca=this.gb.TGc(n),qe.OutlineElementNavigator.Uc(n),qe.OutlineElementNavigator.Mt(n,
!1,!1);n.currentNode.id!==d.currentNode.id;)qe.OutlineElementNavigator.Sd(n),Da=Bd.ParagraphReader.Zf(n)?n.currentNode:null,qe.OutlineElementNavigator.Uc(n),Da&&a&&z&&(ca&&this.kZ.hT(ca,Da,!0),this.oea.k4i(a,Da,O),this.oea.EJa(a,Da,1,!0)),qe.OutlineElementNavigator.Mt(n,!1,!1)}zEk(a,d,n){var z=!1;if(this.hd.Jf){var O=!1;this.V5&&(O=d.currentNode,O=this.V5.Kdm(O)||this.V5.Kqg(O));O?this.hd.J7a=4:z=!0}if(z){for(;a.currentNode!==n.currentNode;){qe.OutlineElementNavigator.Sd(a,!1);z=this.Wi.CWd(fe.a.create(a.currentNode));
let ca;({type:ca}=z.sAe(ca)).returnValue&&this.hd.Ws(ca);for(O=0;O<z.length;O++){let Da;const Xa=({EHe:Da}=z.getContext(O)).returnValue;Da&&(Pl.hyperlinkEditor.Cqb(Xa,1),this.Aj.tNb(Xa,1,null,!0))}a.hb();qe.OutlineElementNavigator.Mt(a,!1,!1)}a.Cb(d);qe.OutlineElementNavigator.Mt(a,!1,!1)}}aPl(a,d){a=Dd.GraphIterator.ua(a);qe.OutlineElementNavigator.Sd(a);return Bd.ParagraphReader.nb(a.currentNode)?(d=d?Bd.ParagraphReader.textLength(a.currentNode):0,ye.SelectionFactory.Pc(a.currentNode,d)):If.TableReader.GS(a.currentNode)?
ye.SelectionFactory.Bl(a.currentNode):null}mon(a){const d=Dd.GraphIterator.ua(this.IJj);d.Ht(1);this.rj.OEb=ye.SelectionFactory.Tm(d.currentNode,!1);a.ui(Object(m.a)(this,this.FKb,"pasteTeardown"));return!0}FKb(){var a=void 0===this.rj.aE||null===this.rj.aE?"not available":Object(hx.a)(bt.a,this.rj.aE);k.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.rj.aE,a);k.ULS.shipAssertTag(6305497,307,!!this.rj.OEb);Pl.r0&&this.O7a&&(a=new Dd.GraphIterator,this.O7a.restore(a),this.O7a=null,
this.LPm(a));this.transaction.dispose();a=this.xs.tw;if(!a.Yd||!a.editingView.uk)return!1;a.editingView.BCn();return!1}LPm(a){if(a&&If.TableReader.wHe(a)&&1==a.Sr()){var d=new Dd.GraphIterator;d.set(a.currentNode);a=Pi.a.ua(a.currentNode);d.tn()&&a.tn()&&(qe.OutlineElementNavigator.D0(a,!1,!0),Ia.OutlineElementReader.gg(a)&&1==a.Sr()&&(qe.OutlineElementNavigator.Sd(d),qe.OutlineElementNavigator.Sd(a),d&&a&&d.currentNode!=a.currentNode&&If.TableReader.isTable(d)&&If.TableReader.isTable(a)&&this.swm(d,
a)&&(d.wg(),d.wg())))}else k.ULS.sendTraceTag(527745502,3022,50,"Outline iterator should contain a single table")}swm(a,d){if(!If.TableReader.isTable(a)||!If.TableReader.isTable(d))return!1;var n=If.TableReader.nh(a.currentNode),z=If.TableReader.nh(d.currentNode);if(n!=z)return k.ULS.sendTraceTag(527536328,3022,50,"Number of columns in source and target table should be same"),!1;n=If.TableReader.Sf(a.currentNode);z=If.TableReader.Sf(d.currentNode);let O=new Ff.GraphTransaction(4);O.Sa(d.currentNode);
d.currentNode.setValue(Vd.a.kua,n+z);for(O.dispose();a.Vz();)a.Rc(),d.Re(a.currentNode,1),a.wg();return!0}arn(a,d){const n=new Dd.GraphIterator;n.Cb(a);a=qe.OutlineElementNavigator.Sd(n);d=Bd.ParagraphReader.nb(a)&&d===Bd.ParagraphReader.textLength(a);k.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",d);return d}xyn(a){k.ULS.shipAssertTag(6305498,307,Qd.SelectionEditor.Cd(a));const d=Dd.GraphIterator.ua(a.node);var n=d.kc();qe.OutlineElementNavigator.Uc(d);n&&a.Yb||k.ULS.sendTraceTag(40425481,
307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:n,["ipContextNodeType"]:a.node.type,["isValidIpContext"]:a.Yb});if(!Ia.OutlineElementReader.gg(d)&&(k.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),this.K.ea("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;n=Pl.Pg.EIa(d,!0);const z=this.arn(d,a.cpBegin);Pl.Pg.voa(d,n,a,!1,!1,!0,z);return!0}static get hyperlinkEditor(){return Pl.lk||(Pl.lk=la.a.instance.resolve("Box4.IHyperlinkEditor"))}static get yc(){return mi.PageReader.instance}static get Pg(){return Pl.Ee||
(Pl.Ee=la.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Oc(){return at.a.getInstance()}static get Ka(){return Pl.Ja||(Pl.Ja=la.a.instance.sa("Box4.IFeatureHelper"))}static get ufj(){return Pl.xJh||(Pl.xJh=la.a.instance.resolve("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste"))}static get RPm(){return Pl.wJh||(Pl.wJh=la.a.instance.resolve("Box4.Actors.PastedContentsPostProcessorHelper"))}static get r0(){null==this.i2&&(l.AFrameworkApplication.Yi("he991617;3eed2178"),this.i2=
l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.i2}}Pl.Ja=null;Pl.Ee=null;Pl.lk=null;Pl.xJh=null;Pl.wJh=null;Pl.i2=null;Object(t.a)(Pl,"APasteExecutionManager",null,[]);class st{constructor(a){this.Zj=a}reset(){this.Zj.reset()}get iod(){return this.Zj.iod}xna(a,d){this.Zj.xna(a,d)}DWa(a){this.Zj.DWa(a)}lKb(a){this.Zj.lKb(a)}PJa(a){this.Zj.PJa(a)}zWa(a){this.Zj.zWa(a)}f7a(a,d){this.Zj.f7a(a,d)}e7a(){this.Zj.e7a()}IK(a){this.Zj.IK(a)}HK(){this.Zj.HK()}iKb(){this.Zj.iKb()}hKb(){this.Zj.hKb()}GWa(a){this.Zj.GWa(a)}EWa(){this.Zj.EWa()}l7a(a){this.Zj.l7a(a)}FWa(){this.Zj.FWa()}Wqb(a){this.Zj.Wqb(a)}wna(a){this.Zj.wna(a)}tna(){this.Zj.tna()}vna(a){this.Zj.vna(a)}una(){this.Zj.una()}sna(a){this.Zj.sna(a)}rna(){this.Zj.rna()}m7a(a,
d){this.Zj.m7a(a,d)}Tqb(){this.Zj.Tqb()}}Object(t.a)(st,"AHtmlNormalizer",null,[179,180]);class qw extends st{constructor(a){super(a);this.mO=!1}xna(a,d){this.mO?this.XS.gS(()=>{this.fPg(a,d)}):this.fPg(a,d)}fPg(a,d){this.Zj.xna(a,d)}DWa(a){this.mO?this.XS.gS(()=>{this.GOg(a)}):this.GOg(a)}GOg(a){this.Zj.DWa(a)}PJa(a){this.mO?this.XS.gS(()=>{this.ANd(a)}):this.ANd(a)}ANd(a){this.Zj.PJa(a)}zWa(a){this.mO?this.XS.gS(()=>{this.EOg(a)}):this.EOg(a)}EOg(a){this.Zj.zWa(a)}f7a(a,d){this.mO?this.XS.gS(()=>
{this.BOg(a,d)}):this.BOg(a,d)}BOg(a,d){this.Zj.f7a(a,d)}e7a(){this.mO?this.XS.gS(Object(m.a)(this,this.AOg,"processAnchorEnd")):this.AOg()}AOg(){this.Zj.e7a()}IK(a){this.mO?this.XS.gS(()=>{this.SOg(a)}):this.SOg(a)}SOg(a){this.Zj.IK(a)}HK(){this.mO?this.XS.gS(Object(m.a)(this,this.ROg,"processParagraphEnd")):this.ROg()}ROg(){this.Zj.HK()}iKb(){this.mO?this.XS.gS(Object(m.a)(this,this.VOg,"processPreFormattedTextStart")):this.VOg()}VOg(){this.Zj.iKb()}hKb(){this.mO?this.XS.gS(Object(m.a)(this,this.UOg,
"processPreFormattedTextEnd")):this.UOg()}UOg(){this.Zj.hKb()}GWa(a){this.mO?this.XS.gS(()=>{this.KOg(a)}):this.KOg(a)}KOg(a){this.Zj.GWa(a)}EWa(){this.mO?this.XS.gS(Object(m.a)(this,this.HOg,"processListEnd")):this.HOg()}HOg(){this.Zj.EWa()}l7a(a){this.mO?this.XS.gS(()=>{this.JOg(a)}):this.JOg(a)}JOg(a){this.Zj.l7a(a)}FWa(){this.mO?this.XS.gS(Object(m.a)(this,this.IOg,"processListItemEnd")):this.IOg()}IOg(){this.Zj.FWa()}wna(a){this.mO?this.XS.gS(()=>{this.ePg(a)}):this.ePg(a)}ePg(a){this.Zj.wna(a)}tna(){this.mO?
this.XS.gS(Object(m.a)(this,this.bPg,"processTableEnd")):this.bPg()}bPg(){this.Zj.tna()}vna(a){this.mO?this.XS.gS(()=>{this.dPg(a)}):this.dPg(a)}dPg(a){this.Zj.vna(a)}una(){this.mO?this.XS.gS(Object(m.a)(this,this.cPg,"processTableRowEnd")):this.cPg()}cPg(){this.Zj.una()}sna(a){this.mO?this.XS.gS(()=>{this.aPg(a)}):this.aPg(a)}aPg(a){this.Zj.sna(a)}rna(){this.mO?this.XS.gS(Object(m.a)(this,this.$Og,"processTableCellEnd")):this.$Og()}$Og(){this.Zj.rna()}m7a(a,d){this.mO?this.XS.gS(()=>{this.LOg(a,
d)}):this.LOg(a,d)}LOg(a,d){this.Zj.m7a(a,d)}Tqb(){this.mO?this.XS.gS(Object(m.a)(this,this.xgj,"processMathEnd")):this.xgj()}xgj(){this.Zj.Tqb()}}Object(t.a)(qw,"AQueuingHtmlNormalizer",st,[]);var Wg=b(1729);class ix{constructor(){this.Qrf=new Wg.a}gS(a){this.Qrf.enqueue(a)}flush(a=!1){for(a&&this.kXe();!this.Qrf.isEmpty;)this.Qrf.dequeue()();a&&this.sVe()}kXe(){}sVe(){}}Object(t.a)(ix,"QueuedEventManager",null,[]);class jx extends ix{constructor(a){super();this.id=void 0;this.BTf=null;this.YFe=
!1;this.G7a="";this.XFe=this.GGe=!1;this.tTf=this.mCc=null;this.PId=0;this.qDd=this.$Ed=this.atg=!1;this.table=null;this.ODg=0;this.n6=a}get Dgd(){return!!this.table}kXe(){this.n6.yOc.push(this.n6.currentState);this.n6.currentState=this}sVe(){this.n6.currentState=this.n6.yOc.pop()}}jx.nextId=void 0;Object(t.a)(jx,"ContentState",ix,[]);var kx=b(298);class dy{constructor(a,d,n){this.colSpan=a.colSpan;this.rowSpan=a.rowSpan;this.width=a.width;this.height=a.height;this.$ob=a.$ob;this.shadingColor=a.shadingColor;
this.verticalAlignment=a.verticalAlignment;this.hua=a.hua;this.J0e=a.J0e;this.bLc=a.bLc;this.lfa=a.lfa;this.contents=n;this.TTl=d}}Object(t.a)(dy,"TableCell",null,[]);var Dz=b(970),Ez=b(971),Pu=b(974),Gv=b(975),Fq=b(973);class lx extends ix{constructor(a,d){super();this.n6=a;this.wPh=new bu.a;this.hL=new bu.a;this.xnf=[];this.Ede=[];this.I_a=-1;this.Uab=0;this.vck=d.HPi;this.uck=d.y8l;this.mpk=d.y9g;this.At=d.width;this.hCh=d.$ob;this.eak=new kx.a(new du.a(d.dha.cLi,d.dha.YCe),d.vE,d.ota,d.cultureName,
d.DQa);this.Fbk=d.CDe;this.Dfe=d.styleId;this.rpk=d.tableLook}get Zj(){return this.n6.Zj}nTm(a){this.I_a++;this.wPh.add(a);this.Ede[this.I_a]=a.height;this.Uab=0}get Z5k(){for(;this.Uab>=this.hL.count;)this.hL.add(Array(this.I_a+1));return this.hL.J(this.Uab)}KAf(a,d,n,z,O,ca,Da){if(0>this.I_a)return!1;for(;this.xnf[this.Uab]>=this.I_a;)this.Uab++;a=new dy(a,new kx.a(d,n,z,O,ca),Da);this.Z5k[this.I_a]=a;if(1<a.rowSpan)for(d=this.I_a+a.rowSpan-1,z=this.Uab,n=this.Uab+a.colSpan-1;z<=n;z++)this.xnf[z]>=
d||(this.xnf[z]=d);this.Uab+=a.colSpan;this.Ede[this.I_a]<a.height&&(this.Ede[this.I_a]=a.height);return!0}kXe(){this.n6.currentState.table=this}sVe(){this.n6.currentState.table=null}Rpi(){this.flush(!0);const a=this.I_a+1;var d=Array(a);for(var n=0;n<a;n++)d[n]=Array(this.hL.count);n=!0;var z=0;for(var O=0;O<this.hL.count;O++){var ca=this.hL.J(O),Da=!0;for(var Xa=0;Xa<a;Xa++){var zb=ca[Xa];zb&&(Da=!1,d[Xa][O+z]=new Pu.a(zb.colSpan,zb.rowSpan,zb.width,zb.height,void 0,void 0,void 0,void 0,zb.$ob,
zb.bLc))}Da?(this.hL.removeAt(O),O--,++z):n=!1}if(!n){(d=this.hCh?this.n6.W3h(d,this.At/100):this.n6.W3h(d))&&d.length!==this.hL.count&&(d=null);this.n6.wEb(!0);this.n6.jne();this.Zj.wna(new Fq.a(a,this.hL.count,this.At,this.hCh,d,this.vck,this.uck,this.mpk,this.Fbk,this.Dfe,this.rpk,this.eak));for(d=0;d<a;d++){n=this.wPh.J(d);this.Zj.vna(new Gv.a(this.Ede[d],new kx.a(n.dha,n.vE,n.ota,n.cultureName,n.DQa)));for(n=0;n<this.hL.count;n++){z=this.hL.J(n)[d];var Vb=!!this.Dfe&&""!==this.Dfe&&"Custom"!==
this.Dfe;O=z?z.colSpan:0;ca=z?z.rowSpan:0;Da=z?z.width:0;Xa=z?z.height:0;zb=z?z.lfa:0;const Fc=z?z.$ob:!1,Yc=z&&(65536&zb||!Vb)?z.shadingColor:"",yd=z?z.verticalAlignment:0,je=z?z.bLc:!1;Vb=z?this.n6.xHl(z.hua,n,d,this.hL,Vb,z.lfa):new Dz.a;const Le=z?z.J0e:new Ez.a,Ve=z?z.TTl:null;this.Zj.sna(new Pu.a(O,ca,Da,Xa,Yc,yd,Vb,Le,Fc,je,zb,new kx.a(Ve?Ve.dha:null,Ve?Ve.vE:null,Ve?Ve.ota:null,Ve?Ve.cultureName:null,Ve?Ve.DQa:null)));z&&!z.bLc&&(z.contents.kXe(),z.contents.flush(),this.n6.wEb(!1),this.n6.jne(),
z.contents.sVe());this.Zj.rna()}this.Zj.una()}this.Zj.tna();this.n6.currentState.qDd=!1;this.n6.Vki(!1)}}}Object(t.a)(lx,"NormalizedTable",ix,[]);class ey{constructor(a=!1,d=!1){this.adk=a;this.iN=d}get Bbm(){return this.adk}get AQ(){return this.iN}}Object(t.a)(ey,"HtmlNormalizerSettings",null,[189]);var uA=b(754);class eu extends qw{constructor(a,d=null){super(a);this.currentState=null;this.yOc=new uA.a;this.ktc=d||new ey}reset(){super.reset();this.currentState=new jx(this);this.yOc.clear();this.mO=
!1}get XS(){return this.currentState&&this.currentState.Dgd?this.currentState.table:this.currentState}Xse(a=!1){this.currentState.YFe||(this.jne(),this.Zj.IK(this.currentState.BTf),this.currentState.YFe=!0,this.currentState.qDd=!1);a||!this.currentState.mCc||this.currentState.XFe||(this.Zj.f7a(this.currentState.mCc,this.currentState.tTf),this.currentState.XFe=!0)}tqd(){this.currentState.XFe&&(this.Zj.e7a(),this.currentState.XFe=!1)}Wfl(){this.currentState.YFe&&(this.Zj.HK(),this.currentState.YFe=
!1,this.currentState.G7a="")}Vki(a){this.currentState.$Ed&&(this.currentState.qDd?a||(this.Zj.IK(null),this.Zj.HK(),this.Zj.FWa(),this.currentState.$Ed=!1):(this.Zj.FWa(),this.currentState.$Ed=!1,this.currentState.qDd=!0))}wEb(a){this.tqd();this.Wfl();this.Vki(a)}hMm(a){this.Zj.GWa(new cu.a(2,1,a));this.currentState.PId++;this.currentState.atg=!0}jne(){!this.currentState.$Ed&&this.currentState.atg&&(this.Zj.EWa(),this.currentState.PId--,this.currentState.atg=!1)}fPg(a,d){a=this.dAm(a);if(""!==a)if(this.Xse(),
this.currentState.GGe)this.gPg(a,d);else{a=a.split(eu.NLk);for(let n=0;n<a.length-1;n++)this.gPg(a[n],d),this.Zj.lKb(d);this.gPg(a[a.length-1],d)}}LOg(a,d){""!==a&&(this.Xse(),this.Zj.m7a(a,d))}GOg(a){this.ktc.AQ||this.tqd();this.Xse(!0);this.Zj.DWa(a)}EOg(a){this.currentState.Dgd||this.Zj.zWa(a)}ANd(a){this.currentState.mCc&&(a.href=this.currentState.mCc);super.ANd(a)}BOg(a,d){this.tqd();this.currentState.mCc=a;this.currentState.tTf=d}AOg(){this.tqd();this.currentState.mCc=null;this.currentState.tTf=
null}SOg(a){this.currentState.BTf=a;this.wEb(!0)}ROg(){this.currentState.BTf=null;this.wEb(!0)}VOg(){this.currentState.GGe=!0}UOg(){this.currentState.GGe=!1}KOg(a){this.wEb(!1);this.jne();this.Zj.GWa(a);this.currentState.PId++}HOg(){this.wEb(!1);this.Zj.EWa();this.currentState.PId--}JOg(a){this.wEb(!1);this.currentState.PId||this.hMm(a);this.Zj.l7a(a);this.currentState.$Ed=!0;this.currentState.qDd=!0}IOg(){this.wEb(!1)}wna(a){this.currentState.Dgd||(this.mO=!0,this.currentState.table=new lx(this,
a))}ePg(){}tna(){if(this.currentState.table){var a=this.currentState.table;this.currentState.table=null;this.yOc.isEmpty?(this.mO=!1,a.Rpi()):this.XS.gS(Object(m.a)(a,a.Rpi,"flushTable"))}}bPg(){}vna(a){this.currentState.Dgd&&this.currentState.table.nTm(a)}dPg(){}una(){}cPg(){}sna(a){let d=!1;if(this.currentState.Dgd){const n=new jx(this);this.currentState.table.KAf(a,new du.a(a.dha.cLi,a.dha.YCe),a.vE,a.ota,a.cultureName,a.DQa,n)?(this.yOc.push(this.currentState),this.currentState=n):d=!0}else d=
!0;d&&this.currentState.ODg++}aPg(){}rna(){0<this.currentState.ODg?this.currentState.ODg--:this.currentState=this.yOc.pop()}$Og(){}W3h(a,d=1){if(!a)return null;const n=a.length;if(!n)return null;const z=a[0].length;for(var O=1;O<n;O++)if(a[O].length!==z)return null;O=Array(z+1);O[0]=0;const ca=Array(z+1);for(var Da=0;Da<ca.length;Da++)ca[Da]=!1;Da=new db.a;for(let zb=0;zb<z;zb++){for(var Xa=0;Xa<n;Xa++)if(a[Xa][zb]&&0<a[Xa][zb].width){const Vb=Math.min(zb+a[Xa][zb].colSpan,z);O[Vb]=O[zb]+a[Xa][zb].width*
(a[Xa][zb].$ob?d:1);ca[Vb]=!0}if(ca[zb+1]){Xa=O[zb+1]-O[zb];if(0>=Xa)return null;Da.add(Xa)}else O[zb+1]=O[zb]}return Da.toArray()}hum(a,d){1&d||(a.borderTopStyle=12);16&d||(a.borderRightStyle=12);256&d||(a.borderBottomStyle=12);4096&d||(a.borderLeftStyle=12);return a}xHl(a,d,n,z,O,ca){if(!a)return null;O&&(a=this.hum(a,ca));if(0>n||0>d||d>z.count-1)return a;0<=d-1&&n<=z.J(d-1).length-1&&1===a.borderLeftStyle&&(O=z.J(d-1)[n])&&1!==O.hua.borderRightStyle&&(a.borderLeftStyle=O.hua.borderRightStyle,
a.borderLeftColor=O.hua.borderRightColor,a.borderLeftWidth=O.hua.borderRightWidth);0<=n-1&&n<=z.J(d).length-1&&1===a.borderTopStyle&&(d=z.J(d)[n-1])&&1!==d.hua.borderBottomStyle&&(a.borderTopStyle=d.hua.borderBottomStyle,a.borderTopColor=d.hua.borderBottomColor,a.borderTopWidth=d.hua.borderBottomWidth);return a}dAm(a){this.currentState.GGe||(a=this.ktc.Bbm?a.replace(eu.k0l," "):a.replace(eu.j0l," "));a.startsWith(" ")&&(this.currentState.G7a.endsWith(" ")||""===this.currentState.G7a)&&(a=w.a.substring(a,
1,a.length));return a}gPg(a,d){""!==a&&(this.Zj.xna(a,d),this.currentState.G7a+=a)}}eu.j0l=RegExp("[ \t\f\u200b\r\n]+","g");eu.k0l=RegExp("[ \f\u200b\r\n]+","g");eu.NLk="\t";Object(t.a)(eu,"DefaultHtmlNormalizer",qw,[]);class mx extends eu{constructor(a,d,n){super(a,n);this.Jyh=!1;this.QUb=d}static f$l(a){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",!1)&&a?(a=mx.I9k.exec(a))&&0<a.length:!1}ANd(a){this.QUb.HKb&&(l.AFrameworkApplication.Ksa?this.Jyh||
(a=new $g.StandardDialog,a.wc=0,a.ee(1,CommonUIStrings.l_DialogClose),a.iu(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this.Jyh=!0):this.QUb.D3i?this.QUb.pLe=!0:a.src&&""!==a.src?Vc.a.aga(a.src)!==Vc.a.aga(window.location.href)||mx.f$l(a.src)?a.src.startsWith("data:")&&19922944<a.src.length?l.AFrameworkApplication.pa.processAction(Mb.a.iMg,2):a.src.startsWith("webkit-fake-url")?l.AFrameworkApplication.pa.processAction(Mb.a.hMg,2):(this.tqd(),this.Xse(!0),
this.Zj.PJa(a)):l.AFrameworkApplication.pa.processAction(Mb.a.kMg,2):l.AFrameworkApplication.pa.processAction(Mb.a.jMg,2))}}mx.I9k=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/D.+.png");Object(t.a)(mx,"Box4HtmlNormalizer",eu,[]);class fy{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc){this.htmlProcessor=a;this.Cig=d;this.zPk=n;this.$Sj=z;this.Pol=O;this.xgn=ca;this.ygn=Da;this.XCe=Xa;this.d0l=zb;this.f0l=Vb;this.hlm=Fc}}Object(t.a)(fy,"ExecutePasteArguments",null,[]);class Cn extends Pl{constructor(a,d,
n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le,Ve){super(d,n,z,Vb,Yc,Le);this.Gaa=this.i2=this.rpa=null;this.zwa=a;this.g$e=O;this.Qhf=ca;this.Cwf=Da;this.uzf=Xa;this.i3c=zb;this.ktc=je;this.va=Fc;this.lzh=Object.assign(new Ht.a,{EJc:2===this.rj.DBc||3===this.rj.DBc});this.vef=yd;this.S7d=Ve;this.Bwc=Fc.ea("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.Rmk=Fc.ea("ParseStyleFromRawHtmlHeadIsEnabled");this.Dnk=Fc.ea("RemoveSpacesAfterEndFragmentIsEnabled")}get FMe(){return!1}get mog(){return!0}Zli(a){this.rpa=
new Dd.GraphIterator;this.O7a.restore(this.rpa);k.ULS.shipAssertTag(6305550,307,Ia.OutlineElementReader.gg(this.rpa));if(this.r0){var d=new Dd.GraphIterator;d.Cb(this.rpa);d.Rn(16)&&(this.Gaa=d.currentNode)}this.rj.OY&&this.rj.OY.Wyc("external");var n=this.rj.aE&8192?1:0;d=this.Qhf.value.create(n,this.rpa,this.rj.Okd,this.rj.Nsb);const z=this.Cwf.value.create(n,this.rpa),O=Co.a.qui(l.AFrameworkApplication.userSessionId),ca=Co.a.aeg(l.AFrameworkApplication.userSessionId),Da=Co.a.K8f(I.a.Qhb,this.rj.Okd),
Xa=Co.a.JDi(l.AFrameworkApplication.userSessionId),zb=Co.a.KDi(l.AFrameworkApplication.userSessionId),Vb=this.Bwc?this.D3l():null,Fc=Co.a.myi(I.a.Qhb,this.rj.Okd),Yc=Co.a.nyi(l.AFrameworkApplication.userSessionId),yd=this.i3c.SAj?Co.a.gFl(l.AFrameworkApplication.userSessionId):null;n=this.g$e.value.create(n,this.rpa,d,z,null,Da,this.IBk);n=new Cz(n,Xa,zb);n=new mx(n,d,this.ktc);n=new lw.a(n,this.i3c,this.lzh,yd);n=new cy(n,Fc,Vb,this.va);n=new qn(n,Yc);d=new fy(n,d,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd);d=new Bo.a(a,
Object(m.a)(this,this.Yzm,"normalizeHtmlGlobally"),d);this.r0&&d.Hie(this.xJg.bind(this));d.Pj("paste and request pictures");d.Ce=!a||a.Ce;d.run()}get IBk(){return this.zwa.getElementsByTagName("a").length}Yzm(a){this.S7d.xWi(this.zwa)&&l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordRemoveSpacesAfterEndFragmentSettings");this.Dnk&&this.S7d.NGn(this.zwa);a.ui(Object(m.a)(this,this.qTm,"preprocessStyle"));return!0}qTm(a){if(this.Rmk){const d=this.zwa.getElementsByTagName("style");
if(d&&0<d.length){k.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let n=0;n<d.length;n++)this.vef.FYk(this.zwa,d[n]),d[n]&&(d[n].parentNode.removeChild(d[n]),n--)}}a.ui(Object(m.a)(this,this.RYk,"convertWordListHtml"));return!0}RYk(a,d){this.uzf.value.create(d.$Sj).process(this.zwa,a);(d=la.a.instance.sa("Box4.IFeatureHelper"))&&d.isFeatureEnabled(23)?a.ui(Object(m.a)(this,this.kYk,"convertChartHtml")):a.ui(Object(m.a)(this,this.tgj,
"processHtml"));return!0}kYk(a,d){(new rA(d.zPk)).process(this.zwa,a);a.ui(Object(m.a)(this,this.tgj,"processHtml"));return!0}tgj(a,d){d.htmlProcessor.process(this.zwa,a);d=d.Cig&&d.Cig.HKb?Object(m.a)(this,this.aMb,"requestImages"):Object(m.a)(this,this.rki,"endPasteOperation");a.ui(d);return!0}aMb(a,d){if(d=d.Cig){let n=!1,z=!1,O=!1,ca=!1,Da=-1;const Xa=new dh.DictionaryPropertySet,zb=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');if(Object(Uc.a)(90,this.rj.$c)){n=this.rj.$c.fa(Qb.a.Cma,
!1);const Vb=this.rj.$c.fa(Xc.a.wV,"");O=this.rj.$c.fa(Xc.a.wga,!1);ca=this.rj.$c.fa(Vd.a.u4,!1);zb.test(Vb)&&(z=!0);this.UAj&&(Da=this.rj.$c.fa(bd.a.Mfa,-1))}else this.rj.aE&256&&this.zwa&&(n=!0,zb.test(this.zwa.innerHTML)&&(z=!0));Xa.setValue(Qb.a.Cma,n);Xa.setValue(Xc.a.kLc,z);Xa.setValue(Xc.a.wga,O);Xa.setValue(bd.a.Mfa,Da);Xa.setValue(Vd.a.u4,ca);d.BXe(Xa);d.yIg();d.KJb&&(this.rj.jcc=!0,this.rj.Wig=d.t_,this.rj.hFg=d.KJb,n&&!O&&we.c(Mb.a.zmi),l.AFrameworkApplication.pa.processAction(Mb.a.aMb,
2))}a.ui(Object(m.a)(this,this.rki,"endPasteOperation"));return!0}rki(a,d){Co.a.csm(d.$Sj);Co.a.Onm(d.f0l);Co.a.Mqm(d.xgn);Co.a.Nqm(d.ygn);Co.a.nom(d.hlm);a="Others";d.XCe&&(d.XCe.Lnm(),d.XCe.Mnm(),a=d.XCe.B6g);Co.a.Nnm(d.d0l,a);Co.a.tnm(d.Pol,a);return!1}xJg(){if(this.Gaa&&16==this.Gaa.type){let a=new Dd.GraphIterator;a.set(this.Gaa);a.La(14);if(a.Rn(14)){let d=new Ff.GraphTransaction(4);d.Sa(a.currentNode);ci.iXh(this.Gaa);d.dispose()}}}get r0(){null==this.i2&&(l.AFrameworkApplication.Yi("he991617;3eed2178"),
this.i2=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.i2}D3l(){const a=new tA;a.NOc=I.a.Qhb;this.rj&&(a.aE=this.rj.aE,a.sKg=this.rj.Okd,this.rj.$c&&(a.Pgj=this.rj.$c.fa(Xc.a.fMg,"")));this.zwa&&this.zwa.innerHTML&&(a.SPm=this.zwa.innerHTML.length);l.AFrameworkApplication.sessionStartInfoSettings&&(a.platform=l.AFrameworkApplication.sessionStartInfoSettings.Platform);return a}get fBj(){return!0}get eVd(){k.ULS.shipAssertTag(6305551,
307,!!this.rpa);if(this.i3c.TAj(this.lzh)){let a=!1;Ia.OutlineElementReader.gg(this.rpa)&&(this.rpa.QN(),a=!0);const d=Bd.ParagraphReader.Zf(this.rpa)&&!this.rpa.currentNode.fa(Xc.a.bog,!1);a&&this.rpa.hb();return d}return Bd.ParagraphReader.Zf(this.rpa)}}Object(t.a)(Cn,"ExternalPasteExecutionManager",Pl,[]);class Fz{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc){this.g$e=a;this.Qhf=d;this.Cwf=n;this.uzf=z;this.i3c=O;this.V5=ca;this.va=Da;this.vef=Xa;this.ktc=zb;this.oea=Vb;this.S7d=Fc}create(a,d,n,z){return new Cn(a,
d,n,z,this.g$e,this.Qhf,this.Cwf,this.uzf,this.i3c.value,this.V5,this.va,Lb.App.oa.za,this.vef,this.ktc,this.oea,this.S7d)}}Object(t.a)(Fz,"Factory",null,[473]);class fp{xWi(a){if(!a||!a.childNodes)return!1;const d=a.childNodes.length;return 2>d?!1:this.T$l(a.childNodes[d-2])&&this.Mhm(a.childNodes[d-1])}NGn(a){this.xWi(a)&&(a.removeChild(a.lastChild),k.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}e9l(a){return!!a&&8===a.nodeType}Cgm(a){return!!a&&3===a.nodeType}T$l(a){return this.e9l(a)&&
"EndFragment"===a.nodeValue}Mhm(a){if(!this.Cgm(a))return!1;a=a.nodeValue;return!!a&&!a.trim().length}}Object(t.a)(fp,"HtmlNormalizerHelper",null,[472]);var Eo=b(366),rw=b(213),Gz=b(967),vA=b(708);class sw{constructor(a,d,n,z){this.Pqe=this.Nqe=null;this.pWd=a;this.O0e=d;this.hEj=n;this.jEj=z}}Object(t.a)(sw,"TableSimplificationInformation",null,[]);var wA=b(239),xA=b(823),as=b(271),xs=b(1195);class bs extends Sys.EventArgs{constructor(a){super();this.$u=a}}Object(t.a)(bs,"AfterTrimCompleteOnCopyArgs",
Sys.EventArgs,[]);var ys=b(1587);class zs extends ys.a{constructor(a,d,n,z){super(a,d,{});this.LRc=[];for(a=0;a<n.length;a++)this.LRc.push(...n.J(a).toArray());this.f3a=0;this.XB=z;this.$u={}}}Object(t.a)(zs,"BasicInternalCopyArguments",ys.a,[]);class Zq extends Sys.EventArgs{constructor(a){super();this.$u=a}}Object(t.a)(Zq,"BeforePasteArguments",Sys.EventArgs,[]);class Qu extends Sys.EventArgs{constructor(a,d,n,z){super();this.paragraph=a;this.cpBegin=d;this.cpEnd=n;this.$u=z}}Object(t.a)(Qu,"BeforeTrimOnCopyArguments",
Sys.EventArgs,[]);var fu=b(1628),Gq=b(1629);class lq{constructor(a,d,n,z,O,ca,Da,Xa,zb){this.ZTc=a;this.source=d;this.target=n;this.HKg=z;this.rowIndex=O;this.Yp=ca;this.fkd=Da;this.Ydj=Xa;this.Tc=zb}}Object(t.a)(lq,"CoreInternalTablePasteArguments",null,[]);class tw extends Sys.EventArgs{constructor(a,d,n,z,O){super();this.operation=a;this.Zbj=d;this.original=n;this.clone=z;this.$u=O}}Object(t.a)(tw,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);class $f{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,
Yc,yd,je,Le){this.c3=this.Dk=this.Ja=null;this.jof=!1;this.Tld=this.i2=this.bUb=null;this.Ouc=ca;this.Ck=Da;this.si=a;this.xwf=d;this.Cq=n;this.Ee=z;this.Wq=O;this.va=Xa;this.Nb=Vb;this.Wge=zb.create(2097162);this.VSg(this.Wge);this.wdf=zb.create(2097162);this.VSg(this.wdf);this.dzf=zb.create(2097162);this.VSg(this.dzf);this.Tfe=this.Wge;this.V5=Fc;this.U$=Yc;this.Eb=yd;this.$bd=je;this.Dmk=je.substr(0,3);this.oea=Le}get paragraphEditor(){return $f.Ki||($f.Ki=la.a.instance.resolve("Box4.IParagraphEditor"))}get Ka(){return this.Ja||
(this.Ja=la.a.instance.sa("Box4.IFeatureHelper"))}get pl(){return this.Dk?this.Dk.pl:0}get Aya(){return this.Dk.Ba.Aya}get m7(){return this.Dk.Ba.m7}get oua(){return this.Tfe}get CIj(){return this.dzf}get fPf(){return this.Dk.EE&&!this.jof}Gzj(){this.jof=!0}get Fbj(){return!this.Dk.EE}get QDa(){return Kk.a.instance}get Gdm(){return this.va.ea("InternalPasteTableWithReplacingCellIsEnabled")}VSg(a){var d=new xA.a(-1);this.Ouc.Cm.Lxa(d);const n=new Dd.GraphIterator;n.set(d);l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordNoRenderGraphTransactionInternalClipboardSettings");
d=3;this.va&&this.va.ea("NoRenderGraphTransactionInternalClipboardIsEnabled")&&(d=0);d=this.Nb.Wb(d);d.Ir(n);n.Re(a,80);d.dispose()}Roe(a,d=null){a=a.Oa;this.Dk=a.ya.clone();this.jof=!1;a=Dd.GraphIterator.ua(a.eZ);const n=Dd.GraphIterator.ua(this.oua),z=this.Nb.Wb(3,Mb.a.internalCopy);z.Ir(n);a.Va(82);do a.currentNode.bwb(null);while(a.jh(82));a=new Bo.a(d,Object(m.a)(this,this.pSk,"clearInternalClipboard"),new zs(a,n,this.Dk,z));a.Pj("InternalCopy");a.Ce=!d||d.Ce;a.run()}pSk(a,d){Mh.a.mark(5566);
d=d.target;if(d.Rc())return d.wg(),!0;a.ui(Object(m.a)(this,this.dEc,"executeCopy"));return!0}dEc(a,d){d=new fu.a(d,null);d=new Bo.a(a,Object(m.a)(this,this.Emd,"coreCopySetup"),d);d.Pj("ExecuteCoreCopyToInternalClipboard");d.run();a.ui(Object(m.a)(this,this.LGn,"trimNewText"));return!0}Emd(a,d){if(!d.source.Rc())return d.rj&&(d.rj.Kme=null),k.ULS.shipAssertTag(6305560,307,!1),!1;a.ui(Object(m.a)(this,this.Tai,"coreCopyIteration"));return!0}Tai(a,d){const n=d.insertAfter,z=d.source,O=d.target,ca=
z.currentNode;var Da=this.Fbj;if(!ca.zsa)return a.ui(Object(m.a)(this,this.Dmd,"coreCopyIncrement")),!0;d.rj.Nlc&&(d.Nlc=!0);if(!this.wQk(d))return d.yua.UUa.c++,a.ui(Object(m.a)(this,this.Dmd,"coreCopyIncrement")),!0;if(!d.Nlc&&(ca.kkb()&&d.yua.UUa.c++,ca.kkb()||Da&&!ca.Z5a(this.pl)))return a.ui(Object(m.a)(this,this.Dmd,"coreCopyIncrement")),!0;if(!d.Nlc&&Da&&!ca.Dn)return z.Vz()&&(d.V3e=!0,d=new Bo.a(a,Object(m.a)(this,this.Emd,"coreCopySetup"),new fu.a(d,n)),d.Pj("RecursiveCoreCopyToInternalClipboard"),
d.run()),a.ui(Object(m.a)(this,this.Dmd,"coreCopyIncrement")),!0;Da=O.currentNode.Zg().kd;Da=Bq.a(ca,Da,!0);this.QDa.KTe(d.yua.G$b,Da);O.zE(Da,n,18===z.parentNode.type?1:z.role);O.rg(Da);d.insertAfter=Da;Bd.ParagraphReader.nb(Da)&&(this.HUm(a,Object(m.a)(this,this.Emd,"coreCopySetup"),ca,Da,d),this.GUm(a,ca,Da));this.eli(ca,Da);z.Vz()&&(k.ULS.shipAssertTag(6305562,307,!d.V3e),d=new Bo.a(a,Object(m.a)(this,this.Emd,"coreCopySetup"),new fu.a(d,null)),d.Pj("RecursiveCoreCopyToInternalClipboard"),d.run());
a.ui(Object(m.a)(this,this.mZk,"coreCopyIterationPostProcessing"));return!0}mZk(a,d){var n=d.source;const z=d.target;var O=z.currentNode,ca=n.currentNode;Bd.ParagraphReader.Zf(z)&&(d.xLg[ca.id.toString()]=O);if(Bd.ParagraphReader.nb(O)){if(0<Bd.ParagraphReader.wcg(ca))if(0<this.Ck.ML(ca).pu)ca.setValue(Qb.a.dKa,0);else{const Da=this.Ck.b4(ca).pu;this.paragraphEditor.dr.goa(O,Da)}if(!this.XBd&&this.oea.Zdj){n.hb();if(!If.TableReader.Pv(z)&&n.yga&&!this.m7)for(const Da of this.oea.zLg)O.removeProperty(Da);
n.rg(ca)}}if(uf.a.instance.J(6)&&Bd.ParagraphReader.nb(O)){for(ca=0;ca<O.wordRunProperties.length;ca++)O.wordRunProperties.Qo.$(ca,as.CharacterPropertiesEditor.KI),O.wordRunProperties.ir.$(ca,as.CharacterPropertiesEditor.EK);k.ULS.shipAssertTag(6305564,307,uf.a.instance.J(4));k.ULS.shipAssertTag(6305565,307,!!Lb.App.lc);(this.Eb.Jf||uf.a.instance.J(3)&&Lb.App.Yq.MUc)&&O.setValue(Qb.a.QHb,!0);O.oe(Qb.a.f4a,Qb.a.jLg,Qb.a.jQe);uf.a.instance.J(3)&&Bd.ParagraphReader.nb(O)&&O.oe(Qb.a.Nma)}this.Fbj&&(this.dli(z),
If.TableReader.isTable(z)&&(O=this.Dk.zy(),O.moveNext(),(O=Sf.TableCellReader.Bza(n,O.current.node))||(O=new vA.a(0,0)),n=new sw(O,z,If.TableReader.s7(n),If.TableReader.wze(n)),this.xwf.value.Xan(n)));Ia.OutlineElementReader.gg(z)&&!z.Bo(2)&&(this.Ee.vX(z),z.hb());z.hb();d.rj&&(d.rj.Kme=d.insertAfter);a.ui(Object(m.a)(this,this.Dmd,"coreCopyIncrement"));return!0}Dmd(a,d){d.V3e&&(d.insertAfter=d.Kme,d.V3e=!1);if(!d.source.Fs()){d.rj&&(d.rj.Kme=d.insertAfter);const n=d.source;11!==n.Yc||n.jGc(-1)||
this.gVm(a,n.currentNode,d.target.currentNode,d);return!1}a.ui(Object(m.a)(this,this.Tai,"coreCopyIteration"));return!0}wQk(a){const d=a.source;if(Ia.OutlineElementReader.gg(d)&&d.nma(12)){const n=d.Rc();if(Bd.ParagraphReader.nb(n)&&n.fa(Qb.a.CQ,null))return d.hb(),a.Nlc=!1;d.hb()}else if(Bd.ParagraphReader.nb(d.Hm)&&d.Hm.fa(Qb.a.CQ,null))return!1;return!0}GUm(a,d,n){d=Lj.e(d);n=Lj.e(n);for(let z=0;z<d.length;z++)d[z].iNe(n[z],a,Object(m.a)(this,this.Emd,"coreCopySetup"))}LGn(a,d){if(d.f3a>=d.LRc.length)return $f.ka.raiseEvent("AfterTrimCompleteOnCopy",
new bs(d.$u)),a.ui(Object(m.a)(this,this.lZk,"copyTeardown")),!0;a=d.LRc[d.f3a];var n=a.node,z=a.cpBegin;let O=a.cpEnd;if(!Qd.SelectionEditor.Tl(a))if(!d.f3a&&Qd.SelectionEditor.sg(a))O=z=Bd.ParagraphReader.textLength(n);else if(Bd.ParagraphReader.rh(a))z=0,O=Bd.ParagraphReader.textLength(n);else if(Qd.SelectionEditor.rK(a)){k.ULS.shipAssertTag(6305568,307,!d.f3a);var ca=Dd.GraphIterator.ua(n);z=ca.La(12);k.ULS.shipAssertTag(6305569,307,z);n=ca.origin;O=z=Bd.ParagraphReader.textLength(n)}else{if(qh.OutlineReader.Ccc(a))for(a=
$s.a.Ql(a.node);a.moveNext();)ca=a.currentNode,Bd.ParagraphReader.nb(ca)&&Array.add(d.LRc,fe.a.createTextRange(ca,0,Bd.ParagraphReader.textLength(ca)));d.f3a++;return!0}ca=d.xLg[n.id.toString()];k.ULS.shipAssertTag(6305570,307,!!ca);if(!ca)return k.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:d.f3a,["SelectedContextsLength"]:d.LRc.length,["SelectedNodeType"]:n.type,["ContextId"]:a.contextId}),d.f3a++,!0;n=Lj.e(ca);let Da,Xa=!1;for(Da=n.length-1;0<=Da;Da--)if(!n[Da].ila)if(4===
n[Da].Qf)n[Da].Wa.blob=null,n[Da].Wa.blob=new Cp.a(n[Da].Wa,Cp.a.ujb),d.yua.UUa.e++;else{n[Da].Wa.blob=null;if(uf.a.instance.J(6)&&-1!==n[Da].Qc){var zb=n[Da].Wa.formatting,Vb=void 0,Fc=void 0;zb&&-1===zb.Qc?(Fc=n[Da].Qc+1,Vb=n[Da].fO-1,zb.Qc=n[Da].Qc):(Vb=n[Da].fO,Fc=n[Da].Qc);for(zb=0;zb<Vb;zb++)ca.wordRunProperties.removeAt(Fc,16);0<Vb&&(Xa=!0)}Vb="";ih.f(n[Da])?(Vb=" ",d.yua.UUa.f++):ih.g(n[Da])&&(Fc=ih.b(n[Da]))&&(Vb=ih.a(Fc),d.yua.UUa.g++);Fc=n[Da].Wa.cp;Fc>=z&&Fc<O&&($f.characterPropertiesEditor.replaceTextRange(fe.a.createTextRange(ca,
Fc,Fc+1),Vb),O=O-1+Vb.length,d.yua.UUa.i++)}Xa&&ca.$j();this.c7m(ca);$f.ka.raiseEvent("BeforeTrimOnCopy",new Qu(ca,z,O,d.$u));n=Bd.ParagraphReader.textLength(ca);O<n&&$f.characterPropertiesEditor.replaceTextRange(fe.a.createTextRange(ca,O,n),"");0<z&&$f.characterPropertiesEditor.replaceTextRange(fe.a.createTextRange(ca,0,z),"");this.UUl(ca,d.yua.UUa);!Bd.ParagraphReader.textLength(ca)&&d.f3a===d.LRc.length-1&&Qd.SelectionEditor.Tl(a)&&(a=Dd.GraphIterator.ua(ca),a.La(25)&&(qe.OutlineElementNavigator.Uc(a),
this.Ee.Gjb(a),d.f3a&&(this.Dk.Ba.m7=!0)));this.QDa.hQc(d.yua.qQe,d.yua.D4b,d.yua.rCb,ca);d.f3a++;return!0}c7m(a){const d=a.ja;if(uf.a.instance.J(6)&&d){var n=new db.a,z=new db.a;for(let O=0;O<d.length;O++){const ca=d.J(O);ca.xg&&n.add(ca);if(ca.Qa){for(let Da=0;Da<ca.Qa.length;Da++)z.add(ca.Qa.J(Da).Qc);ca.Qa=null}}a.VY(!0,z);for(const O of n)O.xg=null}}lZk(a,d){this.oua.bwb(null);d.XB.dispose();Mh.a.mark(5567);this.Wzm();this.c3=d.yua;this.V_i("Copy");this.R8l&&k.ULS.sendTraceTag(6305600,307,50,
"Empty ClipboardRoot");return!1}get R8l(){return!Dd.GraphIterator.ua(this.oua).Rc()}$Qj(){this.Tfe=this.dzf}ZQj(){this.Tfe=this.Wge}nQn(){this.Tfe=this.wdf}get $gm(){return this.oua===this.Wge}get y$l(){return this.oua===this.wdf}j7h(){const a=Dd.GraphIterator.ua(this.oua);for(;a.Rc();)a.wg()}V_i(a){const d=this.c3.UUa.b;a+="-"+d;this.c3.UUa.b=a;this.c3.G$b.b=a;this.c3.qQe.b=a;this.c3.D4b.b=a;this.c3.rCb.b=a;this.QDa.bom(this.c3.UUa);this.QDa.kxg(this.c3.G$b);this.QDa.S0i(this.c3.qQe);this.QDa.Rwg(this.c3.D4b);
this.QDa.Owg(this.c3.rCb);this.c3.UUa.b=d;this.c3.G$b.b=d;this.c3.qQe.b=d;this.c3.D4b.b=d;this.c3.rCb.b=d}Vdj(a,d,n,z,O=null,ca=null){this.V_i("Paste");const Da=Dd.GraphIterator.ua(d),Xa=Dd.GraphIterator.ua(this.oua);var zb=null;O&&(zb=new kq.a(qh.OutlineReader.tqe,qh.OutlineReader.ffi),zb=O.equals(new kq.a(-1,-1))?new kq.a(0,0):O.lXd(zb));if(this.yOi())if(Xa.Rc(),Kd.ImageReader.Xr(Xa.currentNode))O=Xa.currentNode,Xa.hb(),Xa.zE(this.Ee.V5b(),null,1),Xa.Rc(),Xa.zE(O,null,2),Xa.hb(),Xa.rg(O),Xa.wg(),
this.Gzj();else if(rw.isFloatingEmbeddedFileNode(Xa.currentNode)){O=Xa.currentNode;Xa.hb();Xa.zE(this.Ee.V5b(),null,1);Xa.Rc();var Vb=this.Ee.vX(Xa);Vb=fe.a.Kb(Vb,0);$f.characterPropertiesEditor.replaceTextRange(Vb,"<<"+rw.getEmbeddedFileName(O)+">>");Xa.hb();Xa.hb();Xa.rg(O);Xa.wg();this.Gzj()}this.V5&&this.V5.Kqg(n)||!this.Gdm||!this.mVi(Xa,Da)?(Mh.a.mark(5564),Xa.currentNode.bwb(null),a={},a[$f.zig]=z,Bf.ListReader.rY(n)&&(a[Gz.a.COi]=!0),n=new Gq.a(Xa,Da,n,zb,a),this.r0&&16==d.type&&(this.Tld=
d),d=new Bo.a(ca,Object(m.a)(this,this.Hmd,"corePasteSetup"),n),d.Pj("ExecuteCorePasteFromInternalClipboard"),this.r0&&d.Hie(this.xJg.bind(this)),d.Ce=!ca||ca.Ce,this.tUm(n),d.run()):(Xa.currentNode.bwb(null),k.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),this.h$m(ca,Xa,Da,zb,a),k.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended."))}XUi(a){if(a&&a.Yb){const d=Dd.GraphIterator.ua(this.oua);return this.mVi(d,a)}return!1}mVi(a,d){if(Sf.TableCellReader.nJa(d)&&
1===a.Sr()){a.Va(1);if(Ia.OutlineElementReader.gg(a)){qe.OutlineElementNavigator.Sd(a);if(If.TableReader.isTable(a)){If.TableReader.Qx(a.currentNode)&&k.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");if(d.La(14)&&!If.TableReader.Qx(Uf.getContainingTable(d))){if(k.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."),!this.r0)return!0}else if(k.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table."),this.XBd&&!this.r0)return!0;if(this.r0&&!this.Bfm())return!0}qe.OutlineElementNavigator.Uc(a)}a.hb()}return!1}Won(){this.e1e=
Yr.TableBorderSelectionCache.$0.nP;this.b$g=Yr.TableBorderSelectionCache.$0.cG;this.oCn=Yr.TableBorderSelectionCache.$0.vH;this.VHj=Yr.TableBorderSelectionCache.$0.tT}h$m(a,d,n,z,O){let ca,Da;let Xa;n.La(14);ca=km.a.hm(n);Da=Vr.a(n);n.tc(14);var zb=If.TableReader.Sf(n.currentNode);Xa=If.TableReader.nh(n.currentNode);const Vb=If.TableReader.Sf(d.currentNode),Fc=If.TableReader.nh(d.currentNode);k.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};  and target insert index: {5},{6}",
zb,Xa,Vb,Fc,ca,Da);if(this.r0)this.Won(),zb=Math.min(this.e1e+1,zb),Xa=Math.min(this.b$g+1,Xa),this.b$g-this.oCn==Xa-1&&(this.VHj==this.e1e?Da=0:this.e1e-this.VHj==zb-1&&(n.Rc(),ca=km.a.hm(n),Da=Vr.a(n)));else{this.bUb=xs.a.svd;var Yc=ca+Vb-zb;0<Yc&&(Uf.moveToLastRow(n),k.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+Yc),this.xwf.value.insertRows(n,!1,Yc,this.bUb),k.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),n.tc(14));Yc=Da+Fc-Xa;if(0<Yc){k.ULS.sendTraceTag(8716376,307,50,
"Begin insert columns: "+Yc);try{this.xwf.value.insertColumns(n,Xa,!1,Yc,this.bUb)}catch(yd){throw k.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",yd.toString()),yd;}k.ULS.sendTraceTag(8716377,307,50,"Completed inserting columns.")}}zb=this.oul(zb,Xa,Vb,Fc,ca,Da);k.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");a=new Bo.a(a,Object(m.a)(this,this.NPm,"pasteTableOperationRun"),new lq(null,d,n,z,ca,Da,zb,null,O));a.Pj("ExecuteCorePasteTableInTable");a.Ce=!1;a.run()}NPm(a,
d){if(d.ZTc){if(d.ZTc.inProgress)return!0;Sf.TableCellReader.isTableCell(d.source)||d.source.tc(16);if(this.bym(d))return!1}else If.TableReader.isTable(d.target)||d.target.tc(14),If.TableReader.isTable(d.source)||d.source.tc(14),Uf.moveToCell(d.target,d.rowIndex,d.Yp),Uf.moveToCell(d.source,0,0);if(Sf.TableCellReader.we(d.source)||Sf.TableCellReader.we(d.target))return!0;this.DPm(d,a);return!0}Wzm(){if(this.XBd){for(var a=Dd.GraphIterator.ua(this.oua),d=a.currentNode;14!==a.Yc;)if(d=a.Rc(),!d){k.ULS.sendTraceTag(39716809,
307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.O6i(d)}}aAm(a){this.XBd&&this.O6i(a)}vEn(a){const d=Dd.GraphIterator.ua(a);this.Cq.WGb(d,null,!0);a.we=!1;a.rowSpan=1;a.colSpan=1}O6i(a){if(a&&14===a.type){k.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var d={},n=If.TableReader.Sf(a),z=If.TableReader.nh(a),O=Dd.GraphIterator.ua(a);Uf.forEachCellInTable(O,(ca,Da,Xa)=>{const zb={};ca=ca.currentNode;if(16===ca.type)if(ca.we)$f.y9h(Da,
Xa)in d||(this.vEn(ca),zb.IsGhostCell="->false");else{$f.A1m(a,ca,Da,Xa,n,(Fc,Yc,yd)=>{zb.rowSpan=String.format("{0}:{1}->{2}",Fc,Yc,yd)});$f.z1m(a,ca,Xa,Da,z,(Fc,Yc,yd)=>{zb.colSpan=String.format("{0}:{1}->{2}",Fc,Yc,yd)});const Vb=String.format("{0},{1}-{2},{3}",Da,Xa,Da+ca.rowSpan,Xa+ca.colSpan);for(let Fc=0;Fc<ca.rowSpan;Fc++)for(let Yc=0;Yc<ca.colSpan;Yc++)if(Fc||Yc)d[$f.y9h(Da+Fc,Xa+Yc)]=Vb}if(0<Eo.a(zb).length){if(void 0===zb.IsGhostCell||null===zb.IsGhostCell){if(void 0===zb.rowSpan||null===
zb.rowSpan)zb.rowSpan=ca.rowSpan;if(void 0===zb.colSpan||null===zb.colSpan)zb.colSpan=ca.colSpan}k.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",Da,Xa,zb)}return!0});$f.gdl(d)}}UUl(a,d){if(a&&Bd.ParagraphReader.nb(a)){var n=0,z=Dd.GraphIterator.ua(a);for(z.Va(6);!z.Lj;){var O=z.currentNode;z.jh(6);Kd.ImageReader.Xr(O)?Kd.ImageReader.nEd(O)?Dd.GraphIterator.ua(O).nma(59)?k.ULS.sendTraceTag(590455048,307,50,"HandleAnchoredObjectsForInternalCopy: Not converting anchored image to inline."):
(this.paragraphEditor.FPf(O,fe.a.Kb(a,n)),d.d++,n++):(O=Dd.GraphIterator.ua(O),O.La(12),O.wg(),d.h++):k.ULS.shipAssertTag(6305571,307,!1)}}}get XBd(){return!!this.va&&this.va.ea("ComplexTableCellPasteWithFormattingIsEnabled")}oul(a,d,n,z,O,ca){const Da=[];let Xa,zb,Vb,Fc;this.r0?(Xa=Math.min(a,O+n),zb=Math.min(d,ca+z),Fc=O):(Fc=0,Xa=Math.max(O+n,a));for(;Fc<Xa;Fc++)for(this.r0?Vb=ca:(Vb=0,zb=ca+z,Fc<O?Vb=d:Fc>=O&&Fc<Math.min(O+n,a)?Vb=ca:Fc>=O+n&&Fc<a?Vb=d:zb=Math.max(ca+z,d));Vb<zb;Vb++)Da.push(Array(2)),
Da[Da.length-1][0]=Fc,Da[Da.length-1][1]=Vb;return Da}Hmd(a,d){if(!d.source.Rc())return a.ui(Object(m.a)(this,this.FKb,"pasteTeardown")),!0;a.ui(Object(m.a)(this,this.Uai,"corePasteIteration"));return!0}p$m(a,d){if(this.XBd)if(!d||!a)k.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:a,["table"]:d});else if(16===d.currentNode.type&&16===a.parentNode.type){d=d.currentNode;a=a.parentNode;var n={};d.we!==a.we&&(d.we=a.we,n.IsGhostCell=d.we);d.kV!==a.kV&&(d.kV=a.kV,n.IsSkippedCell=
d.kV);d.f9a!==a.f9a&&(d.f9a=a.f9a,n.ShouldRenderCell=d.f9a);d.colSpan!==a.colSpan&&(n.ColSpan=String.format("{0}<={1}.",d.colSpan,a.colSpan),d.colSpan=a.colSpan);d.rowSpan!==a.rowSpan&&(n.RowSpan=String.format("{0}<={1}.",d.rowSpan,a.rowSpan),d.rowSpan=a.rowSpan);Eo.a(n)}}Uai(a,d){const n=d.source,z=d.target,O=n.currentNode;if(!O.zsa||!O.jla||this.otn(n,z))return a.ui(Object(m.a)(this,this.Gmd,"corePasteIncrement")),!0;if(uf.a.instance.J(3)&&Ia.OutlineElementReader.gg(n)){if(!qe.OutlineElementNavigator.Sd(n).jla)return qe.OutlineElementNavigator.Uc(n),
a.ui(Object(m.a)(this,this.Gmd,"corePasteIncrement")),!0;qe.OutlineElementNavigator.Uc(n)}k.ULS.shipAssertTag(6305608,307,!O.kkb());var ca=z.currentNode.Zg().kd;ca=Bq.a(O,ca,!0);ca.VBa();ca.Lqg=!0;this.p$m(n,z);z.zE(ca,d.insertAfter,n.role);z.rg(ca);d.insertAfter=ca;uf.a.instance.J(4)&&Lb.App.lc.eq&&Lb.App.lc.Mp.MJ(ca);this.eli(O,ca);d=new Bo.a(a,Object(m.a)(this,this.Hmd,"corePasteSetup"),new Gq.a(n,z,null,d.HKg,d.$u));d.Pj("RecursiveCorePasteOperation");d.run();a.ui(Object(m.a)(this,this.oZk,"corePasteIterationPostProcessing"));
return!0}otn(a,d){let n=!1;Ia.OutlineElementReader.gg(a)&&(n=Ia.OutlineElementReader.rI(a)&&this.vgm(d));return n}vgm(a){if(a)return a=a.Yc,36===a||38===a||16===a;throw Error.argument("IsTargetNodeInValidForIFrameContent: target iterator is null for paste.");}nVm(a,d,n){d=Lj.e(d);const z=Lj.e(n);for(let O=d.length-1;0<=O;O--){if(!d[O].bmc(n)){const ca=fe.a.createTextRange(n,d[O].Wa.cp,d[O].Wa.cp+1);$f.characterPropertiesEditor.replaceTextRange(ca,"")}d[O].ANc(z[O],a,Object(m.a)(this,this.Hmd,"corePasteSetup"),
this.y$l)}}oZk(a,d){const n=d.target,z=n.currentNode,O=d.source,ca=O.currentNode;let Da=-1;d.$u[$f.zig]&&(Da=d.$u[$f.zig]);Bd.ParagraphReader.nb(z)&&(this.sVm(a,Object(m.a)(this,this.Hmd,"corePasteSetup"),ca,z,d),this.nVm(a,ca,z));z.Q4();d.$u[Gz.a.COi]?22===z.type&&(Sf.TableCellReader.cM(O)||z.setValue(Qb.a.listID,Number.MAX_VALUE)):this.Wq.Dpj(z);if(Bd.ParagraphReader.nb(z)&&(d=Lj.i(z,5),0<d.length)){for(const Xa of d)!Xa.properties.hasProperty(Qb.a.zhc)&&Xa.properties.hasProperty(Qb.a.XQe)&&(d=
Xa.properties.getValue(Qb.a.XQe),Xa.properties.setValue(Qb.a.zhc,d)),Kd.ImageReader.L5a()?Kd.ImageReader.IVa(Xa.properties)&&this.si.TYg(Xa.properties,Da):Kd.ImageReader.Aw(Xa.properties)||this.si.TYg(Xa.properties,Da);z.Zg().contentReplicator.forceOutbound(null,null,null)}this.dli(n);this.BPn(ca,z);this.r0&&Sf.TableCellReader.nJa(n)&&this.Men(z);n.hb();a.ui(Object(m.a)(this,this.Gmd,"corePasteIncrement"));return!0}BPn(a,d){if(uf.a.instance.J(3)&&If.TableReader.GS(a)){let n=0;const z=If.TableReader.Sf(a);
for(const O of If.TableReader.WB(a,0,z-1))O.hF&&n++;a=this.Nb.Wb(4);a.Sa(d);d.properties.setValue(Vd.a.kua,z-n);a.dispose()}}Gmd(a,d){if(!d.source.Fs())return a.ui(Object(m.a)(this,this.FKb,"pasteTeardown")),!0;a.ui(Object(m.a)(this,this.Uai,"corePasteIteration"));return!0}FKb(){Mh.a.mark(5565);return!1}xJg(){if(null!=this.Tld&&16==this.Tld.type){let a=new Dd.GraphIterator;a.set(this.Tld);a.La(14);if(a.Rn(14)){const d=this.Nb.Wb(4);d.Sa(a.currentNode);ci.iXh(this.Tld);d.dispose()}}}Men(a){if(a&&14===
a.type){var d=new Dd.GraphIterator;d.set(a);if(d.kc()){var n=a.wN,z=If.TableReader.qye(d),O=Uf.returnToContainingCell(d),ca=Uf.getContainingTable(d);if(O&&ca){var Da=Vr.a(d),Xa=Sf.TableCellReader.Sz(O);if(d.tc(14)){var zb=If.TableReader.s7(d);d=0;for(let Vb=Da;Vb<Da+Xa;Vb++)d+=zb[Vb];Da=iq.a.hH(O,ca,Qb.a.gG,Qb.a.v5,0);O=iq.a.hH(O,ca,Qb.a.fJ,Qb.a.lda,0);d-=rf.a.hl(Da+O,0);O=0;for(ca=0;ca<n.length;ca++)O+=n[ca];O=d/O;ca=0;for(Da=0;Da<n.length;Da++)n[Da]*=O,n[Da]<z[Da]&&(n[Da]=z[Da]),ca+=n[Da];ca>d&&
(n=Array.clone(z));z=this.Nb.Wb(4);z.Sa(a);a.wN=n;z.dispose()}}}}else k.ULS.sendTraceTag(537997912,3022,15,"Table node should not be null")}get r0(){null==this.i2&&(l.AFrameworkApplication.Yi("he991617;3eed2178"),this.i2=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.i2}FMe(){return!Dd.GraphIterator.ua(this.oua).Rc()}yOi(){return this.fPf?1===Dd.GraphIterator.ua(this.oua).Sr():!1}Gvi(a){try{return this.pwl(a)}catch(d){return k.ULS.sendTraceTag(23643968,
307,10,"GetCopySourceFromDOMTree failed with exception:{0}",d.message),0}}pwl(a){let d=0;if(a&&(d=this.owl(a),!d&&a.childNodes))for(let n=0;n<a.childNodes.length&&!(d=this.Gvi(a.childNodes[n]));n++);return d}owl(a){if(1===a.nodeType&&a.getAttribute){a=(a.getAttribute("class")||"").split(" ");for(const d of a)if(d.startsWith(this.Dmk))return d.startsWith(this.$bd)?this.pl&&d===this.$bd+this.pl?3:2:1}return 0}HUm(a,d,n,z,O){O.$u||(O.$u={});$f.ka.raiseEvent("OnParagraphCopy",new tw(a,d,n,z,O.$u))}gVm(a,
d,n,z){z.$u||(z.$u={});$f.ka.raiseEvent("OnCopyComplete",new tw(a,null,d,n,z.$u))}tUm(a){a.$u||(a.$u={});$f.ka.raiseEvent("BeforePaste",new Zq(a.$u))}sVm(a,d,n,z,O){$f.ka.raiseEvent("OnParagraphPaste",new tw(a,d,n,z,O.$u))}dli(a){Sf.TableCellReader.isTableCell(a)&&(a.Va(1)||this.Cq.I6(a,!0),a.hb())}eli(a,d){this.U$.Dga(d)&&(d.width=a.width)}static SCf(a){$f.ka.addHandler("OnParagraphCopy",a)}static Gie(a){$f.ka.addHandler("OnParagraphPaste",a)}static V7m(a){$f.ka.removeHandler("OnParagraphPaste",
a)}static pyk(a){$f.ka.addHandler("OnCopyComplete",a)}static Gxk(a){$f.ka.addHandler("BeforePaste",a)}static H7m(a){$f.ka.removeHandler("BeforePaste",a)}static Hxk(a){$f.ka.addHandler("BeforeTrimOnCopy",a)}static Dxk(a){$f.ka.addHandler("AfterTrimCompleteOnCopy",a)}static get characterPropertiesEditor(){return $f.hc||($f.hc=la.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get VH(){return wA.a.instance}static get yc(){return mi.PageReader.instance}static gdl(a){const d={};for(const n of Eo.a(a)){const z=
a[n];d[z]=z in d?String.format("{0}|{1}",d[z],n):n}1<=Eo.a(d).length&&k.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",d)}static z1m(a,d,n,z,O,ca){d.colSpan>O-n&&(ca&&ca("A",d.colSpan,O-n),d.colSpan=O-n);a=$f.Bwn(a,d,z,n);d.colSpan!==a&&(ca&&ca("B",d.colSpan,a),d.colSpan=a)}static A1m(a,d,n,z,O,ca){d.rowSpan>O-n&&(ca&&ca("A",d.rowSpan,O-n),d.rowSpan=O-n);a=$f.Cwn(a,d,n,z);d.rowSpan!==a&&(ca&&ca("B",d.rowSpan,a),d.rowSpan=a)}static Bwn(a,d,n,z){return $f.tDj(a,d.colSpan,(O,ca)=>
{Uf.moveToCell(O,n,z+ca)})}static Cwn(a,d,n,z){return $f.tDj(a,d.rowSpan,(O,ca)=>{Uf.moveToCell(O,n+ca,z)})}static tDj(a,d,n){if(14!==a.type)throw Error.argument("tableNode is not a Table.");if(!n)throw Error.argumentNull("MoveToCellAction");for(let O=1;O<d;O++){var z=Dd.GraphIterator.ua(a);n(z,O);z=z.currentNode;if(!z||16!==z.type||!z.we)return O}return d}static y9h(a,d){return a+","+d}DPm(a,d){for(;a.target.Rc();)a.target.wg();a.ZTc=new Bo.a(d,a.Ydj?a.Ydj:Object(m.a)(this,this.Hmd,"corePasteSetup"),
new Gq.a(a.source,a.target,null,a.HKg));a.ZTc.Pj("ExecuteCorePasteCellContentInCell");a.ZTc.Ce=!1;a.ZTc.run()}bym(a){let d=!1;if(this.r0){const n=Vr.a(a.target),z=km.a.hm(a.target),O=Math.min(this.e1e,a.fkd[a.fkd.length-1][0]),ca=Math.min(this.b$g,a.fkd[a.fkd.length-1][1]);Sf.TableCellReader.UAa(a.target)||Sf.TableCellReader.UAa(a.source)||z==O&&n==ca?d=!0:(Sf.TableCellReader.isTableCell(a.target)||a.target.tc(16),Sf.TableCellReader.Yba(a.source)?(Sf.TableCellReader.UAa(a.target)||(Uf.moveToNextRow(a.target),
Uf.moveToColumnByIndex(a.target,a.Yp),k.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")),Uf.moveToNextOrPreviousCell(a.source,!1,!1)):Sf.TableCellReader.Yba(a.target)||n==ca?(Uf.moveToNextRow(a.source),Uf.moveToColumnByIndex(a.source,0),k.ULS.sendTraceTag(537519906,307,50,"Move to next row to replace cell contents"),Uf.moveToNextRow(a.target),Uf.moveToColumnByIndex(a.target,a.Yp),k.ULS.sendTraceTag(537519907,307,50,"Move to next row to replace cell contents")):(Uf.moveToNextOrPreviousCell(a.target,
!1,!1),Uf.moveToNextOrPreviousCell(a.source,!1,!1)))}else Sf.TableCellReader.UAa(a.source)?d=!0:(Sf.TableCellReader.isTableCell(a.target)||a.target.tc(16),Sf.TableCellReader.Yba(a.source)?(Uf.moveToNextRow(a.target),Uf.moveToColumnByIndex(a.target,a.Yp),k.ULS.sendTraceTag(537716887,307,50,"Move to next row to replace cell contents")):Uf.moveToNextOrPreviousCell(a.target,!1,!1),Uf.moveToNextOrPreviousCell(a.source,!1,!1));d&&(this.V5&&this.V5.pVm(a.target,a.fkd),If.TableReader.isTable(a.target)||a.target.tc(14),
this.aAm(a.target.currentNode),k.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"));return d}Bfm(){const a=Yr.TableBorderSelectionCache.$0.cG,d=Yr.TableBorderSelectionCache.$0.vH;return Yr.TableBorderSelectionCache.$0.nP==Yr.TableBorderSelectionCache.$0.tT&&a==d?!0:!1}}$f.ka=new oc.a;$f.hc=null;$f.Ki=null;$f.zig="PasteConstrainingWidth";Object(t.a)($f,"InternalClipboard",null,[]);var K=b(598);class Z extends Pl{constructor(a,d,n,z,O,ca,Da,Xa){super(a,d,n,O,ca,Xa);this.zC=z;this.aN=
Da}get tm(){return this.aN.value}get FMe(){return this.zC.FMe()}get cej(){const a=this.zC;return a.fPf&&!a.yOi()}$li(a,d){k.ULS.shipAssertTag(6305616,307,qh.OutlineReader.yq(a));const n=K.a(a.currentNode);if(qh.OutlineReader.isEmpty(a)){var z=fe.a.create(a.currentNode);a.Rn(8);l.AFrameworkApplication.pa.rf(z,Mb.a.iK,2,!0,null,null)}else a.Rn(8);(z=a.Ht(1))&&a.hb();this.zC.Vdj(this.rj.Tc,a.currentNode,z,-1,n,d)}Zli(a){const d=new Dd.GraphIterator;this.O7a.restore(d);k.ULS.shipAssertTag(6305618,307,
Ia.OutlineElementReader.gg(d));this.rj.OY&&this.rj.OY.Wyc("internal");let n=-1;if(this.UAj&&Object(Uc.a)(90,this.rj.$c))n=this.rj.$c.fa(bd.a.Mfa,-1);else{const z=this.rxl(d.currentNode);n=z?z.clientWidth:n}this.zC.Vdj(this.rj.Tc,d.parentNode,d.currentNode,n,null,a);this.LSi&&(this.O7a.restore(d),Ia.OutlineElementReader.gg(d)&&this.zC.XUi(d)&&(a=qe.OutlineElementNavigator.Sd(d)))&&(this.rj.OEb=ye.SelectionFactory.Pc(a,0))}rxl(a){return a?(a=a?a.Qd(this.tm.Za):null)?a.htmlElement:null:null}HBj(){const a=
new Dd.GraphIterator;this.O7a.restore(a);return this.zC.XUi(a)}get fBj(){return Bf.ListReader.Jq}get eVd(){return!this.zC.m7&&!this.zC.fPf}}Object(t.a)(Z,"InternalPasteExecutionManager",Pl,[]);class oa{constructor(a,d,n,z){this.zC=a;this.V5=d;this.aN=n;this.oea=z}create(a,d,n){return new Z(a,d,n,this.zC,this.V5,Lb.App.oa.za,this.aN,this.oea)}}Object(t.a)(oa,"Factory",null,[471]);var Wa;(function(a){a[a.unknown=0]="unknown";a[a.differentBox4App=1]="differentBox4App";a[a.sameBox4AppDifferentSession=
2]="sameBox4AppDifferentSession";a[a.sameBox4AppSameSession=3]="sameBox4AppSameSession"})(Wa||(Wa={}));Object(t.b)("CopySource",Wa);class rb{constructor(a,d,n){this.zC=a;this.nAh=d;this.M8j=n}CPm(a,d,n){k.ULS.shipAssertTag(6305620,307,!!a);k.ULS.shipAssertTag(6305621,307,Qd.SelectionEditor.Cd(d));k.ULS.shipAssertTag(6305622,307,!!n);k.ULS.shipAssertTag(6305623,307,Object(Uc.a)(by.a,n.S4));const z=n.S4;z.DBc=this.zC.Gvi(a);this.aom(a,z);const O=this.Mbm(z);var ca=new Ff.GraphTransaction(7,Mb.a.paste);
ca.Sa(d.node);d.node.dD().uE.cfa(8);O?(k.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",z.aE,z.browserName),a=this.nAh.create(d,z,ca)):(k.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",z.aE,z.DBc,z.browserName),rb.Vnm(a),a=this.M8j.create(a,d,z,ca));n=new Bo.a(n,Object(m.a)(a,a.$dj,"pasteSetup"),null);n.Pj("Paste");n.run()}Mbm(a){return!this.Idm(a)&&3===a.DBc}Idm(a){return 1===(a.aE&8192?1:0)}DOi(a,d){k.ULS.shipAssertTag(6305624,307,
Qd.SelectionEditor.Cd(a));k.ULS.shipAssertTag(6305625,307,!!d);k.ULS.shipAssertTag(6305626,307,Object(Uc.a)(by.a,d.S4));const n=new Ff.GraphTransaction(7,Mb.a.UAd);n.Sa(a.node);a=this.nAh.create(a,d.S4,n);d=new Bo.a(d,Object(m.a)(a,a.$dj,"pasteSetup"),null);d.Pj("InternalPasteAtIp");d.run()}aom(a,d){if(a){let n=!1,z=!1;a.innerHTML&&0<=a.innerHTML.indexOf("mso-tab-count")?z=!0:a.innerText&&0<=a.innerText.indexOf("\t")&&(n=!0);(n||z)&&k.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",
Wa[d.DBc],n,z)}}static Vnm(a){a&&rb.gsk.test(a.innerText)&&k.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}rb.gsk=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(t.a)(rb,"PasteCoordinator",null,[]);class Ub{constructor(a,d,n,z,O){this.IHa=a;this.BIb=d;this.QPm=n;this.PPm=z;this.mog=O}}Object(t.a)(Ub,"PastedContentsPostProcessorParams",null,[]);class qc{T3l(a,d,n,z,O,ca){a=this.nAl(a,d,O);n=this.eEl(n);
if(!a||!n)return null;z=this.$Jl(a,z,O);O=this.ZJl(n);return new Ub(a,n,z,O,ca)}nAl(a,d,n){a=n?a:d;if(!Ia.OutlineElementReader.gg(a))return null;d=new Pi.a;d.Cb(a);return d}eEl(a){if(!Ia.OutlineElementReader.gg(a))return null;const d=new Pi.a;d.Cb(a);qe.OutlineElementNavigator.D0(d,!1,!1);return d}$Jl(a,d,n){qe.OutlineElementNavigator.Sd(a);let z=-1;Bd.ParagraphReader.Zf(a)&&(z=n?d:0);qe.OutlineElementNavigator.Uc(a);return z}ZJl(a){qe.OutlineElementNavigator.Sd(a);const d=Bd.ParagraphReader.Zf(a)?
Bd.ParagraphReader.textLength(a.currentNode):-1;qe.OutlineElementNavigator.Uc(a);return d}}Object(t.a)(qc,"PastedContentsPostProcessorHelper",null,[]);var $c=b(569),wd=b(958),ke=b(957);class se{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb){this.Ybf=null;this.Cjf=!1;this.Mbe=null;this.P9d=this.C0a=!1;this.HFa=a;this.wA=d;this.ic=n;this.Cvc=z;this.vh=O;this.NYb=ca;this.va=Da;this.djk=Xa;this.Jz=zb;this.qea=Vb;this.Wyn()}Wyn(){this.wA.IWh(Object(m.a)(this,this.Sun,"showFloatieHandler"));this.wA.jWh(Object(m.a)(this,
this.Yml,"floatieDismissedHandler"))}S0k(a,d){this.NYb.olg();1===this.djk.d1k(d.YLd)?k.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",d.correlationId):this.showFloatie(a,d)?(this.C0a?this.C0a=!1:this.T4m(),this.TPd(),a="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",Mb.a.EI(d.Q0)||"Unknown",d.correlationId),k.ULS.sendTraceTag(40379588,307,50,a),this.uVc()):k.ULS.sendTraceTag(575255108,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",
d.correlationId)}OA(a){this.Cjf||!this.HFa.PIa()&&!this.C0a||(a&&(this.NYb.olg(),this.YMj(),k.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.Mbe)),this.C0a=!a,this.i3e(),this.HFa.OA())}T4m(){this.P9d||(this.Ybf=this.ic.sc,Qc.a.addHandler(this.Ybf.container,"scroll",Object(m.a)(this,this.tkc,"scrollHandler")),this.vh.sU(Object(m.a)(this,this.B8,"resizeHandler")),this.P9d=!0)}YMj(){this.P9d&&(Qc.a.removeHandler(this.Ybf.container,"scroll",
Object(m.a)(this,this.tkc,"scrollHandler")),this.vh.c5(Object(m.a)(this,this.B8,"resizeHandler")),this.P9d=!1)}uVc(){const a=new ke.a(0,l.AFrameworkApplication.isRtl);a.location=this.NYb.FFb();this.NYb.yam(a.location)?this.showFloatie(null,a):this.wA.iXa(new wd.a(!1))}B8(){this.uVc()}tkc(){this.uVc()}Yml(a,d){this.OA(d.Ujl)}Sun(a,d){this.S0k(a,d)}TPd(){this.Cvc.xWh(Object(m.a)(this,this.F$i,"onOnlyKeyPressed"));this.wA.oWh(Object(m.a)(this.HFa,this.HFa.Ate,"expandFloatie"));this.wA.BWh(Object(m.a)(this,
this.aej,"pastedFloatieStatusChange"));this.Jz.Rt(Object(m.a)(this,this.ita,"onParagraphConnect"));this.Jz.vy(Object(m.a)(this,this.Igc,"onParagraphDisconnected"));this.Jz.tq(Object(m.a)(this,this.jta,"onParagraphPropertyChanged"))}i3e(){this.Cvc.Joj(Object(m.a)(this,this.F$i,"onOnlyKeyPressed"));this.wA.Foj(Object(m.a)(this.HFa,this.HFa.Ate,"expandFloatie"));this.wA.Moj(Object(m.a)(this,this.aej,"pastedFloatieStatusChange"));this.Jz.wQ(Object(m.a)(this,this.ita,"onParagraphConnect"));this.Jz.Hta(Object(m.a)(this,
this.Igc,"onParagraphDisconnected"));this.Jz.W0(Object(m.a)(this,this.jta,"onParagraphPropertyChanged"))}aej(a,d){this.Cjf=d.Cog;d.Q0&&(this.Mbe=d.Q0);d.QBj&&this.HFa.PIa()&&this.uVc()}jta(a,d){d.property===Vd.a.lastModifiedTime&&(this.qea.Xpe.contains(Mb.a.H3e)||this.JQg(d))}Igc(a,d){this.JQg(d)}ita(a,d){d.jFe||this.JQg(d)}JQg(a){a.node.loading||this.wA.iXa(new wd.a(!0))}showFloatie(a,d){d||(d=new ke.a(0,l.AFrameworkApplication.isRtl));d.location||(d.location=this.NYb.FFb());if(!d.location)return!1;
this.C0a&&(this.C0a=!1,this.TPd());this.HFa.showFloatie(a,d);return!0}F$i(){$c.a.instance.keyCode===xb.a.f9&&this.wA.Oij()}}Object(t.a)(se,"PasteFloatieEventManager",null,[]);class xf{constructor(a,d){this.xk=a;this.Uu=d}d1k(a){return sg.any(sg.where(sg.asEnumerable(xf.UAn),d=>this.Uu.pEd(d)))?(a=this.xk.DKb(a))&&(a=a.innerText)&&0<a.trim().length?0:1:1}}xf.UAn=[Mb.a.reformatPastedContent.toString(),Mb.a.ILb.toString()];Object(t.a)(xf,"PasteFloatieFeatureSetBuilder",null,[]);class Vh{constructor(){this.gKa=
null;this.POc=0}}Object(t.a)(Vh,"PasteFloatieAnchorData",null,[]);class ki{constructor(a,d,n,z,O){this.MYb=null;this.Da=a;this.JG=d;this.ic=n;this.k$j=z;this.HFa=O}olg(){this.MYb=null}FFb(){const a=this.z8f(this.MYb)||this.L3h();if(!a){let d="null",n="null";if(this.MYb&&this.MYb.gKa){if(!this.ic.sc)return k.ULS.sendTraceTag(51143187,307,15,"SelectoinView is null when we try to get floatie position"),null;d=Object.getType(this.MYb.gKa).getName();const z=this.MYb.gKa.Mh(this.ic.sc.Za);z&&(n=Object.getType(z).getName())}k.ULS.shipAssertTag(40641054,
307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",d,n)}return a}yam(a){if(!a)return!1;const d=this.HFa.r9b(),n=this.k$j(this.ic.sc.container);a=new Sys.UI.Bounds(a.x,a.y,d.width,d.height);return a.y>=n.y&&a.y+a.height<=n.y+n.height}L3h(){if(!this.Da||!this.Da.ya||!this.Da.ya.Ba)return k.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),null;var a=this.Da.ya.Ba.ra,d=!a.cpBegin&&!a.cpEnd;let n=a.node;if(n&&d){do n=this.sCi(n);
while(n&&Object(Uc.a)(Vi.AParagraphNode,n)&&!n.characterData.trim().length)}let z="";const O=Object(qa.a)(Vi.AParagraphNode,n);O&&(z=O.characterData.length===a.cpBegin||d?O.characterData.trimEnd():O.characterData.substring(0,a.cpBegin).trimEnd());d=O?z.length:a.cpBegin;a=Object.assign(new Vh,{gKa:Object(qa.a)(139,(O?Object(qa.a)(139,O):Object(qa.a)(139,n))||a.node),POc:d});return this.z8f(a)}sCi(a){const d=new Dd.GraphIterator;if(!a.anchor)return null;d.set(a);if(!d.kc())return null;d.tc(11);return d.lx()?
d.Va(2):null}z8f(a){if(!a||!a.gKa)return null;this.MYb=a;const d=this.ic.sc;if(!d)return k.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;a=this.oyi(a,d);if(!a)return null;l.AFrameworkApplication.isRtl&&this.HFa.PIa()&&(a.x-=this.HFa.r9b().width);return new Sys.UI.Point(a.x+a.width,a.y+a.height)}oyi(a,d){d=Object(qa.a)(204,a.gKa.Mh(d.Za));if(!d)return null;let n=null;if(Object(Uc.a)(Vi.AParagraphNode,a.gKa)){const z=Object(qa.a)(92,d);if(!z)return null;
try{n=this.JG.oP(a.POc,z,0<a.POc,!1,!1,!1),n.height+=ki.anl}catch(O){k.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",O),n=null}}else Object(Uc.a)(Zi.TableNode,a.gKa)&&(n=Object(qa.a)(153,d).UEi());n||(n=d.getBounds());return n}}ki.anl=2;Object(t.a)(ki,"PasteFloatiePositionProvider",null,[]);class dj{constructor(a,d){this.T_c=a;this.a5j=d}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get Yqi(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get eUf(){return CommonUIStrings.l_ClipboardCut}get Iyg(){return CommonUIStrings.l_ClipboardCut_Mac}get hQf(){return CommonUIStrings.l_ClipboardCopy}get Hyg(){return CommonUIStrings.l_ClipboardCopy_Mac}get cMg(){return CommonUIStrings.l_ClipboardPaste}get Jyg(){return CommonUIStrings.l_ClipboardPaste_Mac}get Jna(){return CommonUIStrings.l_ClipboardPasteText}get Kyg(){return CommonUIStrings.l_ClipboardPasteText_Mac}get GMf(){return this.a5j}get H7h(){return CommonUIStrings.l_ClipboardExtensionLink}get WCb(){return CommonUIStrings.l_ClipboardExtensionSuggestion}umi(){k.ULS.sendTraceTag(8716421,
307,50,null);Ye.a.Tk(this.GMf,"_blank",void 0,"ClipboardAccessExtensionLink")}Wna(a,d){let n=I.a.Pi;l.AFrameworkApplication.K.ea("CcpFixIPadShortcutStringsIsEnabled")&&(n=I.a.tg||n);return n?String.format(d,"\u2318"):a}dispose(){this.T_c=null}cRg(a){this.Pai(a)}qkm(a){this.Pai(a)}Pai(a){this.T_c&&this.T_c(a)}}dj.id="CopyPasteShortcutDialog";dj.tIj="CopyPasteText";Object(t.a)(dj,"ACopyPasteShortcutDialog",null,[12]);class uj extends dj{constructor(a,d,n){super(a,d);a=document.createElement("span");
a.className="WACCopyPasteShortcutDialogTextPanel";d=document.createElement("span");d.id=dj.tIj;var z=document.createElement("span");z.innerText=this.Yqi;var O=document.createElement("span");O.className="UIFontBold";O.innerText=this.Wna(this.eUf,this.Iyg);const ca=document.createElement("span");ca.className="UIFontBold";ca.innerText=this.Wna(this.hQf,this.Hyg);const Da=document.createElement("span");Da.className="UIFontBold";Da.innerText=this.Wna(this.cMg,this.Jyg);d.appendChild(z);d.appendChild(document.createElement("br"));
d.appendChild(O);d.appendChild(ca);d.appendChild(Da);n.ea("PasteTextOnlyShortcutDialogIsEnabled")&&(I.a.el||I.a.Og)&&(n=document.createElement("span"),n.className="UIFontBold",n.innerText=this.Wna(this.Jna,this.Kyg),d.appendChild(n));a.appendChild(d);this.GMf?(k.ULS.sendTraceTag(8716420,307,50,null),n=document.createElement("span"),d=document.createElement("a"),d.href="#",d.innerText=this.H7h,Qc.a.addHandler(d,"click",Object(m.a)(this,this.umi,"extensionLinkHandler")),n.appendChild(d),O=this.WCb.indexOf("{0}"),
-1!==O&&(z=this.WCb.substring(0,O),O=this.WCb.substring(O+3,this.WCb.length),z=document.createTextNode(z),O=document.createTextNode(O),n.insertBefore(z,d),n.appendChild(O)),a.appendChild(document.createElement("br")),a.appendChild(n)):k.ULS.sendTraceTag(8716422,307,50,null);n=new $g.StandardDialog;n.wc=0;n.Je=dj.id;n.iu(this.titleText,null,0,Object(m.a)(this,this.qkm,"legacyCopyPasteShortcutDialogHandler"),a);n.k5(dj.tIj)}}Object(t.a)(uj,"CopyPasteShortcutDialog",dj,[]);class rn extends dj{constructor(a,
d){super(a,d);d={};a=this.E6l;d.extensionStartText=this.Vhl;d.extensionLink=null;d.extensionEndText=null;d.shortcutsMessageText=this.Kqn;d.cutText=this.Wna(this.eUf,this.Iyg);d.copyText=this.Wna(this.hQf,this.Hyg);d.pasteText=this.Wna(this.cMg,this.Jyg);4!==l.AFrameworkApplication.la.eb.Bm&&(d.pasteTextOnly=this.Wna(this.Jna,this.Kyg));d={["id"]:"CopyPasteInstallDialog",["bodyControls"]:d};const n=new xg.a(!1,!1,!0);n.Je="CopyPasteInstallDialog";n.wc=0;n.ee(1,this.D6l);n.j5(1);n.Ih(a,Object(m.a)(this,
this.cRg,"reactCopyPasteShortcutDialogHandler"),d)}get Kqn(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get D6l(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get E6l(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get Vhl(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static Ptn(){var a=window.location.origin;return a?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(a):!1}}Object(t.a)(rn,"ReactCopyPasteInstallDialog",dj,[]);class mq extends dj{constructor(a){super(a,null);this.tXi="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var d={};a=this.xzm;var n="";let z="";this.messageText&&(n=this.messageText.split(" {")[0],z=this.messageText.split("} ")[1]);d.startText=n;d.endText=z;d.cutText=this.C6k;d.copyText=this.ZYk;d.pasteText=this.HPm;
d.cutShortcutText=this.Wna(this.D6k,this.Tsm);d.copyShortcutText=this.Wna(this.iZk,this.Ssm);d.pasteShortcutText=this.Wna(this.KPm,this.Vsm);d.imageSrc=Xi.a.A3("NoClipboardAccessDialogImage.svg");d.imageAltText=this.imageAltText;d.primaryButtonLabel=this.WTm;this.tXi&&(k.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),d.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.JIb,["onExecute"]:()=>{this.lkm()}});d={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:d};
n=new xg.a(!1,!1,!0);n.wc=0;n.Je="CopyPasteNoClipboardAccessDialog";n.Ih(a,Object(m.a)(this,this.cRg,"reactCopyPasteShortcutDialogHandler"),d)}get xzm(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get JIb(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get WTm(){return CommonUIStrings.l_DialogOk}get C6k(){return CommonUIStrings.l_CutString}get D6k(){return CommonUIStrings.l_CutShortcut}get Tsm(){return CommonUIStrings.l_CutShortcut_Mac}get ZYk(){return CommonUIStrings.l_CopyString}get iZk(){return CommonUIStrings.l_CopyShortcut}get Ssm(){return CommonUIStrings.l_CopyShortcut_Mac}get HPm(){return CommonUIStrings.l_PasteString}get KPm(){return CommonUIStrings.l_PasteShortcut}get Vsm(){return CommonUIStrings.l_PasteShortcut_Mac}lkm(){k.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Ye.a.Tk(this.tXi,"_blank",void 0,"learnMoreLink")}}Object(t.a)(mq,"ReactCopyPasteNoClipboardAccessDialog",dj,[]);class cs extends dj{constructor(a,d,n){super(a,d);a={};a.forwardElementText=this.Yqi;a.cutText=this.Wna(this.eUf,this.Iyg);a.copyText=this.Wna(this.hQf,this.Hyg);a.pasteText=this.Wna(this.cMg,this.Jyg);n.ea("PasteTextOnlyShortcutDialogIsEnabled")&&(I.a.el||I.a.Og)&&(a.pasteTextOnly=this.Wna(this.Jna,this.Kyg));this.GMf?(k.ULS.sendTraceTag(40726914,307,
50,null),a.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.H7h,["onExecute"]:z=>{this.umi(z)}},n=this.WCb.indexOf("{0}"),-1!==n&&(a.suggestionPrefixElement=this.WCb.substring(0,n),a.suggestionSuffixElement=this.WCb.substring(n+3,this.WCb.length))):k.ULS.sendTraceTag(40726915,307,50,null);n={["id"]:dj.id,["bodyControls"]:a};a=new xg.a(!1,!1,!0);a.wc=0;a.Je=dj.id;a.Ih(this.titleText,Object(m.a)(this,this.cRg,"reactCopyPasteShortcutDialogHandler"),n)}}Object(t.a)(cs,"ReactCopyPasteShortcutDialog",
dj,[]);class qk{constructor(){this.sFa=!!l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.wz}WQf(a,d,n=!1){k.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.sFa,n));this.sFa?n?new rn(a,d):new cs(a,d,l.AFrameworkApplication.K):new uj(a,d,l.AFrameworkApplication.K)}static get instance(){return qk.na||(qk.na=new qk)}}qk.na=null;Object(t.a)(qk,"CopyPasteShortcutDialogFactory",null,[985]);class Ru{constructor(a,d,n,z,O,ca,Da,Xa){this.NNh=
this.CBh=this.Nvf=!1;this.vfe=a;this.ic=d;this.xs=n;this.ib=z;this.ld=O;this.fg=ca;this.rd=Da;Xa&&(this.NNh=Xa.ea("ShouldLogExecCommandCopySuccess"))}get D9a(){return this.vfe}get Pob(){return this.CBh}set Pob(a){this.CBh=a;this.fg.ignoreClipboardEvents=a}wqd(a){this.D9a.wqd(a);a||this.eYd(!0)}get Vfl(){return this.D9a.rXg}prepareForPaste(a){this.Pob=!0;this.D9a.prepareForPaste(a,this.Z9g)}reset(){this.Pob=!1}paste(){var a=null;let d=null;if(!this.D9a.upc){(a=this.ic.sc)&&this.ib.wf(a.qE);var n=this.xs.tw;
if(!n.Yd||!n.editingView.uk)return null;d=n.editingView;a=this.ld.Eq();this.Pob=!0;n.Gda()}n=null;try{d&&d.XSm(),n=a=this.D9a.Rqd(this.Z9g,a)}catch(z){k.ULS.shipAssertTag(6305672,307,!1),this.XHi()}this.Pob=!1;return n}copy(){var a=this.ic.sc;a&&this.ib.wf(a.qE);a=this.xs.tw;if(!a.Yd||1!==a.editingView.mode)return!1;this.Pob=!0;let d;try{const n=new Map;n.set("View","ContentEditableView");ja.Health.instance.recordKpiUsage(Kn.a.eme,0,Kn.a.QKf,n);const z=this.D9a.f0f(this.Z9g);d=!0;this.NNh&&k.ULS.sendTraceTag(558384097,
307,50,"execCommandCopySuccess, {0}, browser: {1}",z,this.rd.qI);if(!z){const O=Object.assign(new Sg.a,{extendedProperties:n});ja.Health.instance.recordKpiFailure(Kn.a.eme,Kn.a.p5h,!0,!0,O)}}catch(n){k.ULS.shipAssertTag(6305673,307,I.a.Og),k.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",I.a.qI),d=!1}this.Pob=!1;return d?!0:!1}eYd(){if(this.Nvf)return!0;var a=this.xs.tw;if(!a.Yd||!a.editingView.uk)return!1;const d=a.editingView;a=this.ld.Eq();
this.Pob=!0;const n=new Wq.a(a);let z=!1;try{z=this.D9a.eYd(a,()=>{d.Xme()},()=>{d.GKa()})}catch(O){k.ULS.shipAssertTag(6305674,307,!I.a.Ah)}n.restore();this.Pob=!1;z?this.Nvf=!0:(k.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",I.a.qI),I.a.Ah||this.XHi());return z}XHi(){this.Nvf=!1;if(l.AFrameworkApplication.mSj)qk.instance.WQf(null,null);else{const a=new $g.StandardDialog;a.wc=0;a.kT(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,
null)}}get Z9g(){const a=this.ld.G4a();return a?a.Lo:null}}Object(t.a)(Ru,"SystemClipboard",null,[469]);class Gr{constructor(a,d,n){this.Tge=!1;this.nhe=this.TZ=this.wDh=this.uaf=this.V3d=null;this.iaf=a.ea("ChromeClipboardAccessExtensionSuggestionIsEnabled");this.sgf=a.Ga("ChromeClipboardAccessExtensionLink");this.uyb=d;this.xk=n;this.Kof=a.Ga("ChromeClipboardAccessExtensionId");this.qrk=a.ea("UseGetClipboardDataIsEnabled");this.XKh=a.ea("RecordExtensionInstallStatusKpiIsEnabled");this.Exc=!1;a.ea("CcpInstallDialogIsEnabled")&&
l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.wz&&(this.Exc=rn.Ptn()||a.ea("IgnoreDomainCheckCcpInstallDialog"),k.ULS.sendTraceTag(587314304,307,50,"_useInstallDialog: {0}",this.Exc));this.f1c=null}wqd(a){a?this.TZ=!0:(this.TZ=null,chrome.runtime&&chrome.runtime.sendMessage?(this.f1c=this.uyb.cqe,this.uyb.DNb?(this.Tge=this.qrk,this.f6h()):(this.Tge=!0,this.f6h(),k.ULS.sendTraceTag(19256732,307,50,E.a.create().toString()))):(this.omc(),this.TZ=!1))}get rXg(){return this.TZ}get upc(){return this.nhe}eYd(){return!0}f0f(a){k.ULS.sendTraceTag(24402115,
307,50,"Execute chrome copy");(a=Ye.a.AEb(a,"copy"))||k.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)));return a}t6f(a){if(!a)return null;var d=a.img;const n=a.text;a=a.html;const z=this.xk.vuj(!!d,!!n,a);let O=null;if(3===z){if(!a)return null;d=this.xk.Cmi(a);(d=this.xk.Jmi(d))&&(a+=d);O=this.xk.DKb(a)}else 2===z?O=this.xk.VLg(n,!0):1===z&&(O=this.xk.DKb(d));return O}Rqd(a,d){if(this.upc)d=this.t6f(this.uaf),
this.uaf=null;else{if(!this.V3d)return d;a=document.implementation.createHTMLDocument("doc");a.body.innerHTML=this.V3d;d=a.body;this.V3d=null}return d}prepareForPaste(a){const d=E.a.create();this.wDh=d;this.uyb.DNb?k.ULS.sendTraceTag(7377737,307,50,d.toString()):k.ULS.sendTraceTag(19256735,307,50,d.toString());const n={};n.command=this.upc?"getClipboardData":"paste";chrome.runtime.sendMessage(this.f1c,n,z=>{d.equals(this.wDh)?this.upc?this.uaf=z:this.V3d=z:k.ULS.sendTraceTag(7385868,307,50,null);
k.ULS.sendTraceTag(7377738,307,50,d.toString());chrome.runtime.lastError&&(this.bdl(),this.uyb.DNb?k.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):k.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message));a()})}omc(){k.ULS.sendTraceTag(8716423,307,50,null);let a=null;this.Exc?a=this.sgf+this.Kof:this.iaf&&(a=this.sgf+this.f1c);qk.instance.WQf(Object(m.a)(this,this.PRm,"popupInstallDialogHandler"),a,this.Exc)}PRm(a){1===a?(k.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",
this.iaf)),this.Exc&&(k.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.Exc)),Ye.a.Tk(this.sgf+this.Kof,"_blank",void 0,"ChromeCCPInstallDialog"))):a||k.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.iaf))}bdl(){this.uyb.xan();this.omc()}ovj(a,d){chrome.runtime.sendMessage(a,{command:"test",object:"ping"},d)}IPk(){const a=E.a.create();this.uyb.DNb?k.ULS.sendTraceTag(592491466,307,50,a.toString()):k.ULS.sendTraceTag(591984031,307,50,a.toString());
chrome.runtime.sendMessage(this.f1c,{command:"getAvailableCommands"},d=>{k.ULS.sendTraceTag(592491467,307,50,a.toString());d?Object(Uc.a)(Array,d)?(k.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",d),this.nhe=-1!==Array.indexOf(d,"getClipboardData")):(k.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",d),this.nhe=!1):(k.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:
null),this.nhe=!1)})}f6h(){const a=E.a.create();this.uyb.DNb?k.ULS.sendTraceTag(7726105,307,50,a.toString()):k.ULS.sendTraceTag(591984032,307,50,a.toString());this.Tge&&this.IPk();this.ovj(this.f1c,d=>{k.ULS.sendTraceTag(7726106,307,50,a.toString());d&&"ping"===d?this.TZ=!0:(d?"ping"!==d&&k.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",d,chrome.runtime.lastError?chrome.runtime.lastError.message:null):k.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",
chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.omc(),this.TZ=!1);this.Tge&&!this.upc&&k.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}y0i(a,d){const n={};n.OfficeOnlineExtensionInstallationStatus=a;n.OfficeClipboardExtensionInstallationStatus=d;k.ULS.sendTraceTag(51144839,307,50,JSON.stringify(n));this.XKh&&(a&&ja.Health.instance.recordKpiSuccess(Gr.iHh,null),d&&ja.Health.instance.recordKpiSuccess(Gr.gHh,null))}anm(){this.XKh&&(ja.Health.instance.recordKpiUsage(Gr.iHh,
1,Gr.yvh,null),ja.Health.instance.recordKpiUsage(Gr.gHh,1,Gr.yvh,null));if(chrome.runtime&&chrome.runtime.sendMessage){var a=!this.uyb.DNb;this.ovj(this.Kof,d=>{this.y0i(a,!!d)})}else this.y0i(!1,!1)}}Gr.iHh="OfficeOnlineExtensionInstallationStatus";Gr.gHh="OfficeClipboardExtensionInstallationStatus";Gr.yvh="wwccp";Object(t.a)(Gr,"ChromeSystemClipboardAccessManager",null,[494]);class gu{constructor(a,d){this.TZ=null;this.rd=a;this.va=d;this.G3j=!this.va.ea("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&
this.va.ea("BlockCopyCutOnFirefoxIsEnabled");this.Lmk=d.ea("SetResultForEnsureAccessOperationForElectronIsEnabled")}wqd(a){this.G3j&&a&&this.rd.Og?(this.omc(),this.TZ=!1):this.TZ=!0}get rXg(){return this.TZ}get upc(){return!1}f0f(a){return Ye.a.AEb(a,"copy")}Rqd(a,d){Ye.a.AEb(a,"paste");return d}prepareForPaste(a){a()}eYd(a,d,n){if(this.rd.dV)return this.Lmk&&(this.TZ=!1),!1;d();n();a=this.Rqd(a.ownerDocument,a);d=a.innerHTML;a.innerHTML=xa.a.create().toString();n();a=this.Rqd(a.ownerDocument,a);
return this.TZ=a=d===a.innerHTML}omc(){qk.instance.WQf(null,null)}}Object(t.a)(gu,"DefaultSystemClipboardAccessManager",null,[494]);class Hv{constructor(a,d,n){this.TZ=this.pja=this.tvc=this.Awa=this.heb=this.R3d=null;this.xk=d;this.xeb=n;this.Afk=a.jb("ClipboardDataImageBlobLimitaton",10);a.ea("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.onk=a.ea("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}wqd(a){this.onk&&a&&(this.TZ=!0)}get rXg(){return this.TZ}get upc(){return!1}f0f(a){return a?
Ye.a.AEb(a,vb.a.copy):!1}Rqd(a,d){this.heb&&(d=this.heb,this.heb=null);return d}prepareForPaste(a,d=null){if(a&&d){this.R3d=a;this.tvc=d;$addHandler(this.tvc,vb.a.paste,Object(m.a)(this,this.Q$i,"onPasteEvent"));this.pja=this.Awa=null;if(this.VLj(this.tvc)){if(this.pja&&0<this.pja.length&&(!this.Awa||this.xk.b4e(this.Awa))){this.xeb.mai(this.pja,Object(m.a)(this,this.eGm,"onImageConverted"));this.heb&&!this.heb.hasChildNodes()&&k.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");
return}this.Awa&&this.Awa.innerHTML&&((this.heb=this.dLi(this.Awa.innerHTML))&&!this.heb.hasChildNodes()&&k.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),ae.a.HA(this.Awa))}this.Uoi()}else a&&a()}eYd(a){return this.TZ=a=this.VLj(a.ownerDocument)}Q$i(a){try{a&&a.rawEvent&&((this.Awa=a.rawEvent.target)&&this.Awa.id&&-1<this.Awa.id.indexOf("Paste")?(k.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this.Awa.id),this.Awa=null):this.pja=this.ACl(a.rawEvent))}catch(d){k.ULS.sendTraceTag(22073952,
307,15,"Exception while processing context menu paste event: "+d.toString())}}eGm(a){a&&(this.xeb.kBj&&(a=String.format('<img src="{0}">',a)),this.heb=this.dLi(a));this.Uoi()}Uoi(){this.tvc&&($removeHandler(this.tvc,vb.a.paste,Object(m.a)(this,this.Q$i,"onPasteEvent")),this.tvc=null);this.R3d&&(this.R3d(),this.R3d=null)}ACl(a){let d=null;(a=this.xk.Hui(a))&&({pig:d}=this.xk.DLj(a,this.Afk,this.xeb.u3i));return d}VLj(a){return Ye.a.AEb(a,vb.a.paste)}dLi(a){const d=document.implementation.createHTMLDocument("doc");
d.body.innerHTML=a;return d.body}omc(){}}Object(t.a)(Hv,"EdgeSystemClipboardAccessManager",null,[494]);class gp{constructor(a,d,n,z){this.va=a;this.T4j=d;this.xk=n;this.rd=z}create(){let a=null;l.AFrameworkApplication.fZe()&&this.rd.el&&window.chrome?(k.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),a=new Gr(this.va,this.T4j,this.xk),this.va.ea("LogChromeExtensionInstallationStatusIsEnabled")&&a.anm()):this.va.ea("EdgeContextMenuPasteFixIsEnabled")&&this.rd.xm?(k.ULS.sendTraceTag(22073953,
307,50,"EdgeSystemClipboardAccessManager"),a=new Hv(this.va,la.a.instance.resolve("Box4.IClipboardDataHelper"),la.a.instance.resolve("Box4.IProcessImageStrategy"),la.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(k.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),a=new gu(this.rd,this.va));return a}}Object(t.a)(gp,"SystemClipboardAccessManagerFactory",null,[470]);class iv{ahl(a){return a}}Object(t.a)(iv,"DeleteTableSegmentStrategy",null,[468]);
var $h=b(553),Dp=b(906);class Fo{constructor(){this.Ck=this.Ki=null}get dr(){return nt.a.P9b}get paragraphEditor(){return this.Ki||(this.Ki=la.a.instance.resolve("Box4.IParagraphEditor"))}get t8(){return this.paragraphEditor.dr}get Lb(){return Ch.a.instance}get tD(){return this.Ck||(this.Ck=la.a.instance.resolve("Box4.IParagraphIndentationReader"))}zhd(a,d,n,z,O,ca,Da){let Xa=2;if(!a.Yd)return 2;const zb=a.Oa;if(!zb)return this.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.Wga}),8;if(l.AFrameworkApplication.K.ea("Box4PartialPromoteDemoteIsEnabled")){a=
this.r4h(d===Mb.a.NK,n,!0);if(1===z)return a?32:8;a&&(Xa=Dp.a.ROc(d,n,z,O,ca,Da))}else Xa=Dp.a.ROc(d,n,1,O,ca,Da),1!==z&&32===Xa?(a.Oa.PKd(),a=new Ff.GraphTransaction(15),a.Sa(n.view.xc),Xa=this.r4h(d===Mb.a.NK,n,!1)?Dp.a.ROc(d,n,z,O,ca,Da):8,a.dispose()):1!==z&&8===Xa&&(a.Oa.PKd(),this.hWk(d,n,zb));return Xa}r4h(a,d,n){d=d.view.Oa;if(!d||!d.ya.Ba)return this.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.Bqb}),!1;if(d.ya.EE)return this.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.bmd}),!1;d=$h.OutlineElementGeneralizer.Kla(d.ya,
!1);if(!d)return this.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.jEc}),!1;let z=!1;for(let O=0;O<d.length;O++){const ca=d.getContext(O),Da=new Dd.GraphIterator;Da.set(ca.node);Qd.SelectionEditor.Vm(Da);if(!Ia.OutlineElementReader.gg(Da))if(n)continue;else return this.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.hra}),!1;if(a?!this.dr.f4b(Da):!this.dr.hAc(Da))if(n)continue;else return this.Lb.mb(Ee.a.S6b,{["Reason"]:Jf.a.Tjd}),!1;z=!0}return n?z:!0}hWk(a,d,n){const z=new Ff.GraphTransaction(15);try{z.Sa(d.view.xc);d=!0;const O=
$h.OutlineElementGeneralizer.Kla(n.ya,!1);for(let ca=0;ca<O.length;ca++){const Da=O.getContext(ca),Xa=new Dd.GraphIterator;Xa.set(Da.node);Qd.SelectionEditor.Vm(Xa);if(!Ia.OutlineElementReader.gg(Xa))d=!1;else if(a===Mb.a.NK?this.dr.f4b(Xa):this.dr.hAc(Xa))switch(d=!1,a){case Mb.a.NK:this.dr.yCa(Xa,-1,0);break;case Mb.a.JU:this.dr.Eod(Xa,1)}}if(d){const ca=n.ya.Ba;for(n=0;n<ca.length;n++){const Da=ca.J(n);if(Da.Cj){const Xa=this.tD.Jlb(Da.node),zb=Xa.uoa;if(a===Mb.a.NK?Xa.yE>zb:Xa.yE<18*zb){const Vb=
new Dd.GraphIterator;Vb.set(Da.node);this.t8.RKa(Vb,1,a===Mb.a.NK?Xa.yE>=2.5*zb?Xa.yE-2*zb:zb:Xa.yE<16*zb?Xa.yE+2*zb:18*zb)}}}}}finally{z&&z.dispose()}}}Object(t.a)(Fo,"IndentationActorExtension",null,[464]);var nx=b(675),Hr=b(1069);class Su{constructor(a,d){this.oq=new dh.DictionaryPropertySet;this.CVb=!1;this.nk=this.Zpa=this.WOa=this.PMa=null;this.VM=a;this.Qwh=d}get N9a(){return this.Zpa||(this.Zpa=la.a.instance.sa("Box4.ITextFormattingCommands"))}get Xg(){return Su.Wd||(Su.Wd=la.a.instance.resolve("Box4.IFormattingEditor"))}get gb(){return this.nk||
(this.nk=la.a.instance.resolve("Box4.Styles.IWACStyleReader"))}B8a(){this.CVb||(this.oq.hQd(),this.PMa=null,this.H6m())}hZk(a){var d;const n=null!==(d=La.FormattingReader.yr(a))&&void 0!==d?d:La.FormattingReader.eud(a.node,a.cpBegin,-1);!n.cache.av&&(a=n.gm)&&(d=new dh.DictionaryPropertySet,d.hn(a),d.hn(this.oq),d.hasProperty(lh.a.GA)&&(this.PMa=n.paragraph.Ib),this.oq=d)}hasProperty(a){return this.oq.hasProperty(a)}nyd(){return 0<this.oq.Kx()}get eob(){return this.oq}freeze(){this.CVb=!0}XYa(){this.CVb=
!1}mS(a,d){return this.eob.fa(a,d)}ay(a){this.oq.setValue(Vd.a.fontSize,this.Xg.joe(a));this.F8()}fontSize(){return this.oq.fa(Vd.a.fontSize,nn.a.NA)}uXe(a){this.oq.setValue(Vd.a.font,a);this.Qwh&&this.Qwh.execute(d=>{null==d?k.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):d.uXe(this.oq)});this.VM&&this.VM.enabled&&(Ld.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.VM.Qkn(this.oq,a));this.F8()}GSc(a){this.oq.setValue(Qb.a.PV,
a);this.VM&&this.VM.enabled&&(Ld.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.VM.bpn(this.oq,a));this.F8()}$v(a){a=on.a.instance.IRa(Lg.a.instance.ya.Ba.ra.node,a);this.oq.setValue(Vd.a.fontColor,a);this.F8()}yaa(){this.oq.setValue(Vd.a.fontColor,zl.a.auto);this.F8()}fontColor(){return this.oq.fa(Vd.a.fontColor,zl.a.nil)}PKa(a){this.oq.setValue(Vd.a.highlight,parseInt(a,16));this.F8()}Tme(){this.oq.setValue(Vd.a.highlight,zl.a.auto);this.F8()}isBold(){return this.oq.fa(Vd.a.bold,
!1)}tO(a){this.oq.setValue(Vd.a.bold,a);this.F8()}isItalic(){return this.oq.fa(Vd.a.italic,!1)}setItalic(a){this.oq.setValue(Vd.a.italic,a);this.F8()}isUnderline(){return this.oq.fa(Vd.a.underline,!1)}cda(a){this.oq.setValue(Vd.a.underline,a);this.oq.setValue(Vd.a.underlineType,a?nn.a.gPb:nn.a.zM);this.F8()}underlineType(){return this.oq.fa(Vd.a.underlineType,nn.a.zM)}noa(a){a<nn.a.gPb||a>nn.a.zM||(this.oq.setValue(Vd.a.underline,a!==nn.a.zM),this.oq.setValue(Vd.a.underlineType,a),this.F8())}isSuperscript(){return this.oq.fa(Vd.a.superscript,
!1)}koa(a){this.oq.setValue(Vd.a.superscript,a);a&&this.isSuperscript()&&this.oq.setValue(Vd.a.subscript,!1);this.F8()}isSubscript(){return this.oq.fa(Vd.a.subscript,!1)}eDa(a){this.oq.setValue(Vd.a.subscript,a);a&&this.isSubscript()&&this.oq.setValue(Vd.a.superscript,!1);this.F8()}isStrikethrough(){return this.oq.fa(Vd.a.strikethrough,!1)}Lha(a){this.oq.setValue(Vd.a.strikethrough,a);this.F8()}isDoubleStrikethrough(){return this.oq.fa(lh.a.eo,!1)}jSc(a){this.oq.setValue(lh.a.eo,a);this.F8()}l6f(){return this.oq.fa(lh.a.GA,
null)}Ltb(a,d){this.oq.hQd();this.oq.setValue(lh.a.GA,a.id);this.PMa=d.Ib;this.F8()}Zca(a){let d=Vd.a.Sv;if(uf.a.instance.J(1)){const n=nx.a.jec(a);switch(n){case 1:d=Qb.a.s6a;break;case 2:d=Qb.a.t6a}this.oq.setValue(Qb.a.languageHint,n)}this.oq.setValue(d,a);this.F8()}language(){let a=Vd.a.Sv;if(uf.a.instance.J(1))switch(this.oq.fa(Qb.a.languageHint,0)){case 1:a=Qb.a.s6a;break;case 2:a=Qb.a.t6a}return this.oq.fa(a,0)}Jmn(a){this.oq.setValue(Qb.a.gO,a);this.F8()}RHb(){return this.oq.fa(Qb.a.gO,!1)}Qcm(){return this.oq.hasProperty(Qb.a.gO)}Xbm(){return uf.a.instance.J(1)?
this.oq.hasProperty(Vd.a.Sv)||this.oq.hasProperty(Qb.a.s6a)||this.oq.hasProperty(Qb.a.t6a):this.oq.hasProperty(Vd.a.Sv)}F8(){if(I.a.bnc){var a=Lg.a.instance.ya.Ba.ra,d=a.node;if(d===this.WOa)this.WOa.Fi(16,!0);else{this.WOa=d;d=this.WOa.oT();try{this.WOa.Vaa(a.cpBegin).Fma=!0}finally{d&&d.dispose()}}}}H6m(){if(I.a.bnc&&this.WOa){var a=0,d=this.WOa.oT();try{for(let n=this.WOa.ja.length-1;0<=n;n--){const z=this.WOa.ja.J(n);z.Fma&&(z.Fma=!1,a++,z.isEmpty&&this.WOa.ja.removeAt(n))}}finally{d&&d.dispose()}this.WOa=
null}}QXk(a){if(a.cpBegin!==a.cpEnd)return!1;a=a.node.ja.Yg(a.cpBegin);return!!a&&a.Fma}$Ef(a){if(this.N9a){this.freeze();var d=new Ff.GraphTransaction(7);d.Sa(a.node);this.N9a.wXe(a);this.XYa();this.B8a();d.dispose()}}Lbg(a){const d=Bd.ParagraphReader.text(a.node);return a.cpBegin&&a.cpBegin!==d.length&&!w.a.ep(d.charCodeAt(a.cpBegin))&&Hr.a.instance.BTa(d,a.cpBegin-1)!==a.cpBegin&&Qd.SelectionEditor.zVa(a)?(a=Qd.SelectionEditor.SU(a,!1))?1<a.length||Qd.SelectionEditor.Ch(a.ra)?a:null:null:null}}
Su.Wd=null;Object(t.a)(Su,"InsertionPointFormatting",null,[463]);class Iv{constructor(a){this.ga=a}get Tb(){return this.ga}pLk(a,d,n=null){const z=new dh.DictionaryPropertySet;z.setValue(Xc.a.Ju,a);z.setValue(Xc.a.wBa,d);n&&z.hn(n);z.CommandSource="autobulleting";this.Tb.ob(Mb.a.pC,2,z)}numbering(a,d,n,z,O){const ca=new dh.DictionaryPropertySet;ca.setValue(Xc.a.Ju,a);ca.setValue(Xc.a.wBa,d);ca.setValue(Xc.a.vBa,n);O&&ca.setValue(bd.a.VC,O);z&&ca.setValue(Qb.a.fr,z);at.a.p0&&(ca.setValue(bd.a.Lsa,
"autocorrect"),O&&ca.setValue(bd.a.Yma,O));ca.CommandSource="autonumbering";return 32===this.Tb.ob(Mb.a.bL,2,ca)}}Object(t.a)(Iv,"ListCommands",null,[462]);var hu=b(222);class ct extends hu.a{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc){super();this.Mvc=this.sq=this.G_a=null;this.init(a);this.Pj(Fc);this.AIa(Xa,d,z,O,ca);this.Ru=ca;this._context=n;this.Da=zb;this.ud=Vb;this.NFa=Da;this.GC=0}run(){this.xLf();this.GC||this.mqn();1===this.GC&&this.IVm();2===this.GC&&this.DCn();3===this.GC&&this.Oll()}xLf(){this.Da.ya&&
this.Da.ya.Ba?1===this.behavior&&(this.NFa.xLf(this._context)?this.Zl=32:this.Zl=2,this.GC=3):(k.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.Zl=2,this.GC=3)}mqn(){this.dKk();this.NFa.c3g(this.G_a)?(this.mJk(),this.GC=1):(this.Zl=8,this.GC=3)}IVm(){this.fx||new Bo.a(this,Object(m.a)(this,this.JUm,"processCurrentNodeAtBegin"),this.Ru);do if(this.fx.run(),this.fx.inProgress&&!this.Ce)return;while(this.fx.inProgress);this.AAc();this.GC=2}DCn(){this.NFa.n$g(this)?this.Zl=32:this.Zl=
8;this.GC=3}Oll(){this.b1()}JUm(a,d){d=this.NFa.PRe(this.G_a,d);a.ui(Object(m.a)(this,this.gpl,"fromHereToEnd"));return d}gpl(a,d){if(this.sq.moveNext())return a=this.sq.currentNode,12!==a.type||a===this.G_a.node?!0:this.NFa.ENd(a,d);this.LKk();a.ui(Object(m.a)(this,this.hpl,"fromStartToHere"));return!0}hpl(a,d){if(this.sq.moveNext()){const n=this.sq.currentNode;return 12!==n.type?!0:n===this.G_a.node?(a.ui(Object(m.a)(this,this.KUm,"processCurrentNodeAtEnd")),!0):this.NFa.ENd(n,d)}return!1}KUm(a,
d){this.NFa.QRe(this.G_a,d);return!1}dKk(){let a=this.Da.ya.Ba;if(a=this.ud.Xf(a,!0,!1))this.G_a=a.ra;this.G_a&&this.G_a.node&&(this.Mvc=this.NFa.DCi(this.G_a.node))}mJk(){if(!this.Mvc)throw Error.argumentNull("_proofingWholeDocumentRootNode");const a=new Pi.a;a.set(this.G_a.node);a.La(this.Mvc.type);this.sq=$s.a.Yo(a,this.Mvc);this.sq.zj(Object(m.a)(this.NFa,this.NFa.uTc,"spellErrorFilter"),null)}LKk(){if(!this.Mvc)throw Error.argumentNull("_proofingWholeDocumentRootNode");const a=new Pi.a;a.set(this.Mvc);
this.sq=$s.a.Ep(a);this.sq.zj(Object(m.a)(this.NFa,this.NFa.uTc,"spellErrorFilter"),null)}}Object(t.a)(ct,"ProofingWholeDocumentOperation",hu.a,[]);var iu=b(277);class ox extends ho{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(t.a)(ox,"ContextMenuRootProperties",ho,[]);var px=b(1724);class uw{constructor(a){const d=new ox;d.ImageSideArrow=l.AFrameworkApplication.ln;d.ImageSideArrowClass=Vf.getImageClass("SubmenuFlyoutArrow_13x13x32");d.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection;
d.CommandMenuOpen=Mb.a.IMd.toString();this.RPh=new px.ContextMenuRoot("ContextMenuRootName",d);a.execute(n=>{this.U8.XI=n});this.U8.refresh();l.AFrameworkApplication.pa.ma(Sa.a.showContextMenu,Cd.a.frame,Bc.ActionManager.Ke);l.AFrameworkApplication.pa.ma(Sa.a.SNb,Cd.a.frame,Bc.ActionManager.Ke)}get U8(){return this.RPh}dispose(){this.U8&&(this.U8.dispose(),this.RPh=null)}showContextMenu(a,d){this.kmc(a,d.clientPoint,d.ed)}GBc(a,d,n,z,O){this.U8.GBc(a,d,n,z,O)}Vtb(a,d,n){Ye.a.UHd(this.U8.Qgb?"ShowLegacyContextMenuAndFloatie":
"ShowLegacyContextMenu","");Lb.App.oa.Mqi();this.Vv();this.U8.Vtb(a,d,n);this.U8.Qgb?l.AFrameworkApplication.pa.processAction(Sa.a.SNb,2):l.AFrameworkApplication.pa.processAction(Sa.a.showContextMenu,2)}kmc(a,d,n){this.Vtb(a,new Sys.UI.Bounds(d.x,d.y,0,0),n)}Vv(){this.U8.root.Km()}N3(){return this.U8.N3()}SNb(a,d,n,z){const O=this.U8;let ca=!1;n=Object(qa.a)(tg,n);O.Qgb=n;z.J8(a,d);O.sAf?n&&(n.VRm(O,d),ca=!0):(k.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",
z.h6k()),O.Qgb=null);return ca}}Object(t.a)(uw,"AContextMenuController",null,[493,12]);class As{}As.uPc="faProofing";As.dji="EditorMenuSection";Object(t.a)(As,"ContextMenuControlId",null,[]);var Jv=b(503);class ju{constructor(a){this.ud=a}xLf(a){a=Object(qa.a)(Jv.a,a);return!!a&&!!a.view&&a.view.Yd}c3g(){return!0}PRe(){return!0}ENd(){return!0}QRe(){}n$g(){return!0}uTc(a){if(a.Lj)return!0;a=a.role;return 1===a||2===a||3===a||4===a||5===a}DCi(a){if(!a||!this.ud)return a;const d=new Pi.a;d.set(a);if(this.ud.Vm(d)){for(;!d.Lj;)d.hb();
return d.currentNode}return a}}Object(t.a)(ju,"SimpleProofingWholeDocumentCallBacks",null,[327]);class vw{constructor(a){this.value=a}}Object(t.a)(vw,"RefBool",null,[]);class Kv{constructor(){this.Dqd=this.Ofc=null;this.BMj=new vw(!1)}}Object(t.a)(Kv,"FindNextErrorOperationParam",null,[]);var nq=b(1403);class jv extends ju{constructor(a,d,n,z){super(d);this.Ak=a;this.mcd=n;this.j3j=z}PRe(a,d){return!this.Ewg(a.node,a.cpBegin,d)}ENd(a,d){return!this.Ewg(a,0,d)}QRe(a,d){this.Ewg(a.node,0,d);Object(qa.a)(Kv,
d)}Ewg(a,d,n){n=Object(qa.a)(Kv,n);if(Bd.ParagraphReader.nb(a)&&!a.Ey)if(La.FormattingReader.yr(fe.a.Kb(a,d)).cache.RHb)n.BMj.value=!0;else{if(nq.a.tH())return d=this.j3j.bjl(a,d,this.mcd),null!=d?(n.Ofc=d,n.Dqd=a,!0):!1;const z=this.Ak.mba(a);for(let O=0;O<z.length;O++){const ca=z[O];if(ca.begin>=d&&!ca.errorDetails.U5a()&&(!this.mcd||this.mcd(ca.errorDetails)))return n.Ofc=ca,n.Dqd=a,!0}return!1}}}Object(t.a)(jv,"FindNextErrorCallbackSteps",ju,[]);var hp=b(453);class qx{constructor(a,d,n,z,O,ca,
Da,Xa,zb,Vb,Fc,Yc,yd,je,Le,Ve,gg){this.ga=d;this.Ak=a;this.oek=n;this.hc=z;this.Nb=O;this.Da=ca;this.Wl=Da;this.ud=Xa;this.Vwa=zb;this.vn=Vb;this.Bc=Fc;this.exb=gg;this.sG=Object(qa.a)(uw,Yc);this.Ntc=yd.eEd;this.zKh=je;this.xQb=Le;this.Beb=Ve;this.M2d=new me.a;this.M2d.$(1,Mb.a.t_e);this.M2d.$(2,Mb.a.NAe);this.M2d.$(3,Mb.a.b0e);this.Qce=new me.a;this.Qce.$(1,Mb.a.u_e);this.Qce.$(2,Mb.a.OAe);this.Qce.$(3,Mb.a.c0e)}lb(){const a=this.ga,d=Object(m.a)(this,this.qZk,"correctError"),n=Object(m.a)(this,
this.iUk,"collapseIp");a.Aa(Mb.a.fLd,Kb.a.view,Object(m.a)(this,this.fMm,"openLanguageDialogView"),1028);a.ma(Mb.a.nHa,Kb.a.Ub,Object(m.a)(this,this.nHa,"deleteRepeatedWord"));a.ma(Mb.a.nAa,Kb.a.Ub,Object(m.a)(this,this.nAa,"ignoreSpellingError"));a.ma(Mb.a.Mub,Kb.a.Ub,d);a.ma(Mb.a.Nub,Kb.a.Ub,d);a.ma(Mb.a.Oub,Kb.a.Ub,d);a.ma(Mb.a.HOb,Kb.a.Ub,d);a.ma(Mb.a.IOb,Kb.a.Ub,d);a.ma(Mb.a.nHa,Kb.a.view,n);a.ma(Mb.a.nAa,Kb.a.view,n);a.ma(Mb.a.Mub,Kb.a.view,n);a.ma(Mb.a.Nub,Kb.a.view,n);a.ma(Mb.a.Oub,Kb.a.view,
n);a.ma(Mb.a.HOb,Kb.a.view,n);a.ma(Mb.a.IOb,Kb.a.view,n);a.$b(Mb.a.nHa,1028);a.$b(Mb.a.nAa,1028);a.$b(Mb.a.Mub,1028);a.$b(Mb.a.Nub,1028);a.$b(Mb.a.Oub,1028);a.$b(Mb.a.HOb,1028);a.$b(Mb.a.IOb,1028);a.ma(Mb.a.vDa,Cd.a.frame,Bc.ActionManager.Ke);this.Ntc&&a.Aa(Mb.a.IMd,Kb.a.view,Object(m.a)(this,this.IMd,"populateProofingSecondaryMenu"),1124);a.Aa(Mb.a.aNc,Kb.a.view,Object(m.a)(this,this.Wkl,"findNextProofingError"),1028);a.Aa(Mb.a.aSe,Kb.a.Lc,Object(m.a)(this,this.Kgn,"sendClickNoActionFeedback"),1124);
this.E3m([Mb.a.wWd,Mb.a.t_e,Mb.a.u_e,Mb.a.Fxd,Mb.a.NAe,Mb.a.OAe,Mb.a.eXd,Mb.a.b0e,Mb.a.c0e])}E3m(a){for(let d=0;d<a.length;d++)this.ga.Aa(a[d],Kb.a.view,Bc.ActionManager.CX,1028)}A4m(a){this.mcd=a}iUk(a,d,n,z,O){d=this.Da.ya.Ba;if(!d)return this.Bc.mb(Ee.a.af,{["Reason"]:Jf.a.noSelection}),2;d=this.ud.Xf(d,!0,!1);return this.ga.rf(d.ra,a,n,!1,z,O)}fMm(a,d,n){if(1===n)return this.ga.processAction(Mb.a.Zca,1);this.oek().J5g();return 32}F2e(a){return a?a.errorDetails?!1:(k.ULS.sendTraceTag(7660829,324,
10,"Ignore Spelling Error: No suggestions on flagged word"),this.Bc.mb(Ee.a.HEb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),Mh.a.mark(4671),!0):(k.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this.Bc.mb(Ee.a.HEb,{["Reason"]:"RequestedErrorRangeNotFound"}),Mh.a.mark(4671),!0)}nHa(a,d,n){if(1===n)return 32;Mh.a.mark(4670);n=this.Ak.Cra(d);if(this.F2e(n))return 8;d=d.node;const z=this.Nb.Wb(15);let O=n.begin;" "===Bd.ParagraphReader.text(d).charAt(O-1)&&O--;z.Sa(d);const ca=
this.hc.replaceTextRange(fe.a.createTextRange(d,0<n.begin?n.begin-1:0,n.end),"",!0,!1);this.Da.setSelection(ye.SelectionFactory.Pc(d,ca+O));z.dispose();n.errorDetails.ZOb(a);Mh.a.mark(4671);return 32}qqm(a){let d;({value:d}=this.Qce.Ab(a.errorDetails.proofingType,0)).returnValue&&(this.ga.processAction(d,2),k.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",d,a.errorDetails.proofingType))}nAa(a,d,n){if(1===n)return 32;k.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");
if(nq.a.tH())return this.exb.pfg(d,null,hp.b.IgnoreOnce),32;Mh.a.mark(4670);n=this.Ak.Cra(d);if(this.F2e(n))return 8;d=d.node;const z=this.Nb.Wb(15);z.Sa(d);this.Ak.ksb(d,[n],!0);d.setValue(Vd.a.roe,!0);z.dispose();n.errorDetails.ZOb(a);Mh.a.mark(4671);k.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.qqm(n);this.Beb.yLi(n,d,!0);return 32}swl(a){switch(a){case Mb.a.Mub:return 0;case Mb.a.Nub:return 1;case Mb.a.Oub:return 2;case Mb.a.HOb:return 3;case Mb.a.IOb:return 4;
default:return-1}}cmm(a){let d;({value:d}=this.M2d.Ab(a.errorDetails.proofingType,0)).returnValue&&(this.ga.processAction(d,2),k.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",d,a.errorDetails.proofingType))}qZk(a,d,n){var z=!this.vn.t4(d);this.Wl&&this.Wl.instance&&this.Wl.instance.l0(d)&&(z=!1);if(1===n||!z)return z?32:8;this.ga.processAction(Mb.a.vDa,2);Mh.a.mark(4670);z=this.swl(a);if(0>z)return 8;if(nq.a.tH())return this.exb.pfg(d,z,hp.b.Apply),32;
n=this.Ak.Cra(d);if(this.F2e(n))return 8;d=d.node;var O=n.errorDetails.suggestions;if(!O)return this.Bc.mb(Ee.a.HEb,{["Reason"]:"NoSuggestionsFound"}),Mh.a.mark(4671),8;z=z<O.length?O[z]:null;if(!z)return this.Bc.mb(Ee.a.HEb,{["Reason"]:"RequestedSuggestionIsNull"}),Mh.a.mark(4671),8;this.xQb.J(4)&&Lb.App.lc.eq&&Lb.App.lc.Mp.MJ(d);z=z.replace("  "," \u00a0");O=this.Nb.Wb(15);O.Sa(d);const ca=this.hc.replaceTextRange(fe.a.createTextRange(d,n.begin,n.end),z,!0,!1,Mb.a.vDa);this.Da.setSelection(ye.SelectionFactory.Pc(d,
n.begin+z.length+ca));O.dispose();n.errorDetails.ZOb(a);Mh.a.mark(4671);this.cmm(n);return 32}Kgn(a,d){d=this.Ak.Cra(d);if(this.F2e(d))return 8;d.errorDetails.ZOb(a);return 32}rfn(a,d,n,z){a.YY();(a=n.Qd(a.Za))?(z=iu.a.xl(a,l.AFrameworkApplication.isRtl?z.begin:z.end),this.Vwa.J8(new Sys.UI.Point(z.x,z.y+z.height),d)):k.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}Wkl(a,d,n,z,O){if(!d.view.Yd)return 2;const ca=d.view;if(!this.Da.ya.Ba)return this.Bc.mb(Ee.a.af,{["Reason"]:Jf.a.noSelection}),
2;if(1===n)return 32;const Da=new Kv,Xa=new jv(this.Ak,this.ud,this.mcd,this.exb);d=new ct(null,a,d,n,z,Da,Xa,this.ga,this.Da,this.ud,null);d.Ce=!0;d.run();if(d.isCompleted&&Da.Ofc){if(d=ye.SelectionFactory.Pc(Da.Dqd,Da.Ofc.begin),d=ye.SelectionFactory.Mx(d,fe.a.Kb(Da.Dqd,Da.Ofc.end)),!this.zKh.instance||!this.zKh.instance.zTm(Da.Ofc,d,ca)){this.Da.setSelection(d);let zb=0;O&&(zb=O.UF);ca.cmc=!1;th.a.instance.rb(new bf.a(1,1,1,()=>{this.rfn(ca,zb,Da.Dqd,Da.Ofc)}))}}else{const zb=new $g.StandardDialog;
zb.wc=0;Lb.App.UH.kHe?zb.Qha(CommonUIStrings.l_DefaultDialogTitle,Da.BMj.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(zb.Qha(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),Lb.App.UH.EBf(()=>{zb.bca&&(zb.hide(),this.ga.processAction(a,2))}))}return 32}IMd(a,d,n){if(1===n)return 32;this.sG&&this.sG.U8&&(a=this.sG.U8.zdg(As.uPc))&&!a.oQ&&(a.z4(0),a.menu.JP(0));return 32}}Object(t.a)(qx,
"ProofingActor",null,[]);var It=b(316),ip=b(1369);class Ns{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb){this.oF=this.Cja=this.JTc=null;this.gnl="StyleUsageActivity";this.hnl="StylesFloodgateSurveyIsEnabled";this.Vp=null;this.Kz=d;this.Wd=n;this.Vu=z;this.Xn=O;this.vn=ca;this.Bc=Da;this.kU=Xa;this.Vrk=zb;this.Xb=Vb}get Gg(){return this.Vp||(this.Vp=la.a.instance.sa("Box4.Styles.StyleSettings"))}get Wha(){return this.Kz}get jg(){return this.Vu}get pj(){return this.Xn}get Xg(){return this.Wd}get If(){return this.vn}get Lb(){return this.Bc}get lUc(){return this.kU}get T0d(){return this.Vrk}get gb(){return this.Xb}get Ama(){null==
this.Cja&&(l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordHighlightStyleWhenDifferentFromSelectionSettings"),this.Cja=l.AFrameworkApplication.K?l.AFrameworkApplication.K.ea("HighlightStyleWhenDifferentFromSelectionIsEnabled"):!1);return this.Cja}lb(){const a=l.AFrameworkApplication.pa,d=Lb.App.P9a.Jbi(12);uf.a.instance.J(8)&&(a.ma(Mb.a.applyStyle,Kb.a.Lc,Object(m.a)(this,this.pEk,"applyStyleToTextRange")),a.ma(Mb.a.CCa,Kb.a.Lc,Object(m.a)(this,this.KXm,"queryStyleTextRange")),
a.ma(Mb.a.applyStyle,Kb.a.Ub,Object(m.a)(this,this.nEk,"applyStyleToIp")),a.ma(Mb.a.CCa,Kb.a.Ub,Object(m.a)(this,this.IXm,"queryStyleIp")));a.ma(Mb.a.applyStyle,Kb.a.paragraph,Object(m.a)(this,this.oEk,"applyStyleToParagraph"));a.ma(Mb.a.applyStyle,Kb.a.view,Object(m.a)(this,this.qEk,"applyStyleView"));a.$b(Mb.a.applyStyle,1036);a.ma(Mb.a.CCa,Kb.a.view,Object(m.a)(this,this.LXm,"queryStyleView"));a.ma(Mb.a.CCa,Kb.a.paragraph,Object(m.a)(this,this.JXm,"queryStyleParagraph"));a.$b(Mb.a.CCa,99);a.ma(Mb.a.QKb,
Kb.a.view,d);a.ma(Mb.a.QKb,Kb.a.paragraph,Object(m.a)(this,this.QKb,"populateMenuMoreStyles"));a.$b(Mb.a.QKb,1127);a.Aa(Mb.a.Sje,Kb.a.view,Object(m.a)(this,this.s2a,"applyStyleShortcut"),4);a.Aa(Mb.a.Tje,Kb.a.view,Object(m.a)(this,this.s2a,"applyStyleShortcut"),4);a.Aa(Mb.a.Uje,Kb.a.view,Object(m.a)(this,this.s2a,"applyStyleShortcut"),4);a.Aa(Mb.a.Vje,Kb.a.view,Object(m.a)(this,this.s2a,"applyStyleShortcut"),4);a.Aa(Mb.a.Wje,Kb.a.view,Object(m.a)(this,this.s2a,"applyStyleShortcut"),4);a.Aa(Mb.a.Xje,
Kb.a.view,Object(m.a)(this,this.s2a,"applyStyleShortcut"),4);a.Aa(Mb.a.Yje,Kb.a.view,Object(m.a)(this,this.s2a,"applyStyleShortcut"),4);a.Aa(Mb.a.hFf,Kb.a.view,Object(m.a)(this,this.s2a,"applyStyleShortcut"),4);a.Aa(Mb.a.iFf,Kb.a.view,Object(m.a)(this,this.s2a,"applyStyleShortcut"),4);a.Aa(Mb.a.jFf,Kb.a.view,Object(m.a)(this,this.s2a,"applyStyleShortcut"),4);this.JTc=Array(10);Gh.StyleReader.zUd(this.JTc)}nPl(a){switch(a){case Mb.a.Sje:return 0;case Mb.a.Tje:return 1;case Mb.a.Uje:return 2;case Mb.a.Vje:return 3;
case Mb.a.Wje:return 4;case Mb.a.Xje:return 5;case Mb.a.Yje:return 6;case Mb.a.hFf:return 7;case Mb.a.iFf:return 8;case Mb.a.jFf:return 9;default:return-1}}s2a(a,d,n,z){a=this.nPl(a);return 0>a||a>this.JTc.length?2:(a=this.JTc[a])?l.AFrameworkApplication.pa.rf(d,Mb.a.applyStyle,n,!0,z,a):2}QKb(a,d,n,z,O){a=!0;d.contextId!==Kb.a.paragraph&&d.contextId!==Kb.a.Lc&&d.contextId!==Kb.a.Ub&&(a=!1);if(1===n||!a)return a?32:8;if(2===n&&!O)return 8;d=this.gb.rz(d.node);n=uf.a.instance.J(8);O.MenuItems=It.a.oAi(d,
n);return 32}JXm(a,d,n,z,O){a=!0;d.contextId!==Kb.a.paragraph&&(a=!1);if(1===n&&!a)return 8;n=d.node;a=this.gb.im(n);if(!a||!O)return k.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",O,n,a),8;O.w9a.hn(a.Be());this.Ama&&(O.NCd=sj.a.YGe(d,a));return 32}oEk(a,d,n,z,O){if(d.contextId!==Kb.a.paragraph)return 8;if(this.If.tVa(d,!1))return this.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.CF}),8;if(1===n)return 32;n=d.node;if(Bd.ParagraphReader.qla(n)||!O)return 8;const ca=this.ncg(O,
n);if(!ca)return this.Lb.mb(Ee.a.u1,{["Reason"]:Jf.a.skb}),8;if(2!==this.gb.Mv(ca))return 2;a=new Ff.GraphTransaction(15);this.Gg&&this.Gg.isProgressiveStyleEnabled&&this.jx.kTc(O);a.Sa(n);this.pj.B8a();this.Wha.hT(ca,n,!1);const Da=this.gb.rz(n);Da&&this.gb.Gu(ca,Da)&&Ld.b(593078098,3017,50,"Custom linked style applied by user");n.ko&&(n=[Object.assign(new ba.a,{name:"Source",string:"ApplyStyle"})],we.a("TOCFormatting",!0,void 0,n));a.dispose();O=w.a.IR(O);z.vq=O>>>16^O&65535;z&&ip.a.KOb&&(z.lz|=
ip.a.tFb(d.node));return 32}KXm(a,d,n,z,O){a=!0;d.contextId!==Kb.a.Lc&&(a=!1);if(1===n&&!a)return 2;n=d.node;a=La.FormattingReader.yr(d);a=La.FormattingReader.Rra(a);if(this.Ama){if(!O||!n)return k.ULS.sendTraceTag(51218393,324,10,"actionData : {}, graphNode : {}",O,n),8;a=a||this.gb.im(n);if(!a)return k.ULS.sendTraceTag(51218394,324,10,"No paragraph style for Text range context is found"),2;O.NCd=sj.a.YGe(d,a)}else{if(!a)return 2;if(!O)return 8}O.w9a.hn(a.Be());return 32}pEk(a,d,n,z,O){if(d.contextId!==
Kb.a.Lc||!uf.a.instance.J(8))return 8;this.If.tVa(d);if(1===n)return 32;a=d.node;if(!O)return 8;const ca=this.ncg(O,d.node);if(!ca)return this.Lb.mb(Ee.a.u1,{["Reason"]:Jf.a.skb}),8;if(1!==this.gb.Mv(ca))return 2;n=this.gb.rz(a);if(!n)return this.Lb.mb(Ee.a.u1,{["Reason"]:Jf.a.Lte}),8;if(!n.Mf(this.gb.Jd(ca)))return this.Lb.mb(Ee.a.u1,{["Reason"]:Jf.a.skb}),8;const Da=new Ff.GraphTransaction(7);try{if(this.Gg&&this.Gg.isProgressiveStyleEnabled&&this.jx.kTc(O),Da.Sa(a),this.Wha.Heh(a,n),this.lUc.Tka(d,
Xa=>{this.Xg.mya(Xa);this.Xg.Ltb(Xa,ca)}),a.ko){const Xa=[Object.assign(new ba.a,{name:"Source",string:"ApplyStyle"})];we.a("TOCFormatting",!0,void 0,Xa)}}finally{Da&&Da.dispose()}n&&this.gb.Gu(ca,n)&&Ld.b(593078097,3017,50,"Custom linked style applied by user");O=w.a.IR(O);z.vq=O>>>16^O&65535;z&&ip.a.KOb&&(z.lz|=ip.a.tFb(d.node));return 32}IXm(a,d,n,z,O){a=!0;d.contextId!==Kb.a.Ub&&(a=!1);if(1===n&&!a)return 2;n=this.Wha.qPl(d);a=d.node;if(this.Ama){if(!O||!a)return k.ULS.sendTraceTag(51218396,324,
10,"actionData : {}, graphNode : {}",O,a),8;n=n||this.gb.im(a);if(!n)return k.ULS.sendTraceTag(51218397,324,10,"No paragraph style for I/P context is found"),2;O.NCd=sj.a.YGe(d,n)}else{if(!n)return 2;if(!O)return 8}O.w9a.hn(n.Be());return 32}nEk(a,d,n,z,O){if(d.contextId!==Kb.a.Ub||!uf.a.instance.J(8))return 8;if(this.If.tVa(d,!1))return this.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.CF}),8;if(1===n)return 32;var ca=d.node;if(!O)return 8;n=this.ncg(O,d.node);if(!n)return this.Lb.mb(Ee.a.u1,{["Reason"]:Jf.a.skb}),
8;const Da=this.gb.Mv(n);if(1!==Da&&2!==Da)return 2;(d=this.pj.Lbg(d))?(d=Lg.a.s3a(d),a=l.AFrameworkApplication.pa.rf(d,a,2,!1,z,O)):(a=new Ff.GraphTransaction(7),this.Gg&&this.Gg.isProgressiveStyleEnabled&&this.jx.kTc(O),a.Sa(ca),this.Wha.Hon(n,ca),a.dispose(),a=32);ca.ko&&(d=[Object.assign(new ba.a,{name:"Source",string:"ApplyStyle"})],we.a("TOCFormatting",!0,void 0,d));(ca=this.gb.rz(ca))&&this.gb.Gu(n,ca)&&Ld.b(593078096,3017,50,"Custom linked style applied by user");O=w.a.IR(O);z.vq=O>>>16^O&
65535;return a}LXm(a,d,n,z,O){if(uf.a.instance.J(8)){const ca=this.T0d.mCa(a,d,n,z,O,null,0);if(2!==ca)return ca}return this.T0d.mCa(a,d,n,z,O,null,12)}qEk(a,d,n,z,O){const ca={};ca[this.T0d.TZa]=6168;ca[this.T0d.SZa]=6169;let Da=12;if(uf.a.instance.J(8)){if(!d.view.Yd)return 2;var Xa=d.view.Oa,zb=Xa?Xa.Ag:null;if(!zb)return this.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.noSelection}),8;if(this.jg.Eya(Kd.ImageReader.aVa,zb))return this.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.g5b}),8;if(this.jg.h9(Bd.ParagraphReader.wS,
zb))return this.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.qP}),8;if(this.If.Fbc(zb,!1))return this.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.CF}),8;zb=this.gb.kn();if(O&&zb){const Vb=zb.Mf(O);if(Vb){const Fc=this.gb.MN(Vb,zb);let Yc=this.gb.Mv(Vb);Fc&&(Xa=Xa.ya.J(0),Xa.IA&&Xa.ra.contextId===Kb.a.Lc||2===Xa.length&&Xa.ra.contextId===Kb.a.Lc&&Xa.Fb.contextId===Kb.a.endOfParagraph)&&(Yc=1,O=Fc.getValue(lh.a.fC));1===Yc?Da=0:3===Yc&&(Da=14);!this.gb.Gu(Vb,zb)&&this.gb.Hy(Vb)&&(Xa=this.gb.Jd(Vb),Ld.b(562317522,3017,50,String.format("{0}: style applied by user",
Xa)));this.fia(this.gnl,this.hnl)}}}return this.T0d.mCa(a,d,n,z,O,ca,Da)}fia(a,d){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea(d)&&window.setTimeout(()=>{const n=la.a.instance.Ca("Common.ISystemInitiatedFeedback");n&&n.execute(z=>{z.logActivity(a,d)})},Ns.pSa)}ncg(a,d){if(a&&d&&Bd.ParagraphReader.nb(d))d=this.gb.rz(d);else return null;return d.Mf(a)}get jx(){return this.oF||(this.oF=la.a.instance.resolve("Box4.IFontStylesGalleryCache"))}}Ns.pSa=5E3;Object(t.a)(Ns,"StyleActor",null,[]);
var ww=b(1727);class Lv{constructor(a){this.ga=a}get Tb(){return this.ga}wXe(a,d=!1){this.Tb.rf(a,Mb.a.eob,2,!0,null,d)}Zca(a){this.Tb.ob(Mb.a.Zca,2,a)}}Object(t.a)(Lv,"TextFormattingCommands",null,[461]);class Yn{constructor(a,d,n,z){this.Kxf=this.vQh=!1;this.ga=a;this.va=d;this.Oyb=n;this.Da=z}get UJj(){return this.Kxf}lb(){this.ga.Aa(Sa.a.hw,Kb.a.view,Object(m.a)(this,this.pFn,"touchStartHandler"),4);this.ga&&this.va&&(this.va.ea("TouchImageGrippiesResizedIsEnabled")&&(this.ga.Aa(Mb.a.XYd,Kb.a.view,
Object(m.a)(this,this.VUm,"processImageOnTouchSelection"),4),this.ga.Aa(Mb.a.YYd,Kb.a.view,Object(m.a)(this,this.UUm,"processImageOnClickSelection"),4)),this.va.ea("HideGrippersWhenPinchingIsEnabled")&&(this.ga.Aa(Sa.a.K7g,Kb.a.application,Object(m.a)(this,this.JVm,"processStartPinchToZoom"),4),this.ga.Aa(Sa.a.Fse,Kb.a.application,Object(m.a)(this,this.RUm,"processEndPinchToZoom"),4)),Io.EventHandlerManager.instance.Rlj(()=>{this.YKm()}));Lb.App.oa.za.Rb&&Lb.App.oa.za.Rb.Yd&&Lb.App.oa.za.Rb.h3(()=>
{this.tfn()});this.Da&&this.Da.dE(Object(m.a)(this,this.Aca,"onProcessSetSelectionFinished"))}ujj(){we.c(Mb.a.TJj);this.Kxf=!0}tfn(){const a=window.performance.now();Yn.Jlf&&250>a-Yn.Jlf&&1E3<a-Yn.GDh&&(we.c(Mb.a.SJj),Yn.GDh=a);this.Oyb&&Yn.Ka&&Yn.Ka.fq(197)&&this.Oyb.showFloatie()}pFn(a,d,n){if(2!==n)return 2;this.vQh||(this.vQh=!0);l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");
return 32}VUm(a,d,n,z,O){if(2!==n)return 2;this.ugj(O,!0);return 32}UUm(a,d,n,z,O){if(2!==n)return 2;this.ugj(O,!1);return 32}JVm(a,d,n){if(2!==n)return 2;if(!this.Oyb)return 8;this.Oyb.iKi();return 32}RUm(a,d,n){if(2!==n)return 2;if(!this.Oyb)return 8;this.Oyb.lrj();return 32}hPi(a,d){if(d){var n=null;I.a.RH&&a&&(n=a.getSelection());a=null;n&&"Caret"===n.type&&(a=n.getRangeAt(0))&&this.Oyb&&this.Oyb.MOj(a.getBoundingClientRect(),d)}}YKm(){Yn.Jlf=window.performance.now()}ugj(a,d){if(a)for(a=a.firstChild;a;){if("SPAN"===
a.tagName&&Object(oj.a)(a,Yn.e1l)){for(a=a.firstChild;a;)this.yAk(a,d),a=a.nextSibling;break}a=a.nextSibling}}yAk(a,d){if(Object(oj.a)(a,Yn.NLi)){const n="WACImageResizeHandleTouch"+this.ABl(a);d?a.classList.add(Yn.OLi,n):a.classList.remove(Yn.OLi,n)}}ABl(a){for(const d of a.className.split(" "))if(d.startsWith("WACImageResizeHandle")&&d!==Yn.NLi)return w.a.substring(d,20,d.length);return""}Aca(a,d){3===d.UF&&Qd.SelectionEditor.qj(d.zi.Ba)&&(we.c(Mb.a.RJj),l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordExtendPageHeightInTouchSettings"),
this.Kxf=!0)}static get Ka(){return Yn.Ja||(Yn.Ja=la.a.instance.sa("Box4.IFeatureHelper"))}}Yn.NLi="WACImageResizeHandles";Yn.OLi="WACImageResizeHandlesTouch";Yn.e1l="WACImgSelection";Yn.Jlf=0;Yn.GDh=0;Yn.Ja=null;Object(t.a)(Yn,"TouchInputActor",null,[460]);class tt{get TZa(){return Dp.a.TZa}get SZa(){return Dp.a.SZa}get XVc(){return Dp.a.XVc}mCa(a,d,n,z,O,ca,Da){return Dp.a.mCa(a,d,n,z,O,ca,Da)}ROc(a,d,n,z,O,ca){return Dp.a.ROc(a,d,n,z,O,ca)}static get instance(){tt.na||(tt.na=new tt);return tt.na}}
tt.na=null;Object(t.a)(tt,"ViewActionHandlerProxy",null,[459]);class xw{constructor(a,d){this.kpiName="VisiMarkersUsage";this.G_="wwaengidc";this.u0=new Map;this.ga=a;this.fzf=d}lb(){this.ga.Aa(Mb.a.RVd,Kb.a.application,Object(m.a)(this,this.xwn,"showVisiMarks"),1);this.ga.Aa(Mb.a.nQg,Kb.a.application,Object(m.a)(this,this.HXm,"queryShowVisiMarks"),96)}xwn(a,d,n,z,O){if(1===n)return 32;if(!O)return 2;this.u0.set("Source",np.a[this.ga.cQ]);this.fzf.lFd?this.u0.set("Action","Removed"):this.u0.set("Action",
"Applied");ja.Health.instance.recordKpiUsage(this.kpiName,1,this.G_,this.u0);a=document.getElementsByTagName("head")[0];if(!this.fzf.REn(a))return k.ULS.sendTraceTag(593294045,324,15,"Toggling Formatting markers failed"),8;Lb.App.oa.jF({ShowVisiMarkers:"ToggleButtonModel"});return 32}HXm(a,d,n,z,O){if(1===n)return 32;O[Yf.a.On]=this.fzf.lFd;return 32}}Object(t.a)(xw,"VisiMarkersActor",null,[]);class kv{Hb(a){a.ha("Box4.Actors.Box4PasteStewardFactory",()=>new Tm(nt.a.P9b,a.resolve("Box4.List.IListEditor"),
a.resolve("Box4.List.IListReader"),a.resolve("Box4.Actors.IBox4PasteStewardBridge"))).as("Box4.Actors.IBox4PasteStewardFactory").singleInstance();a.ha("Box4.Actors.Box4PasteStewardUtils",()=>new bx(l.AFrameworkApplication.K.ea("WacPasteBrAsNewParagraphIsEnabled"))).as("Box4.Actors.IBox4PasteStewardUtils").singleInstance();a.ha("Box4.Actors.ClipboardActor",()=>new Yx.ClipboardActor(a.vf("Box4.Actors.IClipboardOperationFactory"),a.resolve("Box4.Actors.ISystemClipboard"),Ch.a.instance,a.resolve("Box4.IClipboardDataHelper"),
Lg.a.instance,l.AFrameworkApplication.pa,a.resolve("Box4.IUndoManager"),l.AFrameworkApplication.K,ic.FocusManager.instance(),a.resolve("Box4.Actors.IClipboardOperationPasteFactory"),a.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),l.AFrameworkApplication.mZe(),l.AFrameworkApplication.c5g())).singleInstance();a.ha("Common.App.ChromeExtensionHelper.IChromeExtensionHelper",()=>new Tp(l.AFrameworkApplication.K)).singleInstance();
a.ha("Box4.Clipboard.ISystemClipboardAccessManagerFactory",()=>new gp(l.AFrameworkApplication.K,a.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),a.resolve("Box4.IClipboardDataHelper"),$t.a.instance)).singleInstance();a.ha("Box4.Clipboard.ISystemClipboardAccessManager",()=>a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create()).singleInstance();a.ha("Box4.Actors.ISystemClipboard",()=>new Ru(a.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),Ic.InteractiveViewManager.instance,
Lb.App.oa.za,ic.FocusManager.instance(),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),$t.a.instance,l.AFrameworkApplication.K)).singleInstance();a.ha("Box4.Clipboard.IClipboardOperationCutStrategy",()=>new fx).singleInstance();a.ha("Box4.Actors.IDeleteTableSegmentStrategy",()=>new iv).singleInstance();a.ha("Box4.ISelectionFactory",()=>new jw.a).singleInstance();a.ha("Box4.IRenderOrderGraphIteratorFactory",()=>new Iu).singleInstance();a.ha("Common.IDomElementContentStateFactory",
()=>new Xr).singleInstance();a.ha("Box4.Actors.IClipboardOperationPasteOvertypeStrategy",()=>new Bz(Lg.a.instance,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Styles.IWACStyleReader"),uf.a.instance.J(10))).singleInstance();a.ha("Box4.Actors.PastedContentsPostProcessorHelper",()=>new qc).singleInstance();a.ha("Box4.Actors.PasteFloatiePositionProvider",()=>new ki(Lg.a.instance,a.resolve("Box4.ITextMetricsAdapter"),Ic.InteractiveViewManager.instance,Ye.a.getElementBounds,a.resolve("Box4.UI.PasteFloatieManager"))).singleInstance();
a.ha("Box4.Actors.PasteFloatieFeatureSetBuilder",()=>new xf(a.resolve("Box4.IClipboardDataHelper"),Lb.App.Yq.hz)).singleInstance();a.ha("Box4.Actors.PasteFloatieEventManager",()=>new se(a.resolve("Box4.UI.PasteFloatieManager"),a.resolve("Box4.IPasteFloatieEventSource"),Ic.InteractiveViewManager.instance,Gt.a.instance(),l.AFrameworkApplication.la,a.resolve("Box4.Actors.PasteFloatiePositionProvider"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Lb.App.jj.Cm.Oe(12),
a.resolve("Box4.Graph.IGraphTransactionManager"))).singleInstance();a.ha("Box4.Actors.IClipboardOperationPasteFactory",()=>new ay(Ch.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.PasteCoordinator"),Kk.a.instance,Lg.a.instance,l.AFrameworkApplication.pa,a.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),a.vf("Box4.IUndoManager"),a.resolve("Common.IDomElementContentStateFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();
a.ha("Box4.Actors.IClipboardOperationCutCopyFactory",()=>new Yq(l.AFrameworkApplication.pa,Ch.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),Lg.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),tp.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),
a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper"),a.sa("Box4.IFeatureHelper"))).singleInstance();a.ha("Box4.Actors.IClipboardOperationClipboardAccessHelper",()=>new Nu(Ch.a.instance,$t.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Common.ISimpleOperationFactory"),l.AFrameworkApplication.K.appSettings.ChromeClipboardAccessOperationTimeout)).singleInstance();a.ha("Box4.Actors.IClipboardOperationPasteStrategyFactory",()=>new ow(l.AFrameworkApplication.K)).singleInstance();
a.ha("Box4.Actors.IClipboardOperationFactory",()=>new mw(a.resolve("Box4.Actors.InternalClipboard"),l.AFrameworkApplication.pa,l.AFrameworkApplication.fZe(),Ch.a.instance,tp.a.instance,$t.a.instance,a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteFactory"),a.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),a.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),a.resolve("Box4.Actors.ClipboardOperationWordStrategy"),a.resolve("Box4.ICannotCutDialog"),
a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IUndoManager"),a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();a.ha("Box4.Actors.IExternalPasteExecutionManagerFactory",()=>new Fz(a.vf("Box4.Actors.IBox4PasteStewardFactory"),a.vf("Box4.Actors.IBox4ImageStewardFactory"),a.vf("Box4.Actors.IBox4TableStewardFactory"),
a.vf("Box4.Actors.IBox4WordConverterFactory"),a.vf("HtmlImport.IHtmlTranslatorSettings"),a.sa("Box4.IContentControlCopyPasteHelper"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.Actors.IExternalPasteCssConverter"),a.resolve("HtmlImport.IHtmlNormalizerSettings"),a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.resolve("Box4.Actors.IHtmlNormalizerHelper"))).singleInstance();a.ha("Box4.Actors.InternalClipboard",()=>new $f(a.resolve("Box4.Images.IImageEditor"),a.vf("Box4.ITableEditor"),
a.resolve("Box4.IOutlineEditor"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.List.IListEditor"),Lb.App.jj,a.resolve("Box4.IParagraphIndentationReader"),l.AFrameworkApplication.K,a.resolve("Box4.Graph.IGraphNodeFactory"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.sa("Box4.IContentControlCopyPasteHelper"),a.resolve("Box4.ITableCellReader"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IConstantsProvider").tvj,a.resolve("Box4.IFormattingPropertyTransitStrategy"))).singleInstance();
a.ha("Box4.Actors.IInternalPasteExecutionManagerFactory",()=>new oa(a.resolve("Box4.Actors.InternalClipboard"),a.sa("Box4.IContentControlCopyPasteHelper"),new Nf.a(()=>Lb.App.oa.za.Rb),a.resolve("Box4.IFormattingPropertyTransitStrategy"))).singleInstance();a.ha("Box4.List.IListCommands",()=>new Iv(l.AFrameworkApplication.pa)).singleInstance();a.ha("Box4.Actors.PasteCoordinator",()=>new rb(a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"))).singleInstance();
a.ha("Box4.Actors.Box4ImageStewardFactory",()=>new pn(a.resolve("Box4.Images.IImageEditor"),l.AFrameworkApplication.tb,a.resolve("Box4.IUndoManager"),a.sa("Box4.Actors.IImageStewardBridge"),Lb.App.oa.notificationBar,a.sa("Box4.IFeatureHelper"),a.resolve("Common.IAppSettingsManager").ea("WordEditorPastePictureFailedImprovementIsEnabled"),a.resolve("Common.IAppSettingsManager").ea("NotificationBarImageErrorIsEnabled"),a.resolve("Common.IAppSettingsManager").ea("ImageAccessibilityAltTextOnlyIsEnabled"),
a.resolve("Common.IAppSettingsManager").ea("LogActionForFailedLocalImagePasteIsEnabled"))).as("Box4.Actors.IBox4ImageStewardFactory").singleInstance();a.ha("Box4.Actors.Box4TableStewardFactory",()=>new Az(la.a.instance.resolve("Box4.List.IListEditor"),la.a.instance.resolve("Box4.ITableEditor"),a.resolve("Common.IAppSettingsManager").ea("PasteComplexTablesIsEnabled"),a.resolve("Common.IAppSettingsManager").ea("PasteTableCellMarginImprovementsIsEnabled"))).as("Box4.Actors.IBox4TableStewardFactory").singleInstance();
a.ha("Box4.Actors.ClipboardOperationWordStrategy",()=>new My(Ch.a.instance,Lg.a.instance,Lb.App.lc,aj.a.instance,uf.a.instance.J(4))).singleInstance();a.ha("Box4.Actors.Box4WordConverterFactory",()=>new ex(l.AFrameworkApplication.K)).as("Box4.Actors.IBox4WordConverterFactory").singleInstance();a.ha("Box4.Actors.IExternalPasteCssConverter",()=>new Ny(l.AFrameworkApplication.K)).singleInstance();a.ha("Box4.Actors.IHtmlNormalizerHelper",()=>new fp).singleInstance();a.ha("Box4.ISelectionCommands",()=>
new Ju(l.AFrameworkApplication.pa)).singleInstance();a.ha("Box4.ITextFormattingCommands",()=>new Lv(l.AFrameworkApplication.pa)).singleInstance();a.ha("Box4.Actors.AccessibilityActor",()=>new Ii(a.Ca("Box4.Accessibility.IAccessibilityContextManager"),a.resolve("Box4.Proofing.IErrorRangeEditor"))).singleInstance();a.ha("Box4.Actors.InsertionPointFormatting",()=>new Su(a.sa("Box4.IFontSlotProvider"),a.Ca("Box4.Actors.IFontNameFormattingStrategy"))).as("Box4.IInsertionPointFormatting").singleInstance();
a.ha("Box4.UI.PasteFloatieManager",()=>new Er).as("Box4.UI.IFloatieManager").singleInstance();a.ha("Box4.Actors.ProofingActor",()=>new qx(la.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),l.AFrameworkApplication.pa,()=>la.a.instance.resolve("Box4.UI.ILanguageDialog"),la.a.instance.resolve("Box4.ICharacterPropertiesEditor"),la.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Lg.a.instance,la.a.instance.Ca("Box4.IExternalSelectionManager"),tp.a.instance,la.a.instance.resolve("Box4.ISelectionContextMenuProvider"),
aj.a.instance,Ch.a.instance,la.a.instance.resolve("Box4.IContextMenuController"),la.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),la.a.instance.Ca("Box4.Actors.IProofingErrorPresenter"),uf.a.instance,la.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),la.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();a.ha("Box4.Actors.StyleActor",()=>new Ns(la.a.instance.resolve("Box4.ICharacterPropertiesEditor"),la.a.instance.resolve("Box4.Styles.IWACStyleEditor"),
la.a.instance.resolve("Box4.IFormattingEditor"),bl.ContextSetEditor.instance,la.a.instance.resolve("Box4.IInsertionPointFormatting"),aj.a.instance,Ch.a.instance,la.a.instance.resolve("Box4.TextFormattingHelper"),tt.instance,la.a.instance.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();a.ha("Box4.Actors.StyleContextMenuActor",()=>new mr(la.a.instance.resolve("Box4.IUpdateStyleManager"),la.a.instance.resolve("Box4.Styles.IWACStyleReader"),l.AFrameworkApplication.pa)).singleInstance();a.ha("Box4.Actors.TextFormattingActor",
()=>new ww.a(a.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),a.resolve("Box4.IBox4GraphWriter"),a.sa("Box4.IFontSlotProvider"))).singleInstance();a.ha("Box4.Actors.AutoCorrectActor",()=>new au(l.AFrameworkApplication.pa,Ch.a.instance,()=>la.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog"))).singleInstance();a.ha("Box4.Actors.TouchInputActor",()=>new Yn(l.AFrameworkApplication.pa,l.AFrameworkApplication.K,ot.GrippersManager.instance,Lg.a.instance)).as("Box4.ITouchInputActor").singleInstance();
a.register(Vx,"Box4.VisiMarkersOperation").as("Box4.IVisiMarkersOperation").singleInstance();a.ha("Box4.Actors.VisiMarkersActor",()=>new xw(l.AFrameworkApplication.pa,a.resolve("Box4.IVisiMarkersOperation"))).singleInstance();a.ha("Box4.Actors.IndentationActorExtension",()=>new Fo).as("Box4.Actors.IIndentationActorExtension").singleInstance()}}Object(t.a)(kv,"Box4ActorsComponentConfiguration",null,[2]);var gy=b(959);const Hz=()=>{const a=rx;l.AFrameworkApplication.pa.ma(Mb.a.Vre,Kb.a.embeddedFile,
a);l.AFrameworkApplication.pa.ma(Mb.a.Vre,Kb.a.n4a,a);l.AFrameworkApplication.pa.ma(Mb.a.Ure,Kb.a.embeddedFile,lv);l.AFrameworkApplication.pa.ma(Mb.a.Ure,Kb.a.n4a,lv)},rx=(a,d,n)=>Lb.App.WCc?8:2===n?(a=new $g.StandardDialog,a.wc=4,a.j5(1),a.ee(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),a.ee(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),a.MZe(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,hy),32):2,hy=a=>{1===a&&l.AFrameworkApplication.pa.processAction(Mb.a.Ure,
2)},lv=(a,d,n)=>{if(Lb.App.WCc)return 8;if(1===n)return d.node.hasProperty(Vd.a.embeddedFileContainer)?32:2;if(2===n&&(d.contextId===Kb.a.view&&d.view.Oa&&(d=d.view.Oa.Ag),rw.isEmbeddedFileOrFloatingEmbeddedFileContext(d))){a=gy.a.Pzl(d.node);Fa.a.Ezj("DownloadCheck","1",6E4,"/o/GetImage.ashx");try{ds(a)}catch(z){k.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",z)}}return 32},ds=a=>{Ye.a.Tk(a,void 0,void 0,"EmbeddedFileActor.SaveFile")};var yw=b(701),Jt=b(489),Tu=b(1435),zw=
b(1590);class pr{constructor(a){this.F1=null;this.tnf=a}get gqi(){this.F1||(this.F1=new zw.a(pr.p8h),this.Jnb(this.F1));return this.F1}Jnb(a){a.jqa(1,Mb.a.yaa);a.jqa(3,Mb.a.$v);a.jqa(4,Mb.a.$v);a.jqa(5,Mb.a.Uta);a.jqa(6,Mb.a.mta);a.wyc(this.tnf,1)}lb(){const a=l.AFrameworkApplication.pa;a.ma(Mb.a.mta,Kb.a.view,Object(m.a)(this,this.mta,"openMoreColorsDialog"));a.ma(Mb.a.OKb,Kb.a.view,Object(m.a)(this,this.OKb,"populateFontColor"));a.$b(Mb.a.OKb,1127)}mta(a,d,n,z,O){if(1===n)return 32;l.AFrameworkApplication.pa.ob(Mb.a.X7a,
2,O);a=O&&0<=O.fontColor&&16777215>=O.fontColor?O.fontColor:0;Lb.App.oa.OA();(new Tu.a(pr.p8h,Mb.a.Uta)).vVd(a);return 32}OKb(a,d,n,z,O){if(1===n)return 32;if(2===n&&!O)return 8;a=pr.yc.Ivd(d);d=new yw.a;n=null;32===l.AFrameworkApplication.pa.ob(Mb.a.X7a,2,d)&&d&&(n=d.fontColor);z="";n&&!d.Ykb&&(z=zl.a.LA(n)||"");this.gqi.KRc=z;a=this.gqi.Ave(a,Lb.App.S4b);if(!a)return 8;O.MenuItems=a;k.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32}static yAl(){return new pr(Jt.a.instance)}static get instance(){return pr.Kh||
(pr.Kh=pr.yAl())}static get yc(){return mi.PageReader.instance}}pr.p8h="Font";pr.Kh=null;Object(t.a)(pr,"FontColorActor",null,[]);class Os{constructor(a){this.ga=a}lb(){this.ga.ma(Mb.a.pKg,Kb.a.view,Object(m.a)(this,this.mta,"openMoreColorsDialog"))}mta(a,d,n,z,O){if(1===n)return 32;l.AFrameworkApplication.pa.ob(Mb.a.X7a,2,O);a=O&&0<=O.highlight&&16777215>=O.highlight?O.highlight:0;Lb.App.oa.OA();(new Tu.a("Highlighter",Mb.a.Gha)).vVd(a);return 32}static fCl(){return new Os(l.AFrameworkApplication.pa)}static get instance(){return Os.Kh||
(Os.Kh=Os.fCl())}}Os.Kh=null;Object(t.a)(Os,"HighlighterColorActor",null,[]);var Ln=b(288),Uu;(function(a){a.Heading="Heading";a.Bookmark="Bookmark";a.Url="Url";a.RecentLinks="RecentLinks"})(Uu||(Uu={}));Object(t.b)("InsertLinkUserActivitySource",Uu);class Eh{constructor(a,d,n){this.OTb=this.tf=this.Tn=this.tpa=null;this.q4c=!1;this.Ru=null;this.oc=Ic.InteractiveViewManager.instance.sc;this.$l=a;this.Tn=n;this.Ru=d;Eh.laa&&Qd.SelectionEditor.Ch(a)&&(a=Qd.SelectionEditor.foc(this.$l),Qd.SelectionEditor.Ch(a)?
this.$l=a:k.ULS.sendTraceTag(41522313,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak."));a=Qd.SelectionEditor.lvb(this.$l);Qd.SelectionEditor.Ch(a)&&(this.$l=a)}get tga(){return this.tpa||(this.tpa=la.a.instance.sa("Box4.IInternalLinkManager"))}get Aj(){return this.tf||(this.tf=la.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}mpg(){return null!=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertInternalLinkIsEnable",
!1)}get titleText(){return Box4Intl.Box4Strings.l_InsertLinkTitle}get uNi(){return Box4Intl.Box4Strings.l_InsertLinkButtonText}dispose(){}omi(a,d,n){if(d!==this.$l.cpEnd||a!==this.$l.cpBegin)a=ye.SelectionFactory.wX(n,a,d),this.oc.Oa.setSelection(a),this.$l=Qd.SelectionEditor.lvb(a.ra.clone())}nwi(a){const d=hg.HyperlinkReader.g$b(this.$l);let n=this.$l.cpBegin,z=this.$l.cpEnd,O="";if(!d.length)return this.OTb=a.substring(this.$l.cpBegin,this.$l.cpEnd),{returnValue:!0,JWe:O,yte:n,zte:z,ZCe:d};if(d[0].hyperlink){let ca=
0,Da=0,Xa=Math.max(0,a.length-1),zb=0;for(let Vb=0;Vb<d.length;Vb++)d[Vb].cpBegin>=Da&&({cpBegin:ca,cpEnd:Da}=Eh.XL.vba(this.$l,d[Vb],ca,Da),Xa=Math.min(ca,Xa),zb=Math.max(Da,zb));n=Math.min(Xa,n);z=Math.max(zb,z);this.OTb=a.substring(n,z);n===Xa&&(O=d[0].hyperlink.url);return{returnValue:!0,JWe:O,yte:n,zte:z,ZCe:d}}return{returnValue:!1,JWe:O,yte:n,zte:z,ZCe:d}}ebh(a){uf.a.instance.J(3)&&Eh.hd.dbh(a)}XDe(a,d){if(this.oc.mn){var n=hg.HyperlinkReader.g$b(this.$l);var z=this.oc.Oa.ya.Ba;if(z){z=z.ra;
Bd.ParagraphReader.rh(z)&&(z=fe.a.createTextRange(z.node,0,Bd.ParagraphReader.textLength(z.node)));if(Eh.laa&&Qd.SelectionEditor.Ch(z)){var O=Qd.SelectionEditor.foc(z);Qd.SelectionEditor.Ch(O)?z=O:k.ULS.sendTraceTag(41522316,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}O=Qd.SelectionEditor.lvb(z);Qd.SelectionEditor.Ch(O)&&(z=O);if(0!==a&&32===l.AFrameworkApplication.pa.rf(z,Mb.a.insertHyperlink,1,!0,null,null)&&this.$l.equals(z)){Mh.a.mark(5562);
uf.a.instance.J(4)&&Lb.App.lc&&Lb.App.lc.eq&&this.oc.Oa.h2b();a=new Ff.GraphTransaction(15);a.Sa(this.$l.node);this.$l.node.dD().uE.cfa(4);z=d.txtDisplay;O=!1;if(this.mpg()&&null!=d.linkurl)if(O=!0,d.isHeading){f(this.Ru,"Heading");const ca=d.paragraphNode,Da=d.startCp,Xa=d.endCp;d=this.Tn.Fti(ca);this.Tn.eyc(d,Da,Xa,ca,ca,!1)}else f(this.Ru,"Bookmark"),d=d.linkurl;else f(this.Ru,"Url"),d=d.txtLink.trim();this.insertLink(z,d,n,O);a.om=Mb.a.insertHyperlink;a.dispose();Mh.a.mark(5563);this.$l.node.Ofa();
this.BU()}else this.oc.AD()}else k.ULS.sendTraceTag(41522314,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}}tKj(a,d,n,z,O,ca=!1){z?(z=fe.a.createTextRange(this.$l.node,this.$l.cpBegin,this.$l.cpBegin+a.length),Eh.hyperlinkEditor.Yii(z,n,d),a=ye.SelectionFactory.Pc(this.$l.node,this.$l.cpBegin+a.length)):(Eh.hyperlinkEditor.Cqb(this.$l,2),this.Aj.tNb(this.$l,2),n=fe.a.Kb(this.$l.node,this.$l.cpEnd),Eh.characterPropertiesEditor.replaceTextRange(n,a,!0),z=fe.a.createTextRange(this.$l.node,
this.$l.cpEnd,this.$l.cpEnd+a.length),Eh.hyperlinkEditor.vP(z,d,O,!1,!0,ca),a=ye.SelectionFactory.Pc(this.$l.node,this.$l.cpEnd+a.length));a&&this.oc.Oa.setSelection(a)}insertLink(a,d,n,z=!1){var O=null;a||(a=d,l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",!0)&&(a=a.replace(/[\r\n\v]/g,"")));if(d&&(!n.length||d!==n[0].hyperlink.url)&&!z){d=hg.HyperlinkReader.ega(d);var ca="";this.tga&&({KTg:ca}=this.tga.kbh(d)).returnValue&&(d=ca)}this.q4c||(a=
Eh.hyperlinkEditor.k$m(a));let Da=!1;ca=!1;if(d){var Xa=0<n.length;O=!0;Eh.Sbm&&(O=Bd.ParagraphReader.text(this.$l.node).substring(this.$l.cpBegin,this.$l.cpEnd)!==a);if(Eh.hd.Jf&&1===n.length&&!n[0].hyperlink.Yz&&!(n[0].cpBegin>this.$l.cpBegin&&n[0].cpEnd<=this.$l.cpEnd)){this.tKj(a,d,n[0].hyperlink,!O,Xa,z);return}if(Xa)for(var zb=0;zb<n.length;zb++)n[zb].hyperlink.Yz&&(ca=!0),Eh.hyperlinkEditor.EV(this.$l.node,n[zb].hyperlink,!1);O&&Eh.characterPropertiesEditor.replaceTextRange(this.$l,a,!ca);
O||!Eh.hd.Jf||ca||this.Aj.tNb(this.$l,1);n=fe.a.createTextRange(this.$l.node,this.$l.cpBegin,this.$l.cpBegin+a.length);Eh.hyperlinkEditor.vP(n,d,Xa,ca,!0,z);O=ye.SelectionFactory.Pc(this.$l.node,this.$l.cpBegin+a.length)}else if(0<n.length){z=n[0];const Vb=({cpBegin:Xa,cpEnd:zb}=Eh.XL.vba(this.$l,z,Xa,zb)).returnValue;z.hyperlink.Yz&&(ca=!0);d?z.hyperlink.kUa?(d!==z.hyperlink.url&&(Eh.hd.Jf&&!ca?(n=fe.a.createTextRange(this.$l.node,Xa,Xa+a.length),Eh.hyperlinkEditor.Yii(n,z.hyperlink,d)):Eh.XL.OMn(d,
Vb)),a!==this.OTb&&(Eh.characterPropertiesEditor.replaceTextRange(fe.a.createTextRange(this.$l.node,Xa,zb),a,!0),d=fe.a.createTextRange(this.$l.node,Xa,Xa+a.length),this.ebh(d),O=ye.SelectionFactory.Pc(this.$l.node,Xa+a.length),Da=!0)):Eh.hd.Jf&&!ca?(Xa=Bd.ParagraphReader.text(this.$l.node).substring(this.$l.cpBegin,this.$l.cpEnd)===a,this.tKj(a,d,n[0].hyperlink,Xa,!1)):(Eh.XL.jUg(this.$l,Vb),Eh.characterPropertiesEditor.replaceTextRange(fe.a.createTextRange(this.$l.node,Xa,zb),a,!ca),n=fe.a.createTextRange(this.$l.node,
Xa,Xa+a.length),Eh.hyperlinkEditor.vP(n,d,!1,ca),O=ye.SelectionFactory.Pc(this.$l.node,Xa+a.length)):Eh.hyperlinkEditor.EV(z.paragraph,z.hyperlink)}(Da||ca)&&Eh.hd.Ws(ca?2:7);O&&this.oc.Oa.setSelection(O);Lb.App.YKj()}static get hyperlinkEditor(){return Eh.lk||(Eh.lk=la.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return Eh.hc||(Eh.hc=la.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get hd(){return Eh.Eb||(Eh.Eb=la.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get XL(){return Eh.XT||
(Eh.XT=la.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get Sbm(){null==Eh.wjf&&(Eh.wjf=l.AFrameworkApplication.K?l.AFrameworkApplication.K.ea("KeepHyperlinkFormatFixIsEnabled"):!1);return Eh.wjf}static get gcc(){null==Eh.DVb&&(Eh.DVb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.ea("HyperlinkUrlValidationIsEnabled"):!1);return Eh.DVb}static get laa(){null==Eh.y1&&(Eh.y1=l.AFrameworkApplication.K?l.AFrameworkApplication.K.ea("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Eh.y1}}
Eh.lk=null;Eh.hc=null;Eh.Eb=null;Eh.XT=null;Eh.wjf=null;Eh.DVb=null;Eh.y1=null;Eh.source="Source";Eh.x8h="CommandingInterface";Eh.Ijb="DisplayText";Eh.url="Url";Eh.id="InsertLinkDialog";Object(t.a)(Eh,"AInsertLinkDialog",null,[12]);class Vu{static get Lf(){return xg.a.oz(Vu.fm,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}Vu.fm="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(t.a)(Vu,"InsertLinkDialogHtml",null,[]);class Wu extends Eh{constructor(a,d){super(a,d);this.$d=new xg.a;this.$d.Je=Eh.id;let n=this.OTb="";var z=Bd.ParagraphReader.text(this.$l.node);let O=this.$l.cpBegin,ca=this.$l.cpEnd;({JWe:n,yte:O,zte:ca,ZCe:z}=this.nwi(z));(d="object"===typeof d?d:null)&&(d[Eh.source]&&d[Eh.source]===Eh.x8h||d[Eh.url]&&d[Eh.Ijb])?this.insertLink(d[Eh.Ijb],d[Eh.url],z):(z[0]&&this.omi(O,ca,z[0].paragraph),this.$d.Lf=Vu.Lf,""===n.trim()&&this.$d.ee(1,this.uNi),d={["txtLink"]:n,
["txtDisplay"]:this.OTb},this.$d.UDb=Object(m.a)(this,this.YR,"dialogDefaultEnterKeyHandler"),this.$d.TDb=Object(m.a)(this,this.YR,"dialogDefaultEnterKeyHandler"),this.$d.Ih(this.titleText,Object(m.a)(this,this.XDe,"insertLinkDialogHandler"),d),Eh.gcc&&(d=document.getElementById("txtLink"),Qc.a.addHandler(d,vb.a.input,Object(m.a)(this,this.Sqb,"onLinkChanged")),Qc.a.addHandler(d,vb.a.change,Object(m.a)(this,this.Sqb,"onLinkChanged"))),document.getElementById("txtLink").focus(),Eh.laa?0<Lj.g(fe.a.NR(O,
ca,!1,this.$l.node)).length&&(this.q4c=!0,document.getElementById("txtDisplay").disabled=!0):1>=z.length&&Eh.XL.p$h(a,z[0],1===z.length)&&(this.q4c=!0,document.getElementById("txtDisplay").disabled=!0))}Sqb(){if(this.$d){const a=document.getElementById("txtLink");this.$d.Cha(1,!a||!a.value.length||hg.HyperlinkReader.oJa(a.value))}}YR(a){return this.$d?Eh.gcc?this.$d.T5f(this.$d.dNa)?this.$d.YR(a):!1:this.$d.YR(a):!1}BU(){if(Eh.gcc){const a=document.getElementById("txtLink");a&&(Qc.a.removeHandler(a,
vb.a.change,Object(m.a)(this,this.Sqb,"onLinkChanged")),Qc.a.removeHandler(a,vb.a.input,Object(m.a)(this,this.Sqb,"onLinkChanged")))}this.$d&&(this.$d=null)}}Object(t.a)(Wu,"InsertLinkDialog",Eh,[]);class $q{constructor(a,d,n,z,O){this.linkurl=a;this.isHeading=d;this.startCp=n;this.endCp=z;this.paragraphNode=O}}Object(t.a)($q,"HeadingDataForLinkDialog",null,[]);class sx{constructor(a,d){this.linkurl=a;this.isHeading=d}}Object(t.a)(sx,"BookmarkDataForLinkDialog",null,[]);class Mv{constructor(a,d,n,
z,O,ca){this.key=a;this.name=d;this.startIndex=n;this.count=z;this.level=O;this.isCollapsed=ca}}Object(t.a)(Mv,"GroupHeaderDataForLinkDialog",null,[]);class Aw{constructor(a,d){this.selectedIndex=a;this.selectedGroupId=d}}Object(t.a)(Aw,"SelectedItemFromLinkDialogGroupedList",null,[]);class Bw extends Eh{constructor(a,d,n,z,O){super(a,d,z);this.M7j=n;this.te=O;const ca=new xg.a(!1,!1,!0);n={};n.displayTextLabel=Box4Intl.Box4Strings.l_InsertLinkDisplayText;n.addressLabel=Box4Intl.Box4Strings.l_InsertLinkAddress;
l.AFrameworkApplication.Yi("InsertInternalLinkIsEnable;InsertInternalLinkIsEnablecf");this.mpg()&&(n.insertInternalLinkEnabled=!0,n.enterLinkTabLabel=Box4Intl.Box4Strings.l_EnterLinkText,n.thisDocumentTabLabel=Box4Intl.Box4Strings.l_ThisDocumentText,n.groupedList=this.sBl());var Da=this.OTb="";Da=Bd.ParagraphReader.text(this.$l.node);z=this.$l.cpBegin;O=this.$l.cpEnd;let Xa;({JWe:Da,yte:z,zte:O,ZCe:Xa}=this.nwi(Da));if((d="object"===typeof d?d:null)&&(d[Eh.source]&&d[Eh.source]===Eh.x8h||d[Eh.url]&&
d[Eh.Ijb]))this.insertLink(d[Eh.Ijb],d[Eh.url],Xa);else{Xa[0]&&this.omi(z,O,Xa[0].paragraph);d=CommonUIStrings.l_DialogOk;""===Da.trim()&&(d=this.uNi);ca.ee(1,d);this.mpg()&&Da&&Da.startsWith(w.a.EGa)?(d=this.MNl(Da,n.groupedList))?n.groupedList.selectedItem=d:n.txtLink=Da:n.txtLink=Da;n.txtDisplay=this.OTb;Eh.laa?0<Lj.g(fe.a.NR(z,O,!1,this.$l.node)).length&&(this.q4c=!0,n.textDisplayDisabled=!0):1>=Xa.length&&Eh.XL.p$h(a,Xa[0],1===Xa.length)&&(this.q4c=!0,n.textDisplayDisabled=!0);var zb={["id"]:Eh.id,
["bodyControls"]:n};this.te.Fd(()=>{ca.Ih(this.titleText,Object(m.a)(this,this.XDe,"insertLinkDialogHandler"),zb)},"RILD:IAS")}}MNl(a,d){d=d.items;const n=a.substring(w.a.EGa.length),z=this.Tn.mag(n);a=-1;let O=0;for(let ca=0;ca<d.length;ca++)if(d[ca].isHeading&&0!=z.count&&d[ca].paragraphNode.id==z.J(0).id){a=ca;break}else if(!d[ca].isHeading&&d[ca].linkurl==n){a=ca;O=1;break}d=new Aw(a,O);return-1!=a?d:null}sBl(){const a={};let d=[],n=0,z=0;var O=this.M7j.QBl();null!=O&&(n=O.count,d=d.concat(this.SBl(O)));
O=this.Tn.$Ec(!1);null!=O&&(z=O.count,d=d.concat(this.ktl(O)));a.groups=this.LBl(n,z);a.items=d;return a}LBl(a,d){const n=[];let z=new Mv("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,0,a,0,!0);n.push(z);a=new Mv("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,a,d,0,!0);n.push(a);return n}SBl(a){const d=[];for(const n of a)a=new $q(n.characterData,!0,n.begin,n.end,n.paragraphNode),d.push(a);return d}ktl(a){const d=[];for(const n of a)a=n.Se(Qb.a.Ut).toString(),
a=new sx(a,!1),d.push(a);return d}BU(){}}Object(t.a)(Bw,"ReactInsertLinkDialog",Eh,[]);class ku{constructor(){this.sFa=!!l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.wz}sci(a,d,n,z){this.sFa?new Bw(a,d,n,z,Ln.a.instance):new Wu(a,d)}static get instance(){return ku.na||(ku.na=new ku)}}ku.na=null;Object(t.a)(ku,"InsertLinkDialogFactory",null,[458]);class Dn extends xg.a{constructor(a){super();this.XZ=a;this.oc=Ic.InteractiveViewManager.instance.sc;this.Sp=this.oc.Oa.ya.Ba;this.c2f=a[0].cpBegin;
this.wug=a[a.length-1].cpEnd;this.Je="InsertMultiParagraphLinkDialog";a=this.cMn();this.showDialog("",a)}showDialog(a,d){k.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.Lf=Vu.Lf;""===d.trim()&&this.ee(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);a={["txtLink"]:d,["txtDisplay"]:a};this.Ih(Box4Intl.Box4Strings.l_InsertLinkTitle,Object(m.a)(this,this.XDe,"insertLinkDialogHandler"),a);document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=
!0;Dn.gcc&&(a=document.getElementById("txtLink"),Qc.a.addHandler(a,vb.a.input,Object(m.a)(this,this.Sqb,"onLinkChanged")),Qc.a.addHandler(a,vb.a.change,Object(m.a)(this,this.Sqb,"onLinkChanged")))}hide(){if(Dn.gcc){const a=document.getElementById("txtLink");a&&(Qc.a.removeHandler(a,vb.a.change,Object(m.a)(this,this.Sqb,"onLinkChanged")),Qc.a.removeHandler(a,vb.a.input,Object(m.a)(this,this.Sqb,"onLinkChanged")))}super.hide()}Sqb(){const a=document.getElementById("txtLink");this.Cha(1,!a||!a.value.length||
hg.HyperlinkReader.oJa(a.value))}YR(a){return Dn.gcc?this.T5f(this.dNa)?super.YR(a):!1:super.YR(a)}cMn(){let a,d;var n="";const z=this.XZ.length;var O=hg.HyperlinkReader.vw(this.XZ[0],!1);0<O.length&&({cpBegin:a,cpEnd:d}=Dn.XL.vba(this.XZ[0],O[0],a,d),a<=this.XZ[0].cpBegin&&(n=O[0].hyperlink.url),this.c2f=Math.min(this.c2f,a));O=hg.HyperlinkReader.vw(this.XZ[z-1],!1);0<O.length&&({cpBegin:a,cpEnd:d}=Dn.XL.vba(this.XZ[z-1],O[O.length-1],a,d),this.wug=Math.max(this.wug,d));this.gHn(this.c2f,this.wug);
return n}gHn(a,d){const n=this.XZ.length;if(a!==this.XZ[0].cpBegin||d!==this.XZ[n-1].cpEnd){a=fe.a.Kb(this.XZ[0].node,a);a=ye.SelectionFactory.uj(a);d=fe.a.Kb(this.XZ[n-1].node,d);d=ye.SelectionFactory.Mx(a,d);a=this.AFi(d.ra.clone());const z=this.AFi(d.Fb.clone());a&&z&&(this.XZ[0]=a,this.XZ[n-1]=z,this.oc.Oa.setSelection(d),this.Sp=d)}}XDe(a,d){if(this.oc.mn){var n=this.oc.Oa.ya.Ba;if(n)if(n.equals(this.Sp)&&0!==a){a=new Ff.GraphTransaction(15);a.Sa(this.XZ[0].node);for(n=0;n<this.XZ.length;n++)this.XZ[n].node.dD().uE.cfa(4);
n=d.txtLink.trim();d=this.f8k();n=this.r5l(n);(d||n)&&Dn.hd.Ws(7);this.hide();a.dispose()}else this.oc.AD()}}r5l(a){if(!a)return!1;a=hg.HyperlinkReader.ega(a);for(let n=0;n<this.XZ.length;n++){var d=this.XZ[n];if(Dn.laa&&Qd.SelectionEditor.Ch(d)&&(d=Qd.SelectionEditor.foc(d),!Qd.SelectionEditor.Ch(d)))continue;d=fe.a.createTextRange(this.XZ[n].node,d.cpBegin,d.cpEnd);this.ebh(d);Dn.hyperlinkEditor.vP(d,a,!1)}return!0}ebh(a){uf.a.instance.J(3)&&Dn.hd.dbh(a)}AFi(a){return Bd.ParagraphReader.rh(a)&&
!Qd.SelectionEditor.SN(a)&&Bd.ParagraphReader.textLength(a.node)?fe.a.createTextRange(a.node,0,Bd.ParagraphReader.textLength(a.node)):Qd.SelectionEditor.Ch(a)?a:null}f8k(){let a=!1;for(const d of this.XZ){const n=hg.HyperlinkReader.vw(d,!1);n&&(a=Dn.XL.jUg(d,n)||a)}return a}static get XL(){return Dn.XT||(Dn.XT=la.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get hd(){return Dn.Eb||(Dn.Eb=la.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get hyperlinkEditor(){return Dn.lk||
(Dn.lk=la.a.instance.resolve("Box4.IHyperlinkEditor"))}static get laa(){null==Dn.y1&&(Dn.y1=l.AFrameworkApplication.K?l.AFrameworkApplication.K.ea("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Dn.y1}static get gcc(){null==Dn.DVb&&(Dn.DVb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.ea("HyperlinkUrlValidationIsEnabled"):!1);return Dn.DVb}}Dn.XT=null;Dn.Eb=null;Dn.lk=null;Dn.y1=null;Dn.DVb=null;Object(t.a)(Dn,"InsertMultiParagraphLinkDialog",xg.a,[]);class Oe{static get bookmarkManager(){return Oe.Tn||
(Oe.Tn=la.a.instance.vf("WordEditor.Bookmark.FullBookmarkManager").value)}static get pDc(){return Oe.NEa||(Oe.NEa=la.a.instance.vf("WordEditor.TableOfContents.StyleBasedDocumentHeadings").value)}static get If(){return aj.a.instance}static get rla(){return Oe.P5||(Oe.P5=la.a.instance.sa("Box4.IContentControlChpHelper"))}static get XL(){return Oe.XT||(Oe.XT=la.a.instance.resolve("Box4.IHyperlinkStrategy"))}static sz(){return Oe.Wl||(Oe.Wl=la.a.instance.Ca("Box4.IExternalSelectionManager"))}static get hd(){return Oe.Eb||
(Oe.Eb=la.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Wi(){return Oe.zt||(Oe.zt=la.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get jg(){return bl.ContextSetEditor.instance}static get Lb(){return Ch.a.instance}static get HId(){null==Oe.TPb&&(Oe.TPb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.ea("MultiParagraphHyperlinkEditEnabled"):!1);return Oe.TPb}static get laa(){null==Oe.y1&&(Oe.y1=l.AFrameworkApplication.K?
l.AFrameworkApplication.K.ea("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Oe.y1}static get hyperlinkEditor(){return Oe.lk||(Oe.lk=la.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return Oe.hc||(Oe.hc=la.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get jEd(){Oe.F9d||(l.AFrameworkApplication.K?(l.AFrameworkApplication.Yi("recentLinks;recentLinkscf"),Oe.F9d=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",
!1)):Oe.F9d=!1);return Oe.F9d}static get WDn(){Oe.bQh||(Oe.bQh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.timeInMillisBetweenTwoMRUCalls",6E4):6E4);return Oe.bQh}static lb(){const a=l.AFrameworkApplication.pa;a.ma(Mb.a.insertHyperlink,Kb.a.view,Oe.iIc);a.ma(Mb.a.insertHyperlink,Kb.a.Ub,Oe.insertLink);a.ma(Mb.a.insertHyperlink,Kb.a.Lc,Oe.insertLink);a.$b(Mb.a.insertHyperlink,1028);a.ma(Mb.a.EV,Kb.a.view,Oe.iIc);a.ma(Mb.a.EV,Kb.a.Ub,Oe.pnj);a.ma(Mb.a.EV,
Kb.a.Lc,Oe.pnj);a.$b(Mb.a.EV,1028);a.ma(Mb.a.SSd,Kb.a.view,Oe.iIc);a.ma(Mb.a.SSd,Kb.a.Ub,Oe.zuj);a.ma(Mb.a.SSd,Kb.a.Lc,Oe.zuj);a.ma(Mb.a.NWa,Kb.a.view,Oe.iIc);a.ma(Mb.a.NWa,Kb.a.Ub,Oe.Ubj);a.ma(Mb.a.NWa,Kb.a.Lc,Oe.Ubj);a.ma(Mb.a.NWa,Kb.a.image,Oe.gKg);a.ma(Mb.a.NWa,Kb.a.dTa,Oe.gKg);uf.a.instance.J(5)&&a.ma(Mb.a.NWa,Kb.a.anchoredObject,Oe.gKg);a.ma(Mb.a.Amd,Kb.a.view,Oe.iIc);Oe.jEd&&(a.Aa(Sa.a.h8a,Kb.a.view,this.iIc.bind(this),1028),a.ma(Sa.a.h8a,Kb.a.Ub,this.h8a.bind(this)),a.ma(Sa.a.h8a,Kb.a.Lc,
this.h8a.bind(this)),a.$b(Sa.a.h8a,1028),a.ma(Sa.a.YDe,Kb.a.Ub,this.h8a.bind(this)),a.ma(Sa.a.YDe,Kb.a.Lc,this.h8a.bind(this)),a.$b(Sa.a.YDe,1028),a.ma(Sa.a.qRe,Kb.a.view,this.qRe.bind(this)),a.ma(Sa.a.mRe,Kb.a.view,this.mRe.bind(this)),a.Aa(Sa.a.Wnb,Kb.a.Ub,this.Wnb.bind(this),96),a.Aa(Sa.a.Wnb,Kb.a.Lc,this.Wnb.bind(this),96))}static h8a(a,d){if(!Oe.jEd)return 2;a=Oe.CRj(d);return 32!=a?a:!Oe.m6a(d,!0,null).returnValue||Oe.kBc(d)?8:32}static qRe(a,d,n,z,O){if(!Oe.jEd)return 2;if(1===n)return 32;
Oe.bSg(Oe.Ajk,Oe.Bjk,Oe.Kkk);Ln.a.instance.Fd(()=>{Oe.QPj();O.MenuItems=Object.assign(new he.a,{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const ca=this.ndi();ca?(k.ULS.sendTraceTag(526242130,324,50,"Recent Links data load success in ribbon"),Array.add(O.MenuItems.MenuSectionList,ca)):(k.ULS.sendTraceTag(526242131,324,50,"Recent Links could not load in ribbon"),Array.add(O.MenuItems.MenuSectionList,this.odi()))},"HA:PRLF");return 32}static mRe(a,d,n,z,O){if(!Oe.jEd)return 2;if(1===
n)return 32;Oe.bSg(Oe.yjk,Oe.zjk,Oe.Hkk);Ln.a.instance.Fd(()=>{Oe.QPj();O.MenuItems=Object.assign(new he.a,{Id:"InsertLinkFlyoutList",MenuSectionList:[],UpdateDynamically:!0});Array.add(O.MenuItems.MenuSectionList,this.D1k());const ca=this.ndi(!0);ca?(k.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),Array.add(O.MenuItems.MenuSectionList,ca)):(k.ULS.sendTraceTag(526242133,324,50,"Recent Links could not load in context menu"),Array.add(O.MenuItems.MenuSectionList,
this.odi()))},"HA:PILF");return 32}static odi(){const a=this.fSf("RecentLinksNoDataSection",!1);Array.add(a.ControlList,Object.assign(new Xg.a,{ExternalId:"RecentLinksNoDataSection",LabelText:"No links available right now"}));return a}static D1k(){const a=this.fSf("InsertLinkSection");Array.add(a.ControlList,Object.assign(new Xg.a,{ExternalId:"InsertLink"}));return a}static ndi(a=!1){if(Aj.instance.dsf){var d=this.fSf("RecentLinksSection",a);a=JSON.parse(Aj.instance.dsf);this.esf.clear();a.forEach(n=>
{this.esf.set(n.DocumentUrl,n.FileName);const z=Oe.NLl(n.FileName);var O=Oe.VAl(n.TimeStamp),ca=Array,Da=ca.add,Xa=d.ControlList,zb=Object,Vb=zb.assign,Fc=new Xg.a,Yc=n.DocumentUrl,yd=Sa.a.Wnb,je=Sa.a.Wnb;O=z!==n.FileName?n.FileName+"\n"+O:O;var Le=n.FileName;let Ve="SaveAsWordDocx_32";switch(n.App){case "Word":Ve="SaveAsWordDocx_32";break;case "PowerPoint":Ve="SaveAsPowerPointPptx_32";break;case "Excel":Ve="SaveAsExcelXlsx_32"}Da.call(ca,Xa,Vb.call(zb,Fc,{ExternalId:Yc,Command:yd,CommandValueId:je,
LabelText:z,Alt:O,AriaDescription:Le,ExternalImageId:Ve,KeyTip:n.FileName}))});return d}}static fSf(a,d=!1){return Object.assign(new fi.a,{Title:d?"Recent Links":"",Id:a,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+a,ControlList:[]})}static Wnb(a,d,n,z,O){if(!Oe.jEd)return 2;if(!O||O.CommandValueId!=Sa.a.Wnb)return 32;Oe.bSg(Oe.Sbk,Oe.Tbk,Oe.Jkk);n=new Ff.GraphTransaction(15);n.om=a;n.Sa(d.node);if(!Oe.m6a(d,!0,null).hyperlink&&Qd.SelectionEditor.Cd(d)&&Qd.SelectionEditor.zVa(d)&&
(z=Qd.SelectionEditor.SU(d,!1),z||(z=this.esf.get(O.SourceControlId),Oe.characterPropertiesEditor.replaceTextRange(d,z,!0,void 0,a),z=ye.SelectionFactory.wX(d.node,d.cpBegin,d.cpBegin+z.length)),z&&(Lg.a.instance.setSelection(z),d=z.ra,Oe.kBc(d))))return Oe.hd.lmc(!1),8;try{Oe.hyperlinkEditor.vP(d,O.SourceControlId,0<hg.HyperlinkReader.g$b(d).length),f(O,"RecentLinks")}finally{n&&n.dispose()}k.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static iIc(a,d,n,z,O){if(Oe.HId)return Oe.r0l(a,
d,n,z,O);if(!d.view.Yd)return 2;var ca=d.view.Oa;if(!ca||!ca.ya||!ca.ya.length)return 8;var Da=ca.ya.Ba;let Xa=Da.ra.clone();if(2===Da.length){if(Da=Da.J(1),!Qd.SelectionEditor.Ch(Xa)||!Qd.SelectionEditor.sg(Da)||Xa.node!==Da.node)return 8}else if(2<Da.length)return 8;if(ca.ya.EE)return 8;if(Oe.jg.h9(Bd.ParagraphReader.wS,ca.Ag))return Oe.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.qP}),8;Bd.ParagraphReader.rh(Xa)&&!Qd.SelectionEditor.SN(Xa)&&(ca=Xa.node,Xa=fe.a.createTextRange(ca,0,Bd.ParagraphReader.textLength(ca)));
return a===Mb.a.Amd?Oe.Oai(d,Xa,n,z):l.AFrameworkApplication.pa.rf(Xa,a,n,!0,z,O)}static r0l(a,d,n,z,O){if(!d.view.Yd)return 2;var ca=d.view.Oa;if(!ca||!ca.ya||!ca.ya.length||ca.ya.EE)return 8;var Da=ca.ya.Ba;if(ca=Oe.jsg(Da))Da=Oe.Qcg(Da.ra.clone(),!0);else{let Xa=Da.J(0).clone(),zb=1;for(;zb<Da.length&&(!Bd.ParagraphReader.textLength(Xa.node)||Qd.SelectionEditor.sg(Xa)||Oe.laa&&Lj.l(Xa));)Xa=Da.J(zb).clone(),zb++;Da=Oe.Qcg(Xa,!1)}return Oe.laa&&Qd.SelectionEditor.Ch(Da)&&Lj.l(Da)||!Qd.SelectionEditor.Ch(Da)&&
!ca?8:a===Mb.a.Amd?Oe.Oai(d,Da,n,z):l.AFrameworkApplication.pa.rf(Da,a,n,!0,z,O)}static jsg(a){if(1===a.length)return!0;if(2===a.length){const d=a.ra.clone();a=a.J(1);return Qd.SelectionEditor.Ch(d)&&Qd.SelectionEditor.sg(a)&&d.node===a.node?!0:!1}return!1}static w9h(a,d){a=null;const n=[];for(let z=0;z<d.length;z++){const O=Oe.Qcg(d.J(z).clone(),!1);if(Qd.SelectionEditor.Ch(O))Oe.laa&&Lj.l(O)||n.push(O);else if(!Qd.SelectionEditor.sg(O)&&!Bd.ParagraphReader.rh(O))return{returnValue:!1,x5b:a}}a=n;
return{returnValue:!Oe.laa||0<a.length?!0:!1,x5b:a}}static insertLink(a,d,n,z,O){if(Oe.HId)return Oe.y5l(d,n,O);a=Oe.CRj(d);if(32!==a)return a;let ca;if(!({hyperlink:ca}=Oe.m6a(d,!0,ca)).returnValue||Oe.kBc(d))return 8;if(1===n)return 32;if(!ca&&Qd.SelectionEditor.Cd(d)&&Qd.SelectionEditor.zVa(d)&&(n=Qd.SelectionEditor.SU(d,!1))&&(Lg.a.instance.setSelection(n),d=n.ra,Oe.kBc(d)))return Oe.hd.lmc(!1),8;ca&&k.ULS.sendTraceTag(593875799,324,50,"Edit link");ku.instance.sci(d,O,Oe.pDc,Oe.bookmarkManager);
return 32}static CRj(a){return!Oe.nKf()||!Oe.Jle(a)||a.node.ko||Lg.a.instance.ya.EE?8:uf.a.instance.J(5)&&Qd.SelectionEditor.m0(a)?2:32}static y5l(a,d,n){var z=Lg.a.instance.ya.Ba;const O=Oe.jsg(z);let ca;if(O)ca=[a];else if(!({x5b:ca}=Oe.w9h(ca,z)).returnValue)return 8;if(!Oe.nKf())return 8;for(a=0;a<ca.length;a++)if(!Oe.Jle(ca[a]))return 8;if(Lg.a.instance.ya.EE)return 8;a=Array(ca.length);z=null;for(let Da=0;Da<ca.length;Da++)if(a[Da]=ca[Da],!({hyperlink:z}=Oe.m6a(a[Da],!0,z)).returnValue||Oe.kBc(a[Da]))return 8;
if(1===d)return 32;if(!z&&1===a.length&&O&&Qd.SelectionEditor.Cd(a[0])&&Qd.SelectionEditor.zVa(a[0])&&(d=Qd.SelectionEditor.SU(a[0],!1))&&(Lg.a.instance.setSelection(d),a[0]=d.ra,Oe.kBc(a[0])))return Oe.hd.lmc(!1),8;O?ku.instance.sci(a[0],n,Oe.pDc,Oe.bookmarkManager):new Dn(a,n);return 32}static pnj(a,d,n){if(Oe.HId)return Oe.I6m(a,d,n);if(!Oe.Jle(d)||uf.a.instance.J(5)&&Qd.SelectionEditor.m0(d))return 2;let z;if(!({hyperlink:z}=Oe.m6a(d,!1,z)).returnValue)return 2;if(2===n){n=new Ff.GraphTransaction(15);
try{n.om=a,n.Sa(z.paragraph),Oe.Rnj(d)}finally{n&&n.dispose()}z.hyperlink.Yz&&Oe.hd.Ws(2)}return 32}static I6m(a,d,n){const z=Lg.a.instance.ya.Ba;let O;if(Oe.jsg(z))O=[d];else if(!({x5b:O}=Oe.w9h(O,z)).returnValue)return 8;if(!Oe.nKf())return 8;for(d=0;d<O.length;d++)if(!Oe.Jle(O[d]))return 8;if(1===n&&!({hyperlink:ca}=Oe.m6a(O[0],!1,ca)).returnValue)return 2;if(2===n){for(n=0;n<O.length;n++)if(!({hyperlink:ca}=Oe.m6a(O[n],!0,ca)).returnValue)return 2;var ca=new Ff.GraphTransaction(15);try{const Da=
O[0];ca.om=a;ca.Sa(Da.node);for(a=0;a<O.length;a++)Oe.Rnj(O[a])}finally{ca&&ca.dispose()}Oe.hd.Ws(7)}return 32}static Rnj(a){const d=hg.HyperlinkReader.g$b(a);let n=0,z=0;for(let O=0;O<d.length;O++)if(d[O].cpBegin>=z){const ca=({cpBegin:n,cpEnd:z}=Oe.XL.vba(a,d[O],n,z)).returnValue;Oe.XL.jUg(a,ca)}}static zuj(a,d,n){if(uf.a.instance.J(5)&&Kd.ImageReader.EAa(d))return 2;let z;if(!({hyperlink:z}=Oe.m6a(d,!1,z)).returnValue)return 2;if(2===n){let O,ca;({cpBegin:O,cpEnd:ca}=Oe.XL.vba(d,z,O,ca));Lg.a.instance.setSelection(ye.SelectionFactory.wX(z.paragraph,
O,ca))}return 32}static Ubj(a,d,n){let z;if(uf.a.instance.J(5)&&({hyperlink:z}=Oe.phm(d,z)).returnValue)k.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:z}=Oe.m6a(d,!1,z)).returnValue)return 2;2===n&&Lb.App.Wkb(z.hyperlink.url);return 32}static gKg(a,d,n){a=Kd.ImageReader.vba(d.node);if(!a)return 2;2===n&&Lb.App.Wkb(a);return 32}static Oai(a,d,n,z){if(uf.a.instance.J(5)&&Kd.ImageReader.EAa(d)||!Ic.InteractiveViewManager.instance.editingView.uk)return 2;
let O;if(!({hyperlink:O}=Oe.m6a(d,!1,O)).returnValue)return 2;if(1===n)return 32;let ca,Da;({cpBegin:ca,cpEnd:Da}=Oe.XL.vba(d,O,ca,Da));Lg.a.instance.setSelection(ye.SelectionFactory.wX(O.paragraph,ca,Da));d=Ic.InteractiveViewManager.instance.rfa.ownerDocument.createElement("span");d.innerText=O.hyperlink.url;d.style.backgroundColor="rgb(255, 255, 255)";return l.AFrameworkApplication.pa.rf(a,Mb.a.zmd,2,!0,z,d)}static m6a(a,d,n){n=null;if(Qd.SelectionEditor.Ch(a)){const z=Lj.g(a),O=Fg.a.all(z,ca=>
6===ca.Qf);if(0<z.length&&(!Oe.laa||!O)||Oe.If.ye&&Oe.rla&&0<Oe.rla.xFc(a).count)return{returnValue:!1,hyperlink:n}}return Oe.ghm(a,d,n)}static phm(a,d){d=null;return Kd.ImageReader.EAa(a)&&(d=hg.HyperlinkReader.O4a(a))?{returnValue:!0,hyperlink:d}:{returnValue:!1,hyperlink:d}}static ghm(a,d,n){n=null;const z=hg.HyperlinkReader.g$b(a);return z.length?z[0].hyperlink?(n=z[0],a.cpBegin<z[0].cpBegin?{returnValue:d,hyperlink:n}:{returnValue:!0,hyperlink:n}):{returnValue:!1,hyperlink:n}:{returnValue:d,
hyperlink:n}}static kBc(a){if(uf.a.instance.J(3)){a=Oe.Wi.$4a(a.node,a.cpBegin,a.cpEnd);for(let d=0;d<a.count;++d)if(2===a.J(d).Vc.changeType)return!0}return!1}static nKf(){return uf.a.instance.J(3)?!0:!uf.a.instance.J(3)||!Lb.App.Yq.MUc}static Jle(a){return Oe.If.E3(a)||Oe.sz()&&Oe.sz().instance&&Oe.sz().instance.l0(a)?!1:!0}static Qcg(a,d){return Bd.ParagraphReader.rh(a)&&!Qd.SelectionEditor.SN(a)&&(Bd.ParagraphReader.textLength(a.node)||d)?fe.a.createTextRange(a.node,0,Bd.ParagraphReader.textLength(a.node)):
a}static NLl(a){return a&&a.length<=Oe.Zjj?a:a.substring(0,Oe.Zjj)+"..."}static VAl(a){try{const d=new Date(a);return d.toLocaleString(void 0,{weekday:"long"})+" at "+d.toLocaleString(void 0,{hour:"numeric",minute:"numeric"})}catch(d){return""}}static QPj(){let a=Date.now();a-Oe.EWi>Oe.WDn&&(Aj.instance.I2i(),Oe.EWi=a)}static bSg(a,d,n){const z=new Map;z.set("Source",n);z.set("Action",d);ja.Health.instance.recordKpiUsage(a,0,this.Sbb,z)}}Oe.P5=null;Oe.XT=null;Oe.Wl=null;Oe.Eb=null;Oe.zt=null;Oe.TPb=
null;Oe.y1=null;Oe.Tn=null;Oe.NEa=null;Oe.lk=null;Oe.hc=null;Oe.esf=new Map;Oe.F9d=null;Oe.Zjj=35;Oe.EWi=Date.now();Oe.Sbb="wwaengidc";Oe.Jkk="RecentLinks";Oe.Kkk="RecentLinksRibbonOptions";Oe.Hkk="RecentLinksContextMenuOptions";Oe.Ajk="PopulateRecentLinksRibbon";Oe.Bjk="PopulateRecentLinksRibbonAction";Oe.yjk="PopulateRecentLinksContextMenu";Oe.zjk="PopulateRecentLinksContextMenuAction";Oe.Sbk="InsertRecentLinks";Oe.Tbk="InsertRecentLinksAction";Object(t.a)(Oe,"HyperlinkActor",null,[]);class Gl{static get dr(){return nt.a.P9b}static get jg(){return bl.ContextSetEditor.instance}static get If(){return aj.a.instance}static get Lb(){return Ch.a.instance}static get rH(){return Ic.InteractiveViewManager.instance}static sz(){return Gl.Wl||
(Gl.Wl=la.a.instance.Ca("Box4.IExternalSelectionManager"))}static get M1l(){return Gl.Ozh||(Gl.Ozh=la.a.instance.resolve("Box4.Actors.IIndentationActorExtension"))}static lb(){const a=l.AFrameworkApplication.pa;a.ma(Mb.a.NK,Kb.a.view,Gl.zhd);a.ma(Mb.a.NK,Kb.a.outlineElement,Gl.pZh);a.$b(Mb.a.NK,1036);a.ma(Mb.a.JU,Kb.a.view,Gl.zhd);a.ma(Mb.a.JU,Kb.a.outlineElement,Gl.pZh);a.$b(Mb.a.JU,1036)}static zhd(a,d,n,z,O){const ca=d.view;if(!ca.Yd)return 2;var Da=ca.Oa;if(!Da)return Gl.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.Wga}),
8;Da=Da.Ag;if(!Da)return Gl.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.noSelection}),8;if(Lb.App.A4b(d))return 8;if(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Gl.If.Fbc(Da))return Gl.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.CF}),8;if(1===n)return 32;if(Gl.jg.Eya(Gl.eEf,Da))return Gl.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.g5b}),8;if(Gl.jg.h9(Bd.ParagraphReader.wS,Da))return Gl.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.qP}),8;if(!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",
!1)&&Gl.If.Fbc(Da))return Gl.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.CF}),8;if(Gl.sz()&&Gl.sz().instance&&Gl.sz().instance.l0(Da))return Gl.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.externalSelection}),8;Da={};Da[Dp.a.TZa]=5794;Da[Dp.a.SZa]=5795;return Gl.M1l.zhd(ca,a,d,n,z,O,Da)}static pZh(a,d,n,z,O){var ca,Da;if(d.contextId!==Kb.a.outlineElement)return 2;var Xa=d.clone().vWd();if(If.TableReader.zsg(Xa)){if(Gl.If.Asg(Xa))return Gl.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.CF}),8}else if(Gl.If.tVa(Xa))return Gl.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.CF}),
2;Xa=new Dd.GraphIterator;Xa.set(d.node);Qd.SelectionEditor.Vm(Xa);if(!Ia.OutlineElementReader.gg(Xa))return 2;let zb;switch(a){case Mb.a.NK:zb=Gl.dr.f4b(Xa);break;case Mb.a.JU:zb=Gl.dr.hAc(Xa);break;default:return 2}if(1===n||!zb)return zb?32:8;n=0;a===Mb.a.JU&&O&&O.fa(Xc.a.wGf,!1)&&(n|=2);if(Ia.OutlineElementReader.rI(Xa))return Gl.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.qP}),2;(null===(Da=null===(ca=Gl.rH)||void 0===ca?void 0:ca.sc)||void 0===Da?0:Da.fQ)&&Gl.rH.editingView&&(Gl.rH.editingView.UK=!0);switch(a){case Mb.a.NK:Gl.dr.yCa(Xa,
-1,n);break;case Mb.a.JU:Gl.dr.Eod(Xa,1)}z&&ip.a.KOb&&(z.vq|=ip.a.tFb(d.node,!0));return 32}}Gl.Wl=null;Gl.eEf=Kd.ImageReader.aVa;Gl.Ozh=null;Object(t.a)(Gl,"IndentationActor",null,[]);var cm=b(1389);class jk{static get paragraphEditor(){return jk.Ki||(jk.Ki=la.a.instance.resolve("Box4.IParagraphEditor"))}static get $f(){return jk.Rk||(jk.Rk=la.a.instance.resolve("Box4.ITableEditor"))}static get If(){return aj.a.instance}static get Lb(){return Ch.a.instance}static sz(){return jk.Wl||(jk.Wl=la.a.instance.Ca("Box4.IExternalSelectionManager"))}static lb(){const a=
l.AFrameworkApplication.pa;a.ma(Mb.a.leftJustify,Kb.a.view,cm.a.Nz);a.ma(Mb.a.leftJustify,Kb.a.paragraph,jk.dRa);a.ma(Mb.a.leftJustify,Kb.a.table,jk.kFf);a.$b(Mb.a.leftJustify,1036);a.ma(Mb.a.centerJustify,Kb.a.view,cm.a.Nz);a.ma(Mb.a.centerJustify,Kb.a.paragraph,jk.dRa);a.ma(Mb.a.centerJustify,Kb.a.table,jk.kFf);a.$b(Mb.a.centerJustify,1036);a.ma(Mb.a.rightJustify,Kb.a.view,cm.a.Nz);a.ma(Mb.a.rightJustify,Kb.a.paragraph,jk.dRa);a.ma(Mb.a.rightJustify,Kb.a.table,jk.kFf);a.$b(Mb.a.rightJustify,1036);
a.ma(Mb.a.fullJustify,Kb.a.view,cm.a.Nz);a.ma(Mb.a.fullJustify,Kb.a.paragraph,jk.dRa);a.$b(Mb.a.fullJustify,1036);a.ma(Mb.a.iDc,Kb.a.view,cm.a.Nz);a.ma(Mb.a.iDc,Kb.a.paragraph,jk.dRa);a.$b(Mb.a.iDc,1036);a.ma(Mb.a.uIb,Kb.a.view,cm.a.Nz);a.ma(Mb.a.uIb,Kb.a.paragraph,jk.dRa);a.$b(Mb.a.uIb,1036);a.ma(Mb.a.FSc,Kb.a.view,cm.a.Nz);a.ma(Mb.a.FSc,Kb.a.paragraph,jk.dRa);a.$b(Mb.a.FSc,1036);a.ma(Mb.a.mec,Kb.a.view,cm.a.Nz);a.ma(Mb.a.mec,Kb.a.paragraph,jk.dRa);a.$b(Mb.a.mec,1036);a.ma(Mb.a.s4b,Kb.a.view,cm.a.Nz);
a.ma(Mb.a.s4b,Kb.a.paragraph,jk.dRa);a.$b(Mb.a.s4b,1036);a.ma(Mb.a.akc,Kb.a.view,cm.a.Nz);a.ma(Mb.a.akc,Kb.a.paragraph,jk.dRa);a.$b(Mb.a.akc,1036);a.ma(Mb.a.y8b,Kb.a.view,cm.a.Nz);a.ma(Mb.a.y8b,Kb.a.paragraph,jk.dRa);a.$b(Mb.a.y8b,1036)}static kFf(a,d,n,z){let O=!0;if(!d)return 8;If.TableReader.zsg(d)?jk.If.Asg(d)?(jk.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.CF}),O=!1):jk.sz()&&jk.sz().instance&&jk.sz().instance.l0(d)&&(jk.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.externalSelection}),O=!1):(jk.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.upd}),
O=!1);if(1===n||!O)return O?32:8;d=d.node;switch(a){case Mb.a.leftJustify:jk.$f.NH(d,1);break;case Mb.a.centerJustify:jk.$f.NH(d,2);break;case Mb.a.rightJustify:jk.$f.NH(d,3)}z&&ip.a.KOb&&(z.vq|=2);return 32}static dRa(a,d,n,z,O){let ca=!0;d.contextId!==Kb.a.paragraph?ca=!1:jk.If.tVa(d)?(jk.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.CF}),ca=!1):jk.sz()&&jk.sz().instance&&jk.sz().instance.l0(d)&&(jk.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.externalSelection}),ca=!1);if(1===n||!ca)return ca?32:8;d=d.node;n=Bd.ParagraphReader.Jv(d);
switch(a){case Mb.a.leftJustify:case Mb.a.mec:jk.paragraphEditor.NH(d,1===n&&jk.CHe(O)?6:1);break;case Mb.a.centerJustify:case Mb.a.s4b:jk.paragraphEditor.NH(d,2===n&&jk.CHe(O)?1:2);break;case Mb.a.rightJustify:case Mb.a.akc:jk.paragraphEditor.NH(d,3===n&&jk.CHe(O)?1:3);break;case Mb.a.fullJustify:case Mb.a.y8b:jk.paragraphEditor.NH(d,6===n&&jk.CHe(O)?1:6);break;case Mb.a.uIb:jk.paragraphEditor.NH(d,11);break;case Mb.a.iDc:jk.paragraphEditor.NH(d,7);break;case Mb.a.FSc:jk.paragraphEditor.NH(d,13)}z&&
ip.a.KOb&&(z.vq|=ip.a.tFb(d));return 32}static CHe(a){let d=!1;null!==a&&Object.getType(a)===Object&&a.hasOwnProperty("InContextSet")&&(d=a.InContextSet);return!d}}jk.Rk=null;jk.Ki=null;jk.Wl=null;Object(t.a)(jk,"JustificationActor",null,[]);const tx=()=>{const a=l.AFrameworkApplication.pa;a.ma(Mb.a.save,Cd.a.frame,iy);a.ma(Mb.a.sync,Cd.a.frame,Ep)},Ep=(a,d,n)=>{if(1===n)return 32;l.AFrameworkApplication.pa.processAction(Mb.a.bib,2);Lb.App.jj.C0e();return 32},iy=(a,d,n)=>{if(1===n)return 2===Lb.App.oa.mode?
32:8;l.AFrameworkApplication.pa.processAction(Mb.a.bib,2);if(2!==Lb.App.oa.mode)return 32;Lb.App.jj.htj(null,null);return 32};class lu{lb(){const a=l.AFrameworkApplication.pa;a.ma(Mb.a.activateRibbonTab,Kb.a.view,Object(m.a)(this,this.activateRibbonTab,"activateRibbonTab"));a.$b(Mb.a.activateRibbonTab,5);a.ma(Mb.a.Itg,Kb.a.view,Object(m.a)(this,this.Qjm,"launchJewelOpenMenuShortcut"))}activateRibbonTab(a,d,n,z,O){Lb.App.Yq.hz.WRd(O.toString());return 32}Qjm(a,d,n,z,O){l.AFrameworkApplication.b8("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");
Lb.App.Yq.hz.bWi(1,O.toString());return 32}static get instance(){return lu.na||(lu.na=lu.al())}static al(){return new lu}}lu.na=null;Object(t.a)(lu,"RibbonActor",null,[]);class ar{constructor(a,d){this.Gj=null;this.faa=a;this.w_a=d}get eh(){return this.Gj||(this.Gj=this.faa())}lb(){const a=l.AFrameworkApplication.pa,d=Object(m.a)(this,this.ZIn,"undoRedo");a.Aa(Mb.a.undo,Kb.a.view,d,1028);a.Aa(Mb.a.redo,Kb.a.view,d,1028)}ZIn(a,d,n,z,O){d=d.view;if(!d.Yd)return ar.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.Bqb}),
8;z=a===Mb.a.undo?this.eh.D7:this.eh.g5a;if(1===n)return z?32:8;if(!z)return k.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",a===Mb.a.undo?"undo":"redo"),this.w_a.value.GMj(),ar.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.EMj}),2;n=new Ff.GraphTransaction(3);n.Sa(d.xc);n.dXe();a=a===Mb.a.undo?this.eh.undo():this.eh.redo();n.dispose();O&&ot.GrippersManager.instance.PDa(O.UF);if(a)return 32;ar.Lb.mb(Ee.a.S6b,{["Reason"]:Jf.a.vMe});return 8}static get instance(){return ar.na||(ar.na=
ar.al())}static al(){const a=la.a.instance;return new ar(()=>a.resolve("Box4.IUndoManager"),a.vf("Box4.ICoauthCashTelemetry"))}static get Lb(){return Ch.a.instance}}ar.na=null;Object(t.a)(ar,"UndoActor",null,[]);class ux{constructor(){this.Z=null}get name(){return"Box4.Actors"}Hb(a){this.Z=a;(new kv).Hb(a)}init(){var a=this.Z.resolve("Box4.Actors.ClipboardActor");a.lb();a.DV();Hz();pr.instance.lb();Oe.lb();Gl.lb();jk.lb();this.Z.resolve("Box4.Actors.TouchInputActor").lb();Os.instance.lb();this.Z.resolve("Box4.ISelectAllHandlers").lb();
tx();uf.a.instance.J(9)&&this.Z.resolve("Box4.Actors.ProofingActor").lb();lu.instance.lb();(a=this.Z.sa("Box4.IFeatureHelper"))?a.tk.continueWith(()=>{this.Xlj()}):this.Xlj();xs.a.lb(Lb.App.P9a);this.Z.resolve("Box4.Actors.TextFormattingActor").lb();ar.instance.lb();this.Z.resolve("Box4.Actors.AccessibilityActor").XSg();this.Z.resolve("Box4.IClipboardCommands");this.Z.resolve("Box4.Actors.PasteFloatieEventManager");Lb.App.oa.updateCommandUI()}Xlj(){uf.a.instance.J(10)&&(l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsUpdateStyleContextMenuEnabled",!1)&&this.Z.resolve("Box4.Actors.StyleContextMenuActor").lb(),this.Z.resolve("Box4.Actors.StyleActor").lb())}dispose(){}static main(){M.a.instance.Sb(new ux)}}Object(t.a)(ux,"Box4ActorsPackage",null,[1,2]);class Nv extends ju{constructor(a,d,n,z){super(a);this.n7=n;this.Kta=z;this.Nhh=0;this.dF=d.L6a("UserAction","WordOnlineAddToDictionary")}c3g(a){this.fte=this.n7.Cra(a);if(!this.XPk())return!1;
const d=this.fte.errorDetails.token;this.Kta.FVh(d);if(!this.Kta.kUc(d))return k.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;k.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");this.dF.start();this.transaction=new Ff.GraphTransaction(15);this.transaction.Sa(a.node);return!0}PRe(a){this.bic(a.node);return!0}ENd(a){this.bic(a);return!0}QRe(a){this.bic(a.node)}n$g(a){this.transaction.dispose();
this.fte.errorDetails.ZOb(a.actionId);this.Kta.rWe("unused corelation id.");this.dF.stop();k.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",this.Nhh,this.dF.ti,this.fte.errorDetails.proofingType));return!0}uTc(a,d){const n=a.role;return super.uTc(a,d)||9===n||10===n||13===n||7===n||8===n}bic(a){if(a){var d=this.n7.mba(a,n=>this.Kta.kUc(n.errorDetails.token));this.n7.ksb(a,d,!0);this.Nhh+=d.length}}XPk(){var a,
d;return null!==(d=null===(a=this.fte)||void 0===a?void 0:a.errorDetails)&&void 0!==d&&d.token?!0:(k.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(t.a)(Nv,"AddToDictionaryCallbackSteps",ju,[]);class vx{constructor(a,d,n,z,O,ca,Da){this.Tb=a;this.Oa=d;this.Quj=n;this.n7=z;this.nm=O;this.Kta=ca;this.fWm=Da;this.QUl=(Xa,zb,Vb,Fc,Yc,yd)=>{const je=new Nv(this.Quj,this.nm,this.n7,this.Kta);return new ct(Xa,zb,Vb,Fc,Yc,yd,je,this.Tb,
this.Oa,this.Quj,"AddToDictionaryThroughProofingWholeDocumentOperation")}}lb(){this.Tb.dX(Mb.a.addToDictionary,Kb.a.view,this.QUl,1124);this.fWm.u4m(this.Kta)}}Object(t.a)(vx,"PersonalDictionaryOrchestrator",null,[]);class mu{get name(){return"Box4.PersonalDictionary"}Hb(a){this.container=a;a.register(vx,"Box4.PersonalDictionary.PersonalDictionaryOrchestrator").singleInstance().zd(()=>new vx(l.AFrameworkApplication.pa,Lg.a.instance,tp.a.instance,a.resolve("Box4.Proofing.IErrorRangeEditor"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
a.resolve("IRoamingDictionary"),a.resolve("Box4.Proofing.ProofingCheckOperator")))}init(){this.container.resolve("Box4.PersonalDictionary.PersonalDictionaryOrchestrator").lb()}dispose(){}static main(){Bi.a.get_instance().Ik(7,()=>{l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddToDictionaryIsEnabled",!1)&&M.a.instance.Sb(new mu)})}}Object(t.a)(mu,"PersonalDictionaryPackage",null,[1,2]);class Ir{constructor(a,d,n,z,O,ca){this.zxb=this.F1=null;this.ga=a;this.Ufe=d;this.tnf=
n;this.UOa=z;this.Eb=O;this.tf=ca}get recentColors(){return Ir.vAb||(Ir.vAb=la.a.instance.sa("Box4.UI.RecentColorsSectionHandler"))}get cAj(){this.F1||(this.F1=new zw.a("Shading"),this.Jnb(this.F1));return this.F1}Jnb(a){a.jqa(2,Mb.a.RCb);a.jqa(3,Mb.a.Yca);a.jqa(4,Mb.a.Yca);a.wyc(this.tnf,1)}lb(){this.ga.ma(Mb.a.MKb,Kb.a.view,Object(m.a)(this,this.MKb,"populateCellShadingColor"));this.ga.ma(Mb.a.MKb,Kb.a.tableCell,Object(m.a)(this,this.MKb,"populateCellShadingColor"));this.ga.$b(Mb.a.MKb,1126);this.ga.ma(Mb.a.sAc,
Kb.a.view,xs.a.Dsd);this.ga.ma(Mb.a.sAc,Kb.a.tableCell,Object(m.a)(this,this.sAc,"cellShadingColorMenuOpen"));this.ga.$b(Mb.a.sAc,1028);this.ga.ma(Mb.a.Yca,Kb.a.view,xs.a.Dsd);this.ga.ma(Mb.a.Yca,Kb.a.tableCell,Object(m.a)(this,this.BL,"cellShadingColor"));this.ga.$b(Mb.a.Yca,1028);this.ga.ma(Mb.a.RCb,Kb.a.view,xs.a.Dsd);this.ga.ma(Mb.a.RCb,Kb.a.tableCell,Object(m.a)(this,this.RCb,"clearCellShadingColor"));this.ga.$b(Mb.a.RCb,1028);this.ga.ma(Mb.a.iLb,Kb.a.view,Object(m.a)(this,this.eXm,"queryCellShadingColorView"));
this.ga.ma(Mb.a.iLb,Kb.a.tableCell,Object(m.a)(this,this.iLb,"queryCellShadingColor"));this.ga.$b(Mb.a.iLb,1124);this.ga.ma(Mb.a.Wkc,Kb.a.view,xs.a.Dsd);this.ga.ma(Mb.a.Wkc,Kb.a.tableCell,Object(m.a)(this,this.$Ok,"cellShadingCustomColor"));this.ga.$b(Mb.a.Wkc,1028);this.ga.ma(Mb.a.BPe,Kb.a.view,Object(m.a)(this,this.mta,"openMoreColorsDialog"));this.ga.$b(Mb.a.BPe,1028)}UV(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>
{const a=la.a.instance.Ca("Common.ISystemInitiatedFeedback");a&&a.execute(d=>{d.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}sAc(a,d,n,z,O){return this.AUi(d,n,O,!1)?32:8}BL(a,d,n,z,O){if(!({BA:a}=this.MAj(d,n,O,!0)).returnValue)return a;k.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");O=this.Ufe.IRa(d.node,O);this.tQm(d.node,O);this.UV();return 32}RCb(a,d,n,z,O){if(!({BA:a}=this.MAj(d,n,O,!1)).returnValue)return a;
this.pQm(d.node);return 32}eXm(a,d,n,z,O){if(1===n)return 32;if(!d||!d.view.Yd)return 2;a=d.view.Oa;if(!a)return 2;a=a.Ag;if(!a)return 2;a=Ir.jg.NX(a,16);if(!a||!a.length)return 2;d=null;for(n=0;n<a.length;n++){z=a.getContext(n);if(!z||z.contextId!==Kb.a.tableCell)return 2;const ca={};this.vIi(z,ca);if(ca.CellShading)if(d&&d!==ca.CellShading){d=null;break}else d=ca.CellShading;else{d=null;break}}O.CellShading=d;return 32}iLb(a,d,n,z,O){return 1===n?32:this.vIi(d,O)}MKb(a,d,n,z,O){if(1===n)return 32;
a=d.contextId===Kb.a.view?this.UOa.Ivd(d):this.iag(d);n={};d=null;32===l.AFrameworkApplication.pa.ob(Mb.a.iLb,2,n)&&n&&(d=n.CellShading);n="";d&&(n=zl.a.LA(d)||"");this.cAj.KRc=n;a=this.cAj.Ave(a,Lb.App.S4b);if(!a)return 8;O.MenuItems=a;k.ULS.sendTraceTag(592996034,340,50,"Cell Shading dropdown menu is opened.");return 32}mta(a,d,n,z,O){if(1===n)return 32;Lb.App.oa.OA();l.AFrameworkApplication.pa.ob(Mb.a.iLb,2,O);this.zxb=new Tu.a("Shading",Mb.a.Wkc);this.zxb.vVd(O&&O.CellShading?O.CellShading:0);
return 32}$Ok(a,d,n,z,O){if(1===n)return 32;l.AFrameworkApplication.pa.ob(Mb.a.Yca,2,O);this.recentColors.LBb(O)||k.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");return 32}MAj(a,d,n,z){return this.AUi(a,d,n,z)?{returnValue:2===d,BA:32}:(2==d&&xs.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],Jf.a.Omi),{returnValue:!1,BA:8})}AUi(a,d,n,z){return a.contextId!==Kb.a.tableCell||2===d&&(z&&!n||!a.node)?!1:!0}tQm(a,d){const n=
new Ff.GraphTransaction(15);n.Sa(a);this.czj(a);a.properties.setValue(Vd.a.BL,d);n.dispose()}pQm(a){const d=new Ff.GraphTransaction(15);d.Sa(a);this.czj(a);a.properties.removeProperty(Vd.a.BL);d.dispose()}iag(a){return a.contextId!==Kb.a.tableCell?null:(a=Ir.Ze.kt(a.node))?a:null}czj(a){if(this.Eb&&this.Eb.Jf&&(a=Object(qa.a)(Xq.TableCellNode,a))){const d=a.VE();this.tf.AUd(a,d)}}vIi(a,d){if(a.contextId!==Kb.a.tableCell)return 8;(a=a.node)&&a.hasProperty(Vd.a.BL)&&(d.CellShading=a.getValue(Vd.a.BL));
return 32}static hul(){return new Ir(l.AFrameworkApplication.pa,on.a.instance,Jt.a.instance,mi.PageReader.instance,la.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,la.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Ze(){return jm.PageNavigator.instance}static get jg(){return Ir.Vu||(Ir.Vu=bl.ContextSetEditor.instance)}static get instance(){return Ir.Kh||(Ir.Kh=Ir.hul())}}Ir.vAb=null;Ir.Vu=null;Ir.Kh=null;Object(t.a)(Ir,"CellShadingActor",
null,[]);class jy{constructor(){this.Z=null}get name(){return"Box4.CellShading"}Hb(a){this.Z=a}init(){const a=this.Z.sa("Box4.IFeatureHelper");a?a.tk.continueWith(()=>{this.Po()}):this.Po()}Po(){const a=this.Z.sa("Box4.IFeatureHelper");if(a?a.isFeatureEnabled(22):Lb.App.q4b)Ir.instance.lb(),Lb.App.oa.updateCommandUI()}dispose(){}}Object(t.a)(jy,"CellShadingPackage",null,[1,2]);var Bs;(function(a){a[a.none=0]="none";a[a.style1=1]="style1";a[a.style2=2]="style2";a[a.style3=3]="style3";a[a.style4=4]=
"style4";a[a.style5=5]="style5";a[a.bullet=6]="bullet";a[a.invalid=42]="invalid"})(Bs||(Bs={}));Object(t.b)("ListStyle",Bs);const nu={[Bs.style1]:{[1]:"disc",[0]:"decimal"},[Bs.style2]:{[1]:"circle",[0]:"lower-alpha"},[Bs.style3]:{[1]:"square",[0]:"lower-roman"},[Bs.style4]:{[0]:"upper-alpha"},[Bs.style5]:{[0]:"upper-roman"},[Bs.bullet]:{[1]:"bullet"}};var Ov;(function(a){a[a.number=0]="number";a[a.bullet=1]="bullet";a[a.lim=13]="lim";a[a.nil=14]="nil";a[a.any=15]="any";a[a.noList=16]="noList";a[a.invalid=
42]="invalid"})(Ov||(Ov={}));Object(t.b)("ListType",Ov);var Iz=b(864);class up{constructor(a,d){this.yz=this.bGd=null;this.levelText=a;this.font=d}get HRe(){return this.levelText}get listStyle(){return 6}get Kt(){return"left"}}Object(t.a)(up,"ListMarkerBullet",null,[299]);class Kh{static get es(){return Kh.Wq||(Kh.Wq=la.a.instance.resolve("Box4.List.IListEditor"))}static get Vb(){return Kh.zc||(Kh.zc=la.a.instance.resolve("Box4.List.IListReader"))}static set Vb(a){Kh.zc=a}static get pj(){return Kh.Xn||
(Kh.Xn=la.a.instance.resolve("Box4.IInsertionPointFormatting"))}static sz(){return Kh.Wl||(Kh.Wl=la.a.instance.Ca("Box4.IExternalSelectionManager"))}static get jg(){return bl.ContextSetEditor.instance}static get If(){return aj.a.instance}static get Lb(){return Ch.a.instance}static get Oc(){return at.a.getInstance()}static get bOb(){return Kh.PAb||(Kh.PAb=la.a.instance.sa("Box4.List.ISingleLevelListEditor"))}static lb(){const a=l.AFrameworkApplication.pa;a.ma(Mb.a.pC,Kb.a.view,Kh.Yyc);a.ma(Mb.a.pC,
Kb.a.outlineElement,Kh.wGa);a.$b(Mb.a.pC,1036);a.ma(Mb.a.bL,Kb.a.view,Kh.Yyc);a.ma(Mb.a.bL,Kb.a.outlineElement,Kh.wGa);a.$b(Mb.a.bL,1036);Kh.Vb.Cr&&(a.ma(Mb.a.Tga,Kb.a.view,Kh.Yyc),a.ma(Mb.a.Tga,Kb.a.outlineElement,Kh.wGa),a.$b(Mb.a.Tga,1036));a.ma(Mb.a.Kje,Kb.a.view,Bc.ActionManager.Ke);a.ma(Mb.a.jMf,Kb.a.view,Bc.ActionManager.Ke);a.ma(Mb.a.joinList,Kb.a.view,Kh.man);a.ma(Mb.a.Fje,Kb.a.view,Bc.ActionManager.Ke);a.ma(Mb.a.Mje,Kb.a.view,Bc.ActionManager.Ke);a.ma(Mb.a.w0e,Kb.a.view,Bc.ActionManager.Ke);
a.ma(Mb.a.h9g,Kb.a.view,Bc.ActionManager.Ke);a.ma(Mb.a.XZd,Kb.a.view,Bc.ActionManager.Ke)}static man(){Iz.a.Gqj();return 32}static Yyc(a,d,n,z,O){var ca,Da;if(!d.view.Yd)return 2;const Xa=Kh.Lb.mm(Mb.a.Yyc);z.vq=42;z.lz=42;const zb={[Dp.a.TZa]:5796,[Dp.a.SZa]:5797};var Vb=d.view;if(Kh.jg.Eya(Kh.Q0l,Vb.Oa.Ag))return Kh.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.amd}),Xa.end(),8;if(Kh.jg.Eya(Kh.eEf,Vb.Oa.Ag))return Kh.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.g5b}),Xa.end(),8;if(Kh.jg.h9(Bd.ParagraphReader.wS,Vb.Oa.Ag))return Kh.Lb.mb(Ee.a.af,
{["Reason"]:Jf.a.qP}),Xa.end(),8;if(Kh.If.Fbc(Vb.Oa.Ag))return Kh.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.CF}),Xa.end(),8;if(null===(Da=null===(ca=Kh.sz())||void 0===ca?void 0:ca.instance)||void 0===Da?0:Da.l0(d))return Kh.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.externalSelection}),Xa.end(),8;if(1===n)return Xa.end(),32;O||(O=new dh.DictionaryPropertySet);ca=null;if(2===n){ca=new Ff.GraphTransaction(15);ca.Sa(d.view.xc);Kh.QEd=!1;Da=$h.OutlineElementGeneralizer.Kla(Vb.Oa.ya,!1);if(!Da)return ca.dispose(),Kh.Lb.mb(Ee.a.Yaa,
{["Reason"]:Jf.a.jEc}),Xa.end(),8;1<Da.length&&O.setValue(Xc.a.$Le,null);const Yc=O.fa(Xc.a.mD,-1),yd=O.fa(Xc.a.Ju,-1);Kh.Oc.EVa&&Kh.bOb&&Kh.bOb.gRk(Da);var Fc=Kh.Yqn(Yc,yd,Da);Fc&&(O.setValue(Xc.a.Ju,16),O.setValue(Xc.a.wBa,0));if(!Qd.SelectionEditor.Cd(Vb.Oa.Ag)&&!Fc&&0<Da.length&&Yc){Vb=new Dd.GraphIterator;Fc=Array(Da.length);for(let je=0;je<Da.length;je++)Vb.set(Da.getContext(je).node),Fc[je]=Kh.Vb.ht(Vb);Kh.Xqn(Fc,O)&&(Vb=new dh.DictionaryPropertySet,Vb.setValue(Xc.a.Ju,16),Vb.setValue(Xc.a.wBa,
0),at.a.p0&&(Vb.setValue(bd.a.Lsa,"clean-list-before-apply-new-list-style"),Vb.setValue(bd.a.Yma,O.fa(bd.a.Lsa,"unknown")+"@"+O.fa(bd.a.Yma,"undefined"))),Dp.a.mCa(a,d,n,z,Vb,zb,11),l.AFrameworkApplication.pa.processAction(Mb.a.h9g,2),k.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),Kh.QEd=!0)}Vb=new Dd.GraphIterator;Vb.set(Da.getContext(0).node);Vb=Kh.Vb.ht(Vb);Kh.mom(Yc,yd,Vb,Da.length)}a=Dp.a.mCa(a,d,n,z,O,zb,11);32===a&&O.fa(Xc.a.wGf,!1)&&(a=Dp.a.mCa(Mb.a.JU,
d,n,z,O,zb,11));ca&&ca.dispose();Xa.end();return a}static Xqn(a,d){let n=null;var z=!1;for(let O=a.length-1;0<=O&&(n?(z=a[O],z=-1!==d.fa(Xc.a.mD,-3)?z?n.listType!==z.listType||n.listStyle!==z.listStyle:!0:z?n.listType!==z.listType:!0):n=a[O],!z);O--);return n&&(a=!1,z||(a=d.fa(Xc.a.Ju,42),d=d.fa(Xc.a.mD,-3),a=a!==n.listType||0<d),z||a)?!0:!1}static mom(a,d,n,z){0>=z||Kh.QEd||(a?n?(n=n.listType,-1===a&&d===n?(l.AFrameworkApplication.pa.processAction(Mb.a.XZd,2),k.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):
0<a&&(!d||1===d)&&(l.AFrameworkApplication.pa.processAction(d?Mb.a.Fje:Mb.a.Mje,2),k.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",d?"Bullet":"Numbering"))):(l.AFrameworkApplication.pa.processAction(d?Mb.a.Fje:Mb.a.Mje,2),Kh.EGn(),k.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",d?"Bullet":"Numbering")):(l.AFrameworkApplication.pa.processAction(Mb.a.XZd,2),k.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static Yqn(a,
d,n){if(-1!==a&&a||!n.length)return!1;a=new Dd.GraphIterator;let z=null;for(let O=n.length-1;0<=O&&!(a.set(n.getContext(O).node),z=Kh.Vb.ht(a));O--);return z&&d===z.listType?!0:!1}static wGa(a,d,n,z,O){if(d.contextId!==Kb.a.outlineElement)return 2;var ca=d.clone().vWd();if(Kh.If.tVa(ca))return Kh.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.CF}),2;const Da=new Dd.GraphIterator;Da.set(d.node);Qd.SelectionEditor.Vm(Da);if(!Ia.OutlineElementReader.gg(Da))return 2;if(1===n)switch(a){case Mb.a.pC:return 32;case Mb.a.bL:return 32;
case Mb.a.Tga:return 32;default:return 2}if(Ia.OutlineElementReader.rI(Da))return Kh.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.qP}),2;d=Kh.Vb.ht(Da);var Xa;at.a.p0&&(Xa=Object.freeze(null===d||void 0===d?void 0:d.clone()));let zb=O;if(!zb)return 8;!Bf.ListReader.Jq&&a===Mb.a.bL&&Da.lx()&&(Da.Bo(4)||zb.setValue(Xc.a.vBa,1),Da.yg());Kh.Vb.Cr?(a===Mb.a.bL||a===Mb.a.pC||a===Mb.a.Tga?(zb=Kh.es.WDc(a,zb),ca=$r.a.TR(zb.getValue(Xc.a.Ju),zb.getValue(Xc.a.wBa))):ca=null,Kh.d8(a,zb),Kh.hmn(ca,zb)):(zb=Kh.es.WDc(a,zb),
ca=$r.a.TR(zb.getValue(Xc.a.Ju),zb.getValue(Xc.a.wBa)));Bf.ListReader.Jq||(ca.cA=zb.fa(Vd.a.JS,wh.a.uh));let Vb=!1;a===Mb.a.pC&&zb&&(zb.hasProperty(Qb.a.fr)&&(ca.levelText=zb.fa(Qb.a.fr,"")),zb.hasProperty(Vd.a.font)&&(ca.font=zb.fa(Vd.a.font,"")),zb.hasProperty(Xc.a.gve)&&(Vb=zb.fa(Xc.a.gve,!1)));Kh.Dnn(zb,Da);ca=Kh.es.wGa(zb,Da,ca,Vb);if(!ca.returnValue)return Kh.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.wGd}),2;ca=ca.JUa;at.a.p0&&Kh.u0m(O,Xa,ca);2===n&&(n=O.fa(Xc.a.Ju,-1),ca&&-1!==n&&((Xa=O.fa(Qb.a.gq,"Invalid MultiLevel Type"),
a===Mb.a.bL&&k.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===O||void 0===O?void 0:O.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,["listStyle"]:Bs[null==(null===d||void 0===d?void 0:d.listStyle)?null===ca||void 0===ca?void 0:ca.listStyle:null===d||void 0===d?void 0:d.listStyle],["listType"]:Ov[null==(null===d||void 0===d?void 0:d.listType)?null===ca||void 0===ca?void 0:ca.listType:null===d||void 0===d?void 0:d.listType],
["cleared"]:16===(null===ca||void 0===ca?void 0:ca.listType)})),d)?ca.listType&&1!==ca.listType||Kh.QEd||(l.AFrameworkApplication.pa.processAction(Mb.a.w0e,2),k.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",n?"Bullet":"Numbering",Xa)):16===ca.listType?(l.AFrameworkApplication.pa.processAction(Mb.a.jMf,2),k.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",n?"Bullet":"Numbering",Xa)):ca.listType&&1!==ca.listType||Kh.QEd||(l.AFrameworkApplication.pa.processAction(Mb.a.Kje,
2),k.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",n?"Bullet":"Numbering",Xa))),(a=ic.FocusManager.instance())&&a.Zd&&a.Zd.name===og.AppFrame.Uca&&a.Wv(Ec.AFrame.ao));z.vq=ca.listType;z.lz=ca.listStyle;return 32}static u0m(a,d,n){var z,O,ca,Da,Xa,zb,Vb,Fc;const Yc=new Map;Yc.set("actionCallSource",a.fa(bd.a.Lsa,"unknown"));Yc.set("actionCallSourceTrigger",a.fa(bd.a.Yma,"undefined"));Yc.set("fromListType",Ov[null!==(z=null===d||void 0===d?void 0:d.listType)&&void 0!==
z?z:16]);Yc.set("fromListStyle",Bs[null!==(O=null===d||void 0===d?void 0:d.listStyle)&&void 0!==O?O:0]);Yc.set("fromListMarkerType",null!==(Xa=u(null!==(ca=null===d||void 0===d?void 0:d.listStyle)&&void 0!==ca?ca:0,null!==(Da=null===d||void 0===d?void 0:d.listType)&&void 0!==Da?Da:16))&&void 0!==Xa?Xa:"undefined");Yc.set("fromLevelText",(null===d||void 0===d?0:d.iga)?d.levelText:"undefined");Yc.set("toListType",null!==(zb=Ov[null===n||void 0===n?void 0:n.listType])&&void 0!==zb?zb:"undefined");Yc.set("toListStyle",
null!==(Vb=Bs[null===n||void 0===n?void 0:n.listStyle])&&void 0!==Vb?Vb:"undefined");Yc.set("toListMarkerType",null!==(Fc=u(null===n||void 0===n?void 0:n.listStyle,null===n||void 0===n?void 0:n.listType))&&void 0!==Fc?Fc:"undefined");Yc.set("toLevelText",(null===n||void 0===n?0:n.iga)?n.levelText:"undefined");ja.Health.instance.recordKpiUsage(wh.a.kIe.pYi,0,wh.a.aH,Yc)}static Dnn(a,d){var n=new Dd.GraphIterator;n.Cb(d);(d=n.Va(2))&&Bd.ParagraphReader.nb(d)&&(n=Lg.a.instance.ya.Ba)&&n.ra&&n.ra.node===
d&&Qd.SelectionEditor.Vcc(n)&&(Kh.Pkn(a),Kh.Mkn(a))}static hmn(a,d){d.hasProperty(Qb.a.gq)&&a.fUd(d.getValue(Qb.a.gq));d.hasProperty(bd.a.VC)&&(a.VC=d.getValue(bd.a.VC));d.hasProperty(Qb.a.fr)&&(a.levelText=d.getValue(Qb.a.fr));a.mD=d.fa(Xc.a.mD,-1);let n=null;a.Gsa&&(n=Kh.MEl(a,d));a.Gsa&&n?Kh.Ann(a,n):(a.Gsa?k.ULS.sendTraceTag(589091597,393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",a.mD,a.gq,a.Zr):k.ULS.sendTraceTag(589091596,
393,50,"User has not selected a style choosing default properties"),Kh.Ujn(a))}static Ujn(a){if(a.Zr)a.O$b&&-1===a.mD||(a.levelText="%1.",a.propertySet.hasProperty(Vd.a.rQ)||a.o5(0,1));else if(1===a.listType)a.O$b&&-1===a.mD||(a.font=wh.a.z6b,a.levelText=wh.a.xCc,a.propertySet.hasProperty(Vd.a.rQ)||a.o5(1,6));else return;a.Kt="left"}static Ann(a,d){1===a.gq?Kh.Bmn(a,d):Kh.nln(a,d)}static Bmn(a,d){(a.yz=d.yz)?a.s1=d.yz.s1:d.yz||k.ULS.sendTraceTag(588022422,393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",
a.mD,a.gq,a.Zr)}static nln(a,d){a.levelText=d.levelText;a.Zr?a.o5(0,d.listStyle):(a.font=d.font,a.o5(1,1));a.Kt=d.Kt}static MEl(a,d){let n=null;2===a.gq?n=a.Zr?la.a.instance.sa("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):la.a.instance.sa("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===a.gq&&(n=la.a.instance.sa("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let z=n.sec.value;const O=a.mD+"";O in z||(z=n.Kga,k.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",
O,a.gq,a.Zr));if(!(O in z)){k.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",O,a.gq,a.Zr);if(d.hasProperty(Vd.a.font))return k.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",O,a.gq,a.Zr),a=d.fa(Vd.a.font,""),new up(w.a.fromCharCode(parseInt(O)),a);k.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",
O,a.gq,a.Zr)}return z[O]}static Mkn(a){Kh.pj.hasProperty(Vd.a.fontColor)&&a.setValue(Vd.a.fontColor,Kh.pj.fontColor())}static Pkn(a){Kh.pj.hasProperty(Vd.a.fontSize)&&a.setValue(Vd.a.fontSize,Kh.pj.fontSize())}static d8(a,d){a=a===Mb.a.pC?0:a===Mb.a.bL?1:a===Mb.a.Tga?2:-1;d=d.fa(Xc.a.mD,-1);k.ULS.sendTraceTag(22923024,324,50,"ListType: {0}, ListStyleId: {1}",a,d)}static EGn(){const a=la.a.instance.Ca("Common.ISystemInitiatedFeedback");if(a){var d=l.AFrameworkApplication.K.jb("WordDefaultToEditFloodgateDelayInMilliseconds",
6E4);a.execute(n=>{window.setTimeout(()=>{n.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},d)})}else k.ULS.sendTraceTag(554796489,301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}Kh.Q0l=Kd.ImageReader.Lob;Kh.eEf=Kd.ImageReader.aVa;Kh.Wq=null;Kh.zc=null;Kh.Xn=null;Kh.Wl=null;Kh.PAb=null;Kh.QEd=!1;Object(t.a)(Kh,"ListActor",null,[]);class Ps{constructor(){this.sec=new Nf.a(Object(m.a)(this,this.JRf,"createListMarkerDictionary"));this.Kga={}}jsi(a){return a}}
Object(t.a)(Ps,"AListMarkerGalleryLoader",null,[301]);var wx=b(1196);class Go extends Ps{constructor(){super();this.QWb=new qi.a(ma.a.Xi())}jsi(a){Go.kX||this.$in();a in Go.kX&&(a=Go.kX[a]);return a}JRf(){const a={};a["0"]=new up(Box4Intl.Box4Strings.L_ListStyleNone,wx.a.IOi);a["1"]=new up(String.fromCharCode(61623),"Symbol");a["2"]=new up(String.fromCharCode(111),"Courier New");a["3"]=new up(String.fromCharCode(61607),"Wingdings");a["4"]=new up(String.fromCharCode(9643),"Courier New");a["5"]=new up(String.fromCharCode(61611),
"Wingdings");a["6"]=new up(String.fromCharCode(61614),"Symbol");a["7"]=new up(String.fromCharCode(61483),"Symbol");a["8"]=new up(String.fromCharCode(61485),"Symbol");a["9"]=new up(String.fromCharCode(9830),"Courier New");a["10"]=new up(String.fromCharCode(61664),"Symbol");a["11"]=new up(String.fromCharCode(61558),"Wingdings");a["12"]=new up(String.fromCharCode(61656),"Wingdings");a["13"]=new up(String.fromCharCode(61514),"Wingdings");a["14"]=new up(String.fromCharCode(61516),"Wingdings");a["15"]=
new up(String.fromCharCode(61692),"Wingdings");a["16"]=new up(String.fromCharCode(61691),"Wingdings");a["17"]=new up(String.fromCharCode(61553),"Wingdings");return a}C3e(a){a&&a.length&&this.XIf(a)}PNg(){if(this.Kga){var a=Eo.a(this.Kga),d=a.length;for(let n=0;n<d;n++){const z=this.Kga[a[n]];this.QWb.add(z.levelText+"_"+z.font)}}}XIf(a){this.PNg();for(const d of a)if(d&&!d.Zr&&d.iga&&d.wGb&&(a=d.levelText+"_"+d.font,!this.QWb.contains(a))){const n=Eo.a(this.Kga).length+Eo.a(this.sec.value).length+
"";this.Kga[n]=new up(d.levelText,d.font);this.QWb.add(a)}}$in(){Go.kX={};Go.kX["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;Go.kX["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;Go.kX["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;Go.kX["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;Go.kX["Wingdings 0x00ab"]=Box4Intl.Box4Strings.L_Star;Go.kX["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;Go.kX["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;Go.kX["Symbol 0x002d"]=
Box4Intl.Box4Strings.L_Hyphen;Go.kX["Courier New 0x2666"]=Box4Intl.Box4Strings.L_BlackDiamond;Go.kX["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;Go.kX["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;Go.kX["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;Go.kX["Wingdings 0x004a"]=Box4Intl.Box4Strings.L_SmilingFace;Go.kX["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;Go.kX["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;Go.kX["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;
Go.kX["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}Go.kX=null;Object(t.a)(Go,"ListMarkerBulletLoader",Ps,[]);class br{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(t.a)(br,"InfoAtLevel",null,[]);class Cw{constructor(a){this.yz=a}get font(){return"Calibri"}get listStyle(){return 42}get Kt(){return"left"}get HRe(){return this.yz?this.NTm():this.PTm()}get bGd(){return this.yz?this.OTm():null}get levelText(){return""}jAl(a){switch(a){case 1:return"1";case 2:return"a";
case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}NTm(){let a="";for(let d=0;3>d;d++)a+=this.Xvd(d);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Cw.q7f(),a)}OTm(){const a=[];for(let d=0;3>d;d++)a.push(Object.assign(new br,{textAtLevel:this.rCi(d),styleAtLevel:this.pPl(d)}));return a}PTm(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Cw.r7f(),Box4Intl.Box4Strings.L_ListStyleNone)}rCi(a){a=this.yz.NLc[a];
for(let d=0;9>d;d++)a=w.a.replaceAll(a,"%"+(d+1),this.jAl(this.yz.TIb[d]));return a}pPl(a){const d={};d.fontFamily=6===this.yz.TIb[a]?this.yz.hTa[a]:this.font;return d}Xvd(a){const d=this.rCi(a),n=new Sys.StringBuilder;6===this.yz.TIb[a]&&n.append(String.format("font-family:{0};",this.yz.hTa[a]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
a,n.toString(),d)}static q7f(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static r7f(){const a=new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(t.a)(Cw,"ListMarkerMultilevel",null,[299]);var yA=b(1001);class zA extends Ps{constructor(){super()}JRf(){const a=new yA.a,d={};d["0"]=new Cw(null);d["1"]=new Cw(a.YQf());d["2"]=new Cw(a.XRf("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),
[1,2,3,1,2,3,1,2,3]));d["3"]=new Cw(a.xbi([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));return d}C3e(){}}Object(t.a)(zA,"ListMarkerMultilevelLoader",Ps,[]);var Up=b(137);class Vp{constructor(a,d){this.yz=null;this.levelText=a;this.A$d=d}get font(){return"Calibri"}get listStyle(){return this.A$d}get Kt(){switch(this.A$d){case 3:case 5:return"right";default:return"left"}}get HRe(){switch(this.A$d){case 1:return this.lPc("1",
"2","3");case 2:return this.lPc("a","b","c");case 3:return this.lPc("i","ii","iii");case 4:return this.lPc("A","B","C");case 5:return this.lPc("I","II","III");case 0:return this.QTm();default:return this.lPc("1","2","3")}}get bGd(){const a=[],d={};d.fontFamily=Up.FontUtils.Gya(this.font);switch(this.A$d){case 1:return a.push(Object.assign(new br,{textAtLevel:this.g4("1"),styleAtLevel:d})),a.push(Object.assign(new br,{textAtLevel:this.g4("2"),styleAtLevel:d})),a.push(Object.assign(new br,{textAtLevel:this.g4("3"),
styleAtLevel:d})),a;case 2:return a.push(Object.assign(new br,{textAtLevel:this.g4("a"),styleAtLevel:d})),a.push(Object.assign(new br,{textAtLevel:this.g4("b"),styleAtLevel:d})),a.push(Object.assign(new br,{textAtLevel:this.g4("c"),styleAtLevel:d})),a;case 3:return a.push(Object.assign(new br,{textAtLevel:this.g4("i"),styleAtLevel:d})),a.push(Object.assign(new br,{textAtLevel:this.g4("ii"),styleAtLevel:d})),a.push(Object.assign(new br,{textAtLevel:this.g4("iii"),styleAtLevel:d})),a;case 4:return a.push(Object.assign(new br,
{textAtLevel:this.g4("A"),styleAtLevel:d})),a.push(Object.assign(new br,{textAtLevel:this.g4("B"),styleAtLevel:d})),a.push(Object.assign(new br,{textAtLevel:this.g4("C"),styleAtLevel:d})),a;case 5:return a.push(Object.assign(new br,{textAtLevel:this.g4("I"),styleAtLevel:d})),a.push(Object.assign(new br,{textAtLevel:this.g4("II"),styleAtLevel:d})),a.push(Object.assign(new br,{textAtLevel:this.g4("III"),styleAtLevel:d})),a;case 0:return null;default:return a.push(Object.assign(new br,{textAtLevel:this.g4("1"),
styleAtLevel:d})),a.push(Object.assign(new br,{textAtLevel:this.g4("2"),styleAtLevel:d})),a.push(Object.assign(new br,{textAtLevel:this.g4("3"),styleAtLevel:d})),a}}lPc(a,d,n){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',Vp.q7f(),this.Xvd(a),this.Xvd(d),this.Xvd(n))}QTm(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',Vp.r7f(),Box4Intl.Box4Strings.L_ListStyleNone)}Xvd(a){a=this.g4(a);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',
a)}g4(a){return w.a.replaceAll(this.levelText,"%1",a)}static q7f(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static r7f(){const a=new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(t.a)(Vp,"ListMarkerNumbering",null,[299]);class ky extends Ps{constructor(){super();this.QWb=new qi.a(ma.a.Xi())}zfm(a){a=a.match(RegExp("%[1-9]","g"));return!!a&&1===a.length}JRf(){const a=
{};a["0"]=new Vp(Box4Intl.Box4Strings.L_ListStyleNone,0);a["1"]=new Vp("%1.",5);a["2"]=new Vp("%1.",4);a["3"]=new Vp("%1.",1);a["4"]=new Vp("%1.",2);a["5"]=new Vp("%1.",3);a["6"]=new Vp("%1)",5);a["7"]=new Vp("%1)",4);a["8"]=new Vp("%1)",1);a["9"]=new Vp("%1)",2);a["10"]=new Vp("%1)",3);a["11"]=new Vp("(%1)",5);a["12"]=new Vp("(%1)",4);a["13"]=new Vp("(%1)",1);a["14"]=new Vp("(%1)",2);a["15"]=new Vp("(%1)",3);return a}C3e(a){a&&a.length&&this.XIf(a)}PNg(){if(this.Kga){var a=Eo.a(this.Kga),d=a.length;
for(let n=0;n<d;n++){const z=this.Kga[a[n]];this.QWb.add(z.levelText+"_"+z.listStyle)}}}XIf(a){this.PNg();for(const d of a)if(d&&d.Zr&&d.iga&&this.zfm(d.levelText)&&d.listStyle&&(a=wx.a.h4f(d.levelText))){const n=a+"_"+d.listStyle;if(!this.QWb.contains(n)){const z=Eo.a(this.Kga).length+Eo.a(this.sec.value).length+"";this.Kga[z]=new Vp(a,d.listStyle)}this.QWb.add(n)}}}Object(t.a)(ky,"ListMarkerNumberingLoader",Ps,[]);class Jz{constructor(){this.Z=null}get name(){return"Box4.ListMarker"}init(){Kh.lb()}dispose(){}Hb(a){this.Z=
a;this.Z.ha("Box4.ListMarkerGallery.ListMarkerBulletLoader",()=>new Go).singleInstance();this.Z.ha("Box4.ListMarkerGallery.ListMarkerNumberingLoader",()=>new ky).singleInstance();this.Z.ha("Box4.ListMarkerGallery.ListMarkerMultilevelLoader",()=>new zA).singleInstance()}static main(){M.a.instance.Sb(new Jz)}}Object(t.a)(Jz,"Box4ListMarkerPackage",null,[1,2]);class Py{static get Lf(){return xg.a.oz(Py.fm,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,
"")}}Py.fm="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(t.a)(Py,"DefineNewBulletDialogHtml",null,[]);class Fp extends xg.a{constructor(a,d,n,z){super();this.M6c=this.tmf=this.muc=this.huc=null;this.VXb=0;this.Uhd=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.LMi=!0;this.rw=a;this.Wg=d;this.ga=n;this.wZ=!1;z&&(a=z.indexOf(","),-1!==a&&(z=z.substring(0,a)));this.fontName=z;this.Je="DefineNewBulletDialog";this.Lf=Py.Lf;this.ee(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.ee(0,CommonUIStrings.l_DialogClose);this.Ih(Box4Intl.Box4Strings.L_SymbolSingle,
Object(m.a)(this,this.Q7k,"defineNewBulletHandler"),null);this.XO=!1;this.kXa();document.getElementById(Fp.Wue).focus()}kXa(){this.Wg.rk().scope.zq(ic.FocusManager.instance().kN);this.Wg.rk().scope.zq(ic.FocusManager.instance().lN);this.Wg.rk().scope.bindAction(ic.FocusManager.instance().kN,Mb.a.rod);this.Wg.rk().scope.bindAction(ic.FocusManager.instance().lN,Mb.a.qod)}rV(){this.lle(Fp.Wue,"DefineNewBulletFontPlaceholder",Mb.a.pod.toString(),Mb.a.kLb.toString(),Mb.a.bPc.toString(),Box4Intl.Box4Strings.L_FontName,
"100px");this.TIk()}IV(){super.IV();document.getElementById(this.Kg("WACDialogPanel")).style.width="auto"}lle(a,d,n,z,O,ca,Da){n=Uh.c(a,n,!0,!0,z,O,w.a.Vd(ca),!0,Da);this.npe(a,d,n,"Medium")}TIk(){const a=document.getElementById(Fp.GCc);a&&(a.innerHTML=this.fwi(),this.Flj(a))}Flj(a){if(a=a.getElementsByClassName("DefineNewBulletTableCell"))for(let d=0;d<a.length;d++)Qc.a.addHandler(a[d],vb.a.focus,Object(m.a)(this,this.R7k,"defineNewBulletListMarkerTableFocusHandler"))}nMn(){var a=document.getElementById(Fp.GCc);
if(a){let d=this.fontName;const n=wx.a.jmg(this.fontName);n&&61472!==this.VXb||!n&&32!==this.VXb?(a.innerHTML=this.fwi(),this.Flj(a)):(a=a.getElementsByTagName("table"))&&1===a.length&&d&&(d=this.XUh(d),a[0].style.fontFamily=d)}}R7k(a){if(this.huc&&a.target!==this.huc){const d=this.Wg.rk();d&&d.Tf&&(d.Tf.ou(a.target),this.huc=a.target)}this.NJm(a.target.id)}NJm(a){this.Rxj(this.muc,!1);this.muc=a;this.Rxj(a,!0);if((a=document.getElementById("CharacterCodeValueLabel"))&&this.muc){let d=parseInt(this.muc.substr(this.muc.lastIndexOf("_")+
1));-1!==d&&(d-=61472===this.VXb?61440:0,a.innerText=w.a.Ev(d,4))}}Rxj(a,d){(a=this.Lzi(a))&&(d?a.setAttribute("selected","true"):a.removeAttribute("selected"))}Lzi(a){const d=document.getElementById(Fp.GCc);return d?d.querySelector("#"+a):null}Yka(){const a=document.getElementById(Fp.GCc);a&&(this.tmf||(this.tmf=Object(m.a)(this,this.Xkm,"listMarkerTableClickHandler"),this.Jl.Ea(vb.a.click,a,this.tmf)),this.M6c||(this.M6c=Object(m.a)(this,this.Ykm,"listMarkerTableKeyHandler"),this.Cc.Ea(vb.a.Nf,
a,this.M6c),this.Cc.Ea(vb.a.Bn,a,this.M6c),this.Cc.Ea(vb.a.Of,a,this.M6c)));super.Yka()}EVi(a){return Object(oj.a)(a,"DefineNewBulletTableCell")}Xkm(a){a=a.Ec;if(!this.EVi(a))return!1;this.Wg.rk().Tf.ou(a);a.focus();return!0}Ykm(a){var d=a.Ec;if(!this.EVi(d))return!1;var n=d.id;n=parseInt(n.substr(n.lastIndexOf("_")+1))-this.VXb;if(a.Ua.ctrlKey||a.Ua.altKey||a.Ua.keyCode>=xb.a.Ewb&&a.Ua.keyCode<=xb.a.z$a)return!1;const z=a.Ua.keyCode;if(a.eventName===vb.a.Nf){a=-1;if(z===Sys.UI.Key.enter)return this.Wg.rk().Tf.ou(d),
d.focus(),this.Y9i(d.id),this.hide(),!0;z===Sys.UI.Key.up?a=n-17:z===Sys.UI.Key.down?a=n+17:z===Sys.UI.Key.left?a=l.AFrameworkApplication.isRtl?n+1:n-1:z===Sys.UI.Key.right&&(a=l.AFrameworkApplication.isRtl?n-1:n+1);0<=a&&(d=this.Lzi(Fp.GCc+"_"+(a+this.VXb)))&&d.focus()}return!0}Y9i(a){if(a){a=a.split("_");const d=new dh.DictionaryPropertySet;d.setValue(Xc.a.mD,parseInt(a[1]));d.setValue(Vd.a.font,this.fontName);d.setValue(Xc.a.Ju,1);at.a.p0&&(d.setValue(bd.a.Lsa,"command-ui"),d.setValue(bd.a.Yma,
"define-new-bullet-dialog"));this.ga.ob(Mb.a.pC,2,d)}this.Wg.bG(this.OB,!0)}fwi(){const a=new Sys.StringBuilder,d=wx.a.jmg(this.fontName);let n=this.fontName;n=this.XUh(n);a.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',n));d?(this.VXb=61472,a.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.VXb=32,a.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
a.append("</table>");return a.toString()}XUh(a){a&&-1!==a.indexOf(" ")&&(a="'"+a+"'");return a}npe(a,d,n,z){d=document.getElementById(d);this.rw.e2a(a,n);n=this.rw.xFb(a,z);d.appendChild(n);this.rw.T0(a)}Q7k(a){1===a&&this.Y9i(this.muc);this.hide()}dispose(){this.wZ||(this.rw.WI(Fp.Wue),this.wZ=!0);super.dispose()}}Fp.Wue="DefineNewBulletFontStyleComboBox";Fp.GCc="DefineNewBulletTableContainer";Object(t.a)(Fp,"DefineNewBulletDialog",xg.a,[]);class Qy{fvd(){return Mb.a.ZXi}Wvd(){return Mb.a.nRe}}Object(t.a)(Qy,
"ListMarkerGalleryBulletCommands",null,[317]);class ou{fvd(){return Mb.a.aYi}Wvd(){return Mb.a.ffj}}Object(t.a)(ou,"ListMarkerGalleryMultilevelCommands",null,[317]);class xx{fvd(){return Mb.a.bYi}Wvd(){return Mb.a.oRe}}Object(t.a)(xx,"ListMarkerGalleryNumberingCommands",null,[317]);class Ry{constructor(a,d,n,z,O){this.fNa=this.L0a=null;this.ga=a;this.zc=z.resolve("Box4.List.IListReader");this.yea=d;this.wok=n;switch(this.yea){case 0:a=z.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader");this.L0a=
new Qy;break;case 1:a=z.resolve("Box4.ListMarkerGallery.ListMarkerNumberingLoader");this.L0a=new xx;break;case 2:a=z.resolve("Box4.ListMarkerGallery.ListMarkerMultilevelLoader");this.L0a=new ou;break;default:a=z.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader"),this.L0a=new Qy}O=this.zc?this.zc.Hzi(O):null;a.C3e(O);this.Wek=new wx.a(d,a,O,!!l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.epb)}lb(){this.ga.ma(this.L0a.Wvd(),Kb.a.view,Lb.App.P9a.Jbi(11));this.ga.ma(this.L0a.Wvd(),Kb.a.outlineElement,
Object(m.a)(this,this.ARm,"populateListMarkerGalleryDropDown"));this.ga.$b(this.L0a.Wvd(),1124);this.yea||(this.ga.Aa(Mb.a.AIe,Kb.a.view,Object(m.a)(this,this.wjm,"launchDefineNewBulletDialogHandler"),1028),this.ga.Aa(Mb.a.bPc,Kb.a.view,Object(m.a)(this,this.bPc,"populateDefineNewBulletFontDropdown"),1124),this.ga.Aa(Mb.a.pod,Kb.a.view,Object(m.a)(this,this.P7k,"defineNewBulletFontNameHandler"),1028),this.ga.Aa(Mb.a.rod,Cd.a.frame,Object(m.a)(this,this.hfi,"defineNewBulletMoveFocusForTabsHandler"),
64),this.ga.Aa(Mb.a.qod,Cd.a.frame,Object(m.a)(this,this.hfi,"defineNewBulletMoveFocusForTabsHandler"),64));this.ga.ma(this.L0a.fvd(),Kb.a.view,Object(m.a)(this,this.$Xi,"listMarkerGalleryMenuOpen"));this.ga.ma(this.L0a.fvd(),Kb.a.outlineElement,Object(m.a)(this,this.$Xi,"listMarkerGalleryMenuOpen"));this.ga.$b(this.L0a.fvd(),1124)}hfi(a){if(!this.fNa)return 2;if(this.fNa.Wg.rk().Tf.VG.id.startsWith(Fp.GCc)){let d=null;a===Mb.a.rod?d=this.fNa.sRa:a===Mb.a.qod&&(d=document.getElementById(Fp.Wue));
if(!d)return 2;this.fNa.Wg.rk().Tf.ou(d);d.focus()}else if(a===Mb.a.rod)this.fNa.Wg.rk().oWa();else if(a===Mb.a.qod)this.fNa.Wg.rk().nWa();else return 2;return 32}$Xi(a,d){a=null;d.view.Yd&&(a=d.view);return a&&a.Oa?32:(Ld.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",d.toString()),8)}wjm(a,d,n){return 1===n?32:2===n?(a=this.LGc(d),a=La.FormattingReader.yr(a).cache.bD,this.fNa=new Fp(this.wok,ic.FocusManager.instance(),
l.AFrameworkApplication.pa,a),32):8}LGc(a){return this.gwe(a).ra}gwe(a){let d=null;a=a.view;return a?d=Qd.SelectionEditor.Xf(a.Oa.ya.J(0),!1,!1):d}bPc(a,d,n,z,O){if(1===n)return 32;if(2===n&&!O)return 8;if(this.fNa.LMi){for(a=0;a<wx.a.Uhd.length;a++)Up.FontUtils.bch(wx.a.Uhd[a]);this.fNa.LMi=!1}nn.a.Zac(d);O.PopulationXML=Up.FontUtils.n4f(nn.a.dmc,nn.a.qsd,Mb.a.pod,!1);return 32}ARm(a,d,n,z,O){a=d.contextId===Kb.a.outlineElement;if(1===n||!a)return a?32:8;if(2===n&&!O)return 8;O.MenuItems=this.Wek.QEl();
return 32}P7k(a,d,n,z,O){if(1===n)return 32;if(2===n){a=Object(qa.a)(28,O);if(!a||!a.$c)return 8;this.fNa.fontName=a.$c.fontName;this.fNa.nMn();return 32}return 8}}Object(t.a)(Ry,"ListMarkerGalleryActor",null,[258]);class AA{constructor(){this.he=this.Z=null}get name(){return"Box4.ListMarkerGallery"}init(){if(Ic.InteractiveViewManager.instance){var a=Ic.InteractiveViewManager.instance;a.editingView&&(this.he=a.editingView.xc,this.B3m())}}dispose(){}Hb(a){this.Z=a}B3m(){(new Ry(l.AFrameworkApplication.pa,
1,this.Z.resolve("Common.IStandaloneRootController").e1,this.Z,this.he)).lb();(new Ry(l.AFrameworkApplication.pa,0,this.Z.resolve("Common.IStandaloneRootController").e1,this.Z,this.he)).lb();(new Ry(l.AFrameworkApplication.pa,2,this.Z.resolve("Common.IStandaloneRootController").e1,this.Z,this.he)).lb()}static main(){M.a.instance.Sb(new AA)}}Object(t.a)(AA,"Box4ListMarkerGalleryPackage",null,[1,2]);var Um=b(345),Jr=b(464),yx=b(395),jp=b(111);const ut=a=>{a.element.style.top=""};var Pv=b(926);class vp{constructor(a,
d,n){this.RC=!1;this.Rxb=0;this.D9=this.vIh=null;this.vl=a;this.wpk=d;this.Mr=n;this.AJ=a.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.uv=!!l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.T7)&&!this.Mr.qXf&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";I.a.Og&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.AJ}get visible(){return this.RC}set_visible(a){if(this.RC!==
a)return(this.RC=a)?this.Yhd():this.QDb(),a}dispose(){this.visible&&this.QDb();ae.a.P6(this.htmlElement);this.vl=this.AJ=null}nCj(a,d){const n=a.htmlElement||a.createElement();d===this.htmlElement.childNodes.length?this.htmlElement.appendChild(n):this.htmlElement.insertBefore(n,this.htmlElement.childNodes[d]);a.Vqj();this.Rxb+=a.htmlElement.clientHeight;var z=this.htmlElement.childNodes,O=a.cYh,ca=Object(m.a)(this,this.jCm,"onAfterShowEntry");jp.WacAirSpace.$I(n,"Shared_BasicClass");var Da=new yx.a(n);
Da.e_(0,1);const Xa=new Jr.a(n);Xa.oqa(n.clientTop-30,n.clientTop);O?(jp.WacAirSpace.HJa(Da,null,null),jp.WacAirSpace.HJa(Xa,null,ca)):(jp.WacAirSpace.animate(Da,null,null),jp.WacAirSpace.animate(Xa,null,ca));for(d+=1;d<z.length;d++)ca=z[d],jp.WacAirSpace.$I(ca,"Shared_BasicClass"),Da=new Jr.a(ca),Da.oqa(ca.clientTop-n.clientHeight,ca.clientTop),O?jp.WacAirSpace.HJa(Da,null,null):jp.WacAirSpace.animate(Da,null,null);a.Gun();this.set_visible(!0)}gKi(a){const d=a.htmlElement;if(ae.a.V5a(d)){this.Rxb-=
a.htmlElement.clientHeight;var n=d.parentNode.children;a=a.cYh;var z=Object(m.a)(this,this.aCm,"onAfterHideEntry");jp.WacAirSpace.$I(d,"Shared_BasicClass");var O=new Um.a(d);O.e_(1,0);a?jp.WacAirSpace.HJa(O,null,z):jp.WacAirSpace.animate(O,null,z);z=!1;for(O=0;O<n.length;O++){if(z){const ca=n[O];jp.WacAirSpace.$I(ca,"Shared_BasicClass");const Da=new Jr.a(ca);Da.oqa(ca.clientTop,-d.clientHeight);a?jp.WacAirSpace.HJa(Da,null,ut):jp.WacAirSpace.animate(Da,null,ut)}z||n[O]!==d||(z=!0)}}}jCm(a){a.element.style.top=
"";l.AFrameworkApplication.la.Xfc()}aCm(a){a.element.parentNode.removeChild(a.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);l.AFrameworkApplication.la.Xfc()}Yhd(){""===this.vl.style.top.trim()&&(this.vl.style.top=this.vl.offsetTop+"px");this.htmlElement.style.left=this.vl.style.left;this.htmlElement.style.top=this.vl.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var a=Sys.UI.DomElement.getBounds(this.htmlElement);this.vIh=this.vl.style.top;
this.Rxb=a.height;this.N3e();l.AFrameworkApplication.la.sU(Object(m.a)(this,this.onResize,"onResize"));Qc.a.addHandler(this.htmlElement,vb.a.btb,Qc.a.hya);this.D9=Object(m.a)(this,this.Haa,"contextMenuHandler");l.AFrameworkApplication.la.x5.Ea(this.htmlElement,this.D9,null);if(ic.FocusManager.jA()){var d=ic.FocusManager.instance();a=d.Kc(Pv.a.JGa);a.parent=Ec.AFrame.hp;const n=new kd.DOMFocusListing(()=>this.htmlElement);n.Ln(1);n.Ln(2);n.Ln(8);d.jfa(()=>this.htmlElement,a,n);d=d.getRegion(Pv.a.JGa);
d.wKa();d.MS=!0;d.zya=!0;const z=l.AFrameworkApplication.la.rn;a.Hxa(()=>{z.gx(Pv.a.JGa)});z.CR(Pv.a.JGa);(n.VU||l.AFrameworkApplication.K.ea("ReactBusinessBarIsEnabled"))&&z.bE(Pv.a.JGa)}}QDb(){this.RBj()&&(this.vl.style.top=this.vIh);this.htmlElement.style.visibility="hidden";l.AFrameworkApplication.la&&(ic.FocusManager.jA()&&ic.FocusManager.instance().nsb(Pv.a.JGa),this.D9&&(l.AFrameworkApplication.la.x5.kb(this.htmlElement,this.D9),this.D9=null));Qc.a.removeHandler(this.htmlElement,vb.a.btb,Qc.a.hya)}N3e(){if(this.RBj()&&
this.visible){var a=this.vl,d=this.Rxb+this.wpk;const n=ae.a.kO(a.style.top);jp.WacAirSpace.$I(a,"Shared_BasicClass");a=new Jr.a(a);a.oqa(n,d);jp.WacAirSpace.animate(a,null,null)}}RBj(){return!this.uv&&!this.Mr.qXf}onResize(){const a=this.Mr.entries.length,d=Sys.UI.DomElement.getBounds(this.htmlElement).height;let n;for(let z=0;z<a;++z)n=this.Mr.entries[z],n.htmlElement&&n.Vqj();this.Rxb=Sys.UI.DomElement.getBounds(this.htmlElement).height;d!==this.Rxb&&this.N3e()}Haa(){return!0}}Object(t.a)(vp,"BusinessBarDom",
null,[1021,12]);var dt;(function(a){a[a.none=0]="none";a[a.corruptPage=1]="corruptPage";a[a.currentPageStatus=2]="currentPageStatus";a[a.documentMarkedAsFinal=3]="documentMarkedAsFinal";a[a.documentSigned=4]="documentSigned";a[a.fileAccess=5]="fileAccess";a[a.kickoutWithDataLoss=6]="kickoutWithDataLoss";a[a.lostSession=7]="lostSession";a[a.malformedHyperlinkUris=8]="malformedHyperlinkUris";a[a.odt=9]="odt";a[a.readonlyRecommended=10]="readonlyRecommended";a[a.saveReplaySuccess=11]="saveReplaySuccess";
a[a.saveReplayFailed=12]="saveReplayFailed";a[a.unsupportedObjects=13]="unsupportedObjects";a[a.word11Compat=14]="word11Compat";a[a.unsupportedBrowser=15]="unsupportedBrowser";a[a.applicationNotification=16]="applicationNotification";a[a.skypeDocChatFailed=17]="skypeDocChatFailed";a[a.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";a[a.sessionExpired=19]="sessionExpired";a[a.irmPolicyDescription=20]="irmPolicyDescription";a[a.policyWarningMessage=21]="policyWarningMessage";a[a.thirdPartyAddinDisabled=
22]="thirdPartyAddinDisabled";a[a.gdprPrivacyNotice=23]="gdprPrivacyNotice";a[a.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";a[a.graphMergePrompt=25]="graphMergePrompt";a[a.readOnlyDocument=26]="readOnlyDocument";a[a.dictationSilence=27]="dictationSilence";a[a.autoSensitivityLabel=28]="autoSensitivityLabel";a[a.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";a[a.dictationDebugInfo=30]="dictationDebugInfo";a[a.oneNoteCovid19Message=31]="oneNoteCovid19Message";a[a.citationStylePrompt=
32]="citationStylePrompt";a[a.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";a[a.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";a[a.oneNotePagePrintReady=35]="oneNotePagePrintReady";a[a.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled";a[a.mandatoryLabel=37]="mandatoryLabel";a[a.policyTip=38]="policyTip";a[a.minorVersionLimit=39]="minorVersionLimit";a[a.testEntry1=40]="testEntry1";a[a.testEntry2=41]="testEntry2";a[a.testEntry3=42]="testEntry3";a[a.testEntry4=
43]="testEntry4";a[a.testEntry5=44]="testEntry5";a[a.testEntry6=45]="testEntry6";a[a.testEntry7=46]="testEntry7"})(dt||(dt={}));Object(t.b)("BusinessBarId",dt);class vt{constructor(a,d=0,n=null,z=null){this.dCh=this.auh=!1;this.Hvc=null;this.MD=[];this.aab=z||new vp(a,d,this);this.U3l(n)}U3l(a){if(a){this.Hvc={};a=a.ranking;for(let d=0;d<a.length;d++)this.Hvc[dt[a[d]]]=d}}dispose(){this.aab.dispose();Ja.a.jWe(this.MD);this.MD=null}get htmlElement(){return this.aab.htmlElement}get visible(){return this.aab.visible}get qXf(){return this.auh}set qXf(a){this.auh=
a}get rrg(){return this.dCh}set rrg(a){this.dCh=a}get entries(){return this.MD}set entries(a){this.MD=a}nsa(a){for(let d=0;d<this.MD.length;d++)if(this.MD[d].id===a)return!0;return!1}BB(a,d=!1,n=null,z=null,O=null){a.zL=this;let ca=this.XCl(a.id);d&&!this.Hvc&&(ca=0);ca<vt.efc&&(this.aab.nCj(a,ca),this.MD.length>=vt.efc&&this.aab.gKi(this.MD[vt.efc-1]),this.aab.N3e());Array.insert(this.MD,ca,a);k.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",dt[a.id],void 0===
a.Eib||null===a.Eib?"":a.Eib);a.errorCode&&l.AFrameworkApplication.KH(a.errorCode,n,z,O)}removeEntry(a){const d=Array.indexOf(this.MD,a);-1!==d&&d<vt.efc&&(this.MD.length>vt.efc&&this.aab.nCj(this.MD[vt.efc],vt.efc),this.aab.gKi(a),this.aab.N3e());Array.remove(this.MD,a);a.zL=null;a.dispose()}XCl(a){if(!this.Hvc||0===a)return this.MD.length;a=this.Hvc[dt[a]];if(void 0===a||null===a)return this.MD.length;for(let d=0;d<this.MD.length;d++)if(a<this.Hvc[dt[this.MD[d].id]])return d;return this.MD.length}}
vt.efc=2;Object(t.a)(vt,"BusinessBar",null,[998,12,999]);class Hq{create(a,d,n){return new gd.a(a,d,n)}}Object(t.a)(Hq,"Factory",null,[1020]);class qB{static HWk(a,d){a.register(vt,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").singleInstance().zd(()=>new vt(d.value,0,a.sa("CommonUI.IBusinessBarRankProvider")));a.register(Hq,"CommonUI.BusinessBarEntry.Factory").as("CommonUI.IBusinessBarEntryFactory").singleInstance()}}Object(t.a)(qB,"CommonUIComponentConfiguration",null,[]);var BA=b(1486);class Xu extends BA.a{constructor(){super()}static get instance(){return Xu.na||
Xu.Zjg()}static Zjg(){Xu.na=new Xu;return Xu.na}}Xu.na=null;Object(t.a)(Xu,"ReactRootManager",BA.a,[261,262]);class CA extends Xg.a{constructor(){super()}get ControlType(){return 3}}Object(t.a)(CA,"CompoundButtonProps",Xg.a,[]);class Qv{constructor(a,d,n,z,O,ca,Da){this.JW=d;this.yad=a;this.XAh=d.s$l;this.Ntc=d.eEd;this.qjf=ca;this.NUb=z;this.OUb=O;this.IUb=n;this.ky=Da;this.Xyb=new me.a;this.Xyb.$(1,"SpellingIssue_16x16x32");this.Xyb.$(2,"GrammarIssue_16x16x32");this.Xyb.$(3,"WritingIssue_16x16x32");
this.Xyb.$(4,null);this.Xyb.$(0,null)}create(a,d,n){d=Object(qa.a)(Mi.a,d);if(!d)return k.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const z=new Sys.StringBuilder;a=this.kzi(a);this.eCc(z,d,n,a);this.yRf(z,d);this.u3k(z,d,a);return z.toString()}T5b(a,d,n){const z=Object(qa.a)(Mi.a,d);if(!z)return k.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];d=[];a=this.kzi(a);this.pSf(d,z,n,a);this.zRf(d,z);this.v3k(d,z,a);for(n=0;n<d.length;n++)d[n].Id=
`${As.dji}_${n}`;return d}eCc(a,d,n,z=null){d.errorType?1===d.errorType&&(this.ZDc(d)||a.append(this.PIf(d,n,z))):a.append(this.yad.build())}pSf(a,d,n,z=null){d.errorType?1===d.errorType&&(this.ZDc(d)||a.push(this.PIk(d,n,z))):a.push(this.yad.v2h())}yRf(a,d){const n=new Sys.StringBuilder;this.YCj(d)?n.append(Uh.a("btnIgnoreAllSpellingError",(2===d.errorType?Mb.a.ALa:Mb.a.bsa).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.ZDc(d)||n.append(Uh.a("btnIgrnoreSpellingError",this.qyi(d.errorType).toString(),
Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.cDj(d)&&(this.JW.GQi&&n.append(Uh.a("btnDoNotCheckForThisIssue",Mb.a.bEb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),n.append(Uh.a("btnGrammarOptions",Mb.a.UJa.toString(),w.a.Vd(Box4Intl.Box4Strings.l_GrammarOptions),null)));n.isEmpty()||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append(n.toString()),a.append("</Controls></MenuSection>"))}zRf(a,d){const n=Object.assign(new fi.a,
{ControlList:[]});if(this.YCj(d)){var z=nq.a.tH()?Object.assign(new Xg.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:Mb.a.bsa,LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new Xg.a,{ExternalId:2===d.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});n.ControlList.push(z)}else this.ZDc(d)||(z=Object.assign(new Xg.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.qyi(d.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),
n.ControlList.push(z));this.cDj(d)&&(this.JW.GQi&&(d=Object.assign(new Xg.a,{ExternalId:"DoNotCheckForThisIssue"}),n.ControlList.push(d)),d=Object.assign(new Xg.a,{ExternalId:"GrammerSettingsContext"}),n.ControlList.push(d));a.push(n)}kzi(a){if(!this.ky)return null;a=this.ky.language(this.ky.yr(a.ra));return Ih.a.yf(a)?Ih.a.yf(a).name:null}qyi(a){return 2===a?Mb.a.ALa:this.JW.nbm?Mb.a.DLi:Mb.a.nAa}u3k(a,d,n=null){if(this.V3g(d)){var z=w.a.Vd(d.MA.CategoryTitle);z=Uh.r(As.uPc,Sa.a.Rka,this.Xyb.J(d.proofingType),
""!==z?z:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[a.toString()],this.NUb,this.OUb);z=Uh.e("cgProofingOuter",[z]);a.clear();a.append(Uh.j("msProofingOuter",z,"Menu16",void 0,void 0,n,"ariaLabelledById"));k.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",d.proofingType,d.typeId)}}v3k(a,d,n=null){if(this.V3g(d)){var z=w.a.Vd(d.MA.CategoryTitle);n=Object.assign(new $i.a,{ExternalId:String.format("{0}_{1}",As.uPc,d.proofingType),Command:Sa.a.Rka.toString(),
Image16by16Class:this.Xyb.J(d.proofingType),LabelText:""!==z?z:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:n,Menu:Object.assign(new he.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.wsl(d),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});n.Menu.MenuSectionList.push(...a);Array.clear(a);z=Object.assign(new fi.a,{ControlList:[]});z.ControlList.push(n);a.push(z);k.ULS.sendTraceTag(39188234,375,
50,"Show 2-level context menu of type {0}, critique id {1}",d.proofingType,d.typeId)}}PIf(a,d,n=null){const z=this.Vyl(a);var O=[];let ca=!1;var Da=a.MA.Suggestions;if(Da)if(Da=Da.slice(0,Math.min(3,Da.length)),this.XAh&&(ca=!Fg.a.any(Da,Xa=>!Xa||!Xa.Description)),1!==Da.length||Da[0].Action){let Xa=0,zb=null;ca&&(zb="font-weight: bold;");for(const Vb of Da){if(!Vb)continue;Da=null;let Fc="";const Yc=w.a.Vd(Vb.Text);ca&&(Da=this.Pti(Vb.Description),Fc=this.Oti(Vb.Description));O.push(Uh.a("btnCorrectWord"+
Xa,d[Xa].toString(),Yc,null,null,null,null,null,zb,null,Da,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,z,Yc),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.vai(a.token)),"ariaDescribedById",Fc));Xa++}}else d=w.a.Vd(Da[0].Text),O.push(Uh.a("btnCorrectWord0",Mb.a.ALa.toString(),d,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,
z,d)));d="Menu16";0<O.length?ca&&(d="Menu16DescriptionEnabled"):O=[Uh.a("btnNoSuggestions",Mb.a.ALa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)];return Uh.j("msUnknownWord",Uh.e(null,O),d,z,this.MFl(a),n,"ariaLabelledById")}PIk(a,d,n=null){var z=1!==a.proofingType&&0!==a.proofingType?a.MA.ExplanationTitle:"";z=Object.assign(new fi.a,{Title:z,Lang:n,ControlList:[]});let O=!1;var ca=a.MA.Suggestions;if(ca)if(ca=ca.slice(0,Math.min(3,ca.length)),this.XAh&&(O=!Fg.a.any(ca,Da=>!Da||!Da.Description)),
1!==ca.length||ca[0].Action){let Da=0;for(const Xa of ca){if(!Xa)continue;ca=null;let zb="";O&&(ca=this.Pti(Xa.Description),zb=this.Oti(Xa.Description));if(Da>=d.length)break;ca?(ca=Object.assign(new CA,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",Da,a.proofingType),Command:d[Da].toString(),LabelText:Xa.Text,Description:ca,Lang:n,AriaDescription:zb}),z.ControlList.push(ca)):(ca=Object.assign(new Xg.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",Da,a.proofingType),
Command:d[Da].toString(),LabelText:Xa.Text,Lang:n,RoleInMenu:"menuitem"}),z.ControlList.push(ca));Da++}}else a=ca[0],a=Object.assign(new Xg.a,{ExternalId:"NoSuggestion",Command:Mb.a.ALa.toString(),LabelText:a.Text}),z.ControlList.push(a);0>=z.ControlList.length&&Array.add(z.ControlList,Object.assign(new Xg.a,{ExternalId:"btnNoSuggestions",Command:Mb.a.ALa.toString(),LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return z}Vyl(a){return w.a.Vd(0!==a.proofingType?a.MA.ExplanationTitle:"")}MFl(a){return this.V3g(a)?
null:this.Xyb.J(a.proofingType)}V3g(a){return this.Ntc&&2!==a.errorType&&(1!==a.errorType||!this.ZDc(a))}YCj(a){return this.qjf&&!!a.errorType&&1===a.proofingType&&!this.ZDc(a)}wsl(a){return 1===a.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.vai(a.token)):""}cDj(a){return this.JW.IGe&&this.Ntc&&1===a.errorType&&(2===a.proofingType||3===a.proofingType)}ZDc(a){return!!a.errorType&&!!this.IUb&&this.IUb.contains(a.token,a.lcid)}Pti(a){return""===
a?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):a}Oti(a){return""!==a?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,a):""}vai(a){let d="";if(a){let n;for(n=0;n<a.length-1;n++)d=d+a.charAt(n)+",";d+=a.charAt(n)}return d}}Object(t.a)(Qv,"EditorServiceProofingContextMenuCreator",null,[]);class mj{get ranking(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(t.a)(mj,
"BusinessBarRankProvider",null,[255]);class zx{constructor(){this.Z=null}get name(){return"Wonca.UI"}Hb(a){this.Z=a;a.ha("CommonUI.IBusinessBarRankProvider",()=>new mj).singleInstance();qB.HWk(a,new Nf.a(()=>Lb.App.oa.zP));a.ha("Box4.UI.EditorServiceProofingContextMenuCreator",()=>new Qv(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),a.resolve("Box4.Proofing.IProofingFeatureConfiguration"),a.resolve("Box4.Proofing.IIgnoreAllKeywords"),l.AFrameworkApplication.YL,l.AFrameworkApplication.ln,
l.AFrameworkApplication.K.ea("WordEditorProofingIgnoreAll"),a.resolve("Box4.IFormattingReader"))).singleInstance();a.ha("CommandUI.ReactRootManager",()=>Xu.instance).as("Common.IReactRootManager").singleInstance()}init(){this.Z.resolve("Wonca.IRibbonUserFactory");this.Z.resolve("CommonUI.IBusinessBar")}dispose(){}static main(){M.a.instance.Sb(new zx)}}Object(t.a)(zx,"WoncaUIPackage",null,[1,2]);class DA{constructor(a){this.JT=this.L8c=null;this.Tn=a}get key(){return"BOOKMARK"}get jz(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get jHa(){return this.JT}reset(a){this.JT=
a.node}oZa(a){let d=null;if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)){if(this.L8c&&this.Tn.k9b(this.jHa,a)==this.L8c)return d=Object.assign(new cn.a,{PK:this.key,contentObject:this.L8c}),{returnValue:!0,wL:d};this.L8c=null;const n=new Dd.GraphIterator;n.set(this.jHa.Zg());this.Tn.xId(n);if(this.Tn.GPi(n)){let z=n.Rc();for(;z;){if(this.Tn.k9b(this.jHa,a)==z)return this.L8c=z,d=Object.assign(new cn.a,{PK:this.key,
contentObject:z,description:this.wFb()}),{returnValue:!0,wL:d};z=n.yg()}}}return{returnValue:!1,wL:d}}wFb(){return null}}Object(t.a)(DA,"BookmarkDetailsProvider",null,[287,288]);var Cs=b(419);class Sy{constructor(a,d,n,z,O=null){this.EAh=this.wh=!1;this.mae=this.mvc=null;this.vA=n;this.te=z;this.Xy=d;this.pph=a;this.fy=O}get DH(){return this.Xy.value}initialize(){this.eTg();this.wh=!0}Ose(a=!1){if(!this.wh)return k.ULS.sendTraceTag(24262273,324,10,"BookmarkGraphManager not initialized"),!1;if(!a&&
this.EAh)return!0;let d=!1;this.te.Fd(()=>{this.mvc={};this.mae={};if(this.DH){const n=new Dd.GraphIterator;n.set(this.DH);if(this.dym(n)){if(n.Va(1)){do this.Gvk(n.currentNode);while(n.Kd(1))}d=this.EAh=!0}}},"BGM:EBGL");return d}Gti(a){var d,n,z,O;if(!this.Ose())return null;const ca=new db.a;if(a.toString()in this.mvc){const Da=this.mvc[a.toString()];for(let Xa of Da)(Cs.a.isEnabled?this.fy.efa.has(null===(d=Xa.id)||void 0===d?void 0:d.toString())&&this.fy.efa.get(null===(n=Xa.id)||void 0===n?void 0:
n.toString()).equals(a)&&this.fy.FGa.has(null===(z=Xa.id)||void 0===z?void 0:z.toString())&&this.fy.FGa.get(null===(O=Xa.id)||void 0===O?void 0:O.toString()).equals(a):Xa.hasProperty(Qb.a.fG)&&Xa.properties.getValue(Qb.a.fG).equals(a)&&Xa.hasProperty(Qb.a.QU)&&Xa.properties.getValue(Qb.a.QU).equals(a))?ca.add(Xa):k.ULS.sendTraceTag(24155015,324,100,"GetBookmarksInParagraph: bookmarkNode does not have same paragraph for start and end value (shouldn't happen for TOC)")}return ca}zra(a){return this.Ose()?
a in this.mae?this.mae[a]:null:null}dispose(){this.wh?this.DJn():k.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}dym(a){if(this.vA.pQ(a))return(a=a.Va(30))||k.ULS.sendTraceTag(24691921,324,10,"Graph does not contain BookmarkContainer"),a;k.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}eTg(){k.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");this.pph.RCf(Object(m.a)(this,this.I8i,"onBookmarkContainerNodeLoaded"))}DJn(){k.ULS.sendTraceTag(24691924,
324,50,"Unregistering OnBookmarkContainerNodeLoaded");this.pph.$Ug(Object(m.a)(this,this.I8i,"onBookmarkContainerNodeLoaded"))}I8i(a,d){a=d.node;1074135152!==a.Jb?k.ULS.sendTraceTag(24155018,324,10,"node.RuntimeClassId = {0}",a.Jb):(k.ULS.sendTraceTag(24155019,324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.Ose(!0))}Gvk(a){var d,n,z,O;a?(this.KUh(Cs.a.isEnabled?null!==(n=this.fy.efa.get(null===(d=a.id)||void 0===d?void 0:d.toString()))&&void 0!==n?n:E.a.nil:a.properties.fa(Qb.a.fG,
E.a.nil),a),this.KUh(Cs.a.isEnabled?null!==(O=this.fy.FGa.get(null===(z=a.id)||void 0===z?void 0:z.toString()))&&void 0!==O?O:E.a.nil:a.properties.fa(Qb.a.QU,E.a.nil),a),(d=a.properties.fa(Qb.a.Ut,null))&&(this.mae[d]=a)):k.ULS.sendTraceTag(24155022,324,50,"Node is null")}KUh(a,d){a===E.a.nil?k.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(a=a.toString(),a in this.mvc||(this.mvc[a]=new db.a),a=this.mvc[a],a.contains(d)||a.add(d))}}Object(t.a)(Sy,"BookmarkGraphManager",null,[263]);class Iq{constructor(a,
d){this.vqa=a;this.W3j=d}get Jic(){return this.W3j}}Object(t.a)(Iq,"FoundBookmarkRangeObject",null,[298]);class pu{constructor(a,d=null){this.W$a=a;this.Noe={};this.sCc={};this.fy=d}JWa(a,d){if(a=this.W$a.Gti(d.node.id)){k.ULS.sendTraceTag(24462027,3029,50,String.format("Removing {0} bookmarks from paraId {1}",a.count,d.node.id));for(let n of a)n.id.toString()in this.Noe&&(d=this.Noe[n.id.toString()],d.id.toString()in this.sCc?a=this.sCc[d.id.toString()]:(a=new db.a,this.sCc[d.id.toString()]=a),a.add(n),
delete this.Noe[n.id.toString()])}else k.ULS.sendTraceTag(24691925,3029,50,"Failed to get bookmarks on paragraph deletion")}uIg(a,d){if(a=this.W$a.Gti(d.original.id))for(let n of a)this.Noe[n.id.toString()]=d.clone;else k.ULS.sendTraceTag(24691926,3029,50,"Failed to get bookmarks on paragraph copy")}wIg(a,d){var n,z;if(d.original.id.toString()in this.sCc){a=this.sCc[d.original.id.toString()];if(Cs.a.isEnabled)for(let O of a)this.fy.efa.set(null===(n=O.id)||void 0===n?void 0:n.toString(),d.clone.id),
this.fy.FGa.set(null===(z=O.id)||void 0===z?void 0:z.toString(),d.clone.id);else for(let O of a)O.lf(Qb.a.fG,d.clone.id),O.lf(Qb.a.QU,d.clone.id);delete this.sCc[d.original.id.toString()];k.ULS.sendTraceTag(24691927,3029,50,"OnParagraphPaste: Refreshing out of date bookmarks");this.W$a.Ose(!0)}}M$i(){k.ULS.sendTraceTag(36820239,3029,10,"New Interface Not Implemented!")}Nhe(){k.ULS.sendTraceTag(36471763,3029,10,"New Interface Not Implemented!");return!1}eyc(){k.ULS.sendTraceTag(591730835,3029,10,"New Interface Not Implemented!");
return!1}$Me(){k.ULS.sendTraceTag(36209185,3029,10,"New Interface Not Implemented!")}zra(){k.ULS.sendTraceTag(34936480,3029,10,"New interface not implemented");return null}qlb(){k.ULS.sendTraceTag(34936481,3029,10,"New interface not implemented");return null}Aza(){k.ULS.sendTraceTag(35992273,3029,10,"New Interface Not Implemented!");return new Iq(null,2)}vIg(){k.ULS.sendTraceTag(35992274,3029,10,"New interface not implemented")}rQc(){k.ULS.sendTraceTag(573673489,3029,10,"New interface not implemented")}$Ec(){k.ULS.sendTraceTag(559228954,
3029,10,"getAllBookmarks not implemented");return null}ENj(){k.ULS.sendTraceTag(559228955,3029,10,"updateBookmark not implemented")}VTg(){k.ULS.sendTraceTag(559228956,3029,10,"removeBookmark not implemented");return!1}mag(){k.ULS.sendTraceTag(553951760,3029,10,"getParaNodesFromBookmarkName not implemented");return null}Fti(){k.ULS.sendTraceTag(544814809,3029,10,"getBookmarkNameForHeading not implemented");return null}fHi(){k.ULS.sendTraceTag(544777299,3029,10,"goToBookmark not implemented")}k9b(){k.ULS.sendTraceTag(545118154,
3029,10,"getEnclosingBookmark not implemented");return null}xId(){k.ULS.sendTraceTag(540382879,3029,10,"moveToBookmarkContainer not implemented");return null}GPi(){k.ULS.sendTraceTag(540382880,3029,10,"isBookmarkContainer not implemented");return null}}Object(t.a)(pu,"BookmarkManager",null,[259]);var rB=b(728),sB=b(989);class EA{create(){return new sB.a}}Object(t.a)(EA,"BookmarkContainerNodeFactory",null,[244]);class FA{constructor(a,d,n,z=null){this.Rk=d;this.Tn=n;this.M3j=z||new EA}init(){rB.a.qlj(Object(m.a)(this.Tn,
this.Tn.$Me,"onAfterFullBookmarkRangeDeleted"));this.Rk.TCf(Object(m.a)(this,this.M$i,"onParagraphDeleteForTables"));$f.SCf(Object(m.a)(this,this.uIg,"onParagraphCopy"));$f.Gie(Object(m.a)(this,this.wIg,"onParagraphPaste"))}M$i(a,d){this.Tn.vIg(d)}uIg(a,d){var n=this.Wni(d.clone);a=d.original.Ib;const z=new yb.a;for(let O of n)n=O.pn.toString(),z.Na(n)||(z.add(n,!0),(n=a.Ta(O.pn))&&!n.anchor&&(n=this.Tn.qlb(O.pn)),n?n.anchor?this.aZk(n,d.clone):k.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",
n.id,n.fa(Qb.a.vCb,-1))):k.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))}wIg(a,d){a=d.clone;d=this.Wni(a);this.Tn.rQc(a,d)}Wni(a){const d=new db.a;for(let n=0;n<a.ja.length;n++){const z=a.ja.J(n);if(z.qg)for(let O=0;O<z.qg.length;O++)d.add(z.qg.J(O))}return d}aZk(a,d){var n=d.Zg().kd;n=Bq.a(a,n,!0);d=Dd.GraphIterator.ua(d);this.kfl(d);d.Va(30);d.E6(n,1,a.id);d.rg(n)}kfl(a){if(a.La(25)&&a.tc(25)&&!a.Bo(30)){const d=this.M3j.create(1074135152);a.Re(d,30)}}}Object(t.a)(FA,"BookmarksEventHandler",
null,[]);var Qs=b(274),GA=b(399),tB=b(814),Dw=b(136),AC=b(929);class Ew{create(){return new AC.a}}Object(t.a)(Ew,"BookmarkNodeFactory",null,[244]);class uB{constructor(a,d,n,z,O,ca,Da,Xa=null,zb,Vb=null){this.Pva="_";this.tph=40;this.sok=" ";this.Xy=a;this.vA=d;this.hc=n;this.bmf=z;this.Nb=O;this.Ha=ca;this.Da=Da;this.V3j=Xa||new Ew;this.fy=Vb}tGc(a,d){return a?this.fy.efa.get(null===d||void 0===d?void 0:d.toString()):this.fy.FGa.get(null===d||void 0===d?void 0:d.toString())}get DH(){return this.Xy.value}get gwb(){return this.bmf.value}Nhe(a,
d){if(!d||!d.ra||!d.Fb)return k.ULS.sendTraceTag(36471765,3029,15,"There is no selection"),!1;const n=d.ra.node,z=d.Fb.node,O=Qs.a.a9b(d,!0);d=Qs.a.a9b(d,!1);return this.eyc(a,O,d,n,z)}eyc(a,d,n,z,O,ca=!1){k.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",ca));const Da=this.zra(a);if(Da)if(ca)this.Dmj(Da);else return k.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),!1;if(!z||!O)return k.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),
!1;ca=this.Nb.Wb(15);ca.Sa(this.gwb);a=this.Htk(a);if(!a)return!1;this.MTh(z,d,a,O,n);ca.dispose();return!0}zra(a){k.ULS.shipAssertTag(34936482,3029,!!a);return this.$ni(d=>a===d.properties.fa(Qb.a.Ut,null))}qlb(a){return a&&a!==E.a.nil?this.$ni(d=>a.equals(d.id)):(k.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}$Me(a){const d=this.qlb(a);d?(k.ULS.sendTraceTag(36844636,3029,50,String.format("Removing bookmark {0}",a.toString())),this.WTg(d),this.iQd(d)):
k.ULS.sendTraceTag(36569436,3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}Aza(a,d){var n;const z=Cs.a.isEnabled?null!==(n=this.tGc(d,a.id))&&void 0!==n?n:E.a.nil:a.fa(d?Qb.a.fG:Qb.a.QU,E.a.nil);if(z===E.a.nil)return k.ULS.sendTraceTag(36218377,3029,10,"ParaId not on Bookmark"),new Iq(null,2);n=this.DH.kd.Ta(z);return n?n.isConnected?this.getBookmarkRange(n,a,d):(k.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new Iq(null,3)):(k.ULS.sendTraceTag(36766420,3029,
10,"Unable to get paragraph from object space"),new Iq(null,2))}vIg(a){const d=this.tll(a);d[Symbol.iterator]().next().done||this.aym(a,d)}rQc(a,d){const n=new db.a;let z=0,O=!1;for(let ca of d)ca&&ca.Wa.qg?(z++,ca.Wa.qg.remove(ca),0<=ca.Qc&&ca.Qc<a.wordRunProperties.length&&(ca.Wa.cp||(O=!0),n.add(ca.Qc))):k.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");a.VY(!0,n);k.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",z,n.count));
O&&!a.wordRunProperties.length&&a.wordRunProperties.append(as.CharacterPropertiesEditor.KI,1024)}$Ec(a=!1){k.ULS.sendTraceTag(559228943,3029,50,"Fetching bookmarks with includeHidden: {0}",a);const d=new db.a,n=Dd.GraphIterator.ua(this.DH);if(null!==this.xId(n)){var z=n.Sr();k.ULS.sendTraceTag(559228944,3029,50,"Bookmarks count: {0}",z);if(0<z)for(z=n.Rc();null!==z;){let O=z.fa(Qb.a.Ut,"");w.a.le(O)||(a?d.add(z):O.startsWith(this.Pva)||d.add(z));z=n.yg()}}!a&&0<d.count&&k.ULS.sendTraceTag(556889755,
3029,50,"User Bookmarks count: {0}",d.count);return d}mag(a){var d=this.zra(a);let n=new db.a;if(d){a=Cs.a.isEnabled?this.tGc(!0,d.id):d.properties.getValue(Qb.a.fG);d=Cs.a.isEnabled?this.tGc(!1,d.id):d.properties.getValue(Qb.a.QU);var z=this.DH.kd.Ta(a);z&&n.add(z);if(a.equals(d))return n;a=z;do(a=z=this.Ha.qh(a,!1,!1,!0))&&n.add(z);while(z&&!z.id.equals(d))}else k.ULS.sendTraceTag(553927448,3029,10,"bookmark not exist with the {0}",a);return n}ENj(a,d,n,z){if(null===a)k.ULS.sendTraceTag(559228945,
3029,10,"bookmark id is null");else if(null===d)k.ULS.sendTraceTag(559228946,3029,10,"bookmark information is null");else{var O=this.qlb(a);if(null===O)k.ULS.sendTraceTag(559228947,3029,10,"bookmark node with id {0} does not exist",a);else{var ca=this.Nb.Wb(15);ca.Sa(this.gwb);if(d.hasProperty(Qb.a.Ut)){var Da=d.getValue(Qb.a.Ut);if(w.a.le(Da)){k.ULS.sendTraceTag(559228948,3029,50,"bookmark name is null or empty");return}if(null!==this.zra(Da)){k.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists.");
return}this.NKn(O,Da)}(Cs.a.isEnabled?this.fy.efa.has(null===a||void 0===a?void 0:a.toString())&&this.fy.FGa.has(null===a||void 0===a?void 0:a.toString()):d.hasProperty(Qb.a.fG)&&d.hasProperty(Qb.a.QU))?(Da=Cs.a.isEnabled?this.tGc(!0,a):d.getValue(Qb.a.fG),a=Cs.a.isEnabled?this.tGc(!1,a):d.getValue(Qb.a.QU),d=this.DH.kd.Ta(Da),a=this.DH.kd.Ta(a),this.OKn(O,d,a,n,z)):(Cs.a.isEnabled?this.fy.efa.has(null===a||void 0===a?void 0:a.toString())&&this.fy.FGa.has(null===a||void 0===a?void 0:a.toString()):
d.hasProperty(Qb.a.fG)&&d.hasProperty(Qb.a.QU))||k.ULS.sendTraceTag(559228950,3029,50,"Not updating bookmark anchor as start or end para info is missing");ca.dispose()}}}VTg(a){if(null===a)return k.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;a=this.qlb(a);return this.Dmj(a)}Fti(a){let d="",n=a.id;a=a.characterData.split(this.sok);for(let z=0;3>z&&z<a.length;z++)d+=this.Pva+a[z];d.length>this.tph&&(d=d.substring(0,this.tph));return this.UWj(d,n)}UWj(a,d){const n=this.$Ec(!0);
let z=[],O;for(let Da=0;Da<n.count;Da++){var ca=n.J(Da);O=ca.fa(Qb.a.Ut,"");ca=Cs.a.isEnabled?this.tGc(!0,ca.id):ca.getValue(Qb.a.fG);O.startsWith(a)&&!d.equals(ca)&&z.push(O)}return 0<z.length?(z.sort((Da,Xa)=>Da.localeCompare(Xa,void 0,{numeric:!0})),(d=z[z.length-1].substring(a.length+1))?a+this.Pva+(parseInt(d)+1):a+this.Pva+1):a}fHi(a){w.a.le(a)?k.ULS.sendTraceTag(544777296,3029,10,"Cannot navigate to bookmark as name is null"):(a=this.zra(a),null===a?k.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):
(a=this.Aza(a,!0))?(a=ye.SelectionFactory.Pc(a.vqa.paragraph,a.vqa.Wa.cp))&&this.Da.setSelection(a):k.ULS.sendTraceTag(544777298,3029,10,"No start found for bookmark. Document is corrupted"))}Dmj(a){if(!a)return k.ULS.sendTraceTag(559228888,3029,15,"Could not find bookmark node with given id"),!1;k.ULS.sendTraceTag(559228889,3029,50,String.format("Removing bookmark {0}",a.id));const d=this.Nb.Wb(15);d.Sa(this.gwb);this.WTg(a);this.iQd(a);d.dispose();return!0}k9b(a,d){if(!a||0>d)return k.ULS.sendTraceTag(545118153,
3029,10,String.format("Got null paragraph or negative cp value")),null;let n=null,z=new db.a,O=new db.a;var ca=a.ja;for(var Da=0;Da<ca.length;Da++){var Xa=ca.J(Da);if(Xa.cp>d||Xa.cp===d&&0<z.count)break;if(Xa.qg){var zb=Xa.qg;if(2===zb.length&&zb.J(0).pn.equals(zb.J(1).pn)&&Xa.cp===d){z.add(zb.J(0).pn.toString());break}for(let Vb=0,Fc=zb.length;Vb<Fc;Vb++){Xa=zb.J(Vb);const Yc=a.Ib.Ta(Xa.pn).fa(Qb.a.Ut,"");w.a.le(Yc)||Yc.startsWith(this.Pva)||(Xa.Db?z.add(Xa.pn.toString()):z.contains(Xa.pn.toString())?
z.remove(Xa.pn.toString()):O.add(Xa.pn.toString()))}}}0<z.count&&(n=a.Ib.Ta(E.a.qe(z.J(z.count-1))));if(!n)for(d=Bd.ParagraphReader.qh(a,!0);d&&!n;){for(ca=0;ca<d.ja.length;ca++)if(Da=d.ja.J(ca),Da.qg){Da=Da.qg;for(let Vb=0,Fc=Da.length;Vb<Fc;Vb++)zb=Da.J(Vb),Xa=a.Ib.Ta(zb.pn).fa(Qb.a.Ut,""),w.a.le(Xa)||Xa.startsWith(this.Pva)||(zb.Db?O.contains(zb.pn.toString())?O.remove(zb.pn.toString()):z.add(zb.pn.toString()):z.contains(zb.pn.toString())?z.remove(zb.pn.toString()):O.add(zb.pn.toString()))}0<z.count?
n=d.Ib.Ta(E.a.qe(z.J(z.count-1))):d=Bd.ParagraphReader.qh(d,!0)}return n}$ni(a){if(!this.DH)return k.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const d=new Dd.GraphIterator;d.set(this.DH);if(!this.xId(d))return k.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),null;if(!d.Va(1))return null;do{const n=d.currentNode;if(a(n))return n}while(d.Kd(1));return null}getBookmarkRange(a,d,n){for(let z=0;z<a.ja.length;z++){const O=a.ja.J(z);if(O.qg)for(let ca=0;ca<O.qg.length;ca++){const Da=
O.qg.J(ca);if(Da.pn.equals(d.id)&&n===Da.Db)return new Iq(Da,0)}}k.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",a.id,d.fa(Qb.a.vCb,-1),n,d.id,a.ja.length,this.L9b(a));return new Iq(null,1)}xId(a){if(this.vA.pQ(a))return a=a.Va(30),k.ULS.shipAssertTag(34936513,3029,!!a,"Graph does not contain BookmarkContainer"),a;k.ULS.sendTraceTag(34936514,3029,15,"Unable to move to Page Manifest");return null}tll(a){const d=new yb.a;
for(let n=0;n<a.ja.length;n++){const z=a.ja.J(n);if(z.qg)for(let O=0;O<z.qg.length;O++){const ca=z.qg.J(O),Da=ca.pn.toString();d.Na(Da)?(k.ULS.shipAssertTag(36218379,3029,ca.Db!==d.J(Da).Db),d.remove(Da)):d.add(Da,ca)}}return d.values}aym(a,d){this.rQc(a,d);this.Qxm(a,d)}Qxm(a,d){let n=Bd.ParagraphReader.qh(a,!1,!0);a=Bd.ParagraphReader.qh(a,!0,!0);n||a?(n||this.g1h(d,!0)&&k.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),a||
this.g1h(d,!1)&&k.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),n=n||a,a=a||n,this.d5i(n,d,0,!0),this.d5i(a,d,a.ja.last.cp,!1)):k.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}g1h(a,d){for(let n of a)if(d===n.Db)return!0;return!1}d5i(a,d,n,z){const O=new db.a;n=this.rtd(a,n);for(let ca of d)ca.Db===z&&(n?(d=this.Itk(a,z,n,ca.pn))&&O.add(d):k.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",z));O.count&&
(a.$j(),this.DVc(a,O),k.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",O.count,z)))}Itk(a,d,n,z){const O=this.qlb(z);return O?this.Bfd(a,d,n,O):(k.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",z)),null)}Bfd(a,d,n,z){var O;if(!z)return k.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!n)return k.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),
null;n.qg||(n.qg=new GA.a(n));const ca=new tB.a(n,null,z.id,d);n.qg.add(ca);Cs.a.isEnabled?(d?this.fy.efa:this.fy.FGa).set(null===(O=z.id)||void 0===O?void 0:O.toString(),a.id):z.setValue(d?Qb.a.fG:Qb.a.QU,a.id);return ca}DVc(a,d){if(d){k.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",d.count);d.Sc((n,z)=>n.Qc-z.Qc);for(let n=0;n<d.count;n++){const z=d.J(n);z.Qc?a.wordRunProperties.aQ(z.Qc-1,1024):a.wordRunProperties.uma(z.Qc,1024);a.wordRunProperties.Qo.$(z.Qc,as.CharacterPropertiesEditor.KI);
a.wordRunProperties.ir.$(z.Qc,as.CharacterPropertiesEditor.EK)}}else k.ULS.shipAssertTag(36218383,3029,!1,"Null BookmarksToUpdate.")}rtd(a,d){k.ULS.shipAssertTag(36471766,3029,d<=a.ja.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(a.ja.last.cp===d){var n=a.ja.length-1;if(!a.ja.J(n).formatting)for(var z=n-1;0<=z;z--){var O=a.ja.J(z);if(O.formatting){this.hc.zQ(a,n,d,O.formatting);break}}return a.ja.last}n=null;for(z=0;z<a.ja.length;z++){O=a.ja.J(z);if(O.cp>=d){if(O.cp>d||!O.formatting)this.hc.zQ(a,
z,d,n),O=a.ja.J(z);O.qg||(O.qg=new GA.a(O));k.ULS.shipAssertTag(36471768,3029,O!==a.ja.last);return O}O.formatting&&(n=O.formatting)}return null}Htk(a){const d=new Dd.GraphIterator;d.set(this.DH);if(!this.xId(d))return k.ULS.sendTraceTag(36471769,3029,10,"Unable to move to BookmarkContainer"),null;a=this.t_k(a);d.E6(a,1,null);d.rg(a);return a}t_k(a){const d=this.V3j.create(1074135153);d.setValue(Qb.a.Ut,a);d.setValue(Qb.a.vCb,gf.a.HH());return d}iQd(a){if(a&&a.anchor){k.ULS.sendTraceTag(36729311,
3029,100,"Removed bookmark with id:{0}, ({1})",a.fa(Qb.a.vCb,-1),a.id);var d=new Dd.GraphIterator;d.set(a);d.La(64);d.wg()}}L9b(a){const d=[];let n=0;for(;a.anchor.Zk&&7!==a.type;)d[n]=Dw.a[a.type],a=a.anchor.Zk.Dj.node,n++;d[n]=Dw.a[a.type];return d.join(" ")}NKn(a,d){a.setValue(Qb.a.Ut,d)}OKn(a,d,n,z,O){this.WTg(a);this.MTh(d,z,a,n,O)}WTg(a){const d=this.Aza(a,!0).vqa;a=this.Aza(a,!1).vqa;if(d&&a&&d.paragraph===a.paragraph){let n;this.rQc(d.paragraph,(n=new db.a,n.add(d),n.add(a),n))}else{if(d){let n;
this.rQc(d.paragraph,(n=new db.a,n.add(d),n))}if(a){let n;this.rQc(a.paragraph,(n=new db.a,n.add(a),n))}}}MTh(a,d,n,z,O){l.AFrameworkApplication.Yi("4iaia520;85458494");if(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkCrashFixEnabled",!1)){var ca=this.Bfd(a,!0,this.rtd(a,d),n);a.$j();var Da;this.DVc(a,(Da=new db.a,Da.add(ca),Da));n=this.Bfd(z,!1,this.rtd(z,O),n);z.$j();this.DVc(a,(Da=new db.a,Da.add(n),Da))}else if(Da=this.Bfd(a,!0,this.rtd(a,d),n),n=this.Bfd(z,
!1,this.rtd(z,O),n),a.$j(),a.equals(z))this.DVc(a,(ca=new db.a,ca.add(Da),ca.add(n),ca));else{let Xa;this.DVc(a,(Xa=new db.a,Xa.add(Da),Xa));z.$j();let zb;this.DVc(z,(zb=new db.a,zb.add(n),zb))}}GPi(a){return!!a&&64===a.Yc}}Object(t.a)(uB,"FullBookmarkManager",null,[259]);class Kz{constructor(){this.W$a=this.Nm=this.Z=null}get name(){return"WordEditor.Bookmark"}Hb(a){this.Z=a;this.Nm=this.Z.resolve("Box4.INotebookManager").Cm;const d=new uB(new Nf.a(()=>Lb.App.oa.za.jc),jm.PageNavigator.instance,
this.Z.resolve("Box4.ICharacterPropertiesEditor"),new Nf.a(()=>Lb.App.oa.za.Rb.xc),jn.a.instance,this.Z.resolve("Box4.IParagraphReader"),this.Z.resolve("Box4.SelectionManager"),null,null,this.Z.resolve("Box4.BookmarkParagraphMapping"));this.Z.ha("WordEditor.Bookmark.FullBookmarkManager",()=>d).as("WordEditor.Bookmark.IBookmarkManager").singleInstance();this.Z.ha("WordEditor.Bookmark.BookmarksEventHandler",()=>new FA(this.Nm.Oe(12),this.Z.resolve("WordEditor.ITableEditor"),this.Z.resolve("WordEditor.Bookmark.IBookmarkManager"))).singleInstance();
Rj.App.W4e&&(this.W$a=new Sy(this.Nm.Oe(64),new Nf.a(()=>Lb.App.oa.za.jc),jm.PageNavigator.instance,Ln.a.instance,this.Z.resolve("Box4.BookmarkParagraphMapping")),this.Z.ha("WordEditor.Bookmark.BookmarkGraphManager",()=>this.W$a).as("WordEditor.Bookmark.IBookmarkGraphManager").singleInstance())}init(){this.Z.resolve("Box4.IFeatureHelper").tk.continueWith(()=>{this.Po()})}dispose(){this.W$a.dispose()}Po(){k.ULS.sendTraceTag(36209186,324,50,"Registering paragraph events");if(Rj.App.R4e)this.Z.resolve("WordEditor.Bookmark.BookmarksEventHandler").init();
else if(Rj.App.W4e){this.W$a.initialize();const a=new pu(this.W$a,this.Z.resolve("Box4.BookmarkParagraphMapping"));this.Nm.Oe(12).vy(Object(m.a)(a,a.JWa,"onParagraphDelete"));$f.SCf(Object(m.a)(a,a.uIg,"onParagraphCopy"));$f.Gie(Object(m.a)(a,a.wIg,"onParagraphPaste"))}k.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");this.a2m(this.Z.Ca("Box4.Accessibility.IAccessibilityContextManager"),this.Z.resolve("WordEditor.Bookmark.FullBookmarkManager"))}a2m(a,d){a&&a.execute(n=>{n.Pca(new DA(d))})}static main(){M.a.instance.Sb(new Kz)}}
Object(t.a)(Kz,"BookmarkPackage",null,[1,2]);var Rv=b(646),Ty=b(924),Lz=b(1356),Rs=b(1220);class vB extends Rs.a{constructor(a){super();this.$qk=a}get index(){return 3}run(){this.$qk()}sM(){this.l8()}}Object(t.a)(vB,"FootnoteEndnoteGraphUpdateTracker",Rs.a,[]);class Ax{constructor(){this.t7d=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}Hb(){}init(){Ax.Ka.tk.continueWith(()=>{this.Po()})}Po(){Rv.a.cFb=Lz.a.instance;this.Dhg()}dispose(){}Dhg(){this.t7d=new vB(()=>{Lz.a.instance.qt()});
Ty.a.XTe(Object(m.a)(this.t7d,this.t7d.sM,"setUpdateNeeded"));yq.GraphTransactionManager.instance.UCa(this.t7d,3)}static get Ka(){return la.a.instance.resolve("Box4.IFeatureHelper")}}Object(t.a)(Ax,"PackageManager",null,[1,2]);var Zn=b(700),es=b(504),Mz=b(461),Uy=b(1461);class ly extends Ms{constructor(){super()}get jz(){return null}getTitle(a){a=a.M4a();if(!a||!es.a.instance.OAa(a))return"";const d=new Sys.StringBuilder,n=es.a.instance.Xfa(a);d.append(1===n?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:
WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);d.append(" ");d.append(es.a.instance.pud(a));return d.toString()}}Object(t.a)(ly,"FootnoteEndnoteBaseDetailsProvider",Ms,[]);class mh extends ly{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get Qf(){return 7}}Object(t.a)(mh,"FootnoteEndnoteDetailsProvider",ly,[]);var Bx=b(1407),qg=b(1436),wB=b(1520);class HA extends ly{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get Qf(){return 10}}Object(t.a)(HA,"FootnoteEndnoteRefMarkDetailsProvider",
ly,[]);class Fw{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le,Ve,gg,Lh){this.ga=a;this.xs=d;this.R4d=n;this.ic=z;this.xJ=O;this.H9j=ca;this.f0a=Da;this.cFa=Xa;this.xG=zb;this.Ck=Vb;this.Psc=Fc;this.Nb=Yc;this.vn=yd;this.fb=je;this.Q2=Le;this.Eb=Ve;this.D1j=gg;this.Mrh=Lh;this.Uwh=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.footnoteApiIsEnabled",!1)}CNi(a,d,n,z,O){z=d.view;if(!z.features.pXd||this.xG.qQi)return 8;const ca=z.Oa.Ag;if(!ca)return 2;if(this.vn.E3(ca))return 8;
z=a===Dc.a.insertFootnote?1:0;var Da=this.gwe(d);if(!Da)return k.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;d=!0;let Xa=Da.ra;Da=null;this.Uwh&&(Da=O)&&Da.TKc&&Da.ZUa&&(Xa=Da.ZUa,l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DismissFootnoteEndnoteIsEnabled",!1)&&(d=!Da.keepCurrentFocus));if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableRibbonItemsOnIframeSelection",!1)&&Fw.jg.h9(Bd.ParagraphReader.wS,
ca)&&1===n)return 32;if(!Xa||!Qd.SelectionEditor.Cd(Xa)||this.Mrh.instance&&this.Mrh.instance.Qbm(Xa)||hg.HyperlinkReader.s4(Xa,!0))return 8;if(1===n)return 32;2===n&&(n=this.Q2.Pe("UserAction","InsertFootnoteEndnote"),a=this.H9j.F5l(Xa,z,a),this.Uwh&&Da&&Da.TKc&&(Da.T6i=a),d&&this.uPe(a,!0,!0),n.stop(),this.Eb.Ws(6));return 32}$Mc(a,d,n){const z=d.view;if(a===Dc.a.UNb||a===Dc.a.nmc){if(!z.features.pXd)return 8}else if(!z.features.o0e)return 8;if(!z.Oa.Ag)return 2;d=this.LGc(d);return d?a!==Dc.a.UNb&&
a!==Dc.a.nmc||this.f0a.KYl(d.node,a===Dc.a.UNb?1:0)?1===n?32:2===n&&32===this.ga.ob(Dc.a.fra,2,!0)?(this.ga.ob(Dc.a.N5i,2,a),32):8:8:2}eol(a,d,n,z,O){if(1===n)return 32;if(2===n){a=this.ZNl(d);if(!a)return 8;n=d=null;switch(O){case Dc.a.zDg:n=a.Fb;d=this.Psc.JAe(n,1);break;case Dc.a.yDg:n=a.Fb;d=this.Psc.JAe(n,0);break;case Dc.a.BDg:n=a.ra;d=this.Psc.nHi(n,1);break;case Dc.a.ADg:n=a.ra;d=this.Psc.nHi(n,0);break;case Dc.a.UNb:n=a.ra;(d=this.Psc.JAe(n,1,!0))||(d=this.f0a.nxi(n.node,1));break;case Dc.a.nmc:n=
a.ra,(d=this.Psc.JAe(n,0,!0))||(d=this.f0a.nxi(n.node,0))}if(d)this.uPe(d);else{if(!this.xs.Rb)return 8;(O=Lj.d(n.node,n.cpBegin))&&7===O.Qf&&this.f0a.xuj(O)}}return 32}Uun(a,d,n,z,O){return 1===n?32:2===n?(k.ULS.shipAssertTag(4520066,308,!!O),k.ULS.shipAssertTag(4520067,308,!!O.Jib),a=O.Jib,k.ULS.shipAssertTag(4520068,308,this.xJ.OAa(a)),this.uPe(a,O.RYe)?32:8):32}Vun(a,d,n,z,O){if(1===n)return 32;2===n&&(a=O.footnoteEndnoteNode,O=O.hol)&&(this.cFa.TDc(),d=this.xJ.EHb(a),O.title=this.xJ.SAl(a)+(d?
WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32}mKb(a,d,n,z,O){return 2===n?(k.ULS.shipAssertTag(4520069,308,!!O),k.ULS.shipAssertTag(4520070,308,!!O.Jib),k.ULS.shipAssertTag(4520071,308,Bd.ParagraphReader.nb(O.Jib)),a=this.xJ.MFc(O.Jib),this.uPe(a,O.RYe)?32:8):32}Akn(a,d,n){2===n&&this.xG.l5();return 32}Nal(a,d,n,z,O){if(1===n)return 32;if(2===n)return void 0!==O&&null!==O?this.xG.cXf(O,O):this.xG.cXf(),32;k.ULS.sendTraceTag(4520072,
308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8}Kjm(a,d,n){a=this.LGc(d);return a&&Qd.SelectionEditor.Cd(a)?1===n?32:2===n?(n=0<this.Ck.b4(a.node).pu,this.xG.jRf(),this.xG.dialog.vGb=n,32):8:(k.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)}col(a,d,n){return 1===n?32:2===n?(this.xG.dialog.vGb=!1,32):8}pXm(a,d,n,z,O){return this.vqi(a,n,O)}nXm(a,d,n,z,O){return 1===n?32:this.xG.dialog&&this.xG.dialog.fontName?(O[Yd.a.Value]=this.xG.dialog.fontName,32):
this.R4d.V3a(Mb.a.kLb.toString(),O,null)?32:8}bol(a,d,n){return 1===n?32:2===n?(this.xG.dialog.vGb=!0,32):8}oXm(a,d,n,z,O){return this.vqi(a,n,O)}$nl(a,d,n){if(1===n)return 32;if(2===n){a=this.LGc(d);if(!a)return k.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;d=this.xJ.MFc(a.node);this.xJ.OAa(d)&&(n=this.Nb.Wb(15),n.Sa(d),this.EOj(a),this.f0a.UYh(d,this.xG.dialog),n.dispose());this.xG.xRd();return 32}return 8}Znl(a,d,n){if(1===n)return 32;if(2===n){a=this.LGc(d);if(!a)return k.ULS.sendTraceTag(51512525,
308,10,"Selected graph node context is null"),8;d=this.xJ.MFc(a.node);this.xJ.OAa(d)&&(n=this.Nb.Wb(15),n.Sa(d),this.EOj(a),this.f0a.tDk(d,this.xG.dialog),n.dispose());this.xG.xRd();return 32}return 8}aol(a,d,n){return 1===n?32:2===n?(this.xG.xRd(),32):8}Xnl(a,d,n,z,O){if(1===n)return 32;if(2===n){a=Object(qa.a)(28,O);if(!a||!a.$c)return 8;this.xG.dialog.fontName=a.$c.fontName;return 32}return 8}Ynl(a,d,n,z,O){if(1===n)return 32;if(2===n){a=Object(qa.a)(28,O);if(!a||!a.$c)return 8;this.xG.dialog.ccb=
a.$c;return 32}return 8}EOj(a){(a=La.FormattingReader.yr(a))?(this.xG.dialog.fontName||(this.xG.dialog.fontName=a.cache.bD),-1===this.xG.dialog.fontSize&&(this.xG.dialog.ccb=a.cache.fontSize)):k.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}vqi(a,d,n){return 1===d&&this.xG.dialog?32:2===d&&this.xG.dialog?(n[Dg.a.On]=a===Dc.a.aQg?this.xG.dialog.vGb:!this.xG.dialog.vGb,32):8}lb(){this.ga.Aa(Dc.a.insertFootnote,Kb.a.view,Object(m.a)(this,this.CNi,"insertFootnoteEndnoteViewHandler"),
4);this.ga.Aa(Dc.a.insertEndnote,Kb.a.view,Object(m.a)(this,this.CNi,"insertFootnoteEndnoteViewHandler"),4);this.ga.ma(Dc.a.zDg,Kb.a.view,Object(m.a)(this,this.$Mc,"nextPreviousFootnoteEndnoteHandler"));this.ga.ma(Dc.a.N5i,Kb.a.view,Object(m.a)(this,this.eol,"footnoteEndnoteNavigationHandler"));this.ga.ma(Dc.a.yDg,Kb.a.view,Object(m.a)(this,this.$Mc,"nextPreviousFootnoteEndnoteHandler"));this.ga.ma(Dc.a.BDg,Kb.a.view,Object(m.a)(this,this.$Mc,"nextPreviousFootnoteEndnoteHandler"));this.ga.ma(Dc.a.ADg,
Kb.a.view,Object(m.a)(this,this.$Mc,"nextPreviousFootnoteEndnoteHandler"));this.ga.ma(Dc.a.UNb,Kb.a.view,Object(m.a)(this,this.$Mc,"nextPreviousFootnoteEndnoteHandler"));this.ga.ma(Dc.a.nmc,Kb.a.view,Object(m.a)(this,this.$Mc,"nextPreviousFootnoteEndnoteHandler"));this.ga.ma(Dc.a.rCj,Kb.a.view,Object(m.a)(this,this.Uun,"showFootnoteEndnoteControlHandler"));this.ga.Aa(Dc.a.tqi,Kb.a.view,Object(m.a)(this,this.bol,"footnoteEndnoteFormatFirstIndentStyleHandler"),4);this.ga.Aa(Dc.a.aQg,Kb.a.view,Object(m.a)(this,
this.oXm,"queryFootnoteEndnoteFormatFirstIndentStyleHandler"),100);this.ga.Aa(Dc.a.uqi,Kb.a.view,Object(m.a)(this,this.col,"footnoteEndnoteFormatNoStyleHandler"),4);this.ga.Aa(Dc.a.qhj,Kb.a.view,Object(m.a)(this,this.pXm,"queryFootnoteEndnoteFormatNoStyleHandler"),100);this.ga.ma(Dc.a.sCj,Kb.a.view,Object(m.a)(this,this.Vun,"showFootnoteEndnoteTooltipHandler"));this.ga.Aa(Dc.a.mKb,Kb.a.view,Object(m.a)(this,this.mKb,"openFootnoteEndnoteControl"),96);this.ga.Aa(Dc.a.d3f,Kb.a.view,Object(m.a)(this,
this.Akn,"setFocusOnFootnoteEndnoteControl"),96);this.ga.ma(Dc.a.fra,Kb.a.view,Object(m.a)(this,this.Nal,"dismissFootnoteEndnoteControlHandler"));this.ga.Aa(Dc.a.bXi,Kb.a.view,Object(m.a)(this,this.Kjm,"launchFootnoteEndnoteFormattingOptionsDialogHandler"),4);this.ga.Aa(Dc.a.qqi,Kb.a.view,Object(m.a)(this,this.$nl,"footnoteEndnoteFormatApplyHandler"),4);this.ga.Aa(Dc.a.rqi,Kb.a.view,Object(m.a)(this,this.Znl,"footnoteEndnoteFormatApplyAllHandler"),4);this.ga.Aa(Dc.a.sqi,Kb.a.view,Object(m.a)(this,
this.aol,"footnoteEndnoteFormatCancelHandler"),4);this.ga.Aa(Dc.a.Zue,Kb.a.view,Object(m.a)(this,this.Xnl,"footnoteEndnoteFontNameHandler"),4);this.ga.Aa(Dc.a.phj,Kb.a.view,Object(m.a)(this,this.nXm,"queryFootnoteEndnoteFontNameHandler"),100);this.ga.Aa(Dc.a.$ue,Kb.a.view,Object(m.a)(this,this.Ynl,"footnoteEndnoteFontSizeHandler"),4);this.ga.Aa(Dc.a.CMd,Kb.a.view,Fw.CMd,100);this.ga.Aa(Dc.a.DMd,Kb.a.view,Fw.DMd,100)}WSg(){this.D1j.execute(a=>{a.Pca(new mh);a.Pca(new HA)})}LGc(a){a=this.gwe(a);return a?
a.ra:(k.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}gwe(a){let d=null;a=a.view;if(!a)return k.ULS.sendTraceTag(3486740,308,10,"We expected a view here."),d;a=a.Oa;if(!a)return k.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),d;a=a.ya;if(!a||!a.length)return k.ULS.sendTraceTag(51512528,308,10,"We expected that we have a selection collection here."),d;a=a.J(0);if(!a)return k.ULS.sendTraceTag(51512529,308,10,"We expected that we have a current selection here."),
d;(d=Qd.SelectionEditor.Xf(a,!1,!1))||k.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return d}ZNl(a){return(a=a.view)?a.Oa.ya.J(0):null}uPe(a,d=!0,n=!1){if(a){this.cFa.TDc();var z=a.uza;if(z){var O=z.Wa;const ca=ye.SelectionFactory.wX(O.paragraph,O.cp,O.cp+1);O=this.xs.Rb;if(!O)return!1;this.ic.Nha(O,ca);O.aoa=150;O.YY();a=new Mz.a(a,d);z=z.W4a(O);if(!z)return k.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),!1;n||z.element?this.xG.l5g(a):(this.xG.l5g(new Mz.a(a.Jib,
!1)),d&&(d=new bf.a(2,1,10,()=>{this.xG.l5()}),this.fb.rb(d)));return!0}}return!1}static JAl(){return new Fw(l.AFrameworkApplication.pa,Lb.App.oa.za,la.a.instance.resolve("Box4.IGeneralCuiUser"),Ic.InteractiveViewManager.instance,es.a.instance,qg.a.instance,Bx.a.instance,Lz.a.instance,Uy.FootnoteEndnoteControlManager.instance,la.a.instance.resolve("Box4.IParagraphIndentationReader"),wB.a.instance,new jn.a,aj.a.instance,th.a.instance,l.AFrameworkApplication.la.Np,la.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
la.a.instance.Ca("Box4.Accessibility.IAccessibilityContextManager"),la.a.instance.Ca("Box4.IContentControlReader"))}static IAl(){return Fw.JAl()}static CMd(a,d,n,z,O){if(1===n)return 32;if(2===n&&!O)return 8;nn.a.Zac(d);O.PopulationXML=Up.FontUtils.n4f(nn.a.dmc,nn.a.qsd,Dc.a.Zue,!1);return 32}static DMd(a,d,n,z,O){if(1===n)return 32;if(2===n&&!O)return 8;O.PopulationXML=Up.FontUtils.Cve(Dc.a.$ue);return 32}static get jg(){return bl.ContextSetEditor.instance}}Object(t.a)(Fw,"FootnoteEndnoteActor",
null,[331]);class xB extends Rs.a{constructor(a){super();this.wyf=a}get index(){return 1}run(){this.wyf()}sM(){this.l8()}}Object(t.a)(xB,"FootnoteEndnoteControlUpdateTracker",Rs.a,[]);var Vy=b(347);class yB extends Vy.a{constructor(a,d,n,z,O,ca){super(a,d);this.Bg=null;this.JM=a.container;this.iy=document.createElement("div");a.container.appendChild(this.iy);this.eG(this.iy);this.olk=n;this.wm.execute(Da=>{Da.pha(Object(m.a)(this,this.ju,"onZoomChanged"))});this.j0a=z;this.oL=O;this.j6=ca;this.j0a.execute(Da=>
{Da.b3g(this.qb,this.JM)});this.j6&&(this.JM.style.backgroundColor=this.oL.qGc())}dispose(){super.dispose();this.wm.instance&&this.wm.instance.XLb(Object(m.a)(this,this.ju,"onZoomChanged"))}get wm(){return this.Bg||(this.Bg=la.a.instance.Ca("Common.IZoomManager"))}iF(a){this.JM.classList.add("FootnoteEndnoteViewElement");this.t_d(a.currentNode)}ju(){this.t_d(this.Ia)}t_d(a){this.wm.instance&&(this.wm.instance.J1d(this.iy),this.iy.style.width=Math.round(100/this.wm.instance.Ei)+"%");this.olk(a)}}Object(t.a)(yB,
"FootnoteEndnoteViewElement",Vy.a,[]);class IA{constructor(){this._initialized=!1;this.D4d=this.xff=this.Z=null}get name(){return"WordEditor.FootnoteEndnote"}Hb(a){this.Z=a}init(){this.Z.resolve("Box4.IFeatureHelper").tk.continueWith(()=>{this.Po()})}Po(){Zt.WordSectionNavigator.instance.JId=Object(m.a)(Bx.a.instance,Bx.a.instance.Lym,"navigateToWordSectionNodeWithFootnoteEndnote");Zn.a.N2g(Object(m.a)(this,this.jol,"footnoteEndnoteViewElementFactory"));Uy.FootnoteEndnoteControlManager.instance.bind(Lb.App.oa.Ow);
this.xff=Fw.IAl();this.xff.lb();this.xff.WSg();Lb.App.oa.updateCommandUI();this.Dhg();this._initialized=!0}dispose(){this._initialized&&(this._initialized=!1,Uy.FootnoteEndnoteControlManager.instance.dispose())}jol(a,d){return a.QAa?new yB(a,d,n=>{Uy.FootnoteEndnoteControlManager.instance.K$m(n)},this.Z.Ca("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),this.Z.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Lb.App.instance&&Lb.App.instance.jQ):null}Dhg(){this.D4d=
new xB(()=>{Uy.FootnoteEndnoteControlManager.instance.u_d()});Ty.a.XTe(Object(m.a)(this.D4d,this.D4d.sM,"setUpdateNeeded"));yq.GraphTransactionManager.instance.UCa(this.D4d,3)}}Object(t.a)(IA,"PackageManager",null,[1,2]);class zB{constructor(a,d,n,z,O=null){this.xek=a;this.Da=d;this.xpa=z;this.fy=O}get c1h(){return this.xek.value}get bookmarkManager(){return this.xpa.value}fSi(a){return Rj.App.W4e||Rj.App.R4e?a.startsWith(w.a.EGa):!1}hIi(a){var d,n;try{if(Rj.App.R4e)this.oWl(a);else if(Rj.App.W4e&&
this.c1h){var z=a.split("/"),O=this.c1h.zra(z[z.length-1]);if(O&&O.anchor)if(Cs.a.isEnabled?this.fy.efa.has(null===(d=O.id)||void 0===d?void 0:d.toString()):O.hasProperty(Qb.a.fG)){var ca=Cs.a.isEnabled?this.fy.efa.get(null===(n=O.id)||void 0===n?void 0:n.toString()):O.getValue(Qb.a.fG);if(void 0===ca||null===ca)k.ULS.sendTraceTag(24691933,324,50,"Empty StartBookmarkParaId in the bookmark node"),this.YHe();else{var Da=Lb.App.oa.za.jc.kd.Ta(ca);if(Da&&Da.anchor){var Xa=ye.SelectionFactory.Pc(Da,0);
this.Da.setSelection(Xa)}else k.ULS.sendTraceTag(24691934,324,50,"Paragraph node is invalid for bookmark"),this.YHe()}}else k.ULS.sendTraceTag(24691932,324,50,"Missing StartBookmarkParaId in the bookmark node"),this.YHe();else k.ULS.sendTraceTag(24691931,324,15,"Cannot find bookmark node"),this.YHe()}}catch(zb){k.ULS.sendTraceTag(24691935,324,10,String.format("Error parsing bookmark url. Error: {0}",zb.message))}}kbh(a){return{returnValue:!1,KTg:a,wri:""}}oWl(a){if(this.bookmarkManager){a=a.split("/");
var d=this.bookmarkManager.zra(a[a.length-1]);d&&d.anchor?(a=this.bookmarkManager.Aza(d,!0).vqa,d=this.bookmarkManager.Aza(d,!1).vqa,a||d?a?this.Myj(a):(k.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.Myj(d)):(k.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.Rtg(!1))):(k.ULS.sendTraceTag(35992275,324,15,"Cannot find bookmark node"),this.Rtg(!0))}}YHe(){this.Rtg(!0)}Rtg(a){a=ye.SelectionFactory.Tm(Lb.App.oa.za.jc.vwe(),a);this.Da.setSelection(a)}Myj(a){a.paragraph&&
a.Wa?(a=ye.SelectionFactory.Pc(a.paragraph,a.Wa.cp),a.TEe=!0,this.Da.setSelection(a)):k.ULS.shipAssertTag(35992279,324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(t.a)(zB,"InternalLinkManager",null,[257]);class Gw{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}Hb(a){a.ha("WordEditor.InternalLinks.InternalLinkManager",()=>new zB(new Nf.a(()=>a.sa("WordEditor.Bookmark.IBookmarkGraphManager")),a.resolve("Box4.ISelectionManager"),a.resolve("Box4.IFeatureHelper"),
new Nf.a(()=>a.sa("WordEditor.Bookmark.IBookmarkManager")),a.resolve("Box4.BookmarkParagraphMapping"))).as("Box4.IInternalLinkManager").singleInstance()}static main(){M.a.instance.Sb(new Gw)}}Object(t.a)(Gw,"WordEditorInternalLinksPackage",null,[1,2]);class Hw{constructor(a){this.H0a=null;Hw.Cq=a}pnd(a){if(!Hw.yc.WHb(a))return null;a.Va(1)&&(a.currentNode.Fi(8,!0),a.hb());const d=Hw.Cq.U2k();Hw.yc.isRtl(a.currentNode)?d.setValue(Vd.a.wK,11):d.setValue(Vd.a.wK,9);a.Re(d,1);a.rg(d);return d}Dxj(a){if(this.H0a&&
a!==this.H0a){const d=new bf.a(2,1,0,Object(m.a)(this,this.checkAndDeleteEphemeralOutline,"checkAndDeleteEphemeralOutline"),120);d.customData=this.H0a;l.AFrameworkApplication.tb.rb(d)}this.H0a=a}Ffi(a){this.H0a===a.currentNode&&(this.H0a=null);const d=new Ff.GraphTransaction(7);d.Ir(a);a.wg();d.dispose()}J6h(){if(this.H0a&&this.H0a.anchor){const a=Dd.GraphIterator.ua(this.H0a);a.tn()&&qh.OutlineReader.PJc(a)&&this.Ffi(a);this.H0a=null}}checkAndDeleteEphemeralOutline(a){a=a.customData;if(a.anchor){Mh.a.mark(4763);
var d=Dd.GraphIterator.ua(a);if(d.La(8)&&d.tc(8)&&d.Abh(a)===a){if(qh.OutlineReader.isEmpty(d)){let n=!1;for(let z=0;z<Lg.a.instance.ya.length;z++){const O=Lg.a.instance.ya.J(z);for(let ca=0;ca<O.length;ca++)if(O.J(ca).node===a){n=!0;break}}n||this.Ffi(d)}Mh.a.mark(4764)}}}static get yc(){return mi.PageReader.instance}}Hw.Cq=null;Object(t.a)(Hw,"PageContentEditor",null,[1139]);var AB=b(1023),Iw=b(601);class my extends ck{constructor(){super()}hBj(a,d,n,z,O){let ca=!1,Da=!0;Qd.SelectionEditor.Cd(O)&&
(d=Bf.ListReader.Bh(a)&&d,O=Ia.OutlineElementReader.Hs(a,O,!1)&&!Ia.OutlineElementReader.Hs(a,O,!0),d&&n.qKf(a,z)&&(ca=!0),Lb.App.lc.eq&&(O||d&&!ca)&&(Da=!1));return{gBj:Da,NSj:ca}}}Object(t.a)(my,"CursorMoveValidator",ck,[]);class Mn{constructor(a,d,n,z){this.Xb=this.tf=this.Eb=null;this.lqf=a;this.b2=z;this.dI=d;this.Ee=n;this.Ebk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("QoEIndentLeftForListImprovementIsEnabled")}get hd(){return this.Eb||(this.Eb=la.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get Aj(){return this.tf||
(this.tf=la.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get gb(){return this.Xb||(this.Xb=la.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get Zt(){return this.b2.value}get Pg(){return this.Ee.value}get Pn(){return this.dI}xUl(a,d,n){const z=window.performance.now(),O=new Hm.ScriptSharpLegacyMap;d=new hl.a;n=new Hm.ScriptSharpLegacyMap;if(a&&a.Iq){var ca=null;for(let Da=0;Da<a.length;Da++){const Xa=a.getContext(Da);ca=ca||Mn.Ze.kt(Xa.node);let zb;if(!({groupId:zb}=
this.tHn(Xa.node,ca)).returnValue)continue;let Vb;O.Na(zb)||(Vb=[],O.add(zb,Vb));Vb=O.J(zb);Vb.push(Xa)}for(let Da of sg.toArray(O.keys))a=O.J(Da),ca=new Dd.GraphIterator,ca.set(a[0].node),({orj:a,Ar:ca}=this.dI.aHn(ca)).returnValue?(O.$(Da,a),n.add(Da,ca)):d.add(Da)}k.ULS.sendTraceTag(589592455,338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",window.performance.now()-z));return{returnValue:O,AUl:d,zUl:n}}f4b(a){return this.nOk(a)}hAc(a){return this.RNk(a)}Lle(a,d,n=!0){return Dd.GraphIterator.GX(()=>
{var z=!1;if(Bf.ListReader.Bh(a))return this.qKf(a,d,n);z||(qe.OutlineElementNavigator.Sd(a),z=Bd.ParagraphReader.Zf(a)||If.TableReader.isTable(a),qe.OutlineElementNavigator.Uc(a),z=z&&this.lOk(a,d));return z})}qKf(a,d,n=!0){return Dd.GraphIterator.GX(()=>{const z=Ia.OutlineElementReader.$Ha(a),O=qh.OutlineReader.OP(a.currentNode);if(n?!this.Mcm(a,d):!this.Ncm(a,d))return!1;var ca=Dd.GraphIterator.ua(a.currentNode);if(0<d&&ca.La(14)){ca.tc(16);var Da=ca.currentNode;const Xa=Sf.TableCellReader.Gwd(ca);
ca.tc(14);const zb=ca.currentNode;ca=iq.a.hH(Da,zb,Qb.a.gG,Qb.a.v5,0);Da=iq.a.hH(Da,zb,Qb.a.fJ,Qb.a.lda,0);ca=rf.a.tx(ca,0);Da=rf.a.tx(Da,0);return z+O<Xa-ca-Da}return!0})}lOk(a,d){const n=Ia.OutlineElementReader.$Ha(a);var z=Ia.OutlineElementReader.ML(a);if(0<d){d=qh.OutlineReader.OP(a.currentNode);z=0;({iq:O,marginLeft:Da,marginRight:ca}=Mn.Dye(a.currentNode,O,Da,ca));const Xa=Dd.GraphIterator.ua(a.currentNode);qe.OutlineElementNavigator.Sd(a);if(If.TableReader.isTable(a)){z=If.TableReader.s7(a);
let zb=0;for(let Vb of z)zb+=Vb;z=rf.a.tx(rf.a.ze(zb,0),0)}qe.OutlineElementNavigator.Uc(a);if(Xa.La(14)){Xa.tc(16);var O=Xa.currentNode;a=Sf.TableCellReader.Gwd(Xa);Xa.tc(14);var ca=Xa.currentNode;var Da=iq.a.hH(O,ca,Qb.a.gG,Qb.a.v5,0);O=iq.a.hH(O,ca,Qb.a.fJ,Qb.a.lda,0);Da=rf.a.tx(Da,0);O=rf.a.tx(O,0);return n+d<a-Da-O-z}return n+d<O-Da-ca-z}return 0<n-z}yCa(a,d){this.tcj(a,-1*Math.abs(d))}Eod(a,d){this.tcj(a,Math.abs(d))}x$k(a,d,n,z,O){let ca=Mn.A4i;if(d>=Mn.A4i){ca=d-=n;const Da=z*O,Xa=Math.abs(Da),
zb=Math.abs(d)%Xa;zb&&(ca=0>ca?0>z?ca+zb:ca-(Xa-zb):0<z?ca-zb:ca+(Xa-zb));ca+=Da;ca+=n;Mn.nQe&&(n=Ia.OutlineElementReader.b4(a),ca=Mn.nQe.Iui(a.currentNode,d+n,ca+n,O,ca<d)-n)}return ca}jOk(a,d,n){if(!a||!a.length)return!1;d=n?d?-1:1:this.jwi(a[0].node,d);return this.kOk(a,d,n)}UMm(a,d,n){if(!a)return k.ULS.shipAssertTag(589345600,338,!1,"The group of listOEs are null which are sent for indentation."),8;if(!a.length)return k.ULS.shipAssertTag(589345601,338,!!a.length,"The group of listOEs are empty which are sent for indentation."),
8;if(!n)return k.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),8;if(!n.length)return k.ULS.shipAssertTag(589592459,338,!1,"The listIds are empty which are sent for indentation."),8;const z=a[0].node;d=this.jwi(z,d);if(!this.Fxm(z,n[0],d)||!this.Cxm(a,d))return 8;this.Zt.nia();return 32}Cxm(a,d){for(let n=0;n<a.length;n++){const z=new Dd.GraphIterator;z.set(a[n].node);let O=null;qe.OutlineElementNavigator.Sd(z);if(Bd.ParagraphReader.Zf(z)){if(O=z.currentNode,
!O)return k.ULS.shipAssertTag(589592461,338,!O,"The paraNode is null for the list OE node"),!1}else if(!Bd.ParagraphReader.Zf(z)&&!If.TableReader.isTable(z))return k.ULS.shipAssertTag(589592460,338,!1,"The content of the listOE is neither a paragraph nor a table node"),!1;z.hb();if(O){if(this.TYl(O)){const ca=O.TB(),Da=Ia.OutlineElementReader.$Ha(z);this.Pg.RKa(z,1,Da+d);ca&&this.Aj.d1(O,ca,this.hd.Jf)}O.setValue(Vd.a.hca,new Date)}}return!0}Fxm(a,d,n){for(let z=0;z<wh.a.Qga;z++){const O=this.dI.ww(a,
d,z);if(!O)return k.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",d),!1;const ca=O.getValue(Qb.a.Oj);l.AFrameworkApplication.Zi("Microsoft.Office.WordOnline.EOPNoFormattingFixEnabled");l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EOPNoFormattingFixEnabled",!1)?ca&&O.setValue(Qb.a.Oj,ca+n):O.setValue(Qb.a.Oj,ca+n)}return!0}TYl(a){return a.hasProperty(Qb.a.Oj)||a.hasProperty(Qb.a.Ny)||a.hasProperty(Qb.a.QE)}RNk(a){return this.Lle(a,
1,!0)}nOk(a){return this.Lle(a,-1,!0)}jwi(a,d){var n=new Dd.GraphIterator;n.set(a);const z=Ia.OutlineElementReader.$Ha(n),O=Ia.OutlineElementReader.ML(n),ca=Ia.OutlineElementReader.b4(n);n=qh.OutlineReader.OP(a);let Da,Xa,zb;({iq:Da,marginLeft:Xa,marginRight:zb}=Mn.Dye(a,Da,Xa,zb));a=(O?z-O:ca)%n;return d?-1*(a?a:n):n-a>Mn.Vei?Mn.Vei:n-a}tHn(a,d){let n;const z=new Dd.GraphIterator;z.set(a);a=z.Va(4).getValue(Qb.a.listID);return({id:n}=this.dI.mvb(a,d)).returnValue?{returnValue:!0,groupId:n}:{returnValue:!1,
groupId:n}}kOk(a,d,n){var z=!1;for(let O=0;O<a.length;O++){z=a[O];const ca=new Dd.GraphIterator;ca.set(z.node);Qd.SelectionEditor.Vm(ca);if(!Ia.OutlineElementReader.gg(ca))return Mn.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.hra}),!1;if(this.Lle(ca,d,n))z=!0;else return Mn.Lb.mb(Ee.a.S6b,{["Reason"]:Jf.a.Tjd}),!1}return z}tcj(a,d){if(this.Lle(a,d,!0)){var n=!1;if(Bf.ListReader.Bh(a)){var z=new Dd.GraphIterator;z.Cb(a);this.Pn.dC(z);var O=z.currentNode;z.hb();const Da=O.getValue(Qb.a.je);n=!0;var ca=O.getValue(Qb.a.listID);
if(ca=this.mPl(ca,Da+d))qe.OutlineElementNavigator.Sd(z),Bd.ParagraphReader.Zf(z)&&Mn.kZ.hT(ca,z.currentNode,!1),z.hb();else{ca=null;let Xa;qe.OutlineElementNavigator.Sd(z);Bd.ParagraphReader.Zf(z)&&(ca=z.currentNode);z.hb();Xa=ca?ca.TB():null;this.Ebk&&(ca||(qe.OutlineElementNavigator.Sd(z),Bd.ParagraphReader.Zf(z)&&(ca=z.currentNode),z.hb()),ca&&(ca.hasProperty(Qb.a.Oj)&&ca.removeProperty(Qb.a.Oj),ca.hasProperty(Qb.a.Ny)&&ca.removeProperty(Qb.a.Ny)));this.Zt.OUe(z,Da,d);O.setValue(Qb.a.je,Da+d);
O.removeProperty(Qb.a.lca);ca&&Xa&&(this.Aj.d1(ca,Xa,this.hd.Jf),this.Zt.nia());this.BBn(a,O)}}n||(n=Ia.OutlineElementReader.$Ha(a),z=Ia.OutlineElementReader.ML(a),O=qh.OutlineReader.OP(a.currentNode),d=this.x$k(a,n,z,d,O),this.Pg.RKa(a,1,d))}}Ncm(a,d){const n=Ia.OutlineElementReader.$Ha(a),z=Ia.OutlineElementReader.ML(a),O=Ia.OutlineElementReader.b4(a);let ca,Da,Xa;({iq:ca,marginLeft:Da,marginRight:Xa}=Mn.Dye(a.currentNode,ca,Da,Xa));if(0<d){if(a=ca-Da-Xa,O&&O+d+Lb.App.$Da>a||n+d+Lb.App.$Da>a)return!1}else if(O&&
0>n+d||0>n-z+d)return!1;return!0}Mcm(a,d){var n=this.Zt.Uz(a);const z=n.level,O=qh.OutlineReader.OP(a.currentNode),ca=z+d;if(bn.a.KFd<ca||ca<bn.a.Gue)return!1;const Da=a.currentNode;if(!Bf.ListReader.Jq){var Xa=qe.OutlineElementNavigator.Sd(a);qe.OutlineElementNavigator.Uc(a);if(Xa.hasProperty(Qb.a.Oj)&&(Xa=Xa.getValue(Qb.a.Oj),O*(z+1)!==Xa))return!1}n=this.Pn.ww(Da,n.listID,ca);if(!n)return k.ULS.shipAssertTag(590700875,338,!!n),!1;if(0<d&&n.hasProperty(Qb.a.Oj)){d=n.getValue(Qb.a.Oj);let zb,Vb,
Fc;({iq:zb,marginLeft:Vb,marginRight:Fc}=Mn.Dye(a.currentNode,zb,Vb,Fc));if(d+Lb.App.$Da>zb-Vb-Fc)return!1}return!0}mPl(a,d){const n=this.gb.kn();for(let z=0;z<n.Oz;z++){const O=n.$X(z);if(this.Pn.I3a(O)&&O.fa(Qb.a.listID,this.Zt.Hga+1)===a&&O.fa(Qb.a.je,-1)===d)return O}return null}BBn(a,d){qe.OutlineElementNavigator.Sd(a);if(Bd.ParagraphReader.Zf(a)&&a.currentNode.hasProperty(Qb.a.Oj)&&(d=this.Pn.NFb(d))){const z=Bf.ListReader.Jq;if(z&&d.hasProperty(Qb.a.Ny)){var n=d.getValue(Qb.a.Ny);this.lqf.XMb(a.currentNode,
n)}d.hasProperty(Qb.a.Oj)&&(n=d.getValue(Qb.a.Oj),this.lqf.RKa(a,1,n));z&&d.hasProperty(Qb.a.QE)&&(d=d.getValue(Qb.a.QE),this.lqf.goa(a.currentNode,d))}qe.OutlineElementNavigator.Uc(a)}static get kZ(){return Mn.nI||(Mn.nI=la.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}static get nQe(){return Mn.Y9c||(Mn.Y9c=la.a.instance.sa("WordEditor.ParagraphIndentationUtility"))}static get paragraphEditor(){return Mn.Ki||(Mn.Ki=la.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){Mn.Ki=
a}static get Lb(){return Ch.a.instance}static get pi(){return jq.a.instance}static get Ze(){return jm.PageNavigator.instance}static Dye(a,d,n,z){a=Zt.WordSectionNavigator.instance.BK(a);d=Mn.pi.Gt(a);n=Mn.pi.UP(a);z=Mn.pi.VP(a);return{iq:d,marginLeft:n,marginRight:z}}}Mn.Vei=Wf.a.xE(.25);Mn.nI=null;Mn.Y9c=null;Mn.Ki=null;Mn.A4i=Wf.a.xE(-11);Object(t.a)(Mn,"OutlineElementIndentationEditor",null,[432,433]);var ny=b(284),ii=b(838),kp=b(198),Sv;(function(a){a[a.none=0]="none";a[a.character=1]="character";
a[a.paragraph=2]="paragraph";a[a.table=3]="table"})(Sv||(Sv={}));Object(t.b)("StyleTargetType",Sv);var Jw=b(155);class Cx{constructor(a,d){this.Vp=this.oF=this.tf=this.Eb=this.hc=this.Xn=this.Ja=this.$D=this.nk=this.Wd=this.Ki=null;this.Wq=d;this.zc=a}get paragraphEditor(){return this.Ki||(this.Ki=la.a.instance.resolve("Box4.IParagraphEditor"))}get jx(){return this.oF||(this.oF=la.a.instance.resolve("Box4.IFontStylesGalleryCache"))}get Gg(){return this.Vp||(this.Vp=la.a.instance.sa("Box4.Styles.StyleSettings"))}get Xg(){return this.Wd||
(this.Wd=la.a.instance.resolve("Box4.IFormattingEditor"))}get gb(){return this.nk||(this.nk=la.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get Lda(){return this.$D||(this.$D=new Iw.WACStyleSet)}set Lda(a){this.$D=a}get Ka(){return this.Ja||(this.Ja=la.a.instance.sa("Box4.IFeatureHelper"))}get es(){return this.Wq.value}get pj(){return this.Xn||(this.Xn=la.a.instance.sa("Box4.IInsertionPointFormatting"))}get bJe(){return this.zc||(this.zc=la.a.instance.resolve("Box4.List.IListReader"))}get characterPropertiesEditor(){return this.hc||
(this.hc=la.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}get hd(){return this.Eb||(this.Eb=la.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get Aj(){return this.tf||(this.tf=la.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}qPl(a){const d=a.node;var n=this.pj?this.pj.l6f():null;if(n&&!n.equals(E.a.nil)){a=d.Ib;if(!a)return null;n=a.Ta(n);if(!n||(n=new Jw.a(n),1!==this.gb.Mv(n)))return null}else n=La.FormattingReader.yr(a),n=La.FormattingReader.Rra(n);
return n}Hon(a,d){const n=this.gb.rz(d);n&&n.Mf(this.gb.Jd(a))&&(this.Heh(d,n),this.pj&&(this.pj.B8a(),this.pj.Ltb(a,d)))}UCk(a,d){if(d)if(d.u8b&&0<d.u8b.length){let O=new ra.a;for(var n of d.u8b)O.add(n);if(d.Utg){d=La.FormattingReader.Ksi(a,!1);n=[];for(var z of d)z.formatting&&z.formatting.gm&&n.push(z.formatting.gm);if(0<n.length){z=ny.APropertySet.z9f(n);d=new ra.a;for(const ca of O)z.hasProperty(ca)||d.add(ca);O=d}}this.paragraphEditor.FAc(a,!0,O)}else this.paragraphEditor.FAc(a,!0);else Ld.b(576582787,
3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}hT(a,d,n,z=!1,O=!1,ca=!1,Da=null){if(Bd.ParagraphReader.nb(d))if(a)if(this.gb.Iy(a.Be()))if(2!==this.gb.Mv(a))k.ULS.shipAssertTag(593506381,324,!1);else{var Xa=this.gb.rz(d);if(Xa){var zb=this.gb.Jd(a);if(!zb)k.ULS.shipAssertTag(593506377,324,!1);else if(Xa.Mf(zb)){var Vb=null,Fc=uf.a.instance.J(3)&&!z?d.TB():null;n||(Da&&Da.JNk&&this.Ka&&this.Ka.isFeatureEnabled(163)?(this.UCk(d,Da),this.BNn(d,a,Da)):
(Vb=this.es.uRg(Vb,d),this.paragraphEditor.FAc(d,!0)));this.Heh(d,Xa);uf.a.instance.J(8)||(a=Xa.Mf(this.gb.Jd(a)));O&&Fc&&Fc.hasProperty(lh.a.paragraphStyle)&&Fc.removeProperty(lh.a.paragraphStyle);d.properties.setValue(lh.a.paragraphStyle,a.id);null!=ii.a.Oc&&!ii.a.Oc.hV&&this.Ka&&this.Ka.isFeatureEnabled(163)&&this.uOj(d,a,Da);d.JO=a;d.KV=null;for(n=0;n<d.ja.length;n++)d.ja.J(n).formatting&&d.ja.J(n).formatting.kHb();this.bJe.I3a(a)&&(Vb||(Vb=new Dd.GraphIterator,Vb.set(d),Vb.kc(),qe.OutlineElementNavigator.Uc(Vb)),
Bf.ListReader.Bh(Vb)||(d.oe(Qb.a.Oj,Qb.a.lM,Qb.a.QE,Qb.a.N0,Qb.a.dKa,Qb.a.kM),this.Lje(Vb,a)));this.Gg&&this.Gg.isProgressiveStyleEnabled&&null!=this.jx&&this.jx.kTc(zb);z||!Fc||ca||this.Aj.d1(d,Fc,this.hd.Jf)}}else k.ULS.shipAssertTag(593506379,324,!1)}else k.ULS.shipAssertTag(593506382,324,!1);else k.ULS.shipAssertTag(593506383,324,!1);else k.ULS.shipAssertTag(593506384,324,!1)}BNn(a,d,n){const z=this.bJe.QL(a),O=this.bJe.I3a(d);if(z){if(null!=ii.a.Oc&&ii.a.Oc.hV)this.uOj(a,d,n);else{n=n&&!n.Utg&&
n.u8b?n.u8b:null;var ca=this.bJe.QP(z);ca&&this.es.ANn(z,d,n,ca.Zr)}O||a.setValue(Qb.a.lca,!1)}else O&&a.setValue(Qb.a.lca,!0)}uOj(a,d,n){const z=a.Ib;if(a=this.characterPropertiesEditor.vHa(a)){var O=null==a.gm?new kp.a:a.gm.clone();sj.a.OPj(O,d,n&&!n.Utg&&n.u8b?n.u8b:null);O.V7?d=z.$S(O,!0):(z.Mu(O,null),d=O);a.ng=d.id}else k.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}Lje(){}gYe(a,d){if(d){k.ULS.shipAssertTag(593506371,324,d.isConnected,"paragraphNode not connected");
var n=this.gb.rz(d);n?(a=n.dma(a))?this.gb.Iy(a.Be())?this.hT(a,d,!1,void 0,void 0,void 0,null):k.ULS.shipAssertTag(593506368,324,this.gb.Iy(a.Be())):k.ULS.shipAssertTag(593506369,324,!!a):k.ULS.shipAssertTag(593506370,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else k.ULS.shipAssertTag(593506372,324,!1)}sMf(a,d=!1,n=!1){const z=this.gb.rz(a).Mf(uf.a.instance.J(8)?Gh.StyleReader.wordStyleIdNormal:Gh.StyleReader.styleIdNormal);this.hT(z,a,d,void 0,n)}Heh(a,d){(a=Cx.Ze.kt(a))&&d.tlc(a,
!1)}A8k(a){var d=null;if(this.Ka&&this.Ka.isFeatureEnabled(51)){if(!a||!a.count)return k.ULS.sendTraceTag(592221652,3018,10,"No style IDs provided for delete."),!1;if(!d&&(d=sj.a.qz(),!d))return k.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),!1;var n=this.Lda.VL(d);if(!n)return k.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var z=new Map;z.set("NumberOfStyles",a.count.toString());z.set("Source","DeleteStyleAPI");ja.Health.instance.recordKpiUsage(Fm.a.r1d,
0,Fm.a.aH,z);z=0;const Da=(new Date).getTime();var O=null;let Xa=null,zb=null,Vb=null;const Fc=this.Ka.isFeatureEnabled(50)&&!0;Fc&&(O=new db.a,Xa=new db.a,zb=new db.a,Vb=new db.a);for(var ca of a){if(!ca)return k.ULS.sendTraceTag(592221655,3018,50,"Style ID is null."),!1;const Yc=n.Mf(ca);if(!Yc||!this.gb.Gu(Yc,n))return k.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!Yc,!!Yc&&this.gb.Gu(Yc,n)),!1;const yd=this.gb.Mv(Yc);if(2!==yd&&1!==yd)return k.ULS.sendTraceTag(592221657,
3018,50,"Provided style has style type: {0}.",yd),!1;const je=this.gb.MN(Yc,n);let Le=0;if(je){if(!this.gb.Gu(je,n))return k.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),!1;Le=this.gb.Mv(je);if(2!==Le&&1!==Le)return k.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",yd,Le),!1}else k.ULS.sendTraceTag(592221658,3018,50,"Provided style's linked style is null.");let Ve=this.yjb(Yc,n);if(!Ve)return!1;
z++;Fc&&(1===yd?(Xa.add(ca),Vb.add(Yc.id)):(O.add(ca),zb.add(Yc.id)));if(je){Ve=this.yjb(je,n);if(!Ve)return!1;z++;Fc&&(1===Le?(Xa.add(this.gb.Jd(je)),Vb.add(je.id)):(O.add(this.gb.Jd(je)),zb.add(je.id)))}}It.a.xAa();n=sj.a.Dwd(n);ca=new Ff.GraphTransaction(15);ca.Sa(d);Fc&&this.v7m(O,Xa,zb,Vb,d);d.setValue(lh.a.uM,n);Ld.b(572302817,3018,50,String.format("Style Object Ids - {0}",n));ca.TMb();ca.dispose();d=(new Date).getTime();O=new Map;O.set("Source","DeleteStyleAPI");O.set("NumberOfStyles",a.count.toString());
O.set("TrueStyleCount",z.toString());O.set("ShouldRemoveReferences",(!0).toString());a=Object.assign(new Sg.a,{extendedProperties:O,durationMs:d-Da});ja.Health.instance.recordKpiSuccess(Fm.a.r1d,a);return!0}return!1}v7m(a,d,n,z,O){if(a&&a.count||d&&d.count)if(O){var ca=(new Date).getTime();if(O=this.vyl(O)){for(;O.moveNext();){if(!Bd.ParagraphReader.Zf(O.iterator))continue;const Da=O.currentNode;this.i7m(Da,a,n);this.j7m(Da,d,z)}n=(new Date).getTime();k.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",
n-ca));z=new Map;z.set("Source","DeleteStyleRemoveStylesReferences");z.set("NumberOfStyles",(a.count+d.count).toString());a=Object.assign(new Sg.a,{extendedProperties:z,durationMs:n-ca});ja.Health.instance.recordKpiSuccess(Fm.a.r1d,a)}}else Ld.b(577520338,3018,50,"PageContentNode not provided.");else Ld.b(577520337,3018,50,"No style IDs provided")}i7m(a,d,n){if(d&&d.count&&a){var z=a.hC;z&&z.hasProperty(lh.a.paragraphStyle)&&n.contains(z.getValue(lh.a.paragraphStyle))&&(z.removeProperty(lh.a.paragraphStyle),
a.hC=z,a.TB()&&this.Aj.d1(a,a.TB(),this.hd.Jf));(n=this.gb.im(a))&&(n=this.gb.Jd(n))&&d.contains(n)&&this.sMf(a,!0,!0)}}j7m(a,d,n){if(a&&a.ja&&a.ja.length&&d&&d.count)for(let Da=0;Da<a.ja.length;Da++){var z=a.ja.J(Da);if(z&&z.formatting&&(z=z.formatting)&&z.Wa){var O=La.FormattingReader.Rra(z);O&&(O=this.gb.Jd(O))&&d.contains(O)&&this.Xg.bMf(z);if(O=z.Wa.Qi){var ca=O.gm;ca&&(ca=ca.clone(),ca.hasProperty(lh.a.GA)&&n.contains(ca.getValue(lh.a.GA))&&this.S5m(a,ca,O,z));uf.a.instance.J(3)&&(ca=Da===a.ja.length-
1?a.characterData.length:a.ja.J(Da+1).cp,this.Aj.alc(a,z.Wa,z.Wa.cp,ca,O,z,this.hd.Jf))}}}}S5m(a,d,n,z){a&&d&&n&&z&&(a=a.Ib)&&(d.removeProperty(lh.a.GA),d.V7?d=a.$S(d,!0):a.Mu(d,null),n.ng=d.id,z.Wa.Qi=n)}vyl(a){if(!a)return null;a=Dd.GraphIterator.ua(a);return a.tn()?Yi.a.Yo(a,a.origin):null}yjb(a,d){if(!a)return k.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var n=a.Be();return this.gb.Iy(n)?d.Vnj(a)?!0:(n=new Map,n.set("Source","DeleteStyle"),n.set("StyleType",
Sv[this.gb.Mv(a)]),n.set("IsCustomStyle",this.gb.Gu(a,d).toString()),n.set("IsLinkedStyle",(!!this.gb.MN(a,d)).toString()),a=Object.assign(new Sg.a,{extendedProperties:n}),ja.Health.instance.recordKpiFailure(Fm.a.r1d,"UnableToDeleteStyle",!1,!0,a),k.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(k.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),!1)}HMc(a,d,n,z){if(this.Ka&&this.Ka.isFeatureEnabled(130)){if(!a)return k.ULS.sendTraceTag(591138959,
3018,15,"No style IDs provided for delete."),!1;if(!n&&(n=sj.a.qz(),!n))return k.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),!1;const ca=this.Lda.VL(n);if(!ca)return k.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;a=ca.Mf(a);if(!a)return k.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!a),!1;var O=this.gb.Mv(a);if(2!==O&&1!==O)return k.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",
O),!1;ja.Health.instance.recordKpiUsage(Fm.a.a5e,0,Fm.a.aH,new Map([["Source","ModifyStyleAPI"]]));O=Date.now();const Da=new Ff.GraphTransaction(15);try{Da.Sa(n);if(z&&0!=z.length&&!ca.Ofi(a,z))return this.rKe("ModifyStyleAPI",a,ca,O,"UnableToDeleteStyleProperties"),!1;if(!ca.iQj(a,d))return this.rKe("ModifyStyleAPI",a,ca,O,"UnableToModifyStyle"),!1;It.a.xAa();const Xa=sj.a.Dwd(ca);n.setValue(lh.a.uM,Xa);Ld.b(572302818,3018,50,String.format("Style Object Ids - {0}",Xa));const zb=Date.now(),Vb=new Map([["Source",
"ModifyStyleAPI"]]),Fc=Object.assign(new Sg.a,{extendedProperties:Vb,durationMs:zb-O});ja.Health.instance.recordKpiSuccess(Fm.a.a5e,Fc);return!0}finally{Da&&Da.dispose()}}return!1}rKe(a,d,n,z,O){const ca=Date.now();a=new Map([["Source",a],["StyleType",Sv[this.gb.Mv(d)]],["IsCustomStyle",this.gb.Gu(d,n).toString()],["IsLinkedStyle",(!!this.gb.MN(d,n)).toString()]]);z=Object.assign(new Sg.a,{extendedProperties:a,durationMs:ca-z});ja.Health.instance.recordKpiFailure(Fm.a.a5e,O,!1,!0,z)}static get Ze(){return jm.PageNavigator.instance}}
Object(t.a)(Cx,"WACStyleEditor",null,[25]);class oy extends Cx{constructor(a,d,n){super(a,n);this.b2=d}get Zt(){return this.b2.value}Lje(a,d){this.Zt.Lje(a,d)}}Object(t.a)(oy,"WACStyleEditor",Cx,[]);var Kr=b(161);class JA{W8a(a,d){a.properties.setValue(Qb.a.marginTop,d)}U8a(a,d){a.properties.setValue(Qb.a.marginBottom,d)}ioa(a,d){a.properties.setValue(Qb.a.marginLeft,d)}V8a(a,d){a.properties.setValue(Qb.a.marginRight,d)}H1g(a,d){a.properties.setValue(Qb.a.iq,d)}G1g(a,d){a.properties.setValue(Qb.a.My,
d)}Bxj(a,d){a.properties.setValue(Qb.a.mIe,d)}hSc(a,d){a.properties.setValue(Kr.a.z3,d)}FTd(a){a.properties.setValue(Kr.a.wN,void 0)}}Object(t.a)(JA,"WordSectionEditor",null,[256]);class qu{get name(){return"WordEditor.OutlineLevelEditors"}Hb(a){a.ha("WordEditor.OutlineLevelEditors.WordSectionEditor",()=>new JA).as("Box4.IWordSectionEditor").singleInstance();l.AFrameworkApplication.K.ea("OutlineLevelEditorsDelayInitializationEnabled")&&(a.ha("Box4.OutlineLevelEditors.PageContentEditor",()=>new Hw(a.resolve("Box4.IOutlineEditor"))).as("Box4.Pages.IPageContentEditor").singleInstance(),
a.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Mn(nt.a.dmb,a.resolve("WordEditor.List.IFlatListReader"),a.vf("Box4.IOutlineElementEditor"),a.vf("WordEditor.IFlatListEditor"))).as("Box4.IOutlineElementIndentationEditor"),a.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Mn(nt.a.dmb,a.resolve("WordEditor.List.IFlatListReader"),a.vf("Box4.IOutlineElementEditor"),a.vf("WordEditor.IFlatListEditor"))).as("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"),
a.ha("WordEditor.OutlineLevelEditors.CursorMoveValidator",()=>new my).as("Box4.List.ICursorMovementValidator").singleInstance(),a.ha("Box4.Styles.WACStyleReader",()=>new AB.a(new Iw.WACStyleSet)).as("Box4.Styles.IWACStyleReader").singleInstance(),a.ha("WordEditor.OutlineLevelEditors.WACStyleEditor",()=>new oy(a.resolve("Box4.List.IListReader"),a.vf("WordEditor.IFlatListEditor"),a.vf("Box4.List.IListEditor"))).as("Box4.Styles.IWACStyleEditor").singleInstance())}init(){}dispose(){}static main(){M.a.instance.Sb(new qu)}}
Object(t.a)(qu,"WordEditorOutlineLevelEditorsPackage",null,[1,2]);var Nz=b(1050),Kw=b(532),mv=b(738),ru=b(300);class Oz{constructor(){this.$sa=0;this.uSj=!1}}Object(t.a)(Oz,"LastNumber",null,[]);var Wy=b(533),KA=b(654),su=b(796);class Ds{constructor(a,d,n,z){this.zc=z;this._pageContent=n;this.MXb=Array(Ds.Qga);this.Nwc=Array(Ds.Qga);this.DOh=Array(Ds.Qga);this.Qsf=Array(Ds.Qga);this.NLh=Array(Ds.Qga);for(let ca=0;ca<Ds.Qga;ca++){var O=this.wzi(a,ca,n,z);let Da;O?(Da=O.fa(Vd.a.JS,wh.a.uh),O=O.fa(Qb.a.$Qc,
wh.a.uh)):O=Da=wh.a.uh;this.Nwc[ca]=Da!==wh.a.uh?Da:wh.a.BCc;this.Qsf[ca]=O===wh.a.uh?ca-1:O-1;Ds.Mga(d)&&(this.DOh[ca]=wh.a.uh,this.NLh[ca]=wh.a.uh);this.MXb[ca]=this.Nwc[ca]}}wzi(a,d,n,z){z.C_(n);return this.zc.Slb(a,d,n.Ib,n)}hMb(a){this.MXb[a]=this.Nwc[a]}t6i(a){for(var d=0;d<a;d++)this.MXb[d]===this.Nwc[d]&&this.MXb[d]++;for(d=a+1;d<Ds.Qga;d++)this.Qsf[d]>=a&&this.hMb(d);return this.MXb[a]++}static Mga(a){return!!a&&a.isFeatureEnabled(116)}}Ds.Qga=9;Object(t.a)(Ds,"AWordList",null,[533]);class LA{constructor(a,
d){this.Azb=new Hm.ScriptSharpLegacyMap;this.zc=a;this.oy=d}ht(a,d){this.Azb.Na(a)||this.Azb.$(a,new Ds(a,d,this.oy,this.zc));return this.Azb.J(a)}oEg(a,d,n){return this.ht(a,n).t6i(d)}}Object(t.a)(LA,"AListNumberingMap",null,[537]);class Qo extends Ds{constructor(a,d,n,z){super(a,d,n,z)}uIl(a,d,n,z){z.C_(n);return this.zc.YEl(a,d,this._pageContent.Ib)}pOj(a,d,n){var z=this.uIl(a,d,this._pageContent,this.zc);z?(a=z.fa(Vd.a.JS,wh.a.BCc),z=z.fa(Qb.a.$Qc,wh.a.uh),this.MXb[d]=this.DOh[d]=this.Nwc[d]=
a,z!==wh.a.uh&&(this.NLh[d]=this.Qsf[d]=z-1)):n&&(z=this.wzi(a,d,this._pageContent,this.zc),a=wh.a.BCc,z&&(a=z.fa(Vd.a.JS,wh.a.BCc)),this.MXb[d]=this.Nwc[d]=a)}}Object(t.a)(Qo,"WordList",Ds,[]);class Pz extends LA{constructor(a,d){super(a,d);this.xKh=new db.a}FEl(a,d,n){let z;at.a.getInstance().t0?{value:z}=this.zc.CY.Ab(a,z):{value:z}=this.zc.BY.Ab(a,z);this.Azb.Na(z)||this.Azb.$(z,new Qo(a,n,this.oy,this.zc));if(!this.xKh.contains(a))for(this.xKh.add(a);d<wh.a.Qga;d++)this.Azb.J(z).pOj(a,d,!1);
else if(!d)for(d+=1;d<wh.a.Qga;d++)this.Azb.J(z).pOj(a,d,!0);return this.Azb.J(z)}oEg(a,d,n){return Ds.Mga(n)?this.FEl(a,d,n).t6i(d):super.oEg(a,d,n)}}Object(t.a)(Pz,"ListNumberingMap",LA,[]);class En{constructor(){this.startAt=this.C8=0}}Object(t.a)(En,"WordListRestartInfo",null,[]);class $n{constructor(a,d,n,z){this.CMe=!1;this.Zt=a;this.lSi=n;this.iJc=z;this.lu=this.Zt.Uz(d);this.outlineElement=new Dd.GraphIterator;this.outlineElement.Cb(d)}static get Vb(){return $n.zc||($n.zc=la.a.instance.resolve("Box4.List.IListReader"))}static set Vb(a){$n.zc=
a}static get Oc(){return at.a.getInstance()}static Kkl(a,d,n,z=!1,O=!1){var ca=d.currentNode;let Da=null;new Dd.GraphIterator;let Xa=!1,zb=!1;d=d.Dda();const Vb=Yi.a.Ql(d);Vb.moveNext();for(d=Vb.iterator;d.currentNode!==ca;){let Yc=zb=Xa=!1;var Fc=!1;Bf.ListReader.Jq&&(Fc=$n.Kcl(d));if(Ia.OutlineElementReader.gg(d)&&!Fc){Fc=!1;if(d.Bo(4))if($n.A7i(d,n,!0,z,O))if(Bf.ListReader.V3){if(Yc=!0,Da=new $n(a,d,!1,!1),Vb.moveNext(),Vb.iterator===ca&&(Xa=!0),z)break}else Da=new $n(a,d,!1,!1),Xa=!0;else Ia.OutlineElementReader.isEmpty(d,
!1)||(Fc=!0),zb=!0;else!Ia.OutlineElementReader.isEmpty(d,!1)&&d.nma(12)&&(Ia.OutlineElementReader.rI(d)||(Fc=!0));!z&&Fc&&Da&&(!n.propertySet.hasProperty(Qb.a.je)&&Bf.ListReader.Jq?Da=null:Da.lu.level=0)}Yc||Vb.moveNext();d=Vb.iterator}Da&&(Da.iJc=Xa);if(!Da&&d.Kd(1))for(ca=!0;d.currentNode;){if(Ia.OutlineElementReader.gg(d)){if(d.Bo(4)&&$n.A7i(d,n,!1,z,O)){Da=new $n(a,d,!0,ca);break}if(!Ia.OutlineElementReader.isEmpty(d,!1))break}if(!d.Kd(1))break;ca=!1}Da&&(Da.CMe=zb);return Da}static Kcl(a){var d=
a.Va(2);if(!d)return!1;d=Bd.ParagraphReader.Zf(a)&&$n.ydm(d);a.hb();return d}static ydm(a){return Lj.a(a,8)}static A7i(a,d,n,z=!1,O=!1){$n.Vb.dC(a);var ca=a.currentNode;a.hb();if(ca.fa(Qb.a.lca,!1)&&!$n.Oc.EVa)return!1;const Da=$n.Vb.QP(ca);(a=d.Zr===Da.Zr)&&d.listStyle&&1!==d.gq&&(a=d.listStyle===Da.listStyle);$n.Vb.Cr&&a&&(d.Gsa&&1!==d.gq||d.w8b||O)&&(a=$n.dcm(d,Da),d.Zr||(a=a&&d.font===Da.font));if(1===d.gq)if(1===Da.gq&&Da.propertySet.hasProperty(bd.a.Psa))a=d.s1===Da.s1;else return!1;a&&d.Zr&&
d.cA!==wh.a.uh&&(a=Da.gp,n&&(z&&1===d.cA&&1===a||a++),a=d.cA===a);a&&(z||d.w8b)&&(d=d.propertySet.fa(Qb.a.listID,0),ca=ca.fa(Qb.a.listID,0),0<d&&0<ca&&(a=d===ca));return a}static dcm(a,d){d=d.cGd;a.Gsa&&(d=d.replace(RegExp("%\\d"),"%1"));return d.toLocaleLowerCase()===a.cGd.toLocaleLowerCase()}static Lkl(a,d,n){var z=d.currentNode;let O=null;const ca=new Dd.GraphIterator,Da=a.WP(z,n);var Xa=!1;let zb=!1;ca.Cb(d);ca.hb();for(ca.Va(1);ca.currentNode!==z;)zb=Xa=!1,Ia.OutlineElementReader.gg(ca)&&ca.Bo(4)&&
(d=a.Uz(ca),$n.B7i(d,n,!0)?(O=new $n(a,ca,!1,!1),Xa=!0):(zb=!0,d.listID===n.listID&&d.level<=Da.C8&&(O=null))),ca.Kd(1);O&&(O.iJc=Xa);if(!O&&ca.Kd(1))for(z=!0;ca.currentNode;){if(Ia.OutlineElementReader.gg(ca)&&ca.Bo(4)){Xa=a.Uz(ca);if(Xa.listID===n.listID&&Xa.level<=Da.C8)break;if($n.B7i(Xa,n,!1)){O=new $n(a,ca,!0,z);break}}if(!ca.Kd(1))break;z=!1}O&&(O.CMe=zb);return O}static B7i(a,d,n){let z=a.listID===d.listID&&a.level===d.level;z&&d.gp!==wh.a.uh&&(a=a.gp,n&&a++,z=d.gp===a);return z}}$n.zc=null;
Object(t.a)($n,"JoinTargetInfo",null,[]);class Dx{constructor(){this.action=0;this.lu=null}}Object(t.a)(Dx,"ApplyListInfoWordResult",null,[]);class nv{constructor(a,d,n){this.aGn=a;this.zTc=n;this.xMm=d;this.bpa=n-d.gp;this.pLd=d.listID}get delta(){-1!==this.bpa&&(this.bpa=this.zTc-this.xMm.gp);return this.bpa}set delta(a){this.bpa=a}}Object(t.a)(nv,"ListTransferInfo",null,[]);class ko extends ii.a{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd){super(a,n,zb);this.Ffb=!1;this.PAb=this.C_c=this.o5d=
this.Nrc=null;this.Ck=O;this.dI=a;this.qtc=d;this.Nb=z;this.gMg={};this.qmf=ca;this.Eb=Da;this.tf=Xa;this.Ja=Vb;this.nk=Yc;this.Kz=yd}get Mga(){return this.dI.Gma}get Pn(){return this.dI}get Wha(){return this.Kz}get gb(){return this.nk}get Ar(){return this.Pn.Ar}get Co(){return this.Pn.Co}get Kka(){return this.Pn.Kka}get Cr(){return this.Vb.Cr}get Hga(){return this.Pn.Hga}set Hga(a){this.Pn.Hga=a}get u6a(){return this.Pn.u6a}set u6a(a){this.Pn.u6a=a}get bOb(){return this.PAb||(this.PAb=la.a.instance.sa("Box4.List.ISingleLevelListEditor"))}sAk(a,
d,n,z){k.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const O=n.fa(Xc.a.WEe,!1);let ca=!1,Da=-1;!O||d.listStyle&&1!==d.gq||(ca=!n.fa(Xc.a.Qtg,!1),Da=n.fa(Xc.a.PIe,-1));a=this.c3b(a,d,!0,ca,Da,z,n);O||n.setValue(Xc.a.Qtg,2===a.action);3===a.action&&!n.hasProperty(Xc.a.PIe)&&a.lu&&n.setValue(Xc.a.PIe,a.lu.level)}merge(a,d,n,z=null){a=super.merge(a,d,n,z);this.nia();return a}ygj(a,d){this.IOk(a,d)}IOk(a,d){a=this.Vb.gye(a);const n=this.Vb.gye(d);-1!==a&&-1!==n&&(a-=
n,0<a?this.qtc.value.Eod(d,a):0>a&&this.qtc.value.yCa(d,a,0))}xnj(a){this.Vb.dC(a);this.leaveList(a);a.wg();uf.a.instance.J(3)&&this.nia()}YFn(a,d,n,z){var O=Dd.GraphIterator.ua(n);O=this.Uz(O);this.ZFn(O,a,d,n,z);Lb.App.A6a&&!ii.a.Oc.hV&&this.$Fn(n,z)}Uz(a){this.Vb.dC(a);const d=this.Hra(a.currentNode);a.hb();return d}Fmn(a,d){this.Vb.dC(a);a.currentNode.setValue(Qb.a.listID,d);d=this.Hra(a.currentNode);a.hb();return d}Hra(a){const d=new mv.a;if(uf.a.instance.J(3)){var n=this.Vb.PL(a,!1,!0);d.listID=
n.listId;d.level=n.je}else d.listID=a.fa(Qb.a.listID,0),d.level=a.fa(Qb.a.je,-1);d.lca=a.fa(Qb.a.lca,!1);this.Cr&&(n=this.cGc(a),d.bxj(n));d.gp=a.fa(ii.a.Oc.lA,wh.a.uh);d.Z6b=a.fa(ii.a.Oc.CM,wh.a.uh);return d}$yc(a,d){a||Ch.a.instance.mb("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});d||Ch.a.instance.mb("CrashWhenApplyingList",{["Reason"]:"RefInfoIsNull"});a.setValue(Qb.a.listID,d.listID);a.setValue(Qb.a.je,d.level);d.lca&&a.setValue(Qb.a.lca,!0)}jPj(a){this.Pn.C_(a);a=ko.Ze.kt(a);let d=a.fa(Qb.a.Co,
null);d=d?Array.clone(d):[];a.setValue(Qb.a.Co,d);this.Pn.mHb()}oGj(a){switch(a){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}JEl(a){a=a.view;if(!a.Oa||!a.Oa.ya)return null;a=$h.OutlineElementGeneralizer.Kla(a.Oa.ya,!1);if(1!==a.length)return null;a=Dd.GraphIterator.ua(a.getContext(0).node);if(!Bf.ListReader.Bh(a))if(14===a.Rc().type){const d=this.Pn.YTl(a.currentNode);d&&a.set(d)}else Ld.b(589177753,393,15,"Encountered an OE of non list type."),
a.hb();a.kc();return a}y2k(a,d,n,z){const O=a.dD(),ca=new mv.a;ca.listID=this.Mci(a);this.Mga?(ca.oGd=ii.a.Oc.t0?this.Nci(a):this.Fci(a),this.Jkj(a,ca.listID,ca.oGd)):this.Lkj(a,ca.listID);ca.k1g(d.propertySet,this.aGd(n));this.Qse(a);n=this.Czi(a,d);for(let Xa=0;9>Xa;Xa++){const zb=new Em.a;O.kd.Mu(zb);this.Kkj(a,this.Mga?E.a.nil:zb.id,this.Mga?zb.id:E.a.nil);this.zuk(zb,d.Zr,Xa);this.QUh(zb,n,Xa);var Da=z.TIb[Xa];Da=6===Da?$r.a.TR(1,1):$r.a.TR(0,Da);Da.Jga&&zb.setValue(Vd.a.rQ,Da.Jga);d.cA!==wh.a.uh&&
Xa===ca.level&&zb.setValue(Vd.a.JS,d.cA);z.hTa&&z.hTa[Xa]&&zb.setValue(Vd.a.font,z.hTa[Xa]);Da=z.NLc[Xa];k.ULS.shipAssertTag(22127636,338,!!Da);zb.setValue(Qb.a.fr,Da);zb.setValue(Qb.a.D4,z.sFd[Xa]);ru.a.Alc(z.s1,zb)}return ca}x2k(a,d,n){const z=a.dD(),O=new mv.a;O.listID=this.Mci(a);this.Mga?(O.oGd=ii.a.Oc.t0?this.Nci(a):this.Fci(a),this.Jkj(a,O.listID,O.oGd)):this.Lkj(a,O.listID);O.k1g(d.propertySet,this.aGd(n));if(!d.listStyle)switch(O.level%3){case 0:d.o5(d.listType,1);break;case 1:d.o5(d.listType,
2);break;case 2:d.o5(d.listType,3)}this.Qse(a);n=this.Czi(a,d);for(let ca=0;9>ca;ca++){const Da=new Em.a;z.kd.Mu(Da);this.Kkj(a,this.Mga?E.a.nil:Da.id,this.Mga?Da.id:E.a.nil);this.yuk(Da,d.Zr,ca);this.QUh(Da,n,ca);this.Cr&&(2===ca%3&&d.Zr?Da.setValue(Qb.a.D4,"right"):Da.setValue(Qb.a.D4,"left"));ca===O.level&&(d.Jga&&Da.setValue(Vd.a.rQ,d.Jga),d.cA!==wh.a.uh&&Da.setValue(Vd.a.JS,d.cA),this.Cr&&(d.Zr?this.Nxj(d,Da,ca):(ko.Kxj(d,Da),ko.Mxj(d,Da)),ko.Lxj(d,Da)),lw.a.rDd&&d.w8b&&Da.KR(d.propertySet,Qb.a.listID,
Qb.a.je))}return O}Nxj(a,d,n){a.Gsa?(a=a.levelText,a=w.a.replaceAll(a,"%1","%"+(n+1))):a=a.jJc||a.iga?a.levelText:"%"+(n+1)+".";k.ULS.shipAssertTag(22127638,338,!!a);d.setValue(Qb.a.fr,a)}NBj(a,d,n,z){if(a.jJc)return!1;if(1===a.gq)return z;if(z)return!0;if(d){z=a.listType===d.listType;const O=!a.listStyle&&a.cA===wh.a.uh;let ca=a.listStyle===d.listStyle&&a.cA===d.cA;this.Cr&&(a=(!a.Gsa||this.CYg(d,a))&&!n,ca=ca&&a);return z&&(O||ca)}return!1}Qse(a){this.Nrc||(this.Nrc=a.fa(Qb.a.Xei,null));this.o5d||
(this.o5d=a.fa(Qb.a.Wei,null));this.C_c||(this.C_c=a.fa(Qb.a.Yei,null))}aGd(a){720>a&&(a=0);a=Math.floor(a/720);0>a&&(a=0);8<a&&(a=8);return a}Lkj(a,d){const n=a.fa(Qb.a.Ar,null),z=n?n.length:0,O=Array(z+1);let ca=0;for(;ca<z;ca++)O[ca]=n[ca];O[ca]=d;a.setValue(Qb.a.Ar,O);this.Pn.mHb()}Jkj(a,d,n){this.kBf(Qb.a.Ar,a,d);if(ii.a.Oc.t0){this.kBf(Kr.a.Yfc,a,n);var z=this.Pn.eye(a);z.add(d,n);a.setValue(Kr.a.CY,KA.b(Nz.a.Mnc(z)))}else this.kBf(Qb.a.Kka,a,n),z=this.Pn.dye(a),z.add(d,n),a.setValue(Qb.a.BY,
KA.b(Nz.a.Mnc(z)))}Kkj(a,d,n){this.Mga?(this.IUh(Qb.a.Co,a,n),this.IUh(Qb.a.cha,a,d)):(n=(n=a.fa(Qb.a.Co,null))?Array.clone(n):[],n.push(d),a.setValue(Qb.a.Co,n),this.Pn.mHb())}kBf(a,d,n){const z=d.fa(a,null),O=z?z.length:0,ca=Array(O+1);let Da=0;for(;Da<O;Da++)ca[Da]=z[Da];ca[Da]=n;d.setValue(a,ca)}IUh(a,d,n){let z=d.fa(a,null);z=z?Array.clone(z):[];z.push(n);d.setValue(a,z)}yuk(a,d,n){var z=n%3+1;if(Bf.ListReader.Jq){const O=d?this.C_c:this.o5d;O&&n<O.length?a.setValue(Qb.a.Ny,O[n]):a.setValue(Qb.a.Ny,
360)}z=Bf.ListReader.V3?$r.a.TR(d?0:1,this.oGj(z),null,0,n):$r.a.TR(d?0:1,this.oGj(z));a.hn(z.propertySet);a.setValue(Qb.a.Dke,d?-1:-2);this.Cr&&(d?a.setValue(Qb.a.fr,"%"+(n+1)+"."):(a.setValue(Vd.a.font,this.Jxl(n)),a.setValue(Qb.a.fr,String.fromCharCode(this.Bxl(n)))),ru.a.Btb(2,a))}zuk(a,d,n){if(Bf.ListReader.Jq){const z=d?this.C_c:this.o5d;z&&n<z.length?a.setValue(Qb.a.Ny,z[n]):a.setValue(Qb.a.Ny,360)}a.setValue(Qb.a.Dke,d?-1:-2);ru.a.Btb(1,a)}Bxl(a){switch(a%3){case 0:return 61623;case 1:return 111;
case 2:return 61607;default:return 61623}}Jxl(a){switch(a%3){case 0:return"Symbol";case 1:return"Courier New";case 2:return"Wingdings";default:return"Symbol"}}Mci(a){if(this.Mga)this.Hga<wh.a.SLc&&this.Pn.C_(a),this.Hga=this.uAi(this.Ar,this.Hga,wh.a.SLc);else{if(this.Hga<wh.a.SLc&&(this.Pn.C_(a),this.Ar&&this.Co)){a=this.Ar.length;for(let d=0;d<a;d++)this.Ar[d]>=this.Hga&&(this.Hga=this.Ar[d])}this.Hga+=1}return this.Hga}Fci(a){this.u6a<wh.a.ffd&&this.Pn.C_(a);return this.u6a=this.uAi(this.Kka,this.u6a,
wh.a.ffd)}Nci(a){var d;this.Pn.C_(a);do a=Math.floor(Math.random()*(ko.Uum-ko.G4i))+ko.G4i;while(null===(d=this.Pn.hNc)||void 0===d?0:d.includes(a));return a}uAi(a,d,n){if(d<n&&a){n=a.length;for(let z=0;z<n;z++)a[z]>d&&(d=a[z])}d++;return d}wVg(a,d,n){ko.lEd||this.i3f(a,d,n,Object(m.a)(this,this.UVd,"siblingMatchesListAndLevel"),Object(m.a)(this,this.Fwn,"siblingRenumberSimple"))}J9m(a,d,n,z=!1){this.i3f(a,d,n,Object(m.a)(this,this.UVd,"siblingMatchesListAndLevel"),Object(m.a)(this,this.vDj,"siblingRenumberAndUpdateSublistsDelta"),
null,z)}I9m(a,d,n){this.ool(a,d,n,Object(m.a)(this,this.UVd,"siblingMatchesListAndLevel"),Object(m.a)(this,this.uDj,"siblingRenumberAndUpdateSublists"))}OUe(a,d,n){const z=Ch.a.instance.mm(Mb.a.OUe);1>Math.abs(n)&&Ch.a.instance.mb("PossiblyIncorrectListPromoteDemote",{["Reason"]:"DepthIsIncorrect"});(d<bn.a.Gue||d>bn.a.KFd)&&Ch.a.instance.mb("PossiblyIncorrectListPromoteDemote",{["Reason"]:"LevelHasInvalidRange"});(d+n<bn.a.Gue||d+n>bn.a.KFd)&&Ch.a.instance.mb("PossiblyIncorrectListPromoteDemote",
{["Reason"]:"Level+DepthHasInvalidRange"});const O={};let ca=null;const Da=this.Uz(a);const Xa=a.currentNode,zb=Da.listID,Vb=d+n;let Fc,Yc=wh.a.uh,yd=!0,je=!0,Le=!1;const Ve=Array(9);let gg=!1,Lh=!1;var Ki=new mv.a;Ki.listID=Da.listID;Ki.level=Da.level+n;Ki=this.Pn.$fa(a.currentNode,Ki);var Ak=this.Vb.ht(a);Ki=Ki.Zr;const Uk=Ak.Zr,Rl=this.Cr&&(Ki||Uk);if(Uk||Ki){var kk=new mv.a;kk.listID=Da.listID;kk.level=d;O[d.toString()]=this.WP(Xa,kk);Ak=O[d.toString()].C8;kk.level=Vb;O[Vb.toString()]=this.WP(Xa,
kk);Fc=O[Vb.toString()].C8;for(var dn=0;9>dn;dn++)Ve[dn]=!1;dn=new Dd.GraphIterator;dn.Cb(a);kk=dn.Dda();var fs=Yi.a.Yo(dn,kk);for(fs.moveNext();fs.moveNext();){dn=fs.iterator;var lp=void 0;let qr;if(dn.Bo(4)&&(kk=this.Uz(dn),kk.listID===zb)){var zt=this.Vb.ht(dn);var Ro=zt.Zr;kk.level<=Ak&&(yd=!1);kk.level<=Fc&&(je=!1);if(!yd&&!je)break;qr=kk.level.toString();O[qr]||(O[qr]=this.WP(Xa,kk));zt=O[qr];this.jTn(zt,Ve)||(zt.C8>=d?(ca||(ca=this.uOf(Da,a,O)),lp=wh.a.uh,ca[qr]?lp=!this.Cr||Ro?ca[qr]+1:wh.a.uh:
kk.level===Vb&&(lp=!this.Cr||Ro?zt.startAt:wh.a.uh),lp!==wh.a.uh?(kk.level!==Vb||Le||(Yc=lp,Le=!0,this.Vb.dC(dn),dn.hb(),lp++),this.u4b(dn,lp),ca[qr]=lp):Rl&&this.zdh(dn,kk)):zt.C8>=Vb?(ca||(ca=this.uOf(Da,a,O)),lp=Ve[kk.level]?!this.Cr||Ro?ca[qr]+1:wh.a.uh:!this.Cr||Ro?zt.startAt:wh.a.uh,this.Cr&&lp===wh.a.uh?Rl&&this.zdh(dn,kk):this.u4b(dn,lp),ca[qr]=lp):kk.level===d&&Uk||kk.level===Vb&&Ki?(this.Vb.dC(dn),lp=dn.currentNode,dn.hb(),lp=lp.getValue(ii.a.Oc.lA),Ro=lp===(zt.startAt===wh.a.uh?1:zt.startAt)+
1,kk.level===d?!(0>n)&&Ro||gg?gg=!0:lp--:(Lh?lp--:0>n&&Ro&&this.gpg(dn,zt,null)&&(lp--,Lh=!0),Le||(Yc=lp,Le=!0),lp++),this.u4b(dn,lp)):kk.level!==d&&kk.level!==Vb||!Rl||this.zdh(dn,kk),Ve[kk.level]=!0)}}Ki&&!Le&&(d=O[Vb.toString()],Da.level=Vb,Yc=this.FFd(Da,a,d).$sa,Yc===wh.a.uh?Yc=d.startAt:Yc++);Ki&&this.u4b(a,Yc)}z.end()}S_h(){this.nia()}nia(){var a=null,d,n;if(uf.a.instance.J(3)){var z=new Dd.GraphIterator;if(a)if(8===a.type)z.set(a);else{k.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");
return}else z.set(Lb.App.oa.za.jc),ko.Ze.J2e(z),a=ko.Ze.kt(z.currentNode);if(z.La(7)||z.tc(7)){z=Yi.a.Yo(z,z.origin);var O=new Pz(this.Pn,a);for(a=new Pz(this.Pn,a);z.moveNext();){var ca=z.iterator;if(!ca.Bo(4)&&!ca.Bo(31))continue;this.Vb.wJb(ca);const Xa=ca.currentNode;ca.hb();if(!Xa){k.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",ca.Yb);continue}if(!this.Mga&&63!==Xa.type&&this.Vb.QP(Xa).listType)continue;var Da=this.Vb.PL(Xa,!1,
!1);if(this.Mga&&Da&&this.Vb.jKc(Da.listId)){k.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",Da.listId);continue}const zb=Object(qa.a)(Vi.AParagraphNode,qe.OutlineElementNavigator.Sd(ca,!0));zb&&(zb.ja?(null==zb.ja.last&&k.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),ca.hb(),this.Mga&&this.Pn.C_(ca.currentNode),12===zb.type&&(zb.Nh&&zb.hC.hasProperty(Qb.a.listID)||null===(d=zb.ja.last)||void 0===d||
!d.Af)&&((ca=this.Vb.PL(Xa,!0,!0))?this.Pxj(Xa,a,ii.a.Oc.Mpc,ca):k.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",Xa.type)),!Da||null!==(n=zb.ja.last)&&void 0!==n&&n.Ue||!this.Pxj(Xa,O,ii.a.Oc.lA,Da)||(Da=Xa.getValue(ii.a.Oc.lA),this.Mga&&this.Vb.QP(Xa).listType||Xa.setValue(ii.a.Oc.CM,Da))):k.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else k.ULS.shipAssertTag(593234060,376,7===z.Yc,"Couldnt reach to page manifest node")}}Pxj(a,
d,n,z){n||k.ULS.shipAssertTag(571757918,393,!!n,"Prop definition is null");d=d.oEg(z.listId,z.je,this.Ja);z=-1;a.hasProperty(n)&&(z=a.getValue(n));return d===z||this.Mga&&63!==a.type&&this.Vb.QP(a).listType&&(!ii.a.Oc.zga||n!==ii.a.Oc.Mpc||1!==this.Vb.QP(a).listType)?!1:(a.setValue(n,d),!0)}zdh(a,d){this.Vb.dC(a);const n=a.currentNode;a.hb();n&&this.Vb.o0(n)&&this.k3f(a,d,Object(m.a)(this,this.nzg,"matchesListId"),Object(m.a)(this,this.E8g,"sublistsUpdateListItem"))}gpg(a,d,n){let z=!1,O=!0,ca=0;
const Da=this.Uz(a),Xa=a.currentNode;let zb=null;a=a.Dda();a=Yi.a.Ql(a);for(a.zj(su.a.Npb,null);a.moveNext();){const Vb=a.iterator.currentNode;if(Vb===Xa)break;if(!Bf.ListReader.rY(Vb))continue;const Fc=this.Uz(a.iterator);Fc.listID===Da.listID&&(Fc.level>Da.level?(z=!0,zb=Vb,ca++):Fc.level===Da.level?(O=!1,zb=null,ca=0):Fc.level<=d.C8&&(O=!0,zb=null,ca=0))}return z&&O&&(!n||1===ca&&zb===n)}jTn(a,d){for(a=a.C8;0<=a;a--)if(d[a])return!0;return!1}u4b(a,d){this.Vb.dC(a);const n=a.currentNode;a.hb();
const z=this.Uz(a);z&&this.Pn.TLc(n,z.listID,z.level)?this.I9m(a.currentNode,z,d):ko.lEd||(n.setValue(ii.a.Oc.lA,d),n.setValue(ii.a.Oc.CM,d))}K9m(a,d,n){const z={};let O=null;const ca=new Dd.GraphIterator;const Da=a.gp===d.startAt;let Xa=!1;var zb=new Dd.GraphIterator;zb.Cb(n);var Vb=n.Dda();Vb=Yi.a.Yo(zb,Vb);Vb.zj(su.a.Npb,null);Vb.moveNext();let Fc=!1;for(;Vb.moveNext();)if(ca.Cb(Vb.iterator),ca.Bo(4)){var Yc=this.Uz(ca);if(Yc.listID===a.listID)if(Yc.level>a.level)Xa=!0,zb=Yc.level.toString(),z[zb]||
(z[zb]=this.WP(n.currentNode,Yc)),Yc=z[zb].C8,Yc===a.level&&(O||(O=this.uOf(a,n,z)),O[zb]&&(Yc=O[zb]+1,this.u4b(ca,Yc),O[zb]=Yc));else if(Yc.level===a.level||Yc.level<=d.C8){Fc=!0;break}}return!Fc||Da&&Xa?null:ca}H9m(a){Bf.ListReader.Bh(a)||Ch.a.instance.mb("PossiblyIncorrectListRenumber",{["Reason"]:Kw.a.cza});const d=this.Uz(a);var n=this.WP(a.currentNode,d);const z=a.Va(4);z.removeProperty(ii.a.Oc.Mpc);a.hb();const O=this.hsd(a,d,Object(m.a)(this,this.D8g,"sublistsEnsureSameList"),Object(m.a)(this,
this.zGj,"sublistsUpdateLevel"));if(this.Vb.ht(a).Zr){var ca=null;O&&(ca=this.Uz(O));ca&&ca.listID===d.listID&&ca.level===d.level?n=this.Vb.ht(O).gp:(ca=this.FFd(d,a,n),n=ca.$sa===wh.a.uh?n.startAt:ca.$sa+1);n!==wh.a.uh&&(z.setValue(ii.a.Oc.lA,n),z.setValue(ii.a.Oc.CM,n));O&&this.wVg(O.currentNode,d,1)}a.D$b(11,23)&&Bf.ListReader.Bh(a)&&(a=this.Vb.ht(a),a.Zr&&(a.O3=a.gp))}get tBj(){return this.Cr}Gzi(a){const d=this.Vb.ht(a);if(this.Cr){d.w8b=!0;this.Vb.dC(a);const n=a.currentNode.fa(Qb.a.listID,
0);d.propertySet.setValue(Qb.a.listID,n);a.tc(11)}return d}uOf(a,d,n){const z={},O=new Dd.GraphIterator,ca=d.currentNode;var Da=d.Dda();const Xa=Yi.a.Ql(Da);for(Xa.zj(su.a.Npb,null);Xa.moveNext();){O.Cb(Xa.iterator);if(O.currentNode===ca)break;if(O.Bo(4)&&(Da=this.Uz(O),Da.listID===a.listID)){if(Da.level>a.level){this.Vb.dC(O);var zb=O.currentNode;O.hb();z[Da.level.toString()]=zb.fa(ii.a.Oc.lA,wh.a.uh)}for(zb=Da.level;zb<=bn.a.KFd;zb++){const Vb=zb.toString();z[Vb]&&(n[Vb]||(n[Vb]=this.WP(d.currentNode,
Da)),n[Vb].C8>=Da.level&&delete z[Vb])}}}return z}FFd(a,d,n){const z=new Dd.GraphIterator,O=d.currentNode;let ca;var Da=wh.a.uh;let Xa=!1,zb=!1,Vb=!1,Fc=null;var Yc=d.Dda();Yc=Yi.a.Ql(Yc);for(Yc.zj(su.a.Npb,null);Yc.moveNext();){z.Cb(Yc.iterator);if(z.currentNode===O)break;Xa=!1;z.Bo(4)&&(ca=this.Uz(z),ca.listID===a.listID&&(ca.level===a.level?(this.Vb.dC(z),Da=z.currentNode,z.hb(),Da=Da.fa(ii.a.Oc.lA,wh.a.uh),Xa=!0,Fc=z.Pvb(1),zb=!0):ca.level>a.level?Vb=!0:ca.level<=n.C8&&(Da=wh.a.uh,Vb=zb=!1)))}!zb&&
Vb&&(Da=n.startAt);Xa&&(Xa=d.Pvb(1)===Fc);a=new Oz;a.$sa=Da;a.uSj=Xa;return a}Cpj(a,d=!1,n=0){const z=this.Hra(a),O=this.WP(a,z),ca=this.Pn.$fa(a,z);var Da=new Dd.GraphIterator;const Xa=ca.Zr;let zb=O.startAt,Vb=!1,Fc=!1;k.ULS.shipAssertTag(22127639,338,ca.iga,"Info does not have a level Text. ListNode.LevelText = {0}",a.fa(Qb.a.fr,null));const Yc=ca.listStyle;Da.set(a);if(Da.kc()&&(a=Da.vha()))for(a=Yi.a.Ql(a),a.zj(su.a.Npb,z);a.moveNext();){Da=a.iterator.currentNode;if(!Bf.ListReader.rY(Da))continue;
var yd=this.Uz(a.iterator);d&&yd.listID===n&&(yd=this.Fmn(a.iterator,z.listID));if(yd.listID!==z.listID)continue;const je=a.iterator.Va(4);je&&a.iterator.hb();yd.level>z.level?(this.Pn.TLc(je,z.listID,yd.level)&&this.vlg(Da,je),Fc=!0):(yd.level<=O.C8?(zb=O.startAt,Fc=Vb=!1):(yd=this.v5i(a,Yc),this.Cr&&yd.currentNode.setValue(Qb.a.fr,ca.cGd),{huj:Vb,$sa:zb}=this.Epj(Xa,Fc,Vb,yd,zb,Da)),ko.MOi(a))}}vlg(a,d){k.ULS.shipAssertTag(22819227,338,!!a&&!!d);Bf.ListReader.lna?d.setValue(eg.a.YIe,E.a.create().toString()):
a.setValue(eg.a.YIe,E.a.create().toString())}F9m(a){if(!ii.a.Oc.Zob){var d=this.Hra(a),n;this.WP(a,d);var z=this.Pn.$fa(a,d),O=z.Zr,ca=Array(10),Da=Array(10),Xa=null;k.ULS.shipAssertTag(22127640,338,z.iga,"Info does not have a level Text. ListNode.LevelText = {0}",a.fa(Qb.a.fr,null));var zb=z.listStyle;var Vb=new Dd.GraphIterator;Vb.set(a);if(Vb.kc()&&(Vb=Vb.vha()))for(Vb=Yi.a.Ql(Vb),Vb.zj(su.a.Npb,d);Vb.moveNext();){var Fc=Vb.iterator.currentNode;if(!Bf.ListReader.rY(Fc))continue;const Yc=this.Uz(Vb.iterator);
if(Yc.listID!==d.listID)continue;(n=Vb.iterator.Va(4))&&Vb.iterator.hb();const yd=Yc.level;Xa=Xa?Xa.level:-1;d=this.Hra(n);n=this.WP(n,d);this.vlg(Fc,a);if(Xa<yd||void 0===ca[yd]||null===ca[yd])ca[yd]=n.startAt,Da[yd]=!1;n=this.v5i(Vb,zb);n.currentNode.setValue(Qb.a.fr,z.cGd);({huj:Da[void 0],$sa:ca[void 0]}=this.Epj(O,Xa>yd,Da[yd],n,ca[yd],Fc));Xa=Yc;ko.MOi(Vb)}}}v5i(a,d){a=a.iterator;this.Vb.dC(a);ii.a.Oc.Zob||this.lmn(a.currentNode,d);return a}Epj(a,d,n,z,O,ca){a?(d&&!n&&O++,qe.OutlineElementNavigator.Uc(z),
this.u4b(z,O),O++,n=!0,Bf.ListReader.Jq&&(z.Va(2),Wy.a.qKc(z.currentNode)&&z.currentNode.Fi(4,!0))):(z.currentNode.removeProperty(ii.a.Oc.lA),qe.OutlineElementNavigator.Uc(z));ca.Fi(4,!0);(a=z.ul(16))&&a.Fi(8,!0);return{huj:n,$sa:O}}lmn(a,d){a.setValue(Qb.a.listStyle,d)}WP(a,d){const n=Ch.a.instance.mm(Mb.a.WP),z=new En;(a=this.Pn.ww(a,d.listID,d.level))?(z.C8=a.fa(Qb.a.$Qc,d.level-1),z.startAt=a.fa(Vd.a.JS,1)):Ch.a.instance.mb("PossiblyIncorrectListRestartValue",{["Reason"]:"listPropsIsNull"});n.end();
return z}k4k(a){const d=Tr.a.instance.createInstance(1074135151);a.Re(d,31)}ZFn(a,d,n,z,O){const ca=this.createList(d);d.hb();this.$yc(ca,a);d=this.Pn.$fa(d.currentNode,a);d.listType||(ca.setValue(ii.a.Oc.lA,a.gp),ca.setValue(ii.a.Oc.CM,a.Z6b),this.PUe(ca,a,n?z:O,1));switch(d.listType){case 0:n="Numbering";break;case 1:n="Bullet";break;default:n="Invalid List Type"}l.AFrameworkApplication.pa.processAction(Mb.a.joinList,2);k.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",n);Bf.ListReader.V3&&
(ca.setValue(Qb.a.listID,a.listID),ca.setValue(Qb.a.je,a.level))}$Fn(a,d){a=Dd.GraphIterator.ua(a).Va(4);d=Dd.GraphIterator.ua(d).Va(4);a.hasProperty(Vd.a.fontColor)&&d.setValue(Vd.a.fontColor,a.getValue(Vd.a.fontColor));a.hasProperty(Vd.a.fontSize)&&d.setValue(Vd.a.fontSize,a.getValue(Vd.a.fontSize));a.hasProperty(Vd.a.font)&&d.setValue(Vd.a.font,a.getValue(Vd.a.font));a.hasProperty(Qb.a.PV)&&d.setValue(Qb.a.PV,a.getValue(Qb.a.PV));a.hasProperty(Vd.a.bold)&&d.setValue(Vd.a.bold,a.getValue(Vd.a.bold));
a.hasProperty(Vd.a.italic)&&d.setValue(Vd.a.italic,a.getValue(Vd.a.italic));a.hasProperty(Vd.a.superscript)&&d.setValue(Vd.a.superscript,a.getValue(Vd.a.superscript));a.hasProperty(Vd.a.subscript)&&d.setValue(Vd.a.subscript,a.getValue(Vd.a.subscript));a.hasProperty(Vd.a.strikethrough)&&d.setValue(Vd.a.strikethrough,a.getValue(Vd.a.strikethrough))}rnj(a){if(uf.a.instance.J(10)){var d=this.gb.im(a);d?this.gb.Jd(d)===Gh.StyleReader.wordStyleIdListParagraph&&(d=this.gb.rz(a),this.Wha.hT(d.Mf(Gh.StyleReader.wordStyleIdNormal),
a,!0,!1,!1,this.Ffb&&l.AFrameworkApplication.K.ea("WordEditorSkipTrackingChangeForList"))):k.ULS.shipAssertTag(8271188,315,!1)}}fmn(a){if(uf.a.instance.J(10)){if(this.gb.Jd(this.gb.im(a))===Gh.StyleReader.wordStyleIdNormal){const d=this.gb.rz(a);this.Wha.hT(d.Mf(Gh.StyleReader.wordStyleIdListParagraph),a,!0,!0)}a.oe(Qb.a.Oj,Qb.a.lM,Qb.a.QE,Qb.a.N0,Qb.a.Ny,Qb.a.gha);a.setValue(Qb.a.dKa,0)}}oPk(a,d){const n=a.getValue(Qb.a.listID),z=a.getValue(Qb.a.je);for(let ca=0;9>ca;ca++){const Da=this.Pn.ww(a,
n,ca);if(!Da)return Ch.a.instance.mb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),null;var O=d.TIb[ca];O=6===O?$r.a.TR(1,1):$r.a.TR(0,O);O.Jga&&Da.setValue(Vd.a.rQ,O.Jga);Da.hasProperty(Vd.a.font)&&Da.removeProperty(Vd.a.font);d.hTa&&d.hTa[ca]&&Da.setValue(Vd.a.font,d.hTa[ca]);O=d.NLc[ca];k.ULS.shipAssertTag(22127641,338,!!O);Da.setValue(Qb.a.fr,O);Da.setValue(Qb.a.gq,ru.a.tqb);ru.a.Alc(d.s1,Da);Da.setValue(Qb.a.D4,d.sFd[ca]);Da.oe(Qb.a.$Qc,Vd.a.JS);this.jPj(a)}this.F9m(a);a=new mv.a;
a.listID=n;a.level=z;return a}D5h(a,d,n,z=null){if(this.Cr&&z)return this.oPk(a,z);z=a.getValue(Qb.a.listID);const O=a.getValue(Qb.a.je),ca=this.Pn.ww(a,z,O);if(!ca)return Ch.a.instance.mb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),d&&k.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",d.listStyle,d.listType,z,O),null;lw.a.rDd&&d.w8b&&(ca instanceof ny.APropertySet?ca.KR(d.propertySet,Qb.a.listID,Qb.a.je):k.ULS.sendTraceTag(527991759,
393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===ca||void 0===ca?void 0:ca.constructor.name));var Da=ca.fa(Qb.a.gq,null);Da&&Da===ru.a.tqb&&this.nPk(a,z);if(!d.listStyle){Da=0;if(-1!==n){for(Da+=O-n;0>Da;)Da+=3;Da%=3}switch(Da){default:n=1;break;case 1:n=2;break;case 2:n=3}d.o5(d.listType,n)}d.Jga&&ca.setValue(Vd.a.rQ,d.Jga);this.Cr&&(d.Zr?(this.Nxj(d,ca,O),ca.hasProperty(Vd.a.font)&&ca.removeProperty(Vd.a.font)):(ko.Kxj(d,ca),ko.Mxj(d,ca)),ko.Lxj(d,ca));
ca.oe(Qb.a.$Qc,Vd.a.JS,Qb.a.XHb);this.jPj(a);ii.a.Oc.Zob||this.Cpj(a);a=new mv.a;a.listID=z;a.level=O;return a}nPk(a,d){let n;for(let z=0;9>z;z++){n=this.Pn.ww(a,d,z);if(!n){k.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",d,z);break}n.setValue(Qb.a.gq,ru.a.qac);n.removeProperty(bd.a.Psa)}}eUd(a,d){const n=Ch.a.instance.mm(Mb.a.eUd);this.qtc.value||Ch.a.instance.mb("PossibleIncorrectListIndentation",{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.keb?
(n.properties.$("PendingListInfo","true"),Bf.ListReader.Bh(a)&&(n.properties.$("RemoveCurrentListInfo","true"),this.Ffb=!0,this.cRa(a,null,!0,!1,-1),this.qtc.value.yCa(a,-1,0),this.Ffb=!1),this.c3b(a,this.keb,!1,!0,-1,!1,null,Bf.ListReader.V3),this.keb=null):d||(n.properties.$("CurrentlyUnderPastedList","true"),this.cRa(a,null,!1,!1,-1));n.end()}MXe(a,d,n,z){const O=Ch.a.instance.mm(Mb.a.MXe);if(Bf.ListReader.Bh(a)&&Ia.OutlineElementReader.isEmpty(a,!1))this.qtc.value.qKf(a,-1)?this.qtc.value.yCa(a,
-1,0):this.cRa(a,null,!1,!1,-1);else{const ca=!n.cpBegin,Da=n.cpBegin===Bd.ParagraphReader.textLength(z),Xa=uf.a.instance.J(4)&&Lb.App.lc.eq;let zb=!0;Xa&&ca&&!Da?(zb=!1,z=new Dd.GraphIterator,z.Cb(a),z.kc(),this.Ee.BE(z,!0,!1)):z=this.Ee.EIa(a);this.Ee.voa(a,z,n,!1,!0,zb,!1,d);!Xa||ca||Da||(d=ko.jg.ztd(n),Lb.App.lc.Mp.MJ(d));this.Ffb||(qe.OutlineElementNavigator.Sd(a),d=a.currentNode,qe.OutlineElementNavigator.Uc(a),Bf.ListReader.Bh(a)&&d.Nh&&!d.hC.hasProperty(Qb.a.listID)&&(qe.OutlineElementNavigator.Sd(z),
a=z.currentNode,z=new Em.a,a.Ib.Mu(z),this.tf.d1(a,z,this.Eb.Jf)),this.nia())}O.end()}OYe(a,d){var n;if(Bf.ListReader.Bh(a))return!1;a.Va(2);var z=qf.a.eGk;const O=[!0,!1].map(ca=>Bd.ParagraphReader.qh(a.currentNode,ca,void 0,!1));a.hb();for(let ca=0;ca<O.length;ca++){const Da=O[ca];if(Da&&!Bf.ListReader.Hma(Da))for(const Xa of z)if(Xa.test(Da.characterData))return z=null===(n=Xa.exec(Da.characterData))||void 0===n?void 0:n[0],this.E0m(d,ca?"nextPara":"prevPara",z),!1}return!0}E0m(a,d,n){const z=
new Map;z.set("CurrentAutoListPreventedAutoListText",a);z.set("UndoAutoListPreferenceFoundIn",d);z.set("UndoAutoListPreferenceAutoListText",n);ja.Health.instance.recordKpiUsage(wh.a.kIe.umj,0,wh.a.aH,z)}ttn(a,d){return a&&d}lUg(a){for(let d=0;d<a.count;d++){const n=Dd.GraphIterator.ua(a.J(d));n.tn();this.Gta(n)}a.clear()}Dpj(a){if(Bf.ListReader.rY(a)){if(!ko.lEd){const d=new Dd.GraphIterator;d.set(a);d.kc();this.H9m(d)}this.nia()}}uRg(a,d){a=new Dd.GraphIterator;a.set(d);a.kc();qe.OutlineElementNavigator.Uc(a);
a.Vra(d)||Ch.a.instance.mb("PossibleLossOfDirectFormatting",{["Reason"]:"OeDoesNotContainParagraph"});this.cRa(a,null,!0,!1,-1);return super.uRg(a,d)}Gxj(a,d,n){this.Ee.RKa(a,d,n,!0)}Jxj(a){a.o5(1,1)}Lje(a,d){const n=Ch.a.instance.mm(Mb.a.eZh);if(this.gb.Iy(d.Be())){if(Bf.ListReader.Bh(a)&&this.c3b(a,null,!0,!1,-1),d=this.Pn.jye(d)){n.properties.$("EarlyReturn","False");this.Pn.$fa(a.currentNode,d);var z=$n.Lkl(this,a,d),O=this.createList(a);a.hb();if(z)this.joinList(O,z,!0);else{if(z=this.hsd(a,
d,Object(m.a)(this,this.D8g,"sublistsEnsureSameList"),Object(m.a)(this,this.zGj,"sublistsUpdateLevel"))){const ca=this.Uz(z);if(ca.listID===d.listID&&ca.level<d.level&&this.Vb.ht(z).Zr){const Da=this.WP(z.currentNode,ca);ca.gp===(Da.startAt===wh.a.uh?1:Da.startAt)&&(ca.Z6b=ca.gp,this.PUe(O,ca,z.currentNode,1))}}z=this.WP(O,d);a=this.FFd(d,a,z);a=a.$sa!==wh.a.uh?a.$sa+1:z.startAt===wh.a.uh?1:z.startAt;this.$yc(O,d);O.setValue(ii.a.Oc.lA,a);O.setValue(ii.a.Oc.CM,a)}O.setValue(Qb.a.lca,!0);n.end()}}else Ch.a.instance.mb("PossiblyIncorrectListStyle",
{["Reason"]:"StyleContainerNotValid"})}PUe(a,d,n,z,O=!1){this.Pn.TLc(a,d.listID,d.level)?this.J9m(n,d,z,O):this.wVg(n,d,z)}gZh(a,d,n,z,O=null){a=this.Cr&&O?this.y2k(a,n,z,O):this.x2k(a,n,z);this.$yc(d,a);n.listType||(z=n.cA,z===wh.a.uh&&(z=1),d.setValue(ii.a.Oc.lA,z),d.setValue(ii.a.Oc.CM,z));this.Cr&&(n.iga?(n=n.levelText,O||(n=n.replace("%1","%"+(a.level+1))),d.setValue(Qb.a.fr,n)):(k.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string."),d.setValue(Qb.a.fr,
"")));return a}leaveList(a){const d=this.Hra(a.currentNode);var n=this.Pn.$fa(a.currentNode,d);const z=new Dd.GraphIterator;z.Cb(a);z.hb();Bf.ListReader.Bh(z)||Ch.a.instance.mb("PossibleErrorInLeaveList",{["Reason"]:Kw.a.cza});var O=this.WP(z.currentNode,d),ca=d.gp===O.startAt;Bf.ListReader.lna&&ko.c7l(z);if(O=this.K9m(d,O,z)){const Da=this.Vb.ht(O);Da.O3=Da.Zr?Da.gp:wh.a.uh}n.Zr&&O&&this.PUe(a.currentNode,d,O.currentNode,-1);ca&&O&&(n=this.Uz(O),this.Pn.$fa(O.currentNode,n).Zr&&(ca=this.WP(O.currentNode,
n),n.gp===(ca.startAt===wh.a.uh?1:ca.startAt)+1&&this.gpg(O,ca,z.currentNode)&&this.PUe(a.currentNode,d,O.currentNode,-1,!0)));!O&&this.Pn.TLc(a.currentNode,d.listID,d.level)&&this.k3f(z,d,Object(m.a)(this,this.nzg,"matchesListId"),Object(m.a)(this,this.E8g,"sublistsUpdateListItem"))}joinList(a,d,n,z=null){let O=null,ca=null;if(a)if(22!==a.type&&63!==a.type)k.ULS.sendTraceTag(587851670,393,15,"Graph node {0} received is not list node : skipping join list action.",a.type);else{uf.a.instance.J(3)&&
(O=this.Pn.Q4a(a),ca=O.TB());(uf.a.instance.J(3)||ii.a.Oc.ZHb)&&this.$yc(a,d.lu);if(this.Pn.$fa(a,d.lu).Zr){var Da=new Dd.GraphIterator;Da.set(a);Da.kc();Da.hb();let Xa=null;ii.a.Oc.NTi&&z&&!z.aGn&&(Xa=this.Pn.C$f(Da.currentNode,d.lu));const zb=this.Pml(Da,d,z);Da=this.Gml(Da,a,d,n,z,zb);this.Lml(d,n,z,zb,Da);Xa&&zb&&this.wVg(Xa,d.lu,this.oim(zb,Xa)-(d.lu.gp-1))}uf.a.instance.J(3)||ii.a.Oc.ZHb||this.$yc(a,d.lu);uf.a.instance.J(3)&&O&&ca&&!this.Ffb&&(this.tf.d1(O,ca,this.Eb.Jf),this.nia())}else k.ULS.sendTraceTag(587747659,
393,15,"List node received is null : skipping join list action.")}oim(a,d){let n=0;const z=this.Uz(a),O=new Dd.GraphIterator;O.set(a.currentNode);O.kc();a=$s.a.Yo(O,O.Dda());for(a.zj(su.a.Npb,null);a.moveNext();){if(!Bf.ListReader.Bh(O))continue;this.Vb.dC(O);const ca=this.Hra(O.currentNode);O.hb();if(O.currentNode.id===d.id)break;ca.listID===z.listID&&ca.level===z.level&&n++}return n}Pml(a,d,n){if(d.lSi)d=d.outlineElement;else{let z,O;n?(z=Object(m.a)(this,this.yGj,"sublistsEnsureSameListAsOriginal"),
O=Object(m.a)(this,this.e0e,"sublistsUpdateId")):d.iJc?(z=Object(m.a)(this,this.D8g,"sublistsEnsureSameList"),O=Object(m.a)(this,this.e0e,"sublistsUpdateId")):(z=Object(m.a)(this,this.AAn,"sublistsEnsureLevelHigherThanOrEqualTo"),O=Object(m.a)(this,this.BAn,"sublistsUpdateLevelAndId"));d=this.hsd(a,d.lu,z,O,n)}!d&&n&&(n=new Dd.GraphIterator,n.Cb(a),n.D$b(11,23)&&Bf.ListReader.Bh(n)&&(d=n));return d}Gml(a,d,n,z,O,ca){z?(O?a=O.zTc:(ca=this.WP(d,n.lu),n=this.FFd(n.lu,a,ca),a=n.$sa!==wh.a.uh?n.$sa+1:
ca.startAt===wh.a.uh?1:ca.startAt),d.setValue(ii.a.Oc.lA,a),d.setValue(ii.a.Oc.CM,a)):(a=wh.a.uh,this.Kmn(d,ca,n));return a}Lml(a,d,n,z,O){if(z){var ca=!1,Da=this.Uz(z),Xa=Da.level===a.lu.level,zb=!!n&&Da.listID===n.pLd;(Da.listID===a.lu.listID||zb)&&Xa&&(Xa=this.WP(z.currentNode,Da),zb=Xa.startAt===wh.a.uh?1:Xa.startAt,Da.gp===zb+1&&(ca=d?O===zb:this.gpg(z,Xa,null)));if(!ca||n)n?(d=n.delta,O=Object(m.a)(this,this.Dwn,"siblingMatchesLevel"),ca=Object(m.a)(this,this.Ewn,"siblingRenumberAndUpdateListID")):
(d=1,O=Object(m.a)(this,this.UVd,"siblingMatchesListAndLevel"),ca=Object(m.a)(this,this.vDj,"siblingRenumberAndUpdateSublistsDelta")),Da=new Dd.GraphIterator,Da.set(z.currentNode),Da.kc(),this.Vb.dC(Da),Da.hb(),this.i3f(z.currentNode,a.lu,d,O,ca,n)}}Kmn(a,d,n){let z=null;d&&(z=this.Uz(d));if(z&&z.listID===n.lu.listID&&z.level===n.lu.level){const O=this.Vb.ht(d);let ca=O.gp;a.setValue(ii.a.Oc.lA,ca);a.setValue(ii.a.Oc.CM,ca);Bf.ListReader.V3&&(O.propertySet.setValue(Qb.a.listID,z.listID),O.propertySet.setValue(Qb.a.je,
z.level));if(!n.iJc||n.CMe)n.lSi&&!n.CMe&&(this.Vb.dC(d),a=d.currentNode,qe.OutlineElementNavigator.Uc(d)),a.setValue(ii.a.Oc.CM,a.getValue(ii.a.Oc.lA))}else d=n.lu.gp+1,a.setValue(ii.a.Oc.lA,d),a.setValue(ii.a.Oc.CM,d)}cRa(a,d,n=!0,z=!1,O=-1){this.c3b(a,d,n,z,O)}c3b(a,d,n=!0,z=!1,O=-1,ca=!1,Da=null,Xa=!1){const zb=Ch.a.instance.mm(Mb.a.c3b),Vb=new Dx;Vb.lu=null;Vb.action=0;if(!Ia.OutlineElementReader.gg(a))return Ch.a.instance.mb("PossibleListStateNotUpdated",{["Reason"]:Kw.a.hra}),zb.end(),k.ULS.sendTraceTag(578331469,
393,15,"Iterator not pointing to OE in apply list info word."),Vb;let Fc=-1,Yc;Yc=Ia.OutlineElementReader.b4(a);var yd=ko.Ze.kt(a.currentNode);const je=a.Va(2);let Le=!1,Ve=null;if(je&&Bd.ParagraphReader.nb(je)&&(Le=!0,Ve=je,Fc=this.Ck.x7(a.currentNode).pu-this.Ck.ML(je).pu,Lj.a(je,8)))return zb.end(),k.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),Vb;let gg=null;if(uf.a.instance.J(3)&&12===je.type){if(Ve.ja.last.Ue)return k.ULS.sendTraceTag(578331471,
393,15,"User applied list to para with deleted EOP."),Vb;gg=Ve.TB()}qe.OutlineElementNavigator.Uc(a);var Lh=Ia.OutlineElementReader.$Ha(a);const Ki=Ia.OutlineElementReader.ML(a),Ak=Ia.OutlineElementReader.b4(a);let Uk=null,Rl=null;d&&(Uk=d.yz,Rl=this.infoAtLevel(a,d));let kk=a.Va(4);kk?d&&16!==d.listType?(this.D5h(kk,Rl,O,Uk,!!Da&&Da.hasProperty(Xc.a.$Le)),a.hb(),Vb.action=3,Vb.lu=this.Uz(a)):(Le&&(this.rnj(Ve),this.K6m(Ve),Ve.Faa=null),z=this.Vb.jKc(kk.fa(Qb.a.listID,0)),!ii.a.Oc.zga||z?(kk.dZe=
!1,this.leaveList(a),a.wg()):a.hb(),n&&Le&&(this.Qse(yd),yd=Lh+(Ak?Ak:-1*Ki)-this.C_c[0],yd=0>yd?0:yd,this.Ee.RKa(a,1,yd)),ii.a.Oc.zga&&a.Va(4)&&(kk.dZe=!1,this.leaveList(a),a.wg()),Vb.action=1,Vb.lu=null,Ve&&(this.Eb.Jf&&!this.Ffb||ii.a.Oc.zga&&!this.Eb.Jf&&Ve.Nh)&&(!Ve.Nh||Ve.hC&&Ve.hC.hasProperty(Qb.a.listID))&&this.k4k(a)):d&&16!==d.listType&&(n=-1,Lh=d.propertySet.fa(Qb.a.listID,-1),Bf.ListReader.V3&&Xa&&0<Lh&&Lh+""in this.gMg&&(n=this.gMg[Lh+""]),d=d.Lqb?new $n(this,Dd.GraphIterator.ua(d.Lqb),
!1,!0):$n.Kkl(this,a,Rl,Xa,ca),this.Z1l(a,Rl,z,Xa,d),kk=this.$1k(a),this.Cr&&this.Lkn(d,Rl),Le&&!ii.a.Oc.hV&&this.KXe(kk,je,Da),void 0===d||null===d||ca||Rl.Zr!==this.Vb.$fa(kk,d.lu).Zr?this.V9l(Rl,n,d,kk)?(this.zNn(Rl,kk,n,Fc),Vb.action=3,Vb.lu=this.D5h(kk,Rl,-1,Uk)):(Vb.action=4,0<Yc&&(Fc+=Yc),Vb.lu=this.gZh(yd,kk,Rl,Fc,Uk),this.rNn(n,Lh,Vb.lu,kk)):(Vb.action=2,Vb.lu=d.lu,Rl.listStyle||(d.iJc=!0),this.nim(n,Vb.lu,kk,d)),Le&&this.fmn(je),a.hb());uf.a.instance.J(3)&&!this.Ffb&&(Ve&&gg&&this.tf.d1(Ve,
gg,this.Eb.Jf),this.nia());zb.end();return Vb}$1k(a){ii.a.Oc.zga&&a.Va(31)&&a.wg();return this.createList(a)}K6m(a){a.hasProperty(Qb.a.Oj)&&a.removeProperty(Qb.a.Oj);a.hasProperty(Qb.a.QE)&&a.removeProperty(Qb.a.QE);a.hasProperty(Qb.a.Ny)&&a.removeProperty(Qb.a.Ny)}infoAtLevel(a,d){if(!d)return null;const n=d.yz;if(this.Cr)if(1===d.gq){if(d.Gsa&&!d.mD||!d.Gme(!1))return d;let z;a=Ia.OutlineElementReader.$Ha(a);z=this.aGd(a);const O=n.TIb[z];a=$r.a.QR(d.propertySet,d.propertySet);6===O?a.o5(1,1):a.o5(0,
O);a.fUd("multilevel");a.levelText=n.NLc[z];n.hTa&&n.hTa[z]&&(a.font=n.hTa[z]);a.Kt=n.sFd[z];a.s1=n.s1;a.sGd=d.sGd}else a=d;else a=d;return a}Lkn(a,d){a&&a.lu&&(d.levelText=a.lu.levelText,d.Zr||(d.font=a.lu.font))}Z1l(a,d,n,z,O){if(n&&O){n=Ia.OutlineElementReader.$Ha(a);if(this.Cr){var ca=Ia.OutlineElementReader.b4(a);0<ca?n+=ca:(ca=Ia.OutlineElementReader.ML(a),0<ca&&(n-=ca))}d=d.propertySet.fa(Qb.a.je,-1);O.lu.level=z&&0<=d?d:this.aGd(n);this.Pn.$fa(a.currentNode,O.lu).listType||(z=this.WP(a.currentNode,
O.lu),a=this.FFd(O.lu,a,z),O.lu.Z6b=O.lu.gp=a.$sa===wh.a.uh?z.startAt-1:a.$sa,O.iJc=a.uSj)}else O&&O.lu&&d.propertySet&&d.propertySet.hasProperty(Qb.a.je)&&(O.lu.level=d.propertySet.getValue(Qb.a.je))}rNn(a,d,n,z){Bf.ListReader.V3&&(0>=a?this.gMg[d+""]=n.listID:(z.properties.setValue(Qb.a.listID,a),n.listID=a))}zNn(a,d,n,z){d.properties.setValue(Qb.a.listID,n);d.properties.hasProperty(Qb.a.je)||(n=a.propertySet&&a.propertySet.hasProperty(Qb.a.je)?a.propertySet.Se(Qb.a.je):this.aGd(z),d.properties.setValue(Qb.a.je,
n),this.Cr&&(a.propertySet&&a.iga&&(n=a.levelText.replace("%1","%"+(n+1)),d.setValue(Qb.a.fr,n)),a.propertySet&&a.wGb&&!ii.a.Oc.hV&&d.setValue(Vd.a.font,a.font)))}nim(a,d,n,z){if(Bf.ListReader.V3){let O=null;0<a&&(O=new nv(0,d,-1),O.pLd=a,O.delta=-1);this.joinList(n,z,!1,O)}else this.joinList(n,z,!1)}V9l(a,d,n,z){return!Bf.ListReader.V3||0>=d?!1:void 0===n||null===n?(n=a.propertySet.fa(Qb.a.je,-1),0<=n&&(d=this.Pn.ww(z,d,n))&&(d=d.fa(Vd.a.rQ,null))?a.Jga!==d:!1):a.Zr!==this.Vb.$fa(z,n.lu).Zr||a.Jga!==
this.Vb.$fa(z,n.lu).Jga}J6m(a,d){const n=!!d&&Bd.ParagraphReader.nb(d);let z=0,O=0;n&&(z=this.Ck.x7(a.currentNode).pu,O=this.Ck.ML(d).pu);n&&this.rnj(d);a.wg();n&&this.Ee.RKa(a,1,z-O)}yfa(a,d,n,z=-1,O=!1,ca=null,Da=!1){k.ULS.sendTraceTag(17622211,324,50,"'Continue Existing List' is selected from Context Menu.");const Xa=Ch.a.instance.mm(Mb.a.yfa),zb=this.Nb.Wb(15);zb.Ir(a);let Vb=null,Fc=0;({mim:Vb,ZAm:Fc,returnValue:z}=this.gll(a,d,z,Vb,Fc,O,ca));if(!Vb||Da&&(1===n||0>n-Vb.lu.gp||2<n-Vb.lu.gp))return zb.dispose(),
Xa.end(),!1;for(;0<Fc;)a.D$b(11,23),Fc--;this.sNn(a,d,z,Vb);zb.dispose();Xa.end();return!0}sNn(a,d,n,z){for(;a.D$b(11,23);)if(a.Va(4)){if(this.Hra(a.currentNode).listID===d.listID){d=new nv(0,d,n);this.joinList(a.currentNode,z,!0,d);break}a.hb()}}gll(a,d,n,z,O,ca=!1,Da=null){for(;a.Cxd(11,23);){if(a.Bo(4)){const Xa=this.Uz(a),zb=this.Vb.ht(a);if(zb.listType!==Da.listType){O++;continue}if(ca&&zb.listStyle!==Da.listStyle||!ca&&d.level<Xa.level){O++;continue}-1===n&&(n=Xa.gp+1);z=null;if(d.level===Xa.level||
ca)ii.a.Oc.EVa&&this.bOb&&this.bOb.ajg(a),z=new $n(this,a,!1,!1);ca&&Xa.level!==d.level&&a.Bo(4)&&(a.Va(4).setValue(Qb.a.je,Xa.level),a.hb());break}O++}return{returnValue:n,mim:z,ZAm:O}}cGc(a){let d=0;var n=0;uf.a.instance.J(3)&&(n=this.Vb.PL(a,!1,!0),d=n.listId,n=n.je);return this.Vb.ww(a,d,n)}startNewList(a,d,n){k.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(d){var z=Ch.a.instance.mm(Mb.a.startNewList),O=this.Nb.Wb(15);O.Ir(a);var ca=$r.a.TR(0,d.listStyle,
null,0,d.propertySet.fa(Qb.a.je,-1));a.Va(4);var Da=a.currentNode.fa(Qb.a.listID,0),Xa=a.currentNode.fa(Qb.a.je,-1);a.hb();ca.sGd=Da;var zb=d.propertySet.fa(Qb.a.Oj,0);0<zb&&ca.propertySet.setValue(Qb.a.Oj,zb);-1===ca.propertySet.fa(Qb.a.je,-1)&&ca.propertySet.setValue(Qb.a.je,Xa);1===d.gq&&((Xa=new yA.a,Da=d.mdg(a.currentNode,Da),Da)?1===Da&&(ca.fUd(ru.a.tqb),ca.yz=Xa.XRf(Xa.mFg,Xa.nFg),ca.s1=ca.yz.s1):(ca.fUd(ru.a.tqb),ca.yz=Xa.YQf(),ca.s1=ca.yz.s1));d.y7()&&1>n&&(n=1);ca.cA=n;Da=new dh.DictionaryPropertySet;
Da=this.WDc(Mb.a.bL,Da);Xa=a.Va(2);a.hb();a.Va(4);d=this.Hra(a.currentNode);this.Cr&&(zb=this.cGc(a.currentNode))&&(ca.levelText=zb.fa(Qb.a.fr,""),ca.mD=42,ca.Kt=zb.fa(Qb.a.D4,"left"));this.J6m(a,Xa);({JUa:ca}=this.wGa(Da,a,ca,!0));a.Va(4);22!==a.currentNode.type&&63!==a.currentNode.type&&k.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",a.currentNode.type);a.currentNode.setValue(Qb.a.je,d.level);a.hb();ca=new $n(this,a,!1,!1);this.Vb.dC(a);n=new nv(1,d,n);this.joinList(a.currentNode,
ca,!0,n);O.dispose();z.end()}else k.ULS.sendTraceTag(51242764,324,50,"'Start New List' has no current ListInfo")}Dqg(a){if(!a)return!1;const d=a.Va(2);d&&a.hb();return uf.a.instance.J(3)&&d&&12===d.type&&d.ja&&d.ja.last&&d.ja.last.Ue?!0:!1}RQe(a,d,n,z){return this.qmf.RQe(a,d,n,z)}CYg(a,d){if(!a||!d)return!1;const n=a.propertySet.fa(Qb.a.fr,null);d=d.propertySet.fa(Qb.a.fr,null);if(!n||!d)return!1;const z=a.propertySet.fa(Vd.a.font,null);a=a.propertySet.fa(Vd.a.font,null);return n===d&&z===a}wyj(a,
d,n){n||d.listType||(d.cA=a.fa(Vd.a.JS,wh.a.uh))}Czi(a,d){if(!d)return null;const n=Array(9),z=d.sGd;if(!this.jcm(d,a)||1>z)return null;for(d=0;9>d;d++){const O=this.Vb.ww(a,z,d);if(null===O||void 0===O?0:O.hasProperty(Qb.a.Oj))n[d]=O.getValue(Qb.a.Oj);else return null}return n}jcm(a,d){if(!a)return!1;const n=a.propertySet.fa(Qb.a.je,-1);a=a.propertySet.fa(Qb.a.Oj,-1);if(0>n||0>a)return!1;this.Qse(d);return a!==this.Nrc[n]?!0:!1}QUh(a,d,n){a&&a.setValue(Qb.a.Oj,d?d[n]:this.Nrc&&n<this.Nrc.length?
this.Nrc[n]:720*(n+1))}i3f(a,d,n,z,O,ca=null,Da=!1){const Xa=new Dd.GraphIterator,zb=this.WP(a,d);Xa.set(a);Xa.kc();a=$s.a.Yo(Xa,Xa.Dda());a.zj(su.a.Npb,null);let Vb=-1;for(;a.moveNext();){if(!Bf.ListReader.Bh(Xa))continue;this.Vb.dC(Xa);const Fc=Xa.currentNode,Yc=this.Hra(Fc);Xa.hb();if(z!==Object(m.a)(this,this.UVd,"siblingMatchesListAndLevel")||Yc.listID===d.listID){if(Da){if(-1!==Vb&&Vb>Yc.level)break;if(-1===Vb)Vb=Yc.level;else if(Yc.level!==Vb)continue}else{if(Yc.level<=zb.C8)break;if(!z(d,
Yc,ca))continue}O(Fc,n,d.listID,ca)}}}ool(a,d,n,z,O){const ca=new Dd.GraphIterator,Da=this.WP(a,d);ca.set(a);ca.kc();if(Bf.ListReader.Bh(ca)){this.Vb.dC(ca);a=ca.currentNode;var Xa=this.Hra(a);ca.hb();Xa.level<=Da.C8||z(d,Xa,null)&&O(a,n,d.listID,null)}}k3f(a,d,n,z,O=null){const ca=new Dd.GraphIterator;ca.Cb(a);z(a,d,this.Uz(ca),ca,0);this.hsd(a,d,n,z,O)}hsd(a,d,n,z,O=null){let ca=new Dd.GraphIterator;const Da=this.WP(a.currentNode,d);let Xa=null,zb=0;var Vb=new Dd.GraphIterator;Vb.Cb(a);Vb.La(10);
const Fc=Yi.a.Yo(Vb,Vb.origin);for(Fc.moveNext();Fc.moveNext();)if(Xa=null,ca=Fc.iterator,1===ca.role&&(Xa=Fc.currentNode,ca.Bo(4)&&(Vb=this.Uz(ca),n(d,Vb,O))))if(Vb.level>d.level)z(a,d,Vb,ca,zb),zb++;else if(Vb.level===d.level||Vb.level<=Da.C8)break;return Xa?ca:null}UVd(a,d){return d.listID!==a.listID||d.level!==a.level?!1:!0}Dwn(a,d,n){return d.listID!==a.listID&&d.listID!==n.pLd||d.level!==a.level?!1:!0}nzg(a,d,n){return d.listID===a.listID||n&&d.listID===n.pLd?!0:!1}vDj(a,d,n,z){const O=a.fa(ii.a.Oc.lA,
-1);this.uDj(a,O+d,n,z)}uDj(a,d,n,z){if(!ko.lEd){const O=a.fa(ii.a.Oc.lA,-1);a.hasProperty(ii.a.Oc.lA)&&-1===O&&Ch.a.instance.mb("PossibleIncorrectListRenumbering",{["Reason"]:"PropertyNotExist"});a.setValue(ii.a.Oc.lA,d);a.setValue(ii.a.Oc.CM,d)}a.setValue(Qb.a.listID,n);d=this.Hra(a);a=Dd.GraphIterator.ua(a);a.kc();a.hb();this.k3f(a,d,Object(m.a)(this,this.nzg,"matchesListId"),Object(m.a)(this,this.E8g,"sublistsUpdateListItem"),z)}Fwn(a,d){const n=a.getValue(ii.a.Oc.lA);a.setValue(ii.a.Oc.lA,n+
d);a.hasProperty(ii.a.Oc.CM);a.setValue(ii.a.Oc.CM,n+d)}Ewn(a,d,n,z){let O,ca;O=this.Pn.Q4a(a);ca=O.TB();if(!ko.lEd){a.hasProperty(ii.a.Oc.lA)||Ch.a.instance.mb("PossibleIncorrectListRenumbering",{["Reason"]:"PropertyNotExist"});const Da=a.getValue(ii.a.Oc.lA);a.setValue(ii.a.Oc.lA,Da+d);a.hasProperty(ii.a.Oc.CM)&&a.getValue(ii.a.Oc.CM)!==Da&&Ch.a.instance.mb("PossibleIncorrectListRenumbering",{["Reason"]:"PropertyNotExist"});a.setValue(ii.a.Oc.CM,Da+d)}a.setValue(Qb.a.listID,n);d=this.Hra(a);a=Dd.GraphIterator.ua(a);
a.kc();a.hb();O&&ca&&!this.Ffb&&(this.tf.d1(O,ca,this.Eb.Jf),this.nia());this.hsd(a,d,Object(m.a)(this,this.yGj,"sublistsEnsureSameListAsOriginal"),Object(m.a)(this,this.e0e,"sublistsUpdateId"),z)}Bjj(a,d,n,z,O){a=this.WP(a.currentNode,n);a.C8>=d.level&&this.u4b(z,a.startAt+O)}zGj(a,d,n,z,O){this.Bjj(a,d,n,z,O)}e0e(a,d,n,z){n.listID=d.listID;z.Va(4);a=this.Pn.Q4a(z.currentNode);d=a.TB();this.$yc(z.currentNode,n);z.hb();a&&d&&!this.Ffb&&(this.tf.d1(a,d,this.Eb.Jf),this.nia())}E8g(a,d,n,z){Bf.ListReader.Bh(z)&&
(a=new Dd.GraphIterator,a.Cb(z),a.kc(),this.Vb.dC(a),this.vlg(z.currentNode,a.currentNode))}BAn(a,d,n,z,O){n.listID=d.listID;this.Bjj(a,d,n,z,O);this.e0e(a,d,n,z,O)}D8g(a,d){return d.listID!==a.listID?!1:!0}AAn(a,d){return d.level>a.level?!1:!0}yGj(a,d,n){return d.listID!==n.pLd?!1:!0}static get lEd(){null==ko.rsf&&(ko.rsf=l.AFrameworkApplication.K?l.AFrameworkApplication.K.ea("RemoveRedundantRenumberingForListActionsIsEnabled"):!1);return ko.rsf}static get jg(){return bl.ContextSetEditor.instance}static get Ze(){return jm.PageNavigator.instance}static Kxj(a,
d){d.setValue(Vd.a.font,a.Gsa||a.jJc||a.wGb?a.font:"Symbol")}static Mxj(a,d){a=a.Gsa||a.jJc||a.iga?a.levelText:wh.a.xCc;k.ULS.shipAssertTag(22127637,338,!!a);d.setValue(Qb.a.fr,a)}static Lxj(a,d){a=a.propertySet.fa(Qb.a.D4,"left");d.setValue(Qb.a.D4,a)}static MOi(a){a=a.iterator.parentNode;const d=Dd.GraphIterator.ua(a);a&&Ia.OutlineElementReader.yKc(d,null)&&a.Fi(8,!0)}static c7l(a){const d=new Dd.GraphIterator;d.set(a.currentNode);qe.OutlineElementNavigator.Uc(a);for(a=d.Rc();a&&!Wy.a.qKc(a);)a=
d.yg();a&&a.Fi(4,!0)}}ko.Uum=2147450879;ko.G4i=1;ko.rsf=null;Object(t.a)(ko,"FlatListEditorCssVersion",ii.a,[465,466,467]);class BB{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd){this.dI=a;this.Ee=n;this.tYb=d;this.Nb=z;this.Ck=O;this.qmf=ca;this.Eb=Da;this.tf=Xa;this.mOa=zb;this.Ja=Vb;this.te=Fc;this.Xb=Yc;this.nI=yd}create(){return new ko(this.dI,this.tYb,this.Ee,this.Nb,this.Ck,this.qmf,this.Eb,this.tf,this.mOa,this.Ja,this.te,this.Xb,this.nI)}}Object(t.a)(BB,"FlatListEditorFactory",null,[]);class Ex{constructor(){this.startAt=
this.je=this.listId=0;this.Lqb=null}}Object(t.a)(Ex,"ListAutoCorrectionRefInfo",null,[]);class Xy{constructor(a,d){this.Aek=a;this.zc=d}RQe(a,d,n,z){if(!a.hasProperty(Xc.a.vBa))return!0;d=Dd.GraphIterator.ua(d.currentNode);Qd.SelectionEditor.Vm(d);let O=!0;if(!n.listType&&!z){23===d.Yc&&d.Ht(1);z=a.fa(Xc.a.vBa,1);if(1!==z){var ca=new Dd.GraphIterator;ca.Cb(d);ca.La(10);ca=Yi.a.Ql(ca.origin);z=this.fll(ca,z,n,d.currentNode);n.Lqb||(O=!1)}a.setValue(Xc.a.vBa,z)}return O}fll(a,d,n,z){const O=new db.a;
for(;a.moveNext()&&a.iterator.currentNode!==z;){const ca=a.iterator;if(!ca.Bo(4))continue;const Da=this.Aek.value.Uz(ca),Xa=this.zc.ht(ca);this.XWm(O,Da);Xa.listType===n.listType&&Xa.listStyle===n.listStyle&&(0>d-Da.gp||2<d-Da.gp||O.add(Object.assign(new Ex,{listId:Da.listID,je:Da.level,Lqb:ca.currentNode,startAt:Da.gp+1})))}0<O.count&&(d=O.J(O.count-1).startAt,n.Lqb=O.J(O.count-1).Lqb);return d}XWm(a,d){let n=0;for(;n<a.count;){const z=a.J(n);z.listId===d.listID&&z.je>=d.level?a.removeAt(n):n++}}}
Object(t.a)(Xy,"ListAutoCorrector",null,[436]);class MA{constructor(a,d,n,z,O){this.Tb=a;this.Vb=n;this.Zt=z;this.bWf=O}get O$l(){return Bf.ListReader.Jq}fDd(a){return 0>a?!0:this.O$l?!1:!!a}lb(){this.Tb.ma(Mb.a.q9a,Kb.a.outlineElement,Object(m.a)(this,this.q9a,"startListAtOne"));this.Tb.ma(Mb.a.q9a,Kb.a.Ub,Object(m.a)(this,this.q9a,"startListAtOne"));this.Tb.ma(Mb.a.q9a,Kb.a.view,Object(m.a)(this,this.q9a,"startListAtOne"));this.Tb.$b(Mb.a.q9a,12);this.Tb.ma(Mb.a.p9a,Kb.a.outlineElement,Object(m.a)(this,
this.p9a,"startListAtInputtedValue"));this.Tb.ma(Mb.a.p9a,Kb.a.Ub,Object(m.a)(this,this.p9a,"startListAtInputtedValue"));this.Tb.ma(Mb.a.p9a,Kb.a.view,Object(m.a)(this,this.p9a,"startListAtInputtedValue"));this.Tb.$b(Mb.a.p9a,12);this.Tb.ma(Mb.a.yfa,Kb.a.outlineElement,Object(m.a)(this,this.yfa,"continueExistingList"));this.Tb.ma(Mb.a.yfa,Kb.a.Ub,Object(m.a)(this,this.yfa,"continueExistingList"));this.Tb.ma(Mb.a.yfa,Kb.a.view,Object(m.a)(this,this.yfa,"continueExistingList"));this.Tb.$b(Mb.a.yfa,
12);this.Tb.ma(Mb.a.eub,Kb.a.outlineElement,Object(m.a)(this,this.eub,"startListAtValue"));this.Tb.ma(Mb.a.eub,Kb.a.Ub,Object(m.a)(this,this.eub,"startListAtValue"));this.Tb.ma(Mb.a.eub,Kb.a.view,Object(m.a)(this,this.eub,"startListAtValue"));this.Tb.$b(Mb.a.eub,12);this.Tb.ma(Mb.a.Lib,Kb.a.outlineElement,Object(m.a)(this,this.Lib,"continueExistingListAtValue"));this.Tb.ma(Mb.a.Lib,Kb.a.Ub,Object(m.a)(this,this.Lib,"continueExistingListAtValue"));this.Tb.ma(Mb.a.Lib,Kb.a.view,Object(m.a)(this,this.Lib,
"continueExistingListAtValue"));this.Tb.$b(Mb.a.Lib,12)}q9a(a,d,n){a=this.gnd(d);if(!a||this.Zt.Dqg(a))return 8;d=this.Zt.Uz(a);if(1===d.gp||this.fDd(d.level))return 8;if(1===n)return 32;n=this.Vb.ht(a);this.Zt.startNewList(a,n,1);return 32}p9a(a,d,n){a=this.gnd(d);if(!a||this.Zt.Dqg(a))return 8;d=this.Zt.Uz(a);if(this.fDd(d.level))return 8;if(1===n)return 32;this.bWf.TGl(a.currentNode,d.gp,this.Vb,this.Zt,this.Q9a);return 32}get Q9a(){return la.a.instance.resolve("Common.IStandaloneRootController").e1}yfa(a,
d,n){a=this.gnd(d);if(!a||this.Zt.Dqg(a))return 8;d=this.Zt.Uz(a);if(1!==d.gp||this.fDd(d.level))return 8;if(1===n)return 32;n=this.Vb.ht(a);return this.Zt.yfa(a,d,n.cA,-1,!1,n)?32:8}gnd(a){return this.Zt.JEl(a)}eub(a,d,n,z,O){a=this.gnd(d);if(!a)return 8;d=this.Zt.Uz(a);if(this.fDd(d.level))return 8;if(1===n)return 32;n=this.Vb.ht(a);this.Zt.startNewList(a,n,O);return 32}Lib(a,d,n,z,O){a=this.gnd(d);if(!a)return 8;d=this.Zt.Uz(a);return this.fDd(d.level)?8:1===n?32:this.Zt.yfa(a,d,d.gp,O)?32:8}}
Object(t.a)(MA,"ListContextMenuSectionActor",null,[]);class Qz{static get Okm(){return xg.a.oz(Qz.fm,Box4Intl.Box4Strings.l_StartNewListDialog,Box4Intl.Box4Strings.l_ContinueFromPreviousList,Box4Intl.Box4Strings.l_SetValueTo)}}Qz.fm="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(t.a)(Qz,"ListSetStartValueDialogHtml",null,[]);class Lw extends xg.a{constructor(a,d,n,z,O){super();this.Nae=this.pbf=this.bbe=this.xvf=null;this.Xcf=!0;this.wZ=!1;this.Q0a=0;this.pYa=[Mb.a.NXe,Mb.a.y_e,Mb.a.ASe];this.Je="ListSetStartValueDialog";this.Lf=Qz.Okm;this.he=a;this.K9=d;this.zc=n;this.Bpf=d;this.b2=z;Bf.ListReader.Jq&&(d=new Dd.GraphIterator,a?(d.set(a),d.kc(),Ia.OutlineElementReader.gg(d)||qe.OutlineElementNavigator.Uc(d),Bf.ListReader.Bh(d)&&(d.Va(4),a=d.currentNode,22===a.type&&
(this.zc.QP(a).y7()?this.Q0a=1:this.Q0a=0))):this.Q0a=1);this.pc=O;this.Ih(Box4Intl.Box4Strings.l_SetNumberingValueList,Object(m.a)(this,this.imn,"setListStartValueHandler"),{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.Xcf&&(this.xvf=document.getElementById("ListRadioStartNew"),this.bbe=Object(m.a)(this,this.oKm,"onStartNewRadioSelected"),this.pbf=document.getElementById("ListRadioContinue"),this.Nae=Object(m.a)(this,this.bEm,"onContinueRadioSelected"),Qc.a.addHandler(this.xvf,"click",
this.bbe),Qc.a.addHandler(this.pbf,"click",this.Nae));for(let ca of this.pYa)yg.a.CGa(ca,Object(m.a)(this,this.Aon,"setSpinnerControlValue"),Object(m.a)(this,this.VOl,"getSpinnerControlValue"));this.pc.Km()}get Zt(){return this.b2}Aon(a,d){Bf.ListReader.Jq?(a=d[Tg.a.Number],l.AFrameworkApplication.Zi("Microsoft.Office.WordOnline.EOPNoFormattingFixEnabled"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EOPNoFormattingFixEnabled",!1)?this.K9=Number.isInteger(d[Tg.a.Number])&&
a>=this.Q0a?a:this.Q0a:this.K9=a>=this.Q0a?a:this.Q0a):this.K9=d[Tg.a.Number]}VOl(a,d){Bf.ListReader.Jq&&(this.K9=this.K9>=this.Q0a?this.K9:this.Q0a);d[Tg.a.Number]=this.K9;d[Tg.a.UnitType]=0}imn(a,d){if(1===a){var n=d.ListRadioStartNew,z=d.ListRadioContinue,O=Dd.GraphIterator.ua(this.he);O.kc();d=this.Zt.Uz(O);a=this.zc.ht(O);if(n)this.Zt.startNewList(O,a,this.K9);else if(z)if(this.Xcf)this.Zt.yfa(O,d,this.Bpf,-1,!1,a);else{n=!0;for(z=null;O.lx();)if(O.Bo(4)){z=new $n(this.Zt,O,!1,!1);break}if(!z||
this.Zt.Uz(O).gp>=this.K9)n=!1;n?(O=Dd.GraphIterator.ua(this.he),O.kc(),this.Zt.yfa(O,d,this.Bpf,this.K9,!1,a)):(this.dispose(),this.NKa(CommonUIStrings.l_ErrorDialogMessage,Object(m.a)(this,this.Nkm,"listDialogCreator")))}}}Nkm(){new Lw(this.he,this.Bpf,this.zc,this.Zt,this.pc)}dispose(){this.wZ||(this.Xcf&&(this.bbe&&Qc.a.removeHandler(this.xvf,"click",this.bbe),this.Nae&&Qc.a.removeHandler(this.pbf,"click",this.Nae)),this.pc.WI("ListStartSpinner"),super.dispose(),this.wZ=!0)}FJk(){const a=Uh.q("none",
Bf.ListReader.Jq?this.Q0a+"":"0","100","1");return Uh.o(Lw.gYi,Mb.a.NXe,Mb.a.ASe,Box4Intl.Box4Strings.l_SetValueTo,[a],null,Mb.a.y_e)}o3b(a){const d=document.getElementById(Lw.gYi);this.pc.e2a("ListStartSpinner",a);a=this.pc.xFb("ListStartSpinner","Medium");d.appendChild(a)}rV(){const a=this.FJk();this.o3b(a)}oKm(){document.getElementById(Lw.fYi).style.visibility="visible"}bEm(){document.getElementById(Lw.fYi).style.visibility="hidden"}}Lw.gYi="SetListStartSpinnerContainer";Lw.fYi="ListStartAtSpinnerBox";
Object(t.a)(Lw,"ListSetStartValueDialog",xg.a,[]);class Tv{TGl(a,d,n,z,O){new Lw(a,d,n,z,O)}static get instance(){return Tv.na||(Tv.na=new Tv)}}Tv.na=null;Object(t.a)(Tv,"ListDialogFactory",null,[434]);class py{constructor(a,d,n){this.b2=a;this.zc=d;this.Nb=n}ajg(a){k.ULS.shipAssertTag(40420184,393,Ia.OutlineElementReader.gg(a));const d=a.Va(4);a.hb();if(d){const n=this.zc.QP(d);n.gq||this.$1l(a,d,n)}}gRk(a){for(let d=0;d<a.length;d++){const n=new Dd.GraphIterator;n.set(a.getContext(d).node);this.ajg(n)}}$1l(a,
d,n){const z=jm.PageNavigator.instance.kt(d),O=this.b2.Hra(d),ca=this.Nb.Wb(15);ca.Ir(a);a=this.b2.gZh(z,d,n,0,null);this.b2.Cpj(d,!0,O.listID);ca.dispose();this.zc.$fa(d,a)}}Object(t.a)(py,"SingleLevelListEditor",null,[435]);var wp=b(351);class wt extends gi{constructor(a){super();wt.K3c=a}kgj(a,d,n,z,O,ca){if(!a||!a.length)return 8;let Da,Xa;a=({AUl:Da,zUl:Xa}=wt.dr.xUl(a,Da,Xa)).returnValue;let zb=1;for(let Fc of a.keys){var Vb=Da.contains(Fc);const Yc=a.J(Fc);wt.dr.jOk(a.J(Fc),this.nkd(d),Vb)?
Vb?(k.ULS.sendTraceTag(575213851,393,50,"List Actions: {0} lists, with change in level",this.nkd(d)?"Promote":"Demote"),Vb=l.AFrameworkApplication.pa.rf(wp.a.Sqa(Yc),d,n,z,O,ca)):(k.ULS.sendTraceTag(575213852,393,50,"List Actions: {0} lists, without change in level",this.nkd(d)?"Promote":"Demote"),Vb=wt.dr.UMm(a.J(Fc),this.nkd(d),Xa.J(Fc))):(k.ULS.sendTraceTag(575213850,393,50,"List Actions: Tried to {0} lists, but unable to indent",this.nkd(d)?"Promote":"Demote"),Vb=8);zb=Bc.ActionManager.iqb(zb,
Vb)}return zb}nkd(a){return a===Mb.a.NK?!0:!1}static get dr(){return wt.K3c||(wt.K3c=la.a.instance.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))}}wt.K3c=null;Object(t.a)(wt,"WordEditorListContextManager",gi,[]);class tu{get name(){return"WordEditor.ListEditors"}Hb(a){l.AFrameworkApplication.K.ea("OutlineLevelEditorsDelayInitializationEnabled")&&(a.ha("WordEditor.ListEditors.IListAutoCorrector",()=>new Xy(a.vf("WordEditor.IFlatListEditor"),a.resolve("Box4.List.IListReader"))).singleInstance(),
a.ha("WordEditor.IFlatListEditor",()=>(new BB(a.resolve("WordEditor.List.IFlatListReader"),a.vf("Box4.IOutlineElementIndentationEditor"),a.resolve("Box4.IOutlineElementEditor"),new jn.a,a.resolve("Box4.IParagraphIndentationReader"),a.resolve("WordEditor.ListEditors.IListAutoCorrector"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.List.IListFormattingEditor"),a.resolve("Box4.IFeatureHelper"),a.resolve("Common.ICpuMeter"),
a.resolve("Box4.Styles.IWACStyleReader"),a.resolve("Box4.Styles.IWACStyleEditor"))).create()).singleInstance(),a.ha("Box4.List.IListEditor",()=>a.resolve("WordEditor.IFlatListEditor")).singleInstance(),a.ha("Box4.List.ISingleLevelListEditor",()=>new py(a.resolve("WordEditor.IFlatListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.Graph.IGraphTransactionFactory"))).singleInstance(),a.ha("Box4.ListEditors.WordEditorListContextManager",()=>new wt(a.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))).as("Box4.ListEditors.IListContextManager"))}init(){(new MA(l.AFrameworkApplication.pa,
new so.a,tu.Vb,tu.Zt,Tv.instance)).lb();const a=l.AFrameworkApplication.pa;a.Aa(Mb.a.ASe,Kb.a.view,yg.a.x8,96);a.Aa(Mb.a.y_e,Kb.a.view,yg.a.$P,96);a.Aa(Mb.a.NXe,Kb.a.view,yg.a.$P,96)}dispose(){}static get Vb(){return tu.zc||(tu.zc=la.a.instance.resolve("Box4.List.IListReader"))}static get Zt(){return tu.b2||(tu.b2=la.a.instance.resolve("WordEditor.IFlatListEditor"))}static main(){M.a.instance.Sb(new tu)}}tu.zc=null;tu.b2=null;Object(t.a)(tu,"WordEditorListEditorsPackage",null,[1,2]);var CB=b(1521),
Mw=b(484),ov=b(87),xt=b(1782);class uu extends hb.a{constructor(a,d,n,z,O,ca){super(a,d);this.styleId=null;this.Nj=0;this.B6a=null;this.characterData=n;this.paragraphNode=z;this.Msa=O;this.i5a=ca}}Object(t.a)(uu,"HeadingText",hb.a,[]);class oq{constructor(a,d,n,z,O,ca,Da){this.Mzh=!0;this.VEh=0;this.mRh=8;this.rta=null;this.tek=a;this.vA=d;this.Xb=n;this.zc=z;this.AG=O;this.Voa=ca;this.Zlf=Da}get DH(){return this.tek.value}get Qig(){return this.Mzh}set Qig(a){this.Mzh=a}get Lec(){return this.VEh}set Lec(a){this.VEh=
a}get Roc(){return this.mRh}set Roc(a){this.mRh=a}PBl(){return Object(ov.__awaiter)(this,void 0,void 0,function*(){var a=this.Zlf.value;if(!isNullOrUndefined(a)&&a.Kq)return a=yield this.FIl(),this.ONg(a,!0);a=this.rta;return isNullOrUndefined(a)?null:Promise.resolve(this.ONg(a,!0))})}QBl(){return this.ONg([],!1)}ONg(a,d){const n=window.performance.now(),z=this.byi();if(!z)return null;const O=new db.a;let ca=0;for(;z.moveNext();){var Da=z.iterator;if(11===Da.Yc){const Xa=this.zc.Rlb(Da),zb=qe.OutlineElementNavigator.Sd(Da,
!0);d&&a[ca]&&a[ca].ParaId===Bd.ParagraphReader.gH(zb)&&ca++;qe.OutlineElementNavigator.Uc(Da);if(!zb||!Bd.ParagraphReader.nb(zb)||zb.ko||""===zb.characterData||"\ufffc"===zb.characterData)continue;const Vb=this.Axe(zb);Vb&&(Xa&&(Vb.Msa=this.AG.Opb(Xa,!1).mca,Da=this.zc.ht(Da),1===Da.listType&&Da.wGb&&(Vb.B6a=Da.font)),d&&(a[ca-1]&&a[ca-1].ParaId===Bd.ParagraphReader.gH(zb)?Vb.Nj=ca:Vb.Nj=ca+1),O.add(Vb))}}k.ULS.sendTraceTag(591963592,3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",
window.performance.now()-n));return O}FIl(){let a=new df.a;var d=xt.a.JR(l.AFrameworkApplication.rootQuerySignature,null);let n=new Ek.a;n.Pq=d;n.status=1;this.mik=window.performance.now();d=this.Voa.Pla(0,()=>{if(2!=n.statusCode||null==n.xj||0==n.xj.length||null==n.xj[0]){const z=String.format("GetPageEndsOperation Failed with status code: {0};",n.statusCode);a.setException(Error.create(z));k.ULS.sendTraceTag(543802465,3019,10,z)}else a.mf(n.xj[0].PageEnds),k.ULS.sendTraceTag(543802466,3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",
window.performance.now()-this.mik))});d.PJ(n);d.yP();return Gg.b(a.task)}NBl(){const a=this.byi();if(!a)return-1;let d=0;for(;a.moveNext();){const n=a.iterator;if(11===n.Yc){const z=qe.OutlineElementNavigator.Sd(n,!0);qe.OutlineElementNavigator.Uc(n);z&&Bd.ParagraphReader.nb(z)&&!z.ko&&""!==z.characterData&&"\ufffc"!==z.characterData&&this.Axe(z)&&d++}}return d}YZl(a){if(a.Lj)return!0;a=a.role;return 1===a||2===a||4===a}byi(){if(!this.DH)return k.ULS.sendTraceTag(591000526,3019,10,"PageNode is null"),
null;var a=this.vA.RL(this.DH);if(!a)return k.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;a=Dd.GraphIterator.ua(a);if(!a.tn())return k.ULS.sendTraceTag(591963594,3019,10,"Failed to root at PageContent."),null;a=Yi.a.Yo(a,a.origin);a.zj(Object(m.a)(this,this.YZl,"headingFilter"),null);return a}Axe(a){return this.pTl(a)||this.MBl(a)}MBl(a){var d;let n=d=null,z=-1;var O=-1,ca=this.Xb.rz(a);for(let Xa=0;Xa<a.ja.length;Xa++)if(d=a.ja.J(Xa),d.formatting){var Da=La.FormattingReader.Rra(d.formatting);
const zb=this.Xb.Jd(Da);if(!n&&(n=zb,O=(O=sj.a.w9b(n))?Number.parseInvariant(O):0,!this.zqg(O-1)))break;Da=(Da=this.Xb.MN(Da,ca))?Da.fa(Qb.a.E7a,9):9;z=-1===z?Da:z;if(!(this.mtg(Da)&&z===Da||sj.a.gFd(zb)&&n===zb))break}d=d.cp;ca=a.characterData.substring(0,d);return this.mtg(z)?new uu(0,d,ca,a,null,z+1):sj.a.gFd(n)?new uu(0,d,ca,a,null,O):null}mtg(a){return this.Qig&&this.zqg(a)}zqg(a){return a<=this.Roc&&a>=this.Lec}pTl(a){const d=Bd.ParagraphReader.U4a(a);if(this.mtg(d))return new uu(0,a.characterData.length,
a.characterData,a,null,d+1);if(this.zqg(d)){var n=this.Xb.im(a);n=this.Xb.Jd(n);if(sj.a.spb(n))return new uu(0,a.characterData.length,a.characterData,a,null,d+1)}return null}}Object(t.a)(oq,"StyleBasedDocumentHeadings",null,[297]);class NA{constructor(){this.startTime=0}}Object(t.a)(NA,"TocCallbackData",null,[]);class pv{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc){this.ga=a;this.w3d=d;this.mc=z;this.Nb=O;this.vn=ca;this.hge=Da;this.Eb=Xa;this.Ja=zb;this.qxh=Vb;this.EJ=Fc}lb(){this.ga.ma(Mb.a.Loc,Kb.a.paragraph,
Object(m.a)(this,this.Keh,"updateTableOfContentsHandler"));this.ga.ma(Mb.a.Loc,Kb.a.Lc,Object(m.a)(this,this.Keh,"updateTableOfContentsHandler"));this.ga.ma(Mb.a.Loc,Kb.a.Ub,Object(m.a)(this,this.Keh,"updateTableOfContentsHandler"));this.ga.$b(Mb.a.Loc,1028);this.ga.ma(Dc.a.Nkg,Kb.a.Ub,Object(m.a)(this,this.r6l,"insertTableOfContentsHandler"));this.ga.$b(Dc.a.Nkg,1028);this.ga.ma(Dc.a.CQd,Kb.a.paragraph,Object(m.a)(this,this.CUg,"removeTableOfContentsHandler"));this.ga.ma(Dc.a.CQd,Kb.a.Lc,Object(m.a)(this,
this.CUg,"removeTableOfContentsHandler"));this.ga.ma(Dc.a.CQd,Kb.a.Ub,Object(m.a)(this,this.CUg,"removeTableOfContentsHandler"));this.ga.$b(Dc.a.CQd,1028)}Keh(a,d,n){const z=d.node;if(!z)return k.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),2;if(12!==z.type)return k.ULS.sendTraceTag(36705297,324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!z.ko)return 2;if(1===n)return Yb.SessionStatusManager.instance.oj?8:32;this.Ja&&this.Ja.isFeatureEnabled(206)?
this.hge.fMn(z).then(O=>{O||this.vQj(z)}):this.vQj(z);return 32}vQj(a){ja.Health.instance.recordKpiUsage(pv.xVj,1,pv.aH,null);const d=this.Gsl(a),n=new NA;n.startTime=window.performance.now();this.w3d.lvj(d,Qb.a.Gvb,this.ySl(this.SIl(a)),Object(m.a)(this,this.QPn,"updateTocSuccessCallback"),null,n);this.hge.VPk()}QPn(a){a=window.performance.now()-a.startTime;k.ULS.sendTraceTag(574408796,3019,50,String.format("UpdateTOC Duration: {0} ms;",a));a=Object.assign(new Sg.a,{durationMs:a});ja.Health.instance.recordKpiSuccess(pv.xVj,
a);pv.vLa()}r6l(a,d,n){if(Bd.ParagraphReader.nb(d.node)&&d.node.ko)return 2;if(1===n)return Yb.SessionStatusManager.instance.oj?8:32;if(d.contextId!==Kb.a.Ub||this.vn.t4(d)||!Bd.ParagraphReader.nb(d.node))return 32;this.Eb.Ws(17);this.hge.P_k(d);return 32}CUg(a,d,n){a=d.node;if(!a)return k.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==a.type)return k.ULS.sendTraceTag(39358979,324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),
2;if(!a.ko)return 2;if(1===n)return Yb.SessionStatusManager.instance.oj?8:32;n=new Dd.GraphIterator;n.set(a);n.La(8);n.tc(8);d=this.Nb.Wb(15);d.Ir(n);this.hge.r6m(a)?(d.dispose(),pv.vLa()):(d.dispose(),k.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32}Vjh(a){if(null!=a&&a.ko)if(null==this.qxh.instance)k.ULS.sendTraceTag(539628835,3019,10,"Page Number Finder instance is null.");else{var d=this.qxh.instance.CBi();a=this.$kl(a);var n=!1;1===this.EJ.XG&&(n=!0);0!=a&&d!=a&&(d=[Object.assign(new ba.a,
{name:"TOCPageNo",string:a}),Object.assign(new ba.a,{name:"HeadingPageNo",string:d}),Object.assign(new ba.a,{name:"isPageView",string:n})],we.a("TOCPageNoMismatch",!0,void 0,d))}}$kl(a){for(let d=0;d<a.ja.length;d++){const n=a.ja.J(d);if(null!=n.Hc)for(let z=0;z<n.Hc.length;z++){const O=n.Hc.J(z);if(1===O.hi&&O.instruction.trim().startsWith("PAGEREF"))return parseInt(a.characterData.substr(n.cp,a.characterData.length-n.cp))}}return 0}SIl(a){return a?a.fa(Qb.a.CQ,null):(k.ULS.sendTraceTag(38638673,
324,10,"Node is null in GetParaIdForUpdate."),null)}Gsl(a){return this.mc.CTa(a,7,7).Va(35)}ySl(a){const d=[];d.push(a+",TOC,0");return d}static vLa(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const a=la.a.instance.Ca("Common.ISystemInitiatedFeedback");a&&a.execute(d=>{d.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},pv.pSa)}}pv.pSa=5E3;pv.xVj="WordUpdateTOC";pv.aH="wwaengidc";Object(t.a)(pv,"TableOfContentsActor",
null,[296]);class Ql{}Object(t.a)(Ql,"FieldData",null,[]);class Uv extends Ql{constructor(){super();this.SOb=null}}Object(t.a)(Uv,"TOCFieldData",Ql,[]);class Rz{constructor(a,d,n,z,O,ca=null){this.$Zl=a;this.Ut=d;this.Nj=n;this.rGj=z;this.Msa=O;this.B6a=ca}}Object(t.a)(Rz,"TOCHeadingData",null,[]);class si{constructor(a,d){this.NEa=a;this.Tn=d}NEi(a){return Object(ov.__awaiter)(this,void 0,void 0,function*(){const d=yield this.TBl(a);if(!d||!d.count)return new Uv;k.ULS.sendTraceTag(591963591,3019,
50,String.format("Headings Count in TOC: {0};",d.count));return this.lTm(d,a.fcc)})}TBl(a){this.NEa.Qig=a.Rig;this.NEa.Lec=a.Lec;this.NEa.Roc=a.Roc;return this.NEa.PBl()}itl(a){if(a=this.htl(a))return this.Tn.zra(a)}htl(a){const d=a.ja.length;for(let n=0;n<d;n++){const z=a.ja.J(n);if(z.hyperlink&&z.hyperlink.jY&&z.hyperlink.url.startsWith(w.a.EGa))return z.hyperlink.url.substr(z.hyperlink.url.indexOf("_Toc"))}return null}jUe(a){(a=this.itl(a))&&this.Tn.$Me(a.id)}SPl(){return this.NEa.NBl()}lTm(a,
d){const n=new Uv,z=new db.a;for(let O of a){a=this.RPl(O,d);if(!a)return null;z.add(a)}n.SOb=z;return n}RPl(a,d){let n;if(d&&(n=this.r_k(a),!n))return k.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),null;d=Vi.AParagraphNode.V0(a.characterData.trim());const z=this.mRl(a.i5a);return new Rz(d,n,a.Nj,z,a.Msa,a.B6a)}r_k(a){const d=String.format("{0}{1}","_Toc",gf.a.HH());return this.Tn.eyc(d,a.begin,a.end,a.paragraphNode,a.paragraphNode)?d:null}mRl(a){return String.format("toc {0}",
a)}}Object(t.a)(si,"TOCDataManager",null,[295]);class Wi{N5g(){const a=Object.assign(new $g.StandardDialog,{Hq:l.AFrameworkApplication.kY,wc:0,roa:!1});a.j5(1);a.Qha(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return Wi.Kh||(Wi.Kh=new Wi)}}Wi.Kh=null;Object(t.a)(Wi,"TOCDialogHelper",null,[]);var Fk=b(181),OA=b(179),vu=b(584),DB=b(296),qy=b(133);class Vv{constructor(a,d,n,z,O,ca,Da){this.P5g=a;this.fcc=
d;this.Rig=n;this.Lec=z;this.Roc=O;this.m2b=ca;this.soc=[];this.instruction=Da}toString(){return"showPageNumber:"+this.P5g+"  isHyperlink:"+this.fcc+" includeOutlineLevels:"+this.Rig+" lowerOutlineLevel:"+this.Lec+" upperOutlineLevel:"+this.Roc+" addContentControl:"+this.m2b+" unsupportedSwitches:"+this.soc.toString()}}Object(t.a)(Vv,"TOCSettings",null,[]);class ej{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le,Ve,gg,Lh){this.kAh="TOC";this.fcf=this.txf=null;this.Rnc=a;this.Ee=d;this.lk=n;this.Kz=
z;this.nk=O;this.vn=ca;this.Da=Da;this.hc=Xa;this.lQh=zb;this.Wd=Vb;this.rxf=Fc;this.lr=yd;this.eN=je;this.pq=Le;this.Nb=Ve;this.fb=gg;this.eg=Lh}get IAd(){return this.kAh}set IAd(a){this.kAh=a}get Tnc(){this.txf||(this.txf=this.ewi());return this.txf}ewi(){return new Vv(!0,!0,!0,0,8,!0,this.USm())}P_k(a){Object(ov.__awaiter)(this,void 0,void 0,function*(){we.a(ej.T4k);const d=window.performance.now();if(Bd.ParagraphReader.nb(a.node))if(this.vn.t4(a))k.ULS.shipAssertTag(592233794,3019,!1,"We can't insert table of contents, current insertion point is in locked range"),
ej.Tpb("IP is in locked range");else{var n=yield this.Rnc.NEi(this.Tnc);if(n){var z=new bf.a(2,1,0,()=>{this.V4k(a,n,d)});this.fb.rb(z)}else k.ULS.sendTraceTag(592233795,3019,10,"Failed to create table of contents."),ej.Tpb("Failed to get TOC data")}else k.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),ej.Tpb("Context should be paragraph")})}V4k(a,d,n=0){let z;try{if(0==n&&(n=window.performance.now()),this.uni(a.node)){var O=new Dd.GraphIterator;
O.set(a.node);O.La(8);O.tc(8);z=this.Nb.Wb(15);z.Ir(O);var ca=d.SOb?d.SOb.count:0;if(ca){O=null;var Da;for(var Xa=0;Xa<ca;Xa++){const Yc=d.SOb.J(Xa);if(!({j6b:Da}=this.XNi(a,O,Xa,ca,Yc,Vb?Vb.toString():void 0)).returnValue){ej.Tpb("Failed to populate new TOC paragraph");z.dispose();return}if(0==Xa){var zb=Da.currentNode;var Vb=Bd.ParagraphReader.gH(zb)}O=Da}if(this.Tnc.m2b&&!this.TQf(zb.id,O.Hm.id))ej.Tpb("Failed to add content control block"),z.dispose();else{var Fc=window.performance.now()-n;we.a(ej.HSf,
!0,Fc)}}else this.rxf.N5g(),this.E0k(a)&&(Xa=window.performance.now()-n,we.a(ej.HSf,!0,Xa)),z.dispose()}else ej.Tpb("Failed to fetch style set")}catch(Yc){ej.Tpb(String.format("{0} {1}",Yc.message,Yc.stack))}finally{z&&z.dispose()}}uni(a){this.fcf=this.nk.rz(a);return this.fcf?!0:(k.ULS.sendTraceTag(592233796,3019,15,"Failed to fetch style set"),!1)}static yJa(a){a=[Object.assign(new ba.a,{name:ej.OPn,string:a})];we.a(ej.Neh,!1,void 0,a)}static Qxg(a){a=[Object.assign(new ba.a,{name:ej.A7m,string:a})];
we.a(ej.aoj,!1,void 0,a)}static Tpb(a){a=[Object.assign(new ba.a,{name:ej.U4k,string:a})];we.a(ej.HSf,!1,void 0,a)}fMn(a){return Object(ov.__awaiter)(this,void 0,void 0,function*(){const d=this.MEi(a);if(null==d)ej.yJa("Cannot update TOC when firstTocPara = null");else{var n=this.OEi(d);if(0<n.soc.length)return this.w1i(n.soc),!1;we.a(ej.NPn);var z=window.performance.now(),O=yield this.Rnc.NEi(n);if(!O)return k.ULS.sendTraceTag(559248668,3019,10,"Failed to get data for TOC update."),ej.yJa("Failed to fetch TOC data"),
!1;var ca=new bf.a(1,1,0,()=>{this.PPn(d,O,n,z)});this.fb.rb(ca);return!0}})}PPn(a,d,n=null,z=0){let O;try{if(null==a)ej.yJa("Attempt to update TOC when firstTocPara = null");else if(null==d)ej.yJa("Attempt to update TOC when tocFieldData = null");else{0==z&&(z=window.performance.now());if(null==n&&(n=this.OEi(a),0<n.soc.length)){this.w1i(n.soc);return}var ca=new Dd.GraphIterator;ca.set(a);ca.La(8);ca.tc(8);O=this.Nb.Wb(15);O.Ir(ca);var Da;if(({PKf:Da}=this.ynj(a,n)).response){k.ULS.sendTraceTag(559018207,
3019,50,String.format("Attempting to update TOC with settings: {0}",n.toString()));var Xa=d.SOb?d.SOb.count:0;if(this.uni(a)){var zb;this.sTi(a)&&(this.$nj(a),(a=Bd.ParagraphReader.qh(a,!1,!0))&&(zb=a.fa(Qb.a.Ob,null).toString()));var Vb=a.fa(Qb.a.CQ,null);ca=Vb;zb=null!==zb&&void 0!==zb?zb:Vb;if(Xa){for(var Fc=0,Yc;a.ko&&ca==Vb&&Fc<Xa;){let Le=d.SOb.J(Fc);n.fcc&&this.Rnc.jUe(a);if(!this.uPn(a,Fc,Xa,Le,n)){k.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");ej.yJa("Failed to update TOC paragraph");
O.dispose();return}a.setValue(Qb.a.CQ,zb);Fc++;Yc=a;a=Bd.ParagraphReader.qh(Yc,!1,!0);if(!a){ca=null;break}this.xTi(a)&&this.Znj(a);ca=a.fa(Qb.a.CQ,null)}ca==Vb&&this.xUg(a);var yd;if(({FWi:yd}=this.jwk(d,Fc,Xa,Yc,zb)).response)if(n.m2b&&!this.TQf(Da,yd.id))ej.yJa("Failed to add content control block"),O.dispose();else{var je=window.performance.now()-z;we.a(ej.Neh,!0,je)}else ej.yJa("Failed to add new paragraph"),O.dispose()}else this.rxf.N5g(),this.KPn(a,n.m2b,Da,n.instruction,zb)?(Fc=window.performance.now()-
z,we.a(ej.Neh,!0,Fc)):ej.yJa("Failed to update to empty TOC"),O.dispose()}else ej.yJa("Failed to fetch style set")}else ej.yJa("Failed to remove Content Control"),O.dispose()}}catch(Le){ej.yJa(String.format("{0} {1}",Le.message,Le.stack))}finally{O&&O.dispose()}}jwk(a,d,n,z,O){let ca=new Dd.GraphIterator;for(ca.set(z);d<n;){z=a.SOb.J(d);if(!({j6b:z}=this.XNi(null,ca,d,n,z,O)).returnValue)return{FWi:ca.currentNode,response:!1};ca=z;d++}return{FWi:ca.currentNode,response:!0}}ynj(a,d){var n,z,O;let ca,
Da;const Xa=null===(n=null===a||void 0===a?void 0:a.ja)||void 0===n?void 0:n.first.Qa;if(Xa&&0<Xa.length)if(a=a.ja.first.Qa.J(0),a.Te){n=a.contentControlNode.getValue(Qb.a.IB);ca=Fk.a.Il?this.eg.Ft.get(null===(z=a.contentControlNode.id)||void 0===z?void 0:z.toString()):a.contentControlNode.getValue(Qb.a.fi);Da=Fk.a.Il?this.eg.Bu.get(null===(O=a.contentControlNode.id)||void 0===O?void 0:O.toString()):a.contentControlNode.getValue(Qb.a.vj);if(0!=this.lr.pQc(n))return k.ULS.sendTraceTag(558952907,3019,
10,"Failed to release content control"),{response:!1,PKf:ca,o5h:Da};d.m2b=!0}else k.ULS.sendTraceTag(528537613,3019,15,"Content control is not block type"),d.m2b=!1;else d.m2b=!1;return{response:!0,PKf:ca,o5h:Da}}KPn(a,d,n,z,O){k.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.Rnc.jUe(a);let ca=this.wwe(a);if(!this.efj(ca,d,n,z))return ej.yJa("Failed to populate empty TOC."),!1;if(d=Bd.ParagraphReader.qh(a,!1,!0))n=a.fa(Qb.a.CQ,null),z=d.fa(Qb.a.CQ,null),n==z&&this.xUg(d);
a.setValue(Qb.a.CQ,O);return!0}efj(a,d,n,z){this.hc.replaceTextRange(a,WordEditorIntl.WordEditorStrings.L_EmptyTOCText);a=a.node;this.p5i(a);this.Wd.tO(a.ja.first.formatting,!0);this.fRf(a,0,1,z);return d&&n&&!this.TQf(n,a.id)?!1:!0}wwe(a){a.ja.reset();a.Eqa();const d=new OA.a(a,0);d.formatting=new qy.a(d,E.a.nil);d.Le=!0;a.ja.add(d);return fe.a.createTextRange(a,0,a.characterData.length)}sTi(a){if(Bd.ParagraphReader.ox(a)){var d=a.ja.last.Hc;if(!d||!d.length)return!1;if(4<=d.length){a=0===d.J(d.length-
4).hi;const n=1===d.J(d.length-3).hi&&d.J(d.length-3).instruction.trim().startsWith(this.IAd),z=2===d.J(d.length-2).hi;d=5===d.J(d.length-1).hi;return a&&n&&z&&d}}return!1}xTi(a){if(Bd.ParagraphReader.ox(a)){var d=a.ja.first.Hc;if(!d||!d.length)return!1;if(2<=d.length)return a=4===d.J(0).hi,d=3===d.J(1).hi,a&&d}return!1}$nj(a){const d=a.ja.last.Hc,n=d.J(d.length-4),z=d.J(d.length-3),O=d.J(d.length-2),ca=d.J(d.length-1);d.remove(n);d.remove(z);d.remove(O);d.remove(ca);a.removeProperty(Qb.a.CQ)}Znj(a){const d=
a.ja.first.Hc,n=d.J(0),z=d.J(1);d.remove(n);d.remove(z);a.removeProperty(Qb.a.CQ)}xUg(a){if(a){var d=a.fa(Qb.a.CQ,null),n=a.fa(Qb.a.Ob,null).toString(),z=d;n==d&&this.sTi(a)&&(this.$nj(a),(a=Bd.ParagraphReader.qh(a,!1,!0))&&(z=a.fa(Qb.a.CQ,null)));n=new Dd.GraphIterator;n.set(a);n.La(8);k.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");for(var O;a&&a.ko&&z==d&&O!=a;){if(this.xTi(a)){this.Znj(a);break}this.Rnc.jUe(a);this.pq.Uc(n);z=this.pq.Mt(n,!1,!0);this.Ee.isb(a);if(!z)return null;
O=a;n.Va(2);z=(a=n.currentNode)?a.fa(Qb.a.CQ,null):null}return a}}OEi(a){var d=a.ja,n=d?d.length:0,z=null;a=new Vv(!0,!1,!1,0,8,!0,void 0);for(let O=0;O<n&&(z=this.TPl(d.J(O)),a.instruction=z,z=this.BNl(z),z[0]!==this.IAd);O++);d=z?z.length:0;for(n=1;n<d;n++)switch(z[n]){case "\\h":a.fcc=!0;break;case "\\u":a.Rig=!0;break;case "\\o":this.Wmn(z[n+1],a)&&n++;break;case "\\z":break;case "\\n":a.P5g=!1;a.soc.push(z[n]);break;default:a.soc.push(z[n])}return a}Wmn(a,d){return a&&(a=a.match(RegExp('^"([0-9])-([0-9])"$')))&&
3===a.length?(d.Lec=Number.parseInvariant(a[1])-1,d.Roc=Number.parseInvariant(a[2])-1,!0):!1}r6m(a){try{we.a(ej.z7m);const d=window.performance.now(),n=this.MEi(a);if(null==n){ej.Qxg("Attempt to remove TOC when firstTocPara = null");return}let z,O,ca;const Da=this.ewi();if(!({PKf:z,o5h:O}=this.ynj(n,Da)).response)return ej.Qxg("Failed to remove content control"),!1;if(void 0==z&&void 0==O)ca=this.xUg(n);else{ca=n.Ib.Ta(z);let zb=new Dd.GraphIterator;zb.set(ca);zb.La(8);a=!1;let Vb;for(;!a&&ca&&Vb!=
ca;){ca.id.equals(O)&&(a=!0);ca&&ca.ko&&this.Rnc.jUe(ca);this.pq.Uc(zb);const Fc=this.pq.Mt(zb,!1,!0);this.Ee.isb(ca);if(!Fc){ca=null;break}zb.Va(2);Vb=ca;ca=zb.currentNode}}ca&&this.tId(ca);const Xa=window.performance.now()-d;we.a(ej.aoj,!0,Xa)}catch(d){ej.Qxg(String.format("{0} {1}",d.message,d.stack))}return!0}tId(a){a=fe.a.Kb(a,0);a=new pa.Selection([a],!0);this.Da.setSelection(a)}TQf(a,d){return this.lr.Exa(a,d,null,ej.qcl,!0).returnValue?(k.ULS.sendTraceTag(573653840,3019,10,"Failed to create content control block for table of contents."),
!1):!0}VPk(){this.Rnc.SPl()||this.rxf.N5g()}MEi(a){if(!a.ko)return k.ULS.sendTraceTag(528320659,3019,15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;a=a.fa(Qb.a.CQ,null);return this.eN.aJl(a)}w1i(a){a.length&&(a=[Object.assign(new ba.a,{name:"UnsupportedSwitches",string:a.toString()})],we.a("UnsupportedTocInstruction",void 0,void 0,a))}TPl(a){const d=(a=a.Hc)?a.length:0;for(let n=0;n<d;n++)if(1===a.J(n).hi&&a.J(n).instruction.trim().startsWith(this.IAd))return a.J(n).instruction.trim();
return null}BNl(a){const d=[];if(!a)return d;a=a.split(" ");return a.length?a:d}E0k(a){a=this.Oci(a,null,!0,void 0).returnValue;if(!a)return ej.Tpb("Failed to create paragraph"),!1;const d=fe.a.Kb(a,0);if(!this.efj(d,!0,a.id,this.Tnc.instruction))return ej.Tpb("Failed to populate empty TOC"),!1;k.ULS.sendTraceTag(575447938,3019,50,"Created an empty table of contents.");return!0}Oci(a,d,n,z){let O,ca;n&&a?(O=this.R0k(a),ca=O.currentNode,z=Bd.ParagraphReader.gH(ca).toString()):d&&(O=this.VGl(d),ca=
this.Ee.vX(O));if(!ca)return k.ULS.sendTraceTag(592233798,3019,15,"Failed to insert paragraph for table of contents"),{returnValue:null,j6b:O};ca.setValue(Qb.a.CQ,z);return{returnValue:ca,j6b:O}}USm(){const a=new Sys.StringBuilder(this.IAd);a.append(" \\o \\z \\u");a.append(" \\h");return a.toString()}fTm(a){const d=new Sys.StringBuilder("PAGEREF ");d.append(a);this.Tnc.fcc&&d.append(" \\h");return d.toString()}VGl(a){a.kc();this.pq.Uc(a);return this.Ee.EIa(a,!1)}R0k(a){const d=new Dd.GraphIterator;
d.set(a.node);d.kc();this.pq.Uc(d);let n=this.vAi(d);const z=!a.cpBegin;if(Ia.OutlineElementReader.isEmpty(d,!0))return this.LNi(n);if(z)return this.Ee.BE(n,!0,!1),this.Ee.voa(d,n,a,!1,!1,!1),a=this.vAi(n),this.LNi(a);n=this.Ee.EIa(d);this.Ee.voa(d,n,a,!1,!1,!0);a=this.Ee.EIa(d);this.Ee.plc(a.currentNode,!1);this.Ee.vX(a);this.pq.Sd(a);return a}vAi(a){const d=new Dd.GraphIterator;d.Cb(a);d.kc();return d}LNi(a){this.Ee.BE(a,!0,!0);this.Ee.plc(a.currentNode,!1);this.pq.Sd(a);return a}p5i(a){const d=
a.ja;1===d.length&&(d.first.Le=!1,a.T3().Le=!0)}uPn(a,d,n,z,O){let ca=this.wwe(a);this.hc.replaceTextRange(ca,"");this.jfj(a,z,O);this.fRf(a,d,n,O.instruction);return O.fcc&&!this.vP(a,z.Ut)?!1:!0}XNi(a,d,n,z,O,ca){d=({j6b:a}=this.Oci(a,d,0==n,ca)).returnValue;if(!d)return{returnValue:!1,j6b:a};this.jfj(d,O,this.Tnc);this.fRf(d,n,z,this.Tnc.instruction);return this.Tnc.fcc&&!this.vP(d,O.Ut)?{returnValue:!1,j6b:a}:{returnValue:!0,j6b:a}}jfj(a,d,n){this.m5l(a,d.$Zl,d.Msa,d.rGj,d.B6a);this.lQh.A6l(a,
a.characterData.length);n.P5g&&this.a6l(a,d);this.p5i(a);this.Mon(a,d.rGj)}REl(a,d){if(!a)return 0;const n=ej.nRl();return 4<a.length?n.J(d)+.5*Math.floor(a.length/3):n.J(d)}m5l(a,d,n,z,O){n&&this.z5l(a,n,z);n=fe.a.Kb(a,a.characterData.length);this.hc.replaceTextRange(n,d);O&&(a=a.ja.Yg(0),this.Wd.n5(a.formatting,O))}z5l(a,d,n){n=this.REl(d,n);const z=fe.a.Kb(a,0);this.hc.replaceTextRange(z,d);this.lQh.A5l(a,d.length,n)}a6l(a,d){var n=fe.a.Kb(a,a.characterData.length);this.hc.replaceTextRange(n,d.Nj.toString());
n=a.ja.Yg(a.characterData.length-d.Nj.toString().length);d=this.fTm(d.Ut);this.B5a(a,n,0,2,d);this.B5a(a,n,1,2,d);this.B5a(a,n,2,2,d);n=a.ja.Yg(a.characterData.length);this.B5a(a,n,3,2,d)}Mon(a,d){d=this.fcf.Mf(d);this.Kz.hT(d,a,!0)}fRf(a,d,n,z){const O=a.ja.first,ca=a.ja.last;d?this.B5a(a,O,4,1,z):(this.B5a(a,O,0,1,z),this.B5a(a,O,1,1,z),this.B5a(a,O,2,1,z));d===n-1?this.B5a(a,ca,3,1,z):this.B5a(a,ca,5,1,z)}B5a(a,d,n,z,O=null){n=new vu.a(d,null,n,z,!0,!1,!1,O);d.Hc||(d.Hc=new DB.a(d));d.Hc.add(n);
a.$j();this.s5k(n,a)}s5k(a,d){uf.a.instance.J(6)&&(a.Qc?d.wordRunProperties.aQ(a.Qc-1,2):d.wordRunProperties.uma(a.Qc,2),d.wordRunProperties.Qo.$(a.Qc,as.CharacterPropertiesEditor.KI),d.wordRunProperties.ir.$(a.Qc,as.CharacterPropertiesEditor.EK))}vP(a,d){a=fe.a.createTextRange(a,0,a.characterData.length);return this.lk.vP(a,d,!1,!1,!1,!0)?!0:(k.ULS.sendTraceTag(592233799,3019,50,"Failed to create hyperlink for table of contents entries"),!1)}static nRl(){ej.fGa||(ej.fGa=new yb.a,ej.fGa.$("toc 1",
1),ej.fGa.$("toc 2",1.5),ej.fGa.$("toc 3",2),ej.fGa.$("toc 4",2.5),ej.fGa.$("toc 5",3),ej.fGa.$("toc 6",3.5),ej.fGa.$("toc 7",4),ej.fGa.$("toc 8",4.5),ej.fGa.$("toc 9",5));return ej.fGa}}ej.fGa=null;ej.qcl="Table of Contents";ej.T4k="CreateTocClient";ej.HSf="CreateTocSuccess";ej.U4k="CreateTocFailureCause";ej.NPn="UpdateTocClient";ej.Neh="UpdateTocSuccess";ej.OPn="UpdateTocFailureCause";ej.z7m="RemoveTocClient";ej.aoj="RemoveTocSuccess";ej.A7m="RemoveTocFailureCause";Object(t.a)(ej,"TOCField",null,
[293,294]);var ry=b(600);class Wv{constructor(a,d,n,z){this.aNa=a;this.n_a=d;this.Ja=n;this.dGa=z}A6l(a,d){if(Bd.ParagraphReader.nb(a)&&!(0>d)){var n=jq.a.Y3b(a);n=new ry.a(n,4,1,1);this.aNa.RDe(a,n);a=fe.a.Kb(a,d);this.n_a.fEe(a,this.dGa,this.Ja)}}A5l(a,d,n){var z=nn.a.NA/2;const O=a.ja.DFb(d);z=La.FormattingReader.jn(O.formatting,Vd.a.fontSize,2*z)/2;n=new ry.a(Wf.a.xE(z/36)*n,1,0,1);this.aNa.RDe(a,n);a=fe.a.Kb(a,d);this.n_a.fEe(a,this.dGa,this.Ja)}}Object(t.a)(Wv,"TOCTabUtility",null,[292]);class Sz{constructor(){this.Z=
null}get name(){return"WordEditor.TableOfContents"}Hb(a){this.Z=a;this.Z.ha("WordEditor.AutoSaveParamsUpdateService",()=>new CB.a(this.Z.resolve("Box4.Graph.IGraphIteratorFactory"),Mw.a.LX)).singleInstance();this.Z.ha("WordEditor.TableOfContents.StyleBasedDocumentHeadings",()=>new oq(new Nf.a(()=>Lb.App.oa.za.jc),jm.PageNavigator.instance,this.Z.resolve("Box4.Styles.IWACStyleReader"),this.Z.resolve("Box4.List.IListReader"),this.Z.resolve("Box4.IListMarkerUtility"),new Ls.a,new Nf.a(()=>Lb.App.oa.za.Rb))).as("WordEditor.TableOfContents.IDocumentHeadings").singleInstance();
this.Z.ha("WordEditor.TableOfContents.TOCDataManager",()=>new si(this.Z.resolve("WordEditor.TableOfContents.IDocumentHeadings"),this.Z.resolve("WordEditor.Bookmark.IBookmarkManager"))).as("Box4.ITOCDataManager").singleInstance();this.Z.ha("WordEditor.TableOfContents.TOCTabUtility",()=>new Wv(this.Z.resolve("WordEditor.ICustomTabStopUtility"),this.Z.resolve("Box4.IBlobEditor"),this.Z.resolve("Box4.IFeatureHelper"),this.Z.resolve("Box4.ITabPresenterFactory"))).as("WordEditor.TableOfContents.ITOCTabUtility").singleInstance();
this.Z.ha("WordEditor.TableOfContents.TOCField",()=>new ej(this.Z.resolve("Box4.ITOCDataManager"),this.Z.resolve("Box4.IOutlineElementEditor"),this.Z.resolve("Box4.IHyperlinkEditor"),this.Z.resolve("Box4.Styles.IWACStyleEditor"),this.Z.resolve("Box4.Styles.IWACStyleReader"),aj.a.instance,this.Z.resolve("Box4.ISelectionManager"),this.Z.resolve("Box4.ICharacterPropertiesEditor"),this.Z.resolve("WordEditor.TableOfContents.ITOCTabUtility"),this.Z.resolve("Box4.IFormattingEditor"),Wi.instance,this.Z.resolve("Box4.IFeatureHelper"),
this.Z.resolve("WordEditor.ContentControl.IContentControlManager"),this.Z.sa("WordEditor.ParagraphWordIdMapping"),this.Z.resolve("Box4.IOutlineElementNavigator"),jn.a.instance,l.AFrameworkApplication.tb,this.Z.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.TableOfContents.ITOCField").singleInstance();this.Z.ha("WordEditor.TableOfContents.TableOfContentsActor",()=>new pv(l.AFrameworkApplication.pa,this.Z.resolve("WordEditor.AutoSaveParamsUpdateService"),this.Z.resolve("Box4.IOutlineElementEditor"),
this.Z.resolve("Box4.Graph.IGraphIteratorFactory"),jn.a.instance,aj.a.instance,this.Z.resolve("WordEditor.TableOfContents.ITOCField"),this.Z.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.Z.resolve("Box4.IFeatureHelper"),this.Z.Ca("WordEditor.IPageNumberFinder"),a.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.TableOfContents.ITableOfContentsActor").singleInstance()}init(){this.Z.resolve("WordEditor.TableOfContents.ITableOfContentsActor").lb()}dispose(){}}Object(t.a)(Sz,
"PackageManager",null,[1,2]);class lo{constructor(a,d,n,z,O,ca,Da,Xa){this.Ph=a;this.Efe=d;this.ga=n;this.ghe=z;this.Nb=O;this.Xn=ca;this.Odk=Xa}lb(){this.jQc(Lb.App.P9a.Kbi())}jQc(a){this.ga.ma(Mb.a.gXa,Kb.a.view,a);this.ga.ma(Mb.a.gXa,Kb.a.table,Object(m.a)(this,this.gXa,"queryTableStyle"));this.ga.$b(Mb.a.gXa,1127);this.ga.ma(Mb.a.qqa,Kb.a.view,Object(m.a)(this,this.X0e,"tableStyleGenericViewActionHandler"));this.ga.ma(Mb.a.qqa,Kb.a.table,Object(m.a)(this,this.qqa,"applyTableStyle"));this.ga.$b(Mb.a.qqa,
1030);this.ga.ma(Mb.a.applyStyle,Kb.a.table,Object(m.a)(this,this.qqa,"applyTableStyle"));this.ga.ma(Mb.a.Uxa,Kb.a.view,Object(m.a)(this,this.X0e,"tableStyleGenericViewActionHandler"));this.ga.ma(Mb.a.Uxa,Kb.a.table,Object(m.a)(this,this.Uxa,"applyTableStyleOption"));this.ga.$b(Mb.a.Uxa,1038);this.ga.ma(Mb.a.DCa,Kb.a.view,a);this.ga.ma(Mb.a.DCa,Kb.a.table,Object(m.a)(this,this.DCa,"queryTableStyleOption"));this.ga.$b(Mb.a.DCa,1127);this.ga.ma(Mb.a.RKb,Kb.a.view,a);this.ga.ma(Mb.a.RKb,Kb.a.table,Object(m.a)(this,
this.RKb,"populateMenuMoreTableStyles"));this.ga.$b(Mb.a.RKb,1126);this.ga.ma(Mb.a.VCb,Kb.a.view,Object(m.a)(this,this.X0e,"tableStyleGenericViewActionHandler"));this.ga.ma(Mb.a.VCb,Kb.a.table,Object(m.a)(this,this.VCb,"clearTableFormatting"));this.ga.$b(Mb.a.VCb,1028)}UV(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const a=la.a.instance.Ca("Common.ISystemInitiatedFeedback");a&&a.execute(d=>{d.logActivity("WordEditorTablesUsageSupport",
"WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}gXa(a,d,n,z,O){if(!({BA:a}=this.FNb(d,n,O,!0,!0)).returnValue)return a;this.Efe.fci(O,d.node);return 32}DCa(a,d,n,z,O){return this.IIi(d,n,z,O,!0)}RKb(a,d,n,z,O){if(!({BA:a}=this.FNb(d,n,O,!1,!0)).returnValue)return a;this.Efe.m2k(O,d.node);k.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32}qqa(a,d,n,z,O){if(!({BA:z}=this.FNb(d,n,O,!1,!0)).returnValue)return 2==n&&8==z&&xs.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],
Jf.a.skb),z;const ca=d.node;let Da=null;(Da=a===Mb.a.qqa?this.Efe.npc(O[Yf.a.SourceControlId],ca):this.Ph.m$b(ca,O))?(this.QQe(ca,()=>{this.ghe.Y8a(Da,ca)}),this.UV(),z=32):(xs.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],Jf.a.skb),z=8);a===Mb.a.qqa&&32===z&&k.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");k.ULS.shipAssertTag(0,324,32===z);return z}Uxa(a,d,n,z,O){return this.IIi(d,n,z,O,!1)}IIi(a,d,n,z,O){if(!({BA:ca}=this.FNb(a,d,z,O,!0)).returnValue)return 2==
d&&8==ca&&xs.a.recordQosError("TableStyleOptionButtonClickNoResponse",["TableInteractionFailed"],Jf.a.Pmi),ca;a=a.node;d=this.Ph.U_(a);var ca=z[Yf.a.On];const Da=lo.gQl(z.MenuItemId);O?z[Yf.a.On]=lo.Qsn(d,Da):(this.uEk(d,Da,ca,a),n.vq=Da,n.lz=ca?0:1,k.ULS.shipAssertTag(0,324,!!Da));return 32}X0e(a,d,n,z,O){return Dp.a.mCa(a,d,n,z,O,{},14)}QQe(a,d){const n=this.Nb.Wb(15);try{n.Sa(a),this.Xn.B8a(),d()}finally{n&&n.dispose()}}FNb(a,d,n,z,O){return this.sgm(a,d,n,z,O)?{returnValue:z||2===d,BA:32}:{returnValue:!1,
BA:8}}sgm(a,d,n,z,O){if(a.contextId!==Kb.a.table)return!1;if(z||2===d)if(O&&!n||!Object(Uc.a)(Zi.TableNode,a.node)||this.Odk(a.node))return!1;return!0}uEk(a,d,n,z){const O=(512===d||1024===d?!n:n)?a|d:a&~d;O!==a&&this.QQe(z,()=>{this.ghe.bDa(O,z)})}VCb(a,d,n,z,O){if(!({BA:a}=this.FNb(d,n,O,!1,!1)).returnValue)return a;const ca=d.node;this.QQe(ca,()=>{this.ghe.x7h(ca)});return 32}static Fn(){lo.VAb[lo.$ll]=32;lo.VAb[lo.Ull]=128;lo.VAb[lo.hjm]=64;lo.VAb[lo.cjm]=256;lo.VAb[lo.sGk]=512;lo.VAb[lo.rGk]=
1024}static Qsn(a,d){a=!!(a&d);if(512===d||1024===d)a=!a;return a}static gQl(a){let d=0;a in lo.VAb&&(d=lo.VAb[a]);return d}}lo.$ll="buttonFirstRow";lo.Ull="buttonFirstColumn";lo.hjm="buttonLastRow";lo.cjm="buttonLastColumn";lo.sGk="buttonBandedRow";lo.rGk="buttonBandedColumn";lo.VAb={};Object(t.a)(lo,"TableStyleActor",null,[]);lo.Fn();var Tz=b(703);class yt extends Aq.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(t.a)(yt,"TableGalleryButtonProps",Aq.a,
[]);class Fx extends yt{constructor(){super()}get Type(){return 6}}Object(t.a)(Fx,"TableStyleGalleryButtonProps",yt,[]);class Uz{}Uz.hAm=2147483647;Object(t.a)(Uz,"TableStyleUtil",null,[]);class Es{constructor(a,d,n){this.vMf="Clear";this.N7b=null;this.tpk=a;this.Xb=d;this.Ph=n;this.YL=l.AFrameworkApplication.YL;this.ln=l.AFrameworkApplication.ln}bkb(){}Vuk(a,d){this.bkb(a);const n=this.Tsi(a),z=n.length;if(!(0>=z)){var O=Uz.hAm,ca=null;for(let zb=0;zb<z;zb++){var Da=n[zb],Xa=this.Ph.sQl(Da);O!==
Xa&&(O=Object.assign(new fi.a,{Id:"msMoreTableStyles"+Xa,Title:this.tQl(Xa),ControlList:[]}),ca=Object.assign(new Vq.a,{Type:6,Id:"galleryMoreTableStyles"+Xa,ExternalGalleryId:"TableStylesGallery",Width:Es.A8g,ElementDimensions:"Size64by48",GalleryItems:[]}),this.N7b&&(ca.ExternalId=this.N7b[Xa.toString()]),O.ControlList.push(ca),d.MenuSectionList.push(O),O=Xa);Xa=this.Xb.Lv(Da);Da=Es.R9g+zb;Xa=Object.assign(new Fx,{Id:Da,ExternalId:Da,Command:Mb.a.qqa.toString(),QueryCommand:Mb.a.gXa.toString(),
LabelText:Xa?w.a.Vd(Xa):"",Alt:Xa,VerticalCenterAlign:"true"});Xa.TableCellStyles=this.Uze(Da,a);Xa.TableStyles=this.Kwd(Da,a);ca&&ca.GalleryItems.push(Xa)}}}Uuk(a){const d=Object.assign(new fi.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),n=Object.assign(new Xg.a,{Id:"fseaClearTableFormatting",Command:Mb.a.VCb.toString(),LabelText:w.a.Vd(this.vMf),Alt:w.a.Vd(this.vMf),Image16by16:this.ln,Image16by16Class:Vf.getImageClassWithCluster(this.YL,
Es.SSk),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});d.ControlList.push(n);a.MenuSectionList.push(d)}fci(a,d){this.bkb(d);const n=a[Yf.a.SourceControlId];var z=this.npc(n,d);if(z){var O=this.Ph.gD(d);O=O?this.Xb.Jd(O):null;var ca=this.Xb.Lv(z);z=this.Xb.Jd(z);a[Dg.a.Alt]=ca;a[Dg.a.On]=z===O;d=Object.assign(new Fx,{Id:n,ExternalId:n,Command:Mb.a.qqa.toString(),QueryCommand:Mb.a.gXa.toString(),TableCellStyles:this.Uze(n,d),TableStyles:this.Kwd(n,d),Alt:ca});a[Dg.a.GalleryButtonProps]=d}else a[Dg.a.InnerHTML]=
null,a[Dg.a.Alt]=null,a[Dg.a.On]=!1,a[Dg.a.GalleryButtonProps]=null}Uze(a,d){this.bkb(d);return(a=this.npc(a,d))?this.tpk.eui(a,d):null}Kwd(a,d){this.bkb(d);return this.npc(a,d),null}m2k(a,d){a.MenuItems=this.wGl(d)}wGl(a){const d=Object.assign(new he.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.Vuk(a,d);this.Uuk(d);return d}npc(a,d){return a?a.startsWith(Es.R9g)?this.Sdg(parseInt(a.substr(Es.R9g.length)),d):this.rbn(parseInt(a.substr(Es.fCn.length)),d):null}}Es.R9g="buttonTableStyleMenu";
Es.fCn="buttonTableStyleRibbon";Es.A8g=7;Es.SSk="ClearTableStyle_16x16x32";Object(t.a)(Es,"ATableStyleRibbonControl",null,[367]);class Yu extends Es{constructor(a,d,n){super(null,d,n);this.xPh=a}fci(a,d){this.bkb(d);const n=a[Yf.a.SourceControlId];var z=this.npc(n,d);if(z){var O=this.Ph.gD(d);O=O?this.Xb.Jd(O):null;var ca=this.Xb.Lv(z);z=this.Xb.Jd(z);a[Dg.a.Alt]=ca;a[Dg.a.On]=z===O;d=Object.assign(new Fx,{Id:n,ExternalId:n,Command:Mb.a.qqa.toString(),QueryCommand:Mb.a.gXa.toString(),TableCellStyles:this.Uze(n,
d),TableStyles:this.Kwd(n,d),Alt:ca});a[Dg.a.GalleryButtonProps]=d}else a[Dg.a.InnerHTML]=null,a[Dg.a.Alt]=null,a[Dg.a.On]=!1,a[Dg.a.GalleryButtonProps]=null}Uze(a,d){this.bkb(d);return(a=this.npc(a,d))?this.xPh.eui(a,d,5,5):null}Kwd(a,d){this.bkb(d);return this.npc(a,d),null}}Object(t.a)(Yu,"ATableStyleRibbonControlVariableSizePreviews",Es,[]);var EB=b(1264),FB=b(976);class Nw{constructor(a,d,n,z){this.nk=a;this.qq=d;this.Rfb=n;this.WV=z;this.Y3j=new Nf.a(()=>this.wtl());this.wEa=new Nf.a(()=>this.vtl())}wtl(){const a=
{},d=l.AFrameworkApplication.isRtl;a.top="border-top";a.left=d?"border-right":"border-left";a.bottom="border-bottom";a.right=d?"border-left":"border-right";a.insideHorizontal="border-bottom";a.insideVertical=d?"border-left":"border-right";return a}vtl(){const a={};a[mg.a.nRa]=mg.a.yCb;a[mg.a.yCb]=mg.a.yCb;a[mg.a.Phb]=mg.a.Phb;return a}R_k(a,d,n,z){const O=new FB.a;O.rowCount=n;O.$Cb=z;O.x9a=this.Rfb.MPl(a);O.Lsb=a.fa(Qb.a.Lsb,1);O.vib=a.fa(Qb.a.vib,1);O.tableLook=d;O.N0e=1;return O}eui(a,d,n,z){if(!this.nk.Jd(a)||
!Object(Uc.a)(26,a)||!Object(Uc.a)(Cq.a,d))return null;const O=this.qq.U_(d);n=this.R_k(a,O,n,z);z=[];for(n.rowIndex=0;n.rowIndex<n.rowCount;n.rowIndex++)this.xwk(a,d,n,z);return z}Kwd(){return null}Pba(){}xwk(a,d,n,z){n.vIc=!n.rowIndex;for(n.cellIndex=0;n.cellIndex<n.$Cb;n.cellIndex++)this.Ptk(a,d,n,z)}Ptk(a,d,n,z){d=this.Rfb.cWk(n,this.Rfb.M6f(n),d,a);const O={};var ca=this.qq.jwe(a,d,Vd.a.fontColor,!0,zh.a.Z3(),!1);O.color=ca?ca:"inherit";ca=this.qq.jwe(a,d,Vd.a.BL,!0,zh.a.Z3(),!1);O["background-color"]=
ca?ca:"inherit";this.qq.zbc()&&this.Rwk(n,a,d,O);z.push(O)}Rwk(a,d,n,z){a=this.Rfb.pTa(a);this.Uhe(5,a,d,n,z);this.Uhe(3,a,d,n,z);this.Uhe(0,a,d,n,z);this.Uhe(4,a,d,n,z)}Uhe(a,d,n,z,O){d=this.Iyl(a,d,n,z);d!==mg.a.XJ&&(O[this.Y3j.value[EB.a[a]]]=d)}Iyl(a,d,n,z){let O=mg.a.XJ;if(({aya:O}=this.qZa(z,a,1,d,Object(m.a)(this,this.xtl,"getBorderPropertyValueFromConditionalStyle"),O)).returnValue)return O;({aya:O}=this.qZa(n,a,3,d,Object(m.a)(this,this.ytl,"getBorderPropertyValueFromTableStyle"),O));return O}qZa(a,
d,n,z,O,ca){return this.WV.OAj(n,d,z)&&(ca=O(a,d))!==mg.a.XJ||!d&&({aya:ca}=this.qZa(a,1,n,z,O,ca)).returnValue||4===d&&({aya:ca}=this.qZa(a,2,n,z,O,ca)).returnValue?{returnValue:!0,aya:ca}:{returnValue:ca!==mg.a.XJ,aya:ca}}ytl(a,d){return this.getBorder(a,this.WV.pS(d))}xtl(a,d){return this.getBorder(a,this.WV.XU(d))}getBorder(a,d){let n="",z,O;({borderStyle:z,borderWidth:O}=this.Atl(a,d,z,O));if(z===mg.a.Phb)return n;n=String.format(mg.a.Gzc,O,z,this.otl(a,d));return n.trim()}otl(a,d){if(!d)return mg.a.FR;
a=this.qq.V7b(a,d.color,zl.a.auto);return a!==zl.a.auto?zl.a.LA(a):mg.a.FR}Atl(a,d,n,z){n=mg.a.p3;z=mg.a.YJ+mg.a.zCb;if(!d)return{borderStyle:n,borderWidth:z};n=this.qq.V7b(a,d.style,mg.a.Phb);a=this.qq.V7b(a,d.size,mg.a.YJ);z=this.ztl(n,a)+mg.a.zCb;n=this.ptl(n);return{borderStyle:n,borderWidth:z}}ztl(a,d){let n=2;a===mg.a.Kzc&&d<mg.a.Zxa&&(n=1);return n}ptl(a){return this.wEa.value[a]||mg.a.x2a}static uQl(){return new Nw(la.a.instance.resolve("Box4.Styles.IWACStyleReader"),la.a.instance.resolve("WordEditor.IWACTableStyleReader"),
Wr.a.instance,mg.a.instance)}static get instance(){return Nw.Kh||(Nw.Kh=Nw.uQl())}}Nw.Kh=null;Object(t.a)(Nw,"TableStylePreviewGenerator",null,[371]);var qv;(function(a){a[a.f_n=0]="background1";a[a.h$n=1]="text1";a[a.g_n=2]="background2";a[a.i$n=3]="text2";a[a.CZn=4]="accent1";a[a.DZn=5]="accent2";a[a.EZn=6]="accent3";a[a.FZn=7]="accent4";a[a.GZn=8]="accent5";a[a.HZn=9]="accent6";a[a.hyperlink=10]="hyperlink";a[a.A2n=11]="followedHyperlink";a[a.B0n=12]="dark1";a[a.O4n=13]="light1";a[a.C0n=14]="dark2";
a[a.P4n=15]="light2";a[a.none=16]="none";a[a.max=17]="max"})(qv||(qv={}));Object(t.b)("ThemeColor",qv);class rv{constructor(a){this.DOa=a}Prl(a,d,n){let z;({xjj:d,r0h:z}=this.HLl(d));a=[];const O=[];for(let Da=0;16>Da;Da++){if(!(qv[Da]in n.U0b))continue;const Xa=Da,zb=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,WoncaIntl.WoncaStrings[z[Xa]],this.RDl(Da));var ca=d[Xa];ca=ca&4278190080|(ca&255)<<16|ca&65280|(ca&16711680)>>>16;O.push(Object.assign(new Sm.a,{Color:Xa.toString(),DisplayColor:"#"+
w.a.Ev(ca,6),Alt:w.a.Vd(zb)}));a[a.length]=Da}return{returnValue:O,CDn:a}}RDl(a){switch(a){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;
case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}HLl(a){let d=null,n=null;a=this.DOa(a);if(!a)return{xjj:d,r0h:n};d=a.properties.fa(Qb.a.themeColors,null);n=a.properties.getValue(Qb.a.uYd).split(" ");return{xjj:d,r0h:n}}static wQl(){return new rv(Object(m.a)(rv.Ze,rv.Ze.kt,"navigateToPageContentNode"))}static get Ze(){return jm.PageNavigator.instance}static get instance(){return rv.Kh||(rv.Kh=rv.wQl())}}rv.Kh=null;Object(t.a)(rv,"TableStyleThemeHelper",null,[401]);var sy=b(774);
class Zu{constructor(a,d){this.Dwf={};this.U0b={};this.Xb=a;this.Ph=d}u_f(a,d){const n=this.Dwf[qv[d]];return n&&n.length?n:this.$pl(a,d)}Eyi(a,d,n){if(d=this.u_f(d,n))for(a=this.Xb.Jd(a),n=0;n<d.length;n++)if(this.Xb.Jd(d[n])===a)return n;return-1}Pba(){this.Dwf={};this.U0b={}}$pl(a,d){const n=[];this.U0b={};a=this.Ph.Z4a(a);this.Bje(n,this.U0b,0,d,a);this.Bje(n,this.U0b,1,d,a);this.Bje(n,this.U0b,2,d,a);this.Bje(n,this.U0b,3,d,a);return this.Dwf[qv[d]]=n}Bje(a,d,n,z,O){const ca=O.Oz;for(let Da=
0;Da<ca;Da++){const Xa=O.$X(Da);if(3!==this.Xb.Mv(Xa))continue;const zb=this.Ph.rQl(Xa),Vb=this.Ph.Jwd(Xa);d[qv[Vb]]=!0;zb!==n||Vb!==z&&16!==Vb||this.Xb.Jd(Xa)===sy.a.B1d||(a[a.length]=Xa)}}static jTl(){return new Zu(la.a.instance.resolve("Box4.Styles.IWACStyleReader"),la.a.instance.resolve("WordEditor.IWACTableStyleReader"))}static m5k(){return Zu.jTl()}}Object(t.a)(Zu,"WACTableStyleRibbonList",null,[399]);class $u extends Yu{constructor(a,d,n,z,O){super(a,d,n);this.Brc=4;this.Vfe=[];this.upk=O;
this.Ixc=z;this.vMf=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.uRm()}L_k(a,d){a.MenuItems=this.vpl(d)}uRm(){this.N7b={};this.N7b["0"]="CustomTableStyles";this.N7b["1"]="PlainTableStyles";this.N7b["2"]="GridTableStyles";this.N7b["3"]="ListTableStyles"}vpl(a){const d=Object.assign(new he.a,{Id:"menuTableTheme"});d.MenuSectionList=[];if(this.Rfm(a))return d;const n=Object.assign(new fi.a,{Id:"msTableStyleTheme",ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),z=Object.assign(new Tz.a,
{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:Dc.a.eCb.toString(),QueryCommand:Dc.a.Dic.toString(),Width:$u.DDn});z.Colors=({CDn:this.Vfe}=this.upk.Prl(this.Vfe,a,this.Ixc)).returnValue;n.ControlList.push(z);d.MenuSectionList.push(n);return d}bkb(a){if(a=this.Ph.gD(a))a=this.Ph.Jwd(a),16!==a&&(this.Brc=a)}Tsi(a){return this.Ixc.u_f(a,this.Brc)}Sdg(a,d){d=this.Ixc.u_f(d,this.Brc);return 0>a||a>=d.length?null:d[a]}rbn(a,d){var n=this.Ph.gD(d);n=this.Ixc.Eyi(n,d,this.Brc);
n=-1!==n?Math.floor(n/Es.A8g)*Es.A8g:0;return this.Sdg(n+a,d)}tQl(a){switch(a){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;default:return""}}Rfm(a){this.bkb(a);return 0>=this.Tsi(a).length}IPn(a,d){if(!a||!d)return null;a=parseInt(a[Gm.Color]);var n=this.Ph.gD(d);
const z=this.Ph.Jwd(n);if(z===a)return null;if(16===z)return this.Brc=a,null;n=this.Ixc.Eyi(n,d,z);this.Brc=a;return this.Sdg(n,d)}C$k(a){a=this.Ph.gD(a);a=this.Ph.Jwd(a);if(16!==a)for(let d=0;d<this.Vfe.length;d++)if(this.Vfe[d]===a)return d;return-1}wyc(a){a.Cfd(Object(m.a)(this,this.o7l,"invalidateStyles"),2)}o7l(){this.Ixc.Pba();this.xPh.Pba()}static vQl(){return new $u(Nw.instance,la.a.instance.resolve("Box4.Styles.IWACStyleReader"),la.a.instance.resolve("WordEditor.IWACTableStyleReader"),Zu.m5k(),
rv.instance)}static get instance(){return $u.Kh||($u.Kh=$u.vQl())}}$u.DDn=4;$u.Kh=null;Object(t.a)($u,"TableStyleRibbonControls",Yu,[366,367]);var Yy=b(1390);class sv extends lo{constructor(a,d,n,z,O,ca,Da,Xa){super(a,d,n,z,O,ca,Da,Xa)}jQc(a){super.jQc(a);this.ga.ma(Dc.a.eCb,Kb.a.view,Object(m.a)(this,this.X0e,"tableStyleGenericViewActionHandler"));this.ga.ma(Dc.a.eCb,Kb.a.table,Object(m.a)(this,this.eCb,"applyTableTheme"));this.ga.$b(Dc.a.eCb,1030);this.ga.ma(Dc.a.cPc,Kb.a.view,a);this.ga.ma(Dc.a.cPc,
Kb.a.table,Object(m.a)(this,this.cPc,"populateMenuTableTheme"));this.ga.$b(Dc.a.cPc,1126);this.ga.ma(Dc.a.Dic,Kb.a.view,a);this.ga.ma(Dc.a.Dic,Kb.a.table,Object(m.a)(this,this.Dic,"queryTableTheme"));this.ga.$b(Dc.a.Dic,1127)}cPc(a,d,n,z,O){if(!({BA:a}=this.FNb(d,n,O,!1,!0)).returnValue)return a;this.S9g.L_k(O,d.node);return 32}eCb(a,d,n,z,O){if(!({BA:a}=this.FNb(d,n,O,!1,!0)).returnValue)return 2==n&&8==a&&xs.a.recordQosError("TableStyleColorButtonClickNoResponse",["TableInteractionFailed"],Jf.a.Qmi),
a;const ca=d.node,Da=this.S9g.IPn(O,ca);Da&&this.QQe(ca,()=>{this.ghe.Y8a(Da,ca)});return 32}Dic(a,d,n,z,O){if(!({BA:a}=this.FNb(d,n,O,!0,!0)).returnValue)return a;O[Gm.IndexColorSelected]=this.S9g.C$k(d.node);return 32}get S9g(){return this.Efe}static qQl(){return new sv(la.a.instance.resolve("WordEditor.IWACTableStyleReader"),$u.instance,l.AFrameworkApplication.pa,Yy.a.instance,new jn.a,la.a.instance.resolve("Box4.IInsertionPointFormatting"),la.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Object(m.a)(aj.a.instance,aj.a.instance.fBa,"isTableNodeInLockedRange"))}static get instance(){return sv.Kh||(sv.Kh=sv.qQl())}}sv.Kh=null;Object(t.a)(sv,"TableStyleActor",lo,[]);var Vz=b(1437);class Zy{constructor(){this.Z=null}get name(){return"WordEditor.TableStyle"}Hb(a){this.Z=a;this.Z.ha("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>Nw.instance).singleInstance();this.Z.ha("Box4.TableEditors.ITableStyleEditor",()=>Vz.a.instance).singleInstance();this.Z.ha("Box4.TableEditors.IWACTableStyleEditor",
()=>Yy.a.instance).singleInstance()}init(){this.Z.resolve("Box4.IFeatureHelper").tk.continueWith(()=>{this.Po()})}Po(){this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(185)&&(sv.instance.lb(),$u.instance.wyc(Jt.a.instance),Gh.StyleReader.FOb=Vz.a.instance,Lb.App.oa.updateCommandUI())}dispose(){}}Object(t.a)(Zy,"TableStylePackage",null,[1,2]);var Wz=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordEditorHeaderToolbar",
ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},children:[{name:"ButtonDock",
attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",QueryCommand:"0xA99F5B15",
TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},
{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},children:[{name:"Menu",
attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",
MenuItemId:"HeaderToolbarButtonFirstPage",Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",
attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",
MenuItemId:"HeaderToolbarButtonRemovePageNumbers",Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},
Xz=b(1260);class PA{constructor(a,d){this.q0a=a;this.UMa=d}R3m(a){this.q0a.Fie(a)}ORa(a){this.UMa.ORa(a)}Tlc(a,d){return this.UMa.Tlc(a,d)}Slc(a,d){return this.UMa.Slc(a,d)}cbh(a,d,n){this.UMa.cbh(a,d,n)}}Object(t.a)(PA,"ClientPaginationHeaderFooterBridge",null,[391]);class Gx{constructor(a,d){this.Zm=a;this.ga=d;this.Tja=new hn.a;this.Uja=new hn.a}ORa(a){a=Dd.GraphIterator.ua(a);if(a.tn()&&a.Sr()){a.Rc();do 10===a.Yc&&this.fNg(a.currentNode),a.Fs();while(8!==a.Yc)}}Tlc(a,d){var n=this.f$b(d);if(!this.Tja.Na(n))return k.ULS.sendTraceTag(573400388,
3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+n),!1;d=this.Tja.J(n);k.ULS.shipAssertTag(573400389,336,this.Uja.Na(n),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");n=this.Uja.J(n);return this.Igg(d,a,n)}Slc(a,d){var n=this.f$b(d);if(!this.Tja.Na(n))return k.ULS.sendTraceTag(573400390,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+n),!1;d=
this.Tja.J(n);k.ULS.shipAssertTag(573400391,336,this.Uja.Na(n),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");n=this.Uja.J(n);return this.$2f(d,a,n)}cbh(a,d,n){d=this.Lcg(d,n);this.ga.ob(a?Dc.a.B4e:Dc.a.V0d,2,d)}Lcg(a,d){d=this.Zm.v9b(d);if(!d)return k.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),0;d=this.Zm.Uza(d);const n=1===a;a=!(a%2);return 1===d?1:2===d?n?2:1:3===d?a?3:4:
n?2:a?3:4}fNg(a){if(10===a.type){var d=new hn.a,n=this.Zm.v9b(a);k.ULS.shipAssertTag(573400393,336,!!n,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var z=this.Zm.Uza(n);a=this.f$b(a);this.weh(a,z);this.veh(a,d);n=Dd.GraphIterator.ua(n);if(n.Sr()){n.Rc();do a=n.currentNode,z=this.Zm.zxe(a),a=this.Zm.WJi(a),d.add(z,a),n.Fs();while(36===n.Yc)}}}weh(a,d){this.Uja.Na(a)?this.Uja.$(a,d):this.Uja.add(a,d)}veh(a,d){this.Tja.Na(a)?
this.Tja.$(a,d):this.Tja.add(a,d)}f$b(a){k.ULS.shipAssertTag(573400395,336,10===a.type,"Expected node of type Outline but received node of type "+a.type);return a.fa(Qb.a.Wca,0)}Igg(a,d,n){const z=1===d;d=!(d%2);switch(n){case 2:if(z){if(a.Na(2))return a.J(2)}else if(a.Na(0))return a.J(0);break;case 3:if(d){if(a.Na(1))return a.J(1)}else if(a.Na(0))return a.J(0);break;case 4:if(z){if(a.Na(2))return a.J(2)}else if(d){if(a.Na(1))return a.J(1)}else if(a.Na(0))return a.J(0);break;case 1:if(a.Na(0))return a.J(0)}return!1}$2f(a,
d,n){const z=1===d;d=!(d%2);switch(n){case 2:if(z){if(a.Na(5))return a.J(5)}else if(a.Na(3))return a.J(3);break;case 3:if(d){if(a.Na(4))return a.J(4)}else if(a.Na(3))return a.J(3);break;case 4:if(z){if(a.Na(5))return a.J(5)}else if(d){if(a.Na(4))return a.J(4)}else if(a.Na(3))return a.J(3);break;case 1:if(a.Na(3))return a.J(3)}return!1}}Object(t.a)(Gx,"ClientPaginationPageAdornmentContentManager",null,[390]);class ty{constructor(a,d,n,z,O,ca){this.rJ=a;this.Zm=d;this.mc=n;this.Nb=z;this.N2c=O;this.ga=
ca}uun(){const a=new $g.StandardDialog;a.wc=1;a.ee(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);a.j5(0);a.iu(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,Object(m.a)(this,this.QWk,"confirmDialogClickActionHandler"))}QWk(a){1===a&&this.rJ.hI&&(a=this.mc.CTa(this.rJ.hI,8,8),this.Zm.NNk(a)?this.I8k(a):this.kun())}I8k(a){a.tc(8);const d=this.Nb.Wb(15);d.set(a.Hm.Bf);this.N2c.B5m(a);this.rJ.dismiss();d.dispose();
k.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}kun(){const a=new $g.StandardDialog;a.wc=1;a.ee(1,Box4Intl.Box4Strings.L_OpenInWord);a.ee(0,CommonUIStrings.l_Close);a.j5(0);a.iu(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,0,Object(m.a)(this,this.QIn,"unableToDeleteActionHandler"));k.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}QIn(a){1===a&&this.ga.ob(Mb.a.openInClient,2,!1)}}Object(t.a)(ty,
"DeleteHeaderFooterDialog",null,[]);class Xv{constructor(a,d,n,z,O){this.Zm=a;this.mc=d;this.Nb=n;this.N2c=z;this.ga=O}create(a){return new ty(a,this.Zm,this.mc,this.Nb,this.N2c,this.ga)}}Object(t.a)(Xv,"DeleteHeaderFooterDialogFactory",null,[389]);class Hx{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb){this.ija=null;this.ga=a;this.Zm=d;this.N2c=n;this.r0a=z;this.Nl=O;this.mc=ca;this.Nb=Da;this.nqk=Xa;this.bak=zb;this.c7j=Vb}get control(){return this.ija}set control(a){this.ija=a}lb(){this.ga.ma(Dc.a.UDe,
Kb.a.view,Object(m.a)(this,this.pah,"toggleHeaderFooter"));this.ga.Aa(Dc.a.dQg,Kb.a.application,Object(m.a)(this,this.zXm,"queryInsertHeaderFooterToggleButton"),96);this.ga.ma(Dc.a.B4e,Kb.a.view,Object(m.a)(this,this.pah,"toggleHeaderFooter"));this.ga.ma(Dc.a.V0d,Kb.a.view,Object(m.a)(this,this.pah,"toggleHeaderFooter"));this.ga.Aa(Dc.a.yCe,Kb.a.view,Object(m.a)(this,this.yCe,"headerFooterContentDirtied"),64);this.ga.ma(Dc.a.vre,Kb.a.view,Object(m.a)(this,this.vre,"displayHeaderFooter"));this.ga.Aa(Dc.a.e7,
Kb.a.application,Object(m.a)(this,this.e7,"dismissHeaderFooter"),96);this.ga.Aa(Dc.a.$dc,Kb.a.application,Object(m.a)(this,this.$dc,"launchHeaderFooterForNode"),96);this.ga.Aa(Dc.a.xin,Kb.a.view,Object(m.a)(this,this.MKa,"setActiveTemplate"),96);this.ga.ma(Dc.a.Fvj,Kb.a.view,Object(m.a)(this,this.MKa,"setActiveTemplate"));this.ga.ma(Dc.a.Hvj,Kb.a.view,Object(m.a)(this,this.MKa,"setActiveTemplate"));this.ga.ma(Dc.a.Gvj,Kb.a.view,Object(m.a)(this,this.MKa,"setActiveTemplate"));this.ga.ma(Dc.a.Ivj,Kb.a.view,
Object(m.a)(this,this.MKa,"setActiveTemplate"));this.ga.Aa(Dc.a.eln,Kb.a.view,Object(m.a)(this,this.oNb,"setTemplateMode"),100);this.ga.Aa(Dc.a.nxj,Kb.a.view,Object(m.a)(this,this.oNb,"setTemplateMode"),4);this.ga.Aa(Dc.a.mxj,Kb.a.view,Object(m.a)(this,this.oNb,"setTemplateMode"),4);this.ga.Aa(Dc.a.kxj,Kb.a.view,Object(m.a)(this,this.oNb,"setTemplateMode"),4);this.ga.Aa(Dc.a.lxj,Kb.a.view,Object(m.a)(this,this.oNb,"setTemplateMode"),4);this.ga.ma(Dc.a.$We,Kb.a.view,Object(m.a)(this,this.$We,"setActiveHeaderFooterSection"));
this.ga.ma(Dc.a.E_g,Kb.a.view,Object(m.a)(this,this.$We,"setActiveHeaderFooterSection"));this.ga.Aa(Dc.a.gNg,Kb.a.view,Object(m.a)(this,this.gNg,"populateHeaderToolbarSectionFlyout"),96);this.ga.Aa(Dc.a.jVf,Kb.a.view,Object(m.a)(this,this.jVf,"deleteAllHeadersAndFooters"),4);this.ga.Aa(Dc.a.fhj,Kb.a.view,Object(m.a)(this,this.jSe,"queryActiveTemplate"),97);this.ga.Aa(Dc.a.hhj,Kb.a.view,Object(m.a)(this,this.jSe,"queryActiveTemplate"),97);this.ga.Aa(Dc.a.ghj,Kb.a.view,Object(m.a)(this,this.jSe,"queryActiveTemplate"),
97);this.ga.Aa(Dc.a.ihj,Kb.a.view,Object(m.a)(this,this.jSe,"queryActiveTemplate"),97);this.ga.Aa(Dc.a.yhj,Kb.a.view,Object(m.a)(this,this.iTe,"queryTemplateMode"),97);this.ga.Aa(Dc.a.xhj,Kb.a.view,Object(m.a)(this,this.iTe,"queryTemplateMode"),97);this.ga.Aa(Dc.a.vhj,Kb.a.view,Object(m.a)(this,this.iTe,"queryTemplateMode"),97);this.ga.Aa(Dc.a.whj,Kb.a.view,Object(m.a)(this,this.iTe,"queryTemplateMode"),97);this.ga.Aa(Dc.a.tXm,Kb.a.view,Object(m.a)(this,this.EXm,"querySectionLabel"),97);this.ga.Aa(Dc.a.NPg,
Kb.a.view,Object(m.a)(this,this.bXm,"queryActiveSection"),97)}pah(a,d,n,z,O){var ca=this.eeg(d);return ca?1===n?32:(n=this.control)?(d=this.Nb.Wb(15),d.Sa(ca),d.om=a,n.gra?this.ga.processAction(Dc.a.e7,2):(ca=this.ali(ca),z.vq=ca?1:0,z=a!==Dc.a.V0d,(a=this.Y8f(a,O))&&n.MKa(a),this.ga.ob(Dc.a.vre,2,z)),d.dispose(),32):8:8}jVf(a,d,n){if(1===n)return 32;this.c7j.create(this.control).uun();return 32}ali(a){const d=this.Zm.v9b(a),n=this.Zm.Uza(d);a=this.r0a.r_f(a,n);this.control.nra(d);return a}zXm(a,
d,n,z,O){return 1===n?32:(a=this.control)?(O[Yf.a.On]=a.gra,32):8}oNb(a,d,n,z,O){if(1===n||!this.control.gra)return 32;d=this.$xi(a,O);n=Hx.JGi(this.control.hI);z=this.Nb.Wb(15);z.Sa(n);z.om=a;a=this.mc.Sl();a.set(n);this.r0a.r_f(a.currentNode,d);this.Zm.Bfc(a);this.N2c.gzj(a,d);z.dispose();return 32}$xi(a,d){switch(a){case Dc.a.nxj:case Dc.a.yhj:a=1;break;case Dc.a.mxj:case Dc.a.xhj:a=2;break;case Dc.a.kxj:case Dc.a.vhj:a=3;break;case Dc.a.lxj:case Dc.a.whj:a=4;break;default:a=d}return a}MKa(a,d,
n,z,O){if(1===n)return 32;a=this.Y8f(a,O);this.control.gra&&this.control.MKa(a);return 32}Y8f(a,d){switch(a){case Dc.a.Fvj:case Dc.a.fhj:a=1;break;case Dc.a.Hvj:case Dc.a.hhj:a=2;break;case Dc.a.Gvj:case Dc.a.ghj:a=3;break;case Dc.a.Ivj:case Dc.a.ihj:a=4;break;case Dc.a.B4e:case Dc.a.V0d:a=d;break;case Dc.a.UDe:a=0;break;default:a=d}return a}$We(a,d,n,z,O){if(1===n)return 32;a=this.CDi(a,O);z.vq=a;d=this.eeg(d);if(!d)return 8;z=this.mc.Sl();z.set(d);z.La(8);z.Rn(8);if(!this.Nl.z5i(z,a))return 8;this.Zm.Bfc(z);
this.control.nra(z.currentNode);return 32}CDi(a,d){return a===Dc.a.E_g||a===Dc.a.NPg?parseInt(d.MenuItemId):d}eeg(a){return this.Nl.kIa(a.Am)}gNg(a,d,n,z,O){if(1===n)return 32;a=this.nqk.d4k(this.eeg(d));O.PopulationXML=a;return 32}iTe(a,d,n,z,O){a=this.$xi(a,O);d=this.control.hI;n=this.Zm.Uza(d);O[Yf.a.On]=a===n;1===a&&(O[Yf.a.LabelText]=this.uHi(d)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32}QCn(a,d){switch(d){case 1:return!1;
case 2:return 1===a||2===a;case 4:return 4===a||2===a||3===a;case 3:return 4===a||3===a}return!0}jSe(a,d,n,z,O){if(1===n||!this.control.gra)return 32;d=this.control.hI;void 0!==d&&null!==d&&(d=this.Zm.Uza(d),a=this.Y8f(a,O),n=this.control.Drc,O[Yf.a.Visible]=this.QCn(a,d),O[Yf.a.On]=a===n);return 32}EXm(a,d,n,z,O){if(1===n||!this.control.gra)return 32;a=this.control.hI;void 0!==a&&null!==a&&this.JRm(a,O);return 32}JRm(a,d){const n=this.uHi(a);if(d[hh.a.Visible]=n)a=this.Nl.feg(this.bak(a)),a=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,
a),d[hh.a.LabelText]=a}uHi(a){const d=this.mc.Sl();d.set(a);d.La(8);d.Rn(8);return 1<this.Nl.oAe(d)}bXm(a,d,n,z,O){if(1===n||!this.control.gra)return 32;a=this.CDi(a,O);d=this.control.hI;n=0;void 0!==d&&null!==d&&(n=d.getValue(Qb.a.Wca));O[Yf.a.On]=a===n;return 32}e7(a,d,n){if(1===n)return 32;this.control.dismiss();return 32}yCe(){return 32}vre(a,d,n,z,O){if(1===n)return 32;this.control.show(O);return 32}$dc(a,d,n,z,O){if(1===n)return 32;if(!O)return 8;d=O.Jib;if(!d||!d.isConnected)return 8;a=this.Zm.CDg(d);
if(!({isHeader:n,v$g:d}=this.Zm.tFi(d)).returnValue)return 8;this.control.nra(a);this.control.MKa(d);this.control.show(n,O.RYe);return 32}static JGi(a){const d=new Dd.GraphIterator;d.set(a);d.La(10);return Zt.WordSectionNavigator.Brj(d)}}Object(t.a)(Hx,"HeaderFooterActor",null,[]);var Ix=b(568),tv=b(686);class $y{constructor(a,d,n,z,O){this.Dgk=a;this.Zm=d;this.Nl=n;this.mc=z;this.ga=O}Nki(a,d){this.Zm.Bfc(a);d=this.Ifl(a,d);a.hb();return d}r_f(a,d){a=this.mc.CTa(a,8,8);let n=!1;this.Nl.vza(a,z=>
{const O=this.mc.Sl();O.set(z);n=(z=this.Nki(O,d))||n;return z});return n}Ifl(a,d){if(3!==this.ga.mode)return!1;let n=!1;d=tv.a.UVf(d);for(let z=0;z<d.length;++z)n=this.Dgk.Hfl(a,d[z])||n;return n}}$y.K7k=1;Object(t.a)($y,"HeaderFooterInserter",null,[382]);class av{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc){this.qNh=this.buh=!1;this.hI=null;this.kjf=!1;this.Drc=0;this.aea=a;a.bind(this);this.uyf=z;this.y7j=zb;this.AHh=O;this.hhk=ca;this.Lyb=Da;this.header=d;this.footer=n;this.header.X4k();this.aea.jC();
this.Rwf=$y.K7k;this.r0a=Xa;av.ga=Vb;this.rZ=Fc}get gra(){return this.buh}show(a=!0,d=!0){this.gra||(this.rQj(),this.Kwj(!0),this.header.O1m(),this.y7j(),this.gzn(),l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.Qma&&appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new Ix.a,{state:0,disablePopover:!0}))));(this.qNh=d)&&this.AHh(a)}dismiss(a=!1){this.gra&&(this.hhk(a),this.Kwj(!1),this.F6b(),this.Drc=0,this.dAn(),l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.Qma&&
appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new Ix.a,{disablePopover:!1}))))}Kwj(a){this.buh=a;av.ga.processAction(Mb.a.mve,2);this.aea.E8(a);this.header.E8(a);this.footer.E8(a);this.uyf()}nra(a){this.hI!==a&&(this.hI=a,this.header.nra(a),this.footer.nra(a),this.Drc=0,this.oNb(this.Lyb.Uza(a)))}F6b(){this.hI&&(this.header.RDb(),this.footer.RDb(),this.hI=null)}update(){this.gra&&this.B3e()}B3e(){this.hI&&(this.Lyb.Hcl(this.hI)&&this.Lyb.PZl(this.hI)?this.rQj():this.dismiss())}rQj(){const a=
this.Lyb.Uza(this.hI);a!==this.Rwf&&this.oNb(a)}oNb(a){this.Rwf=a;this.MKa(this.MQl(a))}MQl(a){switch(a){case 2:return 2;case 3:return 3;case 4:return 2}return 1}MKa(a,d=!0){this.Drc!==a&&(this.r0a.r_f(this.hI,this.Rwf),this.header.Evj(a),this.header.q_h(og.AppFrame.jga),this.footer.Evj(a),this.footer.q_h(og.AppFrame.Ufa),this.Drc=a,this.gra&&this.qNh&&this.hgl(d))}hgl(a){this.AHh(a);a?this.header.setInitialSelection():this.footer.setInitialSelection()}dispose(){this.aea.jia();this.header.dispose();
this.footer.dispose()}gzn(){this.rZ.ggd(Object(m.a)(this,this.j7a,"onContentDirtied"));this.kjf=!1}dAn(){this.rZ.BUe(Object(m.a)(this,this.j7a,"onContentDirtied"));this.kjf&&av.ga.processAction(Dc.a.yCe,2)}j7a(){this.kjf=!0}static Ral(){av.ga.ob(Sa.a.cnb,2,!0);av.ga.processAction(Dc.a.fra,2)}}av.ga=null;Object(t.a)(av,"HeaderFooterControl",null,[410,12]);class az{constructor(a,d,n,z,O){this.uyf=a;this.Lyb=d;this.r0a=n;this.ga=z;this.rZ=O}create(a,d,n,z,O){return new av(a,d,n,this.uyf,z,O,this.Lyb,
this.r0a,av.Ral,this.ga,this.rZ)}}Object(t.a)(az,"Factory",null,[388]);class Ow{constructor(){this.ija=null}get control(){return this.ija}set control(a){this.ija=a}s4f(a){return this.t4f(this.control.hI,this.control.Drc,a.isHeader,a)}t4f(a,d,n,z){return()=>{if(!a.isConnected)return null;this.control.nra(a);this.control.MKa(d);this.control.show(n);return z}}dismiss(){this.ija.gra&&this.ija.dismiss()}}Object(t.a)(Ow,"HeaderFooterControlLauncher",null,[]);var BC=b(1007),sn=b(368),CC=b(735);class Kt{constructor(a,
d,n){this.EUc=null;const z=d?"Header":"Footer";this.Ym=a.ownerDocument.createElement("div");this.Ym.id=d?"HeaderPane":"FooterPane";this.Ym.classList.add(Kt.SZl,z);this.K1b=(new CC.a(this.Ym,"WACViewPanel_"+z)).sC;this.Ym.appendChild(this.K1b);a.appendChild(this.Ym);d&&(this.EUc=a.ownerDocument.createElement("div"),this.EUc.classList.add(Kt.VZl),this.Ym.appendChild(this.EUc));this.coh=n.OIl(this.Ym)}bind(){}E8(a){a?this.coh.JBk():this.coh.KBk()}fHk(a){a.Mhb(this.K1b)}}Kt.VZl="HeaderToolbarContainer";
Kt.SZl="HeaderFooterPane";Object(t.a)(Kt,"PaneControlDom",null,[414]);class wu{constructor(a,d,n,z,O){this.rJ=this.Sj=null;this.Ym=a.ownerDocument.createElement("div");this.Ym.id=wu.eai;this.Ym.className=wu.eai;this.wA=z;this.e6=O;this.VJi=new Kt(this.Ym,!0,d);this.W2k(this.Ym);this.pqi=new Kt(this.Ym,!1,d);this.E8(!1);a.appendChild(this.Ym)}W2k(a){this.Sj=a.ownerDocument.createElement("div");this.Sj.id=wu.cNm;this.Sj.className=wu.aNm;this.Sj.tabIndex=0;this.Sj.setAttribute(pd.a.ig,pd.a.l3);this.Sj.setAttribute(pd.a.Vka,
WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);a.appendChild(this.Sj)}bind(a){this.rJ=a}E8(a){if(!a&&this.wA){var d=new wd.a(!0);this.wA.iXa(d)}!a&&this.e6&&(d=new wd.a(!0),this.e6.iXa(d));this.Ym.style.display=a?"":"none";this.VJi.E8(a);this.pqi.E8(a)}Bkn(){this.Sj.focus()}jC(){Ae.a.instance.Ea(vb.a.click,this.Sj,Object(m.a)(this,this.I$i,"onOverlayClick"));Eg.a.instance.Ea(vb.a.Mq,this.Ym,Object(m.a)(this,this.AH,"onMouseDown"))}jia(){Ae.a.instance.kb(vb.a.click,this.Sj,Object(m.a)(this,
this.I$i,"onOverlayClick"));Eg.a.instance.kb(vb.a.Mq,this.Ym,Object(m.a)(this,this.AH,"onMouseDown"))}I$i(){this.rJ.dismiss(!0);if(this.e6){let a=new wd.a(!0);this.e6.iXa(a)}return!0}AH(a){a.Ua.preventDefault();return!1}}wu.eai="HeaderFooterControl";wu.cNm="HeaderFooterOverlay";wu.aNm="EditingSurfaceOverlay HeaderFooterOverlay";Object(t.a)(wu,"HeaderFooterControlDom",null,[409]);class bz{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb){this.aea=null;this.ka=new oc.a;this.rJ=this.Nde=null;this.ib=a;this.Bq=d;
this.aJh=n;this.Cak=z;this.Vik=O;this.ga=ca;this.jvh=gb.KeyInputManager.$a(xb.a.Ms,0);this.d6=gb.KeyInputManager.$a(xb.a.G5,0);this.tok=gb.KeyInputManager.$a(xb.a.Eua,0);this.aN=Da;this.va=Xa;this.wA=zb;this.e6=Vb;this.ef&&this.ef.h3(Object(m.a)(this,this.cQe,"pageViewOnScrolledEvent"))}HWh(a){this.ka.addHandler("OnShowEventKey",a)}Z7m(a){this.ka.removeHandler("OnShowEventKey",a)}Fie(a){this.ka.addHandler("OnDismissEventKey",a)}Doj(a){this.ka.removeHandler("OnDismissEventKey",a)}get ef(){const a=
this.aN.value;return a?a.gj?a:(k.ULS.sendTraceTag(25474004,317,10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(k.ULS.sendTraceTag(25474003,317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),null)}get control(){return this.rJ}bind(a){this.rJ=this.jXk(a)}jXk(a){this.aea=new wu(a,this.Vik.value,this.va,this.wA,this.e6);a=this.aJh.value.create(this.ga,this.aea.VJi,!0,og.AppFrame.jga);const d=this.aJh.value.create(this.ga,this.aea.pqi,!1,og.AppFrame.Ufa);
this.rJ=this.Cak.value.create(this.aea,a,d,Object(m.a)(this,this.sHg,"onHeaderFooterShow"),Object(m.a)(this,this.rHg,"onHeaderFooterDismiss"));this.Mjg();this.CR();return this.control}Mjg(){var a=3===this.ga.mode?og.AppFrame.lE:og.AppFrame.ALb;const d=this.ib.Kc(og.AppFrame.jga);d.parent=a;this.ib.aie(og.AppFrame.jga);const n=this.ib.Kc(og.AppFrame.Ufa);n.parent=a;this.ib.aie(og.AppFrame.Ufa);a=this.ib.Kc(sn.a.W$b);a.parent=Ec.AFrame.hp;a.naa(()=>{this.aea.Bkn()});a.bindAction(this.jvh,Dc.a.e7);a.bindAction(this.d6,
Dc.a.e7);a.bindAction(this.tok,Dc.a.e7);d.bindAction(this.d6,Dc.a.e7);n.bindAction(this.d6,Dc.a.e7)}CR(){this.Bq.CR(og.AppFrame.jga);this.Bq.CR(sn.a.Ymb);this.Bq.CR(og.AppFrame.Ufa);this.Bq.CR(sn.a.W$b)}sHg(a){this.Fha(a);this.ka.raiseEvent("OnShowEventKey")}Fha(a){this.Bq.bE(og.AppFrame.jga);this.Bq.bE(sn.a.Ymb);this.Bq.bE(og.AppFrame.Ufa);this.Bq.bE(sn.a.W$b);this.Bq.gx(Ec.AFrame.ao);this.ib.Wxc(og.AppFrame.jga);this.ib.Wxc(og.AppFrame.Ufa);a?this.ib.wf(og.AppFrame.jga):this.ib.wf(og.AppFrame.Ufa)}rHg(a){this.ef&&
(this.Nde=new BC.a(this.ef));this.ib.wCc(og.AppFrame.jga);this.ib.wCc(og.AppFrame.Ufa);this.hoa(a);this.ka.raiseEvent("OnDismissEventKey")}hoa(a){this.Bq.gx(og.AppFrame.jga);this.Bq.gx(sn.a.Ymb);this.Bq.gx(og.AppFrame.Ufa);this.Bq.gx(sn.a.W$b);this.Bq.bE(Ec.AFrame.ao);(a||this.ib.Zd&&(this.ib.Zd.name===og.AppFrame.jga||this.ib.Zd.name===sn.a.Ymb||this.ib.Zd.name===og.AppFrame.Ufa||this.ib.Zd.name===sn.a.W$b))&&this.ib.wf(Ec.AFrame.ao)}cQe(){this.Nde&&(this.Nde.dispose(),this.Nde=null)}dispose(){const a=
this.ib.Kc(sn.a.W$b);a.zq(this.jvh);a.zq(this.d6);this.ib.Kc(og.AppFrame.jga).zq(this.d6);this.ib.Kc(og.AppFrame.Ufa).zq(this.d6);this.ef&&this.ef.ujc(Object(m.a)(this,this.cQe,"pageViewOnScrolledEvent"));this.control.dispose()}}Object(t.a)(bz,"HeaderFooterControlOwner",null,[386,387]);var QA=b(977);class Jx{constructor(a,d,n,z,O,ca){this.Zm=a;this.mc=d;this.wik=n;this.Kl=z;this.zik=O;this.Eak=ca}d5l(a,d){const n=this.mc.Sl();n.set(a);this.Zm.Cfc(n,d);this.wik(n);this.zik(n.currentNode,this.Kl);this.Eak.e5l(n,
QA.a(d))}}Object(t.a)(Jx,"HeaderFooterDefaultContentInserter",null,[385]);class Jq{constructor(a,d,n,z,O,ca,Da,Xa){this.YZ=a;this.ppk=d;this.R$e=n;this.Kl=z;this.yik=O;this.Unk=ca;this.tak=Da;Jq.Ee=Xa}e5l(a,d){this.ppk(a,1,3,null,!1);this.YZ.fYe(sy.a.B1d,1696,a.currentNode);this.R$e(a,0,this.Kl?3:1,d);this.R$e(a,1,2,d);this.R$e(a,2,this.Kl?1:3,d);this.yik(a);this.Unk(a,!1,!0,null);this.tak(a,d)}static get kZ(){return Jq.nI||(Jq.nI=la.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}static get paragraphEditor(){return Jq.Ki||
(Jq.Ki=la.a.instance.resolve("Box4.IParagraphEditor"))}static ijn(a,d,n){Uf.moveToCellContent(a,0,d);qe.OutlineElementNavigator.Sd(a);Jq.kZ.gYe(Box4Intl.Box4Strings.L_StyleWordHeader,a.currentNode);Jq.paragraphEditor.NH(a.currentNode,n);d||Jq.paragraphEditor.dr.RKa(a,1,-115);2===d&&Jq.paragraphEditor.dr.clc(a.currentNode,1,-115);Uf.returnToContainingTable(a)}static cln(a,d){qe.OutlineElementNavigator.Sd(a);Jq.kZ.gYe(d?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,a.currentNode);
qe.OutlineElementNavigator.Uc(a)}static gul(){return(a,d,n)=>{Jq.ijn(a,d,n)}}static wBl(){return(a,d)=>{Jq.cln(a,d)}}static eQl(a){return(d,n,z,O,ca)=>a.hHa(d,n,z,O,ca)}static DOl(){return(a,d,n,z,O)=>Jq.Ee.BE(a,d,n,z,O)}}Jq.nI=null;Jq.Ki=null;Jq.Ee=null;Object(t.a)(Jq,"HeaderFooterDefaultTableInserter",null,[384]);class RA{constructor(a,d,n,z){this.Zm=a;this.cvc=d;this.mc=n;this.Nl=z}gzj(a,d){a.Hm.properties.setValue(Qb.a.mCe,2===d||4===d);a.La(8);a.JVc(8).properties.setValue(Qb.a.hyd,3===d||4===
d)}B5m(a){this.Nl.vza(a,d=>{const n=this.mc.Sl();n.set(d);this.Zm.Bfc(n);this.gzj(n,1);this.C5m(n);return!0})}C5m(a){for(;a.Rc();)a.wg()}}Object(t.a)(RA,"HeaderFooterEditor",null,[383]);var GB=b(981);class uy extends Rs.a{constructor(a){super();this.wyf=a}get index(){return 0}run(){this.wyf()}OZl(a,d){d.property===Qb.a.mCe&&this.sM()}wNm(a,d){d.property===Qb.a.hyd&&this.sM()}sM(){this.l8()}}Object(t.a)(uy,"ControlUpdateNeededTracker",Rs.a,[]);class cz{constructor(a,d,n,z,O,ca){this.Hxb=null;this.Dak=
n;this.C7d=d;this.gtc=a;this.Lik=z;this.f1a=ca}start(){this.gtc.bind(Lb.App.oa.Ow);this.C7d.control=this.gtc.control;this.C7d.lb();this.Dak.control=this.gtc.control;this.Lik.value.create(this.gtc.control,Object(m.a)(this.C7d,this.C7d.ali,"ensureSectionHeaderFooterAttachedToControl")).lb();this.O_l()}O_l(){this.Hxb=new uy(()=>{this.gtc.control.update()});const a=Lb.App.jj.Cm;a.Oe(35).tq(Object(m.a)(this.Hxb,this.Hxb.OZl,"headerFooterContainerNodePropertyChanged"));a.Oe(8).tq(Object(m.a)(this.Hxb,this.Hxb.wNm,
"pageContentNodePropertyChanged"));GB.a.XTe(Object(m.a)(this.Hxb,this.Hxb.sM,"setUpdateNeeded"));yq.GraphTransactionManager.instance.UCa(this.Hxb,3)}dispose(){this.gtc.dispose();this.f1a.Ygi()}}Object(t.a)(cz,"HeaderFooterManager",null,[]);class Yv{constructor(a,d,n,z){this.Nl=a;this.Zm=d;this.Cgk=n;this.wcf=z}Hfl(a,d){let n=!1;const z=tv.a.H$f(d);a.Bo(z)||(this.l5l(a,d),this.wcf.d5l(a.currentNode,d),n=!0);return n}l5l(a,d){const n=this.Cgk.create(1074135123),z=a.currentNode.fa(Qb.a.Wca,0);n.properties.setValue(Qb.a.Wca,
z);n.properties.setValue(Qb.a.V$b,d);d=tv.a.H$f(d);a.Re(n,d)}}Object(t.a)(Yv,"HeaderFooterNodeLevelInserter",null,[381]);var dz=b(1309),bv=b(1332);class Pw extends dz.a{constructor(a,d,n){super(a,d,"","");this.uYb=null;this.bKi=Pw.Uei;this.zyd=[];this.ahf=n}get GD(){return!0}get cssClass(){return"cui-herodock"}Cn(){this.I1m();super.Cn()}R3a(){for(const a of this.zyd)a.Nse();super.R3a()}vyn(){let a,d,n;a=[];d=[];n=[];for(let z=0;z<this.zyd.length;z++){const O=this.zyd[z];O.visible?a.length<this.bKi?
a.push(O):Object(Uc.a)(bv.FlyoutAnchor,O)?Array.addRange(d,O.mwl()):d.push(O):n.push(O)}return{fFn:a,ZMm:d,u7l:n}}V2k(a){if(!a||!a.length)return null;const d=new sa.Menu(this.root,this.id+"OverflowMenu",null,null,null),n=new wl.a(this.root,this.id+"OverflowMenuSection",null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},d);for(const z of a)n.Re(z.uX("Menu20"));d.Re(n);return d}I1m(){this.lUe();this.Pb=Ne.a.q8a(this.Pb);this.MF();var a;({fFn:n,ZMm:a,u7l:z}=this.vyn());for(var d of n){var n=
d.uX("Medium20");n.enabled=!0;this.fyc(n,this.children.count);this.Pb.appendChild(n.Pb);n.kza()}if(a=this.V2k(a))this.uYb?this.uYb.menu=a:(d=this.id+"OverflowMenuLauncher",n={},n.Image20by20=this.ahf.OverflowMenuImage20by20,n.Image20by20Class=this.ahf.OverflowMenuImage20by20Class,n.PopulateDynamically="false",n.HideDefaultArrow="true",n.Alt=this.ahf.OverflowMenuTooltip,n.Command="798637440",n.Id=d,this.uYb=new bv.FlyoutAnchor(this.root,d,n,a)),a=this.uYb.uX("Small20"),a.enabled=!0,this.fyc(a,this.children.count),
this.Pb.appendChild(a.Pb),a.kza();if(l.AFrameworkApplication.K.ea("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const O of z){var z=O.uX("Medium20");this.Re(z);z.kza()}}dispose(){this.uYb&&(this.uYb.dispose(),this.uYb=null);for(const a of this.zyd)a.dispose();this.lUe();super.dispose()}set GD(a){super.GD=a}}Pw.Uei=4;Object(t.a)(Pw,"HeroDock",dz.a,[]);var Zv=b(1365);class HB extends Zv.a{constructor(){super();this.n0e=this.bdm=this.Lzn=!1;this.Eum=l.AFrameworkApplication.CDd?1:Pw.Uei}}Object(t.a)(HB,
"ToolbarBuildOptions",Zv.a,[]);var Di=b(1325),Oh=b(1385),DC=b(1404);class ez extends dz.a{constructor(a,d,n){super(a,d,"","");this.EXc=n.Alignment;this.uuh=n.ScalingDirection===Di.a.LXj}Cn(){this.uHa();this.k3(this.Pb);super.Cn()}k3(a){for(let d of this.children){d.MF();switch(this.EXc){case Di.a.z6e:Ne.a.uf(d.Pb,"cui-toolbar-button-left");break;case Di.a.uwb:Ne.a.uf(d.Pb,"cui-toolbar-button-center");break;case Di.a.Npc:Ne.a.uf(d.Pb,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.EXc);
}d.visible&&a.appendChild(d.Pb);d.kza()}}RU(a){if(!Object(Uc.a)(yp.a,a))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");}get cssClass(){switch(this.EXc){case Di.a.z6e:return"cui-toolbar-buttondock alignleft";case Di.a.uwb:return"cui-toolbar-buttondock aligncenter";case Di.a.Npc:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.EXc);}}get GD(){return!0}get alignment(){return this.EXc}jHc(){let a=0;if(this.alignment===Di.a.uwb)for(let d of this.children){const n=
d;n.visible&&(a+=n.Pb.offsetWidth)}else a=this.Pb.offsetWidth;return a}Mze(){let a=null;if(this.alignment===Di.a.uwb)for(let d of this.children){if(d.visible){a=Sys.UI.DomElement.getBounds(d.Pb);break}}else a=Sys.UI.DomElement.getBounds(this.Pb);return a?0===this.root.Q8?a.x:a.x+a.width:0}Ywe(){let a=null;if(this.alignment===Di.a.uwb){if(0<this.children.count){const d=this.children.Zwe(this.children.count-1);for(;d.T6a();){const n=d.get_current();if(n.visible){a=Sys.UI.DomElement.getBounds(n.Pb);
break}}}}else a=Sys.UI.DomElement.getBounds(this.Pb);return a?0===this.root.Q8?a.x+a.width:a.x:0}n_f(){for(let a of this.children){const d=a;if(!Object(Uc.a)(yp.a,d)||d.control.visible)d.visible=!0}}Nen(a){const d=this.children.toArray(),n=new DC.a;let z=this.uuh?0:d.length-1;const O=this.children.count,ca=this.root.z9a;for(;this.jHc()>=a&&!(z>=O||0>z);){const Da=d[z];ca&&Object(Uc.a)(yp.a,Da)&&Da.control.visible&&(n.add(Da),Da.XYh());z+=this.uuh?1:-1}for(let Da of n)Da.inj(),Da.visible=!1}set GD(a){super.GD=
a}}Object(t.a)(ez,"ButtonDock",dz.a,[]);class Kx extends Gc.a{constructor(a,d,n,z,O,ca,Da=!1){super(a,d,ca);this.SEa=this.Q5=this.bxa=null;this.Qnf=!1;this.mJa=z;this.n0e=O;this.jge=0;ze.c(d.Size)||(d.Size===Di.a.Ykh||n.options.bdm?this.jge=0:d.Size===Di.a.x_j&&(this.jge=1));this.oqk=Da}get z9a(){return!0}Re(a){super.Re(a);Object(Uc.a)(ez,a)&&!this.Qnf&&(a.alignment===Di.a.z6e?(this.bxa&&this.u1g(),this.bxa=a):a.alignment===Di.a.uwb?(this.Q5&&this.u1g(),this.Q5=a):a.alignment===Di.a.Npc&&(this.SEa&&
this.u1g(),this.SEa=a))}u1g(){this.Qnf=!0;this.SEa=this.Q5=this.bxa=null}QMb(a,d){a=this.Gtd(a);ze.c(a)||a.visible===d||(a.visible=d,this.refresh())}Cn(){super.Cn();this.dlj(!0)}dlj(a){const d=this.root.z5b;ze.c(this.Pb)&&this.Y4k();this.Pb=Ne.a.q8a(this.Pb);this.Byd&&this.Pb.appendChild(this.Byd);for(let n of this.children)n.visible&&(n.MF(),this.Pb.appendChild(n.Pb),n.kza());this.Q5&&a&&this.nfl();d&&d.l5();this.M3=!1}nfl(){if(this.Q5.visible&&this.Q5.children.count&&(this.fZh(0,0),this.Fcl(this.bxa,
this.Q5,this.SEa))){let a=0,d=0;const n=this.bxa?this.bxa.jHc():0,z=this.SEa?this.SEa.jHc():0;if(0<z||0<n)z>n?(a=0,d=z-n):(a=n-z,d=0);this.fZh(a,d)}}Fcl(a,d,n){let z=!1;0===this.root.Q8?(a&&(z=a.Ywe()>d.Mze()),!z&&n&&(z=d.Ywe()>n.Mze())):(a&&(z=a.Ywe()<d.Mze()),!z&&n&&(z=d.Ywe()<n.Mze()));return z}fZh(a,d){0===this.Q8?(this.Q5.Pb.style.marginLeft=a+"px",this.Q5.Pb.style.marginRight=d+"px"):(this.Q5.Pb.style.marginRight=a+"px",this.Q5.Pb.style.marginLeft=d+"px")}Y4k(){this.MF()}Vv(){this.Nhi(()=>{Wx.a.prototype.Vv.call(this)})}T0(a){a=
this.Gtd(a);ze.c(a)||this.Nhi(Object(m.a)(a,a.Km,"pollForStateAndUpdate"))}Nhi(a){this.RMc=this.uqb=!1;a();if(this.uqb||this.RMc)this.oqk||this.refresh(),this.scale()}RU(a){if(!Object(Uc.a)(Pw,a)&&!Object(Uc.a)(ez,a))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(Uc.a)(ez,a)&&a.alignment===Di.a.uwb)for(let d of this.children)if(d.alignment===Di.a.uwb)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let a=
"cui-toolbar-toolbar ";0===this.jge?(a+="cui-toolbar-onerow ",l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.vY||(a+="UITextTranformUpperCase ")):1===this.jge&&(a+="cui-toolbar-singledock ");return a+super.cssClass}get rHa(){return"div"}get xha(){return 26}get DJj(){return this.yU}set DJj(a){this.yU=a}y_k(a){a=a[Di.a.Ry];return new ez(this.root,a.Id,a)}MF(){super.MF();this.Pb.setAttribute("role","toolbar");this.properties.Title&&this.Pb.setAttribute("title",this.properties.Title)}vua(a){return this.root&&
this.root.iQc(a)?!0:!1}Ekn(){this.T8a()}scale(){super.scale();if(!Ne.a.Jt(this.properties.Scale)||this.Qnf)return!1;ze.c(this.bxa)||(this.bxa.visible=!0,this.bxa.n_f());ze.c(this.Q5)||(this.Q5.visible=!0,this.Q5.n_f());ze.c(this.SEa)||(this.SEa.visible=!0,this.SEa.n_f());this.dlj(!1);const a=this.Pb.offsetWidth,d=ze.c(this.bxa)?0:this.bxa.jHc(),n=ze.c(this.Q5)?0:this.Q5.jHc(),z=ze.c(this.SEa)?0:this.SEa.jHc();z+n+d>=a&&(z+d>=a?(this.eKi(this.Q5),z>=a?(this.eKi(this.bxa),this.SYg(this.SEa,a)):this.SYg(this.bxa,
a-z)):this.SYg(this.Q5,a-z-d));this.uqb=!1;this.Cn();return!1}eKi(a){a&&(a.visible=!1)}SYg(a,d){a&&a.Nen(d)}}Object(t.a)(Kx,"Toolbar",Gc.a,[827]);class Vm extends Kx{constructor(a,d,n,z,O=!1){super(a,d,n,!1,!1,z,O);this.TDh=!0}get xha(){return 7}get cssClass(){return Vm.Mzn+" "+super.cssClass}static get Mzn(){let a="cui-statusbar";l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.vY||(a+=" UISmallFont UITextTranformUpperCase");return a}}Object(t.a)(Vm,"StatusBar",Kx,[]);var fz=b(1338);class uv extends fz.a{constructor(){super();
this.toolbar=null;this.mHe=!1}}Object(t.a)(uv,"ToolbarBuildContext",fz.a,[]);class gz extends ac.Builder{constructor(a,d,n,z){super(a,d,Jh.Task.KL(n),z);if(ze.c(d))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}Z2g(a){this.root=a}get wah(){return this.options}bLk(){const a=new uv,d=new Oh.a;d.id="toolbar";d.MOd=1;d.handler=Object(m.a)(this,this.jJm,"onReturnToolbarData");d.data=a;this.lHa.fWe(d)}jJm(a){this.Z2g(this.dLk(a.$Nd,a.jmd));this.toolbar.DJj=
this;this.toolbar.Cn();this.placeholder.appendChild(this.toolbar.Pb);Ne.a.uf(this.placeholder,"loaded");this.HGa.continueWith(()=>{this.HGa.result.ogc(this.toolbar)},11)}dLk(a,d){var n=Di.a.oba(a,Di.a.c0j);ze.c(n)&&(n=Di.a.oba(a,Di.a.E_j),d.mHe=!0);if(ze.c(n))throw Error.create("No toolbar element was present in the data");a=new Di.a(n);n=l.AFrameworkApplication.K.ea("ToolbarScalingRedundancyEliminationIsEnabled");d.mHe?this.Z2g(new Vm(a.attributes[Di.a.id],a.attributes,this,this.fka,n)):this.Z2g(new Kx(a.attributes[Di.a.id],
a.attributes,this,this.wah.Lzn,this.wah.n0e,this.fka,n));this.toolbar.NGa=this.options.NGa;this.toolbar.X3e=!0;this.toolbar.Cn();a=Di.a.yw(Di.a.oba(a.node,Di.a.xXj));d=this.nIk(a,d);for(const z of d)this.toolbar.Re(z);return this.toolbar}nIk(a,d){const n=[];for(let z=0;z<a.length;z++)this.Y5a(a[z])||Array.add(n,this.WIk(a[z],d));return n}WIk(a,d){const n=Di.a.zvd(a);let z=null;n===Di.a.FWj?z=this.zIk(a,d):n===Di.a.dYj&&(z=this.nJk(a,d));return z}nJk(a,d){var n=new Di.a(a);n=new Pw(this.root,n.attributes[Di.a.id],
a[Di.a.Ry]);n.bKi=this.wah.Eum;a=Di.a.oba(a,Di.a.vwb);a=Di.a.yw(a);const z=[];for(let ca=0;ca<a.length;ca++){var O=a[ca];this.Y5a(O)||(O=this.waa(O,d),Array.add(z,O))}n.zyd=z;return n}zIk(a,d){new Di.a(a);const n=this.toolbar.y_k(a);a=Di.a.oba(a,Di.a.vwb);a=Di.a.yw(a);for(let z=0;z<a.length;z++){if(this.Y5a(a[z]))continue;const O=this.cLk(a[z],d);n.Re(O)}return n}cLk(a,d){var n=new Di.a(a);const z=n.name;n=n.attributes[Di.a.CWc];let O;O=d.mHe?"Small14":"Small";switch(z){case Di.a.button:return a=
this.waa(a,d),a.uX(ze.b(n)?O:n);case Di.a.KHa:return O=d.mHe?"Medium14":"Medium",a=this.waa(a,d),a.uX(ze.b(n)?O:n);case Di.a.label:return a=this.waa(a,d),a.uX(ze.b(n)?O:n);case Di.a.separator:return a=this.waa(a,d),a.uX("Small");case Di.a.toggleButton:return a=this.waa(a,d),a.uX(ze.b(n)?O:n);default:throw Error.create("Invalid control type.");}}}Object(t.a)(gz,"ToolbarBuilder",ac.Builder,[]);var hz=b(1780);class Yz{constructor(a,d,n,z,O,ca){this.JM=a;a=new qj.CuiHelper(ul.a.A2a,WordEditorIntl.WordEditorStrings,
null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);z=new HB;z.dL={};ca=3!==ca.mode;z.dL.HeaderToolbarControlsRight=ca;z.dL.HeaderToolbarButtonDockRight=ca;z.dL.HeaderToolbarButtonRemovePageNumbers=ca;O=new gz(z,this.JM,this,O);O.lHa=new hz.a(Yz.WZl,a);O.bLk();this.rxa=O.toolbar;n.execute(Da=>{this.toolbar.XI=Da});this.toolbar.refresh();this.toolbar.Km();this.gh=d;d.m2a(Object(m.a)(this,this.VJb,"onCommandUiUpdateHandler"))}get toolbar(){return this.rxa}VJb(){this.toolbar.Km()}dispose(){this.gh.sjc(Object(m.a)(this,
this.VJb,"onCommandUiUpdateHandler"));this.toolbar&&(this.toolbar.dispose(),this.rxa=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.Ekn()}Qal(){this.toolbar.N3()}ogc(){}}Yz.WZl="WordEditorHeaderToolbarData";Object(t.a)(Yz,"HeaderFooterToolbar",null,[195,408]);class Ox{constructor(a,d,n,z,O){this.gh=a;this.Pbf=d;this.Ja=n;this.fka=z;this.ga=O}create(a){return new Yz(a,this.gh,this.Pbf,this.Ja,this.fka,this.ga)}}Object(t.a)(Ox,"Factory",null,[380]);class SA{constructor(a,d){this.mc=
a;this.Nl=d}d4k(a){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+this.c4k(a)+"</Controls></MenuSection></Menu>"}hBl(a){const d=this.mc.Sl();d.set(a);d.La(8);d.tc(8);return d}c4k(a){if(!a)return"";let d="";a=this.hBl(a);this.Nl.vza(a,n=>{const z=this.Nl.feg(n);n=n.getValue(Qb.a.Wca);d+=Uh.p(n.toString(),n.toString(),Dc.a.E_g.toString(),Dc.a.NPg.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,
z));return!0});return d}}Object(t.a)(SA,"HeaderFooterToolbarGenerator",null,[379]);var Qw=b(114);class lA extends Vy.a{constructor(a,d,n,z,O,ca){super(a,d);this.Bg=null;this.JM=a.container;this.iy=document.createElement("div");this.eG(this.iy);this.aPa=n;this.j0a=z;this.wm.execute(Da=>{Da.pha(Object(m.a)(this,this.ju,"onZoomChanged"))});this.oL=O;if(this.j6=ca)this.JM.style.backgroundColor=this.oL.qGc()}dispose(){super.dispose();this.wm.instance&&this.wm.instance.XLb(Object(m.a)(this,this.ju,"onZoomChanged"))}get wm(){return this.Bg||
(this.Bg=la.a.instance.Ca("Common.IZoomManager"))}iF(a){this.JM.classList.add("HeaderFooterViewElement");this.iy.classList.add("HeaderFooterViewContent");this.t_d(a.currentNode)}lia(a){this.iy.parentNode&&this.iy.parentNode===this.JM||(this.JM.appendChild(this.iy),this.j0a.instance&&this.j0a.instance.b3g(this.qb,this.JM));super.lia(a)}oPb(a){Qw.a.Fd(()=>{Qw.a.prototype.oPb.call(this,a);this.eOj();this.j0a.instance&&this.j0a.instance.oNj(this.qb,this.iy.style.paddingLeft,this.iy.style.paddingTop)},
"HFVE:UFO")}ju(){this.t_d(this.Ia)}t_d(a){this.wm.instance&&this.wm.instance.J1d(this.iy);this.eOj();a=this.aPa.OGc(a);this.iy.style.paddingLeft=a.xBc+"px";this.iy.style.width=a.hmd+"px";this.j0a.instance&&this.j0a.instance.oNj(this.qb,this.iy.style.paddingLeft,this.iy.style.paddingTop)}eOj(){if(this.wm.instance){this.iy.style.paddingTop="";var a=Qk.a.Hv(this.iy);a.paddingTop&&(a=ae.a.kO(a.paddingTop),this.iy.style.paddingTop=Math.round(a/this.wm.instance.Ei)+"px")}}}Object(t.a)(lA,"HeaderFooterViewElement",
Vy.a,[]);class IB{constructor(a,d,n,z){this.aPa=a;this.j0a=d;this.oL=n;this.j6=z}create(a,d){return new lA(a,d,this.aPa,this.j0a,this.oL,this.j6)}}Object(t.a)(IB,"Factory",null,[378]);var Zz=b(381),Lt=b(182),e=b(860),v=b(537);class Q extends Zz.a{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le,Ve,gg){super(d,ca,Da,Xa,zb,Lt.a.$yd,Vb,Fc,Yc,yd,je,Le,Ve,gg);this.isHeader=this.isHeader=a;this.Veb=O;this.Veb.XXd=this;z(this);this.x4d=n;this.rNa=document.createElement("div");this.rNa.setAttribute("Unselectable",
"on");this.rNa.setAttribute("hideselection","hideselection");this.rNa.setAttribute("style","outline:none;");this.rNa.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;this.rNa.tabIndex=0;this.features.M4g=!0;this.features.Ple=!0}get JFe(){return!0}gxd(){const a=this.x4d.s4f(this);return e.ViewReference.QB(a)}hpd(a){Object(Uc.a)(Q,a)||this.x4d.dismiss()}get OHc(){return"WordEditor"+(this.isHeader?"Header":"Footer")+"HiddenLabel"}lmb(){return v.a.DAg}onResize(){super.onResize();
this.Veb.$ki()}fz(a,d=null){this.rNa.parentNode&&this.rNa.parentNode.removeChild(this.rNa);super.fz(a,d);this.Veb.Mki(this.xc.Bf)}detach(){this.Veb.Zki();super.detach();this.rNa.parentNode||this.container.insertBefore(this.rNa,this.container.firstChild)}qlc(){this.mn?super.qlc():this.rNa.focus()}ksd(){this.onResize()}}Object(t.a)(Q,"HeaderFooterView",Zz.a,[403,339,363,147,12,113,404,405,406]);class aa{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le){this.x4d=a;this.Xrk=d;this.Wrk=n;this.xs=z;
this.ic=O;this.faa=ca;this.ga=Da;this.h$=Xa;this.sR=zb;this.oR=Vb;this.Qw=Fc;this.Un=Yc;this.fe=yd;this.Df=je;this.FRb=Le}create(a,d){return new Q(a,d,this.x4d,this.Xrk,this.Wrk(),this.xs,this.ic,this.faa,this.ga,this.h$,this.sR,this.oR,this.Qw,this.Un,this.fe,this.Df,this.FRb)}}Object(t.a)(aa,"Factory",null,[376]);class ua{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le,Ve,gg,Lh){this.QIh=!1;this.yOh="SourceControlId";this.SDn=1;this.TDn=1E3;this.ga=a;this.Nb=d;this.fb=n;this.Xzb=z;this.ija=
O;this.Zm=ca;this.aqf=Da;this.$pf=Xa;this.jvc=zb;this.f1a=Vb;this.Da=Fc;this.Quf=Yc;this.Ad=yd;this.Eb=je;this.l7d=Le;this.u8j=Lh;this.Nik=new Nf.a(()=>this.Xzb.JIl())}lb(){this.ga.Aa(Dc.a.HMd,Kb.a.view,Object(m.a)(this,this.HMd,"populatePageNumbersDropDown"),100);this.ga.Aa(Dc.a.adj,Kb.a.view,Object(m.a)(this,this.HNm,"pageNumbersDropDownOpenHandler"),68);this.ga.Aa(Dc.a.QNi,Kb.a.view,Object(m.a)(this,this.b6l,"insertPageNumbersActionHandler"),4);this.ga.Aa(Dc.a.Eac,Kb.a.view,Object(m.a)(this,this.B1l,
"includePageCountActionHandler"),4);this.ga.Aa(Dc.a.uQd,Kb.a.view,Object(m.a)(this,this.Cnj,"removePageNumbersActionHandler"),4);this.ga.Aa(Dc.a.b7m,Kb.a.view,Object(m.a)(this,this.Cnj,"removePageNumbersActionHandler"),4);this.ga.Aa(Dc.a.cQg,Kb.a.application,Object(m.a)(this,this.yXm,"queryIncludePageCountToggleButton"),97);this.ga.Aa(Dc.a.OSe,Kb.a.application,Object(m.a)(this,this.OSe,"queryPageNumbersPosition"),97);this.ga.Aa(Dc.a.TCj,Kb.a.view,Object(m.a)(this,this.Evn,"showPageNumbersCalloutHandler"),
4);this.ga.dX(Dc.a.UCj,Kb.a.view,Object(m.a)(this,this.Dvn,"showPageNumbersCalloutForBlobHandler"),100);this.ga.Aa(Dc.a.Sal,Kb.a.view,Object(m.a)(this,this.Tal,"dismissPageNumbersCalloutHandler"),4)}OSe(a,d,n,z,O){if(1===n)return 32;this.l7d(O[this.yOh]);O[Dg.a.Text]=this.aqf.INm(this.Xzb.Eac);return 32}yXm(a,d,n,z,O){if(1===n)return 32;O[Yf.a.On]=this.Xzb.Eac;return 32}B1l(a,d,n,z,O){if(1===n)return 32;this.Xzb.VMn(O[Yf.a.On]);return 32}Cnj(a,d,n){if(1===n)return 32;if(this.ija){d=ua.Ze.kt(d.view.xc);
n=Dd.GraphIterator.ua(d);const z=this.Eb.Jhb();try{const O=this.Nb.Wb(15);try{O.Sa(d),O.om=a,jq.a.instance.vza(n,ca=>{this.jvc.uQd(ca,Object(m.a)(this,this.exl,"getCurrentSelectionCpInParagraph"),Object(m.a)(this,this.Gln,"setIpSelectionInParagraph"));return!0})}finally{O&&O.dispose()}}finally{z&&z.dispose()}}return 32}HMd(a,d,n,z,O){if(1===n)return 32;O.MenuItems=this.Nik.value;this.QIh?this.Xzb.Ban():this.QIh=!0;return 32}b6l(a,d,n,z,O){if(1===n)return 32;const ca=this.l7d(O[this.yOh]);if(this.ija){d=
ua.Ze.kt(d.view.xc);n=Dd.GraphIterator.ua(d);z=this.Nb.Wb(15);try{z.Sa(d);z.om=a;let Da=null;const Xa=this.Ad.Pe("UserAction","InsertPageNumber");jq.a.instance.vza(n,zb=>{this.ija.gra||this.u8j(zb);Da=this.$pf.$5l(zb,ca,this.Xzb.Eac)||Da;return!0});Xa.stop();if(!Da)return 8;this.$un(Da,ca)}finally{z&&z.dispose()}this.Eb.Ws(12)}return 32}HNm(){return 32}Evn(a,d,n,z,O){if(1===n)return 32;2===n&&this.f1a.showCallout(O);return 32}Dvn(a,d,n,z,O,ca){return this.Quf.create(a,d,n,z,O,ca)}Tal(a,d,n){if(1===
n)return 32;this.f1a.Ygi();return 32}$un(a,d){const n=a.Wa.paragraph;if(n){var z=this.Zm.CDg(n);z&&this.ija.nra(z)}z=this.ija.gra;this.ija.show(4>d);n&&this.dln(n)&&(this.non(a,n),this.Ywk(a,z))}dln(a){let d;if(!({isHeader:d,v$g:a}=this.Zm.tFi(a)).returnValue)return!1;this.ija.MKa(a,d);return!0}non(a,d){a=ye.SelectionFactory.Pc(d,a.Wa.cp);this.Da.setSelection(a)}Ywk(a,d){d=new bf.a(2,1,d?this.SDn:this.TDn,Object(m.a)(this,this.fun,"showCalloutForAPageNumbersBlobTask"));d.customData=a;this.fb.rb(d)}fun(a){l.AFrameworkApplication.pa.Nna(null,
Dc.a.UCj,2,a.customData,null,null)}exl(a){const d=Lg.a.instance.ya.Ba;let n=-1;for(let z of d)if(z.node===a){n=z.cpBegin;break}return{returnValue:n,cGe:Qd.SelectionEditor.qj(d)}}Gln(a,d){a=ye.SelectionFactory.Pc(a,d);Lg.a.instance.setSelection(a)}static get Ze(){return jm.PageNavigator.instance}}Object(t.a)(ua,"PageNumbersActor",null,[407]);class Ya{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd){this.ga=a;this.fb=d;this.Xzb=n;this.aqf=z;this.$pf=O;this.jvc=ca;this.f1a=Da;this.Quf=Xa;this.Zm=zb;this.Eb=
Vb;this.l7d=Fc;this.jrk=Yc;this.bqa=yd}create(a,d){return new ua(this.ga,new jn.a,this.fb,this.Xzb,a,this.Zm,this.aqf,this.$pf,this.jvc,this.f1a,Lg.a.instance,this.Quf,Lb.App.oa.Np,this.Eb,this.l7d,this.jrk,this.bqa,d)}}Object(t.a)(Ya,"Factory",null,[377]);var Gb=b(1720),Xb;(function(a){a[a.small=0]="small";a[a.mediumSmall=1]="mediumSmall";a[a.medium=2]="medium";a[a.large=3]="large"})(Xb||(Xb={}));Object(t.b)("ModalCalloutSize",Xb);var wc;(function(a){a[a.topCenter=0]="topCenter";a[a.topJustified=
1]="topJustified";a[a.topLeft=2]="topLeft";a[a.topRight=3]="topRight";a[a.bottomCenter=4]="bottomCenter";a[a.bottomLeft=5]="bottomLeft";a[a.bottomRight=6]="bottomRight"})(wc||(wc={}));Object(t.b)("BeakLocation",wc);class Pc{constructor(a,d,n){this.RDn=1;this.nsf=!1;this.twc=null;this.fb=a;this.Da=d;this.x7j=n}jC(){this.Xwk()}jia(){this.nsf?(this.Da.Vna(Object(m.a)(this,this.wCa,"processSetSelectionFinished")),this.nsf=!1):this.twc&&(this.fb.ie(this.twc),this.twc=null)}Xwk(){this.twc=new bf.a(2,1,
this.RDn,Object(m.a)(this,this.W2m,"registerForProcessSetSelectionFinished"));this.fb.rb(this.twc)}W2m(){this.Da.dE(Object(m.a)(this,this.wCa,"processSetSelectionFinished"));this.nsf=!0;this.twc=null}wCa(a,d){if(a=d.zi.Ba)1<a.length||!a.length?a=!0:(a=a.ra,a=a.cpEnd-a.cpBegin,a=1<a||!a),a&&this.x7j()}}Object(t.a)(Pc,"CalloutDismissManager",null,[]);class qd{constructor(a,d,n,z){this.nId=a;this.jk=z;this.g0c=new Pc(d,n,Object(m.a)(this,this.dismiss,"dismiss"))}get $L(){return this.nId.$L}show(){if(!this.$L){const a=
document.createElement("div");a.classList.add(qd.GNm);a.innerText=WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;this.nId.content=a;this.nId.show();this.jk&&this.jk.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,!0);this.g0c.jC()}}dismiss(){this.$L&&(this.g0c.jia(),this.nId.dismiss())}dispose(){this.dismiss();this.nId.dispose()}static q2k(a,d){d=Gb.a.Dci(Ye.a.getElementBounds(a.targetElement),d,Lb.App.oa.Ow,Xb.small);d.tqa=qd.c6f(a);d.Hq=!1;return d}static c6f(a){let d=
wc.bottomCenter;Object(Uc.a)(403,a.view)&&a.view.isHeader&&(d=wc.topCenter);return d}}qd.GNm="PageNumbersCalloutControl";Object(t.a)(qd,"PageNumbersCallOutControl",null,[402]);class Nd{constructor(a,d,n){this.NZ=null;this.GZ=!1;this.vl=a;this.g0c=new Pc(d,n,Object(m.a)(this,this.dismiss,"dismiss"))}get $L(){return this.GZ}show(){this.$L||xk.UISurfaces.oK().then(a=>{const d=a.callout(Object.assign(new aq.a,{target:this.vl,content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),n=Object.assign(new rm.a,
{telemetryId:"PageNumbersCallout",onShow:()=>{this.GZ=!0},expirationOptions:Object.assign(new Hk.a,{displayTimeoutSeconds:7,onExpire:()=>{this.dismiss()}})});this.NZ=a.addNotification(d,n);this.g0c.jC();return null},a=>{k.ULS.sendTraceTag(593352340,383,15,"Failed to GetNotificationsAPIAsync: {0}",a);return null})}dismiss(){this.$L&&this.NZ&&xk.UISurfaces.oK().then(a=>{this.g0c.jia();a.removeNotification(this.NZ);this.GZ=!1;return null},a=>{k.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",
a);return null})}}Object(t.a)(Nd,"ReactPageNumbersCallOutControl",null,[402]);class ce{constructor(a,d,n){this.Da=d;this.fb=a;this.jk=n}create(a,d){if(l.AFrameworkApplication.la.eb&&l.AFrameworkApplication.la.eb.Dsa)return new Nd(d.targetElement,this.fb,this.Da);a=qd.q2k(d,a);return new qd(a,this.fb,this.Da,this.jk,l.AFrameworkApplication.la.Qy)}}Object(t.a)(ce,"Factory",null,[375]);class ne{constructor(a,d){this.rJ=null;this.Mik=a;this.vh=d}get control(){return this.rJ}showCallout(a){this.control&&
this.control.$L&&this.control.dismiss();this.rJ=this.gTm(a);this.control.show()}Ygi(){this.control&&(this.control.dismiss(),this.rJ=null)}gTm(a){const d=this.vh.Q_();this.rJ=this.Mik.value.create(d,a);return this.control}}Object(t.a)(ne,"PageNumbersCalloutControlManager",null,[374]);var Gf=b(697);class Cg extends Aq.a{constructor(){super();this.Text=null}get Type(){return 7}}Object(t.a)(Cg,"PageNumberGalleryButtonProps",Aq.a,[]);const yf=(a,d,n)=>{a=a.Sl();a.set(n);d.Bfc(a);return a};class h{constructor(a,
d,n){this.$hf=!1;this.bqa=d;this.Kl=n}get Eac(){return this.$hf}JIl(){const a=Object.assign(new he.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});a.MenuSectionList.push(this.lvk());a.MenuSectionList.push(this.Pvk());a.MenuSectionList.push(this.kwk());return a}VMn(a){this.$hf=a;this.blj()}Ban(){this.$hf=!1;const a={};a[h.gMi]="CheckboxModel";this.bqa(a);this.blj()}lvk(){const a=Object.assign(new fi.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:w.a.Vd(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),
ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),d=Object.assign(new Gf.a,{Id:h.C1l,Command:Dc.a.Eac.toString(),QueryCommand:Dc.a.cQg.toString(),LabelText:w.a.Vd(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:w.a.Vd(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),KeyTip:CommonUIStrings.l_IncludePageCountKeytip,UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});a.ControlList.push(d);return a}Pvk(){const a=Object.assign(new fi.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,
ControlList:[]}),d=Object.assign(new Vq.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.Kl){for(var n=3;1<=n;n--)d.GalleryItems.push(this.P8f(n));for(n=6;4<=n;n--)d.GalleryItems.push(this.P8f(n))}else for(n=1;6>=n;n++)d.GalleryItems.push(this.P8f(n));a.ControlList.push(d);return a}kwk(){const a=Object.assign(new fi.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",
DisplayMode:"Menu16",ControlList:[]}),d=Object.assign(new Xg.a,{Id:"btnRemovePageNumber",Command:Dc.a.uQd.toString(),LabelText:w.a.Vd(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),Alt:w.a.Vd(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:l.AFrameworkApplication.ln,Image16by16Class:Vf.getImageClass("WordRemovePageNumbers_16x16x32"),KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});a.ControlList.push(d);return a}P8f(a){const d=h.cLg+a.toString();var n=Object,z=n.assign,
O=new Cg,ca=Dc.a.QNi.toString(),Da=Dc.a.OSe.toString(),Xa=w.a,zb=Xa.Vd;let Vb="";switch(a){case 1:Vb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:Vb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;break;case 3:Vb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;break;case 4:Vb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;break;case 5:Vb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:Vb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return z.call(n,
O,{Id:d,Command:ca,QueryCommand:Da,Alt:zb.call(Xa,Vb)})}blj(){const a={};for(let d=1;6>=d;d++)a[h.cLg+d.toString()]="PageNumberGalleryButtonModel";a[h.gMi]="CheckboxModel";this.bqa(a)}static KIl(a){return a?parseInt(a.substr(h.cLg.length)):1}}h.C1l="btnIncludePageCount";h.gMi="IncludePageCount";h.cLg="btnPageNumbersPosition";Object(t.a)(h,"PageNumbersControl",null,[373]);class y{constructor(a,d,n,z,O=null,ca=null,Da=null,Xa=null){this.Cq=null;this.mc=a;this.Oik=d;this.jvc=n;this.Zm=z;this.O2c=O||
Object(m.a)(this,this.GBl,"getHeaderFooterKinds");this.j6j=ca||Object(m.a)(this,this.Tvl,"getContentNode");this.i6j=Da||Object(m.a)(this,this.Uvl,"getContentNodeForValidTable");this.Wck=Xa||Object(m.a)(this,this.Zam,"isHeaderFooterNodeOfCurrentSection")}get ME(){return this.Cq||(this.Cq=la.a.instance.resolve("Box4.IOutlineEditor"))}$5l(a,d,n){var z=yf(this.mc,this.Zm,a).Hm;z=this.Zm.Uza(z);z=this.O2c(d,z);let O=null;for(let Da=0;Da<z.length;Da++){var ca=z.Rf(Da);this.Wck(a,ca)&&(ca=this.j6j(a,d,ca),
O=this.Oik.Ovk(ca,n)||O)}return O}GBl(a,d){const n=new Uj.a;a=4>a;switch(d){case 1:case 2:n.add(a?0:3);break;case 3:case 4:n.add(a?0:3),n.add(a?1:4)}return n}Tvl(a,d,n){var z=yf(this.mc,this.Zm,a);this.Zm.Cfc(z,n);let O=this.i6j(z,d);if(O)this.jvc.coj(O);else{z=yf(this.mc,this.Zm,a);this.Zm.Cfc(z,n);z.Rc();if(Ia.OutlineElementReader.gg(z)&&(qe.OutlineElementNavigator.Sd(z),Bd.ParagraphReader.Zf(z))){z=z.currentNode;const ca=this.yFi(d);Bd.ParagraphReader.Jv(z)===ca&&this.jvc.coj(z)&&(O=z)}O||(z=yf(this.mc,
this.Zm,a),this.Zm.Cfc(z,n),this.ME.WGb(z,null,!0),O=qe.OutlineElementNavigator.Sd(z),this.NH(d,O))}return O}Uvl(a,d){let n=null;a.Va(1);if(Ia.OutlineElementReader.gg(a)&&(a.Va(2),If.TableReader.isTable(a))){var z=a.currentNode;if(3===If.TableReader.nh(z)){let O=0;z=If.TableReader.wi(z);switch(d){case 1:case 4:O=z?2:0;break;case 2:case 5:O=1;break;case 3:case 6:O=z?0:2}Uf.moveToCellContent(a,0,O);a.currentNode&&Ia.OutlineElementReader.gg(a)&&(a=qe.OutlineElementNavigator.Sd(a),Bd.ParagraphReader.nb(a)&&
(n=a))}}return n}NH(a,d){y.Wha.gYe(4>a?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,d);y.paragraphEditor.NH(d,this.yFi(a))}yFi(a){let d=1;switch(a){case 1:case 4:d=1;break;case 2:case 5:d=2;break;case 3:case 6:d=3}return d}Zam(a,d){const n=yf(this.mc,this.Zm,a);a=n.currentNode.fa(Qb.a.Wca,0);this.Zm.Cfc(n,d);d=n.currentNode.fa(Qb.a.Wca,0);return a===d}static get paragraphEditor(){return y.Ki||(y.Ki=la.a.instance.resolve("Box4.IParagraphEditor"))}static get Wha(){return y.Kz||
(y.Kz=la.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}}y.Ki=null;y.Kz=null;Object(t.a)(y,"PageNumbersInserter",null,[372]);var S=b(575),ea=b(651);class Ca{constructor(a,d,n=null,z=null,O=null){this.Nb=a;this.tbe=n||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.Jbf=z||Object(m.a)(this,this.ZZk,"createAndInsertPageNumberBlob");this.MPh=O||Object(m.a)(this,this.w6l,"insertTextRange")}Ovk(a,d){const n=this.Nb.Wb(15);n.Sa(a);var z=Bd.ParagraphReader.text(a),O=!1;0<
z.length&&" "!==z.charAt(z.length-1)&&(O=!0);if(d){d=String.format(this.tbe,"#","$");O&&(d=" "+d);O=d.indexOf("#");z=d.indexOf("$");k.ULS.shipAssertTag(4256717,309,-1!==O,"{0}",{["PageNumberIndex"]:O});k.ULS.shipAssertTag(4256718,309,-1!==z,"{0}",{["PageCountIndex"]:z});k.ULS.shipAssertTag(4256719,309,O!==z,"{0}",{["PageNumberIndex"]:O,["PageCountIndex"]:z});let Xa;let zb;if(O<z){var ca=O;Xa=z;var Da=S.a.dud(0);zb=S.a.dud(1)}else ca=z,Xa=O,Da=S.a.dud(1),zb=S.a.dud(0);this.Okg(a,d,0,ca);Da=this.Jbf(a,
Da);this.Okg(a,d,ca+1,Xa);ca=this.Jbf(a,zb);this.Okg(a,d,Xa+1,d.length);a=O<z?Da:ca}else O&&this.MPh(a," "),a=this.Jbf(a,S.a.dud(0));n.dispose();return a}ZZk(a,d){a=fe.a.Kb(a,Bd.ParagraphReader.textLength(a));const n=a.node.Ib;return n?Ca.characterPropertiesEditor.oga(a,z=>{z=ea.a.getInstance(z);this.dpe(z,15,n,d);this.dpe(z,47,n,d);this.dpe(z,16,n);this.dpe(z,17,n);return z},Vi.AParagraphNode.ix):null}dpe(a,d,n,z=null){const O=new Em.a;O.setValue(Vd.a.w5,!0);O.setValue(Qb.a.f4a,1);O.setValue(Qb.a.Jp,
d);switch(d){case 15:O.setValue(Qb.a.Bga,!0);O.setValue(Qb.a.fieldInstruction,z);break;case 47:O.setValue(Qb.a.fieldInstruction,z);break;case 17:O.setValue(Qb.a.h6a,!0)}d=n.Mu(O,E.a.create());this.Awk(a,d)}Awk(a,d){a.f3(d,E.a.nil,Vi.AParagraphNode.ix,null)}Okg(a,d,n,z){d=d.substring(n,z);0<d.length&&this.MPh(a,d)}w6l(a,d){a=fe.a.Kb(a,Bd.ParagraphReader.textLength(a));Ca.characterPropertiesEditor.replaceTextRange(a,d)}static get characterPropertiesEditor(){return Ca.hc||(Ca.hc=la.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(a){Ca.hc=
a}}Ca.hc=null;Object(t.a)(Ca,"PageNumbersNodeLevelInserter",null,[290]);class Ra{INm(a){return Ra.OKl(a)}static OKl(a){return String.format(a?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,Ra.Pcj,Ra.Pcj)}}Ra.Pcj="1";Object(t.a)(Ra,"PageNumbersPositionPreviewGenerator",null,[289]);class ob{constructor(){this.Erh=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");
this.L5j=this.Erh.length}yZl(a){let d=a.characterData.lastIndexOf("\ufffc");return-1!==d&&d+1===Bd.ParagraphReader.textLength(a)?{returnValue:!0,MMd:d}:{returnValue:!1,MMd:-1}}wYl(a){let d=a.characterData.lastIndexOf(this.Erh);return-1!==d&&d+this.L5j===Bd.ParagraphReader.textLength(a)?{returnValue:!0,MMd:d}:{returnValue:!1,MMd:-1}}iZl(a){return Lj.a(a,9)?!0:!1}}Object(t.a)(ob,"PageNumbersReader",null,[286]);class Fb{constructor(a,d,n,z,O,ca=null,Da=null){this.mc=a;this.Zm=d;this.bqf=n;this.Eb=z;
this.Aad=O;this.O2c=ca||tv.a.UVf;this.Tkk=Da||Object(m.a)(this,this.a7m,"removePageNumbersFromSection");this.tbe=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.hxh=String.format(this.tbe,"#","$");this.Hbk=this.hxh.indexOf("#");this.Gbk=this.hxh.indexOf("$");this.Hff=String.format(this.tbe,"\ufffc","\ufffc");this.axh=this.Hff.length}uQd(a,d,n){var z=yf(this.mc,this.Zm,a).Hm;z=this.Zm.Uza(z);z=this.O2c(z);for(let O of z)this.Tkk(a,O,d,n)}coj(a){if(this.bqf.iZl(a)){let d=
-1;if(({MMd:d}=this.bqf.wYl(a)).returnValue&&this.Y5h(a,d)||({MMd:d}=this.bqf.yZl(a)).returnValue&&this.EPk(a,d))return!0}return!1}a7m(a,d,n,z){a=yf(this.mc,this.Zm,a);this.Zm.Cfc(a,d);d=$s.a.Ep(a);for(a=!1;d.moveNext();){const O=d.currentNode;if(Bd.ParagraphReader.nb(d.currentNode)&&Lj.a(d.currentNode,9)){a=!0;let ca;const Da=({cGe:ca}=n(O,ca)).returnValue;let Xa=Da;Xa=this.X5m(O,Xa);Xa=this.n7m(O,Xa);-1<Da&&(Xa===Da&&ca||z(O,Xa))}}a&&this.Eb.Ws(12)}n7m(a,d){var n=a.ja.length;for(let O=0;O<n;O++){var z=
a.ja.J(O);z.blob&&9===z.blob.Qf&&(z=z.cp,n=fe.a.createTextRange(a,z,z+1),this.Aad(n,""),n=a.ja.length,O--,d=this.mXh(d,z,1))}return d}X5m(a,d){let n=a.characterData.indexOf(this.Hff);for(;-1!==n;)this.Y5h(a,n)&&(d=this.mXh(d,n,this.axh)),n=a.characterData.indexOf(this.Hff);return d}EPk(a,d){const n=a.ja.Yg(d);return n&&n.blob&&9===n.blob.Qf?(a=fe.a.createTextRange(a,d,d+1),this.Aad(a,""),!0):!1}Y5h(a,d){const n=a.ja.Yg(d+this.Hbk),z=a.ja.Yg(d+this.Gbk);return n&&n.blob&&9===n.blob.Qf&&z&&z.blob&&
9===z.blob.Qf?(a=fe.a.createTextRange(a,d,d+this.axh),this.Aad(a,""),!0):!1}mXh(a,d,n){-1<a&&a>d&&(d=a-d,a=d>n?a-n:a-d);return a}}Object(t.a)(Fb,"PageNumbersRemover",null,[285]);class Ob{constructor(a,d){this.vQb=this.uQb=null;this.Ym=a;this.fb=d}JBk(){this.Ym.style.display="";this.uQb||(this.vQb&&(this.fb.ie(this.vQb),this.vQb=null),this.uQb=new bf.a(0,1,10,()=>{this.Ym.classList.add("Displayed");this.uQb=null}),this.fb.rb(this.uQb))}KBk(){this.Ym.classList.remove("Displayed");this.vQb||(this.uQb&&
(this.fb.ie(this.uQb),this.uQb=null),this.vQb=new bf.a(0,1,200,()=>{this.Ym.style.display="none";this.vQb=null}),this.fb.rb(this.vQb))}}Object(t.a)(Ob,"PaneControlAnimationHelper",null,[319]);class lc{constructor(a){this.fb=a}OIl(a){return new Ob(a,this.fb)}}Object(t.a)(lc,"PaneControlAnimationHelperFactory",null,[283]);class Nc{constructor(a,d,n,z,O,ca,Da,Xa,zb=!1){this.jk=this.wnh=this.rxa=this.D7d=null;this.ga=a;this.aea=d;this.aea.bind(this);this.jjf=n;this.gPa=O;this.xxf=Da;this.ib=Xa;this.Q8d=
zb;this.jpa=ca.value.create(n,z);this.aea.fHk(this.jpa);this.d6=gb.KeyInputManager.$a(xb.a.G5,0)}get Au(){return this.jk||(this.jk=la.a.instance.resolve("Common.Utils.IAriaNotifier"))}E8(a){this.aea.E8(a);this.rxa&&!a&&this.rxa.Qal()}nra(a){this.D7d!==a&&(this.RDb(),this.D7d=a)}Evj(a){if(this.D7d){var d=this.gPa.HFb(this.D7d,tv.a.FBl(a,this.jjf));this.Q8d?(this.wnh=this.ysi(a,this.jjf),this.jpa.ttb(pd.a.Khd)):this.wKn(a);d&&this.kGf(d)}}q_h(a){this.Q8d&&this.ib&&(a=this.ib.Kc(a))&&a.maa(Object(m.a)(this,
this.RZl,"headerFooterOnFocus"))}RZl(){this.Au.sendNotification(this.wnh+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,!0)}ysi(a,d){let n="";switch(a){case 1:n=3!==this.ga.mode?d?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:d?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;
break;case 2:n=3!==this.ga.mode?d?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:d?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:n=3!==this.ga.mode?d?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:
d?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;break;case 4:n=3!==this.ga.mode?d?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:d?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return n}wKn(a){this.jpa.q0g(this.ysi(a,
this.jjf),WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,pd.a.Khd)}setInitialSelection(){this.jpa.qlc()}kGf(a){this.RDb();this.jpa.fz(a,a.Bf)}RDb(){this.jpa.detach()}X4k(){this.rxa=this.xxf.value.create(this.aea.EUc);this.qqn(this.rxa)}qqn(a){if(this.ib){const d=this.ib.Kc(sn.a.Ymb);d.parent=Ec.AFrame.hp;d.naa(()=>{a.setFocus();this.fpn()});d.bindAction(this.d6,Dc.a.e7)}}fpn(){if(this.ib){var a=this.ib.Kc(sn.a.Ymb);const d=new kd.DOMFocusListing(()=>this.aea.EUc);d.Una=
!0;d.Ln(1);this.ib.ple(this.aea.EUc,a,d);a=this.ib.getRegion(sn.a.Ymb);a.wKa();a.MS=!0;d.VU&&d.ou(d.VU)}}dispose(){void 0!==this.rxa&&null!==this.rxa&&(this.ib.Kc(sn.a.Ymb).zq(this.d6),this.rxa.dispose())}O1m(){void 0!==this.rxa&&null!==this.rxa&&this.rxa.refresh()}}Object(t.a)(Nc,"PaneControl",null,[320]);class nd{constructor(a,d,n,z){this.Zm=a;this.Fak=d;this.xxf=n;this.ib=z}create(a,d,n,z){return new Nc(a,d,n,z,this.Zm,this.Fak,this.xxf,this.ib,l.AFrameworkApplication.K.ea("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}
Object(t.a)(nd,"Factory",null,[284]);var Td=b(968);class ue extends hu.a{constructor(a,d,n,z,O,ca,Da,Xa,zb){super();this.init(a);this.Pj("ShowCalloutForPageNumberOperation");this.J1j=Xa;this.AIa(this.J1j,d,z,O,ca);this.GC=0;this.P9c=ca;this.f1a=Da;this.gh=zb;1===this.behavior&&(this.Zl=32,this.b1())}run(){var a=this.gh.za.tw;!this.GC&&this.P9c.GHc(a)&&this.P9c.W4a(a).element&&(this.GC=1);if(1===this.GC){const d=this.P9c.W4a(a);a=new Td.a(d.element,a);this.f1a.showCallout(a);this.GC=2}2===this.GC&&
(this.Zl=32,this.b1())}}Object(t.a)(ue,"ShowCalloutForPageNumberOperation",hu.a,[]);class Ce{constructor(a,d,n){this.f1a=a;this.ga=d;this.$pc=n}create(a,d,n,z,O,ca){return new ue(a,d,n,z,O,ca,this.f1a,this.ga,this.$pc)}}Object(t.a)(Ce,"Factory",null,[282]);class Df{constructor(){this.Cq=null}get ME(){return this.Cq||(this.Cq=la.a.instance.resolve("Box4.IOutlineEditor"))}Hb(a){a.ha("WordEditor.HeaderFooter.HeaderFooterManager",()=>new cz(a.resolve("WordEditor.HeaderFooter.HeaderFooterControlOwner"),
a.resolve("WordEditor.HeaderFooter.HeaderFooterActor"),a.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),a.vf("WordEditor.HeaderFooter.IPageNumbersActorFactory"),a.resolve("WordEditor.IHeaderFooterViewElementFactory"),a.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),a.resolve("Box4.IFeatureHelper"))).singleInstance();a.ha("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new aa(a.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),Xz.a.JOf,()=>
a.resolve("WordEditor.SectionAlignedViewRepositioner"),Lb.App.oa.za,Ic.InteractiveViewManager.instance,()=>a.resolve("Box4.IUndoManager"),l.AFrameworkApplication.pa,a.resolve("Box4.IInteractiveEventNotifier"),a.Ca("Box4.ITextMetricsAdapter"),a.resolve("Box4.IRotatingCoordinateConverter"),a.sa("Box4.IContentControlViewElementManager"),a.sa("Box4.CpConversionManagerImpl"),a.sa("Box4.ContentControlConfigSettings"),a.sa("Box4.IContentControlReader"),a.sa("Box4.IContentControlBoundaryNavigator"))).as("WordEditor.HeaderFooter.IHeaderFooterViewFactory").singleInstance();
a.ha("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new IB(a.resolve("Box4.SectionAlignedViewPositionProvider"),a.Ca("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),a.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Lb.App.instance&&Lb.App.instance.jQ)).as("WordEditor.IHeaderFooterViewElementFactory").singleInstance();a.ha("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new Ox(Rj.App.wn,a.Ca("Box4.IGeneralCuiUser"),a.resolve("Box4.IFeatureHelper"),
Rj.App.wn,l.AFrameworkApplication.pa)).as("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory").singleInstance();a.ha("WordEditor.HeaderFooter.PaneControl.Factory",()=>new nd(a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),a.vf("WordEditor.HeaderFooter.IHeaderFooterViewFactory"),a.vf("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory"),ic.FocusManager.instance())).as("WordEditor.HeaderFooter.IPaneControlFactory").singleInstance();a.ha("WordEditor.HeaderFooter.HeaderFooterControl.Factory",
()=>new az(()=>{Lb.App.oa.updateCommandUI()},a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),a.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),l.AFrameworkApplication.pa,a.resolve("Box4.ContentEditableViewEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlFactory").singleInstance();a.ha("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new Ya(l.AFrameworkApplication.pa,th.a.instance,a.resolve("WordEditor.HeaderFooter.PageNumbersControl"),a.resolve("WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator"),
a.resolve("WordEditor.HeaderFooter.PageNumbersInserter"),a.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),a.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),a.resolve("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory"),a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,h.KIl,Object(m.a)(Lb.App.oa,Lb.App.oa.Ioc,"updateRibbonControl"),Object(m.a)(Lb.App.oa,Lb.App.oa.jF,"updateRibbonControls"))).as("WordEditor.HeaderFooter.IPageNumbersActorFactory").singleInstance();
a.ha("WordEditor.HeaderFooter.HeaderFooterControlLauncher",()=>new Ow).singleInstance();a.ha("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory",()=>new lc(th.a.instance)).singleInstance();a.ha("WordEditor.HeaderFooter.HeaderFooterControlOwner",()=>new bz(ic.FocusManager.instance(),Lb.App.oa.rn,a.vf("WordEditor.HeaderFooter.IPaneControlFactory"),a.vf("WordEditor.HeaderFooter.IHeaderFooterControlFactory"),a.vf("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory"),l.AFrameworkApplication.pa,
new Nf.a(()=>Lb.App.oa.za.Rb),l.AFrameworkApplication.K,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Box4.IExternalContentFloatieEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent").singleInstance();a.ha("WordEditor.HeaderFooter.HeaderFooterEditor",()=>new RA(a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),mi.PageReader.instance,new so.a,jq.a.instance)).singleInstance();a.ha("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator",()=>new SA(new so.a,jq.a.instance));
a.ha("WordEditor.HeaderFooter.HeaderFooterActor",()=>new Hx(l.AFrameworkApplication.pa,a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),a.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),a.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),jq.a.instance,new so.a,new jn.a,a.resolve("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator"),Hx.JGi,a.resolve("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory"))).singleInstance();a.ha("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter",
()=>new Jq(Yy.a.instance,Jq.eQl(a.resolve("Box4.ITableEditor")),Jq.gul(),l.AFrameworkApplication.isRtl,qe.OutlineElementNavigator.Uc,Jq.DOl(),Jq.wBl(),a.resolve("Box4.IOutlineElementEditor")));a.ha("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter",()=>new Jx(a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new so.a,d=>this.ME.WGb(d),l.AFrameworkApplication.isRtl,Object(m.a)(a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.IOutlineElementEditor").plc,"setRtlSimple"),a.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter")));
a.ha("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter",()=>new Yv(jq.a.instance,a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),a.resolve("WordEditor.HeaderFooterNodeFactory"),a.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter"))).singleInstance();a.ha("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory",()=>new Xv(a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new so.a,new jn.a,a.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),l.AFrameworkApplication.pa)).singleInstance();
a.ha("WordEditor.HeaderFooter.HeaderFooterInserter",()=>new $y(a.resolve("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter"),a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),jq.a.instance,new so.a,l.AFrameworkApplication.pa)).singleInstance();a.ha("WordEditor.HeaderFooter.PageNumbersControl",()=>new h(Object(m.a)(Lb.App.oa,Lb.App.oa.Ioc,"updateRibbonControl"),Object(m.a)(Lb.App.oa,Lb.App.oa.jF,"updateRibbonControls"),l.AFrameworkApplication.isRtl)).singleInstance();a.register(Ra,"WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator").singleInstance();
a.ha("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter",()=>new Ca(new jn.a,a.resolve("Box4.IFeatureHelper"))).singleInstance();a.ha("WordEditor.HeaderFooter.PageNumbersInserter",()=>new y(new so.a,a.resolve("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter"),a.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).singleInstance();a.ha("WordEditor.HeaderFooter.PageNumbersReader",()=>new ob).singleInstance();a.ha("WordEditor.HeaderFooter.PageNumbersRemover",
()=>new Fb(new so.a,a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),a.resolve("WordEditor.HeaderFooter.PageNumbersReader"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(m.a)(Df.characterPropertiesEditor,Df.characterPropertiesEditor.replaceTextRange,"replaceTextRange"))).singleInstance();a.ha("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new ne(a.vf("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory"),Lb.App.oa)).as("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager").singleInstance();
a.ha("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new ce(th.a.instance,Lg.a.instance,a.resolve("Common.Utils.IAriaNotifier"))).as("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory").singleInstance();a.ha("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new Ce(a.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),l.AFrameworkApplication.pa,Lb.App.oa)).as("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory").singleInstance();
a.ha("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",()=>new Gx(a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),l.AFrameworkApplication.pa)).as("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager").singleInstance();a.ha("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new PA(a.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),a.resolve("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager"))).as("WordEditor.IClientPaginationHeaderFooterBridge").singleInstance()}static get characterPropertiesEditor(){return Df.hc||
(Df.hc=la.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}}Df.hc=null;Object(t.a)(Df,"HeaderFooterComponentConfiguration",null,[2]);class fg{constructor(){this.F7d=this.Z=null}get name(){return"WordEditor.HeaderFooter"}Hb(a){this.Z=a;(new Df).Hb(a)}init(){this.Z.resolve("Box4.IFeatureHelper").tk.continueWith(()=>{this.Po()})}Po(){this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(185)&&(this.F7d=this.Z.resolve("WordEditor.HeaderFooter.HeaderFooterManager"),this.F7d.start(),this.Z.resolve("WordEditor.IClientPaginationHeaderFooterBridge"))}dispose(){this.F7d&&
this.F7d.dispose()}static main(){M.a.instance.Sb(new fg)}}Object(t.a)(fg,"PackageManager",null,[1,2]);var Yg=b(330),ld=b(988);class te{constructor(a,d){this.fe=a;this.so=d}create(){return new ld.a(this.fe.instance,this.so.instance)}}Object(t.a)(te,"ContentControlNodeFactory",null,[244]);var Rh=b(166),zi=b(579);class vg{constructor(a,d,n,z){this.hc=a;this.fe=d;this.Ha=n;this.eg=z}get i0(){return!!this.fe.instance&&this.fe.instance.i0}get xHb(){return!!this.fe.instance&&this.fe.instance.xHb}qGa(a,d,
n,z,O,ca=Rh.a.C3a,Da=Rh.a.tjb,Xa=null,zb=Rh.a.pqe,Vb=-1){(a=this.Bye(a,n))?(a.Qa||(a.Qa=new Yg.a(a)),this.quk(d,a.Qa,z,O,ca,Da,Xa,zb,Vb)):k.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}x8k(a,d){if(a){new db.a;for(let z=0;z<a.count;z++){var n=this.W6f(a.J(z),d,!1);for(let O of n)this.Y5m(O)}}}replaceTextRange(a,d){this.hc.replaceTextRange(a,d)}Bye(a,d){var n=fe.a.Kb(a,d);this.hc.hLa(n);for(n=0;n<a.ja.length;n++){const z=a.ja.J(n);if(z.cp>d)break;if(z.cp===
d)return z}return null}quk(a,d,n,z,O=Rh.a.C3a,ca=Rh.a.tjb,Da=null,Xa=Rh.a.pqe,zb=-1){const Vb=d.Wa.paragraph;a=new zi.a(d.Wa,!0,!0,!0,null,a,z,n,O,ca,Da,Xa,null,this.eg);if(!this.i0||-1>=zb||zb>d.length)zb=d.length;d.insert(a,zb);Vb.$j();uf.a.instance.J(6)&&(a.Qc?Vb.wordRunProperties.aQ(a.Qc-1,512):Vb.wordRunProperties.uma(a.Qc,512),Vb.wordRunProperties.Qo.$(a.Qc,as.CharacterPropertiesEditor.KI),Vb.wordRunProperties.ir.$(a.Qc,as.CharacterPropertiesEditor.EK))}W6f(a,d,n){const z=new db.a;for(let O=
0;O<a.ja.length;O++){const ca=a.ja.J(O);if(ca.Qa)for(let Da=0;Da<ca.Qa.length;Da++)if(ca.Qa.J(Da).nd.equals(d)&&(z.add(ca.Qa.J(Da)),n))return z}return z}q_d(a,d,n){if(this.xHb&&a){var z=a.node,O=a.Gm,ca=a.$w,Da=this.tvi(z,O,d,!0);d=this.tvi(z,ca,d,!1);n?-1!==Da&&Da++:-1!==d&&d++;O||-1===Da||(Da=Math.max(Da,this.Ha.au(z)));ca===this.Ha.textLength(z)&&-1!==d&&(d=Math.min(d,this.Ha.$t(z)));a.Ma=Da;a.Xa=d}}tvi(a,d,n,z){return(a=(a=a.ja.Yg(d))?a.Qa:null)&&a.length?a.PP(n,z):-1}Y5m(a){if(a&&a.Wa.Qa){a.Wa.Qa.remove(a);
const d=a.Wa.paragraph;0<=a.Qc&&a.Qc<d.wordRunProperties.length&&(a.Wa.cp||1!==d.wordRunProperties.length||(d.wordRunProperties.aQ(0,512),d.wordRunProperties.Qo.$(1,as.CharacterPropertiesEditor.KI),d.wordRunProperties.ir.$(1,as.CharacterPropertiesEditor.EK)),d.wordRunProperties.removeAt(a.Qc,512));d.$j()}}}Object(t.a)(vg,"ContentControlChpManager",null,[242]);class ln{constructor(a,d,n,z,O){this.Ha=a;this.zk=d;this.Df=n;this.Ja=z;this.eg=O}H5f(a){if(!a||!Qd.SelectionEditor.Cd(a))return null;if(!a.cpBegin){const d=
this.Bti(a.node,a.Ma,!0);if(d)return d}return a.cpBegin===this.Ha.textLength(a.node)?this.Bti(a.node,a.Ma-1,!1):null}atl(a,d){a=this.uci(a,d);return this.H5f(a)}Bti(a,d,n){return a.ja&&a.ja.length?(a=n?a.ja.first.Qa:a.ja.last.Qa)&&0<=d&&d<a.length&&a.J(d).Te&&a.J(d).Db===n&&this.Zmg(a.J(d))?a.J(d):null:null}u9f(a){if(!a||!Qd.SelectionEditor.Tl(a))return null;var d=this.zk.Y6f(a,a);a=0<d.count?d.J(d.count-1):null;return a&&!a.Te&&this.Zmg(a)?(d=1<d.count?d.J(d.count-2):null)&&!d.Te&&this.Zmg(d)?null:
a:null}Zmg(a){if(!a)return!1;var d=this.GBi(a);if(!d)return!1;if(a.Db)var n=a;else n=d,d=a;var z=this.Ha.textLength(a.Wa.paragraph);if(n.Wa.cp||d.Wa.cp!==z||!n.mo||n.dBa||!d.mo||d.dBa)return!1;n=n.Wa.Qa;d=d.Wa.Qa;for(z=0;z<n.length&&!n.J(z).nd.equals(a.nd);z++)if(!n.J(z).Db)return!1;for(n=d.length-1;0<=n&&!d.J(n).nd.equals(a.nd);n--)if(d.J(n).Db)return!1;return!0}gVc(a){a=this.H5f(a);this.Goe(a,!1)}iMj(a,d){a=this.uci(a,d);this.gVc(a)}rZa(a){a=this.u9f(a);return this.Goe(a,!0)?a:null}FPi(a,d){a=this.H5f(a);
return!!a&&a.nd.equals(d)}K5a(a,d,n){a=this.atl(a,d);return!!a&&a.nd.equals(n)}UCd(a,d){a=this.u9f(a);return!!a&&a.nd.equals(d)}Goe(a,d){if(!a)return!1;const n=this.GBi(a);return this.kai(a,d)&&(!n||this.kai(n,d))}kai(a,d){if(!a||a.Te===d)return!1;var n=this.zk.O2e(a.Wa.paragraph,a.Db);const z=a.Wa.Qa;-1!==n||a.Db||(n=z.length);const O=d===a.Db?1:-1;n+=d?O:0;a=z.PP(a.nd,a.Db)+O;if(n===a||0<O!==a>n)return k.ULS.shipAssertTag(24933847,368,n!==a,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",
n,a,O),k.ULS.shipAssertTag(24933848,368,0<O===a>n,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",n,a,O),!1;for(var ca=n;ca!==a;ca+=O){var Da=z.J(ca);z.Qca(Da);Da.Te=d;z.eOi(Da,ca);this.ZMn(z.J(ca))}if(this.mY)for(z.Wa.paragraph.$j(),ca=n;ca!==a;ca+=O)Da=z.J(ca),Da.paragraph.wordRunProperties.Qo.$(Da.Qc,as.CharacterPropertiesEditor.KI),Da.paragraph.wordRunProperties.ir.$(Da.Qc,as.CharacterPropertiesEditor.EK);d?this.kPn(z,n,a,O):this.lPn(z,
n,a,O);k.ULS.sendTraceTag(24933849,368,50,"Converted {0} content control(s) to {1}",Math.abs(a-n),d?"block":"inline");return!0}Fag(a){var d,n;if(Fk.a.Il){if(a.Db&&this.eg.Ft.get(null===(d=a.contentControlNode.id)||void 0===d?void 0:d.toString()).equals(a.Wa.paragraph.id))return 38;if(!a.Db&&this.eg.Bu.get(null===(n=a.contentControlNode.id)||void 0===n?void 0:n.toString()).equals(a.Wa.paragraph.id))return 39}return a.Te&&a.Db?40:a.Te&&!a.Db?41:!a.Te&&a.Db?38:39}ZMn(a){const d=a.Wa.paragraph.Ib;if(d){var n=
d.Ta(a.Gv),z=a.contentControlNode;if(n&&z){n=n.clone();n.setValue(Qb.a.REd,a.Te);var O=this.Fag(a);n.setValue(Qb.a.Jp,O);d.Mu(n,null);a.Gv=n.id;z.setValue(Qb.a.J7,a.Te)}}}GBi(a){if(a.Wa.cp&&a.Wa.cp!==this.Ha.textLength(a.Wa.paragraph)||!a.Wa.paragraph.ja||!a.Wa.paragraph.ja.length)return null;const d=a.Db?a.Wa.paragraph.ja.last:a.Wa.paragraph.ja.first;if(!d.Qa)return null;a=d.Qa.PP(a.nd,!a.Db);return-1===a?null:d.Qa.J(a)}lPn(a,d,n,z){var O,ca;const Da=a.J(d).contentControlNode;if(Da){var Xa=a.J(d).Db,
zb=Xa?Qb.a.fi:Qb.a.vj;Xa=Fk.a.Il?Xa?this.eg.Ft:this.eg.Bu:null;Xa=Fk.a.Il?null!==(ca=Xa.get(null===(O=Da.id)||void 0===O?void 0:O.toString()))&&void 0!==ca?ca:E.a.nil:Da.fa(zb,E.a.nil);if(!Xa.equals(E.a.nil))if(a.Wa&&a.Wa.paragraph&&a.Wa.paragraph.id.equals(Xa)){for(d+=z;d!==n;d+=z){O=a.J(d).contentControlNode;if(!O)return;O.setValue(zb,Xa)}0<=n&&n<a.length&&a.J(n).Te&&this.dLc(a.J(n))&&(a=a.J(n).contentControlNode)&&a.setValue(zb,Xa)}else k.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}kPn(a,
d,n,z){var O;let ca=null;var Da=d-z;0<=Da&&Da<a.length&&a.J(Da).Te&&this.dLc(a.J(Da))&&(ca=a.J(Da).contentControlNode);for(Da=a.J(d).Db;d!==n;d+=z){const Xa=a.J(d).contentControlNode;if(!Xa)break;ca&&(Fk.a.Il?(Da?this.eg.Ft:this.eg.Bu).set(null===(O=ca.id)||void 0===O?void 0:O.toString(),Xa.id):ca.setValue(Da?Qb.a.fi:Qb.a.vj,Xa.id));ca=Xa}}dLc(a){return a.mo&&!a.dBa}uci(a,d){if(!a||!this.Df)return null;const n=d?fe.a.Kb(a,0):fe.a.kz(a);a=this.Df.hk(a,d);n.Xa=n.Ma=a;return n}get mY(){return this.Ja.isFeatureEnabled(41)}}
Object(t.a)(ln,"ContentControlConverter",null,[243]);var Rn;(function(a){a[a.gUn=0]="BoundingBox";a[a.dYn=1]="Tags";a[a.CVn=2]="Hidden";a[a.tWn=3]="NumberOfContentControlAppearance"})(Rn||(Rn={}));Object(t.b)("ContentControlAppearance",Rn);var Sn;(function(a){a[a.Unknown=-1]="Unknown";a[a.tXn=0]="RichText";a[a.MWn=1]="PlainText";a[a.LWn=2]="Picture";a[a.sUn=3]="ComboBox";a[a.cVn=4]="DropDownList";a[a.iUn=5]="BuildingBlockGallery";a[a.Date=6]="Date";a[a.oXn=7]="RepeatSectionItem";a[a.nUn=8]="CheckBox";
a[a.nXn=9]="RepeatSection";a[a.Bibliography=10]="Bibliography";a[a.uWn=11]="NumberOfContentControlKinds"})(Sn||(Sn={}));Object(t.b)("ContentControlKind",Sn);class Ym{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc){this.qyb=this.Icd=this.U0c=this.Ocd=this.Gae=null;this.$ua=this.wl=this.d$c=this._id=0;this.csc=this.zvc=this.Ffe=this._title=this.HMa=null;this.y9d=this.x9d=this.xCh=this.Sce=this.w4c=this.o4c=this.D5d=!1;this.rDh=null;this.Te=!1;this.gbf=null;this.aj=n;this.Xy=d;this.$g=z;this.tu=O;this.so=ca;
this.B9=Da;this.fFa=Xa;this.eqa=zb;this.V1b=Vb;this.eg=Fc;a?(this.Gae=a.id,this.gbf=a,this.D_(!1)):this._id=gf.a.HH()}get $i(){return this.aj.value}get id(){this.D_();return this._id}set id(a){this._id=a;this.Yb()&&(this.contentControlNode.setValue(Qb.a.IB,this._id),this.d9())}get parentId(){this.D_();return this.d$c}set parentId(a){this.d$c=a}get title(){this.D_();return this._title}set title(a){this._title=a;this.Yb()&&(this.contentControlNode.setValue(Qb.a.b3a,this._title),this.d9(),this.s_d(d=>
{d.title=this._title?this._title:Rh.a.C3a}))}get tag(){this.D_();return this.Ffe}set tag(a){this.Ffe=a;this.Yb()&&(this.contentControlNode.setValue(Qb.a.tBc,this.Ffe),this.d9())}get type(){this.D_();return this.wl}set type(a){this.wl=a;this.Yb()&&(this.contentControlNode.setValue(Qb.a.uBc,Sn[this.wl]),this.d9())}get appearance(){this.D_();return this.$ua}set appearance(a){if(a&&1!==a&&2!==a)throw Error.argumentUndefined("The appearance value is undefined enum.");this.$ua=a;this.Yb()&&(this.contentControlNode.setValue(Qb.a.c3a,
Rn[this.$ua].toLowerCase()),this.d9(),this.s_d(d=>{d.appearance=Rn[this.$ua].toLowerCase()}))}get color(){this.D_();return this.HMa}set color(a){if(a&&16777215>=a)this.HMa=a,this.Yb()&&(this.contentControlNode.setValue(Qb.a.o5b,this.HMa),this.d9(),this.s_d(d=>{d.color=this.HMa}));else throw Error.argumentOutOfRange("The color value is out of range.");}get aRe(){this.D_();return this.zvc}set aRe(a){this.zvc=a}get Bre(){this.D_();return this.csc}set Bre(a){this.csc=a;this.Yb()&&(this.contentControlNode.setValue(Qb.a.qBc,
this.csc),this.d9())}get PXf(){this.D_();return this.D5d}set PXf(a){a&&(this.D5d=a,this.Yb()&&(this.contentControlNode.setValue(Qb.a.emd,this.D5d),this.d9()))}get removeWhenEdited(){this.D_();return this.Sce}set removeWhenEdited(a){if(a&&!this.KAa)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");this.Sce=a;this.Yb()&&(this.contentControlNode.setValue(Qb.a.jPf,this.Sce),this.d9())}get KAa(){this.D_();return this.o4c}set KAa(a){if(!a&&
this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");this.o4c=a;this.Yb()&&(this.contentControlNode.setValue(Qb.a.q5b,this.o4c),this.s_d(d=>{d.vI=this.o4c}),this.d9())}get isEditable(){this.D_();return this.w4c}set isEditable(a){this.w4c=a;this.Yb()&&(this.contentControlNode.setValue(Qb.a.QRa,this.w4c),this.s_d(d=>{d.editable=this.w4c}),this.d9())}get isSupported(){this.D_();return this.xCh}get Lgm(){this.D_();
return this.csc&&"table of contents"===this.csc.toLowerCase()?!0:!1}get uGe(){this.D_();return this.x9d}set uGe(a){this.x9d=a;this.Yb()&&(this.contentControlNode.setValue(Qb.a.kPf,this.x9d),this.d9())}get xKc(){this.D_();return this.y9d}set xKc(a){this.y9d=a;this.Yb()&&(this.contentControlNode.setValue(Qb.a.lPf,this.y9d),this.d9())}get jV(){return this.contentControlNode.fa(Qb.a.V6,!1)}set jV(a){this.Yb()&&this.contentControlNode.setValue(Qb.a.V6,a)}get fi(){this.D_();return this.Ocd}set fi(a){this.Ocd=
a}get vj(){this.D_();return this.U0c}set vj(a){this.U0c=a}get objectId(){return this.Gae}set objectId(a){this.Gae=a;this.gbf=this.$i.Ta(this.Gae)}get start(){this.dQj();return this.Icd}set start(a){this.Icd=a}get end(){this.dQj();return this.qyb}set end(a){this.qyb=a}get contentControlNode(){return this.gbf}UOm(a){for(let d=0;3>d;++d)if(Rn[d].toLowerCase()===a)return d;return 0}VOm(a){for(let d=0;11>d;++d)if(Sn[d]===a)return d;return-1}d9(){const a=this.start.node;a&&a.setValue(Vd.a.hca,new Date)}yVc(){var a,
d,n,z;this._id=this.contentControlNode.fa(Qb.a.IB,0);this.$ua=this.UOm(this.contentControlNode.fa(Qb.a.c3a,null));this.HMa=this.contentControlNode.fa(Qb.a.o5b,null);this._title=this.contentControlNode.fa(Qb.a.b3a,null);this.Ffe=this.contentControlNode.fa(Qb.a.tBc,null);this.Te=this.contentControlNode.fa(Qb.a.J7,!1);this.o4c=this.contentControlNode.fa(Qb.a.q5b,!1);this.w4c=this.contentControlNode.fa(Qb.a.QRa,!1);this.xCh=this.contentControlNode.fa(Qb.a.U6,!1);this.csc=this.contentControlNode.fa(Qb.a.qBc,
null);this.D5d=this.contentControlNode.fa(Qb.a.emd,!1);Fk.a.Il?(this.Ocd=null!==(d=this.eg.Ft.get(null===(a=this.contentControlNode.id)||void 0===a?void 0:a.toString()))&&void 0!==d?d:E.a.nil,this.U0c=null!==(z=this.eg.Bu.get(null===(n=this.contentControlNode.id)||void 0===n?void 0:n.toString()))&&void 0!==z?z:E.a.nil):(this.Ocd=this.contentControlNode.fa(Qb.a.fi,E.a.nil),this.U0c=this.contentControlNode.fa(Qb.a.vj,E.a.nil));this.y9d=this.contentControlNode.fa(Qb.a.lPf,!1);this.x9d=this.contentControlNode.fa(Qb.a.kPf,
!1);this.Sce=this.contentControlNode.fa(Qb.a.jPf,!1);this.wl=this.VOm(this.contentControlNode.fa(Qb.a.uBc,"RichText"));a=null;try{const O=this.contentControlNode.fa(Qb.a.Nqa,E.a.nil);if(E.a.Ap(O,E.a.nil))this.d$c=0;else if(a=this.$i.Ta(O))this.d$c=a.fa(Qb.a.IB,0)}catch(O){this.d$c=0}this.nOn()}nOn(){if(this.V1b){var a=this.contentControlNode.fa(Qb.a.Aoe,"");if((a=this.fFa.zGi(a))&&0<a.length){this.zvc=this.Rsi(a.ra,a.Fb);return}}this.zvc=(a=this.$g.tTa())&&a.currentNode?a.currentNode.fa(Qb.a.pBc,
null):null}D_(a=!0){if(!a||this.Yb())a=this.contentControlNode.fa(Vd.a.lastModifiedTime,new Date(0)),this.rDh!==a&&(this.yVc(),this.rDh=a)}jPn(a,d){var n,z;this.Ocd=a;this.U0c=d;Fk.a.Il?(this.eg.Ft.set(null===(n=this.contentControlNode.id)||void 0===n?void 0:n.toString(),a),this.eg.Bu.set(null===(z=this.contentControlNode.id)||void 0===z?void 0:z.toString(),d)):(this.contentControlNode.setValue(Qb.a.fi,a),this.contentControlNode.setValue(Qb.a.vj,d))}dQj(){if(this.contentControlNode){var a=this.fi,
d=this.vj;if(!a||!d||a.equals(E.a.nil)||d.equals(E.a.nil))k.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");else if(a=this.$g.zza(a,!0),d=this.$g.zza(d,!1),a&&d)if(a.isConnected&&d.isConnected||k.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.Te)a=fe.a.create(a),this.tu.q_d(a,this.objectId,!0),this.start=a,a=fe.a.create(d),this.tu.q_d(a,this.objectId,!0),this.end=a;else{let n=d=-1;
if(a.ja){for(let z=0;z<a.ja.length&&(-1===d||-1===n);z++){const O=a.ja.J(z);if(O.Qa)for(let ca=0;ca<O.Qa.length&&(-1===d||-1===n);ca++){const Da=O.Qa.J(ca);E.a.Ap(Da.nd,this.objectId)&&(Da.Db?d=O.cp:n=O.cp)}}0<=d&&0<=n&&(a=fe.a.NR(d,n,!1,a),this.tu.q_d(a,this.objectId,!0),this.start=this.end=a)}}}}getText(){let a="";var d=this.start;const n=this.end;if(!d||!n)return a;this.Te?a=this.Rsi(d,n):(d=Bd.ParagraphReader.text(d.node).substring(d.cpBegin,n.cpEnd),a+=Vi.AParagraphNode.V0(d));return a}Yb(){return!!this.contentControlNode&&
this.contentControlNode.isConnected}setText(a){return this.eqa?this.so.jzj(this,a)?0:2:2}clear(){return this.eqa?this.so.jzj(this,"")?0:2:2}Aui(){const a=new db.a;var d=this.contentControlNode.fa(Qb.a.contentControlNode,[]);for(let n of d)if(!E.a.Ap(n,E.a.nil)){d=this.aj.value.Ta(n);try{a.add(this.B9.J5b(d,this.Xy,this.aj,this.$g,this.tu,this.so,this.fFa,this.eqa,this.V1b))}catch(z){}}return a}a5f(){const a=new db.a;this.Isi(this,a);return a}Isi(a,d){a=a.Aui();if(a.count)for(let n of a)d.add(n),this.Isi(n,
d)}kK(a=!1){const d=new db.a;if(this.Te){var n=this.so.P_(this.start,this.end);for(var z of n)n=fe.a.create(z),this.tu.q_d(n,this.objectId,a),d.add(n)}else z=this.start.clone(),this.tu.q_d(z,this.objectId,a),d.add(z);return d}s_d(a){const d=this.so.P_(this.start,this.end);for(let n=0;n<d.count;n++){const z=this.tu.W6f(d.J(n),this.objectId,!1);if(z){for(let O=0;O<z.count;O++)a(z.J(O));d.J(n).re()}}}Rsi(a,d){const n=new Sys.StringBuilder;d=this.so.P_(a,d);for(let z of d)z.id.equals(a.node.id)||n.append("\r"),
n.append(Bd.ParagraphReader.plainText(z));return n.toString()}}Object(t.a)(Ym,"ContentControl",null,[281]);class xo{constructor(a){this.eg=a}J5b(a,d,n,z,O,ca,Da,Xa,zb){return new Ym(a,d,n,z,O,ca,this,Da,Xa,zb,this.eg)}}Object(t.a)(xo,"ContentControlFactory",null,[241]);var uq=b(828);class $o{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc){this.Xy=a;this.aj=d;this.mc=n;this.ivc=z;this.a6j=O;this.Cq=ca;this.Ee=Da;this.Ha=Xa;this.Ebe=zb;this.e7d=Vb;this.eg=Fc}get Ft(){return this.eg.Ft}get Bu(){return this.eg.Bu}get DH(){return this.Xy.value}tTa(){const a=
this.mc.Sl();a.set(this.DH);this.ivc.pQ(a);if(a.Va(25))return a;this.e7d.instance&&this.e7d.instance.Tba&&k.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");k.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");return null}wud(a,d,n=!1){this.RDc();const z=new db.a;let O;if(a){O=a.Va(26);if(!O)return z;for(;O&&(!d(O)||(z.add(O),!n));){z.addRange(this.wud(a,d));if(n&&0<z.count)break;O=a.Kd(26)}a.hb()}return z}HIl(){const a=this.mc.Sl();a.set(this.Xy.value);
this.ivc.pQ(a);return a.currentNode}a6a(a,d,n){let z;z=a.equals(d);z||(z=(a=this.zza(a,n))?a.id.equals(d):!1);return z}p4a(a,d){var n,z,O,ca;a=this.Fu(a);if(!a)return null;let Da=null;for(;55===a.type;){let Xa;Xa=Fk.a.Il?d?null!==(z=this.eg.Ft.get(null===(n=a.id)||void 0===n?void 0:n.toString()))&&void 0!==z?z:E.a.nil:null!==(ca=this.eg.Bu.get(null===(O=a.id)||void 0===O?void 0:O.toString()))&&void 0!==ca?ca:E.a.nil:d?a.fa(Qb.a.fi,E.a.nil):a.fa(Qb.a.vj,E.a.nil);if(Xa.equals(Da)){a=null;break}else a=
this.Fu(Xa);Da=Xa}return a}zza(a,d){return(a=this.p4a(a,d))?Bd.ParagraphReader.nb(a)?a:d?this.Ha.Im(a):this.Ha.OL(a):null}xfi(a,d=!1){this.TKn(a);this.yfi(a,d)}TKn(a){var d,n,z,O,ca,Da,Xa,zb,Vb=this.sTa(a);Vb=this.sTa(Vb.parentNode);Vb=55===Vb.currentNode.type?Vb.currentNode.id:null;let Fc;if(Fk.a.Il){Fc=this.Fu(null!==(n=this.eg.Ft.get(null===(d=a.id)||void 0===d?void 0:d.toString()))&&void 0!==n?n:E.a.nil);for(d=this.Fu(null!==(O=this.eg.Bu.get(null===(z=a.id)||void 0===z?void 0:z.toString()))&&
void 0!==O?O:E.a.nil);Fc&&55===Fc.type;)Fc=this.Fu(null!==(Da=this.eg.Ft.get(null===(ca=Fc.id)||void 0===ca?void 0:ca.toString()))&&void 0!==Da?Da:E.a.nil);for(;d&&55===d.type;)d=this.Fu(null!==(zb=this.eg.Bu.get(null===(Xa=d.id)||void 0===Xa?void 0:Xa.toString()))&&void 0!==zb?zb:E.a.nil)}else{Fc=this.Fu(a.getValue(Qb.a.fi));for(d=this.Fu(a.getValue(Qb.a.vj));Fc&&55===Fc.type;)Fc=this.Fu(Fc.getValue(Qb.a.fi));for(;d&&55===d.type;)d=this.Fu(d.getValue(Qb.a.vj))}Fc&&d&&this.dOj(Fc.id,d.id,Vb,Yc=>{Yc=
Yc.fa(Qb.a.EU,E.a.nil);return!Yc||Yc.equals(E.a.nil)||a.id.equals(Yc)})}yfi(a,d=!1){var n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je;k.ULS.sendTraceTag(528537620,368,50,"Attempting to delete content control node");const Le=this.sTa(a),Ve=this.sTa(Le.parentNode);let gg=E.a.nil,Lh=E.a.nil;var Ki=Ve.currentNode.fa(Qb.a.contentControlNode,[]);const Ak=new db.a;for(let Rl=0;Rl<Ki.length;Rl++)Ak.add(Ki[Rl]);if(d){if(54!==Ve.currentNode.type){Fk.a.Il?(gg=this.eg.Ft.get(null===(n=Ve.currentNode.id)||void 0===n?void 0:
n.toString()),Lh=this.eg.Bu.get(null===(z=Ve.currentNode.id)||void 0===z?void 0:z.toString())):(gg=Ve.currentNode.getValue(Qb.a.fi),Lh=Ve.currentNode.getValue(Qb.a.vj));Ki=this.Fu(gg);for(n=this.Fu(Lh);Ki&&55===Ki.type;)gg=Fk.a.Il?this.eg.Ft.get(null===(O=Ki.id)||void 0===O?void 0:O.toString()):Ki.getValue(Qb.a.fi),Ki=this.Fu(gg);for(;n&&55===n.type;)Lh=Fk.a.Il?this.eg.Bu.get(null===(ca=n.id)||void 0===ca?void 0:ca.toString()):n.getValue(Qb.a.vj),n=this.Fu(Lh)}O=this.sTa(a);if(O.Va(26)){ca=new db.a;
for(ca.add(O.currentNode);O.Kd(26);)ca.add(O.currentNode);for(var Uk of ca)this.yfi(Uk,d)}}else if(Fk.a.Il?(gg=this.eg.Ft.get(null===(Da=a.id)||void 0===Da?void 0:Da.toString()),Lh=this.eg.Bu.get(null===(Xa=a.id)||void 0===Xa?void 0:Xa.toString())):(gg=a.getValue(Qb.a.fi),Lh=a.getValue(Qb.a.vj)),d=this.aDl(Ak,a.id),Uk=this.sTa(a),Uk.Va(26))for(O=this.sTa(Uk.currentNode),ca=O.currentNode,Ki=a;ca;)n=Uk.currentNode,Ak.insert(d++,n.id),ca=O.Kd(26),z=this.sTa(n),54!==Ve.currentNode.type?n.setValue(Qb.a.Nqa,
Ve.currentNode.id):n.removeProperty(Qb.a.Nqa),Bq.g(z,Ve,Ki,26),Ki=z.currentNode,ca&&(Uk.set(ca),Uk.jJ(this.tTa().currentNode));54!==Ve.currentNode.type&&(d=Fk.a.Il?null!==(Vb=this.eg.Ft.get(null===(zb=Ve.currentNode.id)||void 0===zb?void 0:zb.toString()))&&void 0!==Vb?Vb:E.a.nil:Ve.currentNode.fa(Qb.a.fi,E.a.nil),zb=Fk.a.Il?null!==(Yc=this.eg.Bu.get(null===(Fc=Ve.currentNode.id)||void 0===Fc?void 0:Fc.toString()))&&void 0!==Yc?Yc:E.a.nil:Ve.currentNode.fa(Qb.a.vj,E.a.nil),d.equals(a.id)&&(Fk.a.Il?
this.eg.Ft.set(null===(yd=Ve.currentNode.id)||void 0===yd?void 0:yd.toString(),gg):Ve.currentNode.setValue(Qb.a.fi,gg)),zb.equals(a.id)&&(Fk.a.Il?this.eg.Bu.set(null===(je=Ve.currentNode.id)||void 0===je?void 0:je.toString(),Lh):Ve.currentNode.setValue(Qb.a.vj,Lh)));Le.wg();k.ULS.sendTraceTag(528537621,368,50,"Disconnected nodeToDelete");this.remove(Ak,a.id);Ki=Array(Ak.count);for(Fc=0;Fc<Ak.count;Fc++)Ki[Fc]=Ak.J(Fc);Ve.currentNode.setValue(Qb.a.contentControlNode,Ki);uq.a.aWa(a.id)}puk(a,d,n,z,
O,ca,Da=null){var Xa,zb,Vb,Fc,Yc,yd,je,Le;let Ve,gg;d?(Ve=this.Fu(d.objectId),gg=this.sTa(Ve)):(gg=this.tTa(),Ve=gg.currentNode);const Lh=this.a6j.create(1074135145);Da&&Lh.properties.hn(Da.properties);Fk.a.Il||(Lh.setValue(Qb.a.fi,O),Lh.setValue(Qb.a.vj,ca));54!==Ve.type&&Lh.setValue(Qb.a.Nqa,Ve.id);Da?gg.Mnb(Lh,n,26,Da.id):gg.zE(Lh,n,26);Fk.a.Il&&(this.eg.Ft.set(null===(Xa=Lh.id)||void 0===Xa?void 0:Xa.toString(),O),this.eg.Bu.set(null===(zb=Lh.id)||void 0===zb?void 0:zb.toString(),ca));a.Te&&(d&&
(n=Fk.a.Il?null!==(Fc=this.eg.Ft.get(null===(Vb=Ve.id)||void 0===Vb?void 0:Vb.toString()))&&void 0!==Fc?Fc:E.a.nil:Ve.fa(Qb.a.fi,E.a.nil),Vb=Fk.a.Il?null!==(yd=this.eg.Bu.get(null===(Yc=Ve.id)||void 0===Yc?void 0:Yc.toString()))&&void 0!==yd?yd:E.a.nil:Ve.fa(Qb.a.vj,E.a.nil),n.equals(O)&&(Fk.a.Il?this.eg.Ft.set(null===(je=Ve.id)||void 0===je?void 0:je.toString(),Lh.id):Ve.setValue(Qb.a.fi,Lh.id)),Vb.equals(ca)&&(Fk.a.Il?this.eg.Bu.set(null===(Le=Ve.id)||void 0===Le?void 0:Le.toString(),Lh.id):Ve.setValue(Qb.a.vj,
Lh.id))),this.dOj(O,ca,Lh.id,Ki=>{Ki=Ki.fa(Qb.a.EU,E.a.nil);const Ak=d?d.objectId:null;return!Ki||Ki.equals(E.a.nil)||Ki.equals(Ak)}));O=this.sTa(Lh);ca=Array(z.count);for(Yc=z.count-1;0<=Yc;Yc--)ca[Yc]=z.J(Yc).objectId,yd=this.Fu(z.J(Yc).objectId),yd=this.sTa(yd),yd.currentNode.setValue(Qb.a.Nqa,Lh.id),Bq.g(yd,O,null,26);0<ca.length&&Lh.setValue(Qb.a.contentControlNode,ca);$o.Ka.isFeatureEnabled(54)&&(a.Bre&&Lh.setValue(Qb.a.qBc,a.Bre),a.PXf&&Lh.setValue(Qb.a.emd,!0));return Lh}Vjn(a,d,n,z){a.setValue(Qb.a.J7,
d);a.setValue(Qb.a.q5b,!0);a.setValue(Qb.a.QRa,!0);a.setValue(Qb.a.IB,n);a.setValue(Qb.a.c3a,Rn[0]);a.setValue(Qb.a.U6,!0);a.setValue(Qb.a.uBc,"RichText");z&&a.setValue(Qb.a.VOb,z);a.setValue(Qb.a.t5b,0)}Ifi(a){if(!a||!a.count||!a.J(0))return null;const d=this.Sag(a);for(let n=0;n<a.count;n++)this.Ee.isb(a.J(n));return d}Sag(a){if(!a||!a.J(0))return null;const d=this.mc.Sl();d.set(a.J(0));d.kc();d.hb();return d.lx()?d.currentNode:null}NJl(a){const d=this.mc.Sl();d.set(a);d.kc();d.hb();d.hb();return d}RUh(a,
d,n){const z=new db.a;for(let O=0;O<n;O++){d=this.Cq.WGb(a,d,!0,null);if(!d||!a.Rc())return null;const ca=a.currentNode;a.hb();a.hb();z.add(ca)}return z}gHc(a){const d=this.mc.Sl();d.set(a);for(d.La(7);d.hb();)switch(d.currentNode.type){case 8:case 16:case 36:case 40:return d.currentNode.id}return null}oBi(a){const d=this.mc.Sl();d.set(a);d.kc();return(a=d.vha())?a.id:null}D9f(a){const d=this.mc.Sl();d.set(a);return d.La(7)?d:null}Fu(a){return this.aj.value.Ta(a)}RDc(){if(!$o.PAh){var a=this.tTa();
a&&this.Zah(a);$o.PAh=!0}}n9a(a){return this.Ebe.n9a(a)}vAk(a,d){const n=this.mc.Sl();n.set(a.node);const z=this.mc.Sl();z.set(d.node);n.kc();z.kc();const O=this.mc.Sl();O.set(n.currentNode);const ca=this.mc.Sl();ca.set(z.currentNode);const Da=Uf.returnToLowestCommonTableCell(n,z);return Da?(O.kc(),ca.kc(),{returnValue:({hD:a}=this.Bme(O,!0,Da,a)).returnValue&&({hD:d}=this.Bme(ca,!1,Da,d)).returnValue,kFj:a,lki:d}):{returnValue:({hD:a}=this.Bme(n,!0,null,a)).returnValue&&({hD:d}=this.Bme(z,!1,null,
d)).returnValue,kFj:a,lki:d}}Bme(a,d,n,z){let O=null,ca=a.tc(16);for(;ca!==n;){if(d&&Sf.TableCellReader.jRi(a)||!d&&Sf.TableCellReader.Jpg(a))O=a.tc(14);else return{returnValue:!1,hD:z};ca=a.tc(16)}O&&(z=fe.a.create(O));return{returnValue:!0,hD:z}}Zah(a){if(a.Va(26)){for(this.Zah(a);a.Kd(26);)this.Zah(a);a.hb()}}remove(a,d){for(let n=0;n<a.count;n++)if(a.J(n).toString()===d.toString()){a.removeAt(n);break}}sTa(a){const d=this.mc.Sl();d.set(a);d.jJ(this.tTa().currentNode);return d}aDl(a,d){for(let n=
0;n<a.count;n++)if(a.J(n).equals(d))return n;return-1}dOj(a,d,n,z){a=this.Bvl(a,d);for(d=0;d<a.count;d++)z(a.J(d))&&(n?a.J(d).setValue(Qb.a.EU,n):a.J(d).removeProperty(Qb.a.EU),this.e7d.instance&&this.e7d.instance.Wmg&&a.J(d).Fi(16,!0))}Bvl(a,d){const n=new db.a;var z=this.Fu(a);const O=this.Fu(d);if(!z||!O)return n;const ca=({YFd:Da}=this.Lve(z,O)).returnValue;z=Da[ca];if(14===z.type)n.add(z);else if(15===z.type&&1<=ca){const Xa=Da[ca-1];1===If.TableReader.Sf(Xa)&&n.add(Xa)}var Da=Dd.GraphIterator.ua(ca>=
Da.length-1?z:Da[ca+1]);Da.La(7);for(z=Yi.a.Yo(Da,z);z.moveNext()&&z.currentNode!==O;)14===z.currentNode.type&&n.add(z.currentNode);if(!E.a.Ap(d,a)&&14===O.type)for(Da=Dd.GraphIterator.ua(O),z=Yi.a.Yo(Da,O);z.moveNext();)14===z.currentNode.type&&n.add(z.currentNode);return n}Lve(a,d){a=this.nTa(a);d=this.nTa(d);let n=0;for(;n<a.length&&n<d.length&&a[n]===d[n];++n);return{returnValue:0<n?n-1:n,YFd:a,YXg:d}}nTa(a){const d=[];d.push(a);a=Dd.GraphIterator.ua(a);for(a.La(7);a.hb();)d.push(a.currentNode);
d.reverse();return d}static get Ka(){return $o.Ja||($o.Ja=la.a.instance.sa("Box4.IFeatureHelper"))}}$o.PAh=!1;$o.Ja=null;Object(t.a)($o,"ContentControlGraphManager",null,[240]);class Zm{constructor(a,d,n,z,O,ca,Da,Xa,zb){this.rEa=null;Zm.Xy=a;Zm.aj=d;this.$g=n;this.tu=z;this.so=O;this.B9=ca;this.fFa=Da;this.fe=Xa;this.zk=zb}get fVa(){return!!this.fe.instance&&this.fe.instance.fVa}get Tba(){return!!this.fe.instance&&this.fe.instance.Tba}get YBd(){return!!this.fe.instance&&this.fe.instance.YBd}get i0(){return!!this.fe.instance&&
this.fe.instance.i0}get AJc(){return!!this.fe.instance&&this.fe.instance.AJc}xHb(){return!!this.fe.instance&&this.fe.instance.xHb}Exa(a,d,n=null,z=null,O=!1){if(!this.fVa)return{returnValue:2,id:0};a=this.$g.zza(a,!0);d=this.$g.zza(d,!1);if(!a||!d)return{returnValue:2,id:0};a=fe.a.create(a);d=fe.a.create(d);return this.KTh(a,d,n,z,O)}Dtk(a,d){return this.fVa&&a&&d?this.KTh(a,d,null):{returnValue:2,id:0}}u2b(a,d=null,n=!1){let z=0;if(!this.fVa)return{returnValue:2,id:z};const O=this.B9.J5b(d,Zm.Xy,
Zm.aj,this.$g,this.tu,this.so,this.fFa,this.fVa,this.YBd);O.start=a;O.end=a;O.fi=a.node.id;O.vj=a.node.id;O.Te=!1;return this.so.HUh(O,d,n)?(z=O.id,{returnValue:0,id:z}):{returnValue:2,id:z}}ouk(a,d,n=null){d=0;if(!this.fVa||!this.Ram(a))return{returnValue:2,id:d};var z=a.J(0).contextId===Kb.a.endOfParagraph?a.J(1):a.J(0);const O=a.J(a.count-1);if(this.aPf(a,Kb.a.paragraph)||this.aPf(a,Kb.a.endOfParagraph)){a=z.node.id;d=O.node.id;const ca=a.equals(d);z=this.so.FEj(z,!0);void 0!==z&&null!==z&&(a=
z,d=ca?a:d);this.so.FEj(O,!1);n.setValue(Qb.a.J7,!0);return this.Exa(a,d,n)}return z!==O||z.contextId!==Kb.a.Lc&&z.contextId!==Kb.a.Ub?{returnValue:2,id:d}:(n.setValue(Qb.a.J7,!1),this.u2b(z,n))}getById(a){if(!this.Tba)return null;const d=this.$g.wud(this.$g.tTa(),n=>n.getValue(Qb.a.IB)===a,!0);return 0<d.count?this.so.t7(d.J(0)):null}getByTitle(a){if(!this.Tba)return null;const d=this.$g.wud(this.$g.tTa(),z=>z.fa(Qb.a.b3a,null)===a,!1),n=new db.a;for(let z of d)n.add(this.so.t7(z));return n}getByTag(a){if(!this.Tba)return null;
const d=this.$g.wud(this.$g.tTa(),z=>z.fa(Qb.a.tBc,null)===a,!1),n=new db.a;for(let z of d)n.add(this.so.t7(z));return n}PX(a,d,n,z=!1){return this.Tba?this.i0?this.so.u4a(a,d,n):this.so.PX(a,d,n,z):null}P_(a,d){return this.so.P_(a,d)}rrl(){if(!this.Tba)return null;const a=this.$g.wud(this.$g.tTa(),()=>!0,!1),d=new db.a;for(let n of a)d.add(this.so.t7(n));return d}pQc(a){if(!this.fVa)return k.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),
2;a=this.getById(a);return this.so.tXa(a)?0:2}n8k(a){if(!this.fVa)return 2;a=this.getById(a);return this.so.deleteContentControl(a)?0:2}Buk(a){this.so.u2m(a)}YGk(a){this.rEa=a;this.rEa.U3m(Object(m.a)(this,this.gdm,"isOperationAllowed"))}Mvl(a){if(!this.xHb())return null;let d;var n=a.kK();d=this.Qxe(n.J(n.count-1),!1);n=this.tu.Bye(n.J(n.count-1).node,d.cpBegin).Qa;a=this.zQl(n,a);if(-1===a)return null;d.Ma=a;d.Xa=d.Ma;return d}gdm(a,d){if(this.i0)return this.hdm(a,d);if(!a||!a.count)return k.ULS.sendTraceTag(17356048,
368,15,"The GNC list should not be null or empty"),!1;let n=!0;switch(d){case 0:d=this.PX(a.J(0),a.J(a.count-1),1);if((a=this.PX(a.J(0),a.J(a.count-1),3))&&0<a.count){if(!a.J(0).isSupported||!a.J(0).isEditable){n=!1;break}for(a=a.J(0);a;)this.lQd(d,a.id),a=this.getById(a.parentId)}if(d)for(var z of d)if(!z.isSupported||!z.isEditable){n=!1;break}break;case 1:if(a.J(0).contextId!==Kb.a.Ub){k.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");
n=!1;break}(d=this.PX(a.J(0),a.J(0),1))&&0<d.count&&(n=!1);break;case 2:if(a.J(0).contextId!==Kb.a.Ub){k.ULS.sendTraceTag(17424994,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");n=!1;break}(d=this.PX(a.J(0),a.J(0),3))&&0<d.count&&(n=!1);break;case 3:case 4:d=this.Qxe(a.J(0),!0);z=this.Qxe(a.J(a.count-1),!1);if(!d||!z){k.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");
n=!1;break}if((d=this.PX(d,d,3))&&0<d.count){n=!1;break}if((d=this.PX(z,z,3))&&0<d.count){n=!1;break}if(d=this.so.PX(a.J(0),a.J(a.count-1),1))for(let O of d)if(!O.KAa){n=!1;break}break;default:n=!1}return n}hdm(a,d){if(!a||!a.count)return k.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),!1;switch(d){case 0:return this.G$l(a);case 3:case 4:case 6:return this.Eem(a,6===d);case 1:case 2:case 5:return 1!==a.count||a.J(0).contextId!==Kb.a.Ub?(k.ULS.sendTraceTag(21031132,368,
15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),!1):this.aSi(a.J(0),5===d,!1);default:return!1}}G$l(a){const d=this.so.u4a(a.J(0),a.J(a.count-1),3);if(d&&0<d.count){var n=d.J(0);if(!n.isSupported||!n.isEditable)return!1}a=this.so.u4a(a.J(0),a.J(a.count-1),1);for(n=0;d&&n<d.count;n++)this.lQd(a,d.J(n).id);if(a)for(let z of a)if(!z.isSupported||!z.isEditable)return!1;return!0}Eem(a,d){var n=a.J(0),z=a.J(a.count-1),O=n.Gm,ca=z.$w;if(-1===O||
-1===ca)return!1;O=this.zk.kba(n.node,O,n.Ma);ca=this.zk.kba(z.node,ca,z.Xa);var Da=-1,Xa=Math.min(O.count,ca.count);for(--Xa;0<=Xa;Xa--){const zb=O.J(Xa).nd,Vb=ca.J(Xa).nd;if(zb.equals(Vb)){Da=Xa;break}}if(-1<Da&&(Xa=this.so.t7(O.J(Da).contentControlNode),!Xa.isEditable||!Xa.isSupported||Xa.jV&&!this.p$l(Xa,a)))return!1;n=this.so.u4a(n,z,1);for(z=0;z<=Da;z++)this.lQd(n,this.so.t7(O.J(z).contentControlNode).id);for(z=Da+1;z<O.count;z++){Xa=this.so.t7(O.J(z).contentControlNode);if(!Xa.isEditable||
!Xa.KAa||!Xa.isSupported||Xa.jV)return!1;this.lQd(n,Xa.id)}for(O=Da+1;O<ca.count;O++){Da=this.so.t7(ca.J(O).contentControlNode);if(!Da.isEditable||!Da.KAa||!Da.isSupported||Da.jV)return!1;this.lQd(n,Da.id)}if(n)for(let zb of n)if(!zb.isSupported||!zb.KAa)return!1;return d&&(a=this.Qxe(a.J(0),!0))?this.aSi(a,!0,!0):!0}p$l(a,d){d=this.zk.IJl(d.J(0),d.J(d.count-1));return!!a&&!!d&&a.objectId.equals(d.nd)}aSi(a,d,n){return(a=this.so.u4a(a,a,3))&&0<a.count&&(a=a.J(0),!a.isSupported||!a.isEditable||!this.AJc&&
d&&!a.Te||!n&&a.jV)?!1:!0}Qxe(a,d){if(!a)return null;let n=null;switch(a.contextId){case Kb.a.paragraph:n=d?fe.a.Kb(a.node,0):fe.a.kz(a.node);break;case Kb.a.endOfParagraph:n=fe.a.kz(a.node);break;case Kb.a.Lc:n=d?fe.a.Kb(a.node,a.cpBegin):fe.a.Kb(a.node,a.cpEnd);break;case Kb.a.Ub:n=a}n&&(n.Xa=n.Ma=d?a.Ma:a.Xa);return n}lQd(a,d){if(a)for(let n of a)if(n.id===d){a.remove(n);break}}zQl(a,d){if(!a)return-1;let n=-1;for(let z=0;z<a.length;z++)if(a.J(z).nd.equals(d.objectId)&&!1===a.J(z).Db){n=z;if(d.Te&&
0<z&&a.J(z-1).Te&&!a.J(z-1).Db)return-1;break}return n}Ram(a){if(void 0===a||null===a)return!1;for(let d=0;d<a.count;d++){const n=a.J(d).contextId;if(n!==Kb.a.paragraph&&n!==Kb.a.endOfParagraph&&n!==Kb.a.Lc&&n!==Kb.a.Ub||0<d&&d<a.count-1&&n===Kb.a.Lc&&(a.J(d).cpBegin||a.J(d).cpEnd!==a.J(d).node.characterData.length))return!1}return a.J(0).contextId===Kb.a.endOfParagraph&&1===a.count||this.aPf(a,Kb.a.Ub)&&1<a.count?!1:!0}aPf(a,d){for(let n of a)if(n.contextId===d)return!0;return!1}KTh(a,d,n=null,z=
null,O=!1){let ca=0;var Da=d.node;let Xa=fe.a.create(a.node);Da=fe.a.create(Da);if(!({kFj:Xa,lki:Da}=this.$g.vAk(Xa,Da)).returnValue)return{returnValue:2,id:ca};const zb=this.B9.J5b(n,Zm.Xy,Zm.aj,this.$g,this.tu,this.so,this.fFa,this.fVa,this.YBd);zb.start=a;zb.end=d;zb.fi=Xa.node.id;zb.vj=Da.node.id;zb.Te=!0;zb.Bre=z;zb.PXf=O;return this.so.HUh(zb,n)?(ca=zb.id,{returnValue:0,id:ca}):{returnValue:2,id:ca}}}Zm.Xy=null;Zm.aj=null;Object(t.a)(Zm,"ContentControlManager",null,[239]);var Mp=b(640),Ul=b(147),
ht=b(183);class Gd extends Sys.EventArgs{constructor(a){super();this.Q6k=a}}Object(t.a)(Gd,"ContentControlChangeEventArgs",Sys.EventArgs,[]);class Wd{constructor(){this.G6i=0;this.Edj=null}}Object(t.a)(Wd,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",null,[]);class Ui{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le,Ve,gg,Lh,Ki,Ak,Uk,Rl,kk){this.JKh=[];this.Rrf=[];this.Xy=a;this.aj=d;this.$g=n;this.tu=z;this.B9=O;this.Wd=zb;this.nk=Vb;this.Da=ca;this.HG=Da;this.UOa=Xa;this.fFa=je;this.V1b=
Le;this.eqa=Fc;this.$H=Yc;this.ga=yd;this.zk=Ve;this.fe=gg;this.Df=Lh;this.Ha=Ki;this.Nb=Ak;this.TRh=Uk;this.Ja=Rl;this.eg=kk;this.$H&&(this.$H.addHandler(Mp.a.ajc,Object(m.a)(this,this.Raj,"onShowingPlaceholder")),this.$H.addHandler(Mp.a.zUe,Object(m.a)(this,this.jaj,"onRemoveWhenEdited")))}get DH(){return this.Xy.value}get $i(){return this.aj.value}get i0(){return!!this.fe.instance&&this.fe.instance.i0}get mY(){return!!this.Ja&&this.Ja.isFeatureEnabled(41)}get p9l(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContentControlGetActualParagraphNodeCrashFixIsEnabled",
!1)}get Xmg(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocumentAssemblyCCFormatting",!1)}dispose(){this.$H&&(this.$H.removeHandler(Mp.a.ajc,Object(m.a)(this,this.Raj,"onShowingPlaceholder")),this.$H.removeHandler(Mp.a.zUe,Object(m.a)(this,this.jaj,"onRemoveWhenEdited")))}PX(a,d,n,z=!1){if(this.i0)return this.u4a(a,d,n);if(!a||!d)return null;const O=this.$g.zza(a.node.id,!0);var ca=this.$g.zza(d.node.id,!1);if(!O||!ca)return null;a=a.contextId===Kb.a.endOfParagraph?
a:fe.a.Kb(O,-1===a.cpBegin?0:a.cpBegin);d=d.contextId===Kb.a.endOfParagraph?d:fe.a.Kb(ca,-1===d.cpEnd?ca.characterData.length:d.cpEnd);ca=null;switch(n){case 0:ca=this.mzl(a,d);break;case 1:ca=this.UJl(a,d);break;case 3:ca=this.SBi(a,d,z);break;case 2:ca=this.vRl(a,d);break;case 4:ca=this.Bvi(a,d,!1)}return ca}u4a(a,d,n){if(!a||!d||a.contextId!==Kb.a.endOfParagraph&&(a=this.lai(a,!0),!a)||d.contextId!==Kb.a.endOfParagraph&&(d=this.lai(d,!1),!d))return null;let z=null;switch(n){case 0:z=this.nzl(a,
d);break;case 1:z=this.VJl(a,d);break;case 3:z=this.TBi(a,d);break;case 2:z=this.wRl(a,d);break;case 4:z=this.Bvi(a,d,!0)}return z}lai(a,d){var n=this.$g.zza(a.node.id,d);if(!n)return null;d?(d=-1===a.cpBegin?0:a.cpBegin,a=a.Ma):(d=-1===a.cpEnd?n.characterData.length:a.cpEnd,a=a.Xa);n=fe.a.Kb(n,d);n.Ma=a;n.Xa=a;return n}mzl(a,d){const n=new db.a;if(a.contextId===Kb.a.endOfParagraph||d.contextId===Kb.a.endOfParagraph||a.equals(d))return n;const z=new hl.a,O=this.Q8b(a,a),ca=this.Q8b(d,d);for(let Da=
0;Da<O.count;Da++)if(O.J(Da).Db)for(let Xa=0;Xa<ca.count;Xa++)ca.J(Xa).Db||O.J(Da).nd.equals(ca.J(Xa).nd)&&(!O.J(Da).Te||this.$g.a6a(O.J(Da).nd,a.node.id,!0)&&this.$g.a6a(ca.J(Xa).nd,d.node.id,!1))&&this.She(n,z,O.J(Da).nd);return n}nzl(a,d){const n=new db.a;if(a.contextId===Kb.a.endOfParagraph||d.contextId===Kb.a.endOfParagraph||a.equals(d)&&a.Ma===a.Xa||-1===a.Ma||-1===d.Xa)return n;var z=a.node.ja.Yg(a.cpBegin),O=d.node.ja.Yg(d.cpEnd);z&&z.Qa&&0<z.Qa.length&&a.Ma<=z.Qa.length&&O&&O.Qa&&0<O.Qa.length&&
d.Xa<=O.Qa.length&&(a=a.Ma,d=d.Xa,a===z.Qa.length&&a--,0<d&&d--,z=z.Qa.J(a),O=O.Qa.J(d),z.Db&&!O.Db&&E.a.Ap(z.nd,O.nd)&&z.mo&&O.mo&&(O=z.contentControlNode)&&n.add(this.t7(O)));return n}UJl(a,d){const n=new db.a,z=new hl.a,O=this.Q8b(a,d);for(let ca=0;ca<O.count;ca++)this.She(n,z,O.J(ca).nd);a=this.SBi(a,d,!1,!1);for(let ca of a)z.contains(ca.objectId)||(n.add(ca),z.add(ca.objectId));return n}VJl(a,d){const n=new db.a,z=new hl.a,O=this.W5f(a,d);for(let ca=0;ca<O.count;ca++)this.OAf(n,z,O.J(ca));a=
this.TBi(a,d);for(let ca of a)z.contains(ca.objectId)||(n.add(ca),z.add(ca.objectId));return n}SBi(a,d,n,z=!0){const O=new db.a;a.equals(d)&&(n=!1);const ca=new hl.a;let Da=!1;a=this.Q8b(null,a,!0,n);d=this.Q8b(d,null,n,!0);for(n=a.count-1;0<=n;n--){for(let Xa=0;Xa<d.count&&!(a.J(n).nd.equals(d.J(Xa).nd)&&(a.J(n),this.She(O,ca,a.J(n).nd)&&(Da=!this.$g.Fu(a.J(n).nd).fa(Qb.a.Nqa,null),z||Da)));Xa++);if(0<O.count&&(z||Da))break}return O}TBi(a,d){const n=new db.a,z=new hl.a,O=a.node;var ca=d.node;const Da=
d.contextId===Kb.a.endOfParagraph?ca.characterData.length:d.cpEnd;a=this.zk.kba(O,a.contextId===Kb.a.endOfParagraph?O.characterData.length:a.cpBegin,a.Ma);d=this.zk.kba(ca,Da,d.Xa);ca=a.count>d.count?d.count:a.count;for(--ca;0<=ca;ca--)a.J(ca).nd.equals(d.J(ca).nd)&&this.OAf(n,z,a.J(ca));return n}vRl(a,d){const n=new db.a;let z=new hl.a;const O=this.Q8b(a,d);let ca=0,Da=null;if(a.equals(d))return n;for(a=0;a<O.count;a++)!O.J(a).Db||O.J(a).Te&&!this.$g.a6a(O.J(a).nd,O.J(a).Wa.paragraph.id,!0)?O.J(a).Db||
O.J(a).Te&&!this.$g.a6a(O.J(a).nd,O.J(a).Wa.paragraph.id,!1)||(ca--,0>ca?(ca=0,z=new hl.a):!ca&&Da&&O.J(a).nd.equals(Da)&&this.She(n,z,Da)):(ca||(Da=O.J(a).nd),ca++);return n}wRl(a,d){const n=new db.a;if(a.equals(d)&&a.Ma===d.Xa)return n;let z=new hl.a;a=this.W5f(a,d);d=0;let O=null;for(let ca=0;ca<a.count;ca++){const Da=a.J(ca);!Da.Db||Da.Te&&!this.$g.a6a(Da.nd,Da.Wa.paragraph.id,!0)?Da.Db||Da.Te&&!this.$g.a6a(Da.nd,Da.Wa.paragraph.id,!1)||(d--,0>d?(d=0,z=new hl.a):!d&&O&&Da.nd.equals(O.nd)&&this.OAf(n,
z,O)):(d||(O=Da),d++)}return n}Bvi(a,d,n){const z=new db.a;a=n?this.W5f(a,d):this.Q8b(a,d);d=0;for(n=0;n<a.count;n++){var O=a.J(n);O.mo&&(O.Db?d++:(d--,0>d?d=0:(O=this.t7(O.contentControlNode))&&z.add(O)))}return z}Q8b(a,d,n=!0,z=!0){const O=new db.a,ca=this.P_(a,d);if(!ca.count)return O;let Da,Xa,zb,Vb;for(let Fc=0;Fc<ca.count;Fc++){Da=0;Xa=ca.J(Fc).characterData.length;zb=Vb=!0;if(a&&ca.J(Fc).id.equals(a.node.id)){if(a.contextId===Kb.a.endOfParagraph)continue;0<=a.cpBegin&&(Da=a.cpBegin)}d&&ca.J(Fc).id.equals(d.node.id)&&
0<=d.cpEnd&&(Xa=d.cpEnd);Fc||(zb=n);Fc!==ca.count-1||d&&d.contextId===Kb.a.endOfParagraph||(Vb=z);O.addRange(this.Ntl(ca.J(Fc),Da,Xa,zb,Vb))}return O}W5f(a,d){const n=new db.a,z=this.P_(a,d);let O,ca,Da;for(let zb=0;zb<z.count;zb++){const Vb=z.J(zb);var Xa=Vb.ja.J(Vb.ja.length-1);O=0;ca=Vb.characterData.length;Da=0;Xa=Xa&&Xa.Qa?Xa.Qa.length:0;a&&Vb.id.equals(a.node.id)&&(O=a.Gm,Da=a.Ma);d&&Vb.id.equals(d.node.id)&&(ca=d.$w,Xa=d.Xa);n.addRange(this.Otl(Vb,O,ca,Da,Xa))}return n}Ntl(a,d,n,z=!0,O=!0){const ca=
new db.a;a=a.ja;for(let Da=0;Da<a.length;Da++){if(a.J(Da).cp<d)continue;if(a.J(Da).cp>n)break;const Xa=a.J(Da);if(Xa.Qa&&0<Xa.Qa.length&&(Xa.cp!==d||z)&&(Xa.cp!==n||O))for(let zb=0;zb<Xa.Qa.length;zb++)ca.add(Xa.Qa.J(zb))}return ca}Otl(a,d,n,z,O){const ca=new db.a;a=a.ja;for(let Da=0;Da<a.length;Da++){if(a.J(Da).cp<d)continue;if(a.J(Da).cp>n)break;const Xa=a.J(Da);if(Xa.Qa&&0<Xa.Qa.length){let zb=0,Vb=Xa.Qa.length;Xa.cp===d&&(zb=z);for(Xa.cp===n&&(Vb=O);zb<Vb&&zb<Xa.Qa.length;zb++)ca.add(Xa.Qa.J(zb))}}return ca}She(a,
d,n){let z=null;if(d.contains(n)||!(z=this.$i.Ta(n)))return!1;a.add(this.t7(z));d.add(n);return!0}OAf(a,d,n){let z=null;!d.contains(n.nd)&&(z=n.contentControlNode)&&(a.add(this.t7(z)),d.add(n.nd))}tLj(a,d,n,z){let O=!1;a=({x7a:n,w7a:z,bVd:O}=this.uLj(a,d,n,z,!1,O)).returnValue||O;O&&(a=a||({x7a:n,w7a:z,bVd:O}=this.uLj(n,z,n,z,!0,O)).returnValue);return{returnValue:a,x7a:n,w7a:z}}uLj(a,d,n,z,O,ca){var Da,Xa,zb,Vb;if(O)return z=n=null,{returnValue:!1,x7a:n,w7a:z,bVd:!1};let Fc=!1;n=a;z=d;const Yc=a.cpBegin,
yd=d.cpEnd;ca=!1;var je=O?this.Osi(d):this.Drl(a);let Le=!1,Ve=!1,gg=0,Lh=0;for(let Ki of je)for(je=0;je<Ki.ja.length;je++){const Ak=Ki.ja.J(je);!Ve&&Ki.id.equals(d.node.id)&&(Ve=!0);if(!Le&&(Ki.id.equals(d.node.id)&&-1!==yd&&Ak.cp>yd||Ve&&!Ki.id.equals(d.node.id)))if(Le=!0,gg!==Lh)Fc=!0;else return{returnValue:!1,x7a:n,w7a:z,bVd:ca};if((!Ki.id.equals(a.node.id)||Ak.cp>=Yc||-1===Yc)&&Ak.Qa)for(let Uk=0;Uk<Ak.Qa.length;Uk++){const Rl=Ak.Qa.J(Uk),kk=this.$i.Ta(Rl.nd);if(!kk.getValue(Qb.a.J7)||(!Rl.Db||
this.$g.a6a(Fk.a.Il?null!==(Xa=this.eg.Ft.get(null===(Da=kk.id)||void 0===Da?void 0:Da.toString()))&&void 0!==Xa?Xa:E.a.nil:kk.fa(Qb.a.fi,E.a.nil),Ki.id,!0))&&(Rl.Db||this.$g.a6a(Fk.a.Il?null!==(Vb=this.eg.Bu.get(null===(zb=kk.id)||void 0===zb?void 0:zb.toString()))&&void 0!==Vb?Vb:E.a.nil:kk.fa(Qb.a.vj,E.a.nil),Ki.id,!1))){Rl.Db?gg++:gg--;if(Fc&&gg===Lh)return{x7a:n,w7a:z}=this.$_k(a.node,Ki,a.cpBegin,Ak.cp),{returnValue:!0,x7a:n,w7a:z,bVd:ca};!O&&gg<Lh&&(ca=!0,Lh--)}}}return{returnValue:Fc,x7a:n,
w7a:z,bVd:ca}}$_k(a,d,n,z){let O;d.id.equals(a.id)?a=0<n||z<Bd.ParagraphReader.textLength(d)?O=fe.a.createTextRange(d,n,z):O=fe.a.create(d):(O=0<n?fe.a.createTextRange(a,n,Bd.ParagraphReader.textLength(a)):fe.a.create(a),a=z<Bd.ParagraphReader.textLength(d)?fe.a.createTextRange(d,0,z):fe.a.create(d));return{x7a:O,w7a:a}}KGl(a){var d,n,z,O;const ca=a.cpBegin,Da=this.Osi(a);for(let zb=Da.count-1;0<=zb;zb--){const Vb=Da.J(zb);for(let Fc=Vb.ja.length-1;0<=Fc;Fc--){const Yc=Vb.ja.J(Fc);if((!Vb.id.equals(a.node.id)||
Yc.cp<=ca||-1===ca&&!Yc.cp)&&Yc.Qa){var Xa=Yc.Qa.length-1;for((Yc.cp===ca||-1===ca&&!Yc.cp)&&this.i0&&Vb.id.equals(a.node.id)&&(Xa=a.Ma-1);0<=Xa;Xa--){const yd=Yc.Qa.J(Xa),je=this.$i.Ta(yd.nd);if(yd.Db){if(je.getValue(Qb.a.J7)&&!this.$g.a6a(Fk.a.Il?null!==(O=this.eg.Ft.get(null===(z=je.id)||void 0===z?void 0:z.toString()))&&void 0!==O?O:E.a.nil:je.fa(Qb.a.fi,E.a.nil),Vb.id,!0))continue;return null}if(!je.getValue(Qb.a.J7)||this.$g.a6a(Fk.a.Il?null!==(n=this.eg.Bu.get(null===(d=je.id)||void 0===d?
void 0:d.toString()))&&void 0!==n?n:E.a.nil:je.fa(Qb.a.vj,E.a.nil),Vb.id,!1))return this.t7(je)}}}}return null}t7(a){if(!a)return null;this.$g.RDc();return this.B9.J5b(a,this.Xy,this.aj,this.$g,this.tu,this,this.fFa,this.eqa,this.V1b)}P_(a,d){a=this.Nsi(a,d,Ui.Mza(12));if(!a)return null;d=new db.a;for(let n of a)d.add(n);return d}Brl(a,d){const n=Ui.CDl();return this.Nsi(fe.a.create(a.node),fe.a.create(d.node),n)}Nsi(a,d,n){if(!n||!a&&!d)return null;if(a&&d&&(a.equals(d)||a.node.id.equals(d.node.id))){var z=
a.node;if(z&&n(z)){var O;return O=new db.a,O.add(z),O}}z=Object.assign(new Wd,{G6i:35,Edj:n});a=a?a.node:null;d=d?d.node:null;O=this.rNl(a,d);if(!O)return null;d=this.xAk(d,n,Ui.V2h,z);return this.yrl(a,d,O,n,Ui.V2h,z)}rNl(a,d){return(a=a?this.fzi(a):this.fzi(d))?a.tc(35):this.$g.HIl()}xAk(a,d,n,z){if(!a)return null;d(a)||(d=this.zrl(a,d,n,z),d.count&&(a=d.J(d.count-1)));return a}yrl(a,d,n,z,O,ca){a?(a=Dd.GraphIterator.ua(a),a.La(7),n=Yi.a.Yo(a,n)):n=Yi.a.Ql(n);O&&n.zj(O,ca);for(O=new db.a;n.moveNext()&&
(z(n.currentNode)&&O.add(n.currentNode),!d||!n.currentNode.id.equals(d.id)););return O}zrl(a,d,n,z){a=Yi.a.Ql(a);n&&a.zj(n,z);for(n=new db.a;a.moveNext();)d(a.currentNode)&&n.add(a.currentNode);return n}fzi(a){a=Dd.GraphIterator.ua(a);return a.La(35)?a:null}wJi(a,d){a=this.P_(a,d);for(let n of a)if((a=this.$g.D9f(n))&&a.ZP(4))return!0;return!1}HUh(a,d=null,n=!1){if(!a)return!1;var z=a.start,O=a.end;if(!Qd.SelectionEditor.Tl(z)&&z.contextId!==Kb.a.paragraph||!Qd.SelectionEditor.Tl(O)&&O.contextId!==
Kb.a.paragraph||!this.i0&&({x7a:z,w7a:O}=this.tLj(a.start,a.end,z,O)).returnValue||this.i0&&!({start:z,end:O}=this.ZNk(z,O)).returnValue)return!1;a.start=z;a.end=O;const ca=this.L$l(z,O);if(this.i0){var Da=this.u4a(a.start,a.end,3);var Xa=this.u4a(a.start,a.end,2)}else Da=this.PX(a.start,a.end,3),Xa=this.PX(a.start,a.end,2);const zb=Da&&0<Da.count?Da.J(0):null,Vb=Xa&&0<Xa.count?Xa.J(0):null;if(n)return this.bCd(a,0,Da)?!0:!1;if(this.bCd(a,0,Da)){n=(n=Object(qa.a)(Ym,this.KGl(a.start)))?this.$g.Fu(n.objectId):
null;Xa=this.$g.puk(a,zb,n,Xa,a.fi,a.vj,d);if(a.Te)for(z=this.P_(a.start,a.end),O=0;O<z.count;O++)this.i0?(n=zb?zb.objectId:null,Da=this.Qyi(n,z.J(O),!0),this.tu.qGa(z.J(O),Xa.id,0,!0,!0,void 0,void 0,void 0,void 0,Da),n=this.Qyi(n,z.J(O),!1),this.tu.qGa(z.J(O),Xa.id,z.J(O).characterData.length,!0,!1,void 0,void 0,void 0,void 0,n)):(this.tu.qGa(z.J(O),Xa.id,0,!0,!0),this.tu.qGa(z.J(O),Xa.id,z.J(O).characterData.length,!0,!1));else this.i0?(n=-1===z.Ma?0:z.Ma,this.tu.qGa(a.start.node,Xa.id,z.cpBegin,
!1,!0,void 0,void 0,void 0,void 0,n),this.tu.qGa(a.end.node,Xa.id,O.cpEnd,!1,!1,void 0,void 0,void 0,void 0,ca?n+1:O.Xa)):(this.tu.qGa(a.start.node,Xa.id,a.start.cpBegin,!1,!0),this.tu.qGa(a.start.node,Xa.id,a.start.cpEnd,!1,!1));d||this.$g.Vjn(Xa,a.Te,a.id,this.$g.gHc(this.$g.Fu(a.fi)));a.objectId=Xa.id;d=this.$g.tTa().currentNode;d.hasProperty(Qb.a.pBc)||d.setValue(Qb.a.pBc,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);zb&&this.DPj(zb.contentControlNode,a);Vb&&this.DPj(Xa,Vb);ca&&
this.ga.ob(Mb.a.qZe,2,a.id);return!0}return!1}deleteContentControl(a){if(this.bCd(a,3)){a.jV&&(a.jV=!1);const d=this.Da.ya.Ba;a=a.kK();const n=new pa.Selection(a.toArray(),!0);let z=!1;this.Da.sMb(()=>{this.Da.setSelection(n);if(32===this.ga.processAction(Mb.a.iK,2)){if(this.TRh.instance){const O=this.TRh.instance.iAi(d,n,this.Da.ya.Ba);this.Da.sNj(new Ul.SelectionCollection([O],0))}z=!0}});return z}k.ULS.sendTraceTag(528537614,368,15,"Invalid content control to delete");return!1}tXa(a,d=!1){if(this.bCd(a,
2)){if(a.jV)return k.ULS.sendTraceTag(528537615,368,15,"Attempting to delete content control showing placeholder"),this.deleteContentControl(a);const n=this.$g.Fu(a.objectId);let z=new db.a;d&&(z=a.a5f());z.add(a);n&&n.anchor&&this.$g.xfi(n,d);for(let O of z)a=this.P_(O.start,O.end),this.tu.x8k(a,O.objectId);this.Kij(z);k.ULS.sendTraceTag(528537616,368,50,"Successfully released content control.");return!0}k.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");return!1}jzj(a,d){if(this.bCd(a,
1)){let Xa=!1;d||(Xa=!0,{rsn:n,returnValue:d}=this.Uvd(a),n&&this.$g.tTa().currentNode.setValue(Qb.a.pBc,d));var n=a.Aui().toArray();for(var z=0;z<n.length;z++)this.tXa(n[z],!0);d=this.syn(d);if(a.Te){z=this.P_(a.start,a.end);if(!z.count)return!1;if(this.Xmg&&1===z.count&&l.AFrameworkApplication.Ifa)d=d.join(" "),this.tu.replaceTextRange(fe.a.createTextRange(z.J(0),0,z.J(0).characterData.length),d);else{var O=this.$g.NJl(z.J(0));n=z.J(0).plb();z=this.$g.Ifi(z);z=this.$g.RUh(O,z,d.length);for(O=0;O<
z.count;O++){this.tu.replaceTextRange(fe.a.createTextRange(z.J(O),0,0),d[O]);for(var ca=0;ca<n.count;ca++)this.tu.qGa(z.J(O),n.J(ca),0,!0,!0),this.tu.qGa(z.J(O),n.J(n.count-ca-1),z.J(O).characterData.length,!0,!1)}a.jPn(z.J(0).id,z.J(z.count-1).id);d=this.HG.Pc(z.J(0),0);this.Da.setSelection(d)}}else{O=0;1<d.length&&k.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");n=a.start;z=n.node;for(var Da=0;Da<z.ja.length&&n.contextId===
Kb.a.Lc;Da++)if(ca=z.ja.J(Da),ca.cp===n.cpBegin&&ca.blob){O++;for(Da+=1;Da<z.ja.length;Da++)if(ca=z.ja.J(Da),ca.cp>n.cpBegin&&ca.cp<=n.cpEnd)if(ca.blob)O++;else break;else if(ca.cp>n.cpEnd)break;break}if(0<O&&O+n.cpBegin<n.cpEnd)z=fe.a.createTextRange(n.node,n.cpBegin,n.cpBegin+O),n=fe.a.createTextRange(n.node,n.cpBegin+O,n.cpEnd),this.tu.replaceTextRange(n,d[0]),this.tu.replaceTextRange(z,"");else if(0<O&&O+n.cpBegin===n.cpEnd)for(this.tu.replaceTextRange(a.start,d[0]),d=0;d<z.ja.length;d++){if(O=
z.ja.J(d),O.cp===n.cpBegin){O.blob=null;break}}else this.Xmg&&l.AFrameworkApplication.Ifa?(d=d.join(" "),this.tu.replaceTextRange(a.start,d)):this.tu.replaceTextRange(a.start,d[0])}this.Rje(a,Xa);let zb;this.wYm((zb=new db.a,zb.add(a),zb));return!0}return!1}Rje(a,d){const n=this.tu.Bye(a.start.node,0<=a.start.cpBegin?a.start.cpBegin:0);if(!n)k.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control");else if(uf.a.instance.J(10)){const z=this.$g.Fu(a.objectId);if(d){d=
this.nk.rz(a.start.node);let O=d.Mf(Ui.QQm);O||(O=d.dma(Ui.PQm));O&&(this.Wd.mya(n.formatting),this.Wd.Ltb(n.formatting,O));z&&(a.jV=!0)}else z&&a.jV&&(this.Hbn(a,n),a.jV=!1)}}Hbn(a,d){a=this.$g.Fu(a.objectId);let n=null;a&&(n=a.fa(Qb.a.s5b,E.a.nil));this.Wd.mya(d.formatting);n&&!n.equals(E.a.nil)&&(a=this.aj.value.Ta(n),d.formatting=a)}Uvd(a){let d=!1;a=a.aRe;this.Pfm(a)&&(a=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,d=!0);return{returnValue:a,rsn:d}}k5m(a,d=!0){this.eqa&&(d&&this.g5m(a),
this.o5m(a))}l5m(a){if(this.eqa&&(a=this.PX(a,a,4)))for(let d of a)this.tXa(d,!1)}YDm(a,d){if(d&&!a.Db&&(this.$g.RDc(),(a=a.Wa.paragraph.Ib.Ta(a.nd))&&a.anchor)){this.$g.xfi(a);a=this.B9.J5b(a,this.Xy,this.aj,this.$g,this.tu,this,this.fFa,this.eqa,this.V1b);let n;this.Kij((n=new db.a,n.add(a),n))}}jaj(a,d){this.$g.RDc();a=this.$g.Fu(d.nd);const n=this.t7(a);if(n&&n.Yb()&&n.removeWhenEdited){const z=this.Nb.Wb(7);z.Sa(a);this.tXa(n,!1);d.state=2;z.dispose()}}Raj(a,d){this.$g.RDc();a=this.$g.Fu(d.nd);
this.q9l(a)&&(a=a.fa(Qb.a.IB,0),this.ga&&(this.ga.ob(Mb.a.qZe,2,a),Ui.hd.NDf()))}q9l(a){return a&&a.isConnected&&!a.fa(Qb.a.V6,!1)?this.n9l(a):!1}n9l(a){a=this.B9.J5b(a,this.Xy,this.aj,this.$g,this.tu,this,this.fFa,this.eqa,this.V1b);if(!a.Yb())return!1;if(a.Te){if(a.fi.toString()===a.vj.toString()){var d=this.$g.Fu(a.fi);if(!d)return k.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),!1;if(12===d.type&&1===d.ja.length)return this.kQi(d.ja.J(0),a.objectId)}}else{d=
a.start;if(!d)return k.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),!1;if(d.cpBegin===d.cpEnd)return d=this.$g.Fu(a.fi).ja.Yg(d.cpBegin),this.kQi(d,a.objectId)}return!1}kQi(a,d){a=a?a.Qa:null;if(!a)return!1;const n=a.PP(d,!0);return-1<n&&n+1<a.length&&a.J(n+1).nd.toString()===d.toString()}u2m(a){this.Rrf.push(a)}FEj(a,d){if(void 0===a||null===a||a.contextId!==Kb.a.Lc)return null;a=fe.a.Kb(a.node,d?a.cpBegin:a.cpEnd);return 0<a.cpBegin&&a.cpBegin<
Bd.ParagraphReader.textLength(a.node)?this.$g.n9a(a):null}select(a,d){if(a&&!a.equals(E.a.nil)){var n=this.$g.Fu(a);if(n&&55===n.type){n=this.t7(n);if(n.Te)n=this.btl(n);else{n=n.start;if(!n)return;n=this.HG.uj(n)}n&&n.length&&(this.twj(n.ra,a,d,!0,!0),this.twj(n.Fb,a,d,!1,!1),this.Da.setSelection(n))}}}Mfn(a,d){if(!Qd.SelectionEditor.Cd(a)||a.Ma!==a.Xa)return!1;const n=a.Ma;return-1===n?!1:(a=this.zk.wlb(a.node,a.cpBegin,n,!d))&&d===a.Db?(Fk.a.$Bd?(d=this.t7(a.contentControlNode),this.select(a.nd,
!d.isEditable)):this.select(a.nd,!1),!0):!1}btl(a){var d=this.$g.p4a(a.fi,!0);a=this.$g.p4a(a.vj,!1);if(!d||!a)return null;d=this.Brl(fe.a.create(d),fe.a.create(a));if(!d||!d.count)return null;a=new db.a;for(let n=0;n<d.count;n++){let z;if(12===d.J(n).type)z=n===d.count-1?fe.a.createTextRange(d.J(n),0,Bd.ParagraphReader.textLength(d.J(n))):fe.a.create(d.J(n)),this.Df&&(z.Ma=this.Df.hk(z.node,!0),z.Xa=this.Df.hk(z.node,!1));else if(15===d.J(n).type)z=ht.TableNodeContext.create(d.J(n));else continue;
a.add(z)}return new pa.Selection(a.toArray(),!0)}xjn(a){if(a&&!a.equals(E.a.nil)&&(this.$g.RDc(),(a=this.$g.Fu(a))&&55===a.type&&a.isConnected)){var d=a.fa(Qb.a.V6,!1);a.setValue(Qb.a.V6,!1);d&&this.v1m(a)}}v1m(a){var d,n;const z=Fk.a.Il?null!==(n=this.eg.Ft.get(null===(d=a.id)||void 0===d?void 0:d.toString()))&&void 0!==n?n:E.a.nil:a.fa(Qb.a.fi,E.a.nil);z.equals(E.a.nil)||(d=this.$g.zza(z,!0))&&(a=this.tu.W6f(d,a.id,!0))&&0<a.count&&(a=a.J(0),d=a.Wa,d.formatting=a.FN?a.FN.Xc(d):new qy.a(d,E.a.nil))}nmj(a){if(a=
this.Avi(a))for(let d of a)d.jV=!1,this.tXa(d,!1)}xvi(a){const d=new db.a;if(a=this.Avi(a))for(let n of a)d.add(n.contentControlNode);return d}m5m(a){if(a&&(11===a.type||14===a.type||15===a.type||16===a.type)){var d=this.Ha.Im(a),n=this.Ha.OL(a);if(this.Df&&d&&n){a=this.Df.hk(d,!0);const z=this.Df.hk(n,!1);d=fe.a.create(d);n=fe.a.create(n);d.Ma=a;n.Xa=z;if(a=this.u4a(d,n,4))for(let O of a)this.tXa(O,!1)}}}Erl(a){var d,n,z,O;const ca=Fk.a.Il?null!==(n=this.eg.Ft.get(null===(d=a.id)||void 0===d?void 0:
d.toString()))&&void 0!==n?n:E.a.nil:a.fa(Qb.a.fi,E.a.nil);d=Fk.a.Il?null!==(O=this.eg.Bu.get(null===(z=a.id)||void 0===z?void 0:z.toString()))&&void 0!==O?O:E.a.nil:a.fa(Qb.a.vj,E.a.nil);if(ca.equals(E.a.nil)||d.equals(E.a.nil))return new db.a;a=this.$g.zza(ca,!0);z=this.$g.zza(d,!1);return!this.p9l||a&&z?this.P_(fe.a.create(a),fe.a.create(z))||new db.a:new db.a}p4a(a,d){return this.$g.p4a(a,d)}Iud(a,d){if(a&&55===a.type&&(a=this.t7(a),a=d?a.start:a.end)){const n=fe.a.Kb(a.node,d?a.Gm:a.$w);n.Ma=
n.Xa=(d?a.Ma:a.Xa)+(d?-1:1);return n}return null}twj(a,d,n,z,O){if((a.contextId===Kb.a.Lc||a.contextId===Kb.a.Ub||a.contextId===Kb.a.paragraph)&&(O=a.node.ja.Yg(O?a.Gm:a.$w))&&O.Qa)for(let ca=0;ca<O.Qa.length;ca++){const Da=O.Qa.J(ca);if(Da.nd.equals(d)&&Da.mo)if(z&&Da.Db){a.Ma=n?ca:ca+1;break}else if(!z&&!Da.Db){a.Xa=n?ca+1:ca;break}}}wYm(a){for(let d=0;d<this.JKh.length;++d)(0,this.JKh[d])(this,new Gd(a))}Kij(a){for(let d=0;d<this.Rrf.length;++d)(0,this.Rrf[d])(this,new Gd(a))}o5m(a){a=fe.a.create(a);
if(a=this.PX(a,a,4))for(let d of a)d.Te||this.tXa(d,!1)}g5m(a){if(a=a.plb())for(let n=0;n<a.count;n++){var d=this.$g.Fu(a.J(0));d=this.B9.J5b(d,this.Xy,this.aj,this.$g,this.tu,this,this.fFa,this.eqa,this.V1b);this.tXa(d)}}Drl(a){return this.P_(a,null)}bCd(a,d,n=null){let z=!0;try{if(!a)return k.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),!1;k.ULS.sendTraceTag(529106508,368,50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",d,a.isSupported,a.KAa));
if(this.UOa&&uf.a.instance.J(3)&&this.UOa.s0(this.Xy.value))return k.ULS.sendTraceTag(529106509,368,50,"Content Control Change Invalid because track changes is enabled"),!1;if(this.idm(d)&&!this.r9l(a))return!1;if(!n){const Da=this.HJl(a);Da&&(n=new db.a,n.add(Da))}var O=this.$g.oBi(a.start.node);const ca=this.$g.oBi(a.end.node);if(O&&ca&&!O.equals(ca)||!O&&ca||O&&!ca)return!1;O=!0;if(n&&0<n.count){if(!n.J(0).isSupported)return!1;O=n.J(0).isEditable}switch(d){case 0:z=this.X7l(a,O);break;case 1:z=
(this.mY||!this.lpg(a))&&a.isSupported&&a.isEditable&&this.KZh(a)&&this.mQi(a);this.Xmg&&l.AFrameworkApplication.Ifa||(z=z&&!this.wJi(a.start,a.end));break;case 2:const Da=a.Lgm?!0:a.isSupported;z=(this.mY||!this.lpg(a))&&Da&&a.KAa&&O;k.ULS.sendTraceTag(529106510,368,50,"True");break;case 3:z=a.isSupported&&a.KAa&&O&&this.KZh(a)&&this.mQi(a)&&!this.wJi(a.start,a.end)}}catch(ca){k.ULS.sendTraceTag(17413646,368,15,"Exception was caught in IsContentControlValid. OperationType: "+d+", Exception: "+ca),
z=!1}return z}idm(a){return!(this.i0&&(!a||2===a||3===a))}X7l(a,d){let n=!0;if(!this.mY&&this.lpg(a))n=!1;else if(this.i0)this.i0?a.Te||Qd.SelectionEditor.Tl(a.start)||a.start.contextId===Kb.a.endOfParagraph?a.Te&&(a.start.contextId!==Kb.a.paragraph&&a.start.contextId!==Kb.a.endOfParagraph||a.end.contextId!==Kb.a.paragraph&&a.end.contextId!==Kb.a.endOfParagraph)&&(n=!1):n=!1:n=d?this.v8l(a):!1;else if(!(a.Te||-1!==a.start.cpBegin&&-1!==a.end.cpEnd&&a.start.equals(a.end)))n=!1;else if(a.Te&&(a.start.contextId!==
Kb.a.paragraph||a.end.contextId!==Kb.a.paragraph||a.start.equals(a.end)&&!Bd.ParagraphReader.textLength(a.start.node)))n=!1;else if(a.start.contextId===Kb.a.Ub||a.end.contextId===Kb.a.Ub||a.start.contextId===Kb.a.endOfParagraph||a.end.contextId===Kb.a.endOfParagraph)n=!1;return n}Avi(a){if(!a||!a.length)return null;const d=a[0];a=a[a.length-1];this.Df&&(this.Ha.rh(d)&&12===d.node.type&&(d.Ma=this.Df.hk(d.node,!0)),this.Ha.rh(a)&&12===a.node.type&&(a.Xa=this.Df.hk(a.node,!1)));return this.u4a(d,a,
4)}KZh(a){a=a.a5f();for(let d of a)if(!d.isSupported||!d.KAa)return!1;return!0}r9l(a){let d;if(({x7a:n,w7a:d}=this.tLj(a.start,a.end,n,d)).returnValue)return!1;var n=this.PX(a.start,a.end,2);if(!n)return!0;for(let z of n)if(!z.objectId.equals(a.objectId)&&(z.Te&&(z.start.node.id.equals(a.start.node.id)&&(-1===a.start.cpBegin||!a.start.cpBegin)||z.end.node.id.equals(a.end.node.id)&&(-1===a.end.cpEnd||a.end.cpEnd===Bd.ParagraphReader.textLength(z.end.node)))||!z.Te&&(a.start.node.id.equals(z.start.node.id)&&
(-1!==a.start.cpBegin?z.start.cpBegin===a.start.cpBegin:!z.start.cpBegin)||a.end.node.id.equals(z.end.node.id)&&(-1!==a.end.cpEnd?z.end.cpEnd===a.end.cpEnd:z.end.cpEnd===Bd.ParagraphReader.textLength(a.end.node)))))return!1;return!0}mQi(a){if(a.Te){var d=this.$g.Fu(a.fi),n=this.$g.Fu(a.vj);let z=null;if(12===d.type&&12===n.type){d=this.$g.gHc(d);d=this.$g.Fu(d);n=this.$g.gHc(n);n=this.$g.Fu(n);if(!d||!n)return!1;16===d.type&&16===n.type&&d.id.equals(n.id)&&(z=d)}a=this.P_(a.start,a.end);if(!a.count)return!1;
for(let O of a)if(a=this.$g.gHc(O),a=this.$g.Fu(a),!a||!(16!==a.type||z&&a.id.equals(z.id)))return!1}return!0}lpg(a){return a.Te?!1:(a=a.start.node)?!a.fa(Qb.a.GHb,!0):!0}v8l(a){if(a.Te){var d=this.$g.Fu(a.fi);a=this.$g.Fu(a.vj);if(Sf.TableCellReader.Dga(d)||Sf.TableCellReader.Dga(a)||km.a.Sma(d)||km.a.Sma(a))return!1;d=this.$g.gHc(d);d=this.$g.Fu(d);a=this.$g.gHc(a);a=this.$g.Fu(a);if(!d||!a||(16===d.type||16===a.type)&&!d.id.equals(a.id))return!1}return!0}HJl(a){if(!a)return null;a=this.$g.Fu(a.objectId);
if(!a)return null;a=a.fa(Qb.a.Nqa,E.a.nil);return a.equals(E.a.nil)?null:(a=this.$g.Fu(a))?this.t7(a):null}Osi(a){return this.P_(null,a)}syn(a){return(a||"").split(RegExp("\r\n|\r|\n"))}Pfm(a){return a&&""!==a?!1:!0}Qyi(a,d,n){d=d.ja.Yg(n?0:d.characterData.length);if(!d)return k.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!d.Qa||!d.Qa.length)return 0;if(!a)return n?0:d.Qa.length;for(let z=0;z<d.Qa.length;z++){const O=d.Qa.J(z);if(E.a.Ap(O.nd,
a)&&O.Db===n)return n?z+1:z}return n?0:d.Qa.length}ZNk(a,d){var n=a.node,z=d.node,O=a.contextId===Kb.a.paragraph?0:a.cpBegin,ca=d.contextId===Kb.a.paragraph?Bd.ParagraphReader.textLength(z):d.cpEnd;n=this.zk.kba(n,O,a.Ma);z=this.zk.kba(z,ca,d.Xa);ca=!n||!n.count;O=!z||!z.count;if(ca&&O)return{returnValue:!0,start:a,end:d};if(ca)return{returnValue:this.N2e(a,z.J(z.count-1).nd,!0),start:a,end:d};if(O)return{returnValue:this.N2e(d,n.J(n.count-1).nd,!1),start:a,end:d};if(n.count===z.count)return n=n.J(n.count-
1),z=z.J(z.count-1),{returnValue:n.nd.equals(z.nd),start:a,end:d};n=(ca=n.count<z.count)?z.J(z.count-1):n.J(n.count-1);return{returnValue:ca?this.N2e(a,n.nd,!0):this.N2e(d,n.nd,!1),start:a,end:d}}N2e(a,d,n){var z=a.node;let O;if(n){O=a.contextId===Kb.a.paragraph?0:a.cpBegin;var ca=a.Ma}else O=a.contextId===Kb.a.paragraph?Bd.ParagraphReader.textLength(z):a.cpEnd,ca=a.Xa;z=z.ja.Yg(O);if(-1===ca||!z||!z.Qa||!z.Qa.length)return!1;z=z.Qa;if(n)for(n=ca;n<z.length;n++){ca=z.J(n);if(!ca.Db)break;if(ca.nd.equals(d))return a.Ma=
n+1,!0}else for(n=ca-1;0<=n;n--){ca=z.J(n);if(ca.Db)break;if(ca.nd.equals(d))return a.Xa=n,!0}return!1}L$l(a,d){return this.OEk(a,d)&&a.Ma===a.Xa&&(a.contextId===Kb.a.Ub||a.contextId===Kb.a.paragraph&&!a.node.characterData.length)}OEk(a,d){return a.equals(d)&&a.Ma===d.Ma&&a.Xa===d.Xa}DPj(a,d){var n,z,O,ca,Da,Xa;if(a&&d.Te){var zb=Fk.a.Il?null!==(z=this.eg.Ft.get(null===(n=a.id)||void 0===n?void 0:n.toString()))&&void 0!==z?z:E.a.nil:a.fa(Qb.a.fi,E.a.nil);n=this.$g.zza(d.fi,!0);zb.equals(n?n.id:null)&&
(Fk.a.Il?this.eg.Ft.set(null===(O=a.id)||void 0===O?void 0:O.toString(),d.objectId):a.setValue(Qb.a.fi,d.objectId));O=Fk.a.Il?null!==(Da=this.eg.Bu.get(null===(ca=a.id)||void 0===ca?void 0:ca.toString()))&&void 0!==Da?Da:E.a.nil:a.fa(Qb.a.vj,E.a.nil);ca=this.$g.zza(d.vj,!1);O.equals(ca?ca.id:null)&&(Fk.a.Il?this.eg.Bu.set(null===(Xa=a.id)||void 0===Xa?void 0:Xa.toString(),d.objectId):a.setValue(Qb.a.vj,d.objectId))}}static get hd(){return Ui.Eb||(Ui.Eb=la.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static Mza(a){return d=>
d.type===a}static CDl(){return a=>12===a.type||15===a.type}static V2h(a,d){return a.Yc===d.G6i||a.parentNode&&d.Edj(a.parentNode)?!1:!0}}Ui.QQm="Placeholder Text";Ui.PQm="Placeholder Text";Ui.Eb=null;Object(t.a)(Ui,"ContentControlOperator",null,[237,12,238]);class it{constructor(a,d,n){this.mc=a;this.Xy=d;this.ivc=n}zGi(a){const d=this.GDl();return d&&a&&this.XTl(d,a)?this.hTl(d):null}XTl(a,d){if(!a)return!1;do{const n=a.currentNode;if(!n)break;if(n.fa(Qb.a.dHi,null)===d)return!0}while(a.Kd(29));
return!1}hTl(a){var d=a.Va(1);a.hb();a=a.Ht(1);if(!d||!a)return null;d=ye.SelectionFactory.Ipe(d,a);a=Qd.SelectionEditor.Xf(d,!1,!1);return ye.SelectionFactory.Mx(d,a.Fb)}GDl(){const a=this.mc.Sl();a.set(this.Xy.value);this.ivc.pQ(a);return a.Va(28)&&a.Va(29)?a:null}}Object(t.a)(it,"GlossaryNavigator",null,[236]);class jt{constructor(a,d,n,z,O,ca){this.tu=a;this.$g=d;this.so=n;this.Ha=z;this.Uh=O;this.eqa=ca}ITd(a,d,n){if(!this.eqa)return 1;if(!({tableNode:O}=this.ysg(a)).returnValue||!this.Uh.WUi(O,
d)||this.lmj(a,d))return 2;var z=this.Uh.Psi(d);var O=z.J(0).plb();O&&O.count||(O=new db.a,O.add(a.objectId));a=this.$g.Ifi(z);n=n.split("\n");d=Object(qa.a)(Dd.GraphIterator,this.$g.D9f(d));d=this.$g.RUh(d,a,n.length);for(a=0;a<d.count;++a){z=d.J(a);this.tu.replaceTextRange(fe.a.createTextRange(z,0,0),n[a]);for(let ca=0;ca<O.count;++ca)this.tu.qGa(z,O.J(ca),0,!0,!0),this.tu.qGa(z,O.J(O.count-ca-1),z.characterData.length,!0,!1)}return 0}lmj(a,d){if(!this.eqa)return 1;let n;if(!({tableNode:n}=this.ysg(a)).returnValue||
!this.Uh.WUi(n,d))return 2;d=this.Uh.Psi(d);if(0<d.count&&(d=this.so.PX(fe.a.create(d.J(0)),fe.a.create(d.J(d.count-1)),2)))for(let z of d)if(z.id!==a.id&&!this.so.tXa(z,!0))return 2;return 0}fLc(a){if(!this.eqa||!({tableNode:n}=this.ysg(a)).returnValue)return!1;a=a.a5f();for(var d of a)if(!d.KAa||!d.isSupported)return!1;if(this.Uh.j9l(n))return!1;var n=Object(qa.a)(Dd.GraphIterator,this.$g.D9f(n));d=new db.a;this.Ha.emb(n,!0,!1,d);for(let z of d)if(0<z.fa(Qb.a.f4a,0)||this.Ha.V4a(z).Tx)return!1;
return!0}ysg(a){let d=null;return a&&a.fi.toString()===a.vj.toString()&&a.Yb()&&a.isEditable&&a.isSupported?(d=this.$g.Fu(a.fi))&&14===d.type?{returnValue:!0,tableNode:d}:{returnValue:!1,tableNode:null}:{returnValue:!1,tableNode:d}}}Object(t.a)(jt,"TableContentControlEditor",null,[235]);class Rq{j9l(a){let d=!1;const n=new Dd.GraphIterator;n.set(a);Uf.forEachCellInTable(n,z=>{if(!Sf.TableCellReader.we(z)){let O=Ll.OutlineNavigator.M4(z);for(;O;){if(Ia.OutlineElementReader.syd(z))return d=!0,!1;O=
z.jh(1)}}return!0});return d}WUi(a,d){const n=new Dd.GraphIterator;n.set(d);return Sf.TableCellReader.Dga(d)&&n.La(14)&&n.tc(14).id===a.id?!0:!1}Psi(a){const d=new db.a,n=new Dd.GraphIterator;n.set(a);a=new db.a;Bd.ParagraphReader.emb(n,!0,!1,a);for(let z of a)d.add(z);return d}}Object(t.a)(Rq,"TableReader",null,[234]);class qp{constructor(){this.so=null}get name(){return"WordEditor.ContentControl"}init(){l.AFrameworkApplication.K.ea("WordEditorContentControlWriteIsEnabled")&&(Yg.a.uKa(Object(m.a)(la.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator"),
la.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator").YDm,"onContentControlRangeChanged")),this.so=la.a.instance.sa("WordEditor.ContentControl.IContentControlOperator"))}dispose(){this.so&&(this.so.dispose(),this.so=null)}Hb(a){a.ha("WordEditor.ContentControl.ContentControlFactory",()=>new xo(la.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlFactory").singleInstance();a.ha("WordEditor.ContentControlNodeFactory",()=>new te(la.a.instance.Ca("Box4.ContentControlConfigSettings"),
la.a.instance.Ca("Box4.ContentControl.IContentControlOperator"))).singleInstance();a.ha("WordEditor.ContentControl.ContentControlGraphManager",()=>new $o(new Nf.a(()=>Lb.App.oa.za.jc),new Nf.a(()=>Lb.App.oa.za.jc.kd),new so.a,jm.PageNavigator.instance,la.a.instance.resolve("WordEditor.ContentControlNodeFactory"),la.a.instance.resolve("Box4.IOutlineEditor"),la.a.instance.resolve("Box4.IOutlineElementEditor"),la.a.instance.resolve("Box4.IParagraphReader"),la.a.instance.resolve("WordEditor.IParagraphSplitHelper"),
la.a.instance.Ca("Box4.ContentControlConfigSettings"),la.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlGraphManager").singleInstance();a.ha("WordEditor.ContentControl.GlossaryNavigator",()=>new it(new so.a,new Nf.a(()=>Lb.App.oa.za.jc),jm.PageNavigator.instance)).as("WordEditor.ContentControl.IGlossaryNavigator").singleInstance();a.ha("WordEditor.ContentControl.ContentControlOperator",()=>new Ui(new Nf.a(()=>Lb.App.oa.za.jc),new Nf.a(()=>
Lb.App.oa.za.jc.kd),la.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),la.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),la.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Lg.a.instance,la.a.instance.resolve("Box4.ISelectionFactory"),mi.PageReader.instance,la.a.instance.resolve("Box4.IFormattingEditor"),la.a.instance.resolve("Box4.Styles.IWACStyleReader"),l.AFrameworkApplication.K.ea("WordEditorContentControlWriteIsEnabled"),
la.a.instance.sa("Box4.IContentControlDataChangedManager"),l.AFrameworkApplication.pa,la.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),l.AFrameworkApplication.K.ea("WordEditorContentControlCustomizedPlaceholderIsEnabled"),la.a.instance.resolve("Box4.IContentControlChpHelper"),la.a.instance.Ca("Box4.ContentControlConfigSettings"),la.a.instance.sa("Box4.IContentControlReader"),la.a.instance.resolve("Box4.IParagraphReader"),la.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),
la.a.instance.Ca("Box4.Actors.IVirtualSelectionMerger"),la.a.instance.resolve("Box4.IFeatureHelper"),la.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.ContentControl.IContentControlOperator").as("WordEditor.ContentControl.IContentControlOperator").singleInstance();a.ha("WordEditor.ContentControl.ContentControlManager",()=>new Zm(new Nf.a(()=>Lb.App.oa.za.jc),new Nf.a(()=>Lb.App.oa.za.jc.kd),la.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),la.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),
la.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),la.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),la.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),la.a.instance.Ca("Box4.ContentControlConfigSettings"),la.a.instance.resolve("Box4.IContentControlChpHelper"))).as("WordEditor.ContentControl.IContentControlManager").singleInstance();a.ha("WordEditor.ContentControl.ContentControlChpManager",()=>new vg(la.a.instance.resolve("Box4.ICharacterPropertiesEditor"),
la.a.instance.Ca("Box4.ContentControlConfigSettings"),la.a.instance.resolve("Box4.IParagraphReader"),la.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlChpManager").singleInstance();a.ha("WordEditor.ContentControl.TableContentControlEditor",()=>new jt(la.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),la.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),la.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),
la.a.instance.resolve("Box4.IParagraphReader"),new Rq,l.AFrameworkApplication.K.ea("WordEditorContentControlWriteIsEnabled"))).as("WordEditor.ContentControl.ITableContentControlEditor").singleInstance();l.AFrameworkApplication.K.ea("WordEditorContentControlInlineBlockConversionIsEnabled")&&a.ha("Box4.ContentControlConverter",()=>new ln(a.resolve("Box4.IParagraphReader"),a.resolve("Box4.IContentControlChpHelper"),a.resolve("Box4.IContentControlReader"),a.resolve("Box4.IFeatureHelper"),a.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.IContentControlConverter").singleInstance()}static main(){M.a.instance.Sb(new qp)}}
Object(t.a)(qp,"ContentControlPackage",null,[1,2]);var rp=b(1311);class Uw extends Sys.EventArgs{constructor(a){super();this.definition=a}}Object(t.a)(Uw,"MenuDidCloseEventArgs",Sys.EventArgs,[]);class kt extends Sys.EventArgs{constructor(a){super();this.definition=a}}Object(t.a)(kt,"MenuDidOpenEventArgs",Sys.EventArgs,[]);var Bn=b(1438);class cB{constructor(a,d,n,z,O,ca,Da=!1,Xa=null,zb=null,Vb=null,Fc=!1,Yc=null,yd=!1,je=!0,Le=null,Ve=!1){this.target=this.container=this.menu=null;this.isDismissed=
!1;this.KNe=this.DJd=this.ymi=this.onScroll=this.onResize=this.Zga=this.OJa=this.cCa=this.documentElement=this.SCa=this.editingElement=null;this.isFocused=!1;this.qre=null;this.vMg=this.eog=!1;this.O3e=null;this.tRe=0;this.paragraphNode=a;this.cpBegin=d;this.cpEnd=n;this.definition=z;this.Ysk=O;this.q6a=ca;this.XDb=Da;this.YBj=Xa;this.Zya=zb;this.hostServices=Vb;this.wun=Fc;this.Ccj=Yc;this.kCj=yd;this.Pal=je;this.ymi=Le;this.showDictationCommandUx=Ve}}Object(t.a)(cB,"UxManagerState",null,[]);class Tn{constructor(a,
d,n,z,O,ca,Da,Xa,zb,Vb){this.ib=a;this.Da=d;this.vC=n;this.ic=z;this.Cc=O;this.fb=ca;this.vh=Da;this.mk=Xa;this.cP=zb;this.Mqc=Vb;this.Ruf=!1;this._state=null;this.shouldIgnoreFocusEvent=Fc=>{var Yc;return this.ic.sc.Kq&&!this.ic.sc.fQ&&Fc===(null===(Yc=this.ic.editingView)||void 0===Yc?void 0:Yc.editingElement)};this.ka=new oc.a;this.ucd=new yb.a;this.yCf((Fc,Yc)=>{Tn.Bom(n,Yc.definition)});this.VVh((Fc,Yc)=>{Tn.Aom(n,Yc.definition)});this.ib.Kc(Tn.Que).uK=!0}yCf(a){this.ka.addHandler(Tn.Rzg,a)}uoj(a){this.ka.removeHandler(Tn.Rzg,
a)}MYm(a){this.ka.raiseEvent(Tn.Rzg,new kt(a))}VVh(a){this.ka.addHandler(Tn.Qzg,a)}M7m(a){this.ka.removeHandler(Tn.Qzg,a)}LYm(a){this.ka.raiseEvent(Tn.Qzg,new Uw(a))}DPn(a){if(!a.isDismissed&&a.SCa){var d=Bn.c(a.paragraphNode,a.cpBegin,a.cpEnd);if(d&&d.length){d=Bn.b(d);var n=Ye.a.getElementBounds(a.SCa);d.width||d.height?d.x+d.width<n.x||d.x>n.x+n.width||d.y+d.height<n.y||d.y>n.y+n.height?this.dismiss():(n=a.target,n.style.left=d.x+"px",n.style.top=d.y+"px",n.style.width=d.width+"px",n.style.height=
d.height+"px",a.menu.updatePosition()):(k.ULS.sendTraceTag(50968328,341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else k.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}Bij(a){a.isDismissed||a.O3e||(a.O3e=new bf.a(2,1,1,()=>{a.O3e=null;this.DPn(a)},147),this.fb.rb(a.O3e))}cCa(a,d){!a.isDismissed&&a.Pal&&0<d.Iw.length&&(this.dismiss(),k.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}sBk(a){return!!a&&
a.id===Tn.atk}OJa(a,d){if(a.isDismissed||!d||!d.Ua)return!1;d=d.Ua;const n=d.keyCode,z=!a.isFocused&&!!a.menu,O=d.altKey||d.ctrlKey||d.shiftKey;let ca=!1;n===xb.a.G5?(this.dismiss(),k.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),ca=!0):n!==xb.a.Ms&&n!==xb.a.Nw||!z||O||!this.sBk(a.definition)?n!==xb.a.Uvb&&n!==xb.a.dpc||!z||O||(this.KPg(a),a.menu?(a.menu.focus(),ca=!0,k.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):k.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):
(a.menu.executeDefaultAction(),k.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),ca=!0);ca&&(d.preventDefault(),d.stopPropagation());return ca}DJd(a,d){if(a.isDismissed)return!1;a.menu.invokeBadgeId(d);k.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}KNe(a,d){if(a.isDismissed)return!1;a.menu.executeActionFromString(d);k.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}Zga(a,
d){if(a.isDismissed||!d||!d.Ua)return!1;const n=a.target;a=a.menu.getElementBounds();var z=d.Ua;d=z.clientX;z=z.clientY;n&&Tn.Sej(d,z,Ye.a.getElementBounds(n),16)||a&&Tn.Sej(d,z,Tn.WHk(a),4)||this.dismiss();return!1}dqn(a){var d=Bn.c(a.paragraphNode,a.cpBegin,a.cpEnd);if(!d||!d.length)return!1;d=Bn.a(d,"OfficeContextualTarget");if(!d)return!1;a.container=Tn.Vmd();a.target=d;a.editingElement=this.ic.editingView.editingElement;a.SCa=this.ic.sc.container;a.documentElement=document.documentElement;a.cCa=
(n,z)=>{this.cCa(a,z)};a.OJa=n=>this.OJa(a,n);a.Zga=n=>this.Zga(a,n);a.onScroll=()=>{this.Bij(a)};a.onResize=()=>{this.Bij(a)};a.showDictationCommandUx&&(a.DJd=n=>this.DJd(a,n),a.KNe=n=>this.KNe(a,n),this.Mqc&&this.Mqc.execute(n=>{n.Nmn(a.DJd)}));document.body.appendChild(a.container);document.body.appendChild(a.target);this.Da.dE(a.cCa);this.vh.sU(a.onResize);this.Cc.Ea(vb.a.UJ,a.editingElement,a.OJa);a.XDb&&this.mk.Ea(vb.a.dO,a.documentElement,a.Zga);Qc.a.addHandler(a.SCa,"scroll",a.onScroll);a.q6a||
this.KPg(a);return!0}H$b(a){const d=!!a.menu;this.LYm(a.definition);a.container&&document.body.removeChild(a.container);a.target&&document.body.removeChild(a.target);a.isFocused&&this.ib.Zd.name===Tn.Que&&this.ib.QI(Tn.Que);a.cCa&&this.Da.Vna(a.cCa);a.OJa&&a.editingElement&&this.Cc.kb(vb.a.UJ,a.editingElement,a.OJa);a.showDictationCommandUx&&this.Mqc&&this.Mqc.execute(n=>{n.Kan();n.zxj(!1)});a.Zga&&a.documentElement&&a.XDb&&this.mk.kb(vb.a.dO,a.documentElement,a.Zga);a.onScroll&&a.SCa&&Qc.a.removeHandler(a.SCa,
"scroll",a.onScroll);a.onResize&&this.vh.c5(a.onResize);a.menu=null;a.container=null;a.target=null;a.isDismissed=!0;a.editingElement=null;a.documentElement=null;a.SCa=null;a.cCa=null;a.OJa=null;a.Zga=null;a.onScroll=null;a.onResize=null;a.DJd=null;a.KNe=null;d&&a.Zya&&(a.eog?a.vMg=!0:a.Zya(a.qre))}Gmb(a,d){var n;if(!d)return!1;switch(d.actionType){case hp.b.Toggle:if(d.objectFulfillment===Tn.KEn)return this.Ruf=!this.Ruf,this.Zdh(),!0;if(d.objectFulfillment===Tn.NEn)return{value:a}=this.ucd.Ab(d.suggestionGroup.type,
!1),this.ucd.$(d.suggestionGroup.type,!a),!0;break;case hp.b.GiveFeedback:if((null===(n=d.suggestionGroup)||void 0===n?void 0:n.type)!==rp.a.bgi)return this.focus(),this.Zdh(),!0}a.eog=!0;d=a.Ysk.executeAction(d,a.paragraphNode,a.cpBegin,a.cpEnd);a.eog=!1;a.vMg&&(a.vMg=!1,a.Zya(a.qre),a.qre=null);return d}Tsn(a,d){return!(0<=a.positionInSet&&0<a.setSize)&&!d}dMj(a){var d;if(this.dqn(a)){var n=1;l.AFrameworkApplication.K.ea("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&(n=3);var z=!1;0<(null===
(d=a.definition.suggestionGroups)||void 0===d?void 0:d.length)&&(z=a.definition.suggestionGroups[0].type,z=this.ucd.Na(z)?this.ucd.J(z):a.wun);d=!1;l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",!1)&&(d=!0);const O=l.AFrameworkApplication.pa;n={containerElement:a.container,targetElement:a.target,definition:a.definition,onAction:ca=>this.Gmb(a,ca),onDismiss:()=>{this.H$b(a)},openCustomDictionaryDialog:()=>O.processAction(Dc.a.TTf,
2),keepCurrentFocus:a.q6a,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.Ruf,showDescription:z,showEditorButton:a.kCj,showEditorBranding:this.Tsn(a.definition,a.kCj),hostServices:a.hostServices,maxSuggestionGroupNumber:n,renderFooterIcons:d,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:a.ymi,showDictationCommandUx:a.showDictationCommandUx,editingElement:a.editingElement};a.Ccj&&a.Ccj(n);this.vC.createContextualUi(n).then(ca=>{this.MYm(a.definition);
a.menu=ca;a.YBj&&a.YBj();a.showDictationCommandUx&&this.Mqc&&this.Mqc.execute(Da=>Da.zxj(!0))}).catch(ca=>{this.H$b(a);k.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",ca)});0<a.tRe&&k.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",a.tRe)}else 5<++a.tRe?(k.ULS.sendTraceTag(50968330,341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),this.dismiss()):this.fb.rb(new bf.a(2,1,Math.pow(3,a.tRe),()=>{a.isDismissed||this.dMj(a)},
146))}get S7(){return!!this._state&&!this._state.isDismissed}EUi(a){let d=!1;({value:d}=this.ucd.Ab(a,!1));return d}qdh(a,d){this.S7&&(this._state.cpBegin=a,this._state.cpEnd=d)}get definition(){return this.S7?this._state.definition:null}set definition(a){this.S7&&(this._state.definition=a,this._state.menu&&this._state.menu.setDefinition(a))}focus(){this.S7&&this._state.menu&&(this._state.isFocused||this.KPg(this._state),this._state.menu.focus())}Zdh(){this.S7&&this._state.menu&&this._state.menu.updatePosition()}KPg(a){this.ib.bG(Tn.Que,
!1);a.isFocused=!0}Ytb(a,d,n,z,O,ca=null,Da=null,Xa=null,zb=!1,Vb=null,Fc=!1,Yc=!0,yd=null,je=!1){if(!d||this._state&&!this._state.isDismissed)return!1;let Le,Ve,gg;if(!({paragraphNode:gg,start:Le,end:Ve}=Tn.cHn(a,gg,Le,Ve)).returnValue)return!1;this._state=new cB(gg,Le,Ve,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je);this.dMj(this._state);return!0}mXe(){this._state&&(this._state.qre=!0)}dismiss(){var a;this._state&&(this._state.isDismissed=!0,null===(a=this._state.menu)||void 0===a?void 0:a.dismiss())}static Bom(a,
d){a.logAction({actionType:hp.b.SessionStart,engagement:hp.a.Try,objectName:Tn.jIj,objectId:d.id});if(d.suggestionGroups)for(let n of d.suggestionGroups)a.logAction({actionType:hp.b.Presented,engagement:hp.a.See,objectName:n.type,objectId:n.id})}static Aom(a,d){a.logAction({actionType:hp.b.SessionEnd,engagement:hp.a.None,objectName:Tn.jIj,objectId:d.id})}static Vmd(){const a=document.createElement("div");a.id="OfficeContextualContainer";return a}static WHk(a){return new Sys.UI.Bounds(a.left,a.top,
a.width,a.height)}static Sej(a,d,n,z){const O=n.y-z,ca=n.x+n.width+z,Da=n.y+n.height+z;return n.x-z<=a&&a<=ca&&O<=d&&d<=Da}static cHn(a,d,n,z){if(!a||!Bd.ParagraphReader.nb(a.node)||a.contextId!==Kb.a.Ub&&a.contextId!==Kb.a.Lc&&a.contextId!==Kb.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};d=a.node;a.contextId!==Kb.a.paragraph?(n=a.cpBegin,z=a.cpEnd):(n=0,z=d.characterData.length);return{returnValue:!0,paragraphNode:d,start:n,end:z}}SGd(){this.cP&&this.cP.execute(a=>{a.logActivity("WordWebEditorSeen",
null)})}}Tn.atk="ActionSet";Tn.jIj="IntentGroup";Tn.Que="CanvasContextualUxReact";Tn.KEn="Context";Tn.NEn="Description";Tn.Rzg="MenuDidOpen";Tn.Qzg="MenuDidClose";Object(t.a)(Tn,"UxManager",null,[]);class Px{constructor(){this.Z=null}get name(){return"WordEditor.CanvasContextualProvider"}Hb(a){this.Z=a}init(){this.Z.resolve("Box4.IFeatureHelper").tk.continueWith(()=>{this.Po()})}Po(){l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");const a=l.AFrameworkApplication.K.ea("EditorGoalsEnabled");
(this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(105)||l.AFrameworkApplication.K.ea("WordEditorIdeasCardsIsEnabled")||l.AFrameworkApplication.K.ea("RewriteIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&(l.AFrameworkApplication.K.ea("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.Z.resolve("Common.IDynamicScriptLoaderProvider").uG.loadScript("canvasContextual")).then(()=>{this.Z.ha("CanvasContextual.ICanvasContextualController",
()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:l.AFrameworkApplication.uiCulture,dataCulture:l.AFrameworkApplication.dataCulture,isRightToLeft:l.AFrameworkApplication.isRtl,ulsLogger:new No.a})).singleInstance();this.Z.ha("WordEditor.CanvasContextualProvider.UxManager",()=>new Tn(ic.FocusManager.instance(),this.Z.resolve("Box4.ISelectionManager"),this.Z.resolve("CanvasContextual.ICanvasContextualController"),Ic.InteractiveViewManager.instance,gb.KeyInputManager.instance,
l.AFrameworkApplication.tb,l.AFrameworkApplication.la,l.AFrameworkApplication.la.dZ,this.Z.Ca("Common.ISystemInitiatedFeedback"),this.Z.Ca("WordEditor.DictationCommands.CorrectionCommandUxStateManager"))).singleInstance();this.Z.resolve("CanvasContextual.ICanvasContextualController");this.Z.resolve("WordEditor.CanvasContextualProvider.UxManager");a&&(this.Z.ha("CanvasContextual.IEditorInitializer",()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:l.AFrameworkApplication.uiCulture,
ulsLogger:new No.a})).singleInstance(),this.Z.resolve("CanvasContextual.IEditorInitializer").init(),this.Z.ha("CanvasContextual.ISkittleControllerV2",()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new No.a})).singleInstance(),this.Z.resolve("CanvasContextual.ISkittleControllerV2"))}).catch(d=>{k.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",d)})}dispose(){}static main(){M.a.instance.Sb(new Px)}}Object(t.a)(Px,
"PackageManager",null,[1,2]);class dB{constructor(a){this.Bua=null;this.Gx=a;this.E2l();this.okf=l.AFrameworkApplication.K.ea("IsRoamingServiceEnabled");this.kVb=l.AFrameworkApplication.K.ea("IsAnonymousUser")}BAj(){return this.okf&&!this.kVb}get mRi(){return this.Bua.J("IsFirstProactiveSuggestion")}set mRi(a){this.Bua.J("IsFirstProactiveSuggestion")!==a&&this.peh("IsFirstProactiveSuggestion",a);this.Bua.$("IsFirstProactiveSuggestion",a)}get oRi(){return this.Bua.J("IsFirstUseOfFollowUp")}set oRi(a){this.Bua.J("IsFirstUseOfFollowUp")!==
a&&this.peh("IsFirstUseOfFollowUp",a);this.Bua.$("IsFirstUseOfFollowUp",a)}get nRi(){return this.Bua.J("IsFirstSuccessfulKeptFollowUpSuggestion")}set nRi(a){this.Bua.J("IsFirstSuccessfulKeptFollowUpSuggestion")!==a&&this.peh("IsFirstSuccessfulKeptFollowUpSuggestion",a);this.Bua.$("IsFirstSuccessfulKeptFollowUpSuggestion",a)}E2l(){this.Bua=new yb.a;this.Bua.$("IsFirstProactiveSuggestion",!0);this.Bua.$("IsFirstSuccessfulKeptFollowUpSuggestion",!0);this.Bua.$("IsFirstUseOfFollowUp",!0)}peh(a,d){if(this.BAj()){var n=
{};n[a]=d?"1":"0";this.Gx.setUserSettings("saveFollowUpUserSettings",n)}}vec(){this.BAj()&&this.Gx.cxd("getFollowUpUserSettings",["IsFirstProactiveSuggestion","IsFirstSuccessfulKeptFollowUpSuggestion","IsFirstUseOfFollowUp"]).continueWith(Object(m.a)(this,this.AWa,"onGetRequestFinished"),8)}AWa(a){a.Vh||(a=a.result)&&this.XLk(a)}XLk(a){if(a)for(let n in a){var d=n;let z=!1;"1"===a[n].toString()&&(z=!0);switch(d){case "IsFirstSuccessfulKeptFollowUpSuggestion":this.nRi=z;break;case "IsFirstUseOfFollowUp":this.oRi=
z;break;case "IsFirstProactiveSuggestion":this.mRi=z;break;default:k.ULS.sendTraceTag(588836865,324,15,"This setting is unknown to the client "+d)}}}getSettings(){return{shouldShow:this.Bua.J("IsFirstProactiveSuggestion")}}getTypeName(){return"FollowUpOnboardingUi"}}Object(t.a)(dB,"FollowUpUserSettings",null,[]);class eB{constructor(a,d,n,z){this.ga=a;this.Da=d;this.nL=n;this.njk=z}lb(){this.ga.ma(Dc.a.WDe,Kb.a.view,Object(m.a)(this,this.w5l,"insertIntelligentPlaceholderHandler"));this.ga.ma(Dc.a.czg,
Kb.a.view,Object(m.a)(this,this.Y2i,"markCompleteIntelligentPlaceholderHandler"));this.ga.ma(Dc.a.Z2i,Kb.a.view,Object(m.a)(this,this.Y2i,"markCompleteIntelligentPlaceholderHandler"))}w5l(a,d,n){a=null;d.view.Yd&&(a=d.view);if(!a||!a.Oa)return 8;if(!this.nL.qpg())return 2;if(1===n)return 32;this.njk.r0k();return 32}Y2i(a,d,n){let z=null;d.view.Yd&&(z=d.view);if(!z||!z.Oa)return 8;if(!this.nL.qpg())return 2;if(1===n)return 32;if(1!==this.nL.MGc(this.Da.ya,!0).count)return 2;d=new Ff.GraphTransaction(15);
try{if(d.Sa(z.xc),!this.nL.OHn(a===Dc.a.czg))return 8}finally{d&&d.dispose()}return 32}}Object(t.a)(eB,"IntelligentPlaceholderActor",null,[]);class fB{constructor(){this.jYc=new yb.a;this.g4d=new yb.a}Gtk(a,d){let n;({value:n}=this.jYc.Ab(a,n)).returnValue||this.jYc.$(a,n=new ra.a);n.add(d)}huk(a,d){this.g4d.Na(a)&&k.ULS.sendTraceTag(50954435,323,15,"Comment ID already exists for bookmark");this.g4d.$(a,d)}Etk(a,d,n){this.Gtk(a,d);this.huk(d,n)}jtl(a){let d;return({value:d}=this.jYc.Ab(a,d)).returnValue?
d:null}avl(a){let d;return({value:d}=this.g4d.Ab(a,d)).returnValue?d:null}E7m(a){let d;if(({value:d}=this.jYc.Ab(a,d)).returnValue){for(let n of d)this.g4d.remove(n);this.jYc.remove(a)}else k.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}Object(t.a)(fB,"IntelligentPlaceholderAtMentionManager",null,[246]);class qz{constructor(a,d){this.JT=this.M8c=null;this.Ha=a;this.Bxb=d}get key(){return"COMMENT"}get jz(){return WordEditorIntl.WordEditorStrings.L_Comment}get jHa(){return this.JT}reset(a){this.JT=
a.node}oZa(a){let d=null;if(this.M8c&&this.tQi(a,this.jHa,this.M8c))return d=Object.assign(new cn.a,{PK:this.key,contentObject:this.M8c}),{returnValue:!0,wL:d};this.M8c=null;const n=this.Bxb.ERf(this.jHa);if(this.Bxb.Qmg(n)){let z=n.Rc();for(;z;){if(this.tQi(a,this.jHa,z))return this.M8c=z,d=Object.assign(new cn.a,{PK:this.key,contentObject:z,description:this.wFb()}),{returnValue:!0,wL:d};z=n.yg()}}return{returnValue:!1,wL:d}}tQi(a,d,n){if(this.GBj(n))return!1;const z=this.Bxb.RGc(n,!0),O=this.Bxb.RGc(n,
!1);return z&&O&&this.Ha.TDd(d,z,O)&&(d=this.Bxb.rTa(z,n.id,!0))&&(z!==this.jHa||d.Wa.cp<=a)&&(n=this.Bxb.rTa(O,n.id,!1))&&(O!==this.jHa||n.Wa.cp>a||n.Wa.cp>=a)?!0:!1}GBj(a){return a.fa(Qb.a.uH,!1)}wFb(){return null}}Object(t.a)(qz,"CommentDetailsProvider",null,[287,288]);class Vw extends qz{constructor(a,d){super(a,d)}get key(){return"FOLLOW UP"}get jz(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}GBj(a){return!a.fa(Qb.a.uH,!1)}wFb(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}
Object(t.a)(Vw,"IntelligentPlaceholderDetailsProvider",qz,[]);var yo=b(1630),gC=b(1777),hC=b(1634);class gB{constructor(){this.Cab=""}FIa(a){this.Cab+=a}TNi(a){this.Cab+=a}pkg(a){this.Cab+=a}ENi(a){this.Cab+=a}}Object(t.a)(gB,"PlainTextFormatCreator",null,[855]);var zv=b(1418),qo;(function(a){a[a.normal=0]="normal";a[a.beingCreated=1]="beingCreated";a[a.beingEdited=2]="beingEdited"})(qo||(qo={}));Object(t.b)("CommentType",qo);var iC=b(329),jD=b(1485),Xj=b(1318);class Rt{constructor(){this.Z_c=new yb.a}contains(a){return this.Z_c.Na(Rt.Ytg(a))}add(a){this.Z_c.$(Rt.Ytg(a),
a)}remove(a){this.Z_c.remove(Rt.Ytg(a))}iJn(a){for(let d of a.Z_c)this.add(d.value)}tmi(){const a=new db.a;for(let d of this.Z_c)a.add(d.value.vi);return a}static Ytg(a){return a.vi.toString()}}Object(t.a)(Rt,"CommentRangeSet",null,[]);class ev extends Sys.EventArgs{constructor(a){super();this.commentNode=a}}Object(t.a)(ev,"OnFollowUpEventArgs",Sys.EventArgs,[]);class gw extends ev{constructor(a,d){super(a);this.OQm=d}}Object(t.a)(gw,"OnCreateEventArgs",ev,[]);class Ay extends ev{constructor(a,d){super(a);
this.wem=d}}Object(t.a)(Ay,"OnResolveEventArgs",ev,[]);var lj=b(209);class mA{}mA.G6e="MentionExperienceDegraded";Object(t.a)(mA,"AtMentionsConstants",null,[]);class kD{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb){this.sLe=a;this.qFk=d;this.kYd=n;this.Wle=z;this.Oa=O;this.rH=ca;this.pEe=Da;this.oOi=Xa;this.Au=zb;this.Xhd=Vb;this.K7a=null;(a=la.a.instance.sa("Box4.IEditStateEventManager"))&&a.addHandler(lj.a.SQa,this.Kbn.bind(this))}Mqg(){return!!this.K7a}Kbn(){this.Mqg()&&this.S4h&&(this.K7a.updateInputText(this.xug,
!1),this.S4h=!1)}hzc(a,d){this.Au.sendNotification(a,d)}Tvk(){const a=this.rH.editingView.editingElement;if(a){var d=a.getAttribute(pd.a.ezc);a.setAttribute(pd.a.ezc,d?d.toString()+" PeoplePickerAutomationID":"PeoplePickerAutomationID")}else k.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}d7m(){const a=this.rH.editingView.editingElement;if(a){var d=a.getAttribute(pd.a.ezc);d?(d=d.toString().split(" "),Array.remove(d,"PeoplePickerAutomationID"),d.length?a.setAttribute(pd.a.ezc,d.join(" ")):
a.removeAttribute(pd.a.ezc)):k.ULS.sendTraceTag(51218127,323,50,"No aria-controls when dismissing picker?")}else k.ULS.sendTraceTag(51218126,323,15,"Cannot find editing element")}ERk(){this.d7m();this.K7a&&this.K7a.updateInputText("a",!0);const a=document.getElementById("PeoplePicker");a&&document.body.removeChild(a);this.K7a=null;this.oOi.Pwj(!0)}$Im(a,d,n){k.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");a=this.pEe.Unb(a,n.displayName,n.email,n.id);this.hzc(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,
d),!0);a?k.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.Xhd.fl("LPPWordEditorKPI","FailedToInsertAtMention",{isInternal:!0},{name:mA.G6e,isInternal:!0})}fIm(a,d){k.ULS.sendTraceTag(50954434,323,50,"Permissions received for entity");d&&this.Xhd.hM(Dc.a.COk);this.pEe.MWl(a.id,d)}JEm(){this.rH.sc.Kq&&!this.rH.sc.fQ&&this.rH.editingView.EYf?this.S4h=!0:(this.sLe.reset(),k.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))}cKm(){k.ULS.sendTraceTag(41178055,
323,50,"People picker shown on canvas");this.Tvk()}eIm(a,d,n,z=new Map){z=Object.assign(new Sg.a,{extendedProperties:z});this.Xhd.fl("LPPWordEditorKPI",a,{isIntentional:d,isInternal:n,EA:z},{name:mA.G6e,Zo:"LPPFailedToInsertAtMention",isIntentional:d,isInternal:n,EA:z})}Plj(){this.sLe.Ylj(()=>{this.ERk()});this.sLe.Klj((a,d)=>{this.xug=a;if(this.K7a)this.K7a.updateInputText(this.xug,!1);else if(this.Xhd.Lq("LPPWordEditorKPI",0),this.Xhd.hM(Dc.a.VLm),(a=this.sCl(d))&&a.height){d=a.y;const n=a.height,
z=document.createElement("div");z.id="PeoplePicker";z.style.position="absolute";z.style.top=d-5+"px";z.style.left=a.x+"px";z.style.height=n+10+"px";document.body.appendChild(z);a={editingElementId:this.rH.editingView.editingElement.id,containerElement:z,automationID:"PeoplePickerAutomationID",onReplaceTextCallback:Object(m.a)(this,this.$Im,"onReplaceTextFromPicker"),onPermissionsReceivedCallback:Object(m.a)(this,this.fIm,"onPermissionsReceivedFromPicker"),onDismiss:Object(m.a)(this,this.JEm,"onDismissPicker"),
onShow:Object(m.a)(this,this.cKm,"onShowPicker"),onFailure:Object(m.a)(this,this.eIm,"onPeoplePickerServiceFailure")};this.qFk.createPeoplePicker(a).then(O=>{O.updateInputText(this.xug,!1);this.K7a=O;this.oOi.Pwj(!1)})}});this.sLe.Llj(a=>{if(this.K7a)this.K7a.onKeyDown(a.Ua.rawEvent)})}sCl(a){var d=this.Oa.ya;if(!d)return null;d=d.Ba;if(!d)return null;d=d.ra;if(!d)return null;d=d.node;if(!d)return null;d=Object(qa.a)(139,d);if(!d)return null;d=Object(qa.a)(204,d.Mh(this.rH.sc.Za));if(!d)return null;
d=Object(qa.a)(92,d);if(!d)return null;let n=null;try{n=this.kYd.oP(this.Wle.lFc(2,a),d,!1,!1,!1,!1)}catch(z){k.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",z)}return n}}Object(t.a)(kD,"WordEditorAtMentionsHandler",null,[279]);class Ar{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le,Ve){this.ga=a;this.mc=d;this.Zzb=n;this.Da=z;this.vr=O;this.hc=ca;this.lk=Da;this.H8d=Xa;this.Eb=zb;this.tf=Vb;this.X2j=Yc;this.aj=yd;this.Nb=Fc;this.z9j=
Le;this.ka=new oc.a;this.xe=je;this.Y2j=Ve;Xj.a.LCf((gg,Lh)=>{this.uH(Lh.commentNode,!0)&&this.ka.raiseEvent(Ar.MJd)})}fWh(a){this.ka.addHandler(Ar.Z8i,a)}Qyk(a){this.ka.addHandler(Ar.paj,a)}Byk(a){this.ka.addHandler(Ar.dHm,a)}LCf(a){this.ka.addHandler(Ar.MJd,a)}uH(a,d){let n=a.fa(Qb.a.uH,!1);d&&(n=n&&!a.fa(Qb.a.S6,!1));return n}uDd(a){return this.vr.uDd(a)}IHl(a){for(let d of a)for(let n of d)if(Ar.htg(n.contextId))return n.node.Ib;return null}KNl(a,d,n){const z=new Rt,O=a.Ib;for(let ca=0;ca<a.ja.length;ca++){const Da=
a.ja.J(ca);if(Da.cp>=d)break;if(Da.fd&&Da.fd.length)for(let Xa=0;Xa<Da.fd.length;Xa++){const zb=Da.fd.J(Xa);this.uH(O.Ta(zb.vi),n)&&(zb.Db?z.add(zb):z.remove(zb))}}return z}LNl(a,d,n,z){const O=new Rt,ca=a.Ib;for(let Da=0;Da<a.ja.length;Da++){const Xa=a.ja.J(Da);if(Xa.cp>n)break;if(Xa.fd&&Xa.fd.length)for(let zb=0;zb<Xa.fd.length;zb++){const Vb=Xa.fd.J(zb);this.uH(ca.Ta(Vb.vi),z)&&(Vb.Db?Xa.cp<n&&O.add(Vb):Xa.cp<=d&&O.remove(Vb))}}return O}EDi(a,d){let n;const z=a.node;a.contextId!==Kb.a.paragraph?
(n=a.cpBegin,a=a.cpEnd):(n=0,a=z.characterData.length);return n===a?this.KNl(z,n,d):this.LNl(z,n,a,d)}twd(a,d){return Ar.htg(a.contextId)?this.EDi(a,d).tmi():new db.a}MGc(a,d){const n=new Rt;for(let z of a)for(let O of z)Ar.htg(O.contextId)&&n.iJn(this.EDi(O,d));return n.tmi()}qpg(){var a=this.Da.ya;if(!a||1!==a.length||1!==a.J(0).length)return!1;a=a.J(0).ra.node;return Bd.ParagraphReader.nb(a)&&!Bd.ParagraphReader.qla(a)&&this.vr.vJc(this.ga,!0)?!0:!1}INi(a,d){if(!this.qpg())return null;if(this.vr.AYl())return k.ULS.sendTraceTag(592761861,
323,15,"Placeholder insertion failed because of draft comment"),null;let n=!1;var z=this.Da.ya.J(0).ra;z.contextId===Kb.a.Ub?(a=a?Qd.SelectionEditor.SU(z,!1):null)&&a.IA&&a.ra.contextId===Kb.a.Lc?this.Da.setSelection(a):(this.hc.replaceTextRange(z,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+" ",!0),this.Da.setSelection(ye.SelectionFactory.wX(z.node,z.cpBegin,z.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):n=!0;this.xe.B6b||
yo.a.instance.kAd();a=this.vr.mnd(this.Da.ya.Ba);if(!a)return null;var O=this.mc.Dg(a);const ca=O.Va(1);if(!ca||393229!==ca.Jb)return null;O=O.Va(2);if(!O||393230!==O.Jb)return null;this.ldh(a.Ib,a.id);this.ka.raiseEvent(Ar.Z8i,new gw(a,d));n&&(d=z.node,z=z.contextId!==Kb.a.paragraph?z.cpEnd:d.characterData.length,this.Da.setSelection(ye.SelectionFactory.wX(d,z,z)));return a}WDe(a){return!!this.INi(!0,a)}Ekg(a,d,n,z,O,ca){if(0>d)return!1;z="@"+z;const Da=z+" ",Xa=new Ff.GraphTransaction(15);try{Xa.Sa(a);
this.hc.replaceTextRange(fe.a.createTextRange(a,d,n),Da);this.Eb.Jf&&(this.tf.yMf(a,d,d+z.length),this.tf.moa(a,d+z.length,d+Da.length,1));const zb=this.lk.vP(fe.a.createTextRange(a,d,d+z.length),"mailto:"+O,!1,!0,!1);if(!zb)return!1;const Vb=zb.Xs;if(!Vb)return k.ULS.sendTraceTag(51217483,323,15,"Insertion of IntelligentPlaceholderWithMention failed"),!1;this.Da.setSelection(ye.SelectionFactory.wX(a,d,d+z.length));let Fc=this.INi(!1,2);if(!Fc)return!1;ca&&this.H8d.Etk(ca,Vb,Fc.id);this.Da.setSelection(ye.SelectionFactory.Pc(a,
d+Da.length))}finally{Xa&&Xa.dispose()}return!0}Unb(a,d,n,z){const O=this.Da.Ag;return Qd.SelectionEditor.Cd(O)?this.Ekg(O.node,O.cpBegin-a,O.cpBegin,d,n,z):!1}pKl(a){if(1===a.length&&a.J(0).IA&&(a=a.J(0).ra,a.contextId===Kb.a.Ub&&Bd.ParagraphReader.nb(a.node))){const d=a.node;for(let n=0;n<d.ja.length;n++){const z=d.ja.J(n);if(z.cp===a.cpBegin){a=z.$Fb(!0,!0);if(0<a.length)return a[0].vi;break}}}return null}F5b(a,d,n){return this.vr.Mmd(a,d,n).returnValue}Nve(a,d,n,z,O){let ca=!1;const Da=a.characterData;
if(d>=Da.length||n>Da.length||n<d)return{returnValue:!1,NHa:ca};let Xa=d,zb=null;for(let Fc=0;Fc<a.ja.length;Fc++){const Yc=a.ja.J(Fc),yd=Yc.cp;if(!(yd<d)){if(Yc.Wh&&zb)try{const je=Da.substring(Xa,yd),Le=new gC.a;Le.fullName=je.startsWith("@")?je.substr(1):je;jD.a(zb,Le);const Ve=new hC.a;jD.b(zb,Ve);O&&(Ve.contentId=this.X2j.zve());z.pkg(je,Le,Ve);ca=!0;zb=null;Xa=yd}catch(je){var Vb=Object.assign(new Sg.a,{extendedProperties:new Map});Vb.extendedProperties.set("exception",je.message);this.Y2j.fl("LPPWordEditorKPI",
"FailedToRenderAtMention",{isInternal:!0,EA:Vb},{name:mA.G6e,isInternal:!0,EA:Vb})}yd<=n&&!zb&&(Vb=Math.min(yd,n),Vb>Xa&&z.FIa(Da.substring(Xa,Vb)),Xa=yd);Yc.hyperlink&&Yc.hyperlink.Yz&&(zb=Yc.hyperlink);if(yd>=n)break}}return{returnValue:!0,NHa:ca}}Xsi(a,d,n,z,O,ca=-1){O=!1;var Da=a.Ta(d),Xa=a.Ta(Da.getValue(Qb.a.mC));Da=a.Ta(Da.getValue(Qb.a.RA));ca=0<ca?ca:Number.MAX_VALUE;a=this.F5b(Xa,d,!0);d=this.F5b(Da,d,!1);if(-1===a||-1===d)return{returnValue:!1,NHa:O};if(Xa===Da)return this.Nve(Xa,a,d,n,
z);const zb=this.Zzb.uDb(Xa,!1,!1);if(!zb)return{returnValue:!1,NHa:O};Xa=new db.a;let Vb=0;do Xa.add(zb.jE),Vb+=zb.jE.characterData.length;while(zb.jE!==Da&&zb.mIa()&&Vb<ca);for(ca=0;ca<Xa.count;ca++)if(O=Xa.J(ca),Da=O.characterData,ca)if(ca===Xa.count-1){if(!({NHa:O}=this.Nve(O,0,d,n,z)).returnValue)return{returnValue:!1,NHa:O}}else{if(!({NHa:O}=this.Nve(O,0,Da.length,n,z)).returnValue)return{returnValue:!1,NHa:O};n.FIa("\n")}else{if(!({NHa:O}=this.Nve(O,a,Da.length,n,z)).returnValue)return{returnValue:!1,
NHa:O};n.FIa("\n")}return{returnValue:!0,NHa:O}}Mve(a,d){let n;const z=new gB;return({NHa:n}=this.Xsi(a,d,z,!1,n,-1)).returnValue?z.Cab:null}wte(a,d){var n=a.Ta(d);if(!n)return null;a=a.Ta(n.getValue(Qb.a.RA));if(!a)return null;d=this.F5b(a,d,!1);if(-1===d)return null;n=a.characterData;if(d>=n.length||!w.a.Fga(n.charAt(d))){n=this.Nb.Wb(15);try{n.Sa(a),this.hc.replaceTextRange(fe.a.Kb(a,d)," ")}finally{n&&n.dispose()}}return ye.SelectionFactory.Pc(a,d+1)}ldh(a,d){const n=a.Ta(d),z=new zv.a;let O=
!1;({NHa:O}=this.Xsi(a,d,z,!0,O)).returnValue&&(z.FIa("\n"),this.vr.WNj(n,z.bpa),this.z9j&&(O?n.setValue(Qb.a.Uld,!0):n.oe(Qb.a.Uld)),this.ka.raiseEvent(Ar.kLm))}qgn(a,d){for(let n of a){if(n.contains(d))return!0;for(let z of n)for(let O of d)if(z.node===O.node&&z.Gm>=O.Gm)return!0}return!1}wfi(a,d,n,z,O){const ca=this.Da.ya.clone(),Da=new Jv.a(Lb.App.oa.za.Rb);a=ye.SelectionFactory.Pc(a,d);n=fe.a.Kb(n,z);a=ye.SelectionFactory.Mx(a,n);this.Da.setSelection(a);n=!this.qgn(ca,a);return 32===this.ga.rf(Da,
Mb.a.iK,2,!0,null,null)?(n?this.Da.lB(ca):O!==E.a.nil&&(O=this.wte(this.aj.value,O),this.Da.setSelection(O)),!0):!1}e6m(a,d){var n=a.Ta(d);const z=a.Ta(n.getValue(Qb.a.mC));a=a.Ta(n.getValue(Qb.a.RA));if(z===a){n=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;var O=z.characterData.indexOf(n);-1!==O&&this.wfi(z,O,a,O+n.length,d)}}Cfi(a,d,n){var z=a.Ta(d);if(!z)return!1;const O=a.Ta(z.getValue(Qb.a.mC));a=a.Ta(z.getValue(Qb.a.RA));z=this.F5b(O,d,!0);const ca=this.F5b(a,
d,!1);if(-1===z||-1===ca||!this.wfi(O,z,a,ca,E.a.nil))return!1;n&&this.Kfi(d);return!0}Kfi(a){this.vr.rUg(a,!0)}OHn(a){var d=this.IHl(this.Da.ya);if(!d)return!1;const n=this.MGc(this.Da.ya,!0);if(1!==n.count)return!1;const z=d.Ta(n.J(0));if(a)d=this.Cfi(d,n.J(0),!1);else{const O=z.getValue(Qb.a.mC),ca=z.getValue(Qb.a.RA);E.a.Ap(O,ca)||k.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");this.vYk(n.J(0));d.Ta(O).Fi(16,!0);d=!0}d&&(z.setValue(Qb.a.S6,
!0),this.ka.raiseEvent(Ar.paj,new Ay(z,a)));return d}x0h(a,d){a=this.MGc(this.Da.ya,!1);d.$u[Ar.Sgi]=!!a.count}$9i(a,d){if(d.$u[Ar.Sgi]&&Bd.ParagraphReader.nb(d.clone)&&(d=d.clone,a=d.Ib)&&(d=fe.a.createTextRange(d,0,d.characterData.length),d=this.twd(d,!1),d.count))for(let n of d)(d=a.Ta(n))&&d.setValue(Qb.a.uH,!1)}Ewl(a,d,n){let z;const O=({ukd:zb}=this.vr.Mmd(d,n,!0)).returnValue;n=({ukd:z}=this.vr.Mmd(d,n,!1)).returnValue;let ca=null,Da=-1,Xa=-1;for(;zb<z;zb++){let Vb=d.ja.J(zb);if(Vb.hyperlink&&
Vb.hyperlink.Yz&&Vb.hyperlink.Xs===a){ca=Vb.hyperlink;Da=Vb.cp;break}}if(!ca||Da<O)return{returnValue:!1,ibi:Da,hbi:Xa};for(a=zb;a<d.ja.length;a++){var zb=d.ja.J(a);if(zb.cp>n)break;if(zb.Wz){Xa=zb.cp;break}}return{returnValue:-1!==Xa,ibi:Da,hbi:Xa}}Q6m(a){var d=this.H8d.avl(a);if(d){var n=null;Lb.App.oa&&(n=Lb.App.oa.za.jc.kd);if(n){var z=n.Ta(d);d=n.Ta(z.getValue(Qb.a.mC));var O=n.Ta(z.getValue(Qb.a.RA));if(d!==O)k.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");
else if(({ibi:a,hbi:O}=this.Ewl(a,d,z.id)).returnValue){var ca=new Ff.GraphTransaction(7);try{ca.Sa(d);let Da=fe.a.createTextRange(d,a,O);this.hc.replaceTextRange(Da,"");this.ldh(n,z.id)}finally{ca&&ca.dispose()}this.Da.ya&&0<this.Da.ya.length?(n=this.Da.ya.J(0).ra,n.node===d?k.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",n.cpBegin,a):k.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):k.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");
this.Da.setSelection(ye.SelectionFactory.Pc(d,a))}else k.ULS.sendTraceTag(50954440,323,15,"Unable to compute hyperlink CPs for bookmark")}else k.ULS.sendTraceTag(50954438,323,15,"Unable to find object space for removing mention")}else k.ULS.sendTraceTag(50954437,323,15,"Mention bookmark has no associated comments")}MWl(a,d){if(!d){d=this.H8d.jtl(a);if(!d){k.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");return}for(let n of d)this.Q6m(n)}this.H8d.E7m(a)}trl(){yo.a.instance.kAd();
const a=new db.a;for(let n of this.vr.SDf)if(n.Dv!==qo.beingCreated){var d=E.a.qe(n.objectId);d=this.aj.value.Ta(d);this.uH(d,!0)&&a.add(d)}return a}Xfn(a){a=this.vr.Kbg(a);this.Da.setSelection(a)}vYk(a){a?this.aj.value.Ta(a).setValue(Qb.a.uH,!1):k.ULS.sendTraceTag(594043491,323,10,"The given intelligent placeholder guid is null")}static htg(a){return a===Kb.a.Lc||a===Kb.a.Ub||a===Kb.a.paragraph}}Ar.Sgi="DisableNestedIntelligentPlaceholder";Ar.Z8i="CreateIntelligentPlaceholder";Ar.paj="ResolveIntelligentPlaceholder";
Ar.kLm="UpdateIntelligentPlaceholder";Ar.MJd="DeleteIntelligentPlaceholder";Ar.dHm="MentionAddedToFollowUpEventKey";Object(t.a)(Ar,"IntelligentPlaceholderEditor",null,[247,248,249]);class lD{constructor(a,d,n,z){this.rFa=!1;this.$h=!0;this.Cc=null;this.ic=a;this.aj=d;this.Da=n;this.wea=z}hid(a,d){this.rFa||(a.IIa?(this.oCb(d),this.rFa=!0):a.mqa(()=>{this.rFa||(this.oCb(d),this.rFa=!0)}))}dispose(){this.Cc&&this.Cc.kb(vb.a.UJ,this.ic.editingView.editingElement,Object(m.a)(this,this.nCb,"beforeKeyDownHandler"))}oCb(a){this.Cc=
a;this.ic.sc.gj&&this.Cc.Ea(vb.a.UJ,this.ic.editingView.editingElement,Object(m.a)(this,this.nCb,"beforeKeyDownHandler"))}nCb(a){if(!this.$h||!this.UNk(a,this.Da.ya))return!1;a.Ua.preventDefault();a.Ua.stopPropagation();this.ic.sc&&this.ic.sc.ckb(!1);a=this.wte(this.Da.ya);if(!a)return!1;this.Da.setSelection(a);return!0}UNk(a,d){if(a.Ua.keyCode!==xb.a.Nw&&a.Ua.keyCode!==xb.a.Ms||1!==d.length||!d.J(0).IA)return!1;var n=this.wea.MGc(d,!0);if(1!==n.count)return!1;const z=d.J(0).ra.node;if(!Bd.ParagraphReader.nb(z))return!1;
a=this.wea.F5b(z,n.J(0),!0);n=this.wea.F5b(z,n.J(0),!1);return d.J(0).ra.cpBegin<a||d.J(0).ra.cpEnd>n?!1:!0}wte(a){a=this.wea.MGc(a,!0);if(1!==a.count)return null;a=a.J(0);return this.wea.wte(this.aj.value,a)}Pwj(a){this.$h=a}}Object(t.a)(lD,"IntelligentPlaceholderKeyboardListener",null,[245,12]);class mD{constructor(a,d){this.ga=a;this.DAb=d}K6l(a){1===a&&this.ga.processAction(Sa.a.newComment,2);2===a&&(this.DAb.instance?this.DAb.instance.cVc("https://go.microsoft.com/fwlink/?linkid=2154656")&&w.a.gQ("https://go.microsoft.com/fwlink/?linkid=2154656")&&
window.open("https://go.microsoft.com/fwlink/?linkid=2154656","_blank"):k.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));a=[Object.assign(new ba.a,{name:"DialogResult",int64:a})];we.d(Dc.a.fqi,void 0,void 0,void 0,void 0,void 0,a)}r0k(){const a=new $g.StandardDialog;a.wc=11;a.ee(1,WordEditorIntl.WordEditorStrings.L_TryIt);a.ee(2,WordEditorIntl.WordEditorStrings.L_LearnMore);a.iu(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,
WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,0,Object(m.a)(this,this.K6l,"intelligentPlaceholderPhaseOutHandler"));we.a("FollowUpsPhaseOutDialogShown")}}Object(t.a)(mD,"IntelligentPlaceholderPhaseOutDialogManager",null,[]);var hB=b(1281);class jC{constructor(a,d,n,z,O,ca){this.Gea=this.Sqf=null;this.Nb=a;this.nL=d;this.Da=n;this.fb=z;this.iyf=O;this.aj=ca;this.PT=new Wk.a;this.Aq=new hB.a;this.nJh=new qi.a(this.PT);this.nL.fWh((Da,Xa)=>{this.Yvk(Xa.commentNode)})}Yvk(a){a=a.id;const d=
this.eCi(this.aj.value,a);d&&this.Aq.$(a,d)}eCi(a,d){const n=a.Ta(d);return!n||this.nL.uDd(n)?null:this.nL.Mve(a,d)}AIk(a){const d=new hB.a;var n=this.nL.MGc(a,!0);if(!n)return d;a=this.aj.value;for(let z of n)(n=this.eCi(a,z))&&d.$(z,n);return d}rUg(a){if(this.Sqf){const d=this.Nb.Wb(15);try{d.Sa(this.iyf()),this.nL.Kfi(this.Sqf)}finally{d&&d.dispose()}}this.Sqf=a?this.nL.pKl(a):null}jXl(a){const d=this.aj.value;if(a=a?this.AIk(a):new hB.a){var n=new qi.a(this.PT),z=new qi.a(this.PT);jC.azl(this.Aq,
a,n,z);for(var O of n)this.Aq.$(O,a.J(O));for(let ca of z)if(n=this.Aq.J(ca),z=this.nL.Mve(d,ca),this.Aq.remove(ca),z&&(a=O=!1,ma.a.kHc().equals(z,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?(a=!0,n=!1):n=-1<z.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?O=!0:!ma.a.kHc().equals(n,z),n||O||a)){z=this.Nb.Wb(15);try{z.Sa(this.iyf()),a?this.nL.Cfi(d,ca,!0):(O&&this.nL.e6m(d,ca),n&&this.nL.ldh(d,ca))}finally{z&&z.dispose()}}}}xJl(a){const d=
new qi.a(this.PT);for(let n of a)for(let z of n)a=z.node,Bd.ParagraphReader.nb(a)&&d.add(a.id);return d}QVl(a){var d=this.aj.value;const n=a?this.xJl(a):new qi.a(this.PT);if(n){a=new db.a;for(let ca of this.nJh)if(!n.contains(ca)){var z=d.Ta(ca);if(z){z=z.ja;for(let Da=0;Da<z.length;Da++){const Xa=z.J(Da).fd;if(Xa)for(let zb=0;zb<Xa.length;zb++){var O=Xa.J(zb);O.Db&&(O=d.Ta(O.vi))&&O.fa(Qb.a.Ysg,!1)&&E.a.Ap(ca,O.getValue(Qb.a.RA))&&this.nL.uDd(O)&&a.add(O)}}}}this.nJh=n;if(a.count){d=this.Nb.Wb(7);
try{d.Sa(this.iyf());for(let ca of a)ca.oe(Qb.a.Ysg)}finally{d&&d.dispose()}}}}fCe(a){this.rUg(a);this.jXl(a);this.QVl(a)}J4h(){this.Gea&&(this.fb.ie(this.Gea),this.Gea=null)}jgc(){if(this.Gea||this.aj.zgg)this.J4h(),this.fCe(null)}Bca(){this.Gea||(this.Gea=new bf.a(3,1,0,()=>{this.Gea=null;this.fCe(this.Da.ya)},130),this.fb.rb(this.Gea))}wD(){this.Da.dE(Object(m.a)(this,this.Bca,"onSetSelectionFinished"));l.AFrameworkApplication.QH(()=>{this.jgc()})}dispose(){this.Da.Vna(Object(m.a)(this,this.Bca,
"onSetSelectionFinished"));this.J4h()}static azl(a,d,n,z){for(let O of d){let ca=O.key;a.Na(ca)||n.add(ca)}for(let O of a)a=O.key,d.Na(a)||z.add(a)}}Object(t.a)(jC,"IntelligentPlaceholderSelectionCache",null,[12]);var iB;(function(a){a[a.unknown=0]="unknown";a[a.contextMenu=1]="contextMenu";a[a.atMention=2]="atMention";a[a.l$n=3]="textGesture";a[a.paste=4]="paste";a[a.fTn=5]="workItemIntent";a[a.X_n=6]="characterTrigger"})(iB||(iB={}));Object(t.b)("IntelligentPlaceholderCreation",iB);class Av{constructor(a,
d,n,z){this.nNa=a;this.Gj=d;this.Jqc=n;this.Xy=z}VYe(a){return a&&a.Ib&&a.Ib.id.equals(this.Xy.value.kd.id)?!0:!1}eBj(a){return this.VYe(a)&&a.fa(Qb.a.uH,!1)?!0:!1}Cpm(){this.Jqc.execute(a=>{a.logAction({actionType:hp.b.SessionStart,engagement:hp.a.Offer,objectName:Av.gUc})})}qKe(a,d){let n=!1;l.AFrameworkApplication.K.ea("FixInCanvasMentionLogging")&&(n=2==d&&this.VYe(a));if(this.eBj(a)||n){var z=a.getValue(Qb.a.IF);this.Jqc.execute(O=>{O.logAction({actionType:hp.b.Created,engagement:hp.a.None,objectName:Av.gUc,
objectId:z.toString(),objectFulfillment:iB[d]})})}}Nmm(a){if(this.eBj(a)){var d=a.getValue(Qb.a.IF);this.Jqc.execute(n=>{n.logAction({actionType:hp.b.Deleted,engagement:hp.a.None,objectName:Av.gUc,objectId:d.toString()})})}}vqm(a,d){if(this.VYe(a)){var n=a.getValue(Qb.a.IF);this.Jqc.execute(z=>{z.logAction({actionType:hp.b.Resolved,engagement:hp.a.None,objectName:Av.gUc,objectId:n.toString(),objectFulfillment:d?"RemoveText":"KeepText"})})}}zrm(a){a===Dc.a.WDe&&this.Jqc.execute(d=>{d.logAction({actionType:hp.b.Deleted,
engagement:hp.a.None,objectName:Av.gUc,objectFulfillment:Av.KCn})})}zom(a){if(this.VYe(a)){var d=a.getValue(Qb.a.IF);this.Jqc.execute(n=>{n.logAction({actionType:hp.b.Modified,engagement:hp.a.None,objectName:Av.gUc,objectId:d.toString(),objectFulfillment:"MentionInserted"})})}}LGk(){this.Cpm();this.nNa.fWh((a,d)=>{this.qKe(d.commentNode,d.OQm)});this.nNa.Qyk((a,d)=>{this.vqm(d.commentNode,d.wem)});this.nNa.Byk((a,d)=>{this.zom(d.commentNode)});this.Gj.MWh((a,d)=>{this.zrm(d.actionId)});Xj.a.LCf((a,
d)=>{this.Nmm(d.commentNode)})}}Av.gUc="IntelligentPlaceholder";Av.KCn="Undo";Object(t.a)(Av,"IntelligentPlaceholderTelemetry",null,[]);class nA{constructor(){this.Lwh=this.wea=this.T9d=this.Yde=this.Z=null}get name(){return"WordEditor.IntelligentPlaceholder"}Hb(a){this.Z=a;a.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager",()=>new mD(l.AFrameworkApplication.pa,a.Ca("Common.App.SafeLinks.ISafeLinksManager"))).singleInstance();a.ha("WordEditor.IntelligentPlaceholder.FollowUpUserSettings",
()=>new dB(a.resolve("Box4.IRoamingServiceRequestManager"))).singleInstance();this.Lwh=a.resolve("WordEditor.IntelligentPlaceholder.FollowUpUserSettings");a.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new fB).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager").singleInstance();a.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",()=>new Ar(l.AFrameworkApplication.pa,new so.a,a.resolve("Box4.IParagraphIteratorFactory"),
a.resolve("Box4.ISelectionManager"),a.resolve("WordEditor.Comments.IWordEditorCommentModel"),a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.IHyperlinkEditor"),a.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.IAtMentionHyperlinkConfigurator"),new Nf.a(()=>
Lb.App.oa.za.jc.kd),a.resolve("WordEditor.Comments.CommentsSettings"),!1,this.Z.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").singleInstance();a.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor",()=>new eB(l.AFrameworkApplication.pa,a.resolve("Box4.ISelectionManager"),
a.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),a.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager"))).singleInstance();a.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache",()=>new jC(a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),a.resolve("Box4.ISelectionManager"),l.AFrameworkApplication.tb,()=>Lb.App.oa.za.Rb.xc,new Nf.a(()=>
Lb.App.oa.za.jc.kd))).singleInstance();a.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener",()=>new lD(Ic.InteractiveViewManager.instance,new Nf.a(()=>Lb.App.oa.za.jc.kd),a.resolve("Box4.ISelectionManager"),a.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener").singleInstance();a.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry",()=>new Av(a.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),
a.resolve("Box4.IUndoManager"),a.Ca("CanvasContextual.ICanvasContextualController"),new Nf.a(()=>Lb.App.oa.za.jc))).singleInstance()}init(){this.Z.resolve("Box4.IFeatureHelper").tk.continueWith(()=>{this.Po()})}Po(){const a=this.Z.resolve("Box4.IFeatureHelper");a.isFeatureEnabled(29)&&(this.Z.Ca("WordEditor.CanvasContextualProvider.UxManager").execute(d=>{this.QGg(d)}),this.Z.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor").lb(),this.Z.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry").LGk(),
this.wea=this.Z.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),$f.Gxk(Object(m.a)(this.wea,this.wea.x0h,"beforeIntelligentPlaceholderPaste")),$f.Gie(Object(m.a)(this.wea,this.wea.$9i,"onIntelligentPlaceholderPaste")),this.Yde=this.Z.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache"),a.isFeatureEnabled(156)||this.Yde.wD(),this.T9d=this.Z.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener"),this.T9d.hid(Lb.App.oa.za,
gb.KeyInputManager.instance),this.v3m(this.Z.Ca("Box4.Accessibility.IAccessibilityContextManager"),this.Z.resolve("Box4.IParagraphReader"),this.Z.resolve("WordEditor.CommentsInteractive.ICommentEditor")))}QGg(){this.Lwh.vec()}dispose(){this.Yde&&this.Yde.dispose();this.T9d&&this.T9d.dispose();this.wea&&($f.H7m(Object(m.a)(this.wea,this.wea.x0h,"beforeIntelligentPlaceholderPaste")),$f.V7m(Object(m.a)(this.wea,this.wea.$9i,"onIntelligentPlaceholderPaste")))}v3m(a,d,n){a&&a.execute(z=>{z.Pca(new Vw(d,
n))})}static main(){M.a.instance.Sb(new nA)}}Object(t.a)(nA,"PackageManager",null,[1,2]);var uE=window.FindReplaceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"NavControls",
DisplayMode:"Medium",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},children:[{name:"Row",
attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",attrs:{Id:"GroupReplaceControls",
IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},
children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",Image16by16:"IMGMAP@we@UpArrow_16x16x32",
LabelText:"STR@L_FindPrevious"}},{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},nD=b(1803),kC=b(1716),St=b(1783),oD=b(1786),Au=b(1787);class tj{}tj.nyn="Search_16x16x32";tj.fyn="ClosePaneGlyph_16x16x32";
Object(t.a)(tj,"SearchBoxIcons",null,[]);var By=b(1785);class pD{constructor(){this.kwh=null}get key(){return"FIND_HIT"}get jz(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(a){this.kwh=a.node.uba()}oZa(a){let d=null;for(let n of this.kwh)if(n.begin<=a&&a<n.end)return d=Object.assign(new cn.a,{PK:this.key,contentObject:n}),{returnValue:!0,wL:d};return{returnValue:!1,wL:d}}}Object(t.a)(pD,"FindHitDetailsProvider",null,[287,288]);var qD=b(1460),lC=b(1391),rD=b(1439);class Qx{constructor(a,
d,n,z,O,ca,Da,Xa=null,zb=null){this.an=null;this.ga=a;this.xp=d;this.ND=n;this.RZb=z;this.lCh=O;this.Ad=Da;zb&&zb(1,Object(m.a)(this,this.Xga,"onBeforeAppClose"),null);this.i0a=Xa}DV(){}lb(){this.ga.Aa(Dc.a.sQg,Kb.a.view,Object(m.a)(this,this.CXm,"queryNavigationPaneToggleButton"),96);this.ga.ma(Dc.a.$ub,Kb.a.view,Object(m.a)(this,this.$ub,"toggleNavigationPane"));this.ga.ma(Dc.a.eTc,Kb.a.view,Object(m.a)(this,this.cTc,"showFindReplacePane"));this.ga.ma(Dc.a.TNb,Kb.a.view,Object(m.a)(this,this.cTc,
"showFindReplacePane"));this.ga.ma(Mb.a.uEc,Kb.a.view,Object(m.a)(this,this.find,"find"));this.ga.ma(Sa.a.findInDocument,Kb.a.view,Object(m.a)(this,this.findInDocument,"findInDocument"));this.ga.ma(Mb.a.findOnPage,Kb.a.view,Object(m.a)(this,this.Eoi,"findSearchBoxQuery"));this.ga.Aa(Sa.a.khj,Kb.a.view,Object(m.a)(this,this.Irb,"queryFindState"),97);this.ga.ma(Mb.a.ZMc,Kb.a.view,Object(m.a)(this,this.Ukl,"findNext"));this.ga.ma(Mb.a.mPc,Kb.a.view,Object(m.a)(this,this.dll,"findPrevious"));this.ga.Aa(Mb.a.GSe,
Kb.a.view,Object(m.a)(this,this.GSe,"queryNextHit"),97);this.ga.Aa(Mb.a.USe,Kb.a.view,Object(m.a)(this,this.USe,"queryPreviousHit"),97);this.ga.ma(Dc.a.GAe,Kb.a.view,Object(m.a)(this,this.GAe,"goToFindHit"));this.ga.ma(Mb.a.bib,Kb.a.view,Object(m.a)(this,this.cancelSearch,"cancelSearch"));this.ga.ma(Sa.a.clearSearch,Kb.a.view,Object(m.a)(this,this.clearSearch,"clearSearch"));this.ga.ma(Sa.a.pMf,Kb.a.application,Object(m.a)(this,this.clearSearch,"clearSearch"));this.ga.ma(Dc.a.Skd,Kb.a.view,Object(m.a)(this,
this.Skd,"closeFindReplacePane"));this.ga.ma(Sa.a.pue,Kb.a.view,Object(m.a)(this,this.y3e,"updateFilters"));this.ga.ma(Sa.a.zue,Kb.a.view,Object(m.a)(this,this.y3e,"updateFilters"));this.ga.Aa(Sa.a.cOd,Kb.a.view,Object(m.a)(this,this.cOd,"queryFindMatchCase"),97);this.ga.Aa(Sa.a.dOd,Kb.a.view,Object(m.a)(this,this.dOd,"queryFindWholeWord"),97);this.ga.Aa(Dc.a.WPg,Kb.a.view,Object(m.a)(this,this.WPg,"queryFiltersLabel"),97);this.ga.Aa(Dc.a.VPc,Kb.a.view,Object(m.a)(this,this.VPc,"querySummaryLabel"),
97);this.ga.Aa(Dc.a.XPg,Kb.a.view,Object(m.a)(this,this.XPg,"queryFindComplete"),97);this.ga.Aa(Dc.a.$Pg,Kb.a.view,Object(m.a)(this,this.$Pg,"queryFindReplaceViewType"),97);this.ga.Aa(Dc.a.ZPg,Kb.a.view,Object(m.a)(this,this.ohj,"queryFindReplacePane"),97);Object(lC.b)()&&this.ga.Aa(Dc.a.sSe,Kb.a.view,Object(m.a)(this,this.sSe,"queryFindText"),96);this.lCh&&(this.ga.Aa(Dc.a.WNb,Kb.a.view,Object(m.a)(this,this.cTc,"showFindReplacePane"),1028),this.ga.Aa(Dc.a.vOd,Kb.a.view,Object(m.a)(this,this.ohj,
"queryFindReplacePane"),97),this.ga.Aa(Dc.a.replace,Kb.a.view,Object(m.a)(this,this.replace,"replace"),1028),this.ga.Aa(Dc.a.replaceAll,Kb.a.view,Object(m.a)(this,this.replaceAll,"replaceAll"),1028),l.AFrameworkApplication.K.ea("SmartLookupEnableNativePane")&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)&&this.ga.Aa(Sa.a.sue,Kb.a.view,Object(m.a)(this,this.$jl,"findAndReplaceInDocument"),1028));this.ga.ma(Dc.a.hTc,Kb.a.view,Object(m.a)(this,
this.cTc,"showFindReplacePane"))}WSg(){this.i0a&&this.i0a.execute(a=>{a.Pca(new pD)})}find(a,d,n,z,O){return 1===n?32:void 0===O||null===O?8:O.length?this.F7g(O):(this.CKf(St.a.initial),32)}findInDocument(a,d,n,z,O){return this.VCj(Dc.a.TNb,a,d,n,z,O)}$jl(a,d,n,z,O){return this.VCj(Dc.a.WNb,a,d,n,z,O)}VCj(a,d,n,z,O,ca){if(1===z)return Yb.SessionStatusManager.instance.VN?32:8;if(void 0===ca||null===ca)return 8;this.cTc(a,n,2,O,ca);a=this.xp;a.F0g(ca.CommandValueId);Object(lC.b)()&&("MatchCase"in ca&&
(a.matchCase=ca.MatchCase),"MatchWholeWord"in ca&&(a.matchWholeWord=ca.MatchWholeWord));return this.Eoi(d,n,z,O,ca)}F7g(a){if(void 0===a||null===a||!a.length)return 32;a=oD.a.createQuery(a,this.mXm);if(void 0===a||null===a)return k.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.ND.find(a);return 32}get mXm(){let a=Au.a.none;this.xp.matchCase&&(a|=Au.a.matchCase);this.xp.matchWholeWord&&(a|=Au.a.wholeWordOnly);return a}Eoi(a,d,n){return 1===n?32:this.F7g(this.xp.J4a())}Irb(a,d,n,z,O){a=!this.xp.gK;
O[Sk.a.Image16by16Class]=a?Vf.getImageClass(tj.nyn):Vf.getImageClass(tj.fyn);O[Sk.a.LabelText]=a?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;O[Sk.a.ApplyLabelTextToControlOnly]=!0;O[Sk.a.EnsureControlRoleIsButton]=!0;O[Sk.a.On]=!1;return 32}Ukl(a,d,n){if(1===n)return 32;this.gHi(!1);return 32}dll(a,d,n){if(1===n)return 32;this.gHi(!0);return 32}gHi(a){this.xp.IDb!==By.a.headings&&this.xp.d$&&(a?this.ND.KRd.ZTl():this.ND.KRd.iHi())}GSe(a,
d,n,z,O){O[rg.a.Visible]=this.xp.aDj;return 32}USe(a,d,n,z,O){O[rg.a.Visible]=this.xp.aDj;return 32}GAe(a,d,n,z,O){if(1===n)return 32;this.ND.KRd.kHi(O);return 32}cancelSearch(a,d,n){if(1===n)return 32;this.CKf(St.a.initial);return 32}Skd(a,d,n){if(1===n)return 32;this.CKf(St.a.initial);this.xp.nt(!1);return 32}CKf(a){this.xp.gK&&(this.xp.jVa||k.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.ND.Zhb(),this.xp.mfa(a))}clearSearch(a,d,n){if(1===
n)return this.M8l(a===Sa.a.pMf);this.xp.clearSearch();return 32}M8l(a){return this.xp.gK===St.a.replaceAllInProgress||a&&!this.xp.gK?8:32}y3e(a,d,n){if(1===n)return 32;switch(a){case Sa.a.pue:this.xp.matchCase=!this.xp.matchCase;break;case Sa.a.zue:this.xp.matchWholeWord=!this.xp.matchWholeWord}return this.F7g(this.xp.J4a())}cOd(a,d,n,z,O){O[Yf.a.On]=this.xp.matchCase;return 32}dOd(a,d,n,z,O){O[Yf.a.On]=this.xp.matchWholeWord;return 32}WPg(a,d,n,z,O){a=this.xp.matchCase;d=this.xp.matchWholeWord;n=
"";a&&d?n=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):a?n=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):d&&(n=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));O[go.a.Value]=n;O[go.a.Visible]=a||d;return 32}VPc(a,d,n,z,O){a=this.xp.d$;
d="";switch(this.xp.gK){case St.a.startSearch:d=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case St.a.searching:d=a?this.sbg(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case St.a.searchComplete:d=this.sbg(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);break;case St.a.tooManyResults:d=this.sbg(this.xp.jVa?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);
break;case St.a.noMatchesFound:d=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case St.a.replaceAllInProgress:d=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case St.a.replaceAllComplete:d=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}O[go.a.Value]=d;return 32}sSe(a,d,n,z,O){O&&(O.CommandValueId=this.xp.J4a());return 32}sbg(a){return String.format(a,this.xp.X4d,this.xp.d$)}replace(a,d,n,z,O){if(1===n)return this.Crg()?32:8;if(!this.Crg())return 8;a=this.xp.$9b();
"string"===typeof O&&O&&(a=O);k.ULS.sendTraceTag(6033813,312,50,"Replace Called");we.a("NavigationPaneReplace");O=this.RZb.replace(a);this.xp.Jin(O);return 32}Crg(){return this.xp.kwd()&&0<this.xp.d$}replaceAll(a,d,n,z,O){if(1===n)return this.Dem()?32:8;a=this.xp.$9b();"string"===typeof O&&O&&(a=O);we.a("NavigationPaneReplace");this.an=this.Ad.Pe("UserAction","ReplaceAll");this.xp.mfa(St.a.replaceAllInProgress);k.ULS.sendTraceTag(4065348,312,50,"Replace All started feedback indicated to user.");rD.a.Q9m(this.xp.J4a(),
this.xp.$9b());this.RZb.replaceAll(a,Object(m.a)(this,this.YIm,"onReplaceAllComplete"));return 32}YIm(a,d){this.an&&(this.an.stop(),this.an=null);k.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:a,["TotalCount"]:d});rD.a.N9m(a,d);this.xp.mfa(St.a.replaceAllComplete)}Dem(){return this.Crg()&&this.xp.jVa}ohj(a,d,n,z,O){d=!1;if(!O)return 8;this.xp.hh.isVisible&&(d=a===Dc.a.vOd===this.xp.kwd());a!==Dc.a.vOd||this.lCh||(d=!1);O[Yf.a.On]=d;return 32}XPg(a,d,n,z,O){if(!O||!this.xp.hh.isVisible)return 32;
O[Yf.a.On]=this.xp.jVa;return 32}$Pg(a,d,n,z,O){if(!O)return 32;O.currentFindReplaceViewType=this.xp.gK;return 32}CXm(a,d,n,z,O){if(1===n)return 32;a=O[Yf.a.On];O&&(O[Yf.a.On]=this.xp.hh.isVisible);a&&!O[Yf.a.On]&&(Qx.SKj(),we.a("NavigationPaneCrossClick"));return 32}static SKj(){null!=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>{const a=la.a.instance.Ca("Common.ISystemInitiatedFeedback");a&&a.execute(d=>{d.logActivity("NavPaneUsed",
"NavPaneFloodgateIsEnabled")})},Qx.pSa)}$ub(a,d,n,z,O){const ca=this.xp.hh.isVisible;k.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",ca);return ca?this.Skd(a,d,n,z,O):this.cTc(a,d,n,z,O)}cTc(a,d,n,z,O){if(1===n)return!Yb.SessionStatusManager.instance.VN||Lb.App.A4b(d)?8:32;if(2===n){l.AFrameworkApplication.b8("AutoDetectedHeadingsIsEnabled");Qx.SKj();this.DV();qD.FindReplaceUIManager.WLk(a,O,this.xp.hh.isVisible);d=!0;a===Dc.a.hTc&&void 0!==O&&null!==O&&(d=O);this.xp.nt(!0,d);O=By.a.initial;
switch(a){case Dc.a.eTc:k.ULS.sendTraceTag(42501022,367,50,"");O=By.a.headings;break;case Dc.a.TNb:O=By.a.find;break;case Dc.a.WNb:O=By.a.replace;break;case Dc.a.hTc:O=By.a.intelligentPlaceholder;break;case Dc.a.$ub:O=this.xp.IDb,O||(k.ULS.sendTraceTag(42501023,367,50,""),O=By.a.headings)}this.xp.Cmn(O,d);return 32}return 8}Xga(){this.xp.gK&&!this.xp.jVa&&k.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")}static Uzl(a,d,n,z){return new Qx(l.AFrameworkApplication.pa,a,d,n,z,
ic.FocusManager.instance(),Lb.App.oa.Np,la.a.instance.Ca("Box4.Accessibility.IAccessibilityContextManager"),Object(m.a)(l.AFrameworkApplication.la.Qy,l.AFrameworkApplication.la.Qy.Ea,"registerHandler"))}static Tzl(a,d,n,z){return Qx.Uzl(a,d,n,z)}}Qx.pSa=5E3;Object(t.a)(Qx,"FindReplaceActor",null,[]);var mC=b(1392);class rz{constructor(){this.RZb=this.ND=this.E1c=this.D6d=null}get name(){return"WordEditor.FindReplace"}Hb(){}init(){rz.Ka.tk.continueWith(()=>{this.Po()})}Po(){if(Lb.App.u1d){const a=
Lb.App.iWc;this.E1c=qD.FindReplaceUIManager.getInstance(a);this.ND=kC.FindManager.createInstance(this.E1c,nD.a.instance,mC.a.instance,!0);this.RZb=this.ND.xjc;this.D6d=Qx.Tzl(this.E1c,this.ND,this.RZb,a);this.D6d.lb();this.D6d.DV();this.D6d.WSg();Lb.App.oa.updateCommandUI()}}dispose(){this.E1c&&this.E1c.dispose()}static get Ka(){return rz.Ja||(rz.Ja=la.a.instance.resolve("Box4.IFeatureHelper"))}}rz.Ja=null;Object(t.a)(rz,"FindReplacePackageManager",null,[1,2]);class jB{constructor(){}zve(){return"_@_"+
xa.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+"Z"}NOj(a,d,n,z){d.Kin(a,z);d.Sn(a,Vd.a.w5,!0);d.Sn(a,Qb.a.Bga,!0);d.Sn(a,Qb.a.fieldInstruction,jB.yni(n));d.Sn(a,Qb.a.Jp,15)}bXh(a,d,n,z){const O=a.Rmd(z);d.Sn(O,Vd.a.w5,!0);d.Sn(O,Qb.a.Jp,47);d.Sn(O,Qb.a.fieldInstruction,jB.yni(n));a=a.Rmd(z);d.Sn(a,Vd.a.w5,!0);d.Sn(a,Qb.a.Jp,16);return[O.ng,a.ng]}Gpl(a,d,n){a=a.Rmd(n);d.Sn(a,Vd.a.w5,!0);d.Sn(a,Qb.a.h6a,!0);return a.ng}static yni(a){return String.format(' HYPERLINK "{0}"',a)}}Object(t.a)(jB,
"AtMentionHyperlinkConfigurator",null,[393]);class sD{constructor(a,d,n){this.C7c=a;this.Da=d;this.ujf=!1;this.AHg=this.AHg.bind(this);this.NHg=this.NHg.bind(this);this.UIg=this.UIg.bind(this);n&&n.execute(z=>{this.Fxb=z})}Plj(){this.C7c.Klj(this.AHg);this.C7c.Llj(this.NHg);this.C7c.Ylj(this.UIg)}Mqg(){return!1}AHg(a,d,n){var z,O;d=Date.now();if(this.Fxb){var ca=null===(O=null===(z=this.Da.ya)||void 0===z?void 0:z.Ba)||void 0===O?void 0:O.Fb;ca?(z=ca.node,Bd.ParagraphReader.nb(z)?(O=Bd.ParagraphReader.text(z),
0>n||n>O.length?k.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the @ was not within the bounds of the paragraph."):(this.ujf||(this.ujf=!0,this.Fxb.vwn(ca)),this.Fxb.qdh(n,n+a.length),a=O.substring(0,n)+a,this.Fxb.G4f(z,a,n,d))):k.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):k.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else k.ULS.sendTraceTag(537776153,
3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}NHg(a){if(this.Fxb)this.Fxb.onKeyDown(a)}UIg(){this.ujf=!1;this.Fxb&&this.Fxb.X7h()}}Object(t.a)(sD,"ContextIQUserInitHandler",null,[279]);var nC=b(1522);class Bu{constructor(){this.vC=this.Z=null}get name(){return"WordEditor.AtMentions"}Hb(a){this.Z=a;a.ha("Box4.IAtMentionHyperlinkConfigurator",()=>new jB(a.resolve("Box4.IFeatureHelper"))).singleInstance();const d={fjb:Bu.OWj,featureName:Bu.KXj,GUc:Bu.d0j,
gpc:7};a.ha("WordEditor.AtMentions.IFeatureUsageAndHealthLogger",()=>new Pp.a(ja.Health.instance,new Qr.a,d)).as("WordEditor.AtMentions.IFeatureUsageAndHealthLogger").singleInstance()}init(){this.Z.resolve("Box4.IFeatureHelper").tk.continueWith(()=>{this.Po()})}dispose(){}Po(){this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(29)&&(l.AFrameworkApplication.K.ea("CanvasAtMentionDetectionIsEnabled")&&this.Z.Ca("Common.App.People.IExternalPeopleAPI").execute(a=>{a.atMentionsEnabledAsync().then(d=>
{l.AFrameworkApplication.K.ea("ConsumerMentionsHostIsEnabled")&&(d=d&&l.AFrameworkApplication.K.ea("WordEditorConsumerCanvasMentionsIsEnabled"));d&&this.qlm()})}),this.Z.resolve("Box4.IAtMentionHyperlinkConfigurator"))}qlm(){(l.AFrameworkApplication.K.ea("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasAtMentions"):this.Z.resolve("Common.IDynamicScriptLoaderProvider").uG.loadScript("canvasAtMentions")).then(()=>{l.AFrameworkApplication.K.wq(()=>{this.o2m()})})}o2m(){const a={peopleAPI:this.Z.resolve("Common.App.People.IExternalPeopleAPI"),
localizationDetails:{isRightToLeft:l.AFrameworkApplication.isRtl,appLocale:Sys.CultureInfo.CurrentCulture.name},useLPP:!0,isTestEnv:this.Bgm()};this.vC=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(a);nC.a.J5e()?this.Z.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new sD(this.Z.resolve("Box4.AtMentions.IAtMentionsListener"),this.Z.resolve("Box4.ISelectionManager"),this.Z.Ca("WordEditor.CanvasContextual.ContextIQIntentProvider"))).singleInstance():this.Z.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",
()=>new kD(this.Z.resolve("Box4.AtMentions.IAtMentionsListener"),this.vC,this.Z.resolve("Box4.ITextMetricsAdapter"),this.Z.resolve("Box4.ICaretPositionManager"),this.Z.resolve("Box4.ISelectionManager"),Ic.InteractiveViewManager.instance,this.Z.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),this.Z.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener"),this.Z.resolve("Common.Utils.IAriaNotifier"),this.Z.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).singleInstance();
this.Z.resolve("WordEditor.AtMentions.IWordEditorAtMentionsHandler").Plj()}Bgm(){var a,d;const n=null!==(a=l.AFrameworkApplication.sessionStartInfoSettings.Ring)&&void 0!==a?a:"-1";a=null!==(d=l.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==d?d:"";return n===Bu.EWj&&a===Bu.DWj}}Bu.EWj="-4";Bu.DWj="DC2";Bu.OWj="webasynccollabeng";Bu.KXj="AtMentions";Bu.d0j="AtMentionsFeatureUsage";Object(t.a)(Bu,"PackageManager",null,[1,2]);var kB=b(1664);class Ww{constructor(){this.iconSet=
null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null}}Object(t.a)(Ww,"CommonOptionalButtonProperties",null,[]);class Xw extends Ww{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null}}Object(t.a)(Xw,"OptionalButtonProperties",Ww,[]);var gk=b(1210);class Cy{constructor(a,d,n,z,O){this.lg=a;this.Zsf=d;this.Sda=n;this.v4d=z;this.p6j=O;this.Hsf=0;this.vhe=!1;this.VMa=null;this.Y7j=new Map([["ReferencesSmartLookUp",
!0],["SmartLookupSynonyms",!0],["SmartLookupContextMenu",!0],["SmartLookupDictionary",!0],["ChangePicture",!0]]);this.O6j=[{id:`${As.uPc}_${1}`},{id:`${As.uPc}_${2}`},{id:`${As.uPc}_${3}`},{id:gk.a.hqe},{id:gk.a.Poe},{id:gk.a.DQe},{id:gk.a.BQe}];this.g2j=[{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"CreateHeadingLink"},{id:"ReviewDesignerSuggestion"}];this.Jaf=new Map;this.Bdk=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SearchSuggestionInContextMenuIsEnabled",
!1);this.kck=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",!1);this.YBh=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.PersonalizerInContextMenuIsEnabled",!1);this.ndk=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenHyperlinkInlineViewIsEnabled",!1);this.Kfk=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",5);this.$uc=new Map;this.lg.Ea(this,
kB.SearchSuggestionAnnotation.getTypeName());l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&this.Jaf.set("InsertLink","InsertLinkFlyout");this.ANj()}PUm(a,d){const n=Date.now();this.Hsf&&1250>n-this.Hsf||0<this.$uc.size||(this.Hsf=n,this.VMa=a,this.Wee=this.YOl(d),this.hbn(),this.P$m())}sS(a,d){if(a.annotationType===kB.SearchSuggestionAnnotation.getTypeName()&&a.content&&d===Mj.a.getTypeName()){d=Date.now();a=a.content;var n=this.$uc.get(a.correlationId);
if(n){window.clearTimeout(n.Z$g);this.$uc.delete(a.correlationId);n.vej&&(this.v4d.Scn=n.vej);var z=a.menuSuggestions&&0<a.menuSuggestions.length,O=a.searchSuggestions&&0<a.searchSuggestions.length,ca=!0;z&&(this.JNn(a.menuSuggestions,a.searchSuggestions),this.vhe&&(ca=!1));ca&&this.xpj();k.ULS.sendTraceTag(572057625,1303,50,JSON.stringify({["description"]:"[Zero term context menu] augloop response latency",["correlationId"]:a.correlationId,["networkTime"]:a.networkTime,["executionTime"]:a.executionTime,
["updateTime"]:Date.now()-d,["latencyMs"]:d-n.timestamp,["containsZTM"]:z,["expectedZTM"]:n.Cte,["containsSearchSuggestions"]:O,["expectedSearchSuggestions"]:n.x0f,["fallBack"]:ca}))}}}YOl(a){const d=[],n=new Map,z=Date.now();for(const O of a){if(!O)continue;a=[];const ca={itemsMetadata:new yb.a};for(let Da=0;Da<O.ControlList.length;Da++){const Xa=O.ControlList[Da];if(Xa&&!Xa.ExternalId)continue;a.push(Xa.ExternalId);const zb={timeStamp:z,source:"FallbackZeroTermMenu",confidenceScore:-1};ca.itemsMetadata[Xa.ExternalId]=
zb;n.set(Xa.ExternalId,zb)}d.push(appChrome.api.menuSection(a,O.Title,O.Lang,O.Id,ca))}return{sections:d,commands:n}}nGn(a){return this.Jaf.has(a)?this.Jaf.get(a):a}a9l(a){return!appChrome.selectors.isControlDefined(a)||appChrome.selectors.isControlDisabled(a)?!1:this.Y7j.has(a)?this.Wee.commands.has(a):!0}Xdi(a){return appChrome.actions.updateMenu("ZeroTermContextMenu",a,null,null,null,null,{menuTargetType:this.VMa})}ZEc(){const a=fm.a.instance.ZEc(),d=[],n=Date.now();for(let z of a)z.commandId&&
d.push({Id:z.commandId,TimeElapsedSinceClick:(n-z.timeStamp)/1E3});return d}vtd(){const a=fm.a.instance.vtd(),d=[],n=Date.now();for(let z of a)z.controlId&&d.push({Id:z.controlId,TimeElapsedSinceClick:(n-z.timeStamp)/1E3});return d}ANj(){this.Sda.getSession().then(a=>this.s3d=a).catch(()=>{this.s3d=void 0})}P$m(){const a={CommandClickedEvents:this.vtd(),CommandActionEvents:this.ZEc(),ContentType:this.VMa};this.YBh&&(a.PersonalizerData={RankRequestData:{EventId:xa.a.create().toString()},RewardRequestData:this.v4d.Rcn},
this.v4d.Oqj());const d=this.Bdk?this.Uyi():null;this.DAn(a,d)}DAn(a,d){var n,z,O,ca,Da;if(a){var Xa=new kB.SearchSuggestionSignal({correlationId:xa.a.create().toString(),context:null===d||void 0===d?void 0:d.neighborhood,start:null!==(n=null===d||void 0===d?void 0:d.mentionStart)&&void 0!==n?n:0,length:null!==(z=null===d||void 0===d?void 0:d.mentionLength)&&void 0!==z?z:0,zeroTermMenuRequest:a});n=window.setTimeout(()=>{this.bJm(Xa.correlationId)},750);a={Cte:!!a,x0f:!!d,timestamp:Date.now(),Z$g:n,
vej:null===(Da=null===(ca=null===(O=Xa.zeroTermMenuRequest)||void 0===O?void 0:O.PersonalizerData)||void 0===ca?void 0:ca.RankRequestData)||void 0===Da?void 0:Da.EventId};this.$uc.set(Xa.correlationId,a);O=new Mj.l({parentPath:["Signal",kB.SearchSuggestionSignal.getTypeName()],items:[{id:xa.a.create().toString(),body:Xa}]});this.s3d&&!this.s3d.RBd?this.s3d.submitOperation(O):(this.Sda.submitOperation({operation:O}),this.ANj());k.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",
["correlationId"]:Xa.correlationId,["containsZTM"]:a.Cte,["containsSearchSuggestions"]:a.x0f}))}else k.ULS.sendTraceTag(556892510,1303,15,"No search suggestion al workflow will be activated")}bJm(a){const d=this.$uc.get(a);d&&(this.$uc.delete(a),d.Cte&&this.xpj(),k.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:a,["containsZTM"]:d.Cte,["containsSearchSuggestions"]:d.x0f})))}xpj(){const a=this.Xdi(this.Wee.sections);
appChrome.api.dispatch(a);this.q9h()}q9h(){this.vhe=!0}m6m(a){var d,n;const z=[],O=new Map;if(!a||0===a.length)return z;for(const ca of a){if(!ca||!ca.controlIds||0===ca.controlIds.length)continue;a={controlIds:[],id:ca.id,title:ca.title,lang:ca.lang,data:{itemsMetadata:new yb.a}};const Da="CommandsZTM"===ca.id;for(const Xa of ca.controlIds){if(O.has(Xa))continue;if(Da&&a.controlIds.length>=this.Kfk)break;const zb=null===(n=null===(d=ca.data)||void 0===d?void 0:d.itemsMetadata)||void 0===n?void 0:
n[Xa];O.set(Xa,zb);a.controlIds.push(Xa);zb&&(a.data.itemsMetadata[Xa]=zb)}0<a.controlIds.length&&z.push(a)}return z}hbn(){this.vhe=!1;if(this.kck){const a=[appChrome.actions.updateControlHiddenState("ContextMenu",!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(a)}}JNn(a,d){this.vhe||(a=this.pql(a,d),0<a.length&&appChrome.api.dispatch(a))}pql(a,d){const n=[];let z=[];if(!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisablePassThroughSections",
!1)){var O=this.WJl();O&&0<O.length&&z.push(...O)}(O=this.Bpl())&&z.push(O);(O=this.Spl(n))&&z.push(O);Array.isArray(a)&&0<a.length&&(this.ndk&&(O=this.p6j.lRm(n))&&a.unshift({suggestion:O,rankingScore:-1,suggestionSource:"RichCommandZeroTermMenu"}),a=this.dHa(a))&&(a.id="CommandsZTM",z.push(a));Array.isArray(d)&&0<d.length&&(d=this.Upl(d,n))&&z.push(d);(d=this.tpl())&&z.push(d);z=this.m6m(z);if(0===z.length)return[];this.YBh&&(this.v4d.MTn=this.wYk(z));n.push(this.Xdi(z));this.q9h();return n}Spl(a){const d=
[],n={itemsMetadata:new yb.a};if(this.Zsf){var z=this.Zsf.E_m();const O=Date.now();for(const ca of z)z=ca.Yrj.actionId,n.itemsMetadata[z]={timeStamp:O,source:this.Zsf.source,confidenceScore:ca.score},appChrome.selectors.isControlDefined(z)||a.push(ca.Yrj.ypl()),d.push(z)}return 0<d.length?appChrome.api.menuSection(d,null,null,null,n):null}WJl(){var a,d;const n=null===(a=this.Wee)||void 0===a?void 0:a.sections.filter(z=>{var O;return null===(O=z.id)||void 0===O?void 0:O.startsWith(As.dji)});for(const z of n)if(null===
(d=z.data)||void 0===d?0:d.itemsMetadata)for(const O in z.data.itemsMetadata)z.data.itemsMetadata[O].source="PassThroughZeroTermMenu";return n}Bpl(){const a=this.Wri(this.O6j,"DefaultZeroTermMenu");return this.dHa(a)}tpl(){const a=this.Wri(this.g2j,"AdvertizedZeroTermMenu");return this.dHa(a)}Wri(a,d){const n=[];for(const z of a)z&&this.Wsn(z)&&this.Wee.commands.has(z.id)&&n.push({suggestion:z.id,rankingScore:-1,suggestionSource:d});return n}Wsn(a){if("number"!==typeof(null===a||void 0===a?void 0:
a.count))return!0;if(0===a.count)return!1;a.count--;return!0}wYk(a){const d=[];for(let z of a)for(let O of z.controlIds){var n=z.data;a=-1;let ca=null;n&&n.itemsMetadata&&(n=n.itemsMetadata[O],a=n.confidenceScore,ca=n.source);d.push({suggestion:O,rankingScore:a,suggestionSource:ca})}return d}Upl(a,d){const n=[],z=[],O={itemsMetadata:new yb.a};this.Pxe();let ca=0;for(let Xa of a){a=Xa.suggestion;var Da={neighborhood:a,mentionStart:0,mentionLength:a.length};Da=(new Mo.a).rdi(Da,23,null);a=Object.assign(new Xg.a,
{ExternalId:"ZeroTermContextMenuSearchSuggestion"+ca,LabelText:this.FRf(a,WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookupSubmenu_SearchMore),CommandValueId:Da});if(appChrome.selectors.isControlDefined(a.ExternalId))d.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),d.push(appChrome.actions.setButtonCommandValueId(a.ExternalId,Da));else{Da={};const zb=Object.assign(new Xw,{commandValueId:a.CommandValueId});Da["default"]=
"Insights_20";zb.iconSet=Da;z.push(appChrome.api.createButtonModel(a.ExternalId,a.LabelText,zb))}n.push(a.ExternalId);O.itemsMetadata[a.ExternalId]={timeStamp:Date.now(),source:Xa.suggestionSource?Xa.suggestionSource:"SearchSuggestion",confidenceScore:Xa.rankingScore};ca++;if(3<=ca)break}0<z.length&&d.push(appChrome.actions.addControls(z));return n&&0<n.length?appChrome.api.menuSection(n,null,null,null,O):null}dHa(a){const d=[],n={itemsMetadata:new yb.a},z=Date.now();for(let O of a)a=this.nGn(O.suggestion),
this.a9l(a)&&(d.push(a),n.itemsMetadata[a]={timeStamp:z,source:O.suggestionSource,confidenceScore:O.rankingScore});return 0<d.length?appChrome.api.menuSection(d,null,null,null,n):null}Uyi(){return(new Mo.a).getSelectedText()}Pxe(){const a=this.Uyi();return a.neighborhood.substr(a.mentionStart,a.mentionLength)}ize(a){a=a?a.trim():null;let d=20;a&&0<a.length&&(a.length>d&&(d=w.a.Yr(a,d)?d-1:d),a=a.length>d?a.substr(0,d).trim()+"...":a);return a}FRf(a,d,n){(a=this.ize(a))&&0<a.length&&(n=String.format(d,
a));return n}}Object(t.a)(Cy,"AugLoopSearchSuggestionManager",null,[280,442]);var sz=b(463),Yw=b(301);b(1662);class Dy{constructor(a){this.xTb=a;this.lfd=[];sz.a.instance.egd(this.MUl.bind(this))}MUl(a,d){a={commandId:d.actionName,timestamp:d.timeStamp};(new Zw).FLn(a)&&(Array.insert(this.lfd,0,a),this.lfd.length>this.xTb.l3i&&Array.removeAt(this.lfd,this.xTb.l3i))}}Object(t.a)(Dy,"ActionContextCache",null,[]);class Rx{constructor(a){this.Sp=a}get paragraphId(){return this.Sp&&this.Sp.ra&&this.Sp.ra.node&&
this.Sp.ra.node.id&&this.Sp.ra.node.id.guid?this.Sp.ra.node.id.guid.toString():null}}Object(t.a)(Rx,"SelectionDetailFetcher",null,[]);class Zw{FLn(a){return"BrowserPasted"===a.commandId||"ImageResize"===a.commandId?(a.paragraphId=(new Rx(this.a4())).paragraphId,!0):!1}a4(){var a=Lb.App.oa.za.Rb;return a?(a=a.Oa)&&a.ya&&a.ya.length?a.ya.Ba:null:null}}Object(t.a)(Zw,"ActionContextFetcher",null,[]);class tD{constructor(a,d,n){this.xTb=a;this.ga=d;this.fLh=n;this.source="RichAction";this.t4m()}E_m(){const a=
[];for(const d of this.fLh){const n=d.zli();n>=this.xTb.threshold&&a.push({score:n,Yrj:d})}a.sort((d,n)=>n.score-d.score);return a.slice(0,Math.min(this.xTb.topN,a.length))}t4m(){for(const a of this.fLh){const d=a.zhl;this.ga.Aa(d.XUk,d.contextId,d.handler,d.flags)}}}Object(t.a)(tD,"ActionRecommender",null,[]);var Fj;(function(a){a.dXn="WordEditor.ContextualSearch.RichAction.PreviousParagraphFormatApplier";a.cXn="WordEditor.ContextualSearch.RichAction.NextParagraphFormatApplier";a.bXn="WordEditor.ContextualSearch.RichAction.AdjacentImageAligner"})(Fj||
(Fj={}));Object(t.b)("RichActionRegisterNames",Fj);class oC{constructor(){this.topN=2;this.threshold=.5;this.l3i=50;this.Lum=3}}Object(t.a)(oC,"FeatureSetting",null,[]);class tz{constructor(a,d,n,z,O){this.Oa=a;this.iconName=d;this.actionId=n;this.btk=z;this.YTk=O;this.GL=void 0}get zhl(){return{XUk:this.YTk,contextId:Cd.a.frame,handler:this.i_.bind(this),flags:1028}}ypl(){const a=new Xw;var d={};d["default"]=this.iconName;a.iconSet=d;d=[];d.push(appChrome.api.createButtonModel(this.actionId,this.btk,
a));return appChrome.actions.addControls(d)}i_(a,d,n){if(1===n)return 32;d=new Ff.GraphTransaction(15);d.Sa(this.GL.ra.node);d.om=a;a=this.execute();d.dispose();return a}}Object(t.a)(tz,"RichAction",null,[]);class oA extends tz{constructor(a,d,n,z){super(a,"FormatPainter_20","previous"===z?"RaNeighborPreviousParagraphFormatApplier":"RaNeighborNextParagraphFormatApplier",`Format as ${z} paragraph`,"previous"===z?Dc.a.Eij:Dc.a.Dij);this.Or=d;this.h8e=n;this.H2j=z;this.Kuc=void 0}zli(){var a,d,n;this.GL=
null===(d=null===(a=this.Oa)||void 0===a?void 0:a.ya)||void 0===d?void 0:d.Ba;this.Kuc=void 0;if(1!==(null===(n=this.GL)||void 0===n?void 0:n.length)||!Bd.ParagraphReader.Zf(this.GL.ra.iterator)||this.GL.bM||!this.I9l)return 0;a=Bd.ParagraphReader.qh(this.GL.ra.node,"previous"===this.H2j,!1,!1);if(!a||!Bd.ParagraphReader.nb(a)||!this.$Si&&!this.Oam)return 0;this.Kuc=a;return.9}execute(){if(!this.GL||!this.Kuc)return 16;var a=fe.a.createTextRange(this.Kuc,0,Bd.ParagraphReader.textLength(this.Kuc));
a=new pa.Selection([a],!1);this.Or.HMg(a);this.$Si?(a=fe.a.createTextRange(this.GL.ra.node,0,Bd.ParagraphReader.textLength(this.GL.ra.node)),a=new pa.Selection([a],!1),this.Or.Ije(a)):this.Or.Ije(this.GL);this.Kuc=this.GL=void 0;return 32}get $Si(){return this.GL.ra.cpBegin===this.GL.ra.cpEnd}get Oam(){return 0===this.GL.ra.cpBegin&&this.GL.ra.cpEnd===Bd.ParagraphReader.textLength(this.GL.ra.node)}get I9l(){for(const a of this.h8e.lfd)if("BrowserPasted"===a.commandId){const d=a.paragraphId;if(d){const n=
(new Rx(this.GL)).paragraphId;if(d===n)return!0}}return!1}}Object(t.a)(oA,"NeighborParagraphFormatApplier",tz,[]);class uD extends oA{constructor(a,d,n){super(a,d,n,"previous")}}Object(t.a)(uD,"PreviousParagraphFormatApplier",oA,[]);class vD extends oA{constructor(a,d,n){super(a,d,n,"next")}}Object(t.a)(vD,"NextParagraphFormatApplier",oA,[]);class wD extends tz{constructor(a,d,n,z){super(a,"FormatPainter_20","RaAdjacentImageAligner","Align images",Dc.a.Cij);this.si=d;this.h8e=n;this.xTb=z;this.kqc=
void 0}zli(){var a,d,n;this.GL=null===(d=null===(a=this.Oa)||void 0===a?void 0:a.ya)||void 0===d?void 0:d.Ba;if(1!==(null===(n=this.GL)||void 0===n?void 0:n.length)||!this.GL.bM)return 0;var z=Kd.ImageReader.$k(this.GL.ra);a=this.Esi(this.GL.ra.node,!0);d=this.jPi(z,a.Iyc);n=this.Esi(this.GL.ra.node,!1);z=this.jPi(z,n.Iyc);if(d&&!z)return this.kqc=a.Iyc,.9;if(z&&!d)return this.kqc=n.Iyc,.9;if(!d&&!z)return 0;this.kqc=this.$7l(n.oAk)?n.Iyc:a.Iyc;return.9}execute(){if(!this.GL||!this.kqc)return 16;
const a=Kd.ImageReader.$k(this.GL.ra),d=Kd.ImageReader.UA(this.kqc),n=Kd.ImageReader.Tz(this.kqc);this.si.Syj(a,this.GL.ra,n,d);return 32}Esi(a,d){let n=void 0,z=void 0;try{for(let O=-1;O<this.xTb.Lum;++O){n=Bd.ParagraphReader.qh(a,d,!1,!1);if(!n)break;if(z=Kd.ImageReader.$k(fe.a.createTextRange(n,0,Bd.ParagraphReader.textLength(n))))break;if(0<Bd.ParagraphReader.textLength(n))break;a=n}}catch(O){k.ULS.sendTraceTag(545861641,1303,10,"Exception as getting adjacent image. Error: {0}",O),z=n=void 0}return{oAk:n,
Iyc:z}}jPi(a,d){if(!d)return!1;const n=Kd.ImageReader.UA(a);a=Kd.ImageReader.Tz(a);const z=Kd.ImageReader.UA(d);d=Kd.ImageReader.Tz(d);return n===z&&a===d?!1:!0}$7l(a){a=a.id.guid.toString();for(const d of this.h8e.lfd)if("ImageResize"===d.commandId)return d.paragraphId===a;return!1}}Object(t.a)(wD,"AdjacentImageAligner",tz,[]);class lB{constructor(a){this.Tb=a;this.efd=null;this.AAb={EventId:null};this.lb()}lb(){this.Tb.Aa(Dc.a.t5e,Cd.a.frame,Object(m.a)(this,this.t5e,"zeroTermContextMenuClose"),
1124)}Oqj(){this.AAb={EventId:null};this.efd=null}set Scn(a){this.AAb.EventId=a}set MTn(a){this.efd=a}get Rcn(){return this.AAb&&this.AAb.EventId&&this.AAb.OfferedSuggestions?this.AAb:null}t5e(a,d,n,z,O){var ca;if(1===n)return 32;if(!this.efd||0===this.efd.filter(Da=>Da.suggestionSource===lB.source).length)return this.Oqj(),32;O&&O.yhl&&(this.AAb.ExecutedSuggestion={suggestion:null!==(ca=O.a7n)&&void 0!==ca?ca:O.yhl,suggestionSource:O.source,rankingScore:O.confidenceScore});this.AAb.OfferedSuggestions=
this.efd;return 32}}lB.source="Personalizer";Object(t.a)(lB,"ContextualSearchPersonalizerActor",null,[250]);class mB{}Object(t.a)(mB,"DocumentItem",null,[]);var pC=b(1663);class xD{constructor(a){this.Oa=a;this.Hrk=RegExp("^(docx|pptx|ppsx|xlsx|pdf)$");this.Krk=["sharepoint.com","sharepoint-df.com"]}HNl(){var a,d;let n=null;const z=null===(d=null===(a=this.Oa)||void 0===a?void 0:a.ya)||void 0===d?void 0:d.Ba;if(!z)return null;a=z.ra;if(32!==l.AFrameworkApplication.pa.rf(a,Mb.a.NWa,1,!0,null,null))return n;
(a=hg.HyperlinkReader.g$b(a))&&1===a.length&&(n=decodeURIComponent(a[0].hyperlink.url));return n}wyl(a){const d=a.lastIndexOf(".");if(0>d)return null;a=a.substring(d+1).toLowerCase();return this.Hrk.test(a)?a:null}xhm(a){const d=new URL(a);return d&&d.hostname&&this.Krk.find(n=>d.hostname.toLowerCase().includes(n))?!0:!1}lRm(a){const d=[];var n=new Mo.a,z=this.HNl();if(!z||!this.xhm(z))return null;const O=this.wyl(z);if(!O)return null;z={landingTab:"Files",data:{type:3,l2Document:Object.assign(new mB,
{Id:xa.a.create().toString(),Path:z,FileType:O,LastModifiedTime:null})}};n=n.rdi({neighborhood:"",mentionStart:0,mentionLength:0},10,z);appChrome.selectors.isControlDefined("OpenHyperlinkInlineView")||(z=Object.assign(new Xw,{commandValueId:n}),d.push(appChrome.api.createButtonModel("OpenHyperlinkInlineView",pC.WordRibbonStrings.zWn,z)));z=Object.assign(new Xg.a,{ExternalId:"OpenHyperlinkInlineView",CommandValueId:n});a.push(appChrome.actions.setButtonCommandValueId(z.ExternalId,n));0<d.length&&a.push(appChrome.actions.addControls(d));
return z.ExternalId}}Object(t.a)(xD,"ContextualSearchHyperlinkProcessor",null,[233]);class qC{constructor(){this.Z=null}get name(){return"WordEditor.ContextualSearch"}Hb(a){this.Z=a;l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RichActionInContextMenuIsEnabled",!1)&&(this.Z.ha("WordEditor.ContextualSearch.RichAction.FeatureSetting",()=>new oC).singleInstance(),this.Z.ha("WordEditor.ContextualSearch.RichAction.ActionContextCache",()=>new Dy(this.Z.resolve("WordEditor.ContextualSearch.RichAction.FeatureSetting"))).singleInstance(),
this.Z.ha("WordEditor.ContextualSearch.RichAction.PreviousParagraphFormatApplier",()=>new uD(Rj.App.wn.za.Rb.Oa,this.Z.resolve("Box4.IFormatPainter"),this.Z.resolve("WordEditor.ContextualSearch.RichAction.ActionContextCache"))).singleInstance(),this.Z.ha("WordEditor.ContextualSearch.RichAction.NextParagraphFormatApplier",()=>new vD(Rj.App.wn.za.Rb.Oa,this.Z.resolve("Box4.IFormatPainter"),this.Z.resolve("WordEditor.ContextualSearch.RichAction.ActionContextCache"))).singleInstance(),this.Z.ha("WordEditor.ContextualSearch.RichAction.AdjacentImageAligner",
()=>new wD(Rj.App.wn.za.Rb.Oa,this.Z.resolve("WordEditor.IImageEditor"),this.Z.resolve("WordEditor.ContextualSearch.RichAction.ActionContextCache"),this.Z.resolve("WordEditor.ContextualSearch.RichAction.FeatureSetting"))).singleInstance(),this.Z.ha("WordEditor.ContextualSearch.RichAction.ActionRecommender",()=>new tD(this.Z.resolve("WordEditor.ContextualSearch.RichAction.FeatureSetting"),l.AFrameworkApplication.pa,Object.keys(Fj).filter(d=>d.startsWith("Ra",0)).map(d=>this.Z.resolve(Fj[d])))).singleInstance());
this.Z.ha("WordEditor.ContextualSearch.ContextualSearchPersonalizerActor",()=>new lB(l.AFrameworkApplication.pa)).as("WordEditor.ContextualSearch.IContextualSearchPersonalizerActor").singleInstance();this.Z.ha("WordEditor.ContextualSearch.ContextualSearchHyperlinkProcessor",()=>new xD(Rj.App.wn.za.Rb.Oa)).as("WordEditor.ContextualSearch.IContextualSearchHyperlinkProcessor").singleInstance();this.Z.ha("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager",()=>new Cy(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
this.Z.sa("WordEditor.ContextualSearch.RichAction.ActionRecommender"),augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.Z.resolve("WordEditor.ContextualSearch.IContextualSearchPersonalizerActor"),this.Z.resolve("WordEditor.ContextualSearch.IContextualSearchHyperlinkProcessor"))).as("WordEditor.ContextualSearch.ISearchSuggestionManager").singleInstance()}init(){this.Z.resolve("Box4.IFeatureHelper").tk.continueWith(()=>{Ea.a.ar().then(()=>{this.start()})})}start(){this.Z.resolve("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager")}dispose(){}static main(){M.a.instance.Sb(new qC)}}
Object(t.a)(qC,"PackageManager",null,[1,2]);var yD=b(398),Pr=b(847);class zo extends Pr.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(t.a)(zo,"BootMessage",Pr.a,[]);var rC=b(925);class zD{constructor(){this.vF=null;this.kMa=new me.a}vdc(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}create(a,d){let n=!1;try{this.vF=new Worker(a);this.vF.onmessage=Object(m.a)(this,this.jHm,"onMessageHandler");
const z=Object.assign(new zo,{api:0,method:0,scripts:d,documentUrl:document.URL});this.postMessage(z);this.vdc()&&rC.a.gnh(this.vF);n=!0}catch(z){k.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",z)}return n}postMessage(a){try{const d=x.c(a);this.vF.postMessage(d)}catch(d){k.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",d)}}jHm(a){if(a.target===this.vF)if(void 0===a.data||null===a.data)k.ULS.sendTraceTag(50739143,
3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof a.data){const d=x.a(a.data);this.k0e(d.api)?this.kMa.J(d.api).GBa(d.method,d):k.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(d){k.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",d)}}k0e(a){return this.kMa.Na(a)}rtk(a,d){this.k0e(a)&&k.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",
a);this.kMa.$(a,d)}ksl(a){return this.k0e(a)?this.kMa.J(a):null}}Object(t.a)(zD,"WebWorker",null,[63]);class AD{constructor(){this.Phh=[]}o5k(a,d){if(d){var n=l.AFrameworkApplication.Yx(a.Utj,7),z=[];for(let O=0;O<a.$mc.length;O++){let ca;switch(a.$mc[O].format){case 5:case 6:ca=yD.a.Pra(a.$mc[O].name);break;default:ca=a.$mc[O].name}z.push(l.AFrameworkApplication.Yx(ca,a.$mc[O].format))}try{const O=URL.createObjectURL(new Blob(["importScripts('"+n+"');"],{type:"application/javascript"})),ca=new zD;
if(ca.create(O,z))for(this.Phh.push(ca),n=0;n<a.i0e.length;n++){const Da=d.g_k(ca,a.i0e[n]);Da&&ca.rtk(a.i0e[n],Da)}}catch(O){k.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",O.message)}}else k.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(t.a)(AD,"WebWorkerCollection",null,[]);class BD{constructor(a,d){this.Hzf=new AD;if(a){a=a.create();for(let n=0;n<a.length;n++)this.Hzf.o5k(a[n],d)}else k.ULS.sendTraceTag(50442779,
3007,10,"WebWorkerRouter: configFactory parameter was null.")}Eh(a,d,...n){let z=!1;for(let ca=0;ca<this.Hzf.Phh.length;ca++){var O=this.Hzf.Phh[ca];O.k0e(a)&&((O=O.ksl(a))?z=O.fya(d,n)||z:k.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",a))}z||k.ULS.sendTraceTag(50442781,3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",a,d)}}Object(t.a)(BD,"WebWorkerRouter",
null,[16]);class $w{constructor(){this.D=this.ST=0}}Object(t.a)($w,"LongTaskInfo",null,[]);class cq{constructor(a,d){this.wzf=null;a.b5(Object(m.a)(this,this.ksm,"longTaskListener"));this.bX=d}get QSn(){null==this.wzf&&(this.wzf=l.AFrameworkApplication.K?l.AFrameworkApplication.K.jb("WordHangDetectionHangThresholdTime",2E3):2E3);return this.wzf}ksm(a){if(a){var d=[];for(let n of a.getEntries())n.duration>=this.QSn&&(a=new $w,a.ST=n.startTime,a.D=Math.round(n.duration),d.push(a));if(0<d.length){let n;
(n=this.bX).Eh.apply(n,[1,3].concat(d))}}}}Object(t.a)(cq,"HangDetector",null,[]);class sC{constructor(){this.HJh=null;this.Iz=[];this.Ruc=0}b5(a){this.Ruc||this.pBm();1===this.Ruc&&this.Iz.push(a)}jsm(){return!!window.PerformanceObserver&&!!window.PerformanceLongTaskTiming&&!!PerformanceObserver.supportedEntryTypes&&-1!==Array.indexOf(PerformanceObserver.supportedEntryTypes,"longtask")}P6l(a){for(let d of this.Iz)d(a)}pBm(){if(!this.Ruc)if(this.jsm())try{this.HJh=new PerformanceObserver(Object(m.a)(this,
this.P6l,"internalListener")),this.HJh.observe({type:"longtask"}),this.Ruc=1}catch(a){this.Ruc=2,k.ULS.sendTraceTag(592479427,3008,10,"Failed to create PerformanceObserver with message {0}",a.message)}else this.Ruc=2}}Object(t.a)(sC,"LongTaskListeners",null,[232]);class tC extends Pr.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=
this.WaciiEnabledRequests=0;this.WacClusterId=null}}Object(t.a)(tC,"SettingsMessage",Pr.a,[]);class Cu{constructor(a){this.vF=a}}Object(t.a)(Cu,"WebWorkerApiMain",null,[]);class CD extends Cu{constructor(a){super(a)}vdc(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}fya(a,d){if(!d)return k.ULS.sendTraceTag(591972375,3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),
!1;if(1===a)return this.pNk(d);k.ULS.sendTraceTag(591972376,3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",a);return!1}GBa(a,d){switch(a){case 14:this.iWl(d);break;default:k.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",a)}}pNk(a){if(2!==a.length)return k.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",a.length),
!1;if("object"!==typeof a[0]||"object"!==typeof a[1])return k.ULS.sendTraceTag(587343010,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}","object"===typeof a[0],"object"===typeof a[1]),!1;a=Object.assign(new tC,{api:0,method:1,appSettings:a[0],sessionStartInfoSettings:a[1],sessionID:l.AFrameworkApplication.userSessionId,LocalCobaltSessionId:Xf.a.instance.nD,LocalCobaltMachineId:Xf.a.instance.Qsa,LocalCobaltClusterId:Xf.a.instance.uJa,
LocalCobaltSessionHasBackup:Xf.a.instance.nQ,WaciiEnabledRequests:Xf.a.instance.AM,SettingsRoutedToServer:Xf.a.instance.Clc,WacClusterId:l.AFrameworkApplication.Gd.mG});this.vF.postMessage(a);return!0}iWl(a){this.vdc()&&a&&a.result&&(k.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),this.vQn())}vQn(){Object(ov.__awaiter)(this,void 0,void 0,function*(){try{const a=yield new rC.a.inh.WorkerUtilsTestClass(10);yield a.yh(5);15==(yield a.counter)?k.ULS.sendTraceTag(555877917,
3007,50,"WorkerUtils testing successfully"):k.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(a){k.ULS.sendTraceTag(555877919,3007,10,"WorkerUtils failed with exception: {0}",a.message)}})}}Object(t.a)(CD,"InitializeWorkerApiMain",Cu,[]);class Ey extends Pr.a{constructor(){super();this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=null;this.appMode=0;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(t.a)(Ey,"CatchUpNetworkRequestWorkerRequestMessage",
Pr.a,[]);class uz extends Cu{constructor(a,d){super(a);this.Xjd=d}fya(a,d){if(4===a)return a=Object.assign(new Ey,{rootQuerySignature:d[0],requestEndpoint:d[1],appMode:d[2],activityFeedIsEnabled:d[3]}),this.vF.postMessage(a),!0;k.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",a);return!1}GBa(a,d){switch(a){case 5:k.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",a);this.Xjd.cjn(d);
break;default:k.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",a)}}}Object(t.a)(uz,"CatchUpNetworkRequestWorkerExternalApi",Cu,[]);class Fy extends Pr.a{constructor(){super();this.taskInfo=null}}Object(t.a)(Fy,"HangDetectionMessage",Pr.a,[]);class Xs extends Pr.a{constructor(){super();this.taskInfo=null}}Object(t.a)(Xs,"ReportLongTasksMessage",Pr.a,[]);class uC extends Cu{constructor(a){super(a)}fya(a,d){if(!d)return k.ULS.sendTraceTag(591972370,
3008,10,"HangDetectionWorkerApiMain: HangDetection called with a null methodParams value."),!1;switch(a){case 2:return this.oNk(d);case 3:return this.C$m(d);default:return k.ULS.sendTraceTag(591972371,3008,10,"HangDetectionWorkerApiMain: Unknown method called.  MethodId: {0}",a),!1}}GBa(a){k.ULS.sendTraceTag(591972372,3007,10,"HangDetectionWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",a)}oNk(a){if(1!==a.length||"object"!==typeof a[0])return k.ULS.sendTraceTag(591972373,
3008,10,"HangDetectionWorkerApiMain: HangDetection called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",a.length,"object"===typeof a[0]),!1;a=Object.assign(new Fy,{api:1,method:2,taskInfo:a[0]});this.vF.postMessage(a);return!0}C$m(a){if(!a.length||!Object(Uc.a)($w,a[0]))return k.ULS.sendTraceTag(591972374,3008,10,"HangDetectionWorkerApiMain: ReportLongTasks called with incorrect parameters. Params length is {0}, Param[0] is LongTaskInfo is {1}",a.length,0<a.length?Object(Uc.a)($w,
a[0]):!1),!1;a=Object.assign(new Xs,{api:1,method:3,taskInfo:a});this.vF.postMessage(a);return!0}}Object(t.a)(uC,"HangDetectionWorkerApiMain",Cu,[]);class Np extends Pr.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=null}}Object(t.a)(Np,"LocalInferenceMessage",Pr.a,[]);class Gy{constructor(){this.prediction=this.context=null}}Object(t.a)(Gy,"LocalInferenceOutput",null,[]);class vz{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=
null}}Object(t.a)(vz,"TextPredictionConfig",null,[]);class Hy{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=3}}Object(t.a)(Hy,"TextPredictionSettings",null,[]);class DD{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(t.a)(DD,"TextPredictionDynamicPayload",null,[]);class ax extends Cu{constructor(a,d){super(a);this.psk=d}fya(a,d){if(!d)return k.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),
!1;switch(a){case 8:return this.vNk(d);case 7:return this.qNk(d);case 9:return this.uNk(d);case 10:return this.rNk(d);case 13:return this.sNk(d);case 14:return this.tNk(d);default:return k.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",a),!1}}GBa(a,d){switch(a){case 9:this.cXl(d);break;default:k.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",a)}}cXl(a){a&&a.prediction&&
(a=Object.assign(new Gy,{prediction:a.prediction,context:a.context}),this.psk.B_h().YUm(a))}qNk(a){if(1>a.length)return k.ULS.sendTraceTag(575959823,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",a.length,"object"===typeof a[0]),!1;a=a[0];a=Object.assign(new Np,{api:4,method:7,paragraphContent:a,textPredictionConfig:this.getConfig()});this.vF.postMessage(a);return!0}vNk(a){if(1>a.length)return k.ULS.sendTraceTag(575959824,
3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",a.length,"object"===typeof a[0]),!1;a=a[0];a=Object.assign(new Np,{api:4,method:8,paragraphContent:a});this.vF.postMessage(a);return!0}uNk(a){if(2>a.length)return k.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",a.length,"object"===
typeof a[0]),!1;var d=a[0];a=a[1];d=Object.assign(new Np,{api:4,method:9,paragraphContent:a,context:d});this.vF.postMessage(d);return!0}rNk(a){if(1>a.length)return k.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",a.length,"object"===typeof a[0]),!1;a=a[0];a=Object.assign(new Np,{api:4,method:10,textPredictionConfig:this.getConfig(a)});this.vF.postMessage(a);return!0}sNk(a){if(1>a.length)return k.ULS.sendTraceTag(556827920,
3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",a.length,"object"===typeof a[0]),!1;a=a[0];a=Object.assign(new Np,{api:4,method:13,textPredictionConfig:this.Bwi(a)});this.vF.postMessage(a);return!0}tNk(a){if(1>a.length)return k.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",a.length,Object(Uc.a)(Object,
a[0])),!1;a=a[0];a=Object.assign(new Np,{api:4,method:14,textPredictionConfig:this.Bwi(a)});this.vF.postMessage(a);return!0}getConfig(a=null){return Object.assign(new vz,{scriptDirectory:l.AFrameworkApplication.BQ+"/intelligence/",settings:Object.assign(new Hy,{extendedRankLimit:0}),modelFilesUrl:a})}Bwi(a=null){return Object.assign(new vz,{scriptDirectory:l.AFrameworkApplication.BQ+"/intelligence/",settings:Object.assign(new Hy,{dynamicTemporaryInDocModelNGramToken:a.nGramOrder}),modelFilesUrl:a.modelFilesUrl})}}
Object(t.a)(ax,"LocalInferenceWorkerApiMain",Cu,[]);class vC extends Cu{constructor(a){super(a);l.AFrameworkApplication.QH(()=>{this.jgc()})}fya(a){k.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",a);return!1}GBa(a){k.ULS.sendTraceTag(591689870,3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",a)}jgc(){const a=Object.assign(new Pr.a,{api:3,method:6});this.vF.postMessage(a)}}Object(t.a)(vC,
"ShutdownWorkerApiMain",Cu,[]);var Du=b(784),wz=b(563);class Tt extends Pr.a{constructor(){super();this.args=null;this.numLogs=0}}Object(t.a)(Tt,"UlsWorkerMessage",Pr.a,[]);var hw=b(776),nB=b(886),vq=b(937);class oB extends nB.a{constructor(a,d,n,z,O){super(a,d,n,z,O);this.Mja=null;this.wuf=!1;if(this.GCh=this.Xsg())if(a=z.Ga("ContentBaseUrl")?6:5,z=z.Ga("AppScriptBaseName"))z=l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerScriptName",z+".{0}ulsworker.js"),
z=yD.a.Pra(z),z=l.AFrameworkApplication.Yx(z,a),hw.createWorker({createMode:"Thread"},{local:hw.paramInsideDef(vq.ulsWorkerInsideInit),LDn:hw.paramInsideDef(Object(vq.ulsWorkerInsideScript)(z))}).then(ca=>{ca.onClose=()=>{this.fyf=void 0};this.fyf=ca},ca=>{var Da=new Date;ca=`UlsWorkerDefererHost threw an error: ${this.Jwm(ca)}`;console.error(ca);Da=new wz.a(Da.getTime(),3007,545653664,10,ca,0,!1,null,null);super.kH(Da);this.wuf=!0})}Xsg(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",
!1)}get Twm(){this.Mja||(this.Mja=la.a.instance.resolve("Box4.Workers.IWebWorkerRouter"));return this.Mja}b4a(a){this.wuf=a}kH(a){if(this.wuf)super.kH(a);else if(this.GCh)null!=this.fyf&&this.fyf.call.kH(a);else{let d;(d=this.Twm).Eh.apply(d,[5,11].concat([a]))}}Jwm(a){if(null==a||"object"!==typeof a)return"unknown";const d=String(a.name),n=String(a.message);return null!=a.stack?(a=String(a.stack),0<=a.indexOf(n)&&0<=a.indexOf(d)?a:`${d}: ${n}\n${a}`):0<=n.indexOf(d)?n:`${d}: ${n}`}}Object(t.a)(oB,
"UlsWorkerDefererHost",nB.a,[]);class wC extends Cu{constructor(a){super(a);this.RXb=0;a=la.a.instance.sa("Common.IRefreshableAppSettings");this.mBb=new oB(Du.a.MDb,!0,l.AFrameworkApplication.Gd,null!==a&&void 0!==a?a:l.AFrameworkApplication.K,a);a=k.ULS.host;null!=a&&a.Lmb(this.mBb);k.ULS.gDa(this.mBb);this.fDh=Ye.a.me();this.Jok=2*l.AFrameworkApplication.K.jb("UlsWorkerStayAliveIntervalMS",6E4);this.mBb.b4a(!0)}fya(a,d){if(11!==a||!d||1!==d.length||!Object(Uc.a)(wz.a,d[0]))return!1;if(Ye.a.me()-
this.fDh>this.Jok)return this.mBb.b4a(!0),this.mBb.kH(d[0]),k.ULS.sendTraceTag(570770058,3008,15,"UlsWorkerApiMain: Haven't heard from UlsWorkerApi recently"),!1;a=Object.assign(new Tt,{api:5,method:a,args:d[0],numLogs:this.RXb});this.RXb++;this.vF.postMessage(a);return!0}GBa(a,d){void 0!==d&&null!==d&&12===a&&(this.fDh=Ye.a.me(),this.mBb.b4a(!1))}}Object(t.a)(wC,"UlsWorkerApiMain",Cu,[]);class Iy{constructor(a){this.container=a}g_k(a,d){var n=null;switch(d){case 0:n=new CD(a);break;case 1:n=new uC(a);
break;case 2:n=new uz(a,this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"));break;case 3:n=new vC(a);break;case 4:n=new ax(a,this.container.resolve("Box4.WordPrediction.IWordPredictionAugLoop"));break;case 5:d=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsWorkerIsEnabled",!1);n=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",!1);n=(d||n)&&l.AFrameworkApplication.C2a?new wC(a):
null;break;default:k.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",d)}return n}}Object(t.a)(Iy,"WordWebWorkerApiFactory",null,[231]);var pA=b(243);class Af{constructor(a,d){this.name=a;this.format=d}}Object(t.a)(Af,"ImportedScript",null,[]);class pB{constructor(){this.i0e=this.$mc=this.Utj=null}}Object(t.a)(pB,"WebWorkerConfig",null,[]);var xz=b(951);class xC{constructor(a){this.jwf=[];this.edk=a;if(l.AFrameworkApplication.K){var d=
l.AFrameworkApplication.K.ea("AppChromeOverrideIsCombinedBundle");a=l.AFrameworkApplication.K.Ga("ContentBaseUrl")?6:5;const n=l.AFrameworkApplication.K.Ga("AppScriptBaseName");if(n){d=d?"":"{0}";const z=n+`.${d}worker.js`;this.jwf.push(new Af(`MicrosoftAjaxDS.${d}js`,a),new Af(z,a));this.Xsg()&&this.jwf.push(new Af(n+`.${d}ulsworker.js`,a))}else k.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else k.ULS.sendTraceTag(558465107,
3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const a=[],d=Object.assign(new pB,{Utj:"workerboot",$mc:this.jwf,i0e:[0,1,2,3,4,5]});this.edk&&this.B$l()&&Array.add(d.$mc,new Af("intelligence/edge-inference-web.js",5));a.push(d);return a}B$l(){return(new pA.a("arrowFunction",()=>{try{Object(xz.a)("const sum = (a, b) => a + b")}catch(a){return!1}return!0},!1)).isSupported()}Xsg(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",
!1)}}Object(t.a)(xC,"WordWebWorkerConfigFactory",null,[230]);class qA{constructor(){this.va=this.Z=null}get name(){return"WordEditor.Workers"}init(){const a=this.Z.resolve("Box4.Workers.IWebWorkerRouter");a.Eh.apply(a,[0,1].concat([this.va.appSettings,l.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}Hb(a){this.Z=a;this.va=this.Z.resolve("Common.IAppSettingsManager");const d=this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);a.ha("Box4.Workers.WebWorkerRouter",
()=>new BD(new xC(d),new Iy(a))).as("Box4.Workers.IWebWorkerRouter").singleInstance();a.ha("WordEditor.Workers.LongTaskListeners",()=>new sC).as("WordEditor.Workers.ILongTaskListeners").singleInstance();a.ha("WordEditor.Workers.HangDetector",()=>new cq(a.resolve("WordEditor.Workers.ILongTaskListeners"),a.resolve("Box4.Workers.IWebWorkerRouter"))).singleInstance()}static main(){M.a.instance.Sb(new qA)}}Object(t.a)(qA,"WordEditorWorkersPackage",null,[1,2]);class Sx{constructor(){this.kde=[]}fDi(a,d){let n=
-1,z=null;z=O=>{O?d(this.kde[n]):(++n,n<this.kde.length?this.kde[n].iAc(a,z):d(null))};z(!1)}iAc(a,d){this.fDi(a,n=>{d(!!n)})}XQc(a,d,n){this.fDi(a,z=>{if(!z)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");z.XQc(a,d,n)})}aVh(a){this.kde.push(a)}}Object(t.a)(Sx,"CompositeExternalContentURLResolver",null,[443,210]);var ED=b(1252);class yz extends ED.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=null;this.Height=this.Width=0;this.IFrameHtml=
null}}Object(t.a)(yz,"ExternalContentEmbedResponse",ED.a,[]);var FD=b(1269),GD=b(1657),yC=b(1656),HD=b(1182),ID=b(649),Jy=b(671),Ky=b(217),zz=b(777),Ct;(function(a){a[a.autoCorrect=0]="autoCorrect";a[a.externalComponentPaste=1]="externalComponentPaste";a[a.externalHyperlinkPaste=2]="externalHyperlinkPaste";a[a.O1n=3]="externalContentFloatieConversion"})(Ct||(Ct={}));Object(t.b)("ExternalContentConversionContext",Ct);class Mg{constructor(){this.Xdc=this.Wdc=null;this.G0f=new HD.ExternalContentEmbedRetriever;
this.kcd=!0;this.h1c=this.kp=this.lLi=this.kLi=this.Fm=this.Xq=null;null!=Mg.oza&&Mg.oza.Evi()}get Mlc(){return this.kcd}set Mlc(a){this.kcd=a}oKf(a,d){let n=!1;if(a){switch(a.contextId){case Kb.a.Ub:n=!d;break;case Kb.a.Lc:n=!0}n&&!zz.a(a.node)&&(n=!1)}return n}Dhm(a){const d=a.startsWith(hg.HyperlinkReader.cXa),n=a.startsWith(hg.HyperlinkReader.Frb),z=a.startsWith(hg.HyperlinkReader.iic);return(d||n||z)&&hg.HyperlinkReader.oJa(a)}Ajj(){this.kp=E.a.create();Mg.Ye.U5b(this.kp,4);Mg.Ye.Nca(this.kp,
0,Mg.Ye.Fp());this.kbc(this.Wdc,3,this.Xdc,!0)}A5a(a,d,n){this.kp=E.a.create();Mg.Ye.U5b(this.kp,n?0:2);Mg.Ye.Nca(this.kp,0,Mg.Ye.Fp());this.h1c();this.kbc(a,n?0:2,d)}CQe(a,d){this.kp=E.a.create();Mg.Ye.U5b(this.kp,1);Mg.Ye.Nca(this.kp,0,Mg.Ye.Fp());this.kbc(a,1,d)}VDe(a,d,n){if(!a||!a.isConnected||!Kd.ImageReader.Xr(a))return null;const z=new ID.a;z.setValue(lh.a.zUa,n);z.setValue(lh.a.q5a,d);z.Iib=this.kLi;z.jz=this.lLi;z.upb=1===n;Dd.GraphIterator.ua(a).Re(z,2);this.FHd(z);return z}olj(a){this.h1c=
a}t7e(a,d){d=Mg.dOb.RCc(d)||0;const n=a.Width/a.Height;1<=n?(a.Width=d,a.Height=d/n):(a.Height=600,a.Width=600/n)}Ijh(a,d,n){if(null!=a&&null!=d&&!w.a.le(n)){var z=Mg.nJd.pGc(n);z.mYa=!0;z.hideFloatie=!0;this.t7e(a,d.node);this.KIc(a,d,!1,!1,z,n)}}aGb(a){return a?a.Ge:0}$fh(a,d,n,z){z=null;const O=a.node;if(!Bd.ParagraphReader.nb(O)||!O.isConnected)return{returnValue:!1,RDa:z};if(n)return{returnValue:!0,RDa:a};n=a.cpBegin;const ca=a.cpEnd,Da=Bd.ParagraphReader.text(O);if(0<=n&&ca<=Da.length&&Da.substring(n,
ca)===d)return{returnValue:!0,RDa:a};const Xa=Da.indexOf(d);return 0<=Xa?(z=fe.a.createTextRange(O,Xa,Xa+d.length),{returnValue:!0,RDa:z}):0<=n&&ca<=Da.length&&this.IHc(a)?{returnValue:!0,RDa:a}:{returnValue:!1,RDa:z}}IHc(a){if(!a||a.cpBegin>=a.cpEnd)return!1;var d=fe.a.createTextRange(a.node,a.cpBegin,a.cpEnd);d=hg.HyperlinkReader.vw(d,!1);if(1===d.length){d=d[0];const n=Bd.ParagraphReader.text(a.node).substring(d.cpBegin,d.cpEnd).trim();if(a.cpEnd===d.cpEnd&&d.hyperlink.url!==n)return!0}return!1}ntg(a){return null==
a.width&&null==a.height||null!=a.width&&null!=a.height&&0<a.width&&0<a.height?!0:!1}vLa(a,d){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea(d)&&window.setTimeout(()=>{const n=la.a.instance.Ca("Common.ISystemInitiatedFeedback");n&&n.execute(z=>{z.logActivity(a,d)})},Mg.pSa)}h8f(a,d){const n=!w.a.AU(d);switch(a){case 1:a=n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,d):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;
break;default:a=n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,d):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return a}kbc(a,d,n,z=!1){if(this.Dhm(n)){var O=Mg.nJd.pGc(n);if(O)if(this.ntg(O)){k.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");a=Object(qa.a)(fe.a,a);var ca=!d;this.oKf(a,ca)?this.BCd(n)?(d=1===d,z=this.wAl(a),O.hideFloatie=!0,this.KIc(z,
a,ca,d,O,n)):this.KNg(a,d,O,n,z):Mg.Ye.KX(this.kp,2,"URL inserted in Non-Embedable context",Mg.Ye.Fp())}else k.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),Mg.Ye.KX(this.kp,2,"Size provided is not valid for OEmbed",Mg.Ye.Fp())}else k.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),Mg.Ye.KX(this.kp,2,"URL inserted is not valid for ExternalContent",Mg.Ye.Fp())}wAl(a){let d=new yz;d.Width=Mg.dOb.RCc(a.node)||
0;d.Height=600;d.Title="Fluid Component";d.MediaType="fluid";return d}BCd(a){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=Mg.Tsa&&Mg.Tsa.SUi(a)}KNg(a,d,n,z,O){const ca=!d,Da=1===d,Xa=Mg.dOb.RCc(a.node)||0,zb=FD.a.ROf(n.bfh,!0,Xa,600);this.aHd(a,z,d,!0);this.G0f.X5h(zb,Vb=>{Mg.Ye.Nca(this.kp,4,Mg.Ye.Fp());Mg.Ye.OTd(this.kp,this.aGb(Vb.data));if(Vb=this.RNg(Vb)){k.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");
var Fc=Ky.l(Vb.MediaType);Mg.Ye.ITe(this.kp,7,Fc);Fc=a;({RDa:Fc}=this.$fh(a,z,Da,Fc)).returnValue?(this.aHd(Fc,z,d,!1),null==n.width?0<Xa&&Vb.Width>Xa&&(k.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Vb.Width=Xa):(k.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Vb.Width=this.J0d(n.width,Vb.Width,Xa)),null==n.height?600<Vb.Height&&(k.ULS.sendTraceTag(591681427,
324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Vb.Height=600):(k.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Vb.Height=this.J0d(n.height,Vb.Height,600)),Mg.oza.Ixb||O?this.KIc(Vb,Fc,ca,Da,n,z):(this.Wdc=a,this.Xdc=z,this.Zmd(z))):(k.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),
Mg.Ye.KX(this.kp,2,"No conversion as the context is no longer valid for the external content conversion",Mg.Ye.Fp()));Da&&this.nib(Fc.node)}else Da&&this.nib(a.node),Mg.Ye.KX(this.kp,1,"URL not oEmbedable",Mg.Ye.Fp())},Vb=>{Mg.Ye.Nca(this.kp,4,Mg.Ye.Fp());Mg.Ye.OTd(this.kp,this.aGb(Vb.data));Da&&this.nib(a.node);k.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Vb.data.Rd);Mg.Ye.KX(this.kp,2,"ExternalContentEmbedRequest failed",Mg.Ye.Fp())},Vb=>{Da&&this.nib(a.node);
k.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Vb)},this.kp)}J0d(a,d,n){!a&&0<n&&d>n||a>n?(k.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),d=n):a>n?d=n:a&&a<n&&(d=a);return d}KIc(a,d,n,z,O,ca){this.Fm=xa.a.create();a.Width=a.Width/a.Height*(a.Height-(Jy.a.ACe+Jy.a.bya))+2*Jy.a.bya;const Da=new Ff.GraphTransaction(15);Da.Sa(d.node);Da.om=Dc.a.A5a;const Xa=this.IHc(d);null!=O.mYa&&
!O.mYa||z||Xa||(a.Title=""===O.title||O.title?O.title:a.Title,!a.Title&&""!==a.Title)||(d=this.Pkg(d,Da,a.Title,ca,n));if(d){z&&(d=this.sVf(d));var zb=this.upe(d,z);if(zb){n=Ky.l(a.MediaType);var Vb=this.fze(a,n);this.kLi=a.IFrameHtml;this.lLi=a.Title;if(zb=this.Akg(zb,Vb,Da,z,ca,n))Da.AJa(this.Fm,1),Da.dispose(),this.Wdc=d,this.Xdc=ca,this.OKg(O,a,zb),this.uNg(ca,z||O.hideFloatie,Xa,n,a.Title)}else Da.dispose(),k.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),
Mg.Ye.KX(this.kp,2,"Could not create IP context on splitting the paragraph",Mg.Ye.Fp())}else Mg.Ye.KX(this.kp,2,"GraphNodeContext is null",Mg.Ye.Fp())}fze(a,d){const n=new dh.DictionaryPropertySet;Mg.vz.CRe(n,a.Width,a.Height);a=this.g8f(d,a.Title);n.setValue(Vd.a.imageAltText,a);n.setValue(Qb.a.$U,gf.a.HH());n.setValue(Qb.a.imageType,0);return n}Akg(a,d,n,z,O,ca){if(!a)return null;a=Mg.vz.cEe(a,d);if(!a)return n.dispose(),k.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),
Mg.Ye.KX(this.kp,2,"The anchored image could not be inserted",Mg.Ye.Fp()),null;n=a.node;O=this.VDe(n,O,ca);Mg.Ye.Qdh(this.kp,O.id);z||this.j0g(n);return n}OKg(a,d,n){w.a.AU(a.thumbnailUrl)||(d.Thumbnail=a.thumbnailUrl);d.Thumbnail&&d.Thumbnail.length&&(Mg.Ye.Nca(this.kp,8,Mg.Ye.Fp()),k.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.zre(n,d.Thumbnail))}uNg(a,d,n,z,O){d||this.Zmd(a);this.vLa("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");
this.NPe("IsHyperlinkWithNonURLDisplayText",n);this.hzc(z,O);Mg.Ye.Nca(this.kp,5,Mg.Ye.Fp())}NPe(a,d){k.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");R.a.sendTelemetryEvent(Object.assign(new ha.a,{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new ba.a,{name:a,bool:d})]}))}hzc(a,d){this.Mlc&&Mg.Au&&(a=this.h8f(a,d),Mg.Au.sendNotification(a,!0))}Pkg(a,d,n,z,O){if(O){if((O=hg.HyperlinkReader.vw(a,!1))&&1!==
O.length)return d.dispose(),k.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;Mg.hyperlinkEditor.EV(O[0].paragraph,O[0].hyperlink)}return this.BVg(a,n,z)}sVf(a){const d=a.node,n=Bd.ParagraphReader.text(d);return 0<n.length&&!n.trim().length?(a=fe.a.createTextRange(d,0,n.length),Mg.characterPropertiesEditor.replaceTextRange(a,""),fe.a.Kb(d,0)):a}upe(a,d){return d?a:this.g9f(a)}g9f(a){const d=Bd.ParagraphReader.text(a.node),
n=Dd.GraphIterator.ua(a.node);if(n.kc()){a=fe.a.Kb(a.node,a.cpEnd);qe.OutlineElementNavigator.Uc(n);const z=Mg.Pg.EIa(n);Mg.Ee.voa(n,z,a,!0,!0,!0,!0);""!=d&&Mg.Ee.BE(n,!1,!0);n.Rc();return fe.a.Kb(n.currentNode,0)}return null}RNg(a){let d;if(!({group:d}=tf.a.b9(a.data.Rd,d)).returnValue)return null;a=d.Responses[0];return a.StatusCode?null:a}BVg(a,d,n){const z=a.cpBegin+d.length;Mg.characterPropertiesEditor.replaceTextRange(a,d);a=fe.a.createTextRange(a.node,a.cpBegin,z);Mg.hyperlinkEditor.vP(a,n,
!1);return a}g8f(a,d){const n=!w.a.AU(d);switch(a){case 1:return n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,d):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,d):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}zre(a,d){a.Zg().contentReplicator.forceOutbound(()=>{this.QNg(d,
a)},()=>{k.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}FHd(a){a=Dd.GraphIterator.ua(a);a.La(12);a.tc(12);a.Hm.rI=!0}nib(a){a.nrb=null}j0g(a){a=Dd.GraphIterator.ua(a);a.La(11)&&(a.tc(11),a.kc()&&a.yg()&&a.Rc()&&Bd.ParagraphReader.nb(a.currentNode)&&(a=ye.SelectionFactory.Pc(a.currentNode,0),Lg.a.instance.setSelection(a)))}aHd(a,d,n,z){const O=a.cpBegin,ca=a.cpEnd;a=Bd.ParagraphReader.text(a.node).trim();O||a!==d&&""!==a?O?ca===a.length?
k.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Ct[n],z):0<O&&ca<a.length&&k.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Ct[n],z):k.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
Ct[n],z):k.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Ct[n],z)}Zmd(a){this.$Cc();const d=new ke.a(1,l.AFrameworkApplication.isRtl);d.YLd=a;Mg.EEb.dPd(d)}$Cc(){const a=new wd.a(!0);Mg.$Lg.iXa(a)}QNg(a,d){if(a=this.Bag(a,d))d=Array(1),d[0]=a,a=GD.a.construct(d,!1,l.AFrameworkApplication.K.ea("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Xq.Ds:null),d=this.ISf(),
this.KMb(d,a)}Bag(a,d){if(!d)return k.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.Xq=d.Zg();(new Dd.GraphIterator).set(d);if(!d.anchor||!d.anchor.Zk||!d.anchor.Zk.Dj)return k.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var n=d.anchor.Zk.Dj.node;if(!n)return k.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),
null;let z=Re.a.Do;uf.a.instance.J(4)&&(z=n.fa(bd.a.wH,Re.a.Do));n=d.getValue(Vd.a.rP);const O=rf.a.ze(Kd.ImageReader.pz(d.properties),0),ca=rf.a.ze(Kd.ImageReader.UB(d.properties),1);return yC.a.construct(d.id.toString(),a,d.fa(Vd.a.imageAltText,""),O,ca,d.fa(Qb.a.dY,""),z,d.fa(Qb.a.$U,0),d.fa(Qb.a.Cma,!1),d.fa(bd.a.Mfa,-1),d.fa(Qb.a.F6a,Box4Intl.Box4Strings.l_Picture),d.fa(Vd.a.u4,!1),n,d.fa(Qb.a.runId,1),d.fa(Qb.a.Ob,0))}KMb(a,d){l.AFrameworkApplication.Gd.Ni(a,2,x.c(d),{},!1,2,Object(m.a)(this,
this.picturePasteRequestSucceeded,"picturePasteRequestSucceeded"),Object(m.a)(this,this.SOc,"picturePasteRequestFailed"),null,void 0,void 0,void 0,void 0,"26");k.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}picturePasteRequestSucceeded(){k.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")}SOc(){k.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")}ISf(){let a=Vc.a.YEc("PicturePaste.ashx");
l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.ea("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(a=Vc.a.tl(a,Me.a.fileId,this.Xq.Ds));a=Vc.a.tl(a,Me.a.cellId,this.Xq.gl.toString());this.Fm||(this.Fm=xa.a.create(),k.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));a=Vc.a.tl(a,Me.a.t_,this.Fm.toString());a=Vc.a.tl(a,Me.a.classId,(393233).toString());this.Xq.ZG&&(a=Vc.a.tl(a,Me.a.ZG,this.Xq.ZG));a=Vc.a.tl(a,Me.a.k$a,"1");a=Vc.a.tl(a,be.a.imageType,
"0");a=Xf.a.instance.wie(a);this.Xq.contentReplicator&&this.Xq.contentReplicator.pdc&&(a=Vc.a.tl(a,Me.a.Mke,"1"));a=Vc.a.tl(a,Me.a.Vxa,this.Xq.contentReplicator.Bw.toString());a=Vc.a.tl(a,Me.a.rhc,"0");return a=Vc.a.tl(a,Me.a.vPb,"1")}static get EEb(){return Mg.e6||(Mg.e6=la.a.instance.resolve("Box4.IExternalContentFloatieEventSource"))}static get oza(){Mg.xNa||(Mg.xNa=la.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Mg.xNa}static get $Lg(){return Mg.wA||(Mg.wA=
la.a.instance.resolve("Box4.IPasteFloatieEventSource"))}static get Au(){return Mg.jk||(Mg.jk=la.a.instance.resolve("Common.Utils.IAriaNotifier"))}static get dOb(){return Mg.g0b||(Mg.g0b=la.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior"))}static get vz(){return Mg.si||(Mg.si=la.a.instance.resolve("WordEditor.IImageEditor"))}static get Pg(){return Mg.Ee||(Mg.Ee=la.a.instance.resolve("Box4.IOutlineElementEditor"))}static get hyperlinkEditor(){return Mg.lk||(Mg.lk=la.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return Mg.hc||
(Mg.hc=la.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Ye(){return Mg.BZ||(Mg.BZ=la.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler"))}static get nJd(){return Mg.E8c||(Mg.E8c=la.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}static get Tsa(){return Mg.iXb||(Mg.iXb=la.a.instance.resolve("Fluid.Host.LoopComponentManager"))}}Mg.e6=null;Mg.jk=null;Mg.g0b=null;Mg.si=null;Mg.Ee=null;Mg.lk=null;Mg.hc=null;Mg.BZ=null;Mg.E8c=null;Mg.pSa=5E3;Mg.wA=
null;Mg.xNa=null;Mg.iXb=null;Object(t.a)(Mg,"ExternalContentEditor",null,[198]);var iw=b(289),JD=b(1067);class KD{constructor(a,d){this.Ixb=!0;this.Gx=a;this.K$=d}Evi(){const a=new df.a;this.gUi()&&this.K$?this.K$.$ic(iw.a.omd).CWRCo(Object(m.a)(this,this.Lgc,"onRegisterCallback"),0).CWRCo(Object(m.a)(this,this.AWa,"onGetRequestFinished"),8):a.mf(this.Ixb)}Lgc(a){if(null!=a.result)return a.result.Value;k.ULS.sendTraceTag(556376794,324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");
return this.Ixb}AWa(a){a.Jm||a.Vh?k.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):(this.g3h(a.result),k.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));return this.Ixb}wua(a){this.K$&&this.K$.wua(iw.a.omd,new JD.a(iw.a.omd,a))}qen(a){this.gUi()&&(this.Gx.TKa("saveConvertExternalContentIsEnabled",a.toString()),k.ULS.sendTraceTag(559437386,
324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),this.g3h(a),this.wua(a))}gUi(){const a=l.AFrameworkApplication.K.ea("IsAnonymousUser");if(l.AFrameworkApplication.K.ea("IsRoamingServiceEnabled"))if(a)k.ULS.sendTraceTag(559437387,324,50,"User is anonymous ");else return!0;return!1}g3h(a){this.Ixb=a}}Object(t.a)(KD,"ExternalContentSettingInfo",null,[447]);class Bv{constructor(a,d){Bv.Nl=a;Bv.a_=d}RCc(a){if(!a)return null;var d=Bv.a_.BK(a);if(Bv.Nl.qLc(d)){a=Bv.Nl.UP(d);
const n=Bv.Nl.VP(d);d=Bv.Nl.Gt(d);if(a+n<=d)return rf.a.Rh(d-a-n,0)}return null}}Bv.Nl=null;Bv.a_=null;Object(t.a)(Bv,"ExternalContentSizeBehavior",null,[446]);var LD=b(1E3);class Ly{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(t.a)(Ly,"FluidComponentProperties",null,[]);class vE{constructor(){this.loopType=this.jz=this.Iib=this.url=null;this.mediaType=0;this.F1i=null}}Object(t.a)(vE,"IFrameProps",
null,[]);class Dl{static get dOb(){return Dl.g0b||(Dl.g0b=la.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior"))}static get vz(){return Dl.si||(Dl.si=la.a.instance.resolve("WordEditor.IImageEditor"))}static get Au(){return Dl.jk||(Dl.jk=la.a.instance.resolve("Common.Utils.IAriaNotifier"))}static get hyperlinkEditor(){return Dl.lk||(Dl.lk=la.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Pg(){return Dl.Ee||(Dl.Ee=la.a.instance.resolve("Box4.IOutlineElementEditor"))}static get characterPropertiesEditor(){return Dl.hc||
(Dl.hc=la.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static oJa(a){const d=a.startsWith(hg.HyperlinkReader.cXa),n=a.startsWith(hg.HyperlinkReader.Frb),z=a.startsWith(hg.HyperlinkReader.iic);return(d||n||z)&&hg.HyperlinkReader.oJa(a)}static oKf(a,d){let n=!1;if(a){switch(a.contextId){case Kb.a.Ub:n=!d;break;case Kb.a.Lc:n=!0}n&&!zz.a(a.node)&&(n=!1)}return n}static IHc(a){if(!a||a.cpBegin>=a.cpEnd)return!1;var d=fe.a.createTextRange(a.node,a.cpBegin,a.cpEnd);d=hg.HyperlinkReader.vw(d,!1);
if(1===d.length){d=d[0];const n=Bd.ParagraphReader.text(a.node).substring(d.cpBegin,d.cpEnd).trim();if(a.cpEnd===d.cpEnd&&d.hyperlink.url!==n)return!0}return!1}static g8f(a,d){const n=!w.a.AU(d);switch(a){case 1:return n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,d):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,
d):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static FHd(a){a=Dd.GraphIterator.ua(a);a.La(12);a.tc(12);a.Hm.rI=!0}static fze(a,d,n,z){const O=new dh.DictionaryPropertySet;Dl.vz.CRe(O,d,a);a=Dl.g8f(z,n);O.setValue(Vd.a.imageAltText,a);O.setValue(Qb.a.$U,gf.a.HH());O.setValue(Qb.a.imageType,0);return O}static VDe(a,d){if(!a||!a.isConnected||!Kd.ImageReader.Xr(a))return null;const n=new ID.a;n.setValue(lh.a.zUa,d.mediaType);n.setValue(lh.a.q5a,d.url);n.setValue(Xc.a.loopComponentType,
d.loopType);n.Iib=d.Iib;n.jz=d.jz;n.upb=1===d.mediaType;n.createMode=d.F1i;Dd.GraphIterator.ua(a).Re(n,2);Dl.FHd(n);return n}static upe(a,d){return d?a:Dl.g9f(a)}static g9f(a){const d=Bd.ParagraphReader.text(a.node),n=Dd.GraphIterator.ua(a.node);if(n.kc()){a=fe.a.Kb(a.node,a.cpEnd);qe.OutlineElementNavigator.Uc(n);const z=Dl.Pg.EIa(n);Dl.Pg.voa(n,z,a,!0,!0,!0,!0);""!=d&&Dl.Pg.BE(n,!1,!0);n.Rc();return fe.a.Kb(n.currentNode,0)}return null}static j0g(a){a=Dd.GraphIterator.ua(a);a.La(11)&&(a.tc(11),
a.kc()&&a.yg()&&a.Rc()&&Bd.ParagraphReader.nb(a.currentNode)&&(a=ye.SelectionFactory.Pc(a.currentNode,0),Lg.a.instance.setSelection(a)))}static h8f(a,d){const n=!w.a.AU(d);switch(a){case 1:a=n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,d):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:a=n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,
d):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return a}static hzc(a,d){Dl.Au&&(a=Dl.h8f(a,d),Dl.Au.sendNotification(a,!0))}static NPe(a,d,n){k.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");R.a.sendTelemetryEvent(Object.assign(new ha.a,{name:n,dataFields:[Object.assign(new ba.a,{name:a,bool:d})]}))}}Object(t.a)(Dl,"ExternalContentHelper",null,[]);class zC{constructor(){this.Fm=this.Xq=null}zre(a,d){a.Zg().contentReplicator.forceOutbound(()=>
{this.QNg(d,a)},()=>{k.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}QNg(a,d){if(a=this.Bag(a,d))d=Array(1),d[0]=a,a=GD.a.construct(d,!1,l.AFrameworkApplication.K.ea("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Xq.Ds:null),d=this.ISf(),this.KMb(d,a)}Bag(a,d){if(!d)return k.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.Xq=d.Zg();(new Dd.GraphIterator).set(d);
if(!d.anchor||!d.anchor.Zk||!d.anchor.Zk.Dj)return k.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var n=d.anchor.Zk.Dj.node;if(!n)return k.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;let z=Re.a.Do;uf.a.instance.J(4)&&(z=n.fa(bd.a.wH,Re.a.Do));n=d.getValue(Vd.a.rP);const O=rf.a.ze(Kd.ImageReader.pz(d.properties),0),ca=rf.a.ze(Kd.ImageReader.UB(d.properties),
1);return yC.a.construct(d.id.toString(),a,d.fa(Vd.a.imageAltText,""),O,ca,d.fa(Qb.a.dY,""),z,d.fa(Qb.a.$U,0),d.fa(Qb.a.Cma,!1),d.fa(bd.a.Mfa,-1),d.fa(Qb.a.F6a,Box4Intl.Box4Strings.l_Picture),d.fa(Vd.a.u4,!1),n,d.fa(Qb.a.runId,1),d.fa(Qb.a.Ob,0))}KMb(a,d){l.AFrameworkApplication.Gd.Ni(a,2,x.c(d),{},!1,2,this.picturePasteRequestSucceeded.bind(this),this.SOc.bind(this),null,void 0,void 0,void 0,void 0,"26");k.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}picturePasteRequestSucceeded(){k.ULS.sendTraceTag(592996169,
324,100,"Picture paste request for External Content succeeded")}SOc(){k.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")}ISf(){let a=Vc.a.YEc("PicturePaste.ashx");l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.ea("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(a=Vc.a.tl(a,Me.a.fileId,this.Xq.Ds));a=Vc.a.tl(a,Me.a.cellId,this.Xq.gl.toString());this.Fm||(this.Fm=xa.a.create(),k.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));
a=Vc.a.tl(a,Me.a.t_,this.Fm.toString());a=Vc.a.tl(a,Me.a.classId,(393233).toString());this.Xq.ZG&&(a=Vc.a.tl(a,Me.a.ZG,this.Xq.ZG));a=Vc.a.tl(a,Me.a.k$a,"1");a=Vc.a.tl(a,be.a.imageType,"0");a=Xf.a.instance.wie(a);this.Xq.contentReplicator&&this.Xq.contentReplicator.pdc&&(a=Vc.a.tl(a,Me.a.Mke,"1"));a=Vc.a.tl(a,Me.a.Vxa,this.Xq.contentReplicator.Bw.toString());a=Vc.a.tl(a,Me.a.rhc,"0");return a=Vc.a.tl(a,Me.a.vPb,"1")}}Object(t.a)(zC,"ExternalContentThumbnailHelper",null,[]);class Eu extends zC{constructor(){super(...arguments);
this.kp=null}static get Ye(){return Eu.BZ||(Eu.BZ=la.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler"))}SRj(a,d,n){return Dl.oJa(d)?Dl.oKf(a,n)?!0:(Eu.Ye.KX(this.kp,2,"URL inserted in Non-Embedable context",Eu.Ye.Fp()),!1):(k.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),Eu.Ye.KX(this.kp,2,"URL inserted is not valid for ExternalContent",Eu.Ye.Fp()),!1)}}Eu.BZ=null;Object(t.a)(Eu,"AbstractExternalContentEditor",zC,[198]);
class vv extends Eu{static get Tsa(){return vv.iXb||(vv.iXb=la.a.instance.resolve("Fluid.Host.LoopComponentManager"))}static get paragraphEditor(){return vv.Ki||(vv.Ki=la.a.instance.resolve("Box4.IParagraphEditor"))}T0k(a,d){d=this.Yzi(a,d);this.BNi(d,a,5)}A5a(a,d,n){this.SRj(a,d,n)&&(n=this.Yzi(a,null),n.url=d,this.BNi(n,a,2))}CQe(a,d){this.A5a(a,d,!1)}BNi(a,d,n){this.Fm=xa.a.create();const z=new Ff.GraphTransaction(15);z.Sa(d.node);z.om=Dc.a.j5l;const O=Dl.IHc(d),ca=Ky.l(a.mediaType),Da=Dl.fze(a.height,
a.width,a.title,ca);d=this.zMn(d,1==n);(d=Dl.si.cEe(d,Da))?(d=d.node,Dl.VDe(d,{url:a.url,mediaType:ca,jz:a.title,loopType:a.type,F1i:n})||k.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),z.AJa(this.Fm,1),z.dispose(),this.zre(d,a.thumbnail),this.iSm(O,ca)):k.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}zMn(a,d){Dl.characterPropertiesEditor.replaceTextRange(a,"");return Dl.upe(a,d)}iSm(a,d){Dl.NPe("IsHyperlinkWithNonURLDisplayText",
a,"Office.Word.Online.ExternalContent.FluidComponent");Dl.hzc(d,"Fluid Component")}Yzi(a,d){let n=new Ly;n.width=Dl.dOb.RCc(a.node)||0;n.height=null!=vv.Tsa&&vv.Tsa.Dxl(d)+2*Jy.a.bya||600;n.title="Fluid Component";n.mediaType="fluid";n.type=d;n.thumbnail=null!=vv.Tsa&&"https://fa000000096.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2202.14002/en-us_web/assets/fallback.jpg";n.url=null!=vv.Tsa&&"https://fa000000096.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2202.14002/en-us_web/assets/fallback.jpg";
return n}static BCd(a){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=vv.Tsa&&vv.Tsa.SUi(a)}}Object(t.a)(vv,"FluidComponentEditor",Eu,[]);class YH{constructor(){this.ITb=this.sTb=null}get ail(){return this.sTb||(this.sTb=la.a.instance.resolve("Wonca.ExternalContent.IExternalContentEditor"))}get Oue(){return this.ITb||(this.ITb=la.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor"))}fSm(a,d){a&&(vv.BCd(d)?this.Oue.A5a(a,
d,!0):this.ail.A5a(a,d,!0))}}Object(t.a)(YH,"PostHyperlinkAutoCorrectStrategy",null,[445]);class EC{iAc(a,d){d(EC.mSm.test(a))}XQc(a,d){a.startsWith("https")||(a=a.replace("http","https"));a=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",960,960,a);a=Object.assign(new yz,{OperationId:0,StatusCode:0,MediaType:"rich",
Height:960,Width:960,Thumbnail:EC.thumbnailUrl,Title:"Power BI",IFrameHtml:a});d(a)}}EC.mSm=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$","i");EC.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(t.a)(EC,"PowerBIURLResolver",null,[443,210]);class FC{constructor(a){this.pRh=a}iAc(a,d){let n=!1;try{if(FC.egm(a)){const z=this.pRh.pGc(a);n=null!=z.width&&null!=z.height&&!!z.thumbnailUrl&&!!z.title&&null!=z.mYa}}catch(z){}d(n)}XQc(a,d){var n=this.pRh.pGc(a);
a=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",n.width,n.height,a);n=Object.assign(new yz,{Height:n.height,IFrameHtml:a,
MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:n.thumbnailUrl,Title:n.title,Width:n.width});d(n)}static egm(a){for(let d of FC.$An)if(a.startsWith(d))return!0;return!1}static Afa(){return new FC(la.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}FC.$An=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(t.a)(FC,"WedgeComponentExperimentsURLResolver",null,[443,210]);var UF=b(831),XO=b(992);class VF{constructor(a,d){this.ga=a;this.ITb=
d}lb(){this.ga.Aa(Dc.a.JNi,Kb.a.Ub,this.C5l.bind(this),1028);this.ga.Aa(Dc.a.iEe,Kb.a.Ub,this.Dkg.bind(this),1028);this.ga.Aa(Dc.a.PDe,Kb.a.Ub,this.Dkg.bind(this),1028);this.ga.Aa(Dc.a.Jkg,Kb.a.Ub,this.Dkg.bind(this),1028);this.ga.Aa(Dc.a.rXi,Kb.a.Ub,this.LYj.bind(this),1028)}C5l(){return 32}Dkg(a,d,n){if(!XO.a.qRi())return 2;if(1===n){if(!d.Cj||!Qd.SelectionEditor.Cd(d))return 2;if(d&&d.node&&zz.a(d.node))return 32}else if(2===n)return this.ITb.T0k(d,VF.vAl(a)),32;return 2}LYj(){return 32}static vAl(a){switch(a){case Dc.a.iEe:return UF.a.TaskAssignment;
case Dc.a.PDe:return UF.a.CheckList;case Dc.a.Jkg:return UF.a.Poll;default:return null}}}Object(t.a)(VF,"FluidComponentsActor",null,[]);class Dj extends Eu{constructor(){super();this.Xdc=this.Wdc=null;this.G0f=new HD.ExternalContentEmbedRetriever;this.h1c=null;null!=Dj.oza&&Dj.oza.Evi()}Ajj(){this.kp=E.a.create();Dj.Ye.U5b(this.kp,4);Dj.Ye.Nca(this.kp,0,Dj.Ye.Fp());this.kbc(this.Wdc,3,this.Xdc,!0)}A5a(a,d,n){this.kp=E.a.create();Dj.Ye.U5b(this.kp,n?0:2);Dj.Ye.Nca(this.kp,0,Dj.Ye.Fp());this.h1c();
this.kbc(a,n?0:2,d)}CQe(a,d){this.kp=E.a.create();Dj.Ye.U5b(this.kp,1);Dj.Ye.Nca(this.kp,0,Dj.Ye.Fp());this.kbc(a,1,d)}olj(a){this.h1c=a}t7e(a,d){d=Dj.dOb.RCc(d)||0;const n=a.Width/a.Height;1<=n?(a.Width=d,a.Height=d/n):(a.Height=600,a.Width=600/n)}Ijh(a,d,n){if(null!=a&&null!=d&&!w.a.le(n)){var z=Dj.nJd.pGc(n);z.mYa=!0;z.hideFloatie=!0;this.t7e(a,d.node);this.KIc(a,d,!1,!1,z,n)}}aGb(a){return a?a.Ge:0}$fh(a,d,n,z){z=null;const O=a.node;if(!Bd.ParagraphReader.nb(O)||!O.isConnected)return{returnValue:!1,
RDa:z};if(n)return{returnValue:!0,RDa:a};n=a.cpBegin;const ca=a.cpEnd,Da=Bd.ParagraphReader.text(O);if(0<=n&&ca<=Da.length&&Da.substring(n,ca)===d)return{returnValue:!0,RDa:a};const Xa=Da.indexOf(d);return 0<=Xa?(z=fe.a.createTextRange(O,Xa,Xa+d.length),{returnValue:!0,RDa:z}):0<=n&&ca<=Da.length&&Dl.IHc(a)?{returnValue:!0,RDa:a}:{returnValue:!1,RDa:z}}ntg(a){return null==a.width&&null==a.height||null!=a.width&&null!=a.height&&0<a.width&&0<a.height?!0:!1}vLa(a,d){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea(d)&&
window.setTimeout(()=>{const n=la.a.instance.Ca("Common.ISystemInitiatedFeedback");n&&n.execute(z=>{z.logActivity(a,d)})},Dj.pSa)}kbc(a,d,n,z=!1){if(this.SRj(a,n,!d)){var O=Dj.nJd.pGc(n);O&&(this.ntg(O)?(k.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),this.KNg(a,d,O,n,z)):(k.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),Dj.Ye.KX(this.kp,2,"Size provided is not valid for OEmbed",Dj.Ye.Fp())))}}KNg(a,d,
n,z,O){const ca=!d,Da=1===d,Xa=Dj.dOb.RCc(a.node)||0,zb=FD.a.ROf(n.bfh,!0,Xa,600);this.aHd(a,z,d,!0);this.G0f.X5h(zb,Vb=>{Dj.Ye.Nca(this.kp,4,Dj.Ye.Fp());Dj.Ye.OTd(this.kp,this.aGb(Vb.data));if(Vb=this.RNg(Vb)){k.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var Fc=Ky.l(Vb.MediaType);Dj.Ye.ITe(this.kp,7,Fc);Fc=a;({RDa:Fc}=this.$fh(a,z,Da,Fc)).returnValue?(this.aHd(Fc,z,d,!1),null==n.width?0<Xa&&Vb.Width>Xa&&(k.ULS.sendTraceTag(591681426,
324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Vb.Width=Xa):(k.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Vb.Width=this.J0d(n.width,Vb.Width,Xa)),null==n.height?600<Vb.Height&&(k.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Vb.Height=600):(k.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),
Vb.Height=this.J0d(n.height,Vb.Height,600)),Dj.oza.Ixb||O?this.KIc(Vb,Fc,ca,Da,n,z):(this.Wdc=a,this.Xdc=z,this.Zmd(z))):(k.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),Dj.Ye.KX(this.kp,2,"No conversion as the context is no longer valid for the external content conversion",Dj.Ye.Fp()));Da&&this.nib(Fc.node)}else Da&&this.nib(a.node),Dj.Ye.KX(this.kp,1,"URL not oEmbedable",Dj.Ye.Fp())},Vb=>{Dj.Ye.Nca(this.kp,
4,Dj.Ye.Fp());Dj.Ye.OTd(this.kp,this.aGb(Vb.data));Da&&this.nib(a.node);k.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Vb.data.Rd);Dj.Ye.KX(this.kp,2,"ExternalContentEmbedRequest failed",Dj.Ye.Fp())},Vb=>{Da&&this.nib(a.node);k.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Vb)},this.kp)}J0d(a,d,n){!a&&0<n&&d>n||a>n?(k.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),
d=n):a>n?d=n:a&&a<n&&(d=a);return d}KIc(a,d,n,z,O,ca){this.Fm=xa.a.create();a.Width=a.Width/a.Height*(a.Height-(Jy.a.ACe+Jy.a.bya))+2*Jy.a.bya;const Da=new Ff.GraphTransaction(15);Da.Sa(d.node);Da.om=Dc.a.A5a;const Xa=Dl.IHc(d);null!=O.mYa&&!O.mYa||z||Xa||(a.Title=""===O.title||O.title?O.title:a.Title,!a.Title&&""!==a.Title)||(d=this.Pkg(d,Da,a.Title,ca,n));if(d){z&&(d=this.sVf(d));var zb=Dl.upe(d,z);if(zb){n=Ky.l(a.MediaType);var Vb=Dl.fze(a.Height,a.Width,a.Title,n);(zb=this.Akg(zb,Vb,z,{url:ca,
Iib:a.IFrameHtml,jz:a.Title,mediaType:n}))?(Da.AJa(this.Fm,1),Da.dispose(),this.Wdc=d,this.Xdc=ca,this.OKg(O,a,zb),this.uNg(ca,z||O.hideFloatie,Xa,n,a.Title)):Da.dispose()}else Da.dispose(),k.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),Dj.Ye.KX(this.kp,2,"Could not create IP context on splitting the paragraph",Dj.Ye.Fp())}else Dj.Ye.KX(this.kp,2,"GraphNodeContext is null",Dj.Ye.Fp())}Akg(a,d,n,z){if(!a)return null;
a=Dj.vz.cEe(a,d);if(!a)return k.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),Dj.Ye.KX(this.kp,2,"The anchored image could not be inserted",Dj.Ye.Fp()),null;a=a.node;z=Dl.VDe(a,z);Dj.Ye.Qdh(this.kp,z.id);n||Dl.j0g(a);return a}OKg(a,d,n){w.a.AU(a.thumbnailUrl)||(d.Thumbnail=a.thumbnailUrl);d.Thumbnail&&d.Thumbnail.length&&(Dj.Ye.Nca(this.kp,8,Dj.Ye.Fp()),k.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),
this.zre(n,d.Thumbnail))}uNg(a,d,n,z,O){d||this.Zmd(a);this.vLa("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");Dl.NPe("IsHyperlinkWithNonURLDisplayText",n,"Office.Word.Online.ExternalContent.OEmbedInsertions");Dl.hzc(z,O);Dj.Ye.Nca(this.kp,5,Dj.Ye.Fp())}Pkg(a,d,n,z,O){if(O){if((O=hg.HyperlinkReader.vw(a,!1))&&1!==O.length)return d.dispose(),k.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;Dl.hyperlinkEditor.EV(O[0].paragraph,
O[0].hyperlink)}return this.BVg(a,n,z)}sVf(a){const d=a.node,n=Bd.ParagraphReader.text(d);return 0<n.length&&!n.trim().length?(a=fe.a.createTextRange(d,0,n.length),Dl.characterPropertiesEditor.replaceTextRange(a,""),fe.a.Kb(d,0)):a}RNg(a){let d;if(!({group:d}=tf.a.b9(a.data.Rd,d)).returnValue)return null;a=d.Responses[0];return a.StatusCode?null:a}BVg(a,d,n){const z=a.cpBegin+d.length;Dl.characterPropertiesEditor.replaceTextRange(a,d);a=fe.a.createTextRange(a.node,a.cpBegin,z);Dl.hyperlinkEditor.vP(a,
n,!1);return a}nib(a){a.nrb=null}aHd(a,d,n,z){const O=a.cpBegin,ca=a.cpEnd;a=Bd.ParagraphReader.text(a.node).trim();O||a!==d&&""!==a?O?ca===a.length?k.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Ct[n],z):0<O&&ca<a.length&&k.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
Ct[n],z):k.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Ct[n],z):k.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Ct[n],z)}Zmd(a){this.$Cc();const d=new ke.a(1,l.AFrameworkApplication.isRtl);d.YLd=a;Dj.EEb.dPd(d)}$Cc(){const a=
new wd.a(!0);Dj.$Lg.iXa(a)}static get EEb(){return Dj.e6||(Dj.e6=la.a.instance.resolve("Box4.IExternalContentFloatieEventSource"))}static get oza(){Dj.xNa||(Dj.xNa=la.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Dj.xNa}static get $Lg(){return Dj.wA||(Dj.wA=la.a.instance.resolve("Box4.IPasteFloatieEventSource"))}static get dOb(){return Dj.g0b||(Dj.g0b=la.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior"))}static get vz(){return Dj.si||
(Dj.si=la.a.instance.resolve("WordEditor.IImageEditor"))}static get nJd(){return Dj.E8c||(Dj.E8c=la.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}Dj.e6=null;Dj.g0b=null;Dj.si=null;Dj.E8c=null;Dj.pSa=5E3;Dj.wA=null;Dj.xNa=null;Object(t.a)(Dj,"ExternalContentEditorV2",Eu,[]);class WF{constructor(){this.Ja=this.Z=null}get name(){return"WordEditor.ExternalContent"}get Ka(){return this.Ja?this.Ja:this.Ja=this.Z.resolve("Box4.IFeatureHelper")}Hb(a){this.Z=a;a.ha("WordEditor.ExternalContent.ExternalContentSizeBehavior",
()=>new Bv(jq.a.instance,Zt.WordSectionNavigator.instance)).as("WordEditor.ExternalContent.IExternalContentSizeBehavior").singleInstance();a.ha("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new YH).as("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy").singleInstance();a.ha("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new KD(a.resolve("Box4.IRoamingServiceRequestManager"),a.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.ExternalContent.IExternalContentSettingInfo").singleInstance();
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(a.ha("WordEditor.ExternalContent.ExternalContentEditorV2",()=>new Dj).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance(),a.ha("WordEditor.ExternalContent.FluidComponentEditor",()=>new vv).singleInstance(),a.ha("WordEditor.ExternalContent.FluidComponentsActor",()=>new VF(l.AFrameworkApplication.pa,a.resolve("WordEditor.ExternalContent.FluidComponentEditor"))).singleInstance()):a.ha("WordEditor.ExternalContent.ExternalContentEditor",
()=>new Mg).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance()}init(){this.Ka.tk.continueWith(()=>{this.Po()});l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&this.Z.resolve("WordEditor.ExternalContent.FluidComponentsActor").lb()}dispose(){}M0k(){const a=new Sx;this.$ji()&&a.aVh(FC.Afa());a.aVh(new EC);return a}Po(){null==l.AFrameworkApplication.K||l.AFrameworkApplication.K.ea("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.Z.ha("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",
()=>new LD.a).as("WordEditor.ExternalContent.IOEmbedOverridesURLParser").singleInstance();this.$ji()&&(this.Z.ha("WordEditor.ExternalContent.IWordExternalContentURLResolver",()=>this.M0k()).as("WordEditor.ExternalContent.IWordExternalContentURLResolver").singleInstance(),this.Z.resolve("WordEditor.ExternalContent.IWordExternalContentURLResolver"))}$ji(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",!1)}static main(){M.a.instance.Sb(new WF)}}
Object(t.a)(WF,"ExternalContentPackage",null,[1,2]);var TA;(function(a){a[a.invalid=-1]="invalid";a[a.clear=0]="clear";a[a.left=1]="left";a[a.start=2]="start";a[a.center=3]="center";a[a.right=4]="right";a[a.end=5]="end";a[a.decimal=6]="decimal";a[a.h_n=7]="bar";a[a.$sa=8]="num"})(TA||(TA={}));Object(t.b)("TabStopValues",TA);class xp{}xp.afi=8;xp.M7k=1;xp.G_="wwaengidc";xp.kpiName="WordRuler";xp.precision=.0625;xp.ZBn=1;xp.IQn="ShowHideRuler";Object(t.a)(xp,"Constants",null,[]);var ZH=b(370),wE=b(695);
class At{static JGc(a,d){if(!At.sEd)return null;switch(a){case "Left":return n=>{const z=n.rulerCanvasProps;n=n.indents;return{lec:0,$jc:z.scale-(z.margins[1].value+n[2].value+Math.max(n[0].value,n[1].value)+8*z.precision)}};case "Right":return n=>{const z=n.rulerCanvasProps;n=n.indents;return{lec:0,$jc:z.scale-(n[2].value+(z.margins[0].value+Math.max(n[0].value,n[1].value))+8*z.precision)}};case "MoveTableColumn":return()=>{let n=0,z=0;if(0===d){var O={};32===At.Tb.ob(Mb.a.Cic,2,O)&&(n=Wf.a.qC(O.MinIndent),
z=Wf.a.qC(O.MaxIndent))}else O={Yp:d-1},32===At.Tb.ob(Mb.a.Bic,2,O)&&(n=Wf.a.qC(O.MinResize),z=Wf.a.qC(O.MaxResize));return{lec:n,$jc:z}};case "Top":return n=>{n=n.rulerCanvasProps;return{lec:0,$jc:n.scale-(n.margins[1].value+8*n.precision)}};case "Bottom":return n=>{n=n.rulerCanvasProps;return{lec:0,$jc:n.scale-(n.margins[0].value+8*n.precision)}}}return null}static Aze(a){if(!At.sEd)return null;switch(a){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return d=>{var n=d.rulerCanvasProps,
z=d.indents,O=d.ipContextIndex;d=n.margins;var ca=n.scale;n=n.precision;if("MoveTableColumn"!==d[0].type){O=d[0].value;d=d[1].value+z[2].value;var Da=O;"LeftIndent"===a&&(Da+=Math.max(z[0].value,z[1].value));z=-1*O;n=ca-(Da+d+8*n)}else{ca=0;for(Da=0;Da<=O;Da++)ca+=d[Da].value;Da=0;if("LeftIndent"===a){Da=z[0].value;const Xa=z[1].value;ca+=Math.max(Da,Xa);Da=Math.max(Da,Xa)}d=d[O+1].value;Da+=z[2].value;z=-1*ca;n=d-Da-n}return{lec:z,$jc:n}};case "RightIndent":return d=>{var n=d.rulerCanvasProps,z=
d.indents,O=d.ipContextIndex,ca=n.margins;d=n.scale;n=n.precision;if("MoveTableColumn"!==ca[0].type){var Da=ca[0].value;ca=ca[1].value;O=z[0].value;var Xa=z[1].value;z=-1*ca;d-=Da+ca+Math.max(O,Xa)+8*n}else{Da=0;for(Xa=0;Xa<=O;Xa++)Da+=ca[Xa].value;ca=ca[O+1].value;O=z[0].value;Xa=z[1].value;z=-1*(d-Da-ca);d=ca-Math.max(O,Xa)-n}return{lec:z,$jc:d}}}return null}static hNl(){return a=>{var d=a.rulerCanvasProps,n=a.indents,z=a.ipContextIndex,O=d.margins;a=d.precision;d=d.scale;"MoveTableColumn"!==O[0].type?
(z=O[0].value,O=O[1].value+n[2].value,n=Math.min(n[0].value,n[1].value)+a,a=d-(z+O+a)):(d=n[2].value,O=O[z+1].value,n=Math.min(n[0].value,n[1].value)+a,a=O-(d+a));return{lec:n,$jc:a}}}static get Tb(){return At.ga||(At.ga=l.AFrameworkApplication.pa)}static get sEd(){null==this.nzb&&(l.AFrameworkApplication.y0("WoRul910;WoRul910cf"),this.nzb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):!1);return this.nzb}}
At.nzb=null;Object(t.a)(At,"RulerPropertyBoundaryHelper",null,[]);var YO=b(1048),xE;(function(a){a[a.appChromeReady=0]="appChromeReady";a[a.appChromeLazyReady=1]="appChromeLazyReady"})(xE||(xE={}));Object(t.b)("WoncaAppChromeState",xE);const $H=a=>{xh.c()?a():k.ULS.sendTraceTag(51393038,340,10,"appChrome is not defined.")},yE=(a,d)=>{const n=la.a.instance.sa("Wonca.IWoncaAppChromeStateManager");n?n.Ik(a,()=>{$H(d)}):$H(d)};var ZO=b(1083),$O=b(1084);class $z{constructor(a,d,n,z,O,ca){this.PMm="OutlineContainer";
this.crk="UpdateCustomTabFailed";this.EZb="ReadRulerPropertiesFailed";this.grk="UpdateIndentFailed";this.hRh="UpdateMarginFailed";this.Ek=a;this.Ouc=d;this.ga=n;this.qtf=z;this.JJ=O;this.l6=ca;this.rsc=null;this.uv=!!l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.T7}wD(){this.RBf();this.dVh();this.Ouc.Cm.Oe(10).tq(Object(m.a)(this,this.AKd,"onOutlinePropertyChanged"));Qc.a.addHandler(this.hzf,vb.a.scroll,Object(m.a)(this,this.VPj,"updateRulerLocationOnScroll"));this.Ek.execute(d=>{d.pha(Object(m.a)(this,
this.ju,"onZoomChanged"))});const a=[this.jag(),document.getElementById(og.AppFrame.EPb),document.getElementById("PageContentContainer")];this.rsc?this.rsc.register(a,Object(m.a)(this,this.DZa,"updateRulerLocation")):yE(xE.appChromeLazyReady,()=>{appChrome.getResizeObserver().then(d=>{this.rsc=d.createResizeObserver();this.rsc.register(a,Object(m.a)(this,this.DZa,"updateRulerLocation"));return null})});Lb.App.oa.Di.registerBoundingWindowRectsChanged("documentPanel",(d,n)=>{"undefined"!==n&&this.Lvb([1,
0])})}jag(){return 1===this.l6.XG?this.Sik:this.vik}get hzf(){return document.getElementById(og.AppFrame.VDa)}get vik(){const a=document.getElementsByClassName(this.PMm);return a&&0<a.length?a[0]:null}get Sik(){var a=this.JJ.f8b;if(!a)return null;a=this.Gfn(Bd.ParagraphReader.gH(a));return YO.a.DBi(a)}Gfn(a){return 0<a?document.querySelector("div.PagesContainer p[paraid='"+a+"']"):null}IOe(a){a.button===Sys.UI.MouseButton.rightButton&&this.qtf.show(new Sys.UI.Point(a.clientX,a.clientY),2)}VPj(){this.DZa()}get KT(){return this.Ek&&
this.Ek.instance?this.Ek.instance.Ei:xp.M7k}bGc(){const a={};return 32!==this.ga.ob(Mb.a.qKa,2,a)?(k.ULS.sendTraceTag(529065947,ZO.a.msoulscat_Wac_WordRuler,$O.a.warning,"Unable to read page properties for Ruler"),Wl.recordQosError(this.EZb,[Wl.Qpa],"Unable to read page properties for Ruler"),null):a}dispose(){this.cKi();this.Ouc.Cm.Oe(10).W0(Object(m.a)(this,this.AKd,"onOutlinePropertyChanged"));Qc.a.removeHandler(this.hzf,vb.a.scroll,Object(m.a)(this,this.VPj,"updateRulerLocationOnScroll"));this.Ek.execute(a=>
{a.XLb(Object(m.a)(this,this.ju,"onZoomChanged"))});this.rsc&&this.rsc.dispose();Lb.App.oa.Di.unregisterBoundingWindowRectsChanged("documentPanel",(a,d)=>{"undefined"!==d&&this.Lvb([1,0])})}get QSi(){null==$z.Kjf&&($z.Kjf=l.AFrameworkApplication.K?l.AFrameworkApplication.K.ea("SharedUXThemingIsEnabled")&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&l.AFrameworkApplication.K.ea("RulerThemingIsEnabled"):!1);return $z.Kjf}}$z.Kjf=null;Object(t.a)($z,
"ARuler",null,[415]);class Mt extends $z{constructor(a,d,n,z,O,ca,Da){super(a,d,n,O,ca,Da);this.gca="HorizontalRuler";this.oXj="CustomTabModificationFromRuler";this.rYj="IndentModificationFromRuler";this.F6e="MarginModificationFromRuler";this.azh=this.$yh=this._tabStops=null;if(ZH.a.isSharedUxGateEnabled("WordOnline.ChangeGate.DelayLoadUISlice20InRuler"))this.ika=z;else{const Xa=z();this.ika=()=>Xa}this.Uw={}}get l4(){return this.$yh}get vUa(){return this.azh}renderRuler(){this.l4.classList.remove("HideWACHorizontalRulerContainer");
this.l4.classList.add("ShowWACHorizontalRulerContainer");var a=this.bGc();if(a){var d=Object(m.a)(this,this.YHg,"onMarginChange"),n=Object(m.a)(this,this.mGm,"onIndentChange"),z=Object(m.a)(this,this.kEm,"onCustomTabChange"),O=this.pZd(),ca=this.oLj(),Da=this.nLj();O&&ca&&Da||(this.Uw.disabled=!0);this.Uw.onIndentChange=n;this.Uw.onMarginChange=d;this.Uw.onTabChange=z;this.DZa();a=rf.a.Rh(a.iq,0);this.vUa.style.width=(a*this.KT).toString()+"px";return this.ika().then(Xa=>{Xa.renderRuler(this.vUa,
this.Uw)})}}kEm(a,d,n){if(!(a>=this._tabStops.length)){a=this._tabStops[a];var z="Modify"===n?this.ga.ob(Dc.a.GMc,2,{["tabStop"]:a,["value"]:Wf.a.xE(d)}):this.ga.ob(Dc.a.jsb,2,a);if(32===z){d=1;var O=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",n,TA[a.zoa]);k.ULS.sendTraceTag(591213271,3014,50,O)}else d=0,O=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",n,TA[a.zoa]),k.ULS.sendTraceTag(591213272,3014,15,O),Wl.recordQosError(this.crk,
[Wl.Qpa],"Unable to modify custom tab using ruler");we.a(this.oXj,32===z,void 0,[Object.assign(new ba.a,{name:"Operation",string:n}),Object.assign(new ba.a,{name:"TabType",int64:TA[a.zoa]})]);n=new Map;n.set("Command","OnCustomTabChange");n.set("Source",this.gca);n.set("Response",O);ja.Health.instance.recordKpiUsage(xp.kpiName,d,xp.G_,n)}}nLj(){const a=[];var d={};if(32!==this.ga.ob(Dc.a.mic,2,d))return k.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),Wl.recordQosError(this.EZb,
[Wl.Qpa],"Unable to read paragraph tabs for Ruler"),!1;var n=d.customTabs;if(!n||0>=n.length)return this.Uw.tabs=a,!0;this._tabStops=n;d="";for(let z of n){switch(z.zoa){case 1:d="LeftTab";break;case 4:d="RightTab";break;case 3:d="CenterTab";break;case 6:d="DecimalTab";break;case 7:d="BarTab"}n=rf.a.oCa(z.BYa,0);a.push({["type"]:d,["value"]:n,["getRulerPropertyBoundary"]:At.hNl()})}this.Uw.tabs=a;return!0}Lvb(a){if(this.l4){this.l4.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.Uw&&
delete this.Uw.disabled;for(let d of a)switch(d){case 0:a=this.oLj();const n=this.nLj();a&&n||(this.Uw.disabled=!0);break;case 1:this.pZd()||(this.Uw.disabled=!0)}this.ika().then(d=>{d.renderRuler(this.vUa,this.Uw);return null})}}pZd(){const a={};var d=this.bGc();if(!d)return!1;a.scale=Wf.a.qC(d.iq);a.precision=xp.precision;a.rulerType="Horizontal";if(!this.LLm())return this.Uw.ipContextIndex=0,this.Uw.permittedUnits=xp.afi,d=[{["type"]:"Left",["value"]:Wf.a.qC(d.marginLeft),["getRulerPropertyBoundary"]:At.JGc("Left",
0)},{["type"]:"Right",["value"]:Wf.a.qC(d.marginRight),["getRulerPropertyBoundary"]:At.JGc("Right",1)}],a.margins=d,this.Uw.rulerCanvasProps=a,!0;var n={};d={};var z=this.ga.ob(Mb.a.XPc,2,n);const O=this.ga.ob(Mb.a.vLb,2,d);if(32!==z||32!==O)return k.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),Wl.recordQosError(this.EZb,[Wl.Qpa],"Unable to read table properties for Ruler"),!1;n=n.ColumnWidths;z=d.TablePosition;if(!z||!n||0>=n.length)return k.ULS.sendTraceTag(589632533,
3014,15,"Cannot show table properties on the ruler as they are null"),Wl.recordQosError(this.EZb,[Wl.Qpa],"Cannot show table properties on the ruler as they are null"),!1;d=Array(n.length+1);d[0]={["type"]:"MoveTableColumn",["value"]:Wf.a.qC(z.x/this.KT),["getRulerPropertyBoundary"]:At.JGc("MoveTableColumn",0)};for(z=0;z<n.length;z+=1)d[z+1]={["type"]:"MoveTableColumn",["value"]:Wf.a.qC(n[z]),["getRulerPropertyBoundary"]:At.JGc("MoveTableColumn",z+1)};this.Uw.ipContextIndex=this.bQl();this.Uw.permittedUnits=
xp.ZBn;a.margins=d;this.Uw.rulerCanvasProps=a;return!0}oLj(){var a={};if(32!==this.ga.ob(Mb.a.a8a,2,a))return k.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),Wl.recordQosError(this.EZb,[Wl.Qpa],"Unable to read paragraph indentation for Ruler"),!1;const d={type:"FirstLineIndent"};d.getRulerPropertyBoundary=At.Aze("FirstLineIndent");const n={type:"HangingIndent"};n.getRulerPropertyBoundary=At.Aze("HangingIndent");const z={type:"RightIndent"};z.getRulerPropertyBoundary=
At.Aze("RightIndent");const O={type:"LeftIndent"};O.getRulerPropertyBoundary=At.Aze("LeftIndent");this.Uw.rtl=a.isRtl;a=a.fu;d.value=1===a.specialIndentType?Wf.a.qC(a.uoa+a.yE):2===a.specialIndentType?Wf.a.qC(a.yE-a.uoa):Wf.a.qC(a.yE);n.value=Wf.a.qC(a.yE);O.value=Wf.a.qC(a.yE);z.value=Wf.a.qC(a.sAa);this.Uw.indents=[d,n,z,O];return!0}mGm(a,d){var n=new wE.a;n.unit=1;n.value=Wf.a.xE(d);d=8;switch(a){case "FirstLineIndent":d=this.ga.ob(Mb.a.ASc,2,n);break;case "HangingIndent":d=this.ga.ob(Mb.a.BSc,
2,n);break;case "LeftIndent":d=this.ga.ob(Mb.a.u5a,2,n);break;case "RightIndent":d=this.ga.ob(Mb.a.t5a,2,n)}let z;32===d?(n=1,z=String.format("Indents set using Ruler. Indent: {0}",a),k.ULS.sendTraceTag(592517017,3014,50,z)):(n=0,z=String.format("Unable to set indent using Ruler. Indent: {0}",a),k.ULS.sendTraceTag(592496523,3014,15,z,a),Wl.recordQosError(this.grk,[Wl.Qpa],"Unable to set indent using Ruler."));we.a(this.rYj,32===d,void 0,[Object.assign(new ba.a,{name:"Type",string:a})]);a=new Map;
a.set("Command","OnIndentChange");a.set("Source",this.gca);a.set("Response",z);ja.Health.instance.recordKpiUsage(xp.kpiName,n,xp.G_,a)}dVh(){Qc.a.addHandler(this.l4,vb.a.Mq,Object(m.a)(this,this.IOe,"onRulerMouseDown"))}cKi(){this.l4.classList.remove("ShowWACHorizontalRulerContainer");this.l4.classList.add("HideWACHorizontalRulerContainer");Qc.a.removeHandler(this.l4,vb.a.Mq,Object(m.a)(this,this.IOe,"onRulerMouseDown"));this.ika().then(a=>{a.dispose(this.vUa);return null})}YHg(a,d,n){let z;z="Left"===
a?this.ga.ob(Mb.a.ioa,2,Wf.a.xE(d)):"Right"===a?this.ga.ob(Mb.a.V8a,2,Wf.a.xE(d)):n?this.ga.ob(Mb.a.JXd,2,{["columnIndex"]:n-1,["width"]:Wf.a.xE(d)}):this.ga.ob(Mb.a.vlc,2,Wf.a.xE(d));32===z?(d=1,n=String.format("Margins set using Ruler. Margin: {0}",a),k.ULS.sendTraceTag(592517018,3014,50,n)):(d=0,n=String.format("Unable to set margins using Ruler. Margin: {0}",a),k.ULS.sendTraceTag(592496524,3014,15,n),Wl.recordQosError(this.hRh,[Wl.Qpa],"Unable to set margins using Ruler."));we.a(this.F6e,32===
z,void 0,[Object.assign(new ba.a,{name:"Type",string:a})]);a=new Map;a.set("Command","OnMarginChange");a.set("Source",this.gca);a.set("Response",n);ja.Health.instance.recordKpiUsage(xp.kpiName,d,xp.G_,a)}ju(){this.XPj();this.DZa();this.Lvb([1,0])}AKd(a,d){a=d.property;if(a===Qb.a.iq||a===Qb.a.marginLeft||a===Qb.a.marginRight)this.XPj(),this.DZa(),this.Lvb([1])}XPj(){var a=this.bGc();a&&(a=rf.a.Rh(a.iq,0),this.vUa.style.width=Math.round(a*this.KT).toString()+"px")}DZa(){window.requestAnimationFrame(()=>
{var a=this.jag();a&&(a=Ye.a.getElementBounds(a),l.AFrameworkApplication.isRtl?this.vUa.style.marginRight=(window.document.documentElement.clientWidth-a.x-a.width).toString()+"px":this.vUa.style.marginLeft=a.x.toString()+"px")})}bQl(){const a=Dd.GraphIterator.ua(this.JJ.f8b);if(a.La(14))return a.tc(16),Vr.a(a,!0);k.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");Wl.recordQosError(this.EZb,[Wl.Qpa],"Unable to read table column index for Ruler");return 0}LLm(){let a=
!0;const d=this.JJ.Ba.zy();if(null===d)return k.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),Wl.recordQosError(this.EZb,[Wl.Qpa],"Unable to get Context Iterator for the Ruler"),!1;for(;d.moveNext()&&a;){const n=Dd.GraphIterator.ua(d.current.node);n.kc();a=a&&If.TableReader.Pv(n)}return a}RBf(){if(!this.vUa&&!this.l4){this.$yh=document.createElement("div");this.l4.id=Mt.Rak;this.l4.className=Mt.Qak;this.l4.setAttribute(pd.a.Vka,WordEditorIntl.WordEditorStrings.L_Ruler);
this.l4.setAttribute(pd.a.ig,pd.a.RFf);this.l4.classList.add("HideWACHorizontalRulerContainer");if(this.QSi){var a=l.AFrameworkApplication.K.Ga("ModernUxExperimentPreferenceCookieName");const d=l.AFrameworkApplication.K.ea("ModernUxExperimentDefaultOffIsEnabled");Fa.a.SHa(a,!d)&&this.l4.classList.add(Mt.cgk)}this.azh=document.createElement("div");this.vUa.className=Mt.Pak;this.vUa.id=Mt.Sak;this.l4.appendChild(this.vUa);a=null;this.uv&&((a=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedLayout",
!1)?Lb.App.oa.Di.getRegion("EditorBars"):Lb.App.oa.Di.getRegion(Lb.App.oa.Di.BV.J("Ruler")))&&a.appendChild(this.l4),this.l4.classList.add("regionComposer"));a||(a=document.getElementById(og.AppFrame.EPb),a.insertBefore(this.l4,a.firstChild))}}static FF(){return new Mt(la.a.instance.Ca("Common.IZoomManager"),Lb.App.jj,l.AFrameworkApplication.pa,xk.UISurfaces.ybg,la.a.instance.resolve("WordEditor.IRulerContextMenu"),Qs.a.instance,la.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return Mt.na||
(Mt.na=Mt.FF())}}Mt.Rak="WACHorizontalRulerContainer";Mt.Qak="WACHorizontalRulerContainer";Mt.Sak="WACHorizontalRuler";Mt.Pak="WACHorizontalRuler";Mt.cgk="ModernUxWACHorizontalRulerContainer";Mt.na=null;Object(t.a)(Mt,"HorizontalRuler",$z,[]);var XF=b(848);class Nt extends $z{constructor(a,d,n,z,O,ca,Da){super(a,d,n,O,ca,Da);this.gca="VerticalRuler";this.F6e="MarginModificationFromRuler";this.QRh=this.PRh=null;if(ZH.a.isSharedUxGateEnabled("WordOnline.ChangeGate.DelayLoadUISlice20InRuler"))this.ika=
z;else{const Xa=z();this.ika=()=>Xa}this.Uw={}}get Hda(){return this.PRh}get RZa(){return this.QRh}renderRuler(){ae.a.gv(this.Hda,"HideWACVerticalRulerContainer");ae.a.uf(this.Hda,"ShowWACVerticalRulerContainer");var a=this.bGc();if(a){var d=Object(m.a)(this,this.YHg,"onMarginChange");this.pZd()||(this.Uw.disabled=!0);this.Uw.onMarginChange=d;this.DZa();a=rf.a.Rh(a.My,1);this.RZa.style.height=(a*this.KT).toString()+"px";this.ika().then(n=>{n.renderRuler(this.RZa,this.Uw);return null})}}Lvb(a){if(this.Hda){ae.a.uf(this.Hda,
"ShowWACVerticalRulerContainer");"disabled"in this.Uw&&delete this.Uw.disabled;for(let d of a)switch(d){case 1:this.pZd()?this.DZa():this.Uw.disabled=!0}this.ika().then(d=>{d.renderRuler(this.RZa,this.Uw);return null})}}pZd(){const a={},d=this.bGc();if(!d)return!1;a.scale=Wf.a.qC(d.My);a.precision=xp.precision;a.rulerType="Vertical";this.Uw.ipContextIndex=0;this.Uw.permittedUnits=xp.afi;a.margins=[{["type"]:"Top",["value"]:Wf.a.qC(d.marginTop),["getRulerPropertyBoundary"]:At.JGc("Top",0)},{["type"]:"Bottom",
["value"]:Wf.a.qC(d.marginBottom),["getRulerPropertyBoundary"]:At.JGc("Bottom",1)}];this.Uw.rulerCanvasProps=a;return!0}dVh(){this.RBf();Qc.a.addHandler(this.Hda,vb.a.Mq,Object(m.a)(this,this.IOe,"onRulerMouseDown"))}cKi(){ae.a.gv(this.Hda,"ShowWACVerticalRulerContainer");ae.a.uf(this.Hda,"HideWACVerticalRulerContainer");Qc.a.removeHandler(this.Hda,vb.a.Mq,Object(m.a)(this,this.IOe,"onRulerMouseDown"));this.ika().then(a=>{a.dispose(this.RZa);return null})}YHg(a,d){let n=8;"Top"===a?n=this.ga.ob(Mb.a.W8a,
2,Wf.a.xE(d)):"Bottom"===a&&(n=this.ga.ob(Mb.a.U8a,2,Wf.a.xE(d)));let z;32===n?(d=1,z=String.format("Margins set using Ruler. Margin: {0}",a),k.ULS.sendTraceTag(529065945,3014,50,z)):(d=0,z=String.format("Unable to set margins using Ruler. Margin: {0}",a),k.ULS.sendTraceTag(529065946,3014,15,z),Wl.recordQosError(this.hRh,[Wl.Qpa],"Unable to set margins using Ruler."));we.a(this.F6e,32===n,void 0,[Object.assign(new ba.a,{name:"Type",string:a})]);a=new Map;a.set("Command","OnMarginChange");a.set("Source",
this.gca);a.set("Response",z);ja.Health.instance.recordKpiUsage(xp.kpiName,d,xp.G_,a)}ju(){this.UPj();this.DZa();this.Lvb([1])}AKd(a,d){a=d.property;if(a===Qb.a.My||a===Qb.a.marginTop||a===Qb.a.marginBottom)this.UPj(),this.DZa(),this.Lvb([1])}UPj(){var a=this.bGc();a&&(a=rf.a.Rh(a.My,1),this.RZa.style.height=Math.round(a*this.KT).toString()+"px")}DZa(){window.requestAnimationFrame(()=>{var a=this.jag();if(a){const d=Ye.a.getElementBounds(a);this.RZa.style.height=d.height.toString()+"px";a=this.zRl(a);
this.RZa.style.marginTop=a+"px"}})}zRl(a){a=a.getBoundingClientRect().y;let d=this.hzf.getBoundingClientRect().y;return a-d}RBf(){if(!this.RZa&&!this.Hda){this.PRh=document.createElement("div");this.Hda.id=Nt.Srk;this.Hda.className=Nt.Rrk;this.Hda.setAttribute(pd.a.Vka,WordEditorIntl.WordEditorStrings.L_Ruler);this.Hda.setAttribute(pd.a.ig,pd.a.RFf);Sys.UI.DomElement.addCssClass(this.Hda,"HideWACVerticalRulerContainer");if(this.QSi){var a=l.AFrameworkApplication.K.Ga("ModernUxExperimentPreferenceCookieName");
const d=l.AFrameworkApplication.K.ea("ModernUxExperimentDefaultOffIsEnabled");Fa.a.SHa(a,!d)&&Sys.UI.DomElement.addCssClass(this.Hda,Nt.dgk)}this.QRh=document.createElement("div");this.RZa.className=Nt.Qrk;this.RZa.id=Nt.Trk;this.Hda.appendChild(this.RZa);a=document.getElementById(og.AppFrame.EPb);a.insertBefore(this.Hda,a.firstChild)}}static FF(){return new Nt(la.a.instance.Ca("Common.IZoomManager"),Lb.App.jj,l.AFrameworkApplication.pa,xk.UISurfaces.ybg,la.a.instance.resolve("WordEditor.IRulerContextMenu"),
Qs.a.instance,la.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return Nt.na||(Nt.na=Nt.FF())}}Nt.Srk="WACVerticalRulerContainer";Nt.Rrk="WACVerticalRulerContainer";Nt.Trk="WACVerticalRuler";Nt.Qrk="WACVerticalRuler";Nt.dgk="ModernUxWACVerticalRulerContainer";Nt.na=null;Object(t.a)(Nt,"VerticalRuler",$z,[]);class Wl{constructor(a,d,n,z,O,ca,Da,Xa,zb){this.bhf=this.ljf=!1;this.gca="RulerActor";this.wMh=null;this.bBa=!1;this.Y4j="ClearAllTabStopsFailed";this.dOh="ShowHideRulerFailed";
this.Rkf=null;this.ga=a;this.Syb=d;this.Yyf=n;this.$pc=z;this.qtf=O;this.rtf=ca;Wl.Nl=Xa;this.q0a=Da;this.l6=zb;this.q0a.HWh(Object(m.a)(this,this.XJi,"headerFooterOpenedEvent"));this.q0a.Fie(Object(m.a)(this,this.U$b,"headerFooterDismissedEvent"))}initialize(){this.lb();this.wMh=Object(m.a)(this,this.Edn,"rulerOn");window.addEventListener("TurnRulerOnAction",this.wMh,!0);return this.rtf.gNl().continueWith(Object(m.a)(this,this.u2l,"initRulerRoamingSettingOptions"),8)}lb(){this.ga.ma(Mb.a.VNb,Kb.a.view,
Object(m.a)(this,this.VNb,"showHideRuler"));this.ga.Aa(Mb.a.wOd,Kb.a.view,Object(m.a)(this,this.wOd,"queryRulerToggle"),96);this.ga.ma(Dc.a.NGf,Kb.a.view,Object(m.a)(this,this.zAd,"insertCustomTabStopRuler"));this.ga.ma(Dc.a.YKf,Kb.a.view,Object(m.a)(this,this.zAd,"insertCustomTabStopRuler"));this.ga.ma(Dc.a.Pme,Kb.a.view,Object(m.a)(this,this.Pme,"clearAllTabStops"));this.ga.ma(Dc.a.uUf,Kb.a.view,Object(m.a)(this,this.zAd,"insertCustomTabStopRuler"));this.ga.ma(Dc.a.Fyd,Kb.a.view,Object(m.a)(this,
this.Fyd,"hideRuler"));this.ga.ma(Dc.a.gvg,Kb.a.view,Object(m.a)(this,this.zAd,"insertCustomTabStopRuler"));this.ga.ma(Dc.a.ZXg,Kb.a.view,Object(m.a)(this,this.zAd,"insertCustomTabStopRuler"));XF.a.Zc.addHandler(XF.a.rOe,this.bLd.bind(this));this.l6.Ayc(this.WJg)}bNi(){this.bBa&&(this.Syb.wD(),this.Syb.renderRuler(),this.QHe()&&this.upj())}upj(){this.Yyf.wD();this.Yyf.renderRuler()}yXf(){this.Yyf.dispose()}QHe(){return this.MVi()&&this.isPaginatedView()}MVi(){null==this.Rkf&&null!=l.AFrameworkApplication.K&&
(this.Rkf=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VerticalRulerEnabled",!1));return this.Rkf}p2e(){this.bBa||la.a.instance.Ca("Common.ISystemInitiatedFeedback").execute(a=>{a.logActivity("TurnRulerOnActivity",null)})}BU(){this.q0a.Z7m(Object(m.a)(this,this.XJi,"headerFooterOpenedEvent"));this.q0a.Doj(Object(m.a)(this,this.U$b,"headerFooterDismissedEvent"));this.bBa&&(this.Syb.dispose(),this.QHe()&&this.yXf())}Pme(a,d,n){if(1===n)return 32;a=this.ga.processAction(Dc.a.djc,
2,null);32===a?(n=1,d=String.format("Clear all tab stops from ruler"),k.ULS.sendTraceTag(591213266,3014,50,d)):(n=0,d=String.format("Unable to clear all tab stop from ruler"),k.ULS.sendTraceTag(591213267,3014,15,d),Wl.recordQosError(this.Y4j,[Wl.Qpa],d));const z=new Map;z.set("Command","ClearAllTabStops");z.set("Source",this.gca);z.set("Response",d);ja.Health.instance.recordKpiUsage(xp.kpiName,n,xp.G_,z);return a}zAd(a,d,n){if(1===n)switch(a){case Dc.a.NGf:case Dc.a.uUf:return 2;default:return 32}d=
this.qtf.ZLl();switch(a){case Dc.a.gvg:var z=1;break;case Dc.a.ZXg:z=4;break;case Dc.a.YKf:z=3;break;default:return k.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),2}a=new ry.a(d,z,0,1);a=this.ga.ob(Dc.a.HTd,2,a);32===a?(n=1,d=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",TA[z],d.toString()),k.ULS.sendTraceTag(591213269,3014,50,d)):(n=0,d=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",TA[z],d.toString()),k.ULS.sendTraceTag(591213270,
3014,15,d));z=new Map;z.set("Command","InsertCustomTabStopRuler");z.set("Source",this.gca);z.set("Response",d);ja.Health.instance.recordKpiUsage(xp.kpiName,n,xp.G_,z);return a}VNb(a,d,n,z,O){return this.ljf?8:this.bBa?this.Fyd(a,d,n,z,O):this.Vvn(d,n)}Edn(){this.bBa?k.ULS.sendTraceTag(574128526,3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),32!==this.ga.processAction(Mb.a.VNb,2)?(k.ULS.sendTraceTag(574128527,3014,50,"Ruler could not be enabled"),
Wl.recordQosError(this.dOh,[Wl.Qpa],"Ruler could not be enabled")):k.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))}WPj(){if(this.$pc){const a={};a[xp.IQn]="ToggleButtonModel";this.$pc.jF(a)}}Vvn(a,d){if(!Wl.Nl.kIa(a.Am))return k.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),Wl.recordQosError(this.dOh,[Wl.Qpa],"Cannot show ruler. Word Section Node not found."),8;if(1===d)return 32;this.bBa=!0;this.rtf.ntj(!0);this.bNi();this.WPj();
k.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");a=new Map;a.set("Command","ShowRuler");a.set("Source",this.gca);a.set("Response","");ja.Health.instance.recordKpiUsage(xp.kpiName,1,xp.G_,a);return 32}Fyd(a,d,n){if(1===n||!this.bBa)return 32;this.bBa=!1;this.rtf.ntj(!1);this.Syb.dispose();this.QHe()&&this.yXf();this.WPj();k.ULS.sendTraceTag(593351623,3014,50,"Ruler is disabled");a=new Map;a.set("Command","HideRuler");a.set("Source",this.gca);a.set("Response","");ja.Health.instance.recordKpiUsage(xp.kpiName,
1,xp.G_,a);return 32}isPaginatedView(){return 1===this.l6.XG}bLd(a,d){switch(d.documentMode){case "View":this.bBa&&(this.ga.processAction(Mb.a.VNb,2),this.bhf=!0);break;case "Edit":this.bhf&&(this.ga.processAction(Mb.a.VNb,2),this.bhf=!1)}}WJg(a,d){if(Wl.instance.bBa&&Wl.instance.MVi())switch(d.Mfc){case 1:Wl.instance.upj();break;case 0:Wl.instance.yXf()}}wOd(a,d,n,z,O){if(1===n)return 32;O&&(O[Yf.a.On]=this.bBa);return 32}u2l(a){this.bBa=a.result}U$b(){this.ljf=!1}XJi(){this.ljf=!0}static recordQosError(a,
d,n){const z=Object.assign(new Sg.a,{extendedProperties:new Map});n&&z.extendedProperties.set("exception",n);ja.Health.instance.recordQosError(a,d,!1,!0,!1,!1,z)}static FF(){return new Wl(l.AFrameworkApplication.pa,Mt.instance,Nt.instance,Lb.App.oa,la.a.instance.resolve("WordEditor.IRulerContextMenu"),la.a.instance.sa("WordEditor.Ruler.IRulerSettingInfo"),la.a.instance.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),jq.a.instance,la.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return Wl.na||
(Wl.na=Wl.FF())}}Wl.na=null;Wl.Nl=null;Wl.Qpa="RulerInteractionFailed";Object(t.a)(Wl,"RulerActor",null,[]);class aI{constructor(a,d){this.hbd=null;this.Gx=a;this.K$=d}gNl(){const a=new df.a;if(null==this.hbd){if(this.jUi())return this.K$.$ic(iw.a.nSd).CWRCo(Object(m.a)(this,this.Lgc,"onRegisterCallback"),0).CWRCo(Object(m.a)(this,this.AWa,"onGetRequestFinished"),8);a.mf(!1)}else a.mf(this.hbd);return a.task}Lgc(a){return a.result?a.result.Value.toString():""}wua(a){this.K$.wua(iw.a.nSd,new JD.a(iw.a.nSd,
a))}ntj(a){this.jUi()&&(this.Gx.TKa("saveRulerIsEnabled",a.toString()),k.ULS.sendTraceTag(591541276,3014,50,"Try to save ruler settings value to Roaming Service."));this.wua(a)}jUi(){const a=l.AFrameworkApplication.K.ea("IsAnonymousUser");if(l.AFrameworkApplication.K.ea("IsRoamingServiceEnabled"))if(a)k.ULS.sendTraceTag(591541277,3014,50,"User is anonymous ");else return!0;return!1}AWa(a){a.Jm||a.Vh?(k.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),
this.hbd=!1):(a=a.result,""===a&&l.AFrameworkApplication.K&&(a=l.AFrameworkApplication.K.Ga("RulerDefaultOn")),this.hbd="true"===a.toLowerCase(),k.ULS.sendTraceTag(591541279,3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully."));return this.hbd}}Object(t.a)(aI,"RulerSettingInfo",null,[275]);class bI{constructor(){this.Zzh=this.Z=null}get name(){return"WordEditor.Ruler"}Hb(a){this.Z=a;k.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.Z.ha("WordEditor.Ruler.RulerSettingInfo",
()=>new aI(this.Z.resolve("Box4.IRoamingServiceRequestManager"),this.Z.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.Ruler.IRulerSettingInfo").singleInstance();this.Z.resolve("Box4.IFeatureHelper").tk.continueWith(()=>{this.Po()});this.Zzh=Wl.instance.initialize();k.ULS.sendTraceTag(578110852,3014,50,"Word ruler package is initialized")}Po(){this.Zzh.continueWith(()=>{Wl.instance.bNi();Wl.instance.p2e()});k.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){Wl.instance.BU();
k.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}Object(t.a)(bI,"PackageManager",null,[1,2]);class cI{constructor(){this.yIc=this.ygd=null}}Object(t.a)(cI,"CreatePickerCustomizationDictionaryOptions",null,[897]);class YF{}YF.Lf="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(t.a)(YF,"InsertMediaM365DialogHtml",
null,[]);class dI{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le,Ve){this.MRb=null;this.oog=this.N9d=!1;this.g9c=z;this.ebe=O;this.D8d=Da;this.gAh=Xa;this.g$=zb;this.ga=a;this.l8d=ca;this.TBh=yd;this.M7d=Le;this.dzb=n;this.utc=Vb;this.hAh=Fc;this.iAh=Ve;(this.nZ=Yc)&&this.nZ.isFeatureEnabled("MsoPremiumStockImages",!1).catch(gg=>k.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",gg)).then(gg=>{(this.N9d=
gg)||this.nZ.oXa("MsoPremiumStockImages",()=>{this.N9d=!0;k.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});return null})}lb(){(this.dzb.npg||this.dzb.YRi)&&this.dzb.Gbm&&this.dTm();this.u3m();this.ga.Aa(Mb.a.hLf,Kb.a.view,Object(m.a)(this,this.FCj,"showInsertPictureFromHostDialog"),1284);this.ga.Aa(Mb.a.RPg,Kb.a.view,Object(m.a)(this,this.$Ln,"updateEntryPointsForChangePictureHostButton"),1124);this.ga.Aa(Mb.a.$De,Kb.a.view,Object(m.a)(this,
this.FCj,"showInsertPictureFromHostDialog"),1284);this.ga.Aa(Mb.a.ySe,Kb.a.view,Object(m.a)(this,this.XLn,"updateEntryPoints"),1124);this.ga.Aa(Mb.a.MNi,Kb.a.view,Object(m.a)(this,this.lvn,"showInsertOneDriveFileDialog"),1284)}u3m(){this.ga.Aa(Mb.a.insertOnlinePicture,Kb.a.view,Object(m.a)(this,this.DZe,"showInsertPictureFromSearchDialog"),1284);this.ga.Aa(Mb.a.DAd,Kb.a.view,Object(m.a)(this,this.AZe,"showInsertM365PictureFromSearchDialog"),1284);this.ga.Fta("word_insertOnlinePictures",!0,Mb.a.insertOnlinePicture,
Kb.a.view,Object(m.a)(this,this.DZe,"showInsertPictureFromSearchDialog"),a=>{Lb.App.oa.zVc(a,Object(m.a)(new gk.a,(new gk.a).tFc,"getCommandById"))});this.ga.Fta("word_insertOnlinePictures",!0,Mb.a.DAd,Kb.a.view,Object(m.a)(this,this.AZe,"showInsertM365PictureFromSearchDialog"),a=>{Lb.App.oa.zVc(a,Object(m.a)(new gk.a,(new gk.a).tFc,"getCommandById"))});this.ga.Aa(Mb.a.nme,Kb.a.view,Object(m.a)(this,this.DZe,"showInsertPictureFromSearchDialog"),1284);this.ga.Aa(Mb.a.ome,Kb.a.view,Object(m.a)(this,
this.EZe,"showInsertPictureFromSharedPicker"),1284);this.ga.Fta("word_insertOnlinePictures",!0,Mb.a.ome,Kb.a.view,Object(m.a)(this,this.EZe,"showInsertPictureFromSharedPicker"));this.ga.Aa(Mb.a.pme,Kb.a.view,Object(m.a)(this,this.AZe,"showInsertM365PictureFromSearchDialog"),1284);this.ga.Aa(Mb.a.PPg,Kb.a.view,Object(m.a)(this,this.YLn,"updateEntryPointsForChangePictureFromBingPicture"),1284);this.ga.Aa(Mb.a.QPg,Kb.a.view,Object(m.a)(this,this.ZLn,"updateEntryPointsForChangePictureFromOnlineM365Picture"),
1284);this.ga.Fta("word_insertOnlinePictures",!0,Mb.a.nme,Kb.a.view,Object(m.a)(this,this.DZe,"showInsertPictureFromSearchDialog"));this.ga.Fta("word_insertOnlinePictures",!0,Mb.a.pme,Kb.a.view,Object(m.a)(this,this.AZe,"showInsertM365PictureFromSearchDialog"));this.ga.Aa(Mb.a.aEe,Kb.a.view,Object(m.a)(this,this.EZe,"showInsertPictureFromSharedPicker"),1284);this.ga.Fta("word_insertOnlinePictures",!0,Mb.a.aEe,Kb.a.view,Object(m.a)(this,this.EZe,"showInsertPictureFromSharedPicker"),a=>{Lb.App.oa.zVc(a,
Object(m.a)(new gk.a,(new gk.a).tFc,"getCommandById"))})}dTm(){l.AFrameworkApplication.la.get_element().appendChild(this.ebe.tkb);Qc.a.addHandler(this.ebe.tkb.contentWindow,"message",Object(m.a)(this,this.RCj,"showOneDriveFilePickerDialog"));this.oog=!0}RCj(a){if(a.rawEvent&&(a=a.rawEvent.data))try{const d=Sys.Serialization.JavaScriptSerializer.deserialize(a,!0),n=d.MessageId?d.MessageId.toString():null;d&&n&&(n===D.a.insertImage||n===D.a.TDe)&&this.g9c.start(n===D.a.insertImage?this.utc:this.hAh)}catch(d){}}XLn(a,
d,n,z,O){if(1===n)return 32;this.TBh?a=CommonUIStrings.l_OneDriveName:""!==this.M7d?a=this.M7d:(a=CommonUIStrings.l_HostGeneric,k.ULS.sendTraceTag(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));O[rg.a.LabelText]=a;return 32}$Ln(a,d,n,z,O){if(1===n)return 32;if(!l.AFrameworkApplication.WFe())return O[rg.a.Visible]=!1,32;this.TBh?a=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.M7d?a=String.format(CommonUIStrings.l_ChangePictureFromHost,
this.M7d):(a=CommonUIStrings.l_ChangePictureFromHostGeneric,k.ULS.sendTraceTag(577835747,352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));O[rg.a.LabelText]=a;return 32}YLn(a,d,n,z,O){if(1===n)return 32;l.AFrameworkApplication.K.ea("InsertOnlinePictureEnabled")||(O[rg.a.Visible]=!1);return 32}ZLn(a,d,n,z,O){if(1===n)return 32;l.AFrameworkApplication.K.ea("InsertPictureUsingStockImagesIsEnabled")||(O[rg.a.Visible]=!1);return 32}DZe(a,
d,n){d=this.l8d.value.KGa(d);if(1===n)return d&&this.dzb.Fbm?32:8;if(2!==n||!d)return 8;this.MRb=xa.a.create();k.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");a=this.pDl(a,this.MRb);a=this.D8d.Wud(a);a.correlationId=this.MRb;a.QIc=this.iAh;a.Ysa=1;return this.CZe(a,CommonUIStrings.L_PictureInsertTitle,this.utc)}pDl(a,d){let n=0;l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb&&5===l.AFrameworkApplication.la.eb.Bm&&(n=12);const z=Ih.a.yf(l.AFrameworkApplication.lcid);
return String.format(l.AFrameworkApplication.K.appSettings.WordInsertPictureServiceEndpoint,a===Mb.a.insertOnlinePicture?1:0,l.AFrameworkApplication.lcid,z?z.name:"en-us",l.AFrameworkApplication.buildVersion,d,n,l.AFrameworkApplication.K.Ga("UserId"))}lvn(a,d,n){a=32===this.ga.rf(d,Mb.a.insertHyperlink,1,!1,null,null);if(1===n)return a&&this.dzb.YRi?32:8;if(2!==n||!a)return 8;k.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.CZe(this.gAh.getInstance(),
Box4Intl.Box4Strings.l_InsertOneDriveFile,this.hAh)}FCj(a,d,n){a=this.l8d.value.KGa(d);if(1===n)return a&&this.dzb.npg?32:8;if(2!==n||!a)return 8;k.ULS.sendTraceTag(17838539,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");return this.CZe(this.gAh.getInstance(),CommonUIStrings.L_PictureInsertTitle,this.utc)}CZe(a,d,n){try{return a.BZe(d,n),k.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),
32}catch(z){return k.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",z.toString()),this.jq(tl.a.noPictureSpecified,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}AZe(a,d,n){d=this.l8d.value.KGa(d);if(1===n)return d&&this.dzb.Hbm?32:8;if(2!==n||!d)return 8;k.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");this.MRb=xa.a.create();n=l.AFrameworkApplication.K.ea("StockImagesFreemiumExperienceIsEnabled")&&
this.nZ.isFreemiumUpsellEnabled();n=this.N9d?1:n?0:-1;a=this.yFl(a,this.MRb,n);a=this.D8d.Wud(a);a.Lf=YF.Lf;a.correlationId=this.MRb;a.Ysa=2;a.QIc=this.iAh;a.q2a=this.nZ;a.lRj=n;return this.CZe(a,CommonUIStrings.L_PictureInsertTitle,this.utc)}yFl(a,d,n){return Mb.a.DAd===a?this.g$.m2h(l.AFrameworkApplication.K.Ga("InsertOnlineM365PictureEndpoint"),d.toString(),1,n):this.g$.m2h(l.AFrameworkApplication.K.Ga("InsertOnlineM365PictureEndpoint"),d.toString(),0,n)}jq(a,d,n){const z=new $g.StandardDialog(!0);
z.Hq=l.AFrameworkApplication.kY;z.wc=0;z.ee(1,CommonUIStrings.l_DialogClose);z.aw(a,d,n,()=>{})}EZe(a,d,n){d=this.l8d.value.KGa(d);a=la.a.instance.sa("Common.App.SharedFilePicker.ISharedFilePicker");if(1===n)return d&&!this.dzb.npg&&a&&a.DUi()?32:8;if(2!==n||!d||!a)return 8;k.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");this.MRb=xa.a.create();n=ll.Jrk;d=new cI;d.yIc=!0;n=a.dci(CommonUIStrings.L_ImageUploadButtonText,"Select Images",!0,!1,
!0,n,"Insert Media",1,d);a.gxi(n).then(z=>{if(null!=z&&0<z.length){const O=[];for(let ca=0;ca<z.length;ca++){const Da=z[ca][G.a.Bej],Xa=z[ca][G.a.zej],zb={};zb.Extension=Da;zb.OriginalUrl=Xa;zb.caption=Da;O.push(zb)}this.utc.Tnb=Mb.a.hfa;this.utc.VGb(O)}});return 32}dispose(){this.oog&&this.ebe.tkb.contentWindow&&(Qc.a.removeHandler(this.ebe.tkb.contentWindow,"message",Object(m.a)(this,this.RCj,"showOneDriveFilePickerDialog")),this.oog=!1)}}Object(t.a)(dI,"InsertMediaActor",null,[12]);var GC=b(850);
class eI extends GC.a{constructor(a,d){super(a,Vc.a.aga(d))}Nt(a,d){this.isEnabled()&&this.Tgb(this.Pub)&&(this.ax(a),this.uD(a,d))}}Object(t.a)(eI,"InsertMediaCrossDocumentMessenger",GC.a,[450,74,12]);class fI{getInstance(a,d){return new eI(a,d)}}Object(t.a)(fI,"InsertMediaCrossDocumentMessengerFactory",null,[424]);var aP=b(928);class zE{}zE.Lf="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(t.a)(zE,"InsertMediaDialogHtml",null,[]);var HC;(function(a){a[a.OK=0]="OK";a[a.cancel=1]="cancel";a[a.error=2]="error";a[a.open=3]="open"})(HC||(HC={}));Object(t.b)("HubbleAction",HC);var UA;(function(a){a[a.unknown=0]="unknown";a[a.bing=1]="bing";a[a.M365=2]="M365";a[a.icons=3]="icons";a[a.oneDrive=4]="oneDrive";a[a.hubble=5]="hubble"})(UA||(UA={}));Object(t.b)("InsertMediaProviders",UA);class AE extends xg.a{constructor(a,d,n,z=null,O=!1){super(!1,!1,O);this.qL=null;this.m1c=!1;this.zHd=
this.f8=null;this.BJf="KeepFocusDiv";this.yle="KeepFocusStartDiv";this.correlationId=null;this.Ysa=0;this.q2a=this.QIc=null;this.lRj=0;this.jmf=null;if(!a)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.E8d=a;this.Wrc="";this.g$=n;this.Rpa=[];this.fce=d;this.Lf=z||zE.Lf;this.Je="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}BZe(a,d){this.Wrc=a;this.m1c=!1;this.showDialog(this.Wrc,null);this.f8=this.CFc(this.Kg("insertmediaframe"));
if(!this.f8)throw this.USa(this.sRa),Error.invalidOperation("Couldn't get InsertMediaIframe.");a=document.createElement("div");a.setAttribute("Id",this.yle);a.setAttribute("tabindex","0");a.setAttribute("position","absolute");a.setAttribute("width","-1000px");a.setAttribute("top","-1000px");this.f8.parentNode.insertBefore(a,this.f8.parentNode.firstChild);a=document.createElement("div");a.setAttribute("Id",this.BJf);a.setAttribute("tabindex","0");this.f8.parentNode.appendChild(a);a.setAttribute("position",
"absolute");a.setAttribute("width","-1000px");a.setAttribute("top","10000px");$addHandler(this.Sod,"keydown",Object(m.a)(this,this.yY,"keyDownHandler"));this.f8.src=this.E8d;this.f8.style.width="100%";this.f8.style.height="100%";this.f8.frameBorder="0";l.AFrameworkApplication.K.ea("ShowInsertMediaIframeWhenIframeIsReady")&&I.a.Og?(this.f8.style.visibility="hidden",this.zHd=Object(m.a)(this,this.vGm,"onInsertMediaIframeLoaded"),Qc.a.addHandler(this.f8,"load",this.zHd)):this.f8.style.visibility="visible";
this.CFc(this.Kg("WACDialogButtonPanel")).style.display="none";this.CFc(this.Kg("WACDialogTitleText")).style.display="none";2===this.Ysa&&(this.CFc(this.Kg("WACDialogTitlePanel")).style.display="none",this.CFc(this.Kg("WACDialogBodyPanel")).style.padding="0");ic.FocusManager.instance().rk().scope.uK=!0;this.qL=this.fce.getInstance(this.f8.contentWindow,this.E8d);this.qL.Nt(D.a.hBf,n=>{this.e8i(n,Object(m.a)(d,d.VGb,"insertMediaCallback"))});this.qL.Nt(D.a.insert,n=>{this.cOe(n,Object(m.a)(d,d.VGb,
"insertMediaCallback"))});this.qL.Nt(D.a.OUh,n=>{this.HHm(n)});this.qL.Nt(D.a.A7f,Object(m.a)(this,this.E9i,"onGetCustomHeaders"));this.qL.Nt(D.a.getSessionId,Object(m.a)(this,this.H9i,"onGetSessionId"));this.qL.Nt(D.a.Y5f,Object(m.a)(this,this.D9i,"onGetCID"));this.qL.Nt(D.a.Njd,Object(m.a)(this,this.M8i,"onCancelDialog"));2!==this.Ysa||this.lRj||(this.qL.Nt(D.a.cXi,Object(m.a)(this,this.PGm,"onLaunchM365Upsell")),this.jmf=this.q2a.oXa("MsoPremiumStockImages",n=>{k.ULS.sendTraceTag(577249664,352,
50,"OnCompleteM365Upsell: upsell completed from stock images");this.qL.Eh(D.a.JQj,{["LicenseTier"]:n.toString()})}));this.LMb(3)}vGm(){this.f8&&(this.f8.style.visibility="visible",window.setTimeout(()=>{if(this.ff){const a=this.ff.getElementById(this.yle);a&&a.focus()}},0))}yY(a){a.keyCode===Sys.UI.Key.tab&&(a.target.id!==this.BJf||a.shiftKey?a.target.id===this.yle&&a.shiftKey&&(a.preventDefault(),this.ff.getElementById(this.BJf).focus()):(a.preventDefault(),this.ff.getElementById(this.yle).focus()))}dispose(){this.q2a&&
this.jmf&&this.q2a.vQc("MsoPremiumStockImages",this.jmf);this.qL&&(this.qL.dispose(),this.qL=null);this.zHd&&(Qc.a.removeHandler(this.f8,"load",this.zHd),this.zHd=null);super.dispose()}e8i(a,d){k.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");if(a=this.g$.jPm(a))this.Rpa.push(a),this.m1c&&(d(this.Rpa),this.m1c=!1)}jq(){const a=new $g.StandardDialog(!0);a.Hq=l.AFrameworkApplication.kY;a.wc=0;a.ee(1,CommonUIStrings.l_DialogOk);a.iu(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,
2,()=>{})}M8i(){k.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.USa(this.sRa);this.LMb(1)}LMb(a){var d=RegExp("hubble","gi");if(this.QIc&&0<this.QIc.search(d)&&this.correlationId){d=l.AFrameworkApplication.sessionStartInfoSettings;var n={};n.InsertedFiles=this.Rpa.length;n.MediaDetails=this.Rpa;n.DialogResult=HC[a];n.DialogMode=this.e$f();n.CorrelationId="{"+this.correlationId.toString()+"}";n.Platform="Wac";n.Provider=UA[this.Ysa]||"Unknown";n.AudienceGroup=d&&"AudienceGroup"in
d?d.AudienceGroup.toString():"Unknown";n.Ring=d&&"Ring"in d?d.Ring.toString():"Unknown";n.AppId=2;n.Build=l.AFrameworkApplication.buildVersion;n.Locale=Ih.a.yf(l.AFrameworkApplication.lcid).name;this.iTm().send(JSON.stringify(n))}2===this.Ysa&&(n=l.AFrameworkApplication.K.Ga("InsertMediaDialogAriaTenantNameSpace"))&&""!==n&&(d=[],Array.add(d,Object.assign(new ba.a,{name:"InsertedFiles",int64:this.Rpa.length})),Array.add(d,Object.assign(new ba.a,{name:"MediaDetails",string:JSON.stringify(this.Rpa)})),
Array.add(d,Object.assign(new ba.a,{name:"DialogResult",string:HC[a]})),Array.add(d,Object.assign(new ba.a,{name:"DialogMode",string:this.e$f()})),Array.add(d,Object.assign(new ba.a,{name:"CorrelationId",string:this.correlationId.toString()})),Array.add(d,Object.assign(new ba.a,{name:"Provider",string:UA[this.Ysa]||"Unknown"})),R.a.sendTelemetryEvent(Object.assign(new ha.a,{name:String.format("{0}.{1}",n,this.telemetryEventName),dataFields:d})))}e$f(){return 3===this.Ysa?"Icons":5===this.Ysa?"ExternalContent":
"Images"}CFc(a){const d=document.getElementById(a);if(!d)throw Error.invalidOperation(String.format("Couldn't get {0}.",a));return d}iTm(){const a=new XMLHttpRequest;a.open("POST",this.QIc,!0);a.setRequestHeader("Content-Type","");return a}cOe(a,d){k.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.USa(this.sRa);d?this.Rpa&&50<this.Rpa.length?(this.jq(),this.LMb(0),k.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.Rpa.length,UA[this.Ysa])):
this.Rpa&&0<this.Rpa.length?(d(this.Rpa),this.LMb(0),k.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.Rpa.length,UA[this.Ysa])):(k.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.m1c=!0,d(this.Rpa),this.LMb(2)):this.LMb(2)}E9i(){this.qL&&(k.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.qL.Eh(D.a.Ewj,{["CustomHeaders"]:""}))}H9i(){this.qL&&(k.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),
this.qL.Eh(D.a.Pyj,{["SessionId"]:l.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))}D9i(){this.qL&&(k.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.qL.Eh(D.a.$vj,{["CID"]:""}))}HHm(a){a&&a.Values&&(a=a.Values,delete a.m_Origin,delete a.m_Source,delete a.m_ReceivedTime,k.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+a.eventName||!1),R.a.sendOtelEvent(Object.assign(new aP.a,{otelEvent:a})))}PGm(){this.q2a&&(k.ULS.sendTraceTag(577249665,352,
50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.q2a.launchUpsellExperience("stockimages"))}}Object(t.a)(AE,"InsertMediaDialog",xg.a,[423,12]);class gI{constructor(a,d){this.oif=a;this.g$=d}Wud(a,d=!1){return new AE(a,this.oif,this.g$,zE.Lf,d)}getInstance(){throw Error.notImplemented();}}Object(t.a)(gI,"InsertMediaDialogFactory",null,[422]);class hI{constructor(a,d,n){this.OPi=!1;this.correlationId=null;this.Ysa=0;this.QIc=null;this.Vak=a;this.ged=[];this.N7d=d;this.dPh=
n.split(";")}BZe(a,d){Array.clear(this.ged);a=this.Vak.value;a.Tgb(this.N7d);a.ax(d.Nyd);this.OPi||(a.uD(d.Nyd,n=>{this.cOe(n,d)}),this.OPi=!0);k.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");a.Eh(d.$di,{["FileExtensionFilterList"]:this.dPh})}lxk(a){Array.contains(this.ged,a)||this.ged.push(a)}cOe(a,d){k.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");a=d.Ldj(a);const n=[];for(let z=0;z<a.length;z++){const O=
a[z];d.xFe(O,this.dPh)?n.push(O):this.lxk(d.gDi(O))}n&&n.length?d.VGb(n):k.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.ged.length&&(d=this.ged.join(", "),k.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",d),this.twn(d))}twn(a){const d=new $g.StandardDialog;d.wc=0;d.kT(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,a),
null)}dispose(){}}Object(t.a)(hI,"InsertMediaFromHostManager",null,[423,12]);class iI{constructor(a){this.Rbk=a}Wud(){throw Error.notImplemented();}getInstance(){return this.Rbk}}Object(t.a)(iI,"InsertMediaFromHostManagerFactory",null,[421,422]);class jI{constructor(){this.tkb=document.createElement("iframe");this.tkb.src="about:blank";this.tkb.style.visibility="hidden";this.tkb.style.position="absolute";this.tkb.style.zIndex="-100"}}Object(t.a)(jI,"InsertMediaFromHostOneDriveHostFrame",null,[420]);
class kI extends GC.a{constructor(a,d){super(a,"*"===d?d:Vc.a.aga(d));this.BTh(D.a.insertImage);this.BTh(D.a.TDe)}Djc(){}}Object(t.a)(kI,"InsertMediaFromOneDriveCrossDocumentMessenger",GC.a,[419,74,12]);class BE{}Object(t.a)(BE,"OnlineMediaSearchResult",null,[]);class IC{m2h(a,d,n,z){const O=Ih.a.yf(l.AFrameworkApplication.lcid).name,ca=l.AFrameworkApplication.buildVersion,Da=w.a.IR(l.AFrameworkApplication.K.Ga("UserId")).toString();if(-1!==a.indexOf("exp=")){const Xa=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",
!1)?1:0;l.AFrameworkApplication.Yi("ShIns226;ShIns226cf");return String.format(a,l.AFrameworkApplication.lcid,O,ca,d,IC.O7e,Da,z,n,Xa)}return String.format(a,l.AFrameworkApplication.lcid,O,ca,d,IC.O7e,Da,z,n)}jPm(a){if(!a||!a.Values)return null;a=a.Values;if(!a)return null;let d="";"sourceProvider"in a&&(d=a.sourceProvider||"");return Object.assign(new BE,{Action:a.action||"",Caption:a.caption||"",ContentType:a.contenttype||"",Type:a.extension||"",PageUrl:a.pageUrl||"",OriginalUrl:a.sourceUrl||"",
ContentProvider:d,ThumbnailUrl:a.thumbnailUrl||"",LicenseUrl:a.licenseUrl||"",LicenseDisplayName:a.licenseDisplayName||"",Height:a.height||0,Width:a.width||0,SvgContent:a.svgContent||"",Html:a.html||""})}kPm(a){const d=[];if(!a||!a.Values||!a.Values.Items)return d;a=a.Values.Items;for(let z=0;z<a.length;z++){var n=a[z];n&&(n=Object.assign(new BE,{Type:n.Extension||"",OriginalUrl:n.SourceUrl||"",Caption:n.caption,Height:n.Height||0,Width:n.Width||0}),d.push(n))}return d}tQe(a){const d=[];for(let z=
0;z<a.data.files.length;z++){var n=a.data.files[z];n&&(n=Object.assign(new BE,{ContentType:n.itemType||"",Type:n.extension||"",OriginalUrl:n.urls&&n.urls.open?n.urls.open:"",Height:n.photo?n.photo.height:0,Width:n.photo?n.photo.width:0}),d.push(n))}return d}xFe(a,d){if(!a)return!1;for(let n=0;n<d.length;n++)if(0<=a.toLowerCase().indexOf(d[n]))return!0;return!1}$Sm(a){let d="";if(a)for(let n=0;n<a.length;n++){const z=a[n];z&&(d+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',z.OriginalUrl,
z.Width,z.Height))}return d}}IC.O7e=0;Object(t.a)(IC,"InsertMediaHelper",null,[416]);class lI{constructor(a,d,n,z,O){this.Fbm=a;this.npg=d;this.YRi=n;this.Gbm=z;this.Hbm=O}}Object(t.a)(lI,"InsertMediaSettingsManager",null,[]);class ZF{constructor(a){this.S3c=Mb.a.insertHyperlink;this.ga=a}get Tnb(){return this.S3c}set Tnb(a){this.S3c=a}VGb(a){try{k.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",a.length);for(let d=0;d<a.length;d++)this.ga.ob(this.Tnb,
2,a[d]);k.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",a.length)}catch(d){k.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",d.toString())}}}Object(t.a)(ZF,"InsertOneDriveFileHandler",null,[395]);class mI extends ZF{constructor(a){super(a)}get $di(){return D.a.TDe}get Nyd(){return D.a.zNi}Ldj(a){return a&&a.Values&&"Items"in a.Values?a.Values.Items:null}gDi(){Ld.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");
return""}xFe(){return!0}Bgj(a,d,n){a=n(a);a.length&&(n={},n.Items=a,d.Eh(this.Nyd,n))}Mdj(a){const d=[];for(let n=0;n<a.data.files.length;n++){const z=a.data.files[n];if(z){const O={};O.DisplayText=String.format("{0}{1}",z.name,z.extension);O.Url=this.jml([z.urls.viewInBrowser,z.urls.open,z.urls.download]);d.push(O)}}return d}jml(a){for(let d=0;d<a.length;d++)if(a[d]&&""!==a[d])return a[d];k.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(t.a)(mI,"InsertOneDriveFileHelper",
ZF,[394,395]);class $F{constructor(a,d,n){this.S3c=Mb.a.hfa;this.jk=null;this.ga=a;this.g$=d;this.W$=n}get Tb(){return this.ga}get Au(){return this.jk||(this.jk=la.a.instance.resolve("Common.Utils.IAriaNotifier"))}get Tnb(){return this.S3c}set Tnb(a){this.S3c=a}VGb(a){try{k.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",a.length);const d=this.g$.$Sm(a);let n=2;if(d&&0<d.length){const z=new dh.DictionaryPropertySet;z.setValue(Xc.a.wV,d);z.setValue(Xc.a.wga,
!0);if(this.W$){const O=this.W$.NWd();O.Wyc("insertOnlineImage");z.setValue(Xc.a.pya,O)}n=this.ga.ob(this.Tnb,2,z)}k.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",a.length,32===n,""===d)}catch(d){k.ULS.ZY(21612225,352,10,d,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}Object(t.a)($F,"InsertOnlineImageHandler",null,[395]);class CE extends $F{constructor(a,d,n=null){super(a,d,n)}get $di(){return D.a.insertImage}get Nyd(){return D.a.GNi}Ldj(a){return this.g$.kPm(a)}gDi(a){return a.Type}xFe(a,
d){return this.g$.xFe(a.Type,d)}Mdj(a){return this.g$.tQe(a)}Bgj(a,d,n){n=n(a);if(n.length){a=[];for(let z=0;z<n.length;z++){const O=n[z],ca={};ca.Extension=O.Type;ca.SourceUrl=O.OriginalUrl;ca.caption=O.Type;ca.SourceUrl=O.OriginalUrl;ca.Width=O.Width;ca.Height=O.Height;a.push(ca)}n={};n.Items=a;d.Eh(this.Nyd,n)}}}Object(t.a)(CE,"InsertOnlineImageHelper",$F,[394,395]);class nI{constructor(a,d){this.BTb=a;this.fce=d}start(a){this.BTb.start({mode:"open",select:"multi",lightbox:"white"},(d,n)=>{this.XOg(d,
n,a)})}XOg(a,d,n){k.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",a);a&&d&&d.data&&d.data.files&&0<d.data.files.length?(a=this.fce.getInstance(window.frames[0].parent,window.document.URL),n.Bgj(d,a,Object(m.a)(n,n.Mdj,"parseOneDriveV5Response"))):k.ULS.sendTraceTag(22090010,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(t.a)(nI,"OneDriveFilePickerHelperV5",
null,[274]);class oI{constructor(){this.C8d=this.Z=null}get name(){return"Box4.Media"}Hb(a){this.Z=a;a.ha("Box4.Media.InsertMediaFromHostOneDriveHostFrame",()=>new jI).as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").singleInstance();const d=new lI(Boolean.parse(l.AFrameworkApplication.K.appSettings.InsertOnlinePictureEnabled||"false"),l.AFrameworkApplication.WFe(),!1,l.AFrameworkApplication.hZe(),l.AFrameworkApplication.K.ea("InsertPictureUsingStockImagesIsEnabled"));a.ha("Box4.Media.OneDriveFilePickerHelperV5",
()=>new nI(a.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5"),a.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"))).as("Box4.Media.IOneDriveFilePickerHelper").singleInstance();a.ha("Box4.Media.InsertMediaActor",()=>new dI(l.AFrameworkApplication.pa,l.AFrameworkApplication.K,d,a.resolve("Box4.Media.IOneDriveFilePickerHelper"),a.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),new Nf.a(()=>la.a.instance.resolve("Box4.Images.IImageEditor")),a.resolve("Box4.Media.IInsertMediaDialogFactory"),
a.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),a.resolve("Box4.Media.InsertMediaHelper"),a.resolve("Box4.Media.InsertOnlineImageHelper"),a.resolve("Box4.Media.InsertOneDriveFileHelper"),a.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),l.AFrameworkApplication.fpb,l.AFrameworkApplication.Ksa,l.AFrameworkApplication.JKi,l.AFrameworkApplication.K.appSettings.InsertPictureTelemetryEndpoint)).singleInstance();a.ha("Box4.Media.InsertMediaDialogFactory",()=>new gI(a.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),
a.resolve("Box4.Media.InsertMediaHelper"))).as("Box4.Media.IInsertMediaDialogFactory").singleInstance();a.ha("Box4.Media.InsertMediaFromHostManagerFactory",()=>new iI(a.resolve("Box4.Media.InsertMediaFromHostManager"))).as("Box4.Media.IInsertMediaFromHostManagerFactory").singleInstance();a.ha("Box4.Media.InsertMediaFromHostManager",()=>new hI(new Nf.a(()=>{if(l.AFrameworkApplication.hZe()){var n=la.a.instance.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").tkb;n=new kI(n.contentWindow,
"*")}else n=l.AFrameworkApplication.$_;return n}),l.AFrameworkApplication.hZe()?Vc.a.aga(window.document.URL):Vc.a.aga(l.AFrameworkApplication.urb),l.AFrameworkApplication.K.appSettings.ImageFetcherSupportedExtensions)).singleInstance();a.register(fI,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").singleInstance();a.register(IC,"Box4.Media.InsertMediaHelper").singleInstance();a.ha("Box4.Media.InsertOnlineImageHelper",()=>new CE(l.AFrameworkApplication.pa,
a.resolve("Box4.Media.InsertMediaHelper"),a.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();a.ha("Box4.Media.InsertOneDriveFileHelper",()=>new mI(l.AFrameworkApplication.pa)).singleInstance()}init(){this.C8d=this.Z.resolve("Box4.Media.InsertMediaActor");this.C8d.lb()}dispose(){this.C8d&&this.C8d.dispose()}}Object(t.a)(oI,"MediaPackage",null,[1,2]);var aG=b(265);class cv{constructor(){this.adn="getAddinShortcutsPreference";this.bdn="saveAddinShortcutsPreference";this.cdn="{0}RoamingServiceHandler.ashx?action={1}&{2}";
this.Yql=6E4;this.nMe=this.Rya=this.Pha=null}Otb(){cv.wAj||"undefined"===typeof OSF||(cv.Otb=OSF.OUtil.checkFlight(23),cv.wAj=!0);return cv.Otb}mDi(a){return String.format(this.cdn,l.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",a,l.AFrameworkApplication.Fk)}executeRequest(a,d,n,z,O=null){return cv.oya.z2b(a,d,O,null,!1,2,null,n,z,!1,null,this.Yql)}saveSetting(a,d,n,z,O){if(this.Otb())return this.otj(a,d,n,null,z,O);const ca=this.XSc(),Da={};Da.action=n;Da.addinId=d;
Da.ownerType=a;Da.timestamp=(new Date).toUTCString();a={};a[z.toString()]=Da;z=new aG.a(O.toString(),a);return ca?this.ptj(z):this.qtj(z)}startBatchUpdateScope(){this.nMe=[]}saveShortcutInfoArrayBatch(a,d,n){this.yen(n,a,d)}yen(a,d,n){const z={action:"",addinId:"",ownerType:0};z.timestamp=(new Date).toUTCString();const O=this.getShortcutInfoArray(d.toString(),n.toString());a?(z.shortcutInfoArray=a,this.QAf(d,n,a)):O&&(z.shortcutInfoArray=O);a={};a[d.toString()]=z;d=new aG.a(n.toString(),a);this.nMe.push(d)}commitBatchUpdateScope(){return this.XSc()?
this.zen().then(()=>{this.Vzc();return Promise.resolve(!0)}):this.Aen().then(()=>{this.Vzc();return Promise.resolve(!0)})}zen(){return this.getSetting().then(a=>{let d=null;if(a&&!({at:d}=x.d(a)).returnValue)return k.ULS.sendTraceTag(0,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);d||(d={});for(const n of this.nMe){(a=d[n.key])||(a={});const z=n.value;for(const O of ta.a.NF(z))a[O]=z[O];d[n.key]=a}this.Pha=d;try{return localStorage.setItem("AddinShortcutPreferenceData",
x.c(d)),Promise.resolve(!0)}catch(n){return k.ULS.sendTraceTag(0,0,10,"SaveSettingToLocalStorageBatch failed",n),Promise.resolve(!1)}})}Aen(){return this.fin().then(a=>this.oWe(a))}fin(){return this.Tbg().then(a=>{let d=null;a&&(({at:d}=x.d(a)).returnValue||k.ULS.sendTraceTag(0,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));d||(d={});for(const n of this.nMe){(a=d[n.key])||(a={});const z=n.value;for(const O of ta.a.NF(z))a[O]=z[O];d[n.key]=
a}this.Pha=d;return x.c(d)})}saveShortcutInfoArray(a,d,n){return this.otj(0,"","",n,a,d)}otj(a,d,n,z,O,ca){const Da=this.XSc(),Xa={};Xa.action=n;Xa.addinId=d;Xa.ownerType=a;Xa.timestamp=(new Date).toUTCString();d=this.getShortcutInfoArray(O.toString(),ca.toString());0===a&&z?(Xa.shortcutInfoArray=z,this.QAf(O,ca,z)):d&&(Xa.shortcutInfoArray=d);a={};a[O.toString()]=Xa;O=new aG.a(ca.toString(),a);return Da?this.ptj(O):this.qtj(O)}ptj(a){return this.getSetting().then(d=>{let n=null;if(d&&!({at:n}=x.d(d)).returnValue)return k.ULS.sendTraceTag(0,
0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),Promise.resolve(!1);n||(n={});n[a.key]=a.value;this.Pha=n;try{return localStorage.setItem("AddinShortcutPreferenceData",x.c(n)),Promise.resolve(!0)}catch(z){return k.ULS.sendTraceTag(0,0,10,"SaveSettingToLocalStorage failed",z),Promise.resolve(!1)}})}qtj(a){return this.ein(a).then(d=>this.oWe(d))}ein(a){return this.Tbg().then(d=>{let n=null;d&&(({at:n}=x.d(d)).returnValue||k.ULS.sendTraceTag(0,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));
n||(n={});n[a.key]=a.value;this.Pha=n;return x.c(n)})}saveSettings(a){this.Pha=x.a(a);this.Otb()&&this.Vzc();return this.XSc()?this.ttj(a):this.oWe(a)}ttj(a){try{return localStorage.setItem("AddinShortcutPreferenceData",a),Promise.resolve(!0)}catch(d){return k.ULS.sendTraceTag(0,0,10,"SaveSettingToLocalStorage failed",d),Promise.resolve(!1)}}oWe(a){const d={};d.Wac=a;const n=x.c(d);return new Promise(z=>{try{if(void 0===n||null===n||!n.length||1E6<=n.length)z(!1);else{var O=this.executeRequest(this.mDi(this.bdn),
2,"SaveAddinShortcutsPreferenceRequest","38",n);O.continueWith(()=>{if(O.Jm||O.Vh)k.ULS.sendTraceTag(0,0,10,"SaveAddinShortcutsPreference: Request failure"),z(!1);else{var ca=O.result;void 0!==ca.args&&null!==ca.args&&void 0!==ca.args.data&&null!==ca.args.data&&ca.args.data.Ge===Ma.a.HD?z(!0):z(!1)}})}}catch(ca){k.ULS.sendTraceTag(0,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",ca.toString()),z(!1)}})}getSetting(){const a=this.XSc();return this.Pha?Promise.resolve(x.c(this.Pha)):a?
this.oOl():this.Tbg()}XSc(){const a=l.AFrameworkApplication.K.ea("IsAnonymousUser"),d=l.AFrameworkApplication.K.ea("IsRoamingServiceEnabled");return a||this.Otb()&&!d}oOl(){try{const a=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(a)}catch(a){return k.ULS.sendTraceTag(0,0,10,"GetSettingFromLocalStorage failed",a),Promise.resolve("")}}Tbg(){return new Promise((a,d)=>{try{const n=this.executeRequest(this.mDi(this.adn),1,"GetSettingRequest","37");n.continueWith(()=>{if(n.Jm||
n.Vh)k.ULS.sendTraceTag(0,0,10,"GetSettingFromRoaming : Request failure");else{let O="";var z=n.result;z&&z.args&&z.args.data?z.args.data.Ge!==Ma.a.HD?k.ULS.sendTraceTag(0,0,10,"GetSettingFromRoaming : Received error response {0}",z.args.data.Ge):z.args.data.Rd?(z=x.a(z.args.data.Rd),z.Wac&&(O=z.Wac)):k.ULS.sendTraceTag(0,0,10,"GetSettingFromRoaming : ResponseData is null"):k.ULS.sendTraceTag(0,0,10,"GetSettingFromRoaming : Data is null");a(O)}})}catch(n){k.ULS.sendTraceTag(0,0,10,"GetSettingFromRoaming Exception handling request {0}",
n.toString()),d("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(a){const d=this.XSc(),n=this;return this.getSetting().then(z=>{let O=null;z&&(O=x.a(z));if(!O)return k.ULS.sendTraceTag(0,0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(const ca of ta.a.NF(O)){z=O[ca.toString()];for(const Da of ta.a.NF(z)){const Xa=z[Da];if(Xa.addinId===a)delete z[Da.toString()];else if(n.Otb()&&0===Xa.ownerType&&Xa.shortcutInfoArray){const zb=Xa.shortcutInfoArray,
Vb=new db.a;for(let Fc=0;Fc<zb.length;++Fc)zb[Fc].addinId!==a&&Vb.add(zb[Fc]);Xa.shortcutInfoArray=Vb.toArray()}}ta.a.count(z)||delete z[ca]}n.Pha=O;n.Otb()&&n.b6m(a);return d?n.ttj(x.c(O)):n.oWe(x.c(O))})}Vzc(){if(this.Pha){this.Rya=null;const n=this.Pha;for(let z in n){var a=z;const O=n[z];for(let ca in O){var d=ca;const Da=O[ca];Da.shortcutInfoArray&&this.QAf(parseInt(d),parseInt(a),Da.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.Otb()?this.getSetting().then(a=>{let d=
null;if(a&&!({at:d}=x.d(a)).returnValue)return k.ULS.sendTraceTag(0,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.Pha=d;this.Vzc();return Promise.resolve(!0)}):Promise.resolve(!0)}getShortcutsPreferenceInfoByAddinId(a,d,n){return this.Pha&&(n=this.Pha[n])&&(d=n[d])&&d.addinId===a?d:null}getShortcutInfoArray(a,d){return this.Pha&&(d=this.Pha[d])&&(a=d[a])&&a.shortcutInfoArray?a.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(a,
d,n){this.saveShortcutInfoArrayBatch(parseInt(a),parseInt(d),n)}setShortcutInfoArray(a,d,n){return this.saveShortcutInfoArray(parseInt(a),parseInt(d),n).then(()=>{this.Vzc();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(a,d){if(!this.Rya)return Promise.resolve(!0);var n=this.Rya[a];if(!n)return Promise.resolve(!0);var z=n[d];n=z.modifiers;z=z.keyCode;const O=this.getShortcutInfoArray(n.toString(),z.toString());if(!O||!O.length)return Promise.resolve(!0);let ca=0;for(const Da of O){if(Da.addinId===
a&&Da.action===d)break;++ca}if(ca>=O.length)return Promise.resolve(!0);O.splice(ca,1);return this.saveShortcutInfoArray(n,z,O).then(()=>{this.Vzc();return Promise.resolve(!0)})}QAf(a,d,n){this.Rya||(this.Rya={});for(const z of n){n=z.addinId;const O=z.action;let ca=this.Rya[n];ca||(ca={});const Da={};Da.modifiers=a;Da.keyCode=d;ca[O]=Da;this.Rya[n]=ca}}b6m(a){a in this.Rya&&delete this.Rya[a]}isActionCustomized(a,d){return this.Rya&&(a=this.Rya[a])&&a[d]?!!a[d]:!1}getShortcutByCustomizedAction(a,
d){return this.Rya&&(a=this.Rya[a])?a[d]:null}getShortcutsPreferenceMappingTable(){return this.Pha}static instance(){cv.nDf||(k.ULS.sendTraceTag(0,0,50,"AddinShortcutsPreferenceSettingHelper"),cv.nDf=new cv,cv.oya=l.AFrameworkApplication.Gd);return cv.nDf}}cv.nDf=null;cv.oya=null;cv.wAj=!1;cv.Otb=!1;Object(t.a)(cv,"AddinShortcutsPreferenceSettingHelper",null,[]);class pI{constructor(a,d,n,z){this.O4d=null;new db.a;this.xBh=!0;this.o7d=a;this.Jg=n;this.Uxh=z}vCf(a){this.Uxh.addHandler("GoalChangedEvent",
a)}HAm(){this.Uxh.raiseEvent("GoalChangedEvent")}kng(a,d,n=!1,z=null){return this.O4d&&this.xBh?a in this.O4d?this.O4d[a]:(n&&this.Jg.sendTraceTag(528274568,2252,50,"Critique configuration doesn't contain TypeId. Type id {0} language {1}",a,z),"Formality"===d&&this.o7d.Hbg().formality?!1:!0):!0}Fjn(a,d){d===this.o7d.Hbg().formality&&(this.O4d=a,this.HAm())}xMn(a){this.xBh=a}}Object(t.a)(pI,"GoalChangeSource",null,[439,440,441]);var DE=b(867),bG=b(822),JC=b(641);class qI{constructor(a,d,n,z,O,ca){this.n0a=
d;this.JNa=n;this.lg=a;this.Qea=z;this.Jg=O;this.iak=ca;this.JNa.ccc()&&this.initialize()}initialize(){return this.Qea.ar().then(()=>{this.lg.Ea(this,DE.a.getTypeName());this.lg.addHandler(this,bG.a.getTypeName())}).catch(a=>{this.Jg.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",a)})}sS(a,d){if(d===Jn.a.getTypeName()||d===JC.a.getTypeName())if(!a||!a.content)this.Jg.sendTraceTag(528274564,2252,10,"Handled annotation is invalid");
else if(Gj.a.getTypeNameFor(a.content)===DE.a.getTypeName()||Gj.a.getTypeNameFor(a.content)===bG.a.getTypeName())if(Gj.a.getTypeNameFor(a.content)===DE.a.getTypeName()){var n=a.content;this.Jg.sendTraceTag(528274565,2252,50,"Goal annotation received with formality goal: {0}",n.critiqueConfiguration.formalityGoal);this.n0a.Fjn(n.critiqueConfiguration.mapping,n.critiqueConfiguration.formalityGoal)}else if(Gj.a.getTypeNameFor(a.content)===bG.a.getTypeName())if(a=a.content,a.features){for(n of a.features)if("Goals"===
n.featureName){this.iak.xMn(!!n.supportType);return}this.Jg.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.Jg.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}Object(t.a)(qI,"GoalsAnnotationHandler",null,[280]);class rI{constructor(a){this.va=a}ccc(){return this.va.ea("EditorGoalsEnabled")}}Object(t.a)(rI,"GoalsGate",null,[438]);var bP=b(1030),cP=b(1031),sI=b(787);class $v{}$v.sqe=0;$v.wqe="1.0";$v.Z8a="Goals";Object(t.a)($v,
"GoalsConstants",null,[]);var cG=b(933);class tI{constructor(a,d,n,z,O){this.yvc=null;this.CRi=!1;this.JJh=a;this.q7d=d;this.Jg=n;this.JNa=z;this.pgf=O;this.JNa.ccc()?this.e_m():this.JNa.ccc()&&this.j_g($v.sqe,$v.wqe)}e_m(){new Promise(a=>{this.JJh.dKl($v.Z8a,d=>{this.f_m(d)?(this.j_g(this.yvc.formality,this.yvc.version),a(this.yvc)):(this.j_g($v.sqe,$v.wqe),a(null))})})}f_m(a){this.CRi=!0;if(!a||!a.NUd)return this.Jg.sendTraceTag(528274529,2252,50,"No persisted goal is registered."),!1;a=a.NUd.properties;
var d=a.getValue(Qb.a.Xkg);d=parseInt(d);a=a.getValue(Qb.a.Ykg);if(!this.q7d.mgh(a))return this.Jg.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",a),!1;this.yvc=a=Object.assign(new cG.a,{formality:d,version:a});this.Jg.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",a.formality,a.version);return!0}j_g(a,d){a=Object.assign(new sI.a,{formality:a,version:d});this.pgf.nvj(a)}rTn(a){if(this.q7d.mgh(a.version)){var d=
bP.a.k1k(a.version,a.formality.toString());this.JJh.Vvk(Object.assign(new cP.a,{NUd:d,Z8a:$v.Z8a}))?this.yvc=a:this.Jg.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.Jg.sendTraceTag(528274560,2252,10,"Trying to write unsupported formality goal version. Goal version {0}",a.version)}rzi(){this.CRi||this.Jg.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");return this.yvc}}Object(t.a)(tI,"GoalsPersistenceHandler",null,[437]);class uI{constructor(a,
d,n,z){this.Jg=a;this.qgf=d;this.q7d=n;this.JNa=z;this.p7d=Object.assign(new cG.a,{formality:$v.sqe,version:$v.wqe});this.Euf=this.JNa.ccc()}Hbg(){this.Euf&&(this.Euf=!1,this.qgf.rzi()&&(this.p7d=this.qgf.rzi()));return this.p7d}eon(a){this.Euf=!1;this.q7d.mgh(a.version)?(this.JNa.ccc()&&this.qgf.rTn(a),this.p7d=a):(this.Jg.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",a.version),this.p7d=Object.assign(new cG.a,{formality:$v.sqe,version:$v.wqe}))}}Object(t.a)(uI,
"GoalsProvider",null,[253,254]);class EE{constructor(a,d,n,z){this.lg=a;this.Qea=d;this.Xwb=n;this.Jg=z}nvj(a){a=Object.assign(new Jn.a,{parentPath:["Signal",sI.a.getTypeName()],items:[Object.assign(new Sq.a,{body:a})]});this.jfl(a)}jfl(a){this.Qea.ar().then(()=>{this.etk(a)}).catch(d=>{this.Jg.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",d)})}etk(a){this.lg.activateAnnotation(DE.a.getTypeName(),EE.Pyc).then(()=>{this.Xwb.getAugLoopRuntimeManager().submitOperation(Object.assign(new Na.a,
{operation:a}))}).catch(d=>{this.Jg.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",d)})}}EE.Pyc="GoalSelected";Object(t.a)(EE,"GoalsSignalSender",null,[252]);class VA{constructor(){VA.Wyf=new RegExp(VA.Ork)}mgh(a){return!!a.match(VA.Wyf)&&1===a.match(VA.Wyf).length}}VA.Ork="[0-9]+[.]?[0-9]*";VA.Wyf=null;Object(t.a)(VA,"GoalsValidator",null,[251]);class dG{constructor(){this.Z=null}get name(){return"WordEditor.Goals"}init(){this.Z.resolve("WordEditor.Goals.GoalsAnnotationHandler")}dispose(){}Hb(a){this.Z=
a;this.Z.ha("WordEditor.Goals.GoalsValidator",()=>new VA).as("WordEditor.Goals.IGoalsValidator").singleInstance();this.Z.ha("WordEditor.Goals.IGoalsGate",()=>new rI(this.Z.resolve("Common.IAppSettingsManager"))).singleInstance();this.Z.ha("WordEditor.Goals.GoalsProvider",()=>new uI(this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("WordEditor.Goals.GoalsPersistenceHandler"),this.Z.resolve("WordEditor.Goals.IGoalsValidator"),this.Z.resolve("WordEditor.Goals.IGoalsGate"))).as("WordEditor.Goals.IGoalReader").as("WordEditor.Goals.IGoalUpdater").singleInstance();
this.Z.ha("WordEditor.Goals.GoalChangeSource",()=>new pI(this.Z.resolve("WordEditor.Goals.IGoalReader"),this.Z.resolve("WordEditor.Goals.IGoalUpdater"),this.Z.resolve("Common.IUlsWrapper"),new oc.a)).as("WordEditor.Goals.IGoalChangeSource").as("WordEditor.Goals.IGoalCritiqueConfiguration").as("WordEditor.Goals.IGoalsFeatureSupport").singleInstance();this.Z.ha("WordEditor.Goals.GoalsPersistenceHandler",()=>new tI(this.Z.resolve("Box4.PersistenceSettingsManager"),this.Z.resolve("WordEditor.Goals.IGoalsValidator"),
this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("WordEditor.Goals.IGoalsGate"),this.Z.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).as("WordEditor.Goals.IGoalsPersistenceHandler").singleInstance();this.Z.ha("WordEditor.Goals.GoalsAnnotationHandler",()=>new qI(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.Goals.IGoalCritiqueConfiguration"),this.Z.resolve("WordEditor.Goals.IGoalsGate"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.Z.resolve("Common.IUlsWrapper"),
this.Z.resolve("WordEditor.Goals.IGoalsFeatureSupport"))).as("WordEditor.Goals.GoalsAnnotationHandler").singleInstance();this.Z.ha("WordEditor.Goals.GoalsSignalSender",()=>new EE(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.Z.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.Z.resolve("Common.IUlsWrapper"))).as("WordEditor.Goals.IGoalSelectedSignalSender").singleInstance()}static main(){M.a.instance.Sb(new dG)}}Object(t.a)(dG,
"WordEditorGoalsPackage",null,[1,2]);var MD=b(681),ND=b(414);class eG{constructor(){this.annotation=null;this.languages=new qi.a(ma.a.Xi())}}Object(t.a)(eG,"CritiqueCountWrapper",null,[]);class aA{constructor(){this.FEa=new yb.a}Awe(){return this.FEa}kMi(a,d,n,z){if(this.FEa.Na(n)){this.FEa.J(n).annotation.count+=d;n=this.FEa.J(n).languages;for(var O of z)n.add(O)}else O=E.a.create().toString(),a=Object.assign(new ND.a,{id:O,categoryName:a,count:d}),this.FEa.add(n,Object.assign(new eG,{annotation:a,
languages:z}))}}aA.yi=389;Object(t.a)(aA,"BaseCritiquesByTypeCounter",null,[226]);class vI extends aA{constructor(a){super();this.OZb=new ra.a;this.Dbf=new ra.a;this.fhe=a}XUl(a){const d=a.annotation;if(d&&MD.a(Gj.a.getTypeNameFor(d.content))){const n=d.content;if(a.opType===Jn.a.getTypeName()){this.fhe.F7m(d.parentPath,n);a=n.M_.state;if(60!==a&&70!==a)return this.OZb.contains(d.id)&&this.OZb.remove(d.id),this.I1l(d.id,n),!0;this.OZb.add(d.id)}else if(a.opType===Rp.a.getTypeName())if(this.OZb.contains(d.id))this.OZb.remove(d.id);
else return this.Fei(n.typeId,d.id)}return!1}WUl(a){if((a=a.annotation)&&MD.a(Gj.a.getTypeNameFor(a.content))){const d=a.content,n=d.M_.state;if((60===n||70===n)&&!this.OZb.contains(a.id))return this.OZb.add(a.id),this.Fei(d.typeId,a.id)}return!1}I1l(a,d){this.Dbf.add(a);a=new qi.a(ma.a.Xi());d.language&&a.add(d.language);this.kMi(d.categoryName,1,d.typeId,a)}Fei(a,d){if(!this.Dbf.contains(d))return!1;if(!this.FEa.Na(a))return k.ULS.sendTraceTag(589866503,aA.yi,15,"Unable to decrement the count for critique category {0}. Reason : {1}",
a,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.FEa.J(a).annotation.count)return k.ULS.sendTraceTag(589866504,aA.yi,15,"Unable to decrement the count for critique category {0}. Reason : {1}",a,"Current count is less than or equal to 0"),!1;this.Dbf.remove(d);this.FEa.J(a).annotation.count--;return!0}}Object(t.a)(vI,"AlCritiquesByTypeCounter",aA,[448,226]);var wI=b(883);class xI extends Rs.a{constructor(a,d,n,z,O,ca,Da,Xa,zb){var Vb;super();this.lg=a;this.fhe=d;this.L8e=
n;this.Nth=z;this.n0a=O;this.JFa=ca;this.te=Da;this.$T=this.zsh=!1;this.Lof=new yb.a;this.G9l=(Fc,Yc,yd)=>{const je=!this.n0a||this.n0a.kng(Fc,yd,!0,Yc);Fc=this.JFa&&this.JFa.instance?this.JFa.instance.jng(Fc,yd,Yc.substr(1,Yc.length-2)):!0;return je&&Fc};null===Xa||void 0===Xa?void 0:Xa.vCf(Object(m.a)(this,this.YJb,"onGoalChange"));zb.UCa(this,7);null===(Vb=this.JFa)||void 0===Vb?void 0:Vb.execute(Fc=>{Fc.$Cf(Object(m.a)(this,this.Fkc,"sendAnnotationsToHandlers"))})}get index(){return 3}ZEm(a,d){this.fhe.MVl(d)&&
(this.$T=!0,this.l8())}run(){this.$T&&(this.Fkc(),this.$T=!1)}uCm(a,d){this.L8e.XUl(d)&&this.Fkc()}g9i(){this.Fkc()}TFg(a,d){this.L8e.WUl(d)&&this.Fkc()}YJb(){this.Fkc()}aaj(){this.Fkc()}Fkc(){let a=!1;this.te.Fd(()=>{var d=this.Hwl();const n=new db.a;for(let z of d)d=Object.assign(new wI.a,{id:z.id,parentPath:Ea.a.X6b,content:z,annotationType:Gj.a.getTypeNameFor(z)}),n.add(d),a||(a=0<z.count);this.lg.Ejn(n)},"CC:SATH");!this.zsh&&a&&(R.a.sendTelemetryEvent(Object.assign(Object.assign({},new ha.a),
{name:"Office.Word.Online.Editor.CritiquesAvailable"})),this.zsh=!0)}xZk(a){let d=0;if(({value:d}=this.Lof.Ab(a.categoryName,0)).returnValue)if(d!==a.count)this.Lof.$(a.categoryName,a.count);else return!1;else this.Lof.add(a.categoryName,a.count);return!0}Hwl(){const a=new yb.a;var d=this.fhe.Awe();const n=this.L8e.Awe();this.rdh(a,d);this.rdh(a,n);this.Nth&&(d=this.Nth.Awe(),this.rdh(a,d));d=new db.a;for(let z of a.values)this.xZk(z)&&d.add(z);return d}rdh(a,d){for(let O of d){d=O.value.annotation;
const ca=O.key;var n=this.din(O.value.languages);if(!a.Na(d.categoryName)){var z=E.a.create().toString();z=Object.assign(new ND.a,{id:z,categoryName:d.categoryName,count:0,countsByTypeId:{}});a.add(d.categoryName,z)}this.G9l(ca,n,d.categoryName)&&(n=a.J(d.categoryName),n.count+=d.count,n.countsByTypeId[ca]=(n.countsByTypeId[ca]?n.countsByTypeId[ca]:0)+d.count)}}din(a){const d=[];let n=0;for(let z of a)d[n++]=z;return x.c(d)}}Object(t.a)(xI,"CritiquesCounter",Rs.a,[228,229]);class yI{constructor(a){this.Cx=
a}Awe(){const a=new yb.a,d=new qi.a(ma.a.Xi()),n=Object.assign(new ND.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.Cx.OZc.count});a.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",Object.assign(new eG,{annotation:n,languages:d}));return a}}Object(t.a)(yI,"DictationCritiquesByTypeCounter",null,[227,226]);class zI extends aA{constructor(a){super();this.rxb=new yb.a;this.lg=a}MVl(a){const d=Ea.a.Rye(a.nc);if(!Ea.a.le(d)){if(a.Xaa&&a.Xaa.length){let n=null;for(let z of a.Xaa)z.errorDetails.U5a()||
(a=this.Lvi(z),Ea.a.le(a)||(n||(n=new yb.a),n.Na(a)||n.add(a,new db.a),n.J(a).add(z)));this.Gei(d);n?this.Hmn(d,n):this.rxb.remove(d)}else{if(!this.rxb.Na(d))return!1;this.Gei(d);this.rxb.remove(d)}return!0}return!1}F7m(a,d){var n;if(({value:n}=this.rxb.Ab(a,n)).returnValue)for(let O of n)if(a=O.value,0<a.count&&this.m7f(a.J(0))===d.categoryName)for(n=a.count-1;0<=n;n--){var z=a.J(n).end-a.J(n).begin;a.J(n).begin===d.range.start&&z===d.range.length&&(z=this.Lvi(a.J(n)),this.FEa.Na(z)&&(z=this.FEa.J(z).annotation,
z.count=Math.max(0,z.count-1)),a.removeAt(n))}}Gei(a){if(this.rxb.Na(a))for(let n of this.rxb.J(a)){var d=n.key;a=n.value;this.FEa.Na(d)&&(d=this.FEa.J(d).annotation,d.count=Math.max(0,d.count-a.count))}}Hmn(a,d){const n=new yb.a,z=new yb.a;for(let O of d){d=O.key;z.add(d,new qi.a(ma.a.Xi()));for(let ca of O.value){const Da=ca.end-ca.begin,Xa=this.m7f(ca);this.fQk(a,Xa,ca.begin,Da)?k.ULS.sendTraceTag(589866513,aA.yi,50,"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",
d,a,ca.begin,Da):(n.Na(d)||n.add(d,new db.a),n.J(d).add(ca),z.J(d).add(this.Jwl(ca)))}}this.rxb.$(a,n);for(let O of this.rxb.J(a))0<O.value.count&&(a=this.m7f(O.value.J(0)),this.kMi(a,O.value.count,O.key,z.J(O.key)))}Lvi(a){let d=null;a&&(a=Object(qa.a)(224,a.errorDetails))&&a.MA&&(d=a.MA.TypeId);return d}m7f(a){let d=null;a&&(a=Object(qa.a)(224,a.errorDetails))&&a.MA&&(d=a.MA.CategoryTitle);return d}Jwl(a){let d="";a&&a.errorDetails&&(d=Ih.a.yf(a.errorDetails.lcid).name);return d}fQk(a,d,n,z){if((a=
this.lg.$si(a))&&0<a.count)for(let O of a)if(a=Gj.a.getTypeNameFor(O.content),O&&MD.a(a)&&(a=O.content,a.categoryName===d&&a.range.start===n&&a.range.length===z))return!0;return!1}}Object(t.a)(zI,"WacCritiquesByTypeCounter",aA,[225,226]);class fG{constructor(){this.Z=null}get name(){return"WordEditor.CritiqueCounts"}Hb(a){this.Z=a}init(){var a=this.Z.resolve("Common.IAppSettingsManager");if(a.ea("AugLoopOperationsAreEnabled")){this.Z.ha("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter",()=>new zI(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).singleInstance();
this.Z.ha("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter",()=>new vI(this.Z.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.Z.resolve("Common.IAppSettingsManager"))).singleInstance();(a=a.ea("DictationCorrectionsInEditorPaneIsEnabled"))&&this.Z.ha("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter",()=>new yI(this.Z.resolve("Box4.DictationCorrections.IDictationCorrectionManager"))).singleInstance();this.Z.ha("WordEditor.CritiqueCounts.ICritiquesCounter",()=>new xI(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
this.Z.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.Z.resolve("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter"),this.Z.sa("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter"),this.Z.sa("WordEditor.Goals.IGoalCritiqueConfiguration"),this.Z.Ca("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),Ln.a.instance,this.Z.sa("WordEditor.Goals.IGoalChangeSource"),this.Z.resolve("Box4.Graph.IGraphTransactionManager"))).singleInstance();const d=this.Z.resolve("WordEditor.CritiqueCounts.ICritiquesCounter");
this.Z.resolve("Box4.Proofing.IErrorRangeEditor").nWh(Object(m.a)(d,d.ZEm,"onErrorRangesChangedEventHandler"));this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage").eyk(Object(m.a)(d,d.uCm,"onAnnotationOperationEventHandler"));this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage").$Vh(Object(m.a)(d,d.TFg,"onAnnotationLocalStateChangedEventHandler"));a&&(this.Z.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor").LVh(Object(m.a)(d,d.g9i,"onDictationCorrectionChangedHandler")),
this.Z.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor").MVh(Object(m.a)(d,d.g9i,"onDictationCorrectionChangedHandler")))}}dispose(){}static main(){M.a.instance.Sb(new fG)}}Object(t.a)(fG,"WordEditorCritiqueCountsPackage",null,[1,2]);class gG{get name(){return"WordEditor.GraphicsEditor"}Hb(){}init(){}dispose(){}static main(){M.a.instance.Sb(new gG)}}Object(t.a)(gG,"PackageManager",null,[1,2]);var dP=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},
children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",
Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",
Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}}]}]}]}]}]}]}]}]}]}]}]};class AI{constructor(a){this.l8j={};this.ib=a;this.i_b=new cg.a}V3a(a,d){const n=this.ib.Q7a,z=parseInt(a);return a&&z!==Bc.ActionManager.vse?this.i_b.Na(n)?(a=this.i_b.J(n).sGb(z,d,2),32===
a||1===a):!1:!1}yVa(a){const d=parseInt(a),n=this.ib.Q7a;return a&&d!==Bc.ActionManager.vse?this.i_b.Na(n)?32===this.i_b.J(n).sGb(d,this.l8j,1):!1:!0}Zlj(a,d){this.i_b.$(a,d)}XAj(a){a=parseInt(a);const d=this.ib.Q7a;return!!d&&!!this.i_b.J(d)&&this.i_b.J(d).$8l(a)}}Object(t.a)(AI,"NonCanvasCuiUser",null,[861,223]);var iz=b(1053),JB=b(55),OD;(function(a){a[a.UnspecifiedGallery=0]="UnspecifiedGallery";a[a.CharacterCodeGallery=1]="CharacterCodeGallery";a[a.FontStyleGallery=2]="FontStyleGallery";a[a.InkThicknessGallery=
3]="InkThicknessGallery";a[a.IconGallery=4]="IconGallery";a[a.ListGallery=5]="ListGallery";a[a.TableStyleGallery=6]="TableStyleGallery";a[a.PageNumberGallery=7]="PageNumberGallery";a[a.ChangeColorsGallery=8]="ChangeColorsGallery"})(OD||(OD={}));Object(t.b)("GalleryType",OD);class wv{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(t.a)(wv,"CommonGalleryButtonProps",null,[]);class FE extends wv{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=
0}}Object(t.a)(FE,"AdditionalTableStyleGalleryButtonProps",wv,[]);class BI extends FE{constructor(){super()}}Object(t.a)(BI,"AdditionalChangeColorsGalleryButtonProps",FE,[]);class CI extends wv{constructor(){super();this.character=null}}Object(t.a)(CI,"AdditionalCharacterCodeGalleryButtonProps",wv,[]);class DI extends wv{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(t.a)(DI,"AdditionalFontStyleGalleryButtonProps",wv,[]);class EI{constructor(){this.selectedId=this.sections=
this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(t.a)(EI,"AdditionalGalleryProperties",null,[]);class FI extends wv{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(t.a)(FI,"AdditionalIconButtonProperties",wv,[]);class GI extends wv{constructor(){super();this.styleDisplayName=null}}Object(t.a)(GI,"AdditionalInkThicknessGalleryButtonProps",
wv,[]);class HI extends wv{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(t.a)(HI,"AdditionalListGallerButtonProps",wv,[]);class II extends wv{constructor(){super();this.text=null}}Object(t.a)(II,"AdditionalPageNumberGalleryButtonProps",wv,[]);var KC=b(994);const eP=(a,d)=>{var n=appChrome.selectors.getActiveControlStates();if(n=Object(qa.a)(Object,n[a])){if((a=Object(qa.a)(String,n.value))&&a===d)return!1;a=Object(qa.a)(String,n.selectedKey);if(!d&&!a)return!1;if(a){n=Array.isArray(n.options)?
n.options:null;let z=null;for(let O=0;O<n.length;O++){const ca=Object(qa.a)(Object,n[O]);if(Object(qa.a)(String,ca.key)===a){z=ca;break}}if(z&&Object(qa.a)(String,z.text)===d)return!1}}return!0},KI=(a,d,n,z)=>{if(0<(z&2)){z=[];switch(d){case "ToggleButtonModel":case "InkButtonModel":z.push(GE(a,n[Yf.a.On]));break;case "CheckboxModel":z.push(appChrome.actions.toggleCheckbox(a,n[Yf.a.On]));break;case "ComboBoxModel":if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("ReactRibbonDispatchActionFilter")&&
!eP(a,n[Yd.a.Value]))break;(d=n[Yd.a.Key])?z.push(appChrome.actions.updateComboBoxKey(a,d,n[Yd.a.Value])):z.push(appChrome.actions.updateComboBoxValue(a,n[Yd.a.Value]));break;case "FontPickerModel":z.push(appChrome.actions.updateFontPickerSelectedFont(a,n[KC.a.SelectedFont]));break;case "SplitButtonModel":z.push(GE(a,n[Sk.a.On]));break;case "SpinButtonModel":z.push(appChrome.actions.updateSpinButton(a,n[Tg.a.Number],Wf.a.C5b(n[Tg.a.UnitType]),n[Tg.a.Text],n[Tg.a.MaxValue],n[Tg.a.Alt]));break;case "ColorPickerModel":z.push(appChrome.actions.updateColorPickerSelectedColor(a,
n[Gm.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":z.push(appChrome.actions.updatePageNumberGalleryButtonText(a,n[Dg.a.Text]));break;case "CompoundButtonModel":n[Yf.a.Description]&&z.push(appChrome.actions.updateCompoundButtonDescription(a,n[Yf.a.Description]));Yf.a.On in n&&z.push(GE(a,n[Yf.a.On]));break;case "SliderModel":n.snapToStep?z.push(appChrome.actions.updateSliderSelectedValue(a,n[ek.Value])):z.push(appChrome.actions.updateSliderValue(a,n[ek.Value],n[ek.MinValue]||0,n[ek.MaxValue],
n[ek.Text]));break;case "FlyoutAnchorModel":hh.a.ImageIsVisible in n&&z.push(appChrome.actions.hideFlyoutAnchorIcon(a,!n[hh.a.ImageIsVisible]));Yf.a.On in n&&z.push(GE(a,n[Yf.a.On]));break;case "InputBoxModel":z.push(appChrome.actions.updateInputBoxValue(a,n[Hn.a.Text]))}d=z;var O=Object(qa.a)(String,n[rj.a.iconColor]);void 0!==O&&null!==O&&d.push(appChrome.actions.updateIconColor(a,O));JI(a,n,z);d=z;(O=Object(qa.a)(Object,n[rj.a.IconSet]))&&d.push(appChrome.actions.setControlIconSet(a,O));d=z;O=
Object(qa.a)(String,n[rj.a.customTooltip]);void 0!==O&&null!==O&&d.push(appChrome.actions.setControlCustomTooltip(a,O));a=z;(n=Array.isArray(n[rj.a.ESg])?n[rj.a.ESg]:null)&&a.push.apply(a,n);return z}return null},KB=(a,d)=>appChrome.actions.updateControlEnabledDisabledState(a,d),GE=(a,d)=>appChrome.actions.toggleButton(a,d),JI=(a,d,n)=>{d=Object(qa.a)(String,d[rj.a.Icon]);void 0!==d&&null!==d&&n.push(appChrome.actions.setControlIcon(a,d))};class LI{constructor(a,d,n,z){this.Ho=z;this.UFa=a;this.KC=
d;this.hwc=n;this.J5c={}}zRm(a,d,n,z,O=null){const ca=a.ExternalGalleryId||a.ExternalId;var Da=a.ExternalId;z.push(ca);if(appChrome.selectors.isControlDefined(ca))a.GalleryStyle&&xh.d("setGalleryStyles")&&d.push(appChrome.actions.setGalleryStyles(ca,a.GalleryStyle));else{if(4!==a.Type)return;n.push(appChrome.api.createGalleryModel(ca,Object.assign(new EI,{columns:a.Width,sections:[appChrome.api.gallerySection([],Da)],styles:a.GalleryStyle,galleryType:"IconGallery"})))}n=0;if(xh.d("setGallerySections")&&
a.GallerySections&&0<a.GallerySections.length){Da=[];z=[];const Xa=[];for(const zb of a.GallerySections){Da.push(appChrome.api.gallerySection([],zb.SectionId,zb.Title));0===n&&zb.GalleryButtons&&0<zb.GalleryButtons.length&&(n=zb.GalleryButtons[0].Type);const Vb=this.YAf(z,zb.GalleryButtons);z.push.apply(z,this.Iag(Vb,ca,zb.SectionId,!1,n,O,!0));Xa.push.apply(Xa,Vb)}d.push(appChrome.actions.setGallerySections(ca,Da));d.push.apply(d,z);d.push.apply(d,this.Q8f(ca,OD[n],Xa,null,5===a.Type))}else a.GalleryItems&&
0<a.GalleryItems.length&&(n=a.GalleryItems[0].Type),d.push.apply(d,this.Iag(this.YAf(d,a.GalleryItems),ca,Da,!1,n,O))}NKl(a,d){const n=[];let z=null,O=!1;if(!a)return null;const ca=this.UFa.wMd(this.KC,a.commandId,d);n.push(KB(a.externalUxCommand,!ca));if(a.previewControlIds){const zb=[];for(let Vb=0;Vb<a.previewControlIds.length;Vb++){var Da={},Xa=a.previewControlIds[Vb];Da.SourceControlId=Xa;const Fc=this.Ho.getCommandByExternalUxId(Xa);this.Yye(Fc||a,Da);Da[Dg.a.On]&&(z=Da.SourceControlId,Da[Dg.a.HighlightOn]&&
(O=!0));JI(Xa,Da,n);if(Da=Object(qa.a)(Aq.a,Da[Dg.a.GalleryButtonProps]))zb.push(Da),ca&&(Xa=this.UFa.wMd(this.KC,Da.Command,d),Da.IsDisabled=!Xa)}0<zb.length&&n.push.apply(n,this.Iag(this.YAf(n,zb),a.externalUxCommand,a.externalUxCommand,!0,zb[0].Type));n.push(appChrome.actions.updateGallerySelectedId(a.externalUxCommand,z));O&&(k.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",z),n.push(appChrome.actions.highlightSelectedFontStyle(z)))}return n}YAf(a,d){const n=
[],z=[];for(let ca=0;ca<d.length;ca++){const Da=d[ca],Xa=ze.b(Da.ExternalId)?Da.Id:Da.ExternalId;n.push(Xa);switch(Da.Type){case 1:var O=Da;z.push(appChrome.api.createCharacterCodeGalleryButtonModel(Xa,Object.assign(new CI,{disabled:O.IsDisabled,character:O.Character,style:O.Style,title:O.Alt})));break;case 2:O=Da;z.push(appChrome.api.createFontStylesGalleryButtonModel(Xa,Object.assign(new DI,{disabled:O.IsDisabled,styleDisplayName:O.LabelText,style:O.Style,title:O.Alt,previewStyleLabel:O.PreviewStyleLabel})));
break;case 3:O=Da;z.push(appChrome.api.createInkThicknessGalleryButtonModel(Xa,Object.assign(new GI,{disabled:O.IsDisabled,styleDisplayName:O.LabelText,style:O.Style,title:O.Alt})));break;case 4:O=Da;z.push(appChrome.api.createIconGalleryButtonModel(Xa,Object.assign(new FI,{disabled:O.IsDisabled,icon:[O.Icon],fullIconStyle:O.FullIconStyle,previewIconStyle:O.PreviewIconStyle,largePreviewIconStyle:O.LargePreviewIconStyle,label:O.LabelText,title:O.Alt})));break;case 5:O=Da;z.push(appChrome.api.createListGalleryButtonModel(Xa,
Object.assign(new HI,{disabled:O.IsDisabled,infoAtLevel:O.LevelInfo,ariaLabel:O.Alt})));break;case 6:O=Da;z.push(appChrome.api.createTableStyleGalleryButtonModel(Xa,Object.assign(new FE,{disabled:O.IsDisabled,tableCellStyles:O.TableCellStyles,tableStyles:O.TableStyles,title:O.Alt,columns:O.columns})));break;case 8:O=Da;z.push(appChrome.api.createChangeColorsGalleryButtonModel(Xa,Object.assign(new BI,{disabled:O.IsDisabled,tableCellStyles:O.TableCellStyles,tableStyles:O.TableStyles,title:O.Alt})));
break;case 7:O=Da,z.push(appChrome.api.createPageNumberGalleryButtonModel(Xa,Object.assign(new II,{disabled:O.IsDisabled,text:O.Text,title:O.Alt})))}this.Ho.addCommandToMaps(Object.assign(new JB.a(Xa,Da.Command),{queryCommandId:Da.QueryCommand,menuItemId:Da.MenuItemId}))}a.push(appChrome.actions.addControls(z));return n}Iag(a,d,n,z,O,ca=null,Da=!1){const Xa=[];z?Xa.push(appChrome.actions.populateGalleryItems(d,a)):(this.J5c[d]=!1,Da||(z=!0,appChrome.selectors.isControlDefined(d)&&(z=appChrome.selectors.getGalleryState(d),
z=z.disableIndividualButtons?z.disableIndividualButtons:!0),Xa.push.apply(Xa,this.Q8f(d,OD[O],a,null,5===O,z,ca))),Xa.push(appChrome.actions.updateGallerySectionItems(d,n,a)));return Xa}dBl(a){return this.Q8f(a.ExternalUxId,a.galleryType,a.items,a.sections,a.isListGallery,a.disableIndividualButtons?a.disableIndividualButtons:!0)}Q8f(a,d,n,z,O,ca=!0,Da=null){const Xa=[];if(a in this.J5c){if(this.J5c[a])return delete this.J5c[a],Xa;this.J5c[a]=!0}let zb=null,Vb=-1;if(n)({Kri:Vb,returnValue:zb}=this.uUh(d,
n,Xa,ca,Da));else if(z)for(const Fc of z)(n=({Kri:Vb}=this.uUh(d,Fc.galleryButtons,Xa,ca)).returnValue)&&(zb=n);Xa.push(appChrome.actions.updateGallerySelectedId(a,zb));ca&&Xa.push(KB(a,!1));O&&0<Vb&&Xa.push(appChrome.actions.updateListGalleryTextDirection(a,2===Vb));return Xa}uUh(a,d,n,z,O=null){let ca,Da=null;ca=-1;let Xa=!1;for(const Vb of d){var zb=this.bBl(a);d={};d.SourceControlId=Vb;d.Location=O;const Fc=this.Ho.getCommandByExternalUxId(Vb);if(!Fc)continue;const Yc=this.Yye(Fc,d);z&&n.push(KB(Vb,
1>(Yc&1)));(zb=KI(Vb,zb,d,Yc))&&n.push.apply(n,zb);d[Dg.a.On]&&(Da=Vb,d[Dg.a.HighlightOn]&&d[Dg.a.HighlightOn]&&(Xa=!0));void 0!==d[rj.a.labelText]&&null!==d[rj.a.labelText]&&n.push(appChrome.actions.setControlLabel(Fc.externalUxCommand,d[rj.a.labelText]));d[Dg.a.IsRtl]&&0>ca&&(ca=d[Dg.a.IsRtl])}Xa&&(k.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",Da),n.push(appChrome.actions.highlightSelectedFontStyle(Da)));return{returnValue:Da,Kri:ca}}bBl(a){switch(a){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";
case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}Yye(a,d){d.MenuItemId=a.menuItemId;return this.UFa.rCa(this.KC,this.hwc,
a.commandId,a.queryCommandId,d)}}Object(t.a)(LI,"ReactGalleryPoller",null,[]);var fP=b(763),MI=b(606);class NI{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(t.a)(NI,"PopulateFontPickerDataProps",null,[]);var OI=b(285),jz=b(1668);class PI extends Ww{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(t.a)(PI,"OptionalCompoundButtonProperties",
Ww,[]);class QI extends Ww{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(t.a)(QI,"OptionalFlyoutAnchorProperties",Ww,[]);class RI extends Xw{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(t.a)(RI,"OptionalPersonaButtonProperties",Xw,[]);class HE extends Ww{constructor(){super();this.toggled=!1;this.roleInMenu=
null;this.toggleUsingIcon=!1}}Object(t.a)(HE,"OptionalToggleButtonProperties",Ww,[]);var gP=b(1526),hP=b(1525),iP=b(467);class SI{constructor(){this.y8h=this.actions=null;this.wSj=!1}}Object(t.a)(SI,"PopulateActions",null,[]);class hG{rEi(a,d){switch(d){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(a);case "ToggleButtonModel":return this.tLl(a);case "InkButtonModel":return this.sLl(a);case "GalleryModel":return appChrome.selectors.getGalleryState(a);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(a);
case "SliderModel":return appChrome.selectors.getSliderState(a)}return{}}tLl(a){const d={};d[Yf.a.On]=appChrome.selectors.getButtonToggleState(a);return d}sLl(a){const d={};d[Yf.a.On]=xh.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(a):appChrome.selectors.getButtonToggleState(a);return d}}Object(t.a)(hG,"ReactStatePropsSelector",null,[]);class IE{constructor(a,d,n,z,O){this.UFa=a;this.KC=d;this.hwc=n;this.Ho=z;this.bwf={};this.Akk=new hG;this.DZb=O}SDj(a){const d=a.populationProps.populateQueryCommandId;
return a.populationProps.populateOnlyOnce&&d in this.bwf}PLl(a,d,n=null){const z=[],O={};if(!this.SDj(a)){const ca=a.populationProps.populateQueryCommandId,Da={};Da.MenuId=a.externalUxCommand;Da.IsShadowMenuOpen=this.isShadowMenuOpen(n);if(0<(this.UFa.rCa(this.KC,this.hwc,ca,ca,Da,this.oDl(n))&1))if("FontPickerModel"===d)this.bwf[ca]=!0,z.push(IE.vKl(a,Da)),O[a.externalUxCommand]="FontPickerModel";else if(Da.MenuItems)switch(this.bwf[ca]=!0,d){case "ComboBoxModel":z.push(IE.tKl(a,Da));O[a.externalUxCommand]=
"ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":z.push.apply(z,this.iGi(a.externalUxCommand,d,Da.MenuItems,O,n&&"location"in n?n.location:null))}}return Object.assign(new SI,{actions:z,y8h:O,wSj:this.isShadowMenuOpen(n)})}iGi(a,d,n,z,O=null){const ca=[],Da=[],Xa=[],zb=[];for(let Vb=0;Vb<n.MenuSectionList.length;Vb++){const Fc=Object(qa.a)(fi.a,n.MenuSectionList[Vb]);if(!Fc)continue;let Yc=
null;const yd=[];ze.c(Fc.Title)||(Yc=Fc.Title);for(let je=0;je<Fc.ControlList.length;je++){const Le=Object(qa.a)(io.a,Fc.ControlList[je]);if(!Le||Le.ExternalId)z&&this.Vul(Le,z),ca.push.apply(ca,this.uKl(Le,Da,yd,zb,a,d,O))}n.UpdateDynamically&&Xa.push(appChrome.api.menuSection(yd,Yc,Fc.Lang))}n.UpdateDynamically&&ca.push(appChrome.actions.updateMenu(a,Xa,n.Title,n.AriaLabel,n.ShouldAutoOpen,n.AriaRoleDescription,n.MenuTargetDescriptor));0<Da.length&&ca.splice(0,0,appChrome.actions.addControls(Da));
0<zb.length&&xh.d("setStatefulSplitButtonMruBypassControls")&&ca.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(a,zb));return ca}Vul(a,d){switch(a.ControlType){case 1:case 3:d[a.ExternalId]=1===a.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:d[a.ExternalId]="ToggleButtonModel";break;case 6:d[a.ExternalId]="CheckboxModel";break;case 7:d[a.ExternalId]="ColorPickerModel";a=Object(qa.a)(Tz.a,a);a.McuLayout&&(d[a.McuExternalId]="ColorPickerModel");break;case 9:d[a.ExternalId]=
"FlyoutAnchorModel"}}uKl(a,d,n,z,O,ca,Da=null){const Xa=[];switch(a.ControlType){case 1:case 3:z=Object(qa.a)(Xg.a,a);this.kRm(z,Xa,d,n);z.MenuItemsStatefulData&&xh.d("setStatefulSplitButtonMenuItemsStatefulData")&&Xa.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(O,z.MenuItemsStatefulData));break;case 2:this.NRm(Object(qa.a)(iP.a,a),Xa,d,n);break;case 6:this.mRm(Object(qa.a)(Gf.a,a),Xa,d,n);break;case 4:this.HRm(Object(qa.a)(Lm,a),Xa,d,n);break;case 7:this.oRm(Object(qa.a)(Tz.a,
a),Xa,d,n);break;case 9:O=Object(qa.a)($i.a,a);this.vRm(O,Xa,d,n);"StatefulSplitButtonModel"===ca&&z.push(O.ExternalId);break;case 8:this.DZb.zRm(Object(qa.a)(Vq.a,a),Xa,d,n,Da)}return Xa}kRm(a,d,n,z){z.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&d.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),a.Description&&d.push(appChrome.actions.updateCompoundButtonDescription(a.ExternalId,a.Description)),a.CommandValueId&&d.push(appChrome.actions.setButtonCommandValueId(a.ExternalId,
a.CommandValueId)),this.fje()&&((n=this.N4a(a))&&0<n.length&&d.push(appChrome.actions.setControlIconSet(a.ExternalId,(new jz.a(n)).iconSet)),a.LabelText!==a.Alt&&d.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(a.Description||Object(Uc.a)(CA,a)?n.push(appChrome.api.createCompoundButtonModel(a.ExternalId,a.LabelText,a.Description,Object.assign(new PI,{iconSet:(new jz.a(this.N4a(a))).iconSet,keytip:a.KeyTip,roleInMenu:a.RoleInMenu,ariaDescription:a.AriaDescription,customTooltip:a.LabelText!==
a.Alt?a.Alt:null}))):n.push(appChrome.api.createButtonModel(a.ExternalId,a.LabelText,Object.assign(new Xw,{iconSet:(new jz.a(this.N4a(a))).iconSet,keytip:a.KeyTip,supportsPreview:!!a.CommandPreviewId&&!!a.CommandRevertId,customTooltip:a.LabelText!==a.Alt?a.Alt:null,commandValueId:a.CommandValueId}))),this.Ho.addCommandToMaps(Object.assign(new JB.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand,commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));
a.Lang&&xh.d("setControlLanguage")&&d.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}mRm(a,d,n,z){z.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&d.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.fje()&&((n=this.N4a(a))&&0<n.length&&d.push(appChrome.actions.setControlIconSet(a.ExternalId,(new jz.a(n)).iconSet)),a.IsChecked&&d.push(appChrome.actions.toggleButton(a.ExternalId,a.IsChecked)),a.LabelText!==a.Alt&&d.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,
a.Alt)))):(n.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new HE,{iconSet:(new jz.a(this.N4a(a))).iconSet,keytip:a.KeyTip,toggled:a.IsChecked,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null,toggleUsingIcon:!!a.CheckedImageClass}))),this.Ho.addCommandToMaps(Object.assign(new JB.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}NRm(a,d,n,z){z.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?
(a.LabelText&&d.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.fje()&&((n=this.N4a(a))&&0<n.length&&d.push(appChrome.actions.setControlIconSet(a.ExternalId,(new jz.a(n)).iconSet)),l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&a.LabelText!==a.Alt&&d.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?
n.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new HE,{iconSet:(new jz.a(this.N4a(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null}))):n.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new HE,{iconSet:(new jz.a(this.N4a(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel}))),
this.Ho.addCommandToMaps(Object.assign(new JB.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}HRm(a,d,n,z){z.push(a.ExternalId);z=this.fKl(a);appChrome.selectors.isControlDefined(a.ExternalId)?a.LabelText&&d.push(appChrome.actions.setPersonaButtonCoauthor(a.ExternalId,z,a.LabelText)):xh.a("createPersonaButtonModel")&&n.push(appChrome.api.createPersonaButtonModel(a.ExternalId,z,a.LabelText,Object.assign(new RI,{role:a.RoleInMenu,fullDescriptionLabel:a.AriaDescription,
iconSet:{["default"]:"doughboywhiteglyph_20"}})))}vRm(a,d,n,z){z.push(a.ExternalId);if(appChrome.selectors.isControlDefined(a.ExternalId))a.LabelText&&d.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.fje()&&((n=this.N4a(a))&&0<n.length&&d.push(appChrome.actions.setControlIconSet(a.ExternalId,(new jz.a(n)).iconSet)),void 0!==a.ImageIsVisible&&null!==a.ImageIsVisible&&d.push(appChrome.actions.hideFlyoutAnchorIcon(a.ExternalId,!a.ImageIsVisible)),void 0!==a.Toggled&&null!==a.Toggled&&
d.push(appChrome.actions.toggleButton(a.ExternalId,a.Toggled)));else{z=!(void 0===a.ImageIsVisible||null===a.ImageIsVisible)&&!a.ImageIsVisible;const O=!(void 0===a.Toggled||null===a.Toggled)&&a.Toggled;n.push(appChrome.api.createFlyoutAnchorModel(a.ExternalId,a.LabelText,Object.assign(new QI,{iconSet:(new jz.a(this.N4a(a))).iconSet,keytip:a.KeyTip,hideIcon:z,toggled:O,roleInMenu:a.AriaLabel})));this.Ho.addCommandToMaps(Object.assign(new JB.a(a.ExternalId,a.Command),{queryCommandId:a.QueryCommand,
populationProps:new fP.a(a.PopulateQueryCommand,a.PopulateOnlyOnce)}))}a.Menu&&d.push.apply(d,this.iGi(a.ExternalId,"FlyoutAnchorModel",a.Menu,null));a.Lang&&d.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}oRm(a,d,n,z){a.McuLayout&&z.push(a.McuExternalId);z.push(a.ExternalId);z=0;appChrome.selectors.isControlDefined(a.ExternalId)?a.McuLayout&&(z=this.Akk.rEi(a.ExternalId,"ColorPickerModel").columnCount):(a.McuLayout&&(n.push(appChrome.api.createColorPickerModel(a.McuExternalId,a.Width)),
this.Ho.addCommandToMaps(Object.assign(new JB.a(a.McuExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})),z=a.Width),n.push(appChrome.api.createColorPickerModel(a.ExternalId,a.Width)),this.Ho.addCommandToMaps(Object.assign(new JB.a(a.ExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));n=[];const O=[];for(let ca=0;ca<a.Colors.length;ca++){const Da=a.Colors[ca];ca<z?n.push(appChrome.api.colorPickerCell(Da.Color,
Da.DisplayColor,Da.Alt)):O.push(appChrome.api.colorPickerCell(Da.Color,Da.DisplayColor,Da.Alt))}0<n.length&&d.push(appChrome.actions.populateColorPickerCells(a.McuExternalId,n));d.push(appChrome.actions.populateColorPickerCells(a.ExternalId,O));a.SelectedColorId&&(0<n.length&&d.push(appChrome.actions.updateColorPickerSelectedColor(a.McuExternalId,a.SelectedColorId)),d.push(appChrome.actions.updateColorPickerSelectedColor(a.ExternalId,a.SelectedColorId)))}N4a(a){return a.Image32by32Class?this.Ho.Xwi(a.Image32by32Class):
a.Image16by16Class?this.Ho.Xwi(a.Image16by16Class):a.ExternalImageId}fKl(a){return a?Object.assign(new hP.a,{displayName:a.DisplayName,personaCoinColor:a.ImageBackColor,isUnauthenticatedSender:a.IsAnonymous,identifiers:Object.assign(new gP.a,{PersonaType:"User",Smtp:a.PersonaId})}):null}oDl(a){let d=2;a&&"inputMethod"in a&&a.inputMethod&&(d=a.inputMethod);return d}isShadowMenuOpen(a){return!!a&&a.isShadowRendering}fje(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",
!1)}static vKl(a,d){return appChrome.actions.populateFontPickerDataAsync(new Promise((n,z)=>{la.a.instance.Ca("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(O=>{O.isFeatureEnabled(OI.a.MIb,!1).then(ca=>{let Da=d.fonts;ca||O.isFreemiumUpsellEnabled()||(Da=Fg.a.Xgh(Da,Xa=>Xa.fontType!==OI.a.gPc));ca=Object.assign(new NI,{commandId:a.externalUxCommand,fonts:Da,isSubscriber:ca,mruList:d.mruList,initialPinnedFontKeys:d.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});
n(ca)}).catch(z)})}))}static tKl(a,d){const n=[];for(let z=0;z<d.MenuItems.MenuSectionList.length;z++){const O=d.MenuItems.MenuSectionList[z];O.Title&&n.push(appChrome.api.comboBoxHeader("Header-"+z.toString(),O.Title));for(let ca=0;ca<O.ControlList.length;ca++){const Da=Object(qa.a)(MI.a,O.ControlList[ca]);Da&&n.push(appChrome.api.comboBoxItem(Da.MenuItemId,Da.LabelText,Da.Styles,Da.CommandValueId,Da.AriaLabel,Da.Data,Da.Disabled))}z<d.MenuItems.MenuSectionList.length-1&&n.push(appChrome.api.comboBoxDivider("Divider-"+
z.toString()))}return appChrome.actions.populateComboBoxOptions(a.externalUxCommand,n)}}Object(t.a)(IE,"ReactPopulateQueryCommandPoller",null,[]);class TI{constructor(a,d,n,z,O){this.Ho=n;this.UFa=a;this.KC=d;this.hwc=z;this.DZb=O}OLl(a,d,n){const z=[];if(this.k9l(d))a=this.cPl(a,d,n),void 0!==a&&null!==a&&z.push.apply(z,a);else if(a){var O=this.Yye(a,n);rj.a.visible in n&&z.push(appChrome.actions.updateControlHiddenState(a.externalUxCommand,!n[rj.a.visible]));z.push(KB(a.externalUxCommand,1>(O&1)));
void 0!==n[rj.a.labelText]&&null!==n[rj.a.labelText]&&z.push(appChrome.actions.setControlLabel(a.externalUxCommand,n[rj.a.labelText]));void 0!==d&&null!==d&&(O=KI(a.externalUxCommand,d,n,O),void 0!==O&&null!==O&&z.push.apply(z,O),"PeopleWell"===d&&this.Uvk(a.externalUxCommand,n,z))}return z}Tyl(a,d,n){const z=[];switch(d){case "FlyoutAnchorModel":var O=appChrome.selectors.getFlyoutAnchorMenuItems(a);break;case "SplitButtonModel":var ca=appChrome.selectors.getSplitButtonState(a);if(ca=this.Ho.getCommandByExternalUxId(ca.command))n=
this.UFa.wMd(this.KC,ca.commandId,n),z.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(a,!n)),z.push(KB(a,!1));return z;default:return null}d=!1;for(ca in O)if(O=this.Ho.getCommandByExternalUxId(ca),ze.c(O))d=!0;else if(n.SourceControlId=O.externalUxCommand,this.UFa.wMd(this.KC,O.commandId,n))return z.push(KB(a,!1)),z;z.push(KB(a,!d));return z}cPl(a,d,n){switch(d){case "PreviewGalleryModel":return this.DZb.NKl(a,n);case "GalleryModel":return this.DZb.dBl(n)}return null}k9l(a){return"GalleryModel"===
a||"PreviewGalleryModel"===a}Yye(a,d){d.MenuItemId=a.menuItemId;return this.UFa.rCa(this.KC,this.hwc,a.commandId,a.queryCommandId,d)}Uvk(a,d,n){const z=d[hh.a.LabelTextUserGeneratedPlaceholderReplacements];d=d[hh.a.LabelText];z&&0<z.length&&(d=String.format.apply(null,[d].concat(z)));n.push(this.xSl(a,d))}xSl(a,d){return appChrome.actions.updatePeopleWell(this.Mul(a),d)}Mul(a){const d=[];var n={};a=this.Ho.getCommandByExternalUxId(a).populationProps.populateQueryCommandId;this.UFa.rCa(this.KC,this.hwc,
"1285265560",a,n);n=n.MenuItems;if(!n)return d;n=n.MenuSectionList[0];for(a=0;a<n.ControlList.length;a++){const z=n.ControlList[a],O={};O.name=z.Alt;O.id=z.MenuItemId;O.description=z.Description;O.color=z.ImageBackColor;O.joinTime=z.JoinTimeInMS;O.imageUrl=z.ImageUrl;O.activeStatus=z.ActiveStatus;O.isAnonymous=z.IsAnonymous;O.canJump=z.CanJump;O.upn=z.Upn;d.push(O)}return d}}Object(t.a)(TI,"ReactQueryCommandPoller",null,[]);var jP=b(1496);class UI{constructor(a,d,n){this.Ho=a;this.KC=d;a=new jP.a;
this.Bok=new hG;this.DZb=new LI(a,this.KC,n,this.Ho);this.OKh=new IE(a,this.KC,n,this.Ho,this.DZb);this.HKh=new TI(a,this.KC,this.Ho,n,this.DZb)}QTa(){const a=[];if(!xh.c())return a;a.push.apply(a,this.vSl());var d=this.fyl();if(0<d.length)a.push.apply(a,d);else if(d=appChrome.selectors.getActiveControlIds(),Object.keys(d).length){const n=this.gyl();for(const z of n)a.push(appChrome.actions.updateControlEnabledDisabledState(z,!0)),delete d[z];a.push.apply(a,this.tAe(d))}return a}xMd(a,d){xh.c()&&
(a=this.tAe(a,d),appChrome.api.dispatch(a))}cNg(a,d,n=null){if(!ze.c(a)&&a.populationProps&&!this.OKh.SDj(a)){a=this.OKh.PLl(a,d,n);if(!a.wSj){let z;(z=a.actions).push.apply(z,this.tAe(a.y8h,xh.g(n)))}if(0<a.actions.length)return appChrome.api.dispatch(a.actions),!0}return!1}tAe(a,d=0){const n=[],z={};if(xh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var O of appChrome.selectors.getActiveGroupIds())for(var ca of appChrome.selectors.getVisibleControlsInGroup(O))z[ca]=
!0;for(let Da in a)O=Da,ca=a[Da],0===d&&z[O]&&(d=2),n.push.apply(n,this.uSl(O,ca,d));return n}uSl(a,d,n=0){const z=[],O=this.Ho.getCommandByExternalUxId(a);let ca={};appChrome.selectors.isControlDefined(a)&&(ca=this.Bok.rEi(a,d));ca[iz.a.kVc]=n;ze.c(O)?(ca.ExternalUxId=a,(a=this.HKh.Tyl(a,d,ca))&&0<a.length&&z.push.apply(z,a)):(ca.MenuItemId=O.menuItemId,ca.SourceControlId=a);z.push.apply(z,this.HKh.OLl(O,d,ca));return z}vSl(){const a=[],d=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("ReactRibbonDispatchActionFilter"),
n=appChrome.selectors.getContextualTabIds();let z=[];d&&(z=appChrome.selectors.getActiveContextualTabIds());for(let ca=0;ca<n.length;ca++){var O=this.Ho.vcg(n[ca]);if(O){O=this.KC.yVa(O);let Da=!0;d&&(Da=0<=Array.indexOf(z,n[ca]));d&&Da===O||a.push(appChrome.actions.activateDeactivateContextualTab(n[ca],O))}}return a}fyl(){var a=appChrome.selectors.getSelectedTabId();const d=[],n=this.Ho.vcg(a);n&&(this.KC.yVa(n)||d.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(a,!0)));return d}gyl(){var a=
appChrome.selectors.getActiveGroupIds();const d=[];for(const n of a)if(a=this.Ho.tBl(n))for(const z of a)this.KC.yVa(z.commandId)||((a=z.externalUxCommandIds)||(a=appChrome.selectors.getVisibleControlsInGroup(z.externalUxGroupId)),d.push.apply(d,a));return d}}Object(t.a)(UI,"ReactRibbonRootPoller",null,[846]);class JE{constructor(a,d,n=null){this.KC=this.iOa=this.tAb=null;this.Qvc=d;a.Lxa(this);this.XI=n}get oBa(){this.iOa||(this.iOa=new Date,this.iOa.setTime(0));return this.iOa}set oBa(a){this.iOa=
a}get xha(){return 2}get XI(){return this.KC}set XI(a){this.KC=a}get eQc(){this.tAb||(this.tAb=new UI(this.Qvc,this.XI,this.xha));return this.tAb}eDb(){const a=document.activeElement;ae.a.isEditable(a)&&a.blur()}executeCommand(a,d,n,z,O,ca,Da,Xa=2){ze.c(this.XI)||(O=new zm.a,O.CommandLocation=Xa,O.InvocationMethod=z,O.CommandTabName=n,this.xAc(),d[iz.a.kVc]=Xa,this.XI.V3a(a,d,O,ca,Da),this.zmm(a,d))}QTa(){return ze.c(this.XI)?[]:this.eQc.QTa()}Km(){const a=this.QTa();0<a.length&&(this.oBa=new Date,
appChrome.api.dispatch(a))}P_d(){xh.c()&&this.eQc.xMd({PeopleWell:"PeopleWell"},18)}u_d(){}xAc(){const a=la.a.instance.sa("Common.ISystemInitiatedFeedback");a?a.logActivity("SLRCommandUsed","FGSLRUsageEnabled"):k.ULS.sendTraceTag(561394446,340,50,"ISystemInitiatedFeedback was null")}zmm(a,d){try{const n=la.a.instance.sa("Common.ISystemInitiatedFeedback");if(n&&d){const z=d.SourceControlId||d.launcherId||d.LegacyId||d.NewContextId;let O=(z?"_"+z:"")+(d.SqmControlId?"_"+d.SqmControlId:"");O=O.length?
O:"_"+a;n.Iwg("Ribbon"+O)}}catch(n){k.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(n?n.toString():""))}}}Object(t.a)(JE,"ReactRibbonRoot",null,[642,847]);var KE=b(1440);class VI{constructor(a){this.jzf=this.Ogf=!1;this.Gxb=null;this.upa=this.aqh=!1;this.Yrf=a;Eg.a.instance.Ea(vb.a.Mq,this.Ftd(),Object(m.a)(this,this.aEm,"onContextualUIMouseDown"));l.AFrameworkApplication.K.ea("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&l.AFrameworkApplication.la.eb.eM?Bi.a.get_instance().Ik(16,
()=>{this.eJa?this.initializeContextualUI(this.Ftd()):Bi.a.get_instance().Ik(7,()=>{this.initializeContextualUI(this.Ftd())})}):Bi.a.get_instance().Ik(7,()=>{this.initializeContextualUI(this.Ftd())})}get PIa(){return this.upa}get eJa(){return l.AFrameworkApplication.K.ea("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&l.AFrameworkApplication.la.eb.eM?Bi.a.get_instance().isCompleted(16)&&Bi.a.get_instance().isCompleted(7):Bi.a.get_instance().isCompleted(7)}YNk(){if(this.aqh)return!0;try{return Promise.resolve(null),
this.aqh=!0}catch(a){return!1}}rch(a){if(!this.eJa||this.jzf)return this.Sxg("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.YNk())return this.Sxg("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(l.AFrameworkApplication.Ifa)return this.Sxg("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.jzf=!0;let d=Sa.a.rc;switch(a){case 1:d=Sa.a.showContextMenu;break;case 0:d=Sa.a.showFloatie;break;case 2:d=
Sa.a.SNb}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.jzf=!1;we.c(d)},0)});return!1}AGi(a){return xk.UISurfaces.C4a().then(d=>{if(appChrome.api.isSmallDevice()&&d.getBlockedSmallScreenFloatieGroupList){d=d.getBlockedSmallScreenFloatieGroupList();const n=[];for(const z of a)Array.contains(d,z)||n.push(z);return n}return a})}showFloatie(a,d,n){this.rch(0)||this.AGi(d).then(z=>{if(0>=z.length)return null;this.f3g(z).then(()=>{const O={};O.target=a;xk.UISurfaces.C4a().then(ca=>{appChrome.api.dispatch(ca.showFloatie(O,
n));this.upa=!0;return null})});return null})}showContextMenu(a,d,n=null,z=null){this.rch(1)||this.iCj(a,d,n,z)}iCj(a,d,n=null,z=null){this.f3g(null).then(()=>{const O={};O.target=a;z&&(O.directionalHint=z);xk.UISurfaces.C4a().then(ca=>{appChrome.api.dispatch(ca.showContextMenu(O,d,n));return null})})}i9a(a,d,n,z=null){this.rch(2)||this.AGi(d).then(O=>{0>=O.length?this.iCj(a,n,z):this.f3g(O).then(()=>{const ca={};ca.target=a;const Da={};Da.target=a;xk.UISurfaces.C4a().then(Xa=>{appChrome.api.dispatch(Xa.showContextualUI(ca,
Da,n,void 0,z));this.upa=!0;return null})});return null})}Sxg(a){k.ULS.sendTraceTag(561394519,340,15,a)}bXf(){this.eJa&&xk.UISurfaces.isLoaded()&&xk.UISurfaces.C4a().then(a=>{appChrome.api.dispatch(a.hideContextMenu());return null})}OA(){this.eJa&&xk.UISurfaces.isLoaded()&&xk.UISurfaces.C4a().then(a=>{this.upa=!1;appChrome.api.dispatch(a.hideFloatie());return null})}fpd(){this.eJa&&xk.UISurfaces.isLoaded()&&xk.UISurfaces.C4a().then(a=>{appChrome.api.dispatch(a.hideContextualUI());this.upa=!1;return null})}initializeContextualUI(a){return xk.UISurfaces.C4a().then(d=>
{this.Ogf||(d.initializeContextualUI(a),this.Ogf=!0);return null})}f3g(a){if(!this.Ogf)return this.initializeContextualUI(this.Ftd()).then(()=>{this.setActiveFloatieGroups(a);return null});this.setActiveFloatieGroups(a);return Promise.resolve(null)}setActiveFloatieGroups(a){if(a&&a.length){var d=[];d.push(appChrome.actions.setActiveFloatieGroups(a));appChrome.api.dispatch(d);var n=[];xk.UISurfaces.C4a().then(z=>{n.push.apply(n,this.Yrf.eQc.tAe(z.selectors.getFloatieOnlyControlsMap(),9));0<n.length&&
appChrome.api.dispatch(n);return null})}}Ftd(){if(this.Gxb)return this.Gxb;this.Gxb=KE.a("div");this.Gxb.id="ReactContextualUIDiv";this.Gxb.style.position="absolute";this.Gxb.style.zIndex="1001";document.body.insertBefore(this.Gxb,document.body.firstChild);return this.Gxb}aEm(a){a.Ua&&a.Ua.target&&"input"===a.Ua.target.tagName.toLowerCase()&&ic.FocusManager.instance().Wv("ribbon");return!1}}Object(t.a)(VI,"ReactContextualUILauncher",null,[848]);class WI extends Zv.a{constructor(){super()}}Object(t.a)(WI,
"FloatieBuildOptions",Zv.a,[]);class XI extends fz.a{constructor(){super()}}Object(t.a)(XI,"FloatieBuildContext",fz.a,[]);var kP=b(1364);class YI extends ac.Builder{constructor(a,d,n){super(a,d,n,null);if(ze.c(d))throw Error.create("Floatie placeholder DOM element is null or undefined.");}get floatie(){return this.root}Fpn(a){this.root=a}cJk(){const a=new XI,d=new Oh.a;d.MOd=1;d.handler=Object(m.a)(this,this.gJm,"onReturnFloatieData");d.data=a;this.lHa.fWe(d)}gJm(a){this.dJk(a.$Nd,a.jmd);this.floatie.Gpi=
this;this.floatie.Cn();this.floatie.Pb.style.display="none";this.placeholder.appendChild(this.floatie.Pb);this.HGa.continueWith(()=>{this.HGa.result.ogc(this.floatie)},11);bi.a.instance.Ea(vb.a.pointerDown,this.floatie.Pb,Object(m.a)(this.floatie,this.floatie.ZF,"onPointerDown"))}dJk(a,d){a=Di.a.oba(a,Di.a.MXj);if(ze.c(a))throw Error.create("No floatie element was present in the data");a=new Di.a(a);this.Fpn(new tg(a.attributes[Di.a.id],a.attributes));a=Di.a.oba(a.node,Di.a.Hpc);this.MIf(a,d)}MIf(a,
d){a=Di.a.yw(a);for(let n=0;n<a.length;n++){if(this.Y5a(a[n]))continue;const z=this.VIf(a[n],d);this.floatie.Re(z)}}VIf(a,d){var n=new Di.a(a);a=new kP.Group(this.floatie,n.attributes[Di.a.id],n.attributes[Di.a.jEa],n.attributes[Di.a.BWc],n.attributes[Di.a.o$a],!1,n.name===Di.a.e0j,!1,n.attributes);n=Di.a.yw(n.node);for(let z=0;z<n.length;z++)a.Re(this.rle(n[z],d));return a}rle(a,d){a=new Di.a(a);var n=a.attributes[Di.a.id];a=Di.a.yw(a.node);var z=2;2===a.length&&(z=3);n=new gc.a(this.floatie,n,z,
2,1);for(z=0;z<a.length;z++){const ca=new Di.a(a[z]);var O=Di.a.oba(ca.node,Di.a.vwb);O=Di.a.yw(O);this.cJf(n.uze(z+1),O,ca.attributes[Di.a.id],d)}return n}cJf(a,d,n,z){for(n=0;n<d.length;n++){if(this.Y5a(d[n]))continue;const O=new Di.a(d[n]),ca=this.waa(d[n],z);ca&&a.Re(ca.uX(O.attributes[Di.a.CWc]))}}}Object(t.a)(YI,"FloatieBuilder",ac.Builder,[]);class PD{constructor(a,d){this.ut=null;this.dVk=a;this.Pbf=d}get floatie(){return this.ut}fDb(a,d,n){d=new qj.CuiHelper(ul.a.A2a,Box4Intl.Box4Strings,
null,null,d);const z=new WI;z.dL=n||{};n=(n=la.a.instance.sa("Box4.IFeatureHelper"))?n.fq(22):Lb.App.q4b;z.dL.floatieshadingColor=!n;const O=new YI(z,document.body,this.dVk.isj);O.lHa=new hz.a(a,d);O.cJk();this.Pbf.execute(ca=>{O.floatie.XI=ca});O.floatie.Q3m(Object(m.a)(this,this.INc,"onFloatieDismissed"));O.floatie.l3m(Object(m.a)(this,this.$Bl,"getHiddenFloatieGroups"));this.ut=O.floatie;return this.floatie}$Bl(){return[]}}Object(t.a)(PD,"AFloatieInitializer",null,[]);class ZI extends PD{constructor(a,
d,n,z){super(d,n);this.gh=a;this.eI=z}fDb(a,d,n){if(a=super.fDb(a,d,n))a.kPc=!0,a.GRe=!0,a.preventDismissOnScroll=!0;this.gh.m2a(Object(m.a)(this,this.VMg,"pollForStateAndUpdateFloatie"));return a}fAd(a,d,n=null){this.eI.B0h(()=>this.fDb(a,d,n))}INc(){this.floatie.kPc=!0}VMg(){this.floatie.Km()}}Object(t.a)(ZI,"PasteFloatieInitializer",PD,[]);var iG=b(731);class Lx{J8(a,d){this.rOk&&this.pun(a,d,Lx.Uzg,Lx.Ba)}pun(a,d,n,z){switch(n){case 1:case 6:case 2:case 3:case 4:Lx.JYf.show(z,a,d)}}Szg(){switch(Lx.Uzg){case 5:case 1:return!0;
default:return!1}}h6k(){return Lx.Uzg}get rOk(){return 1!==Lb.App.oa.state}static get JYf(){return Lx.G0c||(Lx.G0c=la.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu"))}static NFl(a){if(!a)return 0;if(2===Lb.App.oa.mode){const d=a.ra.node,n=Dd.GraphIterator.ua(d);n.tn();return ih.e(n.currentNode)?2:l.AFrameworkApplication.Zoc||!rw.isEmbeddedFileNode(d)||rw.isInvalid(d)?Yj.d(a.ra)||Yj.b(a.ra)?6:1:3}return 4}static get Ba(){return Lg.a.instance.ya.Ba}static get Uzg(){return Lx.NFl(Lx.Ba)}}Lx.G0c=
null;Object(t.a)(Lx,"SelectionContextMenuProvider",null,[1093]);var LE=b(1667);class ME{constructor(a,d){this.GRe=this.kPc=!1;this.qyd=!0;this.GT=a;this.Ho=d}get isVisible(){return this.GT.PIa}get controls(){return null}OA(){this.GT.OA();return!0}UZf(){}j9a(a,d,n){this.GT.showFloatie(Object.assign(new LE.a,{x:a.x,y:a.y}),this.T4f(n),n)}r9b(){return new Sys.UI.Bounds(0,0,0,0)}N3(){return this.OA()}T4f(){return[]}}Object(t.a)(ME,"ReactFloatie",null,[272,273]);class $I{constructor(a){this.W4d=null;this.GT=
a}dispose(){}N3(){this.GT.fpd();return!0}showContextMenu(a,d){this.kmc(a,d.clientPoint,d.ed)}kmc(a,d,n){this.Vtb(a,new Sys.UI.Bounds(d.x,d.y,0,0),n);k.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",a)}Vtb(a,d,n,z=null){this.W4d?this.GT.i9a(Object.assign(new LE.a,{x:d.x,y:d.y}),this.W4d.T4f(n),n,a):this.GT.showContextMenu(Object.assign(new LE.a,{x:d.x,y:d.y}),n,a,z);this.W4d=null}SNb(a,d,n,z){this.W4d=Object(qa.a)(ME,n);z.J8(a,d);return!0}GBc(){}}Object(t.a)($I,"ReactContextMenuController",
null,[493,12]);var lP=b(334);class aJ{constructor(){this.Ota=this.text=this.yAa=null}}Object(t.a)(aJ,"BusinessBarButtonData",null,[]);class jG{constructor(){this.text=this.yAa=null}}Object(t.a)(jG,"BusinessBarLinkData",null,[]);var bJ=b(169);class kG{constructor(a,d,n,z){this.bwh=this.Suc=this.Oth=this.ayb=this.gsh=null;this.Mr=a;this.xEa=d;this.ga=n;this.va=z}BMg(){this.OCb();this.xme();this.wAc();this.hRk()}xme(){}OCb(){const a=Lb.App.oa.za.jc;a&&(this.gsh=this.Nvb(this.gsh,1,2===Lb.App.oa.mode&&
a.Hbc,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}get Wgm(){return Lb.App.l3e?I.a.Ah:!1}Fhm(){return l.AFrameworkApplication.la&&1===l.AFrameworkApplication.la.mode}hRk(){this.Wgm&&!this.Suc&&(this.Suc=this.xEa.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.Suc.id=15,this.Suc.closeable=!0,this.Suc.addButton(Box4Intl.Box4Strings.L_DownloadNow,og.AppFrame.jNj,""),we.a("NewBrowserSuggestionShown"),this.Mr.BB(this.Suc,!1))}wAc(){let a=null;const d=Lb.App.oa.za.Uea;if(d){const n=
d.xOc;bJ.a.pJc(n)?22===n?a=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===n||20===n?a=I.a.tg?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===n?a=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===n?a=I.a.tg?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===n&&(a=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):bJ.a.xCe(d.EQa)||Lb.App.ap||this.Fhm()||(a=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.bwh=
this.Nvb(this.bwh,5,!!a,a)}C5g(a,d,n,z){a=this.xEa.create(null,a,null);a.closeable=!0;a.id=23;a.image=3;a.hie(d,()=>{Ye.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+n)});z&&(a.nla=z);this.Mr.BB(a,!0)}tCj(a,d,n){this.C5g(a,d,n,null)}gvn(a){a=this.xEa.create(null,a,null);a.closeable=!0;a.id=20;this.Mr.BB(a)}yun(){var a=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,d=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.ayb||(this.ayb=this.xEa.create(a,d,null),this.ayb.closeable=
!0,this.ayb.id=27,this.Mr.BB(this.ayb))}dKi(){this.ayb&&(this.ayb=this.Nvb(this.ayb,27,!1,""))}q5g(a){this.Oth=this.Nvb(this.Oth,30,!0,a)}Nvb(a,d,n,z,O=!1,ca="",Da=null,Xa=null,zb=null){n?a?a.message=z:(a=this.xEa.create(ca,z,null),a.id=d,a.closeable=O,Da&&a.addButton(Da.text,Da.yAa,Da.Ota),Xa&&a.hie(Xa.text,Xa.yAa),zb&&(a.nla=zb),this.Mr.BB(a,!1)):a&&(this.Mr.removeEntry(a),a=null);return a}JAf(a){this.Mr.BB(a,void 0)}}Object(t.a)(kG,"BusinessBarController",null,[209]);class LB extends kG{constructor(a,
d,n,z){super(a,d,n,z);this.gOa=null}jzi(a,d,n=null,z=null,O=null,ca=2){this.gOa||(this.gOa=this.xEa.create(d,n||"",null),this.gOa.id=6,this.gOa.image=ca,this.gOa.nGe=!1,a&&(this.gOa.errorCode=a),this.gOa.closeable=!1,d=l.AFrameworkApplication.zz&&this.va.ea("ShowFeedbackButtonOnKickoutBusinessBar"),z?(this.gOa.addButton(z,O,""),d&&this.gOa.fVh(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.$Gi(a)})):d&&this.gOa.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.$Gi(a)},""),this.Mr.BB(this.gOa,
void 0,null,null,null))}$Gi(a){k.ULS.sendTraceTag(36471966,338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:a});this.ga.ob(Sa.a.giveFeedback,2,{["ErrorCode"]:a})}static get yc(){return mi.PageReader.instance}}Object(t.a)(LB,"BusinessBarController",kG,[208,209]);class lG{static get z7i(){const a=w.a.Xh(Ih.a.yf(l.AFrameworkApplication.lcid).name);return String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",a)}}Object(t.a)(lG,"OdtUtils",null,[]);class cJ extends LB{constructor(a,
d,n,z){super(a,d,n,z);this.pRb=this.v2c=this.bFh=this.a2a=this.hFh=this.oOh=null;this.Qek="https://go.microsoft.com/fwlink/?linkid=2134357"}BMg(){super.BMg();this.PQk()}xme(){const a=Lb.App.oa.za.jc;if(a){var d=Lb.App.gV;if(Lb.App.Vt||Lb.App.ap||d&&l.AFrameworkApplication.$r)this.oOh=this.Nvb(this.oOh,4,LB.yc.e6a(a),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.hFh=this.Nvb(this.hFh,3,LB.yc.rVa(a),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,!0),this.bFh=this.Nvb(this.bFh,8,LB.yc.v$h(a),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,
!0),LB.yc.wpb(a)?this.a2a||(this.a2a=this.xEa.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.a2a.id=14,this.a2a.closeable=!0,this.a2a.image=3,this.a2a.addButton(Box4Intl.Box4Strings.L_LearnMore,og.AppFrame.sXi,""),this.Mr.BB(this.a2a,!1)):this.a2a&&(this.Mr.removeEntry(this.a2a),this.a2a=null)}}PQk(){if(Rj.App.KDd){const a=lG.z7i,d=this.xEa.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,
null);d.id=9;d.closeable=!0;d.pvk(a);this.Mr.BB(d,!0)}}Xun(a,d){if(Lb.App.oa.za.jc){const n=new aJ;n.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;n.yAa=()=>{a()};const z=new jG;z.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;z.yAa=()=>{Ye.a.openWindow(4,l.AFrameworkApplication.vCa)};this.v2c=this.Nvb(this.v2c,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,
n,z,()=>{d()})}}k_l(){this.v2c&&(this.v2c=this.Nvb(this.v2c,25,!1,""))}lun(){if(Lb.App.oa.za.jc){const a=new jG;a.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;a.yAa=()=>{Ye.a.openWindow(4,this.Qek)};this.pRb||(this.pRb=this.xEa.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,null),this.pRb.id=32,this.pRb.closeable=!0,this.pRb.image=3,this.pRb.hie(a.text,a.yAa),this.Mr.BB(this.pRb,!1))}}nsa(a){return this.Mr.nsa(a)}BB(a,
d){this.Mr.BB(a,d)}}Object(t.a)(cJ,"BusinessBarController",LB,[552,208,209]);class dJ{constructor(){this.menuTargetType=null}}Object(t.a)(dJ,"MenuTargetDescriptor",null,[]);class et{static get DF(){return et.sG||(et.sG=la.a.instance.resolve("Box4.IContextMenuController"))}static X_k(a){et.DF.GBc(a,"mnuNavPaneWordEditor","","","Menu16")}static showContextMenu(a,d){et.DF.showContextMenu(a,d)}static kmc(a,d,n){et.DF.kmc(a,d,n)}static Vtb(a,d,n,z=null){et.DF.Vtb(a,d,n,z)}static zsd(a,d,n,z){return Uh.a(a,
d.toString(),z,n)}}et.sG=null;Object(t.a)(et,"BaseContextMenu",null,[]);class Ij extends et{constructor(a,d,n,z=!1,O,ca=null,Da){super();this.gWm=d;this.Ak=n;this.Tp=ca;this.Sjf=z;this.lb(a);this.exb=Da;Ij.sfb[1]=Mb.a.wWd;Ij.sfb[2]=Mb.a.Fxd;Ij.sfb[3]=Mb.a.eXd}get xdl(){return gk.a.hqe}get wdl(){return gk.a.Poe}get ydl(){return gk.a.DQe}get GYf(){return gk.a.Tdj}lb(a){a.Aa(Mb.a.lRe,Kb.a.application,Object(m.a)(this,this.jRe,"populateContextMenu"),96);a.Aa(Mb.a.eNg,Kb.a.application,Object(m.a)(this,
this.jRe,"populateContextMenu"),96)}show(a,d,n){let z=null,O=new Sys.UI.Bounds(0,0,0,0);const ca=this.jLl(a);if(ca&&(a=a.ra.node)&&(a=a.Qd(Ic.InteractiveViewManager.instance.sc.Za))){O=iu.a.xl(a,ca.end);if(l.AFrameworkApplication.isRtl&&O.x>d.x||!l.AFrameworkApplication.isRtl&&O.x+O.width<d.x||O.y+O.height<d.y)O=iu.a.xl(a,ca.end-1);d.x=O.x+(l.AFrameworkApplication.isRtl?0:O.width);d.y=O.y+O.height;z=6}et.Vtb("ContextMenu",new Sys.UI.Bounds(d.x,d.y,O.width,O.height),n,z)}jRe(a,d,n,z,O){if(1===n)return 32;
a=O.UF;O=O.$c;d=Object.assign(new he.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.n2k(d,a,O.IsShadowMenuOpen);O.MenuItems=d;return 32}hga(a,d){let n=!1,z=!1;return this.MVd(a)||Ij.hkd(Mb.a.mergeCells)||Ij.hkd(Mb.a.bub)||this.h6g(a)||this.bCj(a,d)||Ij.KCj()||({pIa:n,jIc:z}=Ij.zCj(a,n,z)).returnValue}MVd(a){return 2===Lb.App.oa.mode&&this.BDd(a)}eCc(a,d,n=null){if(nq.a.tH()&&2===Lb.App.oa.mode){d=this.exb.nai(a.ra);if(!d)return;d=d.errorDetails}else{if(!this.MVd(a))return;
d=this.BCi(a)}var z=Ih.a.yf(d.lcid);const O=z?z.name:"UNKNOWN";z=Object(Uc.a)(Mi.a,d)?d.typeId:"";k.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",d.errorType,d.proofingType,z,O);if(a=this.gWm.$Bc(a,d))n.push.apply(n,a),this.frm(d,z)}frm(a,d){const n=Ij.sfb[a.proofingType];n&&(l.AFrameworkApplication.pa.processAction(n,2),k.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",
n,d,a.proofingType,nq.a.tH()))}BCi(a){return this.Ak.Cra(a.ra).errorDetails}BDd(a){return this.Ak.Dkc(a)}DFc(){return null}lpe(){}jLl(a){return this.BDd(a)?this.Ak.Cra(a.ra):(a=this.DFc(a))?new hb.a(a.Cu,a.cpEnd):null}h6g(a){if(2!==Lb.App.oa.mode||!a)return!1;a=wp.a.Sqa(a.toArray());return!!Ij.jg.xU(a,14)}gDj(a,d){return 2===d||3===d&&!this.BDd(a)}bCj(a,d){return 3!==d||this.BDd(a)}C_k(){const a=[];a.push(Object.assign(new Xg.a,{ExternalId:this.xdl}));a.push(Object.assign(new Xg.a,{ExternalId:this.wdl}));
a.push(Object.assign(new Xg.a,{ExternalId:this.ydl}));return a}e3k(){const a=[];this.Sjf&&a.push(Object.assign(new Xg.a,{ExternalId:this.GYf}));return a}static get Vb(){return Ij.zc||(Ij.zc=la.a.instance.resolve("Box4.List.IListReader"))}static get jg(){return bl.ContextSetEditor.instance}static get hbm(){null==Ij.njf&&(Ij.njf=l.AFrameworkApplication.K?l.AFrameworkApplication.K.ea("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return Ij.njf}static get HId(){null==Ij.TPb&&(Ij.TPb=l.AFrameworkApplication.K?
l.AFrameworkApplication.K.ea("MultiParagraphHyperlinkEditEnabled"):!1);return Ij.TPb}static get laa(){null==Ij.y1&&(Ij.y1=l.AFrameworkApplication.K?l.AFrameworkApplication.K.ea("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Ij.y1}static hkd(a){return 32===l.AFrameworkApplication.pa.processAction(a,1)}static KCj(){return 2===Lb.App.oa.mode&&!!Lb.App.Yq.hz&&Lb.App.Yq.hz.pEd(Mb.a.fLd.toString())}static MCj(a){if(1!==a.length||!a.ra.Cj)return!1;a=Dd.GraphIterator.ua(a.ra.node);a.La(11);a.hb();
return a.Bo(4)&&!Ij.Vb.ht(a).listType?!0:!1}static zCj(a,d,n){d=n=!1;if(!a)return{returnValue:!1,pIa:d,jIc:n};if(Ij.HId)return Ij.fvn(a,d,n);if(!(a.IA||Ij.hbm&&2===a.length&&a.Fb.contextId===Kb.a.endOfParagraph))return{returnValue:!1,pIa:d,jIc:n};a=a.ra.clone();d=32===l.AFrameworkApplication.pa.rf(a,Mb.a.NWa,1,!0,null,null);n=32===l.AFrameworkApplication.pa.rf(a,Mb.a.insertHyperlink,1,!0,null,null);return{returnValue:d||n,pIa:d,jIc:n}}static fvn(a,d,n){let z;n=a.ra.clone();z=Ij.laa&&Lj.l(n);d=!z&&
32===l.AFrameworkApplication.pa.rf(n,Mb.a.NWa,1,!0,null,null);if(a.IA||2===a.length&&a.Fb.contextId===Kb.a.endOfParagraph)n=!z&&32===l.AFrameworkApplication.pa.rf(n,Mb.a.insertHyperlink,1,!0,null,null);else{n=!0;const O=a.length;for(let ca=0;ca<O;ca++){const Da=a.J(ca).clone();if(Da.contextId===Kb.a.paragraph||Da.contextId===Kb.a.Lc)(z=Ij.laa&&Lj.l(Da))||(n=32===l.AFrameworkApplication.pa.rf(Da,Mb.a.insertHyperlink,1,!0,null,null)&&n);else if(Da.contextId!==Kb.a.endOfParagraph)return n=d=!1,{returnValue:!1,
pIa:d,jIc:n}}}return{returnValue:d||n,pIa:d,jIc:n}}static cAi(a){const d=Object.assign(new fi.a,{ControlList:[]});for(const n of a)Array.add(d.ControlList,Object.assign(new Xg.a,{ExternalId:n}));return d}static LL(a){let d=[];for(const n of a)Array.add(d,Object.assign(new Xg.a,{ExternalId:n}));return d}}Ij.njf=null;Ij.zc=null;Ij.TPb=null;Ij.y1=null;Ij.sfb=[];Object(t.a)(Ij,"AEditSurfaceContextMenu",et,[]);var mP=b(554),nP=b(775);class pq{static Pxl(a,d,n){return n.k$k(a)?Ij.LL(["ReviewDesignerSuggestion"]):
[]}static XFl(){return Ij.hkd(Mb.a.mergeCells)?Ij.LL(["MergeCells"]):Ij.hkd(Mb.a.FWd)?Ij.LL(["SplitCells"]):[]}static HRl(a,d,n){d=[];if(!n.Wi.n$h(a))return d;a=n.Wi.XFi(a);d.push(Object.assign(new Xg.a,{ExternalId:"AcceptChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_AcceptChange,a)}));d.push(Object.assign(new Xg.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,
WordEditorIntl.WordEditorStrings.L_RejectChange,a)}));return d}static Ztl(a,d,n){return l.AFrameworkApplication.K.ea("CatchUpActivityIsEnabled")&&a&&a.ra&&a.ra.node&&n.Lb&&n.Lb.E6i(a.ra.node)?Ij.LL(["ShowCatchUpActivitiesForParagraph"]):[]}static Byl(a){return Km.CCj(a)?Ij.LL(["EditIllustration"]):[]}static BTl(a,d,n){return n.K.ea("WordEditorWrapTextIsEnabled")&&Km.ywn(a)?[Object.assign(new $i.a,{ExternalId:"WrapTextMenu"})]:[]}static hze(a,d,n){return n.A$k(a)?Ij.LL(["CreatePullQuote"]):[]}static Zul(){return Km.eCj()?
Ij.LL(["NewComment"]):[]}static mul(a){let d=[];!Km.f6g(a)&&Km.H5g(a)&&Yb.SessionStatusManager.instance.VN&&a.bM&&Array.add(d,Object.assign(new $i.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));return d}static rDl(a,d,n){d=[];!Km.f6g(a)&&Km.H5g(a)&&Yb.SessionStatusManager.instance.VN&&(k.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),a.bM&&!l.AFrameworkApplication.K.ea("ChangePicturesIsEnabled")?d.push(...Ij.LL(["ChangePicture"])):d.push(...n.F1k().ControlList),
(a=Km.Pxe())&&0<a.length&&(n=n.E4k(a),null!=n&&d.push(...n.ControlList)));return d}static hLl(){return Ij.KCj()?Ij.LL(["SetProofingLanguage"]):[]}static CMl(a,d,n){return n.Nem&&n.Tvn(a)?Ij.LL(["Rewrite"]):[]}static IEl(a){return Ij.MCj(a)?Ij.LL(["StartNewList","ContinueNumbering","SetNumberingValue"]):[]}static sJl(){return Km.XCj()?Ij.LL(["ParagraphOptions"]):[]}static zCl(a){return Km.CCj(a)?Ij.LL(["EditIllustration"]):[]}static NOl(a){return Km.f6g(a)?Ij.LL(["ShowSmartLookupPane"]):[]}static PRl(a){return Km.OCj(a)?
Ij.LL(["ModernTranslatorSplitButton"]):[]}static OBl(a,d,n){d=[];if(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.HeadingDeeplinkIsEnabled",!1)&&a.IA){const z=a.ra;if(z.contextId===Kb.a.paragraph||z.contextId===Kb.a.Ub||z.contextId===Kb.a.Lc){a=a.ra.node;if(!n.gs.nb(a)||a.ko||""===a.characterData)return d;n.pDc.Axe(a)&&d.push(...Ij.LL(["CreateHeadingLink"]))}}return d}static getBookmark(a,d,n){d=[];if(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksFloatie",
!1)&&a.IA){const z=a.ra;(Qd.SelectionEditor.Cd(z)||Qd.SelectionEditor.JIa(z))&&n.FHk.k9b(a.ra.node,a.ra.cpBegin)&&(d.push(...Ij.LL(["DeleteBookmarkContextMenu"])),d.push(...Ij.LL(["EditBookmarkNameContextMenu"])))}return d}static vba(a){let d=!1,n=!1,z=[];({pIa:d,jIc:n}=Ij.zCj(a,d,n)).returnValue&&(d?n?z.push(...Ij.LL(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):z.push(...Ij.LL(["OpenHyperlink"])):n&&(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",
!1)?z.push(...Ij.LL(["InsertLinkFlyout"])):z.push(...Ij.LL(["InsertLink"]))));return z}static Hul(a,d,n){let z=[];if(!n.bCj(a,d))return z;2===Lb.App.oa.mode?(z.push(...n.C_k()),z.push(...n.e3k()),3===d&&n.BDd(a)&&Array.add(z,Object.assign(new Xg.a,{ExternalId:"Delete"}))):l.AFrameworkApplication.protectFile||Array.add(z,Object.assign(new Xg.a,{ExternalId:"Copy"}));return z}static f5f(a,d,n){return n.h6g(a)&&n.gDj(a,d)?Ij.LL(["EditTableAltText"]):[]}static Zyi(a,d,n){return n.u$k(a)?Ij.LL(["ShowIntentSuggestion"]):
[]}static fQl(a,d,n){const z=[];n.h6g(a)&&!n.gDj(a,d)&&(Array.add(z,Object.assign(new $i.a,{ExternalId:"InsertTableMenu"})),Array.add(z,Object.assign(new $i.a,{ExternalId:"DeleteTableMenu"})),Array.add(z,Object.assign(new $i.a,{ExternalId:"SelectTableMenu"})));return z}static kQl(a,d,n){return Km.Ka.isFeatureEnabled(182)&&n.fwn(a)?Ij.LL(["UpdateTableOfContents"]):[]}static dzl(a){return Km.Hun(a)?Ij.LL(["ShowHideEquationToolsPane"]):[]}}Object(t.a)(pq,"ContextMenuSectionItemHelper",null,[]);class LC{static Vql(a,
d,n){return n.K.ea("AddInCommandsIsEnabled")?(d=[],LC.NZk(a,Rj.App.wn.za.Rb.Oa.eZ,d),d):[]}static NZk(a,d,n){2===Rj.App.wn.mode&&Km.JEk&&(d=Dd.GraphIterator.ua(d),Km.hvk(n,a,d))}static DKl(a,d,n){d=[];n.sTm.$Bc(n.Frl(a),d);return d}static ayl(a,d,n){const z=[];if(n.MVd(a))return z;n.K.ea("WordEditorIdeasCardsIsEnabled")&&!I.a.Ah||n.nWf.lpe(a,null,d,z);return z}static UOl(a,d,n){const z=[];n.pZf()&&n.eCc(a,d,z);if(!n.K.ea("WordEditorIdeasCardsIsEnabled")||I.a.Ah)n.pZf()||n.eCc(a,d,z);return z}}Object(t.a)(LC,
"ContextMenuSectionHelper",null,[]);class Km extends Ij{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le,Ve,gg,Lh,Ki=!1,Ak=null,Uk=null,Rl,kk,dn){super(a,d,n,Ki,void 0,Ak,Rl);this.hrf=this.z1=null;this.Hyh=!1;this.MSd=new Map;this.ZI={};this.vMc={};this.K=z;this.Wi=O;this.Eb=ca;this.JW=Xa;this.$M=zb;this.Wu=Vb;this.trk=!!Ak;this.nWf=Fc;this.sTm=Yc;this.Trc=Ve;this.Sia=gg;this.FHk=Lh;this.NEa=dn;this.Ha=kk;Le&&Le.execute(fs=>{this.LMh=fs});yd&&yd.execute(fs=>{this.hrf=fs});this.Lb=Da;this.Pw=je;
Uk&&Uk.execute(fs=>{this.z1=fs});this.q2l();this.LRm();this.djl();this.KRm()}static get JEk(){return Km.uoh}get gs(){return this.Ha}get pDc(){return this.NEa}static get hvk(){return Km.Jnh}x9l(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.isContextMenuSimplified",!1)}get GYf(){return this.trk?gk.a.BQe:super.GYf}X1m(a){Km.uoh=a}W1m(a){Km.Jnh=a}dtn(){const a=Rj.App.wn.za.Rb.Oa.ya.Ba;return this.MVd(a)&&2!==this.BCi(a).errorType}pZf(){return this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickMenuIsEnabled",
!1)}hga(a,d){return super.hga(a,d)||Km.XCj()||Ij.MCj(a)||Km.eCj()||Km.H5g(a)||Km.OCj(a)}n2k(a,d,n){const z=[];let O=null;try{O=Rj.App.wn.za.Rb.Oa.ya.Ba}catch(ca){k.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");return}this.BRm(O,d,z,this.ewl(O));a.MenuSectionList.push(...z);this.tmn(a);!n&&this.LMh&&this.LMh.PUm(a.MenuTargetDescriptor.menuTargetType,z)}ewl(a){return this.x9l()?Ij.hkd(Mb.a.mergeCells)?Rw.mmh:a.bM?Rw.dlh:a.dpb()?Rw.Mih:Rw.jjh:Rw.Sjh}G1k(a){a=
Km.FRf(a);return Object.assign(new Xg.a,{ExternalId:"SmartLookupContextMenu",LabelText:a})}F4k(a){return(a=Km.lXj(a))?Object.assign(new Xg.a,{ExternalId:"SmartLookupSynonyms",LabelText:a}):null}F1k(){const a=Object.assign(new fi.a,{ControlList:[]}),d=Km.Pxe();Array.add(a.ControlList,this.G1k(d));return a}E4k(a){const d=Object.assign(new fi.a,{ControlList:[]});if(a&&0<a.length){a=this.F4k(a);if(null==a)return null;d.ControlList.push(a)}return d}tpb(a){return a.bM||2<a.length||!a.length||2===a.length&&
!Qd.SelectionEditor.sg(a.Fb)||1===a.length&&Qd.SelectionEditor.sg(a.Fb)?!1:this.ltg(a.ra)}ltg(a){return Bd.ParagraphReader.nb(a.node)?""!==Bd.ParagraphReader.text(a.node).trim():!1}fwn(a){var d=Dd.GraphIterator.ua(a.ra.node);d=Object(qa.a)(mP.a,d.currentNode);return uf.a.instance.J(5)&&a.bM?!1:!!d&&d.ko}djl(){l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");this.K.ea("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",
!1)?this.Pw.execute(a=>{a.isFeatureEnabled(nP.a.b6i,!1).then(d=>{d||k.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");this.Hyh=d;return null})}):k.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}get Nem(){l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");return this.K.ea("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",
!1)?this.Hyh:!1}Tvn(a){if(!this.tpb(a)||a.Mbc||a.dpb())return!1;a=a.ra;if(Bd.ParagraphReader.rh(a)||Qd.SelectionEditor.Cd(a)||Qd.SelectionEditor.Ch(a)){a=this.$M.Plb(a);a||(a=l.AFrameworkApplication.lcid);switch(a&1023){case 9:return!0;case 10:if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}u$k(a){if(1!==a.length||I.a.Ah)return!1;const d=l.AFrameworkApplication.K.ea("WordEditorIdeasCardsIsEnabled");if(d&&this.pZf()&&this.dtn()||
nq.a.tH()&&this.exb.nai(a.ra))return!1;const n=Km.Ka.isFeatureEnabled(105);return a.J(0).contextId===Kb.a.Ub&&(d||n)&&0<this.Wu.Xud(a.J(0),0).count||d&&this.DFc(a)?!0:!1}k$k(a){return 1===a.length&&this.Trc.XP(a.ra.node).SAa}get xI(){return Km.M_a||(Km.M_a=la.a.instance.sa("WordEditor.Designer.IDesignerTaskPane"))}A$k(a){if(!this.Sia.BQi()||!this.xI||this.xI.isVisible||!(1===a.length||2===a.length&&Qd.SelectionEditor.sg(a.Fb))||a.KVa||!Qd.SelectionEditor.Ch(a.ra)&&a.ra.contextId!==Kb.a.paragraph||
a.sUi()||this.Trc.XP(a.ra.node).SAa)return!1;const d=Bd.ParagraphReader.text(a.ra.node),n=a.ra.contextId===Kb.a.paragraph?0:a.ra.cpBegin,z=a.ra.contextId===Kb.a.paragraph?d.length:a.ra.cpEnd-n;return 1>z||1500<z||w.a.le(w.a.qha(d.substr(n,z)))||1!=ip.a.tFb(a.ra.node)?!1:!0}DFc(a){return this.nWf.DFc(a)}lpe(a,d,n,z=null){this.MVd(a)||this.nWf.lpe(a,d,n,z)}Frl(a){return this.hrf?this.hrf.Grl(a):[]}tmn(a){const d=this.z1?this.z1.contentType:"Unknown";a.MenuTargetDescriptor=Object.assign(new dJ,{menuTargetType:d})}static get Ka(){return Km.Ja||
(Km.Ja=la.a.instance.resolve("Box4.IFeatureHelper"))}static H5g(a){return l.AFrameworkApplication.hY&&!a.Mbc&&la.a.instance.resolve("Box4.Insights.IBox4InsightsSelection").lhm()}static ize(a){a=a?a.trim():null;let d=20;a&&0<a.length&&(a.length>d&&(d=w.a.Yr(a,d)?d-1:d),a=a.length>d?a.substr(0,d).trim()+"...":a);return a}static FRf(a){let d=WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;(a=Km.ize(a))&&0<a.length&&(d=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,
a));return d}static lXj(a){a=Km.ize(a);return null!=a&&0<a.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,a):null}static Pxe(){const a=(new Mo.a).getSelectedText();return a.neighborhood.substr(a.mentionStart,a.mentionLength)}static CCj(a){const d=Km.Ka.isFeatureEnabled(81);return!a.jDb&&d&&!I.a.Ah&&(a.Mbc||d&&a.bM)}static f6g(a){return l.AFrameworkApplication.K.ea("WordEditorSmartLookupIsEnabled")&&!a.dpb()}static OCj(a){return l.AFrameworkApplication.K.ea("LanguageTranslationIsEnabled")&&
!a.Mbc&&!a.dpb()}static eCj(){return Km.Ka.fq(28)}static Hun(a){return a.Xrg()&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EquationToolsIsEnabled",!1)}static XCj(){return 2===Rj.App.wn.mode}static ywn(a){return a.bM&&Km.Ka.isFeatureEnabled(220)}BRm(a,d,n,z){this.vMc[z].forEach(O=>{const ca=Object.assign(new fi.a,{ControlList:[]}),Da=ca.ControlList;O.forEach(Xa=>{Xa instanceof rr?n.push(...this.MSd.get(Xa)(a,d,this)):Da.push(...this.ZI[Xa](a,d,this))});(null===Da||
void 0===Da?0:Da.length)&&n.push(ca)})}KRm(){this.MSd.set(rr.x5e,LC.Vql);this.MSd.set(rr.Jpc,LC.DKl);this.MSd.set(rr.e6e,LC.ayl);this.MSd.set(rr.d7e,LC.UOl)}LRm(){this.ZI[Sh.FWc]=pq.Hul;this.ZI[Sh.g7e]=pq.fQl;this.ZI[Sh.h7e]=pq.kQl;this.ZI[Sh.d6e]=pq.Pxl;this.ZI[Sh.E6e]=pq.XFl;this.ZI[Sh.z5e]=pq.f5f;this.ZI[Sh.t6e]=pq.rDl;this.ZI[Sh.e2d]=pq.Zyi;this.ZI[Sh.yjh]=pq.zCl;this.ZI[Sh.c7e]=pq.NOl;this.ZI[Sh.k7e]=pq.PRl;this.ZI[Sh.N6e]=pq.hLl;this.ZI[Sh.R6e]=pq.CMl;this.ZI[Sh.g2d]=pq.IEl;this.ZI[Sh.l2d]=
pq.sJl;this.ZI[Sh.O6e]=pq.hze;this.ZI[Sh.N7e]=pq.BTl;this.ZI[Sh.f6e]=pq.Byl;this.ZI[Sh.E5e]=pq.mul;this.ZI[Sh.j7e]=pq.HRl;this.ZI[Sh.D5e]=pq.Ztl;this.ZI[Sh.U1d]=pq.getBookmark;this.ZI[Sh.q6e]=pq.OBl;this.ZI[Sh.s6e]=pq.vba;this.ZI[Sh.Dpc]=pq.Zul;this.ZI[Sh.e2d]=pq.Zyi;this.ZI[Sh.h6e]=pq.dzl}q2l(){const a=[Sh.E6e,Sh.z5e,Sh.g7e];this.vMc[Rw.mmh]=[[Sh.FWc],a,[Sh.Dpc],[rr.Jpc]];this.vMc[Rw.dlh]=[[Sh.FWc],[Sh.E5e,Sh.f6e,Sh.N7e],a,[Sh.Dpc],[rr.Jpc]];this.vMc[Rw.Mih]=[[Sh.h6e],[Sh.g2d,Sh.l2d],[Sh.U1d,Sh.Dpc],
[rr.Jpc]];this.vMc[Rw.jjh]=[[Sh.e2d],[Sh.d6e],[rr.d7e],[rr.e6e],[Sh.FWc],[Sh.t6e,Sh.yjh,Sh.c7e,Sh.k7e],[Sh.N6e,Sh.R6e,Sh.l2d],[Sh.g2d],a,[Sh.s6e,Sh.U1d,Sh.q6e,Sh.Dpc],[Sh.O6e],[Sh.j7e],[Sh.D5e],[rr.x5e],[Sh.h7e],[rr.Jpc]];this.vMc[Rw.Sjh]=[[Sh.e2d],[Sh.d6e],[rr.d7e],[rr.e6e],[Sh.FWc],[Sh.E5e],[Sh.f6e],[Sh.N7e],[Sh.t6e],[Sh.c7e],[Sh.k7e],[Sh.N6e],[Sh.R6e],[Sh.h6e],[Sh.g2d],[Sh.l2d],[Sh.s6e],[Sh.E6e],[Sh.z5e],[Sh.g7e],[Sh.U1d],[Sh.q6e],[Sh.Dpc],[Sh.O6e],[Sh.j7e],[Sh.D5e],[rr.x5e],[Sh.h7e],[rr.Jpc]]}}
Km.uoh=null;Km.Jnh=null;Km.Ja=null;Km.M_a=null;Object(t.a)(Km,"EditSurfaceContextMenu",Ij,[]);var Rw;(function(a){a[a.mmh=1]="TABLE_MULTI_CELL";a[a.jjh=2]="GENERIC";a[a.dlh=3]="PICTURE";a[a.Mih=4]="EQUATION";a[a.Sjh=5]="LEGACY"})(Rw||(Rw={}));Object(t.b)("Scenarios",Rw);class rr{}rr.x5e=new rr;rr.Jpc=new rr;rr.e6e=new rr;rr.d7e=new rr;Object(t.a)(rr,"Sections",null,[]);var Sh;(function(a){a[a.e2d=1]="INTENT_SUGESTION";a[a.FWc=2]="ESSENTIALS";a[a.t6e=3]="INSIGHT";a[a.yjh=4]="ILLUSTRATION";a[a.c7e=
5]="SMART_LOOKUP";a[a.k7e=6]="TRANSLATE";a[a.N6e=7]="PROOFING";a[a.R6e=8]="REWRITE_SUGGESTIONS";a[a.g2d=9]="LISTS";a[a.l2d=10]="PARAGRAPH_OPTIONS";a[a.E6e=11]="MERGE_SPLIT_CELLS";a[a.z5e=12]="ALT_TEXT";a[a.s6e=13]="HYPERLINK";a[a.U1d=14]="BOOKMARK";a[a.q6e=15]="HEADING_LINK";a[a.Dpc=16]="COMMENT";a[a.O6e=17]="PULL_QUOTE";a[a.N7e=18]="WRAP_TEXT";a[a.f6e=19]="DRAW_ANNOTATE";a[a.j7e=20]="TRACK_CHANGE";a[a.D5e=21]="CATCHUP_ACTIVITIES";a[a.h7e=22]="TABLE_OF_CONTENTS";a[a.d6e=23]="DESIGNER_REVIEW";a[a.g7e=
24]="TABLE_ITEMS";a[a.E5e=25]="CHANGE_PICTURE";a[a.h6e=26]="EQUATIONTOOLS"})(Sh||(Sh={}));Object(t.b)("SectionItem",Sh);class bA extends et{constructor(a,d,n){super();this.vl=null;this.ga=a;this.Ek=d;this.JJ=n;this.lb()}get Syb(){return document.getElementById("WACHorizontalRuler")}get KT(){return this.Ek&&this.Ek.instance?this.Ek.instance.Ei:1}get target(){return this.vl}show(a,d){this.vl=a;et.kmc("RulerContextMenu",a,d);k.ULS.sendTraceTag(592307397,3014,50,"Ruler Context menu invoked.");a=new Map;
a.set("Command","Show");a.set("Source",bA.gca);a.set("Response","Ruler Context menu invoked.");ja.Health.instance.recordKpiUsage(bA.kpiName,1,bA.G_,a)}ZLl(){var a=0,d=(this.target.x-Ye.a.Yve(this.Syb))/this.KT;d=rf.a.tx(d,0);var n={},z=this.JJ.f8b,O=Dd.GraphIterator.ua(z);O.kc();if(!If.TableReader.Pv(O))return 32===this.ga.ob(Mb.a.qKa,2,n)&&(a=n.marginLeft),d-a;a={};O={};n=this.ga.ob(Mb.a.XPc,2,a);var ca=this.ga.ob(Mb.a.vLb,2,O);if(32!==n||32!==ca)return k.ULS.sendTraceTag(559252943,3014,15,"Unable to read table properties for Ruler Context Menu"),
d;a=a.ColumnWidths;ca=O.TablePosition;if(!ca||!a||0>=a.length)return k.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),d;n=0;O=Dd.GraphIterator.ua(z);O.La(14)&&(O.tc(16),n=Vr.a(O,!0));z=ca.x/this.KT;for(O=0;O<n;O++)z+=a[O];return d-z}lb(){this.ga.Aa(Dc.a.rRe,Kb.a.application,Object(m.a)(this,this.rRe,"populateRulerContextMenu"),96)}rRe(a,d,n,z,O){if(1===n)return 32;a=[];d=[];this.etn()&&d.push("InsertTabStopMenuSplitButton");this.Vsn()&&d.push("ClearAllTabStops");
d.push("HideRuler");a.push(bA.cAi(d));d=Object.assign(new he.a,{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});d.MenuSectionList.push(...a);O.MenuItems=d;return 32}etn(){var a={},d={},n=this.ga.ob(Mb.a.qKa,2,a),z=this.ga.ob(Mb.a.a8a,2,d);if(32===n&&32===z){z=d.fu;n=rf.a.Rh(z.sAa,0);z=1===z.specialIndentType?rf.a.Rh(z.yE,0):rf.a.Rh(z.yE-z.uoa,0);const O=rf.a.Rh(a.marginLeft,0);a=rf.a.Rh(a.marginRight,0);const ca=Ye.a.Yve(this.Syb),Da=Ye.a.O5f(this.Syb);d.isRtl?(d=ca+this.KT*
Math.max(a,a+n),n=Da-this.KT*Math.max(O,O+z)):(d=ca+this.KT*Math.max(O,O+z),n=Da-this.KT*Math.max(a,a+n));if(this.target.x>=d&&this.target.x<=n)return!0}return!1}Vsn(){var a={};if(32!==this.ga.ob(Dc.a.mic,2,a)||!a)return!1;a=a.customTabs;return!a||0>=a.length?!1:!0}static cAi(a){const d=Object.assign(new fi.a,{ControlList:[]});for(let n of a)Array.add(d.ControlList,Object.assign(new Xg.a,{ExternalId:n}));return d}}bA.G_="wwaengidc";bA.kpiName="WordRuler";bA.gca="RulerContextMenu";Object(t.a)(bA,"RulerContextMenu",
et,[549]);let vy;class Gp{static get gb(){return Gp.Xb||(Gp.Xb=la.a.instance.resolve("Box4.Styles.IWACStyleReader"))}static get kZ(){return Gp.nI||(Gp.nI=la.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}static get pj(){return Gp.Xn||(Gp.Xn=la.a.instance.resolve("Box4.IInsertionPointFormatting"))}static Sgj(a,d,n){if(1===d)return(a?Gp.mOk(n):Gp.QNk(n))?32:8;(a=Gp.sPl(a,n))&&Gp.VDk(a,n);return 32}static VDk(a,d){const n=new Ff.GraphTransaction(15);n.Sa(d);Gp.pj.B8a();Gp.kZ.hT(a,d,!1);n.dispose()}static mOk(a){a=
Gp.gb.im(a);return!!a&&Gp.gb.Jd(a)!==Gh.StyleReader.wordStyleIdHeading1}static QNk(a){a=Gp.gb.im(a);return!!a&&Gp.gb.Jd(a)!==Gh.StyleReader.dEa}static sPl(a,d){const n=Gp.gb.im(d);return n?Gp.gb.rz(d).Mf(Gp.rPl(a,Gp.gb.Jd(n))):null}static rPl(a,d){d=Gp.Ngg.indexOf(d);a=a?d-1:d+1;return 0<=a&&a<Gp.Ngg.count?Gp.Ngg.J(a):null}}Gp.Xb=null;Gp.nI=null;Gp.Xn=null;Gp.Ngg=(vy=new db.a,vy.add(Gh.StyleReader.wordStyleIdHeading1),vy.add(Gh.StyleReader.wordStyleIdHeading2),vy.add(Gh.StyleReader.wordStyleIdHeading3),
vy.add(Gh.StyleReader.aEa),vy.add(Gh.StyleReader.bEa),vy.add(Gh.StyleReader.cEa),vy.add(Gh.StyleReader.RLa),vy.add(Gh.StyleReader.SLa),vy.add(Gh.StyleReader.dEa),vy);Object(t.a)(Gp,"NavigationPaneEditor",null,[]);class QD extends et{constructor(){super();this.VG=null}show(a){QD.wh||(this.GBc(),QD.wh=!0);et.showContextMenu("mnuNavPaneWordEditor",a)}GBc(){const a={PopulateDynamically:"true",PopulateOnlyOnce:"false"};a.PopulateQueryCommand=""+Dc.a.lfj;a.Command=""+Sa.a.Rka;et.X_k(a);l.AFrameworkApplication.pa.ma(Dc.a.lfj,
Kb.a.application,Object(m.a)(this,this.jRe,"populateContextMenu"));l.AFrameworkApplication.pa.ma(Dc.a.$Re,Kb.a.view,Object(m.a)(this,this.$Re,"promoteHeading"));l.AFrameworkApplication.pa.ma(Dc.a.Qqe,Kb.a.view,Object(m.a)(this,this.Qqe,"demoteHeading"))}jRe(a,d,n,z,O){if(1===n)return 32;a=new Sys.StringBuilder;a.append(String.format('<Menu Id="{0}">',"mnuNavPaneWordEditor"));a.append('<MenuSection Id="msWordEditorHeadings" DisplayMode="Menu16"><Controls>');a.append(et.zsd("promoteHeading",Dc.a.$Re,
"LeftArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_PromoteHeadingText));a.append(et.zsd("demoteHeading",Dc.a.Qqe,"RightArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_DemoteHeadingText));a.append("</Controls></MenuSection></Menu>");O.PopulationXML=a.toString();return 32}$Re(a,d,n){return Gp.Sgj(!0,n,this.VG.Ia)}Qqe(a,d,n){return Gp.Sgj(!1,n,this.VG.Ia)}}QD.wh=!1;Object(t.a)(QD,"WordEditorNavigationPaneContextMenu",et,[550]);var cA=b(1271),aw=b(278),oP=b(442),pP=b(677),NE=b(1043),mG=b(1523),
nG=b(1524);class OE{constructor(){this.job=this.ORi=!1;this.Vub=2;this.Kt=0;this.m$a=1}}Object(t.a)(OE,"WrapTextPropertiesData",null,[]);class dl extends NE.a{constructor(a=null){super(a);this.RMh=new mG.a;this.wSh=new OE;this.rPh=new nG.a;this.Lgf=!1}initialize(){super.initialize();this.Gc.$(Dc.a.Rug,cA.a.hbc);this.Gc.$(Dc.a.Tug,cA.a.hbc);this.Gc.$(Dc.a.dQg,dl.W7a);this.Gc.$(Dc.a.vOd,dl.W7a);this.Gc.$(Dc.a.ZPg,dl.W7a);this.Gc.$(Sa.a.xLb,dl.W7a);this.Gc.$(Mb.a.lOd,Object(m.a)(this,this.Pta,"sectionPropertiesExecuteBridge"));
this.Gc.$(Mb.a.kOd,Object(m.a)(this,this.Pta,"sectionPropertiesExecuteBridge"));this.Gc.$(Mb.a.jOd,Object(m.a)(this,this.Pta,"sectionPropertiesExecuteBridge"));this.Gc.$(Mb.a.nOd,Object(m.a)(this,this.Pta,"sectionPropertiesExecuteBridge"));this.Gc.$(Mb.a.mOd,Object(m.a)(this,this.Pta,"sectionPropertiesExecuteBridge"));this.Gc.$(Mb.a.iOd,Object(m.a)(this,this.Pta,"sectionPropertiesExecuteBridge"));this.Gc.$(Mb.a.tOd,Object(m.a)(this,this.Pta,"sectionPropertiesExecuteBridge"));this.Gc.$(Mb.a.sOd,Object(m.a)(this,
this.Pta,"sectionPropertiesExecuteBridge"));this.Gc.$(Mb.a.rOd,Object(m.a)(this,this.Pta,"sectionPropertiesExecuteBridge"));this.Gc.$(Mb.a.oOd,Object(m.a)(this,this.Pta,"sectionPropertiesExecuteBridge"));this.Gc.$(Mb.a.pOd,Object(m.a)(this,this.Pta,"sectionPropertiesExecuteBridge"));this.Gc.$(Mb.a.qOd,Object(m.a)(this,this.Pta,"sectionPropertiesExecuteBridge"));this.Gc.$(Mb.a.NSe,Object(m.a)(this,this.Pta,"sectionPropertiesExecuteBridge"));this.Gc.$(Mb.a.MSe,Object(m.a)(this,this.Pta,"sectionPropertiesExecuteBridge"));
this.Gc.$(Mb.a.bNb,dl.Ktm);this.Gc.$(Mb.a.YXa,dl.ONm);this.Gc.$(Mb.a.qqa,dl.W7a);this.Gc.$(Mb.a.RKb,dl.W7a);this.Gc.$(Mb.a.gXa,dl.W7a);this.Gc.$(Mb.a.Uxa,dl.W7a);this.Gc.$(Mb.a.DCa,dl.W7a);this.Gc.$(Dc.a.HMd,dl.W7a);this.Gc.$(Dc.a.Zue,cA.a.R2f);this.Gc.$(Dc.a.$ue,Object(m.a)(this,this.psi,"genericFontSizeExecuteBridge"));this.fo.$(Dc.a.CMd,cA.a.Fjb);this.fo.$(Dc.a.DMd,cA.a.Fjb);this.Gc.$(Mb.a.lNb,cA.a.lkb);this.Gc.$(Mb.a.kNb,cA.a.lkb);this.Gc.$(Mb.a.Gtb,cA.a.lkb);this.Gc.$(Mb.a.dTe,Object(m.a)(this,
this.VI,"queryParaFormattingExecuteBridge"));this.Gc.$(Mb.a.bTe,Object(m.a)(this,this.VI,"queryParaFormattingExecuteBridge"));this.Gc.$(Mb.a.cTe,Object(m.a)(this,this.VI,"queryParaFormattingExecuteBridge"));this.Gc.$(Mb.a.yQ,dl.bWm);this.fo.$(Dc.a.oTe,dl.eQd);this.fo.$(Dc.a.pTe,dl.eQd);this.fo.$(Dc.a.qTe,dl.eQd);this.fo.$(Dc.a.mTe,dl.eQd);this.fo.$(Dc.a.nTe,dl.eQd);this.Gc.$(Dc.a.oTe,Object(m.a)(this,this.E1d,"wrapTextPropertiesExecuteBridge"));this.Gc.$(Dc.a.pTe,Object(m.a)(this,this.E1d,"wrapTextPropertiesExecuteBridge"));
this.Gc.$(Dc.a.qTe,Object(m.a)(this,this.E1d,"wrapTextPropertiesExecuteBridge"));this.Gc.$(Dc.a.mTe,Object(m.a)(this,this.E1d,"wrapTextPropertiesExecuteBridge"));this.Gc.$(Dc.a.nTe,Object(m.a)(this,this.E1d,"wrapTextPropertiesExecuteBridge"));this.Gc.$(Dc.a.wrapText,dl.nWc);this.Gc.$(Dc.a.l5e,dl.nWc);this.Gc.$(Dc.a.m5e,dl.nWc);this.Gc.$(Dc.a.n5e,dl.nWc);this.Gc.$(Dc.a.o5e,dl.nWc);this.Gc.$(Dc.a.p5e,dl.nWc);this.Gc.$(Dc.a.jDa,dl.OEc);this.Gc.$(Dc.a.A5g,dl.OEc);this.Gc.$(Dc.a.B5g,dl.OEc);this.Gc.$(Dc.a.vZe,
dl.OEc);this.Gc.$(Dc.a.wZe,dl.OEc);this.Gc.$(Dc.a.xZe,dl.OEc);this.Gc.$(Dc.a.pLb,Object(m.a)(this,this.vXm,"queryImageCropExecuteBridge"));this.Gc.$(Dc.a.fOd,dl.Ive);this.Gc.$(Dc.a.uSe,dl.Ive);this.Gc.$(Dc.a.vSe,dl.Ive);this.Gc.$(Dc.a.wSe,dl.Ive);this.Gc.$(Dc.a.nzd,Object(m.a)(this,this.gDe,"imageCropFromSpinnersExecuteBridge"));this.Gc.$(Dc.a.kzd,Object(m.a)(this,this.gDe,"imageCropFromSpinnersExecuteBridge"));this.Gc.$(Dc.a.lzd,Object(m.a)(this,this.gDe,"imageCropFromSpinnersExecuteBridge"));this.Gc.$(Dc.a.mzd,
Object(m.a)(this,this.gDe,"imageCropFromSpinnersExecuteBridge"));this.Gc.$(Mb.a.bsa,Object(m.a)(this,this.xLi,"ignoreAllExecuteBridge"));this.Gc.$(Mb.a.bEb,Object(m.a)(this,this.xLi,"ignoreAllExecuteBridge"));this.Gc.$(Dc.a.jLb,dl.jLb);this.Gc.$(Dc.a.GZe,cA.a.lkb);this.Gc.$(Mb.a.gTe,Object(m.a)(this,this.nij,"queryTableBorderFormattingExecuteBridge"));this.Gc.$(Mb.a.hTe,Object(m.a)(this,this.nij,"queryTableBorderFormattingExecuteBridge"))}clearCache(){super.clearCache();this.Lgf=!1;this.RMh=new mG.a;
this.wSh=new OE;this.rPh=new nG.a}t7f(){const a=super.t7f();a.eRa=dl.eRa;a.shb=dl.shb;return a}xLi(a){const d=new aw.a;d.zHa=!0;d.yR=a;return d}Pta(){const a=new aw.a;a.T$b=!1;a.yR=Mb.a.qKa;a.$c=this.RMh;a.LKc=!0;a.Csa=!0;return a}nij(){const a=new aw.a;a.T$b=this.Lgf;this.Lgf=!0;a.yR=Mb.a.c8a;a.$c=this.rPh;a.LKc=!0;a.Csa=!0;return a}E1d(){const a=new aw.a;a.T$b=!1;a.yR=Dc.a.aQc;a.$c=this.wSh;a.LKc=!0;a.Csa=!0;return a}gDe(a,d){const n=new aw.a;n.$c=new dh.DictionaryPropertySet;switch(a){case Dc.a.nzd:n.$c.setValue(Xc.a.tnb,
d[Tg.a.Number]);break;case Dc.a.kzd:n.$c.setValue(Xc.a.qnb,d[Tg.a.Number]);break;case Dc.a.lzd:n.$c.setValue(Xc.a.rnb,d[Tg.a.Number]);break;case Dc.a.mzd:n.$c.setValue(Xc.a.snb,d[Tg.a.Number])}return n}vXm(){const a=new aw.a;a.$c=new dh.DictionaryPropertySet;a.Csa=!0;return a}static get rNm(){return dl.IIh||(dl.IIh=la.a.instance.sa("WordEditor.IPageCommandStringBuilder"))}static get nC(){dl.eGa||(dl.eGa=la.a.instance.sa("WordEditor.ITableBorderManager"));return dl.eGa}static W7a(a,d){a=new aw.a;a.$c=
d;return a}static gUd(a,d,n){d[Yf.a.Description]=a?a.Htm(n):null}static eRa(a,d){const n=Object(qa.a)(mG.a,a.$c),z=Object(qa.a)(oP.a,a.$c),O=Object(qa.a)(OE,a.$c),ca=Object(qa.a)(nG.a,a.$c);let Da=!0;const Xa=dl.rNm;switch(a.qKb){default:Da=NE.a.eRa(a,d);break;case Mb.a.lOd:d[rj.a.Icon]=n.WIa?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";d[Yf.a.On]=!n.Yec;dl.gUd(Xa,d,0);break;case Mb.a.kOd:d[rj.a.Icon]=n.WIa?"PageMarginsLandscapeNarrow_48":"PageMarginsPortraitNarrow_48";d[Yf.a.On]=
1===n.Yec;dl.gUd(Xa,d,1);break;case Mb.a.jOd:d[rj.a.Icon]=n.WIa?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";d[Yf.a.On]=2===n.Yec;dl.gUd(Xa,d,2);break;case Mb.a.nOd:d[rj.a.Icon]=n.WIa?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";d[Yf.a.On]=3===n.Yec;dl.gUd(Xa,d,3);break;case Mb.a.mOd:d[rj.a.Icon]=n.WIa?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";d[Yf.a.On]=4===n.Yec;dl.gUd(Xa,d,4);break;case Mb.a.iOd:d[rj.a.Icon]=n.WIa?"PageMarginsLandscapeCustom_48":
"PageMarginsPortraitCustom_48";d[Yf.a.On]=5===n.Yec;break;case Mb.a.tOd:d[Yf.a.On]=!n.ghc;d[Yf.a.Description]=Xa?Xa.GLd(0):null;break;case Mb.a.sOd:d[Yf.a.On]=1===n.ghc;d[Yf.a.Description]=Xa?Xa.GLd(1):null;break;case Mb.a.rOd:d[Yf.a.On]=2===n.ghc;d[Yf.a.Description]=Xa?Xa.GLd(2):null;break;case Mb.a.oOd:d[Yf.a.On]=3===n.ghc;d[Yf.a.Description]=Xa?Xa.GLd(3):null;break;case Mb.a.pOd:d[Yf.a.On]=4===n.ghc;d[Yf.a.Description]=Xa?Xa.GLd(4):null;break;case Mb.a.qOd:d[Yf.a.On]=5===n.ghc;break;case Mb.a.NSe:d[Yf.a.On]=
!n.WIa;break;case Mb.a.MSe:d[Yf.a.On]=n.WIa;break;case Mb.a.dTe:d[Yf.a.On]=z.fu?!z.fu.specialIndentType:!1;break;case Mb.a.bTe:d[Yf.a.On]=z.fu?1===z.fu.specialIndentType:!1;d[rg.a.Image16by16Class]=z.isRtl?Vf.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):Vf.getImageClass("IndentSpecialFirstLine_Server_16x16x32");break;case Mb.a.cTe:d[Yf.a.On]=z.fu?2===z.fu.specialIndentType:!1;d[rg.a.Image16by16Class]=z.isRtl?Vf.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):Vf.getImageClass("IndentSpecialHanging_Server_16x16x32");
break;case Dc.a.oTe:d[Yf.a.On]=1===O.m$a;break;case Dc.a.pTe:d[Yf.a.On]=8===O.m$a;break;case Dc.a.qTe:d[Yf.a.On]=9===O.m$a;break;case Dc.a.mTe:d[Yf.a.On]=3===O.m$a;break;case Dc.a.nTe:d[Yf.a.On]=4===O.m$a;break;case Dc.a.pLb:d[Yf.a.On]=a.$c.fa(Xc.a.rsa,!1);break;case Dc.a.jLb:d[Yd.a.IsFreeForm]=!0;d[Yd.a.Value]=a.$c[go.a.Value];break;case Mb.a.gTe:d[Dg.a.On]=dl.nC.Iti(d.MenuItemId)===ca.fGd;break;case Mb.a.hTe:d[Dg.a.On]=dl.nC.Jti(d.MenuItemId)===ca.hGd}return Da}static Ktm(a,d){a=5;switch(d.MenuItemId){case "buttonMarginsNormal":a=
0;break;case "buttonMarginsNarrow":a=1;break;case "buttonMarginsModerate":a=2;break;case "buttonMarginsWide":a=3;break;case "buttonMarginsOffice2003":a=4}d=new aw.a;d.$c=a;return d}static ONm(a,d){a=5;switch(d.MenuItemId){case "buttonSizeLetter":a=0;break;case "buttonSizeLegal":a=1;break;case "buttonSizeExecutive":a=2;break;case "buttonSizeA4":a=3;break;case "buttonSizeA5":a=4}d=new aw.a;d.$c=a;return d}static jLb(){const a=new aw.a;a.yR=Dc.a.jLb;a.$c={};a.Csa=!0;a.LKc=!0;return a}static nWc(a,d){const n=
new aw.a;n.$c=new dh.DictionaryPropertySet;let z=1;switch(a){case Dc.a.n5e:z=1;break;case Dc.a.o5e:z=8;break;case Dc.a.p5e:z=9;break;case Dc.a.l5e:z=3;break;case Dc.a.m5e:z=4}n.$c.setValue(Xc.a.m$a,z);n.$c.setValue(Xc.a.cLa,d[Yf.a.SourceControlId]);return n}static OEc(a,d,n){a=new aw.a;a.$c=n.InvocationMethod;return a}static bWm(a,d){a=new aw.a;a.$c=d;return a}static eQd(){const a=new pP.a;a.yR=Dc.a.aQc;return a}static Ive(){const a=new aw.a;a.$c=new dh.DictionaryPropertySet;a.hEd=!0;return a}static shb(a,
d){let n=!0;switch(a.qKb){case Dc.a.fOd:a=a.$c.fa(Xc.a.tnb,0);d[Tg.a.Number]=a;d[Tg.a.UnitType]=7;break;case Dc.a.uSe:a=a.$c.fa(Xc.a.qnb,0);d[Tg.a.Number]=a;d[Tg.a.UnitType]=7;break;case Dc.a.vSe:a=a.$c.fa(Xc.a.rnb,0);d[Tg.a.Number]=a;d[Tg.a.UnitType]=7;break;case Dc.a.wSe:a=a.$c.fa(Xc.a.snb,0);d[Tg.a.Number]=a;d[Tg.a.UnitType]=7;break;default:n=NE.a.shb(a,d)}return n}}dl.IIh=null;dl.eGa=null;Object(t.a)(dl,"CuiActionBridge",NE.a,[]);class oG extends xg.a{constructor(a){super();this.fVk=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;
this.Jqn=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;this.Xqe=this.E_b=this.dea=this.Ddb=this.ruf=null;this.ib=a;this.Lf="<div id='AccessibilityHelpDialogBody'></div>";this.Je="AAccessibilityHelpDialog";this.wc=6;this.ee(0,CommonUIStrings.l_DialogClose)}get hWf(){return null}get MYe(){this.ruf||(this.ruf=this.h3l());return this.ruf}get VBn(){return 300}get b5i(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get a5i(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get jjb(){return this.ib.rk()}Dha(a){super.Dha(a);
this.sRm()}h9a(){this.showDialog(this.F3a,Object(m.a)(this,this.Fsk,"accHelpDialogResultHandler"));this.kXa();this.setFocus()}setFocus(){this.dea?(this.E_b=this.dea.tBodies[0].firstChild,this.$Y(this.E_b)):this.Tu&&"none"!==this.Tu.style.display?this.$Y(this.Tu):this.$Y(this.Lm)}Yka(){this.Cc.Ea(vb.a.Nf,this.Xqe,Object(m.a)(this,this.JSh,"accHelpDialogKeydownHandler"));if(this.dea){this.Cc.Ea(vb.a.Of,this.dea,Object(m.a)(this,this.HHj,"tableOnKeyUpHandler"));const a=this.dea.tBodies[0].children;for(let d=
0;d<a.length;d++)if(Qc.a.addHandler(a[d],vb.a.focus,Object(m.a)(this,this.vsj,"rowOnFocusHandler")),Qc.a.addHandler(a[d],vb.a.blur,Object(m.a)(this,this.usj,"rowOnBlurHandler")),I.a.Ah){const n=a[d].children;for(let z=0;z<n.length;z++)Qc.a.addHandler(n[z],vb.a.focus,Object(m.a)(this,this.u5h,"cellOnFocusHandler"))}}super.Yka()}ySa(){this.Cc&&(this.Cc.kb(vb.a.Nf,this.Xqe,Object(m.a)(this,this.JSh,"accHelpDialogKeydownHandler")),this.dea&&this.Cc.kb(vb.a.Of,this.dea,Object(m.a)(this,this.HHj,"tableOnKeyUpHandler")));
if(this.dea){const a=this.dea.tBodies[0].children;for(let d=0;d<a.length;d++)if(Qc.a.removeHandler(a[d],vb.a.focus,Object(m.a)(this,this.vsj,"rowOnFocusHandler")),Qc.a.removeHandler(a[d],vb.a.blur,Object(m.a)(this,this.usj,"rowOnBlurHandler")),I.a.Ah){const n=a[d].children;for(let z=0;z<n.length;z++)Qc.a.removeHandler(n[z],vb.a.focus,Object(m.a)(this,this.u5h,"cellOnFocusHandler"))}}super.ySa()}kXa(){this.jjb.scope.zq(this.ib.kN);this.jjb.scope.zq(this.ib.lN);this.jjb.scope.bindAction(this.ib.kN,
Sa.a.Rxc);this.jjb.scope.bindAction(this.ib.lN,Sa.a.Qxc)}yXl(a){if(!this.jjb.Tf||!this.jjb.Tf.VG)return 2;var d=this.jjb.Tf.VG;if(this.dea&&(d===this.Lm&&a===Sa.a.Rxc||d===this.Ddb&&a===Sa.a.Qxc))this.$Y(this.E_b);else if(d.id.startsWith("SelectableTableRow"))d=null,a===Sa.a.Rxc?d=this.Ddb:a===Sa.a.Qxc&&(d=this.Lm),d&&this.$Y(d);else if(a===Sa.a.Rxc)this.jjb.oWa();else if(a===Sa.a.Qxc)this.jjb.nWa();else return 2;return 32}vsj(a){a.target.setAttribute(pd.a.whb,pd.a.Rm);Sys.UI.DomElement.removeCssClass(this.E_b,
"inactiveRowSelection");this.E_b=a.target}usj(a){a.target.removeAttribute(pd.a.whb);Sys.UI.DomElement.addCssClass(a.target,"inactiveRowSelection")}u5h(a){(a=a.target.parentNode)&&a!==this.E_b&&this.$Y(a)}HHj(a){return a.Ua.keyCode===xb.a.Ms?(a.Ua.stopPropagation(),!0):!1}JSh(a){if(!a.Ua)return!1;const d=a.Ua.keyCode;if(a.eventName===vb.a.Nf){a=this.dDl(this.E_b);let n=-1;const z=ta.a.count(this.MYe)-1;d===Sys.UI.Key.down?n=a<z?a+1:0:d===Sys.UI.Key.up?n=0<a?a-1:z:d===Sys.UI.Key.home?n=0:d===Sys.UI.Key.end&&
(n=z);-1!==n&&this.$Y(this.dea.tBodies[0].children[n])}return!0}Fsk(){}sRm(){this.Xqe=document.getElementById("AccessibilityHelpDialogBody")||this.mA;this.B4k();this.n4k();this.r2k()}B4k(){if(this.hWf){var a=document.createElement("div");a.className="WACDialogSubtitle";var d=document.createElement("span");d.innerText=this.hWf;a.appendChild(d);this.RM.appendChild(a)}}n4k(){if(this.MYe&&!ta.a.isEmpty(this.MYe)){this.dea=document.createElement("table");this.dea.className="SelectableDialogTable";var a=
document.createElement("thead"),d=document.createElement("tr");d.setAttribute(pd.a.ig,pd.a.izc);a.appendChild(d);var n=ae.a.IBc(14,this.fVk);d.appendChild(n);n=ae.a.IBc(14,this.Jqn);d.appendChild(n);this.dea.appendChild(a);a=document.createElement("tbody");d=0;n=this.MYe;for(let ca in n){var z=ca,O=n[ca];const Da=document.createElement("tr");Da.tabIndex=0;Da.setAttribute(pd.a.ig,pd.a.izc);Da.id="SelectableTableRow"+d++;z=ae.a.IBc(15,z);Da.appendChild(z);O=ae.a.IBc(15,O);Da.appendChild(O);a.appendChild(Da)}a.style.maxHeight=
this.VBn+"px";this.dea.appendChild(a);this.Xqe.appendChild(this.dea)}}r2k(){if(this.a5i&&this.b5i){var a=document.createElement("div");a.className="WACDialogLearnMoreLinkContainer";this.Ddb=document.createElement("a");this.Ddb.innerText=this.a5i;this.Ddb.href=this.b5i;this.Ddb.target="_blank";this.Ddb.id=this.Kg("AccessibilityHelpDialogLink");this.Ddb.className=Ec.AFrame.eje;a.appendChild(this.Ddb);this.xb.insertBefore(a,this.xb.lastChild)}}dDl(a){return Number.parseInvariant(a.id.substr(18))}jaa(a,
d,n,z=null){a&&d&&n&&(n=z?String.format(n,z):n,a[d]=n)}jEi(a,d){return I.a.Pi?d:a}}Object(t.a)(oG,"AAccessibilityHelpDialog",xg.a,[944]);class MB extends oG{constructor(a){super(a)}get F3a(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get hWf(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}h3l(){const a=this.jEi(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),d=this.jEi(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),
n={};this.jaa(n,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);this.jaa(n,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,a);this.jaa(n,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);this.jaa(n,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,d);this.jaa(n,CommonUIStrings.l_AccHelpDialogTooltipToggle,
CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,a);this.jaa(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,a);this.jaa(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,a);this.jaa(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);
Rj.App.P4e&&this.jaa(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,a);this.jaa(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,a);this.jaa(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,a);this.jaa(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,a);this.jaa(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,a);this.jaa(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,a);l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("AccessibleMovingDialogsEnabled")&&this.jaa(n,
CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);l.AFrameworkApplication.K.ea("CatchUpActivityIsEnabled")&&this.jaa(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);(MB.Ka&&MB.Ka.isFeatureEnabled(105)||l.AFrameworkApplication.K.ea("WordEditorIdeasCardsIsEnabled"))&&this.jaa(n,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,
WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);return n}static get Ka(){return MB.Ja||(MB.Ja=la.a.instance.sa("Box4.IFeatureHelper"))}}MB.Ja=null;Object(t.a)(MB,"AccessibilityHelpDialog",oG,[]);class PE{static get Lf(){return xg.a.oz(PE.fm,WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}PE.fm="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";
Object(t.a)(PE,"ApplyStylesDialogHtml",null,[]);class MC extends xg.a{constructor(a,d){super();this.uL=this.Xb=null;this.ldd=!1;this.H1b=this.fxb=this.$8c=this.e9c=this.Edd=null;this._context=a;this.Ja=d;this.Je="ApplyStylesDialog";this.oc=this._context.view;this.lcg();a=this.wAn();d="";this.uL.length>a&&(d=this.uL[a]);d={["styleText"]:d,["styleList"]:a};this.Lf=PE.Lf;this.Ih(WordEditorIntl.WordEditorStrings.l_ApplyStyles,Object(m.a)(this,this.rEk,"applyStylesDialogHandler"),d);this.gxa=document.getElementById("styleList");
this.lNg();this.gxa.selectedIndex=a;this.jU=document.getElementById("styleText");this.jU.focus();this.jU.select();this.Wae=Object(m.a)(this,this.VGm,"onListSelectionChange");Qc.a.addHandler(this.gxa,"change",this.Wae);this.Vae=Object(m.a)(this,this.onKeyDown,"onKeyDown");Qc.a.addHandler(this.jU,"keydown",this.Vae);I.a.Sx?(this.e9c=Object(m.a)(this,this.JKm,"onTextPropChange"),Qc.a.addHandler(this.jU,"propertychange",this.e9c),this.Edd=this.uL[a]):(this.$8c=Object(m.a)(this,this.GK,"onKeyPress"),Qc.a.addHandler(this.jU,
"keypress",this.$8c))}get gb(){return this.Xb||(this.Xb=la.a.instance.resolve("Box4.Styles.IWACStyleReader"))}wAn(){var a=this.oc.Oa;if(!a||!a.ya)return Ld.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),0;a=a.ya.Ba;if(!a)return Ld.b(579216409,3018,15,"CurrentSelection is null"),0;Bd.ParagraphReader.rh(a.ra)&&(a=Qd.SelectionEditor.Xf(a,!0,!1));a=a.ra;if(!a||!Qd.SelectionEditor.Tl(a))return Ld.b(579216410,3018,15,"Received invalid nodeContext, null={0}",!a),0;var d=La.FormattingReader.yr(a);
(d=La.FormattingReader.Rra(d))||(d=this.gb.im(a.node));if(!d)return 0;a=this.gb.Lv(d);a=Array.indexOf(this.uL,a);0>a&&(a=0);return a}rEk(a,d){if(this.oc.mn){if(a){a=d.styleList;d=d.styleText;if(-1===a||w.a.He(d)!==w.a.He(this.uL[a]))a=this.zEi(d);d=this.uL[a];a=this.gb.kn();d=this.gb.Jd(a.dma(d));l.AFrameworkApplication.pa.rf(this._context,Mb.a.applyStyle,2,!1,new Yw.a,d)}this.oc.AD()}}lNg(){const a=this.uL.length;for(let d=0;d<a;d++){const n=document.createElement("OPTION");n.value=d.toString();
n.text=this.uL[d];this.gxa.add(n,null)}}lcg(){var a=sj.a.qz();if(a){a=(new Iw.WACStyleSet).VL(a);var d=a.Oz,n=this.Ja.isFeatureEnabled(185)&&!!this.gb.De;this.uL=[];for(let z=0;z<d;z++){const O=a.$X(z);if(this.gb.It(O))continue;const ca=this.gb.Mv(O);if(!n){if(3===ca)continue}else if(3===ca&&this.gb.Jd(O)===sy.a.B1d)continue;Array.add(this.uL,this.gb.Lv(O))}this.uL.sort(MC.$Vk)}else Ld.b(577644352,3018,15,"Couldn't find PageContentNode")}dispose(){this.e9c&&Qc.a.removeHandler(this.jU,"propertychange",
this.e9c);this.Vae&&Qc.a.removeHandler(this.jU,"keydown",this.Vae);this.Wae&&Qc.a.removeHandler(this.gxa,"change",this.Wae);this.$8c&&Qc.a.removeHandler(this.jU,"keypress",this.$8c);this.fxb&&l.AFrameworkApplication.tb.ie(this.fxb);this.fxb=this.$8c=this.gxa=this.jU=this.Vae=this.e9c=this.Wae=null;super.dispose()}JKm(a){this.ldd?(this.ldd=!1,this.validate()):"value"===a.rawEvent.propertyName&&(this.ldd=!0,this.jU.value!==this.Edd&&(this.Edd=this.jU.value,this.L_h()))}L_h(){var a=this.jU.value,d=this.O1l(a);
const n=-1===d?a:this.uL[d];a=a.length;const z=n.length;this.Edd=n;this.jU.value=n;this.gxa.selectedIndex=d;z>a&&(I.a.RH?this.jU.setSelectionRange(a,z):I.a.Sx&&(d=this.jU.createTextRange(),d.collapse(!0),d.moveStart("character",a),d.moveEnd("character",z-a),d.select()));this.validate();this.jU.focus()}VGm(){-1!==this.gxa.selectedIndex&&(I.a.Sx&&(this.ldd=!0),this.Edd=this.uL[this.gxa.selectedIndex],this.jU.value=this.uL[this.gxa.selectedIndex],this.validate())}onKeyDown(a){I.a.RH?a.keyCode!==xb.a.rC&&
a.keyCode!==xb.a.iZ||this.fxb||this.H1b||(this.H1b=new bf.a(0,1,1,Object(m.a)(this,this.YQn,"validateInputTaskCallback")),l.AFrameworkApplication.tb.rb(this.H1b)):I.a.Sx&&a.keyCode===xb.a.rC&&(this.ldd=!0)}GK(){this.fxb||(this.fxb=new bf.a(0,1,1,Object(m.a)(this,this.PFk,"autoCompleteTaskCallback")),l.AFrameworkApplication.tb.rb(this.fxb));this.H1b&&(l.AFrameworkApplication.tb.ie(this.H1b),this.H1b=null)}PFk(){this.fxb=null;this.L_h()}YQn(){this.H1b=null;this.validate()}O1l(a){let d=0,n=this.uL.length,
z=-1;for(a=w.a.He(a);d<n;){const O=Math.floor((d+n)/2),ca=MC.fOf(a,this.uL[O]);if(!ca){z=O;break}0<ca?d=O+1:n=O}if(z>d)for(;!MC.fOf(a,this.uL[z-1])&&(z--,z!==d););return z}validate(){const a=-1===this.zEi(this.jU.value),d=document.getElementById("badStyleError");a?(d.style.display="inline-block",d.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):(d.style.display="none",d.innerText="");return!a}zEi(a){a=w.a.He(a);const d=this.uL.length;for(let n=0;n<d;n++)if(a===w.a.He(this.uL[n]))return n;
return-1}static fOf(a,d){const n=Math.min(a.length,d.length);a=w.a.He(a);d=w.a.He(d);for(let z=0;z<n;z++){const O=w.a.charCodeAt(a,z),ca=w.a.charCodeAt(d,z);if(O!==ca)return O-ca}return a.length<=d.length?0:1}static $Vk(a,d){return MC.fOf(a,d)}}Object(t.a)(MC,"ApplyStylesDialog",xg.a,[]);class QE{static get Lf(){return xg.a.oz(QE.fm,WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists)}}
QE.fm="<div class='normal' id='text'> <label id='NameLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <br/> <div class='normal' id='text'> <label id='ParagraphLabel' class='WACDialogLabel' >{1}</label> <div id='previewContainer' class='previewContainer' style='height: 40px; border: solid 1px #c3cbd0; position: relative; overflow: hidden;'></div> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleNameError' role='alert'>{2}</div> </div>";
Object(t.a)(QE,"CreateNewStyleDialogHtml",null,[]);class Ss extends xg.a{constructor(a,d,n=!1){super(!1,!1,n);this.Xb=this.ky=null;this._context=a;this.ga=d;n=d=null;this.Je=Ss.id;if(this.oc=a.view)n=this.oc.Oa;n&&n.ya&&n.ya.Ba&&(d=n.ya.Ba.ra);d?(a=d.node)?(this.oy=Ss.Ze.kt(a))?(this.$D=(new Iw.WACStyleSet).VL(this.oy),(this.u2=this.K3f.lrd(d))?(a=this.u2.fa(Vd.a.fontSize,22),16>a?Ld.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=a?Ld.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):
90>=a?Ld.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):Ld.b(593078047,3018,50,"Font size more than 45pt in create new style dialog preview"),this.FUg(this.u2)):Ld.b(592737758,3018,10,"_newStyleProperties is null.")):Ld.b(592737757,3018,10,"_pageContenNode is null."):Ld.b(592725466,3018,10,"node is null."):Ld.b(556917206,3018,10,"nodeContext is null.")}FUg(a){a.oe(lh.a.paragraphStyle,lh.a.GA,...Fm.a.W_())}get K3f(){return this.ky||(this.ky=la.a.instance.resolve("Box4.IFormattingReader"))}get gb(){return this.Xb||
(this.Xb=la.a.instance.resolve("Box4.Styles.IWACStyleReader"))}t$f(a){if(!a)return"";const d=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,n=a.Oz;let z;for(z=1;z<=n;z++){const O=d+z;let ca=a.Mf(O)||a.mmb(O);ca||(ca=a.Mf(O+"Char")||a.mmb(O+"Char"));if(!ca)break}return d+z}oyc(a,d){const n=new Ff.GraphTransaction(15);n.Sa(this.oy);n.om=Mb.a.createNewStyle;if(d=sj.a.oyc(a,sj.a.Zag(d),null,this.oy))Ld.b(593078046,3018,50,"User created linked style"),this.$D=(new Iw.WACStyleSet).VL(this.oy),
a=w.a.qha(w.a.FI(a)),a=this.$D.mmb(a),this.ga.rf(this._context,Mb.a.applyStyle,2,!1,new Yw.a,this.gb.Jd(a));n.dispose();return d}QRj(a){var d=w.a.qha(a);const n=""===w.a.qha(a),z=a.length>Ss.zum,O=RegExp("[{|}|;|\\\\]").test(a);a=!!this.$D.dma(a)||!!this.$D.mmb(d);d=null;if(n||z||O||a)d=n?WordEditorIntl.WordEditorStrings.l_StyleNameEmpty:z?WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength:O?WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters:WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;
return d}static get Ze(){return jm.PageNavigator.instance}}Ss.id="CreateNewStyleDialog";Ss.kLe=26;Ss.zum=253;Ss.tGj=5;Ss.sGj=40;Object(t.a)(Ss,"ACreateNewStyleDialog",xg.a,[]);class eJ extends Ss{constructor(a,d){super(a,d);this.oy&&this.u2&&(a=this.t$f(this.$D),d={["styleText"]:a},this.Lf=QE.Lf,this.Ih(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,Object(m.a)(this,this.C2k,"createNewStyleDialogHandler"),d),this.jU=document.getElementById("styleText"),this.$Y(this.jU),d=document.getElementById("previewContainer"),
this.Ion(this.u2,a,d),this.j6d=document.getElementById("badStyleNameError"))}Owl(a){const d=a.fa(Vd.a.fontSize,nn.a.NA)>=2*Ss.kLe;a=It.a.Dwe(a,"97%",Ss.kLe,!1,!0,d)+" padding-left: "+Ss.tGj+"px;";d||(a=a+" line-height: "+Ss.sGj+"px;");return a}Ion(a,d,n){const z=document.createElement("div");z.innerText=d;a=this.Owl(a);z.setAttribute("style",a);n.appendChild(z)}C2k(a){this.oc.mn&&(a&&(a=new Map,a.set("Source","CreateNewStyleDialog"),a.set("Action","CreateStyle"),ja.Health.instance.recordKpiUsage(Fm.a.rwb,
0,Fm.a.aH,a),this.oyc(this.jU.value,this.u2)||(a=new Map,a.set("Source","CreateNewStyleDialog"),a.set("Action","CreateStyle"),a=Object.assign(new Sg.a,{extendedProperties:a}),ja.Health.instance.recordKpiFailure(Fm.a.rwb,"CreateStyleFailed",!1,!0,a))),this.oc.AD())}validate(){const a=this.QRj(this.jU.value),d=!!a;d?(this.j6d.style.display="inline-block",this.j6d.innerText=a):(this.j6d.style.display="none",this.j6d.innerText="");return!d}}Object(t.a)(eJ,"CreateNewStyleDialog",Ss,[]);class fJ extends $g.StandardDialog{constructor(a,
d){super();this.vA=this.Xb=this.nI=null;d||Ld.b(590128417,3018,10,"styleId is null");let n=null,z=null;if(this.oc=a.view)z=this.oc.Oa;z&&(n=z.ya.Ba.ra);n?(a=n.node)?(this.oy=this.Ze.kt(a))?(this.TOh=new db.a,this.TOh.add(d),this.vun(d)):Ld.b(590128448,3018,10,"_pageContenNode is null."):Ld.b(590128419,3018,10,"node is null."):Ld.b(590128418,3018,10,"nodeContext is null.")}get kZ(){return this.nI||(this.nI=la.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}get gb(){return this.Xb||(this.Xb=la.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get Ze(){return this.vA||
(this.vA=jm.PageNavigator.instance)}vun(a){const d=(new Iw.WACStyleSet).VL(this.oy);d?((a=d.Mf(a))||Ld.b(590128450,3018,10,"Style set doesn't contain style with given ID"),a=this.gb.Lv(a),this.wc=4,this.j5(2),this.iu(CommonUIStrings.l_DefaultDialogTitle,String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,a),0,Object(m.a)(this,this.Z8k,"deleteStyleConfirmationDialogHandler"))):Ld.b(590128449,3018,10,"Can't retrieve style set from page content node")}Z8k(a){if(1===
a){a=new Map;a.set("Source","DeleteStyleConfirmationDialog");a.set("Action","DeleteStyle");ja.Health.instance.recordKpiUsage(Fm.a.rwb,0,Fm.a.aH,a);var d=sj.a.qz();a=new Ff.GraphTransaction(15);a.Sa(d);a.om=Mb.a.yjb;this.kZ.A8k(this.TOh)?Ld.b(578359694,3018,50,"User deleted a style via UI."):(d=new Map,d.set("Source","DeleteStyleConfirmationDialog"),d.set("Action","DeleteStyle"),d=Object.assign(new Sg.a,{extendedProperties:d}),ja.Health.instance.recordKpiFailure(Fm.a.rwb,"DeleteStyleFailed",!1,!0,
d),Ld.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));a.dispose()}}}Object(t.a)(fJ,"DeleteStyleConfirmationDialog",$g.StandardDialog,[]);class RE{static get Lf(){return xg.a.oz(RE.fm)}}RE.fm="<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";Object(t.a)(RE,"DeleteStyleDialogHtml",null,[]);class gJ extends xg.a{constructor(a){super();this.oy=this.uL=this.Yxb=this.Xb=null;this._context=a;this.Je=
"DeleteStyleDialog";this.wc=1;this.ee(1,WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);this.oc=this._context.view;this.lcg();this.Lf=RE.Lf;this.Ih(WordEditorIntl.WordEditorStrings.l_DeleteStyle,Object(m.a)(this,this.$8k,"deleteStyleDialogHandler"),{["styleList"]:0});this.gxa=document.getElementById("styleList");this.lNg();this.gxa.selectedIndex=0;this.gxa.focus()}get gb(){return this.Xb||(this.Xb=la.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get bWf(){return this.Yxb||(this.Yxb=
la.a.instance.resolve("WordEditor.UI.IDialogFactory"))}$8k(a,d){this.oc.mn&&(a?(a=d.styleList,-1!==a&&(a=this.uL[a],d=this.gb.kn(),a=this.gb.Jd(d.dma(a)),this.bWf.Y8k(this._context,a),this.oc.AD())):this.oc.AD())}lNg(){const a=this.uL.length;for(let d=0;d<a;d++){const n=document.createElement("OPTION");n.value=d.toString();n.text=this.uL[d];this.gxa.add(n,null)}}lcg(){if(this.oy=sj.a.qz()){var a=(new Iw.WACStyleSet).VL(this.oy),d=a.Oz;this.uL=[];for(let z=0;z<d;z++){const O=a.$X(z);if(!this.gb.It(O)&&
this.gb.Gu(O,a)){var n=this.gb.Mv(O);if(2===n||1===n)O.hasProperty(Qb.a.AY)&&2!==n||(n=O.fa(Qb.a.Et,null))&&0<n.length||this.uL.push(this.gb.Lv(O))}}this.uL.sort()}else Ld.b(578650370,3018,15,"PageContentNode is null")}}Object(t.a)(gJ,"DeleteStyleDialog",xg.a,[]);var qP=b(702);class hJ{constructor(a){this.customData=null;this.TU=a}}Object(t.a)(hJ,"PropertySetChangedState",null,[]);class iJ{static BUm(a,d,n){if(a&&d){var z=new hJ(d),O=(ca,Da,Xa)=>{n.AUm(ca,Da,Xa,z)};a=new qP.a(d,a);a.J2b=O;a.v4b=O;
a.vjc=O;a.bXa()}}}Object(t.a)(iJ,"PropertySetChangedManager",null,[]);class jJ{constructor(a){this.cka=a}AUm(a,d,n,z){const O=this.cka[a.id.toString()];O&&O(a,d,n,z)}}Object(t.a)(jJ,"PropertyChangedProcessor",null,[]);const RD=(a,d,n)=>{const z=Qs.a.instance.f8b;if(z){const O=new Ff.GraphTransaction(15);O.Sa(z);iJ.BUm(a,d,new jJ(n));O.dispose()}};class SE{static get Lf(){return xg.a.oz(SE.fm,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,
WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}SE.fm="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(t.a)(SE,"MarginsDialogHtml",null,[]);class Fs{static get YJa(){return Fs.JIh||(Fs.JIh=la.a.instance.sa("WordEditor.IPageCommands"))}static Gtm(a,d,n){Fs.YJa&&null!==n&&Fs.YJa.PXe(0,n)}static Ctm(a,d,n){Fs.YJa&&null!==n&&Fs.YJa.PXe(3,n)}static Etm(a,d,n){Fs.YJa&&null!==n&&Fs.YJa.PXe(1,n)}static Ftm(a,d,n){Fs.YJa&&null!==n&&Fs.YJa.PXe(2,n)}static TNm(a,d,n){Fs.YJa&&null!==n&&Fs.YJa.YXa(0,n)}static BNm(a,d,n){Fs.YJa&&null!==n&&Fs.YJa.YXa(1,n)}}Fs.JIh=null;Object(t.a)(Fs,"PageLevelPropertyChangedHandlers",
null,[]);class xu extends xg.a{constructor(a,d,n,z,O){super();this.Je="MarginsDialog";this.Fka=d.clone();this.g2=a.clone();this.Ef=a.clone();this.k2=n;this.fW=!1;this.rw=O;this.Lf=SE.Lf;n&&(this.Uxb=to.a.YOb);this.Ih(WordEditorIntl.WordEditorStrings.L_PageMargins,Object(m.a)(this,this.Itm,"marginsDialogResultHandler"),null);this.jAd()}rV(){this.nle("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",Dc.a.iLd,Dc.a.ESe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.nle("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",Dc.a.hLd,Dc.a.BSe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.nle("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",Dc.a.zPe,Dc.a.CSe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.nle("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",Dc.a.APe,Dc.a.DSe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}jAd(){for(let a=0;a<xu.pYa.length;a++)yg.a.CGa(xu.pYa[a],Object(m.a)(this,
this.R8a,"setAdvancedControlValue"),Object(m.a)(this,this.r4a,"getAdvancedControlValue"));this.rw.T0("DialogMarginTopSpinner");this.rw.T0("DialogMarginBottomSpinner");this.rw.T0("DialogMarginLeftSpinner");this.rw.T0("DialogMarginRightSpinner")}dispose(){for(let a=0;a<xu.pYa.length;a++)yg.a.xSa(xu.pYa[a]);this.rw.WI("DialogMarginTopSpinner");this.rw.WI("DialogMarginBottomSpinner");this.rw.WI("DialogMarginLeftSpinner");this.rw.WI("DialogMarginRightSpinner");super.dispose()}r4a(a,d){var n=xu.PNd(a);
a=Lb.App.vJa;this.Ef.hasProperty(n)?(n=this.Ef.getValue(n),d[Tg.a.Number]=Wf.a.i$a(n,a)):d[Tg.a.Number]=0;d[Tg.a.UnitType]=a}R8a(a,d){this.Ef.setValue(xu.PNd(a),Wf.a.pvb(d[Tg.a.Number],d[Tg.a.UnitType]));this.rw.Km()}Itm(a){let d=!1;1===a&&(Math.abs(this.Ef.getValue(Qb.a.marginTop))+Math.abs(this.Ef.getValue(Qb.a.marginBottom))+Lb.App.$Da<=this.Fka.getValue(Qb.a.My)&&this.Ef.getValue(Qb.a.marginLeft)+this.Ef.getValue(Qb.a.marginRight)+Lb.App.$Da<=this.Fka.getValue(Qb.a.iq)?RD(this.g2,this.Ef,xu.X9b()):
d=!0);this.dispose();d&&this.NKa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,Object(m.a)(this,this.Dtm,"marginDialogCreator"))}Dtm(){la.a.instance.resolve("WordEditor.UI.IDialogFactory").Aci(this.g2,this.Fka,this.k2)}nle(a,d,n,z,O){n=xu.GJk(d,n,z,O);this.o3b(n,a,d)}o3b(a,d,n){d=document.getElementById(d);this.rw.e2a(n,a);a=this.rw.xFb(n,"Medium");d.appendChild(a)}static X9b(){return xu.cka||(xu.cka=xu.wDb())}static wDb(){const a={};a[Qb.a.marginTop.id.toString()]=Fs.Gtm;a[Qb.a.marginBottom.id.toString()]=
Fs.Ctm;a[Qb.a.marginLeft.id.toString()]=Fs.Etm;a[Qb.a.marginRight.id.toString()]=Fs.Ftm;return a}static GJk(a,d,n,z){let O=!0;if(d===Dc.a.iLd||d===Dc.a.hLd)O=!1;return Uh.o(a,d,n,z,[xu.IJk(O),xu.HJk(O)])}static IJk(a){return Uh.q("inch",a?"0":"-22","22",".1")}static HJk(a){return Uh.q("centimeter",a?"0":"-55.8","55.8","1")}static PNd(a){let d=null;switch(a){case Dc.a.iLd:case Dc.a.ESe:d=Qb.a.marginTop;break;case Dc.a.hLd:case Dc.a.BSe:d=Qb.a.marginBottom;break;case Dc.a.zPe:case Dc.a.CSe:d=Qb.a.marginLeft;
break;case Dc.a.APe:case Dc.a.DSe:d=Qb.a.marginRight}return d}}xu.pYa=[Dc.a.iLd,Dc.a.hLd,Dc.a.zPe,Dc.a.APe,Dc.a.ESe,Dc.a.BSe,Dc.a.CSe,Dc.a.DSe];xu.cka=null;Object(t.a)(xu,"MarginsDialog",xg.a,[]);class TE{static get Lf(){return xg.a.oz(TE.fm,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}TE.fm="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(t.a)(TE,"PaperSizeDialogHtml",null,[]);class cr extends xg.a{constructor(a,d,n,z,O){super();this.Je="PaperSizeDialog";this.Fka=d.clone();this.g2=a.clone();this.Ef=a.clone();this.k2=n;this.fW=!1;this.rw=O;this.Lf=TE.Lf;n&&(this.Uxb=to.a.YOb);this.Ih(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,Object(m.a)(this,this.cOm,"paperSizeDialogResultHandler"),null);this.jAd()}rV(){this.s2h("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",Dc.a.GPe,Dc.a.QSe,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);
this.s2h("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",Dc.a.FPe,Dc.a.PSe,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}jAd(){for(let a=0;a<cr.pYa.length;a++)yg.a.CGa(cr.pYa[a],Object(m.a)(this,this.R8a,"setAdvancedControlValue"),Object(m.a)(this,this.r4a,"getAdvancedControlValue"));this.rw.T0("DialogWidthSpinner");this.rw.T0("DialogHeightSpinner")}dispose(){for(let a=0;a<cr.pYa.length;a++)yg.a.xSa(cr.pYa[a]);this.rw.WI("DialogWidthSpinner");this.rw.WI("DialogHeightSpinner");
super.dispose()}r4a(a,d){var n=this.PNd(a);a=Lb.App.vJa;this.Ef.hasProperty(n)?(n=this.Ef.getValue(n),d[Tg.a.Number]=Wf.a.i$a(n,a)):d[Tg.a.Number]=0;d[Tg.a.UnitType]=a}R8a(a,d){this.Ef.setValue(this.PNd(a),Wf.a.pvb(d[Tg.a.Number],d[Tg.a.UnitType]));this.rw.Km()}cOm(a){let d=!1;1===a&&(this.Ef.getValue(Qb.a.My)>=Lb.App.$Da+this.Fka.getValue(Qb.a.marginTop)+this.Fka.getValue(Qb.a.marginBottom)&&this.Ef.getValue(Qb.a.iq)>=Lb.App.$Da+this.Fka.getValue(Qb.a.marginLeft)+this.Fka.getValue(Qb.a.marginRight)?
RD(this.g2,this.Ef,cr.X9b()):d=!0);this.dispose();d&&this.NKa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,Object(m.a)(this,this.bOm,"paperSizeDialogCreator"))}bOm(){la.a.instance.resolve("WordEditor.UI.IDialogFactory").fdi(this.g2,this.Fka,this.k2)}s2h(a,d,n,z,O){n=cr.YJk(d,n,z,O);this.o3b(n,a,d)}o3b(a,d,n){d=document.getElementById(d);this.rw.e2a(n,a);a=this.rw.xFb(n,"Medium");d.appendChild(a)}PNd(a){let d=null;switch(a){case Dc.a.FPe:case Dc.a.PSe:d=Qb.a.My;break;case Dc.a.GPe:case Dc.a.QSe:d=
Qb.a.iq}return d}static X9b(){return cr.cka||(cr.cka=cr.wDb())}static wDb(){const a={};a[Qb.a.iq.id.toString()]=Fs.TNm;a[Qb.a.My.id.toString()]=Fs.BNm;return a}static YJk(a,d,n,z){return Uh.o(a,d,n,z,[cr.$Jk(),cr.ZJk()])}static $Jk(){return Uh.q("inch",cr.YDj,cr.$im,cr.pxn)}static ZJk(){return Uh.q("centimeter",cr.YDj,cr.Zim,cr.oxn)}}cr.pYa=[Dc.a.GPe,Dc.a.FPe,Dc.a.QSe,Dc.a.PSe];cr.YDj="0";cr.$im="22";cr.pxn=".1";cr.oxn="1";cr.Zim="55.8";cr.cka=null;Object(t.a)(cr,"PaperSizeDialog",xg.a,[]);class kJ{constructor(){this.mEj=
this.kdj=this.jdj=this.gOm=this.rLg=!1}}Object(t.a)(kJ,"Box4PropertySetChangedState",null,[]);class Bk{static get BIc(){return Bk.Pzh||(Bk.Pzh=la.a.instance.sa("Box4.IIndentationCommands"))}static get fWi(){return Bk.OCh||(Bk.OCh=la.a.instance.sa("Box4.IJustificationCommands"))}static get fda(){return Bk.RAb||(Bk.RAb=la.a.instance.sa("Box4.ISpacingCommands"))}static eWi(a,d,n){Bk.fWi&&n&&(null===d||11!==n||10!==d&&9!==d)&&Bk.fWi.NH(n)}static MXi(a,d,n){Bk.fda&&n&&Bk.fda.cF(n)}static VXk(a,d,n){d!=
n&&Bk.fda.Zkc(n)}static Aim(a,d,n){d!=n&&Bk.fda.qSc(n)}static iQe(a,d,n,z){Bk.fda&&void 0!==n&&null!==n&&(a=Bk.btd(z),!a.rLg&&z.TU.hasProperty(Xc.a.bKa)&&z.TU.hasProperty(Xc.a.cKa)&&(d=z.TU.getValue(Xc.a.cKa),z=z.TU.getValue(Xc.a.bKa),a.rLg=!0,Bk.fda.Vta(1,d,z)))}static hQe(a,d,n,z){Bk.fda&&void 0!==n&&null!==n&&(a=Bk.btd(z),!a.gOm&&z.TU.hasProperty(Xc.a.$Ja)&&z.TU.hasProperty(Xc.a.aKa)&&(d=z.TU.getValue(Xc.a.aKa),z=z.TU.getValue(Xc.a.$Ja),a.rLg=!0,Bk.fda.Vta(0,d,z)))}static eQe(a,d,n,z){Bk.BIc&&
void 0!==n&&null!==n&&(a=Bk.btd(z),!a.jdj&&z.TU.hasProperty(Xc.a.hha)&&z.TU.hasProperty(Xc.a.iha)&&(d=z.TU.getValue(Xc.a.iha),z=z.TU.getValue(Xc.a.hha),a.jdj=!0,Bk.BIc.kyj(1,d,z)))}static fQe(a,d,n,z){Bk.BIc&&void 0!==n&&null!==n&&(a=Bk.btd(z),!a.kdj&&z.TU.hasProperty(Xc.a.iCa)&&z.TU.hasProperty(Xc.a.jCa)&&(d=z.TU.getValue(Xc.a.jCa),z=z.TU.getValue(Xc.a.iCa),a.kdj=!0,Bk.BIc.kyj(0,d,z)))}static tTc(a,d,n,z){Bk.BIc&&void 0!==n&&null!==n&&(a=Bk.btd(z),!a.mEj&&z.TU.hasProperty(Xc.a.Sha)&&z.TU.hasProperty(Xc.a.q5)&&
(d=0,z.TU.hasProperty(Xc.a.tM)&&(d=z.TU.getValue(Xc.a.tM)),n=z.TU.getValue(Xc.a.q5),z=z.TU.getValue(Xc.a.Sha),a.mEj=!0,Bk.BIc.eYe(d,n,z)))}static btd(a){a.customData||(a.customData=new kJ);return a.customData}}Bk.Pzh=null;Bk.OCh=null;Bk.RAb=null;Object(t.a)(Bk,"ParagraphLevelPropertyChangedHandlers",null,[]);class ni extends xg.a{constructor(a,d,n,z,O,ca){super();this.wZ=this.X6d=!1;this.Je="ParagraphDialog";ni.fda=n;this.$y=ca;this.g2=a.clone();this.Ef=a.clone();if(this.k2=d)this.Uxb=to.a.YOb}rV(){ni.t2h(ni.byn,
ni.tEj,Mb.a.Zgc,Mb.a.yic,Mb.a.m9a,Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,this.$y);ni.t2h(ni.ayn,ni.sEj,Mb.a.jLd,Mb.a.AOd,Mb.a.vTc,Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,this.$y);ni.AJk(ni.$xn,ni.j7g,this.$y);ni.DJk(ni.Ckm,ni.VIe,this.$y)}Fjg(){for(let a=0;a<ni.p_e.length;a++)yg.a.CGa(ni.p_e[a],Object(m.a)(this,this.R8a,"setAdvancedControlValue"),Object(m.a)(this,this.r4a,"getAdvancedControlValue"));yg.a.CGa(Mb.a.q7a,Object(m.a)(this,this.VMb,"setDropDownValue"),Object(m.a)(this,
this.fLb,"provideDropDownValue"));yg.a.CGa(Mb.a.PPc,Object(m.a)(this,this.VMb,"setDropDownValue"),Object(m.a)(this,this.fLb,"provideDropDownValue"));this.$y.Km()}dispose(){if(!this.wZ){for(let a=0;a<ni.p_e.length;a++)yg.a.xSa(ni.p_e[a]);yg.a.xSa(Mb.a.q7a);yg.a.xSa(Mb.a.PPc);this.$y.WI(ni.tEj);this.$y.WI(ni.sEj);this.$y.WI(ni.j7g);this.$y.WI(ni.VIe);super.dispose();this.wZ=!0}}r4a(a,d){switch(a){case Mb.a.yic:case Mb.a.AOd:var n=a===Mb.a.yic?Xc.a.cKa:Xc.a.aKa;a=a===Mb.a.yic?Xc.a.bKa:Xc.a.$Ja;this.Ef.hasProperty(n)&&
this.Ef.hasProperty(a)?(a=this.Ef.getValue(a),1===a?(d[Tg.a.Text]=Box4Intl.Box4Strings.L_SpinnerAuto,d[Tg.a.Number]=Number.NaN,d[Tg.a.UnitType]=5):(n=this.Ef.getValue(n),a=2===a?4:5,d[Tg.a.Number]=n,d[Tg.a.UnitType]=a)):(d[Tg.a.Text]="",d[Tg.a.Number]=Number.NaN,d[Tg.a.UnitType]=Lb.App.Uba?4:5);break;case Mb.a.hOd:n=!1,this.Ef.hasProperty(Xc.a.Lt)&&this.Ef.hasProperty(Xc.a.C4)&&2===this.Ef.getValue(Xc.a.C4)&&(this.tSi()||this.X6d)&&(a=ni.w0.P4a(this.Ef),a>=ni.zAg&&(d[Tg.a.Number]=a,n=!0)),n||(d[Tg.a.Text]=
"",d[Tg.a.Number]=Number.NaN),d[Tg.a.UnitType]=0}}R8a(a,d){var n=d[Tg.a.Text],z=d[Tg.a.Number],O=d[Tg.a.UnitType];switch(a){case Mb.a.Zgc:case Mb.a.jLd:n===Box4Intl.Box4Strings.L_SpinnerAuto?(n=0,z=1):(n=z,z=4===O?2:4);d=a===Mb.a.Zgc?Xc.a.bKa:Xc.a.$Ja;this.Ef.setValue(a===Mb.a.Zgc?Xc.a.cKa:Xc.a.aKa,n);this.Ef.setValue(d,z);break;case Mb.a.m9a:case Mb.a.vTc:O=a===Mb.a.m9a?Xc.a.cKa:Xc.a.aKa;a=a===Mb.a.m9a?Xc.a.bKa:Xc.a.$Ja;d=d.Increment;""===n||d&&n===Box4Intl.Box4Strings.L_SpinnerAuto?(this.Ef.setValue(O,
0),this.Ef.setValue(a,4)):z||d||(this.Ef.setValue(O,0),this.Ef.setValue(a,1));break;case Mb.a.gLd:this.Ixj(z);break;case Mb.a.yWd:""===n&&this.Ixj(ni.zAg)}this.$y.Km()}Ixj(a){this.Ef.setValue(Xc.a.C4,2);this.Ef.setValue(Xc.a.Lt,ni.w0.O9f(a));this.X6d=!0;this.$y.T0(ni.VIe)}fLb(a,d){switch(a){case Mb.a.PPc:this.LWm(d)}}LWm(a){let d=0;var n=!1;this.Ef.hasProperty(Xc.a.Lt)&&this.Ef.hasProperty(Xc.a.C4)||(n=!0);n||(2!==this.Ef.getValue(Xc.a.C4)&&(n=!0),d=ni.w0.P4a(this.Ef),d<ni.zAg&&(n=!0));n||(n=ni.xvg,
this.X6d||this.tSi()||(gf.a.r4(d,1)?n="1.00":gf.a.r4(d,1.5)?n="1.50":gf.a.r4(d,2)&&(n="2.00")),a[vd.a.SelectedItemId]=n)}VMb(a,d){switch(a){case Mb.a.q7a:this.Yjn(d)}}Yjn(a){a=a.MenuItemId;a===ni.xvg?(this.Ef.setValue(Xc.a.C4,2),this.Ef.setValue(Xc.a.Lt,ni.w0.O9f(3))):(a=parseFloat(a),this.Ef.setValue(Xc.a.C4,2),this.Ef.setValue(Xc.a.Lt,ni.w0.O9f(a)));this.X6d=!1;this.$y.T0(ni.VIe);this.$y.T0(ni.j7g)}mQe(a){1===a&&RD(this.g2,this.Ef,ni.X9b());this.dispose()}lQe(){const a=la.a.instance.resolve("Box4.UI.IBox4DialogFactory"),
d=la.a.instance.resolve("WordEditor.ClientPagination.IClientPaginationSettings");a.XBc(this.g2,null,this.k2,d)}tSi(){if(!this.Ef.hasProperty(Xc.a.Lt)||!this.Ef.hasProperty(Xc.a.C4)||2!==this.Ef.getValue(Xc.a.C4))return!1;const a=ni.w0.P4a(this.Ef);return!gf.a.r4(a,1)&&!gf.a.r4(a,1.5)&&!gf.a.r4(a,2)}static get w0(){return ni.DC||(ni.DC=la.a.instance.resolve("Box4.ILineSpacingHelper"))}static X9b(){return ni.cka||(ni.cka=ni.wDb())}static wDb(){const a={};a[Xc.a.Lt.id.toString()]=Bk.MXi;a[Xc.a.aKa.id.toString()]=
Bk.hQe;a[Xc.a.$Ja.id.toString()]=Bk.hQe;a[Xc.a.cKa.id.toString()]=Bk.iQe;a[Xc.a.bKa.id.toString()]=Bk.iQe;return a}static t2h(a,d,n,z,O,ca,Da){n=ni.bKk(d,n,z,O,ca);ni.n3b(n,a,d,Da)}static AJk(a,d,n){const z=ni.BJk(d);ni.n3b(z,a,d,n)}static DJk(a,d,n){const z=ni.EJk(d);ni.n3b(z,a,d,n)}static n3b(a,d,n,z){d=document.getElementById(d);z.e2a(n,a);a=z.xFb(n,"Medium");d.appendChild(a)}static bKk(a,d,n,z,O){return Uh.o(a,d,n,O,[ni.wKk(),ni.vKk()],[Box4Intl.Box4Strings.L_SpinnerAuto],z,ni.B_e)}static BJk(a){return Uh.o(a,
Mb.a.gLd,Mb.a.hOd,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,[ni.CJk()],null,Mb.a.yWd,ni.B_e)}static CJk(){return Uh.q("none","1","132",".5")}static wKk(){return Uh.q("point","0","1584","1")}static vKk(){return Uh.q("line","0","327","1")}static EJk(a){const d=Uh.f("DdlLineSpacing_Single","1.00",Mb.a.q7a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle),n=Uh.f("DdlLineSpacing_1.5","1.50",Mb.a.q7a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf),
z=Uh.f("DdlLineSpacing_Double","2.00",Mb.a.q7a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble),O=Uh.f("DdlLineSpacing_Multiple",ni.xvg,Mb.a.q7a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple);return Uh.n(a,Mb.a.q7a,Mb.a.PPc,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,ni.Dkm,[d,n,z,O])}}ni.Dkm=150;ni.B_e=70;ni.zAg=1;ni.tEj="DialogSpacingBeforeSpinner";ni.sEj="DialogSpacingAfterSpinner";ni.j7g="DialogLineSpacingAtSpinner";ni.byn="ParagraphDialogSpacingBeforeSpinnerContainer";
ni.ayn="ParagraphDialogSpacingAfterSpinnerContainer";ni.$xn="ParagraphDialogLineSpacingAtSpinnerContainer";ni.Ckm="ParagraphDialogLineSpacingContainer";ni.VIe="ParagraphDialogLineSpacingSelect";ni.xvg="multiple";ni.p_e=[Mb.a.Zgc,Mb.a.jLd,Mb.a.gLd,Mb.a.yic,Mb.a.AOd,Mb.a.hOd,Mb.a.yWd,Mb.a.vTc,Mb.a.m9a];ni.fda=null;ni.DC=null;ni.cka=null;Object(t.a)(ni,"ParagraphDialog",xg.a,[]);class UE{static get Lf(){return xg.a.oz(UE.fm,Box4Intl.Box4Strings.l_ParagraphDialogGeneral,Box4Intl.Box4Strings.l_ParagraphDialogAlignment,
Box4Intl.Box4Strings.l_ParagraphDialogIndentation,Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,Box4Intl.Box4Strings.l_ParagraphDialogSpacing,Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy)}}
UE.fm="<div class='WACDialogGroupBox ParagraphDialogLeftChunk' id='LeftChunk'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> <div class='ParagraphDialogContentArea' id='ParagraphDialogGeneralRow'> <div class='WACDialogGroupBox' id='GeneralLabelBox'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr role='presentation'> <td> <label id='Alignment' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogAlignmentContainer' >{1}</label> </td> <td> <div id='ParagraphDialogAlignmentContainer' class='WacSpinnerBox' aria-labelledby='Alignment' role='presentation'></div> </td> </tr> </table> <div class='WACDialogRow' id='ParagraphDialogIndentationRow'> <div class='WACDialogSectionTitle UIFontBold'>{2}</div> </div> <div class='WACDialogGroupBox ParagraphDialogContentArea' id='InnerRowIndentationLabels'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr role='presentation'> <td> <label id='ParagraphDialogIndentationLeft' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogIndentLeftSpinnerContainer' >{3}</label> </td> <td> <div id='ParagraphDialogIndentLeftSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogIndentationLeft' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogIndentationRight' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogIndentRightSpinnerContainer' >{4}</label> </td> <td> <div id='ParagraphDialogIndentRightSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogIndentationRight' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpecialIndent' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpecialIndentContainer' >{10}</label> </td> <td> <div id='ParagraphDialogSpecialIndentContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpecialIndent' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpecialIndentBy' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpecialIndentBySpinnerContainer' >{11}</label> </td> <td> <div id='ParagraphDialogSpecialIndentBySpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpecialIndentBy' role='presentation'></div> </td> </tr> </table> </div> </div> </div> </div> <div class='WACDialogGroupBox ParagraphDialogRightChunk' id='RightChunk'> <div class='WACDialogSectionTitle UIFontBold'>{5}</div> <div class='ParagraphDialogContentArea' id='InnerRowSpacing'> <div class='WACDialogGroupBox' id='SpacingLabelBox'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr> <td> <label id='ParagraphDialogSpacingBefore' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpacingBeforeSpinnerContainer' >{6}</label> </td> <td> <div id='ParagraphDialogSpacingBeforeSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpacingBefore' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpacingAfter' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpacingAfterSpinnerContainer' >{7}</label> </td> <td> <div id='ParagraphDialogSpacingAfterSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpacingAfter' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogLineSpacing' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogLineSpacingContainer' >{8}</label> </td> <td> <div id='ParagraphDialogLineSpacingContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogLineSpacing' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogLineSpacingAt' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogLineSpacingAtSpinnerContainer' >{9}</label> </td> <td> <div id='ParagraphDialogLineSpacingAtSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogLineSpacingAt' role='presentation'></div> </td> </tr> </table> </div> </div> </div>";
Object(t.a)(UE,"ParagraphDialogHtml",null,[]);const pG=a=>1===a||2===a||3===a||6===a||10===a||11===a||9===a||7===a||13===a,qG=(a,d,n,z)=>{let O=Lb.App.vJa;a.hasProperty(d)&&a.hasProperty(n)&&!z?(d=a.getValue(d),a=a.getValue(n),d?2===a?O=2:d=Wf.a.i$a(d,O):Lb.App.Uba&&(O=2)):(d=Number.NaN,Lb.App.Uba&&(O=2));return{sTc:d,xZa:O}},rP=a=>{let d="0";a.hasProperty(Xc.a.tM)&&(a=a.getValue(Xc.a.tM),(1===a||2===a||!a)&&(1===a?d="1":2===a?d="2":a||(d="0")));return d},VE=(a,d)=>{if(d.hasProperty(Xc.a.tM)&&2===
d.getValue(Xc.a.tM)&&d.hasProperty(Xc.a.q5)&&d.hasProperty(Xc.a.Sha)&&a.hasProperty(Xc.a.iha)&&a.hasProperty(Xc.a.hha)){var n=a.getValue(Xc.a.iha),z=a.getValue(Xc.a.hha);n=(new Ur.a(z,n)).pu;z=d.getValue(Xc.a.q5);d=d.getValue(Xc.a.Sha);d=(new Ur.a(d,z)).pu;a.setValue(Xc.a.iha,n+d);a.setValue(Xc.a.hha,1)}},oJ=(a,d)=>{var n;if(n=lJ(a,d))n=d.hasProperty(Xc.a.q5)&&d.hasProperty(Xc.a.Sha);if(n){n=d.getValue(Xc.a.q5);const z=d.getValue(Xc.a.Sha);n=(new Ur.a(z,n)).pu;return mJ(d)+nJ(d)+a.getValue(Qb.a.marginRight)+
a.getValue(Qb.a.marginLeft)+n+Lb.App.$Da<=a.getValue(Qb.a.iq)}return lJ(a,d)?mJ(d)+nJ(d)+a.getValue(Qb.a.marginRight)+a.getValue(Qb.a.marginLeft)+Lb.App.$Da<=a.getValue(Qb.a.iq):!0},mJ=a=>{const d=a.getValue(Xc.a.iha);a=a.getValue(Xc.a.hha);return(new Ur.a(a,d)).pu},nJ=a=>{const d=a.getValue(Xc.a.jCa);a=a.getValue(Xc.a.iCa);return(new Ur.a(a,d)).pu},lJ=(a,d)=>d.hasProperty(Xc.a.iha)&&d.hasProperty(Xc.a.hha)&&d.hasProperty(Xc.a.jCa)&&d.hasProperty(Xc.a.iCa)&&a.hasProperty(Qb.a.marginLeft)&&a.hasProperty(Qb.a.marginRight)&&
a.hasProperty(Qb.a.iq),sP=a=>a.hasProperty(Xc.a.IOc)?a.getValue(Xc.a.IOc):!1,tP=a=>a.hasProperty(Kr.a.gM)?a.getValue(Kr.a.gM):!1;class sr extends ni{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc){super(a,n,ca,Da,Xa,Vb);this.rm=Fc;this.Lf=UE.Lf;this.Fka=d.clone();this.Ih(Box4Intl.Box4Strings.l_ParagraphDialogTitle,Object(m.a)(this,this.mQe,"paragraphDialogResultHandler"),null);this.Fjg();a=document.getElementById("ParagraphDialogAlignmentControl-Medium");this.$Y(a)}rV(){sr.k2h("ParagraphDialogIndentLeftSpinnerContainer",
"DialogIndentLeftSpinner",Mb.a.Fac,Mb.a.rLb,Mb.a.Jmc,Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,this.$y);sr.k2h("ParagraphDialogIndentRightSpinnerContainer","DialogIndentRightSpinner",Mb.a.Jzd,Mb.a.DPc,Mb.a.xWd,Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,this.$y);sr.AKk(this.$y);const a=this.Ef.getValue(Xc.a.Kt);sr.lIk(a,this.$y);sr.CKk(this.$y);super.rV()}Fjg(){for(let a=0;a<sr.ADe.length;a++)yg.a.CGa(sr.ADe[a],Object(m.a)(this,this.R8a,"setAdvancedControlValue"),Object(m.a)(this,
this.r4a,"getAdvancedControlValue"));yg.a.CGa(Mb.a.nta,Object(m.a)(this,this.VMb,"setDropDownValue"),Object(m.a)(this,this.fLb,"provideDropDownValue"));yg.a.CGa(Mb.a.vic,Object(m.a)(this,this.VMb,"setDropDownValue"),Object(m.a)(this,this.fLb,"provideDropDownValue"));yg.a.CGa(Mb.a.s7a,Object(m.a)(this,this.VMb,"setDropDownValue"),Object(m.a)(this,this.fLb,"provideDropDownValue"));yg.a.CGa(Mb.a.zic,Object(m.a)(this,this.VMb,"setDropDownValue"),Object(m.a)(this,this.fLb,"provideDropDownValue"));super.Fjg()}dispose(){if(!this.kj){for(let a=
0;a<sr.ADe.length;a++)yg.a.xSa(sr.ADe[a]);yg.a.xSa(Mb.a.nta);yg.a.xSa(Mb.a.vic);yg.a.xSa(Mb.a.s7a);yg.a.xSa(Mb.a.zic);this.$y.WI("DialogIndentLeftSpinner");this.$y.WI("DialogIndentRightSpinner");this.$y.WI("ParagraphDialogAlignmentControl");this.$y.WI("ParagraphDialogSpecialIndentSelect");this.$y.WI("ParagraphDialogSpecialIndentBySpinner");super.dispose()}}r4a(a,d){var n=!1;switch(a){case Mb.a.rLb:case Mb.a.DPc:var z=a===Mb.a.rLb?Xc.a.iha:Xc.a.jCa,O=a===Mb.a.rLb?Xc.a.hha:Xc.a.iCa;n=Lb.App.vJa;this.Ef.hasProperty(z)&&
this.Ef.hasProperty(O)?(z=this.Ef.getValue(z),O=this.Ef.getValue(O),z?2===O?n=2:z=Wf.a.i$a(z,n):Lb.App.Uba&&(n=2),d[Tg.a.Number]=z):(d[Tg.a.Text]="",d[Tg.a.Number]=Number.NaN,Lb.App.Uba&&(n=2));d[Tg.a.UnitType]=n;n=!0;break;case Mb.a.BOd:z=Xc.a.q5;O=Xc.a.Sha;let ca=!1;n=Lb.App.vJa;this.Ef.hasProperty(Xc.a.tM)&&(ca=!this.Ef.getValue(Xc.a.tM));this.Ef.hasProperty(z)&&this.Ef.hasProperty(O)&&!ca?(z=this.Ef.getValue(z),O=this.Ef.getValue(O),z?2===O?n=2:z=Wf.a.i$a(z,n):Lb.App.Uba&&(n=2),d[Tg.a.Number]=
z):(d[Tg.a.Text]="",d[Tg.a.Number]=Number.NaN,Lb.App.Uba&&(n=2));d[Tg.a.UnitType]=n;n=!0}n||super.r4a(a,d)}R8a(a,d){var n=d[Tg.a.Text],z=d[Tg.a.Number],O=d[Tg.a.UnitType],ca=!1;switch(a){case Mb.a.Fac:case Mb.a.Jzd:n=z;2===O?ca=2:(ca=1,n=Wf.a.pvb(z,O));z=a===Mb.a.Fac?Xc.a.hha:Xc.a.iCa;this.Ef.setValue(a===Mb.a.Fac?Xc.a.iha:Xc.a.jCa,n);this.Ef.setValue(z,ca);ca=!0;break;case Mb.a.Jmc:case Mb.a.xWd:""===n&&(z=2===O?2:1,n=a===Mb.a.Jmc?Xc.a.hha:Xc.a.iCa,this.Ef.setValue(a===Mb.a.Jmc?Xc.a.iha:Xc.a.jCa,
0),this.Ef.setValue(n,z));ca=!0;break;case Mb.a.m9a:case Mb.a.vTc:O=a===Mb.a.m9a?Xc.a.cKa:Xc.a.aKa;ca=a===Mb.a.m9a?Xc.a.bKa:Xc.a.$Ja;const Da=d.Increment;""===n||Da&&n===Box4Intl.Box4Strings.L_SpinnerAuto?(this.Ef.setValue(O,0),this.Ef.setValue(ca,4)):z||Da||(this.Ef.setValue(O,0),this.Ef.setValue(ca,1));ca=!0;break;case Mb.a.kLd:""===n&&this.Ef.setValue(Xc.a.tM,1);this.Tyj(z,O);ca=!0;break;case Mb.a.AWd:""===n&&(this.Ef.setValue(Xc.a.tM,1),this.Tyj(.1,O)),ca=!0}ca||super.R8a(a,d)}Tyj(a,d){let n=
a,z;2===d?z=2:(z=1,n=Wf.a.pvb(a,d));this.Ef.setValue(Xc.a.q5,n);this.Ef.setValue(Xc.a.Sha,z);this.$y.T0("ParagraphDialogSpecialIndentBySpinner")}fLb(a,d){let n=!1;switch(a){case Mb.a.vic:this.KWm(d);n=!0;break;case Mb.a.zic:this.MWm(d),n=!0}n||super.fLb(a,d)}MWm(a){let d="0";if(this.Ef.hasProperty(Xc.a.tM)){const n=this.Ef.getValue(Xc.a.tM);(1===n||2===n||!n)&&(1===n?d="1":2===n?d="2":n||(d="0"))}a[vd.a.SelectedItemId]=d}KWm(a){if(this.Ef.hasProperty(Xc.a.Kt)){let d=this.Ef.getValue(Xc.a.Kt);if(10===
d||9===d)d=11;pG(d)&&(a[vd.a.SelectedItemId]=d.toString())}}VMb(a,d){let n=!1;switch(a){case Mb.a.nta:this.$mn(d);n=!0;break;case Mb.a.s7a:this.zon(d),n=!0}n||super.VMb(a,d)}zon(a){a=parseInt(a.MenuItemId);this.Ef.setValue(Xc.a.tM,a);this.$y.T0("ParagraphDialogSpecialIndentSelect");a?(this.Ef.setValue(Xc.a.Sha,1),this.Ef.hasProperty(Xc.a.q5)?this.Ef.getValue(Xc.a.q5)||this.Ef.setValue(Xc.a.q5,720):this.Ef.setValue(Xc.a.q5,720)):(this.Ef.setValue(Xc.a.Sha,1),this.Ef.setValue(Xc.a.q5,0));this.$y.T0("ParagraphDialogSpecialIndentBySpinner")}$mn(a){this.Ef.setValue(Xc.a.Kt,
parseInt(a.MenuItemId));this.$y.T0("ParagraphDialogAlignmentControl")}mQe(a){let d="";1===a&&(VE(this.g2,this.g2),VE(this.Ef,this.g2),oJ(this.Fka,this.Ef)?RD(this.g2,this.Ef,sr.ceg()):d=""!==d?d:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage);this.dispose();""!==d&&this.NKa(d,Object(m.a)(this,this.lQe,"paragraphDialogCreator"))}lQe(){la.a.instance.resolve("Box4.UI.IBox4DialogFactory").XBc(this.g2,this.Fka,this.k2,this.rm)}static ceg(){return ni.cka||(ni.cka=sr.PSf())}static PSf(){const a=ni.X9b();
a[Xc.a.Kt.id.toString()]=Bk.eWi;a[Xc.a.hha.id.toString()]=Bk.eQe;a[Xc.a.iha.id.toString()]=Bk.eQe;a[Xc.a.iCa.id.toString()]=Bk.fQe;a[Xc.a.jCa.id.toString()]=Bk.fQe;a[Xc.a.tM.id.toString()]=Bk.tTc;a[Xc.a.Sha.id.toString()]=Bk.tTc;a[Xc.a.q5.id.toString()]=Bk.tTc;return a}static k2h(a,d,n,z,O,ca,Da){n=sr.qJk(d,n,z,O,ca);ni.n3b(n,a,d,Da)}static AKk(a){const d=sr.BKk();ni.n3b(d,"ParagraphDialogSpecialIndentBySpinnerContainer","ParagraphDialogSpecialIndentBySpinner",a)}static lIk(a,d){a=sr.mIk(a);ni.n3b(a,
"ParagraphDialogAlignmentContainer","ParagraphDialogAlignmentControl",d)}static CKk(a){const d=sr.DKk();ni.n3b(d,"ParagraphDialogSpecialIndentContainer","ParagraphDialogSpecialIndentSelect",a)}static qJk(a,d,n,z,O){return Uh.o(a,d,n,O,[sr.tJk(),sr.sJk(),sr.rJk()],null,z,ni.B_e)}static BKk(){return Uh.o("ParagraphDialogSpecialIndentBySpinner",Mb.a.kLd,Mb.a.BOd,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,[sr.zKk(),sr.yKk(),sr.xKk()],null,Mb.a.AWd,ni.B_e)}static zKk(){return Uh.q("inch",
"0","22",".1")}static yKk(){return Uh.q("centimeter","0","55.88","1")}static xKk(){return Uh.q("character","0","316.8",".5")}static tJk(){return Uh.q("inch","-11","22",".1")}static sJk(){return Uh.q("centimeter","-27.94","55.88","1")}static rJk(){return Uh.q("character","-316.8","316.8",".5")}static mIk(a){return Uh.n("ParagraphDialogAlignmentControl",Mb.a.nta,Mb.a.vic,Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,150,sr.P2k(a))}static P2k(a){var d=Uh.f("DdlAlignment_Left","1",Mb.a.nta.toString(),
Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft),n=Uh.f("DdlAlignment_Center","2",Mb.a.nta.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter);const z=Uh.f("DdlAlignment_Right","3",Mb.a.nta.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignRight),O=Uh.f("DdlAlignment_Justified","6",Mb.a.nta.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified),ca=Uh.f("DdlAlignment_Kashida","11",Mb.a.nta.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida),Da=Uh.f("DdlAlignment_Distribued",
"7",Mb.a.nta.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed),Xa=Uh.f("DdlAlignment_ThaiDistribued","13",Mb.a.nta.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed);d=[d,n,z,O,Da];n=5;if(l.AFrameworkApplication.lcid===Ih.a.yf("AR-SA").LCID||11===a)d[n]=ca,n=6;if(l.AFrameworkApplication.lcid===Ih.a.yf("TH-TH").LCID||13===a)d[n]=Xa;return d}static DKk(){const a=Uh.f("DdlSpecialIndent_None","0",Mb.a.s7a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent),
d=Uh.f("DdlSpecialIndent_FirstLine","1",Mb.a.s7a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent),n=Uh.f("DdlSpecialIndent_Hanging","2",Mb.a.s7a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent);return Uh.n("ParagraphDialogSpecialIndentSelect",Mb.a.s7a,Mb.a.zic,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,150,[a,d,n])}}sr.ADe=[Mb.a.Fac,Mb.a.Jzd,Mb.a.s7a,Mb.a.kLd,Mb.a.nta,Mb.a.rLb,Mb.a.DPc,Mb.a.zic,Mb.a.BOd,Mb.a.vic,Mb.a.Jmc,Mb.a.xWd,Mb.a.AWd];Object(t.a)(sr,
"ParagraphDialog",ni,[]);class pJ extends Ss{constructor(a,d){super(a,d,!0);this.ryb=null;this.oy&&this.u2&&(this.XO=!1,a=this.t$f(this.$D),a=this.Itd(a,a),this.Ih(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,Object(m.a)(this,this.Fjj,"reactCreateNewStyleDialogHandler"),a))}Fjj(a,d){this.oc.mn&&(a?(a="string"===typeof d.styleText?d.styleText:null,(d=this.QRj(a))?(this.ryb=d,d=this.t$f(this.$D),a=this.Itd(a,d),this.ryb=null,this.fW=!1,this.hide(),this.Ih(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,
Object(m.a)(this,this.Fjj,"reactCreateNewStyleDialogHandler"),a),this.fW=!0):(this.hide(),d=new Map,d.set("Source","ReactCreateNewStyleDialog"),d.set("Action","CreateStyle"),ja.Health.instance.recordKpiUsage(Fm.a.rwb,0,Fm.a.aH,d),this.oyc(a,this.u2)||(a=new Map,a.set("Source","ReactCreateNewStyleDialog"),a.set("Action","CreateStyle"),a=Object.assign(new Sg.a,{extendedProperties:a}),ja.Health.instance.recordKpiFailure(Fm.a.rwb,"CreateStyleFailed",!1,!0,a)))):this.hide(),this.oc.AD())}Itd(a,d){var n=
this.u2.fa(Vd.a.fontSize,nn.a.NA)>=2*Ss.kLe;const z=It.a.AFc(this.u2,"97%",Ss.kLe,!1,!0,n);z["padding-left"]=Ss.tGj+"px";n||(z["line-height"]=Ss.sGj+"px");n={};n.styleNameLabel=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName;n.previewWindowLabel=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview;n.styleName=a;n.previewContainerText=d;n.getPreviewStyle=()=>z;this.ryb&&(n.errorMessage=this.ryb);return{["id"]:this.Je,["bodyControls"]:n}}}Object(t.a)(pJ,"ReactCreateNewStyleDialog",
Ss,[]);class WA extends xg.a{constructor(a,d=!1,n){super(!1,!1,d);let z=d=this.ky=null;this.Je=WA.id;this.oc=a.view;this.Tn=n;this.oc&&(z=this.oc.Oa);z&&z.ya&&z.ya.Ba&&(d=z.ya.Ba.ra);d?(a=d.node)?(this.oy=WA.Ze.kt(a))||k.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):k.ULS.sendTraceTag(539762889,3029,10,"node is null"):k.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}NQn(a){var d=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu"),n=this.nrl();const z=""===w.a.qha(a),
O=a.length>WA.xum;n=n.includes(a);d=d.test(a);a=a.startsWith("_");let ca=null;if(z||O||n||a||!d)ca=z?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:O?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:a?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:d?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return ca}w8l(a,d){return a?a===d:!1}static get Ze(){return jm.PageNavigator.instance}nrl(){const a=
this.Tn.$Ec(!1);let d=[];for(let n=0;n<a.count;n++){let z=a.J(n).fa(Qb.a.Ut,"");d.push(z)}return d}}WA.id="BookmarkEditDialog";WA.xum=40;Object(t.a)(WA,"AEditBookmarkDialog",xg.a,[]);class qJ extends WA{constructor(a,d,n){super(a,!0,n);this.ryb=null;this.Sbb="wwaengidc";this.R5c="ReactCreateEditBookmarkNameDialog";this.WCh="EditBookmarkName";this.V9d="EditBookmarkNameDialog";this.$9e=d;this.Tn=n;this.oy&&(this.XO=!1,a=this.Itd(d.properties.fa(Qb.a.Ut,null)),this.Ih(WordEditorIntl.WordEditorStrings.l_EditBookmark,
this.Hjj.bind(this),a))}Hjj(a,d){if(this.oc.mn){if(a){a="string"===typeof d.BookmarkText?d.BookmarkText:null;var n;this.$9e.hasProperty(Qb.a.Ut)?n=this.$9e.getValue(Qb.a.Ut):k.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");d=this.NQn(a);this.w8l(a,n)?(k.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):d?(this.ryb=d,n=this.Itd(a),this.ryb=null,this.fW=!1,this.hide(),this.Ih(WordEditorIntl.WordEditorStrings.l_EditBookmark,
this.Hjj.bind(this),n),this.fW=!0):(this.hide(),n=new Map,n.set("Source",this.R5c),n.set("Action",this.WCh),ja.Health.instance.recordKpiUsage(this.V9d,0,this.Sbb,n),this.hPk(a)||(n=new Map,n.set("Source",this.R5c),n.set("Action",this.WCh),n=Object.assign(new Sg.a,{extendedProperties:n}),ja.Health.instance.recordKpiFailure(this.V9d,"Unable to edit bookmark",!1,!0,n)))}else this.hide();this.oc.AD()}}hPk(a){a=w.a.qha(w.a.FI(a));try{const d=new dh.DictionaryPropertySet;d.setValue(Qb.a.Ut,a);this.Tn.ENj(this.$9e.id,
d,0,0);k.ULS.sendTraceTag(539762886,3029,50,"Updated bookmark name to name specified by user")}catch(d){return k.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",d.Message),!1}return!0}Itd(a){const d={};d.bookmarkValue=a;d.errorMessage=this.ryb;d.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.Je,["bodyControls"]:d}}}Object(t.a)(qJ,"ReactEditBookmarkNameDialog",WA,[]);const WE=(a,d)=>{const n=[];if(a.length!==
d.length)return n;for(let z=0;z<a.length;z++){const O={};O.key=d[z];O.text=a[z];O.type="AppComboBoxItem";n[z]=O}return n},kz=(a,d,n,z,O)=>({["unitType"]:a,["unitPlaceholder"]:w.a.WOc(d),["minValue"]:n,["maxValue"]:z,["step"]:O}),rG=()=>({["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}),rJ=(a,d,n)=>{let z=!1;a.hasProperty(d)&&a.hasProperty(n)?(n=a.getValue(n),1===n?(a=Number.NaN,d=5,z=!0):
(a=a.getValue(d),d=2===n?4:5)):(a=Number.NaN,d=Lb.App.Uba?4:5);return{sTc:a,xZa:d,oJc:z}};class XA{constructor(){this.cka=null}cJl(a){const d={};d.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};var n=kz("Point",5,0,1584,1),z=kz("Line",4,0,327,1),O=[n,z];z=rG();var ca=[Box4Intl.Box4Strings.L_SpinnerAuto];n=[""];({sTc:Xa,xZa:Da,oJc:zb}=rJ(a,Xc.a.cKa,Xc.a.bKa));var Da={["type"]:"AppSpinButtonProps",
["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:Wf.a.C5b(Da),["validUnits"]:O,["numberFormatInfo"]:z,["validReservedValues"]:ca};zb?Da.reservedValue=ca[0]:Da.value=isNaN(Xa)?"":Xa;d.beforeSpacingSpinButtonProps=Da;({sTc:Xa,xZa:Da,oJc:zb}=rJ(a,Xc.a.aKa,Xc.a.$Ja));O={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Wf.a.C5b(Da),["validUnits"]:O,["numberFormatInfo"]:z,["validReservedValues"]:ca};zb?O.reservedValue=ca[0]:O.value=isNaN(Xa)?"":Xa;d.afterSpacingSpinButtonProps=O;if(ca=O=a.hasProperty(Xc.a.Lt))ca=XA.w0.P4a(a),ca=a.hasProperty(Xc.a.Lt)&&a.hasProperty(Xc.a.C4)&&2===a.getValue(Xc.a.C4)?!gf.a.r4(ca,1)&&!gf.a.r4(ca,1.5)&&!gf.a.r4(ca,2):!1;if(O){var Xa=XA.w0.P4a(a);O=0;var zb=!1;a.hasProperty(Xc.a.Lt)&&a.hasProperty(Xc.a.C4)||
(zb=!0);zb||(2!==a.getValue(Xc.a.C4)&&(zb=!0),O=Xa,1>O&&(zb=!0));zb?O="":(Xa="multiple",ca||(gf.a.r4(O,1)?Xa="1.00":gf.a.r4(O,1.5)?Xa="1.50":gf.a.r4(O,2)&&(Xa="2.00")),O=Xa)}else O=null;Xa={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:WE([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,
Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["allowFreeForm"]:!1};O?Xa.selectedKey=O:Xa.defaultSelectedKey="";d.lineSpacingComboBoxProps=Xa;O=0;Xa=!1;a.hasProperty(Xc.a.Lt)&&a.hasProperty(Xc.a.C4)&&2===a.getValue(Xc.a.C4)&&ca&&(O=XA.w0.P4a(a),Xa=!0,1>O&&(O=Number.NaN));a=[kz("none",0,1,132,.5)];a={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:a,["numberFormatInfo"]:z,["validReservedValues"]:n};Xa?a.value=O:a.reservedValue=n[0];d.atSpinButtonProps=a;return d}X9b(){return this.cka||(this.cka=this.wDb())}wDb(){const a={};a[Xc.a.Lt.id.toString()]=Bk.MXi;a[Xc.a.aKa.id.toString()]=Bk.hQe;a[Xc.a.$Ja.id.toString()]=Bk.hQe;a[Xc.a.cKa.id.toString()]=Bk.iQe;a[Xc.a.bKa.id.toString()]=Bk.iQe;return a}static get w0(){return XA.DC||(XA.DC=la.a.instance.resolve("Box4.ILineSpacingHelper"))}}
XA.DC=null;Object(t.a)(XA,"ReactParagraphDialog",null,[]);class sJ extends xg.a{constructor(a,d,n,z,O,ca=la.a.instance.Ca("Box4.Settings.SpacingSettings")){var Da,Xa;super(!1,!1,!0);this.wO=this.vSh=null;ca.execute(Fc=>this.wO=Fc);this.g2=a.clone();this.Ef=a.clone();this.Fka=d.clone();this.k2=n;this.ga=z;this.nuf=new XA;this.rm=O;a=this.nuf.cJl(this.Ef);d=kz("Inch",3,-11,22,.1);n=kz("Inch",3,0,22,.1);ca=kz("Centimeter",1,-27.94,55.88,1);z=kz("Centimeter",1,0,55.88,1);var zb=kz("Character",2,-316.8,
316.8,.5);O=kz("Character",2,0,316.8,.5);d=[d,ca,zb];z=[n,z,O];n=rG();a.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};ca=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];zb=["1","2","3","6",
"7"];let Vb=5;O=this.Ef.hasProperty(Xc.a.Kt)?this.Ef.getValue(Xc.a.Kt):0;if(10===O||9===O)O=11;if(l.AFrameworkApplication.lcid===Ih.a.yf("AR-SA").LCID||11===O)a.isKashidaSupported=!0,ca[Vb]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,zb[Vb]="11",Vb=6;if(l.AFrameworkApplication.lcid===Ih.a.yf("TH-TH").LCID||13===O)a.isThaiSupported=!0,ca[Vb]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,zb[Vb]="13";ca={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:WE(ca,zb),["allowFreeForm"]:!1};pG(O)?ca.selectedKey=O.toString():ca.defaultSelectedKey="";a.alignmentComboBoxProps=ca;(null===(Da=this.rm)||void 0===Da?0:Da.$gg)||(a.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,["forId"]:"PaginationGroup"});this.rm.Idc&&(Da={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:tP(this.Ef)},a.keepWithNextCheckboxProps=Da);a.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};O=rP(this.Ef);Da="0"===O;a.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,
["showLabel"]:!0,["options"]:WE([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:O,["allowFreeForm"]:!1};ca=Lb.App.vJa;O=0;({sTc:O,xZa:ca}=qG(this.Ef,Xc.a.q5,Xc.a.Sha,Da));Da={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,
["unitType"]:Wf.a.C5b(ca),["validUnits"]:z,["numberFormatInfo"]:n};Da=this.I2g(O,Da);a.bySpinButtonProps=Da;z=Lb.App.vJa;Da=0;({sTc:Da,xZa:z}=qG(this.Ef,Xc.a.iha,Xc.a.hha,!1));z={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Wf.a.C5b(z),["validUnits"]:d,["numberFormatInfo"]:n};z=this.I2g(Da,z);a.beforeTextSpinButtonProps=z;z=Lb.App.vJa;Da=0;({sTc:Da,
xZa:z}=qG(this.Ef,Xc.a.jCa,Xc.a.iCa,!1));d={["type"]:"AppSpinButtonProps",["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:Wf.a.C5b(z),["validUnits"]:d,["numberFormatInfo"]:n};d=this.I2g(Da,d);a.afterTextSpinButtonProps=d;d={["id"]:"ParagraphDialog",["bodyControls"]:a};if(null===(Xa=this.wO)||void 0===Xa?0:Xa.YAa)Xa={["type"]:"AppCheckboxInternalProps",["id"]:"ContextualSpacingCheckbox",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,["checked"]:sP(this.Ef)},a.contextualSpacingCheckboxProps=Xa;d.dialogButtonsOption=9;d.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions};d.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:"left",["margin-left"]:"0"}}};this.Ih(Box4Intl.Box4Strings.l_ParagraphDialogTitle,Object(m.a)(this,this.mQe,"paragraphDialogResultHandler"),d)}ceg(a){return this.vSh||
(this.vSh=this.PSf(a))}PSf(a){var d,n;a[Xc.a.Kt.id.toString()]=Bk.eWi;a[Xc.a.hha.id.toString()]=Bk.eQe;a[Xc.a.iha.id.toString()]=Bk.eQe;a[Xc.a.iCa.id.toString()]=Bk.fQe;a[Xc.a.jCa.id.toString()]=Bk.fQe;a[Xc.a.tM.id.toString()]=Bk.tTc;a[Xc.a.Sha.id.toString()]=Bk.tTc;a[Xc.a.q5.id.toString()]=Bk.tTc;if(null===(d=this.wO)||void 0===d?0:d.YAa)a[Xc.a.IOc.id.toString()]=Bk.VXk;if(null===(n=this.rm)||void 0===n?0:n.Idc)a[Kr.a.gM.id.toString()]=Bk.Aim;return a}lQe(){la.a.instance.resolve("Box4.UI.IBox4DialogFactory").XBc(this.g2,
this.Fka,this.k2,this.rm)}mQe(a,d){var n,z;if(d&&(1===a||2===a)){if(d.alignmentComboBoxProps){var O=parseInt(d.alignmentComboBoxProps.selectedKey);isNaN(O)||pG(O)&&this.Ef.setValue(Xc.a.Kt,O)}var ca=d.bySpinButtonProps;O=!!ca&&""!==ca.value;var Da=d.didChangeSpecialIndentationComboBoxValue;if(d.specialIndentationComboBoxProps){var Xa=parseInt(d.specialIndentationComboBoxProps.selectedKey);1!==Xa&&2!==Xa&&Xa||!(Xa||Da||O)||this.Ef.setValue(Xc.a.tM,Xa)}if(ca){Xa=ca.value;ca=Wf.a.mDb(ca.unitType.toLowerCase());
let zb;0<=Xa||(Xa=0);2===ca?zb=2:(zb=1,Xa=Wf.a.pvb(Xa,ca));if(O||Da)this.Ef.setValue(Xc.a.q5,Xa),this.Ef.setValue(Xc.a.Sha,zb)}d.beforeTextSpinButtonProps&&(Da=d.beforeTextSpinButtonProps,O=Wf.a.mDb(Da.unitType.toLowerCase()),Da=""===Da.value?Number.NaN:Da.value,isNaN(Da)||(Xa=Da,2===O?ca=2:(ca=1,Xa=Wf.a.pvb(Da,O)),this.Ef.setValue(Xc.a.iha,Xa),this.Ef.setValue(Xc.a.hha,ca)));d.afterTextSpinButtonProps&&(Da=d.afterTextSpinButtonProps,O=Wf.a.mDb(Da.unitType.toLowerCase()),Da=""===Da.value?Number.NaN:
Da.value,isNaN(Da)||(Xa=Da,2===O?ca=2:(ca=1,Xa=Wf.a.pvb(Da,O)),this.Ef.setValue(Xc.a.jCa,Xa),this.Ef.setValue(Xc.a.iCa,ca)));d.beforeSpacingSpinButtonProps&&(O=d.beforeSpacingSpinButtonProps,Da=Wf.a.mDb(O.unitType.toLowerCase()),Xa=O.reservedValue,""!==O.value&&(Xa===Box4Intl.Box4Strings.L_SpinnerAuto?(Da=1,O=0):(Da=4===Da?2:4,O=O.value),this.Ef.setValue(Xc.a.cKa,O),this.Ef.setValue(Xc.a.bKa,Da)));d.afterSpacingSpinButtonProps&&(O=d.afterSpacingSpinButtonProps,Da=Wf.a.mDb(O.unitType.toLowerCase()),
Xa=O.reservedValue,""!==O.value&&(Xa===Box4Intl.Box4Strings.L_SpinnerAuto?(Da=1,O=0):(Da=4===Da?2:4,O=O.value),this.Ef.setValue(Xc.a.aKa,O),this.Ef.setValue(Xc.a.$Ja,Da)));if(d.atSpinButtonProps||d.lineSpacingComboBoxProps)if(O=d.atSpinButtonProps.value,1<O)this.Ef.setValue(Xc.a.Lt,O),this.Ef.setValue(Xc.a.C4,2);else if(O=d.lineSpacingComboBoxProps.selectedKey)O="1.00"===O?1:"1.50"===O?1.5:"2.00"===O?2:0,O=1<=O?O:1,this.Ef.setValue(Xc.a.Lt,O),this.Ef.setValue(Xc.a.C4,2);(null===(n=this.wO)||void 0===
n?0:n.YAa)&&d.contextualSpacingCheckboxProps&&this.Ef.setValue(Xc.a.IOc,d.contextualSpacingCheckboxProps.checked);(null===(z=this.rm)||void 0===z?0:z.Idc)&&d.keepWithNextCheckboxProps&&this.Ef.setValue(Kr.a.gM,d.keepWithNextCheckboxProps.checked);VE(this.g2,this.g2);VE(this.Ef,this.g2);d="";oJ(this.Fka,this.Ef)?RD(this.g2,this.Ef,this.ceg(this.nuf?this.nuf.wDb():{})):d=""!==d?d:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==d?this.NKa(d,Object(m.a)(this,this.lQe,"paragraphDialogCreator")):
2===a&&(we.c(Dc.a.$Sc,!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.ob(Dc.a.$Sc,2,null))}}I2g(a,d){d.value=isNaN(a)?"":a;return d}}Object(t.a)(sJ,"WordReactParagraphDialog",xg.a,[]);class tJ{k_k(a){new MC(a,la.a.instance.resolve("Box4.IFeatureHelper"))}B2k(a,d){l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.wz?new pJ(a,d):new eJ(a,d)}tdl(a,d,n){new qJ(a,d,n)}Aci(a,d,n){new xu(a,d,n,la.a.instance.resolve("WordEditor.IPageCommands"),la.a.instance.resolve("Common.IStandaloneRootController").e1)}fdi(a,
d,n){new cr(a,d,n,la.a.instance.resolve("WordEditor.IPageCommands"),la.a.instance.resolve("Common.IStandaloneRootController").e1)}HZk(a){return new MB(a)}XBc(a,d,n,z){l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.wz&&l.AFrameworkApplication.K.ea("ReactParagraphDialogIsEnabled")?new sJ(a,d,n,l.AFrameworkApplication.pa,z):new sr(a,d,n,la.a.instance.resolve("Box4.IIndentationCommands"),la.a.instance.resolve("Box4.IJustificationCommands"),la.a.instance.resolve("Box4.ISpacingCommands"),la.a.instance.vf("Box4.IFeatureHelper"),
l.AFrameworkApplication.K,la.a.instance.resolve("Box4.IParagraphIndentationReader"),la.a.instance.resolve("Common.IStandaloneRootController").e1,z)}Y8k(a,d){new fJ(a,d)}zVf(a){return new gJ(a)}}Object(t.a)(tJ,"DialogFactory",null,[547,548]);class SD extends xg.a{constructor(a,d){super(!1,!1,!0);this.Fhi="DoNotCheckSpellingCheckbox";this.Zhi="DocumentChoiceGroup";this.Y4d=0;this.vWi="LanguageList";this.documentContext="DocumentContext";this.Js="RangeContext";this.Sif=null;this.YCh=d;this.Y9d=a}J5g(){var a=
Array(2);a[0]={["key"]:this.Js,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};a[1]={["key"]:this.documentContext,["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const d={showDocumentChoiceGroup:!0};d.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;d.documentChoiceGroupProps={["id"]:this.Zhi,["defaultSelectedKey"]:this.T9l?this.Fxl():this.Js,["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:a};this.Y4d=({kWm:this.Msh}=this.Y9d.FNl(this.Msh)).returnValue;
d.languageListPropsProvider=this.VDl();d.spellingCheckboxProps={["id"]:this.Fhi,["checked"]:!this.Msh,["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};a={["id"]:"LanguageDialog",["bodyControls"]:d};this.Ih(Box4Intl.Box4Strings.l_Language,Object(m.a)(this,this.Lln,"setLanguageHandler"),a)}get T9l(){null==this.Sif&&null!=l.AFrameworkApplication.K&&(this.Sif=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefaultLanguageDialogOption",!1));return this.Sif}Fxl(){return this.Y9d.Cd()?
this.documentContext:this.Js}VDl(){return()=>{let a,d;const n=({selectedIndex:a,r5:d}=this.YCh.UDl(this.Y4d,a,d)).returnValue;for(let z=0;z<n.length&&z<d;z++)n[z].value=SD.Ilh+n[z].value;return{["id"]:this.vWi,["items"]:n,["selectedLanguageIndex"]:a,["applyBorderIndex"]:d}}}Lln(a,d){if(uf.a.instance.J(9)){var n=Ch.a.instance.mm(Mb.a.f1g);if(1!==a)n.properties.$("canceled","true");else{a=d[this.vWi].replace(SD.Ilh,"");var z=parseInt(a),O=Boolean.parse(d[this.Fhi]);d=d[this.Zhi];d===this.documentContext?
this.Y9d.akn(z,O):this.Y9d.don(z,O);n.properties.$("PreviousLCID",this.Y4d.toString());n.properties.$("ChangedLCID",z.toString());n.properties.$("NoProof",O.toString());this.YCh.Kln(z,this.Y4d);we.d(Mb.a.f1g,!0,void 0,void 0,void 0,void 0,[Object.assign(new ba.a,{name:"SelectedLcid",string:a}),Object.assign(new ba.a,{name:"NoProof",string:O.toString()}),Object.assign(new ba.a,{name:"Context",string:d})]);Lb.App.oa.updateCommandUI(!0)}n.end()}}}SD.Ilh="recent-";Object(t.a)(SD,"ReactLanguageDialog",
xg.a,[551]);class uJ extends PD{constructor(a,d,n,z){super(d,n);this.gh=a;this.eI=z}fDb(a,d,n){if(a=super.fDb(a,d,n))a.kPc=!0,a.GRe=!0,a.preventDismissOnScroll=!0;this.gh.m2a(Object(m.a)(this,this.VMg,"pollForStateAndUpdateFloatie"));return a}fAd(a,d,n=null){this.eI.B0h(()=>this.fDb(a,d,n))}INc(){this.floatie.kPc=!0}VMg(){this.floatie.Km()}}Object(t.a)(uJ,"ExternalContentFloatieInitializer",PD,[]);class vJ{Fhc(){Wl.instance.bBa&&(Mt.instance.Lvb([1,0]),Wl.instance.QHe()&&Nt.instance.Lvb([1]))}}Object(t.a)(vJ,
"RulerUser",null,[546]);class wJ{constructor(){this.whitelistedControlIds=null}}Object(t.a)(wJ,"StatusBarProps",null,[]);class TD{constructor(a,d){this.Kce=!1;this.$rf=null;this.bqa=d.jF;this.Ivf=d.FFj;Bi.a.get_instance().Ik(7,()=>{window.setTimeout(()=>{Ln.a.instance.Fd(()=>{xk.UISurfaces.sEi().then(n=>{const z=Object.assign(new wJ,{whitelistedControlIds:d.whitelistedControlIds});n.initializeNewStatusBar(a,z,this.Ivf);this.$rf=n;this.Kce=!0;window.setTimeout(()=>{Ln.a.instance.Fd(()=>{const O=[];
if(d.dL){const ca=d.dL;for(let Da in ca)O.push(appChrome.actions.updateControlHiddenState(Da,ca[Da]));appChrome.api.dispatch(O)}this.Fhc()},"RSB:I2")},0);return null}).catch(()=>{k.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(d.Vha&&a){TD.wyh||(l.AFrameworkApplication.pa.ma(Sa.a.X7g,Cd.a.frame,Object(m.a)(this,this.IFj,"statusBarTabAction")),l.AFrameworkApplication.pa.ma(Sa.a.W7g,Cd.a.frame,Object(m.a)(this,this.IFj,"statusBarTabAction")),TD.wyh=
!0);const n=to.a.Gjg(d.Vha,d.Xwj,a,!1);n.uK=!0;this.fQc(n,Sa.a.X7g,Sa.a.W7g)}},0)})}Fhc(){this.Kce&&this.bqa&&window.setTimeout(()=>{this.bqa(this.$rf.selectors.getStatusBarControlsMap(this.Ivf),7)},0)}QMb(a,d){this.Kce&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(a,d))},0)}yV(a){this.Kce&&this.bqa&&window.setTimeout(()=>{const d=this.$rf.selectors.getStatusBarControlsMap(this.Ivf);if(d[a]){const n={};n[a]=d[a];this.bqa(n,7)}},0)}fQc(a,d,n){const z=gb.KeyInputManager.$a(xb.a.Nw,
0),O=gb.KeyInputManager.$a(xb.a.Nw,4);a.zq(z);a.zq(O);a.bindAction(z,d);a.bindAction(O,n)}IFj(){return 4}}TD.wyh=!1;Object(t.a)(TD,"ReactStatusBar",null,[]);class xJ{constructor(){this.whitelistedControlIds=this.dL=this.jF=null;this.Ehm=!1;this.Xwj=this.Vha=this.FFj=null}}Object(t.a)(xJ,"ReactStatusBarInitOptions",null,[]);var YA=b(355);class yJ{constructor(a,d,n,z,O){this.Qvc=this.l1a=this.va=null;this.WXl=(ca,Da,Xa,zb,Vb)=>{if(!Vb)return k.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),
8;if(1===Xa)return 32;Vb&&2===Vb.length&&this.l1a&&this.l1a.QMb(Vb[0],Vb[0]);return 32};this.ga=z;Ln.a.instance.Fd(()=>{this.va=O;this.Qvc=this.l1a=null;let ca={};l.AFrameworkApplication.RZe||(ca[YA.a.xdn]=!0);ca.GiveFeedback=!l.AFrameworkApplication.zz;this.va.ea("OfficeOnlineInGallatinTextVisible")||(ca.CenterStatusLabel=!0);ca[YA.a.Ocj]=!0;this.va.ea("WPMPackageIsEnabled")&&this.va.ea("WPMStatusBarLabelIsEnabled")||(ca[YA.a.Shh]=!0);this.va.ea("AddInCommandsIsEnabled")||(ca[YA.a.ivk]=!0);this.va.ea("WordEditorShowOcsConnectionStatus")||
(ca[YA.a.tFg]=!0);ca[YA.a.ASn]=!0;this.va.ea("ReadingTimeIsEnabled")||(ca[YA.a.Tjj]=!0);this.va.ea("EditorGoalsEnabled")&&(ca[YA.a.kse]=!0);window.setTimeout(()=>{this.Y3l(a,ca)},0)},"SBU:I")}lb(){this.ga.Aa(Mb.a.XWd,Kb.a.application,this.WXl,96)}Y3l(a,d){this.Qvc=la.a.instance.sa("WordEditor.WordEditorReactCommandDefinitionMapping");const n={};for(let O in d){var z=d[O];n[this.fbg(O)]=z}this.l1a=new TD(a,Object.assign(new xJ,{dL:n,jF:Object(m.a)(this,this.Z_d,"updateStatusBarControls"),Ehm:!1,FFj:"WordEditorStatusBar",
Vha:og.AppFrame.Vha,Xwj:Object(m.a)(this,this.Qzn,"statusBarScopeSetFocus")}))}Qzn(){const a=Lb.App.oa.Zh.getRegion(og.AppFrame.Vha);a&&a.KMc()}Z_d(a){Lb.App.oa.jF(a)}fbg(a){let d="";if(this.Qvc){const n=this.Qvc.i8f(a);n&&0<n.count&&(d=n.J(0))}return d&&""!==d?d:a}Fhc(){this.l1a&&this.l1a.Fhc()}QMb(a,d){this.l1a&&this.l1a.QMb(this.fbg(a),d)}yV(a){this.l1a&&this.l1a.yV(this.fbg(a))}dispose(){}}Object(t.a)(yJ,"StatusBarUser",null,[545,12]);var zJ=b(1426);class sG{constructor(a){this.ga=a;this.ga.ma(Sa.a.MQc,
Cd.a.frame,Object(m.a)(this,this.MQc,"reportFileMenuPageSwitch"));this.ga.ma(Sa.a.ZVg,Cd.a.frame,Bc.ActionManager.Ke)}MQc(a,d,n,z,O){this.ga.processAction(this.Nzl(O[zJ.a.pageId]),2);return 32}}Object(t.a)(sG,"FileMenuSQMInformation",null,[882]);class AJ extends sG{constructor(a){super(a);this.J2m()}J2m(){this.ga.ma(Sa.a.$Ue,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Sa.a.TVg,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Sa.a.aVe,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Sa.a.UVg,Cd.a.frame,Bc.ActionManager.Ke);
this.ga.ma(Sa.a.VVg,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Sa.a.bVe,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Sa.a.WVg,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Sa.a.XVg,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Sa.a.YVg,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Sa.a.pWg,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Sa.a.qWg,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Sa.a.dWg,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Sa.a.eWg,Cd.a.frame,Bc.ActionManager.Ke)}Nzl(a){switch(a){case "menuJewelAbout":case "FileAboutPage":return Sa.a.$Ue;
case "tabHome":case "FileHomePage":return Sa.a.TVg;case "menuJewelInfo":case "FileInfoPage":return Sa.a.aVe;case "menuJewelNew":case "FileNewPage":return Sa.a.UVg;case "menuJewelOpen":case "FileOpenPage":return Sa.a.VVg;case "menuJewelPrint":case "FilePrintPage":return Sa.a.bVe;case "menuJewelSaveAs":case "FileSaveAsPage":return Sa.a.WVg;case "menuJewelShare":case "FileSharePage":return Sa.a.XVg;case "menuJewelTransform":case "FileTransformPage":return Sa.a.YVg}return Sa.a.ZVg}}Object(t.a)(AJ,"WordEditorFileMenuSQMInformation",
sG,[]);var BJ=b(1423);class tG{constructor(a){this.ga=a;this.ga.ma(Sa.a.NQc,Cd.a.frame,Object(m.a)(this,this.NQc,"reportTabSwitch"));this.ga.ma(Sa.a.mWg,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Sa.a.nWg,Cd.a.frame,Bc.ActionManager.Ke)}NQc(a,d,n,z,O){this.ga.processAction(this.FMl(O[BJ.a.jnc]),2);return 32}}Object(t.a)(tG,"RibbonSQMInformation",null,[843]);class CJ extends tG{constructor(a){super(a);this.s4m()}s4m(){this.ga.ma(Sa.a.iWg,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Sa.a.jWg,Cd.a.frame,
Bc.ActionManager.Ke);this.ga.ma(Dc.a.dVe,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Sa.a.kWg,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Sa.a.lWg,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Dc.a.Zpj,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Dc.a.$pj,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Dc.a.aqj,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Dc.a.bqj,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Dc.a.eVe,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Dc.a.cqj,Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Sa.a.oWg,
Cd.a.frame,Bc.ActionManager.Ke);this.ga.ma(Dc.a.dqj,Cd.a.frame,Bc.ActionManager.Ke)}FMl(a){switch(a){case "tabAddins":case "Addins":return Sa.a.iWg;case "tabHome":case "Home":return Sa.a.kWg;case "tabInsert":case "Insert":return Sa.a.lWg;case "tabDeveloper":case "Developer":return Sa.a.jWg;case "tabPageLayout":case "Layout":return Dc.a.Zpj;case "tabReferences":case "References":return Dc.a.bqj;case "tabReview":case "Review":return Dc.a.eVe;case "tabView":case "View":return Sa.a.oWg;case "Table":case "TableLayout":case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return Dc.a.cqj;
case "tabMailings":case "Mailings":return Dc.a.$pj;case "tabWordDesign":case "Design":return Dc.a.dqj;case "tabHelp":case "Help":return Dc.a.dVe;case "ctabPictureTools":case "Picture":return Dc.a.aqj}return Sa.a.nWg}}Object(t.a)(CJ,"WordEditorRibbonSQMInformation",tG,[]);class DJ{constructor(a=null,d=null,n=null){this.dL=a||{};this.gLj=d||[];this.iLj=n||{}}}Object(t.a)(DJ,"RibbonTrimmingProperties",null,[]);class EJ{constructor(a,d,n){this.lHa=a;this.dL=d;this.Gtg=n}}Object(t.a)(EJ,"ReactRibbonJewelProperties",
null,[]);class FJ{constructor(){l.AFrameworkApplication.pa.ma(Sa.a.RVa,Cd.a.frame,Object(m.a)(this,this.OZm,"reactFileMenuOpenFromTellMe"))}OZm(a,d,n,z,O){if(1===n||!O)return 32;a=O.SourceControlId;17!==O.UILocation||"New"!==a&&"Open"!==a||(O=[],xh.d("setFileMenuSelectedPage")&&("New"===a&&l.AFrameworkApplication.la?2===l.AFrameworkApplication.la.eb.Bm?O.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):O.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===a&&l.AFrameworkApplication.la&&
(2===l.AFrameworkApplication.la.eb.Bm?O.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):O.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),O.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(O));return 32}aXi(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}m8a(){return!1}Zej(){}rhi(){}}Object(t.a)(FJ,"ReactFileMenu",null,[453]);class GJ{gRf(){const a=new FJ,d=[];d.push(appChrome.actions.updateFileMenuExpandedValue(!1));
d.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(d);return a}}Object(t.a)(GJ,"ReactFileMenuFactory",null,[425]);class NC{constructor(a,d,n,z=!1){this.qLa=a;this.tBh=this.qLa.qsa;this.VMe=la.a.instance.sa("Common.IOfficeTrialExperience");this.Uec=la.a.instance.sa("Common.IMacOfficeOffer");NC.A$e=!1;this.Fdm=z;this.ga=d;this.ib=n}get Tb(){return this.ga}get Wg(){return this.ib}Fhd(){return this.tBh&&!!this.VMe&&!!this.Uec}qia(a,d){this.qLa.wq(()=>{k.ULS.sendTraceTag(5878046,
340,50,"Full app settings are ready");this.tBh=!0;this.d0f(a,d)});la.a.instance.Ca("Common.IOfficeTrialExperience").execute(n=>{k.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.VMe=n;this.d0f(a,d)});la.a.instance.Ca("Common.IMacOfficeOffer").execute(n=>{k.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.Uec=n;this.d0f(a,d)})}d0f(a,d){NC.A$e||(this.Fhd()?(k.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),a(this,d),NC.A$e=!0):
k.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}NC.A$e=!1;Object(t.a)(NC,"RibbonDependencies",null,[719]);class uG{constructor(a,d,n){this.VTb=a;this.ga=d;this.ib=n}}Object(t.a)(uG,"WoncaRibbonUserFactory",null,[115]);class HJ{constructor(a,d){this.Kaf=a;this.Mxc=d}vNb(a){this.Kaf.vNb(a);this.Mxc&&this.Mxc.vNb(a)}bUd(a){this.Kaf.bUd(a);this.Mxc&&this.Mxc.bUd(a)}a0d(a){this.Kaf.a0d(a);this.Mxc&&this.Mxc.a0d(a)}}Object(t.a)(HJ,"RibbonCommandTrimmer",null,[176]);var uP=
b(1081);class IJ{constructor(a,d){this.va=a;this.cwc=d}vNb(a){I.a.tg&&6>I.a.mAa&&(a.fseaInsertPicture=!0);this.va.ea("InsertSymbolIsEnabled")||(a.grpInsertSymbols=!0);this.va.ea("ClipartInsertEnabled")||(a.fseaInsertClipart=!0);this.va.ea("UIDiscoverabilityEnabled")||(a.jbtnAccessibilityHelp=!0);const d=this.va.ea("InsertOnlinePictureEnabled"),n=l.AFrameworkApplication.WFe();d||(a.fseaInsertOnlinePicture=!0,a.fseaFlyInsertOnlinePictureFromSearch=!0);n?a.fseaInsertPictureFromOneDrive=!0:(a.fseaFlyInsertOnlinePictureFromHost=
!0,a.fseaInsertOnlinePictureFromHost=!0);n&&d?(a.fseaInsertOnlinePicture=!0,a.fseaInsertOnlinePictureFromHost=!0):a.flyOnlinePicture=!0;l.AFrameworkApplication.mZd&&(a.btnOpenInClient=!0)}bUd(a){a.menuJewel=!0;l.AFrameworkApplication.zz||(a.jbtnGiveFeedback=!0)}a0d(a){delete a.menuJewel;l.AFrameworkApplication.vCa||(a.jbtnPrivacy=!0);l.AFrameworkApplication.Ajc||(a.jbtnReportAbuse=!0);l.AFrameworkApplication.LOb||(a.jbtnTermsOfUse=!0);l.AFrameworkApplication.qEc||(a.jbtnFileSharing=!0);uf.a.instance.J(4)&&
l.AFrameworkApplication.v8a||(a.jbtnShareRWC=!0);l.AFrameworkApplication.rrd||l.AFrameworkApplication.o0d||(a.jbtnVersion=!0);this.cwc.VMe&&this.cwc.VMe.uBm||(a.btnjTryOffice=!0,a.btnjTryOfficeForWordEditor=!0);this.cwc.Uec&&this.cwc.Uec.lsn||(a.btnjTryMacOffice=!0,a.btnjTryMacOfficeForWordEditor=!0);l.AFrameworkApplication.mZd?(a.btnjOpenInClient=!0,a.btnjEditInClient=!0):a[Lb.App.Vt?"btnjOpenInClient":"btnjEditInClient"]=!0;l.AFrameworkApplication.aLj&&(a.jbtnDownloadACopy=!0,a.jbtnDownloadAsPdf=
!0,a.jbtnDownloadAsOdt=!0);if(l.AFrameworkApplication.protectFile||I.a.hBa||!l.AFrameworkApplication.jac&&!l.AFrameworkApplication.prd&&!l.AFrameworkApplication.n0d)a.jbtnFileEmbed=!0;uP.a.eMi()||(a.btnjClose=!0);l.AFrameworkApplication.fpb?(a.jbtnVersion=!0,k.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):l.AFrameworkApplication.PHe()||(a.btnjVersionHistory=!0);a.jbtnVersion&&a.btnjVersionHistory&&a.btnjOpenInClient&&a.btnjEditInClient&&
(a.faInfo=!0);l.AFrameworkApplication.FTe||(a.faOpen=!0);a.jbtnFileSharing&&a.jbtnFileEmbed&&a.jbtnShareRWC&&(a.faShare=!0);a.AboutInformationMenuSectionDiagnostics=!this.va.ea("DiagnosticsInfoInJewelAboutMenuIsEnabled");a.btnjTryOffice&&a.btnjTryMacOffice&&a.jbtnTermsOfUse&&a.jbtnPrivacy&&a.AboutInformationMenuSectionDiagnostics&&(a.faAbout=!0);a.jbtnHelp&&a.jbtnGiveFeedback&&a.jbtnReportAbuse&&(a.faHelp=!0);a.btnjClose&&(a.msJewelSecondary=!0);const d=!!l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.vrg;
if(a.faOpen&&a.faNew||!d)a.faHome=!0}}Object(t.a)(IJ,"WoncaCommandTrimmer",null,[176]);var vP=b(993);b(659);var wP=b(1425),xP=b(1592);class JJ{constructor(a,d){this.V9=this.WO=null;this._clientId=a;this.fka=d}vgl(){if(!ze.c(this.V9))return this.V9;this.g_f();this.V9.style.display="block";this.fka&&this.fka.sU(Object(m.a)(this,this.onResize,"onResize"));return this.V9}onResize(){this.PCa()}PCa(){this.HZf()?(document.getElementById("application").style.minWidth="0px",(new xP.a(this.V9,null,l.AFrameworkApplication.isRtl)).Qen(this.V9)):
l.AFrameworkApplication.la.eb.eM||wP.a.Ren(this.V9,l.AFrameworkApplication.isRtl)}HZf(){return l.AFrameworkApplication.K?l.AFrameworkApplication.K.ea("EnhancedMobileViewIsEnabled"):!1}g_f(){if(ze.c(this.WO)){var a;({NHc:a}=to.a.XUc(!l.AFrameworkApplication.nH)).returnValue&&(this.WO=KE.a("div"),this.WO.className=to.a.cil,this.WO.id=qj.CuiHelper.Fte,a.appendChild(this.WO),this.ZZf(),l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.iV&&!l.AFrameworkApplication.nH&&this.$Zf(),this.ugl())}}ugl(){ze.c(this.V9)&&
(this.V9=KE.a("div"),this.V9.className=to.a.zah,this.V9.style.display="none",this.WO.appendChild(this.V9))}ZZf(){Sys.UI.DomElement.addCssClass(this.WO,to.a.dil);l.AFrameworkApplication.isRtl&&KE.b(this.WO,"cui-rtl")}$Zf(){Sys.UI.DomElement.addCssClass(this.WO,"FlexBoxLayout")}}Object(t.a)(JJ,"HeaderSkeleton",null,[]);var OC=b(587);class vG{constructor(){this.eXc=null}jIn(){this.eXc||(this.eXc=la.a.instance.sa("Common.App.AccountSwitching.IAccountSwitching"))||k.ULS.sendTraceTag(589050651,1300,10,
"Unable to resolve IAccountSwitching")}yql(){this.jIn();return this.eXc?this.eXc.getCustomAuthConfig():null}static M9l(){return l.AFrameworkApplication.K.ea("UiHostSupportsCustomAuthConfig")}}Object(t.a)(vG,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class wG{constructor(){this.Ndc=this.cultureName=null}}Object(t.a)(wG,"HeaderCultureInfo",null,[]);var XE=b(1441);class KJ{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(t.a)(KJ,"SearchInitializationSettings",
null,[]);var PC=b(270);class LJ{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(t.a)(LJ,"DocumentTitleAppProps",null,[]);class MJ{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=
this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(t.a)(MJ,"DocumentTitleCalloutAppProps",null,[]);class NJ{constructor(){this.language=this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showMeControl=this.showAppLauncher=this.isConsumer=
!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=
this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(t.a)(NJ,"HeaderAppProps",null,[]);class OJ{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(t.a)(OJ,"HeaderControls",null,[]);class PJ{constructor(){this.command=this.label=null}}Object(t.a)(PJ,"WorkflowButtonAppProps",null,[]);var YE;(function(a){a[a.none=0]="none";a[a.readOnly=1]="readOnly";a[a.insufficientPermission=2]="insufficientPermission";a[a.incompatibleEditorsPresent=
3]="incompatibleEditorsPresent";a[a.editorsPresent=4]="editorsPresent";a[a.notSupported=5]="notSupported"})(YE||(YE={}));Object(t.b)("RenameDisableReason",YE);class QJ{constructor(a=""){this.kZg=this.documentTitleAppProps=this.Qhh=null;this.Cok=""!==a?a:Xi.a.XK}ILl(a){const d=la.a.instance.sa("Common.IExternalUICommandDefinitionMapping").tFc(a);if(d&&0<d.length)return d[0].externalUxCommand;k.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",
a));return null}ieg(){if(!this.Qhh){const a=OC.a();if(a){const d=this.ILl(a.command);d&&(this.Qhh=Object.assign(new PJ,{command:d,label:a.label}))}}return this.Qhh}lwl(){return Object.assign(new OJ,{workflowButton:this.ieg()})}LEm(){Bi.a.get_instance().dG(17)}onMove(){const a={};a.MoveButtonClickedTime=new Date;l.AFrameworkApplication.pa.ob(Sa.a.rqb,2,a)}bMl(a){switch(a){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;
case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}oyl(){let a=null,d=null;var n=la.a.instance.sa("Common.IRenameProps");n?(n=n.YCi(),0!==n&&(a=this.bMl(n),d=YE[n])):k.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new MJ,{breadcrumbBrandName:l.AFrameworkApplication.Bs.breadcrumbBrandName,breadcrumbBrandUrl:l.AFrameworkApplication.Bs.breadcrumbBrandUrl,breadcrumbFolderName:l.AFrameworkApplication.Bs.breadcrumbFolderName,breadcrumbFolderUrl:l.AFrameworkApplication.Bs.breadcrumbFolderUrl,
hideDocumentTitleInput:l.AFrameworkApplication.la.eb.hKi,isVersionHistoryEnabled:this.htn(),documentExtension:w.a.yTa(l.AFrameworkApplication.fileName),isMoveEnabled:32===l.AFrameworkApplication.pa.processAction(Sa.a.rqb,1),onMove:Object(m.a)(this,this.onMove,"onMove"),message:a,renameDisableReason:d,openBreadcrumbsInNewTab:l.AFrameworkApplication.K.ea("OpenLinksInNewWindow")})}ywi(){if(!this.documentTitleAppProps){const a=l.AFrameworkApplication.Bs.EB;this.documentTitleAppProps=Object.assign(new LJ,
{documentTitle:l.AFrameworkApplication.V6b?a:w.a.HN(a),onFirstRender:Object(m.a)(this,this.LEm,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(m.a)(this,this.oyl,"getDocumentFlyoutProperties"),isShared:!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FileSharedStatusInSharePeripheralControl",!1)&&2===l.AFrameworkApplication.Bs.WUd})}return this.documentTitleAppProps}htn(){return!!l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.dsg}urn(){return!!l.AFrameworkApplication.la&&
l.AFrameworkApplication.la.eb.csg}Usn(){const a=!OC.b()&&!l.AFrameworkApplication.hideHeader&&!l.AFrameworkApplication.THc&&(l.AFrameworkApplication.K.ea("SkypeWebControlIsEnabled")||l.AFrameworkApplication.K.ea("TeamsChatIsEnabled"));k.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",a);return a}XXk(a){appChrome.getHeaderApi().then(d=>{d.setNavBarData(a.result);return null});k.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}d2m(a=!1){appChrome.getHeaderApi().then(d=>
{const n=la.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");d.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});d.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});d.setHeaderCommandHandler("OnFlexPaneOpen",z=>{n.onFlexPaneOpen(z)});d.setHeaderCommandHandler("OnFlexPaneClose",z=>{n.onFlexPaneClose(z)});d.setHeaderCommandHandler("SetCookie",z=>Fa.a.set(z.cookieName,z.value));d.setHeaderCommandHandler("GetCookie",z=>this.nwl(z));d.setHeaderCommandHandler("QueryWorkflowButtonSettings",
Object(m.a)(this,this.ieg,"getWorkflowButtonAppProps"));a||(d.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(m.a)(this,this.ywi,"getDocumentTitleAppProps")),d.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.MEm();return null}));XE.a.XGe()&&d.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(m.a)(this,this.ADi,"getSearchInitializationSettings"))})}MEm(){la.a.instance.Ca("Common.App.SaveStatus.ISaveStatusUIHandler").execute(a=>{a.Mvb(!1,l.AFrameworkApplication.pa.mode)})}nwl(a){a=
Fa.a.get(a);void 0!==a&&null!==a&&0<a.length&&(a=decodeURIComponent(a));return a}HPl(){return PC.AppChromeOverrideUtilities.isEnabled?PC.AppChromeOverrideUtilities.YFb("suiteux-shell",!1):this.Cok+l.AFrameworkApplication.pM+"suiteux-shell"}onFirstRender(){la.a.instance.Ca("Common.App.O365Shell.IO365ShellActor").execute(a=>{a.Cqn.continueWith(Object(m.a)(this,this.XXk,"continueShellServiceDataAsync"),3)});Bi.a.get_instance().dG(15)}onFullyLoaded(){Bi.a.get_instance().dG(16)}STa(a=!1){a:{try{var d=
Ih.a.yf(l.AFrameworkApplication.lcid);if(d){var n=Object.assign(new wG,{cultureName:d.name,Ndc:d.Ndc});break a}}catch(z){k.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+l.AFrameworkApplication.lcid.toString())}n=Object.assign(new wG,{cultureName:"en-us",Ndc:"en"})}d=la.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");n=Object.assign(new NJ,{appName:CommonUIStrings.l_AppNameShort,culture:n.cultureName,language:n.Ndc,isConsumer:!l.AFrameworkApplication.t0d,
showAppLauncher:OC.g(),showMeControl:OC.f(),hideUserName:l.AFrameworkApplication.$$b,defaultDocumentTitleToLeft:l.AFrameworkApplication.qqe,assetsContainerOverride:this.HPl(),controls:this.lwl(),documentTitleAppProps:a?null:this.ywi(),showDocumentTitleControl:!a,showWorkflowButton:!!this.ieg(),showChatControl:this.Usn(),showGoPremiumControl:OC.h(),enableSearchControl:XE.a.afm(),onFlexPaneOpen:Object(m.a)(d,d.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(m.a)(d,d.onFlexPaneClose,"onFlexPaneClose"),
enableTheming:this.urn(),testTraffic:l.AFrameworkApplication.K.ea("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(m.a)(this,this.onFirstRender,"onFirstRender"),onFullyLoaded:Object(m.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:OC.d()});!l.AFrameworkApplication.Zoc||l.AFrameworkApplication.YVd?(n.userDisplayName=l.AFrameworkApplication.userName,n.emailAddress=l.AFrameworkApplication.K.Ga("UserPrincipalName"),n.userID=l.AFrameworkApplication.K.Ga("Puid")||"",n.signOutLink=
l.AFrameworkApplication.YVd):l.AFrameworkApplication.signInUrl&&(n.signInLink=l.AFrameworkApplication.signInUrl);XE.a.XGe()&&(d=this.ADi(),n.loadTellMeResources=d.loadTellMeResources,n.getTokenRequestDictionary=d.getTokenRequestDictionary,n.enableVanillaSearchBox=l.AFrameworkApplication.K.ea("VanillaSearchUxInHeaderIsEnabled"),n.userRing=d.userRing);vG.M9l()&&(d=new vG,n.shellAuthProviderConfigPromise=Object(m.a)(d,d.yql,"getAccountSwitchingConfig"));this.d2m(a);return n}ADi(){if(!this.kZg){const a=
new XE.a;let d=l.AFrameworkApplication.K.Ga("Microsoft365Ring");d&&d.length||(d="generalAudience");this.kZg=Object.assign(new KJ,{loadTellMeResources:a.Olm(),getTokenRequestDictionary:Object(m.a)(a,a.qRl,"getTokenRequestDict"),userRing:d})}return this.kZg}}Object(t.a)(QJ,"ReactSharedHeaderPropsHelper",null,[1007]);class xG{constructor(){this.label=this.value=null}}Object(t.a)(xG,"TextInfoSectionField",null,[]);var UD=b(680);class yG{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(t.a)(yG,
"CommandDefinition",null,[]);class RJ{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(t.a)(RJ,"CommandDefinitionMapping",null,[]);const yP=a=>Object.assign(new RJ,{getCommandByExternalUxId:d=>{const n=a.getCommandByExternalUxId(d);return n?Object.assign(new yG,{commandId:parseInt(n.commandId),externalUxCommand:n.externalUxCommand}):Object.assign(new yG,{externalUxCommand:d})},getDoNothingCommand:()=>parseInt(Sa.a.rc),
addCommandToMaps:Object(m.a)(a,a.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(m.a)(a,a.addIconToMap,"addIconToMap"),addTabToMap:Object(m.a)(a,a.addTabToMap,"addTabToMap")});var zP=b(1204);class SJ{}Object(t.a)(SJ,"RibbonInitState",null,[]);var TJ=b(466),AP=b(1160);class UJ{constructor(){}flatten(a){const d=[];for(const n of a)d.push.apply(d,n);return d}}Object(t.a)(UJ,"ReactAsyncDispatcher",null,[]);class ZE{constructor(a,d){this.lw=null;this.Pce=!1;this.Izb=0;this.Hnf=a;this.ib=d;this.HHh=
Object(m.a)(this,this.bIg,"onModalMouseWheel")}onMenuOpen(){0<this.Izb?this.Izb++:(this.Izb++,l.AFrameworkApplication.K.ea("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame")?window.requestAnimationFrame(()=>{window.setTimeout(Object(m.a)(this,this.chj,"pushTransientFocusScope"),0)}):this.chj(),this.showModal())}chj(){this.ib&&this.ib.bG(Ec.AFrame.y8,!0)}showModal(){this.lw||(this.lw=this.createElement("div"),this.lw.setAttribute("id","ReactModalDiv"),this.lw.style.position="absolute",
this.lw.style.bottom="0px",this.lw.style.left="0px",this.lw.style.right="0px",this.lw.style.backgroundColor="white",this.lw.style.opacity="0.0",this.Hnf.appendChild(this.lw));const a=appChrome.selectors.getShyState();l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.Qma&&a.isActive&&1===a.state&&xh.a("getRibbonHeight")?this.lw.style.top=appChrome.api.getRibbonHeight(xh.f()).toString()+"px":this.lw.style.top="0px";this.lw.style.display="block";this.lw.style.visibility="visible";this.lw.style.zIndex=
"1000";this.Pce||(window.addEventListener("wheel",this.HHh,!0),this.lGe()?bi.a.instance.Ea(vb.a.UE,this.lw,Object(m.a)(this,this.qOe,"onModalPointerUp")):bi.a.instance.Ea(vb.a.pointerDown,this.lw,Object(m.a)(this,this.pOe,"onModalPointerDown")),this.Pce=!0)}onMenuClose(){this.Izb--;0<this.Izb||(0>this.Izb?this.Izb=0:this.mKi())}uGg(){this.Izb=0;this.bXf();this.mKi()}createElement(a){a=document.createElement(a);a.setAttribute("unselectable","on");return a}lKi(){this.ib&&this.ib.Zd&&this.ib.Zd.name===
Ec.AFrame.y8&&!l.AFrameworkApplication.tb.fp&&this.ib.QI(Ec.AFrame.y8,!1);this.lw&&(this.lw.style.zIndex="-1",this.lw.style.visibility="hidden",this.lw.style.display="none");this.Pce&&(window.removeEventListener("wheel",this.HHh,!0),this.lGe()?bi.a.instance.kb(vb.a.UE,this.lw,Object(m.a)(this,this.qOe,"onModalPointerUp")):bi.a.instance.kb(vb.a.pointerDown,this.lw,Object(m.a)(this,this.pOe,"onModalPointerDown")),this.Pce=!1)}mKi(){this.lGe()?window.requestAnimationFrame(()=>{window.setTimeout(()=>
{this.lKi()},0)}):this.lKi()}pOe(){this.fpd();this.Zgi();this.uGg();this.OKa();return!0}qOe(){this.fpd();this.Zgi();this.uGg();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.OKa()},0)});return!0}OKa(){4===l.AFrameworkApplication.la.eb.Bm&&l.AFrameworkApplication.K.ea("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?l.AFrameworkApplication.la.OKa():this.ib.wf(Ec.AFrame.ao)}bIg(a){a.stopPropagation()}fpd(){const a=la.a.instance.sa("Common.IReactContextualUILauncher");a&&a.fpd()}bXf(){const a=
la.a.instance.sa("Common.IReactContextualUILauncher");a&&a.bXf()}Zgi(){l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.xVa&&(this.lGe()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}lGe(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",!1)}}Object(t.a)(ZE,"ReactModalDiv",null,[]);class VJ{constructor(a,d){this.dok=a;this.v5j=d}}Object(t.a)(VJ,"ReactExecuteCommandContext",
null,[]);class bw{}bw.Trigger="FontTrigger";bw.Name="FontName";bw.Action="FontAction";bw.Level="FontLevel";bw.IsPinned="FontIsPinned";Object(t.a)(bw,"FontPickerLogProperties",null,[]);class WJ{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb=null,Fc=null){this.m6=null;this.HNh=!1;this.hef=[];this.U4d=-1;this.Ofe=!1;this.jpk=0;this.Opa=a;this.tAb=d;this.kMh=Object(qa.a)(847,a);this.Ho=n;this.ib=z;O&&(this.m6=new ZE(O,z));this.Olk=ca;this.$8j=Da;this.ty=Vb;this.ga=Xa;this.CWb={};this.va=zb;this.lnh=Fc;zb&&zb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",
!1)&&fk.a.instance.Tyc.CWR(()=>this.HNh=!0)}get Uuj(){return!!window.appChrome&&!!appChrome.selectors}Stj(){-1!==this.U4d&&window.clearTimeout(this.U4d);this.U4d=window.setTimeout(()=>{for(this.U4d=-1;0<this.hef.length;){if(th.a.instance.fp){this.Stj();break}const a=this.hef.shift();a&&this.executeCommand(a.dok,a.v5j)}},0)}executeCommand(a,d){if(th.a.instance.fp){if(this.HNh){this.hef.push(new VJ(a,d));this.Stj();return}k.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",
a,d.modelType,ta.a.toJSON(d.payload));if(this.va.ea("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(d){const n=this.Ho.getCommandByExternalUxId(a),z=d.modelType;this.lnh&&this.lnh.X_i(a,d);n?this.hhl(a,n,z,d):this.ihl(a,z,d);this.qtm(a,d)}}ihl(a,d,n){switch(d){case "GalleryModel":case "PreviewGalleryModel":this.Uli(n,a)}}kOn(a,d,n,z,O){if(n.payload)switch(n.payload.type){case "CoauthorMenuPayload":a.MenuItemId=n.payload.coauthorId;break;case "ButtonPayload":a.MenuItemId=d.menuItemId;a.CommandValueId=
n.payload.commandValueId;this.Gqa();break;case "ButtonPreviewPayload":a.MenuItemId=d.menuItemId;a.CommandValueId=n.payload.commandValueId;O=d.commandPreviewId;break;case "ButtonRevertPreviewPayload":a.MenuItemId=d.menuItemId;a.CommandValueId=n.payload.commandValueId;O=d.commandRevertId;break;default:a.MenuItemId=d.menuItemId}else a.MenuItemId=d.menuItemId;a.SourceControlId=z;return O}lOn(a,d,n){if(d.payload)switch(d.payload.type){case "MenuOpenPayload":a=this.Ho.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;
break;case "MenuClosePayload":a=this.Ho.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":n.CommandId=d.payload.executedControl;n.ControlId=d.payload.executedControl;n.ParentControlId=d.payload.parentControl;n.CloseAllMenus=!0;this.Gqa();break;case "TellMeSearchResultChangePayload":n.Value=d.payload.searchText;break;case "SmartLookupPayload":n.CommandValueId=d.payload.selectionContextJson}return a}hhl(a,d,n,z){var O=this.rRm(z,n),ca=d.commandId;const Da=
{},Xa={};switch(n){case "SplitButtonModel":if(this.Xxd(z.payload,Object(m.a)(this,this.fPn,"updateSplitButtonMenuState"),O))return;Da.MenuItemId=d.menuItemId;this.t2g(z,Da);break;case "StatefulSplitButtonModel":if(this.Xxd(z.payload,Object(m.a)(this,this.oPn,"updateStatefulSplitButtonMenuState"),O))return;n=z.payload.statefulData;O=z.payload.statefulMode;"color"===O?Da.Color=n:"icon"===O&&(n=this.Ho.getCommandByExternalUxId(n))&&(Da.MenuItemId=n.menuItemId);break;case "FileMenu":Da.MenuItemId=d.menuItemId;
Da.SourceControlId=a;z.payload&&"FileMenuPageSwitchPayload"===z.payload.type&&this.UVl(ca,z.payload,a);break;case "TellMe":ca=this.lOn(ca,z,Da);Da.SourceControlId=a;Da.Location=z.payload.location;break;case "ButtonModel":z.payload&&"TabSwitchPayload"===z.payload.type?this.zXl(Da,z):ca=this.kOn(Da,d,z,a,ca);break;case "CompoundButtonModel":Da.MenuItemId=d.menuItemId;Da.CommandValueId=z.payload.commandValueId;Da.SourceControlId=a;this.t2g(z,Da);this.Gqa();break;case "ToggleButtonModel":case "InkButtonModel":Da.MenuItemId=
d.menuItemId;Da.SourceControlId=a;this.t2g(z,Da);this.Gqa();break;case "FontPickerModel":switch(z.payload.type){case "MenuOpenPayload":return;case "MenuClosePayload":ca=this.Ho.getCommandByExternalUxId("FontPickerMenuClose").commandId;Da[KC.a.FontPickerId]=z.payload.launcherId;break;case "FontPickerFontSelectedPayload":n=z.payload.font;O=null;"string"===typeof n?(O=Up.FontUtils.O4(n),Da.CommandValueId=O,O=Up.FontUtils.vDb(O)):(n.data?(Da.CommandValueId=n.data.fontToApply,Da.MenuItemId=n.data.themeIndex,
Da[KC.a.Formatting]=n.data):Da.CommandValueId=n.name,O=n);Da.SourceControlId=a;Da[KC.a.RequestUpdateMru]=O;Xa[bw.Name]=z.payload.nameToLog?z.payload.nameToLog:"string"===typeof n?Up.FontUtils.vHb(n)?"*"+n:Up.FontUtils.OJc(n)?"[EF]":"[MF]":"";Xa[bw.IsPinned]=z.payload.isPinned;Xa[bw.Level]=z.payload.level;this.hxg();break;case "FontPickerFontInfoRequestedPayload":Da.CommandValueId=z.payload.font.name;Da[KC.a.Trigger]=z.payload.trigger;Xa[bw.Trigger]=z.payload.trigger;Xa[bw.Name]=z.payload.nameToLog;
this.hxg();break;case "FontPickerFontPinningPayload":n=z.payload.isPinned;Da.CommandValueId=z.payload.fontKey;Da[KC.a.IsPinned]=n;Xa[bw.Name]=z.payload.nameToLog;Xa[bw.Action]=n?"pin":"unpin";Xa[bw.Level]=z.payload.level;this.hxg();break;default:return}break;case "ComboBoxModel":var zb=z.payload.type;switch(zb){case "MenuOpenPayload":case "MenuPopulatePayload":this.USc(z.payload.launcherId,O)&&(ca={},ca[z.payload.launcherId]=n,this.tAb.xMd(ca,xh.g(z.payload)),this.CWb[a]=new Date);return;case "MenuClosePayload":return;
case "ComboBoxPayload":case "ComboBoxPreviewPayload":n=z.payload.newValue;if(!n)return;n.value?(Da[Yd.a.Value]=n.value,Da[Yd.a.IsFreeForm]=!0):(Da[Yd.a.Value]=n.text,Da.MenuItemId=n.key,Da.CommandValueId=n.commandValueId);"ComboBoxPreviewPayload"===zb&&(ca=d.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":ca=d.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(z.payload.type){case "ZeroTermContextMenuClosePayload":n=ta.a.NF(z.payload);for(zb of n)Da[zb]=z.payload[zb];
break;default:this.Xxd(z.payload,Object(m.a)(this,this.kMn,"updateFlyoutAnchorMenuState"),O),Da.launcherId=z.payload.launcherId}break;case "InkFlyoutAnchorModel":this.Xxd(z.payload,Object(m.a)(this,this.YMn,"updateInkFlyoutAnchorMenuState"),O);Da.launcherId=z.payload.launcherId;break;case "ColorPickerModel":switch(z.payload.type){case "ColorPickerPayload":Da[Gm.Color]=z.payload.selectedColorId;break;case "ColorPickerPreviewPayload":ca=d.commandPreviewId;Da[Gm.Color]=z.payload.selectedColorId;break;
case "ColorPickerRevertPreviewPayload":ca=d.commandRevertId;break;default:return}break;case "SpinButtonModel":Da[Tg.a.Number]=z.payload.value;Da[Tg.a.UnitType]=Wf.a.mDb(z.payload.unitType.toLowerCase());Da[Tg.a.Text]=z.payload.reservedValue;break;case "SliderModel":Da[ek.Value]=z.payload.value;break;case "InsertTableModel":Da[yj.a.Rows]=z.payload.rows;Da[yj.a.Columns]=z.payload.columns;break;case "CheckboxModel":Da[Yf.a.On]=z.payload.checked;Da.MenuItemId=d.menuItemId;break;case "PreviewGalleryModel":if(this.Xxd(z.payload,
Object(m.a)(this,this.sOn,"updatePreviewGalleryMenuState"),O)){Da.launcherId=z.payload.launcherId;break}this.Uli(z,a);return;case "DocumentTitleModel":switch(z.payload.type){case "DocumentTitleRenamePayload":Da.getNewDocumentTitle=z.payload.getNewDocumentTitle;break;case "MenuOpenPayload":ca={};ca[z.payload.launcherId]=n;this.tAb.xMd(ca,xh.g(z.payload));this.CWb[a]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":Da.MenuItemId=z.payload.url;this.inm(z.payload.pageId);
break;case "NewBlankDocumentModel":case "CustomTemplateModel":Da.MenuItemId=z.payload.assetId;Da.SourceControlId=a;this.jnm(z.payload.pageId);break;case "CoauthorGallery":Da.RenderTime=z.triggerTime;break;case "PeopleWell":Da.RenderTime=z.triggerTime;break;case "SyncStatus":Da.SourceControlId=a;break;case "InputBoxModel":Da.Text=z.payload.newValue;break;case "PersonaButtonModel":Da.CommandValueId=z.payload.commandValueId;this.OWl(z.payload);break;default:return}ca&&!this.isShadowMenuOpen(z.payload)&&
(Da.CommandValueId||(Da.CommandValueId=Da.MenuItemId),d.legacyControlId&&(Da.LegacyId=d.legacyControlId),Da.SourceControlId||(Da.SqmControlId=a),z.payload&&!ze.c(z.payload.shouldTakeFocus)&&(Da[iz.a.c9a]=z.payload.shouldTakeFocus),d=this.xUh(z,Da),ze.c(z.triggerTime)||(Xa.TriggerTime=z.triggerTime),this.kMh.executeCommand(ca,Da,this.getSelectedTabId(),d,!0,()=>{this.l5i(Da,a)},Xa,xh.g(z.payload)))}hxg(){this.ty&&this.ty.execute(a=>{a.Iwg("ModernFontPickerExperience")})}xUh(a,d){let n=2;a.payload&&
"inputMethod"in a.payload&&a.payload.inputMethod&&(n=a.payload.inputMethod,d[iz.a.UF]=n);return n}l5i(a,d){const n=Object(qa.a)(Ec.AFrame,l.AFrameworkApplication.la);if(this.ib&&this.iBj(a)){if(!this.ib.Zd&&n){let z="null";if(a){const O=a.Value;delete a.Value;z=ta.a.toJSON(a);ze.c(O)||(a.Value=O)}k.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",d,z,n.AKa)}this.ib.K2f()}(this.ib&&
this.ib.Zd&&this.ib.Zd.name!==Ec.AFrame.y8&&n&&this.ib.Zd.name!==n.AKa||this.iBj(a))&&this.kUk(a)}iBj(a){return!!a&&!ze.c(a[iz.a.c9a])&&a[iz.a.c9a]}kUk(a){iz.a.UF in a&&1===a[iz.a.UF]&&UD.ShyRibbon.K2a(1,0)}zXl(a,d){this.Opa.Km();if(this.Olk&&this.ga){const n={};n[BJ.a.jnc]=d.payload.tabId;this.ga.ob(Sa.a.NQc,2,n,this.fma(d));ze.c(d.payload.inputMethod)||(this.ga.processAction(Sa.a.mWg,2),this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.CoachMarkEnabled",!1)&&!this.Ofe&&this.hwn(d.payload.tabId))}d=
d.payload.tabId;a.NewContextId=d;a.NewContextCommand=this.Ho.vcg(d);k.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+d);if(this.ty&&d){const n=d+"TabSwitchActivity";this.ty.execute(z=>{z.Iwg(n)})}}Xxd(a,d,n){const z=a.type;return"MenuClosePayload"===z?!0:"MenuOpenPayload"===z?(d(a,n),!0):!1}OWl(a){a=a.type;"MenuOpenPayload"===a?l.AFrameworkApplication.dnc=!0:"MenuClosePayload"===a&&(l.AFrameworkApplication.dnc=!1)}rRm(a,d){if(!a.payload||!a.payload.launcherId||"MenuOpenPayload"!==a.payload.type&&
"MenuPopulatePayload"!==a.payload.type)return!1;const n=a.payload.launcherId,z=this.Ho.getCommandByExternalUxId(n);return z&&z.populationProps?((a=this.tAb.cNg(z,d,a.payload))&&n in this.CWb&&delete this.CWb[n],a):!1}kMn(a,d){const n=a.launcherId;this.USc(n,d)&&(d=appChrome.selectors.getFlyoutAnchorMenuItems(n),this.xVc(d,n,xh.g(a)))}YMn(a,d){const n=a.launcherId;this.USc(n,d)&&(d=xh.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(n):appChrome.selectors.getFlyoutAnchorMenuItems(n),
this.xVc(d,n,xh.g(a)))}sOn(a,d){const n=a.launcherId;this.USc(n,d)&&(d=appChrome.selectors.getPreviewGalleryMenuItems(n),this.xVc(d,n,xh.g(a)))}fPn(a,d){const n=a.launcherId;this.USc(n,d)&&(d=appChrome.selectors.getSplitButtonMenuItems(n),this.xVc(d,n,xh.g(a)))}oPn(a,d){const n=a.launcherId;this.USc(n,d)&&(d=appChrome.selectors.getStatefulSplitButtonMenuItems(n),this.xVc(d,n,xh.g(a)))}getSelectedTabId(){return this.Uuj?appChrome.selectors.getSelectedTabId():null}xVc(a,d,n){this.tAb.xMd(a,n);this.CWb[d]=
new Date}USc(a,d){let n=!0;a in this.CWb&&(n=this.CWb[a].getTime()<this.Opa.oBa.getTime());return n&&!d&&this.Uuj}Uli(a,d){const n={};var z=a.payload.selectedGalleryId;const O=this.Ho.getCommandByExternalUxId(z);O&&(n.SourceControlId=z,n.MenuItemId=O.menuItemId,n.SqmControlId=d,O.legacyControlId&&(n.LegacyId=O.legacyControlId),a.payload&&!ze.c(a.payload.shouldTakeFocus)&&(n[iz.a.c9a]=a.payload.shouldTakeFocus),this.CJl(a.payload,n),z=this.xUh(a,n),this.kMh.executeCommand(O.commandId,n,this.getSelectedTabId(),
z,!0,()=>{this.l5i(n,d)},this.fma(a),xh.g(a.payload)))}CJl(a,d){"CharacterGalleryPayload"===a.type&&(d.MenuItemId=a.character)}t2g(a,d){a.payload&&"toggled"in a.payload&&(d[Yf.a.On]=a.payload.toggled)}qtm(a,d){if("MenuOpen"===a){if(this.m6&&!("isShadowRendering"in d.payload&&d.payload.isShadowRendering))this.m6.onMenuOpen()}else if("MenuClose"===a&&this.m6)this.m6.onMenuClose()}Gqa(){this.m6&&this.m6.uGg()}fma(a){let d=null;ze.c(a.triggerTime)||(d={},d.TriggerTime=a.triggerTime);return d}UVl(a,d,
n){if(this.$8j&&this.ga){const z={};z[zJ.a.pageId]=n;this.ga.ob(Sa.a.MQc,2,z)}this.xVc(d.pageControlIdMap,a,xh.g(d))}jnm(a){if(this.ga)switch(a){case "FileHomePage":this.ga.processAction(Sa.a.pWg,2);break;case "FileNewPage":this.ga.processAction(Sa.a.qWg,2)}}inm(a){if(this.ga)switch(a){case "FileHomePage":this.ga.processAction(Sa.a.dWg,2);break;case "FileOpenPage":this.ga.processAction(Sa.a.eWg,2)}}isShadowMenuOpen(a){return!!a&&"MenuOpenPayload"===a.type&&a.isShadowRendering}hwn(a){if(l.AFrameworkApplication.K.ea("TellMeHelpCoachMarkActivityEnabled")&&
"Help"===a)this.ty.execute(d=>{d.logActivity("TellMeHelpCoachMarkActivity",null)}),this.Ofe=!0;else{if(l.AFrameworkApplication.K.ea("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.ty.execute(d=>{d.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.jpk)){this.Ofe=!0;return}l.AFrameworkApplication.K.ea("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.processAction(Sa.a.XNb,2)&&(this.Ofe=!0)}}}Object(t.a)(WJ,"ReactExecuteCommandHandler",null,[]);class XJ{constructor(){this.fileMenu=
null}get IZa(){return 0}get zJa(){return 0}get kWa(){return!1}PCa(){}qJj(){}f7(){return!1}Zwj(){}BZg(){return!1}N3(){return!1}vua(a){return this.fileMenu&&this.fileMenu.m8a(a)?!0:!1}get gua(){return!1}get Kuj(){return null}QMb(){}fFe(){return!1}get Foe(){return null}set Foe(a){}o3(){}z_(){}zdg(){return null}R3a(){}refresh(){}get controls(){return null}iQc(){return!1}eDb(){}Km(){}get XI(){return null}set XI(a){}u_d(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}Object(t.a)(XJ,
"ReactRibbonExternal",null,[641,585,642]);class YJ{constructor(a,d,n,z){this.ib=a;this.ga=d;this.YRh=n;this.dwc=z}initialize(){this.ga.ma(Sa.a.aSd,Cd.a.frame,Object(m.a)(this,this.Urj,"ribbonMoveForwardAction"));this.ga.ma(Sa.a.$Rd,Cd.a.frame,Object(m.a)(this,this.Trj,"ribbonMoveBackwardAction"));this.ga.ma(Sa.a.XRd,Cd.a.frame,Object(m.a)(this,this.Qrj,"ribbonEscAction"));var a=to.a.Gjg(this.dwc,null,this.YRh,!1);a.uK=!0;this.fQc(a,Sa.a.aSd,Sa.a.$Rd);a.bindAction(gb.KeyInputManager.$a(xb.a.Cua,0),
Sa.a.XRd);a=this.ib.Kc(Ec.AFrame.y8);a.uK=!0;this.fQc(a,Sa.a.yla,Sa.a.yla);Eg.a.instance.Ea(vb.a.Mq,this.YRh,Object(m.a)(this,this.mJm,"onRibbonMouseDown"));a=lk.a.instance;xh.a("enterKeytipMode")&&a.dyj(this.dwc,()=>{appChrome.api.enterKeytipMode(!1)});xh.a("exitKeytipMode")&&a.byj(this.dwc,()=>{appChrome.api.exitKeytipMode();UD.ShyRibbon.K2a(1,0)});l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.Qma&&(a=Object(qa.a)(ic.FocusManager,this.ib))&&a.pWh(Object(m.a)(this,this.qFm,"onFocusScopeChanged"))}qFm(a,
d){if((a=Object(qa.a)(Ec.AFrame,l.AFrameworkApplication.la))&&d.pEg&&l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.Qma){const n=appChrome.selectors.getShyState();n.isActive&&d.pEg.name===a.AKa&&UD.ShyRibbon.K2a(n.state,1)}}Urj(){return 4}Trj(){return 4}Qrj(){xh.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.Qma&&appChrome.selectors.getShyState().isActive&&UD.ShyRibbon.K2a(1,0),this.ib.wf(Ec.AFrame.ao));return 4}fQc(a,d,n){const z=
gb.KeyInputManager.$a(xb.a.Nw,0),O=gb.KeyInputManager.$a(xb.a.Nw,4);a.zq(z);a.zq(O);a.bindAction(z,d);a.bindAction(O,n)}mJm(a){a.Ua&&a.Ua.target&&"input"!==a.Ua.target.tagName.toLowerCase()&&a.Ua.preventDefault();return!1}dispose(){this.ga.iB(Sa.a.aSd,Cd.a.frame,Object(m.a)(this,this.Urj,"ribbonMoveForwardAction"));this.ga.iB(Sa.a.$Rd,Cd.a.frame,Object(m.a)(this,this.Trj,"ribbonMoveBackwardAction"));this.ga.iB(Sa.a.XRd,Cd.a.frame,Object(m.a)(this,this.Qrj,"ribbonEscAction"))}}Object(t.a)(YJ,"ReactRibbonFocusManager",
null,[12]);class NB{constructor(a,d,n,z,O,ca,Da,Xa=null,zb=!0,Vb=null,Fc=null){this.Ayb=this.Gge=this.nrh=this.Opa=null;this.mNh=[];this.vde=null;this.Pwa=a;this.Hnf=d;this.dwc=n;this.ib=z;this.ga=O;this.Ho=ca;this.Opa=Vb?Vb:new JE(Xu.instance,this.Ho);this.H5c=Da;this.eMh=new XJ;this.u1a=Xa;this.Guf=zb;new UJ;this.gwh=Fc;Bi.a.get_instance().Ik(7,Object(m.a)(this,this.Rnn,"setRibbonPostInteractiveReady"));Bi.a.get_instance().Ik(7,Object(m.a)(this,this.Fqm,"logRibbonLoadedActivity"));l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",
!1)&&Bi.a.get_instance().Ik(7,Object(m.a)(this,this.C4m,"registerSubComponentReporting"))}initialize(a,d,n=null){this.Guf||this.dG(5);n?n.then(()=>{this.npj()}).catch(()=>k.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):TJ.a.ZYa(TJ.a.ZYa(Jh.Task.WAA(this.zYi(a),this.yYi(NB.J5j)),()=>this.yYi(NB.u2j)),()=>this.zYi(d)).continueWith(()=>{this.npj()},11)}dispose(){this.TIn();this.Ayb&&this.Ayb.rhi();this.vde&&this.vde.dispose();for(const a of this.mNh)Bi.a.get_instance().Z6h(a);
l.AFrameworkApplication.pa.iB(Sa.a.Tpj,Cd.a.frame,Bc.ActionManager.Ke)}yYi(a){return la.a.instance.resolve("Common.ISharedDependencyLoader").YLc(l.AFrameworkApplication.Yx(a,2))}zYi(a){return""===a?Jh.Task.KL(!0):la.a.instance.resolve("Common.ISharedDependencyLoader").YLc(l.AFrameworkApplication.Yx(a,3))}b4l(){(this.u1a||this.H5c)&&appChrome.api.dispatch(this.fGi());this.mpn();xh.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(l.AFrameworkApplication.BQ);this.Opa.Km()}npj(){this.b4l();
this.Guf&&(appChrome.renderAppChrome(this.Pwa,xh.e()),this.dG(10));this.HTh();this.NIf();this.Guf&&this.dG(5);this.XMi()}XMi(){this.ib&&this.ga&&this.dwc&&(this.vde=new YJ(this.ib,this.ga,this.Pwa,this.dwc),this.vde.initialize())}get YRd(){return this.eMh}setCommandDefinitionMapping(){if(xh.a("setCommandDefinitionMapping")){const a=yP(this.Ho);appChrome.api.setCommandDefinitionMapping(a)}}registerOnShyRibbonStateChange(){l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.Qma&&xh.a("registerOnShyRibbonStateChange")&&
appChrome.api.registerOnShyRibbonStateChange((a,d)=>{0===d&&this.aPc()})}HTh(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const a=Object(qa.a)(JE,this.Opa);this.nrh=new WJ(this.Opa,a.eQc,this.Ho,this.ib,this.Hnf,la.a.instance.sa("Common.IRibbonSQMInformation"),la.a.instance.sa("Common.IFileMenuSQMInformation"),l.AFrameworkApplication.pa,l.AFrameworkApplication.K,la.a.instance.Ca("Common.ISystemInitiatedFeedback"),null);this.bHk()}bHk(){this.Gge=appChrome.api.bindCommandHandler((a,
d)=>{this.nrh.executeCommand(a,d)})}TIn(){this.Gge&&(this.Gge(),this.Gge=null)}mpn(){appChrome.api.initializeLogger(new No.a)}QTa(){return this.Opa?this.Opa.QTa():[]}aPc(){Ln.a.instance.Fd(()=>{let a=null;Ln.a.instance.Fd(()=>{a=this.QTa()},"RB:GA");a&&0<a.length&&(this.Opa.oBa=new Date,Ln.a.instance.Fd(()=>{appChrome.api.dispatch(a)},"RB:DA"));this.Ayb&&Ln.a.instance.Fd(()=>{this.Ayb.Zej()},"RB:J")},"RB:PFSU")}P_d(){this.Opa.P_d()}ogc(){}dtk(a){a=[appChrome.actions.activateDeactivateContextualTab(a,
!0),appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}setCurrentTab(a){a=[appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}fGi(){var a=l.AFrameworkApplication.K;const d=[];a.ea("EnableTellMeForOneLineRibbonIsEnabled")?a.ea("OcpsIsEnabled")&&la.a.instance.Ca("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(n=>{n.isFeatureEnabled("ConnectedServices",!0).then(z=>{z&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));
return null})}):d.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));d.push.apply(d,this.fxi());a=new zP.a(this.Ho);this.u1a.dL&&(AP.a.MGn(this.u1a.dL),d.push.apply(d,a.Kve(this.u1a.dL)));if(this.u1a.gLj)for(const n of this.u1a.gLj)d.push(appChrome.actions.updateGallerySectionHiddenState(n.Jri,n.q8n,n.A$n));d.push.apply(d,a.Asi(this.u1a.iLj));return d}fxi(){const a=[];if(this.H5c&&this.H5c.dL){const n=this.H5c.dL;for(let z in n){var d=n[z];const O=this.Ho.i8f(z);if(O)for(let ca of O)a.push(appChrome.actions.updateControlHiddenState(ca,
d))}}return a}Evb(a){a&&this.Opa.eQc.xMd(a,0)}cNg(a){this.Opa.eQc.cNg(this.Ho.getCommandByExternalUxId(a),appChrome.selectors.getModelType(a),{inputMethod:0})}yOl(a){return appChrome.actions.updateControlHiddenState(a,!1)}zOl(){return appChrome.actions.updateControlHiddenState("CopyLink",!1)}dG(a){Bi.a.get_instance().dG(a);this.mNh.push(a)}Rnn(){xh.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new SJ,{postRibbonInteractiveReady:!0})))}NIf(){this.H5c&&
this.gwh&&(this.Ayb=this.gwh.gRf(),this.eMh.fileMenu=this.Ayb)}Pjm(a,d){this.Ayb&&this.Ayb.aXi(a,d)}MVe(a,d,n){if(1===n)return 32;this.yyj(!0);this.aPc();l.AFrameworkApplication.la.updateCommandUI();return 32}NVe(a,d,n){if(1===n)return 32;this.yyj(!1);this.bon();this.aPc();l.AFrameworkApplication.la.updateCommandUI();return 32}bon(){Fa.a.UKa(l.AFrameworkApplication.K.Ga("IsSimplifiedRibbonOnCookieName"),"true",Fa.a.FBa)}yyj(a){Fa.a.UKa(l.AFrameworkApplication.K.Ga("ReactRibbonMLRPreferenceCookieName"),
a.toString(),Fa.a.FBa)}Fqm(){if(l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.lo){const a=la.a.instance.Ca("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(a.execute(d=>{d.logActivity("SingleRibbonModeActivity",null)}),l.AFrameworkApplication.b8("d79fg304;61jba833")):"Multiline"===appChrome.selectors.getRibbonMode()&&(a.execute(d=>{d.logActivity("MultiRibbonModeActivity",null)}),l.AFrameworkApplication.b8("69a7h198;dfd7j584"))}}C4m(){const a=appChrome.api.getRibbonSubComponentMappings();
for(let d of a){const n=a[d];n||appChrome.api.reportRibbonSubComponentBehaviorMapped(d);for(const z of n)l.AFrameworkApplication.pa.OX(z)?appChrome.api.reportRibbonSubComponentBehaviorMapped(d):l.AFrameworkApplication.pa.$xj(z,()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(d)})}}}NB.J5j="common";NB.u2j="appChrome";Object(t.a)(NB,"ReactRibbonUser",null,[197,195,12]);class zG extends NB{constructor(a,d,n,z,O,ca,Da,Xa,zb=null,Vb=!0,Fc=null,Yc=null){super(a,d,z,O,ca,Da,Xa,zb,Vb,Fc,Yc);this.g7d=
null;this.VTb=n;this.VTb.execute(yd=>{this.g7d=yd});this.VTb.execute(yd=>{this.Opa.XI=yd})}QTa(){return this.g7d?(this.g7d.clearCache(),super.QTa()):[]}ogc(a){if(!a)throw Error.argumentNull();this.VTb.execute(d=>{a.XI=d})}}Object(t.a)(zG,"ReactRibbonUser",NB,[]);var BP=b(879);class VD extends zG{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb=!0,Fc=null,Yc=null){super(d,a.Oaa,z,og.AppFrame.Uca,O.Wg,O.Tb,Da,Xa,zb,Vb,Fc,Yc);if(void 0===a||null===a)throw Error.argumentNull("hostingAppFrame");this.mhf=a;this.fka=
ca;O.qia(()=>{this.POn();l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?Bi.a.get_instance().Ik(7,()=>{this.NMi()}):this.NMi()},null)}get wng(){return!!l.AFrameworkApplication.K.appSettings.BootActivityNavigationId}NMi(){this.n1k();this.gRf();this.f2m()}POn(){this.Pwa.classList.add("FlexBoxLayout");this.mhf.Q_().classList.add("cui-exth");this.mhf.Q_().classList.add("FlexBoxLayout");this.mhf.Q_().classList.add("ScrollableRibbon")}n1k(){l.AFrameworkApplication.nH||
this.D4k()}D4k(){if(!l.AFrameworkApplication.nH){var a=(new JJ(VD.Mlk,this.fka)).vgl(),d=to.a.Gjg(og.AppFrame.Yra,null,a,!0);d.uK=!0;this.fQc(d,Sa.a.aSd,Sa.a.$Rd);d.bindAction(gb.KeyInputManager.$a(xb.a.Cua,0),Sa.a.XRd);yE(1,()=>{this.p9m(a)})}}p9m(a){const d=new QJ;appChrome.renderSharedHeader(a,d.STa()).then(Object(m.a)(this,this.dXf,"dismissFastViewHeader"))}gnj(){l.AFrameworkApplication.la.eb.eHe?appChrome.getHeaderApi().then(a=>{document.getElementById(l.AFrameworkApplication.qra).classList.remove("Placeholder");
return a.dismissPlaceholder()}):(new BP.a).dXf()}dXf(){this.wng&&l.AFrameworkApplication.b8("Microsoft.Office.Web.SessionSettings.IWacWordImprovedDeepLinkLoadSettings");this.wng&&l.AFrameworkApplication.K.ea("ImprovedDeepLinkLoadIsEnabled")?(Bi.a.get_instance().Ik(12,Object(m.a)(this,this.gnj,"removeHeaderPlaceholder"),11),k.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):this.gnj()}fQc(a,d,n){const z=gb.KeyInputManager.$a(xb.a.Nw,
0),O=gb.KeyInputManager.$a(xb.a.Nw,4);a.zq(z);a.zq(O);a.bindAction(z,d);a.bindAction(O,n)}gRf(){const a=!!this.u1a&&"FileMenu"in this.u1a.iLj;l.AFrameworkApplication.la.eb.xVa&&!a&&yE(1,Object(m.a)(this,this.O8m,"renderFileMenu"))}O8m(){const a=[];if(l.AFrameworkApplication.K.ea("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var d=[Object.assign(new xG,{label:CommonUIStrings.L_DiagnosticsSessionId,value:l.AFrameworkApplication.userSessionId}),Object.assign(new xG,{label:CommonUIStrings.L_DiagnosticsBuild,
value:l.AFrameworkApplication.buildVersion})];a.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",d))}a.push.apply(a,this.fxi());d=document.createElement("div");document.body.appendChild(d);appChrome.renderFileMenu(d,a)}f2m(){this.ga.ma(Sa.a.E9a,Kb.a.view,Object(m.a)(this,this.E9a,"tabSwitch"));this.ga.ma(Sa.a.MVe,Kb.a.view,Object(m.a)(this,this.MVe,"ribbonModeToggledToMLR"));this.ga.ma(Sa.a.NVe,Kb.a.view,Object(m.a)(this,this.NVe,"ribbonModeToggledToSLR"))}activateRibbonTab(a){this.dtk(a)}aPc(){Bi.a.get_instance().isCompleted(7)&&
this.g7d&&(Mh.a.mark(4893),It.a.NPj(),super.aPc(),Mh.a.mark(4894))}E9a(a,d,n,z,O){if(2===O[iz.a.UF]){if(n=Object(qa.a)(Jv.a,d))d=Object(qa.a)(Zz.a,n.view);else return k.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(d),a,ta.a.join(O," ",":")),8;if(d&&""!==d.qE)this.ib.wf(d.qE),appChrome.selectors.getShyState().isActive&&UD.ShyRibbon.K2a(0,1);else return k.ULS.sendTraceTag(38549529,338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",
Object.getTypeName(n.view),a,ta.a.join(O," ",":"),this.wDl(n.view)),8}return 32}wDl(a){return a?"is ContentEditableView: "+a.uk+" is Editing View: "+a.lsa+" is FishbowlView: "+a.psa+" is HtmlView: "+a.QAa+" is InteractiveView: "+a.Yd+" is NavigationPaneView: "+a.bqg+" is PageView: "+a.gj+" is WordNavigationPaneHeadingsView "+a.UHe:"null view"}}VD.Mlk="WACRibbon";Object(t.a)(VD,"ReactRibbonUser",zG,[196,197,195,12]);class ZJ{constructor(a){this.Tp=a}wOl(){return[r(gk.a.DNi,this.Tp.phg,"Insert Footnote"),
r(gk.a.yNi,this.Tp.nhg,"Insert Endnote"),r(gk.a.j6g,this.Tp.vhg,"Show/Hide \u00b6"),r(gk.a.vch,this.Tp.FCe,"Undo"),r(gk.a.DSg,this.Tp.uhg,"Redo"),r(gk.a.xHf,this.Tp.khg,"Bold"),r(gk.a.Dtg,this.Tp.shg,"Italic"),r(gk.a.uch,this.Tp.Ahg,"Underline"),r(gk.a.$In,this.Tp.FCe,"Undo"),r(gk.a.cfg,this.Tp.rhg,"Grow Font Size"),r(gk.a.k6g,this.Tp.whg,"Shrink Font Size"),r(gk.a.jll,this.Tp.ohg,"Find"),r(gk.a.K2h,this.Tp.lhg,"Bullets"),r(gk.a.L2h,this.Tp.lhg,"Bullets"),r(gk.a.t7i,this.Tp.thg,"Numbering"),r(gk.a.u7i,
this.Tp.thg,"Numbering"),r(gk.a.Egi,this.Tp.mhg,"Dictate")]}uOl(){return[r(gk.a.DNi,this.Tp.phg),r(gk.a.yNi,this.Tp.nhg),r(gk.a.CFn,this.Tp.DKi),r(gk.a.cfg,this.Tp.rhg),r(gk.a.k6g,this.Tp.whg),r(gk.a.xHf,this.Tp.khg),r(gk.a.Dtg,this.Tp.shg),r(gk.a.uch,this.Tp.Ahg),r(gk.a.Bgi,this.Tp.mhg),r(gk.a.j6g,this.Tp.vhg),r(gk.a.Ckg,this.Tp.zKi),r(gk.a.Xym,this.Tp.AKi),r(gk.a.vch,this.Tp.FCe),r(gk.a.DSg,this.Tp.uhg),r(gk.a.pkl,this.Tp.ohg)]}vOl(){return[r(gk.a.n8g,this.Tp.xhg),r(gk.a.K8g,this.Tp.yhg),r(gk.a.R8g,
this.Tp.zhg),r(gk.a.B3f,this.Tp.qhg)]}xOl(){return[r(gk.a.n8g,this.Tp.xhg,"Strikethrough"),r(gk.a.K8g,this.Tp.yhg,"Subscript"),r(gk.a.R8g,this.Tp.zhg,"Superscript"),r(gk.a.B3f,this.Tp.qhg,"Format Painter")]}}Object(t.a)(ZJ,"ShortcutDiscoverySettings",null,[]);class $J{constructor(){this.Tp=new iG.a(I.a.Pi||I.a.tg);this.ree=new ZJ(this.Tp)}wNl(){return this.BDi(this.ree.uOl())}xNl(){return this.BDi(this.ree.vOl())}kxl(){return this.Yvi(this.ree.wOl())}lxl(){return this.Yvi(this.ree.xOl())}BDi(a){const d=
[];a.forEach(n=>{d.push(appChrome.actions.setButtonSecondaryText(n.actionId,n.vAj))});return d}Yvi(a){const d=[];a.forEach(n=>{d.push(appChrome.actions.setControlCustomTooltip(n.actionId,this.xwd(n.label,n.vAj)))});return d}xwd(a,d){return a+" ("+d+")"}}Object(t.a)($J,"ShortcutActionHelper",null,[]);class aK extends VD{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le=null){super(a,d,n,z,O,ca,Da,Xa,zb,!1,Fc,Le);this.Vok=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfRibbonSuperGraphTransaction",
!1);this.Juf=Vb.J4g();this.Fnk=Vb.BBj();this.Tp=Yc;this.UNh=yd;this.VNh=je;this.ty=la.a.instance.Ca("Common.ISystemInitiatedFeedback");this.EAn()}w4l(){k.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");Bi.a.get_instance().dG(5);const a=this.wng&&l.AFrameworkApplication.K.ea("ImprovedDeepLinkLoadIsEnabled")?12:10;Bi.a.get_instance().Ik(a,Object(m.a)(this,this.y3l,"initializeFullRibbon"),11)}tOl(){const a=[],d=new $J;a.push(...d.wNl(),...d.kxl());null!=l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableShortcutControl",!1)&&a.push(...d.xNl(),...d.lxl());return a}$tl(){const a=[];this.UNh&&(a.push(appChrome.actions.setButtonSecondaryText(gk.a.hqe,this.Tp.yKi)),a.push(appChrome.actions.setButtonSecondaryText(gk.a.Poe,this.Tp.xKi)),a.push(appChrome.actions.setButtonSecondaryText(gk.a.DQe,this.Tp.BKi)));this.VNh&&a.push(appChrome.actions.setButtonSecondaryText(gk.a.BQe,this.Tp.CKi));return a}GBk(){this.ty&&this.ty.execute(a=>
{a.logActivity("WordShyRibbon",null)});return 32}lqn(){this.ty&&appChrome.api.isSmallDevice()?this.ty.execute(a=>{a.logActivity("ShyRibbonSmallScreenActivity",null)}):this.ty.execute(a=>{a.logActivity("ShyRibbonNormalScreenActivity",null)});l.AFrameworkApplication.pa.Aa(Sa.a.aEf,Cd.a.frame,Object(m.a)(this,this.GBk,"alwaysShowRibbonSurvey"),96)}y3l(){pk.a.instance.Hd(ai.a.gNi,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(a=>{var d=l.AFrameworkApplication.K.ea("ShareMenuIsEnabled"),
n=d?"ShareTopBar":"Share";this.Juf?a.push(this.yOl(n)):a.push(appChrome.actions.removePeripheralControl(n));this.Fnk?a.push(this.zOl()):a.push(appChrome.actions.removePeripheralControl("CopyLink"));d&&!this.Juf&&a.push(appChrome.actions.updateControlHiddenState("ShareMenu",!this.Juf));this.u1a&&a.push.apply(a,this.fGi());(this.UNh||this.VNh)&&this.Tp&&a.push.apply(a,this.$tl());l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableShortcutDiscovery",!1)&&a.push.apply(a,
this.tOl());l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.Qma&&this.lqn();appChrome.api.isSmallDevice()&&l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.eM&&!I.a.Fy&&!l.AFrameworkApplication.nH&&l.AFrameworkApplication.b8("Microsoft.Office.Web.SessionSettings.IWacWordShyRibbonSettings");a.push.apply(a,this.QTa());a.push(appChrome.actions.setControlBehaviorAttached(!0));const z=la.a.instance.resolve("WordEditor.IModeSwitcherControl");d=z.iDl();l.AFrameworkApplication.Yi("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&(n=appChrome.selectors.getModeSwitcherMode())&&n!==d.activeMode&&k.ULS.sendTraceTag(527778651,306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${d.activeMode}, Actual: ${n}`);l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===d.activeMode?appChrome.getUpdateAppModeAndTabsActions(d).then(O=>
{appChrome.api.dispatch(a.concat(O));z.L3i();this.$Mi()}):(a.push(appChrome.actions.updateModeSwitcher(d)),appChrome.api.dispatch(a),z.L3i(),this.$Mi())})}$Mi(){l.AFrameworkApplication.bMd.AMj();this.HTh();this.NIf();this.XMi();Bi.a.get_instance().dG(7);pk.a.instance.BR(ai.a.p2a,ai.a.Srj,(new Date).getTime())}EAn(){null!=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("CollabCornerFloodgateSurveyFileSharedStatusIsEnabled")&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FileSharedStatusInSharePeripheralControl",
!1)&&2===l.AFrameworkApplication.Bs.WUd&&(this.fea=la.a.instance.Ca("Common.App.HostNotification.EditNotificationEventSource"))&&this.fea.execute(a=>{a.Byc(Object(m.a)(this,this.JKj,"triggerCollabCornerFileSharedStatusSurvey"))})}JKj(){const a=la.a.instance.Ca("Common.ISystemInitiatedFeedback");a&&window.setTimeout(()=>a.execute(d=>{d.logActivity("ToggleCollabCornerFileSharedStatusSurvey","CollabCornerFloodgateSurveyFileSharedStatusIsEnabled");this.fea&&this.fea.execute(n=>{n.KQd(Object(m.a)(this,
this.JKj,"triggerCollabCornerFileSharedStatusSurvey"))})}),12E4)}Evb(a){if(a){const d=this.Wxi();try{super.Evb(a)}finally{null===d||void 0===d?void 0:d.dispose()}}}QTa(){const a=this.Wxi();try{return super.QTa()}finally{null===a||void 0===a?void 0:a.dispose()}}Wxi(){var a;if(this.Vok){var d=void 0,n=null===(a=Lb.App.jj)||void 0===a?void 0:a.Cm;n&&(d=new Ff.GraphTransaction(Lb.App.pFe()&&Lb.App.OCd?0:2),d.set(n));return d}}}Object(t.a)(aK,"ReactRibbonUser",VD,[]);var bK=b(901);class CP{constructor(){this.keytip=
this.id=this.image=this.label=this.command=null}}Object(t.a)(CP,"HeaderToggleButtonInfo",null,[]);class AG{constructor(a){this.$y=a}nAe(){return null}Aql(){return this.nAe()}J4g(){return!1}BBj(){return!1}}Object(t.a)(AG,"TopRowPeripheralControlCreator",null,[1006]);class BG extends AG{constructor(a,d=null,n=null){super(a,d,n)}nAe(){let a=null;l.AFrameworkApplication.qEc&&(a=Object.assign(new bK.a,{label:WoncaIntl.WoncaStrings.L_Share,command:Sa.a.wkb.toString(),image:qj.CuiHelper.vqn,id:qj.CuiHelper.n3g}));
return a}}Object(t.a)(BG,"TopRowPeripheralControlCreator",AG,[]);class cK extends BG{constructor(a){super(a,"SharingSet_Start_Glyph_Word_16x16x32");this.isTeamsSession="teams"===(l.AFrameworkApplication.K.Ga(l.AFrameworkApplication.vda)||"").toLowerCase()}nAe(){return l.AFrameworkApplication.mEd&&l.AFrameworkApplication.v8a||l.AFrameworkApplication.Voc?Object.assign(new bK.a,{command:Sa.a.ssb.toString(),label:WordEditorIntl.WordEditorStrings.L_ReplyWithChanges,id:qj.CuiHelper.YUe}):super.nAe()}J4g(){if(this.isTeamsSession)return!1;
const a=this.Aql();return a&&a.command===Sa.a.wkb.toString()?!0:!1}BBj(){"teams"===(l.AFrameworkApplication.K.Ga(l.AFrameworkApplication.vda)||"").toLowerCase()&&l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordCopyLinkButtonForTeamsSettings");const a=l.AFrameworkApplication.K.ea("CopyLinkButtonIsEnabled")&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopyLinkButtonEnabled",!1),d=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShareMenuEnabled",
!1);return!this.isTeamsSession&&(a||d)&&this.J4g()||l.AFrameworkApplication.qEc&&l.AFrameworkApplication.Qoe&&l.AFrameworkApplication.K.ea("CopyLinkButtonForTeamsIsEnabled")}}Object(t.a)(cK,"TopRowPeripheralControlCreator",BG,[]);class dK extends uG{constructor(a,d,n,z,O,ca){super(a,d,n);a=!1;l.AFrameworkApplication.K.ea("HidePasteTextOnlyInRibbonChrome")||(a=!z.DNb);this.Sjf=l.AFrameworkApplication.K.ea("PasteWithOptionsFromRibbon")&&(I.a.n0||I.a.el&&a);this.Ho=O;this.Yrf=ca}V3k(a,d){const n=new NC(l.AFrameworkApplication.K,
this.ga,this.ib,this.Sjf),z=new vP.a(n);return this.r4k(a,d,z,n)}r4k(a,d,n,z){var O=new HJ(new IJ(l.AFrameworkApplication.K,z),n);n=this.X3l(O);const ca={};O.vNb(ca);O=!I.a.n0;const Da=I.a.el||I.a.Og;var Xa=I.a.Pi;l.AFrameworkApplication.K.ea("CcpFixIPadShortcutStringsIsEnabled")&&(Xa=I.a.tg||Xa);Xa=new iG.a(Xa);a=new aK(a,d,WordEditorIntl.WordEditorStrings,this.VTb,z,a,this.Ho,n,new DJ(ca),new cK(null),this.Yrf,Xa,O,Da,new GJ);a.w4l();return a}X3l(a){const d={};a.bUd(d);a.a0d(d);return new EJ(null,
d,"jewelWordEditor")}}Object(t.a)(dK,"WordEditorRibbonUserFactory",uG,[]);class CG{constructor(a,d){this.KC=a;this.xae=d}V3a(a,d,n,z=null,O=null){return this.xae.XAj(a)?this.xae.V3a(a,d,n,z,O):this.KC.V3a(a,d,n,z,O)}yVa(a,d=null){return this.xae.XAj(a)?this.xae.yVa(a):this.KC.yVa(a,d)}}Object(t.a)(CG,"RootCuiUser",null,[223]);class eK extends CG{constructor(a,d){super(a,d)}clearCache(){this.KC.clearCache()}}Object(t.a)(eK,"WordGeneralCuiUser",CG,[222,223]);class Mx extends ME{constructor(a,d,n){super(a,
n);this.Uu=d}T4f(a){const d=[],n=Lg.a.instance.ya.Ba,z=!!this.Uu&&this.Uu.pEd(Mb.a.kme.toString()),O=!!this.Uu&&this.Uu.pEd(Mb.a.wLb.toString()),ca=!z&&!n.Mbc&&Mx.coa.Szg(),Da=!!this.Uu&&this.Uu.pEd(Sa.a.newComment.toString())||!!yo.a.instance&&(3===yo.a.instance.mode||2===yo.a.instance.mode),Xa=n.Xrg()&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EquationToolsIsEnabled",!1),zb=3===a||I.a.tg||l.AFrameworkApplication.nsd;a=zb&&Mx.JYf.hga(n,a);zb&&d.push(this.Ho.Flb("ClipboardGroup")[0].externalUxGroupId);
ca&&(d.push(this.Ho.Flb("TextFormattingGroup")[0].externalUxGroupId),d.push(this.Ho.Flb("StylesGroup")[0].externalUxGroupId));z&&d.push(this.Ho.Flb("PictureToolsGroup")[0].externalUxGroupId);O&&d.push(this.Ho.Flb("TableToolsGroup")[0].externalUxGroupId);Xa&&d.push(this.Ho.Flb("EquationToolsGroup")[0].externalUxGroupId);Da&&d.push(this.Ho.Flb("CommentGroup")[0].externalUxGroupId);a&&d.push(this.Ho.Flb("ContextMenuGroup")[0].externalUxGroupId);return d}static get JYf(){return Mx.G0c||(Mx.G0c=la.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu"))}static get coa(){return Mx.Vwa||
(Mx.Vwa=la.a.instance.resolve("Box4.ISelectionContextMenuProvider"))}static fAd(a,d,n,z){a.A0h(()=>Mx.fDb(d,n,z))}static fDb(a,d,n){return new Mx(a,d,n)}}Mx.G0c=null;Mx.Vwa=null;Object(t.a)(Mx,"WordReactFloatie",ME,[]);class DG{constructor(){this.sG=this.Scd=this.Z=null}get name(){return"WordEditor.UI"}init(){this.Z.resolve("WordEditor.UI.BusinessBarController").BMg();const a=Lb.App.Yq.hz,d=Lb.App.oa;Mx.fAd(d,this.Z.resolve("Common.IReactContextualUILauncher"),a,this.Z.resolve("Common.IExternalUICommandDefinitionMapping"));
this.sG=this.Z.sa("Box4.IContextMenuController");(new ZI(d,a,this.Z.Ca("Box4.IGeneralCuiUser"),this.Z.resolve("Box4.UI.PasteFloatieManager"))).fAd("PasteFloatieData",null,{});this.Z.resolve("WordEditor.UI.CuiActionBridge").initialize();(new uJ(d,a,this.Z.Ca("Box4.IGeneralCuiUser"),this.Z.resolve("Box4.UI.ExternalContentFloatieManager"))).fAd("ExternalContentFloatieData",[WordEditorIntl.WordEditorStrings],{});this.Z.resolve("Box4.IGeneralCuiUser");Bi.a.get_instance().Ik(7,()=>{this.Scd=this.Z.resolve("WordEditor.UI.StatusBarUser");
this.Scd.lb()})}dispose(){this.Scd&&(this.Scd.dispose(),this.Scd=null);this.sG&&(this.sG.dispose(),this.sG=null)}Hb(a){this.Z=a;a.ha("WordEditor.UI.BusinessBarController",()=>new cJ(a.resolve("CommonUI.IBusinessBar"),a.resolve("CommonUI.IBusinessBarEntryFactory"),l.AFrameworkApplication.pa,l.AFrameworkApplication.K)).as("WordEditor.IBusinessBarController").as("Wonca.IBusinessBarController").as("Box4.IBusinessBarController").singleInstance();let d=I.a.Pi;l.AFrameworkApplication.K.ea("CcpFixIPadShortcutStringsIsEnabled")&&
(d=I.a.tg||d);a.ha("Box4.UI.ShortcutHintMapping",()=>new iG.a(d));const n=I.a.el||I.a.Og,z=l.AFrameworkApplication.K.ea("PasteWithOptionsFromContextMenu")&&(I.a.n0||n),O=l.AFrameworkApplication.K.ea("CatchUpActivityIsEnabled");a.ha("Box4.UI.AugLoopProofingErrorDetailHelper",()=>new nq.a(la.a.instance.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),la.a.instance.resolve("Box4.Intent.IIntentRangeEditor"))).singleInstance();a.ha("WordEditor.UI.EditSurfaceContextMenu",()=>new Km(l.AFrameworkApplication.pa,
a.resolve("Box4.UI.IProofingContextMenuSectionFactory"),a.resolve("Box4.Proofing.IErrorRangeEditor"),l.AFrameworkApplication.K,a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,O?a.Ca("WordEditor.CatchUpActivity.ActivityAnnouncementManager").instance:null,a.resolve("Box4.Proofing.IProofingFeatureConfiguration"),a.resolve("Box4.ILanguageReader"),a.sa("Box4.Intent.IIntentRangeEditor"),a.resolve("Box4.DictationCorrections.IDictationCorrectionContextMenuManager"),
a.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),a.Ca("Box4.IPresenceDataManager"),a.Ca("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),a.Ca("WordEditor.ContextualSearch.ISearchSuggestionManager"),a.resolve("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader"),a.resolve("WordEditor.Designer.IDesignerControl"),a.resolve("WordEditor.Bookmark.FullBookmarkManager"),z,n?a.resolve("Box4.UI.ShortcutHintMapping"):null,la.a.instance.Ca("Common.IActionContextProvider"),la.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),
a.resolve("Box4.IParagraphReader"),a.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"))).as("Box4.UI.AEditSurfaceContextMenu").singleInstance();a.ha("Box4.ISelectionContextMenuProvider",()=>new Lx).singleInstance();a.ha("WordEditor.UI.CuiActionBridge",()=>new dl(l.AFrameworkApplication.K)).as("Box4.UI.CuiActionBridge").singleInstance();a.ha("WordEditor.UI.DialogFactory",()=>new tJ).as("WordEditor.UI.IDialogFactory").as("Box4.UI.IBox4DialogFactory").singleInstance();a.ha("Common.NonCanvasCuiUser",
()=>new AI(ic.FocusManager.instance())).as("Common.INonCanvasCuiUser").singleInstance();a.ha("WordEditor.UI.WordGeneralCuiUser",()=>new eK(a.resolve("Box4.IGeneralCuiUser"),a.resolve("Common.INonCanvasCuiUser"))).singleInstance();a.resolve("WordEditor.UI.WordGeneralCuiUser");a.ha("WordEditor.UI.StatusBarUser",()=>new yJ(Lb.App.oa.WWd,a.Ca("Box4.IGeneralCuiUser"),a.resolve("Box4.IFeatureHelper"),l.AFrameworkApplication.pa,l.AFrameworkApplication.K,Lb.App.oa)).as("WordEditor.IStatusBarUser").singleInstance();
a.ha("WordEditor.IWordEditorNavigationPaneContextMenu",()=>new QD).singleInstance();const ca=a.resolve("WordEditor.UI.WordGeneralCuiUser");a.ha("CommandUI.ReactRibbonRoot",()=>new JE(Xu.instance,a.resolve("Common.IExternalUICommandDefinitionMapping"),ca)).singleInstance();const Da=a.Ca("WordEditor.UI.WordGeneralCuiUser");a.ha("WordEditor.UI.WordEditorRibbonUserFactory",()=>new dK(Da,l.AFrameworkApplication.pa,ic.FocusManager.instance(),a.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),
a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("CommandUI.ReactRibbonRoot"))).as("Wonca.IRibbonUserFactory").singleInstance();a.ha("WordEditor.UI.ReactLanguageDialog",()=>new SD(a.resolve("Box4.UI.ILanguageEditor"),a.resolve("Box4.UI.ILanguageListHelper"))).as("Box4.UI.ILanguageDialog");a.ha("WordEditor.UI.WordEditorRibbonSQMInformation",()=>new CJ(l.AFrameworkApplication.pa)).as("Common.IRibbonSQMInformation").singleInstance();a.ha("WordEditor.UI.WordEditorFileMenuSQMInformation",
()=>new AJ(l.AFrameworkApplication.pa)).as("Common.IFileMenuSQMInformation").singleInstance();a.ha("WordEditor.UI.RulerUser",()=>new vJ).as("WordEditor.IRulerUser");a.ha("WordEditor.UI.RulerContextMenu",()=>new bA(l.AFrameworkApplication.pa,la.a.instance.Ca("Common.IZoomManager"),Qs.a.instance)).as("WordEditor.IRulerContextMenu").singleInstance();a.ha("Common.IReactContextualUILauncher",()=>new VI(a.resolve("CommandUI.ReactRibbonRoot"),a.resolve("Common.IExternalUICommandDefinitionMapping"))).singleInstance();
a.ha("Box4.IContextMenuController",()=>new $I(a.resolve("Common.IReactContextualUILauncher"))).singleInstance()}static main(){gl.instance.aki();gl.instance.rZf();M.a.instance.Sb(new DG,6)}}Object(t.a)(DG,"WordEditorUIPackage",null,[1,2]);var DP=window.ExternalContentFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",
TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},
children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",Alt:"STR@L_EmbeddedContent",LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",
Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},ZA={};ZA.wWc=function(){function a(){return Da()&&(Le()||3<=(Yc()?Ve("version/"):0))}function d(){return 0<=window.navigator.userAgent.indexOf("Windows")}function n(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function z(kf){kf=(new RegExp(kf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var nh=-1;null!=kf&&2<=kf.length&&(nh=parseFloat(kf[1]),
isNaN(nh)&&(nh=-1));return nh}function O(){fK||(fK=!0,gK=z("Windows Phone"));return 8<=gK}function ca(){return"function"==typeof navigator.msLaunchUri&&!n()&&!je()&&!Xa()}function Da(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function Xa(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function zb(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function Vb(){return zb()?8==window.document.documentMode:!1}function Fc(){return 0<=
window.navigator.userAgent.indexOf(" Firefox/")}function Yc(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function yd(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function je(){var kf=window.navigator.userAgent.toLowerCase();return 0<=kf.indexOf("android")&&0<=kf.indexOf("chrome")}function Le(){return 3<=(Fc()?Ve("firefox/"):0)}function Ve(kf){var nh=window.navigator.userAgent.toLowerCase(),Lk=nh.indexOf(kf);return 0<=Lk?parseInt(nh.substring(Lk+kf.length,
nh.length)):0}function gg(kf,nh,Lk,ok,mp){if(ok&&null!=nh)nh();else if(ca())navigator.msLaunchUri(kf,nh,Lk);else if(!(yd()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&Da())||Xa())Ki(kf,nh,Lk);else if(yd()&&mp)a:{try{window.open(kf,"_self")}catch(gs){null!=Lk&&Lk();break a}null!=nh&&nh()}else Lh(kf,nh,Lk)}function Lh(kf,nh,Lk){var ok=document.getElementById("OICLinkTag");null==ok&&(ok=document.createElement("a"),ok.id=
"OICLinkTag",ok.style.visibility="hidden",ok.href="",0==(Wp.Options&cw.SupportsTopTargetNavigation)||Wp.NoBrowserModalDialogs?ok.target="_blank":ok.target="_top",document.body.appendChild(ok),null!=ok.addEventListener&&ok.addEventListener("click",function(mp){null!=mp.stopPropagation&&mp.stopPropagation()},!1));try{ok.href=kf,ok.click()}catch(mp){null!=Lk&&Lk();return}null!=nh&&nh()}function Ki(kf,nh,Lk){var ok=document.getElementById("OICFrame");null==ok&&(ok=document.createElement("iframe"),ok.className=
"ObjectInDialog",ok.style.visibility="hidden",ok.src="about:blank",document.body.appendChild(ok),ok.id="OICFrame");try{ok.contentWindow.location.href=kf}catch(mp){null!=Lk&&Lk();return}null!=nh&&nh()}function Ak(kf){return 0!=(kf.Options&cw.SkipProtocolHandler)||Vb()}function Uk(kf){return kf===$A.ReadOnly||kf===$A.ReadWrite}function Rl(kf,nh,Lk,ok){var mp;try{var gs=new ActiveXObject("SharePoint.OpenDocuments.4");return(mp=gs.ViewDocument3(window.self,kf,nh,ok))?(QC(lz.O14ActiveX),So.None):So.Failed}catch(hs){}if(cw.O14Only===
(Lk&cw.O14Only))return Wp.DescriptiveUnattemptedEnums?So.O14AttemptFailure:So.Unattempted;try{return gs=new ActiveXObject("SharePoint.OpenDocuments.3"),(mp=gs.ViewDocument3(window.self,kf,nh,ok))?(QC(lz.O12ActiveX),So.None):So.Failed}catch(hs){}if(cw.O12UpOnly===(Lk&cw.O12UpOnly))return Wp.DescriptiveUnattemptedEnums?So.O12UpOnlyFail:So.Unattempted;try{return gs=new ActiveXObject("SharePoint.OpenDocuments.2"),(mp=Uk(nh)?gs.ViewDocument2(window.self,kf,ok):gs.EditDocument2(window.self,kf,ok))?(QC(lz.O11ActiveX),
So.None):So.Failed}catch(hs){}return Wp.DescriptiveUnattemptedEnums?So.ActiveXUnattempted:So.Unattempted}function kk(kf,nh,Lk,ok,mp){kf==dr.Visio&&Lk==$A.ReadWrite&&(Lk=$A.WriteOnly);kf=mp;ok=ok||n()&&!O();ok||(ok="",ok=Uk(Lk)?ok+"ofv|ofc|":ok+"ofe|",kf+=fs(ok+"u|"));kf+=fs(nh);Wp.NewTelemetryDataIsEnabled&&(nh=-1!==kf.indexOf("?")?"&":"?",nh+=Wp.SessionOrigin?"OR=wac-"+Wp.SessionOrigin+"&":"",nh+=Wp.ClickTime?"CT="+Wp.ClickTime+"&":"",nh+=Wp.CorrelationId?"CID="+Wp.CorrelationId:"",nh="?"!=nh?nh:
"",nh="&"!=nh.slice(-1)?nh:nh.slice(0,-1),kf+=fs(nh));nh=window.location.href;Lk=nh.toLowerCase().indexOf("&wdlor=");-1!=Lk?(Lk+=7,ok=nh.indexOf("&",Lk),nh=-1==ok?nh.substr(Lk):nh.substring(Lk,ok)):nh=void 0;if(null!=nh&&"undefined"!=typeof nh){Lk="";try{Lk=decodeURIComponent(nh)}catch(gs){}0<Lk.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Lk)&&(kf=kf+"|f|"+Lk)}return kf}function dn(kf,nh,Lk,ok,mp,gs){var hs=hK(kf);if(null==hs)return OB(Wp.DescriptiveUnattemptedEnums?
So.ProtocolHandlerIsNull:So.Unattempted,Wp.Application),!1;kf=kk(kf,nh,Lk,ok,hs);gg(kf,lp,zt,mp,gs);return!0}function fs(kf){if(Da()&&yd()){var nh="";try{nh=decodeURI(kf)}catch(Lk){}if(nh==kf)return encodeURI(kf)}return kf}function lp(){QC(lz.ProtocolHandler)}function zt(){Wp.Options|=cw.SkipProtocolHandler;iK(Wp,RC,SC)}function Ro(){null!=EG&&EG(lz.RoamingProtocolHandler)}function qr(){null!=FG&&FG(So.ControlNeeded)}function wy(){var kf=document.getElementById("npSharePointPlugin");if(null==kf){kf=
"application/x-sharepoint";Da()&&3<=(Yc()?Ve("version/"):0)&&PB("application/x-sharepoint-webkit",!0)&&(kf="application/x-sharepoint-webkit");if(!PB(kf,!0))if(Da()&&PB("application/officelive",!0))kf="application/officelive";else return null;var nh=document.createElement("object");nh.id="npSharePointPlugin";nh.type=kf;nh.style.width="0px";nh.style.height="0px";nh.style.setProperty("visibility","hidden","");document.body.appendChild(nh);kf=document.getElementById("npSharePointPlugin")}return kf}function PB(kf,
nh){var Lk=window.navigator.mimeTypes;if(null==Lk)return!1;kf=Lk[kf];return!kf||nh&&!kf.enabledPlugin?!1:!0}function $E(kf){try{if(null!=new ActiveXObject(kf))return!0}catch(nh){}return!1}function GG(kf){switch(kf){case dr.OneNote:return"OneNote.Notebook";default:return""}}function hK(kf){if(kf!=dr.OneNote&&n()&&!O())return"office:";switch(kf){case dr.Excel:return"ms-excel:";case dr.OneNote:return"onenote:";case dr.PowerPoint:return"ms-powerpoint:";case dr.Visio:return"ms-visio:";case dr.Word:return"ms-word:";
case dr.Project:return"ms-project:";case dr.Publisher:return"ms-publisher:";case dr.Infopath:return"ms-infopath:";case dr.Access:return"ms-access:";default:return""}}function EP(kf){switch(kf){case dr.Excel:return"root\\office15\\excel.exe";case dr.PowerPoint:return"root\\office15\\powerpnt.exe";case dr.Visio:return"root\\office15\\visio.exe";case dr.Word:return"root\\office15\\winword.exe";case dr.Project:return"root\\office15\\winproj.exe";case dr.Publisher:return"root\\office15\\mspub.exe";case dr.Infopath:return"root\\office15\\infopath.exe";
case dr.Access:return"root\\office15\\msaccess.exe";default:return null}}function iK(kf,nh,Lk){Wp=kf;RC=nh;SC=Lk;if(kf.DocumentUrl){var ok=Lk=nh=kf.DocumentUrl;try{ok=decodeURIComponent(kf.DocumentUrl)}catch(TC){}try{Lk=encodeURI(kf.DocumentUrl)}catch(TC){}nh=nh+""+kf.CorrelationIdForWinClient;ok+=kf.CorrelationIdForWinClient;Lk+=kf.CorrelationIdForWinClient;kf.Mode===$A.ReadWrite&&cw.CheckoutRequired===(kf.Options&cw.CheckoutRequired)&&(kf.Mode=$A.ForceCheckout);cw.HostIsEditOnly===(kf.Options&cw.HostIsEditOnly)&&
(kf.Mode=$A.WriteOnly);if(Ak(kf)?0:Da()&&(kf.Application==dr.OneNote||PB("application/x-sharepoint-protocolhandler",!1)||PB("application/x-sharepoint-webkit-protocolhandler",!1))||ca()||je()||!(a()||Le()||"ActiveXObject"in window&&!n()||yd())||15<=aF())dn(kf.Application,kf.EncodeUrl?Lk:nh,kf.Mode,kf.Application==dr.OneNote,kf.SilentExternalHandler,kf.NavigateUsingWindowOpen);else{var mp;if(mp=Vb())a:{var gs=kf.EncodeUrl?nh:ok,hs=kf.Mode,WD=GG(kf.Application);try{mp=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,
gs,hs,WD);break a}catch(TC){}mp=!1}if(mp)QC(lz.O15ActiveX);else{if(a()||Le()){var Ts=kf.EncodeUrl?nh:ok;ok=kf.Mode;mp=GG(kf.Application);gs=wy();if(null==gs)Ts=Wp.DescriptiveUnattemptedEnums?So.PluginIsNull:So.Unattempted;else{hs=!1;try{hs=gs.ViewDocument3(window.self,Ts,ok,mp)}catch(TC){}if(!hs)try{hs=Uk(ok)?gs.ViewDocument2(window.self,Ts,mp):gs.EditDocument2(window.self,Ts,mp)}catch(TC){}hs?(QC(lz.NpapiPlugin),Ts=So.None):Ts=So.Failed}}else{try{Ts=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=Ts&&
Ts.SaveSSOCreds()}catch(TC){}Ts=Rl(kf.EncodeUrl?nh:ok,kf.Mode,kf.Options,GG(kf.Application))}if(Ts!=So.None){if(ok=kf.CouldUseRoamingApps)jK||(jK=!0,kK=z("Windows NT")),ok=6.1<=kK&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(zb()||Le()||yd());if(ok&&kf.Application!=dr.OneNote){if(!ZA.wWc.kUn()){OB(So.ControlNeeded,Wp.Application);return}if(kf.RoamingAppsLauncher){"undefined"==typeof kf.RoamingAppsLauncher||null==kf.RoamingAppsLauncher?OB(Wp.DescriptiveUnattemptedEnums?So.RoamingLauncherIsNull:
So.Unattempted,Wp.Application):"undefined"==typeof kf.RoamingBitsUrl||null==kf.RoamingBitsUrl?ZA.wWc.WVn(kf.DocumentUrl,kf.RoamingAppsLauncher,kf.Application,kf.ApplicationParameters,RC,SC):ZA.wWc.KYj(kf.DocumentUrl,kf.RoamingAppsLauncher,kf.RoamingApplicationExe,kf.ApplicationParameters,kf.RoamingPlatform,kf.RoamingBitsUrl,RC,SC);return}if(!kf.ContinueIfLauncherIsNull){OB(So.LauncherNeeded,Wp.Application);return}}cw.NoProtocolHandlerFallback==(kf.Options&cw.NoProtocolHandlerFallback)||Ak(kf)||zb()||
Da()&&!(Wp.DescriptiveUnattemptedEnums?Ts>=So.O14Unattempted&&Ts<=So.DocumentUrlIsNull:Ts==So.Unattempted)?OB(Ts,Wp.Application):dn(kf.Application,kf.EncodeUrl?Lk:nh,kf.Mode,kf.Application==dr.OneNote,kf.SilentExternalHandler,kf.NavigateUsingWindowOpen)}}}}else OB(Wp.DescriptiveUnattemptedEnums?So.DocumentUrlIsNull:So.Unattempted,Wp.Application)}function QC(kf){null!=RC&&RC(kf)}function OB(kf,nh){"undefined"==typeof nh&&(nh=null);null!=SC&&SC(kf,nh)}function aF(){var kf=0;if(a()||Le()||yd()){var nh=
wy();try{null!=nh&&(kf=nh.GetOfficeVersion())}catch(Lk){}}else $E("SharePoint.OpenDocuments.5")?kf=15:$E("SharePoint.OpenDocuments.4")?kf=14:$E("SharePoint.OpenDocuments.3")?kf=12:$E("SharePoint.OpenDocuments.2")&&(kf=11);return kf}function lK(){return Da()&&(PB("application/x-sharepoint",!0)||PB("application/x-sharepoint-webkit",!0))}var mK="",nK="",oK="",RC,SC,EG,FG,Wp,jK,kK,fK,gK,$A={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},cw={None:0,CheckoutRequired:1,
O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},So={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},lz={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,
RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},dr={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:$A,OpenDocumentOptions:cw,OpenDocumentFailureType:So,OpenDocumentControl:lz,OfficeApplication:dr,EditDocumentInClient:iK,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=dr.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=
!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:aF,IsO14MacPluginInstalled:lK,OfferOfficeInDialog:function(){return d()&&11>=aF()},OfferOfficeNoIntrusive:function(){return d()&&
15>aF()},OfferMacOffice:function(){return Da()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!lK()},InstallRoamingControl:function(){Fc()?window.InstallTrigger.install({Office:{URL:nK}}):Ki(oK,null,null)},CanUseRoamingControl:function(){if(ca())return!0;if(yd())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Fc()){var kf=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(kf);
var nh=document.createEvent("Events");nh.initEvent("RoamingOfficeInstalled",!0,!1);kf.dispatchEvent(nh);return!!kf.getAttribute("installed")}if(zb())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Lk){}return!1},InitUrls:function(kf,nh,Lk){mK=kf;nK=Lk;oK=nh},LaunchRoamingApps:function(kf,nh,Lk,ok,mp,gs){ZA.wWc.KYj(kf,nh,EP(Lk),ok,"x86",mK,mp,gs)},LaunchRoamingApps2:function(kf,nh,Lk,ok,mp,gs,hs,WD){var Ts="";null!=ok&&(Ts+=" "+ok);null!=kf&&(Ts+=' "'+kf+'"');if(ca()||
yd())EG=hs,FG=WD,hs='office: "'+(gs+'" "')+(Lk+'" "ROAMING"'),hs+=' "'+nh+'"',hs+=' "'+mp+'"',hs+=" "+Ts,gg(hs,Ro,qr,!1,!1);else if(Fc())kf=document.createElement("RoamingExtensionElement"),kf.setAttribute("cabUrl",gs),kf.setAttribute("app",Lk),kf.setAttribute("licensingEntitlements",nh),kf.setAttribute("platform",mp),kf.setAttribute("args",Ts),document.documentElement.appendChild(kf),nh=document.createEvent("Events"),nh.initEvent("RoamingOfficeLaunch",!0,!1),kf.dispatchEvent(nh),null!=hs&&hs(lz.RoamingFFExtension);
else if(zb()){if(kf=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=kf)try{kf.HrConfigureSingle(gs,Lk,nh,mp,Ts),null!=hs&&hs(lz.RoamingActiveX)}catch(TC){}}else null!=WD&&WD(So.Failed)},ShouldShowDialog:function(){return!n()},NavigateToUrlUsingClickingOnATag:Lh,OpenDocumentWithProtocolHandler:dn,OpenDocumentWithProtocolHandlerNoCallBack:function(kf,nh,Lk,ok){var mp=hK(kf);if(null==mp)return OB(Wp.DescriptiveUnattemptedEnums?So.ProtocolHandlerNoCallbackIsNull:So.Unattempted,Wp.Application),
!1;kf=kk(kf,nh,Lk,ok,mp);gg(kf,null,null,!1,!1);return!0}}}();ZA.ClientUtils=ZA.wWc;var FP=b(1283);class bF{constructor(a,d,n){this.ga=a;this.gdk=d;this.$O=n}lb(){this.ga.ma(Sa.a.tryMacOffice,Cd.a.frame,Object(m.a)(this,this.hLm,"onTryMacOffice"));this.ga.ma(Sa.a.Kbh,Cd.a.frame,Object(m.a)(this,this.rbj,"onTryMacOfficeFromViewer"));this.ga.ma(Sa.a.Jbh,Cd.a.frame,Object(m.a)(this,this.rbj,"onTryMacOfficeFromViewer"))}hLm(a,d,n,z,O){if(1===n)return 32;O?(a=O.SourceControlId,"btnjTryMacOfficeForWordEditor"===
a?Ye.a.Tk(Vc.a.L4a(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===a&&Ye.a.Tk(Vc.a.L4a(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.dXi();return 32}rbj(a,d,n){if(1===n)return 32;switch(a){case Sa.a.Kbh:Ye.a.Tk(Vc.a.L4a(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Sa.a.Jbh:Ye.a.Tk(Vc.a.L4a(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}dXi(){Ye.a.Tk(bF.Usm,"_blank",void 0,"LaunchMacTrialWindow")}get fVd(){return this.gdk&&
I.a.Pi&&!I.a.FGe&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get lsn(){const a=this.fVd;a||l.AFrameworkApplication.ug.Wvj(9124,1);return a}get ksn(){return this.fVd}static get Usm(){return Vc.a.d4("522401")}}Object(t.a)(bF,"MacOfficeOffer",null,[1027]);class cF{constructor(a,d,n){this.ga=a;this.ldk=d;this.nZ=null;(this.Qge=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&la.a.instance.Ca("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(z=>
{this.nZ=z});this.$O=n}lb(){this.ga.ma(Sa.a.tryOffice,Cd.a.frame,Object(m.a)(this,this.iLm,"onTryOffice"));this.ga.ma(Sa.a.K2e,Cd.a.frame,Object(m.a)(this,this.K2e,"tryOfficeThroughTellMe"));this.ga.ma(Sa.a.Pbh,Cd.a.frame,Object(m.a)(this,this.TLj,"tryOfficeThroughViewer"));this.ga.ma(Sa.a.Obh,Cd.a.frame,Object(m.a)(this,this.TLj,"tryOfficeThroughViewer"))}iLm(a,d,n,z,O){if(this.Qge&&1===n)return this.isFreemiumUpsellEnabled&&this.gVd?32:8;2===n&&(O?(a=O.SourceControlId,"btnjTryOfficeForWordEditor"===
a?Ye.a.Tk(Vc.a.L4a(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===a?Ye.a.Tk(Vc.a.L4a(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.Sug()):this.Sug());return 32}K2e(a,d,n,z,O){if(this.Qge&&1===n)return this.isFreemiumUpsellEnabled&&this.gVd?32:8;2===n&&(O?(a=O.SourceControlId,Ye.a.Tk(Vc.a.d4("862405")+this.AJl(a),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Ye.a.Tk(Vc.a.d4("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));
return 32}TLj(a,d,n){if(this.Qge&&1===n)return this.isFreemiumUpsellEnabled&&this.gVd?32:8;if(2===n)switch(a){case Sa.a.Pbh:Ye.a.Tk(Vc.a.L4a(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Sa.a.Obh:Ye.a.Tk(Vc.a.L4a(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get uBm(){return this.gVd}get tBm(){return this.gVd&&MSOJS.ClientUtils.OfferOfficeInDialog()}get gVd(){return this.ldk&&!I.a.Pi}get isFreemiumUpsellEnabled(){let a=!1;this.nZ&&(a=this.nZ.isFreemiumUpsellEnabled());
return a}Sug(a=null){let d=0;a&&(d=a);Ye.a.Tk(cF.BEl(d),"_blank",void 0,"LaunchOfficeOffer")}AJl(a){let d=0;switch(a){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":d=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":d=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":d=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":d=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":d=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":d=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":d=
7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":d=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":d=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":d=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":d=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":d=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":d=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":d=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":d=20;break;
case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":d=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":d=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":d=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":d=29}return 0===d?"":String.format("&pc={0:D}",d)}static BEl(a){if(I.a.tg)switch(a){case 1:return Vc.a.d4("393806");case 2:return Vc.a.d4("393810");case 3:return Vc.a.d4("393809");case 5:return Vc.a.d4("393805")}else if(I.a.Px)switch(a){case 1:return Vc.a.d4("521979");
case 3:return Vc.a.d4("521980");case 5:return Vc.a.d4("521978");case 2:return Vc.a.d4("522490")}else{if(2===a)return Vc.a.d4("517778");if(1===a)return Vc.a.L4a(30)}return Vc.a.d4("522402")}}Object(t.a)(cF,"OfficeTrialExperience",null,[1028]);class pK{Hb(a){a.register(cF,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").singleInstance().zd(()=>new cF(l.AFrameworkApplication.pa,l.AFrameworkApplication.LDd,l.AFrameworkApplication.lcid));a.register(bF,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").singleInstance().zd(()=>
new bF(l.AFrameworkApplication.pa,l.AFrameworkApplication.jGe,l.AFrameworkApplication.lcid))}}Object(t.a)(pK,"OpenInClientConfiguration",null,[2]);var GP=b(1027);class xy{constructor(a,d,n,z,O,ca){this.vn=a;this.hc=d;this.Sy=n;this.Wl=z;this.tf=O;this.Eb=ca}x5l(a,d){a=d.view;d=d.Am;if(!d||!this.vn.Zng(d,!0)||this.Wl&&this.Wl.instance&&this.Wl.instance.l0(d))return 2;var n=xy.AQ?!xy.XL.s4(d):!0;this.Sy&&n&&this.Sy.fVc(d.node,xb.a.Ms,d.cpBegin);this.hc.oga(d,O=>new Cp.a(O,Cp.a.ujb),Vi.AParagraphNode.ix);
if(this.Eb.Jf){n=new Ff.GraphTransaction(15);try{n.Sa(d.node),this.tf.moa(d.node,d.cpBegin,d.cpBegin+1,1)}finally{n&&n.dispose()}}var z=d.node;n=d.cpEnd+1;" "===Bd.ParagraphReader.text(z).charAt(n)&&(z=fe.a.createTextRange(z,n,n+1),this.hc.replaceTextRange(z,"\u00a0"));d=fe.a.Kb(d.node,n);a.Oa.setSelection(ye.SelectionFactory.uj(d));return 32}static get XL(){return xy.XT||(xy.XT=la.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get AQ(){null==xy.iN&&(xy.iN=l.AFrameworkApplication.K?l.AFrameworkApplication.K.ea("SplitHyperlinkFixWithEnterIsEnabled"):
!1);return xy.iN}}xy.XT=null;xy.iN=null;Object(t.a)(xy,"InsertLineBreakStrategy",null,[]);class yu{static get Pg(){return yu.Ee||(yu.Ee=la.a.instance.resolve("Box4.IOutlineElementEditor"))}static get jg(){return bl.ContextSetEditor.instance}static get Aj(){return yu.tf||(yu.tf=la.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get hd(){return yu.Eb||(yu.Eb=la.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static T5l(a,d,n,z,O){if(O&&O.hasProperty(Xc.a.targetObject)){var ca=
d.view.xc.Ib.Ta(O.getValue(Xc.a.targetObject));ca=fe.a.create(ca)}else ca=yu.jg.xU(d.Am,11);if(!ca)return 8;a=l.AFrameworkApplication.pa.rf(ca,a,n,!0,z,O);if(32===a&&2===n){if(!d.view.Yd)return 2;d=d.view;z=d.Oa.Ag;if(z=yu.jg.xU(z,11)){n=new Pi.a;n.set(z.node);n.kc();if(O&&O.hasProperty(Xc.a.targetObject))for(O=O.Se(Xc.a.targetObject);!n.currentNode.id.equals(O)&&n.hb()&&(qe.OutlineElementNavigator.Uc(n),11===n.Yc););qe.OutlineElementNavigator.D0(n,!1,!1);O=Qd.SelectionEditor.IX(n,!0);O=Bd.ParagraphReader.yl(O)?
ye.SelectionFactory.Pc(O,0):ye.SelectionFactory.Bl(O);d.Oa.setSelection(O)}}return a}static bEe(a,d,n,z,O){a=a===Mb.a.OIc;d=d.node;if(O&&O.hasProperty(Xc.a.targetObject)&&!d.id.equals(O.Se(Xc.a.targetObject)))return 2;if(1===n)return 32;n=new Dd.GraphIterator;n.set(d);n.La(10);yu.Pg.BE(n,a,!0);yu.hd.Jf&&(n=qe.OutlineElementNavigator.Sd(n),yu.Aj.zlc(n,1));return 32}}yu.Ee=null;yu.tf=null;yu.Eb=null;Object(t.a)(yu,"InsertOutlineElementStrategy",null,[]);class mz{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb){this.Sy=
d;this.v8j=a;this.Xn=ca;this.Wq=O;this.Ee=n;this.E6j=z;this.vn=Da;this.Da=Xa;this.HG=zb;this.Exb=Vb}hzm(a,d,n,z,O){if(!d.view.Yd)return 2;d=d.view;let ca=null;d.gj&&(ca=d);const Da=d.Oa.Ag;var Xa=!0;let zb=!1,Vb=null;if(!Da)return 2;const Fc=new Ff.GraphTransaction(15);Fc.Sa(d.xc);let Yc=null;2===n&&(Yc=new Pi.a,Yc.set(Da.node),Yc.kc(),Vb=new Fr.a(Yc),qe.OutlineElementNavigator.Uc(Yc),Xa=Ia.OutlineElementReader.isEmpty(Yc,!1),{gBj:Xa,NSj:zb}=this.E6j.hBj(Yc,Xa,nt.a.P9b,-1,Da));a=l.AFrameworkApplication.pa.rf(Da,
a,n,!1,z,O);Xa&&32===a&&2===n&&(zb||qe.OutlineElementNavigator.hna(Yc,!1,!Qd.SelectionEditor.Cd(Da),!1),zb&&Vb&&Vb.restore(Yc),this.Xn.freeze(),(n=ye.SelectionFactory.Tm(Yc.currentNode,!0))||k.ULS.sendTraceTag(591958035,324,15,"could not create selection for NewLineView."),d.Oa.setSelection(n),this.Xn.XYa(),this.v8j.eh.$A());ca&&(Xa||ca.YY(),ca.editingView&&ca.fQ&&(ca.editingView.UK=!0));ot.GrippersManager.instance.PDa(1);Fc.dispose();return a}KE(a,d,n){a=!1;if(Kd.ImageReader.m0(d)||Kd.ImageReader.aVa(d))d=
this.uYk(d),a=!0;const z=d;if((d=Qd.SelectionEditor.Cd(d))&&this.vn.ye&&!this.vn.ZSi(z))return 2;if(1===n)return 32;const O=z.node,ca=new Dd.GraphIterator;ca.set(O);ca.kc();qe.OutlineElementNavigator.Uc(ca);n=new Ff.GraphTransaction(15);n.Ir(ca);d?(this.Exb.instance&&this.Exb.instance.rZa(z),Bd.ParagraphReader.nb(O)&&z.cpBegin===Bd.ParagraphReader.textLength(O)&&Lj.m(z)&&9===Bd.ParagraphReader.U4a(O)&&this.Xn.hZk(z),this.Wq.MXe(ca,!0,z,O),mz.Oc&&mz.Oc.qVa&&Bf.ListReader.Bh(ca)&&!Ia.OutlineElementReader.isEmpty(ca,
!1)&&(d=Bd.ParagraphReader.Im(ca.currentNode))&&d.ja&&!d.ja.last.formatting&&mz.characterPropertiesEditor.vHa(d),this.Sy&&this.Sy.fVc(O,xb.a.Ms,z.cpBegin),a&&(qe.OutlineElementNavigator.Mt(ca,!1,!1),a=ca.Va(2),(a=this.HG.Pc(a,0))&&this.Da.setSelection(a))):this.Ee.BE(ca,!0,!0);n.dispose();Lb.App.oa&&Lb.App.oa.updateCommandUI();return 32}uYk(a){if(Kd.ImageReader.m0(a))var d=fe.a.Kb(a.node,a.cpBegin);else{d=Bd.ParagraphReader.CL(a.node);var n=d.properties.Se(Qb.a.Qo);a=a.node.properties.getValue(Qb.a.runId);
n=mz.h7f(a,n,d.ja);d=fe.a.Kb(d,n)}return d}static get characterPropertiesEditor(){return mz.hc||(mz.hc=la.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Oc(){return at.a.getInstance()}static V1f(a,d){let n=0;for(;n<d.length&&!(a<d[n]);)n++;return n}static h7f(a,d,n){let z=0;a=mz.V1f(a,d);let O=0;if(a===d.length)O=n.length-1;else for(;O<n.length;){d=n.J(O);if(d.formatting&&d.formatting.Qc===a)break;O++}O<n.length&&(z=n.J(O).cp);return z}}mz.hc=null;Object(t.a)(mz,"NewLineStrategy",
null,[]);class QB{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le){this.Gj=null;this.faa=a;this.g6d=Da;this.rae=new mz(this,d,n,z,O,ca,Xa,Fc,Yc,Le);this.fAh=new xy(Xa,zb,d,Vb,yd,je)}get eh(){return this.Gj||(this.Gj=this.faa())}lb(){const a=l.AFrameworkApplication.pa,d=Object(m.a)(this.rae,this.rae.KE,"newLine");a.Aa(Mb.a.enter,Kb.a.view,Object(m.a)(this.g6d.value,this.g6d.value.Agl,"enterView"),1124);a.Aa(Mb.a.O3g,Kb.a.view,Object(m.a)(this.g6d.value,this.g6d.value.Iqn,"shiftEnterView"),1124);
a.ma(Mb.a.KE,Kb.a.view,Object(m.a)(this.rae,this.rae.hzm,"newLineView"));a.ma(Mb.a.KE,Kb.a.Ub,d);a.ma(Mb.a.KE,Kb.a.image,d);a.ma(Mb.a.KE,Kb.a.Lc,d);a.ma(Mb.a.KE,Kb.a.anchoredObject,d);a.ma(Mb.a.KE,Kb.a.embeddedFile,d);a.ma(Mb.a.KE,Kb.a.ink,d);a.ma(Mb.a.KE,Kb.a.paragraph,d);a.ma(Mb.a.KE,Kb.a.iFrame,d);a.ma(Mb.a.KE,Kb.a.unsupportedObject,d);a.$b(Mb.a.KE,1124);a.Aa(Mb.a.CAd,Kb.a.view,Object(m.a)(this.fAh,this.fAh.x5l,"insertLineBreakView"),1028);a.ma(Mb.a.OIc,Kb.a.view,yu.T5l);a.ma(Mb.a.OIc,Kb.a.outlineElement,
yu.bEe);a.$b(Mb.a.OIc,1092)}static get instance(){return QB.na||(QB.na=QB.al())}static al(){return new QB(()=>la.a.instance.resolve("Box4.IUndoManager"),la.a.instance.sa("Box4.IAutoCorrectScheduler"),la.a.instance.resolve("Box4.IOutlineElementEditor"),la.a.instance.resolve("Box4.List.ICursorMovementValidator"),la.a.instance.resolve("Box4.List.IListEditor"),la.a.instance.resolve("Box4.IInsertionPointFormatting"),la.a.instance.vf("Box4.Actors.IEnterViewStrategy"),aj.a.instance,la.a.instance.resolve("Box4.ICharacterPropertiesEditor"),
la.a.instance.Ca("Box4.IExternalSelectionManager"),Lg.a.instance,la.a.instance.resolve("Box4.ISelectionFactory"),la.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,la.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,la.a.instance.Ca("Box4.IContentControlConverter"))}}QB.na=null;Object(t.a)(QB,"EnterActor",null,[]);var HG=b(1207),IG=b(630);class Zk{static get paragraphEditor(){return Zk.Ki||(Zk.Ki=la.a.instance.resolve("Box4.IParagraphEditor"))}static get fda(){return Zk.RAb||
(Zk.RAb=la.a.instance.sa("Box4.ISpacingCommands"))}static get Vmc(){return Zk.nk||(Zk.nk=la.a.instance.sa("Box4.Styles.IWACStyleReader"))}static get w0(){return Zk.DC||(Zk.DC=la.a.instance.sa("Box4.ILineSpacingHelper"))}static get Aj(){return Zk.tf||(Zk.tf=la.a.instance.sa("Box4.TrackChange.ITrackChangeEditor"))}static get hd(){return Zk.Eb||(Zk.Eb=la.a.instance.sa("Box4.TrackChange.ITrackChangeManager"))}static get wO(){return la.a.instance.sa("Box4.Settings.SpacingSettings")}static lb(){var a;const d=
l.AFrameworkApplication.pa;d.ma(Mb.a.WIe,Kb.a.view,cm.a.Nz);d.$b(Mb.a.WIe,1028);d.ma(Mb.a.cF,Kb.a.view,cm.a.Nz);d.ma(Mb.a.cF,Kb.a.paragraph,Zk.Pje);d.$b(Mb.a.cF,1036);if(null===(a=Zk.wO)||void 0===a?0:a.YAa)d.ma(Mb.a.Zkc,Kb.a.paragraph,Zk.fDk),d.ma(Mb.a.Zkc,Kb.a.view,cm.a.Nz),d.$b(Mb.a.Zkc,1036);d.ma(Mb.a.qSc,Kb.a.paragraph,Zk.GDk);d.ma(Mb.a.qSc,Kb.a.view,cm.a.Nz);d.ma(Mb.a.tie,Kb.a.view,Zk.jAk);d.$b(Mb.a.tie,1036);d.ma(Mb.a.wUe,Kb.a.view,Zk.y8m);d.$b(Mb.a.wUe,1036);d.ma(Mb.a.sie,Kb.a.view,Zk.iAk);
d.$b(Mb.a.sie,1036);d.ma(Mb.a.vUe,Kb.a.view,Zk.x8m);d.$b(Mb.a.vUe,1036);d.ma(Mb.a.cYa,Kb.a.view,cm.a.Nz);d.ma(Mb.a.cYa,Kb.a.paragraph,Zk.Pje);d.$b(Mb.a.cYa,1036);d.ma(Mb.a.bYa,Kb.a.view,cm.a.Nz);d.ma(Mb.a.bYa,Kb.a.paragraph,Zk.Pje);d.$b(Mb.a.bYa,1036);d.ma(Mb.a.zWd,Kb.a.view,Zk.z_e);d.ma(Mb.a.zWd,Kb.a.paragraph,Zk.z_e);d.$b(Mb.a.zWd,1028);d.ma(Mb.a.A_e,Kb.a.view,Zk.z_e);d.ma(Mb.a.A_e,Kb.a.paragraph,Zk.z_e);d.$b(Mb.a.A_e,1028);d.ma(Mb.a.rWd,Kb.a.view,cm.a.Nz);d.ma(Mb.a.rWd,Kb.a.paragraph,Zk.tZh);d.$b(Mb.a.rWd,
1028);d.ma(Mb.a.qWd,Kb.a.view,cm.a.Nz);d.ma(Mb.a.qWd,Kb.a.paragraph,Zk.tZh);d.$b(Mb.a.qWd,1028)}static tZh(a,d,n,z,O){if(1===n)return 32;a===Mb.a.rWd?a=Mb.a.cYa:a===Mb.a.qWd&&(a=Mb.a.bYa);return Zk.Pje(a,d,n,z,Zk.qPm(O))}static qPm(a){var d=a.indexOf(",");const n=a.substring(0,d);a=a.substring(d+1,a.length);d=new HG.a;d.value=parseFloat(n);d.unit=parseInt(a);return d}static z_e(a,d,n,z,O){if(2===n){d=O[Tg.a.Text];n=O[Tg.a.Number];O=O.Increment;z=new HG.a;let ca=!1;""===d||O&&d===Box4Intl.Box4Strings.L_SpinnerAuto?
(z.value=0,z.unit=Lb.App.Uba?2:4,ca=!0):n||O||(z.value=0,z.unit=1,ca=!0);ca&&(l.AFrameworkApplication.pa.ob(a===Mb.a.zWd?Mb.a.cYa:Mb.a.bYa,2,z),Lb.App.oa.updateCommandUI())}return 32}static Pje(a,d,n,z,O){if(!({BA:n}=cm.a.b4g(n,d)).returnValue)return n;d=d.node;switch(a){case Mb.a.cF:Zk.paragraphEditor.cF(d,new IG.a(2,O));break;case Mb.a.cYa:a=new IG.a(O.unit,O.value);Zk.paragraphEditor.Tkc(d,a);break;case Mb.a.bYa:a=new IG.a(O.unit,O.value),Zk.paragraphEditor.Rkc(d,a)}z&&ip.a.KOb&&(z.vq|=ip.a.tFb(d));
return 32}static jAk(a,d,n){if(1===n)return 32;k.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");a=Zk.xEi(d);if(!a)return k.ULS.sendTraceTag(588367186,3018,10,"No style applied on the paragraph"),8;a=(a=a.fa(Qb.a.jO,240)/20)?a:Zk.H7k;Zk.fda.Vta(1,a,4);return 32}static y8m(a,d,n){if(1===n)return 32;k.ULS.sendTraceTag(588394562,340,50,"Remove Space Before Paragraph option is clicked");Zk.fda.Vta(1,0,4);return 32}static iAk(a,d,n){if(1===n)return 32;k.ULS.sendTraceTag(588394563,
340,50,"Add Space After Paragraph option is clicked");a=Zk.xEi(d);if(!a)return k.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),8;a=a.fa(Qb.a.JK,240)/20;Zk.fda.Vta(0,a?a:12,4);return 32}static x8m(a,d,n){if(1===n)return 32;k.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");Zk.fda.Vta(0,0,4);return 32}static GDk(a,d,n,z,O){if(2==n){if("boolean"!==typeof O)return 16;d.node.setValue(Kr.a.gM,O);k.ULS.sendTraceTag(526254554,3009,50,`User modified keep with next property. hasKeepWithNext: ${O}`)}return 32}static fDk(a,
d,n,z,O){if(2==n){if("boolean"!==typeof O)return 16;a=new Map;a.set("Value",O.toString());ja.Health.instance.recordKpiUsage(wh.a.kIe.kJj,0,wh.a.aH,a);d=d.node;a=null;uf.a.instance.J(3)&&(a=d.TB());d.hasProperty(Qb.a.JB)&&d.removeProperty(Qb.a.JB);Zk.w0.xwe(d)!==O&&d.setValue(Qb.a.JB,O);(O=Zk.w0.uye(d,!0))&&O.Fi(4,!0);(O=Zk.w0.uye(d,!1))&&O.Fi(4,!0);a&&Zk.Aj.d1(d,a,Zk.hd.Jf)}return 32}static xEi(a){a=a.view;return a.Yd&&(a=a.Oa)&&a.ya.Ba?Zk.Vmc.im(a.ya.Ba.ra.node):null}}Zk.Ki=null;Zk.RAb=null;Zk.nk=
null;Zk.DC=null;Zk.tf=null;Zk.Eb=null;Zk.H7k=12;Object(t.a)(Zk,"SpacingActor",null,[]);class qK{process(){}}Object(t.a)(qK,"NoOpFormattingViewOperationFinishedStageProcessor",null,[34]);class rK{constructor(a){this.Wd=a}Vkn(a,d){this.Wd.n5(a,d.cache.bD);this.Wd.ay(a,d.cache.fontSize)}P4a(){return null}cIa(){return null}QGc(){return null}x7(){return null}}Object(t.a)(rK,"FormattingStewardBridge",null,[37]);class sK{Hb(a){a.ha("Box4.Actors.IFormattingViewOperationFinishedStageProcessor",()=>new qK).singleInstance();
a.ha("Box4.Actors.IFormattingStewardBridge",()=>new rK(a.resolve("Box4.IFormattingEditor"))).singleInstance()}}Object(t.a)(sK,"WoncaActorsConfiguration",null,[2]);class tK{constructor(a,d,n,z,O,ca,Da,Xa){this.ga=a;this.h4j=d;this.g4j=n;this.Cph=z;this.fjk=O;this.Mbe=ca;this.kjk=Da;this.ljk=Xa}get Tb(){return this.ga}gIk(a){this.Tb.Nna(a,this.h4j,2,null,null,null)}eIk(a){this.Tb.Nna(a,this.g4j,2,null,null,null)}hfa(a,d,n){n?this.Tb.Nna(a,this.Cph,2,d,null,null):this.Tb.ob(this.Cph,2,d)}OPm(a,d){this.Tb.Nna(a,
this.Mbe,2,d,null,null)}Jna(a,d){this.Tb.Nna(a,this.kjk,2,d,null,null)}shc(a,d){this.Tb.Nna(a,this.ljk,2,d,null,null)}GQe(a,d=!1){const n=new dh.DictionaryPropertySet;n.setValue(Xc.a.wV,a);n.setValue(Xc.a.mMg,!0);n.setValue(Xc.a.O5a,d);this.Tb.ob(this.fjk,2,n)}}Object(t.a)(tK,"ClipboardCommands",null,[1267]);class uK{}Object(t.a)(uK,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1152]);class vK{constructor(a){this.ga=a}get Tb(){return this.ga}kyj(a,d,n){let z=0;a?1===a&&(z=Mb.a.u5a):z=Mb.a.t5a;
a=new wE.a;a.unit=n;a.value=d;this.Tb.ob(z,2,a)}eYe(a,d,n){let z=0;1===a?z=Mb.a.kNb:2===a?z=Mb.a.Gtb:a||(z=Mb.a.lNb);a=new wE.a;a.unit=n;a.value=d;this.Tb.ob(z,2,a)}}Object(t.a)(vK,"IndentationCommands",null,[1207]);var dF;(function(a){a[a.unspecified=-1]="unspecified";a[a.none=0]="none";a[a.left=1]="left";a[a.center=2]="center";a[a.right=3]="right";a[a.inner=4]="inner";a[a.outer=5]="outer";a[a.both=6]="both";a[a.distribute=7]="distribute";a[a.margin=8]="margin";a[a.highKashida=9]="highKashida";a[a.lowKashida=
10]="lowKashida";a[a.mediumKashida=11]="mediumKashida";a[a.numTab=12]="numTab";a[a.thaiDistribute=13]="thaiDistribute";a[a.start=14]="start";a[a.end=15]="end"})(dF||(dF={}));Object(t.b)("Justification",dF);class wK{constructor(a){this.F0a={};this.ga=a;this.m2l()}get Tb(){return this.ga}NH(a){a=this.F0a[dF[a]];void 0!==a&&null!==a&&this.Tb.processAction(a,2)}m2l(){this.F0a.left=Mb.a.leftJustify;this.F0a.center=Mb.a.centerJustify;this.F0a.right=Mb.a.rightJustify;this.F0a.both=Mb.a.fullJustify;this.F0a.lowKashida=
Mb.a.uIb;this.F0a.mediumKashida=Mb.a.uIb;this.F0a.highKashida=Mb.a.uIb;this.F0a.distribute=Mb.a.iDc;this.F0a.thaiDistribute=Mb.a.FSc}}Object(t.a)(wK,"JustificationCommands",null,[1196]);class xK{constructor(a){this.ga=a}cF(a){this.ga.ob(Mb.a.cF,2,a)}Zkc(a){this.ga.ob(Mb.a.Zkc,2,a)}qSc(a){this.ga.ob(Mb.a.qSc,2,a)}Vta(a,d,n){this.ga.ob(a?Mb.a.cYa:Mb.a.bYa,2,Object.assign(new HG.a,{value:d,unit:n}))}}Object(t.a)(xK,"SpacingCommands",null,[1087]);class yK{constructor(a,d,n,z){this.Tb=a;this.Bfa=d;this.Kpd=
n;this.Ndl=z;this.$Lm=(O,ca,Da)=>{if(1===Da)return 6===this.Bfa.YVa().status?32:8;O=this.Bfa.YVa();6==O.status&&O.result&&this.Kpd.Klm(O.result);this.Ndl().Cun(this.Kpd.Gyl());return 32};this.Bfa.init()}lb(){this.Tb.Aa(Mb.a.UJa,Kb.a.application,this.$Lm,1028)}}Object(t.a)(yK,"EditorSettingsUIActor",null,[]);class zK extends xg.a{constructor(a){super(!1,!1,!0);this.Bbb=a}Cun(a){a={["id"]:"SettingsDialog",["uiLanguage"]:l.AFrameworkApplication.uiCulture,["selectedLanguage"]:Ih.a.yf(l.AFrameworkApplication.lcid).name,
["isGoalActive"]:!1,["isSubscription"]:!0,["editorSettings"]:a};this.Ih(Box4Intl.Box4Strings.l_EditorSettings,Object(m.a)(this,this.Odl,"editorSettingsHandler"),a);k.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")}Odl(){this.Bbb.CKn();k.ULS.sendTraceTag(578869131,340,50,"Editor settings updated")}}Object(t.a)(zK,"EditorSettingsDialog",xg.a,[]);var HP=b(1225);class dA{constructor(a,d,n,z,O,ca){this.lcid=a;this.id=d;this.Fe=z;this.T7j=O;this.U7j=ca;this.defaultValue=this.pCc;
void 0!==n&&null!==n&&(this.pCc=n)}get pCc(){return(this.T7j||dA.zuh)(this.Fe)}set pCc(a){(this.U7j||dA.Auh)(this.Fe,a)}static Fn(){dA.zuh=()=>null;dA.Auh=()=>{}}}dA.zuh=null;dA.Auh=null;Object(t.a)(dA,"GrammarSettingOption",null,[1251]);dA.Fn();class JG{constructor(a,d,n){this.d2f=a;this.mZg=d;this.gzm=n}}Object(t.a)(JG,"TwoLevelCacheKey",null,[]);class Zj extends xg.a{constructor(a,d,n,z){super();this.Jsf=this.Cxa=this.ixh=this.h_c=null;this.Wg=z;this.c_c=a;this.Je=Zj.id;this.khk=()=>{this.h_c=
n?ta.a.TUd(n):{};this.ixh=n?ta.a.TUd(n):{};const O=this.oIk(),ca=Zj.f0k(O,Zj.svj(Object(m.a)(this,this.e0k,"createCritiqueTypeSettingsTracker"))(Zj.mWk(Xa=>this.h_c=Xa)));ca(n||{});var Da=Zj.svj(Zj.a5k())(Xa=>Xa.cloneNode(!0));Zj.g0k(O,Zj.B_k(Zj.I3k(d),Zj.d0k(Da))(n))(a.toString());this.Jsf=this.lKk();Da=Xa=>{if("click"===Xa.type||Xa.keyCode===xb.a.Ms||Xa.keyCode===xb.a.cpc)this.h_c[a.toString()]={},O.reset(),Zj.eMb(ca)};Qc.a.addHandler(this.fMb,vb.a.click,Da);Qc.a.addHandler(this.fMb,vb.a.Nf,Da)};
this.Lf=""}get fMb(){return this.Jsf}Zgm(){var a=Zj.bUg(this.h_c),d=Zj.bUg(this.ixh);if(!a&&!d)return!1;let n;try{n=a?"object"===typeof a[this.c_c.toString()]?a[this.c_c.toString()]:null:{};var z=d?"object"===typeof d[this.c_c.toString()]?d[this.c_c.toString()]:null:{}}catch(Da){return k.ULS.sendTraceTag(36489288,375,15,"Parse to dictionary failed"),!1}if(!n&&!z)return!1;n=n?n:{};z=z?z:{};a=String.format("language: {0}",this.c_c.toString());d=!1;for(const Da in n){var O=Da,ca=n[Da];O in z&&z[O]===
ca||(d=!0,a=String.format("{0}, [{1}, {2}]",a,O,ca))}for(const Da in z)z=Da,z in n||(d=!0,a=String.format("{0}, [{1}, default]",a,z));d&&k.ULS.sendTraceTag(37319685,375,50,"User changed settings: {0}",a);return d}Ih(a,d,n){super.Ih(a,d,n);this.y_m()}YR(a){return a.Ec.id===Zj.Aqj?!1:super.YR(a)}Ufn(){this.Wg.rk().KMc();this.Cxa=this.Wg.rk().Tf.VG}y_m(){this.Wg.rk().scope.zq(ic.FocusManager.instance().kN);this.Wg.rk().scope.zq(ic.FocusManager.instance().lN);this.Wg.rk().scope.bindAction(ic.FocusManager.instance().kN,
Mb.a.oHc);this.Wg.rk().scope.bindAction(ic.FocusManager.instance().lN,Mb.a.nHc);this.Wg.rk().scope.bindAction(gb.KeyInputManager.$a(xb.a.Xvb,0),Mb.a.Hxd);this.Wg.rk().scope.bindAction(gb.KeyInputManager.$a(xb.a.Zvb,0),Mb.a.Gxd);this.Wg.rk().scope.bindAction(gb.KeyInputManager.$a(xb.a.H5,0),Mb.a.Hxd);this.Wg.rk().scope.bindAction(gb.KeyInputManager.$a(xb.a.Fda,0),Mb.a.Gxd)}get settings(){return Zj.bUg(this.h_c)}rV(){super.rV();this.khk()}oIk(){const a=Zj.SIk(),d=Zj.cjd("WACDialogRow",a);this.rq.insertBefore(d,
this.rq.firstChild);return a}e0k(a){const d=HP.a.merge(null,a);return n=>{n.pCc===(a&&a[n.lcid]?a[n.lcid][n.id]:null)||n.pCc!==n.defaultValue?Zj.fBi(d,n.lcid)[n.id]=n.pCc:delete Zj.fBi(d,n.lcid)[n.id];this.Cxa=this.xAl(n.Fe);return d}}xAl(a){return a?(a=a.getElementsByTagName(Object(oj.a)(a,Zj.Uim)?"select":"input"))?a[0]:null:null}dispose(){this.fMb&&(Qc.a.hUe(this.fMb),this.Jsf=null);super.dispose()}lKk(){const a=document.createElement("input");a.id=Zj.Aqj;a.type="reset";a.setAttribute("form",Zj.Pqi);
a.className="WACButton WACDialogButtonNormal GrammarSettingsDialogResetButton";a.value=CommonUIStrings.l_ResetAll;const d=Zj.cjd("GrammarSettingsDialogResetButtonContainer",a),n=document.getElementById("WACDialogButtonPanel");n.parentNode.insertBefore(d,n);return a}static get Fnd(){return"CritiqueType"}static mWk(a){return d=>n=>a(d(n))}static svj(a){return d=>n=>d(a(n))}static bUg(a){const d={};ta.a.forEach(a,(n,z)=>{0<Eo.a(z).length&&(d[n]=z)},null);return d}static SIk(){const a=document.createElement("form");
a.id=Zj.Pqi;a.classList.add("WACDialogList",Zj.w5k);return a}static f0k(a,d){const n=Zj.GZm(a,vb.a.change);return z=>{const O=d(z);n(ca=>{ca=ca.target.parentNode;Object(oj.a)(ca,Zj.Fnd)&&O(ca[Zj.r_h])})}}static GZm(a,d){let n=null;return z=>{n&&Qc.a.removeHandler(a,d,n);Qc.a.addHandler(a,d,z);n=z}}static fBi(a,d){return a[d]=a[d]||{}}static eMb(a){k.ULS.sendTraceTag(36489289,375,50,"User click reset all button");a(null)}static I3k(a){let d=null;return n=>{d=n;return a.request(Number.parseInvariant(n)).CWRCo(z=>
d===n?z.result:null,Zj.zUf)}}static g0k(a,d){const n=Zj.Fsl(z=>Zj.wEn(z.children));return z=>{const O=n(z,a);a.innerHTML="";(O?Jh.Task.KL(O):d(z)).continueWith(ca=>{ca=ca.result;for(let Da=0;Da<ca.length;Da++)a.appendChild(ca[Da])},Zj.zUf)}}static B_k(a,d){return n=>z=>a(z).CWRCo(O=>sg.toArray(sg.select(sg.asEnumerable(O.result),ca=>d(n,ca,z))),Zj.zUf)}static wEn(a){const d=[];for(let n=0;n<a.length;n++)d.push(a[n]);return d}static Fsl(a){const d={};let n=null;return(z,O)=>{n&&!d[n]&&(O=a(O))&&(d[n]=
O);n=z;return d[z]}}static a5k(){const a={};return d=>{a[d.d2f]=a[d.d2f]||{};const n=a[d.d2f];n[d.mZg]=n[d.mZg]||d.gzm();return n[d.mZg]}}static d0k(a){return(d,n,z)=>{const O=a(new JG(z,n.Id,()=>Zj.DIk(n)));O.setAttribute("role","group");const ca=Zj.i5h+n.Name;O.setAttribute("aria-labelledby",ca);for(const Da of n.CritiqueTypeInfoList){const Xa=Zj.zpl(z,Da,d,a);O.appendChild(Xa);Xa.setAttribute("aria-labelledby",ca)}return O}}static zpl(a,d,n,z){z=z(new JG(a,d.Id,()=>d.IsBinaryCritiqueType?Zj.vIk(d):
Zj.TJk(d)));a=new dA(a,d.Id,n&&n[a]?n[a][d.Id]:null,z,d.IsBinaryCritiqueType?O=>O.children[0].checked:O=>O.children[1].selectedIndex,d.IsBinaryCritiqueType?(O,ca)=>{O.children[0].checked=ca}:(O,ca)=>{O.children[1].selectedIndex=ca});z[Zj.r_h]=a;return z}static DIk(a){a=Zj.FIk(a.Name);a.className="WACWritingStylesDialogCategoryTitle";return Zj.cjd("CritiqueCategory",a)}static vIk(a){const d=Zj.HIk();d.id=a.Id;0<a.DefaultCritiqueValue&&d.setAttribute("checked","checked");a=Zj.mle(a.Name,a.Id);a.className=
"WACDialogLabel";const n=Zj.cjd(Zj.Fnd,d,a);n.appendChild(d);n.appendChild(a);return n}static TJk(a){a=Zj.zJk(a.Id,a.Name,Zj.XJk(a.CritiqueTypeValues,a.DefaultCritiqueValue),a.DefaultCritiqueValue);a.classList.add(Zj.Fnd);return a}static XJk(a,d){return sg.toArray(sg.Si(sg.asEnumerable(a||[]),(n,z)=>{n=Zj.WJk(n,z.toString());z===d&&n.setAttribute("selected","selected");return n}))}static zJk(a,d,n,z){d=Zj.mle(d,a);const O=document.createElement("select");O.id=a;O.className="WACDialogList";n=n||[];
for(a=0;a<n.length;a++)O.appendChild(n[a]),z===a&&(n[a].selected=!0);return Zj.cjd("GrammarSettingsDialogLabeledInlineList",d,O)}static WJk(a,d){const n=document.createElement("option");n.text=a;n.value=d;return n}static HIk(){const a=document.createElement("input");a.type="checkbox";a.className="WACDialogCheckBox";return a}static mle(a,d){const n=document.createElement("label");n.innerText=a;n.setAttribute("for",d);return n}static FIk(a){const d=document.createElement("div");d.innerText=a;d.id=Zj.i5h+
a;return d}static cjd(a=null,...d){const n=document.createElement("div");n.className=a;for(const z of d)n.appendChild(z);return n}}Zj.id="GrammarSettingsDialog";Zj.Pqi="CritiqueTypeSettings";Zj.w5k="CritiquesList";Zj.Uim="GrammarSettingsDialogLabeledInlineList";Zj.Aqj="ResetButton";Zj.i5h="WritingStylesCategory_";Zj.zUf=11;Zj.r_h="CritiqueType";Object(t.a)(Zj,"GrammarSettingsDialog",xg.a,[]);class AK{constructor(a,d,n,z){this.Tb=a;this.Bfa=d;this.eUl=n;this.tPg=z;this.$d=null;this.tPg.init();this.Bfa.init()}lb(){this.Tb.Aa(Mb.a.UJa,
Kb.a.application,Object(m.a)(this,this.UJa,"openGrammarSettings"),1028);this.Tb.ma(Mb.a.oHc,Cd.a.frame,Object(m.a)(this,this.rHi,"grammarDialogTabFocusHandler"));this.Tb.ma(Mb.a.nHc,Cd.a.frame,Object(m.a)(this,this.rHi,"grammarDialogTabFocusHandler"));this.Tb.ma(Mb.a.Hxd,Cd.a.frame,Object(m.a)(this,this.qHi,"grammarDialogOptionFocusHandler"));this.Tb.ma(Mb.a.Gxd,Cd.a.frame,Object(m.a)(this,this.qHi,"grammarDialogOptionFocusHandler"))}UJa(a,d,n,z,O){a=this.Ywl();if(1===n)return this.tPg.request(a).result&&
this.tPg.request(a).result.length?6===this.Bfa.YVa().status?32:8:8;n=this.Bfa.YVa().result;this.$d=this.eUl(a,n);this.$d.showDialog(CommonUIStrings.l_GrammarSettingsDialogTitle,ca=>{k.ULS.sendTraceTag(36489285,375,50,"User click button of {0}",1===ca?"OK":ca?"":"Cancel");1===ca&&(this.$d.Zgm()?(k.ULS.sendTraceTag(36489286,375,50,"User update proofing options"),this.Bfa.saveSettings(this.$d.settings)):k.ULS.sendTraceTag(36508631,375,50,"User click OK with but not update setting"))});a=n="";O&&(n+=
O.SourceControlId,a+=O.Alt);k.ULS.sendTraceTag(36489287,375,50,"Open grammar setting dialog, SourceControlId: "+n+", Alt: "+a);return 32}Ywl(){return l.AFrameworkApplication.lcid}rHi(a){if(!this.$d)return 2;var d=this.$d.Wg.rk().Tf.VG;if(d===this.$d.Lm&&a===Mb.a.oHc||d===this.$d.fMb&&a===Mb.a.nHc)this.$d.Cxa?this.$d.Wg.rk().Tf.ou(this.$d.Cxa):this.$d.Ufn();else if(Object(oj.a)(d,Zj.Fnd)||d.parentNode&&Object(oj.a)(d.parentNode,Zj.Fnd))d=null,a===Mb.a.oHc?d=this.$d.fMb:a===Mb.a.nHc&&(d=this.$d.Lm),
this.$d.Wg.rk().Tf.ou(d);else if(a===Mb.a.oHc)this.$d.Wg.rk().oWa();else if(a===Mb.a.nHc)this.$d.Wg.rk().nWa();else return 2;return 32}qHi(a){if(!this.$d)return 2;let d=this.$d.Wg.rk().Tf.VG;if(d===this.$d.Lm||d===this.$d.fMb||d===this.$d.Tu)return 2;a===Mb.a.Gxd&&this.$d.Wg.rk().oWa();a===Mb.a.Hxd&&this.$d.Wg.rk().nWa();d=this.$d.Wg.rk().Tf.VG;d===this.$d.fMb?this.$d.Wg.rk().nWa():d===this.$d.Lm?this.$d.Wg.rk().oWa():this.$d.Cxa=d;return 32}}Object(t.a)(AK,"GrammarSettingsActor",null,[]);class BK{constructor(a,
d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je){this.JYb=this.a$c=this.Pqc=null;this.jvf=0;this.Jif=!1;this.ka=new oc.a;this.V1c=null;this.GFe=!1;this.BVb=null;this.Kz=a;this.Xn=d;this.Wd=n;this.Ki=z;this.Ha=O;this.Wq=ca;this.zc=Da;this.hc=Xa;this.vn=zb;this.Ja=Vb;this.Eb=Fc;this.tf=Yc;this.kU=yd;this.nk=je}get Uel(){return this.Ja?this.Ja.isFeatureEnabled(66):!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("Box4EndOfParagraphFormattingIsEnabled")}get C3f(){return this.V1c||(this.V1c=la.a.instance.resolve("Box4.IFormatPainterStrategy"))}get UN(){return this.Jif}set UN(a){this.Jif!==
a&&(this.Jif=this.GFe=a,this.ka.raiseEvent("FormatPainterBrushActiveStatusChanged"))}Ixk(a){this.ka.addHandler("FormatPainterBrushActiveStatusChanged",a)}HMg(a){const d=a.ra;k.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",d.contextId);this.reset();var n=d.node;a=this.USi(a);if(this.C3f.psn(d.contextId,a))try{this.JYb=this.Ha.V4a(n)}catch(z){throw k.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",z.message),z;}this.a$c=this.nk.im(n);n=La.FormattingReader.yr(d);
n.gm&&(this.Pqc=Object(qa.a)(kp.a,n.gm.clone()));this.jvf=a?Kb.a.paragraph:d.contextId}Ije(a){if(a){const z=this.USi(a);if(this.DFe)if(a=a.zy().Xx(),null===a||void 0===a?0:a.Cj)this.dCb(a,z);else if(0==(null===a||void 0===a?void 0:a.length))k.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",a);else{if(a)for(var d=0;d<a.length;d++){var n=a.getContext(d);if(null===n||void 0===n?0:n.Iq){if(n)for(let O=0;O<n.length;O++)a.addContext(n.getContext(O))}else(null===
n||void 0===n?0:n.Cj)?this.dCb(n,z):k.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",n.contextId)}}else for(d=0;d<a.length;d++)n=a.J(d),(null===n||void 0===n?0:n.Cj)?this.dCb(n,z):k.ULS.sendTraceTag(22832068,354,50,"Attempt to apply format to non-graph-node context: {0}",n.contextId)}}VYh(a,d){if(d){var n=a.node,z=n.ja.last,O=this.hc.vHa(n),ca=O.Xc(O.Wa);this.WYh(O,d,null);uf.a.instance.J(3)&&this.tf.alc(n,z,a.cpBegin,a.cpEnd,ca,O,this.Eb.Jf)}}uDk(a,d,n){if(d||
n)0<Lj.g(a).length&&k.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.kU.Tka(a,z=>{this.WYh(z,d,n)})}WYh(a,d,n){this.Wd.mya(a);a.gm&&a.gm.removeProperty(Vd.a.highlight);this.Wd.bMf(a);n&&this.hn(a,n.Be());this.hn(a,d)}hn(a,d){if(d){var n=a.paragraph.Ib;if(n){var z=a.gm;z=z?Object(qa.a)(Em.a,z.clone()):kp.a.yya(1179725);for(const ca of d.Dh())if(ca!==Qb.a.Xs&&ca!==Qb.a.fieldInstruction&&ca!==Vd.a.av&&ca!==Vd.a.ES&&ca!==Qb.a.MIa&&ca!==Vd.a.Sv&&ca!==Qb.a.languageHint&&
ca!==Qb.a.gO){if(ca===lh.a.GA){var O=d.fa(lh.a.GA,E.a.nil);if(O!==E.a.nil)if(O=n.Ta(O)){if(O=new Jw.a(O),O=this.nk.Lv(O),O===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(O=this.nk.rz(a.paragraph).dma(O)){z.hn(O.Be());continue}else k.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else k.ULS.sendTraceTag(589345876,354,50,"Applied character style on formatting is not present in Object Space")}z.setValue(ca,d.Se(ca))}z.V7?d=n.$S(z,!0):(n.Mu(z),d=
z);a.ng=d.id}}}USi(a){return!a.IA&&a.Fb.contextId!==Kb.a.endOfParagraph}reset(){this.JYb=this.a$c=this.Pqc=null;this.jvf=Kb.a.none}dCb(a,d){if(a.contextId===Kb.a.Ub||a.contextId===Kb.a.Lc)var n=this.vn.t4(a);else if(a.contextId===Kb.a.paragraph)n=this.vn.GKc(a);else if(a.contextId===Kb.a.endOfParagraph)n=this.vn.Obc(a);else{k.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",a.contextId);return}k.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",a.contextId);
if(n)k.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{n=Object(qa.a)(Vi.AParagraphNode,a.node);var z=!1;n&&(z=a.contextId===Kb.a.Lc&&!!n&&!a.cpBegin&&a.cpEnd===this.Ha.textLength(n));if(d=this.C3f.Pqn(this.jvf,a.contextId,d,z))try{Bd.ParagraphReader.nb(n)?(this.a$c&&this.Kz.hT(this.a$c,n,!0),this.Ki.jZh(n,this.JYb)):k.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",a.node.type)}catch(O){throw k.ULS.sendTraceTag(22832065,
354,10,"ApplyParagraphProperties error: {0}",O.message),O;}z=a;a.contextId===Kb.a.paragraph?z=fe.a.createTextRange(n,0,Bd.ParagraphReader.textLength(n)):a.contextId===Kb.a.Ub&&(z=this.Xn.Lbg(a),z=Lg.a.s3a(z));if(z&&z.contextId===Kb.a.Lc)try{this.uDk(z,this.Pqc,d?null:this.a$c)}catch(O){throw k.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",O.message),O;}if(a.contextId===Kb.a.paragraph||a.contextId===Kb.a.endOfParagraph){d=new Dd.GraphIterator;d.set(n);d.kc();d.tc(11);z=
Bf.ListReader.Bh(d);const O=!Bd.ParagraphReader.textLength(n);k.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",z,O);z?(this.zc.dC(d),d=d.currentNode,this.zc.o0(d)&&(ii.a.Oc.hV?this.VYh(a,this.Pqc):this.Wq.KXe(d,n,this.Pqc))):this.Uel&&this.VYh(a,this.Pqc)}}}get DFe(){null==this.BVb&&(l.AFrameworkApplication.Yi("0b2ac141;84eff841"),this.BVb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsFormatPainterBugFixFlightEnabled",
!1):!1);return this.BVb}}Object(t.a)(BK,"FormatPainter",null,[1233]);var IP=b(101);class RB{constructor(a,d,n,z,O,ca,Da,Xa=!1,zb,Vb,Fc){this.G9d=!1;this.Gff=new bu.a;this.BVb=null;this.gh=a;this.ib=d;this.ga=n;this.Bc=z;this.JJ=O;this.Or=ca;this.Da=Da;this.Fck=Xa;this.to=zb;this.Gz=Vb;this.K6j=Fc}get $wh(){return I.a.xm||I.a.VKc?"url("+this.Gxi()+"), pointer":'url("'+this.Gxi()+'"), pointer'}Gxi(){return this.Gz?this.to.UX(ul.a.$e("FormatPainterText.cur"),ul.a.$e("FormatPainterTextDarkMode.cur"),
new IP.a(zh.a.Z3())):ul.a.$e("FormatPainterText.cur")}lb(){const a=this.ib.Kc(og.AppFrame.lE);a.bindAction(gb.KeyInputManager.$a(xb.a.Cua,0),Mb.a.mve);a.bindAction(gb.KeyInputManager.$a(xb.a.b_a,6),Mb.a.osd);this.Fck||a.bindAction(gb.KeyInputManager.$a(xb.a.$La,6),Mb.a.Jla);this.ga.Aa(Mb.a.osd,Kb.a.view,Object(m.a)(this,this.YVl,"handleFormatPainterPick"),1028);this.ga.Aa(Mb.a.Jla,Kb.a.view,Object(m.a)(this,this.WVl,"handleFormatPainterApply"),1028);this.ga.Aa(Mb.a.mve,Kb.a.view,Object(m.a)(this,
this.XVl,"handleFormatPainterCancel"),1028);this.Or.Ixk(()=>{this.Peh(this.Or.UN)});this.Gz&&this.K6j.JCf(()=>{this.jPe(this.Or.UN)})}XVl(){this.Or.UN=!1;return 32}YVl(a,d,n){a=!1;if(d=this.JJ.rza){switch(d.contextId){case Kb.a.Lc:case Kb.a.paragraph:case Kb.a.endOfParagraph:case Kb.a.Ub:a=!0}a&&Qd.SelectionEditor.Ch(d)&&Lj.b(d)&&(this.Bc.mb(Ee.a.oo,{["Reason"]:Jf.a.k5b}),a=!1);a&&Bd.ParagraphReader.wS(d)&&(this.Bc.mb(Ee.a.oo,{["Reason"]:Jf.a.qP}),a=!1)}if(1===n||!a)return a?32:8;6!==this.ga.gz?(this.Or.UN?
k.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(k.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this.Or.HMg(this.JJ.Ba),this.G9d||(this.gh.l2a(Object(m.a)(this,this.mOj,"updateCursorOnModeSwitched")),(n=this.gh.za.tw)&&n.gj&&n.xCf(Object(m.a)(this,this.lOj,"updateCursorOnInitialSelection")),this.G9d=!0)),this.Or.UN=!this.Or.UN):(k.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),this.Or.HMg(this.JJ.Ba),this.Or.UN=
!1);return 32}WVl(a,d,n,z,O){if(6===this.ga.gz||this.Or.UN){k.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this.ga.gz);a=this.gh.Np.Pe("UserAction","FormatPainterApply");if(RB.Ka&&RB.Ka.fq(197)){O=O?O.KeepBrushActive:!1;n=null;this.JJ.Ba&&2===this.JJ.Ba.trigger&&(O=O||this.Or.GFe,this.Or.GFe&&Qd.SelectionEditor.qj(this.JJ.Ba)&&(n=Qd.SelectionEditor.SU(this.JJ.Ba.ra,!1)))&&(n.trigger=2);this.Or.GFe=!1;if(O||2!==this.JJ.Ba.trigger)d=new Ff.GraphTransaction(15),
n&&n.ra?(d.set(n.ra.node.Bf),this.Da.setSelection(n)):d.set(this.JJ.f8b.Bf),n=this.DFe?ye.SelectionFactory.uj(this.Da.Ag):this.JJ.Ba,this.Or.Ije(n),d.dispose();this.Or.UN=O}else O=new Ff.GraphTransaction(15),O.set(this.JJ.f8b.Bf),d=this.DFe?ye.SelectionFactory.uj(this.Da.Ag):this.JJ.Ba,this.Or.Ije(d),this.Or.UN=!1,O.dispose();a.stop()}return 32}Peh(a){const d=this.gh.Np.Pe("UserAction","FormatPainterUpdateCursor");this.jPe(a);this.gh.updateCommandUI();d.stop()}kOj(a,d){for(let n=0;n<a.length;n++)this.jOj(a[n],
d);(a=this.gh.za.tw)&&a.Yd&&this.jOj(a.Yf.editingElement,d)}jOj(a,d){a.style.cursor=d?this.$wh:""}mOj(){this.jPe(this.Or.UN)}lOj(){this.jPe(this.Or.UN)}jPe(a){const d=document.querySelectorAll(".OutlineElement");if(1<d.length){const n=d[d.length-2].style.cursor===this.$wh;if(this.gh.za.isEditingAllowed||this.gh.za.hu){if(a&&!n||!a&&n)this.kOj(d,a),this.GOj(a);a||!this.G9d||this.Gff.count||(this.gh.OUg(Object(m.a)(this,this.mOj,"updateCursorOnModeSwitched")),(a=this.gh.za.tw)&&a.gj&&a.qoj(Object(m.a)(this,
this.lOj,"updateCursorOnInitialSelection")),this.G9d=!1)}else n&&(this.kOj(d,!1),this.GOj(!1))}}GOj(a){const d=this.gh.za.tw;d&&(a?this.Gff.add(d.xc.Hl):this.Gff.remove(d.xc.Hl))}static get Ka(){return RB.Ja||(RB.Ja=la.a.instance.sa("Box4.IFeatureHelper"))}get DFe(){null==this.BVb&&(l.AFrameworkApplication.Yi("0b2ac141;84eff841"),this.BVb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsFormatPainterBugFixFlightEnabled",!1):!1);return this.BVb}}
RB.Ja=null;Object(t.a)(RB,"FormatPainterActor",null,[]);class yy{constructor(a,d,n){this.Wl=n}Agl(a,d,n,z,O){var ca;if(!({Tc:n,selected:ca,BA:zb}=this.nBj(d,n,!1)).returnValue)return zb;Mh.a.mark(5013);var Da=yy.jg.yF(ca);for(var Xa=0;Xa<Da.length;++Xa){if(!Da[Xa].Yb)continue;const Vb=Da[Xa].iterator;Vb.tn();if(qh.OutlineReader.yq(Vb))return this.kli(n,Vb)}Da=this.$yl();if(ca.Iq||Qd.SelectionEditor.Ch(ca)||Bd.ParagraphReader.rh(ca)&&!Qd.SelectionEditor.SN(ca)){if(yy.Ka&&yy.Ka.isFeatureEnabled(39)&&
bl.ContextSetEditor.instance.a_e(ca).returnValue)return 8;var zb=this.lli(d,n,a,z,O,Da)}else if(Qd.SelectionEditor.sg(ca))zb=this.jli(d,n,a,z,O,Da);else if(Qd.SelectionEditor.Cd(ca)){zb=new Dd.GraphIterator;zb.set(ca.node);zb.La(10);Xa=hg.HyperlinkReader.vw(ca,!1);if(0<Xa.length){if(!Xa[0].hyperlink)return k.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",Xa[0].cpBegin,Xa[0].cpEnd),8;Lb.App.Wkb(Xa[0].hyperlink.url);return 32}Sf.TableCellReader.cM(zb)&&(Uf.returnToContainingCell(zb),
Sf.TableCellReader.Wba(zb)&&(Xa=new Dd.GraphIterator,Xa.Cb(zb),Uf.returnToContainingRow(Xa),qh.OutlineReader.Hs(zb,ca,!1)&&km.a.uog(Xa)&&0>=ca.Ma&&(Da=Mb.a.OIc,Uf.returnToContainingTable(zb),qe.OutlineElementNavigator.Uc(zb),O||(O=new dh.DictionaryPropertySet),O.lf(Xc.a.targetObject,zb.currentNode.id))));zb=this.oli(d,n,a,z,O,Da)}else Qd.SelectionEditor.SN(ca)&&(zb=l.AFrameworkApplication.pa.rf(d,Mb.a.KE,2,!1,z,O));Mh.a.mark(5014);return zb}nBj(a,d,n){let z=null,O=null;if(1===d)return{returnValue:!1,
Tc:z,selected:O,BA:32};if(!a.view.Yd)return{returnValue:!1,Tc:z,selected:O,BA:2};z=a.view;return(O=z.Oa.Ag)&&yy.If.Zng(O,n)?this.Wl&&this.Wl.instance&&this.Wl.instance.l0(O)?{returnValue:!1,Tc:z,selected:O,BA:4}:{returnValue:!0,Tc:z,selected:O,BA:2}:{returnValue:!1,Tc:z,selected:O,BA:2}}Iqn(a,d,n,z,O){let ca,Da;if(!({Tc:n,selected:ca,BA:Da}=this.nBj(d,n,!0)).returnValue)return Da;const Xa=yy.jg.yF(ca);for(let zb=0;zb<Xa.length;++zb){if(!Xa[zb].Yb)continue;const Vb=Xa[zb].iterator;Vb.tn();if(qh.OutlineReader.yq(Vb))return this.kli(n,
Vb)}ca.Iq||Qd.SelectionEditor.Ch(ca)?Da=this.lli(d,n,a,z,O,Mb.a.CAd):Qd.SelectionEditor.sg(ca)?Da=this.jli(d,n,a,z,O,Mb.a.CAd):Qd.SelectionEditor.Cd(ca)?Da=this.oli(d,n,a,z,O,Mb.a.CAd):Qd.SelectionEditor.SN(ca)&&(Da=l.AFrameworkApplication.pa.rf(d,Mb.a.KE,2,!1,z,O));return Da}kli(a,d){a.Oa.setSelection(ye.SelectionFactory.Tm(d.currentNode,!1));return 32}lli(a,d,n,z,O,ca){const Da=new Ff.GraphTransaction(15);Da.om=n;Da.Sa(d.xc);d=new dh.DictionaryPropertySet;d.setValue(Xc.a.mDc,!0);d=l.AFrameworkApplication.pa.rf(a,
Mb.a.iK,2,!0,z,d);32===d&&(d=l.AFrameworkApplication.pa.rf(a,ca,2,!1,z,O));Da.dispose();return d}jli(a,d,n,z,O,ca){const Da=new Ff.GraphTransaction(15);Da.om=n;Da.Sa(d.xc);d.Oa.setSelection(Qd.SelectionEditor.Xf(d.Oa.ya.J(0),!1,!1));a=l.AFrameworkApplication.pa.rf(a,ca,2,!1,z,O);Da.dispose();return a}oli(a,d,n,z,O,ca){const Da=new Ff.GraphTransaction(15,n);Da.om=n;Da.Sa(d.xc);a=l.AFrameworkApplication.pa.rf(a,ca,2,!1,z,O);Da.dispose();return a}static get jg(){return bl.ContextSetEditor.instance}static get If(){return aj.a.instance}static get Ka(){return yy.Ja||
(yy.Ja=la.a.instance.sa("Box4.IFeatureHelper"))}}yy.Ja=null;Object(t.a)(yy,"AEnterViewStrategy",null,[1262]);class CK extends yy{constructor(a,d,n){super(a,d,n)}$yl(){return Mb.a.KE}}Object(t.a)(CK,"EnterViewStrategy",yy,[]);class KG{constructor(a){this.zi=this.transaction=null;this.Tc=a;this.mmd=this.Ti=0}}Object(t.a)(KG,"SelectAllArguments",null,[]);class eA{constructor(a,d,n,z){this.cvc=a;this.fwa=d;this.Nb=n;this.ajf=z}get yNm(){return this.cvc}get eh(){return this.fwa.value}get Nfn(){return this.ajf?
Object(m.a)(this,this.Khl,"expandSelectionWord"):Object(m.a)(this,this.juj,"selectAllInOutline")}lb(){const a=l.AFrameworkApplication.pa;a.ma(Mb.a.J8,Cd.a.frame,eA.hCj);a.ma(Mb.a.JYe,Cd.a.frame,eA.hCj);a.Aa(Mb.a.mkb,Kb.a.view,this.Nfn,2);a.Aa(Mb.a.XQa,Kb.a.view,Ec.AFrame.rc,100);a.Aa(Mb.a.SLe,Kb.a.view,eA.SLe,4)}mkb(a,d,n){if(1===d)return 32;if(!a.view.Yd)return 2;d=a.view;if(!d.Oa)return 8;const z=d.Oa.ya;if(!z||!z.length)return 8;Mh.a.mark(5798);Lb.App.oa.za.isEditingAllowed||Lb.App.oa.za.hu||d.gj?
a=Qd.SelectionEditor.iGc(z):(ic.FocusManager.instance().Wv(Ec.AFrame.ao),a=ye.SelectionFactory.FWe(d.xc));if(!a)return 8;this.ajf&&!z.Yqa&&k.ULS.sendTraceTag(39098305,324,50,"Progress selection start");n&&this.yNm.aJa(Qd.SelectionEditor.Gwe(a))?n=n(d):(n=new KG(d),n.zi=a,n=new Bo.a(null,Object(m.a)(this,this.Brb,"processSetSelection"),n),n.Pj("ExpandSelection"),n.run());return n.inProgress?1:32}Khl(a,d,n,z,O){return d.view.gj?this.mkb(d,n,Object(m.a)(this,this.qFj,"startOperationOfSelectAllInOutline")):
this.juj(a,d,n,z,O)}Brb(a,d){return d.Ti?1===d.Ti?(d.Tc.Oa.vUd(d.zi,a),d.Ti=2,!0):2===d.Ti?(d.Tc.Oa.ya.Yqa=d.zi.Yqa,this.eh.$A(),d.transaction.Bha(a),d.Ti=3,d.transaction.dispose(),Mh.a.mark(5799),!0):!1:(d.transaction=this.Nb.Wb(2),d.transaction.Sa(d.Tc.xc),d.Ti=1,!0)}juj(a,d,n){if(1===n)return 32;if(!d.view.Yd)return 2;a=d.view;return a.Oa&&a.Oa.ya&&a.Oa.ya.Ba?this.qFj(a).inProgress?1:32:8}qFj(a){l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");this.ajf&&
a.gj&&k.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");a=new Bo.a(null,Object(m.a)(this,this.zVm,"processSelectAllInOutline"),new KG(a));a.Pj("SelectAllInOutline");a.run();return a}zVm(a,d){if(!d.Ti)return d.zi=ye.SelectionFactory.kuj(d.Tc.Oa.ya.Ba),d.transaction=this.Nb.Wb(2),d.transaction.Sa(d.Tc.xc),d.Ti=1,!0;if(1===d.Ti){if(!d.mmd)return d.Tc.Oa.setSelection(d.zi.J(0),a),++d.mmd,!0;if(d.mmd<d.zi.length)return d.Tc.Oa.gVh(d.zi.J(d.mmd),a),++d.mmd,!0;d.Ti=2}return 2===d.Ti?(d.Tc.Oa.ya.Yqa=
d.zi.Yqa,this.eh.$A(),d.transaction.Bha(a),d.Ti=3,d.transaction.dispose(),!0):!1}static get coa(){return eA.Vwa||(eA.Vwa=la.a.instance.resolve("Box4.ISelectionContextMenuProvider"))}static SLe(a,d,n){if(1===n)return 32;if(!d.view.Yd)return 8;a=d.view;d=ye.SelectionFactory.Tm(a.root.graphNode,!0);if(!d)return 8;a.Oa.setSelection(d);return 32}static hCj(){var a=Lb.App.oa.za.tw;if(!a.Yd)return 2;if(a.Yd&&1!==Lb.App.oa.state){Mh.a.mark(4668);var d=a.Oa.ya.Ba;if(!d&&l.AFrameworkApplication.K.ea("ContextMenuOnSelectionFixIsEnabled"))return 2;
d=Qd.SelectionEditor.gfa(d);let n=d.x,z=d.y+d.height;if(!a.container)return 8;a=Sys.UI.DomElement.getBounds(a.container);if(d.y<a.y||d.y>a.y+a.height||d.x<a.x||d.x>a.x+a.width)n=a.x,z=a.y;eA.coa.J8(new Sys.UI.Point(n,z),1);Mh.a.mark(4669)}return 32}}eA.Vwa=null;Object(t.a)(eA,"SelectAllHandlers",null,[1095]);class DK{uXe(){}}Object(t.a)(DK,"FontNameFormattingStrategyNoop",null,[1234]);var eF=b(1671),EK=b(1464);class fF{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb){this.nf=a;this.vA=d;this.Ha=O;this.D1=ca;
this.si=Da;this.Ad=Xa;this.Ja=Vb}$Zg(a,d,n,z){const O=a.$Sh(d);if(O){var ca=Object(Uc.a)(EK.a,a),Da=this.Ad.Pe("WebServiceCall",String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",ca,n)),Xa=d.Am.node,zb=()=>{n||this.A6m(d.Am,O.getId())};ca=fF.i2h();z=this.D2h(O.getId().toString(),Xa,z,n);try{a.JYh(z,d)}catch(Vb){k.ULS.sendTraceTag(572872463,3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+
Vb.message);this.jq(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);return}this.nf.Ni(ca,2,z.toString(),{},!0,0,Vb=>{k.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");a.Xqb(Vb,O,()=>{this.jq(a.mze())},zb,Xa,d,Da)},Vb=>{const Fc=415===Vb.data.Ge;a.bCa(`Graphics editor request failed. HttpStatus ${Vb.data.Ge}, ResponseData ${Vb.data.Rd}`,O,Xa,zb,()=>{this.jq(Fc?WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:
a.mze())},Da,Fc)},null)}else this.jq(a.mze())}ahn(a,d,n){return new Promise((z,O)=>{var ca=a.Am.node;ca.Zg();const Da=fF.i2h();ca=this.D2h(d.toString(),ca,n,!1);ca.Xd(eF.a.EPf,"2");this.nf.Ni(Da,2,ca.toString(),{},!0,0,Xa=>{k.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");z(Xa.data.Rd)},Xa=>{k.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Xa.data.Ge}, ResponseData ${Xa.data.Rd}`);
this.jq(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);O(null)},null)})}D2h(a,d,n,z){const O=d.Zg(),ca=new Ba.QueryStringBuilder("WordGraphicsEditorHandler.ashx");l.AFrameworkApplication.Vea(ca);ca.Xd(eF.a.strict,this.vbm(d)?"true":"false");ca.Xd(Me.a.nc,a);ca.Xd(Me.a.cellId,O.gl.toString());ca.Xd(Me.a.fileId,O.Ds);ca.Xd(Me.a.t_,n.toString());ca.Xd(eF.a.Bhl,z?"true":"false");if(a=!!this.Ja&&this.Ja.isFeatureEnabled(81))if(ca.Xd(be.a.IMg,a.toString()),a=this.Ja.isFeatureEnabled(145))ca.Xd(be.a.Hej,
a.toString()),ca.Xd(be.a.ignoreMalformedColors,this.Ja.isFeatureEnabled(93).toString());ca.Xd(be.a.PGf,"true");Xf.a.instance.ehb(ca);return ca}vbm(a){if(!this.vA)return!1;a=this.vA.kt(a);return!!a&&a.Se(Qb.a.nHe)}A6m(a,d){a.cpBegin===a.cpEnd-1&&this.si.jjc(a.node,d,this.Ha,this.D1)}jq(a){const d=new $g.StandardDialog;d.wc=0;d.aw(tl.a.cse,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,a,null);Lb.App.oa.updateCommandUI()}static i2h(){const a=new Ba.QueryStringBuilder("WordGraphicsEditorHandler.ashx");
l.AFrameworkApplication.Vea(a);return a.toString()}}Object(t.a)(fF,"GraphicsEditorRequestManager",null,[562]);class FK extends CE{constructor(a,d){super(a,d);this.Tnb=Mb.a.insertHyperlink}VGb(a){null!=a&&0<a.length&&this.Tb.ob(this.Tnb,2,a[0])}IWj(a,d,n){const z=Ih.a.yf(l.AFrameworkApplication.lcid).name;return String.format(a,l.AFrameworkApplication.lcid,z,l.AFrameworkApplication.buildVersion,d,IC.O7e,n)+"&flipgrid=1&ted=1"}}Object(t.a)(FK,"InsertHubbleMediaHelper",CE,[]);class GK{constructor(a,
d,n,z,O){this.ga=a;this.va=d;this.D8d=n;this.g$=z;this.sTb=O}lb(){this.ga.Aa(Dc.a.Rbj,Kb.a.Ub,this.iMm.bind(this),1028);this.ga.Aa(Dc.a.NNi,Kb.a.Ub,this.L5l.bind(this),1028)}L5l(a,d,n,z,O){if(1!==n){if(null==O)return 16;if(!d.Cj||!Qd.SelectionEditor.Cd(d))return 2;a=this.Pyl(O);O=O.OriginalUrl;l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.sTb.Ijh(a,d,O)}return 32}s0j(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("OnlineVideoFloodgateIsEnabled")&&
window.setTimeout(()=>{const a=la.a.instance.Ca("Common.ISystemInitiatedFeedback");a&&a.execute(d=>{d.logActivity("OnlineVideoInserted","OnlineVideoFloodgateIsEnabled")})},5E3)}Pyl(a){const d=new yz;d.MediaType=a.ContentType;d.Height=a.Height;d.Width=a.Width;d.IFrameHtml=a.Html;d.Title=a.Caption;d.Thumbnail=a.ThumbnailUrl;return d}iMm(a,d,n){if(1!==n)d=w.a.IR(this.va.Ga("UserId")).toString(),d=this.g$.IWj(this.va.appSettings.InsertVideoHubbleEndpoint,xa.a.create().toString(),d),this.g$.Tnb=Dc.a.NNi,
d=this.D8d.Wud(d,!0),d.correlationId=xa.a.create(),d.Ysa=5,d.BZe(null,this.g$),R.a.sendTelemetryEvent(Object.assign(new ha.a,{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new ba.a,{name:"ActionId",int64:a})]})),this.s0j();else if(!(d&&d.node&&zz.a(d.node)))return 2;return 32}}Object(t.a)(GK,"OnlineMediaActor",null,[]);class HK extends AE{constructor(a,d,n,z=null,O=!1){super(a,d,n,z,O);this.S2c=null}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}Ysd(){const a=
{};a.insertMediaServiceEndpoint=this.E8d;a.iFrameId="mediaiframe";return a}BZe(a,d){this.Wrc=a;this.S2c=d;this.m1c=!1;a={["id"]:"OnlineMediaDialog",["bodyControls"]:this.Ysd(),["componentIsVisibleCallback"]:this.JZj.bind(this)};this.Ih(this.Wrc,null,a)}JZj(){this.f8=this.CFc(this.Kg("mediaiframe"));this.qL=this.fce.getInstance(this.f8.contentWindow,this.E8d);this.qL.Nt(D.a.hBf,a=>{this.e8i(a,this.S2c.VGb.bind(this.S2c))});this.qL.Nt(D.a.insert,a=>{this.cOe(a,this.S2c.VGb.bind(this.S2c))});this.qL.Nt(D.a.A7f,
this.E9i.bind(this));this.qL.Nt(D.a.getSessionId,this.H9i.bind(this));this.qL.Nt(D.a.Y5f,this.D9i.bind(this));this.qL.Nt(D.a.Njd,this.M8i.bind(this));this.LMb(3)}LMb(a){const d=[];Array.add(d,Object.assign(new ba.a,{name:"DialogResult",string:HC[a]}));Array.add(d,Object.assign(new ba.a,{name:"DialogMode",string:this.e$f()}));Array.add(d,Object.assign(new ba.a,{name:"CorrelationId",string:this.correlationId.toString()}));Array.add(d,Object.assign(new ba.a,{name:"Provider",string:UA[this.Ysa]||"Unknown"}));
R.a.sendTelemetryEvent(Object.assign(new ha.a,{name:this.telemetryEventName,dataFields:d}))}}Object(t.a)(HK,"OnlineMediaDialog",AE,[]);class IK{constructor(a,d){this.oif=a;this.g$=d}Wud(a,d=!1){return new HK(a,this.oif,this.g$,null,d)}getInstance(){throw Error.notImplemented();}}Object(t.a)(IK,"OnlineMediaDialogFactory",null,[565]);class JK extends Po{constructor(){super(1,3);this.GT=la.a.instance.resolve("Common.IReactContextualUILauncher");this.rIj=!1}j9a(){l.AFrameworkApplication.pa.processAction(Dc.a.bTc,
2)}Use(){this.Hpi&&!this.ut&&(this.ut=this.ipa())}Ate(){if(this.ut&&this.ut.isVisible){var a=Object(qa.a)(Ri.Control,this.ut.controls["ExternalContentFloatie.FlyoutAnchor"]);a.behavior.mz(a.yFb(),1,null)}a=document.getElementById("ExternalContentFloatieFlyout");if(null==a)k.ULS.shipAssertTag(555816415,324,!1,"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");else{var d=a.getBoundingClientRect();0<d.top&&d.bottom<window.innerHeight&&(d=a.getAttribute(pd.a.Mhd)||
"",pd.a.yL===d&&a.click())}}PIa(){return this.GT.PIa}}Object(t.a)(JK,"ExternalContentFloatieManager",Po,[]);class tr{constructor(){this.Xb=null;tr.R3l()}get gb(){return this.Xb||(this.Xb=la.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get key(){return"FORMATTING_PARAGRAPH"}get jz(){return null}$Uc(a){var d=null;if(!Bd.ParagraphReader.Zf(a))return{returnValue:!1,Bya:d};if((a=this.gb.im(a.currentNode))&&2===this.gb.Mv(a)){const n=this.gb.Jd(a);tr.XW.contains(n)&&(d=this.gb.Lv(a),d=Object.assign(new ri.a,
{PK:this.key,contentId:a.id,contentObject:d}))}return{returnValue:!!d,Bya:d}}Z8b(a,d){let n=null;d&&a.contentId.equals(d.contentId)||(n=a.contentObject);return n}static R3l(){tr.XW=new hl.a;tr.XW.add(Gh.StyleReader.styleIdHeading1);tr.XW.add(Gh.StyleReader.styleIdHeading2);tr.XW.add(Gh.StyleReader.styleIdHeading3);tr.XW.add(Gh.StyleReader.M8);tr.XW.add(Gh.StyleReader.Xha);tr.XW.add(Gh.StyleReader.Yha);tr.XW.add(Gh.StyleReader.v9a);tr.XW.add(Gh.StyleReader.cua);tr.XW.add(Gh.StyleReader.wordStyleIdHeading1);
tr.XW.add(Gh.StyleReader.wordStyleIdHeading2);tr.XW.add(Gh.StyleReader.wordStyleIdHeading3);tr.XW.add(Gh.StyleReader.aEa);tr.XW.add(Gh.StyleReader.bEa);tr.XW.add(Gh.StyleReader.cEa);tr.XW.add(Gh.StyleReader.RLa);tr.XW.add(Gh.StyleReader.SLa);tr.XW.add(Gh.StyleReader.dEa);tr.XW.add(Gh.StyleReader.JPb);tr.XW.add(Gh.StyleReader.wpc)}}tr.XW=null;Object(t.a)(tr,"ParagraphStyleDetailsProvider",null,[506,288]);class KK{constructor(a,d,n,z){this.i0a=a;this.Iek=d;this.Oek=n;this.Pek=z}XSg(){this.i0a.execute(a=>
{a.lQc(this.Iek.value);a.lQc(new tr);a.lQc(this.Pek.value);a.Pca(this.Oek.value)})}}Object(t.a)(KK,"AccessibilityActor",null,[]);class LK{constructor(a,d,n){this.$d=null;this.ga=a;this.Yxb=d;this.ib=n}lb(){if(l.AFrameworkApplication.K.ea("UIDiscoverabilityEnabled")){var a=gb.KeyInputManager.$a(xb.a.kEa,5);this.ib.Kc(Ec.AFrame.ao).zq(a);this.ib.Kc(Ec.AFrame.hp).bindAction(a,Sa.a.YSc);this.ga.ma(Sa.a.YSc,Cd.a.frame,Object(m.a)(this,this.YSc,"showAccessibilityHelpDialog"));this.ga.ma(Sa.a.Rxc,Cd.a.frame,
Object(m.a)(this,this.KSh,"accHelpDialogTabFocusHandler"));this.ga.ma(Sa.a.Qxc,Cd.a.frame,Object(m.a)(this,this.KSh,"accHelpDialogTabFocusHandler"))}}YSc(a,d,n){if(1===n)return 32;this.$d=this.Yxb.value.HZk(this.ib);if(!this.$d)return k.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),8;this.$d.h9a();return 32}KSh(a){return this.$d?this.$d.yXl(a):2}}Object(t.a)(LK,"AccessibilityHelpDialogActor",null,[]);var JP=b(916),KP=b(1218);class MK{constructor(a,d){this.B2c=a.jb("WordHangForActionManagerThresholdTime",
750);this.ga=d;this.H1j=JP.a.QB(26,5,new KP.a)}b5(){this.ga.b5(this)}n8(){}m8(a){const d=+a.endTime-+a.startTime;if(d>this.B2c){let n="";switch(a.behavior){case 1:n="E";break;case 2:n="X";break;case 3:n="A"}(a=Bc.ActionManager.haa(a.actionId))&&a.length||(a="UnknownAction");this.H1j.track(d,a+"_"+n)}}}Object(t.a)(MK,"ActionHangDetector",null,[33]);var LP=b(560);class LG{constructor(a,d){this.lhf=this.npa=null;this.ga=a;this.QNa=d;if(this.uyg=l.AFrameworkApplication.K.ea("HandleRaceConditionInHostManagerInit"))this.lhf=
LP.a.create();this.ty=la.a.instance.Ca("Common.ISystemInitiatedFeedback")}get $_(){return this.npa}lb(){this.ga.Aa(Sa.a.close,Cd.a.frame,Object(m.a)(this,this.closeDocument,"closeDocument"),2176);this.ga.Aa(Sa.a.X7b,Cd.a.frame,Object(m.a)(this,this.X7b,"fileProperties"),128);this.ga.ma(Sa.a.wkb,Cd.a.frame,Object(m.a)(this,this.wkb,"fileSharing"));this.ga.Aa(Sa.a.copyAndEdit,Cd.a.frame,Object(m.a)(this,this.copyAndEdit,"copyAndEdit"),128);this.ga.Aa(Sa.a.ssb,Cd.a.frame,Object(m.a)(this,this.ssb,"replyWithChanges"),
128);this.ga.Aa(Sa.a.x5g,Cd.a.frame,Object(m.a)(this,this.Mni,"fileVersion"),128);this.ga.ma(Sa.a.downloadACopy,Cd.a.frame,Object(m.a)(this,this.downloadACopy,"downloadACopy"));this.ga.ma(Sa.a.gYf,Cd.a.frame,Bc.ActionManager.Ke);this.ga.Aa(Sa.a.ZUe,Cd.a.frame,Object(m.a)(this,this.ZUe,"reportAbuseLink"),128);this.ga.Aa(Sa.a.Cmc,Cd.a.frame,Object(m.a)(this,this.XVd,"signInInternal"),128);this.ga.ma(Sa.a.workflow,Cd.a.frame,Object(m.a)(this,this.workflow,"workflow"));l.AFrameworkApplication.K.ea("DocumentNameInJewelInfoMenuIsEnabled")&&
this.ga.Aa(Sa.a.lSe,Cd.a.frame,Object(m.a)(this,this.lSe,"queryBreadcrumbDocName"),96);this.ga.Aa(Sa.a.pSe,Cd.a.frame,Object(m.a)(this,this.pSe,"queryCopyAndEditButton"),96);l.AFrameworkApplication.K.ea("DiagnosticsInfoInJewelAboutMenuIsEnabled")&&(this.ga.Aa(Sa.a.ZNd,Cd.a.frame,Object(m.a)(this,this.ZNd,"queryBuildVersion"),2144),this.ga.Aa(Sa.a.yOd,Cd.a.frame,Object(m.a)(this,this.yOd,"querySessionId"),2144));this.ga.ma(Sa.a.lDb,Cd.a.frame,Object(m.a)(this,this.lDb,"conversation"));this.QNa.execute(Object(m.a)(this,
this.uHg,"onHostPostmessengerCreated"));k.ULS.sendTraceTag(536987588,306,50,"WebAppFrameCommandUIActor-RegisterActions done.")}uHg(a){this.npa=a;this.uyg&&(this.lhf.instance=a);k.ULS.sendTraceTag(536987589,306,this.$_?50:10,String.format("OnHostPostmessengerCreated - Setting OnHostPostmessengerCreated as null value = {0}",!this.$_))}Uqm(){l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateSharingComplexity",!1)&&this.ty&&this.ty.execute(a=>{a.logActivity("CollabCornerSurveyLogSharingCommandActivity",
"CollabCornerFloodgateSurveysIsEnabled")})}closeDocument(a,d,n,z,O){a=2===n;n=el.h;O&&(n=O);return d&&a&&!this.Hke(n)?8:this.PTk(a,n)}Hke(){return!0}PTk(a,d){if(l.AFrameworkApplication.la.eb.SYe("3033402446"))return k.ULS.sendTraceTag(41231952,306,50,"CloseDocumentInternal - Sending FileClose postMessage to give the host control of closing the page"),this.JKa(a,D.a.l1f,!0,{});if(l.AFrameworkApplication.Ajc&&d&&d===el.f)return k.ULS.sendTraceTag(6070357,306,50,"CloseDocumentInternal - navigating to ReportAbuseUrl"),
l.AFrameworkApplication.la.j8(a,l.AFrameworkApplication.Ajc);if(l.AFrameworkApplication.yma)return a&&k.ULS.sendTraceTag(6070358,306,50,"CloseDocumentInternal - cannot close because application is embedded"),8;if(l.AFrameworkApplication.lne){if(!a)return 32;k.ULS.sendTraceTag(6070359,306,50,"CloseDocumentInternal - closing the window");try{return window.top.close(),32}catch(O){return k.ULS.sendTraceTag(6070360,306,10,"CloseDocumentInternal - encountered unexpected exception: {0}",O),8}}let n=l.AFrameworkApplication.ZCb;
if(!n)return a&&k.ULS.sendTraceTag(6070361,306,50,"CloseDocumentInternal - no closeUrl found"),8;d||(d=el.h);if(d===el.c||d===el.h)return l.AFrameworkApplication.la.j8(a,n);let z;if(l.AFrameworkApplication.v8a)return a&&k.ULS.sendTraceTag(6070362,306,50,"CloseDocumentInternal - Using ReplyWithChanges postmessage"),z=d===el.d||d===el.b?this.JKa(a,D.a.ssb,l.AFrameworkApplication.Voc,{["event_source"]:d}):2,32!==z?(n=d?Vc.a.Qm(l.AFrameworkApplication.v8a,el.e,d):l.AFrameworkApplication.v8a,l.AFrameworkApplication.la.j8(a,
n)):z;a&&k.ULS.sendTraceTag(6070363,306,50,"CloseDocumentInternal - Using FileClose postmessage");z=d===el.b?this.JKa(a,D.a.l1f,l.AFrameworkApplication.HVc,null):2;return 32!==z?l.AFrameworkApplication.la.j8(a,n):z}XVd(a,d,n,z,O){a=this.JKa(2===n,D.a.Cmc,!0,O);8===a&&(window.top.location=l.AFrameworkApplication.signInUrl,a=32);return a}X7b(a,d,n){a=this.JKa(2===n,D.a.X7b,l.AFrameworkApplication.a4e,null);return 32!==a?l.AFrameworkApplication.la.j8(2===n,l.AFrameworkApplication.due):a}wkb(a,d,n,z,
O){if(1===n)return Yb.SessionStatusManager.instance.oj?8:32;a=Sa.a.hAj;d=xa.a.create().toString();z={};z.event_source=O;z[G.a.LSc]=d;var ca=O?O.nav:null;ca&&(z[G.a.kAj]=ca);O&&"CopyLink"===O.SourceControlId&&(O.mode="copy",a=Sa.a.gAj);O&&"ManageAccess"===O.SourceControlId&&(O.mode="manageAccess",a=Sa.a.iAj);(ca=O?O.mode:null)&&(z[G.a.jAj]=ca);if(2===n){const Da={};Da[G.a.LSc]=d;ca&&(Da.mode=ca);k.ULS.sendTraceTag(38278995,306,50,x.c(Da));this.Uqm()}d=this.JKa(2===n,D.a.sAj,l.AFrameworkApplication.IVc,
z);if(32!==d){if(l.AFrameworkApplication.MEb)return O=O?Vc.a.Qm(l.AFrameworkApplication.MEb,el.e,O):l.AFrameworkApplication.MEb,l.AFrameworkApplication.la.j8(2===n,O,!0);k.ULS.sendTraceTag(7985242,306,50,"Sharing PostMessage didn't succeed but there is no FileSharingURL to fallback to.",{["Result"]:d})}we.c(a);return d}lDb(a,d,n){return this.JKa(2===n,D.a.lDb,!0,{})}workflow(a,d,n){a=this.JKa(2===n,D.a.workflow,l.AFrameworkApplication.KVc,{["WorkflowType"]:l.AFrameworkApplication.zpc});if(32!==a){if(l.AFrameworkApplication.Apc)return l.AFrameworkApplication.la.j8(2===
n,l.AFrameworkApplication.Apc,!0);k.ULS.sendTraceTag(19781538,306,50,"Workflow PostMessage didn't succeed.",{["Result"]:a})}return a}ZUe(a,d,n){a=2===n;return d&&a&&!this.Hke(el.f)?8:l.AFrameworkApplication.la.j8(a,l.AFrameworkApplication.Ajc)}copyAndEdit(a,d,n){a={};2===n&&(a=l.AFrameworkApplication.la.eb.zwe());a=this.JKa(2===n,D.a.copyAndEdit,l.AFrameworkApplication.W3e,a);return 32!==a?l.AFrameworkApplication.la.j8(2===n,l.AFrameworkApplication.CBc,l.AFrameworkApplication.hideHeader):a}downloadACopy(a,
d,n){return 1===n?l.AFrameworkApplication.WS||l.AFrameworkApplication.wsa||Yb.SessionStatusManager.instance.oj?8:32:l.AFrameworkApplication.la.j8(2===n,l.AFrameworkApplication.J3a,!0)}ssb(a,d,n){a=2===n;if(d&&a&&!this.Hke(el.d))return 8;d=this.JKa(a,D.a.ssb,l.AFrameworkApplication.Voc,{["event_source"]:el.d});return 32!==d?(d=Vc.a.Qm(l.AFrameworkApplication.v8a,el.e,el.d),l.AFrameworkApplication.la.j8(a,d)):d}Mni(a,d,n){a=this.JKa(2===n,D.a.Nni,l.AFrameworkApplication.o0d,null);return 32!==a?l.AFrameworkApplication.la.j8(2===
n,l.AFrameworkApplication.rrd):a}lSe(a,d,n,z,O){if(2===n){if(!O)return 8;O.Value=w.a.HN(l.AFrameworkApplication.Bs.EB)}return 32}ZNd(a,d,n,z,O){if(2===n){if(!O)return 8;O.Text=l.AFrameworkApplication.instance.ugi}return 32}yOd(a,d,n,z,O){if(2===n){if(!O)return 8;O.Text=l.AFrameworkApplication.instance.vgi}return 32}JKa(a,d,n,z){return this.uyg?this.rhn(a,d,n,z):n?a?this.$_.Eh(d,z)?32:8:32:2}rhn(a,d,n,z){return n?a?this.$_?this.$_.Eh(d,z)?32:8:(k.ULS.sendTraceTag(528234241,306,15,"SendPostmessage called when HostPostmessenger was not initialized yet.Queueing the request."),
this.lhf.execute(()=>{k.ULS.sendTraceTag(528234242,306,50,"HostPostmessenger now available. Executing the request.");this.$_.Eh(d,z)}),32):32:2}pSe(a,d,n,z,O){if(2===n){if(!O)return 8;l.AFrameworkApplication.K.ea("IsEditAndReplyFlow")&&(O.LabelText=CommonUIStrings.l_EditAndReply)}return 32}}Object(t.a)(LG,"WebAppFrameCommandUIActor",null,[]);var gF;(function(a){a[a.Unknown=0]="Unknown";a[a.Excel=1]="Excel";a[a.OneNote=2]="OneNote";a[a.PowerPoint=3]="PowerPoint";a[a.Visio=4]="Visio";a[a.Word=5]="Word";
a[a.Project=6]="Project";a[a.Publisher=7]="Publisher";a[a.Infopath=8]="Infopath";a[a.Access=9]="Access"})(gF||(gF={}));Object(t.b)("OfficeApplication",gF);var XD;(function(a){a[a.ReadWrite=0]="ReadWrite";a[a.ReadOnly=1]="ReadOnly";a[a.WriteOnly=2]="WriteOnly";a[a.ForceCheckout=3]="ForceCheckout";a[a.WriteLocalCopy=4]="WriteLocalCopy";a[a.OpenInBrowser=5]="OpenInBrowser"})(XD||(XD={}));Object(t.b)("OpenDocumentMode",XD);class NK extends hf{constructor(a){super(a,void 0,l.AFrameworkApplication.zSa,
new Of(a,!1))}get lqb(){return CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get PLc(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get kGd(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get Hnd(){return l.AFrameworkApplication.zSa?"UIFontDialogTextLarge":null}Wwg(){k.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed")}Xwg(){k.ULS.sendTraceTag(7690389,324,50,"Download a copy dialog clicked")}RGd(){k.ULS.sendTraceTag(19462214,
324,50,"Download a copy dialog button clicked");l.AFrameworkApplication.pa.processAction(Sa.a.gYf,2)}}Object(t.a)(NK,"DownloadACopyDialog",hf,[]);var OK=b(1579);const UC=a=>{for(let d=0;d<a.children.length;d++){const n=a.children[d];n.style.position="relative";n.style.top=(n.parentNode.offsetHeight-n.offsetHeight)/2+"px"}},hF=a=>a.Ua.keyCode===xb.a.Ms||a.Ua.keyCode===xb.a.Eua?(a.Ec.click(),!0):!1,YD=(a,d,n,z,O,ca,Da)=>{const Xa=document.createElement("a");Xa.className="ProtocolLaunchingDialogButtonAnchor";
Xa.className+=" OICDialog";Xa.id=a;Xa.setAttribute(pd.a.ig,pd.a.l3);Xa.style.padding="0";Xa.style.margin="0";z&&PK(O,d,n,z,Xa);a=document.createElement("span");a.className="ProtocolLaunchingDialogButtonLabel";a.innerText=O;Xa.appendChild(a);Xa.tabIndex=0;ca&&Ae.a.instance.Ea(vb.a.click,Xa,ca);Da&&gb.KeyInputManager.instance.Ea(vb.a.Of,Xa,Da);return Xa},PK=(a,d,n,z,O)=>{var ca=document.createElement("img");ca.alt=a;ca.className=Vf.getImageClassWithCluster(n,z);ca.src=d;ca.setAttribute(pd.a.ig,pd.a.Ix);
a=document.createElement("span");a.className="ProtocolLaunchingDialogImg32Container";a.appendChild(ca);ca=document.createElement("span");ca.className="ProtocolLaunchingDialogIconContainer";ca.appendChild(a);O.appendChild(ca)};class iF{static get Lf(){return xg.a.oz(iF.fm,CommonUIStrings.l_OICLaunchDialogTitle)}}iF.fm="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(t.a)(iF,"OICLaunchDialogHtml",null,[]);class QK extends xg.a{constructor(a){super();this.Cqc=this.UQb=null;this.wZ=!1;this.tr=a;this.Lf=iF.Lf;this.wc=5;this.Je="OICLaunchDialog";this.showDialog("",Object(m.a)(this,this.EBm,"oicLaunchDialogResultHandler"));this.d1g("ProtocolLaunchingDialogTitle");this.k5("ProtocolLaunchingDialogTitle");4!==l.AFrameworkApplication.la.eb.jra&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.$Y(this.UQb);
k.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}rV(){this.UQb=YD("BtnRichClient",this.tr.lpd,this.tr.vzd,this.tr.Eig,CommonUIStrings.l_OICLaunchRichClient,Object(m.a)(this,this.xaj,"onRichClientButtonClick"),hF);document.getElementById("OICLaunchRichClient").appendChild(this.UQb);UC(this.UQb);this.Cqc=YD("BtnReturn",this.tr.lpd,this.tr.vzd,this.tr.TLi,CommonUIStrings.l_OICReturnToOnlineClient,Object(m.a)(this,this.taj,
"onReturnButtonClick"),hF);document.getElementById("OICReturnToApp").appendChild(this.Cqc);UC(this.Cqc)}taj(){this.hide();this.tr.ZQc();return!0}xaj(){k.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();l.AFrameworkApplication.pa.processAction(Sa.a.lMb,2);return!0}EBm(){this.tr.ZQc()}dispose(){this.wZ||(this.UQb&&(Ae.a.instance.kb(vb.a.click,this.UQb,Object(m.a)(this,this.xaj,"onRichClientButtonClick")),gb.KeyInputManager.instance.kb(vb.a.Of,this.UQb,hF)),this.Cqc&&(Ae.a.instance.kb(vb.a.click,
this.Cqc,Object(m.a)(this,this.taj,"onReturnButtonClick")),gb.KeyInputManager.instance.kb(vb.a.Of,this.Cqc,hF)),super.dispose(),this.wZ=!0)}}Object(t.a)(QK,"OICLaunchDialog",xg.a,[]);class jF{static get Lf(){return xg.a.oz(jF.fm,CommonUIStrings.l_OICDialogTitle)}}jF.fm="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(t.a)(jF,"ProtocolLaunchingDialogV2Html",null,[]);class RK extends xg.a{constructor(a){super();this.Bqc=this.$$a=null;this.wZ=!1;this.mxb=null;this.tr=a;this.Lf=jF.Lf;this.wc=5;this.Je="ProtocolLaunchingDialog";this.Uxb="OICRetryDialog";l.AFrameworkApplication.tb.gAa&&l.AFrameworkApplication.tb.hMb();l.AFrameworkApplication.tb.rb(new bf.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(m.a)(this,this.EPg,"protocolLaunchingDialogResultHandler"));this.d1g("ProtocolLaunchingDialogTitle");
this.k5("Issues");this.Zpi();k.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}rV(){const a=document.getElementById("Issues");if(a){PK("",this.tr.lpd,this.tr.vzd,this.tr.Eig,a);const d=document.createElement("span");d.className="WACDialogSectionTitle";d.innerText=5===this.tr.Ibj?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;a.appendChild(d);UC(a);a.style.display="none"}l.AFrameworkApplication.la.eb.EAe?
(this.Bqc=YD("GiveFeedback",this.tr.lpd,this.tr.vzd,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(m.a)(this,this.QNe,"onGiveFeedbackClick"),Object(m.a)(this,this.J9i,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.Bqc),UC(this.Bqc)):document.getElementById("ButtonGiveFeedback").style.display="none";0===l.AFrameworkApplication.la.eb.jra||l.AFrameworkApplication.Qgi?document.getElementById("ButtonEdit").style.display="none":(this.$$a=
YD("Edit",this.tr.lpd,this.tr.vzd,"",2===l.AFrameworkApplication.la.eb.Bm?4===l.AFrameworkApplication.la.eb.jra?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===l.AFrameworkApplication.la.eb.jra?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(m.a)(this,this.o9i,"onEditClick"),Object(m.a)(this,this.s9i,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.$$a),UC(this.$$a));0===l.AFrameworkApplication.la.eb.jra&&
!l.AFrameworkApplication.LDd&&a&&(a.style.display="none")}$pi(){return this.mxb?(this.$Y(this.mxb),!0):!1}Zpi(){return this.$$a?(this.$Y(this.$$a),!0):!1}s9i(a){return this.lGg(a,0)}J9i(a){return this.lGg(a,2)}saj(a){return this.lGg(a,1)}lGg(a,d){let n=!1;if(a.Ua.keyCode===xb.a.Ms||a.Ua.keyCode===xb.a.Eua)a.Ec.click(),n=!0;else if(a.Ua.keyCode===Sys.UI.Key.down||a.Ua.keyCode===Sys.UI.Key.up)switch(d){case 1:n=this.Zpi();break;case 0:n=this.$pi()}return n}o9i(){this.hide();4===l.AFrameworkApplication.la.eb.jra?
(k.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.tr.ZQc()):(k.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.tr.I$b());return!0}QNe(){k.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}QHg(){lP.Redirect.showHelp("OICFailure");return!0}FOe(){k.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";l.AFrameworkApplication.pa.processAction(Sa.a.lMb,2);return!0}EPg(){this.tr.ZQc()}switchToBackupMode(){var a=
document.getElementById("ProtocolLaunchingDialogTitle");if(a){a.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(a=document.getElementById("Issues"))a.style.display="block";(a=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!a.children.length&&(this.mxb=YD("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(m.a)(this,this.FOe,"onRetryOICClick"),Object(m.a)(this,this.saj,"onRetryOICKeyUp")),a.appendChild(this.mxb),UC(this.mxb),this.$$a||this.$pi())}}dispose(){this.wZ||(this.$$a&&
(Ae.a.instance.kb(vb.a.click,this.$$a,Object(m.a)(this,this.o9i,"onEditClick")),gb.KeyInputManager.instance.kb(vb.a.Of,this.$$a,Object(m.a)(this,this.s9i,"onEditKeyUp"))),this.Bqc&&(Ae.a.instance.kb(vb.a.click,this.Bqc,Object(m.a)(this,this.QNe,"onGiveFeedbackClick")),gb.KeyInputManager.instance.kb(vb.a.Of,this.Bqc,Object(m.a)(this,this.J9i,"onGiveFeedbackKeyUp"))),this.mxb&&(Ae.a.instance.kb(vb.a.click,this.mxb,Object(m.a)(this,this.FOe,"onRetryOICClick")),gb.KeyInputManager.instance.kb(vb.a.Of,
this.mxb,Object(m.a)(this,this.saj,"onRetryOICKeyUp"))),super.dispose(),this.wZ=!0)}}Object(t.a)(RK,"ProtocolLaunchingDialog",xg.a,[]);class kF extends $g.StandardDialog{constructor(a){super();this.tr=a;this.Je="ProtocolLaunchingDialog";l.AFrameworkApplication.tb.gAa&&l.AFrameworkApplication.tb.hMb();l.AFrameworkApplication.la.eb.EAe&&this.kUh(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(m.a)(this,this.QNe,"onGiveFeedbackClick"));kF.TIi?(this.wc=12,this.ee(1,CommonUIStrings.l_CloseFile),
this.ee(2,CommonUIStrings.l_OICDialogContinueHere),this.ee(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.wc=4,this.ee(1,CommonUIStrings.l_OICDialogContinueHere),this.ee(2,CommonUIStrings.l_OICDialogLaunchAgain));this.P6a(CommonUIStrings.l_OICDialog2ndTitle,5===this.tr.Ibj?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(m.a)(this,this.EPg,"protocolLaunchingDialogResultHandler"),null)}QNe(a){k.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");
this.LNe(a)}FOe(){k.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");l.AFrameworkApplication.pa.processAction(Sa.a.lMb,2)}EPg(a){kF.TIi?3===a?this.wrj():2===a||0===a?this.continueEditing():1===a&&this.closeDocument():2===a?this.wrj():(1===a||0===a)&&this.continueEditing()}closeDocument(){k.ULS.sendTraceTag(577783557,211,50,"Closing the document");l.AFrameworkApplication.pa.ob(Sa.a.close,2,el.a)}wrj(){k.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(m.a)(this,this.FOe,
"onRetryOICClick"),0)}continueEditing(){4===l.AFrameworkApplication.la.eb.jra||l.AFrameworkApplication.K.ea("WordConsumptionViewToEditRedirectIsEnabled")&&1===l.AFrameworkApplication.la.mode?(k.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.tr.ZQc()):(k.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.tr.I$b())}static get TIi(){return l.AFrameworkApplication.K.ea("OICDialogThreeActions")&&32===l.AFrameworkApplication.pa.processAction(Sa.a.close,
1)}}Object(t.a)(kF,"StandardProtocolLaunchingDialog",$g.StandardDialog,[]);class SK{}Object(t.a)(SK,"EditDocumentInClientParams",null,[]);class MG{static Wii(a,d,n,z,O,ca,Da=!1,Xa=!1,zb="",Vb=!1,Fc=!1,Yc=!1,yd="",je="",Le="",Ve=!1){const gg=new SK;gg.DocumentUrl=a;gg.Mode=d;gg.Options=n;gg.Application=z;gg.SilentExternalHandler=Da;gg.EncodeUrl=Xa;gg.CorrelationIdForWinClient=zb;gg.NavigateUsingWindowOpen=Vb;gg.DescriptiveUnattemptedEnums=Fc;gg.NoBrowserModalDialogs=Yc;gg.SessionOrigin=yd;gg.CorrelationId=
je;gg.ClickTime=Le;gg.NewTelemetryDataIsEnabled=Ve;MSOJS.ClientUtils.EditDocumentInClient(gg,O,ca)}}Object(t.a)(MG,"ClientUtils",null,[]);var TK=b(844);class fA{constructor(a){this.peb=this.B0c=this.dZc=null;this.T1c=!1;this.Ymf=this.jHh=null;this.Q3d=this.G9=this.eee="";this.application=this.Tw=0;this.jBn=this.Z8g=!1;this.qQn=a&&l.AFrameworkApplication.K.ea("OICLaunchDialogIsEnabled");l.AFrameworkApplication.pa.OX(Sa.a.lMb)||l.AFrameworkApplication.pa.ma(Sa.a.lMb,Cd.a.frame,Object(m.a)(this,this.ucn,
"retryOpenInClientAction"));this.zDj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("SilentExternalHandler")}get Ibj(){return this.Tw}$zm(){let a,d;if(!l.AFrameworkApplication.K)return 0;switch((l.AFrameworkApplication.K.Ga(l.AFrameworkApplication.vda)||"").toLowerCase()){case "teams":a=524288;break;case "onedrive":a=131072;break;case "owa":a=262144;break;case "assignments":a=65536;break;default:a=0}switch((l.AFrameworkApplication.K.Ga("FileSource")||"").toLowerCase()){case "exchangeonline":d=
1;break;case "exchangeonlineconsumer":d=2;break;case "onedrivewopi":d=4;break;case "sharepointonline":d=8;break;default:d=0}return d|a}ucn(a,d,n){return d.contextId!==Cd.a.frame?2:1===n?32:this.lMb()}get options(){let a=0;l.AFrameworkApplication.wqj&&(a|=1);l.AFrameworkApplication.vPe&&(a|=4);this.eBn()&&(a|=64);return a}eBn(){return!(2===this.application&&l.AFrameworkApplication.K.ea("IsEmbeddedScenario"))}get lpd(){return l.AFrameworkApplication.ln}get vzd(){return l.AFrameworkApplication.YL}get TLi(){return""}get Eig(){return""}get iBn(){return l.AFrameworkApplication.K.ea("OneNoteMobileViewerIsEnabled")}get uDn(){return this.jHh||
(this.jHh=la.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.Z8g||this.fhl()}ZQc(){this.jBn||this.cmi()}Vjj(a){return this.qQn&&I.a.tg?(new QK(this),32):this.p9h(a)}p9h(a){const d=({cPb:a}=this.ujm(a)).returnValue;k.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===d,a);return d}begin(a,d,n,z,O,ca){this.dZc=a;this.B0c=d;this.peb=ca;this.application=n;this.Tw=z;return l.AFrameworkApplication.Tre?(this.YWi(),32):l.AFrameworkApplication.Ksa&&!l.AFrameworkApplication.KCe?
(l.AFrameworkApplication.PZe(),8):this.w0h(O)}get DBm(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}lMb(){this.DBm&&this.lmm();return this.p9h(this.T1c)}cvj(){const a=new TK.a(D.a.openInClient);a.Values["ui-language"]=l.AFrameworkApplication.lcid.toString();a.Values[GC.a.mei]=l.AFrameworkApplication.userSessionId;return this.peb.value.send(a)?32:8}lmm(){ja.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Pa.a,{inStaging:!0}))}Chn(a){const d=new TK.a(D.a.lSj);d.Values["ui-language"]=l.AFrameworkApplication.lcid.toString();d.Values[GC.a.mei]=l.AFrameworkApplication.userSessionId;d.Values[G.a.kSj]=a;this.peb.value.send(d)}ujm(a){this.T1c=a;this.Chn(5===this.Tw?fA.bMm:fA.dMm);return 5===this.Tw?this.sjm():this.xjm()}sjm(){this.hXi();return{returnValue:32,cPb:"HostEditUrl,"}}xjm(){let a;var d=a="";l.AFrameworkApplication.qie&&(d="|f|"+l.AFrameworkApplication.userSessionId);
const n=l.AFrameworkApplication.K.ea("IsAssignmentMode")&&l.AFrameworkApplication.K.ea("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||l.AFrameworkApplication.ldc||I.a.hBa,z=l.AFrameworkApplication.K.ea("UnattemptedEnumIsEnabled"),O=l.AFrameworkApplication.K.ea("NoBrowserModalDialogs");if(l.AFrameworkApplication.pa.YMc){var ca=l.AFrameworkApplication.pa.fma(3588168074);ca&&(this.eee=String.format("{0}{1}{2}",fA.oin.toString(),"_",this.$zm().toString()),this.G9=ca.correlationId?ca.correlationId:
"",this.Q3d=ca.TriggerTime?ca.TriggerTime:"")}if(l.AFrameworkApplication.ARe){a+="NewOrder,";ca=8;this.peb&&this.peb.value&&this.peb.value.isEnabled()&&l.AFrameworkApplication.Svb&&(a+="Post,",ca=this.cvj());if(32===ca)return{returnValue:ca,cPb:a};k.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return l.AFrameworkApplication.Bs.Dca?(k.ULS.shipAssertTag(5566816,211,!!l.AFrameworkApplication.Bs.Dca),a+="HostUrl,",{returnValue:l.AFrameworkApplication.la.j8(!0,
l.AFrameworkApplication.Bs.Dca),cPb:a}):this.dZc?(k.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",l.AFrameworkApplication.userSessionId),a+="DocUrl,",MG.Wii(this.dZc,this.Tw,this.options,this.application,Object(m.a)(this,this.r9i,"onEditInClientSuccess"),Object(m.a)(this,this.q9i,"onEditInClientFailure"),this.zDj,l.AFrameworkApplication.K.ea("OICEncodeUrlIsEnabled"),d,n,z,O,this.eee,this.G9,this.Q3d,l.AFrameworkApplication.pa.YMc),{returnValue:32,cPb:a}):{returnValue:8,
cPb:a}}a+="OldOrder,";if(!this.dZc&&l.AFrameworkApplication.Bs.Dca)return this.peb&&this.peb.value&&this.peb.value.isEnabled()&&l.AFrameworkApplication.Svb?(a+="Post,",d=this.cvj()):(k.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),d=8),32!==d?(k.ULS.shipAssertTag(22595484,211,!!l.AFrameworkApplication.Bs.Dca),a+="HostUrl,",{returnValue:l.AFrameworkApplication.la.j8(!0,l.AFrameworkApplication.Bs.Dca),cPb:a}):{returnValue:d,cPb:a};k.ULS.sendTraceTag(22595485,
211,15,"Try to open doc in rich client, SessionId {0}",l.AFrameworkApplication.userSessionId);a+="DocUrl,";MG.Wii(this.dZc,this.Tw,this.options,this.application,Object(m.a)(this,this.r9i,"onEditInClientSuccess"),Object(m.a)(this,this.q9i,"onEditInClientFailure"),this.zDj,l.AFrameworkApplication.K.ea("OICEncodeUrlIsEnabled"),d,n,z,O,this.eee,this.G9,this.Q3d,l.AFrameworkApplication.pa.YMc);return{returnValue:32,cPb:a}}y$m(a){l.AFrameworkApplication.ug.setDw(8981,a)}r9i(a){this.y$m(a);k.ULS.sendTraceTag(18715406,
211,50,"Open in rich client succeed");6===a&&MSOJS.ClientUtils.ShouldShowDialog()?(this.iBn||this.hXi(),this.zpm()):this.Z8g||this.closeApplication()}q9i(a,d=0){k.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",a,d);if(5===a)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const n=!!this.B0c&&!this.T1c;let z=0;1===a&&(z=2);6<=a&&13>=a&&(z=1,1===d&&(this.Z8g=!0));this.uDn.tBm?(k.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",
z),OK.a.instance.M2k(this.T1c?Object(m.a)(this,this.S7i,"oicErrorDialogHandlerCloseForced"):Object(m.a)(this,this.T7i,"oicErrorDialogHandlerNoCloseForced"),n?Object(m.a)(this,this.f$i,"onLaunchDownload"):null,this.Ogi(!1)?Object(m.a)(this,this.t0l,"iHaveOfficeButtonHandler"):null,z,d)):(k.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",z),OK.a.instance.K2k(this.T1c?Object(m.a)(this,this.S7i,"oicErrorDialogHandlerCloseForced"):Object(m.a)(this,this.T7i,"oicErrorDialogHandlerNoCloseForced"),
n?Object(m.a)(this,this.f$i,"onLaunchDownload"):null,z))}}zpm(){try{const a=[Object.assign(new ba.a,{name:"CorrelationId",string:this.G9}),Object.assign(new ba.a,{name:"SessionOrigin",string:this.eee}),Object.assign(new ba.a,{name:"ClickTime",string:this.Q3d}),Object.assign(new ba.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];we.a("OpenInClientCompleted",!0,0,a)}catch(a){k.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+a.toString())}}hXi(){l.AFrameworkApplication.la&&
l.AFrameworkApplication.la.eb.wz&&l.AFrameworkApplication.K.ea("StandardProtocolDialogIsEnabled")?new kF(this):new RK(this)}S7i(){this.closeApplication()}T7i(){this.ZQc()}f$i(){this.YWi()}t0l(){return this.Ogi(!0)}Ogi(a){const d=(I.a.usa||I.a.xm)&&!!l.AFrameworkApplication.VCc;d&&a&&(Ye.a.Tk(l.AFrameworkApplication.VCc,"_blank",void 0,"OpenInClient"),this.closeApplication());return d}}fA.dMm="OpenInDesktop";fA.bMm="OpenInBrowser";fA.oin=xa.a.qe("B5F65EF9-A5B1-4887-A968-C779537C8303");Object(t.a)(fA,
"AOpenInClientOperation",null,[]);class NG extends fA{constructor(a,d,n=!1){super(n);this.vbk=a;this.ubk=d}get TLi(){return this.ubk}get Eig(){return this.vbk}fhl(){l.AFrameworkApplication.pa.ob(Sa.a.close,2,el.a)}cmi(){}w0h(a){return this.Vjj(a)}YWi(){k.ULS.shipAssertTag(5566817,211,!!this.B0c);l.AFrameworkApplication.kY?l.AFrameworkApplication.la.j8(!0,this.B0c):Ye.a.Tk(this.B0c,void 0,void 0,"LaunchDownload")}I$b(){l.AFrameworkApplication.la.eb.I$b()}}Object(t.a)(NG,"OpenInClientOperation",fA,
[]);class UK extends NG{constructor(){super("Word_32x32x32","EditInWordWebApp_32x32x32",!0)}TGk(a){Lb.App.jj.a7a.eY||Lb.App.lc.oC.Gp?(k.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.Wbj(a)):Mw.a.LX(4,!0,Object(m.a)(this,this.p5m,"releaseLockOnSuccess"),null,a)}p5m(a){k.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");Lb.App.y5.forceOutbound(Object(m.a)(this,this.Wbj,"openWordClient"),Object(m.a)(this,this.$lm,"lockReleaseFailed"),
a)}$lm(a){k.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const d=new $g.StandardDialog;d.wc=0;d.aw(tl.a.MMj,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,a?Object(m.a)(this,this.Ylm,"lockReleaseErrorDismissedCloseForced"):Object(m.a)(this,this.Zlm,"lockReleaseErrorDismissedCloseNoForced"))}Ylm(){l.AFrameworkApplication.pa.ob(Sa.a.close,2,el.c)}Zlm(){Lb.App.oa.refreshDocument(null)}Wbj(a){l.AFrameworkApplication.dnc=!0;k.ULS.sendTraceTag(50857162,
211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",a);this.Vjj(a)}w0h(a){this.TGk(a);return 32}cmi(){Lb.App.oa.refreshDocument(null)}}Object(t.a)(UK,"OpenInWordOperation",NG,[]);const VK=(a,d)=>{k.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");a[Yf.a.On]=mi.PageReader.instance.$r(d);mi.PageReader.instance.$r(d)?a[Yf.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:a[Yf.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},
MP=(a,d,n,z,O)=>{if(!Lb.App.oa||!Lb.App.oa.za||!l.AFrameworkApplication.Xp.mlb)return 8;d=Lb.App.oa.za.jc;if(!d)return 8;if(a===Mb.a.TNd&&2===n){a=new Ff.GraphTransaction(15);try{a.Sa(d),mi.PageReader.instance.vJj(d)}finally{a&&a.dispose()}VK(O,d)}return 32},NP=(a,d,n,z,O)=>{if(!Lb.App.oa||!Lb.App.oa.za)return 8;a=Lb.App.oa.za.jc;if(!a)return 8;O[Yf.a.Alt]=l.AFrameworkApplication.Xp.mlb?"":CommonUIStrings.l_ProtectDocumentToolTip;VK(O,a);return 32};class WK extends LG{constructor(a,d){super(a,d);
this.SBh=!1}lb(){super.lb();this.ga.ma(Mb.a.openInClient,Cd.a.frame,Object(m.a)(this,this.G$i,"onOpenExternal"));l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OICExtendedTelemetryIsEnabled",!1)&&this.ga.$b(Mb.a.openInClient,12288);var a=this.ga;a.Aa(Mb.a.TNd,Kb.a.application,MP,4);a.Aa(Mb.a.WSe,Kb.a.application,NP,96);this.ga.ma(Sa.a.eLd,Cd.a.frame,Object(m.a)(this,this.G$i,"onOpenExternal"))}G$i(a,d,n,z,O){if(d.contextId!==Cd.a.frame)return 2;
if(!(Lb.App.JAc||l.AFrameworkApplication.Bs.Dca||l.AFrameworkApplication.Svb||this.SBh))return k.ULS.sendTraceTag(50857163,211,15,"OIC entry is hidden"),this.SBh=!0,8;if(1===n)return Yb.SessionStatusManager.instance.oj?8:32;d=!1;void 0!==O&&null!==O&&(d=O);k.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");return(new UK).begin(Lb.App.JAc,l.AFrameworkApplication.J3a,gF.Word,a===Sa.a.eLd?XD.OpenInBrowser:XD.WriteOnly,d,new Nf.a(()=>this.$_))}Hke(a){return kh.a.instance.Dqa()?
!0:Lb.App.oa.ctj(1,og.AppFrame.S7h,a)}downloadACopy(a,d,n,z,O){if(2===n){if(!l.AFrameworkApplication.J3a&&!l.AFrameworkApplication.la.eb.SYe(Sa.a.downloadACopy.toString()))return 8;Mw.a.LX(2,!0,Object(m.a)(this,this.Mbl,"doDownloadACopy"),null,O);return 32}return super.downloadACopy(a,d,n,z,O)}Mbl(a){if(!l.AFrameworkApplication.ldc&&l.AFrameworkApplication.la.eb.SYe(Sa.a.downloadACopy.toString()))this.JKa(!0,D.a.download,!0,{});else if(l.AFrameworkApplication.K.ea("WordEditorDownloadACopyUiIsEnabled")){let d=
l.AFrameworkApplication.J3a;a&&a.FileDownloadUrl&&(d=a.FileDownloadUrl.toString());new NK(d)}else super.downloadACopy(0,null,2,null,null)}workflow(a,d,n,z,O){return 2===n?(Mw.a.LX(13,!0,Object(m.a)(this,this.ENk,"callWorkflow"),null,O),32):super.workflow(a,d,n,z,O)}ENk(a){super.workflow(0,null,2,null,a)}}Object(t.a)(WK,"AppFrameCommandUIActor",LG,[]);class XK extends $g.StandardDialog{constructor(){super();this.wc=0;this.P6a(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,CommonUIStrings.l_WheresTheSaveButtonDialogMessage,
"WheresTheSaveButtonDialogItem_32x32x32",CommonUIStrings.l_WheresTheSaveButtonDialogTitle,null,null)}}Object(t.a)(XK,"WheresTheSaveButtonDialog",$g.StandardDialog,[]);const OP=(a,d,n)=>{if(1===n)return 32;new XK;return 32};var OG=b(526),lF=b(1266);class mF{constructor(a,d,n,z,O,ca){this.b1h=this.h1h=null;this.V4=a;this.a1h=d;this.BHk=n;this.DHk=z;this.h1h=O;this.b1h=ca}}Object(t.a)(mF,"BookmarkHighlightContext",null,[]);class ft extends Sb.a{constructor(a,d,n,z,O){var ca,Da,Xa;super();this.U3j=50;
this.OJh="px";this.L2j="aria-label";this.q_a="BookmarkIndicator";this.Vyh="HighlightBookmarkedContent";this.Nak="HighlightBookmark";this.Sbb="wwaengidc";this.Ha=a;this.ag=n;this.mk=d;this.uea=z;this.yC=O;this.QNh=null===(ca=l.AFrameworkApplication.K)||void 0===ca?void 0:ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.QueryBookmarkIndicatorOnSplit",!1);this.X3j=null===(Da=l.AFrameworkApplication.K)||void 0===Da?void 0:Da.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",
!1);this.Q3j=null===(Xa=l.AFrameworkApplication.K)||void 0===Xa?void 0:Xa.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkHighlightIsEnabled",!1);this.yC&&this.yC.Bie(this.AH.bind(this))}crn(a){if(a.nn){for(let d of a.Oh.Bj)if(this.U3g(d))return!0;return!1}return this.U3g(a.htmlElement)}Olc(a){let d=!1;l.AFrameworkApplication.Zi("Microsoft.Office.WordOnline.BookmarksIsEnabled");this.X3j&&(this.QNh?Ln.a.instance.Fd(()=>{d=this.crn(a)},"BIA:SCIVE"):Ln.a.instance.Fd(()=>{d=this.U3g(a.htmlElement)},
"BIA:SCI"));return d}U3g(a){return ft.Puf?(a=a.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&0<a.length?!0:!1:!1}Q5b(a){const d=a.V3b(0,this.U3j,this.zoom),n=[];n.push(this.Zib(a.bha,d,a.U0d[0].y-a.IUa[0].y));return n}Zib(a,d,n){const z=a.Cf.ownerDocument,O=Jl.a.createElement(z,Cl.a.div);O.className=ft.rph;O.style.left=d+this.OJh;O.style.top=n+this.OJh;d=Jl.a.createElement(z,Cl.a.Aac);d.src=ul.a.$e(ft.A3d);d.title="Bookmark";d.alt="Bookmark";d.setAttribute(this.L2j,
"Bookmark");O.appendChild(d);a={context:new mF([],O,new Set,new Set,null,null),rBm:a,container:O};this.mk.Ea(vb.a.xz,d,this.onMouseEnter);this.mk.Ea(vb.a.Fw,d,this.aCa);this.ag.vD(vb.a.click,O,this.YBa.bind(this),a);return O}g7h(){const a=Object.assign(new Y.a,{action:1,type:5,pK:null,zV:this.vxb});this.vxb=null;this.uea.rM(a)}AH(a,d){this.vxb&&(d.yHa.Ec.classList.contains("BookmarkHighlightSelected")||this.g7h())}onMouseEnter(a){if(null==a)return!1;a=a.Ec;a.parentElement.classList.add(ft.sph);a.src=
ul.a.$e(ft.S3j);return!0}aCa(a){if(null==a)return!1;a=a.Ec;a.parentElement.classList.remove(ft.sph);a.src=ul.a.$e(ft.A3d);return!0}YBa(a){this.Zrb(this.Vyh,this.Nak);if(null==a){var d=new Map;d.set("Source",this.q_a);d=Object.assign(new Sg.a,{EA:d});ja.Health.instance.recordKpiFailure(this.Vyh,"Unable to highlight bookmarked content",!1,!0,d);return!1}l.AFrameworkApplication.Zi("Microsoft.Office.WordOnline.BookmarkHighlightIsEnabled");if(this.Q3j){d=a.Dm.context;if(ft.Rcc(d,this.vxb))return!0;d=this.cCl(a.Dm.rBm,
d,a.Dm.container);a=Object.assign(new Y.a,{action:0,type:5,pK:d,zV:this.vxb});this.vxb=d;this.uea.rM(a);return!0}return!1}cCl(a,d,n){d={d1h:new Set,kLg:new Set,i1h:null,zHf:null};const z=this.Ha.VB(a.Ia,!0,!1);let O=[];if(z)for(let ca of z)O.push(ca);this.Qvk(a,d,O);d=new mF(O,n,d.d1h,d.kLg,d.i1h,d.zHf);this.vxb&&this.vxb.V4===O&&(n.className+=String.format(" {0}",ft.T3j),this.vxb=d);return d}Qvk(a,d,n){if(this.QNh&&a.nn){var z=new Set;for(let ca of a.Oh.Bj)ca.querySelectorAll("*").forEach(z.add,
z);a=Array.from(z.values())}else a=Array.prototype.slice.call(a.htmlElement.querySelectorAll("*"),0);let O=[];d.kLg.add(n[0].id);d.i1h=n[0].id;d.zHf=n[0].id;a.forEach(ca=>{let Da=Ag.a.Ta(ca,Ji.a.Ske);if(Da)for(let Xa of Da)O.push(Xa),d.d1h.add(Xa);if(!O.length)return!0;ca=Ag.a.Ta(ca,Ji.a.E3b);if(!ca)return!0;O=lF.a.oUe(O,ca)});for(z=a=this.Ha.qh(n[n.length-1],!1,!0);O.length&&a;){d.kLg.add(a.id);d.zHf=a.id;n.push(a);for(let ca of z.GQ)ca.htmlElement.querySelectorAll("."+Ji.a.yHf).forEach(Da=>{(Da=
Ag.a.Ta(Da,Ji.a.E3b))&&(O=lF.a.oUe(O,Da))});z=a=this.Ha.qh(a,!1,!0)}}Zrb(a,d){const n=new Map;n.set("Source",this.q_a);n.set("Action",d);ja.Health.instance.recordKpiUsage(a,0,this.Sbb,n)}static Rcc(a,d){return!!d&&!!a&&a.a1h===d.a1h}}ft.sph="WordBookmarkIndicatorContainerHovered";ft.T3j="WordBookmarkIndicatorContainerSelected";ft.A3d="BookmarkDefault.png";ft.S3j="BookmarkHover.png";ft.Puf=!0;ft.rph="WordBookmarkIndicatorContainer";Object(t.a)(ft,"BookmarkIndicatorActor",Sb.a,[553]);class YK{constructor(a,
d,n,z,O,ca,Da,Xa,zb,Vb=null,Fc=null,Yc=null,yd=null,je=null,Le=null){this.Pva="_";this.G9e="Bookmark";this.s3j=/^BOOKMARK\d+$/i;this.q_a="BookmarkRibbonOptions";this.O3j="BookmarkFloatieOptions";this.qsh="CreateBookmarkOnRange";this.rsh="CreateBookmarkOnView";this.psh="CreateBookmarkOnIP";this.Kbf="CreateBookmark";this.Sbb="wwaengidc";this.cOh="ShowHideBookmarksOnDocument";this.sth="DeleteBookmark";this.b7j="DeleteBookmarkAction";this.Qnk="ShowHideBookmarks";this.bOh="ShowBookmarksFloatie";this.Nnk=
"ShowBookmarksFloatieAction";this.Cuh="EditBookmark";this.Z7j="EditBookmarkAction";this.Hid="BookmarksUsage";this.$pc=a;this.ga=d;this.Da=n;this.Tn=z;this.Xy=O;this.qW=ca;this.Nb=Da;this.GT=Xa;this.ty=Fc;this.qph=zb;this.ud=Vb;this.Tia=je;this.pq=Yc;this.ic=yd;this.fy=Le}get DH(){return this.Xy.value}lb(){this.ga.ma(Dc.a.m3a,Kb.a.view,Object(m.a)(this,this.m3a,"createBookmark"));this.ga.ma(Dc.a.m3a,Kb.a.Lc,Object(m.a)(this,this.v_k,"createBookmarkOnRange"));this.ga.ma(Dc.a.m3a,Kb.a.Ub,Object(m.a)(this,
this.u_k,"createBookmarkOnIP"));this.ga.ma(Dc.a.deleteBookmark,Kb.a.view,this.deleteBookmark.bind(this));this.ga.ma(Dc.a.FYf,Kb.a.view,this.sdl.bind(this));this.ga.Aa(Dc.a.XBj,Kb.a.view,Object(m.a)(this,this.bvn,"showHideBookmarkIndicator"),1028);this.ga.Aa(Dc.a.kSe,Kb.a.application,Object(m.a)(this,this.kSe,"queryBookmarkIndicatorStatus"),96);this.ga.Aa(Dc.a.pZe,Kb.a.Ub,this.pZe.bind(this),1028);this.ga.Aa(Mb.a.lGd,Kb.a.view,this.lGd.bind(this),1028);this.ga.Aa(Dc.a.ECe,Kb.a.view,this.ECe.bind(this),
1028);this.ga.$b(Dc.a.m3a,1028)}m3a(a,d,n,z,O){if(this.Da.Ag.contextId===Kb.a.anchoredObject)return 2;if(1===n)return Lb.App.A4b(d)?8:32;a=this.Da.ya.Ba;if(this.ud.qj(a))return 2;this.eHd(O,"User is trying to create bookmark from UILocation : {0}");this.Zrb(this.rsh,this.Kbf);if(a&&this.Tn.Nhe(this.hFc(),a))return this.NGd(this.Hid),32;O=new Map;O.set("Source",this.q_a);O=Object.assign(new Sg.a,{EA:O});ja.Health.instance.recordKpiFailure(this.rsh,"Unable to create bookmark",!1,!0,O);return 8}v_k(a,
d,n,z,O){if(1===n)return 32;if(Kb.a.Lc!==d.contextId)return 8;this.eHd(O,"User is trying to create bookmark from UILocation : {0}");a=this.Da.ya.Ba;this.Zrb(this.qsh,this.Kbf);if(this.Tn.Nhe(this.hFc(),a))return this.NGd(this.Hid),32;a=new Map;a.set("Source",this.q_a);a=Object.assign(new Sg.a,{EA:a});ja.Health.instance.recordKpiFailure(this.qsh,"Unable to create bookmark for range",!1,!0,a);return 8}u_k(a,d,n,z,O){if(1===n)return 32;if(Kb.a.Ub!==d.contextId)return 8;this.eHd(O,"User is trying to create bookmark from UILocation : {0}");
a=this.Da.ya.Ba;this.ud.qj(a)&&(d=a.ra,this.ud.zVa(d)?(a=this.ud.SU(d,!1),a||(k.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),a=this.ud.SU(d,!0))):k.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));this.Zrb(this.psh,this.Kbf);if(this.Tn.Nhe(this.hFc(),a))return this.NGd(this.Hid),32;a=new Map;a.set("Source",this.q_a);a=Object.assign(new Sg.a,{EA:a});ja.Health.instance.recordKpiFailure(this.psh,"Unable to create bookmark for IP",
!1,!0,a);return 8}kSe(a,d,n,z,O){1===n&&32;O[Yf.a.On]=ft.Puf;return 32}bvn(a,d,n,z,O){if(1===n)return 32;this.Zrb(this.cOh,this.Qnk);(a=O[Yf.a.On])||k.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");ft.Puf=a;a=jm.PageNavigator.instance.RL(this.DH);if(null!==a)return this.iPd(a),this.$pc.jF({ShowBookmarks:"CheckboxModel"}),32;a=new Map;a.set("Source",this.q_a);a=Object.assign(new Sg.a,{EA:a});ja.Health.instance.recordKpiFailure(this.cOh,"Unable to show/hide bookmark on document",
!1,!0,a);return 8}deleteBookmark(a,d,n,z,O){a=this.Da.ya.Ba.ra;a=this.Tn.k9b(a.node,a.cpBegin);if(1===n)return a?32:8;this.eHd(O,"User is trying to delete bookmark from UILocation : {0}");this.GT.PIa&&(k.ULS.sendTraceTag(545118155,3029,50,"Dismissing the bookmarks floatie"),this.GT.OA());this.Zrb(this.sth,this.b7j);a||k.ULS.sendTraceTag(545118156,3029,50,"Delete bookmark called for a context where there were no bookmarks.");if(a&&this.Tn.VTg(a.id))return this.qph&&this.qph.g7h(),this.NGd(this.Hid),
32;n=new Map;n.set("Source",this.q_a);n=Object.assign(new Sg.a,{EA:n});ja.Health.instance.recordKpiFailure(this.sth,"Unable to delete bookmark",!1,!0,n);return 8}sdl(a,d,n,z,O){if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled",!1)){if(1===n)return 32;this.eHd(O,"User is trying to edit bookmark from UILocation : {0}");this.GT.PIa&&(k.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.GT.OA());
this.Zrb(this.Cuh,this.Z7j);a=this.Da.ya.Ba.ra;(a=this.Tn.k9b(a.node,a.cpBegin))||k.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");if(a)return this.Tia.value.tdl(d,a,this.Tn),this.NGd(this.Hid),32;d=new Map;d.set("Source",this.q_a);d=Object.assign(new Sg.a,{EA:d});ja.Health.instance.recordKpiFailure(this.Cuh,"Unable to edit bookmark",!1,!0,d);return 8}return 2}eHd(a,d){a&&a.UILocation&&k.ULS.sendTraceTag(540386525,3029,50,d,a.UILocation)}pZe(a,
d,n,z,O){if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksFloatie",!1)){1===n&&32;this.Zrb(this.bOh,this.Nnk);if(d.contextId===Kb.a.Ub)return a=Array(1),a.push("Bookmarks"),this.GT.showFloatie(O.location,a,1),32;O=new Map;O.set("Source",this.O3j);O=Object.assign(new Sg.a,{EA:O});ja.Health.instance.recordKpiFailure(this.bOh,"Unable to show bookmark floatie",!1,!0,O);return 8}return 2}lGd(a,d,n,z,O){return 1===n?(a=this.ga.rf(d,Mb.a.insertHyperlink,
n,!0,z,O),32!==a?this.ga.rf(d,Dc.a.m3a,n,!0,z,O):a):8}ECe(a,d,n){var z;if(1===n)return 32;if(a=this.Da.ya.Ba){a=a.ra.node;if(d=this.Dmi(a))return d.click(),32;k.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");if(a=this.Tn.k9b(a,0)){d=Cs.a.isEnabled?this.fy.efa.get(null===(z=a.id)||void 0===z?void 0:z.toString()):a.getValue(Qb.a.fG);z=jm.PageNavigator.instance.RL(this.DH).Ib.Ta(d);if(z=this.Dmi(z))return z.click(),32;k.ULS.sendTraceTag(539523266,3029,50,"No indicator found for the paragraph in previous paragraphs.")}else k.ULS.sendTraceTag(539523267,
3029,50,"No bookmark found enclosing the content.")}return 8}Dmi(a){let d;a=this.pq.Fl(a).Mh(this.ic.sc.Za);a.IHb&&(a=a.htmlElement.querySelectorAll("div."+ft.rph),0<a.length&&(d=a[0]));return d}iPd(a){const d=OG.b(a);if(d){var n=this.Nb.Wb(2);try{for(n.Sa(a);d.moveNext();){if(!Bd.ParagraphReader.Zf(d.iterator))continue;const z=d.currentNode;this.Lcl(z)&&this.qW.cJc(z,!0)}}finally{n&&n.dispose()}}}Lcl(a){for(let n=0;n<a.ja.length;n++){const z=a.ja.J(n);if(null!=z.qg)for(let O=0;O<z.qg.length;O++){var d=
z.qg.J(O);if(null!=d&&(d=a.Ib.Ta(d.pn).fa(Qb.a.Ut,""),!w.a.le(d)&&!d.startsWith(this.Pva)))return!0}}}hFc(){var a=this.Tn.$Ec(!1);let d=[];for(let n=0;n<a.count;n++){let z=a.J(n).fa(Qb.a.Ut,"");this.s3j.test(z)&&d.push(z)}return 0<d.length?(d.sort((n,z)=>n.localeCompare(z,void 0,{numeric:!0})),a=parseInt(d[d.length-1].substring(this.G9e.length)),this.G9e+(a+1)):this.G9e+1}Zrb(a,d){const n=new Map;n.set("Source",this.q_a);n.set("Action",d);ja.Health.instance.recordKpiUsage(a,0,this.Sbb,n)}NGd(a){l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksFloodgateIsEnabled",!1)&&this.ty&&this.ty.execute(d=>{d.logActivity(a,null)})}}Object(t.a)(YK,"BookmarkActor",null,[]);class ZK{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc){this.lr=d;this.fFa=n;this.Wd=z;this.tu=O;this.hc=ca;this.Nb=Da;this.Xb=Xa;this.ga=zb;this.Gck=Vb;this.Dkf=Fc}get N9l(){return this.Gck}lb(){this.ga.Aa(Mb.a.qZe,Kb.a.view,Object(m.a)(this,this.$4l,"insertContentControlPlaceholderTextByContentControlIdHandler"),
96)}$4l(a,d,n,z,O){a=this.lr.getById(O);if(!a)return 8;d=a.contentControlNode;if(!d)return 8;if(d.fa(Qb.a.V6,!1))return 2;n=this.lr.Mvl(a);if(!n)return 8;z=this.Nb.Wb(7);z.Sa(n.node);if(!this.N9l)return(O=a.aRe)||(O=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.hc.replaceTextRange(n,O),this.Rje(a),d.setValue(Qb.a.V6,!0),z.dispose(),32;O=new dh.DictionaryPropertySet;O.setValue(Xc.a.Ceg,n);var ca=d.fa(Qb.a.Aoe,"");ca=this.fFa.zGi(ca);if(!ca)return this.tu.replaceTextRange(n,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),
this.Rje(a),d.setValue(Qb.a.V6,!0),z.dispose(),32;O.setValue(Xc.a.FAe,ca);if(1<ca.length&&!a.Te)return z.dispose(),8;this.fZk(O);d.setValue(Qb.a.V6,!0);z.dispose();return 32}Rje(a){const d=this.tu.Bye(a.start.node,0<=a.start.cpBegin?a.start.cpBegin:0);d?this.Dkf&&(a=this.Xb.rz(a.start.node).Mf("Placeholder Text"))&&(this.Wd.mya(d.formatting),this.Wd.Ltb(d.formatting,a)):k.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}fZk(a){this.ga.ob(Mb.a.showPlaceholderGlossary,
2,a)}}Object(t.a)(ZK,"ContentControlActor",null,[]);var aB=b(941);class PG extends xg.a{constructor(a,d,n){super(!1,!1,!0);this.dEh=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,aB.a.QDf,aB.a.PDf,aB.a.RDf];this.Rnh=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.ga=a;this.uwf=d;this._tabStops=[];this.G_c=n;this.UEa="";a={["id"]:"CustomTabDialog",["bodyControls"]:this.Ysd()};this.Ih(Box4Intl.Box4Strings.l_CustomTabDialogTitle,
Object(m.a)(this,this.w6k,"customTabDialogResultHandler"),a)}$Sc(){new PG(this.ga,this.uwf,this.G_c)}X8(a){return{["position"]:a.position,["alignment"]:a.alignment,["leader"]:a.leader}}TAi(a){return Math.floor(100*parseFloat(a))/100}zEn(a){return new ry.a(Wf.a.xE(this.TAi(a.position)),aB.a.XPl(a.alignment),aB.a.VPl(a.leader),1)}gDl(){const a=[];for(let d of this.uwf)a.push(this.X8(d));return a}mPn(a){const d=new Set;this.UEa="";for(let n of a)if(""!==n.position){const z=this.TAi(n.position);if(0>
z||22<z){this.UEa=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(d.has(z)){this.UEa=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.zEn(n)),d.add(z)}else{this.UEa=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.UEa&&(this._tabStops=[],this.uwf=a)}RQn(a){if(0>a||22<a)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);var d={};if(32===this.ga.ob(Mb.a.qKa,2,d)){var n=d.marginLeft;
const z=rf.a.Rh(d.marginRight,0);n=rf.a.Rh(n,0);d=rf.a.Rh(d.iq,0);if(rf.a.fY(a,0,!1)>=d-z-n)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);}}Ysd(){const a=Object(m.a)(this,this.gDl,"getInitState"),d=Object(m.a)(this,this.mPn,"updateState");return{["getInitState"]:a,["updateState"]:d,["validPositions"]:this.kEi(-Infinity,Infinity),["validAlignments"]:this.Wui(this.Rnh,this.Rnh),["validLeaders"]:this.Wui(this.dEh,this.dEh),["defaultTabStopSpinButtonProps"]:this.kEi(.01,
22),["defaultTabStopLength"]:this.G_c,["DefaultTabStop"]:"DefaultTabStop",["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,
["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}kEi(a,d){return{["type"]:"AppSpinButtonProps",["id"]:"CustomTabDialogSpinButtonPosition",["label"]:"",["unitType"]:"Inch",["validUnits"]:[kz("Inch",3,a,d,.1)],["numberFormatInfo"]:rG()}}Wui(a,d){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",
["label"]:"",["options"]:WE(a,d)}}w6k(a,d){try{if(1===a){if(""!==this.UEa)throw Error.create(this.UEa);d.DefaultTabStop&&(this.G_c=aB.a.gYg(d.DefaultTabStop),this.RQn(this.G_c));if(32!==this.ga.ob(Dc.a.woc,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:Wf.a.xE(this.G_c)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(n){a=Object(m.a)(this,this.$Sc,"showCustomTabDialog"),this.NKa(n.message,a)}}}Object(t.a)(PG,"CustomTabDialog",xg.a,[]);class $K{constructor(a,
d,n){this.rad=this.Eb=null;this.ga=a;this.aNa=d;this.Cq=n}get hd(){return this.Eb||(this.Eb=la.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get TQd(){return this.rad||(this.rad=la.a.instance.sa("WordEditor.Actors.RenderParagraphsContainingTabs"))}lb(){const a=Lb.App.P9a.jpe(d=>$h.OutlineElementGeneralizer.Kla(d.ya,!0),!0);this.ga.ma(Dc.a.mic,Kb.a.view,a);this.ga.Aa(Dc.a.mic,Kb.a.paragraph,Object(m.a)(this,this.mic,"queryCustomTabStops"),96);this.ga.ma(Dc.a.jsb,Kb.a.view,
a);this.ga.Aa(Dc.a.jsb,Kb.a.paragraph,Object(m.a)(this,this.jsb,"removeCustomTabStop"),96);this.ga.ma(Dc.a.djc,Kb.a.view,a);this.ga.Aa(Dc.a.djc,Kb.a.paragraph,Object(m.a)(this,this.djc,"removeAllCustomTabStops"),96);this.ga.ma(Dc.a.HTd,Kb.a.view,a);this.ga.Aa(Dc.a.HTd,Kb.a.paragraph,Object(m.a)(this,this.HTd,"setCustomTabStop"),96);this.ga.ma(Dc.a.GMc,Kb.a.view,a);this.ga.Aa(Dc.a.GMc,Kb.a.paragraph,Object(m.a)(this,this.GMc,"modifyCustomTabStop"),96);this.ga.ma(Dc.a.woc,Kb.a.view,a);this.ga.Aa(Dc.a.woc,
Kb.a.paragraph,Object(m.a)(this,this.woc,"updateCustomTabStopsAndDefaultTabStopLength"),96);this.ga.ma(Dc.a.igh,Kb.a.view,a);this.ga.Aa(Dc.a.igh,Kb.a.paragraph,Object(m.a)(this,this.Adm,"isParagraphValid"),96);this.ga.ma(Dc.a.$Sc,Kb.a.view,Object(m.a)(this,this.jCj,"showCustomTabStopDialog"));this.ga.ma(Dc.a.YNi,Kb.a.view,Object(m.a)(this,this.jCj,"showCustomTabStopDialog"))}GMc(a,d,n,z,O){if(2!==n)return 8;if(!O)return 16;a=O.tabStop;O=O.value;if(!a)return 16;we.c(Dc.a.GMc);O=new ry.a(O,a.zoa,a.rBa,
a.w9g);d=d.node;this.aNa.jsb(d,a);this.aNa.RDe(d,O);return 32}HTd(a,d,n,z,O){if(2===n){if(!O)return 16;this.aNa.RDe(d.node,O);return 32}return 8}mic(a,d,n,z,O){a=this.aNa.Pjj(d.node);if(!("customTabs"in O))return O.customTabs=a,32;d=O.customTabs;if(!d||0>=d.length||!a||0>=a.length)return O.customTabs=null,32;n=[];for(let ca of d)for(let Da of a)if(Da.BYa===ca.BYa&&Da.w9g===ca.w9g&&Da.zoa===ca.zoa){n.push(ca);break}O.customTabs=n;return 32}jsb(a,d,n,z,O){if(2===n){if(!O)return 16;we.c(Dc.a.jsb);this.aNa.jsb(d.node,
O);return 32}return 8}djc(a,d){this.aNa.djc(d.node);return 32}woc(a,d,n,z,O){if(2===n){if(!O)return 16;a=O.tabStops;n=O.defaultTabStopLength;d=d.node;z=!1;let ca=this.aNa.O9m(d,a);O.defaultTabStopLengthSaved||(z=this.Cq.Wjn(d,n),O.defaultTabStopLengthSaved=!0);ca&&we.d(Dc.a.woc,!0,void 0,void 0,void 0,void 0,[Object.assign(new ba.a,{name:"Custom Tab Stops Count",string:a.length.toString()})]);if(null==z)return k.ULS.sendTraceTag(571479714,3015,15,"Could not set Default Tab Stop Length."),16;z&&(this.TQd&&
this.TQd.Fi(),this.hd.Ws(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),we.d(Dc.a.woc,!0,void 0,void 0,void 0,void 0,[Object.assign(new ba.a,{name:"Default Tab Stop Length",string:n.toString()})]));return 32}return 8}jCj(a,d,n){if(2!==n)return 8;a={};if(32!==this.ga.ob(Dc.a.OP,2,a))return k.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),16;d={};if(32!==this.ga.ob(Mb.a.qKa,2,d))return k.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),
16;a=aB.a.gYg(Wf.a.qC(a.defaultTabStop));n={};n.defaultTabStopLength=a;n.sectionPropertiesData=d;if(32!==this.ga.ob(Dc.a.igh,2,n))return k.ULS.sendTraceTag(572072073,3015,15,"Could not validate Paragraphs against indents and default tab stop."),16;if(!n.isParagraphValid)return k.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),this.aNa.NKa(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),8;d={};if(32!==this.ga.ob(Dc.a.mic,
2,d))return k.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(d=d.customTabs)||(d=[]);d=aB.a.WPl(d);new PG(this.ga,d,a);we.c(Dc.a.$Sc,!0);return 32}Adm(a,d,n,z,O){if(2!==n)return 8;if(!O)return 16;if(O.isParagraphValid)return 32;n={};if(32!==this.ga.rf(d,Mb.a.a8a,2,!1,null,n))return 16;a=O.sectionPropertiesData;d=O.defaultTabStopLength;var ca=n.fu;z=ca.sAa;ca=1===ca.specialIndentType?ca.yE:ca.yE-ca.uoa;const Da=a.marginLeft,Xa=a.marginRight;n.isRtl?(n=rf.a.Rh(Math.max(Xa,
Xa+z),0),z=rf.a.Rh(Math.max(Da,Da+ca),0)):(n=rf.a.Rh(Math.max(Da,Da+ca),0),z=rf.a.Rh(Math.max(Xa,Xa+z),0));a=rf.a.Rh(a.iq,0);d=rf.a.fY(d,0,!1);O.isParagraphValid=d<a-n-z;return 32}}Object(t.a)($K,"CustomTabActor",null,[]);var PP=b(117),nF=b(768);class aL{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb){this.ga=a;this.L1b=n;this.zwc=O;this.Dtc=ca;this.s_a=this.zwc&&z;this.Op=Da;this.Q2=Xa;this.L6j=zb;this.Gz=Vb;this.zwc&&xh.a("isSharedUXDarkModeOn")?(this.Op.G3=appChrome.api.isSharedUXDarkModeOn(),this.i1i(!0)):
this.Op.G3=!1;this.s_a?this.S_i(!0):this.Op.rub=!1;l.AFrameworkApplication.QH(()=>{this.jgc()});this.s_a&&xh.a("dispatch")&&appChrome.api.dispatch(this.dHj([]))}lb(){this.s_a&&(this.ga.ma(Dc.a.LEn,Kb.a.view,Object(m.a)(this,this.K6k,"darkMode")),this.ga.ma(Dc.a.VUd,Kb.a.view,Object(m.a)(this,this.VUd,"sharedUXDarkModeSwitchBackground")),this.ga.ma(Dc.a.zOd,Kb.a.view,Object(m.a)(this,this.zOd,"querySharedUXDarkModeSwitchBackground")));this.zwc&&(this.ga.ma(Dc.a.IYe,Kb.a.view,Object(m.a)(this,this.IYe,
"sharedUXDarkModeToggle")),this.ga.ma(Dc.a.$Se,Kb.a.view,Object(m.a)(this,this.$Se,"querySharedUXDarkModeToggle")))}q7l(a){if(!this.asn(a))return!1;const d=jn.a.instance.Wb(2);try{d.Sa(a.root);const n=Dd.GraphIterator.ua(a.root.graphNode),z=$s.a.Ep(n);for(;z.moveNext();){const O=Object(qa.a)(PP.a,z.currentNode);O&&O.GI(a.Za,20,!0)}}finally{d&&d.dispose()}return!0}asn(a){return a&&a.root&&a.mn?a.gj||a.JFe||a.Mog||a.uk:!1}fan(){let a=!1;this.L1b.forEach(d=>{this.q7l(d)&&(a=!0)});return a}MEn(){k.ULS.sendTraceTag(570566656,
3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",this.Op.G3?"dark":"light");return this.Op.G3?nF.a.Vhe(1):nF.a.Nmj(1)}oah(){const a=this.Op.Aqa;k.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",a?"dark":"light");if(!this.fan()||(a?!nF.a.Vhe(0):!nF.a.Nmj(0)))return!1;this.L6j.RYm(a);return!0}dHj(a){a.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.Op.G3));a.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",
this.KEi(!0)));try{WordRibbonStrings?a.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",this.Op.rub?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):k.ULS.sendTraceTag(527283228,3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(d){k.ULS.sendTraceTag(527282835,3023,10,d)}return a}K6k(){return this.oah()?32:8}IYe(a,d,n){if(1===n)return 32;a=this.Q2.Pe("UserAction","sharedUXDarkModeToggle");
if(xh.a("toggleSharedUXDarkMode"))k.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),appChrome.api.toggleSharedUXDarkMode(),xh.a("isSharedUXDarkModeOn")?this.Op.G3=appChrome.api.isSharedUXDarkModeOn():this.Op.G3=!this.Op.G3,this.Dtc&&k.ULS.sendTraceTag(529388308,3023,50,"User in new ribbonMode: {0}",this.Op.G3);else return 8;appChrome.getHeaderApi().then(z=>{z.hasOwnProperty("refreshThemeOverride")&&z.refreshThemeOverride()});this.MEn()||k.ULS.sendTraceTag(561553416,
3023,15,"Failed to toggle Dark mode for Fishbowl");this.s_a&&!this.Op.rub&&(this.oah()||k.ULS.sendTraceTag(561553417,3023,15,"Failed to toggle Dark mode for Canvas"));d={};d.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");Lb.App.oa.jF(d);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.Op.G3));this.s_a&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.Op.G3));a.stop();k.ULS.sendTraceTag(555885377,
3023,50,"{0}",a.ti);return 32}VUd(a,d,n){if(1===n)return 32;a=this.Q2.Pe("UserAction","sharedUXDarkModeSwitchBackground");k.ULS.sendTraceTag(561088148,3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.Op.rub=!this.Op.rub;if(!this.oah())return 8;d={};d.DarkModeSwitchBackground=this.Gz?"ButtonModel":"ToggleButtonModel";Lb.App.oa.jF(d);a.stop();k.ULS.sendTraceTag(555885378,3023,50,"{0}",a.ti);this.Dtc&&k.ULS.sendTraceTag(529388309,3023,50,"User in new canvasMode: {0}",this.Op.rub);
return 32}$Se(a,d,n,z,O){if(1===n)return 32;if(!O)return 2;xh.a("isSharedUXDarkModeOn")&&(this.Op.G3=appChrome.api.isSharedUXDarkModeOn());O&&(O[Yf.a.On]=this.Op.G3);return 32}zOd(a,d,n,z,O){if(1===n)return 32;if(!O)return 2;!this.Gz&&O&&(O[Yf.a.On]=this.Op.rub);a=[];a.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.Op.G3));this.s_a&&this.dHj(a);a.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",this.KEi(!1)));appChrome.api.dispatch(a);return 32}KEi(a){const d=
{};this.Op.rub?a?d["default"]="MoonMonochromatic_16":(d["default"]="MoonMonochromatic_20",d.icon32="MoonMonochromatic_32"):a?d["default"]="SunMonochromatic_16":(d["default"]="SunMonochromatic_20",d.icon32="SunMonochromatic_32");return d}jgc(){this.zwc&&this.i1i(!1);this.s_a&&this.S_i(!1)}i1i(a){k.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",a,this.Op.G3?"dark":"light",this.Op.njb)}S_i(a){k.ULS.sendTraceTag(561088150,3023,50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",
a,this.Op.Aqa?"dark":"light",this.Op.J6k)}}Object(t.a)(aL,"DarkModeActor",null,[]);var bL=b(1399);class oF{constructor(){this.Height=this.Width=0}static construct(a,d){const n=new oF;n.Width=a;n.Height=d;return n}}Object(t.a)(oF,"ViewportInfo",null,[]);class QG extends Jk.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}Jk(){return 85}static construct(a,
d,n,z,O,ca,Da,Xa,zb,Vb,Fc){const Yc=new QG;Yc.ContractVersion=a;Yc.DocumentContent=d;Yc.EnhancementId=n;Yc.World=z;Yc.ScalingFactor=O;Yc.DesktopViewportInfo=oF.construct(ca,Da);Yc.MobileViewportInfo=oF.construct(Xa,zb);Yc.MinParagraphCount=Vb;Yc.ContentCulture=Fc;return Yc}}Object(t.a)(QG,"SwayPreviewRequest",Jk.a,[]);var cL=b(558);class VC{static get Lf(){return xg.a.oz(VC.fm,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,
WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,VC.aen,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}VC.aen=ul.a.$e("progress.gif");VC.fm="<div class='WACDialogRow digitalPrintDialogWrapper UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(t.a)(VC,"DigitalPrintDialogHtml",null,[]);class xv{constructor(a,d,n,z){this.fontFamily=a;this.FRd=d;this.fontWeight=n;this.fontStyle=z}}Object(t.a)(xv,"FontInfo",null,[]);class is{constructor(a,d,n,z){this.styleName=a;this.title=d;this.pEn=n;this.XZl=z}}Object(t.a)(is,"StyleVisualInfo",null,[]);class SB extends xg.a{constructor(a,d,n,z,O=!0){super();this.nea=this.Ci=this.gwa=this.o$=this.J7d=this.hPh=this.ufe=this.lwf=this.mwf=this.Kvf=this.Rwc=this.E1a=this.T$=this.qwc=null;this.Myf=this.osf=
!1;this.R6d=null;this.Lf=VC.Lf;this.Je="DigitalPrintDialog";k.ULS.sendTraceTag(26005578,382,50,"Print to Web dialog has been opened and we initiated document force save");this.okk=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.Wrc=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.epk=n;this.t1c=z;this.ee(1,this.okk);this.Ih(this.Wrc,Object(m.a)(this,this.W$k,"digitalPrintDialogHandler"),null);this.k3l();this.vAn();this.Hth=(new Date).getTime();O&&Mw.a.LX(14,!1,
Object(m.a)(this,this.Bcl,"documentSavedSuccessfully"),Object(m.a)(this,this.Acl,"documentSaveFailed"),null);this.i4l();this.l2l();this.xlm();this.kwg();this.tlm();this.ldi()}get LHa(){return this.R6d}Bcl(){this.Atj(0)}Acl(a,d){this.Atj(d)}Atj(a){if(!this.osf){const d=(new Date).getTime()-this.Hth;pk.a.instance.Hd(ai.a.Lgi,d);a?k.ULS.sendTraceTag(25548302,382,15,String.format("We failed to save document with status code {0}",Tq.a[a])):k.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");
document.getElementById("digitalPrintSavingDiv").style.display="none";this.sRa.disabled=!1}}k3l(){this.Rwc=document.getElementById("digitalPrintStatusMessageDiv");this.Kvf=document.getElementById("digitalPrintStatusMessageIconDiv");this.mwf=document.getElementById("swayDesktopPreviewWrapperDiv");this.lwf=document.getElementById("swayDesktopPreviewHtmlHolder");this.ufe=document.getElementById("swayMobilePreviewHtmlHolder");this.hPh=document.getElementById("swayMobilePreviewWrapperDiv");this.T$=document.getElementById("swayGallery");
this.T$.setAttribute("tabindex","0");Qc.a.addHandler(this.T$,vb.a.scroll,Object(m.a)(this,this.lHg,"onGalleryScroll"));this.T$.setAttribute(pd.a.ig,pd.a.JFf);this.o$=document.getElementById("digitalPrintLearnMoreLink");this.o$.href="https://go.microsoft.com/fwlink/?linkid=871972";Qc.a.addHandler(this.o$,vb.a.click,Object(m.a)(this,this.QHg,"onLearnMoreClick"));this.gwa=new db.a;this.J7d=document.getElementById("homeWrapper");this.k5("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===
this.t1c?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}i4l(){this.Ci=new db.a;this.Ci.add(new is("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));this.Ci.add(new is("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));
this.Ci.add(new is("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.Ci.add(new is("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));this.Ci.add(new is("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));
this.Ci.add(new is("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.Ci.add(new is("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.Ci.add(new is("CelestialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle","swaySwirlHeading swayCelestialHeading"));this.Ci.add(new is("TranquilV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.Ci.add(new is("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.Ci.add(new is("Lucent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle","swaySimplicityHeading swayLucentHeading"));this.Ci.add(new is("AerialV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.Ci.add(new is("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.Ci.add(new is("Muse",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle","swayLightProHeading swayMuseHeading"));this.Ci.add(new is("Cinema",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.Ci.add(new is("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.Ci.add(new is("ConvergenceV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle","swayVanillaHeading swayConvergenceHeading"));this.Ci.add(new is("Alloy",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.Ci.add(new is("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.Ci.add(new is("Aurora",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle","swaySwirlHeading swayAuroraHeading"));this.Ci.add(new is("Civic",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.Ci.add(new is("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}l2l(){this.nea=new db.a;this.nea.add(new xv("universc","universc","normal","normal"));this.nea.add(new xv("Miller-Banner_Roman_WebTT","Miller-Banner_Roman_WebTT","normal","normal"));
this.nea.add(new xv("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.nea.add(new xv("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.nea.add(new xv("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.nea.add(new xv("Posterama-Regular","Posterama-Regular","normal","normal"));this.nea.add(new xv("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.nea.add(new xv("Benton_Modern-Roman_WebTT",
"Benton_Modern-Roman_WebTT","normal","normal"));this.nea.add(new xv("ArialNova","ArialNova","normal","normal"));this.nea.add(new xv("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.nea.add(new xv("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.nea.add(new xv("RockwellNova","RockwellNova","normal","normal"));this.nea.add(new xv("SabonNRegLT","SabonNRegLT","normal","normal"));this.nea.add(new xv("DaytonaThin","DaytonaThin","100","normal"))}xlm(){const a=document.createElement("style");
a.setAttribute("type","text/css");let d="";for(let n of this.nea)d+=String.format(this.epk,n.fontFamily,n.FRd,n.fontWeight,n.fontStyle);a.innerText=d;this.J7d.appendChild(a)}tlm(){const a=document.createElement("style");a.setAttribute("type","text/css");const d=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",ul.a.$e("SwayPreviewFrame.svg")),n=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}",
"swayPreviewFrameBackground",ul.a.$e("SwayPreviewFrameHC.svg"));a.innerText=d+n;I.a.el&&(a.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.J7d.appendChild(a)}kbj(a){this.hzi(a)===Sys.UI.Key.enter&&(this.tJg(a),a.preventDefault(),a.stopPropagation())}hzi(a){return a?a.keyCode:window.event.keyCode}hide(){this.MTg();super.hide()}MTg(){if(this.T$&&!this.osf){for(let a=0;a<this.gwa.count;a++)Qc.a.removeHandler(this.gwa.J(a),vb.a.click,Object(m.a)(this,this.tJg,"onStyleGalleryItemClick")),
Qc.a.removeHandler(this.gwa.J(a),vb.a.Nf,Object(m.a)(this,this.kbj,"onThumbnailKeyDown"));Qc.a.removeHandler(this.T$,vb.a.Nf,Object(m.a)(this,this.C9i,"onGalleryKeyDown"));Qc.a.removeHandler(this.T$,vb.a.focus,Object(m.a)(this,this.B9i,"onGalleryFocus"));Qc.a.removeHandler(this.o$,vb.a.click,Object(m.a)(this,this.QHg,"onLearnMoreClick"));this.Myf||Qc.a.removeHandler(this.T$,vb.a.scroll,Object(m.a)(this,this.lHg,"onGalleryScroll"));this.osf=!0}}kwg(){const a=document.createElement("link");a.setAttribute("rel",
"stylesheet");a.setAttribute("type","text/css");a.setAttribute("href",ul.a.K1h("swayPublish_cluster.css"));this.J7d.appendChild(a);for(let d of this.Ci)this.Y1k(this.T$,d);this.$Y(this.T$);this.J5h(this.T$.firstChild);this.T$.firstChild.focus();Qc.a.addHandler(this.T$,vb.a.Nf,Object(m.a)(this,this.C9i,"onGalleryKeyDown"));Qc.a.addHandler(this.T$,vb.a.focus,Object(m.a)(this,this.B9i,"onGalleryFocus"))}Y1k(a,d){const n=document.createElement("button");n.className="swayGalleryItem swayClip136x90 swayImageBorderButton";
n.setAttribute(pd.a.whb,pd.a.yL);n.setAttribute("title",d.title);n.setAttribute(pd.a.ig,pd.a.NFf);n.id=d.styleName;a.appendChild(n);a=document.createElement("img");a.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",d.styleName);a.src=ul.a.$e("swayPublish.png");a.setAttribute(pd.a.ig,pd.a.Ix);a.setAttribute("unselectable","on");a.setAttribute(pd.a.Xu,pd.a.Rm);a.id=d.styleName+"img";n.appendChild(a);a=document.createElement("label");a.innerText=d.title;a.className=d.pEn;a.setAttribute(pd.a.Xu,
pd.a.Rm);a.setAttribute("unselectable","on");a.setAttribute(pd.a.ig,pd.a.Ix);n.appendChild(a);const z=document.createElement("label");z.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;z.className=d.XZl;z.setAttribute(pd.a.Xu,pd.a.Rm);a.setAttribute("unselectable","on");z.setAttribute(pd.a.ig,pd.a.Ix);n.appendChild(z);Qc.a.addHandler(n,vb.a.click,Object(m.a)(this,this.tJg,"onStyleGalleryItemClick"));Qc.a.addHandler(n,vb.a.Nf,Object(m.a)(this,this.kbj,"onThumbnailKeyDown"));this.gwa.add(n)}B9i(a){((a=
a.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===a.id||a.id===zf.a.Zpc)||I.a.Ah)&&this.E1a&&this.dlc(this.E1a)}C9i(a){const d=this.hzi(a);d!==Sys.UI.Key.tab&&d!==Sys.UI.Key.left&&d!==Sys.UI.Key.right&&d!==Sys.UI.Key.up&&d!==Sys.UI.Key.down||this.xXl(d)||(a.preventDefault(),a.stopPropagation(),this.yFm(d))}yFm(a){const d=this.LHa;this.Fnl(a,d,!l.AFrameworkApplication.isRtl)||this.Hnl(a,d,!l.AFrameworkApplication.isRtl)||this.Cnl(a,d)||this.Dnl(a,d)}xXl(a){return a===Sys.UI.Key.tab?(this.LHa&&
this.LHa!==this.E1a&&(this.LHa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.R6d=this.E1a),!0):!1}lHg(){this.Myf||(this.Myf=!0,k.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),Qc.a.removeHandler(this.T$,vb.a.scroll,Object(m.a)(this,this.lHg,"onGalleryScroll")))}QHg(){k.ULS.sendTraceTag(26005580,382,50,"Learn more click")}Fnl(a,d,n){return a===Sys.UI.Key.right&&n||a===Sys.UI.Key.left&&!n?(a=(a=d.nextSibling)||this.T$.firstChild,this.dlc(a),!0):!1}Hnl(a,
d,n){return a===Sys.UI.Key.left&&n||a===Sys.UI.Key.right&&!n?(a=(a=d.previousSibling)||this.T$.lastChild,this.dlc(a),!0):!1}Cnl(a,d){return a===Sys.UI.Key.down?(a=this.gwa.indexOf(d),d=a+2,d<this.gwa.count?(a=this.gwa.J(d))&&this.dlc(a):(d=a%2+1,d=2<=d?0:d,(a=this.gwa.J(d))&&this.dlc(a)),!0):!1}Dnl(a,d){a===Sys.UI.Key.up&&(a=this.gwa.indexOf(d),d=a-2,0<=d?(a=this.gwa.J(d))&&this.dlc(a):(d=a?20+a-1:this.gwa.count-1,(a=this.gwa.J(d))&&this.dlc(a)))}dlc(a){this.LHa&&this.LHa.id!==this.E1a.id&&(this.LHa.className=
"swayGalleryItem swayClip136x90 swayImageBorderButton");this.R6d=a;this.LHa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.LHa.focus()}vAn(){this.sRa.className="WACDialogButtonNormal swayPrintToWebButton";this.sRa.setAttribute("tabindex","0");this.Lm.className="WACDialogButtonNormal swayCancelButton";this.Lm.setAttribute("tabindex","0");this.sRa.disabled=!0}tJg(a){a.preventDefault();a.stopPropagation();l.AFrameworkApplication.pa.processAction(Mb.a.QWf,
2);a.target?(a="button"===a.target.tagName.toLowerCase()?a.target:a.target.parentNode)&&a.id!==this.qwc&&(k.ULS.sendTraceTag(25231813,382,50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",this.qwc,a.id),this.J5h(a),this.ldi()):k.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")}J5h(a){this.LHa&&(this.LHa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.E1a&&(this.E1a.className="swayGalleryItem swayClip136x90 swayImageBorderButton",
this.E1a.setAttribute(pd.a.whb,pd.a.yL));this.qwc=a.id;this.E1a=a;this.E1a.setAttribute(pd.a.whb,pd.a.Rm);this.R6d=a;this.LHa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}W$k(a){const d=(new Date).getTime()-this.Hth;pk.a.instance.Hd(ai.a.Mgi,d);a?this.uhn():(k.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),l.AFrameworkApplication.pa.processAction(Mb.a.PWf,
2))}ldi(){th.a.instance.rb(new bf.a(2,1,50,Object(m.a)(this,this.thn,"sendPreviewRequest")))}thn(){this.bwn();try{const a=SB.eii.pil(),d=QG.construct(2,a,this.qwc,"VerticalWorld",.3,1366,600,330,280,20,SB.eii.qrc.name);l.AFrameworkApplication.Gd.Ni(String.format("{0}/we/GetSwayPreview.ashx?{1}",Lb.App.webServiceBase,l.AFrameworkApplication.rootQuerySignature),2,cL.b(d),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,Object(m.a)(this,this.RTm,"previewSuccessCallback"),
Object(m.a)(this,this.bgj,"previewFailCallback"),d)}catch(a){k.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",a.message)}}RTm(a){var d=null;({group:d}=tf.a.b9(a.data.Rd,d)).returnValue?(d=d.Responses[0],d.Succeeded?(this.BKe(a.data,ai.a.aHj),this.UCb(),this.pyj(this.lwf,d.PreviewHtml),this.pyj(this.ufe,d.PreviewHtmlMobile)):this.bgj(null)):k.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")}pyj(a,
d){a.innerHTML=d}bgj(){this.cwn();this.mwf.style.background="#E6E6E6";this.hPh.style.background="#E6E6E6"}uhn(){k.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",this.qwc));l.AFrameworkApplication.pa.processAction(Mb.a.RWf,2);const a=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",Lb.App.webServiceBase,l.AFrameworkApplication.rootQuerySignature,l.AFrameworkApplication.userSessionId,this.qwc);Ye.a.openWindow(4,
a)}BKe(a,d){pk.a.instance.Hd(d,+a.hE-+a.px)}cwn(){var a=WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;this.UCb();this.Rwc.innerText=a;this.Rwc.style.display="block"}bwn(){this.UCb();this.Kvf.style.display="block";this.Rwc.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.Rwc.style.display="block"}UCb(){this.mwf.style.background="";this.ufe.style.background="";ae.a.P6(this.lwf);ae.a.P6(this.ufe);this.Rwc.style.display="none";this.Kvf.style.display=
"none"}static get eii(){return SB.euh||(SB.euh=la.a.instance.sa("Box4.DocumentContentExtractor.IDocumentContentExtractor"))}}SB.euh=null;Object(t.a)(SB,"DigitalPrintDialog",xg.a,[]);class RG{constructor(a,d){this._context=this.Ml=null;this.caf=0;this.O3d=!1;this.xOh=null;this.ga=a;this.Tia=d}lb(){l.AFrameworkApplication.protectFile?k.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):l.AFrameworkApplication.K.ea("DisablePrintBasedOnPolicy")&&l.AFrameworkApplication.K.ea("DisablePrint")?
k.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.Aa(Mb.a.Xod,Kb.a.view,Object(m.a)(this,this.digitalPrint,"digitalPrint"),4),this.ga.Aa(Mb.a.QWf,Kb.a.view,Bc.ActionManager.CX,4),this.ga.Aa(Mb.a.RWf,Kb.a.view,Bc.ActionManager.CX,4),this.ga.Aa(Mb.a.PWf,Kb.a.view,Bc.ActionManager.CX,4),this.ga.Aa(Sa.a.Yod,Kb.a.view,Bc.ActionManager.CX,4))}digitalPrint(a,d,n,z,O){if(1===n)return l.AFrameworkApplication.WS?8:32;this.xOh=O.SourceControlId;if(l.AFrameworkApplication.K.ea("IsAnonymousUser"))return k.ULS.sendTraceTag(34373826,
382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),this.gTc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=d;if(RG.Ccm())return k.ULS.sendTraceTag(34373828,382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),this.$Qf(),32;switch(this.caf){case 1:k.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.$Qf();
break;case 2:k.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");this.gTc(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);break;case 0:this.O3d=!1,this.Ml=(new vh.a).create(),this.Ml.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,this.Ml.yQ(CommonUIStrings.l_DefaultDialogTitle,Object(m.a)(this,this.$Qk,"checkSwayLicenseCanceled"),null),l.AFrameworkApplication.Gd.Ni(String.format("{0}/we/CheckSwayLicense.ashx?{1}",
Lb.App.webServiceBase,l.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,Object(m.a)(this,this.bRk,"checkSwayLicenseSuccessCallback"),Object(m.a)(this,this.aRk,"checkSwayLicenseFailCallback"),null)}return 32}$Qf(){k.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",this.xOh);new SB(this._context,this.ga,l.AFrameworkApplication.K.Ga("SwayFontDownloadUrlTemplate"),l.AFrameworkApplication.K.Ga("FileSource"))}$Qk(){this.O3d=
!0;k.ULS.sendTraceTag(34373831,382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")}bRk(a){if(!this.O3d){this.Ml.close();var d=null;this.BKe(a.data,ai.a.$Gj);({group:d}=tf.a.b9(a.data.Rd,d)).returnValue?(a=d.Responses[0],k.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",a.HasLicense,a.Succeeded),a.Succeeded?(this.caf=a.HasLicense?1:2,2===this.caf?this.gTc(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):
this.$Qf()):this.gTc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):(k.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),this.gTc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}}gTc(a){const d=new $g.StandardDialog;d.wc=0;d.Qha(CommonUIStrings.l_DefaultDialogTitle,a,null)}aRk(a){this.O3d||(this.Ml.close(),k.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),
this.BKe(a.data,ai.a.ZGj),this.gTc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}BKe(a,d){pk.a.instance.Hd(d,+a.hE-+a.px)}static Ccm(){return"OneDriveWOPI"===l.AFrameworkApplication.K.Ga("FileSource")}}Object(t.a)(RG,"DigitalPrintActor",null,[]);class dL{constructor(){this.KQh=null}h1i(){k.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}cMj(a){if(!a)return k.ULS.sendTraceTag(25007842,375,15,"Error range is null"),!1;if(!this.FVi(a.errorDetails))return!1;
this.KQh=Object(qa.a)(Mi.a,a.errorDetails).typeId;return!0}TSc(a){return this.FVi(a)?Object(qa.a)(Mi.a,a).typeId===this.KQh:!1}FVi(a){if(!a)return k.ULS.sendTraceTag(25007843,375,15,"No ErrorDetails found"),!1;a=Object(qa.a)(Mi.a,a);return a?a.token&&a.typeId?!0:(k.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!a.token),!1):(k.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(t.a)(dL,"DoNotCheckThisCritiqueTypeStrategy",null,[559]);class eL extends xg.a{constructor(a,d,
n){super(!1,!1,!0);this.Tb=a;this.oza=n;this.J7j="DocumentChoiceGroup";this.Tuh="EmbededContent";this.mzh="HyperLink";this.vlf=n.Ixb;a={["id"]:"ExternalContentDefaultSettingsDialog",["bodyControls"]:this.Ysd()};this.b4j=this.Zhl.bind(this);this.ee(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.Ih(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.b4j,a)}Ysd(){const a=Array(2);a[0]={["key"]:this.Tuh,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};
a[1]={["key"]:this.mzh,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};const d={};d.documentChoiceGroupProps={["id"]:this.J7j,["defaultSelectedKey"]:this.vlf?this.Tuh:this.mzh,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:a};d.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;d.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;
d.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;return d}Zhl(a,d){1===a?(this.vlf!==d.isExternalContentSelected&&(a=d.isExternalContentSelected?Dc.a.a4a:Dc.a.FEb,this.Tb.processAction(a,2),this.vlf=d.isExternalContentSelected,R.a.sendTelemetryEvent(Object.assign(new ha.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",dataFields:[Object.assign(new ba.a,{name:"ActionId",int64:a})]}))),
this.oza.qen(d.isExternalContentSelected)):0===a&&k.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}Object(t.a)(eL,"ExternalContentDefaultSettingsDialog",xg.a,[]);class js{constructor(a,d,n,z){this.GT=la.a.instance.resolve("Common.IReactContextualUILauncher");this.Dqc=Yf.a.On;this.ga=a;this.Gj=d;this.Dvh=z;this.a4j=this.$hl.bind(this);l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.Dvh.olj(()=>
{this.reset()})}lb(){this.ga.Aa(Dc.a.UPg,Kb.a.view,Object(m.a)(this,this.nhj,"queryExternalContentPasteOptions"),97);this.ga.Aa(Dc.a.VPg,Kb.a.view,Object(m.a)(this,this.nhj,"queryExternalContentPasteOptions"),97);this.ga.Aa(Dc.a.vmi,Kb.a.view,this.a4j,1028);this.ga.Aa(Dc.a.a4a,Kb.a.view,Object(m.a)(this,this.wmi,"externalContentPasteOptionsAction"),1028);this.ga.Aa(Dc.a.FEb,Kb.a.view,Object(m.a)(this,this.wmi,"externalContentPasteOptionsAction"),1028);this.ga.Aa(Dc.a.bTc,Kb.a.view,Object(m.a)(this,
this.bTc,"showExternalContentFloatie"),96);this.ga.Aa(Dc.a.Y$b,Kb.a.view,Object(m.a)(this,this.Y$b,"hideExternalContentFloatie"),96)}Lun(a){new eL(this.ga,a,js.oza)}$hl(a,d,n){1!==n&&this.Lun(js.jdb);return 32}bTc(){const a=Array(1);a.push("ExternalContent");var d=la.a.instance.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider").FFb();d=Object.assign(new LE.a,{x:d.x,y:d.y});this.GT.showFloatie(d,a,1);return 32}Y$b(){this.GT.PIa&&this.GT.OA();return 32}nhj(a,d,n,z,O){if(d="object"===
typeof O?O:null)a===Dc.a.UPg?(a=js.jdb!==Dc.a.a4a&&js.jdb!==Dc.a.FEb,d[this.Dqc]=js.jdb===Dc.a.a4a||a):a===Dc.a.VPg&&(d[this.Dqc]=js.jdb===Dc.a.FEb);return 32}wmi(a,d,n){1!==n&&(a===Dc.a.FEb&&js.jdb!==Dc.a.FEb?(k.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.Gj.undo()&&(d=new ke.a(1,l.AFrameworkApplication.isRtl),d.YLd="ExternalContent",js.EEb.dPd(d))):a===Dc.a.a4a&&js.jdb!==Dc.a.a4a&&(k.ULS.sendTraceTag(575813833,324,50,"ExternalContentPasteEmbededWebContentOption clicked"),
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),this.Dvh.Ajj()),js.jdb=a);R.a.sendTelemetryEvent(Object.assign(new ha.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new ba.a,{name:"behavior",string:n.toString()}),Object.assign(new ba.a,{name:"ActionId",int64:a})]}));return 32}static get EEb(){return js.e6||(js.e6=la.a.instance.resolve("Box4.IExternalContentFloatieEventSource"))}static get oza(){js.xNa||(js.xNa=
la.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return js.xNa}reset(){js.jdb=null!=js.oza?js.oza.Ixb?Dc.a.a4a:Dc.a.FEb:Dc.a.a4a}}js.jdb=Dc.a.a4a;js.e6=null;js.xNa=null;Object(t.a)(js,"ExternalContentActor",null,[]);class TB extends se{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb){super(a,d,n,z,O,ca,Da,Xa,zb,Vb);this.ote=!1;this.Z6k=100;this.dtg=!1;this.tAh=null;this.GT=la.a.instance.resolve("Common.IReactContextualUILauncher")}TPd(){this.ote||(super.TPd(),this.ote=!0)}i3e(){this.ote&&
(super.i3e(),TB.$ii&&this.tAh&&TB.$ii.removeHandler(lj.a.SQa,this.tAh),this.ote=!1)}uVc(){this.GT.PIa&&l.AFrameworkApplication.pa.processAction(Dc.a.Y$b,2);l.AFrameworkApplication.pa.processAction(Dc.a.bTc,2);this.dtg=!1}OA(a){!this.Cjf&&(a&&(this.NYb.olg(),this.YMj()),this.GT.PIa||this.C0a)&&(this.C0a=!a,this.i3e(),l.AFrameworkApplication.pa.processAction(Dc.a.Y$b,2))}showFloatie(a,d){d||(d=new ke.a(0,l.AFrameworkApplication.isRtl));d.location||(d.location=this.NYb.FFb());if(!d.location)return!1;
this.C0a&&(this.C0a=!1,this.TPd());l.AFrameworkApplication.pa.processAction(Dc.a.bTc,2);return!0}Cei(){if(!this.dtg){const a=new bf.a(3,1,this.Z6k,()=>{this.uVc()},196);th.a.instance.rb(a);this.dtg=!0}}B8(){l.AFrameworkApplication.pa.processAction(Dc.a.Y$b,2);this.Cei()}tkc(){l.AFrameworkApplication.pa.processAction(Dc.a.Y$b,2);this.Cei()}static get $ii(){return TB.Nr||(TB.Nr=la.a.instance.resolve("Box4.IEditStateEventManager"))}}TB.Nr=null;Object(t.a)(TB,"ExternalContentFloatieEventManager",se,[]);
class UB extends ki{constructor(a,d,n,z,O){super(a,d,n,z,O)}L3h(){if(!this.Da||!this.Da.ya||!this.Da.ya.Ba)return k.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;var a=this.Da.ya.Ba.ra,d=!a.cpBegin&&!a.cpEnd;let n=a.node;if(n&&d&&!n.Ey){do n=this.sCi(n);while(n&&!n.Ey&&Object(Uc.a)(Vi.AParagraphNode,n)&&!n.characterData.trim().length)}let z="";const O=Object(qa.a)(Vi.AParagraphNode,n);O&&(z=O.characterData.length===a.cpBegin||
d?O.characterData.trimEnd():O.characterData.substring(0,a.cpBegin).trimEnd());d=O?z.length:a.cpBegin;a=Object.assign(new Vh,{gKa:Object(qa.a)(139,(O?Object(qa.a)(139,O):Object(qa.a)(139,n))||a.node),POc:d});return this.z8f(a)}oyi(a,d){let n=null;const z=Object(qa.a)(204,a.gKa.Mh(d.Za));if(!z)return null;if(Object(Uc.a)(Vi.AParagraphNode,a.gKa)){const O=Object(qa.a)(Vi.AParagraphNode,a.gKa);if(O.rI){if(a=Object(qa.a)(Im.a,Bd.ParagraphReader.WHa(O)))(a=Object(qa.a)(204,a.Mh(d.Za)))&&(n=a.getBounds()),
n&&(n.height+=UB.Ipi,n.width-=UB.$ml);return n}d=Object(qa.a)(92,z);if(!d)return null;try{if(n=this.JG.oP(a.POc,d,0<a.POc,!1,!1,!1))n.height+=UB.Ipi}catch(ca){k.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",ca),n=null}}n||(n=z.getBounds());return n}}UB.Ipi=65;UB.$ml=100;Object(t.a)(UB,"ExternalContentFloatiePositionProvider",ki,[]);class fL{constructor(a,d,n,z,O,ca){this.ga=a;this.Tia=d;this.Fsc=n;this.v7j=z;this.Wth=O;this.r4j=ca}lb(){l.AFrameworkApplication.K.ea("DisablePrintBasedOnPolicy")&&
this.v7j?(document.body.classList.add("WACStopPrinting"),""!==this.Wth&&this.r4j.gvn(this.Wth)):(this.ga.ma(Mb.a.print,Kb.a.application,Object(m.a)(this,this.vWg,"requestDownload")),this.ga.ma(Dc.a.Apd,Kb.a.application,Object(m.a)(this,this.vWg,"requestDownload")),this.ga.ma(Dc.a.Sre,Kb.a.application,Object(m.a)(this,this.vWg,"requestDownload")))}vWg(a,d,n){if(1===n)return l.AFrameworkApplication.protectFile||l.AFrameworkApplication.wsa||Yb.SessionStatusManager.instance.oj?8:32;if(a===Mb.a.print)a=
1;else if(a===Dc.a.Apd)a=0;else if(a===Dc.a.Sre)a=2;else return 8;return this.jen(a)}jen(a){const d=l.AFrameworkApplication.rootQuerySignature;if(!d||""===d||Lb.App.lc&&Lb.App.lc.oC.Gp)return 8;this.Fsc.VEe=!1;this.Fsc.xSj.start();Mw.a.LX(5,!0,Object(m.a)(this.Fsc,this.Fsc.Q$m,"requestFileDownload"),Object(m.a)(this.Fsc,this.Fsc.Agc,"onForceSaveFailed"),a);return 32}}Object(t.a)(fL,"FileDownloadActor",null,[]);class gL extends rh{constructor(a,d=null){super(a,!0,d,!1)}get Xhg(){return null}get lqb(){return l.AFrameworkApplication.zSa?
CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get PLc(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get Yie(){return null}}Object(t.a)(gL,"DownloadAsPdfDialog",rh,[]);class zu{constructor(){this._url=this.Tq=null;this.cfb=this.bfb=0;this.tBb=!1}send(a,d,n){this._url=a;this.Tq=d;this.tBb=n;this.makeRequest(null)}makeRequest(){l.AFrameworkApplication.Gd.Ni(this._url,1,null,null,!0,2,Object(m.a)(this,
this.Ngc,"onRequestSucceeded"),Object(m.a)(this,this.bCa,"onRequestFailed"),null)}Ngc(a){zu.wRd();const d=a.data.X0;let n=null;if(d)try{n=d.selectSingleNode("/docdata/status")}catch(z){}n&&("InProgress"===n.text&&22>this.bfb++||"ServiceBusy"===n.text&&3>this.cfb++)?this.mMb(1E3*(this.bfb+this.cfb)):this.Tq(!0,n?n.text:null,a.data)}bCa(a){this.tBb?(zu.mPa||(zu.uzb=new Date,zu.mPa=!0,zu.s6=1),18E4>(new Date).getTime()-zu.uzb.getTime()?this.retryOnFailure(4<=zu.s6?2E4:1E3):this.xmb(a.data)):4>zu.s6?
this.retryOnFailure(2E3):this.xmb(a.data)}mMb(a){a=new bf.a(2,1,a,Object(m.a)(this,this.makeRequest,"makeRequest"));l.AFrameworkApplication.tb.rb(a)}retryOnFailure(a){this.mMb(a);zu.s6++}xmb(a){this.Tq(!1,null,a)}static x_(a,d){(new zu).send(a,d,!1)}static wRd(){zu.mPa=!1;zu.s6=0}}zu.uzb=null;zu.mPa=!1;zu.s6=0;Object(t.a)(zu,"ClientRequestWithRetry",null,[]);class hL extends hf{constructor(a){super(a,void 0,l.AFrameworkApplication.zSa)}get lqb(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}get PLc(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get kGd(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get Hnd(){return l.AFrameworkApplication.zSa?
"UIFontDialogTextLarge":null}Wwg(){k.ULS.sendTraceTag(7628378,324,50,"ODT download dialog displayed")}Xwg(){k.ULS.sendTraceTag(7628379,324,50,"ODT download dialog link clicked")}RGd(){k.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get UFd(){return lG.z7i}get JIb(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get t4i(){return!l.AFrameworkApplication.zSa}}Object(t.a)(hL,"DownloadAsOdtDialog",hf,[]);class iL{constructor(a,d){this.zyb=this.Fgb=
null;this.VEe=!1;this.GSb=a;this.xSj=d.L6a("UserAction","WordEditorForceSaveAndPrint")}Xtb(a){1===Lb.App.oa.state||this.Fgb||(this.Fgb=(new vh.a).create(),a=a.customData,this.mmm(a),1===a?this.Fgb.message=this.GSb.BX.isEnabled?l.AFrameworkApplication.zSa?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:a?2===a&&(this.Fgb.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait):this.Fgb.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait,
this.Fgb.yQ(CommonUIStrings.l_DefaultDialogTitle,Object(m.a)(this,this.cancelButton,"cancelButton"),null))}cancelButton(){this.VEe=!0}$ya(a){this.Fgb&&(this.wmm(a),this.Fgb.close(),this.Fgb=null)}dda(a){if(1!==Lb.App.oa.state){this.dnm(a);const d=new $g.StandardDialog;d.wc=0;d.ee(1,CommonUIStrings.l_DialogClose);d.aw(0,"",1===a?WordEditorIntl.WordEditorStrings.l_PrintError:WordEditorIntl.WordEditorStrings.l_ConversionError,null,!0)}}kMl(a){switch(a){case 0:return"downloadpdf";case 1:return"printpdf";
case 2:return"odt";default:return k.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",a),"printpdf"}}Q$m(a){var d=l.AFrameworkApplication.rootQuerySignature;d&&""!==d?(d="WordViewer/request."+this.Uhl(a)+"?"+d+"&type="+this.kMl(a)+"&rndm="+xa.a.create(),1===a&&this.GSb.Qtn()&&(d+="&useNamedAction=1"),l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("CustomFontReadModePDFIsEnabled")&&Up.FontUtils.ANb()&&(1===a||!a)&&(0<Up.FontUtils.WTf&&(d+="&cfcVer="+Up.FontUtils.WTf),Up.FontUtils.VTf&&
(d+="&cfcUrl="+Up.FontUtils.VTf),Up.FontUtils.XTf&&(d+="&cfcEncData="+Up.FontUtils.XTf)),zu.x_(d,Object(m.a)(this,this.$ga,"onRequestComplete")),this.zyb||(this.zyb=new bf.a(2,1,500,Object(m.a)(this,this.Xtb,"showWaitUI")),this.zyb.customData=a,l.AFrameworkApplication.tb.rb(this.zyb))):(this.b8g("failed. QuerySignature is empty."),this.dda(a))}Uhl(a){return 2===a?"odt":"pdf"}Agc(){this.b8g("Failed. force save failed.")}aan(a){if(0<a.indexOf("&type=downloadpdf"))return 0;if(0<a.indexOf("&type=printpdf"))return 1;
if(0<a.indexOf("&type=odt"))return 2;k.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri:{0}",a);return 1}$ga(a,d,n){this.b8g("Success. Save and Conversion Complete.");n=new Ba.QueryStringBuilder(n.request.get_url());l.AFrameworkApplication.Vea(n);n=n.toString();const z=this.aan(n);this.$ya(z);2!==z&&this.GSb.mUm();!a||d?this.dda(z):this.VEe?(this.VEe=!1,this.zyb=null):(this.zyb&&l.AFrameworkApplication.tb.ie(this.zyb),this.zyb=null,this.ibl(n,z))}b8g(a){k.ULS.sendTraceTag(7628385,
328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",a);this.xSj.stop()}ibl(a,d){const n=new db.a;n.add("access_token");n.add("access_token_ttl");1!==Lb.App.oa.state&&(1===d?this.GSb.Nvn(a,n):d?2===d&&new hL(a):new gL(a))}dispose(){}mmm(a){switch(a){case 0:k.ULS.sendTraceTag(38114782,203,50,"Download Attempt: Pdf");break;case 2:k.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:k.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");break;
default:k.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",a)}}wmm(a){switch(a){case 0:k.ULS.sendTraceTag(38114786,203,50,"Download Cancelled: Pdf");break;case 2:k.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:k.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");break;default:k.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",a)}}dnm(a){switch(a){case 0:k.ULS.sendTraceTag(38114818,203,15,"Download Failed: Pdf");break;case 2:k.ULS.sendTraceTag(38114819,
203,15,"Download Failed: Odt");break;case 1:k.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;default:k.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",a)}}}Object(t.a)(iL,"FileDownloadManager",null,[]);class VB{get key(){return"LIST"}get jz(){return Box4Intl.Box4Strings.l_ListContentTitle}$Uc(a){let d=null;const n=VB.Vb.ht(a);if(!n)return{returnValue:!1,Bya:d};a=this.GEl(a,n);d=Object.assign(new ri.a,{PK:this.key,contentId:a.listId,contentObject:a});return{returnValue:!0,
Bya:d}}Z8b(a,d){a=a.contentObject;const n=this.EDl(a.Tx),z=new Uj.a;d?(d=d.contentObject,d.level!==a.level?(z.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),z.add(n)):d.id.equals(a.id)&&d.Tx.listType===a.Tx.listType||z.add(n)):(z.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),z.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),z.add(n));return z.toArray().join(" ")}EDl(a){let d="";const n=a.listStyle;if(!a.listType)d=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,
a.gp);else if(1===a.listType)switch(n){case 1:d=this.M2h;break;case 2:d=this.mLk;break;case 3:d=this.nLk;break;default:d=this.M2h}return d}static get Vb(){return VB.zc||(VB.zc=la.a.instance.resolve("Box4.List.IListReader"))}}VB.zc=null;Object(t.a)(VB,"ListDetailsProvider",null,[506,288]);class jL{constructor(){this.Tx=this.listId=this.id=null;this.level=0}}Object(t.a)(jL,"ListItemInfo",null,[]);class kL extends VB{constructor(a){super();this.b2=a}get M2h(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get mLk(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get nLk(){return WoncaIntl.WoncaStrings.L_BulletStyle3}GEl(a,
d){const n=this.b2.Uz(a);return Object.assign(new jL,{id:a.currentNode.id,listId:new E.a(xa.a.nil,n.listID),Tx:d,level:n.level+1})}}Object(t.a)(kL,"FlatListDetailsProvider",VB,[]);class lL{constructor(a,d){this.Xb=null;this.ga=a;this.zc=d}get gb(){return this.Xb||(this.Xb=la.a.instance.sa("Box4.Styles.IWACStyleReader"))}lb(){}}Object(t.a)(lL,"FormattingActor",null,[]);var WC=b(1153),QP=b(1531);class mL{constructor(a,d,n,z,O,ca,Da,Xa){this.Ya=a;this.Jmk=d;this.Nb=n;this.hUb=z;this.In=O;this.va=ca;
this.Ja=Da;this.$ck=Xa}Xqb(a,d,n,z,O,ca,Da){k.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:Da.ti});this.hUb.then(()=>{this.Jmk(a.data.Rd);k.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:Da.ti});Da.stop()})}bCa(a,d,n,z,O,ca,Da){ca.stop();O();Da?(this.AQm(d,n),k.ULS.sendTraceTag(574377989,3001,
50,a)):k.ULS.sendTraceTag(574377990,3001,10,a)}JYh(a,d){a.Xd(eF.a.EPf,"1");if(this.Ja&&this.Ja.isFeatureEnabled(81)){var n=this.In.$k(d.Am);n=this.In.ml(n);a.Xd(be.a.Jp,WC.a[n]);5===n&&this.GCk(a,d)}this.$ck&&a.Xd(be.a.nDe,"true")}$Sh(){return new QP.a(this.Ya.id,this.Ya)}mze(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}AQm(a,d){const n=this.Nb.Wb(7,Mb.a.DHi);n.Sa(d);a.Ya.setValue(Qb.a.dPf,!0);n.dispose()}GCk(a,d){var n=d.Am;d=this.In.$k(n);var z=n.node;const O=(n=this.In.f4(d,
z.Ib,!1))?this.In.Zfa(n):"";if(""===O)throw k.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),Error.argumentNull("OriginalObjectDataBlobId");z=(z=this.In.f4(d,z.Ib,!0))?this.In.Zfa(z):"";a.Xd(be.a.u7a,O);a.Xd(be.a.Vgh,z);n=n.fa(lh.a.m1f,"");""!==n&&a.Xd(be.a.extension,n);a.Xd(be.a.width,this.In.Tz(d).toString());a.Xd(be.a.height,this.In.UA(d).toString());a.Xd(be.a.IKb,this.In.PTa(d).toString());n=this.va.ea("WordEditorImageCropIsEnabled");a.Xd(be.a.XSf,n.toString());
n&&(a.Xd(be.a.top,this.In.zba(d).toString()),a.Xd(be.a.bottom,this.In.wba(d).toString()),a.Xd(be.a.left,this.In.xba(d).toString()),a.Xd(be.a.right,this.In.yba(d).toString()));n=this.va.ea("WordEditorImageRotateIsEnabled");a.Xd(be.a.fYg,n.toString());n&&(a.Xd(be.a.angle,this.In.WX(d).toString()),a.Xd(be.a.Okb,this.In.r1(d,Qb.a.xGb,!1)?"true":"false"),a.Xd(be.a.Pkb,this.In.r1(d,Qb.a.BGb,!1)?"true":"false"));a.Xd(be.a.eZf,"true")}}Object(t.a)(mL,"GraphicsEditorDocumentXmlToJsonRequestHelper",null,[569]);
class nL{constructor(){this.k0a=null}aHk(a){this.k0a=a}teardown(){null!=this.k0a&&(this.k0a.teardown(),this.k0a=null);this.srf=null}getGraphicData(){return this.k0a?this.k0a.getGraphicData():null}r5m(){null!=this.srf&&this.setGraphicData(this.srf)}setGraphicData(a){this.srf=a;if(this.k0a)try{this.k0a.setGraphicData(a)}catch(d){k.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",d.toString())}else k.ULS.sendTraceTag(575522529,3001,
10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.k0a?this.k0a.hasEdits():!1}}Object(t.a)(nL,"GraphicsEditorGC2HostUser",null,[571]);var RP=b(1532),SP=b(1187),TP=b(566),UP=b(1267),VP=b(953);class oL{constructor(a){this.preloadScript=this.loadScript=null;this.loadScript=d=>a.loadScript(d);this.preloadScript=d=>{a.preloadScript(d)}}}Object(t.a)(oL,"GC2ScriptLoader",null,[]);class SG{constructor(a,d,n){this.zaf=a;this._context=d;this.r1a=n}closeEditor(){this.zaf&&
(this.zaf(),this.zaf=null)}logTrace(a,d,n,z){k.ULS.sendTraceTag(575522531,3001,SG.fsm(d),z)}isEnabled(a){const d=l.AFrameworkApplication.K;switch(a){case "SmartGuides":return d.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsSmartGuides",!1);case "EqualSizingGuide":return d.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "AdjustHandles":return d.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",!1);case "SpaceFirstLastPara":return d.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",
!1);case "ModernFontPicker":return d.ea("ModernFontPickerIsEnabled");case "CropGridLines":return d.getBooleanFeatureGate("Microsoft.Office.WordOnline.CropGridLines",!1);case "CropResolution":return d.getBooleanFeatureGate("Microsoft.Office.WordOnline.CropResolution",!1);case "SnapToAspectRatio":return d.getBooleanFeatureGate("Microsoft.Office.WordOnline.SnapToAspectRatio",!1);case "SVG":return d.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsUseSVG",!1);default:return!1}}getFontPickerFonts(a){const d=
`${la.a.instance.resolve("Box4.IFontServiceParser").Xkb}/${"hier_officeFontsPreview.ttf"}`;a("msofp_hier",d);a=Up.FontUtils.Asd(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:a.fonts.filter(n=>"premium"!==n.fontType),mruList:a.mruList,previewFontFamily:"msofp_hier_MSFontService"}}getFonts(a){const d=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1),n=d?"msofp_hier":"msofp",z=`${la.a.instance.resolve("Box4.IFontServiceParser").Xkb}/${d?"hier_officeFontsPreview.ttf":
"flat_officeFontsPreview.ttf"}`;a(n,z);Up.FontUtils.Lhe();Up.FontUtils.$he({});a=Up.FontUtils.WEc(()=>!1,(O,ca)=>ca,!1).MenuSectionList;d&&0<a.length&&(a.pop(),a.push(this.hXk()));return a}hXk(){const a=Up.FontUtils.Asd(()=>!1,()=>"").fonts.map((d,n)=>{const z=d.name;d=d.displayName;const O=Up.FontUtils.fM(z);return Object.assign(new MI.a,{MenuItemId:Up.FontUtils.DWe+n,CommandValueId:z,LabelText:d||z,Styles:{["optionText"]:{["fontFamily"]:d&&!O?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},
AriaLabel:z})});return Object.assign(new fi.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,Id:"AllFontsDropdown",ControlList:a})}getPictureDataFromId(a){const d=this._context.Am;var n=Kd.ImageReader.$k(d);if(this.jbm(n,d,a)&&(n=Kd.ImageReader.r1(n,Xc.a.gCa,""),n.length))return Promise.resolve(n);n=new Ba.QueryStringBuilder("/we/GetImage.ashx?");n.g2a(d.node.Zg().Ds);n.Xd(be.a.uCc,a);l.AFrameworkApplication.Vea(n);n.Xd(Me.a.k$a,"1");Xf.a.instance.ehb(n);n.Xd(be.a.qUf,"true");const z=n.toString();
return new Promise((O,ca)=>{this.r1a.Ni(z,1,null,null,!1,2,Da=>{O(Da.data.Rd)},Da=>{ca(Da.data.Ge.toString())},null)})}getPlaceholders(){const a={};a.PictureDownloading=ul.a.$e("progress.gif");a.PictureInvalid=ul.a.$e("CancelRequest.32x32x32.png");return a}getTheme(){const a=jm.PageNavigator.instance.kt(this._context.view.xc).properties.fa(Qb.a.uYd,"");return 0===a.length?[]:a.split(" ").map(d=>Lb.App.S4b[d])}static fsm(a){switch(a){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;
case 4:return 200;default:return 50}}jbm(a,d,n){const z=d.node.Ib;d=Kd.ImageReader.Bvd(a,z,!1);a=Kd.ImageReader.Bvd(a,z,!0);return n===d||n===a}}Object(t.a)(SG,"GraphicsEditorApp",null,[595]);class pL extends xg.a{constructor(a,d,n,z,O){super(!1,!1,!0);this.Nyb=a;this.qak=d;this.Bzh=n;this._context=z;this.r1a=O}Yun(){return new Promise((a,d)=>{const n={["id"]:"GraphicsEditorDialog",["bootstrap"]:(z,O)=>this.HHk(O),["onload"]:z=>{this.onLoad(z,a,d)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,
["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,["onReload"]:()=>{this.Nyb.r5m()}};this.Ih(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,Object(m.a)(this,this.zX,"dialogHandler"),n)})}onLoad(a,d,n){a?(this.Nyb.aHk(a),d(a)):(k.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),n(null))}HHk(a){const d=l.AFrameworkApplication.K,n=VP.a();n.loadScriptWithRetryHandler=a;const z=new SG(Object(m.a)(this,this.closeEditor,"closeEditor"),
this._context,this.r1a),O={["bootConfig"]:Object.assign(new SP.a,{scriptBaseUrl:PC.AppChromeOverrideUtilities.isEnabled?PC.AppChromeOverrideUtilities.gvd(l.AFrameworkApplication.lcid):l.AFrameworkApplication.BQ+l.AFrameworkApplication.lcid+"/",isMLRRibbonMode:l.AFrameworkApplication.la.eb.$lc}),["scriptLoader"]:new oL(new dynamicScriptLoader.DynamicScriptLoader(n)),["publicPath"]:l.AFrameworkApplication.BQ,["appSettings"]:d.appSettings,["logger"]:new No.a,["featureGateManager"]:Object.assign(new TP.a,
{getBooleanFeatureGate:Object(m.a)(d,d.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:Object(m.a)(d,d.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(m.a)(d,d.getStringFeatureGate,"getStringFeatureGate")}),["app"]:z,["resolveScript"]:(ca,Da)=>UP.a.resolveScript(ca,Da)};d.ea("DynamicBundlesIsEnabled")&&(O.dynamicBundlesPath=PC.AppChromeOverrideUtilities.isEnabled?PC.AppChromeOverrideUtilities.O8a+"exp/":d.Ga("StaticContentUrl")+"exp/");return new Promise((ca,Da)=>
{a("gc2",l.AFrameworkApplication.Yx("gc2.js",5),"anonymous",5,!1).then(()=>{ca(O)}).catch(()=>{k.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");Da(null)})})}S$h(a){a=this.Nyb.hasEdits()&&!a;this.qak(a?this.Nyb.getGraphicData():null,!!this.Bzh,this.Bzh,a)}closeEditor(){this.S$h();this.dispose()}zX(a){this.S$h(2===a)}}Object(t.a)(pL,"ReactGraphicsEditorDialog",xg.a,[]);class qL{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je){this.hUb=this._context=
null;this.Maj=(Le,Ve=!0)=>{this.Nyb.setGraphicData(Le);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");Le=performance.getEntriesByName("EditorLaunch");k.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${Ve} Duration: ${Le[Le.length-1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");performance.clearMeasures("EditorLaunch")};this.ga=a;this.va=d;this.wgf=n;this.si=
z;this.yx=O;this.Gj=ca;this.Nyb=new nL;this.Nb=Xa;this.Ha=zb;this.D1=Vb;this.In=Fc;this.Ja=yd;this.nf=Yc;this.gN=je}lb(){let a=!0;this.va.ea("GraphicsEditorActorRegistrationUpdateIsEnabled")||(a=this.Ja&&this.Ja.isFeatureEnabled(81));a&&!I.a.Ah&&(this.ga.Aa(Dc.a.graphicsEditor,Kb.a.view,Object(m.a)(this,this.Zun,"showGraphicsEditorDialogActionHandler"),4),this.ga.Aa(Mb.a.gse,Kb.a.view,Object(m.a)(this,this.EVl,"handleEditExistingContent"),4),this.ga.Aa(Dc.a.Zii,Kb.a.view,Object(m.a)(this,this.FVl,
"handleEditIllustrationContextMenu"),4))}Zun(a,d,n,z,O){const ca=!!O&&Object(Uc.a)(E.a,O);try{if(1===n){const Da=d.view;return this.si.KGa(d)&&Da.features.qXd?32:8}k.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${ca}`);performance.mark("LaunchStart");this._context=d;this.hUb=(new pL(this.Nyb,Object(m.a)(this,this.vGg,"onCloseDialog"),ca?O:null,d,this.nf)).Yun().then(()=>{k.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${ca}`)}).catch(()=>
{this.hhi()});if(!ca){const Da=Vb=>{this.hUb.then(()=>{this.Maj(Vb,!1)})};if(l.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===l.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return Da(JSON.stringify({elements:[]})),32;let Xa=null;Xa=jm.PageNavigator.instance.kt(d.view.xc);const zb=Xa.properties.fa(Qb.a.Z3f,"");if(0<zb.length)return Da(zb),32;this.wgf.ahn(d,E.a.create(),xa.a.create()).then(Vb=>{const Fc=this.Nb.Wb(0,Mb.a.rHc);Fc.Sa(Xa);Xa.setValue(Qb.a.Z3f,Vb);Fc.dispose();
Da(Vb);return null}).catch(()=>{this.hhi()})}return 32}catch(Da){return k.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",Da.toString(),ca),8}}hhi(){const a=new $g.StandardDialog;a.wc=0;a.aw(tl.a.cse,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,null);Lb.App.oa.updateCommandUI()}EVl(a,d,n,z,O){if(!d.view.features.qXd)return 32;k.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");
this.Xii(O,d);return 32}FVl(a,d,n){if(1===n)return d.view.features.qXd?32:8;if(2===n){a=Kd.ImageReader.$k(d.Am);if(!a)return 2;k.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.Xii(a,d);return 32}return 2}Xii(a,d){var n=a.fa(bd.a.$Lb,1);const z=a.fa(lh.a.n4,0);n&&1!==z?a.fa(Qb.a.dPf,!1)?(d=new $g.StandardDialog,d.wc=0,d.aw(tl.a.cse,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null),Lb.App.oa.updateCommandUI()):
(this.ga.ob(Dc.a.graphicsEditor,2,a.id),this.hUb||(k.ULS.sendTraceTag(574997639,3001,10,"GraphicsEditorDialogInitialization promise was null!"),this.hUb=new Promise(O=>{O(null)})),n=xa.a.create(),a=new mL(a,this.Maj,jn.a.instance,this.hUb,this.In,this.va,this.Ja,Lb.App.instance.TFe(this.In.ml(a))),this.wgf.$Zg(a,d,!0,n)):k.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}vGg(a,d,n,z){var O;this.Nyb.teardown();if(d&&this._context){var ca=this._context.view.Oa.Ag,
Da=ca.node;ca.Cj&&Bd.ParagraphReader.nb(Da)&&(ca=null===(O=this.gN)||void 0===O?void 0:O.XP(Da),27==(null===ca||void 0===ca?void 0:ca.role)&&k.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",z,z?" Everything deleted: "+(0==(null===a||void 0===a?void 0:a.json.length)):""))}if(z)if(k.ULS.sendTraceTag(541714E3,3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(a)if(z=a.json,O=a.width,Da=a.height,z.length||d)if(!z.length&&d)if(d=this._context.Am){d=
d.node;if(Kd.ImageReader.eQ(d)){if(!this.si.G5m(d,new Dd.GraphIterator,aj.a.instance,bL.DeleteActor.Txc)){k.ULS.sendTraceTag(588817116,3001,10,"Failed to remove anchored image.");return}}else if(!this.si.jjc(d,n,this.Ha,this.D1)){k.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}k.ULS.sendTraceTag(572363226,3001,50,"Graphic removed thru dialog.")}else k.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else ca=new RP.a(this._context,
l.AFrameworkApplication.la.tUa,!0,this.si,this.va,jm.PageNavigator.instance),a=xa.a.create(),n=new EK.a(ca,z,this.yx,this.Gj,a,jn.a.instance,d,n,this.si,this.In,O,Da,this.va,this.D1,this.Ja,Lb.App.instance.SCd,Lb.App.instance.xzd),this.wgf.$Zg(n,this._context,d,a),this.fia();else k.ULS.sendTraceTag(541714001,3001,50,"Empty Json on new content creation when close dialog");else k.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else k.ULS.sendTraceTag(590205069,
3001,10,"GraphicsEditorActor: context cannot be null")}fia(){const a=la.a.instance.Ca("Common.ISystemInitiatedFeedback");a?a.execute(d=>{d.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):k.ULS.sendTraceTag(572352085,3001,10,"ISystemInitiatedFeedback was null")}}Object(t.a)(qL,"GraphicsEditorActor",null,[]);class rL{Psn(a){return Bd.ParagraphReader.qla(this.Txi(a))}tXe(a,d){if(a=Bd.ParagraphReader.WHa(this.Txi(a)))d=a.Qd(d),Object(Uc.a)(560,d)&&d.tXe()}Txi(a){return a&&a.Cj&&a?a.node:
null}}Object(t.a)(rL,"IFrameFocusStrategy",null,[561]);class sL{constructor(a){this.eQa=null;this.IUb=a}h1i(){k.ULS.sendTraceTag(25007835,375,50,"Ignore all spelling error triggered")}cMj(a){if(!a)return k.ULS.sendTraceTag(25007836,375,15,"Error range is null"),!1;if(!a.errorDetails)return k.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!a.errorDetails.token)return k.ULS.sendTraceTag(25007838,375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(a.errorDetails).toString()),
!1;this.eQa=w.a.FYd(a.errorDetails.token,a.errorDetails.lcid);this.IUb.add(this.eQa,a.errorDetails.lcid);return!0}TSc(a){return a?a.token?w.a.FYd(a.token,a.lcid)===this.eQa:(k.ULS.sendTraceTag(25007840,375,15,"ErrorDetails Token is null"),!1):(k.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(t.a)(sL,"IgnoreAllProofingErrorStrategy",null,[559]);var WP=b(1197),TG=b(505);class tL{constructor(a,d){this.filename=a;this.blob=d}}Object(t.a)(tL,"UploadBlobParameters",
null,[]);class uL extends ll{constructor(a,d,n,z,O,ca,Da,Xa=null){super(a,d,n,null,O,ca,!1);this.nek="DragAndDrop";this.ewh="FileName";this.hwh=0;this.kRh=null;this.$3e=this.SCc=!1;this.vuh=z;this.aKh=Xa}get gca(){return this.nek}get fileExtension(){return this.ewh}get fileSize(){return this.hwh}get KQj(){return this.kRh}jXd(a){const d=new tL(this.vuh.name,this.vuh);a.AGj(d);this.kRh=a.rBb}h4a(a,d){this.aKh&&this.aKh();super.h4a(a,d)}UQn(a){const d=!!a&&this.APb(a.name,null)&&this.ggh(a,null);a&&
(this.ewh=a.name,this.hwh=a.size);d||this.sKe();return d}}Object(t.a)(uL,"DragDropInsertImageUploader",ll,[]);class Bt{constructor(a,d,n,z,O){this.lLe=this.mLe=this.ELe=this.FLe=0;this.ga=null;this.si=a;this.Wl=d;this.hd=n;this.eh=z;this.Da=O;this.q5c=l.AFrameworkApplication.K.ea("SupportImageDragDropExternalIsEnabled")}get yc(){return mi.PageReader.instance}get HX(){return this.Wl.instance}get Tb(){return this.ga}h4l(){this.FLe=rf.a.hl(1,0);this.ELe=rf.a.hl(1,1);this.mLe=rf.a.hl(1920,0);this.lLe=
rf.a.hl(1280,1)}lb(a){this.ga=a;const d=Object(m.a)(this,this.JQm,"pictureToolsTabViewHandler"),n=Object(m.a)(this,this.d6l,"insertPictureDialogView"),z=Object(m.a)(this,this.XGb,"insertPicture"),O=Object(m.a)(this,this.HUl,"growShrinkImage");a.Aa(Mb.a.G7,Kb.a.view,n,1284);a.ma(Mb.a.XGb,Kb.a.Ub,z);a.ma(Mb.a.XGb,Kb.a.image,z);a.$b(Mb.a.XGb,1284);a.Aa(Mb.a.dkd,Kb.a.view,n,1284);a.Aa(Mb.a.kme,Kb.a.view,d,1028);this.Us(a,Mb.a.Oxd,O);this.Us(a,Mb.a.b_e,O);this.Us(a,Mb.a.qic,Object(m.a)(this,this.qic,"queryImageResize"));
this.Us(a,Mb.a.mLb,Object(m.a)(this,this.mLb,"queryImageAbsoluteHeight"));this.Us(a,Mb.a.nLb,Object(m.a)(this,this.nLb,"queryImageAbsoluteWidth"));this.Us(a,Mb.a.$7a,Object(m.a)(this,this.$7a,"queryImageAltTextTitle"));this.Us(a,Mb.a.Z7a,Object(m.a)(this,this.Z7a,"queryImageAltTextDescription"));this.Us(a,Mb.a.zac,Object(m.a)(this,this.zac,"imageResize"));this.Us(a,Mb.a.PTd,Object(m.a)(this,this.vIa,"imageAbsoluteHeight"));this.Us(a,Mb.a.QTd,Object(m.a)(this,this.wIa,"imageAbsoluteWidth"));this.Us(a,
Mb.a.oSc,Object(m.a)(this,this.pnb,"imageAltTextTitle"));this.Us(a,Mb.a.YMb,Object(m.a)(this,this.dY,"imageAltTextDescription"));this.Us(a,Mb.a.qLb,Object(m.a)(this,this.qLb,"queryImageLockAspectRatio"));this.Us(a,Mb.a.uS,Object(m.a)(this,this.uS,"imageLockAspectRatio"));this.Us(a,Mb.a.Wre,Object(m.a)(this,this.Wre,"downloadImage"));this.q5c&&a.Aa(Mb.a.mYf,Kb.a.view,Object(m.a)(this,this.ddl,"dropLocalImagesContent"),4);a.$b(Mb.a.Oxd,4);a.$b(Mb.a.b_e,4);a.$b(Mb.a.qic,69);a.$b(Mb.a.mLb,69);a.$b(Mb.a.nLb,
69);a.$b(Mb.a.qLb,69);a.$b(Mb.a.$7a,69);a.$b(Mb.a.Z7a,69);a.$b(Mb.a.uS,4);a.$b(Mb.a.zac,4);a.$b(Mb.a.PTd,4);a.$b(Mb.a.QTd,4);a.$b(Mb.a.oSc,4);a.$b(Mb.a.YMb,4);this.h4l()}Us(a,d,n){a.ma(d,Kb.a.image,n);a.ma(d,Kb.a.dTa,n);a.ma(d,Kb.a.Lc,n);a.ma(d,Kb.a.anchoredObject,n)}Wre(a,d,n){if(Lb.App.WCc)return 8;a=d.node;return 1===n?a?32:2:2===n?(n=Kd.ImageReader.$k(d),d=Kd.ImageReader.QFb(n,d.node.Zg().kd,l.AFrameworkApplication.K,l.AFrameworkApplication.la.tUa),ds(d),32):2}d6l(a,d,n){const z=this.si.KGa(d);
if(2===n&&z){if(Mb.a.G7===a||Mb.a.dkd===a)l.AFrameworkApplication.Ksa?l.AFrameworkApplication.PZe():this.k3k(d);return 32}return 1!==n||Mb.a.G7!==a&&Mb.a.dkd!==a?2:z?32:2}k3k(a){new ll(a,th.a.instance,l.AFrameworkApplication.K,null,this.eh,this.ga)}XGb(a,d,n,z,O){return this.si.KGa(d)?1===n?32:this.si.Ikg(d,O)?32:2:2}aRn(a){return this.yc.L7?(Bt.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(Bt.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.Smi}),!1):Bt.If.E3(a)?(Bt.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.CF}),
!1):this.HX&&this.HX.l0(a)?(Bt.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.externalSelection}),!1):!0}obm(a){const d=Kd.ImageReader.$k(a);return d&&5===Kd.ImageReader.ml(d)&&this.VQi(a,d)}VQi(a,d){(d=!Kd.ImageReader.JFb(d)&&!Kd.ImageReader.$Fe(d))||Bt.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.woe});return d&&this.aRn(a)}pon(){if(this.Da&&this.Da.ya&&this.Da.ya.Ba){const a=this.Da.ya.Ba.ra;a&&this.Da.setSelection(ye.SelectionFactory.Pc(a.node,a.cpBegin))}}u5l(a,d){d=new uL(d,th.a.instance,l.AFrameworkApplication.K,a,this.eh,
this.ga,this.Da,Object(m.a)(this,this.pon,"setSelectionForUpload"));if(!d.UQn(a))return ja.Health.instance.recordQosError("PictureDragDropInvalid",["ImageInsertFailed"],!0,!0,!1,!1,null),k.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new vn.a(document.body,Object(m.a)(d,d.oOc,"onUploadFrameInitialized"),Object(m.a)(d,d.ELa,"uploadResponseReceived"),l.AFrameworkApplication.K,!1,void 0,Uo.a(l.AFrameworkApplication.K));return!0}ddl(a,d,n,z,O){k.ULS.sendTraceTag(42530333,307,50,"Drag and drop local content");
if((a=O.DataTransfer)&&a.files&&0<a.files.length){k.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",a.files.length));for(n=0;n<a.files.length;n++)z=a.files[n],0<=w.a.He(z.type).indexOf("image")&&this.u5l(z,d)&&(z=this.Da.ya.Ba.ra,this.Da.setSelection(ye.SelectionFactory.Pc(z.node,z.cpBegin+1)));this.a_a();return 32}k.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");return 2}wU(a){return this.obm(a)}gRa(a){const d=Kd.ImageReader.$k(a);if(!d)return!1;const n=
la.a.instance.sa("Box4.IFeatureHelper"),z=Kd.ImageReader.ml(d);return 5===z||10===z||48===z||11===z||n&&n.isFeatureEnabled(81)&&4===z?this.VQi(a,d):!1}JQm(a,d,n,z,O){if(2===n)return l.AFrameworkApplication.pa.rf(d.Am,a,n,!0,z,O);if(!d.view.Yd)return this.TOc(!1),8;a=d.view;if(!a.Oa)return this.TOc(!1),8;a=Bt.jg.yF(a.Oa.Ag);if(1!==a.length)return this.TOc(!1),8;if(this.wU(a[0]))return this.Lpm(),this.TOc(!0),32;this.TOc(!1);return 8}HUl(a,d,n){if(!this.wU(d))return 8;const z=Kd.ImageReader.$k(d),O=
Kd.ImageReader.Tz(z),ca=Kd.ImageReader.UA(z);a=a===Mb.a.Oxd;k.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:a});if(1===n)return this.yc.L7||Kd.ImageReader.TIa(z)?2:a&&O<this.mLe&&ca<this.lLe||!a&&O>this.FLe&&ca>this.ELe?32:2;n=a?1.1:.9;this.setSize(z,d,O*n,ca*n,!0);return 32}setSize(a,d,n,z,O=!1){uf.a.instance.J(4)&&Lb.App.lc.eq&&Lb.App.lc.Mp.MJ(d.node);const ca=Kd.ImageReader.SIa(a);let Da=1;n>this.mLe?Da=this.mLe/n:n<this.FLe&&(Da=this.FLe/n);let Xa=1;z>this.lLe?Xa=this.lLe/
z:z<this.ELe&&(Xa=this.ELe/z);if(ca||O)Da=Math.min(Da,Xa),Xa=Math.min(Da,Xa);1!==Da&&(n*=Da);1!==Xa&&(z*=Xa);this.MXf(a,d,n,z)}MXf(a,d,n,z){this.si.Syj(a,d,n,z)}qic(a,d,n,z,O){if(!this.gRa(d))return 8;a=Kd.ImageReader.$k(d);d=Kd.ImageReader.Kra(a);n=Kd.ImageReader.Jra(a);if(0>=d||0>=n)return 2;a=Kd.ImageReader.Tz(a)/d*100;O.setValue(Xc.a.tIc,a);return 32}zac(a,d,n,z,O){if(!this.gRa(d))return 8;a=Kd.ImageReader.$k(d);if(1===n)return this.yc.L7||Kd.ImageReader.TIa(a)?2:32;k.ULS.sendTraceTag(20459937,
322,50,"Change image scale.");n=O.fa(Xc.a.tIc,-1)/100;z=O.fa(Xc.a.Aig,!1);const ca=O.fa(Xc.a.jDe,!0);O=O.fa(Xc.a.kDe,!0);if(0>=n)return Bt.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.bob}),2;const Da=Kd.ImageReader.Kra(a),Xa=Kd.ImageReader.Jra(a),zb=Kd.ImageReader.Tz(a),Vb=Kd.ImageReader.UA(a);if(0>=Da||0>=Xa)return Bt.Lb.mb(Ee.a.u1,{["Reason"]:Jf.a.bob}),2;z?(z=ca?n*zb:zb,n=O?n*Vb:Vb):(z=ca?n*Da:zb,n=O?n*Xa:Vb);this.setSize(a,d,z,n);uf.a.instance.J(4)&&Lb.App.lc.eq&&Lb.App.lc.Mp.MJ(d.node);this.a_a();return 32}mLb(a,
d,n,z,O){if(!this.wU(d))return 8;a=Kd.ImageReader.$k(d);a=Kd.ImageReader.UA(a);if(0>=a)return 2;O.setValue(Xc.a.vIa,a);return 32}vIa(a,d,n,z,O){if(!this.gRa(d))return 8;a=Kd.ImageReader.$k(d);if(1===n)return this.yc.L7||Kd.ImageReader.TIa(a)?2:32;k.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");n=O.fa(Xc.a.vIa,0);O=Kd.ImageReader.SIa(a);if(0>=n)return Bt.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.bob}),2;z=Kd.ImageReader.Kra(a);const ca=Kd.ImageReader.Jra(a),Da=Kd.ImageReader.Tz(a);var Xa=
Kd.ImageReader.UA(a);Xa=Da/Xa;if(0>=z||0>=ca)if(Bt.Lb.mb(Ee.a.u1,{["Reason"]:Jf.a.bob}),this.mBj(a))return 2;this.setSize(a,d,O?n*Xa:Da,n);uf.a.instance.J(4)&&Lb.App.lc.eq&&Lb.App.lc.Mp.MJ(d.node);Lb.App.oa.updateCommandUI();return 32}nLb(a,d,n,z,O){if(!this.wU(d))return 8;a=Kd.ImageReader.$k(d);a=Kd.ImageReader.Tz(a);if(0>=a)return 2;O.setValue(Xc.a.wIa,a);return 32}wIa(a,d,n,z,O){if(!this.gRa(d))return 8;a=Kd.ImageReader.$k(d);if(1===n)return this.yc.L7||Kd.ImageReader.TIa(a)?2:32;k.ULS.sendTraceTag(20459939,
322,50,"Change image absolute width.");n=O.fa(Xc.a.wIa,0);O=Kd.ImageReader.SIa(a);if(0>=n)return Bt.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.bob}),2;z=Kd.ImageReader.Kra(a);const ca=Kd.ImageReader.Jra(a);var Da=Kd.ImageReader.Tz(a);const Xa=Kd.ImageReader.UA(a);Da=Xa/Da;if(0>=z||0>=ca)if(Bt.Lb.mb(Ee.a.u1,{["Reason"]:Jf.a.bob}),this.mBj(a))return 2;this.setSize(a,d,n,O?n*Da:Xa);uf.a.instance.J(4)&&Lb.App.lc.eq&&Lb.App.lc.Mp.MJ(d.node);Lb.App.oa.updateCommandUI();return 32}qLb(a,d,n,z,O){if(!this.wU(d))return 8;
a=Kd.ImageReader.$k(d);a=Kd.ImageReader.SIa(a);O.setValue(Xc.a.uS,a);return 32}uS(a,d,n,z,O){if(!this.wU(d))return 8;a=Kd.ImageReader.$k(d);if(1===n&&this.yc.L7)return 2;uf.a.instance.J(4)&&Lb.App.lc.eq&&Lb.App.lc.Mp.MJ(d.node);O&&(d=O.fa(Xc.a.uS,!0),k.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this.si.wxj(a,d),Lb.App.oa.updateCommandUI());return 32}$7a(a,d,n,z,O){if(!this.wU(d))return 8;a=Kd.ImageReader.$k(d);a=Kd.ImageReader.e4(a);O.setValue(Xc.a.pnb,a);return 32}pnb(a,
d,n,z,O){if(!this.wU(d))return 8;if(1===n)return this.yc.L7?2:32;if(uf.a.instance.J(4)&&Lb.App.lc.eq&&(a=d.node.fa(bd.a.wH,Re.a.Do),a!==Re.a.Do&&(a=Lb.App.lc.Mp.Tlb(a),TG.CoauthLockEditor.getInstance().hDa(a))))return Bt.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.CF}),2;a=Kd.ImageReader.$k(d);O=O.fa(Xc.a.pnb,null);this.si.uln(a,d,O);k.ULS.sendTraceTag(21297027,322,50,"Change image alt text.");this.hd.Ws(13);return 32}Z7a(a,d,n,z,O){if(!this.wU(d))return 8;a=Kd.ImageReader.$k(d);a=Kd.ImageReader.XHa(a);O.setValue(Xc.a.dY,
a);return 32}dY(a,d,n,z,O){if(!this.wU(d))return 8;if(1===n)return this.yc.L7?2:32;if(uf.a.instance.J(4)&&Lb.App.lc.eq&&(a=d.node.fa(bd.a.wH,Re.a.Do),a!==Re.a.Do&&(a=Lb.App.lc.Mp.Tlb(a),TG.CoauthLockEditor.getInstance().hDa(a))))return Bt.Lb.mb(Ee.a.oo,{["Reason"]:Jf.a.CF}),2;a=Kd.ImageReader.$k(d);O=O.fa(Xc.a.dY,null);this.si.tln(a,d,O);k.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");this.hd.Ws(13);return 32}Lpm(){k.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")}a_a(){l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.ea("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const a=la.a.instance.Ca("Common.ISystemInitiatedFeedback");a&&a.execute(d=>{d.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}mBj(a){const d=Kd.ImageReader.Kra(a);a=Kd.ImageReader.Jra(a);return 0>=d||0>=a}TOc(){}static get jg(){return bl.ContextSetEditor.instance}static get If(){return aj.a.instance}static get Lb(){return Ch.a.instance}}Object(t.a)(Bt,"ImageActor",
null,[]);var vL=b(494),UG=b(1013),VG=b(1014),pF=b(635),XP=b(447);class Lr extends Bt{constructor(a,d,n,z,O,ca,Da,Xa,zb){super(a,d,z,ca,Xa);this.SEh=!1;this.vAb=this.D2=null;this.Vjf=this.gYb=!1;this.YO=a;this.wad=n;this.Lde=O;this.Ja=Da;this.gh=zb}get recentColors(){return this.vAb||(this.vAb=la.a.instance.sa("Box4.UI.RecentColorsSectionHandler"))}get $n(){this.D2||(this.D2=new vL.a);return this.D2}lb(a){super.lb(a);this.Us(a,Mb.a.dy,Object(m.a)(this,this.dy,"setPictureStyle"));a.$b(Mb.a.dy,4);this.Us(a,
Mb.a.zRd,Object(m.a)(this,this.zRd,"resetPicture"));this.Us(a,Dc.a.wrapText,Object(m.a)(this,this.vHc,"handleWrapTextAction"));a.$b(Dc.a.wrapText,4);this.Us(a,Dc.a.l5e,Object(m.a)(this,this.vHc,"handleWrapTextAction"));this.Us(a,Dc.a.m5e,Object(m.a)(this,this.vHc,"handleWrapTextAction"));this.Us(a,Dc.a.n5e,Object(m.a)(this,this.vHc,"handleWrapTextAction"));this.Us(a,Dc.a.o5e,Object(m.a)(this,this.vHc,"handleWrapTextAction"));this.Us(a,Dc.a.p5e,Object(m.a)(this,this.vHc,"handleWrapTextAction"));this.Us(a,
Dc.a.aQc,Object(m.a)(this,this.aQc,"queryWrapTextProperties"));a.$b(Dc.a.aQc,101);this.Us(a,Dc.a.imageCrop,Object(m.a)(this,this.cWl,"handleImageCropAction"));a.$b(Dc.a.imageCrop,4);this.Us(a,Dc.a.pLb,Object(m.a)(this,this.pLb,"queryImageCrop"));a.$b(Dc.a.pLb,101);this.Us(a,Dc.a.JLi,Object(m.a)(this,this.dWl,"handleImageCropApplyAction"));this.Us(a,Dc.a.nzd,Object(m.a)(this,this.YBe,"handleImageCropFromSpinners"));this.Us(a,Dc.a.kzd,Object(m.a)(this,this.YBe,"handleImageCropFromSpinners"));this.Us(a,
Dc.a.lzd,Object(m.a)(this,this.YBe,"handleImageCropFromSpinners"));this.Us(a,Dc.a.mzd,Object(m.a)(this,this.YBe,"handleImageCropFromSpinners"));this.Us(a,Dc.a.fOd,Object(m.a)(this,this.CPc,"queryImageCropDimensions"));a.$b(Dc.a.fOd,101);this.Us(a,Dc.a.uSe,Object(m.a)(this,this.CPc,"queryImageCropDimensions"));a.$b(Dc.a.uSe,101);this.Us(a,Dc.a.vSe,Object(m.a)(this,this.CPc,"queryImageCropDimensions"));a.$b(Dc.a.vSe,101);this.Us(a,Dc.a.wSe,Object(m.a)(this,this.CPc,"queryImageCropDimensions"));a.$b(Dc.a.wSe,
101);this.Us(a,Mb.a.imageRotate,Object(m.a)(this,this.gWl,"handleImageRotateAction"));a.$b(Mb.a.imageRotate,4);this.Us(a,Mb.a.oLb,Object(m.a)(this,this.oLb,"queryImageAngle"));a.$b(Mb.a.oLb,101);this.Us(a,Mb.a.dPc,Object(m.a)(this,this.dPc,"populatePictureBorderColor"));a.$b(Mb.a.dPc,4);this.Us(a,Mb.a.G8,Object(m.a)(this,this.G8,"setPictureBorderColor"));a.$b(Mb.a.G8,4);this.Us(a,Mb.a.vSc,Object(m.a)(this,this.G8,"setPictureBorderColor"));a.$b(Mb.a.vSc,4);this.Us(a,Mb.a.CPe,Object(m.a)(this,this.mta,
"openMoreColorsDialog"));a.$b(Mb.a.CPe,4);this.Us(a,Mb.a.BCa,this.BCa.bind(this));a.$b(Mb.a.BCa,4);this.Us(a,Mb.a.Jha,Object(m.a)(this,this.Jha,"setPictureBorderWeight"));a.$b(Mb.a.Jha,4);this.Us(a,Mb.a.sLb,this.sLb.bind(this));a.$b(Mb.a.sLb,4);this.Us(a,Mb.a.$Xa,Object(m.a)(this,this.$Xa,"setPictureBorderStyle"));a.$b(Mb.a.$Xa,4);this.Us(a,Mb.a.wMe,Object(m.a)(this,this.vQd,"removePictureBorder"));a.$b(Mb.a.wMe,4)}MXf(a,d,n,z){k.ULS.sendTraceTag(593372313,322,50,"Applying New Image Resize, isCanvas: "+
Kd.ImageReader.qJc(a));this.YO.rsa()&&this.YO.KYd(a,d);if(Kd.ImageReader.Aw(a)){a=xa.a.create();const O=new Ff.GraphTransaction(15);O.Sa(d.node);this.Lde.cYm(d,Kd.ImageReader.$k(d),n,z,a);O.AJa(a,1);O.dispose()}else Kd.ImageReader.NNb(a)?(new UG.a(a,new VG.a)).Gnn(n,z,Object(m.a)(this,this.cJm,"onResizeComplete"),d):(super.MXf(a,d,n,z),this.hd.Ws(13))}wU(a){if(!a.Cj)return!1;const d=Object(qa.a)(ss.a,a.node);return d&&Ky.j(d)?(Bt.Lb.mb(WP.a.oo,{["Reason"]:Kw.a.qP}),!1):super.wU(a)}VJb(){this.gh.sjc(Object(m.a)(this,
this.VJb,"onCommandUiUpdateHandler"));this.gYb=!1;const a=appChrome.selectors.getActiveContextualTabIds();this.Vjf=!1;"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(a,"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))}TOc(a){a?Lr.DTi&&!this.gYb&&this.Vjf?(this.gh.m2a(Object(m.a)(this,this.VJb,"onCommandUiUpdateHandler")),this.gYb=!0,this.fia("SimplifyRibbonContextualCommandsUsageTreatment","EnableAutoContextualTabSwitch")):this.fia("SimplifyRibbonContextualCommandsUsageControl",
"DefaultContextTabBehaviour"):Lr.DTi&&(this.Vjf=!0)}fia(a,d){const n=la.a.instance.Ca("Common.ISystemInitiatedFeedback");n&&n.execute(z=>{z.logActivity(a,d)})}dy(a,d,n,z,O){if(!this.wU(d))return 8;if(1===n)return this.yc.L7?2:32;a=parseInt(O);k.ULS.sendTraceTag(593372312,322,50,"SetPictureStyle: "+a);this.Lde.fYm(d,Kd.ImageReader.$k(d),a);this.KGd(d);this.a_a();return 32}zRd(a,d,n){if(!this.wU(d))return 8;k.ULS.sendTraceTag(593372311,322,50,"Applying Style Reset");a=Kd.ImageReader.$k(d);if(1===n)return this.yc.L7?
2:32;n=Kd.ImageReader.Fra(a);1===n?(n=new Ff.GraphTransaction(15),n.Sa(d.node),Kd.ImageReader.L5a()?a.setValue(Qb.a.zhc,""):this.YO.n6m(a),n.dispose(),this.wad.create(a,d).dy(We.a.KWg),this.KGd(d)):2===n&&this.wad.create(a,d).dy(We.a.KWg);return 32}cWl(a,d,n,z,O){if(!this.wU(d))return 8;a=Kd.ImageReader.$k(d);if(1===n)return this.yc.L7||Kd.ImageReader.Mob(a)?2:32;O&&(this.YO.KYd(a,d),k.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),Lb.App.oa.updateCommandUI());this.a_a();return 32}dWl(a,
d,n,z,O){if(!this.wU(d))return 8;if(1===n)return this.yc.L7?2:32;a=Kd.ImageReader.$k(d);if(O){n=Kd.ImageReader.qJc(Kd.ImageReader.$k(d));k.ULS.sendTraceTag(22381022,322,50,"Applying New Image Cropping, isCanvas: "+n);z=O.fa(Xc.a.tnb,0);const ca=O.fa(Xc.a.qnb,0),Da=O.fa(Xc.a.rnb,0);O=O.fa(Xc.a.snb,0);const Xa=Kd.ImageReader.zba(a),zb=Kd.ImageReader.wba(a),Vb=Kd.ImageReader.xba(a),Fc=Kd.ImageReader.yba(a);if(z===Xa&&ca===zb&&Da===Vb&&O===Fc)return k.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),
32;n?(new UG.a(a,new VG.a)).Jjn(z,ca,Da,O,Object(m.a)(this,this.jEm,"onCroppingComplete"),d):this.Lde.YXm(d,Kd.ImageReader.$k(d),z,ca,Da,O);this.KGd(d);Lb.App.oa.updateCommandUI()}return 32}YBe(a,d,n,z,O){if(!this.wU(d))return 8;z=Kd.ImageReader.$k(d);if(1===n)return this.yc.L7||Kd.ImageReader.Mob(z)?2:32;if(O){k.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");this.YO.rsa()||this.YO.KYd(z,d);switch(a){case Dc.a.nzd:a=O.fa(Xc.a.tnb,-1);n=0;break;
case Dc.a.kzd:a=O.fa(Xc.a.qnb,-1);n=1;break;case Dc.a.lzd:a=O.fa(Xc.a.rnb,-1);n=2;break;case Dc.a.mzd:a=O.fa(Xc.a.snb,-1);n=3;break;default:return 8}this.YO.RMn(a,n);this.KGd(d);Lb.App.oa.updateCommandUI()}return 32}pLb(a,d,n,z,O){if(!this.wU(d))return 8;Kd.ImageReader.$k(d);O&&(a=this.YO.rsa(),O.setValue(Xc.a.rsa,a));return 32}CPc(a,d,n,z,O){if(!this.wU(d))return 8;d=Kd.ImageReader.$k(d);if(O){if(this.YO.rsa())({top:Da,bottom:n,left:a,right:d}=this.YO.Wwl());else{z=rf.a.ze(Kd.ImageReader.Tz(d),0);
var ca=rf.a.ze(Kd.ImageReader.UA(d),1);var Da=Math.max(Kd.ImageReader.zba(d),0);n=Math.max(Kd.ImageReader.wba(d),0);a=Math.max(Kd.ImageReader.xba(d),0);d=Math.max(Kd.ImageReader.yba(d),0);z=1E5*z/(1E5-(a+d));ca=1E5*ca/(1E5-(Da+n));Da=Math.floor(Da*ca/1E5);n=Math.floor(n*ca/1E5);a=Math.floor(a*z/1E5);d=Math.floor(d*z/1E5)}O.setValue(Xc.a.tnb,Da);O.setValue(Xc.a.qnb,n);O.setValue(Xc.a.rnb,a);O.setValue(Xc.a.snb,d)}return 32}vHc(a,d,n,z,O){if(!this.wU(d))return 8;if(1===n){if(this.yc.L7||this.Ja&&!this.Ja.isFeatureEnabled(220))return 2;
this.dsm();return 32}a=Kd.ImageReader.$k(d);this.YO.rsa()&&this.YO.KYd(a,d);a=O.fa(Xc.a.cLa,"");O=O.fa(Xc.a.m$a,0);k.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:O,["SourceControlId"]:a});switch(O){case 1:this.YO.dpn(d);break;case 8:this.YO.pYe(d,1,1);break;case 9:this.YO.pYe(d,1,3);break;case 3:this.YO.pYe(d,2,void 0,!0);break;case 4:this.YO.pYe(d,2,void 0,!1)}this.a_a();Lb.App.oa.updateCommandUI();return 32}aQc(a,d,n,z,O){if(!this.wU(d))return 8;a=Kd.ImageReader.$k(d);d=Kd.ImageReader.m0(d);
n=Kd.ImageReader.job(a);z=Kd.ImageReader.fGb(a);a=Kd.ImageReader.Jv(a);return this.XXm(d,n,z,a,O)?32:8}XXm(a,d,n,z,O){return O?(O.ORi=a,O.job=d,O.Vub=n,O.Kt=z,O.m$a=Lr.CTl(O),!0):!1}gWl(a,d,n,z,O){if(!this.gRa(d))return 8;z=Kd.ImageReader.$k(d);if(1===n)return Yb.SessionStatusManager.instance.oj?8:this.yc.L7||Kd.ImageReader.Nob(z)?2:32;this.YO.rsa()&&this.YO.KYd(z,d);if(O){var ca=O.fa(Xc.a.sIc,0);const Da=Kd.ImageReader.qJc(z);k.ULS.sendTraceTag(22052889,322,50,"SetImageRotateAction: {0}, isCanvas: {1}",
ca,Da);n=Kd.ImageReader.WX(z);let Xa=Kd.ImageReader.Nud(z),zb=Kd.ImageReader.Hlb(z);switch(ca){case 0:n=O.fa(Xc.a.pH,0);break;case 2:n-=90;n=wk.c(n);break;case 1:n+=90;n=wk.c(n);break;case 4:Xa=!Xa;break;case 3:zb=!zb}Da?(new UG.a(z,new VG.a)).Vnn(n,Xa,zb,Object(m.a)(this,this.rJm,"onRotationComplete"),d):ca?this.wad.create(z,d).rnn(n,Xa,zb):(O=xa.a.create(),ca=new Ff.GraphTransaction(15,Mb.a.imageRotate),ca.Sa(d.node),this.YO.Cln(z,n),this.Lde.dYm(d,Kd.ImageReader.$k(d),n,O),ca.AJa(O,1),ca.om=a,
ca.dispose());this.a_a();this.KGd(d);Lb.App.oa.updateCommandUI()}return 32}oLb(a,d,n,z,O){if(!this.wU(d))return 8;a=Kd.ImageReader.$k(d);a=Kd.ImageReader.WX(a);if(0>a)return 2;O.setValue(Xc.a.pH,a);return 32}KGd(a){uf.a.instance.J(4)&&Lb.App.lc.eq&&Lb.App.lc.Mp.MJ(a.node)}dsm(){this.SEh||(k.ULS.sendTraceTag(20459971,322,50,"Wrap Text UI enabled."),this.SEh=!0)}rJm(a,d,n,z){if(a){const O=new Ff.GraphTransaction(15,Mb.a.imageRotate);O.Sa(z.node);d.setValue(Xc.a.ICb,JSON.stringify(n));d.setValue(Xc.a.ZB,
a);this.YO.CXe(d,n.rotationAngle,n.dIc,n.VVc);this.A8b(d);O.dispose()}}cJm(a,d,n,z){if(a){const O=new Ff.GraphTransaction(15);O.Sa(z.node);d.setValue(Xc.a.ICb,JSON.stringify(n));d.setValue(Xc.a.ZB,a);this.YO.lXe(d,n.$2e,n.YZd);this.A8b(d);O.dispose()}}jEm(a,d,n,z){if(a){const O=new Ff.GraphTransaction(15);O.Sa(z.node);d.setValue(Xc.a.ICb,JSON.stringify(n));d.setValue(Xc.a.ZB,a);this.YO.xln(d,Math.round(n.CDb*pF.a.ADb),Math.round(n.yDb*pF.a.ADb),Math.round(n.zDb*pF.a.ADb),Math.round(n.BDb*pF.a.ADb));
this.A8b(d);O.dispose()}}A8b(a){const d=XP.a.instance.Eqd(a);this.YO.AXe(a,d[0],d[1],d[2],d[3])}dPc(a,d,n,z,O){if(!this.gRa(d))return 8;if(1===n)return 32;a=d.contextId===Kb.a.view?mi.PageReader.instance.Ivd(d):jm.PageNavigator.instance.kt(d.node);if(!a)return 8;n=Kd.ImageReader.$k(d);d=this.$n.Dag(zh.a.VX(d),n);Lr.Gej.KRc=d;d=Lr.Gej.Ave(a,Lb.App.S4b);if(!d)return 8;O.MenuItems=d;return 32}G8(a,d,n,z,O){if(!this.gRa(d))return 8;if((z=Kd.ImageReader.$k(d))&&Kd.ImageReader.Aw(z))return 2;if(1===n)return 32;
if(2!==n)return 2;if(!O)return k.ULS.sendTraceTag(571287758,322,10,"SetPictureBorderColor: actionData null"),8;n=new Ff.GraphTransaction(15);n.Sa(d.node);const ca=Lr.qUc.IRa(d.node,O);this.$n.G8(z,O,d,ca);this.A8b(z);n.dispose();a==Mb.a.vSc&&this.recentColors.LBb(O);this.u2d();this.a_a();return 32}mta(a,d,n){if(!this.gRa(d))return 8;if(1===n)return 32;Lb.App.oa.OA();Lr.zxb=new Tu.a("PictureBorder",Mb.a.vSc);Lr.zxb.vVd(0);return 32}Jha(a,d,n,z,O){if(!this.gRa(d))return 8;if(1===n)return 32;if((a=Kd.ImageReader.$k(d))&&
Kd.ImageReader.Aw(a))return 2;if(!O)return k.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),8;n=new Ff.GraphTransaction(15);n.Sa(d.node);this.$n.Jha(a,O,d);this.A8b(a);n.dispose();this.u2d();this.a_a();return 32}BCa(a,d,n,z,O){2===n&&(a=Kd.ImageReader.$k(d),this.$n.Emh(O,a));return 32}$Xa(a,d,n,z,O){if(!this.gRa(d))return 8;if(1===n)return 32;if((a=Kd.ImageReader.$k(d))&&Kd.ImageReader.Aw(a))return 2;if(!O)return k.ULS.sendTraceTag(571287760,322,10,"SetPictureBorderStyle: actionData null"),
8;n=new Ff.GraphTransaction(15);n.Sa(d.node);this.$n.$Xa(a,O,d);this.A8b(a);n.dispose();this.u2d();this.a_a();return 32}sLb(a,d,n,z,O){2===n&&(a=Kd.ImageReader.$k(d),this.$n.Dmh(O,a));return 32}vQd(a,d,n){if(!this.gRa(d))return 8;if(1===n)return 32;a=Kd.ImageReader.$k(d);n=new Ff.GraphTransaction(15);n.Sa(d.node);Kd.ImageReader.Rmb(a)&&(this.$n.vQd(a),this.A8b(a));n.dispose();this.u2d();this.a_a();return 32}u2d(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("PictureBorderFloodgateSurveyIsEnabled")&&
window.setTimeout(()=>{const a=la.a.instance.Ca("Common.ISystemInitiatedFeedback");a&&a.execute(d=>{d.logActivity("PictureBorderApplied","PictureBorderFloodgateSurveyIsEnabled")})},5E3)}static get qUc(){return Lr.Ufe||(Lr.Ufe=on.a.instance)}static get DTi(){null==Lr.Wjf&&(Lr.Wjf=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAutoContextualTabSwitch",!1):!1);return Lr.Wjf}static get Gej(){Lr.F1||(Lr.F1=new zw.a("PictureBorder"),Lr.Jnb(Lr.F1));
return Lr.F1}static CTl(a){if(a.ORi)a=1;else switch(a.Vub){case 2:a=a.job?3:4;break;case 1:a=1===a.Kt?8:3===a.Kt?9:2;break;case 0:a=5;break;case 3:a=6;break;case 4:a=7;break;default:a=0}return a}static Jnb(a){a.jqa(3,Mb.a.G8);a.jqa(4,Mb.a.G8);a.jqa(5,Mb.a.vSc);a.jqa(6,Mb.a.G8);a.wyc(Jt.a.instance,1)}}Lr.F1=null;Lr.zxb=null;Lr.Ufe=null;Lr.Wjf=null;Object(t.a)(Lr,"ImageActor",Bt,[]);class dm{static get paragraphEditor(){return dm.Ki||(dm.Ki=la.a.instance.resolve("Box4.IParagraphEditor"))}static get tD(){return dm.Ck||
(dm.Ck=la.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get t8(){return dm.paragraphEditor.dr}static get eh(){return dm.Gj||(dm.Gj=la.a.instance.resolve("Box4.IUndoManager"))}static lb(){const a=l.AFrameworkApplication.pa;a.ma(Mb.a.bLb,Kb.a.view,cm.a.Nz);a.ma(Mb.a.bLb,Kb.a.paragraph,dm.Sxa);a.$b(Mb.a.bLb,1036);a.ma(Mb.a.ODb,Kb.a.view,cm.a.Nz);a.ma(Mb.a.ODb,Kb.a.paragraph,dm.Sxa);a.$b(Mb.a.ODb,1036);a.ma(Mb.a.Ajb,Kb.a.view,cm.a.Nz);a.ma(Mb.a.Ajb,Kb.a.paragraph,dm.Sxa);a.$b(Mb.a.Ajb,
1036);a.ma(Mb.a.hjc,Kb.a.view,cm.a.Nz);a.ma(Mb.a.hjc,Kb.a.paragraph,dm.Sxa);a.$b(Mb.a.hjc,1036);a.ma(Mb.a.xQc,Kb.a.view,cm.a.Nz);a.ma(Mb.a.xQc,Kb.a.paragraph,dm.Sxa);a.$b(Mb.a.xQc,1036);a.ma(Mb.a.u5a,Kb.a.view,cm.a.Nz);a.ma(Mb.a.u5a,Kb.a.paragraph,dm.Sxa);a.$b(Mb.a.u5a,1036);a.ma(Mb.a.Enb,Kb.a.view,cm.a.Nz);a.ma(Mb.a.Enb,Kb.a.paragraph,dm.Sxa);a.$b(Mb.a.Enb,1036);a.ma(Mb.a.t5a,Kb.a.view,cm.a.Nz);a.ma(Mb.a.t5a,Kb.a.paragraph,dm.Sxa);a.$b(Mb.a.t5a,1036);a.ma(Mb.a.STd,Kb.a.view,dm.x_e);a.ma(Mb.a.STd,
Kb.a.paragraph,dm.x_e);a.$b(Mb.a.STd,1028);a.ma(Mb.a.DXe,Kb.a.view,dm.x_e);a.ma(Mb.a.DXe,Kb.a.paragraph,dm.x_e);a.$b(Mb.a.DXe,1028);a.ma(Mb.a.kNb,Kb.a.view,cm.a.Nz);a.ma(Mb.a.kNb,Kb.a.paragraph,dm.Sxa);a.$b(Mb.a.kNb,1036);a.ma(Mb.a.Gtb,Kb.a.view,cm.a.Nz);a.ma(Mb.a.Gtb,Kb.a.paragraph,dm.Sxa);a.$b(Mb.a.Gtb,1036);a.ma(Mb.a.lNb,Kb.a.view,cm.a.Nz);a.ma(Mb.a.lNb,Kb.a.paragraph,dm.Sxa);a.$b(Mb.a.lNb,1036);a.ma(Mb.a.uWd,Kb.a.view,cm.a.Nz);a.$b(Mb.a.uWd,1028);a.ma(Mb.a.ASc,Kb.a.view,cm.a.Nz);a.ma(Mb.a.ASc,
Kb.a.paragraph,dm.Sxa);a.$b(Mb.a.ASc,1036);a.ma(Mb.a.BSc,Kb.a.view,cm.a.Nz);a.ma(Mb.a.BSc,Kb.a.paragraph,dm.Sxa);a.$b(Mb.a.BSc,1036)}static x_e(a,d,n,z,O){2===n&&""===O[Tg.a.Text]&&(a=a===Mb.a.STd?Mb.a.u5a:Mb.a.t5a,d=new wE.a,d.value=0,d.unit=Lb.App.Uba?2:1,l.AFrameworkApplication.pa.ob(a,2,d),Lb.App.oa.updateCommandUI());return 32}static Sxa(a,d,n,z,O){if(!({BA:n}=cm.a.b4g(n,d)).returnValue)return n;d=d.node;switch(a){case Mb.a.bLb:dm.t8.pPg(d,!0);break;case Mb.a.ODb:dm.t8.pPg(d,!1);break;case Mb.a.Ajb:dm.t8.Ajb(d);
break;case Mb.a.hjc:dm.t8.goa(d,0);break;case Mb.a.xQc:dm.t8.XMb(d,0);break;case Mb.a.Enb:case Mb.a.u5a:n=new Dd.GraphIterator;n.set(d);n.La(11);let ca=O.value;O=O.unit;a===Mb.a.Enb&&(ca=(new Ur.a(O,ca)).pu+dm.tD.ML(d).pu,O=1);dm.t8.RKa(n,O,ca);break;case Mb.a.t5a:dm.t8.clc(d,O.unit,O.value);break;case Mb.a.kNb:O?(a=(new Ur.a(O.unit,O.value)).pu,dm.t8.goa(d,a)):dm.tD.u8f(d).pu||dm.t8.goa(d,qh.OutlineReader.OP(d));break;case Mb.a.Gtb:O?(a=(new Ur.a(O.unit,O.value)).pu,dm.t8.XMb(d,a)):dm.tD.ML(d).pu||
dm.t8.XMb(d,qh.OutlineReader.OP(d));break;case Mb.a.lNb:dm.t8.goa(d,0);break;case Mb.a.ASc:a=O;a=(new Ur.a(a.unit,a.value)).pu;dm.t8.k2g(d,1,a);break;case Mb.a.BSc:a=O,a=(new Ur.a(a.unit,a.value)).pu,dm.t8.k2g(d,2,a)}dm.eh.$A();z&&ip.a.KOb&&(z.vq|=ip.a.tFb(d));return 32}}dm.Ki=null;dm.Ck=null;dm.Gj=null;Object(t.a)(dm,"IndentationActor",null,[]);var wL=b(299),YP=b(45),qF=b(418),WG=b(1052);class Kq{constructor(a){this.deb=this.yQa=this.K8c=null;this.lSh=!1;this._frame=a}nzn(){if(this.lSh)this.gXi();
else{const a=Ta.a.create(l.AFrameworkApplication.K.Ga("WopiBootstrapUrl"));a.QJ((d,n)=>{n.succeeded?(this.lSh=!0,this.gXi()):k.ULS.sendTraceTag(40436806,323,10,"Failed to download word.boot.js")});ib.a.BP(a)}}gXi(){if(this.K8c)k.ULS.sendTraceTag(38130908,323,10,"previewPanel: Tried to launch while already running");else{const a=this._frame.SV;this.yQa=document.createElement("div");a.parentNode.insertBefore(this.yQa,a);this.deb=previewPanel.FactoryGlobal.getWordDocumentPanel(this,{fileName:l.AFrameworkApplication.K.Ga("FileName"),
reactRoot:this.yQa});this.deb.setWebpackPublicPath(l.AFrameworkApplication.BQ);this.deb.renderDocumentPanel()}}IDl(a){const d={};d.Container=a;d.BootstrapperUrl=l.AFrameworkApplication.K.Ga("WopiBootstrapUrl");d.ApplicationUrl=this._frame.LLa;a={};a.HostName=l.AFrameworkApplication.K.Ga("FileSource");a.HostSessionId=l.AFrameworkApplication.K.Ga("HostSessionId");a.UserId=l.AFrameworkApplication.K.Ga("UserId");a.DocumentClickTime=new Date(this._frame.lWa);a.SessionContext="";a.WdParams={};d.SessionInformation=
a;a={};a.FileName=l.AFrameworkApplication.K.Ga("FileName");a.FileGetUrl="";a.ReadOnly=!1;a.BundleInfo={MajorVersion:1,Url:""};d.WopiPrecheckInfo=a;d.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",IsCore:!0,InAppDocumentPreview:!0};a={entryPoint:"WordEditorPreviewPanel"};a.userClickTime=this._frame.lWa;d.Diagnostics=a;a={};a.WopiSrc=l.AFrameworkApplication.K.Ga("WopiSrc");a.AccessToken=l.AFrameworkApplication.K.Ga("AccessToken");a.AccessTokenTtl=l.AFrameworkApplication.K.Ga("AccessTokenTtl");
d.WopiInfo=a;d.FnOnInitializeSuccess=n=>{Kq.d3=n;this.deb.setMaxPage(Kq.d3.GetPageCount());this.deb.setCurrentPage(Kq.d3.GetCurrentPage());this.deb.setPageControlVisible(!0);Kq.d3.RegisterEventHandler("PageChanged",z=>{this.deb.setCurrentPage(z.newPage)});Kq.d3.RegisterEventHandler("BrowserEvent",z=>{27===z.keyCode?this.closeViewer():z.button&&1!==z.button||this.yQa.click()});n=this._frame.lWa-(new Date).getTime();k.ULS.sendTraceTag(38355488,323,50,"previewPanel: Load finished - {0}",n);this.lb();
ic.FocusManager.instance().bG(Ec.AFrame.kKa,!0);this.buildFocusRegion();this.kXa(ic.FocusManager.instance().Kc(Ec.AFrame.kKa));this.yQa.click()};d.FnOnInitializeFailure=(n,z)=>{k.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",n.toString(),z.toString());this.closeViewer()};return d}buildFocusRegion(){const a=ic.FocusManager.instance();var d=a.getRegion(Ec.AFrame.kKa);d=[2,3];const n=a.Kc(Ec.AFrame.kKa),z=new kd.DOMFocusListing(()=>this.yQa);z.Una=!0;for(let O of d)z.Ln(O);d=a.jfa(()=>this.yQa,
n,z);d.wKa();d.MS=!0;d.zya=!0;z.ou(z.VU)}lb(){l.AFrameworkApplication.pa.ma(Sa.a.XMd,Cd.a.frame,Object(m.a)(this,this.IRe,"previewPanelTabsHandler"));l.AFrameworkApplication.pa.ma(Sa.a.WMd,Cd.a.frame,Object(m.a)(this,this.IRe,"previewPanelTabsHandler"))}kXa(a){a.zq(ic.FocusManager.instance().kN);a.zq(ic.FocusManager.instance().lN);a.bindAction(ic.FocusManager.instance().kN,Sa.a.XMd);a.bindAction(ic.FocusManager.instance().lN,Sa.a.WMd)}IRe(a){if(this.yQa)if(a===Sa.a.XMd)ic.FocusManager.instance().getRegion(Ec.AFrame.kKa).oWa();
else if(a===Sa.a.WMd)ic.FocusManager.instance().getRegion(Ec.AFrame.kKa).nWa();else return 2;else return 2;return 32}loadViewer(a){a=this.IDl(a);this.K8c=Microsoft.Office.Word.Viewer.InitializeWopiPending(a);this.K8c.Complete(a.WopiInfo)}closeViewer(){ic.FocusManager.instance().QI(Ec.AFrame.kKa);Kq.d3&&(Kq.d3.Dispose(),Kq.d3=null,l.AFrameworkApplication.pa.iB(Sa.a.XMd,Cd.a.frame,Object(m.a)(this,this.IRe,"previewPanelTabsHandler")),l.AFrameworkApplication.pa.iB(Sa.a.WMd,Cd.a.frame,Object(m.a)(this,
this.IRe,"previewPanelTabsHandler")));this.K8c&&(this.yQa.parentNode.removeChild(this.yQa),this.yQa=this.K8c=null)}printAction(){k.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");l.AFrameworkApplication.pa.processAction(Mb.a.print,2)}downloadPdfAction(){k.ULS.sendTraceTag(38355490,323,50,"previewPanel: Download to PDF Called");l.AFrameworkApplication.pa.processAction(Dc.a.Apd,2)}downloadCopyAction(){k.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");l.AFrameworkApplication.pa.processAction(Sa.a.downloadACopy,
2)}zoomInAction(){if(Kq.d3){let a=Kq.d3.GetZoomLevel();a+=.2;Kq.d3.SetZoomLevel(a)}}zoomOutAction(){if(Kq.d3){let a=Kq.d3.GetZoomLevel();a-=.2;Kq.d3.SetZoomLevel(a)}}setPage(a){if(Kq.d3){const d=Kq.d3.GetPageCount();1>a?(Kq.d3.SetCurrentPage(1),this.deb.setCurrentPage(1)):1<=a&&a<=d?Kq.d3.SetCurrentPage(a):(Kq.d3.SetCurrentPage(d),this.deb.setCurrentPage(d))}}static getInstance(a){Kq.qrf||(Kq.qrf=new Kq(a));return Kq.qrf}}Kq.d3=null;Kq.qrf=null;Object(t.a)(Kq,"PreviewPanelActor",null,[]);class qq{static get eSj(){return qq.RRh||
(qq.RRh=l.AFrameworkApplication.K.Ga("ClassicViewModePreferenceCookieName"))}static lb(a,d){a.Aa(Mb.a.BLb,Cd.a.frame,qq.qTj,128);a.ma(Mb.a.RTc,Cd.a.frame,qq.qTj);qq.EJ=d;a.ma(Dc.a.MFd,Cd.a.frame,qq.MFd);a.ma(Dc.a.OFd,Cd.a.frame,qq.OFd);a.Aa(Dc.a.uOd,Cd.a.frame,qq.uOd,96);a.Aa(Dc.a.NOd,Cd.a.frame,qq.NOd,96)}static qTj(a,d,n){if(d.contextId!==Cd.a.frame)return 2;d=Rj.App.wn;switch(a){case Mb.a.BLb:if(!d.LLa)return 8;if(1===n)return Yb.SessionStatusManager.instance.oj?8:32;a=(new Date).getTime();fk.a.instance.Ukj(a);
d.lWa=a;l.AFrameworkApplication.K.ea("InAppDocumentPreviewIsEnabled")?Mw.a.LX(3,!0,qq.yTm,null,d):Mw.a.LX(3,!0,qq.U5i,null,d);return 32;case Mb.a.RTc:return 32;default:return 2}}static U5i(a){qF.a()?qq.TSl(a):qq.eHj(a)}static TSl(a){const d={};d[G.a.QCe]=qq.eSj;l.AFrameworkApplication.jH().execute(n=>{n.ax(D.a.RCe);n.zJn(D.a.RCe);n.uD(D.a.RCe,z=>{qq.LPk(z,a)});n.Eh(D.a.kyi,d)})}static LPk(a,d){a.Values[G.a.QCe]===qq.eSj&&("true"===a.Values[G.a.Phg]?qq.eHj(d):(qq.RLn(),qq.uBn()))}static RLn(){if("View"!==
appChrome.selectors.getModeSwitcherMode()){const a={activeMode:"View"};l.AFrameworkApplication.Yi("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)?appChrome.dispatchUpdateAppModeAndTabsAction(a):appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(a))}}static uBn(){l.AFrameworkApplication.$r=!0;Lb.App.oa.O8(1);Lb.App.oa.za.tw&&Lb.App.oa.za.tw.gj&&Lb.App.oa.za.tw.IDe();
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",!1)&&Lb.App.oa.updateCommandUI();WG.PageView.LKj(l.AFrameworkApplication.K)}static eHj(a){try{const d=new yb.a;let n,z;l.AFrameworkApplication.Ogh?(n=Lb.App.hostUrl,z=3):(n=a.LLa,z=1);a.lWa&&d.add(l.AFrameworkApplication.oId,a.lWa.toString());l.AFrameworkApplication.DJc&&d.add(l.AFrameworkApplication.BBc,"1");l.AFrameworkApplication.kAc&&d.add(l.AFrameworkApplication.h$h,"1");d.add(wL.a.MVc,wL.a.userSessionData);
d.add(l.AFrameworkApplication.Rhc,l.AFrameworkApplication.userSessionId);const O=l.AFrameworkApplication.K.Ga(l.AFrameworkApplication.vda);O&&d.add(l.AFrameworkApplication.W2e,O);k.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");qF.b(l.AFrameworkApplication.K)?qF.d("view",d,qF.c):(n=Vc.a.lie(n,d),l.AFrameworkApplication.Ogh?Ye.a.Tk(n,Ye.a.Mda(z),void 0,"AuthenticationLostDuringSession"):Ye.a.openWindow(z,n,!1,void 0,YP.a.GUe))}catch(d){}}static yTm(a){k.ULS.sendTraceTag(38355487,323,50,
"previewPanel: init");(l.AFrameworkApplication.K.ea("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):la.a.instance.resolve("Common.IDynamicScriptLoaderProvider").uG.loadScript("previewPanel")).catch(()=>{k.ULS.sendTraceTag(38130907,323,10,"previewPanel: Failed to download script");qq.U5i(a)}).then(()=>{Kq.getInstance(a).nzn()})}static MFd(a,d,n){if(1===n)return 32;qq.EJ.Bwj(1);Lb.App.oa.updateCommandUI();return 32}static OFd(a,d,n){if(1===n)return 32;qq.EJ.Bwj(0);Lb.App.oa.updateCommandUI();
return 32}static uOd(a,d,n,z,O){if(1===n)return 32;O[Yf.a.On]=1===qq.EJ.XG;return 32}static NOd(a,d,n,z,O){if(1===n)return 32;O[Yf.a.On]=!qq.EJ.XG;return 32}}qq.EJ=null;qq.RRh=null;Object(t.a)(qq,"MainViewModeActor",null,[]);class xL{constructor(a,d,n){this.ga=a;this.Tia=d;this.Nl=n}lb(){this.ga.ma(Dc.a.Rug,Kb.a.view,Object(m.a)(this,this.Jtm,"marginsDialogViewHandler"));this.ga.Aa(Dc.a.ESe,Kb.a.view,yg.a.x8,96);this.ga.Aa(Dc.a.BSe,Kb.a.view,yg.a.x8,96);this.ga.Aa(Dc.a.CSe,Kb.a.view,yg.a.x8,96);this.ga.Aa(Dc.a.DSe,
Kb.a.view,yg.a.x8,96);this.ga.ma(Dc.a.iLd,Kb.a.view,yg.a.$P);this.ga.ma(Dc.a.hLd,Kb.a.view,yg.a.$P);this.ga.ma(Dc.a.zPe,Kb.a.view,yg.a.$P);this.ga.ma(Dc.a.APe,Kb.a.view,yg.a.$P)}Jtm(a,d,n,z,O){return 1===n?32:(a=this.Nl.kIa(d.Am))?(O=3===O.UF,this.Tia.value.Aci(this.lLl(a),this.w$b(a),O),32):2}lLl(a){const d=new dh.DictionaryPropertySet;d.setValue(Qb.a.marginTop,this.Nl.Ira(a));d.setValue(Qb.a.marginBottom,this.Nl.Pza(a));d.setValue(Qb.a.marginLeft,this.Nl.UP(a));d.setValue(Qb.a.marginRight,this.Nl.VP(a));
return d}w$b(a){const d=new dh.DictionaryPropertySet;d.setValue(Qb.a.iq,this.Nl.Gt(a));d.setValue(Qb.a.My,this.Nl.Kv(a));return d}}Object(t.a)(xL,"MarginsDialogActor",null,[]);class XG{constructor(a){this.ga=a}lb(){this.ga.ma(Dc.a.LYd,Kb.a.view,Object(m.a)(this,this.LYd,"toggleModernUxExperiment"))}LYd(a,d,n){if(1===n)return 32;a=l.AFrameworkApplication.la;if(!a)return 32;a.gid();XG.ren(a);return 32}static ren(a){const d=l.AFrameworkApplication.K.Ga("ModernUxExperimentPreferenceCookieName");var n=
l.AFrameworkApplication.K.ea("ModernUxExperimentDefaultOffIsEnabled");n=Fa.a.SHa(d,!n);Fa.a.UKa(d,(!n).toString(),Fa.a.FBa);n?k.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):k.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");we.d(Dc.a.LYd,!0,void 0,void 0,void 0,void 0,[Object.assign(new ba.a,{name:"ModernUxExperimentPreference",string:(!n).toString()})]);a.refreshDocument(null)}}Object(t.a)(XG,"ModernUxActor",null,[]);var ZP=
b(931),ks=b(1528);class yL{constructor(a,d){this.l_e=Wf.a.xE(1)/6;this.fP=a;this.Eb=d}get pi(){return jq.a.instance}FFl(a){var d=Lb.App.ADd,n=d?1:3,z=l.AFrameworkApplication.numberFormat;let O=ks.a.v8[a].nXb;var ca=ks.a.v8[a].lXb;var Da=ks.a.v8[a]._marginLeft;a=ks.a.v8[a].mXb;O=d?Wf.a.qvb(O):Wf.a.qC(O);ca=d?Wf.a.qvb(ca):Wf.a.qC(ca);Da=d?Wf.a.qvb(Da):Wf.a.qC(Da);a=d?Wf.a.qvb(a):Wf.a.qC(a);d=w.a.xza(O,n,z);ca=w.a.xza(ca,n,z);Da=w.a.xza(Da,n,z);n=w.a.xza(a,n,z);z={};z.top=d;z.bottom=ca;z.left=Da;z.right=
n;return z}Htm(a){const d=WordRibbonStrings.PageMarginsTop,n=WordRibbonStrings.PageMarginsBottom,z=WordRibbonStrings.PageMarginsLeft,O=WordRibbonStrings.PageMarginsRight;a=this.FFl(a);return[[d,a.top,n,a.bottom],[z,a.left,O,a.right]]}GLd(a){var d=Lb.App.ADd,n=d?1:3;const z=l.AFrameworkApplication.numberFormat;let O=ks.a.tCa[a].EFa;a=ks.a.tCa[a].g1a;O=d?Wf.a.qvb(O):Wf.a.qC(O);a=d?Wf.a.qvb(a):Wf.a.qC(a);d=w.a.xza(a,n,z);n=w.a.xza(O,n,z);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,
d,n)}lb(){const a=l.AFrameworkApplication.pa;a.Aa(Mb.a.bNb,Kb.a.view,Object(m.a)(this,this.xnn,"setPredefinedMarginsView"),4);a.Aa(Mb.a.YXa,Kb.a.view,Object(m.a)(this,this.ynn,"setPredefinedPageSizeView"),4);a.Aa(Mb.a.setOrientation,Kb.a.view,Object(m.a)(this,this.Tmn,"setOrientationView"),4);a.Aa(Mb.a.qKa,Kb.a.view,Object(m.a)(this,this.qKa,"querySectionProperties"),96);a.ma(Mb.a.W8a,Kb.a.view,Object(m.a)(this,this.QXe,"setMarginView"));a.ma(Mb.a.U8a,Kb.a.view,Object(m.a)(this,this.QXe,"setMarginView"));
a.ma(Mb.a.ioa,Kb.a.view,Object(m.a)(this,this.QXe,"setMarginView"));a.ma(Mb.a.V8a,Kb.a.view,Object(m.a)(this,this.QXe,"setMarginView"));a.ma(Mb.a.XXe,Kb.a.view,Object(m.a)(this,this.jyj,"setPaperSizeView"));a.ma(Mb.a.WXe,Kb.a.view,Object(m.a)(this,this.jyj,"setPaperSizeView"))}xnn(a,d,n,z,O){if(1===n)return 32;if(d=this.pi.kIa(d.Am)){if(0<=O&&O<ks.a.v8.length){n=new Ff.GraphTransaction(15);n.Sa(d);n.om=a;a=ks.a.v8[O].nXb;z=ks.a.v8[O].lXb;const ca=ks.a.v8[O]._marginLeft;O=ks.a.v8[O].mXb;this.$Pe(a,
z,this.pi.Kv(d))&&this.$Pe(ca,O,this.pi.Gt(d))?(this.fP.W8a(d,a),this.fP.U8a(d,z),this.fP.ioa(d,ca),this.fP.V8a(d,O),this.Eb.Ws(11)):this.NKa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);n.dispose()}else return 2;return 32}return 2}$Pe(a,d,n){return n>=a+d+Lb.App.$Da}ynn(a,d,n,z,O){if(1===n)return 32;if(d=this.pi.kIa(d.Am)){if(0<=O&&O<ks.a.tCa.length)n=new Ff.GraphTransaction(15),n.Sa(d),n.om=a,a=(z=this.pi.gDd(d))?ks.a.tCa[O].EFa:ks.a.tCa[O].g1a,O=z?ks.a.tCa[O].g1a:ks.a.tCa[O].EFa,this.$Pe(this.pi.Pza(d),
this.pi.Ira(d),O)&&this.$Pe(this.pi.UP(d),this.pi.VP(d),a)?(this.fP.H1g(d,a),this.fP.G1g(d,O),this.Eb.Ws(11)):this.NKa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),n.dispose();else return 2;return 32}return 2}Tmn(a,d,n,z,O){if(1===n)return 32;if(d=this.pi.kIa(d.Am)){n=this.pi.gDd(d);z=new Ff.GraphTransaction(15);z.Sa(d);z.om=a;this.fP.Bxj(d,O);if(O&&!n||!O&&n){a=this.pi.Gt(d);O=this.pi.Kv(d);this.fP.H1g(d,O);this.fP.G1g(d,a);a=this.pi.Ira(d);O=this.pi.Pza(d);const ca=this.pi.UP(d),Da=this.pi.VP(d);
n?(this.fP.W8a(d,l.AFrameworkApplication.isRtl?ca:Da),this.fP.U8a(d,l.AFrameworkApplication.isRtl?Da:ca),this.fP.ioa(d,l.AFrameworkApplication.isRtl?O:a),this.fP.V8a(d,l.AFrameworkApplication.isRtl?a:O)):(this.fP.W8a(d,l.AFrameworkApplication.isRtl?Da:ca),this.fP.U8a(d,l.AFrameworkApplication.isRtl?ca:Da),this.fP.ioa(d,l.AFrameworkApplication.isRtl?Math.abs(a):O),this.fP.V8a(d,l.AFrameworkApplication.isRtl?O:a));this.Eb.Ws(11)}z.dispose();return 32}return 2}qKa(a,d,n,z,O){return(a=this.pi.kIa(d.Am))?
(O.marginTop=this.pi.Ira(a),O.marginBottom=this.pi.Pza(a),O.marginLeft=this.pi.UP(a),O.marginRight=this.pi.VP(a),O.iq=this.pi.Gt(a),O.My=this.pi.Kv(a),O.WIa=this.pi.gDd(a),O.Yec=this.EFl(O),O.ghc=this.MIl(O),32):2}EFl(a){let d=5;for(let n=0;n<ks.a.v8.length;n++)if(ks.a.v8[n].nXb===a.marginTop&&ks.a.v8[n].lXb===a.marginBottom&&ks.a.v8[n]._marginLeft===a.marginLeft&&ks.a.v8[n].mXb===a.marginRight){d=n;break}return d}MIl(a){let d=5;a=new ZP.a(Math.min(a.iq,a.My),Math.max(a.iq,a.My));for(let n=0;n<ks.a.tCa.length;n++)if(this.NNm(a,
ks.a.tCa[n])){d=n;break}return d}NNm(a,d){return gf.a.rmg(a.g1a,Math.max(d.g1a-this.l_e,0),d.g1a+this.l_e)&&gf.a.rmg(a.EFa,Math.max(d.EFa-this.l_e,0),d.EFa+this.l_e)}QXe(a,d,n,z,O){if(1===n)return 32;if(d=this.pi.kIa(d.Am)){n=new Ff.GraphTransaction(15);n.Sa(d);switch(a){case Mb.a.W8a:this.fP.W8a(d,O);break;case Mb.a.U8a:this.fP.U8a(d,O);break;case Mb.a.ioa:this.fP.ioa(d,O);break;case Mb.a.V8a:this.fP.V8a(d,O)}this.Eb.Ws(11);n.dispose();return 32}return 2}jyj(a,d,n,z,O){if(1===n)return 32;if(d=this.pi.kIa(d.Am)){n=
new Ff.GraphTransaction(15);n.Sa(d);let ca=z=0;switch(a){case Mb.a.XXe:ca=O;this.fP.H1g(d,ca);z=this.pi.Kv(d);break;case Mb.a.WXe:z=O,this.fP.G1g(d,z),ca=this.pi.Gt(d)}this.fP.Bxj(d,z<ca);this.Eb.Ws(11);n.dispose();return 32}return 2}NKa(a){if(!zf.a.Yu){const d=new $g.StandardDialog;d.wc=0;d.kT(CommonUIStrings.l_DefaultDialogTitle,a,null)}}}Object(t.a)(yL,"PageActor",null,[558]);class zL{constructor(a){this.ga=a}get Tb(){return this.ga}PXe(a,d){let n=0;a?1===a?n=Mb.a.ioa:2===a?n=Mb.a.V8a:3===a&&(n=
Mb.a.U8a):n=Mb.a.W8a;this.Tb.ob(n,2,d)}YXa(a,d){let n=0;1===a?n=Mb.a.WXe:a||(n=Mb.a.XXe);this.Tb.ob(n,2,d)}}Object(t.a)(zL,"PageCommands",null,[557]);class AL{constructor(a,d,n){this.ga=a;this.Tia=d;this.Nl=n}lb(){this.ga.ma(Dc.a.Tug,Kb.a.view,Object(m.a)(this,this.MNm,"pageSizeDialogViewHandler"));this.ga.Aa(Dc.a.QSe,Kb.a.view,yg.a.x8,96);this.ga.Aa(Dc.a.PSe,Kb.a.view,yg.a.x8,96);this.ga.ma(Dc.a.GPe,Kb.a.view,yg.a.$P);this.ga.ma(Dc.a.FPe,Kb.a.view,yg.a.$P)}MNm(a,d,n,z,O){return 1===n?32:(a=this.Nl.kIa(d.Am))?
(O=3===O.UF,this.Tia.value.fdi(this.mLl(a),this.w$b(a),O),32):2}mLl(a){const d=new dh.DictionaryPropertySet;d.setValue(Qb.a.iq,this.Nl.Gt(a));d.setValue(Qb.a.My,this.Nl.Kv(a));return d}w$b(a){const d=new dh.DictionaryPropertySet;d.setValue(Qb.a.marginTop,Math.abs(this.Nl.Ira(a)));d.setValue(Qb.a.marginBottom,Math.abs(this.Nl.Pza(a)));d.setValue(Qb.a.marginLeft,this.Nl.UP(a));d.setValue(Qb.a.marginRight,this.Nl.VP(a));return d}}Object(t.a)(AL,"PaperSizeDialogActor",null,[]);class XC{constructor(a,
d,n,z,O=la.a.instance.Ca("Box4.Settings.SpacingSettings")){this.ga=a;this.Tia=d;this.DC=n;this.rm=z;this.wO=null;O.execute(ca=>this.wO=ca)}lb(){this.ga.Aa(Mb.a.aec,Kb.a.view,Object(m.a)(this,this.oOm,"paragraphDialogViewHandler"),1028);this.ga.ma(Mb.a.aec,Kb.a.paragraph,Object(m.a)(this,this.nOm,"paragraphDialogHandler"));this.ga.Aa(Mb.a.AOd,Kb.a.view,yg.a.x8,96);this.ga.Aa(Mb.a.yic,Kb.a.view,yg.a.x8,96);this.ga.Aa(Mb.a.hOd,Kb.a.view,yg.a.x8,96);this.ga.Aa(Mb.a.PPc,Kb.a.view,yg.a.x8,96);this.ga.Aa(Mb.a.m9a,
Kb.a.view,yg.a.$P,96);this.ga.Aa(Mb.a.vTc,Kb.a.view,yg.a.$P,96);this.ga.Aa(Mb.a.jLd,Kb.a.view,yg.a.$P,96);this.ga.Aa(Mb.a.Zgc,Kb.a.view,yg.a.$P,96);this.ga.Aa(Mb.a.gLd,Kb.a.view,yg.a.$P,96);this.ga.Aa(Mb.a.yWd,Kb.a.view,yg.a.$P,96);this.ga.Aa(Mb.a.q7a,Kb.a.view,yg.a.$P,96)}nOm(a,d,n,z,O){if(1===n)return 3===this.ga.mode||2===this.ga.mode?32:8;a=d.node;d=this.HLj(d);O=3===O.UF;this.Tia.value.XBc(this.cwd(a),this.w$b(d),O,this.rm);return 32}oOm(a,d,n,z,O){a=d.view.Oa;if(!a||XC.If.Fbc(a.Ag))return 8;
if(XC.jg.h9(Bd.ParagraphReader.wS,a.Ag))return XC.Lb.mb(Ee.a.af,{["Reason"]:Jf.a.qP}),8;if(1===n)return 3===this.ga.mode||2===this.ga.mode?32:8;n=a.ya.Ba;d=this.HLj(d);O=3===O.UF;if(1===n.length&&Qd.SelectionEditor.Cd(n.J(0)))return n=n.J(0).node,this.Tia.value.XBc(this.cwd(n),this.w$b(d),O,this.rm),32;a=[];for(z=0;z<n.length;z++){const ca=n.J(z);(!z&&Qd.SelectionEditor.sg(ca)||Bd.ParagraphReader.rh(ca)||Qd.SelectionEditor.Ch(ca))&&a.push(ca.node)}if(!a.length)return 8;n=Array(a.length);for(z=0;z<
a.length;z++)n[z]=this.cwd(a[z]);n=ny.APropertySet.z9f(n);this.Tia.value.XBc(n,this.w$b(d),O,this.rm);return 32}cwd(a){var d,n;const z=new dh.DictionaryPropertySet;z.setValue(Xc.a.Kt,Bd.ParagraphReader.Jv(a));const O=this.DC.cIa(a);var ca=O.lineSpacing;z.setValue(Xc.a.C4,ca.unit);z.setValue(Xc.a.Lt,ca.value);ca=O.beforeSpacing;z.setValue(Xc.a.bKa,ca.unit);z.setValue(Xc.a.cKa,ca.value);ca=O.afterSpacing;z.setValue(Xc.a.$Ja,ca.unit);z.setValue(Xc.a.aKa,ca.value);(null===(d=this.wO)||void 0===d?0:d.YAa)&&
z.setValue(Xc.a.IOc,O.JB);(null===(n=this.rm)||void 0===n?0:n.Idc)&&z.setValue(Kr.a.gM,Bd.ParagraphReader.gM(a));return z}static get If(){return aj.a.instance}static get jg(){return bl.ContextSetEditor.instance}static get Lb(){return Ch.a.instance}}Object(t.a)(XC,"AParagraphDialogActor",null,[]);class BL extends XC{constructor(a,d,n,z,O,ca){super(a,d,n,ca);this.Nl=z;this.Ck=O}lb(){super.lb();this.ga.Aa(Mb.a.rLb,Kb.a.view,yg.a.x8,96);this.ga.Aa(Mb.a.DPc,Kb.a.view,yg.a.x8,96);this.ga.Aa(Mb.a.vic,Kb.a.view,
yg.a.x8,96);this.ga.Aa(Mb.a.Fac,Kb.a.view,yg.a.$P,96);this.ga.Aa(Mb.a.Jzd,Kb.a.view,yg.a.$P,96);this.ga.Aa(Mb.a.Jmc,Kb.a.view,yg.a.$P,96);this.ga.Aa(Mb.a.xWd,Kb.a.view,yg.a.$P,96);this.ga.Aa(Mb.a.nta,Kb.a.view,yg.a.$P,96);this.ga.Aa(Mb.a.s7a,Kb.a.view,Object(m.a)(this,this.DIi,"handleSpecialIndentDialogControl"),96);this.ga.Aa(Mb.a.kLd,Kb.a.view,Object(m.a)(this,this.DIi,"handleSpecialIndentDialogControl"),96);this.ga.Aa(Mb.a.AWd,Kb.a.view,yg.a.$P,96);this.ga.Aa(Mb.a.BOd,Kb.a.view,yg.a.x8,96);this.ga.Aa(Mb.a.zic,
Kb.a.view,yg.a.x8,96)}HLj(a){return this.Nl.kIa(a.Am)}cwd(a){const d=super.cwd(a);var n=this.Ck.x7(a);const z=this.Ck.ML(a);d.setValue(Xc.a.hha,1);d.setValue(Xc.a.iha,n.pu-z.pu);n=this.Ck.HGc(a);d.setValue(Xc.a.iCa,n.unit);d.setValue(Xc.a.jCa,n.value);a=this.Ck.QGc(a);a.specialIndentType&&(d.setValue(Xc.a.tM,a.specialIndentType),d.setValue(Xc.a.Sha,a.unit),d.setValue(Xc.a.q5,a.value));return d}DIi(a,d,n,z,O){const ca=d.view.Oa,Da=ca.ya.Ba.ra;return 1===n&&ca.ya.Ba.IA&&Bd.ParagraphReader.eV(Da.node)&&
!Bf.ListReader.Jq?8:yg.a.$P(a,d,n,z,O)}w$b(a){const d=new dh.DictionaryPropertySet;d.setValue(Qb.a.iq,this.Nl.Gt(a));d.setValue(Qb.a.My,this.Nl.Kv(a));d.setValue(Qb.a.marginTop,Math.abs(this.Nl.Ira(a)));d.setValue(Qb.a.marginBottom,Math.abs(this.Nl.Pza(a)));d.setValue(Qb.a.marginLeft,this.Nl.UP(a));d.setValue(Qb.a.marginRight,this.Nl.VP(a));return d}}Object(t.a)(BL,"ParagraphDialogActor",XC,[]);class CL extends Sys.EventArgs{constructor(a,d){super();this.node=a;this.Kpg=d}}Object(t.a)(CL,"AfterPasteEventArgs",
Sys.EventArgs,[]);class DL{constructor(a){this.ITb=this.Pif=this.Uif=null;this.sTb=a}get Oue(){return this.ITb||(this.ITb=la.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor"))}get $9l(){this.Uif||(this.Uif=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate(Nb.a.Zfi,!1));return this.Uif}get fCd(){this.Pif||(this.Pif=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea(Nb.a.cgi));return this.Pif}oVm(a){if(a&&Ia.OutlineElementReader.gg(a.IHa)&&Ia.OutlineElementReader.gg(a.BIb)){this.GVm(a);
var d=new Pi.a;for(d.Cb(a.IHa);d&&d.currentNode;){const n=this.Sye(d),z=Bd.ParagraphReader.nb(n);z&&Bd.ParagraphReader.WGa(n)&&this.mVm(n);const O=d.currentNode.id===a.BIb.currentNode.id;z&&(this.$9l||this.fCd)&&n.Bf.eH(n.type).zLb(new CL(n,O));if(O)break;qe.OutlineElementNavigator.Mt(d,!1,!1)}}}mVm(a){k.ULS.sendTraceTag(590435214,307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");const d=a.nrb;a=fe.a.Kb(a,0);vv.BCd(d)?
this.Oue.CQe(a,d):this.sTb.CQe(a,d)}GVm(a){if(a.IHa.currentNode&&a.BIb.currentNode&&a.IHa.currentNode.id===a.BIb.currentNode.id){const d=this.Sye(a.IHa);Bd.ParagraphReader.nb(d)?this.rVm(d,a.QPm,a.PPm):k.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}rVm(a,d,n){k.ULS.shipAssertTag(590956771,307,0<=d);k.ULS.shipAssertTag(590958592,307,0<=n);var z=Bd.ParagraphReader.text(a);if(""!==z){var O=fe.a.createTextRange(a,d,n);O=hg.HyperlinkReader.vw(O,!1);if(1===
O.length){const ca=O[0];O=z.substring(d,n).trim();z=z.substring(ca.cpBegin,ca.cpEnd).trim();d=O===z;O=fe.a.createTextRange(a,ca.cpBegin,ca.cpEnd);if(ca.hyperlink&&d&&!hg.HyperlinkReader.oJa(z))a=ca.hyperlink.url;else if(d)a=z;else{k.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");return}vv.BCd(a)?this.Oue.A5a(O,a,!1):this.sTb.A5a(O,a,!1)}else k.ULS.sendTraceTag(590958597,307,50,
"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",O.length)}}Sye(a){const d=qe.OutlineElementNavigator.Sd(a);qe.OutlineElementNavigator.Uc(a);return d}}Object(t.a)(DL,"PastedContentsProcessorPostMergeAfterPaste",null,[556]);class YG extends ju{constructor(a,d,n,z,O,ca,Da,Xa){super(z);this.Dtf=7;this.tF=this.Y0c=null;this.Bhf=0;this.zhf=a;this.vn=d;this.Ak=n;this.Ad=O;this.L1j=Da;this.Beb=Xa;this.S$=
this.Ad.L6a("UserAction","WordIgnoreAll")}c3g(a){this.zhf.h1i();this.Y0c=this.Ak.Cra(a);this.Beb.yLi(this.Y0c,null,!1);return this.zhf.cMj(this.Y0c)?(this.S$.start(),this.tF=new Ff.GraphTransaction(15),this.tF.Sa(a.node),!0):!1}PRe(a){this.bic(a.node);return!0}ENd(a){this.bic(a);return!0}QRe(a){this.bic(a.node)}n$g(a){this.tF.dispose();this.Y0c.errorDetails.ZOb(a.actionId);this.S$.stop();k.ULS.sendTraceTag(19779652,324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",
this.Bhf,this.S$.ti,this.Y0c.errorDetails.proofingType));return!0}uTc(a,d){if(super.uTc(a,d))return!0;a=a.role;return 9===a||10===a||13===a||7===a||8===a}DCi(a){if(a&&a.type!==this.Dtf){const d=Dd.GraphIterator.ua(a);return d.La(this.Dtf)?d.tc(this.Dtf):a}return a}mbm(a,d){return this.zhf.TSc(d.errorDetails)&&!this.vn.t4(fe.a.createTextRange(a,d.begin,d.end))}bic(a){if(a){var d=this.Ak.mba(a,n=>this.mbm(a,n));this.L1j?this.Ak.ksb(a,d,!0):0<d.length&&(a.Fi(4,!0),this.Ak.IJb(a));this.Bhf+=d.length}}}
Object(t.a)(YG,"IgnoreAllCallbackSteps",ju,[]);class EL{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je){this.ga=a;this.vn=d;this.Da=n;this.ud=z;this.Ak=ca;this.$M=Da;this.Ad=Xa;this.nbk=zb;this.F7j=Vb;this.Ntc=Fc.eEd;this.JW=Fc;this.Beb=Yc;this.qjf=yd;this.exb=je}lb(){this.qjf&&(nq.a.tH()?this.ga.Aa(Mb.a.bsa,Kb.a.Ub,this.G0l.bind(this),1028):this.ga.dX(Mb.a.bsa,Kb.a.view,Object(m.a)(this,this.bsa,"ignoreAllSpellingError"),1028));this.Ntc&&this.ga.dX(Mb.a.bEb,Kb.a.view,Object(m.a)(this,this.bEb,
"doNotCheckThisCritiqueType"),1028);this.ga.Aa(Dc.a.gOd,Kb.a.view,Object(m.a)(this,this.gOd,"queryLanguage"),96)}gOd(a,d,n,z,O){if(1===n)return 32;a=this.$M.Plb(d.view.Oa.Ag);if(a=Ih.a.yf(a))O[rg.a.LabelText]=a.displayName;return 32}bsa(a,d,n,z,O,ca){const Da=new YG(this.nbk,this.vn,this.Ak,this.ud,this.Ad,this.JW,0,this.Beb);return new ct(a,d,n,z,O,ca,Da,this.ga,this.Da,this.ud,"IgnoreAllOperation")}bEb(a,d,n,z,O,ca){const Da=new YG(this.F7j,this.vn,this.Ak,this.ud,this.Ad,this.JW,1,this.Beb);return new ct(a,
d,n,z,O,ca,Da,this.ga,this.Da,this.ud,"DoNotCheckThisCritiqueType")}G0l(a,d,n){if(1===n)return 32;k.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.exb.pfg(d,null,hp.b.IgnoreAll);return 32}}Object(t.a)(EL,"ProofingActor",null,[]);var nz=b(1042),$P=b(1530);class gA{constructor(a,d,n,z,O,ca,Da,Xa,zb){this.tr=this.z1a=this.ffe=this.gfe=null;this.oG=this.Ex=this.At=0;this.Gyb=this.Fyb=!1;this.tka=this.orc=this.nrc=this.mrc=this.prc=0;this.mee=null;this.Xoa=this.LW=this.yt=
this.eR=0;this.Fm=null;this.RUb=0;this.si=n;this._image=a;this._context=d;this.K9d=!1;(a=gA.Ze.kt(d.node))&&a.Se(Qb.a.nHe)&&(this.K9d=!0);this.F3c=z.ea("ImageDataURLPresentationIsEnabled");this.Ejk=z.ea("WordOartPostRequestIsEnabled");this.va=z;this.Pr=O;this.Ad=ca;this.Eb=Da;this.Gj=Xa;this.yx=zb;this.F3l();this.Mtc=!!z&&z.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImproveApplyStyle",!1)}F3l(){this.tr="";this.At=Kd.ImageReader.Tz(this._image);this.Ex=Kd.ImageReader.UA(this._image);this.tka=
Kd.ImageReader.PTa(this._image);this.oG=Kd.ImageReader.WX(this._image);this.Fyb=Kd.ImageReader.Nud(this._image);this.Gyb=Kd.ImageReader.Hlb(this._image);this.prc=Math.max(Kd.ImageReader.zba(this._image),0);this.mrc=Math.max(Kd.ImageReader.wba(this._image),0);this.nrc=Math.max(Kd.ImageReader.xba(this._image),0);this.orc=Math.max(Kd.ImageReader.yba(this._image),0);this.Fm=xa.a.nil;this.z1a=null;this.RUb=Kd.ImageReader.ml(this._image)}qle(a,d){return(new $P.a(this.Pr,this.RUb,this.va,this.At,this.Ex,
this.oG,this.tka,this.prc,this.mrc,this.nrc,this.orc,this.Fyb,this.Gyb,this.K9d)).build(this._context.node,this._image,a,d)}resize(a,d){this.tr="Resize";this.N_e();Mh.a.mark(this.xGc());this.At=a;this.Ex=d;this.Eh(!1,Object(m.a)(this,this.Xqb,"onRequestSuccess"))}dy(a){this.tr="Styles";this.N_e();Mh.a.mark(this.xGc());this.tka=a;this.Eh(!1,Object(m.a)(this,this.Xqb,"onRequestSuccess"))}rnn(a,d,n){this.tr="Rotation";this.N_e();this.oG=a;this.Fyb=d;this.Gyb=n;this.Eh(!1,Object(m.a)(this,this.Xqb,"onRequestSuccess"))}qnn(a,
d){this.tr="SwordRequestManager";this.N_e();this.z1a=a;this.oG=d.angle;this.At=d.width;this.Ex=d.height;this.tka=d.styleId;this.prc=d.top;this.mrc=d.bottom;this.nrc=d.left;this.orc=d.right;this.Fm=d.t_;this.Eh(!1,Object(m.a)(this,this.Xqb,"onRequestSuccess"))}Eh(a,d){if(this.va.ea("WordOartForceOutboundAfterImageSuccessIsEnabled")){var n=this.NBc(n);const z=Kd.ImageReader.Cba(this._image,this.va,this.Pr);z?nz.a.eNb(this._image,z,4):(l.AFrameworkApplication.Yi("picstylefix;picstylefixcf"),this.Mtc&&
this._image.setValue(bd.a.msd,!0));n.dispose()}this.xFj(a);Mh.a.mark(this.xGc());a=new Ba.QueryStringBuilder(this.qle(a,!0));this.F3c&&a.Xd(be.a.qUf,"true");this.Ejk?(n=new Ba.QueryStringBuilder("WordOart.ashx"),l.AFrameworkApplication.Gd.Ni(n.toString(),2,a.toString(),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,d,Object(m.a)(this,this.TIg,"onRequestFail"),null)):l.AFrameworkApplication.Gd.Ni(a.toString(),1,"",null,!0,0,d,Object(m.a)(this,this.TIg,"onRequestFail"),null)}NBc(a){a=
this.Fm&&this.Fm!==xa.a.nil?new Ff.GraphTransaction(7,Mb.a.imageRotate):new Ff.GraphTransaction(15);a.Sa(this._context.node);return a}get cYj(){const a=new Ff.GraphTransaction(3);a.Sa(this._context.node);return a}RRd(){this.dqd();this.Ise();const a=this.cYj;var d=Kd.ImageReader.yra(this._image,this._context.node.Ib,this.va,this.Pr);this.Mtc&&this._image.setValue(bd.a.msd,!1);this._image.setValue(Xc.a.pIc,d);this._image.setValue(Xc.a.pH,-1);d=Kd.ImageReader.Cba(this._image,this.va,this.Pr);this.va.ea("WordOartForceOutboundAfterImageSuccessIsEnabled")&&
(this._image.removeProperty(Xc.a.qMd),this._image.removeProperty(Xc.a.pMd),d&&nz.a.eNb(this._image,d,3));a.dispose();gA.jq();this.z1a&&this.z1a()}TIg(a){if(5===this.RUb){const d=Object.assign(new Sg.a,{extendedProperties:new Map});d.extendedProperties.set("status",a.data.status.toString());d.extendedProperties.set("httpStatus",a.data.Ge.toString());ja.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,!1,!1,d)}k.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",
{["Status"]:a.data.status,["HttpStatus"]:a.data.Ge,["Id"]:a.data.id,["ResponseData"]:a.data.Rd},WC.a[this.RUb]);this.RRd()}xFj(a){this.Ad&&(a=String.format("Send Single {0} SWORD Request.",a?"PNG":"XML"),this.gfe=this.Ad.Pe("WebServiceCall",a))}dqd(){this.gfe&&(this.gfe.stop(),this.gfe=null)}N_e(){if(this.Ad){const a=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.tr,WC.a[this.RUb]);this.ffe=this.Ad.Pe("WebServiceCall",a)}}Ise(){this.ffe&&(this.ffe.stop(),this.ffe=null)}static get Ze(){return jm.PageNavigator.instance}static jq(){const a=
new $g.StandardDialog;a.wc=0;a.aw(tl.a.Mej,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);Lb.App.oa&&Lb.App.oa.updateCommandUI()}}Object(t.a)(gA,"RenderedImageEditOperation",null,[588]);var rF=b(488);class FL extends gA{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb){super(a,d,n,z,O,ca,Da,Xa,zb);this.ogk=Vb}Eh(a,d){this.xFj(a);Mh.a.mark(this.xGc());const n=new Ba.QueryStringBuilder("WordOart.ashx");a=new rF.a(n.toString(),2,this.jGb(a,!0,0),null,!0,2,null,null,
null,null,null,null,null,null,null,null,null,null,["Content-Type"],null,a?"blob":"text");l.AFrameworkApplication.Gd.send(a).Cta(d,z=>{this.TIg(z)})}Xqb(a){try{const d=JSON.parse(a.data.Sca);this.pak=d[be.a.UAe];this.hsk=d[be.a.width];this.Gak=d[be.a.height];this.Znh=d[be.a.Lyc];this.K0c=Array(4);this.K0c[0]=d[be.a.Sjb];this.K0c[1]=d[be.a.Tjb];this.K0c[2]=d[be.a.Ujb];this.K0c[3]=d[be.a.Rjb];this.ogk?this.Eh(!0,n=>{this.kKd(n)}):(this.yVc(),this.Toi())}catch(d){k.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",
d.message,this.tr,Kd.ImageReader.ml(this._image)),this.RRd()}}kKd(a){2!==a.data.status||Kd.ImageReader.qY(a.data.Rd)||this.OPb(a).then(d=>{this.xzh=d;a.data.request&&(this.yzh=nz.a.gEc("POST"===a.data.request.get_httpVerb()?a.data.request.get_body():a.data.request.get_url()));this.Shf=this.jGb(!0,!1,this.oG);this.yVc();this.Toi()}).catch(d=>{k.ULS.sendTraceTag(526528852,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",d,this.tr,Kd.ImageReader.ml(this._image));
this.RRd()})}yVc(){let a;a=this.NBc(a);this._image.setValue(Kr.a.nIa,this.pak);this.Znh&&this._image.setValue(Kr.a.Agd,this.Znh);this._image.setValue(Kr.a.bUa,this.hsk);this._image.setValue(Kr.a.cUa,this.Gak);this._image.setValue(Kr.a.kma,this.K0c);this.xzh&&this._image.setValue(Xc.a.ZB,this.xzh);this.yzh&&this._image.setValue(Xc.a.wac,this.yzh);this.Shf&&(nz.a.eNb(this._image,this.Shf,3),this._image.setValue(Qb.a.JSa,this.Shf));this.MRk();a.dispose()}MRk(){this._image.removeProperty(Xc.a.pH);this._image.removeProperty(Xc.a.qMd);
this._image.removeProperty(Xc.a.pMd)}Toi(){this.yx.UXa(this._context);if(this.Fm&&this.Fm!==xa.a.nil){const a=this._context.node.Zg(),d=new E.a(this.Fm,1);this.Gj.dBc(a,d)}this.Eb.Ws(13);this.dqd();this.Ise();Mh.a.mark(this.wGc());this.z1a&&this.z1a()}jGb(a,d,n){a=new Ba.QueryStringBuilder(this.qle(a,d));a.Xd(be.a.nDe,"true");a.Xd(be.a.ecj,n.toString());return a.toString()}OPb(a){return new Promise((d,n)=>{if(Kd.ImageReader.wma())try{const z=new Blob([a.data.Sca],{type:a.data.Ri["Content-Type"]}),
O=new FileReader;O.addEventListener("loadend",()=>{d(O.result)},!1);O.readAsDataURL(z)}catch(z){k.ULS.sendTraceTag(526528853,322,10,"GetImageDataURLFromRequestSucceededEventArgs exception in dataUrl conversion: {0}",z),n()}else d(a.data.Rd)})}xGc(){return 51511}wGc(){return 51512}}Object(t.a)(FL,"RenderedGraphicEditOperation",gA,[]);class GL extends gA{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb){super(a,d,n,z,O,ca,Da,Xa,zb);this.Bvh=null;this.usf=Vb}xGc(){return 51511}wGc(){return 51512}Xqb(a){try{var d=
JSON.parse(a.data.Rd);const O=Sys.Net.XMLDOM("string"===typeof d[be.a.YDf]?d[be.a.YDf]:null);this.mee="string"===typeof d[be.a.Cgd]?d[be.a.Cgd]:null;const ca=la.a.instance.sa("Box4.IFeatureHelper");ca&&ca.isFeatureEnabled(81)&&(this.Bvh="string"===typeof d[be.a.O7b]?d[be.a.O7b]:null);I.a.Ah&&O.setProperty("SelectionNamespaces","xmlns:mc='"+We.a.UXh+"'");const Da=O.selectSingleNode("/mc:AlternateContent");if(!Da)throw U.a.argument("Alternate content element could not be retrieved!");const Xa=Da.firstChild;
if(!Xa)throw U.a.argument("Alternate content choice element could not be retrieved!");const zb=Xa.firstChild;if(!zb)throw U.a.argument("Drawing element could not be retrieved!");var n=zb.firstChild;if(!n)throw U.a.argument("Inline element could not be retrieved!");d=a=null;const Vb=RegExp("effectExtent"),Fc=RegExp("extent");for(let yd of n.childNodes)-1!==yd.nodeName.search(Vb)&&(a=yd),-1!==yd.nodeName.search(Fc)&&(d=yd);if(!a||!d)throw U.a.argument("Effect extent or extent could not be retrieved!");
this.eR=parseInt(a.selectSingleNode("@l").text);this.LW=parseInt(a.selectSingleNode("@r").text);this.yt=parseInt(a.selectSingleNode("@t").text);this.Xoa=parseInt(a.selectSingleNode("@b").text);const Yc=wk.c(this.oG);if(45<=Yc&&135>=Yc||225<=Yc&&315>=Yc){const yd=parseInt(d.selectSingleNode("@cx").text);var z=parseInt(d.selectSingleNode("@cy").text);n=yd/2;z/=2;this.eR-=n-z;this.LW+=n-z;this.yt-=z-n;this.Xoa+=z-n}}catch(O){k.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",
O.message,this.tr,WC.a[this.usf]);this.RRd();return}this.Eh(!0,Object(m.a)(this,this.kKd,"onImageSuccess"))}kKd(a){const d=this.qle(!0,!1);let n;n=this.NBc(n);this._image.setValue(Qb.a.Bgd,this.mee);var z=la.a.instance.sa("Box4.IFeatureHelper");z&&z.isFeatureEnabled(81)&&this._image.setValue(Qb.a.M0f,this.Bvh);this.va.ea("WordEditorImageRotateIsEnabled")&&this.va.ea("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.si.CXe(this._image,this.oG,this.Fyb,this.Gyb);const O=Kd.ImageReader.Cba(this._image,
this.va,this.Pr),ca=()=>{O&&nz.a.eNb(this._image,O,3);nz.a.eNb(this._image,d,3);this.si.AXe(this._image,Wf.a.LB(this.eR),Wf.a.LB(this.LW),Wf.a.LB(this.yt),Wf.a.LB(this.Xoa));this._image.setValue(Qb.a.JSa,d);Kd.ImageReader.Aw(this._image)||this._image.setValue(Qb.a.oAa,1);this.si.lXe(this._image,this.At,this.Ex);this.va.ea("WordEditorImageRotateIsEnabled")&&!this.va.ea("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.si.CXe(this._image,this.oG,this.Fyb,this.Gyb);2===a.data.status&&Kd.ImageReader.qY(a.data.Rd)&&
(this._image.setValue(Xc.a.ZB,a.data.Rd),a.data.request&&this._image.setValue(Xc.a.wac,nz.a.gEc("POST"===a.data.request.get_httpVerb()?a.data.request.get_body():a.data.request.get_url())));this.z1a&&this.z1a();this.yx.UXa(this._context);if(this.Fm&&this.Fm!==xa.a.nil){const Da=this._context.node.Zg(),Xa=new E.a(this.Fm,1);this.Gj.dBc(Da,Xa)}this.Eb.Ws(13);this.dqd();this.Ise();Mh.a.mark(this.wGc())};if(this.va.ea("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Fm&&this.Fm!==xa.a.nil&&(z=
this._context.node.Zg())&&z.contentReplicator){n.dispose();z.contentReplicator.forceOutbound(()=>{let Da;Da=this.NBc(Da);ca();Da.dispose()},null,null);return}ca();n.dispose()}}Object(t.a)(GL,"RenderedDrawingEditOperation",gA,[]);class HL extends gA{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc){super(a,d,n,z,O,ca,Da,Xa,zb);this.D2=null;this.usf=Vb;this.Ja=Fc}xGc(){return 7988}wGc(){return 7989}get $n(){this.D2||(this.D2=new vL.a);return this.D2}Xqb(a){try{const d=a.data.X0;this.mee=a.data.Rd;I.a.Ah&&d.setProperty("SelectionNamespaces",
"xmlns:pic='"+We.a.Lej+"'");const n=d.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.eR=parseInt(n.selectSingleNode("@l").text);this.LW=parseInt(n.selectSingleNode("@r").text);this.yt=parseInt(n.selectSingleNode("@t").text);this.Xoa=parseInt(n.selectSingleNode("@b").text)}catch(d){a=Object.assign(new Sg.a,{extendedProperties:new Map});a.extendedProperties.set("exception",d.message);a.extendedProperties.set("operation",this.tr);ja.Health.instance.recordQosError("PictureSwordResponseInvalid",
["ImageEditFailed"],!1,!0,!1,!1,a);k.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",d.message,this.tr,WC.a[this.usf]);this.RRd();return}this.dqd();Mh.a.mark(this.wGc());this.Eh(!0,Object(m.a)(this,this.kKd,"onImageSuccess"))}kKd(a){const d=this.qle(!0,!1);let n;n=this.NBc(n);this._image.setValue(Qb.a.zhc,this.mee);const z=Kd.ImageReader.Cba(this._image,this.va,this.Pr),O=()=>{z&&nz.a.eNb(this._image,z,3);nz.a.eNb(this._image,
d,3);this.si.AXe(this._image,Wf.a.LB(this.eR),Wf.a.LB(this.LW),Wf.a.LB(this.yt),Wf.a.LB(this.Xoa));this._image.setValue(Qb.a.JSa,d);Kd.ImageReader.Aw(this._image)||this._image.setValue(Qb.a.oAa,1);this._image.setValue(Qb.a.IKb,this.tka);this._image.setValue(Xc.a.QLi,-1);this.Ja.isFeatureEnabled(145)&&Kd.ImageReader.Rmb(this._image)&&this.$n.vQd(this._image);this.Mtc&&this._image.setValue(bd.a.msd,!1);this.si.lXe(this._image,this.At,this.Ex);this.va.ea("WordEditorImageRotateIsEnabled")&&this.si.CXe(this._image,
this.oG,this.Fyb,this.Gyb);this.va.ea("WordEditorImageCropIsEnabled")&&this.si.zXe(this._image,this.prc,this.mrc,this.nrc,this.orc);2===a.data.status&&Kd.ImageReader.qY(a.data.Rd)&&(this._image.setValue(Xc.a.ZB,a.data.Rd),a.data.request&&this._image.setValue(Xc.a.wac,nz.a.gEc("POST"===a.data.request.get_httpVerb()?a.data.request.get_body():a.data.request.get_url())));this.z1a&&this.z1a();this.yx.UXa(this._context);if(this.Fm&&this.Fm!==xa.a.nil){const ca=this._context.node.Zg(),Da=new E.a(this.Fm,
1);this.Gj.dBc(ca,Da)}this.Eb.Ws(13);this.dqd();this.Ise();Mh.a.mark(this.wGc())};if(this.va.ea("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Fm&&this.Fm!==xa.a.nil){const ca=this._context.node.Zg();if(ca&&ca.contentReplicator){n.dispose();ca.contentReplicator.forceOutbound(()=>{let Da;Da=this.NBc(Da);O();Da.dispose()},null,null);return}}O();n.dispose()}}Object(t.a)(HL,"RenderedPictureEditOperation",gA,[]);class IL{constructor(a,d,n,z,O,ca,Da,Xa){this.si=a;this.va=d;this.Pr=n;this.Ad=z;
this.Eb=O;this.Gj=ca;this.yx=Da;this.Ja=Xa}create(a,d){const n=Kd.ImageReader.ml(a);return Rj.App.instance.TFe(n)?new FL(a,d,this.si,this.va,this.Pr,this.Ad,this.Eb,this.Gj,this.yx,!0):10===n||11===n||48===n||4===n?new GL(a,d,this.si,this.va,this.Pr,this.Ad,this.Eb,this.Gj,this.yx,n):5===n?new HL(a,d,this.si,this.va,this.Pr,this.Ad,this.Eb,this.Gj,this.yx,n,this.Ja):null}}Object(t.a)(IL,"Factory",null,[555]);class JL{constructor(){this.ZZb=null}Fi(){const a=sj.a.qz();this.iPd(a);this.yLb(null)}yLb(a){this.ZZb&&
(l.AFrameworkApplication.tb.ie(this.ZZb),this.ZZb=null);this.ZZb=new bf.a(1,1,1,Object(m.a)(this,this.ppd,"doRerenderDocumentTask"),198);this.ZZb.customData=a;l.AFrameworkApplication.tb.rb(this.ZZb)}iPd(a){const d=OG.b(a);if(d){var n=new Ff.GraphTransaction(3);try{for(n.Sa(a);d.moveNext();){if(!Bd.ParagraphReader.Zf(d.iterator))continue;const z=d.currentNode;this.tii(z)&&z.Fi(4,!0)}}finally{n&&n.dispose()}}}tii(a){a=a.GQ;for(let d of a)if(d.IHb)return 0<d.inc;return!1}ppd(a){const d=window.performance.now(),
n=sj.a.qz();if(n){a=OG.a(a.customData,n);a=Yi.a.Yo(a,n);var z=0,O=new Ff.GraphTransaction(3);try{for(O.Sa(n);a.moveNext();){if(!Bd.ParagraphReader.Zf(a.iterator))continue;const ca=a.currentNode;this.tii(ca)&&(z++,ca.Fi(4,!0));const Da=window.performance.now()-d;if(2500<z||100<Da){this.ZZb=null;this.yLb(ca);break}}}finally{O&&O.dispose()}}else Ld.b(570450380,3018,10,"PageContentNode not found")}}Object(t.a)(JL,"RenderParagraphsContainingTabs",null,[]);class KL{constructor(a,d){this.Vcf=!0;this.j_c=
null;this.ga=a;this.B1a=d}lb(){this.ga.Aa(Sa.a.c$a,Kb.a.application,Object(m.a)(this,this.c$a,"updateSaveStatusForHeader"),1124)}LPn(){this.j_c?l.AFrameworkApplication.tb.ie(this.j_c):this.j_c=new bf.a(4,1,5E3,Object(m.a)(this,this.ncl,"doUpdateToSavedStatus"));l.AFrameworkApplication.tb.rb(this.j_c)}ncl(){this.j_c=null;this.Vcf=!0;this.B1a&&this.B1a.d$a(!Lb.App.RN())}c$a(a,d,n){if(1===n)return 32;2===n&&(a=!1,Lb.App.RN()?this.Vcf=!1:this.Vcf?a=!0:this.LPn(),this.B1a&&this.B1a.d$a(a));return 32}}
Object(t.a)(KL,"SaveStatusActor",null,[]);var LL=b(321);class ML{constructor(a,d){this.Vp=this.Xb=null;this.ga=a;this.Tia=d}get OYg(){return this.Jen||(this.Jen=la.a.instance.sa("Box4.ISaveStyleManager"))}get Gg(){return this.Vp||(this.Vp=la.a.instance.sa("Box4.Styles.StyleSettings"))}get gb(){return this.Xb||(this.Xb=la.a.instance.resolve("Box4.Styles.IWACStyleReader"))}lb(){this.ga.Aa(Mb.a.thb,Kb.a.view,Object(m.a)(this,this.thb,"applyStyles"),1028);this.ga.Aa(Mb.a.createNewStyle,Kb.a.view,Object(m.a)(this,
this.createNewStyle,"createNewStyle"),4);this.ga.Aa(Mb.a.yjb,Kb.a.view,Object(m.a)(this,this.zVf,"deleteStyleDialog"),4);this.ga.Aa(Mb.a.CSd,Kb.a.view,this.Den.bind(this),4)}Den(a,d,n){a=sj.a.eLc(d)||this.nrn();if(1===n||a)return a?8:32;this.OYg.utj();return 32}thb(a,d,n){a=sj.a.eLc(d);if(1===n||a)return a?8:32;this.Tia.value.k_k(d);return 32}createNewStyle(a,d,n){a=sj.a.eLc(d);if(1===n||a)return a?8:32;this.Tia.value.B2k(d,this.ga);return 32}zVf(a,d,n){a=sj.a.eLc(d)||this.jrn();if(1===n||a)return a?
8:32;this.Tia.value.zVf(d);return 32}nrn(){var a=LL.a.f$a,d=LL.a.yH;const n=this.Xb.kn();if("{}"==a&&0==d.size)return!0;if(!({at:a}=x.d(a)).returnValue)return k.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),!1;if(Object.keys(a).length!=d.size)return!1;for(let O of d.values()){d=n.Mf(O);var z=a[O];if(null==z)return!1;if(z=sj.a.cGb(z)){if(this.Gg.sK||(d=sj.a.EFc(d,n)),z=this.nLl(z),sj.a.uKc(d,z))return!1}else k.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}nLl(a){if(!a)return null;
const d=a.Dh(),n=new Map;for(const z of d)n.set(z,a.Cy(z));return n}jrn(){var a=sj.a.qz();if(!a)return Ld.b(577368330,3018,15,"PageContentNode is null"),!0;a=(new Iw.WACStyleSet).VL(a);const d=a.Oz;for(let z=0;z<d;z++){var n=a.$X(z);if(this.gb.It(n)||!this.gb.Gu(n,a))continue;const O=this.gb.Mv(n);if(2===O||1===O)if(!n.hasProperty(Qb.a.AY)||2===O)if(n=n.fa(Qb.a.Et,null),!(n&&0<n.length))return!1}return!0}}Object(t.a)(ML,"StylesActor",null,[]);class sF{constructor(a){this.ga=a}lb(){this.ga.ma(Dc.a.x0e,
Kb.a.view,Object(m.a)(this,this.x0e,"switchToClassicViewMode"))}x0e(a,d,n){a=l.AFrameworkApplication.la;if(1===n)return 1!==a.mode||Yb.SessionStatusManager.instance.oj?2:32;ja.Health.instance.recordKpiUsage("SwitchToClassicViewMode",0,sF.aH,null);const z={};z[G.a.QCe]=l.AFrameworkApplication.K.Ga("ClassicViewModePreferenceCookieName");z[G.a.Phg]="true";l.AFrameworkApplication.jH().execute(O=>{O.Eh(D.a.$Fj,z)});return l.AFrameworkApplication.pa.processAction(Mb.a.BLb,2)}}sF.aH="wwaengidc";Object(t.a)(sF,
"SwitchToClassicViewModeActor",null,[]);class NL{constructor(a,d,n,z,O,ca,Da,Xa,zb){this.angle=n;this.styleId=z;this.width=a;this.height=d;this.top=O;this.bottom=ca;this.left=Da;this.right=Xa;this.t_=zb}}Object(t.a)(NL,"SWordData",null,[]);class OL{constructor(a,d){this.Mk=this.FZ=this.Qr=null;this.Esf=this.Muc=!1;this.eR=this.LW=this.Xoa=this.yt=this.tka=this.Ex=this.At=this.oG=0;this.Fm=null;this.In=a;this.wad=d;this.VMi()}VMi(){this.LW=this.eR=this.Xoa=this.yt=this.tka=this.Ex=this.At=this.oG=
-1;this.Fm=xa.a.nil}jqd(){this.Esf||(this.hRn(),this.E3k(),this.Muc=!1)}E3k(){this.Mk=new NL(this.At,this.Ex,this.oG,this.tka,this.yt,this.Xoa,this.eR,this.LW,this.Fm);this.wad.create(this.FZ,this.Qr).qnn(Object(m.a)(this,this.$ga,"onRequestComplete"),this.Mk);this.Esf=!0;let a;Object(Uc.a)(3,this.FZ)?a=WC.a[Kd.ImageReader.ml(this.FZ)]:(k.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),
a="generic");k.ULS.sendTraceTag(23171277,322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",this.At,this.Ex,this.oG,this.tka,this.yt,this.Xoa,this.eR,this.LW,a);this.VMi()}$ga(){this.Esf=!1;this.Muc&&this.jqd()}hRn(){this.At=-1!==this.At?this.At:this.FZ.fa(Xc.a.wIa,-1);this.Ex=-1!==this.Ex?this.Ex:this.FZ.fa(Xc.a.vIa,-1);this.At=-1!==this.At?this.At:this.In.Tz(this.FZ);this.Ex=-1!==this.Ex?this.Ex:
this.In.UA(this.FZ);this.oG=-1!==this.oG?this.oG:this.In.WX(this.FZ);this.tka=-1!==this.tka?this.tka:this.In.PTa(this.FZ);this.yt=-1!==this.yt?this.yt:this.In.zba(this.FZ);this.Xoa=-1!==this.Xoa?this.Xoa:this.In.wba(this.FZ);this.eR=-1!==this.eR?this.eR:this.In.xba(this.FZ);this.LW=-1!==this.LW?this.LW:this.In.yba(this.FZ)}dYm(a,d,n,z){this.Qr=a;this.oG=n;this.Muc=!0;this.FZ=d;this.Fm=z;this.jqd()}cYm(a,d,n,z,O){this.Qr=a;this.Muc=!0;this.FZ=d;this.Fm=O;this.FZ.setValue(Xc.a.wIa,n);this.FZ.setValue(Xc.a.vIa,
z);this.jqd()}fYm(a,d,n){this.Qr=a;this.Muc=!0;this.FZ=d;this.tka=n;this.jqd()}YXm(a,d,n,z,O,ca){this.Qr=a;this.yt=n;this.Xoa=z;this.eR=O;this.LW=ca;this.Muc=!0;this.FZ=d;d=a=0;({width:a,height:d}=this.In.ETa(this.FZ));this.At=a-(O+ca)/1E5*a;this.Ex=d-(n+z)/1E5*d;this.jqd()}}Object(t.a)(OL,"SWordRequestManager",null,[554]);class ZD{constructor(a,d,n,z=null,O=null,ca=null,Da=null,Xa=null,zb=null,Vb=null){this.Gj=null;this.GRh=!1;this.faa=a;this.pwf=d;this.Wl=n;this.pZ=z;this.Sy=O;this.dGa=ca;this.n_a=
Da;this.Ja=Xa;this.Nb=zb;this.yhf=Vb}get eh(){return this.Gj||(this.Gj=this.faa())}lb(){const a=l.AFrameworkApplication.pa,d=Object(m.a)(this,this.JBn,"tabView");a.Aa(Mb.a.tab,Kb.a.view,d,1124);a.Aa(Mb.a.KYe,Kb.a.view,d,1124);a.ma(Mb.a.hkg,Kb.a.view,Bc.ActionManager.Ke)}JBn(a,d,n,z,O){if(1===n)return 32;const ca=a===Mb.a.KYe;if(!d.view.Yd)return 2;const Da=d.view,Xa=Da.Oa,zb=Xa.Ag;if(!zb||ZD.If.E3(zb))return 2;if(this.Wl&&this.Wl.instance&&this.Wl.instance.l0(zb))return 4;a=null;var Vb=Bc.ActionManager.P4;
let Fc=!1;var Yc=Qd.SelectionEditor.Cd(zb);if(zb.Iq){if(Xa.ya.EE&&(Vb=zb.getContext(0),a=new Dd.GraphIterator,a.set(Vb.node),a.tn(),Vb=ca?Mb.a.GWe:Mb.a.TSd),Vb=this.pwf.eUm(Vb),Vb===Bc.ActionManager.P4){var yd=ZD.jg.xU(zb,16);yd?(ca&&(Vb=Mb.a.IId),a=new Dd.GraphIterator,a.set(yd.node),a.kc()):Vb=ca?Mb.a.NK:Mb.a.JU}}else if(zb.Cj)if(a=new Dd.GraphIterator,a.set(zb.node),Qd.SelectionEditor.Vm(a),qh.OutlineReader.Aga(zb))Vb=ca?Mb.a.GWe:Mb.a.TSd;else{if(this.yhf&&this.yhf.Psn(zb))return this.yhf.tXe(zb,
Da.Za),32;Vb=ca?this.pwf.nUl(a,zb,Vb,d):this.pwf.mUl(a,zb,Vb,d);Ia.OutlineElementReader.gg(a)&&zb.contextId===Kb.a.Ub&&(Fc=Ia.OutlineElementReader.Hs(a,zb,!1));yd=Bf.ListReader.Bh(a)&&Fc;Vb!==Bc.ActionManager.P4||Sf.TableCellReader.nJa(a)||yd||(this.GRh||(k.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.GRh=!0),l.AFrameworkApplication.pa.processAction(Mb.a.hkg,2),this.HNi(d))}else return 2;if(!ca&&Vb===Bc.ActionManager.P4&&Sf.TableCellReader.nJa(a))if(Uf.returnToCell(a),
Sf.TableCellReader.UAa(a)||If.TableReader.hpg(a)&&Sf.TableCellReader.Jpg(a)){if(Vb=this.ctk(),!Vb)return 2}else Vb=Mb.a.xDg;if(Vb===Bc.ActionManager.P4)return 2;switch(Vb){case Mb.a.xDg:case Mb.a.IId:z=Vb===Mb.a.IId;Yc&&this.pZ&&this.Sy&&(Yc=this.pZ.H1f(zb,-1,!0,xb.a.Nw))&&this.Sy.Mtj(Yc);n=32;Uf.returnToCell(a);Uf.moveToNextOrPreviousCell(a,z)&&(Yc=!0,z=!1,qh.OutlineReader.rCe(a)||(Ll.OutlineNavigator.MMc(a,!1),qe.OutlineElementNavigator.Sd(a),Bd.ParagraphReader.yl(a.currentNode)&&(Yc=!1,Bd.ParagraphReader.textLength(a.currentNode)||
(z=!0)),z||Uf.returnToCell(a)),z?a=ye.SelectionFactory.Pc(a.currentNode,0):(a=ye.SelectionFactory.Bl(a.currentNode),!Yc&&Qd.SelectionEditor.sg(a.Fb)&&(Yc=a.toArray(),Array.removeAt(Yc,Yc.length-1),a=new pa.Selection(Yc,a.Ac))),Xa.setSelection(a));break;case Mb.a.GWe:case Mb.a.TSd:Vb===Mb.a.TSd?Ll.OutlineNavigator.jBg(a,!1):Ll.OutlineNavigator.jBg(a,!0);Xa.setSelection(ye.SelectionFactory.Bl(a.currentNode));n=32;break;case Mb.a.wTc:n=l.AFrameworkApplication.pa.rf(d,Vb,n,!0,z,O);break;default:if(n=
l.AFrameworkApplication.pa.rf(d,Vb,n,!0,z,O),!Fc&&Yc&&(Vb===Mb.a.NK||Vb===Mb.a.JU)){const je=Qd.SelectionEditor.gfa(Xa.ya.Ba).y;Lb.App.Wic(()=>{this.Yxm(Xa,Da,je)})}}32===n&&d.view.Yd&&this.eh.$A();return n}Yxm(a,d,n){if(a&&d){var z=a.ya.Ba;Qd.SelectionEditor.gfa(z).y<n?(d=Qd.SelectionEditor.Fkb(d,z,!1),d=Qd.SelectionEditor.K_(d,{jr:!1,ik:!1,gt:!1,nu:!0})):d=Qd.SelectionEditor.QEb(d,z,!1);a.setSelection(d)}}ctk(){return Mb.a.PUa}HNi(){}tId(a,d,n){if(a&&d){var z=a.ya.Ba;Qd.SelectionEditor.gfa(z).y<
n?(d=Qd.SelectionEditor.Fkb(d,z,!1),d=Qd.SelectionEditor.K_(d,{jr:!1,ik:!1,gt:!1,nu:!0})):d=Qd.SelectionEditor.K_(z,{jr:!1,ik:!1,gt:!1,nu:!0});a.setSelection(d)}}static get If(){return aj.a.instance}static get jg(){return bl.ContextSetEditor.instance}}Object(t.a)(ZD,"TabActor",null,[]);class ZG{constructor(a){this.K3c=a}get dr(){return this.K3c}eUm(a){return a}nUl(a,d,n,z){const O=z.view,ca=O.Oa.ya.Ba;if(Sf.TableCellReader.nJa(a))return this.LRi(a,z)?Mb.a.NK:Mb.a.IId;qe.OutlineElementNavigator.Uc(a);
if(Qd.SelectionEditor.Cd(d))Ia.OutlineElementReader.Hs(a,d,!1)&&this.oBj(a)?n=Mb.a.bLb:Qd.SelectionEditor.eIb(O,ca)&&this.dr.f4b(a)?n=Mb.a.NK:Qd.SelectionEditor.eIb(O,ca)&&(n=Mb.a.NK);else if(Qd.SelectionEditor.Ch(d)){if(!this.dr.f4b(a))return n;Qd.SelectionEditor.OIa(d)?n=Mb.a.NK:Qd.SelectionEditor.Qsg(d)&&(n=this.oBj(a)?Mb.a.bLb:Mb.a.NK)}else this.dr.f4b(a)&&(n=Mb.a.NK);return n}mUl(a,d,n,z){if(Sf.TableCellReader.cM(a))return this.LRi(a,z)?Mb.a.JU:n;qe.OutlineElementNavigator.Uc(a);if(Qd.SelectionEditor.Cd(d))Ia.OutlineElementReader.Hs(a,
d,!1)&&(!Bf.ListReader.Bh(a)&&Ia.OutlineElementReader.isEmpty(a,!1)?n=Bc.ActionManager.P4:this.irn(a)?n=Mb.a.Ajb:this.HAj(a)?n=Mb.a.ODb:this.dr.hAc(a)&&(n=Mb.a.JU));else if(Qd.SelectionEditor.Ch(d)){if(!this.dr.hAc(a))return n;Qd.SelectionEditor.OIa(d)?n=Mb.a.JU:Qd.SelectionEditor.Qsg(d)&&(n=this.HAj(a)?Mb.a.ODb:Mb.a.JU)}else this.dr.hAc(a)&&(n=Mb.a.JU);return n}oBj(a){return Bf.ListReader.Bh(a)?!1:0<Ia.OutlineElementReader.b4(a)?!0:!1}HAj(a){if(Bf.ListReader.Bh(a))return!1;const d=Ia.OutlineElementReader.b4(a);
a=qh.OutlineReader.OP(a.currentNode);return d<a?!0:!1}irn(a){return Bf.ListReader.Bh(a)?!1:0<Ia.OutlineElementReader.ML(a)?!0:!1}static Ao(){return new ZG(nt.a.P9b)}LRi(a,d){if(this.fem){d=d.view;const n=d.Oa.ya.Ba,z=new Dd.GraphIterator;z.Cb(a);qe.OutlineElementNavigator.Uc(z);if(Bf.ListReader.Bh(z)&&Qd.SelectionEditor.eIb(d,n))return!0}return!1}get fem(){var a;l.AFrameworkApplication.Yi("egdi3422;7g6fa693");return null===(a=l.AFrameworkApplication.K)||void 0===a?void 0:a.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",
!1)}}Object(t.a)(ZG,"TabActorPromoteDemoteStrategy",null,[568]);class WB extends ZD{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd){super(a,d,n,z,O,ca,Da,Xa,zb,Vb);this.rad=null;this.Ouc=Fc;this.ga=yd;this.wD();this.ga.ma(Dc.a.OP,Kb.a.view,Object(m.a)(this,this.OP,"getDefaultTabStop"))}get TQd(){return this.rad||(this.rad=la.a.instance.sa("WordEditor.Actors.RenderParagraphsContainingTabs"))}wD(){this.Ouc.Cm.Oe(10).tq(Object(m.a)(this,this.AKd,"onOutlinePropertyChanged"))}AKd(a,d){a=d.property;!this.TQd||
a!==Qb.a.iq&&a!==Qb.a.marginLeft&&a!==Qb.a.marginRight||this.TQd.Fi()}HNi(a){const d=a.view,n=d.Oa;a=n.Ag;if(this.n_a&&this.Nb){var z=this.Nb.Wb(15);z.Sa(a.node);a.contextId===Kb.a.Lc&&l.AFrameworkApplication.pa.processAction(Mb.a.iK,2);this.n_a.fEe(n.Ag,this.dGa,this.Ja);z.dispose();var O=Qd.SelectionEditor.gfa(n.ya.Ba).y;Lb.App.Wic(()=>{this.tId(n,d,O)})}}oJl(a){return a.view.Oa.ya.Ba.ra.node}OP(a,d,n,z,O){a=qh.OutlineReader.OP(this.oJl(d));O.defaultTabStop=a;return 32}static get instance(){return WB.na||
(WB.na=WB.al())}static al(){return new WB(()=>la.a.instance.resolve("Box4.IUndoManager"),ZG.Ao(),la.a.instance.Ca("Box4.IExternalSelectionManager"),la.a.instance.resolve("Box4.IAutoCorrectRules"),la.a.instance.resolve("Box4.IAutoCorrectScheduler"),la.a.instance.sa("Box4.ITabPresenterFactory"),la.a.instance.sa("Box4.IBlobEditor"),la.a.instance.sa("Box4.IFeatureHelper"),la.a.instance.sa("Box4.Graph.GraphTransactionFactory"),la.a.instance.sa("Box4.Actors.IIFrameFocusStrategy"),Lb.App.jj,la.a.instance.sa("Box4.ITabRenderer"),
l.AFrameworkApplication.pa)}}WB.na=null;Object(t.a)(WB,"TabActor",ZD,[]);class Lq{static get xr(){return Lq.gh||(Lq.gh=la.a.instance.resolve("Box4.IAppFrame"))}static get eVi(){null==Lq.Ikf&&(Lq.Ikf=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAutoContextualTabSwitch",!1):!1);return Lq.Ikf}static initialize(){xs.a.UKc=Lq.Tem;xs.a.Lub=Lq.NSn}static Tem(a){return!If.TableReader.QRi(a)}static VJb(){Lq.xr.sjc(Lq.VJb);Lq.gYb=!1;const a=appChrome.selectors.getActiveContextualTabIds();
Lq.Hkf=!1;"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(a,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static NSn(a){if(a){if(Qs.a.instance.Ba.xY||Qs.a.instance.Ba.ym||Qs.a.instance.Ba.k6a)Lq.eVi&&!Lq.gYb&&Lq.Hkf?(Lq.xr.m2a(Lq.VJb),Lq.gYb=!0,Lq.fia("SimplifyRibbonContextualCommandsUsageTreatment","EnableAutoContextualTabSwitch")):Lq.fia("SimplifyRibbonContextualCommandsUsageControl","DefaultContextTabBehaviour")}else Lq.eVi&&(Lq.Hkf=!0)}static fia(a,
d){const n=la.a.instance.Ca("Common.ISystemInitiatedFeedback");n&&n.execute(z=>{z.logActivity(a,d)})}}Lq.gYb=!1;Lq.Hkf=!1;Lq.gh=null;Lq.Ikf=null;Object(t.a)(Lq,"TableActor",null,[]);var aQ=b(1527);class $G{Ooi(a,d,n,z){return a?this.okl(d,n,z):this.Fll(d,n,z)}que(a,d,n,z,O){return a?this.ill(d,n,z,O):this.Xkl(d,n,z,O)}Vkl(a){let d=!1;var n=a.Ac?a.fc.Fb:a.fc.ra;a=new Dd.GraphIterator;a.set(n.node);a.La(14);n=null;Sf.TableCellReader.Yba(a)?Sf.TableCellReader.XIa(a)||(d=!0,n=Uf.moveToNextRow(a)):n=Uf.moveToNextColumn(a);
return{returnValue:n,oym:d}}ell(a){var d=a.Ac?a.fc.Fb:a.fc.ra;const n=new Dd.GraphIterator;n.set(d.node);n.La(14);d=null;Sf.TableCellReader.Wba(n)?Sf.TableCellReader.AS(n)||(d=new Dd.GraphIterator,d.set(a.q3.node),d.La(14),a=km.a.hm(d),km.a.hm(n)>a?(Uf.moveToPreviousRow(n),Uf.moveToLastColumn(n),d=n.currentNode):d=Uf.moveToPreviousRow(n)):d=Uf.moveToPreviousColumn(n);return d}Noi(a,d){var n=a.Ac?a.fc.Fb:a.fc.ra;a=new Dd.GraphIterator;a.set(n.node);a.La(14);n=null;d?Sf.TableCellReader.AS(a)||(n=Uf.moveToPreviousRow(a)):
Sf.TableCellReader.XIa(a)||(n=Uf.moveToNextRow(a));return n}ydc(a,d,n){for(;Sf.TableCellReader.we(a);)if(d){if(n&&a.BS(1)||!n&&a.CS(1))return null;n?Uf.moveToPreviousColumn(a):Uf.moveToNextColumn(a)}else{if(Sf.TableCellReader.kV(a.currentNode)){const z=new Dd.GraphIterator;z.Cb(a);if(this.ydc(z,!0,!0)||this.ydc(z,!0,!1)){a.Cb(z);break}}else{if(!n&&Uf.moveToControllingCell(a,2))break;if(n&&Uf.moveToControllingCell(a))break}if(n&&Sf.TableCellReader.AS(a)||!n&&Sf.TableCellReader.XIa(a))return null;n?
Uf.moveToPreviousRow(a):Uf.moveToNextRow(a)}return a.currentNode}wEc(a,d){if(!km.a.isTableRow(a))return null;a=Dd.GraphIterator.ua(a.currentNode);a.La(14);let n;const z=If.TableReader.Qx(a.origin);do n=d?Uf.moveToPreviousRow(a):Uf.moveToNextRow(a);while(z&&n&&km.a.vga(a));return n}Sga(a,d,n,z,O){let ca=null;qe.OutlineElementNavigator.Uc(a);const Da=Ia.OutlineElementReader.isRtl(a.currentNode);if(n)if(Uf.returnToCell(a),d=Sf.TableCellReader.Yba(a),n=Sf.TableCellReader.Wba(a),O||!Da&&n||Da&&z&&d)Uf.returnToContainingRow(a),
(z=this.wEc(a,!0))?ca=ye.SelectionFactory.Tm(z,!d):O&&(qe.OutlineElementNavigator.Uc(a),O=new Pi.a,O.Cb(a),(a=qe.OutlineElementNavigator.D0(O,!1,!1))&&(ca=ye.SelectionFactory.Tm(a,!1)));else{do Da?Uf.moveToNextColumn(a):Uf.moveToPreviousColumn(a);while(Sf.TableCellReader.we(a)&&!Sf.TableCellReader.AS(a));Sf.TableCellReader.we(a)||(ca=ye.SelectionFactory.Tm(a.currentNode,!Da))}else Ia.OutlineElementReader.Hs(a,d,Da)||Qd.SelectionEditor.Cd(d)||Uf.returnToCell(a),ca=ye.SelectionFactory.Tm(a.currentNode,
!Da);return ca}Rga(a,d,n,z,O){let ca=null;qe.OutlineElementNavigator.Uc(a);const Da=Ia.OutlineElementReader.isRtl(a.currentNode);if(n)if(Uf.returnToCell(a),n=Sf.TableCellReader.Yba(a),d=Sf.TableCellReader.Wba(a),O||!Da&&z&&n||Da&&!z&&d)Uf.returnToContainingRow(a),(z=this.wEc(a,!1))?ca=ye.SelectionFactory.Tm(z,d):(qe.OutlineElementNavigator.Uc(a),z=new Pi.a,z.Cb(a),(a=qe.OutlineElementNavigator.Mt(z,!1,!1))&&(ca=ye.SelectionFactory.Tm(a,!0)));else{do Da?Uf.moveToPreviousColumn(a):Uf.moveToNextColumn(a);
while(Sf.TableCellReader.we(a)&&!Sf.TableCellReader.Yba(a));Sf.TableCellReader.we(a)||(ca=ye.SelectionFactory.Tm(a.currentNode,Da))}else Ia.OutlineElementReader.Hs(a,d,!Da)||Qd.SelectionEditor.Cd(d)||Uf.returnToCell(a),ca=ye.SelectionFactory.Tm(a.currentNode,Da);return ca}}Object(t.a)($G,"ATableCellSelectionStrategy",null,[1283]);class PL extends $G{constructor(){super()}Xkl(a,d,n,z){let O=a.Ba,ca=null;if(a.ym)if(d)if(2===O.fc.qV&&!O.Ac&&O.fc.Fb.equals(O.q3))O=ye.SelectionFactory.Jpe(O.q3.node,!1);
else{var Da=({oym:a}=this.Vkl(O)).returnValue;Da&&(Sf.TableCellReader.jo(Da)&&(Da=Dd.GraphIterator.ua(Da),Da.La(14),Da=!a&&this.ydc(Da,!0,!1)?Da.currentNode:a||Uf.moveToNextRow(Da)?this.ydc(Da,!1,!1):null),Da&&(ca=ye.SelectionFactory.uj(ht.TableNodeContext.create(Da),O.Ac)))}else O=a.xO,a=Dd.GraphIterator.ua(O.fc.Fb.node),a.La(14),Sf.TableCellReader.nY(a.currentNode)&&Uf.moveToLastGhostCell(a,2),(Da=Uf.moveToNextColumn(a))?(a=Sf.TableCellReader.kV(Da),Sf.TableCellReader.jo(Da)&&!a&&(Da=Dd.GraphIterator.ua(Da),
Da.La(14),Da=Uf.moveToControllingCell(Da)),a?O=ye.SelectionFactory.Tm(O.fc.Fb.node,!1):ca=ye.SelectionFactory.Tm(Da,!0)):(Da=O.fc.Fb.node,ca=ye.SelectionFactory.Tm(Da,!1));else a=d&&O.Ac||!d&&!O.x4?O.fc.Fb:O.fc.ra,km.a.Sma(a.node)&&(a=Dd.GraphIterator.ua(a.node),(Da=this.wEc(a,!1))?ca=d?ye.SelectionFactory.uj(ht.TableNodeContext.create(Da),O.Ac):ye.SelectionFactory.Tm(Da,!0):O=Qd.SelectionEditor.Xf(ye.SelectionFactory.Bl(a.currentNode),!1,!0));return ca?ca:z?Qd.SelectionEditor.i4a(O,!1,d,!0):Qd.SelectionEditor.K_(O,
{jr:!d,ik:d,gt:n,nu:!0})}ill(a,d,n,z){let O=a.Ba;var ca=null;if(a.ym)d?1===O.fc.qV&&O.Ac&&O.fc.ra.equals(O.q3)||(ca=this.ell(O),(ca=this.Boi(O,ca))||O.Ac&&(O=O.WEb())):(O=a.xO,ca=ye.SelectionFactory.Tm(O.fc.ra.node,!0));else if(d){var Da=(O.Ac?O.fc.Fb:O.fc.ra).node;a=Dd.GraphIterator.ua(Da);Qd.SelectionEditor.Vm(a);km.a.Sma(Da)&&(O.Ac&&1===O.fc.qV&&O.x4?(ca=km.a.RB(Da).toArray(),(ca=this.Boi(O,0<=ca.length-2?ca[ca.length-2]:null))||O.Ac&&(O=O.WEb())):(Da=this.wEc(a,!0))?ca=ye.SelectionFactory.uj(ht.TableNodeContext.create(Da),
O.Ac):O=ye.SelectionFactory.Tm(a.currentNode,!0))}else ca=Qd.SelectionEditor.Xf(O,!0,!1);return ca?ca:z?Qd.SelectionEditor.i4a(O,!0,d,!0):Qd.SelectionEditor.L_(O,{jr:!d,ik:d,gt:n,nu:!0})}Boi(a,d){if(!d)return null;var n=d;Sf.TableCellReader.jo(d)&&(n=Dd.GraphIterator.ua(d),n.La(14),n=this.ydc(n,!0,!0)?n.currentNode:Sf.TableCellReader.UU(d));return n?ye.SelectionFactory.uj(ht.TableNodeContext.create(n),a.Ac):null}Fll(a,d,n){let z=d.Ba,O=null;if(d.ym){var ca=d.WC>d.k1;if(n)if(2===d.length&&1===d.xO.fc.qV&&
ca)z=Qd.SelectionEditor.Xf(z,!0,!1);else{if(d=this.Noi(z,!0))Sf.TableCellReader.jo(d)&&(d=Dd.GraphIterator.ua(d),d.La(14),d=this.ydc(d,!1,!0)),d&&(O=ye.SelectionFactory.uj(ht.TableNodeContext.create(d),z.Ac));O||z.Ac&&(z=z.WEb())}else ca&&(z=d.xO)}else d=n&&z.Ac?z.fc.Fb:z.fc.ra,km.a.Sma(d.node)&&(d=Dd.GraphIterator.ua(d.node),(ca=this.wEc(d,!0))?O=n?ye.SelectionFactory.uj(ht.TableNodeContext.create(ca),z.Ac):ye.SelectionFactory.Tm(ca,!0):n&&(z=ye.SelectionFactory.Tm(d.currentNode,!0)));return O?O:
Qd.SelectionEditor.tla(a,z,!1,n,n)}okl(a,d,n){let z=d.Ba,O=null;if(d.ym){const ca=d.WC<d.k1;if(n)if(2===d.length&&1===d.xO.fc.qV&&ca)z=Qd.SelectionEditor.Xf(z,!1,!1);else{if(d=this.Noi(z,!1))Sf.TableCellReader.jo(d)&&(d=Dd.GraphIterator.ua(d),d.La(14),d=this.ydc(d,!1,!1)),d&&(O=ye.SelectionFactory.uj(ht.TableNodeContext.create(d),z.Ac))}else ca&&(z=d.xO)}else d=!n||z.Ac?z.fc.Fb:z.fc.ra,km.a.Sma(d.node)&&(d=Dd.GraphIterator.ua(d.node),(d=this.wEc(d,!1))&&(O=n?ye.SelectionFactory.uj(ht.TableNodeContext.create(d),
z.Ac):ye.SelectionFactory.Tm(d,z.x4)));return O?O:Qd.SelectionEditor.tla(a,z,!0,n,n)}}Object(t.a)(PL,"TableCellSelectionStrategy",$G,[]);class QL{constructor(a){this.ga=a}lb(){this.ga.Aa(Mb.a.yQ,Kb.a.view,Object(m.a)(this,this.yQ,"showProgressDialog"),1028)}yQ(a,d,n,z,O){if(1===n)return 32;a=(new vh.a).create();d="";switch(O.DialogType){case "DirectPrintPreparingPDF":d=CommonUIStrings.l_DirectPrintPreparingPDF;O=CommonUIStrings.l_DefaultDialogTitle;break;default:O=CommonUIStrings.l_DefaultDialogTitle}a.message=
d;a.yQ(O,null,null);return 32}}Object(t.a)(QL,"UIAutomationActor",null,[]);class RL{constructor(a,d,n,z,O,ca,Da,Xa,zb=null){this.Ha=a;this.n_a=d;this.nYc=n;this.oea=z;this.L4d=zb||Object(m.a)(this,this.kz,"createIpContextAtEndOfParagraph");this.Ja=O;this.dGa=ca}Bbh(a,d,n){return this.nYc.ndm(d)?n?!0:a&&this.Ha.Zf(a)?(a=this.L4d(a.currentNode),this.n_a.PNi(a),!0):!1:!1}Efg(a,d){return this.nYc.Ogl(a,d)}Jfg(a){a&&this.Ha.Zf(a)&&(a=this.L4d(a.currentNode),this.n_a.fEe(a,this.dGa,this.Ja))}kz(a){return fe.a.kz(a)}ZXa(a,
d,n){this.oea.Zdj&&this.nYc.RQi(n)&&(this.oea.ZXa(a,d),a.setValue(Xc.a.bog,!0))}LXe(){}EFe(a){return this.nYc.EFe(a)}get BGe(){return this.nYc.BGe}cF(){}Vta(){}eYe(){}get KBj(){return!1}}Object(t.a)(RL,"WordEditorPasteStewardBridge",null,[540]);class SL{constructor(a){this.ka=new oc.a;this.Vsj="WordFileSaveAsButtonClicked";this.ga=a}lb(){l.AFrameworkApplication.K.ea("UseNewCommandForWordFileMenuSaveAs")&&this.ga.ma(Dc.a.nTj,Cd.a.frame,Object(m.a)(this,this.PSn,"wordFileMenuSaveAsClickHandler"))}PSn(){this.ka.raiseEvent(this.Vsj,
null);return 32}izk(a){this.ka.addHandler(this.Vsj,a)}}Object(t.a)(SL,"WordFileSaveAsActor",null,[]);class TL extends Fo{constructor(){super()}zhd(a,d,n,z,O,ca,Da){return Dp.a.ROc(d,n,z,O,ca,Da)}}Object(t.a)(TL,"WordIndentationActorExtension",Fo,[]);class UL extends kj.a{constructor(){super()}get kAa(){return!0}get eac(){return 5}get HGb(){if(null!=this.lja)return this.lja;this.lja=[];Array.add(this.lja,new zn.a(Ji.a.Rke,Ji.a.Rke));Array.add(this.lja,new zn.a(Ji.a.BHf,Ji.a.BHf));Array.add(this.lja,
new zn.a(Ji.a.Fid,Ji.a.Fid));return this.lja}o7a(a,d){if(this.kAa){var n=this.YB.z3a,z=this.YB.wIe;if(n)if(5===n.type){z=n.pK;if(n.zV&&n.zV.V4.includes(a))for(const O of d.xic("*"))this.YB.gsb(O);z&&z.V4.includes(a)&&this.jUd(d,n.action,z,a)}else z&&5===z.type&&3===n.action&&z.pK.V4.includes(a)&&this.jUd(d,0,z.pK,a)}}rpb(a){return Object(Uc.a)(mF,a)}VFb(a,d){if(a)for(let n of a.V4)d.add(n)}jUd(a,d,n,z){if(0===d&&a.htmlElement){a=a.xic("*");d=a.length;const Vb=Ji.a.Rke,Fc=z.id===n.h1h,Yc=z.id===n.b1h;
let yd=!1,je=0;var O=[];let Le=Array(d);for(let Ve=0;Ve<d;Ve++){var ca=a[Ve];const gg=kn.a(ca);Le[Ve]=gg;const Lh=ca.classList;if(0!=Le[Ve]){const Ki=!Lh.contains(Ji.a.EP);let Ak=Ag.a.Ta(ca,Ji.a.E3b);Ak&&O.push(...Ak);if(Fc){let Uk;if((Uk=Ag.a.Ta(ca,Ji.a.Ske))&&Ak&&1===Uk.length&&1===Ak.length&&Uk[0].equals(Ak[0]))continue;Uk&&(je+=Uk.length,1===gg?Lh.add(Ji.a.BHf):Lh.add(Vb));if(Ak)for(var Da of Ak)this.SEe(n,Da)&&(je--,yd&&Lh.add(Ji.a.Fid));0!==je&&Ki&&Lh.add(Vb)}if(!Fc&&!Yc&&n.DHk.has(z.id))if((ca=
Ag.a.Ta(ca,Ji.a.E3b))&&yd){Lh.add(Vb);for(var Xa of ca)if(this.SEe(n,Xa)){Lh.add(Ji.a.Fid);break}}else Ki&&Lh.add(Vb)}yd=!Lh.contains(Ji.a.p7b)}if(Yc&&!Fc){z=new Set;for(var zb of O)this.SEe(n,zb)&&z.add(zb);yd=!1;for(zb=0;0!==z.size&&zb<d;zb++){O=a[zb];Da=O.classList;if(0!=Le[zb])if(Xa=!1,O=Ag.a.Ta(O,Ji.a.E3b)){for(let Ve of O)this.SEe(n,Ve)&&(z.delete(Ve),Xa=!0);0!==z.size&&Da.add(Vb);yd&&Xa&&Da.add(Ji.a.Fid)}else Da.contains(Ji.a.EP)||Da.add(Vb);yd=!Da.contains(Ji.a.p7b)}}}}SEe(a,d){for(let n of a.BHk)if(d.equals(n))return!0;
return!1}}Object(t.a)(UL,"BookmarkHighlightActor",kj.a,[221]);var $D=b(493);class VL{constructor(a,d,n){this.Sbb="wwaengidc";this.K4d="CreateLinkForHeading";this.x6j="CreateLinkForHeadingAction";this.m8j="\ufffc";this.NEa=a;this.ga=d;this.Ha=n}lb(){this.ga.ma(Dc.a.cnd,Kb.a.paragraph,this.oSf.bind(this));this.ga.ma(Dc.a.cnd,Kb.a.Lc,this.oSf.bind(this));this.ga.ma(Dc.a.cnd,Kb.a.Ub,this.oSf.bind(this));this.ga.$b(Dc.a.cnd,1028)}oSf(a,d,n){l.AFrameworkApplication.Zi("Microsoft.Office.WordOnline.HeadingDeeplinkIsEnabled");
if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.HeadingDeeplinkIsEnabled",!1)){a=d.node;if(1===n)return this.vSi(a)?32:8;this.t0m(this.K4d,this.x6j);if(!this.vSi(a))return k.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),8;n=a.getValue(Qb.a.Ob);if(!n)return k.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),n=new Map,n.set("Source",this.K4d),n=Object.assign(new Sg.a,
{EA:n}),ja.Health.instance.recordKpiFailure(this.K4d,"Unable to create sharable link as paragraph id is missing",!1,!0,n),8;n=String.format('{{"{0}":"{1}"}}',$D.a.heading,n);a={};a.nav=btoa(n);a.mode="copy";this.ga.ob(Sa.a.wkb,2,a);return 32}return 8}vSi(a){return!this.Ha.nb(a)||this.Ha.ZJc(a)||this.Ha.HCd(a)||a.ko||""===a.characterData||a.characterData===this.m8j||!this.NEa.Axe(a)?!1:!0}t0m(a,d){const n=new Map;n.set("Source",this.K4d);n.set("Action",d);ja.Health.instance.recordKpiUsage(a,0,this.Sbb,
n)}}Object(t.a)(VL,"HeadingsActor",null,[]);var bQ=b(781);class aH{constructor(){this.A9d=this.Ja=this.JW=this.Z=null}get name(){return"WordEditor.Actors"}init(){Ic.InteractiveViewManager.instance.editingView.HCc=!0;l.AFrameworkApplication.pa.ma(Dc.a.qSn,Cd.a.frame,OP);bL.DeleteActor.instance.lb(l.AFrameworkApplication.pa);QB.instance.lb();dm.lb();qq.lb(l.AFrameworkApplication.pa,this.Z.resolve("WordEditor.IMainViewModeManager"));Zk.lb();WB.instance.lb();aQ.a.lb();this.Z.resolve("WordEditor.Actors.ModeSwitcherControlActor").lb(l.AFrameworkApplication.pa);
this.Z.resolve("WordEditor.Actors.ExternalContentActor").lb();this.Z.resolve("WordEditor.OnlineMedia.OnlineMediaActor").lb();l.AFrameworkApplication.K.ea("WordEditorFormatPainterIsEnabled")&&this.Z.resolve("Box4.Actors.FormatPainterActor").lb();l.AFrameworkApplication.K.ea("WordEditorAutoSaveImprovementIsEnabled")&&this.Z.resolve("WordEditor.Actors.SaveStatusActor").lb();l.AFrameworkApplication.K.ea("WritingStyleIsEnabled")&&l.AFrameworkApplication.K.ea("WordWritingStylesDialogIsEnabled")&&(this.JW.IGe=
!0);l.AFrameworkApplication.K.ea("SharedUXThemingIsEnabled")&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&this.Z.resolve("WordEditor.Actors.ModernUxActor").lb();l.AFrameworkApplication.K.ea("WordConsumptionViewToEditRedirectIsEnabled")&&this.Z.resolve("WordEditor.Actors.SwitchToClassicViewModeActor").lb();this.Z.resolve("WordEditor.Actors.AppFrameCommandUIActor").lb();this.Z.resolve("Common.IOfficeTrialExperience").lb();this.Z.resolve("Common.IMacOfficeOffer").lb();
this.Z.resolve("WordEditor.Actors.MarginsDialogActor").lb();this.Z.resolve("WordEditor.Actors.PaperSizeDialogActor").lb();this.Z.resolve("WordEditor.Actors.FileDownloadActor").lb();this.Z.resolve("WordEditor.Actors.StylesActor").lb();this.Z.resolve("WordEditor.Actors.ParagraphDialogActor").lb();this.Z.resolve("WordEditor.Actors.ProofingActor").lb();this.Z.resolve("WordEditor.Actors.PageActor").lb();this.Z.resolve("WordEditor.Actors.DarkModeActor").lb();this.Z.resolve("WordEditor.Actors.ImageActor").lb(l.AFrameworkApplication.pa);
this.Z.resolve("WordEditor.Actors.FormattingActor").lb();this.Z.resolve("WordEditor.Actors.UIAutomationActor").lb();this.Z.resolve("WordEditor.Actors.ContentControlActor").lb();this.Z.resolve("WordEditor.Actors.CustomTabActor").lb();this.Z.resolve("WordEditor.Actors.BookmarkActor").lb();this.Z.resolve("WordEditor.Actors.HeadingsActor").lb();this.Z.resolve("Box4.Indicator.IIndicatorManager").MLb(this.Z.resolve("WordEditor.Actors.BookmarkIndicatorActor"));this.Z.resolve("WordEditor.Actors.AccessibilityHelpDialogActor").lb();
this.Z.resolve("WordEditor.Actors.AccessibilityActor").XSg();this.Z.resolve("WordEditor.Actors.ISWordRequestManager");this.Z.resolve("Box4.Actors.AutoCorrectActor").lb();this.Z.resolve("WordEditor.Actors.DigitalPrintActor").lb();this.Z.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager");this.Z.resolve("Box4.Actors.VisiMarkersActor").lb();this.Z.resolve("WordEditor.Actors.ExternalContentFloatieEventManager");this.Z.resolve("WordEditor.Actors.ActionHangDetector").b5();this.Z.resolve("WordEditor.Actors.WordFileSaveAsActor").lb();
l.AFrameworkApplication.K.ea("GraphicsEditorActorRegistrationUpdateIsEnabled")?this.U1m():this.Z.resolve("WordEditor.Actors.GraphicsEditorActor").lb();this.uea.LLb(this.P3j);const a=this.Z.resolve("WordEditor.Bookmark.FullBookmarkManager");l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&0<a.$Ec(!1).count&&Lb.App.oa.za.zki();Lb.App.oa.updateCommandUI();Lq.initialize()}dispose(){}U1m(){this.Ja.tk.isCompleted?this.Ja&&this.Ja.isFeatureEnabled(81)&&
this.Z.resolve("WordEditor.Actors.GraphicsEditorActor").lb():this.Ja.tk.continueWith(()=>{this.Ja&&this.Ja.isFeatureEnabled(81)&&(this.Z.resolve("WordEditor.Actors.GraphicsEditorActor").lb(),Lb.App.oa.updateCommandUI())})}get Edm(){if(null==this.A9d)if(this.Ja)if(this.Ja.tk.isCompleted)this.A9d=this.Ja.isFeatureEnabled(44)&&this.Ja.isFeatureEnabled(4);else return!1;else this.A9d=!1;return this.A9d}Hb(a){this.Z=a;this.Ja=a.sa("Box4.IFeatureHelper");this.JW=this.Z.resolve("Box4.Proofing.IProofingFeatureConfiguration");
this.JW.eEd=l.AFrameworkApplication.K.ea("WordProofingSecondaryContextualMenuIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",!1);(new sK).Hb(a);a.ha("Box4.IClipboardCommands",()=>new tK(l.AFrameworkApplication.pa,Mb.a.gle,Mb.a.BCb,Mb.a.hfa,Mb.a.FQe,Mb.a.paste,Mb.a.Jna,Mb.a.shc)).singleInstance();a.ha("HtmlImport.IHtmlNormalizerSettings",()=>{const d=a.resolve("Common.IAppSettingsManager");return new ey(!0,d.ea("SplitHyperlinkFixWithEnterIsEnabled"))}).singleInstance();
a.ha("HtmlImport.IHtmlTranslatorSettings",()=>{const d=a.resolve("Common.IAppSettingsManager"),n=z=>!z.EJc;return new GP.a(d.ea("ExternalPasteImprovementsEnabled"),d.ea("PasteComplexTablesIsEnabled"),d.ea("PasteTableCellMarginImprovementsIsEnabled"),d.ea("WordWacQoEListBulletsLevelExternalPasteImprovementIsEnabled"),!0,void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,d.ea("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,!0,z=>z.EJc,()=>!1,n,n,n,n,void 0,()=>this.Edm,z=>!z.EJc)}).singleInstance();
a.ha("WordEditor.Actors.WordEditorPasteStewardBridge",()=>new RL(a.resolve("Box4.IParagraphReader"),a.resolve("Box4.IBlobEditor"),a.resolve("Box4.Actors.IBox4PasteStewardUtils"),a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.resolve("Box4.IFeatureHelper"),a.resolve("Box4.ITabPresenterFactory"),a.resolve("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy"),a.resolve("Box4.ICharacterPropertiesEditor"),null,a.resolve("Wonca.ExternalContent.IExternalContentEditor"))).as("Box4.Actors.IBox4PasteStewardBridge").singleInstance();
a.ha("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",()=>new DL(a.resolve("Wonca.ExternalContent.IExternalContentEditor"),a.resolve("Box4.IFeatureHelper"))).as("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste").singleInstance();a.ha("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",()=>new uK).as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").singleInstance();a.ha("Box4.IIndentationCommands",()=>new vK(l.AFrameworkApplication.pa)).singleInstance();
a.ha("Box4.IJustificationCommands",()=>new wK(l.AFrameworkApplication.pa)).singleInstance();a.ha("Box4.ISpacingCommands",()=>new xK(l.AFrameworkApplication.pa)).singleInstance();a.ha("WordEditor.IPageCommands",()=>new zL(l.AFrameworkApplication.pa)).singleInstance();a.ha("WordEditor.Actors.StylesActor",()=>new ML(l.AFrameworkApplication.pa,a.vf("WordEditor.UI.IDialogFactory"))).singleInstance();a.ha("WordEditor.Actors.DigitalPrintActor",()=>new RG(l.AFrameworkApplication.pa,a.vf("WordEditor.UI.IDialogFactory"))).singleInstance();
a.ha("WordEditor.Actors.FileDownloadManager",()=>new iL(a.resolve("Common.App.DirectPrint.IDirectPrintManager"),new FP.a)).singleInstance();a.ha("WordEditor.Actors.FileDownloadActor",()=>new fL(l.AFrameworkApplication.pa,a.vf("WordEditor.UI.IDialogFactory"),a.resolve("WordEditor.Actors.FileDownloadManager"),l.AFrameworkApplication.K.ea("DisablePrint"),l.AFrameworkApplication.K.Ga("IrmPolicyDescription"),a.resolve("WordEditor.IBusinessBarController"))).singleInstance();a.ha("WordEditor.Actors.ParagraphDialogActor",
()=>new BL(l.AFrameworkApplication.pa,a.vf("Box4.UI.IBox4DialogFactory"),a.resolve("WordEditor.LineSpacingHelper"),jq.a.instance,a.resolve("Box4.IParagraphIndentationReader"),a.resolve("WordEditor.ClientPagination.IClientPaginationSettings"))).singleInstance();a.ha("WordEditor.Actors.MarginsDialogActor",()=>new xL(l.AFrameworkApplication.pa,a.vf("WordEditor.UI.IDialogFactory"),jq.a.instance)).singleInstance();a.ha("WordEditor.Actors.ModeSwitcherControlActor",()=>new XF.a(a.Ca("Common.ISystemInitiatedFeedback"),
bQ.a.Ptd())).as("WordEditor.IModeSwitcherControl").singleInstance();a.ha("WordEditor.Actors.PaperSizeDialogActor",()=>new AL(l.AFrameworkApplication.pa,a.vf("WordEditor.UI.IDialogFactory"),jq.a.instance)).singleInstance();a.ha("WordEditor.Actors.IgnoreAllProofingErrorStrategy",()=>new sL(a.resolve("Box4.Proofing.IIgnoreAllKeywords"))).singleInstance();a.register(dL,"WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy").singleInstance();a.ha("WordEditor.Actors.ProofingActor",()=>new EL(l.AFrameworkApplication.pa,
aj.a.instance,la.a.instance.resolve("Box4.ISelectionManager"),tp.a.instance,uf.a.instance,la.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),la.a.instance.resolve("Box4.ILanguageReader"),la.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),la.a.instance.resolve("WordEditor.Actors.IgnoreAllProofingErrorStrategy"),la.a.instance.resolve("WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy"),this.JW,la.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),
l.AFrameworkApplication.K.ea("WordEditorProofingIgnoreAll"),la.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EditorSettingV2IsEnabled",!1)?(l.AFrameworkApplication.K.ea("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("editorSettingsManager"):a.resolve("Common.IDynamicScriptLoaderProvider").uG.loadScript("EditorSettingsManager")).then(()=>{a.resolve("Box4.Proofing.IEditorSettingsManagerActor").h2l();
a.ha("Box4.Proofing.EditorSettingsUIActor",()=>new yK(l.AFrameworkApplication.pa,a.resolve("Box4.Proofing.ICritiqueTypeSettings"),a.resolve("Box4.Proofing.IEditorSettingsManagerActor"),()=>new zK(a.resolve("Box4.Proofing.IEditorSettingsManagerActor")))).singleInstance();l.AFrameworkApplication.K.ea("WritingStyleIsEnabled")&&l.AFrameworkApplication.K.ea("WordWritingStylesDialogIsEnabled")&&this.Z.resolve("Box4.Proofing.EditorSettingsUIActor").lb()}):(a.ha("Box4.Actors.GrammarSettingsActor",()=>new AK(l.AFrameworkApplication.pa,
a.resolve("Box4.Proofing.ICritiqueTypeSettings"),(d,n)=>new Zj(d,a.resolve("Box4.Proofing.IProofingConfigV2Manager"),n,ic.FocusManager.instance()),a.resolve("Box4.Proofing.IProofingConfigV2Manager"))).singleInstance(),l.AFrameworkApplication.K.ea("WritingStyleIsEnabled")&&l.AFrameworkApplication.K.ea("WordWritingStylesDialogIsEnabled")&&this.Z.resolve("Box4.Actors.GrammarSettingsActor").lb());a.ha("WordEditor.Actors.PageActor",()=>new yL(la.a.instance.resolve("Box4.IWordSectionEditor"),la.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).as("WordEditor.IPageCommandStringBuilder").singleInstance();
a.ha("WordEditor.Actors.DarkModeActor",()=>new aL(l.AFrameworkApplication.pa,l.AFrameworkApplication.K,Lb.App.rT,!!Lb.App.instance&&Lb.App.instance.eVa,!!Lb.App.instance&&Lb.App.instance.$Kc,!!Lb.App.instance&&Lb.App.instance.ol,la.a.instance.resolve("Box4.IDarkModeState"),la.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),la.a.instance.resolve("Box4.DarkModeEventsManager"),!!Lb.App.instance&&Lb.App.instance.Bsa)).singleInstance();a.ha("WordEditor.FlatListDetailsProvider",
()=>new kL(a.resolve("WordEditor.IFlatListEditor")));a.ha("WordEditor.Actors.AccessibilityActor",()=>new KK(a.Ca("Box4.Accessibility.IAccessibilityContextManager"),a.vf("WordEditor.FlatListDetailsProvider"),a.vf("WordEditor.TrackChange.TrackChangeCpDetailsProvider"),a.vf("WordEditor.TrackChange.TrackChangeStructuralDetailsProvider"))).singleInstance();a.ha("WordEditor.Actors.AppFrameCommandUIActor",()=>new WK(l.AFrameworkApplication.pa,a.Ca("Postmessage.IHostPostmessenger"))).singleInstance();a.ha("WordEditor.Actors.ImageActor",
()=>new Lr(a.resolve("WordEditor.IImageEditor"),a.Ca("Box4.IExternalSelectionManager"),a.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("WordEditor.Actors.ISWordRequestManager"),a.resolve("Box4.IUndoManager"),a.resolve("Box4.IFeatureHelper"),a.resolve("Box4.ISelectionManager"),a.resolve("Box4.IAppFrame"),l.AFrameworkApplication.K)).as("Box4.Actors.ImageActor").singleInstance();a.ha("WordEditor.Actors.WordFileSaveAsActor",
()=>new SL(l.AFrameworkApplication.pa)).singleInstance();a.ha("WordEditor.Actors.RenderedImageEditOperation.Factory",()=>new IL(a.resolve("WordEditor.IImageEditor"),l.AFrameworkApplication.K,l.AFrameworkApplication.la.tUa,la.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IUndoManager"),a.resolve("Box4.CatchUpActivity.IChangeIdEditor"),a.resolve("Box4.IFeatureHelper"))).singleInstance();this.Z.ha("WordEditor.Actors.SWordRequestManager",
()=>new OL(a.resolve("Box4.Images.IImageReader"),a.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),l.AFrameworkApplication.K)).as("WordEditor.Actors.ISWordRequestManager").singleInstance();a.ha("WordEditor.Actors.TableCellSelectionStrategy",()=>new PL).as("Box4.ITableCellSelectionStrategy").singleInstance();l.AFrameworkApplication.K.ea("WordEditorFormatPainterIsEnabled")&&a.ha("Box4.Actors.FormatPainter",()=>new BK(a.resolve("Box4.Styles.IWACStyleEditor"),a.resolve("Box4.IInsertionPointFormatting"),
a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.ICharacterPropertiesEditor"),aj.a.instance,a.resolve("Box4.IFeatureHelper"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TextFormattingHelper"),a.resolve("Box4.Styles.IWACStyleReader"))).as("Box4.IFormatPainter").singleInstance();
a.ha("Box4.Actors.FormatPainterActor",()=>new RB(Lb.App.oa,ic.FocusManager.instance(),l.AFrameworkApplication.pa,Ch.a.instance,Qs.a.instance,a.resolve("Box4.IFormatPainter"),a.resolve("Box4.ISelectionManager"),!0,a.resolve("Box4.ICssColorProvider"),!!Lb.App.instance&&Lb.App.instance.Bsa,a.resolve("Box4.DarkModeEventsManager"))).singleInstance();a.ha("WordEditor.Actors.FormattingActor",()=>new lL(l.AFrameworkApplication.pa,a.resolve("Box4.List.IListReader"))).singleInstance();a.ha("WordEditor.Actors.UIAutomationActor",
()=>new QL(l.AFrameworkApplication.pa)).singleInstance();a.ha("WordEditor.Actors.SaveStatusActor",()=>new KL(l.AFrameworkApplication.pa,a.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"))).singleInstance();a.ha("Box4.Actors.IEnterViewStrategy",()=>new CK(a.sa("Box4.IAutoCorrectScheduler"),a.vf("Box4.IUndoManager"),a.Ca("Box4.IExternalSelectionManager"))).singleInstance();a.ha("Box4.ISelectAllHandlers",()=>new eA(mi.PageReader.instance,a.vf("Box4.IUndoManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),
l.AFrameworkApplication.K.ea("QoETinyWinsSelectAllEnabled"))).singleInstance();a.ha("WordEditor.Actors.ContentControlActor",()=>new ZK(a.resolve("Box4.Actors.InternalClipboard"),a.resolve("WordEditor.ContentControl.IContentControlManager"),a.resolve("WordEditor.ContentControl.IGlossaryNavigator"),a.resolve("Box4.IFormattingEditor"),a.resolve("WordEditor.ContentControl.IContentControlChpManager"),a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.Styles.IWACStyleReader"),
l.AFrameworkApplication.pa,l.AFrameworkApplication.K.ea("WordEditorContentControlCustomizedPlaceholderIsEnabled"),uf.a.instance.J(10))).singleInstance();a.ha("WordEditor.Actors.AccessibilityHelpDialogActor",()=>new LK(l.AFrameworkApplication.pa,a.vf("WordEditor.UI.IDialogFactory"),ic.FocusManager.instance())).singleInstance();a.ha("Box4.Actors.FontNameFormattingStrategyNoop",()=>new DK).as("Box4.Actors.IFontNameFormattingStrategy").singleInstance();a.ha("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",
()=>new fF(l.AFrameworkApplication.Gd,jm.PageNavigator.instance,a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.IBlobReader"),a.resolve("WordEditor.IImageEditor"),la.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),l.AFrameworkApplication.K,a.resolve("Box4.IFeatureHelper"))).as("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager").singleInstance();a.ha("WordEditor.Actors.GraphicsEditorActor",
()=>new qL(l.AFrameworkApplication.pa,l.AFrameworkApplication.K,a.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),a.resolve("WordEditor.IImageEditor"),a.resolve("Box4.CatchUpActivity.IChangeIdEditor"),a.resolve("Box4.IUndoManager"),a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.IBlobReader"),a.resolve("Box4.Images.IImageReader"),l.AFrameworkApplication.Gd,this.Ja,a.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();
a.ha("WordEditor.Actors.RenderParagraphsContainingTabs",()=>new JL).singleInstance();a.ha("WordEditor.Actors.CustomTabActor",()=>new $K(l.AFrameworkApplication.pa,a.resolve("WordEditor.ICustomTabStopUtility"),a.resolve("Box4.IOutlineEditor"))).singleInstance();a.ha("WordEditor.Actors.HeadingsActor",()=>new VL(a.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),l.AFrameworkApplication.pa,a.resolve("Box4.IParagraphReader"))).singleInstance();a.ha("WordEditor.Actors.BookmarkActor",()=>
new YK(Lb.App.oa,l.AFrameworkApplication.pa,Lg.a.instance,a.resolve("WordEditor.Bookmark.FullBookmarkManager"),new Nf.a(()=>Lb.App.oa.za.jc),this.Z.resolve("Box4.Indicator.IIndicatorManager"),this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),this.Z.resolve("Common.IReactContextualUILauncher"),this.Z.resolve("WordEditor.Actors.BookmarkIndicatorActor"),tp.a.instance,this.Z.Ca("Common.ISystemInitiatedFeedback"),a.resolve("Box4.IOutlineElementNavigator"),Ic.InteractiveViewManager.instance,this.Z.vf("WordEditor.UI.IDialogFactory"),
this.Z.resolve("Box4.BookmarkParagraphMapping"))).singleInstance();a.ha("WordEditor.Actors.BookmarkIndicatorActor",()=>new ft(a.resolve("Box4.IParagraphReader"),Eg.a.instance,Ae.a.instance,this.Z.resolve("Box4.Highlight.IHighlightManager"),a.resolve("Box4.IInteractiveEventHandler"))).singleInstance();a.ha("Box4.Actors.IIFrameFocusStrategy",()=>new rL).singleInstance();a.ha("WordEditor.Actors.ExternalContentFloatiePositionProvider",()=>new UB(Lg.a.instance,a.resolve("Box4.ITextMetricsAdapter"),Ic.InteractiveViewManager.instance,
Ye.a.getElementBounds,a.resolve("Box4.UI.ExternalContentFloatieManager"))).singleInstance();a.ha("WordEditor.Actors.ExternalContentActor",()=>new js(l.AFrameworkApplication.pa,a.resolve("Box4.IUndoManager"),l.AFrameworkApplication.K,a.resolve("Wonca.ExternalContent.IExternalContentEditor"))).as("WordEditor.Actors.ExternalContentActor").singleInstance();a.ha("Box4.UI.ExternalContentFloatieManager",()=>new JK).as("Box4.UI.IFloatieManager").singleInstance();a.ha("WordEditor.Actors.ActionHangDetector",
()=>new MK(l.AFrameworkApplication.K,l.AFrameworkApplication.pa)).as("WordEditor.Actors.ActionHangDetector").singleInstance();a.ha("WordEditor.Actors.ExternalContentFloatieEventManager",()=>new TB(a.resolve("Box4.UI.ExternalContentFloatieManager"),a.resolve("Box4.IExternalContentFloatieEventSource"),Ic.InteractiveViewManager.instance,Gt.a.instance(),l.AFrameworkApplication.la,a.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),
Lb.App.jj.Cm.Oe(12),a.resolve("Box4.Graph.IGraphTransactionManager"))).singleInstance();a.ha("Box4.Actors.WordIndentationActorExtension",()=>new TL).as("Box4.Actors.IIndentationActorExtension").singleInstance();l.AFrameworkApplication.K.ea("SharedUXThemingIsEnabled")&&(l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordModernUxExperimentOneSettings"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&a.ha("WordEditor.Actors.ModernUxActor",
()=>new XG(l.AFrameworkApplication.pa)).singleInstance());l.AFrameworkApplication.K.ea("WordConsumptionViewToEditRedirectIsEnabled")&&a.ha("WordEditor.Actors.SwitchToClassicViewModeActor",()=>new sF(l.AFrameworkApplication.pa)).singleInstance();(new pK).Hb(a);a.ha("WordEditor.OnlineMedia.OnlineMediaDialogFactory",()=>new IK(a.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),a.resolve("Box4.Media.InsertMediaHelper"))).as("WordEditor.OnlineMedia.OnlineMediaDialogFactory").singleInstance();
a.ha("WordEditor.OnlineMedia.InsertHubbleMediaHelper",()=>new FK(l.AFrameworkApplication.pa,a.resolve("Box4.Media.InsertMediaHelper"))).singleInstance();a.ha("WordEditor.OnlineMedia.OnlineMediaActor",()=>new GK(l.AFrameworkApplication.pa,l.AFrameworkApplication.K,a.resolve("WordEditor.OnlineMedia.OnlineMediaDialogFactory"),a.resolve("WordEditor.OnlineMedia.InsertHubbleMediaHelper"),a.resolve("Wonca.ExternalContent.IExternalContentEditor"))).singleInstance();this.P3j=new UL;this.uea=this.Z.resolve("Box4.Highlight.IHighlightManager")}static main(){M.a.instance.Sb(new aH)}}
Object(t.a)(aH,"WordEditorActorsPackage",null,[1,2]);class XL{constructor(a){this.G4c=!1;this.yA=a;this.yA.Eyc(Object(m.a)(this,this.K9i,"onGraphFullyConnected"))}K9i(){this.G4c=!0;this.yA.eVg(Object(m.a)(this,this.K9i,"onGraphFullyConnected"))}}Object(t.a)(XL,"GraphFullyConnectedGetter",null,[564]);class Lf{constructor(){this.bEh=Object.assign(new hn.a,{})}tuk(a,d){let n;const z=a&1023;({value:n}=this.bEh.Ab(z,0)).returnValue||Lf.QTl().contains(z)||k.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",
a,z);n+=d;this.bEh.$(z,n);return n}static QTl(){Lf.rfe||(Lf.rfe=new ra.a,Lf.Bb(0),Lf.Bb(1),Lf.Bb(2),Lf.Bb(3),Lf.Bb(4),Lf.Bb(5),Lf.Bb(6),Lf.Bb(7),Lf.Bb(8),Lf.Bb(9),Lf.Bb(10),Lf.Bb(11),Lf.Bb(12),Lf.Bb(13),Lf.Bb(14),Lf.Bb(15),Lf.Bb(16),Lf.Bb(17),Lf.Bb(18),Lf.Bb(19),Lf.Bb(20),Lf.Bb(21),Lf.Bb(22),Lf.Bb(23),Lf.Bb(24),Lf.Bb(25),Lf.Bb(26),Lf.Bb(27),Lf.Bb(28),Lf.Bb(29),Lf.Bb(30),Lf.Bb(31),Lf.Bb(32),Lf.Bb(33),Lf.Bb(34),Lf.Bb(35),Lf.Bb(36),Lf.Bb(37),Lf.Bb(38),Lf.Bb(39),Lf.Bb(40),Lf.Bb(41),Lf.Bb(42),Lf.Bb(43),
Lf.Bb(44),Lf.Bb(45),Lf.Bb(46),Lf.Bb(47),Lf.Bb(48),Lf.Bb(49),Lf.Bb(50),Lf.Bb(51),Lf.Bb(52),Lf.Bb(53),Lf.Bb(54),Lf.Bb(55),Lf.Bb(56),Lf.Bb(57),Lf.Bb(58),Lf.Bb(59),Lf.Bb(60),Lf.Bb(61),Lf.Bb(62),Lf.Bb(63),Lf.Bb(64),Lf.Bb(65),Lf.Bb(66),Lf.Bb(67),Lf.Bb(68),Lf.Bb(69),Lf.Bb(70),Lf.Bb(71),Lf.Bb(72),Lf.Bb(73),Lf.Bb(74),Lf.Bb(75),Lf.Bb(76),Lf.Bb(77),Lf.Bb(78),Lf.Bb(79),Lf.Bb(80),Lf.Bb(81),Lf.Bb(82),Lf.Bb(83),Lf.Bb(84),Lf.Bb(85),Lf.Bb(86),Lf.Bb(87),Lf.Bb(88),Lf.Bb(89),Lf.Bb(90),Lf.Bb(91),Lf.Bb(92),Lf.Bb(93),Lf.Bb(94),
Lf.Bb(95),Lf.Bb(96),Lf.Bb(97),Lf.Bb(98),Lf.Bb(99),Lf.Bb(100),Lf.Bb(101),Lf.Bb(102),Lf.Bb(103),Lf.Bb(104),Lf.Bb(105),Lf.Bb(106),Lf.Bb(107),Lf.Bb(108),Lf.Bb(109),Lf.Bb(110),Lf.Bb(111),Lf.Bb(112),Lf.Bb(113),Lf.Bb(114),Lf.Bb(115),Lf.Bb(116),Lf.Bb(117),Lf.Bb(118),Lf.Bb(119),Lf.Bb(120),Lf.Bb(121),Lf.Bb(122),Lf.Bb(124),Lf.Bb(126),Lf.Bb(127),Lf.Bb(128),Lf.Bb(129),Lf.Bb(130),Lf.Bb(131),Lf.Bb(132),Lf.Bb(133),Lf.Bb(134),Lf.Bb(135),Lf.Bb(136),Lf.Bb(140),Lf.Bb(145),Lf.Bb(146),Lf.Bb(147));return Lf.rfe}static Bb(a){Lf.rfe.add(a&
1023)}}Lf.rfe=null;Object(t.a)(Lf,"LanguagePerParagraphModel",null,[]);class YL{constructor(){this.e5g=!1;this.vme=this.ume=this.ypc=0;this.AVi=!0;this.dTn=0}}Object(t.a)(YL,"UpdateWordCountStateResult",null,[]);class ZL extends Sys.EventArgs{constructor(a){super();this.isEnabled=a}}Object(t.a)(ZL,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class $L{constructor(){this.M5h=this.L5h=this.wordCount=-1;this.g7b=this.V1h=0;this.f7b=1;this.wdj=1033}}Object(t.a)($L,"WordCountCache",null,[]);
class aM extends Sys.EventArgs{constructor(a){super();this.state=a}}Object(t.a)(aM,"WordCountChangedEventArg",Sys.EventArgs,[]);class bM{constructor(){this.dWc=this.ARa=0}}Object(t.a)(bM,"CharsCountResult",null,[]);class cM{constructor(){this.cp=0;this.gWc=null;this.nfa=this.ofa=0}}Object(t.a)(cM,"TextChunkResult",null,[]);class dM{constructor(){this.dTj=this.ofa=this.nfa=this.wordCount=0}}Object(t.a)(dM,"WordCountStateForParagraph",null,[]);class bH{constructor(){this.tDa=this.rma=this.ofa=this.nfa=
this.s8=this.wordCount=0;this.currentNode=null;this.WC=-1;this.cp=0;this.xMg=[];this.f7b=this.g7b=this.rRa=this.tMg=this.uMg=0;this.LO=this.wRi=!1;this.LPb=new db.a;this.Dpb=new db.a}}Object(t.a)(bH,"WordCountState",null,[]);class Xp{constructor(a,d,n,z,O,ca){this.Tyn=1E3;this.ka=new oc.a;this.U1b=null;this.n8e=0;this.I9j="\ue000";this.m0c=!1;this.gcf=this.Xbf=this.f5d=0;this.Ish=this.Ssh=null;this.Sbf=this.Rbf=this.bcf=0;this.AG=d;this.j8j=new RegExp(Vi.AParagraphNode.Xjb,"g");this.Vb=a;this.taskManager=
z;this.Fq=n;this.Lgb=ca;this.zcb=O.ea("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.umk=O.ea("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.Cqj()}get Qhm(){return!!this.U1b}get CSa(){return this.m0c}set CSa(a){this.m0c=a}get Fhe(){return this.n8e}set Fhe(a){this.n8e=a}get o6a(){return!this.n8e}get UR(){return this.f5d}get f6b(){return this.Xbf}get k6b(){return this.gcf}get o6k(){return this.Ssh}get wTf(){return this.Ish}get CTf(){return this.bcf}get qTf(){return this.Rbf}get Upe(){return this.Sbf}Eyc(a){this.ka.addHandler(Xp.Q4e,
a)}eVg(a){this.ka.removeHandler(Xp.Q4e,a)}eDf(a){this.ka.addHandler(Xp.qhh,a)}u8m(a){this.ka.removeHandler(Xp.qhh,a)}Kqe(){this.Jqe();this.Cqj()}Cqj(){this.bcf=this.Sbf=this.Rbf=this.gcf=this.Xbf=this.f5d=-1}aVf(){this.R_e(this.Tyn)}R7g(){const a=new bH;a.wRi=!0;this.Jqe();this.OXf(a)}R_e(a,d=null){this.o6a&&(this.Qhm&&(d=null,this.Jqe()),d||(d=new bH),a=new bf.a(3,1,a,Object(m.a)(this,this.pcl,"doWordCountTask"),this.$Hj),a.customData=d,this.txk(a))}Jqe(){this.U1b&&(this.taskManager.ie(this.U1b),
this.U1b=null)}EQj(a,d,n,z,O,ca=!0,Da=-1,Xa=-1,zb=-1,Vb=1033){const Fc=new YL;Fc.ypc=n;Fc.ume=O;Fc.vme=z;if(!a.cp&&d.p1d&&ca&&!this.VCi(d))return Xp.cQn(a,d.p1d),Fc.AVi=!0,Fc;z=0<=Xa&&0<=zb?{vd:Xa,endCp:zb}:void 0;n=this.drl(d,z);z&&(Xa=z.vd,zb=z.endCp);n=0<=zb?n.substring(0,zb):n;zb=0<=Xa&&0<=zb?n.substring(Xa,zb):n;z=a.cp>=Xa?a.cp:Xa;O=a.xMg||[];ca=0<a.uMg?a.uMg:0;let Yc=0<a.tMg?a.tMg:0,yd=[];a.LO=!1;do{this.Lgb.update();if(!a.wRi&&(Fc.ypc+yd.length/2>Xp.zSn||this.Lgb.zJb())){let Ve;O=(Ve=O).concat.apply(Ve,
yd);a.cp=z;a.xMg=O;a.tMg=Yc;a.uMg=ca;a.WC=Da;a.currentNode=d;this.R_e(Xp.vTn,a);Fc.e5g=!0;a.LO=!0;return Fc}if((!z||z===Xa)&&0<n.length&&z<n.length){O.push(Hr.a.instance.cHc(n,z));var je=this.VCi(d);if(0<=Da&&!z&&je){a.wordCount+=1;Fc.ypc+=1;const Ve=this.Vb.QP(je);je=this.AG.jNc(Ve,je);je=Xp.Yoe(je);a.ofa+=je.ARa+1;a.nfa+=je.ARa-je.dWc}}je=this.GGi(n,z,Xp.xRk);z=je.cp;let Le;yd=(Le=yd).concat.apply(Le,je.gWc);ca+=je.ofa;Yc+=je.nfa}while(-1!==z);a=this.Qsk(a,O,yd,n,zb,Fc.ypc,Fc.ume,Fc.vme,d,-1===
Da,Vb);Fc.ypc=a.wordCount;Fc.ume=a.nfa;Fc.vme=a.ofa;Fc.dTn=a.dTj;return Fc}Lhi(a,d){const n=Bd.ParagraphReader.textLength(d,1);if(n){d=Lj.e(d);var z=0;for(let O=0;O<d.length;O++)if(this.QGb&&5===d[O].Qf&&a.rma++,Xp.Tqn(d[O])){z++;break}d.length!==n?a.s8++:a.s8+=z}}GAj(a){this.Fhe=this.lrn(a.rRa,a.wordCount)?1:0;return!!this.Fhe}Abj(a){this.f5d=a.wordCount;this.Xbf=a.rma;this.gcf=a.tDa;this.Sbf=a.ofa;this.Rbf=a.nfa;this.bcf=a.s8;this.Ssh=a.LPb;this.Ish=a.Dpb;this.rjj(a)}rjj(a){this.ka.raiseEvent(Xp.Q4e,
new aM(a))}qjj(){this.ka.raiseEvent(Xp.qhh,new ZL(!1))}lrn(a,d){if(I.a.Ah||I.a.xm||I.a.cB)return!1;(d/=2)||(d=1);return(d?a/d:0)>Xp.yum?!0:!1}get QGb(){const a=!this.Yyg||1===this.Yyg&&this.umk;return this.zcb&&a}pAi(a,d){let n=1033,z=0;a=d.H9f(a);d=new Lf;for(let O=0;O<a.length;O++){const ca=d.tuk(a[O].lcid,a[O].end-a[O].begin);z<ca&&(z=ca,n=a[O].lcid)}return n}pcl(a){this.U1b=null;this.OXf(a.customData)}Qsk(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc){var Yc;d=(Yc=d).concat.apply(Yc,n);n=Hr.a.instance.zAe(d,z);
a.wordCount+=n.wordCount;O=Xp.Yoe(O);Yc=O.ARa-O.dWc;const yd=O.ARa;a.nfa+=Yc;a.ofa+=yd;ca+=n.wordCount;Da+=O.ARa-O.dWc;Xa+=O.ARa;a.rRa+=n.rRa;let je,Le;({rdl:je,mFn:Le}=Xp.Psk(d,z,je,Le));a.g7b+=je;a.f7b+=Le;a.Dpb.add(Fc);a.LPb.add(n.wordCount);Vb&&Xp.ULk(yd,Yc,zb,n,je,Le,Fc);a.cp=0;a.xMg=[];a=new dM;a.nfa=Da;a.ofa=Xa;a.wordCount=ca;a.dTj=n.wordCount;return a}drl(a,d){let n=this.S9m(a);Lb.App.lDa&&(n=Bd.ParagraphReader.GHa(a,1,n,d));return this.o6m(n)}S9m(a){var d=Bd.ParagraphReader.text(a);a=Lj.e(a);
if(0<a.length){d=d.split("");for(let z=0;z<a.length;++z){let O=!0;var n=!0;const ca=a[z];if(1===ca.Qf)n=ca,n=22!==n.kind&&2!==n.kind;else if(5===ca.Qf)O=!1;else if(7===ca.Qf||10===ca.Qf)d[ca.Wa.cp]=this.I9j,O=!1;if(O){if(ca.Wa.cp>=d.length)return"";d[ca.Wa.cp]=n?" ":"C"}}d=d.join("")}return d}o6m(a){return a.replace(this.j8j,"")}GGi(a,d,n){const z=a.length-d<=n;var O=z?a.length:d+n;const ca=new cM;if(O<d)return ca.cp=-1,ca;ca.gWc=Hr.a.instance.jFc(a,d,O);O=Xp.Yoe(a.substr(d,O));ca.ofa=O.ARa;ca.nfa=
O.ARa-O.dWc;if(!ca.gWc.length&&!z)return n===a.length-d?ca:this.GGi(a,d,a.length-d);ca.cp=z||!ca.gWc.length?-1:ca.gWc[ca.gWc.length-1].cp;return ca}txk(a){this.U1b=a;this.taskManager.rb(this.U1b)}VCi(a){if(a=a.Faa){const d=this.Vb.QP(a);if(d&&d.Zr)return a}return null}static Tqn(a){return 11===a.Qf}static cQn(a,d){a.wordCount+=d.wordCount;a.nfa+=d.L5h;a.ofa+=d.M5h;a.rRa+=d.V1h;a.g7b+=d.g7b;a.f7b+=d.f7b;a.Dpb.add(d.wdj);a.LPb.add(d.wordCount)}static ULk(a,d,n,z,O,ca,Da){const Xa=new $L;Xa.wordCount=
z.wordCount;Xa.M5h=a;Xa.L5h=d;Xa.V1h=z.rRa;Xa.g7b=O;Xa.f7b=ca;Xa.wdj=Da;n.p1d=Xa}static Yoe(a){const d=a.length,n=new bM;for(let O=0;O<d;O++){var z=a.charCodeAt(O);n.ARa++;if(55296<=z&&56319>=z&&(z=O+1<d?a.charCodeAt(O+1):0,56320<=z&&57343>=z)){O++;continue}w.a.Fga(a.charAt(O))&&n.dWc++}return n}static Psk(a,d,n,z){n=z=0;for(let O=0;O<a.length;++O){const ca=a[O],Da=ca.jw;(3===Da||2===Da)&&ca.cp<d.length&&(++z,w.a.NIa(d.charCodeAt(ca.cp))&&++n)}return{rdl:n,mFn:z}}}Xp.Q4e="wctek";Xp.qhh="wcac";Xp.vTn=
1;Xp.xRk=400;Xp.zSn=90;Xp.yum=.1;Object(t.a)(Xp,"WordCountManagerBase",null,[574]);class eM extends Xp{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc){super(a,d,n,O,zb,Vb);this.wqi=this.Afe=this.Xwa=null;this.Da=z;this.Bc=Da;this.uPh=Xa;this.$M=Fc;this.Da.dE(Object(m.a)(this,this.Aca,"onProcessSetSelectionFinished"));this.ckf=zb.ea("ReadingTimeIsEnabled")}get $Hj(){return 66}d4l(){if(this.Xwa)return!0;if(!this.Da||!this.Da.ya)return this.Bc&&(Lb.App.SBd||l.AFrameworkApplication.mi?this.Bc.mb("SelectionWordCountSelectionNullWhenAppExiting",
{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):this.Bc.mb("SelectionWordCountSelectionNullWhenAppAlive")),!1;const a=this.Da.ya.clone();this.Xwa=a.zy(!0);if(!this.Xwa||!this.Xwa.Xx())return this.Jqe(),!1;this.uPh&&(this.Afe=this.uPh.create(d=>a.zy(d),this.Fq));this.Xwa.moveNext();return!0}get Yyg(){return 1}RXk(a){return a===Kb.a.Lc||a===Kb.a.paragraph?!0:this.QGb&&(a===Kb.a.dTa||a===Kb.a.image||a===Kb.a.anchoredObject)}OXf(a){this.Lgb.reset();if(this.d4l()){for(this.QGb&&this.Afe&&
(this.Afe.kcl(a,this.Lgb)||this.R_e(1,a));this.Xwa.current;){const z=-1===a.WC?0:a.WC;let O=0;var d=this.Xwa.current;if(!this.RXk(d.contextId)){this.Xwa.moveNext();continue}if(this.QGb&&Kd.ImageReader.EAa(d)){a.rma++;this.Xwa.moveNext();continue}if(!Bd.ParagraphReader.nb(d.node)){this.Xwa.moveNext();continue}const ca=d.node;if(this.CSa&&this.wqi&&this.wqi.MFc(ca))this.Xwa.moveNext();else{if(this.QGb&&d.Yb){var n=Dd.GraphIterator.ua(ca);for(n.Va(6);!n.Lj;)Kd.ImageReader.Xr(n.currentNode)&&a.rma++,
n.jh(6)}n=this.ckf?this.pAi(ca,this.$M):1033;d=this.EQj(a,ca,0,0,0,this.IFe(d),z,d.cpBegin,d.cpEnd,n);if(d.AVi&&(O+=1,100<O)){a.WC=z+1;this.R_e(1,a);return}if(d.e5g)return;this.Lhi(a,ca);this.Xwa.moveNext()}}this.Afe=this.Xwa=null;this.GAj(a)?(this.f5d=-1,this.qjj()):this.Abj(a)}}Aca(){this.aVf()}IFe(a){let d=!1;a.contextId===Kb.a.paragraph?d=!0:a.contextId===Kb.a.Lc&&(d=a.cpEnd-a.cpBegin===a.node.characterData.length);return d}}Object(t.a)(eM,"SelectionWordCountManager",Xp,[]);class tF{constructor(a,
d){this.Ftc=!1;this.H0b=null;a&&d&&(this.axc=a(!1),this.mc=d,this.axc.moveNext())}kcl(a,d){if(!a||!this.axc||!this.axc.current)return!0;do{const n=this.axc.current;if(n.contextId===Kb.a.tableRow||n.contextId===Kb.a.tableCell){for(this.H0b||this.l4l(n.node);this.H0b.moveNext();)if(14===this.H0b.currentNode.type&&a.tDa++,d.update(),d.zJb())return!1;this.BZk(n,a);this.H0b=null}this.axc.moveNext()}while(this.axc.current);return!0}BZk(a,d){const n=this.mc.Dg(a.node);n.La(14);a.contextId===Kb.a.tableRow&&
(km.a.uog(n)&&(this.Ftc=!0),km.a.jDd(n)&&this.Ftc&&(this.Ftc=!1,d.tDa++));a.contextId===Kb.a.tableCell&&(Sf.TableCellReader.CHb(n)&&(this.Ftc=!0),Sf.TableCellReader.UAa(n)&&this.Ftc&&(this.Ftc=!1,d.tDa++))}l4l(a){this.H0b=Yi.a.Ql(a);14===a.type?this.H0b.zj(tF.NEb,a):this.H0b.zj(tF.NEb,null)}static NEb(a){return a.parentNode?!0:!1}}Object(t.a)(tF,"TableCountSelectionTraverser",null,[573]);class fM{constructor(a){this.zcb=a.ea("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(a,d){return this.zcb?
new tF(a,d):null}}Object(t.a)(fM,"TableCountSelectionTraverserFactory",null,[563]);class gM extends Xp{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc){super(a,d,n,O,zb,Vb);this.ga=z;this.Hik=ca;this.Cqk=Da;this.ssh=Xa;this.$M=Fc;this.ga.Aa(Dc.a.bTj,Kb.a.application,Bc.ActionManager.Ke,64);this.ga.Aa(Dc.a.cTj,Kb.a.application,Bc.ActionManager.Ke,64);this.ckf=zb.ea("ReadingTimeIsEnabled")}get $Hj(){return 63}get Yyg(){return 0}OXf(a){this.Lgb.reset();a.LO=!1;var d=this.Hik();mi.PageReader.instance.aJa(d)||
(this.Kqe(),this.qjj());d=this.Fq.CTa(d,7,7).currentNode;var n=this.M1k(a.currentNode,d);d=this.Cqk(n,d);d.zj(Object(m.a)(this,this.BSn,"wordCountFilter"),null);let z=n=0;for(var O=0;d.moveNext();)if(d.currentNode&&this.Vb.o0(d.currentNode)){var ca=this.Vb.QP(d.currentNode);if(ca.Zr){var Da=this.Vb.Q4a(d.currentNode);if(Da&&(Da=Da.ja.last,Rj.App.lDa&&Da&&Da.Le&&Da.Ue))continue;a.wordCount+=1;if(ca=this.AG.jNc(ca,d.currentNode))ca=Xp.Yoe(ca),a.ofa+=ca.ARa+1,a.nfa+=ca.ARa-ca.dWc;n+=1;z+=a.ofa;O+=a.nfa}}else if(this.QGb&&
d.currentNode&&Kd.ImageReader.Xr(d.currentNode))a.rma++;else if(this.QGb&&d.currentNode&&If.TableReader.GS(d.currentNode))a.tDa++;else if(d.currentNode&&Bd.ParagraphReader.nb(d.currentNode)){ca=d.currentNode;Da=this.ckf?this.pAi(ca,this.$M):1033;O=this.EQj(a,ca,n,z,O,!0,-1,-1,-1,Da);if(O.e5g){a.LO=!0;l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorWordCountPackageImageAndTableCountSettings");return}this.Lhi(a,ca);n=O.ypc;z=O.vme;O=O.ume}this.GAj(a)?(this.Kqe(),this.z$m(),
this.rjj(a)):this.Abj(a)}M1k(a,d){a?(a=this.ssh(a),a.La(7)):a=this.ssh(d);return a}BSn(a){if(a.Lj)return!0;a=a.role;return 1===a||2===a||this.QGb&&6===a||3===a||4===a||5===a||!this.CSa&&(7===a||8===a)}z$m(){switch(this.Fhe){case 1:this.ga.processAction(Dc.a.bTj,2);break;case 2:this.ga.processAction(Dc.a.cTj,2)}}}Object(t.a)(gM,"TotalWordCountManager",Xp,[]);class hM{constructor(a,d,n,z,O,ca,Da,Xa,zb){this.tL=null;this.G2c=this.m0c=this.Ctc=this.Xkf=!1;this.xbf=Da;this.ybf=ca;this.yA=a;this.lka=d;
this.q0b=n;this.Gok=O;this.lka.eDf(Object(m.a)(this,this.qOc,"onWordCountAvailabilityChanged"));this.yA.eDf(Object(m.a)(this,this.qOc,"onWordCountAvailabilityChanged"));this.lka.Eyc(Object(m.a)(this,this.eCa,"onWordCountChanged"));this.yA.Eyc(Object(m.a)(this,this.eCa,"onWordCountChanged"));this.CSa=z;this.zcb=zb.ea("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get GUf(){return!I.a.v4}qOc(){this.S3e()}eCa(){this.S3e()}lb(){const a=l.AFrameworkApplication.pa;a.ma(Dc.a.O1e,Kb.a.application,
Object(m.a)(this,this.O1e,"toggleAccurateWordCountEnabled"));a.ma(Dc.a.oTc,Kb.a.view,Object(m.a)(this,this.oTc,"showWordCountDialog"));a.Aa(Dc.a.OOd,Kb.a.application,Object(m.a)(this,this.OOd,"queryWordCountFeatureStatus"),96);a.Aa(Dc.a.hSe,Kb.a.application,Object(m.a)(this,this.hSe,"queryAccurateWordCount"),96);a.Aa(Dc.a.vQg,Kb.a.application,Object(m.a)(this,this.vQg,"queryWordCountSplitButton"),96)}get CSa(){return this.m0c}set CSa(a){this.m0c=a;this.yA.CSa=a;this.lka.CSa=a}vQg(){return this.yA.o6a?
32:8}Mel(){this.yA.o6a&&(this.Qzj(!0),this.S3e(),this.yA.R7g())}Uyl(){return this.xbf("WACWordCountEnabled",this.GUf)}oXe(a){this.ybf("WACWordCountEnabled",a?"true":"false",Fa.a.FBa)}get ztg(){this.Ctc||(this.Xkf=this.Uyl(),this.Ctc=!0);return this.Xkf}Qzj(a){this.oXe(a);this.Xkf=a;this.Ctc=!0}ual(){this.yA.Kqe();this.lka.Kqe();this.Qzj(!1);this.S3e()}OOd(a,d,n,z,O){if(1===n)return this.yA.o6a?32:8;O[Yf.a.On]=this.ztg;return 32}O1e(a,d,n){if(1===n)return this.yA.o6a?32:8;this.ztg?this.ual():this.Mel();
Lb.App.oa.jF({ShowWordCount:"CheckboxModel"});return 32}oTc(a,d,n){if(1===n)return Lb.App.A4b(d)?8:this.yA.o6a?32:8;l.AFrameworkApplication.pa.processAction(Dc.a.sPe,2);return 32}get PH(){return this.tL||(this.tL=this.q0b())}S3e(){this.G2c||(k.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.q5k()),this.G2c=!0);this.PH&&this.PH.yV(this.Gok)}q5k(){const a={["words"]:this.yA.UR,["charsWithSpaces"]:this.yA.Upe,["charsWithNoSpaces"]:this.yA.qTf,["paragraphs"]:this.yA.CTf};this.zcb&&
(a.images=this.yA.f6b,a.tables=this.yA.k6b);return a}hSe(a,d,n,z,O){O||k.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===n)return 32;if(!this.yA.o6a)return O[rg.a.Visible]=!1,32;O[rg.a.Visible]=!0;this.ztg?(a=this.yA.UR,0>a?a=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:a?(d=this.lka?this.lka.UR:-1,a=0<d?this.cOl(a,d):String.format(1===a?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,
this.kWe(a))):a=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.kWe(a))):a=WordEditorIntl.WordEditorStrings.l_WordCountHidden;O[rg.a.LabelText]=a;return 32}kWe(a){try{return a.toLocaleString()}catch(d){k.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",d.toString(),d.stack))}return a.toString()}cOl(a,d){d>a&&(k.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),
d=a);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.kWe(d),this.kWe(a))}}Object(t.a)(hM,"WordCountActor",null,[]);class iM extends Rs.a{constructor(a,d,n,z){super();this.qea=a;this.yA=d;this.Bk=n;this.zcb=z.ea("WordEditorWordCountPackageImageAndTableCountIsEnabled")}jC(){var a=this.Bk.Oe(12);a.tq(Object(m.a)(this,this.jta,"onParagraphPropertyChanged"));a.Rt(Object(m.a)(this,this.L$i,"onParagraphConnectOrDisconnect"));a.vy(Object(m.a)(this,this.L$i,
"onParagraphConnectOrDisconnect"));a=this.Bk.Oe(22);a.tq(Object(m.a)(this,this.DHm,"onNumberListPropertyChanged"));a.Rt(Object(m.a)(this,this.INe,"onElementConnectedOrDisconnected"));a.vy(Object(m.a)(this,this.INe,"onElementConnectedOrDisconnected"));this.zcb&&this.K3m();this.qea.UCa(this,7)}K3m(){var a=[19,14];for(let d of a)a=this.Bk.Oe(d),a.Rt(Object(m.a)(this,this.INe,"onElementConnectedOrDisconnected")),a.vy(Object(m.a)(this,this.INe,"onElementConnectedOrDisconnected"))}get index(){return 1}run(){this.yA.aVf()}jta(a,
d){if(d.property===Vd.a.wk||d.property===Vd.a.qn)a=d.node,d=Rj.App.wn.za.Rb,d.mn&&d.xc&&d.xc.Ib&&a.Ib&&a.Ib.id===d.xc.Ib.id&&this.Xki(a)}L$i(a,d){this.Xki(d.node)}Xki(a){a.p1d=null;this.l8()}DHm(a,d){d.property!==Xc.a.Ju&&d.property!==Qb.a.fr||this.l8()}INe(){this.l8()}}Object(t.a)(iM,"WordCountAppEventCoordinator",Rs.a,[]);class cH{}cH.Rsk="AccurateWordCountButton";Object(t.a)(cH,"WordCountConstants",null,[]);class jM{constructor(a,d){this.yA=a;this.lka=d}getInstance(a){switch(a){case 1:return this.lka;
case 0:return this.yA;default:return this.yA}}}Object(t.a)(jM,"WordCountManagerFactory",null,[220]);class dH{constructor(){this.Z=null}get name(){return"WordEditor.WordCount"}Hb(a){this.Z=a;const d=this.Z.resolve("Common.IAppSettingsManager");this.Z.ha("WordEditor.WordCount.ITableCountSelectionTraverserFactory",()=>new fM(d)).singleInstance();this.Z.ha("WordEditor.WordCount.IWordCountManagerFactory",()=>{var n=new qm(10,Ye.a.me);const z=new gM(a.resolve("Box4.List.IListReader"),a.resolve("Box4.IListMarkerUtility"),
new so.a,l.AFrameworkApplication.pa,l.AFrameworkApplication.tb,()=>Rj.App.wn.za.Rb.xc,Yi.a.Yo,Dd.GraphIterator.ua,d,n,la.a.instance.resolve("Box4.ILanguageReader"));n=new eM(la.a.instance.resolve("Box4.List.IListReader"),la.a.instance.resolve("Box4.IListMarkerUtility"),new so.a,Lg.a.instance,l.AFrameworkApplication.tb,es.a.instance,Ch.a.instance,la.a.instance.resolve("WordEditor.WordCount.ITableCountSelectionTraverserFactory"),d,n,la.a.instance.resolve("Box4.ILanguageReader"));return new jM(z,n)}).singleInstance();
this.Z.ha("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new XL(this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0))).as("WordEditor.IGraphFullyConnectedGetter").singleInstance()}init(){const a=Lb.App.oa.za;a.IIa?this.Zta():a.mqa(()=>{this.Zta()})}Zta(){if(Lb.App.jj){var a=Lb.App.jj.Cm;if(a){this.Z.resolve("WordEditor.IGraphFullyConnectedGetter");var d=this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0),n=this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(1),
z=la.a.instance.resolve("Common.IAppSettingsManager");(new hM(d,n,()=>la.a.instance.sa("WordEditor.IStatusBarUser"),this.hyl(),cH.Rsk,Fa.a.UKa,Fa.a.SHa,la.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),z)).lb();(new iM(yq.GraphTransactionManager.instance,d,a,z)).jC();d.aVf()}else k.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else k.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}hyl(){var a=
Rj.App.wn.za;if(!a)return k.ULS.sendTraceTag(22611550,324,10,""),!1;a=a.Rb;if(!a)return k.ULS.sendTraceTag(22611552,324,10,""),!1;a=a.xc;return a?a.fa(Qb.a.CSa,!1):(k.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){M.a.instance.Sb(new dH)}}Object(t.a)(dH,"PackageManager",null,[1,2]);var cQ=b(1784);class kM{constructor(a){this.Itf=null;a.Ca("Common.App.SearchCommon.SearchHostRuntime").execute(d=>{this.Itf=d})}Lwj(a){this.Itf&&this.Itf.d9f().handleDocumentContentAugloopAnnotation(a)}}
Object(t.a)(kM,"DocumentContentExtractionManager",null,[429]);class bh{}bh.vxn="mso_smartLookup";bh.channelId="SmartLookup";bh.txn="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";bh.sxn="https://cdn.uci.edog.officeapps.live.com/mirrored/smartlookup/";bh.uxn="https://cdn.uci.officeapps.live.com/mirrored/smartlookup/";bh.wxn="https://uci.edog.cdn.office.net/mirrored/smartlookup/";bh.xxn="https://uci.cdn.office.net/mirrored/smartlookup/";bh.rxn="https://hedwigtestserver.blob.core.windows.net/builds/";
bh.qxn="http://localhost:8080/";bh.jWd="current";bh.ZDj="next";bh.$Nm=2;bh.HOc=1;bh.CKb=CommonUIStrings.L_SmartLookupPaneTitle;bh.nB="InsightsTaskPane";bh.e$g="InsightsTaskPaneData";bh.Uhg="InsightsContentFrame";bh.width=400;bh.Hwm="ApplicationPropertiesRequest";bh.Vwm="SelectionRequest";bh.Owm="PageRendered";bh.Gwm="ApplicationProperties";bh.Uwm="Selection";bh.Xwm="Telemetry";bh.Wwm="TakeFocus";bh.Nwm="LostFocus";bh.Kwm="Keyboard";bh.Lwm="LegalAgreed";bh.bTn="WordWac";bh.JLm="OneNoteWAC";bh.OLg=
"yes";bh.hIj="appCorrelationId";bh.HCn="clientCorrelationId";bh.iIj="message";bh.zXi="Microsoft::Office::Insights::LegalAgreed";Object(t.a)(bh,"InsightsConstants",null,[]);var aE=b(1432);class YC{}Object(t.a)(YC,"ActivityContractInfo",null,[]);class Us{}Object(t.a)(Us,"BrowserPaneDataField",null,[]);class ZC{}Object(t.a)(ZC,"BrowserPaneTelemetryEvent",null,[]);class jl{static aF(a,d){const n=new ZC;n.eventName="Diagnostics";n.isActivity=!1;n.activityContract=Object.assign(new YC,{success:!0});const z=
[],O=new Us;O.name="Message";O.dataType=0;O.value=a;a=new Us;a.name="Level";a.dataType=0;a.value=jl.getLevelString(d);Array.add(z,O);Array.add(z,a);n.dataFields=z;jl.sendTelemetryEvent(n)}static $uj(a,d){const n=new ZC;n.eventName=a;n.isActivity=!1;n.activityContract=Object.assign(new YC,{success:!0});a=[];const z=new Us;z.name="AppCorrelationId";z.dataType=0;z.value=d;Array.add(a,z);n.dataFields=a;jl.sendTelemetryEvent(n)}static dhn(a,d,n,z,O,ca){const Da=new ZC;Da.eventName="LaunchPaneWithError";
Da.isActivity=!1;Da.activityContract=Object.assign(new YC,{success:!0});const Xa=[],zb=new Us;zb.name="IsNetworkConnected";zb.dataType=0;zb.value=a?"true":"false";a=new Us;a.name="IsHostruntimeAvailable";a.dataType=0;a.value=d?"true":"false";d=new Us;d.name="EntryPoint";d.dataType=0;d.value=n;n=new Us;n.name="RuntimeVersion";n.dataType=0;n.value=z;z=new Us;z.name="IsFirstRelease";z.dataType=1;z.value=O?"true":"false";O=new Us;O.name="IsZeroTerm";O.dataType=1;O.value=ca?"true":"false";ca=new Us;ca.name=
"IsClientSideRendering";ca.dataType=1;ca.value="false";Array.add(Xa,zb);Array.add(Xa,d);Array.add(Xa,a);Array.add(Xa,n);Array.add(Xa,z);Array.add(Xa,O);Array.add(Xa,ca);Da.dataFields=Xa;jl.sendTelemetryEvent(Da)}static SZg(a,d,n){const z=new ZC;z.eventName="CDNDownloadLatency";z.isActivity=!0;z.activityContract=Object.assign(new YC,{duration:n,success:!0});n=[];const O=new Us;O.name="CDNHostname";O.dataType=0;O.value=a;a=new Us;a.name="Filename";a.dataType=0;a.value=d;Array.add(n,O);Array.add(n,a);
z.dataFields=n;jl.sendTelemetryEvent(z,1)}static URc(a,d,n,z,O,ca,Da,Xa){const zb=new ZC;zb.eventName="LaunchPane";zb.isActivity=!0;zb.activityContract=Object.assign(new YC,{duration:d,success:!0});d=[];const Vb=new Us;Vb.name="AppCorrelationId";Vb.dataType=0;Vb.value=a;a=new Us;a.name="EntryPoint";a.dataType=0;a.value=n;n=new Us;n.name="IsServerSideRendering";n.dataType=1;n.value="true";const Fc=new Us;Fc.name="UxVersion";Fc.dataType=0;Fc.value=z;z=new Us;z.name="FeatureGates";z.dataType=0;z.value=
O;O=new Us;O.name="IsFirstRelease";O.dataType=1;O.value=ca?"true":"false";ca=new Us;ca.name="IsZeroTerm";ca.dataType=1;ca.value=Da?"true":"false";Da=new Us;Da.name="IsClientSideRendering";Da.dataType=1;Da.value=Xa?"true":"false";Array.add(d,Vb);Array.add(d,a);Array.add(d,n);Array.add(d,Fc);Array.add(d,z);Array.add(d,O);Array.add(d,ca);Array.add(d,Da);zb.dataFields=d;jl.sendTelemetryEvent(zb)}static sendTelemetryEvent(a,d=2){if(a.isFeedbackActivity)jl.hnm(a.eventName);else{var n=-1<a.eventName.indexOf(jl.gIj)?
a.eventName:jl.gIj+a.eventName,z=jl.wxl(a.dataFields);a.isActivity?(a=Object.assign(new Yh.a,{name:n,samplingPolicy:d,dataFields:z,succeeded:a.activityContract.success,durationMs:a.activityContract.duration}),R.a.sendActivityEvent(a)):(a=Object.assign(new ha.a,{name:n,samplingPolicy:d,dataFields:z}),R.a.sendTelemetryEvent(a))}}static getLevelString(a){switch(a){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static wxl(a){const d=[];if(a&&0<a.length)for(const n of a)(a=Ze.a.v7(n.name,
n.value,jl.OYk(n.dataType)))&&Array.add(d,a);return d}static OYk(a){switch(a){case 0:return 2;case 1:return 1;case 2:return 3;case 3:return 4;default:return 0}}static hnm(a){const d=la.a.instance.sa("Common.ISystemInitiatedFeedback");d?d.logActivity(a,null):k.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}jl.gIj="Office.Insights.SmartLookup.";Object(t.a)(jl,"TelemetryUtils",null,[]);var $C;(function(a){a[a.other=0]="other";a[a.searchBoxSearch=1]="searchBoxSearch";
a[a.searchBoxDictionary=2]="searchBoxDictionary";a[a.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";a[a.smartLookupRibbon=4]="smartLookupRibbon";a[a.smartLookupContextMenu=5]="smartLookupContextMenu";a[a.entity=6]="entity";a[a.dictionary=7]="dictionary";a[a.web=8]="web";a[a.pictures=9]="pictures";a[a.files=10]="files";a[a.bookmarks=11]="bookmarks";a[a.help=12]="help";a[a.chartRecommendation=13]="chartRecommendation";a[a.linkSkill=14]="linkSkill";a[a.searchBoxFindInDocument=15]="searchBoxFindInDocument";
a[a.searchBoxEntity=16]="searchBoxEntity";a[a.searchSkill=17]="searchSkill";a[a.controlF=18]="controlF";a[a.ribbonFindButton=19]="ribbonFindButton";a[a.reuseSlides=20]="reuseSlides";a[a.data=21]="data";a[a.contextMenuDictionary=22]="contextMenuDictionary";a[a.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";a[a.contextMenuSynonyms=24]="contextMenuSynonyms";a[a.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";a[a.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";a[a.contextMenuSearchZeroTerm=
27]="contextMenuSearchZeroTerm";a[a.note=28]="note";a[a.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";a[a.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";a[a.dataDisambiguate=31]="dataDisambiguate";a[a.linkFiles=32]="linkFiles";a[a.searchBoxNoteL2=33]="searchBoxNoteL2";a[a.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";a[a.prefetch=99]="prefetch"})($C||($C={}));Object(t.b)("EntryPoint",$C);var Ot=b(1355),dw=b(1368);class Pt{static uga(a,d,n,z,O,ca){if(1===
n)return Yb.SessionStatusManager.instance.VN?32:8;if(O.value.rtn())return jl.aF("Skipping Serplet launch",10),32;d=ca;if(!d)return 8;a=Pt.M8b();if(n=d.CommandValueId)try{d=x.a(n)}catch(Da){return k.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",n),8}n=d;d.selection||(d.neighborhood?n=Object.assign(new Ot.a,{selection:d}):(d=O.value.YFc(),n.selection=Object.assign(new dw.a,{neighborhood:d.neighborhood,mentionStart:d.mentionStart,mentionLength:d.mentionLength})));
n.selection.clientDetectedLanguage=O.value.Tyi();return Pt.eEc(ca,null,n,a,0,O)}static eEc(a,d,n,z,O,ca){const Da={};Da.controlId=a?a.SourceControlId:"shortcut";n&&(Da.entryPoint=$C[n.entryPoint]);k.ULS.sendTraceTag(594044172,1303,50,Pt.O_("Show insights",z,Da));d?ca.value.ovn(d,z,O):n&&ca.value.pvn(n,z,O);return 32}static O_(a,d,n=null){a={["appCorrelationId"]:d,["message"]:a};if(n)for(let z in n)a[z]=n[z];return x.c(a)}static M8b(){return xa.a.create().toString()}}Object(t.a)(Pt,"InvokingPaneUtils",
null,[]);class lM{}Object(t.a)(lM,"LaunchDataInDoc",null,[]);var dv=b(1370);class eH{constructor(a,d,n,z,O,ca,Da,Xa,zb){this.p0c=this.P7d=this.Ty=null;this.yG=a;this.ga=d||l.AFrameworkApplication.pa;this.Bq=n;this.ib=z;this.pCh=Xa;this.D8c=O;this.va=ca;this.fb=Da;this.u3l();this.kcb=new Nf.a(()=>new Sd.a(zb.value,Object(m.a)(this,this.H9b,"getMoreInfoEventReceived")))}lb(){this.ga.ma(Sa.a.hOi,Cd.a.frame,Object(m.a)(this,this.mvn,"showInsights"));this.ga.ma(Sa.a.jOi,Cd.a.frame,Object(m.a)(this,this.nvn,
"showInsightsForTellMe"));this.ga.ma(Sa.a.definitions,Cd.a.frame,Object(m.a)(this,this.qun,"showDefinitions"));this.ga.ma(Sa.a.zqe,Cd.a.frame,Object(m.a)(this,this.tun,"showDefinitionsForTellMe"));this.ga.ma(Sa.a.FZe,Cd.a.frame,Object(m.a)(this,this.FZe,"showInsightsForSuggestion"));this.pCh&&(this.ga.ma(Sa.a.vma,Cd.a.frame,Object(m.a)(this,this.uga,"invokeSmartLookupPane")),this.ga.ma(Sa.a.gJc,Cd.a.frame,Object(m.a)(this,this.gJc,"invokeInDocSerplet")),this.ga.ma(Sa.a.jBd,Cd.a.frame,Object(m.a)(this,
this.jBd,"invokeSerpletRibbon")),this.ga.ma(Sa.a.hJc,Cd.a.frame,Object(m.a)(this,this.hJc,"invokeSerpletContextMenu")),this.ga.ma(Sa.a.CEe,Cd.a.frame,Object(m.a)(this,this.CEe,"invokeSerpletTellMeZeroTerm")),this.ga.ma(Sa.a.BEe,Cd.a.frame,Object(m.a)(this,this.BEe,"invokeSerpletTellMeNotes")),this.ga.ma(Sa.a.fBd,Cd.a.frame,Object(m.a)(this,this.fBd,"invokeImageSerpletContextMenu")),this.ga.ma(Sa.a.kBd,Cd.a.frame,Object(m.a)(this,this.kBd,"invokeSynonymsSerpletContextMenu")),this.ga.ma(Sa.a.eBd,Cd.a.frame,
Object(m.a)(this,this.eBd,"invokeDictionarySerpletContextMenu")),this.ga.ma(Sa.a.lBd,Cd.a.frame,Object(m.a)(this,this.lBd,"invokeZeroTermSerpletContextMenu")),this.ga.ma(Sa.a.iBd,Cd.a.frame,Object(m.a)(this,this.iBd,"invokeSerpletBrowseFiles")),this.ga.ma(Sa.a.gBd,Cd.a.frame,Object(m.a)(this,this.gBd,"invokeInDocSerpletWithLaunchData")),this.ga.ma(Sa.a.KOd,Cd.a.frame,Object(m.a)(this,this.KOd,"queryToggleSerplet")),this.ga.ma(Sa.a.RTd,Cd.a.frame,Object(m.a)(this,this.RTd,"setInDocSearchParameter")),
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.ga.ma(Sa.a.Jlg,Cd.a.frame,Object(m.a)(this,this.L7l,"invokeSmartLookupPaneConversations")),this.ga.ma(Sa.a.dBd,Cd.a.frame,Object(m.a)(this,this.dBd,"invokeAutoLaunchSearchRequest"))),this.K2m().continueWith(()=>{l.AFrameworkApplication.la&&l.AFrameworkApplication.la.updateCommandUI(!0)}))}lUh(){this.ga.Aa(Sa.a.HIa,Cd.a.frame,Object(m.a)(this,this.HIa,"invokeFilesSerplet"),4);this.ga.Aa(Sa.a.AEe,
Cd.a.frame,Object(m.a)(this,this.HIa,"invokeFilesSerplet"),4);this.ga.Aa(Sa.a.Hlg,Cd.a.frame,Object(m.a)(this,this.A7l,"invokeLinkFilesSerplet"),4);if(this.va.ea("IsTellMeUpSellEnterpriseEnabled")&&this.va.ea("SmartLookupTokenPrefetchIsEnabled")){const a=bf.a.Iya(1,0,Object(m.a)(this,this.Hfj,"prefetchToken"),0,177);this.fb.rb(a)}}gCf(){xh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.ga.ma(Sa.a.HIa,Cd.a.frame,
Object(m.a)(this,this.Glg,"invokeFilesSerpletUnavailable")),this.ga.ma(Sa.a.AEe,Cd.a.frame,Object(m.a)(this,this.Glg,"invokeFilesSerpletUnavailable")),this.ga.ma(Sa.a.Hlg,Cd.a.frame,Object(m.a)(this,this.Glg,"invokeFilesSerpletUnavailable")))}Hfj(a){k.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",a.interval,!!a.data);this.aVc().then(d=>{let n=1;if(d)k.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),this.m_g("SmartLookupFiles: Token prefetch succeeded",
!0),d=6E4*this.va.jb("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{k.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.m_g("SmartLookupFiles: Token prefetch failed",!1);n=parseInt(a.data||"1");if(n>this.va.jb("SmartLookupTokenRenewalRetryThreshold",5)){k.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.m_g("SmartLookupFiles: Token prefetch max retry count reached",!1);return}d=6E4*this.va.jb("SmartLookupTokenRetryWaitDurationInMinutes",
10);n++}d=new bf.a(3,1,d,Object(m.a)(this,this.Hfj,"prefetchToken"),177);d.data=n.toString();this.fb.rb(d)})}m_g(a="",d=!1){this.D8c.execute(n=>{n&&n.IMb("PrefetchToken",d,0,"SmartLookup",a)})}aVc(){return this.D8c?new Promise(a=>{this.D8c.execute(d=>{if(d){var n=Date.now();d.getToken("SmartLookup",this.va.Ga("SmartLookupShredderServiceEndpoint")).then(z=>{a(!!z&&0<z.length);d.IMb("TryGetTokenInternal",!!z&&0<z.length,Date.now()-n,"SmartLookup")})}else a(!1)})}):Promise.resolve(!1)}K2m(){const a=
new df.a;if(this.va.ea("BrowserSupportsInsightsPaneSSO"))this.lUh(),a.mf(!0);else{if(!this.D8c)return k.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),a.mf(!1),this.gCf(),a.task;this.D8c.execute(d=>{d?d.getToken("SmartLookup",this.va.Ga("SmartLookupShredderServiceEndpoint")).then(n=>{k.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!n&&0<n.length);n&&0<n.length?(this.lUh(),a.mf(!0)):this.gCf()}):(k.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),a.mf(!1),
this.gCf())})}return a.task}mvn(a,d,n,z,O){if(1===n)return l.AFrameworkApplication.la&&l.AFrameworkApplication.K.ea("OneNoteDelayLoadContextActivationManager")&&!l.AFrameworkApplication.ABc?8:this.yG.value.bSi()?32:8;a=Pt.M8b();d=this.yG.value.YFc();return this.pCh?(d=Object.assign(new dw.a,{neighborhood:d.neighborhood,mentionStart:d.mentionStart,mentionLength:d.mentionLength}),d=Object.assign(new Ot.a,{selection:d,userIntent:null,entryPoint:0,launchData:Object.assign(new dv.a,{landingTab:"All"})}),
Pt.eEc(O,null,d,a,0,this.yG)):Pt.eEc(O,d,null,a,0,this.yG)}qun(a,d,n,z,O){if(1===n)return this.yG.value.bSi()?32:8;a=Pt.M8b();d=this.yG.value.YFc();return Pt.eEc(O,d,null,a,1,this.yG)}nvn(a,d,n,z,O){return 1===n?32:this.dmi(O,0)}tun(a,d,n,z,O){return 1===n?32:this.dmi(O,1)}dmi(a,d){const n=Pt.M8b(),z=a.CommandValueId;let O;try{O=x.a(z)}catch(ca){return k.ULS.sendTraceTag(6295941,1303,15,Pt.O_(String.format("Insights parameters [{0}] is not in proper format.",z),n)),8}return Pt.eEc(a,O,null,n,d,this.yG)}FZe(a,
d,n,z,O){if(1===n)return 32;if(!O)return 8;a=O.query?O.query:"";d=Pt.M8b();n=new aE.a;n.neighborhood=a;n.mentionStart=0;n.mentionLength=a.length;return Pt.eEc(O,n,null,d,0,this.yG)}A7l(a,d,n,z){if(1===n)return Yb.SessionStatusManager.instance.VN?32:8;const O=l.AFrameworkApplication.K.ea("InsertFileLinkSerpletIsEnabled"),ca=this.yG.value.Mlb();return this.uga(a,d,n,z,Object.assign(new Ot.a,{selection:Object.assign(new dw.a,{neighborhood:ca.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new dv.a,
{landingTab:"File"}),entryPoint:O?32:10}))}HIa(a,d,n,z){if(1===n)return Yb.SessionStatusManager.instance.VN?32:8;const O=l.AFrameworkApplication.K.ea("InvokeReuseSlidesSerpletIsEnabled"),ca=this.yG.value.Mlb();return this.uga(a,d,n,z,Object.assign(new Ot.a,{selection:Object.assign(new dw.a,{neighborhood:ca.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new dv.a,{landingTab:O?"Slide":"File"}),entryPoint:O?20:10}))}Glg(){return 2}gJc(a,d,n,z,O){if(1===n)return Yb.SessionStatusManager.instance.oj?
8:32;const ca=this.yG.value.Mlb();O=void 0===O||null===O?18:19;return this.uga(a,d,n,z,Object.assign(new Ot.a,{selection:Object.assign(new dw.a,{neighborhood:ca.neighborhood,mentionStart:ca.mentionStart,mentionLength:ca.mentionLength}),launchData:Object.assign(new dv.a,{landingTab:"Indoc"}),entryPoint:O}))}gBd(a,d,n,z,O){O=O.CommandValueId;if(!O||O&&this.p0c&&O.query===this.p0c.query&&O.matchCase===this.p0c.matchCase&&O.matchWholeWordOnly===this.p0c.matchWholeWordOnly)return 32;const ca=this.yG.value.Mlb();
return this.uga(a,d,n,z,Object.assign(new Ot.a,{selection:Object.assign(new dw.a,{neighborhood:ca.neighborhood,mentionStart:ca.mentionStart,mentionLength:ca.mentionLength}),launchData:Object.assign(new dv.a,{landingTab:"Indoc",data:Object.assign(new lM,{type:4,query:O.query,matchCase:O.matchCase,matchWholeWord:O.matchWholeWordOnly})}),entryPoint:18}))}KOd(a,d,n,z,O){O&&(O[Yf.a.On]=this.yG.value.Dcc);return 32}RTd(a,d,n,z,O){if(a=O.CommandValueId)this.p0c=a;return 32}L7l(a,d,n){if(1===n)return Yb.SessionStatusManager.instance.VN?
32:8;a=this.yG.value.Mlb();a=Object.assign(new Ot.a,{selection:Object.assign(new dw.a,{neighborhood:a.neighborhood,mentionStart:a.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new dv.a,{landingTab:"All"})});this.yG.value.CIe(a);return 32}dBd(a,d,n){if(1===n)return Yb.SessionStatusManager.instance.VN?32:8;a=this.yG.value.Mlb();a=Object.assign(new Ot.a,{selection:Object.assign(new dw.a,{neighborhood:a.neighborhood,mentionStart:a.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new dv.a,
{landingTab:"All",data:l.AFrameworkApplication.J3a})});d=Pt.M8b();this.yG.value.Ikc(a,d);return 32}jBd(a,d,n,z){if(1===n)return Yb.SessionStatusManager.instance.VN?32:8;const O=this.yG.value.Vyi();return this.uga(a,d,n,z,Object.assign(new Ot.a,{selection:Object.assign(new dw.a,{neighborhood:O.neighborhood,mentionStart:O.mentionStart,mentionLength:O.mentionLength}),entryPoint:4,launchData:Object.assign(new dv.a,{landingTab:"All"})}))}hJc(a,d,n,z){return this.uga(a,d,n,z,Object.assign(new Ot.a,{entryPoint:5,
launchData:Object.assign(new dv.a,{landingTab:"All"})}))}CEe(a,d,n,z){if(1===n)return Yb.SessionStatusManager.instance.VN?32:8;const O=this.yG.value.Mlb();return this.uga(a,d,n,z,Object.assign(new Ot.a,{selection:Object.assign(new dw.a,{neighborhood:O.neighborhood,mentionStart:O.mentionStart,mentionLength:0}),launchData:Object.assign(new dv.a,{landingTab:"All"}),entryPoint:26}))}eBd(a,d,n,z){return 1===n?(a=this.yG.value.YFc())&&0<a.mentionLength?32:8:this.uga(a,d,n,z,Object.assign(new Ot.a,{entryPoint:22,
launchData:Object.assign(new dv.a,{landingTab:"All"})}))}fBd(a,d,n,z){return this.uga(a,d,n,z,Object.assign(new Ot.a,{launchData:Object.assign(new dv.a,{landingTab:"Image"}),entryPoint:9}))}kBd(a,d,n,z){return this.uga(a,d,n,z,Object.assign(new Ot.a,{launchData:Object.assign(new dv.a,{landingTab:"All"}),entryPoint:24}))}BEe(a,d,n,z){return this.uga(a,d,n,z,Object.assign(new Ot.a,{launchData:Object.assign(new dv.a,{landingTab:"Notes"}),entryPoint:33}))}lBd(a,d,n,z){if(1===n)return Yb.SessionStatusManager.instance.VN?
32:8;const O=this.yG.value.Mlb();return this.uga(a,d,n,z,Object.assign(new Ot.a,{selection:Object.assign(new dw.a,{neighborhood:O.neighborhood,mentionStart:O.mentionStart,mentionLength:0}),launchData:Object.assign(new dv.a,{landingTab:"All"}),entryPoint:27}))}uga(a,d,n,z,O){return Pt.uga(a,d,n,z,this.yG,O)}iBd(a,d,n){if(1===n)return 32;this.Ty||this.kcb.value.sk("Browse File from Search pane",!0);if(!this.P7d||""===this.P7d)return k.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),
8;Ye.a.Tk(this.P7d,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}H9b(a){this.Ty||3!==a.state||(this.Ty=a,this.P7d=this.Ty.Mna)}u3l(){const a=this.ib.Kc(bh.nB);a.parent=Ec.AFrame.hp;a.naa(Object(m.a)(this,this.TRc,"sendIFrameTakeFocusMessage"));this.Bq.CR(bh.nB)}TRc(){document.activeElement.blur();l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.b6a||(this.yG.value.Ckn(),this.yG.value.chn())}dispose(){this.yG.value&&this.yG.value.dispose()}}Object(t.a)(eH,"InsightsActor",null,[12]);
const fH=a=>{a=a.split("-");return a[a.length-1]},eQ=()=>{var a=uF();if(a)return Promise.resolve(a);a=bE().replace("SearchWeb","searchweb");a=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?a+bh.ZDj+"/":a+bh.jWd+"/";a+="version.json";if(I.a.Fy)return dQ(a);try{const d=new Sys.Net.WebRequest;d.set_httpVerb("GET");d.set_url(a);a={};a.method=d.get_httpVerb();return"function"!==typeof window.fetch?(jl.aF("InsightsUtils - Failed to download version.json because fetch API is unavailable.",
10),Promise.resolve("")):window.fetch(d.getResolvedUrl(),a).then(n=>n.json()).catch(()=>{jl.aF("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(n=>{n=x.b(JSON.stringify(n));return n.version?n.version:""},n=>{jl.aF("InsightsUtils - Failed to deserialize version: "+n.toString(),10);k.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+n.toString());return""}).then(n=>n)}catch(d){return jl.aF("InsightsUtils - Failed to download version.json: "+
d.toString(),10),k.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+d.toString()),Promise.resolve("")}},dQ=a=>{const d=l.AFrameworkApplication.Gd;return new Promise(n=>{const z=new rF.a(a,1,null,null,!0,2,null);d.send(z).Cta(O=>{O&&O.data?O.data.Rd||(jl.aF("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+O.data.Ge,10),n("")):(jl.aF("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",
10),n(""));try{const ca=x.b(O.data.Rd);ca.version&&n(ca.version)}catch(ca){jl.aF("InsightsUtils - Failed to deserialize version: "+ca.toString(),10),n("")}},O=>{O&&O.data?jl.aF("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+O.data.Ge,10):jl.aF("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);n("")})})},vF=()=>l.AFrameworkApplication.K.ea("SmartLookupEnableLocalOverride")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",
!1),wF=()=>{const a=bE();return vF()||l.AFrameworkApplication.K.Ga("SmartLookupPRClientVersion")?a+uF()+"/":l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?a+bh.ZDj:a+bh.jWd},uF=()=>vF()?"dev":l.AFrameworkApplication.K.Ga("SmartLookupPRClientVersion")?l.AFrameworkApplication.K.Ga("SmartLookupPRClientVersion").split("/")[1]:l.AFrameworkApplication.K.Ga("SmartLookupClientVersion"),gH=a=>{var d=3===l.AFrameworkApplication.la.eb.Bm?"wordwac":
2===l.AFrameworkApplication.la.eb.Bm?"pptwac":"excelwac";var n=Ih.a.yf(l.AFrameworkApplication.lcid);const z=n?n.name:"en-us";n=bE();const O=XB();d="main_ssr_wac.html?appName="+d+"&culture="+z;return"LOCAL"===O?n+d:n+((""!==a?a:bh.jWd)+"/")+d},fQ=a=>bE()+(""!==a?a:bh.jWd)+"/scripts/microsoft.office.smartlookup.host.runtime.js",bE=()=>{switch(XB()){case "LOCAL":return bh.qxn;case "PR":const a=l.AFrameworkApplication.K.Ga("SmartLookupPRClientVersion").split("/");return bh.rxn+a[0]+"/";case "INT":return bh.txn;
case "EDOG":return mM();default:return nM()}},gQ=()=>{if(!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(XB()){case "EDOG":return mM();case "PROD":return nM();default:return""}},mM=()=>l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletOfficeCDNEnabled",!1)?bh.wxn:bh.sxn,nM=()=>l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletOfficeCDNEnabled",
!1)?bh.xxn:bh.uxn,XB=()=>{if(l.AFrameworkApplication.K.ea("SmartLookupEnableEdogSourceLocationOverride")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(l.AFrameworkApplication.K.ea("SmartLookupEnableProdSourceLocationOverride")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(l.AFrameworkApplication.K.ea("SmartLookupEnableIntSourceLocationOverride")||
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(l.AFrameworkApplication.K.Ga("SmartLookupPRClientVersion")&&l.AFrameworkApplication.K.Ga("SmartLookupPRIntentSvc"))return"PR";if(vF())return"LOCAL";switch(Object(qa.a)(String,l.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",
!1)){let a=l.AFrameworkApplication.K.Ga("UserPrincipalName");a=w.a.He(a);const d=l.AFrameworkApplication.K.iz("SmartLookupINTEnabledForSKITeam")?l.AFrameworkApplication.K.kx("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(d,a))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},oM=()=>{let a;a=l.AFrameworkApplication.K.ea("IntentSvcEnableEdogSourceLocationOverride")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",
!1)?"EDOG":l.AFrameworkApplication.K.ea("IntentSvcEnableProdSourceLocationOverride")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":l.AFrameworkApplication.K.ea("IntentSvcEnableIntSourceLocationOverride")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":XB();const d=l.AFrameworkApplication.K.Ga("IntentServiceEndpoint"),n=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",
!1);if("PROD"===a&&""!==d)return d+"searchendpointv2/";switch(a){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return l.AFrameworkApplication.K.Ga("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(n?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(n?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+
"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}};class pM{sendTelemetryEvent(a){jl.sendTelemetryEvent(a)}}Object(t.a)(pM,"OtelTelemetrySink",null,[544]);class qM{}Object(t.a)(qM,"ApplicationProperties",null,[]);class rM{constructor(){this.filePath=this.docName=null}}Object(t.a)(rM,"CurrentDocumentProperties",null,[]);class sM{}Object(t.a)(sM,"EnterpriseUserInfo",null,[]);class tM{}Object(t.a)(tM,"FeatureGates",null,[]);class hH{constructor(a,
d){this.Cw=this.Gi=null;this.n2i=!0;this.I1b=d;this.Pw=a;this.Pw.execute(n=>{n.isFeatureEnabled("mso_sendASmile",!0).then(z=>{this.n2i=z}).catch(z=>{jl.aF("SearchHelper - Failed to check if Feedback feature is enabled: "+z.toString(),15)})});a=oM();d=l.AFrameworkApplication.K.ea("SmartLookupEnableInDocumentSearch")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(l.AFrameworkApplication.K.ea("SmartLookupFeatureGateV2")){this.Cw=
{};const n=this.kOl();if(n&&0<n.length)for(let z=0;z<n.length;z++){const O=n[z],ca=this.rOl(O);switch(ca.toLowerCase()){case "true":this.Cw[O]=!0;break;case "false":this.Cw[O]=!1;break;default:this.Cw[O]=ca}}this.Cw.EnableInDocumentSearch=d;this.Cw.EnableInDocumentSearchReplace=!0;this.Cw.EnableInDocumentParamLocalSearch=!0;this.Cw.EnableInDocumentQuerySuggest=d&&l.AFrameworkApplication.K.ea("SmartLookupEnableInDocumentQuerySuggest")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",
!1);this.Cw.EnableInDocumentQuestionGeneration=d&&l.AFrameworkApplication.K.ea("SmartLookupEnableInDocumentQuestionGeneration")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.Cw.EnableInDocumentGlobalEncoder=d&&l.AFrameworkApplication.K.ea("SmartLookupEnableInDocumentGlobalEncoder")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",!1);this.Cw.EnableInDocumentExperiment1=
d&&l.AFrameworkApplication.K.ea("SmartLookupEnableInDocumentExperiment1")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.Cw.EnableInDocumentExperiment2=d&&l.AFrameworkApplication.K.ea("SmartLookupEnableInDocumentExperiment2")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1);this.Cw.EnableInDocumentExperiment3=d&&l.AFrameworkApplication.K.ea("SmartLookupEnableInDocumentExperiment3")||
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.Cw.EnableZeroTermAutoRefresh=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.Cw.EnableTap3SZeroTerm=l.AFrameworkApplication.K.ea("SmartLookupEnableTap3SZeroTerm")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",!1);this.Cw.EnableLocalSearch=!0;
this.Cw.EnableInDocumentStickyFilters=!0;this.Cw.IntentServiceEndpoint=a;this.Cw.EnablePDFShredding=l.AFrameworkApplication.K.ea("SmartLookupEnableSharepointPDFIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.Cw.FilterNonPPTFilesForReuseSlides=l.AFrameworkApplication.K.ea("SmartLookupFilterNonPPTFilesForReuseSlides");this.Cw.UXBundleVersion=uF();this.Cw.SmartLookupServicePath=wF();this.Cw.EnableAcronymSearch=!0;this.Cw.UseAltAnswerEndpoint1=
l.AFrameworkApplication.K.ea("SmartLookupUseAltAnswerEndpoint1")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.Cw.UseAltAnswerEndpoint2=l.AFrameworkApplication.K.ea("SmartLookupUseAltAnswerEndpoint2")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.Cw.UseAltAnswerEndpoint3=l.AFrameworkApplication.K.ea("SmartLookupUseAltAnswerEndpoint3")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",
!1);this.Cw.UseNextUXVersion=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.Cw.IgnoreNeighborhoodContext=l.AFrameworkApplication.K.ea("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.Cw.ShowDebugInfo="INT"===XB();this.Cw.DebugCommands=l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands","");this.Cw.ChangeGates=l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",
"");this.Cw.QnaInMixSection=!0;this.Cw.EnableNoteSearch=l.AFrameworkApplication.K.ea("SmartLookupNoteSearchIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.Cw.EnableWikiL2=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.Cw.EnableFilteringOutRedundantKPE=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",
!1);this.Cw.EnableZeroTermEntitySuggestion=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.Cw.RankingModels=l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.Cw.EnableClientSideRendering=!0}else this.Gi=new tM,this.Gi.EnableInDocumentSearch=d,this.Gi.EnableInDocumentSearchReplace=!0,this.Gi.EnableInDocumentParamLocalSearch=!0,this.Gi.EnableInDocumentQuerySuggest=d&&
l.AFrameworkApplication.K.ea("SmartLookupEnableInDocumentQuerySuggest")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.Gi.EnableInDocumentQuestionGeneration=d&&l.AFrameworkApplication.K.ea("SmartLookupEnableInDocumentQuestionGeneration")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1),this.Gi.EnableInDocumentGlobalEncoder=d&&l.AFrameworkApplication.K.ea("SmartLookupEnableInDocumentGlobalEncoder")||
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",!1),this.Gi.EnableInDocumentExperiment1=d&&l.AFrameworkApplication.K.ea("SmartLookupEnableInDocumentExperiment1")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.Gi.EnableInDocumentExperiment2=d&&l.AFrameworkApplication.K.ea("SmartLookupEnableInDocumentExperiment2")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",
!1),this.Gi.EnableInDocumentExperiment3=d&&l.AFrameworkApplication.K.ea("SmartLookupEnableInDocumentExperiment3")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.Gi.EnableZeroTermAutoRefresh=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.Gi.EnableTap3SZeroTerm=l.AFrameworkApplication.K.ea("SmartLookupEnableTap3SZeroTerm")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.Gi.EnableLocalSearch=!0,this.Gi.EnableInDocumentStickyFilters=!0,this.Gi.IntentServiceEndpoint=a,this.Gi.EnablePDFShredding=l.AFrameworkApplication.K.ea("SmartLookupEnableSharepointPDFIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.Gi.FilterNonPPTFilesForReuseSlides=l.AFrameworkApplication.K.ea("SmartLookupFilterNonPPTFilesForReuseSlides"),this.Gi.UXBundleVersion=uF(),this.Gi.SmartLookupServicePath=wF(),
this.Gi.EnableAcronymSearch=!0,this.Gi.UseAltAnswerEndpoint1=l.AFrameworkApplication.K.ea("SmartLookupUseAltAnswerEndpoint1")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.Gi.UseAltAnswerEndpoint2=l.AFrameworkApplication.K.ea("SmartLookupUseAltAnswerEndpoint2")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.Gi.UseAltAnswerEndpoint3=l.AFrameworkApplication.K.ea("SmartLookupUseAltAnswerEndpoint3")||
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.Gi.UseNextUXVersion=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.Gi.IgnoreNeighborhoodContext=l.AFrameworkApplication.K.ea("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.Gi.ShowDebugInfo="INT"===XB(),this.Gi.DebugCommands=l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.Gi.ChangeGates=l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.Gi.QnaInMixSection=!0,this.Gi.EnableNoteSearch=l.AFrameworkApplication.K.ea("SmartLookupNoteSearchIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.Gi.EnableWikiL2=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.Gi.EnableFilteringOutRedundantKPE=
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.Gi.EnableZeroTermEntitySuggestion=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.Gi.RankingModels=l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.Gi.EnableClientSideRendering=!0,this.Gi.SharedSerpletFeatureGate1=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",
!1),this.Gi.SharedSerpletFeatureGate2=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.Gi.SharedSerpletFeatureGate3=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.Gi.SharedSerpletFeatureGate4=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.Gi.SharedSerpletFeatureGate5=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",
!1),this.Gi.SharedSerpletFeatureGate6=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.Gi.SharedSerpletFeatureGate7=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.Gi.SharedSerpletFeatureGate8=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.Gi.SharedSerpletFeatureGate9=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",
!1),this.Gi.SharedSerpletFeatureGate10=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.Gi.SharedSerpletFeatureGate11=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.Gi.SharedSerpletFeatureGate12=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.Gi.SharedSerpletFeatureGate13=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",
!1),this.Gi.SharedSerpletFeatureGate14=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.Gi.SharedSerpletFeatureGate15=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.Gi.SharedSerpletFeatureGate16=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.Gi.SharedSerpletFeatureGate17=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",
!1),this.Gi.SharedSerpletFeatureGate18=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.Gi.SharedSerpletFeatureGate19=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.Gi.SharedSerpletFeatureGate20=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.Gi.SharedSerpletFeatureGate21=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",
!1),this.Gi.SharedSerpletFeatureGate22=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.Gi.SharedSerpletFeatureGate23=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.Gi.SharedSerpletFeatureGate24=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.Gi.SharedSerpletFeatureGate25=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",
!1),this.Gi.SharedSerpletFeatureGate26=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.Gi.SharedSerpletFeatureGate27=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.Gi.SharedSerpletFeatureGate28=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.Gi.SharedSerpletFeatureGate29=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",
!1),this.Gi.SharedSerpletFeatureGate30=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.Gi.SharedSerpletFeatureGate31=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.Gi.SharedSerpletFeatureGate32=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.Gi.SharedSerpletFeatureGate33=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",
!1),this.Gi.SharedSerpletFeatureGate34=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.Gi.SharedSerpletFeatureGate35=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.Gi.SharedSerpletFeatureGate36=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.Gi.SharedSerpletFeatureGate37=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",
!1),this.Gi.SharedSerpletFeatureGate38=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.Gi.SharedSerpletFeatureGate39=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.Gi.SharedSerpletFeatureGate40=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.j7c=la.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");
this.w2i=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableOAuthManager",!1);this.aJb=hH.isEnterpriseUser();this.J6a=l.AFrameworkApplication.K.Ga("SmartLookupShredderServiceEndpoint");this.Fyg=Vc.a.JN(l.AFrameworkApplication.K.Ga("AppCatalogUrl")||"");this.Rsm=l.AFrameworkApplication.K.Ga("UserPrincipalName");this.aJb&&this.ZDi()}rOl(a){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline."+a,"")}kOl(){const a=
l.AFrameworkApplication.K.m4a,d=l.AFrameworkApplication.K.kx("SmartLookupFlightKeywordList"),n=[];if(a&&d&&0<d.length)for(let O in a){var z={key:O,value:a[O]};z=z&&z.key?z.key:"";for(let ca=0;ca<d.length;ca++)if(-1<z.toLowerCase().indexOf(d[ca].toLowerCase())){const Da=z.split(".");Da&&4===Da.length&&Array.add(n,Da[Da.length-1])}}return n}Ybg(a,d,n,z){return new Promise(O=>{this.Dfm().then(ca=>{const Da=new qM;Da.anid="";Da.applicationName=3===l.AFrameworkApplication.la.eb.Bm?"WORD":"POWERPNT";Da.applicationVersion=
l.AFrameworkApplication.buildVersion;Da.appCorrelationId=a?a:Pt.M8b();Da.themePlatform="web";Da.lcid=l.AFrameworkApplication.lcid;Da.launchUtcTime=(new Date).toUTCString();l.AFrameworkApplication.K.ea("SmartLookupFeatureGateV2")?Da.featureGates=x.c(this.Cw):Da.featureGates=x.c(this.Gi);var Xa=Ih.a.yf(l.AFrameworkApplication.lcid);Xa=Xa?Xa.name:null;Da.market=fH(Xa);Da.uiLanguage=Xa;Da.sessionId=l.AFrameworkApplication.userSessionId;Da.themeId=n;Da.parentalControl="yes";Da.processorOnlyMode=ca;Da.isEditingAllowed=
d.isEditingAllowed();Da.isFeedbackEnabled=this.n2i;Da.isClientSideRendering=18===z||19===z||15===z;Da.accessToken=this.aJb?this.ZDi():"";ca=new sM;ca.CountryCode=fH(Xa);ca.ServiceEndpoint=this.J6a;ca.IsGoLocal=l.AFrameworkApplication.K.ea("IsGoLocalEnvironment");ca.IsEnabled=this.aJb;ca.IsEnterpriseEnabled=this.aJb;ca.TenantRoot=this.Fyg;ca.Upn=this.Rsm;Da.enterpriseUserInfo=ca;ca=new rM;ca.filePath=l.AFrameworkApplication.K.Ga("EditDocInClientUrl");ca.docName=l.AFrameworkApplication.K.Ga("FileName");
Da.currentDocument=ca;O(Da)})})}Dfm(){return new Promise(a=>{this.Pw?this.Pw.execute(d=>{d.isFeatureEnabled(bh.vxn,!0).then(n=>{a(!n)}).catch(n=>{jl.aF("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+n.toString(),10);a(!0)})}):a(!0)})}mQm(a){this.j7c&&this.aJb&&this.PFi(this.J6a).then(d=>{a(d)})}ZDi(){return"Dev Box"===l.AFrameworkApplication.K.Ga("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?
window.SearchPaneShredderTokenOverride:this.j7c?this.j7c.pRl(this.J6a,this.w2i):""}PFi(a){return"Dev Box"===l.AFrameworkApplication.K.Ga("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?new Promise(d=>{d(window.SearchPaneShredderTokenOverride)}):this.j7c?this.j7c.getToken("SmartLookup",a,this.w2i):Promise.resolve("")}Awd(){return this.I1b?this.I1b.getVersion():""}Fzl(){return l.AFrameworkApplication.K.ea("SmartLookupFeatureGateV2")?
x.c(this.Cw):x.c(this.Gi)}static isEnterpriseUser(){const a=l.AFrameworkApplication.K.Ga("SovereignEnvironmentName"),d=l.AFrameworkApplication.K.ea("IsTellMeUpSellEnterpriseEnabled");return(!a||!a.length)&&d}}Object(t.a)(hH,"SearchHelper",null,[430]);class YB{constructor(){YB.na=""}getVersion(){return YB.na}wpn(a){YB.na=a}}YB.na=null;Object(t.a)(YB,"SmartLookupVersion",null,[]);class uM{}Object(t.a)(uM,"ConfigurationProvider",null,[]);class aD{constructor(a){aD.na=a}d9f(){return aD.na}}aD.na=null;
Object(t.a)(aD,"SearchHostRuntime",null,[]);class iH{constructor(){this.opa=this.fqc=this.Z=null}get name(){return"Common.App.Insights"}Hb(a){this.Z=a;const d=Ph.a.ot(la.a.instance.Ca("Common.IEventEmitter<Common.IGetMoreInfoResult>")),n=l.AFrameworkApplication.K.ea("SmartLookupEnableNativePane")||l.AFrameworkApplication.K.ea("SmartLookupIsEnabled");a.register(eH,"Common.App.Insights.InsightsActor").singleInstance().zd(()=>new eH(a.vf("Common.App.Insights.IInsightsManager"),l.AFrameworkApplication.pa,
lk.a.instance,ic.FocusManager.instance(),a.Ca("Common.App.SearchCommon.ISearchOAuthManager"),l.AFrameworkApplication.K,th.a.instance,n,new Nf.a(()=>d.result)));a.register(429,"Common.App.Insights.IDocumentContentExtractionManager").singleInstance().zd(()=>new kM(a));n&&(a.register(YB,"Common.App.Insights.SmartLookupVersion").singleInstance().zd(()=>new YB),a.register(430,"Common.App.SearchCommon.ISearchHelper").singleInstance().zd(()=>new hH(la.a.instance.Ca("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
a.sa("Common.App.Insights.SmartLookupVersion"))))}init(){l.AFrameworkApplication.hY&&(this.fqc=this.Z.sa("Common.App.Insights.InsightsActor"),this.fqc.lb())}Xcl(){this.N6l()}N6l(){eQ().then(a=>{if(""!==a){const d=this.Z.sa("Common.App.Insights.SmartLookupVersion");d&&d.wpn(a)}this.Xre();this.fqc=this.Z.resolve("Common.App.Insights.InsightsActor");a=fQ(a);a=Ta.a.create(a);a.QJ((d,n)=>{n.succeeded?this.eqn()&&this.prefetchZeroTerm():jl.aF("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+
n.Kp,10);this.fqc.lb()});ib.a.BP(a)})}eqn(){const a=Object.assign(new uM,{channelId:bh.channelId,approvedOriginPattern:vF()?"^(http)?://(localhost:8080)$":l.AFrameworkApplication.K.Ga("SmartLookupApprovedOriginPattern")});var d=this.Z.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const n=this.Z.resolve("Common.App.SearchCommon.ISerpletExecutor"),z=this.Z.resolve("Common.App.SearchCommon.IInsertContentExecutor"),O=new db.a;d&&O.add(d);n&&O.add(n);z&&O.add(z);d=oM();try{const ca=new pM,
Da=SmartLookupHostRuntime.setup(a,O.toArray(),!0,d,ca);this.Z.register(aD,"Common.App.SearchCommon.SearchHostRuntime").singleInstance().zd(()=>new aD(Da));return!0}catch(ca){return jl.aF("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+ca,10),!1}}prefetchZeroTerm(){if(l.AFrameworkApplication.K.ea("SmartLookupEnableInDocumentSearch")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var a=
la.a.instance.sa("Common.App.SearchCommon.SearchHostRuntime");if(a){const d=this.Z.resolve("Common.App.SearchCommon.ISearchHelper"),n=this.Z.resolve("Common.App.SearchCommon.IDocumentHelper");d.Ybg(null,n,0,99).then(z=>{a.d9f().prefetchZeroTerm(z,l.AFrameworkApplication.userSessionId,wF(),!0,"Indoc",null)})}else jl.aF("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}Xre(){var a=this.Z.resolve("Common.App.SearchCommon.ISearchHelper");const d=gH(a.Awd());
a=a.Awd();a=bE()+(""!==a?a:bh.jWd)+"/scripts/microsoft.office.smartlookup.ssr.js";const n=gQ();I.a.Fy?this.Wcl(d,a):(this.Ucl(d,n),this.Vcl(a,n))}Ucl(a,d){const n=new Sys.Net.WebRequest;n.set_httpVerb("GET");const z={};z.method=n.get_httpVerb();n.set_url(a);const O=(new Date).getTime();try{window.fetch(n.getResolvedUrl(),z).then(()=>{""!==d&&jl.SZg(d,a,(new Date).getTime()-O);this.Z.sa("Common.App.Insights.SmartLookupVersion")})}catch(ca){jl.aF("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+
ca.toString(),10)}}Vcl(a,d){var n=new Sys.Net.WebRequest;n.set_httpVerb("GET");const z={};z.method=n.get_httpVerb();n.set_url(a);let O=-1;if(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))n=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),th.a.instance.rb(new bf.a(5,1,n,()=>{const ca=Ta.a.create(a);ca.dgd(()=>{O=Date.now()});ca.QJ((Da,Xa)=>{Xa.succeeded?""!==d&&jl.SZg(d,a,Date.now()-
O):jl.aF("InsightsPackage - Failed to prefetch JS file.",10)});ib.a.BP(ca)}));else{O=Date.now();try{window.fetch(n.getResolvedUrl(),z).then(()=>{""!==d&&jl.SZg(d,a,Date.now()-O)})}catch(ca){jl.aF("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+ca.toString(),10)}}}Wcl(a,d){if(I.a.Fy){var n=l.AFrameworkApplication.Gd;a=new rF.a(a,1,null,null,!0,2,null);n.send(a).Cta(z=>{z&&z.data?z.data.Rd?this.Z.sa("Common.App.Insights.SmartLookupVersion"):jl.aF("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+
z.data.Ge,10):jl.aF("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},z=>{z&&z.data?jl.aF("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+z.data.Ge,10):jl.aF("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});l.AFrameworkApplication.K.ea("SmartLookupPrefetchJSIsEnabled")&&(d=new rF.a(d,1,null,null,!0,2,null),n.send(d).Cta(z=>{z&&z.data?z.data.Rd||jl.aF("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
z.data.Ge,10):jl.aF("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},z=>{z&&z.data?jl.aF("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+z.data.Ge,10):jl.aF("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.fqc&&this.fqc.dispose()}}Object(t.a)(iH,"InsightsPackage",null,[1,2]);var vM=b(1405);class wM{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(t.a)(wM,"DocumentContentParams",null,[]);var hQ=b(1672),hA;(function(a){a.Success="Success";a.wYj="Invoked";a.Error="Error";a.Timeout="Timeout";a.U_j="StaleAnnotation"})(hA||(hA={}));Object(t.b)("LogType",hA);class ZB{constructor(a,d){this.D_h=0;this.YQa=a;this.dii=d;l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1)&&this.YQa.Ea(this,ZB.auj)}logMessage(a){const d=[Object.assign(new ba.a,{name:"LogType",
string:a.logType}),Object.assign(new ba.a,{name:"CorrelationId",string:a.correlationId}),Object.assign(new ba.a,{name:"Message",string:a.message}),Object.assign(new ba.a,{name:"WorkflowExecutionTime",int64:a.workflowExecutionTime})];Object(we.a)("AugloopSearchProviderData",a.success,Date.now()-this.D_h,d)}kzl(a){return`Error: ${a}, Message: ${a.message}, Stack: ${a.stack}`}Qbi(a="",d="",n=""){return Object.assign(new wM,{documentContentKey:a,dataCenterEndpoint:d,documentContentTableName:n})}sS(a){if(a.annotationType===
ZB.auj&&(a=a.content,void 0!==this.correlationId))if(window.clearTimeout(this.Z$g),a&&a.docContentKey)if(this.Pdc===(null===a||void 0===a?void 0:a.correlationId))this.onError(hA.U_j,"Current annotation same as the last");else{this.Pdc=null===a||void 0===a?void 0:a.correlationId;var d=this.Qbi(a.docContentKey,a.dataCenterEndpoint,a.documentContentTableName);this.logMessage({logType:hA.Success,success:!0,correlationId:a.correlationId,message:"Workflow completed successfully",workflowExecutionTime:a.workflowExecutionTime});
this.correlationId=void 0;this.dii.Lwj(d)}else this.onError(hA.Error,"Augloop annotation is empty or incorrect")}submitDocumentContentExtractionSignal(){if(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1))try{this.correlationId=xa.a.create().toString();this.logMessage({logType:hA.wYj,success:!0,correlationId:this.correlationId,message:"Workflow invoked"});const a=XB().toLowerCase(),d=new Mj.l({parentPath:["Signal",ZB.Hfn],items:[{id:"SearchProvider",
body:new hQ.SearchProviderSignal({correlationId:this.correlationId,shouldUseIntEndpoint:"int"===a||"local"===a})}]});this.D_h=Date.now();augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:d});this.Z$g=window.setTimeout(()=>{this.onError(hA.Timeout,"Request timed out")},1500)}catch(a){this.onError(hA.Error,this.kzl(a))}}onError(a,d){this.correlationId&&(this.logMessage({logType:a,success:!1,correlationId:this.correlationId,message:d}),this.correlationId=void 0,this.Iil())}Iil(){this.dii.Lwj(this.Qbi())}}
ZB.auj="AugLoop_SearchProvider_SearchProviderAnnotation";ZB.Hfn="AugLoop_SearchProvider_SearchProviderSignal";Object(t.a)(ZB,"AugloopSearchProviderManager",null,[280]);class xF{constructor(){this.results=null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(t.a)(xF,"DocumentContentSearchResults",null,[]);class jH{getAllParagraphsInDocument(){return null}selectRange(){}search(){}searchV2(a,d){this.search(a,n=>{d(Object.assign(new xF,{results:n,totalResultCount:n.length,hasTooManyResults:100<
n.length}))})}searchWithParam(a,d){this.search(a.query,d)}searchWithParamV2(a,d){this.searchWithParam(a,n=>{d(Object.assign(new xF,{results:n,totalResultCount:n.length,hasTooManyResults:n.length>a.totalResultLimit}))})}highlight(){}highlightWithParam(a){this.highlight(a.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}getId(){return"DocumentContentExecutor"}}
Object(t.a)(jH,"BaseDocumentContentExecutor",null,[903,310]);class bB{static get Zum(){return 50}static Vye(a){if(""===a)return"";let d=0,n="";try{const z=zv.a.Mwe(a);for(const O of z.ops)if(bB.Yz(O))d||(n+=bB.iAl(O.attributes.atmention.fullName)),d+=1;else{const ca=O.insert?O.insert:"";" "!==ca&&0<ca.length&&(d=0,n+=ca)}}catch(z){k.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return n}static hvl(a){a=bB.Vye(a);return 0<
a.length&&a.split(" ").length<=bB.Zum?a:null}static iAl(a){let d="";a&&(a=a.split(" "),0<a.length&&(d=a[0]));return d}static Yz(a){return!!a.attributes&&!!a.attributes.atmention}}Object(t.a)(bB,"BaseCommentSmartReplyHelpers",null,[]);class cE extends bB{constructor(){super()}static U8b(a,d,n=!1){if(!a)return null;a=a.text&&0<a.text.length?a.text[0]:"";d=!d||!d.Lg||""===d.Lg;return 0<a.length&&d&&!n?bB.hvl(a):null}}Object(t.a)(cE,"CommentSmartReplyHelpers",bB,[]);var ew=b(1265);class yF{constructor(){this.query=
null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(t.a)(yF,"DocumentContentSearchParams",null,[]);class kH{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(t.a)(kH,"DocumentSelection",null,[]);var zF=b(627);class xM{constructor(){this.uue=this.T8h=0}}Object(t.a)(xM,"CommentFindResultIndexInfo",null,[]);const lH=(a,d)=>{var n=a.ya.Ba;if(!n||!n.length)return null;n=n.ra;d=d.Pc(n.node,
n.Gm);a.setSelection(d)};class yM extends jH{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd){super();this.va=Vb;this.D_b=null;this.dN=a;this.Ha=d;this.ic=n;this.Da=z;this.HG=O;this.sm=Xa;this.ib=zb;this.Bxa=ca;this.Jz=Da;this.Jh=Fc;this.Wbk=Yc;this.$Lh=E.a.create();this.YTe(Object(m.a)(this,this.jta,"onParagraphPropertyChanged"),Object(m.a)(this,this.ita,"onParagraphConnect"),Object(m.a)(this,this.gKb,"onParagraphDisconnect"));yd.execute(je=>{this.JMh=je})}get p5(){return!this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.NoCommentFocusOnFindSelection",
!1)}submitDocumentContentExtractionSignal(){this.JMh&&this.JMh.submitDocumentContentExtractionSignal()}getAllParagraphsInDocument(){var a=Object.assign(new zF.a,{EUa:!1,FUa:!1,GUa:!0});const d=this.Ha.I4a(this.dN.value,a);a=new db.a;for(var n of d)a.add(this.qag(n));for(let z of this.Jh.eba())n=cE.Vye(z.text[0]).split("\n"),n=1===n.length?n[0]:n.join(" "),a.add(n);return a.toArray()}selectRange(a,d,n,z,O){const ca=Date.now(),Da={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",
duration:0};try{this.iNb();if(0>a||0>d||0>n||0>z||a>n||a===n&&d>z)throw Error("Provided select range offsets incorrect");const je=Object.assign(new zF.a,{EUa:!1,FUa:!1,GUa:!0}),Le=this.Ha.I4a(this.dN.value,je);if(n>=Le.count){const Ve=la.a.instance.resolve("Common.Comments.ICommentModel").eba(),gg=n-Le.count;if(gg<Ve.length){O=-1;if(this.Bxa.LRa.Na(gg)){const Ki=this.Bxa.LRa.J(gg).yEc;for(var Xa=0;Xa<Ki.length;Xa++)if(Ki[Xa].begin===d){O=Xa;break}}this.D_b=-1!==O?Object.assign(new xM,{T8h:gg,uue:O}):
null;const Lh=Ve[gg];l.AFrameworkApplication.pa.processAction(Dc.a.e7,2);l.AFrameworkApplication.pa.ob(Dc.a.fra,2,null);l.AFrameworkApplication.pa.ob(Dc.a.selectComment,2,Object.assign(new ew.a,{commentId:Lh.id,doa:2,p5:this.p5}))}}else{this.D_b=null;var zb=Le.J(a),Vb=Le.J(n);if(!this.KVi(zb,d)||!this.KVi(Vb,z))throw Error("Provided select range offsets incorrect");l.AFrameworkApplication.pa.processAction(Dc.a.e7,2);this.OEn(zb);var Fc=this.HG.Pc(zb,d);Xa=this.HG.Mx(Fc,fe.a.Kb(Vb,z+1));if(O){const Ve=
Xa.toArray();d=[];for(const gg of Ve)d.push(this.qag(gg.node));d.join(" ").includes(O)||(Da.success=!1,Da.message="The text in clicked passage does not match the selected hit")}var Yc=this.sm.value.tw,yd=this.Da.ya.Ba;yd&&yd.equals(Xa)&&this.ic.Nha(Yc,null);this.ic.Nha(Yc,Xa);Da.duration=Date.now()-ca;this.logMessage(Da)}}catch(je){Da.success=!1,Da.message=je.stack,Da.duration=Date.now()-ca,this.logMessage(Da)}}search(a,d){this.iNb();this.Bxa.search(Object.assign(new yF,{query:a}),d)}searchV2(a,d){this.iNb();
this.Bxa.searchV2(Object.assign(new yF,{query:a}),d)}selectNextPrevHighlight(a){this.iNb();return this.Bxa.selectNextPrevHighlight(a)}searchWithParam(a,d){this.iNb();this.Bxa.search(a,d)}searchWithParamV2(a,d){this.iNb();this.Bxa.searchV2(a,d)}highlight(a){this.iNb();this.Bxa.highlight(Object.assign(new yF,{query:a}))}highlightWithParam(a){this.iNb();this.Bxa.highlight(a)}getRevision(){return this.$Lh.toString()}getSelectedText(){const a=this.Wbk.getSelectedText();return Object.assign(new dw.a,{neighborhood:a.neighborhood,
mentionStart:a.mentionStart,mentionLength:a.mentionLength})}getDocumentSelection(){var a=Object.assign(new zF.a,{EUa:!1,FUa:!1,GUa:!0});let d;var n=({V4:d}=this.$Nl(a)).returnValue;if(n)return n;var z=this.Da.ya.Ba;if(!z||!z.length)return null;n=z.ra;z=z.Fb;let O=-1,ca=-1;d=d||this.Ha.I4a(this.dN.value,a);for(a=0;a<d.count;a++)n.node.id===d.J(a).id&&(O=a),z.node.id===d.J(a).id&&(ca=a);return Object.assign(new kH,{startParagraphIndex:O,startParagraphOffset:n.Gm,endParagraphIndex:ca,endParagraphOffset:z.$w})}clearDocumentSelection(){lH(this.Da,
this.HG)}iNb(){this.ib&&(this.ib.Zd&&this.ib.Zd.name===bh.nB||this.ib.wf(bh.nB))}NOn(){this.$Lh=E.a.create()}qag(a){if(a.Ebc)return"";a=this.Ha.text(a);return Vi.AParagraphNode.V0(a," ")}KVi(a,d){a=this.qag(a);return d<a.length}J$b(a,d){switch(d){case 1:case 2:case 3:this.NOn()}}logMessage(a){const d=[Object.assign(new ba.a,{name:"Message",string:a.message})];Object(we.a)(a.activityName,a.success,a.duration,d)}g4g(a){return!a.Ebc&&this.IDd(a)}IDd(a){const d=this.dN.value;return!!d&&!!d.kd&&!!a.Ib&&
a.Ib.id.equals(d.kd.id)}OEn(a){this.Ha.ZJc(a)?32===l.AFrameworkApplication.pa.ob(Dc.a.mKb,2,new Mz.a(a))&&l.AFrameworkApplication.pa.processAction(Dc.a.d3f,2):l.AFrameworkApplication.pa.ob(Dc.a.fra,2,null)}jta(a,d){a=d.node;d=d.property;this.g4g(a)&&d===Vd.a.wk&&this.J$b(a,3)}ita(a,d){a=d.node;!d.jFe&&this.g4g(a)&&this.J$b(a,1)}gKb(a,d){a=d.node;this.g4g(a)&&this.J$b(a,2)}YTe(a,d,n){this.Jz&&(this.Jz.tq(a),this.Jz.Rt(d),this.Jz.vy(n))}$Nl(a){let d=null;var n=this.ib?this.ib.Zd.name:"";if(!this.Jh.Ou||
n!==Ec.AFrame.Zs&&n!==Ec.AFrame.IP)return{returnValue:null,V4:d};n=Array.indexOf(this.Jh.eba(),this.Jh.Ou);if(0>n)return{returnValue:null,V4:d};d=this.Ha.I4a(this.dN.value,a);var z=cE.Vye(this.Jh.Ou.text[0]).split("\n");a=0;z=(1===z.length?z[0]:z.join(" ")).length-1;this.D_b&&n===this.D_b.T8h&&this.Bxa.LRa.Na(n)&&this.Bxa.LRa.J(n).yEc.length>this.D_b.uue&&(a=this.Bxa.LRa.J(n).yEc[this.D_b.uue].begin,z=this.Bxa.LRa.J(n).yEc[this.D_b.uue].end);return{returnValue:Object.assign(new kH,{startParagraphIndex:d.count+
n,startParagraphOffset:a,endParagraphIndex:d.count+n,endParagraphOffset:z,subdocumentId:"Comment"}),V4:d}}}Object(t.a)(yM,"WordDocumentContentExecutor",jH,[]);class AF{isEditingAllowed(){return!0}}Object(t.a)(AF,"BaseDocumentHelper",null,[509]);class zM extends AF{constructor(){super()}isEditingAllowed(){return Lb.App.oa.za.isEditingAllowed}}Object(t.a)(zM,"WordDocumentHelper",AF,[]);class AM{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=
this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=0}}Object(t.a)(AM,"DocumentContentSearchResult",null,[]);var iQ=b(1637);class BM{constructor(){this.yEc=this.VNf=null}}Object(t.a)(BM,"CommentFindResults",null,[]);class CM{constructor(){this.end=this.begin=0}}Object(t.a)(CM,"FindResultOffset",null,[]);class DM{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc){this.BVk="Comment";this.C$e=this.Tq=this.Qef=this.ND=null;this.sQh=0;this.ow=null;this.tZc=new db.a;this.xrh=
null;this.dN=a;this.Ha=d;this.x_b=n;this.Lpa=O;this.Jsc=ca;this.C1c=Da;this.Jh=Xa;this.ga=zb;this.Da=Vb;this.HG=Fc}get LRa(){return this.xrh}initialize(){this.ND=kC.FindManager.createInstance(this,this.Lpa,mC.a.instance,!1,!0)}search(a,d){this.ND.Zhb();this.org(a)?(this.Tq=d,this.ow=new db.a,a=this.cSf(a),this.ND.find(a)):d(null)}searchV2(a,d){l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordCommentsInFindPaneSettings");this.ND.Zhb();if(this.org(a)){this.NRi()&&this.ga.ob(Sa.a.RTd,
2,{CommandValueId:a});this.C$e=d;this.sQh=a.totalResultLimit;this.ow=new db.a;a=this.cSf(a);this.xrh=new hn.a;this.ND.find(a);d=this.Lpa.RMd(a.text);d=this.Lpa.phc(d);a=this.Jsc.EGc(d.join("|"),a);d=this.Jh.eba();for(let O=0;O<d.length;O++){const ca=d[O];var n=cE.Vye(ca.text[0]).split("\n");n=1===n.length?n[0]:n.join(" ");var z=this.C1c.Lxd(n,a);if(z)for(let Da of z)z=iQ.a.createInstance(Da.begin,Da.end,E.a.qe(ca.objectId),O,32,!1),this.tZc.add(z),this.LRa.Na(O)||this.LRa.add(O,Object.assign(new BM,
{VNf:n,yEc:[]}));else k.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",!n,!a)}}else d(null)}get soi(){null==this.Qef&&(this.Qef=kC.FindManager.createInstance(this,this.Lpa,mC.a.instance));return this.Qef}NRi(){var a;return null===(a=l.AFrameworkApplication.K)||void 0===a?void 0:a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}highlight(a){var d=this.org(a);a=d?this.cSf(a):null;var n={};this.NRi()&&this.ga.ob(Dc.a.sQg,2,n);if(n[Yf.a.On]){if(d){d=
{};n={};var z={};this.ga.ob(Dc.a.sSe,2,d);this.ga.ob(Sa.a.cOd,2,n);this.ga.ob(Sa.a.dOd,2,z);if(a.text!=d.CommandValueId||a.matchCase!=n[Yf.a.On]||a.matchWholeWord!=z[Yf.a.On])lH(this.Da,this.HG),this.ga.ob(Sa.a.findInDocument,2,{CommandValueId:a.text,MatchCase:a.matchCase,MatchWholeWord:a.matchWholeWord})}}else n=this.soi,n.Zhb(),d&&n.find(a)}selectNextPrevHighlight(a){const d=this.soi;return 0<d.Yj.qua?(a?d.HAe():d.IAe(),d.Yj.rAf-1):-1}cSf(a){let d=Au.a.none;a.matchCase&&(d|=Au.a.matchCase);a.matchWholeWordOnly&&
(d|=Au.a.wholeWordOnly);return oD.a.createQuery(a.query,d)}org(a){return a&&!!a.query&&0<a.query.length}rYe(){}aXe(){}reset(){}X1f(){}rEc(){if(this.Tq){var a=this.Rbi(this.ow);this.Tq(a)}if(this.C$e){a=new xF;const d=this.ow.count+this.tZc.count>this.sQh;a.totalResultCount=this.ow.count+this.tZc.count;a.hasTooManyResults=d;d||(this.ow.$B(this.ow.count,this.tZc),a.results=this.Rbi(this.ow));this.C$e(a);this.tZc.clear()}}Rbi(a){const d=[];var n=Object.assign(new zF.a,{EUa:!1,FUa:!1,GUa:!0});n=this.Ha.I4a(this.dN.value,
n);for(let O of a){var z=O.begin;let ca=O.end,Da;a=-1;let Xa=null,zb=0;if(32===O.type){Xa=this.BVk;zb=3;a=n.count+O.JGb;const Vb=({begin:z,end:ca}=vM.a.Wmj(this.LRa.J(O.JGb).VNf,z,ca)).returnValue;Da=this.x_b.kSf(Vb,z,ca,lC.a(O.type));this.LRa.J(O.JGb).VNf=Vb;this.LRa.J(O.JGb).yEc.push(Object.assign(new CM,{begin:z,end:ca}))}else{for(z=0;z<n.count;z++)if(n.J(z).id===O.nc){a=z;break}Da=this.x_b.Gpe(O)}0<=a&&(a=Object.assign(new AM,{snippet:Da.yPf,subdocumentId:Xa,subdocumentType:zb,startOffsetInSnippet:Da.tXg,
endOffsetInSnippet:Da.qXg-1,paragraphIndex:a,startOffsetInParagraph:O.begin-Da.tXg,endOffsetInParagraph:O.end-Da.qXg-1}),d.push(a))}d.sort((O,ca)=>O.paragraphIndex===ca.paragraphIndex?O.startOffsetInParagraph-ca.startOffsetInParagraph:O.paragraphIndex-ca.paragraphIndex);return d}update(){}k4a(a,d){switch(a){case 0:d&&0<d.length&&!this.ow&&(k.ULS.sendTraceTag(570975814,313,15,"Results container list is null"),this.ow=new db.a);for(let n of d)this.ow.add(n)}}fNb(){}dispose(){}}Object(t.a)(DM,"WordDocumentSearchProcessor",
null,[278,12,427]);class EM{constructor(a){this.M1i=a}insertOnlinePicture(){}insertHtmlText(a){a&&this.ykg(a.htmlText)}getId(){return"InsertContentExecutor"}ykg(a){return this.executeCommand(Mb.a.fRa,a)}executeCommand(a,d){const n=new dh.DictionaryPropertySet;n.setValue(Xc.a.wV,d);n.setValue(Xc.a.IKa,!1);d=this.M1i.processAction(a,1);32===d&&(d=this.M1i.ob(a,2,n));return d}}Object(t.a)(EM,"WordInsertContentExecutor",null,[428,310]);class FM{constructor(a,d,n){this.k_c="undefined";this.yG=a;this.ga=
d||l.AFrameworkApplication.pa;this.va=n;this.sck=(this.uv=!!l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.T7)&&!!this.va&&this.va.ea("AutoOpenSearchPaneInDoublePortraitIsEnabled")}lb(){this.ga.Aa(Dc.a.e0h,Cd.a.frame,Object(m.a)(this,this.M7l,"invokeSmartLookupPaneWrapper"),1028);this.sck&&(this.k_c=Lb.App.oa.Di.getWindowMode(),this.Dki(this.k_c),Lb.App.oa.Di.registerBoundingWindowRectsChanged("SearchPane",(a,d)=>{d!==this.k_c&&(this.k_c=d,this.Dki(this.k_c))}))}Dki(a){"DP"===a&&xk.UISurfaces.Nv().then(d=>
{d.selectors.getTabbedTaskPaneCount()||this.ga.ob(Dc.a.e0h,2,{SourceControlId:"smartlookupAuto"});return null})}M7l(a,d,n,z,O){return Pt.uga(a,d,n,z,this.yG,O)}}Object(t.a)(FM,"WordInsightsActor",null,[]);class bD{constructor(){this.sW=null}Mlb(){return this.YFc()}Vyi(){return this.YFc()}Tyi(){return null}ovn(a,d,n){this.sW||(this.sW=this.tpe());this.sW.HV(a,d,n)}pvn(a,d,n){this.sW||(this.sW=this.tpe());this.sW.WCj(a,d,n)}Ikc(a,d){this.sW||(this.sW=this.tpe());this.sW.Ikc(a,d)}CIe(a){this.sW||(this.sW=
this.tpe());this.sW.CIe(a)}chn(){this.sW&&this.sW.TRc()}Ckn(){this.sW&&this.sW.rXe()}rtn(){var a=l.AFrameworkApplication.K.jb("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);a=window.performance.now()-bD.NWi<=a;a||(bD.NWi=window.performance.now());return a}dispose(){this.sW&&(this.sW.dispose(),this.sW=null)}get Dcc(){return this.sW?this.sW.isVisible:!1}}bD.NWi=0;Object(t.a)(bD,"InsightsManager",null,[938,12]);class dE{constructor(a,d,n,z,O,ca=!0,Da=null,Xa=null){this.Rda=this.fU=this.A0a=
null;this.E5c=!1;this.opa=null;this.ib=d;this.Utc=ca;this.guh=Xa?Xa:new AF;this.Pw=Da;this.Bq=a;this.Utc&&(la.a.instance.sa("Common.App.SearchCommon.SearchHostRuntime")&&(this.opa=la.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").d9f()),this.IAb=la.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.I1b=this.IAb.Awd())}Pqb(a){if(this.Utc){a=a.rawEvent;try{var d=x.a(a.data)}catch(n){k.ULS.sendTraceTag(595161728,1303,15,this.O_("Message data from Serplet [{0}] failed to deserialize.",
a.data));return}switch(d.actionType){case 101:a=0;this.fU&&(a=this.fU.entryPoint);this.IAb.Ybg(this.Rda,this.guh,this.gGb(),a).then(n=>{d.data=n;this.UKb(d)});break;case 118:d.data=this.fU?this.fU:Object.assign(new Ot.a,{selection:Object.assign(new dw.a,{neighborhood:this.A0a.neighborhood,mentionStart:this.A0a.mentionStart,mentionLength:this.A0a.mentionLength})});this.UKb(d);break;case 103:a=x.a(Object(qa.a)(String,d.data));jl.sendTelemetryEvent(a);break;case 206:this.IAb.PFi(d.data).then(n=>{d.data=
n;this.UKb(d)});break;case 112:d.data.shiftPressed?(I.a.Og&&document.activeElement.blur(),this.Bq.sHc(0,null,2,null,null),k.ULS.sendTraceTag(592545156,1303,50,this.O_("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.Bq.tGb(0,null,2,null,null),k.ULS.sendTraceTag(592545155,1303,50,this.O_("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.jAa()}}}LSd(a){if(this.opa){var d=0;this.fU&&(d=this.fU.entryPoint);this.IAb.Ybg(this.Rda,this.guh,this.gGb(),d).then(n=>{jl.$uj("SearchFromHost",
this.Rda);this.fU.launchData||(this.fU.launchData=new dv.a);const z=wF();try{this.opa.search(this.fU,n,l.AFrameworkApplication.userSessionId,z,a),this.IAb.mQm(O=>{jl.$uj("SearchFromHostWithToken",this.Rda);this.opa.searchAuthenticatedProviders(this.fU,n,l.AFrameworkApplication.userSessionId,z,null,O)})}catch(O){jl.aF("BaseSmartLookupPane - Fail to search from host. Error: "+O,10)}}).catch(n=>{jl.aF("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+n.toString(),10)})}}URc(a){if(this.Utc){var d=
jl,n=d.URc,z=this.Rda;a=Math.round(window.performance.now()-a);var O=this.fU?$C[this.fU.entryPoint]:"",ca=this.IAb.Awd(),Da=this.IAb.Fzl(),Xa=this.fU?this.fU.entryPoint:0;n.call(d,z,a,O,ca,Da,l.AFrameworkApplication.wgd,this.E5c,18===Xa||19===Xa||15===Xa)}}}Object(t.a)(dE,"BaseSmartLookupPane",null,[490,12]);class eE{constructor(a){this.messageType=null;this.messageType=a}}Object(t.a)(eE,"InsightsMessage",null,[]);class fE extends eE{constructor(a,d){super(a);this.messageContent=null;this.messageContent=
d}}Object(t.a)(fE,"InsightsMessageWithContent",eE,[]);class GM extends fE{constructor(a){super(bh.Gwm,a)}}Object(t.a)(GM,"InsightsMessageAppProperties",fE,[]);class HM extends fE{constructor(a){super(bh.Uwm,a)}}Object(t.a)(HM,"InsightsMessageSelection",fE,[]);class IM extends eE{constructor(){super(bh.Wwm)}}Object(t.a)(IM,"InsightsMessageTakeFocus",eE,[]);class gE extends dE{constructor(a,d,n,z,O=null,ca=null,Da=null,Xa=!0,zb=null,Vb=null){super(d,n,O,ca,Da,Xa,zb,Vb);this.S3d=this.QD=this.hh=null;
this.wbe=!1;this.F8d=a;this.r3c=this.Utc?gH(this.I1b):l.AFrameworkApplication.jEe;this.K6();this.pTg();this.jk=z;this.hth=0}get isVisible(){return!1}K6(){this.hh=this.F8d.ynd();l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.b6a&&this.hh.T3m(a=>{a===this.hh&&(this.rXe(),this.TRc())});this.Rjg(this.hh.t9a.P0h);this.hh.Km()}Rjg(a){a.style.overflow="hidden";const d=Ne.a.createElement("iframe");Sys.UI.DomElement.addCssClass(d,"InsightsPaneIFrame");d.setAttribute("Unselectable","off");this.QD=
d;a.appendChild(this.QD);this.QD.id=bh.Uhg}pTg(){Qc.a.addHandler(this.QD,"load",Object(m.a)(this,this.ONc,"onIFrameLoad"));Qc.a.addHandler(this.QD,"error",Object(m.a)(this,this.bKb,"onIFrameError"));$addHandler(window,"message",Object(m.a)(this,this.Pqb,"onIFrameMessage"))}Nch(){Qc.a.removeHandler(this.QD,"load",Object(m.a)(this,this.ONc,"onIFrameLoad"));Qc.a.removeHandler(this.QD,"error",Object(m.a)(this,this.bKb,"onIFrameError"));$removeHandler(window,"message",Object(m.a)(this,this.Pqb,"onIFrameMessage"))}dispose(){this.QD&&
(this.Nch(),this.QD.parentNode.removeChild(this.QD),this.QD=null);this.hh&&(this.F8d.Q6b(this.hh),this.hh=null)}HV(a,d,n){this.Rda=d;this.S3d=null;this.hth=n;this.E5c=!a.mentionLength;this.wbe=!1;k.ULS.sendTraceTag(6295947,1303,50,this.O_("Start to show Insights"));this.A0a=a;this.r3c&&this.r3c.length?this.QD.src=this.r3c:(this.QD.src=gE.j7i,k.ULS.sendTraceTag(6295948,1303,15,this.O_("The Insights URL config setting is null or empty")));this.jk.sendNotification(CommonUIStrings.l_InsightsPaneNotification,
!0);this.hh.dca||this.hh.uTg(Object(m.a)(this,this.wGm,"onInsightsTaskPaneHidden"));this.Utc&&this.LSd(!1);a=window.performance.now();this.F8d.showTaskPane(this.hh);this.hh.Km();this.URc(a)}WCj(a,d,n){this.fU=a;this.HV(Object.assign(new aE.a,{neighborhood:a.selection.neighborhood,mentionStart:a.selection.mentionStart,mentionLength:a.selection.mentionLength}),d,n)}Ikc(){}CIe(){}TRc(){this.QD.src===this.r3c&&this.wbe&&(this.ib.wf(bh.nB),this.UKb(new IM))}rXe(){this.QD&&ic.FocusManager.iJ(this.QD.contentWindow)}tUf(){this.QD.src=
gE.j7i;this.hh.Cn()}jAa(){this.F8d.hideTaskPane(this.hh);this.tUf()}wGm(a){a===this.hh&&this.jAa()}ONc(){k.ULS.sendTraceTag(6295951,1303,50,this.O_("The iframe is successfully loaded in Insights task pane"))}bKb(){k.ULS.sendTraceTag(6295952,1303,15,this.O_("The iframe failed to load in Insights task pane"))}Pqb(a){const d=a.rawEvent;if(d.source===this.QD.contentWindow)if(this.Utc)super.Pqb(a);else{let n;try{n=x.a(d.data)}catch(z){k.ULS.sendTraceTag(6295953,1303,15,this.O_("Message data [{0}] failed to deserialize.",
d.data));return}if(ze.c(n.messageType))k.ULS.sendTraceTag(6295954,1303,15,this.O_("Message data [{0}] is in wrong format.",d.data));else switch(n.messageType){case bh.Hwm:this.UKb(new GM(this.qDl()));break;case bh.Vwm:this.UKb(new HM(this.A0a));break;case bh.Owm:this.wbe=!0;this.rXe();this.TRc();k.ULS.sendTraceTag(6295955,1303,50,this.O_("Insights pane rendering is completed"));break;case bh.Xwm:a=n.messageContent;this.S3d=a.clientCorrelationId;this.Rda!==a.appCorrelationId&&k.ULS.sendTraceTag(6403778,
1303,15,this.O_("App correlation ID on client {0} does not match one on server {1}",this.Rda,a.appCorrelationId));break;case bh.Nwm:n.messageContent?(I.a.Og&&document.activeElement.blur(),this.Bq.sHc(0,null,2,null,null),k.ULS.sendTraceTag(6604741,1303,50,this.O_("Insights UX lost focus through Ctrl + Shift + F6"))):(this.Bq.tGb(0,null,2,null,null),k.ULS.sendTraceTag(6604742,1303,50,this.O_("Insights UX lost focus through Ctrl + F6")));break;case bh.Kwm:n.messageContent.keyCode===xb.a.Cua&&this.jAa();
break;case bh.Lwm:try{this.wbe=!1,localStorage.setItem(bh.zXi,"true")}catch(z){k.ULS.sendTraceTag(17961859,1303,10,this.O_("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}qDl(){const a={anid:"00000000-0000-0000-0000-000000000000"};a.appCorrelationId=this.Rda;3===l.AFrameworkApplication.la.eb.Bm?a.applicationName=bh.bTn:4===l.AFrameworkApplication.la.eb.Bm&&(a.applicationName=bh.JLm);a.applicationVersion=l.AFrameworkApplication.buildVersion;var d=Ih.a.yf(l.AFrameworkApplication.lcid);d=d?
d.name:null;a.market=fH(d);a.uiLanguage=d;a.sessionId=l.AFrameworkApplication.userSessionId;a.parentalControl=bh.OLg;a.clientType="user";a.legalAgreed=this.pEl();a.defaultDefineTab=1===this.hth?"true":null;return a}O_(a,...d){const n={};this.Rda&&(n[bh.hIj]=this.Rda);this.S3d&&(n[bh.HCn]=this.S3d);n[bh.iIj]=String.format.apply(null,[a].concat(d));return x.c(n)}gGb(){return 5}pEl(){try{const a=localStorage.getItem(bh.zXi);return!!a&&"true"===a}catch(a){return k.ULS.sendTraceTag(17961860,1303,10,this.O_("Failed to GetItem in LocalStorage for LegalAgreed")),
!1}}UKb(a){a=x.c(a);this.QD.contentWindow.postMessage(a,Vc.a.aga(this.r3c))}}gE.j7i="about:blank";Object(t.a)(gE,"InsightsPane",dE,[]);class JM{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(t.a)(JM,"SmartLookupTaskPaneProps",null,[]);class KM{}Object(t.a)(KM,"ActionDescriptor",null,[]);class LM extends dE{constructor(a,d,n,z=null,O=null,ca=null,Da=!0,Xa=null,zb=null){super(d,n,z,O,ca,Da,Xa,zb);this.Mwf=!!l.AFrameworkApplication.la&&!!l.AFrameworkApplication.la.eb&&l.AFrameworkApplication.la.eb.yHe;
this.Sw=this.ksf=!1;this.Lfk=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.Jfk=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.Ofk=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.Nfk=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);Da||jl.aF("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",
10);this.ceb=a;this.pzh=gH(this.I1b)}get isVisible(){return this.Sw}Ikc(a,d){this.fU=a;this.A0a=a=Object.assign(new aE.a,{neighborhood:a.selection.neighborhood,mentionStart:a.selection.mentionStart,mentionLength:a.selection.mentionLength});this.E5c=!a.mentionLength;this.Rda=d;this.LSd(!1)}CIe(a){this.fU=a;this.jTc(Object.assign(new aE.a,{neighborhood:a.selection.neighborhood,mentionStart:a.selection.mentionStart,mentionLength:a.selection.mentionLength}),!1)}HV(a,d){this.Rda=d;this.jTc(a,!0)}WCj(a,
d,n){this.fU=a;this.HV(Object.assign(new aE.a,{neighborhood:a.selection.neighborhood,mentionStart:a.selection.mentionStart,mentionLength:a.selection.mentionLength}),d,n)}jAa(){this.hoa();this.ceb.hideTaskPane()}jTc(a,d){Yb.SessionStatusManager.instance.VN&&this.opa?(this.A0a=a,this.E5c=!a.mentionLength,a=window.performance.now(),this.initialize(),this.isVisible?l.AFrameworkApplication.K.ea("SmartLookupDisableRefreshPaneIsEnabled")?(this.ceb.updateTaskPane(null),d&&this.zhn()):(d&&this.LSd(!1),this.ksf=
!this.ksf,this.ceb.updateTaskPane(this.GF())):(d&&this.LSd(this.isVisible),this.ceb.showTaskPane(this.GF())),this.URc(a)):(this.ceb.showTaskPane(this.GF()),jl.dhn(Yb.SessionStatusManager.instance.VN,!!this.opa,this.fU?$C[this.fU.entryPoint]:"",this.IAb.Awd(),l.AFrameworkApplication.wgd,this.E5c))}zhn(){if(!this.fU){const a=Object.assign(new dw.a,{neighborhood:this.A0a.neighborhood,mentionStart:this.A0a.mentionStart,mentionLength:this.A0a.mentionLength});this.fU=Object.assign(new Ot.a,{selection:a,
userIntent:null,entryPoint:0,launchData:null})}this.LSd(this.isVisible)}khn(){const a=new KM;a.transactionId=this.Rda;a.actionType=15;a.channelId=bh.channelId;this.UKb(a)}Pqb(a){const d=a.rawEvent;document.getElementById(bh.nB)&&d.source!==document.getElementById(bh.nB).contentWindow||(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)?this.RZm(a):super.Pqb(a))}RZm(a){const d=a.rawEvent;let n;try{n=x.b(d.data)}catch(z){k.ULS.sendTraceTag(545604257,
1303,15,this.O_("Message data from Serplet [{0}] failed to deserialize.",d.data));return}switch(n.actionType){case 32:ae.a.VTa()>=this.Lfk?this.ceb.updateTaskPane(this.ESf(this.Jfk)):ae.a.VTa()>=this.Ofk&&this.ceb.updateTaskPane(this.ESf(this.Nfk));break;case 33:this.ceb.updateTaskPane(this.ESf(n.data));break;default:super.Pqb(a)}}dispose(){}initialize(){this.K6();this.Wta()}K6(){this.ceb.ynd()}Wta(){const a=this.ib.Kc(bh.nB);a.parent=Ec.AFrame.hp;a.uK=!0}Jkn(){this.ib.wf(bh.nB)}hoa(){this.jpb()&&
this.ib.wf(this.ib.uI)}pTg(){$addHandler(window,"message",Object(m.a)(this,this.Pqb,"onIFrameMessage"))}Nch(){$removeHandler(window,"message",Object(m.a)(this,this.Pqb,"onIFrameMessage"))}jpb(){return!!this.ib.Zd&&this.ib.Zd.name===bh.nB}UKb(a){a=x.c(a);document.getElementById(bh.nB)&&document.getElementById(bh.nB).contentWindow.postMessage(a,Vc.a.aga(this.pzh))}O_(a,...d){const n={};this.Rda&&(n[bh.hIj]=this.Rda);n[bh.iIj]=String.format.apply(null,[a].concat(d));return x.c(n)}gGb(){return xh.a("isSharedUXDarkModeOn")&&
appChrome.api.isSharedUXDarkModeOn()?3:0}jbj(){if(this.opa)this.opa.onPaneThemeChanged(this.gGb());return xh.a("getTheme")?appChrome.api.getTheme():null}TRc(){}rXe(){document.getElementById(bh.nB)&&ic.FocusManager.iJ(document.getElementById(bh.nB).contentWindow)}bKb(){jl.aF("ReactSmartLookupPane - Iframe component failed to load.",10)}ONc(){l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||jl.aF("ReactSmartLookupPane - Onload detected no network.",
50)}GF(){var a=new JM;a.src=this.pzh;a.id=bh.nB;a.refreshPane=this.ksf;a.onError=Object(m.a)(this,this.bKb,"onIFrameError");a.onLoad=Object(m.a)(this,this.ONc,"onIFrameLoad");a.title=bh.CKb;Yb.SessionStatusManager.instance.VN?this.opa||(a.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,a.errorType=1):(a.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,a.errorType=0);a=Object.assign(new yk.a,{title:bh.CKb,hideHeader:!1,width:bh.width,location:bh.$Nm,contentProps:a,
isModernPane:!0,onOpen:()=>{this.Jkn();this.Sw=!0;this.pTg();xh.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(m.a)(this,this.jbj,"onThemeIdChanged"));l.AFrameworkApplication.la.updateCommandUI();if(this.opa)this.opa.onPaneStateChanged(!0)},onClose:()=>{this.khn();this.hoa();this.Sw=!1;this.Nch();xh.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(Object(m.a)(this,this.jbj,"onThemeIdChanged"));l.AFrameworkApplication.la.updateCommandUI();
if(this.opa)this.opa.onPaneStateChanged(!1)}});this.Mwf&&(a.enableResize=!0,a.minResizeWidth=320,a.maxResizeWidth=920);return a}ESf(a){const d=this.GF();d.resizeWidth=a;return d}}Object(t.a)(LM,"ReactSmartLookupPane",dE,[]);class MM{ynd(){const a=new qj.CuiHelper(ul.a.A2a,WordEditorIntl.WordEditorStrings);return zp.a.instance.GSf(bh.nB,bh.HOc,bh.width,bh.e$g,a)}showTaskPane(a){zp.a.instance.showTaskPane(a)}hideTaskPane(a){zp.a.instance.hideTaskPane(a)}Q6b(a){zp.a.instance.Q6b(bh.nB,a)}}Object(t.a)(MM,
"WordInsightsPaneHandler",null,[455]);class NM{ynd(){zp.a.instance.t3a()}showTaskPane(a){xk.UISurfaces.Nv().then(d=>{d.showTaskPane(bh.nB,a);return null})}updateTaskPane(a=null){xk.UISurfaces.Nv().then(d=>{d.setSelectedTaskPane(bh.nB);a&&d.updateTaskPane(bh.nB,a);return null})}hideTaskPane(){xk.UISurfaces.Nv().then(a=>{a.hideTaskPane(bh.nB,2);return null})}}Object(t.a)(NM,"WordReactSmartLookupPaneHandler",null,[454]);class OM extends bD{constructor(a,d){super();this.Sp=a;this.Da=d}tpe(){const a=!!l.AFrameworkApplication.la&&
!!l.AFrameworkApplication.la.eb&&l.AFrameworkApplication.K.ea("SmartLookupEnableNativePane");return l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb&&l.AFrameworkApplication.la.eb.LGe?new LM(new NM,lk.a.instance,ic.FocusManager.instance(),la.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),la.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),la.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),a,la.a.instance.Ca("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
la.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper")):new gE(new MM,lk.a.instance,ic.FocusManager.instance(),la.a.instance.resolve("Common.Utils.IAriaNotifier"),la.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),la.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),la.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),a,la.a.instance.Ca("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),la.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper"))}YFc(){return this.Sp.getSelectedText()}Tyi(){if(!this.Da||
!this.Da.ya||1>this.Da.ya.length)return null;var a=this.Da.ya.Ba.ra;a=null==a?null:La.FormattingReader.yr(a);return(a=null==a?null:Ih.a.yf(La.FormattingReader.language(a)))?a.name:""}Mlb(){return this.Sp.IDi()}Vyi(){return this.Sp.IDi()}bSi(){return this.Sp.K9l()}}Object(t.a)(OM,"WordInsightsManager",bD,[]);var jQ=b(152);class PM{}Object(t.a)(PM,"CommandMetadataResponse",null,[]);class $B{constructor(){this.Yhg=this.getAllIcons()}executeCommand(){}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){jQ.PrivacyDialogManager.RNb()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(a){const d=
new PM;a.iconNames&&(d.svgData=this.getCommandIconSvg(a.iconNames));if(!a.commandId||""===a.commandId)return d;try{d.label=appChrome.selectors.getControlLabel(a.commandId);if(d.svgData&&""!==d.svgData)return d;const n=appChrome.selectors.getControlIconSet(a.commandId),z=Array(2);z[0]=n["default"];z[1]=n.icon32;d.svgData=this.getCommandIconSvg(z)}catch(n){return null}return d}getCommandIconSvg(a){if(!this.Yhg)return"";for(let d=0;d<a.length;d++){const n=a[d];if(n in this.Yhg)return this.Yhg[n]}return""}getAllIcons(){return{}}createFeedbackPropertiesFromData(a){const d=
{SourceControlId:"GiveFeedback"};d.feedbackType="true"===a.IsPosFeedback?0:1;const n={};n.featureArea=$B.Uil;d.telemetryGroup=n;d.appData=a;return d}}$B.$Ji="FA000000012";$B.Ihj="AssetID=";$B.Uil="SearchPane";Object(t.a)($B,"BaseSerpletExecutor",null,[309,310]);class QM extends $B{constructor(a,d,n){super();this.ga=a;this.Da=d;this.HG=n}executeCommand(a){if(!a)throw Error("Missing commandData argument");switch(a.CommandId){case 0:this.ga.ob(Mb.a.GIb,2,null);break;case 1:this.ga.ob(Dc.a.rmc,2,null);
break;default:throw Error(`Unknown commandId requested: ${a.CommandId}`);}}browseFiles(){this.ga.ob(Sa.a.iBd,2,null)}openHelpTaskPane(){}openFeedbackPane(a){this.ga.ob(Sa.a.xkc,2,this.createFeedbackPropertiesFromData(a))}openFindReplaceTaskPane(a){const d={};d.CommandValueId=a;d.SourceControlId="Insights";this.ga.ob(Sa.a.sue,2,d)}openFindReplaceTaskPaneV2(a){a={CommandValueId:a.Query,MatchCase:a.MatchCase,MatchWholeWord:a.MatchWholeWordOnly};lH(this.Da,this.HG);this.ga.ob(Sa.a.sue,2,a)}openFindTaskPane(a){const d=
{};d.CommandValueId=a;d.SourceControlId="Insights";this.ga.ob(Sa.a.findInDocument,2,d)}openNavigationPane(){this.ga.ob(Dc.a.eTc,2,null)}openSerpletTaskPane(){this.ga.ob(Sa.a.Jlg,2,null)}sendAutoLaunchSearchRequest(){this.ga.ob(Sa.a.dBd,2,null)}getAllIcons(){const a={};for(const n of Object.keys(window))if(n.startsWith("word")){var d=window[n];d&&(d=d.icons,null!==d&&void 0!==d&&d.length&&d.forEach(z=>a[z.id]=JSON.stringify(z)))}return a}}Object(t.a)(QM,"WordSerpletExecutor",$B,[]);class RM extends iH{constructor(){super();
this.Ppf=null}get name(){return"WordEditor.Insights"}init(){l.AFrameworkApplication.hY&&(this.Ppf.sa("WordEditor.Insights.WordInsightsActor").lb(),l.AFrameworkApplication.K.ea("SmartLookupEnableNativePane")&&l.AFrameworkApplication.K.ea("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?l.AFrameworkApplication.K.wq(Object(m.a)(this,this.Gw,"onFullAppSettingsReady")):super.init())}Gw(){l.AFrameworkApplication.hY&&(this.Xcl(),Ea.a.ar().then(()=>this.Ppf.resolve("WordEditor.Insights.IAugloopSearchProviderManager")))}Hb(a){super.Hb(a);
this.Ppf=a;a.ha("Box4.Insights.Box4InsightsSelection",()=>new Mo.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance();a.ha("WordEditor.Insights.WordInsertContentExecutor",()=>new EM(l.AFrameworkApplication.pa)).as("Common.App.SearchCommon.IInsertContentExecutor").singleInstance();a.ha("WordEditor.Insights.WordSerpletExecutor",()=>new QM(l.AFrameworkApplication.pa,Lg.a.instance,a.resolve("Box4.ISelectionFactory"))).as("Common.App.SearchCommon.ISerpletExecutor").singleInstance();
a.ha("WordEditor.Insights.AugloopSearchProviderManager",()=>new ZB(a.resolve("Box4.AugmentationLoop.IAnnotationStorage"),a.resolve("Common.App.Insights.IDocumentContentExtractionManager"))).as("WordEditor.Insights.IAugloopSearchProviderManager").singleInstance();a.ha("WordEditor.Insights.WordDocumentContentExecutor",()=>{const d=new DM(new Nf.a(()=>Lb.App.oa?Lb.App.oa.za.jc:null),a.resolve("Box4.IParagraphReader"),vM.a.instance,l.AFrameworkApplication.K,nD.a.instance,cQ.a.instance,a.resolve("Box4.Search.IFindManagerHelper"),
a.resolve("Common.Comments.ICommentModel"),l.AFrameworkApplication.pa,Lg.a.instance,a.resolve("Box4.ISelectionFactory"));d.initialize();return new yM(new Nf.a(()=>Lb.App.oa?Lb.App.oa.za.jc:null),a.resolve("Box4.IParagraphReader"),Ic.InteractiveViewManager.instance,Lg.a.instance,a.resolve("Box4.ISelectionFactory"),d,Lb.App.jj.Cm.Oe(12),new Nf.a(()=>Lb.App.oa.za),ic.FocusManager.instance(),l.AFrameworkApplication.K,a.resolve("Common.Comments.ICommentModel"),a.resolve("Common.App.Insights.IInsightsSelection"),
a.Ca("WordEditor.Insights.IAugloopSearchProviderManager"))}).as("Common.App.SearchCommon.IDocumentContentExecutor").singleInstance();a.ha("WordEditor.Insights.WordInsightsManager",()=>new OM(a.resolve("Common.App.Insights.IInsightsSelection"),a.resolve("Box4.ISelectionManager"))).as("Common.App.Insights.IInsightsManager").singleInstance();a.ha("WordEditor.Insights.WordInsightsActor",()=>new FM(a.vf("Common.App.Insights.IInsightsManager"),l.AFrameworkApplication.pa,l.AFrameworkApplication.K)).singleInstance();
a.ha("Common.App.SearchCommon.IDocumentHelper",()=>new zM).singleInstance()}}Object(t.a)(RM,"WordInsightsPackage",iH,[]);class kQ{}Object(t.a)(kQ,"ScalingStep",null,[]);class SM{constructor(a,d,n){this.Z3c=!1;this.z1=null;this.pdd=this.Gtc=!1;this.Dfb=[];this.rVe=z=>{this.Ria&&this.Ria!==z&&appChrome.api.dispatch(this.xDi(!1))};d.execute(z=>{this.z1=z});a.dE(Object(m.a)(this,this.PJm,"onProcessSetSelectionFinished"));this.ty=n}KGc(a,d,n){const z=[];for(const O of a)z.push(appChrome.actions.addScalingStepInTab("Home",
{type:d,controlId:O},n));return z}oCi(a){const d=[];for(let n=0;4>n;n++)d.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:a},2>n?0:void 0));d.push(appChrome.actions.addScalingStepInTab("Home",{type:"GalleryToFlyout",controlId:a},void 0));return d}xDi(a){const d=[];if(a)switch(this.Ria){case "Image":d.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));d.push(...this.oCi("PictureStyles"));d.push(...this.KGc("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),
"DropLabel"));a=this.Dfb.slice().reverse();a.push("TextAlignmentAnchor");d.push(...this.KGc(a,"MoveToOverflow"));break;case "Table":this.pdd||d.push(...this.oCi("TableStyles"));d.push(...this.KGc(this.Dfb,"DropLabel",this.pdd?0:void 0));a=this.Dfb.slice().reverse();d.push(...this.KGc(a,"MoveToOverflow"));break;case "Hyperlink":d.push(...this.KGc(["EditHyperlink","RemoveHyperlink"],"DropLabel")),a=this.Dfb.slice().reverse(),d.push(...this.KGc(a,"MoveToOverflow"))}else for(const n of this.Dfb)d.push(appChrome.actions.removeControlScalingStepsFromTab(n,
"Home"));return d}r_d(a){let d={};for(const n of a)try{d[n]=appChrome.selectors.getModelType(n)}catch(z){this.bna("Error","GetModelType failed for "+n)}Lb.App.oa.jve(d)}zKn(a){if(0!==a.length){var d=[],n={},z=!1;for(const O of a)try{if(appChrome.selectors.isControlDefined(O))n[O]=appChrome.selectors.getModelType(O);else{z=!0;break}}catch(ca){this.bna("Error","GetModelType failed for "+O);z=!0;break}if(z)this.Ria=void 0,this.o3e(!1);else{if("Image"===this.Ria&&!this.Gtc)d.push(appChrome.actions.updateGroupHiddenState("Font",
!0)),this.Gtc=!0;else if(this.Gtc){d.push(appChrome.actions.updateGroupHiddenState("Font",!1));z=appChrome.selectors.getVisibleControlsInGroup("Font");for(const O of z)n[O]=appChrome.selectors.getModelType(O);this.Gtc=!1}Lb.App.oa.jve(n);this.Dfb=a;n=[];for(const O of a)appChrome.selectors.isControlDisabled(O)&&n.push(O);0<n.length&&this.bna("Disabled",n.join(","));0<this.Dfb.length&&(d.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),d.push(appChrome.actions.updateControlsInGroup("Adaptive",
this.Dfb)),d.push(...this.xDi(!0)),this.Z3c=!0);appChrome.api.dispatch(d)}}}o3e(a){if(a||this.Z3c){var d=[];d.push(appChrome.actions.updateGroupHiddenState("Adaptive",!a));this.Z3c=a;if("Image"===this.Ria||this.Gtc){a=!a;d.push(appChrome.actions.updateGroupHiddenState("Font",!a));if(a){const n=appChrome.selectors.getVisibleControlsInGroup("Font");this.r_d(n)}this.Gtc=!a}appChrome.api.dispatch(d)}}p2e(){this.Z3c&&this.ty&&this.ty.execute(a=>{a.logActivity("AdaptiveContextualGroupShown",null)})}PJm(a,
d){!l.AFrameworkApplication.la.eb.$lc&&"Home"===appChrome.selectors.getSelectedTabId()&&this.z1&&d.zi&&d.zi.Ba&&0!==d.zi.length?(a=()=>{let n=[],z=!1;var O=this.z1.contentType,ca=appChrome.selectors.getActiveContextualTabIds();O.includes("Image")?(this.rVe("Image"),this.Ria&&"Image"===this.Ria?z=!0:(n="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),this.Ria="Image")):
O.includes("Table")&&0<=ca.indexOf("Table")?(O=!(Qs.a.instance.Ba.xY||Qs.a.instance.Ba.ym||Qs.a.instance.Ba.k6a),(ca="Table"===this.Ria&&O!==this.pdd)?this.rVe("TableCellEdit"):this.rVe("Table"),!this.Ria||"Table"!==this.Ria||ca?(O?(n=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.pdd=!0):(n="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),
this.pdd=!1),this.Ria="Table"):z=!0):O.includes("Hyperlink")&&(this.rVe("Hyperlink"),this.Ria&&"Hyperlink"===this.Ria?z=!0:(n=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.Ria="Hyperlink"));z?this.Z3c||(this.r_d(this.Dfb),this.o3e(!0),this.p2e()):0<n.length?(this.zKn(n),this.p2e()):this.o3e(!1)},"requestIdleCallback"in window?window.requestIdleCallback(a):window.requestAnimationFrame(a)):this.o3e(!1)}bna(a,d){a={Time:(new Date).getTime(),Event:a,Message:d,Scenario:"AdaptiveTabGroup"};
d=new Yh.a;d.name="Events";d.dataFields=Ze.a.KU(a);d.durationMs=window.performance.now();R.a.KKa(d,"TellMeWAC.")}}Object(t.a)(SM,"AdaptiveTabGroupUpdater",null,[]);class TM{constructor(){this.Z=null}get name(){return"WordEditor.RibbonIntelligence"}Hb(a){this.Z=a}init(){yE(1,Object(m.a)(this,this.wCm,"onAppChromeLazyLoad"))}wCm(){l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&!I.a.Fy&&(this.Z.ha("WordEditor.UI.AdaptiveTabGroupUpdater",
()=>new SM(this.Z.resolve("Box4.ISelectionManager"),this.Z.Ca("Common.IActionContextProvider"),this.Z.Ca("Common.ISystemInitiatedFeedback"))).singleInstance(),this.Z.resolve("WordEditor.UI.AdaptiveTabGroupUpdater"))}dispose(){}}Object(t.a)(TM,"PackageManager",null,[1,2]);const lQ=(a,d,n)=>1===n?32:2===n?(b.e(6).then(b.bind(null,1796)).then(z=>{z.createAndShowDevToolsMenu()}),32):2;class mH{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",
!1))l.AFrameworkApplication.pa.ma(Dc.a.o5g,Cd.a.frame,lQ),null!==sessionStorage.getItem("devToolsRefresh")&&b.e(6).then(b.bind(null,1796))}dispose(){}Hb(){}static main(){M.a.instance.Sb(new mH)}}Object(t.a)(mH,"WordDevToolsPackage",null,[1,2]);var ao=b(535);class nH{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(t.a)(nH,"FormattingData",null,[]);class UM extends nH{constructor(){super();this.hyperlinkData=null}}Object(t.a)(UM,"RichContentCommandData",
nH,[]);class oi{constructor(){oi.yj.add(Dc.a.tub);oi.yj.add(Dc.a.gnc);oi.yj.add(Dc.a.QTc);oi.yj.add(Dc.a.o1);oi.yj.add(Dc.a.nEg);oi.yj.add(Dc.a.dOg);oi.yj.add(Dc.a.deleteComment);oi.yj.add(Dc.a.vod);oi.yj.add(Dc.a.kVf);oi.yj.add(Dc.a.JZe);oi.yj.add(Dc.a.$ub);oi.yj.add(Dc.a.o5g);oi.yj.add(Dc.a.rmc);oi.yj.add(Dc.a.w5g);oi.yj.add(Dc.a.Apd);oi.yj.add(Dc.a.Sre);oi.yj.add(Mb.a.Xod);oi.yj.add(Mb.a.openInClient);oi.yj.add(Mb.a.print);oi.yj.add(Mb.a.TNd);oi.yj.add(Mb.a.WSe);oi.yj.add(Mb.a.BLb);oi.yj.add(Mb.a.GIb);
oi.yj.add(Sa.a.nah);oi.yj.add(Sa.a.tellMe);oi.yj.add(Sa.a.hUc);oi.yj.add(Sa.a.xkc);oi.yj.add(Sa.a.giveFeedback);oi.yj.add(Sa.a.YSc);oi.yj.add(Sa.a.oZe);oi.yj.add(Sa.a.L4e);oi.yj.add(Sa.a.wkb);oi.yj.add(Sa.a.newComment);oi.yj.add(Sa.a.vne);oi.yj.add(Sa.a.RVa);oi.yj.add(Sa.a.aVe);oi.yj.add(Sa.a.$Ue);oi.yj.add(Sa.a.bVe);oi.yj.add(Sa.a.Yod);oi.yj.add(Sa.a.Rka);oi.yj.add(Sa.a.ZZe);oi.yj.add(Sa.a.x5g);oi.yj.add(Sa.a.close);oi.yj.add(Sa.a.yOd);oi.yj.add(Sa.a.ZNd);oi.yj.add(Sa.a.oKb);oi.yj.add(Sa.a.YNb);
oi.yj.add(Sa.a.ZNb);oi.yj.add(Sa.a.aXa);oi.yj.add(Sa.a.renameFile);oi.yj.add(Sa.a.abc);oi.yj.add(Sa.a.a6g);oi.yj.add(Sa.a.KVd);oi.yj.add(Sa.a.downloadACopy);oi.yj.add(Sa.a.pkc);oi.yj.add(Sa.a.GMd);oi.yj.add(Sa.a.xLb);oi.yj.add(Sa.a.rQg);oi.yj.add(Sa.a.aNf);oi.yj.add(Sa.a.Tkd);oi.yj.add(Sa.a.une);oi.yj.add(Sa.a.cNf);oi.yj.add(Sa.a.bNf);oi.yj.add(Sa.a.vne);oi.yj.add(Sa.a.Ukd);oi.yj.add(Dc.a.u5e);oi.yj.add(Dc.a.dih);oi.yj.add(Dc.a.zoomToPageWidth);oi.yj.add(Dc.a.FZg);oi.yj.add(Dc.a.jLb);oi.yj.add(Dc.a.rTe);
oi.yj.add(Dc.a.xua);oi.yj.add(Sa.a.Cnb);oi.yj.add(Sa.a.sjb);oi.yj.add(Sa.a.xmc);oi.yj.add(Sa.a.eih);oi.yj.add(Sa.a.wQg);oi.yj.add(Mb.a.OKb)}}oi.yj=new Set;Object(t.a)(oi,"CommentRibbonCommands",null,[]);class VM{constructor(a,d,n,z,O,ca){this.J6i=a;this.dK=d;this.cS=n;this.pX=z;this.ef=O;this.JDn=ca;this.ewc=null;this.rMa=new cg.a(0);this.PQb=new cg.a(0);this.f$e=new cg.a(0);this.tyf=!1;this.S2l();this.r4m()}$8l(a){return this.ewc&&this.cS.ZL?!oi.yj.has(a):!1}sGb(a,d,n){if(a===Sa.a.rc)return 32;if(!this.rMa.Na(a)&&
!this.PQb.Na(a)||!this.ewc)return 2;const z=this.PQb.Na(a);var O=z?this.PQb.J(a):this.rMa.J(a);const ca=z?2:this.f$e.J(n);z||1!==ca||(this.Cam(Lb.App.oa.Zh.Zd.name)||Lb.App.oa.Zh.wf(this.dK.xq?Ec.AFrame.Zs:Ec.AFrame.IP),Lb.App.oa.updateCommandUI(!0));n=new UM;if(this.pX.bKc)switch(O){case 1:n.highlight={color:this.HCi(d.Color)};break;case 6:n.fontColor={color:this.HCi(d.Color)}}O=this.ewc.executeCommand(O,ca,n);2===O&&z&&(a===Mb.a.lic?d[Yf.a.On]=!!n.bold:a===Mb.a.sic?d[Yf.a.On]=!!n.italic:a===Mb.a.Fic?
d[Yf.a.On]=!!n.underline:a===Mb.a.Aic?d[Yf.a.On]=!!n.strikethrough:a===Mb.a.m5?d[Yf.a.On]=!!n.highlight:a===Mb.a.$v&&(d[Yf.a.On]=!!n.fontColor));return 2===O?32:1===O?2:8}k2m(a){this.ewc=a;this.ewc.registerSelectionChangeHandler(()=>{this.tyf||(this.tyf=!0,Lb.App.oa.updateCommandUI(!0),this.tyf=!1)});this.ewc.registerKeypressHandler(d=>{if(d.shortKey)switch(d.key){case xb.a.YLa:case xb.a.Upc:case xb.a.Wpc:case xb.a.lEa:Lb.App.oa.updateCommandUI(!0)}d.key!==xb.a.rC&&d.key!==xb.a.iZ||Lb.App.oa.updateCommandUI(!0)})}r4m(){this.J6i.Zlj(Ec.AFrame.Zs,
this);this.J6i.Zlj(Ec.AFrame.IP,this)}S2l(){this.rMa.$(Mb.a.bold,0);this.rMa.$(Mb.a.setItalic,3);this.rMa.$(Mb.a.strikethrough,4);this.rMa.$(Mb.a.underline,5);this.pX.bKc&&(this.rMa.$(Mb.a.m5,1),this.rMa.$(Mb.a.Fqa,1),this.rMa.$(Mb.a.$v,6),this.rMa.$(Mb.a.yaa,6),this.rMa.$(Mb.a.Uta,6));this.PQb.$(Mb.a.lic,0);this.PQb.$(Mb.a.sic,3);this.PQb.$(Mb.a.Aic,4);this.PQb.$(Mb.a.Fic,5);this.f$e.$(1,0);this.f$e.$(2,1)}Cam(a){return a===Ec.AFrame.Zs||a===Ec.AFrame.IP}HCi(a){return a?zl.a.LA(this.JDn.IRa(this.ef.xc,
a)):""}}Object(t.a)(VM,"CommentRibbonCommandHandler",null,[218,219]);class oH{constructor(){this.Z=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.Z.resolve("WordEditor.Comments.ICommentRibbonCommandHandler");this.Z.resolve("WordEditor.Comments.CommentsState").WQg?this.Z.resolve("WordEditor.Comments.CommentRibbonCommands"):this.Z.resolve("WordEditor.Comments.WordCommentEventsActor").JLb("OnCommentRenderedOnce",()=>{this.Z.resolve("WordEditor.Comments.CommentRibbonCommands")})}dispose(){}Hb(a){this.Z=
a;this.Z.ha("WordEditor.Comments.CommentRibbonCommandHandler",()=>new VM(this.Z.sa("Common.INonCanvasCuiUser"),this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("Common.Comments.ICommentModel"),this.Z.resolve("WordEditor.Comments.CommentsSettings"),Rj.App.wn.za.Rb,on.a.instance)).as("WordEditor.Comments.ICommentRibbonCommandHandler").singleInstance();this.Z.ha("WordEditor.Comments.CommentRibbonCommands",()=>new oi).singleInstance()}static main(){M.a.instance.Sb(new oH)}}Object(t.a)(oH,
"PackageManager",null,[1,2]);var mQ=b(1400),WM=b(1413);class pH{get name(){return"Common.App.OAuth.OAuthPackage"}Hb(a){a.register(270,"Common.App.OAuth.IOAuthManager").singleInstance().zd(()=>new mQ.OAuthManager)}init(){const a=la.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.pIn(a)}pIn(a){const d=l.AFrameworkApplication.K.Ga("FileSource");if(l.AFrameworkApplication.K.ea("IsO365ConsumerHost")||l.AFrameworkApplication.K.ea("IsO365CommercialHost")||"WopiTest"===d){var n=B.a.jpl,z=B.a.authority;
if(void 0!==n&&null!==n&&n.length&&void 0!==z&&null!==z&&z.length){var O=WM.a[a.cva],ca=I.a.qI,Da=a.LP();try{var Xa=new Map;void 0!==Xa&&null!==Xa?(Xa.set("SupportStatus",O),Xa.set("Browser",ca),Xa.set("AuthStrategy",Da)):Xa=null}catch(Vb){Xa=null}ja.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",Xa);var zb=Ye.a.me();a.xLa("Core",n).then(Vb=>{var Fc=Math.floor(Ye.a.me()-zb);O=WM.a[a.cva];ca=I.a.qI;Da=a.LP();k.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
Fc,Vb.IsSuccess,O,Vb.ErrorCode,d,ca,Da);Xa&&(Xa.set("SupportStatus",O),Xa.set("Browser",ca),Xa.set("AuthStrategy",Da));Fc=Object.assign(new Pa.a,{durationMs:Fc,extendedProperties:Xa});Vb.IsSuccess?ja.Health.instance.recordKpiSuccess("WacCorePFT",Fc):ja.Health.instance.recordKpiFailure("WacCorePFT",Vb.ErrorCode,!1,!1,Fc)})}}}dispose(){}static main(){M.a.instance.Sb(new pH)}}Object(t.a)(pH,"OAuthPackage",null,[1,2]);class XM{constructor(){this.Pde=new cg.a}hIn(a,d){if(!a)return k.ULS.sendTraceTag(40478031,
306,10,"SDX AssetId is null."),!1;a=w.a.He(a);if(this.Pde.Na(a))return k.ULS.sendTraceTag(40478032,306,10,"ISdxPaneSuppressionHandler already registered for SDX AssetId: {0}.",a),!1;this.Pde.$(a,d);return!0}lag(a){if(!a)return k.ULS.sendTraceTag(40478033,306,10,"SDX AssetId is null."),null;a=w.a.He(a);return this.Pde.Na(a)?this.Pde.J(a):(k.ULS.sendTraceTag(40478034,306,10,"ISdxPaneSuppressionHandler does not exist for SDX AssetId: {0}.",a),null)}}Object(t.a)(XM,"SdxPaneSuppressionManager",null,[]);
class YM{constructor(a){this.lof=0;this.Ggk=a}zJb(){return this.lof>=this.Ggk}reset(){this.lof=0}update(){this.lof++}}Object(t.a)(YM,"NodeCountBasedTaskYieldStrategy",null,[697]);class ZM{constructor(){this.tTd=new Set}L3m(a){this.tTd.add(a)}JJn(a){this.tTd.delete(a)}SJm(){return()=>{this.tTd.forEach(a=>{a.onSessionClose()})}}TJm(){return()=>{this.tTd.forEach(a=>{a.onSessionConnect()})}}UJm(){return()=>{this.tTd.forEach(a=>{a.onSessionDisconnect()})}}}Object(t.a)(ZM,"AlSessionLifeEventNotifier",null,
[566]);var qH=b(1209),$M=b(620),nQ=b(401),oQ=b(491);class aN{constructor(){this.token=null}}Object(t.a)(aN,"ReleaseAnnotationParameters",null,[]);class bN{constructor(){this.value=this.id=this.parentPath=null}}Object(t.a)(bN,"SetAnnotationMetadataParameters",null,[]);class cN{constructor(){this.id=this.parentPath=null;this.value=0}}Object(t.a)(cN,"SetAnnotationStateParameters",null,[]);var cD=b(1414),BF=b(303);class dN extends Sys.EventArgs{constructor(a,d){super();this.annotation=a;this.aCb=d}}Object(t.a)(dN,
"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);class rH{constructor(a){this.fYh=this.hf=null;if(!a)k.ULS.sendTraceTag(41418884,389,10,"Null operation received!"),this.hf=null;else if(a.items&&0<a.items.length){const d=rH.Rye(a.parentPath);this.hf=Array(a.items.length);let n=0;for(const z of a.items){const O=Object.assign(new wI.a,{id:z.id,parentPath:d,content:z.body,annotationType:Gj.a.getTypeNameFor(z.body),parentRevId:a.parentRevId});this.hf[n++]=O}this.fYh=Gj.a.getTypeNameFor(a)}}static Rye(a){return a?
a.join("\\"):""}}Object(t.a)(rH,"AnnotationOperation",null,[]);class sH extends Sys.EventArgs{constructor(a,d){super();this.annotationType=a;this.activated=d}}Object(t.a)(sH,"AnnotationActivationEventArgs",Sys.EventArgs,[]);class dD extends Sys.EventArgs{constructor(a,d){super();this.annotation=a;this.opType=d}}Object(t.a)(dD,"AnnotationOperationEventArgs",Sys.EventArgs,[]);class tH{constructor(){this.newState=this.oldState=0;this.handlers=new db.a}}Object(t.a)(tH,"AnnotationResultStateUpdateData",
null,[]);var pQ=b(880);class eN{constructor(){this.mEf=this.PBk=this.oEf=null}}Object(t.a)(eN,"AnnotationCallbacks",null,[]);class gt{constructor(a,d,n,z,O,ca,Da){this.YM=Da;this.Kxc=null;this.Z9c=new cg.a(0);this.Xed=new cg.a;this.e3d=new cg.a;this.Vbe=new ra.a;this.AIg=null;this.te=a;this.YNa=d;this.BJ=n;this.Su=z;this.HZ=O;this.Ja=ca}jSn(a,d,n,z){this.Su.lJc(a)&&this.te.Fd(()=>{if(!this.Kxc){this.Kxc=new cg.a;var O=Bd.ParagraphReader.VB(Ea.a.getRootNode(),!0,!0);for(const ca of O)ca&&(O=ca.fa(Qb.a.Ob,
0))&&(this.Kxc.add(O,ca.id),this.Z9c.$(ca.id.toString(),O))}this.YNa.zIg(a,(ca,Da)=>{if(ca){var Xa=this.Su.$9f(a);ca.contentDescriptor.fv===Xa&&((Xa=this.kBl(ca))?ca.$Bb?(Xa=this.DQf(ca,Xa))&&(Da?n(Da,ca.contentDescriptor):d(Xa,ca.contentDescriptor)):z(ca.contentDescriptor):this.T7k(ca,Object.assign(new eN,{oEf:d,PBk:n,mEf:z})))}})},"PAS:FEPAOT")}kBl(a){if(3===a.contentDescriptor.fv){let d;return({value:d}=this.Kxc.Ab(a.contentDescriptor.paragraphId)).returnValue?d:null}if(4===a.contentDescriptor.fv)return E.a.nil;
k.ULS.sendTraceTag(592525442,gt.yi,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");return null}Sam(a,d){if(3===a.contentDescriptor.fv)return d=this.HZ.value.Ta(d).getValue(Qb.a.Ui),a.contentDescriptor.Ui===d;if(4===a.contentDescriptor.fv&&d===E.a.nil)return!0;k.ULS.sendTraceTag(592525443,gt.yi,15,"IsGraphNodeValidForAnnotation: Unsupported content type");return!1}T7k(a,d){if(3===a.contentDescriptor.fv){const n=a.contentDescriptor.paragraphId;this.Xed.Na(n)||this.Xed.add(n,new db.a);
this.Xed.J(n).add(z=>{12===z.type&&this.Kxc.add(n,z.id);a.$Bb?(z=this.DQf(a,z.id))&&d.oEf(z,a.contentDescriptor):d.mEf(a.contentDescriptor)})}else if(4===a.contentDescriptor.fv)if(a.$Bb){const n=this.DQf(a,E.a.nil);n&&d.oEf(n,a.contentDescriptor)}else d.mEf(a.contentDescriptor);else k.ULS.sendTraceTag(592525444,gt.yi,15,"DelayCallbackForAnnotation: Unsupported content type")}DQf(a,d){if(this.Sam(a,d)){if(d=this.Su.Ozm(a.$Bb,a.contentDescriptor,d.toString()))return this.e3d.$(d.id,a.fsb),d}else this.Ja.isFeatureEnabled(143)&&
this.BJ.Nfd(a);return null}GPj(a,d){let n;(n=this.YM?this.Su.swe(a):this.Su.S2b(a))&&(d===Rp.a.getTypeName()?this.dHn(a,n):this.TGn(a,n))}dHn(a,d){this.Su.lJc(a.annotationType)&&(this.BJ.RLb(this.HZ.value,d,a.annotationType),this.e3d.remove(a.id))}TGn(a,d){if(this.Su.lJc(a.annotationType)){d=Object.assign(new pQ.a,{$Bb:this.Su.TBk(a),contentDescriptor:d,annotationType:a.annotationType});d=this.BJ.addAnnotation(this.HZ.value,d);this.e3d.$(a.id,d);const n=this.Su.LGi(a.annotationType);n&&this.Vbe.contains(n)&&
(this.te.Fd(()=>{var z=Bd.ParagraphReader.VB(Ea.a.getRootNode(),!0,!0);if(z&&0<z.count){const O=new db.a;for(const ca of z)(z=gt.Oye(ca))&&O.add(z);0<O.count&&this.BJ.NUh(this.HZ.value,n,O.toArray())}},"PAS:TAOCPA"),this.Vbe.remove(n))}}DKd(a){if(this.Kxc)if(a){var d=a.fa(Qb.a.Ob,0);if(d&&(this.Z9c.$(a.id.toString(),d),({value:d}=this.Xed.Ab(d)).returnValue))for(const n of d)n(a)}else k.ULS.sendTraceTag(592525445,gt.yi,10,"OnParagraphNodeConnected: Invalid node")}N$i(a,d){if(a){var n=a.id.toString();
a=a.fa(Qb.a.Ob,0);var z=0;({value:z}=this.Z9c.Ab(n)).returnValue&&(3===d?(this.Xed.remove(z),this.Z9c.remove(n)):2===d?this.Z9c.$(n,a):k.ULS.sendTraceTag(592525447,gt.yi,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else k.ULS.sendTraceTag(592525446,gt.yi,10,"UpdatePersistedAnnotations: Invalid node")}$Ll(a){let d;return({value:d}=this.e3d.Ab(a)).returnValue?d:E.a.nil}eQn(a,d,n){a?d?this.YNa.XBi(a,z=>{if(z){const Da=gt.Oye(d,n);if(Da){var O=Array(z.length),
ca=!1;for(let Xa=0;Xa<z.length;Xa++)if(ca||Da!==z[Xa])O[Xa]=z[Xa];else{const zb=gt.Oye(d);if(!zb)return;ca=!0;O[Xa]=zb;z[Xa]=zb}ca&&this.BJ.NUh(this.HZ.value,a,O)}}}):k.ULS.sendTraceTag(588863697,gt.yi,10,"UpdateWorkflowParagraphVersion: Invalid node"):k.ULS.sendTraceTag(588863696,gt.yi,10,"UpdateWorkflowParagraphVersion: null workflowType")}nnn(a){a?this.Vbe.add(a):k.ULS.sendTraceTag(588863698,gt.yi,10,"SetPendingWorkflow: null workflowType")}ISk(a){a?this.Vbe.remove(a):k.ULS.sendTraceTag(588105731,
gt.yi,10,"ClearPendingWorkflow: null workflowType")}static Oye(a,d=0){if(!a)return null;d||(d=a.fa(Qb.a.Ui,0));a=Bd.ParagraphReader.gH(a);if(d&&a)return String.format("{0}{1}{2}",a,gt.COm,d);k.ULS.sendTraceTag(588091606,gt.yi,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",d?"valid":"0",a?"valid":"0");return null}}gt.yi=389;gt.COm="-";Object(t.a)(gt,"PersistedAnnotationStorage",null,[609]);class fN{constructor(){this.config=this.token=null}}Object(t.a)(fN,"UpdateAnnotationConfigParameters",
null,[]);var gN=b(120),qQ=b(927);class Qi{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc=null){this.YM=Fc;this.ka=new oc.a;this.jMa=new yb.a;this.Soa=new yb.a;this.mJ=new yb.a;this.h9e=new yb.a;this.s5d=new qi.a(ma.a.Xi());this.Dpf=new db.a;this.mqc=new yb.a;this.c9e=new yb.a;this.f3d=new yb.a;this.nqc=new yb.a;this.IXc=new yb.a;this.g3d=new yb.a;this.M4d=new yb.a;this.vae=[];this.wae=[];this.l7c=null;this.Hgk=new qi.a(ma.a.Xi());this.f9e=new Map;this.$Yc=null;this.Xua=new yb.a;this.nck=a.ea("AugLoopAnnotationsAttachingIsEnabled");
this.ymk=a.kx("SendReleaseMessageAnnotationList")||[];this.Ja=Vb;this.l_a=Yc;this.YNa=ca;this.BJ=Da;this.Wu=n;this.Su=Xa;this.aka=zb;this.HZ=z;this.te=d;this.fb=O;la.a.instance.resolve("Box4.ICharacterPropertiesEditor").lWh(Object(m.a)(this,this.PEm,"onEditInIntentRangeEventHandler"))}get hmj(){return this.nqc}set hmj(a){this.nqc=a}Ea(a,d){k.ULS.sendTraceTag(41521862,Qi.yi,50,"New registration for annotation type: {0}.",d);this.addHandler(a,d);this.jAf(d).catch(n=>{k.ULS.sendTraceTag(594396739,Qi.yi,
10,"Failed to activate annotation type {0}: {1}",d,n.toString())})}addHandler(a,d){if(a&&d&&""!==d){var n=null;({value:n}=this.nqc.Ab(d,n)).returnValue?n.add(a):(n=new db.a,n.add(a),this.nqc.add(d,n))}else k.ULS.sendTraceTag(41521861,Qi.yi,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!a,!d,""===d)}kb(a,d){k.ULS.sendTraceTag(41521863,Qi.yi,50,"Unregister handler for annotation type: {0}.",d);let n=null;({value:n}=this.nqc.Ab(d,n)).returnValue&&
(n.remove(a),n.count||(k.ULS.sendTraceTag(41521864,Qi.yi,50,"Unregister all handlers for annotation type: {0}.",d),this.nqc.remove(d),this.pCm(d)))}W5k(){this.vae.length||this.wae.length?(0<this.vae.length&&this.Xtm(),0<this.wae.length&&this.qJn()):(this.fb.ie(this.l7c),this.l7c=null)}ybi(){this.l7c||(this.l7c=new bf.a(4,2,100,Object(m.a)(this,this.W5k,"cudIntentsForAnnotationsTask"),141),this.fb.rb(this.l7c))}Xtm(){let a;a=Array.dequeue(this.vae);const d=Ea.a.wye(this.HZ.value,a);if(d)if(d.Bf){var n=
null;if(({value:n}=this.IXc.Ab(a,n)).returnValue){this.IXc.remove(a);for(const z of n)this.Ytm(d,z)}else k.ULS.sendTraceTag(50663568,Qi.yi,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.Hgk.add(a);else k.ULS.sendTraceTag(50436127,Qi.yi,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}Ytm(a,d){var n=d.content.range;n=new cD.a(0,n.start,n.start+n.length,E.a.create(),d,z=>{this.h9e.$(d.id,z.toString())});this.Wu.nMc(a,n);this.ka.j4&&this.ka.raiseEvent(Qi.sNc,
new dD(d,Jn.a.getTypeName()))}c3i(a){const d=Ea.a.dHc(a.parentPath);let n=null;({value:n}=this.IXc.Ab(d,n)).returnValue||(n=new db.a,this.IXc.add(d,n),Array.enqueue(this.vae,d));n.add(a);this.ybi()}$tm(a,d){this.te.Fd(()=>{let n;if(({value:n}=this.Soa.Ab(a,n)).returnValue){var z=this.qBj(a);for(const O of n){let ca;({value:ca}=this.mJ.Ab(O,ca)).returnValue&&d(ca)&&Qi.obc(ca)&&(this.c3i(ca),z&&this.ka.raiseEvent(Qi.sNc,new dD(ca,Rp.a.getTypeName())))}}},"AS:MIFAT")}rJn(a,d){this.te.Fd(()=>{let n;if(({value:n}=
this.Soa.Ab(a,n)).returnValue)for(const z of n){let O;({value:O}=this.mJ.Ab(z,O)).returnValue&&d(O)&&Qi.obc(O)&&this.Ach(O)}},"AS:UIFAT")}vCm(a){var d=Ea.a.L9b(a);let n=null;if(({value:n}=this.jMa.Ab(d,n)).returnValue){d=0;for(var z=new db.a;n.count>d;){var O=n.J(d),ca=null;({value:ca}=this.mJ.Ab(O,ca)).returnValue&&Qi.obc(ca)?this.Su.Plc(a,ca)?this.ICc(ca,!this.Ja.isFeatureEnabled(143)):(O=ca.content.range,ca=new cD.a(0,O.start,O.start+O.length,E.a.create(),ca),z.add(ca),d++):d++}0<z.count&&this.Wu.ezg(a,
z)}}qJn(){let a="";a=Array.dequeue(this.wae);const d=Ea.a.wye(this.HZ.value,a);if(d&&12===d.type){var n=null;({value:n}=this.g3d.Ab(a,n)).returnValue?(this.Wu.Bch(z=>n.contains(z.jt),d,0),this.g3d.remove(a)):k.ULS.sendTraceTag(50663570,Qi.yi,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")}else k.ULS.sendTraceTag(50436128,Qi.yi,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}Ach(a){let d;({value:d}=this.h9e.Ab(a.id,d)).returnValue||(d=Ea.a.dHc(a.parentPath));
this.h9e.remove(a.id);var n=null;({value:n}=this.g3d.Ab(d,n)).returnValue||(n=new db.a,this.g3d.add(d,n),Array.enqueue(this.wae,d));n.add(a);this.ybi();n=null;({value:n}=this.IXc.Ab(d,n)).returnValue&&n.remove(a)}Cvk(a){const d=a.id;var n=a.annotationType;const z=a.parentPath;this.YM?this.Su.ZIa(a):this.Su.tGe(n);let O=null;({value:O}=this.Soa.Ab(n,O)).returnValue||(O=new db.a,this.Soa.add(n,O));O.add(d);n=null;({value:n}=this.jMa.Ab(z,n)).returnValue||(n=new db.a,this.jMa.add(z,n));n.add(d);this.mJ.add(d,
a);this.iSn(a);return!0}iSn(a){const d=a.annotationType;let n=!1,z,O;this.YM?(z=this.Su.Qsi(a),n=0<z.length,O=(ca,Da,Xa)=>this.YNa.hIm(ca,Da,Xa)):(z=[this.Su.S2b(a)],n=null!==z[0],O=(ca,Da,Xa)=>this.YNa.ZNc(ca[0],Da,Xa));if(n){let ca=!1;O(z,a.annotationType,(Da,Xa)=>{this.mJ.Na(a.id)?(Xa=this.YM?this.Su.hIb(a,Ea.a.Zsi(a)):this.Su.lHe(d,Ea.a.Zsi(a)),!Da&&Xa?this.Xdh(a,10,!1):Da&&this.Xdh(a,Da),this.YM&&ca||(this.ehi(a),ca=!0)):Xa.e9a=!0})}else this.ehi(a)}ehi(a){const d=Qi.obc(a);d&&this.c3i(a);!d&&
this.ka.j4&&this.ka.raiseEvent(Qi.sNc,new dD(a,Jn.a.getTypeName()))}wNj(a,d,n){let z=!0;this.te.Fd(()=>{if(n.startsWith(Ea.a.X6b)){var O=a.id,ca=null;if(d===Rp.a.getTypeName())this.ICc(a);else if(({value:ca}=this.mJ.Ab(O,ca)).returnValue)k.ULS.sendTraceTag(41418891,Qi.yi,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",O,a.annotationType),this.mJ.$(O,a);else if(!this.Cvk(a)){z=!1;return}d===Jn.a.getTypeName()&&n!==Ea.a.X6b&&this.Dpf.add(a.annotationType)}this.Ekc(a,
d)},"AS:UAS");return z}Ejn(a){if(a)for(const d of a)this.Ekc(d,JC.a.getTypeName()),a=d.content,this.M4d.Na(a.categoryName)?this.M4d.$(a.categoryName,d):this.M4d.add(a.categoryName,d);else k.ULS.sendTraceTag(592802119,Qi.yi,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}eyk(a){this.ka.addHandler(Qi.sNc,a)}$Vh(a){this.ka.addHandler(Qi.t8i,a)}KEe(a){return this.mqc.Na(a)}dyk(a){this.ka.addHandler(Qi.cNe,a)}P7m(a){this.ka.removeHandler(Qi.cNe,a)}qBj(a){return!Ea.a.le(a)&&
MD.a(a)&&this.ka.j4}ICc(a,d=!0){if(this.mJ.Na(a.id)){var n=this.mJ.J(a.id);this.mJ.remove(a.id);var z=null;({value:z}=this.jMa.Ab(a.parentPath,z)).returnValue?(z.remove(a.id),Qi.obc(n)&&this.Ach(n)):k.ULS.sendTraceTag(50734169,Qi.yi,15,"DeleteAnnotationFromStorage: No annotations in given parent path");z=null;({value:z}=this.Soa.Ab(a.annotationType,z)).returnValue?z.remove(a.id):k.ULS.sendTraceTag(50734170,Qi.yi,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");
this.qBj(a.annotationType)?this.ka.raiseEvent(Qi.sNc,new dD(n,Rp.a.getTypeName())):this.Ekc(a,Rp.a.getTypeName());d&&this.aka.GPj(n,Rp.a.getTypeName())}}k5f(a,d,n=!1){const z=new db.a;var O;if(!({value:O}=this.Soa.Ab(a,O)).returnValue)return z;for(const ca of O)this.mJ.Na(ca)?(a=this.mJ.J(ca),(O=this.YM?this.Su.swe(a):this.Su.S2b(a))&&(d.equals(O)||n&&d.overlaps(O))&&z.add(a)):k.ULS.sendTraceTag(577843217,Qi.yi,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",
ca);return z}hVm(a){this.te.Fd(()=>{k.ULS.jT(Qi.yi,100)&&k.ULS.sendTraceTag(41418894,Qi.yi,100,"Operation of type {0} with path {1} received",Gj.a.getTypeNameFor(a),a.parentPath.join("\\"));try{const d=new rH(a);for(const n of d.hf){const z=n.parentPath,O=d.fYh;if(O===Rp.a.getTypeName()){let Da=null;({value:Da}=this.mJ.Ab(n.id,Da)).returnValue&&(n.annotationType=Da.annotationType)}const ca=n.annotationType;if(Ea.a.le(ca)||ca!==ND.a.getTypeName())if(!Ea.a.le(ca)&&MD.a(ca)&&n.content&&0==n.content.priority&&
gN.a.cJa){const Da=Ea.a.dHc(z);Da&&Da==gN.a.Hql()&&k.ULS.sendTraceTag(539870169,Qi.yi,10,"Skipping the Spelling Error Annotation as Text Prediction is visible")}else O!==Rp.a.getTypeName()&&this.s5d.contains(z)?k.ULS.sendTraceTag(41418897,Qi.yi,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",z,n.id):(this.I5m(n),this.wNj(n,O,z)&&this.aka.GPj(n,O));else k.ULS.sendTraceTag(595342670,Qi.yi,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",
z)}}catch(d){k.ULS.sendTraceTag(41418898,Qi.yi,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",d.message,d.stack)}},"AS:PO")}I5m(a){if(a&&a.annotationType&&this.Su.lJc(a.annotationType)){var d;if(({value:d}=this.Soa.Ab(a.annotationType,d)).returnValue&&(a=this.YM?this.Su.swe(a):this.Su.S2b(a)))for(const n of d){let z;({value:z}=this.mJ.Ab(n,z)).returnValue&&(d=this.YM?this.Su.swe(z):this.Su.S2b(z))&&(a.equals(d)||a.overlaps(d))&&this.ICc(z)}}}Ekc(a,d){this.te.Fd(()=>
{let n=null;if(({value:n}=this.hmj.Ab(a.annotationType,n)).returnValue)for(const z of n)z.sS(a,d)},"AS:SATH")}OSk(){k.ULS.sendTraceTag(50860999,Qi.yi,50,"ClearStorage: Initiated Clearing Storage");this.$Yc||(this.$Yc=new bf.a(4,2,100,Object(m.a)(this,this.PSk,"clearStorageTask"),142),this.fb.rb(this.$Yc))}PSk(){const a=new db.a;for(const d of this.mJ.values)if(a.add(d),a.count===Qi.Mgk)break;for(const d of a)this.ICc(d),this.Ekc(d,Rp.a.getTypeName());this.mJ.count||(this.fb.ie(this.$Yc),this.$Yc=
null)}activateAnnotation(a,d){let n;if(({value:n}=this.f3d.Ab(a,n)).returnValue){if(n.contains(d))return Promise.resolve(null);n.add(d)}else{let z;this.f3d.add(a,(z=new db.a,z.add(d),z))}return this.jAf(a)}jAf(a){k.ULS.sendTraceTag(41521865,Qi.yi,50,"ActivateAnnotation: Activating annotation type {0}.",a);if(this.mqc.Na(a))return Promise.resolve(null);var d=null;if(({value:d}=this.c9e.Ab(a,d)).returnValue)return d;this.ltk(a);d=null;this.l_a&&(d=this.l_a());if(d){const n=new oQ.a;n.annotationType=
a;l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",!1)&&(this.Xua.Na(a)||this.Xua.$(a,new tH),n.stateUpdateHandler=(z,O)=>{this.Xua.J(a).oldState=z;this.Xua.J(a).newState=O;for(const ca of this.Xua.J(a).handlers)ca(a,z,O)});d=d.activateAnnotation(n);this.c9e.add(a,d);return d.then(z=>{this.c9e.remove(a);this.mqc.add(a,z.token);this.vNj(z.token,a);this.ka.raiseEvent(Qi.cNe,new sH(a,!0));this.NWl(a);return z})}return Promise.reject(Error.create("Error during annotation activation"))}NWl(a){const d=
this.Su.LGi(a);d&&this.YNa.XBi(d,n=>{if(this.aka.AIg){var z=Bd.ParagraphReader.VB(Ea.a.getRootNode(),!0,!0);if(z&&0<z.count){let O=0;for(const ca of z){z=gt.Oye(ca);if(!z)continue;let Da=!1;for(;O<n.length;){if(z===n[O]){Da=!0;break}O++}if(!Da){this.aka.AIg(d);break}O++}}}})}ltk(a){this.aka.jSn(a,(d,n)=>{0<this.k5f(a,n,!0).count||this.wNj(d,Jn.a.getTypeName(),d.parentPath)},(d,n)=>{if(3!==n.fv)k.ULS.sendTraceTag(591541786,Qi.yi,15,"Annotation moved to unsupported location type: {0}",n.fv);else if(d.fv!==
n.fv)k.ULS.sendTraceTag(591541787,Qi.yi,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",d.fv,n.fv);else{d=this.k5f(a,d);for(const O of d){const ca=O.content;d=Ea.a.bmb(this.HZ.value,O.parentPath);if(!d){k.ULS.sendTraceTag(591541788,Qi.yi,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.Wu.Bch(Da=>Da.jt===ca,d,0))break;var z=n.uGa;z=new cD.a(0,z,z+n.tGa,null,ca);this.Wu.nMc(d,z)}}},d=>{for(const n of this.k5f(a,d))this.ICc(n,
!1)})}releaseAnnotation(a,d){let n;if(({value:n}=this.f3d.Ab(a,n)).returnValue){n.contains(d)&&n.remove(d);if(0<n.count)return Promise.resolve(!1);this.f3d.remove(a)}k.ULS.sendTraceTag(593790408,Qi.yi,50,"ReleaseAnnotation: Releasing annotation type {0}.",a);return this.hvj(a)}pCm(a){var d=null;if(({value:d}=this.Soa.Ab(a,d)).returnValue){k.ULS.sendTraceTag(41418899,Qi.yi,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",a);for(const n of d)if(d=null,({value:d}=this.mJ.Ab(n,
d)).returnValue){const z=d.parentPath;let O=null;({value:O}=this.jMa.Ab(z,O)).returnValue&&(O.remove(n),O.count||this.jMa.remove(z));this.mJ.remove(n);Qi.obc(d)&&this.Ach(d)}this.Soa.remove(a)}Array.contains(this.ymk,a)&&this.hvj(a)}hvj(a){let d=null,n=null;this.l_a&&(n=this.l_a());if(n){if(({value:d}=this.mqc.Ab(a,d)).returnValue){const z=new aN;z.token=d;this.mqc.remove(a);this.ka.raiseEvent(Qi.cNe,new sH(a,!1));return n.releaseAnnotation(z)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}NXi(){this.te.Fd(()=>
{if(this.nck){var a=Ea.a.getRootNode();if(a){var d=new yb.a;Bq.e(a,n=>{var z=Ea.a.L9b(n),O=null;if(({value:O}=this.jMa.Ab(z,O)).returnValue)for(const ca of O)z=null,({value:z}=this.mJ.Ab(ca,z)).returnValue&&(z.parent=n,z.oDd=!0,z.ohc=2,d.Na(z.annotationType)||d.$(z.annotationType,new db.a),d.J(z.annotationType).add(ca),O=null,({value:O}=this.Soa.Ab(z.annotationType,O)).returnValue&&O.remove(z.id));return!0},12);for(const n of this.Soa.keys)if(a=null,({value:a}=this.Soa.Ab(n,a)).returnValue)for(const z of a)if(a=
null,({value:a}=this.mJ.Ab(z,a)).returnValue){let O=null;a.parentPath===Ea.a.X6b?(a.ohc=1,a.parent=null):({value:O}=this.mJ.Ab(a.parentPath,O)).returnValue?(a.ohc=3,a.parent=O):(a.ohc=0,a.parent=null,k.ULS.sendTraceTag(41554060,Qi.yi,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",a.id));a.oDd=!0;d.Na(a.annotationType)||d.$(a.annotationType,new db.a);d.J(a.annotationType).add(z)}else k.ULS.sendTraceTag(41997840,Qi.yi,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",
z);else k.ULS.sendTraceTag(41997841,Qi.yi,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",n);this.Soa=d;this.Dpf.clear()}else k.ULS.sendTraceTag(41554058,Qi.yi,10,"LinkAnnotations: There is no root node in the current document.")}else k.ULS.sendTraceTag(41554057,Qi.yi,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}SBk(a){this.hVm(a)}MKm(a){this.te.Fd(()=>{const d=Ea.a.L9b(a);k.ULS.sendTraceTag(41418900,Qi.yi,50,"OnTileDeleted: Tile delete event received for tile {0}.",
d);this.s5d.contains(d)||this.s5d.add(d);var n=null;if(({value:n}=this.jMa.Ab(d,n)).returnValue){k.ULS.sendTraceTag(41418901,Qi.yi,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",n.count,d);for(const z of n)n=null,({value:n}=this.mJ.Ab(z,n)).returnValue&&(this.Ekc(n,Rp.a.getTypeName()),this.ka.j4&&this.ka.raiseEvent(Qi.sNc,new dD(n,Rp.a.getTypeName())),this.mJ.remove(z));this.jMa.remove(d)}},"AS:OTD")}LKm(a){a=Ea.a.L9b(a);this.s5d.remove(a)&&k.ULS.sendTraceTag(41418902,Qi.yi,
50,"OnTileAdded: Deleted tile {0} was re-added.",a)}uOn(a){if(a){k.ULS.sendTraceTag(50436131,Qi.yi,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",a.count);var d=new yb.a;for(var n of a)a=null,({value:a}=d.Ab(n.parentPath,a)).returnValue||(a=new yb.a,d.add(n.parentPath,a)),a.$(n.id,n);for(const z of d){d=Ea.a.bmb(this.HZ.value,z.key);if(!d){k.ULS.sendTraceTag(50436160,Qi.yi,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}n=new BF.a([0]);for(let O=0,
ca=d.ja.length;O<ca;O++)a=d.ja.J(O),a.Eg&&n.FZa(a.Eg,void 0,(Da,Xa)=>{if(Xa){var zb=null,Vb=Xa.jt;Vb&&({value:zb}=z.value.Ab(Vb.id,zb)).returnValue&&(Vb=new $M.a,Vb.start=Xa.Wa.cp,Vb.length=Da.Wa.cp-Vb.start,zb.content.range=Vb,zb.W6a=!1)}})}}else k.ULS.sendTraceTag(50436130,Qi.yi,10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(a){k.ULS.sendTraceTag(593049729,Qi.yi,50,"GetAnnotationsByType: Method called for type {0}.",a);return this.jAf(a).then(()=>{const d=new db.a;this.te.Fd(()=>
{if(Ea.a.le(a)||a!==ND.a.getTypeName()){this.Dpf.contains(a)&&this.NXi();var n=null;if(({value:n}=this.Soa.Ab(a,n)).returnValue){k.ULS.sendTraceTag(41418903,Qi.yi,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",a);var z=new db.a;for(const O of n)n=null,({value:n}=this.mJ.Ab(O,n)).returnValue&&(n.W6a&&z.add(n),d.add(n));z&&0<z.count&&Qi.obc(z.J(0))&&this.uOn(z)}}else for(z of this.M4d.values)d.add(z);d.count||k.ULS.sendTraceTag(41418904,Qi.yi,50,"GetAnnotationsByType: No annotations found for type {0}!",
a)},"AS:GABT");return d},d=>{k.ULS.sendTraceTag(41418905,Qi.yi,10,"Exception occurred while fetching annotations of type {0}: {1}",a,d);return null})}nlb(a){let d=null;return({value:d}=this.mJ.Ab(a,d)).returnValue?d:null}$si(a){let d=null;if(this.jMa.Na(a))for(const n of this.jMa.J(a))if(a=this.nlb(n))d||(d=new db.a),d.add(a);return d}MJl(a){a=this.nlb(a);return a?a.parent?a.parent:a.parentPath?Ea.a.bmb(this.HZ.value,a.parentPath):(k.ULS.sendTraceTag(51189520,Qi.yi,15,"GetParentNodeFromAnnotationId: No parent path found"),
null):(k.ULS.sendTraceTag(51189519,Qi.yi,15,"GetParentNodeFromAnnotationId: No annotation found"),null)}qec(a){return(a=this.nlb(a))?(a.oDd||this.NXi(),a):null}Bvb(a,d){this.Fon(a,d);this.Xdh(a,d);this.Ekc(a,JC.a.getTypeName());if(!this.YM&&this.Su.lHe(a.annotationType,d)){const n=this.Su.S2b(a);n&&(a=Object.assign(new qQ.a,{annotationType:a.annotationType,contentDescriptor:n,state:d}),this.BJ.Ij(this.HZ.value,a))}}EKn(a,d){this.DNn(a,d);this.xmn(a,Ea.a.fsl(a));this.Ekc(a,JC.a.getTypeName())}FKn(a,
d){if(this.YM){a=this.Su.Qsi(a);for(var n of a)this.BJ.A3e(this.HZ.value,n,d)}else n=this.Su.S2b(a),this.BJ.A3e(this.HZ.value,n,d)}Fon(a,d){let n=null;this.l_a&&(n=this.l_a());n&&(a=this.gsl(a,d))&&n.setAnnotationState(a)}Xdh(a,d,n=!0){if(a&&Qi.BPi(a)){var z=this.nlb(a.id);!a.content||z&&a.content===z.content||Ea.a.setAnnotationState(a,d);z&&z.content&&Ea.a.setAnnotationState(z,d);n&&this.ka.j4&&(70===d||60===d)&&this.ka.raiseEvent(Qi.t8i,new dN(a,d))}}gsl(a,d){let n=null;a&&(n=Object.assign(new cN,
{id:a.id,value:d}),Ea.a.le(a.parentPath)||(n.parentPath=a.parentPath.split("\\")));return n}xmn(a,d){const n=this.l_a?this.l_a():null;n&&(a=this.esl(a,d))&&n.setAnnotationMetadata(a)}DNn(a,d){if(a&&Qi.BPi(a)){var n=this.nlb(a.id);!a.content||n&&a.content==n.content||Ea.a.Nvj(a,d);n&&n.content&&Ea.a.Nvj(n,d)}}esl(a,d){if(!a)return null;const n=new bN;n.id=a.id;n.value=d;Ea.a.le(a.parentPath)||(n.parentPath=a.parentPath.split("\\"));return n}grn(a,d,n,z){const O=a.content;if((this.YM?this.Su.ZIa(a):
this.Su.tGe(a.annotationType))&&O){const ca=O.range.start+O.range.length;if(0<z&&ca<=n||0>z&&ca<=n+z)return!1;if(0<z&&O.range.start>=d||0>z&&O.range.start>=n)return O.range.start+=z,!1}return!this.Ja.isFeatureEnabled(104)&&O&&O.M_?(a=this.YM?this.Su.hIb(a,60):this.Su.lHe(a.annotationType,60),!(60===O.M_.state&&a)):!0}PEm(a,d){for(const n of d.Eg)a=n.jt,!a.type&&this.grn(a.jt,n.cpBegin,n.cpEnd,n.nec)&&this.ICc(a.jt)}ETh(a,d){this.Xua.Na(d)||this.Xua.$(d,new tH);this.Xua.J(d).handlers.add(a);a(d,this.Xua.J(d).oldState,
this.Xua.J(d).newState)}Amj(a,d){this.Xua.Na(d)&&this.Xua.J(d).handlers.contains(a)&&this.Xua.J(d).handlers.remove(a)}static BPi(a){a=Gj.a.getBaseTypesFor(a.content);return Array.contains(a,Op.a.getTypeName())}static obc(a){if(void 0===a.content||null===a.content||""===Ea.a.dHc(a.parentPath))return!1;const d=Gj.a.getBaseTypesFor(a.content);return Array.contains(d,nQ.a.getTypeName())&&a.annotationType!==bp.RoleDetectionAnnotation.getTypeName()}DKn(a){a?(this.f9e.AugLoop_Text_Critique=a,a=this.KEe("AugLoop_Text_Critique")?
this.mqc.J("AugLoop_Text_Critique"):null,this.vNj(a,"AugLoop_Text_Critique")):k.ULS.sendTraceTag(540615552,Qi.yi,50,"Annotation configuration could not be updated for annotation type: {0}.","AugLoop_Text_Critique")}vNj(a,d){if(a&&this.f9e[d]){const n=new fN;n.token=a;n.config=this.f9e[d];this.l_a&&(this.l_a().updateAnnotationConfig(n),k.ULS.sendTraceTag(540615553,Qi.yi,50,"Annotation configuration has been updated for annotation type: {0}.",d))}}}Qi.yi=389;Qi.sNc="OnAnnotationOperation";Qi.t8i="OnAnnotationLocalStateChange";
Qi.cNe="OnAnnotationActivationChange";Qi.Mgk=20;Object(t.a)(Qi,"AnnotationStorage",null,[610]);class hN{constructor(){this.wZg=null;this.iVd=!1}}Object(t.a)(hN,"AugmentationLoopStateManager",null,[605]);var iN=b(228);class uH extends iN.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=this.SeedBatchesInParallelIsEnabled=
!1}Jk(){return 102}static construct(a,d,n,z,O,ca){const Da=new uH;Da.ExpectedEndRevisionId=a;Da.OriginString=d;Da.Authorization=n;Da.AugLoopSeedUrl=z;Da.FileId=O;Da.SeedBatchesInParallelIsEnabled=ca;Da.AddDocumentKindTypeToPathIsEnabled=!0;Da.CheckOnDemandNodeVersionEnabled=!0;Da.AddSubDocumentKindTypeToPathIsEnabled=!0;return Da}}Object(t.a)(uH,"FullFileAugLoopSeedingRequest",iN.a,[]);class vH{constructor(){this.authToken=this.url=this.dcj=null}}Object(t.a)(vH,"ReseedingTaskInfo",null,[]);class ur{constructor(a,
d,n,z,O,ca){this.JRb=null;this.mxh=!1;this.Urc=null;this.Isf=0;this.g3j=a.ea("AugLoopServerSideSeedingIsEnabled");this.e3j=a.ea("AugLoopReseedingIsEnabled");this.f3j=a.ea("AugLoopFFSSeedBatchesInParallelIsEnabled");this.sFh=a.jb("MaxReseedingRetries",1);this.nf=d;this.Q7d=n;this.iU=z;this.Ija=O;this.lg=ca;Lb.App.oa&&Lb.App.oa.za&&Lb.App.oa.za.jc&&Lb.App.oa.za.jc.contentReplicator&&(this.JRb=Lb.App.oa.za.jc.contentReplicator)}A4l(a,d,n){if(this.g3j){var z=this.iU.wZg;z&&z.trim().length?this.mxh?this.e3j&&
(k.ULS.sendTraceTag(50861E3,ur.yi,50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),this.Isf=0,this.JRb?(this.iU.iVd=!0,this.JRb.xyc(Object(m.a)(this,this.INd,"processReplicationStatus")),this.Urc=Object.assign(new vH,{dcj:a,url:d,authToken:n}),this.JRb.BI(null,null,this.Urc)):k.ULS.sendTraceTag(592814793,ur.yi,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(k.ULS.sendTraceTag(41445392,ur.yi,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),this.wij(z,a,d,n),
this.mxh=!0):k.ULS.sendTraceTag(41445391,ur.yi,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else k.ULS.sendTraceTag(41445390,ur.yi,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}INd(a,d){a=d.hla;this.Urc&&sg.AT(a,n=>n===this.Urc)&&(d.httpStatusCode!==Ma.a.HD||d.$F||2!==d.KMg?d.httpStatusCode!==Ma.a.HD||d.$F||1!==d.KMg?this.yrj(()=>{k.ULS.sendTraceTag(50861003,
ur.yi,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",d.httpStatusCode,d.$F,d.KMg,d.Xt)}):(this.iU.iVd=!1,this.JRb.qjc(Object(m.a)(this,this.INd,"processReplicationStatus")),this.lg.OSk(),k.ULS.sendTraceTag(50861002,ur.yi,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),a=Object(qa.a)(vH,this.Urc),this.wij(d.Ocn,a.dcj,a.url,a.authToken)):this.yrj(()=>
{k.ULS.sendTraceTag(50861001,ur.yi,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))}yrj(a){this.Isf<this.sFh?(k.ULS.sendTraceTag(594384E3,ur.yi,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",++this.Isf,this.sFh),this.JRb.BI(null,null,this.Urc)):(this.iU.iVd=!1,this.JRb.qjc(Object(m.a)(this,this.INd,"processReplicationStatus")),a())}wij(a,d,n,z){const O=uH.construct(a,d,z,n,l.AFrameworkApplication.rootQuerySignature,
this.f3j);k.ULS.sendTraceTag(595178454,ur.yi,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.Q7d.Qac.execute(()=>{this.Cwk(O)})}Cwk(a){k.ULS.sendTraceTag(595178453,ur.yi,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");this.nf.Ni(Lb.App.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,cL.b(a),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,Object(m.a)(this,this.ujl,"fileSeedingSuccessCallback"),
Object(m.a)(this,this.tjl,"fileSeedingFailCallback"),a);k.ULS.sendTraceTag(42016906,ur.yi,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}ujl(a){if(void 0===a||null===a||void 0===a.data||null===a.data||void 0===a.data.Rd||null===a.data.Rd)k.ULS.sendTraceTag(41445393,ur.yi,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(a.data.Ge!==Ma.a.HD)k.ULS.sendTraceTag(41445394,ur.yi,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",
a.data.Ge);else try{let d;({group:d}=tf.a.b9(a.data.Rd,d)).returnValue?d.Responses&&d.Responses.length?(a=null,d&&d.Responses&&d.Responses.length&&(a=d.Responses[0])?(this.Ija.Jvb(a),a.StatusCode?k.ULS.sendTraceTag(41445398,ur.yi,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",a.StatusCode):k.ULS.sendTraceTag(41445399,ur.yi,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",a.LastSeededRevisionId)):
k.ULS.sendTraceTag(41445397,ur.yi,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):k.ULS.sendTraceTag(41445396,ur.yi,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):k.ULS.sendTraceTag(41445395,ur.yi,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(d){k.ULS.sendTraceTag(41445400,ur.yi,10,"FileSeedingSuccessCallback: {0}",
d.message)}}tjl(a){void 0===a||null===a||void 0===a.data||null===a.data||void 0===a.data.Rd||null===a.data.Rd?k.ULS.sendTraceTag(41445401,ur.yi,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):k.ULS.sendTraceTag(41445402,ur.yi,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",a.data.Ge)}}ur.yi=389;Object(t.a)(ur,"FullFileAugLoopSeedingService",null,[]);class jN{constructor(){}}Object(t.a)(jN,"RuntimeManagerInitializationTracker",
null,[]);class kN{getAugLoopRuntimeManager(){return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager()}}Object(t.a)(kN,"AlFactoryWrapper",null,[597]);class lN{ar(){return Ea.a.ar()}}Object(t.a)(lN,"UtilsWrapper",null,[596]);var Gk=b(559),wH=b(250);class vr{constructor(a,d,n,z,O){this.hc=null;this.va=a;this.zc=n;this.Ck=z;this.Xb=O;this.HAa=this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.IsCaptionDetectionEnabled",!1)}get characterPropertiesEditor(){return this.hc||(this.hc=la.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Oc(){return at.a.getInstance()}Ukn(a,
d){a.listType=this.eFl(d);a.outlineLevel=Bd.ParagraphReader.U4a(d);a.indentation=vr.m9f(this.Ck.x7(d));a.alignment=vr.Z4f(Bd.ParagraphReader.Jv(d));a.isInsideTable=this.isInsideTable(d);a.isInsideTOC=d.ko;a.rightIndentation=vr.m9f(this.Ck.HGc(d));var n=this.Ck.QGc(d);a.specialIndentType=vr.SOl(n);a.specialIndentBy=vr.m9f(n);a.listType!==Gk.ListType.NoList&&this.gmn(d,a);this.yon(d,a);n=[];this.HAa&&(n=this.oUm(d));a.formattedRanges=this.YAl(d,n);this.HAa&&null!=n&&(a.objectReferences=0<n.length?n:
void 0)}YAl(a,d){var n=a.ja?a.ja.length:0,z=La.FormattingReader.yr(fe.a.create(a));let O=nn.a.Pz,ca=0,Da=nn.a.NA/2;z&&(Da=La.FormattingReader.jn(z,Vd.a.fontSize,nn.a.NA)/2,O=La.FormattingReader.jn(z,Vd.a.font,nn.a.Pz),ca=La.FormattingReader.language(z));z="Normal";var Xa=this.Xb.im(a);Xa&&(z=Xa.getValue(lh.a.fC)||"Normal",Xa.hasProperty(Vd.a.font)&&(O=Xa.getValue(Vd.a.font)));if(n){--n;Xa=[];let Le=null,Ve=void 0,gg=null;this.HAa&&a.hasProperty(Vd.a.qn)&&(gg=a.getValue(Vd.a.qn));const Lh=a.properties.fa(Qb.a.d7,
null);for(let Ki=0;Ki<n;Ki++){var zb=a.ja.J(Ki),Vb=a.Ib,Fc=null;this.HAa&&(Fc=vr.Tcg(a,gg,Ki));zb.fd&&(Le=vr.HLn(Vb,zb.fd,Le));zb.hyperlink&&zb.hyperlink.url?Ve=zb.hyperlink.url:zb.Wh&&(Ve=void 0);var Yc=a.ja.J(Ki+1).cp-1;Vb=zb.cp;Yc=Yc-zb.cp+1;let Ak=!1,Uk=!1,Rl=!1,kk=Da,dn=0,fs=0,lp=z,zt=void 0,Ro=ca,qr=O,wy;if(zb.formatting){var yd=zb.formatting;Ak=La.FormattingReader.jn(yd,Vd.a.bold,!1);Uk=La.FormattingReader.jn(yd,Vd.a.italic,!1);Rl=La.FormattingReader.jn(yd,Vd.a.underline,!1);kk=La.FormattingReader.jn(yd,
Vd.a.fontSize,2*Da)/2;dn=La.FormattingReader.jn(yd,lh.a.capitalization,0);fs=La.FormattingReader.jn(yd,Vd.a.fontColor,0);Ro=La.FormattingReader.language(yd)||ca;qr=La.FormattingReader.jn(yd,Vd.a.font,O);lp=z;var je=yd.gm;je&&(je=je.fa(lh.a.GA,null))&&!je.equals(E.a.nil)&&yd.paragraph.Ib&&(yd=yd.paragraph.Ib.Ta(je))&&(lp=(new Jw.a(yd)).getValue(lh.a.fC))}this.HAa&&(wy=this.O$f(Fc),null!=wy&&this.pVh(d,Fc,wy,Xa.length,Gk.AnchorMode.Inline));Le&&(zt=0<Le.count);zb={isDeleted:this.X9l(Lh,zb,Ki,Ve),fontFamily:qr,
fontWeight:Ak?Gk.FontWeight.Bold:Gk.FontWeight.Normal,fontSize:kk,italic:Uk,underline:Rl?Gk.UnderlineType.SingleLine:Gk.UnderlineType.None,capitalization:vr.zai(dn),color:zl.a.Ike(fs),styleName:lp,isFollowUp:zt,languageId:vr.oai(Ro),start:Vb,length:Yc,link:Ve,isReference:vr.isReference(zb)?!0:void 0,objectType:null!==wy&&void 0!==wy?wy:void 0};Fc=0<Xa.length?Xa[Xa.length-1]:void 0;vr.fOk(Fc,zb)?Fc.length+=zb.length:Xa.push(zb)}return Xa}return[{fontFamily:O,fontWeight:Gk.FontWeight.Normal,fontSize:Da,
italic:!1,underline:Gk.UnderlineType.None,capitalization:vr.zai(0),color:0,styleName:z,isFollowUp:void 0,languageId:vr.oai(ca),start:0,length:a.characterData.length}]}X9l(a,d,n,z){if(this.tH()){if(d.blob||d.formatting&&d.formatting.cache&&d.formatting.cache.RHb||z)return!0;if(a&&n<a.length)return a[n]}return d.Ue?!0:!1}tH(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}static fOk(a,d){return!!a&&!!d&&a.start+
a.length===d.start&&a.isDeleted===d.isDeleted&&a.fontFamily===d.fontFamily&&a.fontWeight===d.fontWeight&&a.fontSize===d.fontSize&&a.italic===d.italic&&a.underline===d.underline&&a.capitalization===d.capitalization&&a.color===d.color&&a.highlightColor===d.highlightColor&&a.styleName===d.styleName&&void 0===a.link&&void 0===d.link&&a.languageId===d.languageId&&!a.isReference&&!d.isReference&&!a.isFollowUp&&!d.isFollowUp&&void 0===a.objectType&&void 0===d.objectType}eFl(a){const d=new Dd.GraphIterator;
d.set(a);d.La(11);d.tc(11);return(a=this.zc.ht(d))?vr.JYk(a.listType):Gk.ListType.NoList}gmn(a,d){const n=this.zc.QL(a);if(n){n.hasProperty(Qb.a.listID)&&(d.listId=n.getValue(Qb.a.listID).toString());const z=this.Dzi(a,n,Vd.a.font);a=this.Dzi(a,n,Vd.a.fontSize);z&&(d.bulletAndNumberFontFamily=z);a&&(d.bulletAndNumberFontSize=a)}}isInsideTable(a){const d=new Dd.GraphIterator;d.set(a);return d.La(14)}yon(a,d){d.spacingBeforeParagraph=this.fEi(a,Qb.a.X4,Qb.a.Fca,Qb.a.jO);d.spacingAfterParagraph=this.fEi(a,
Qb.a.W4,Qb.a.Eca,Qb.a.JK);d.lineSpacing=this.P4a(a)}fEi(a,d,n,z){if(Bd.ParagraphReader.jn(a,d,!1))return 0;d=Bd.ParagraphReader.jn(a,n,-1);if(0<=d)return d*wH.a.OLd/100;a=Bd.ParagraphReader.jn(a,z,-1);return 0<=a?a/20:0}Dzi(a,d,n){if(vr.Oc.hV){if(a=this.characterPropertiesEditor.vHa(a),null!=a&&null!=a.cache)return a.cache.getValue(n)}else if(d.hasProperty(n))return d.getValue(n)}P4a(a){const d=Bd.ParagraphReader.jn(a,Qb.a.GE,wH.a.GE);a=Bd.ParagraphReader.jn(a,Qb.a.Lt,wH.a.lineSpacing);switch(d){case 0:return a/
240;case 1:return a/20;default:return 0}}static HLn(a,d,n){for(let z=0;z<d.length;z++){const O=d.J(z),ca=O.vi,Da=a.Ta(ca);Da&&Da.fa(Qb.a.uH,!1)&&(n||(n=new qi.a(new Wk.a)),O.Db?n.add(ca):n.remove(ca))}return n}static oai(a){return(a=Ih.a.yf(a))&&a.name?a.name.toLowerCase():void 0}static m9f(a){return a?2===a.unit?Math.floor(rf.a.L2a(a.value)/20):Math.floor(a.value/20):0}static SOl(a){if(!a)return Gk.SpecialIndentType.Initial;switch(a.specialIndentType){case 1:return Gk.SpecialIndentType.FirstLine;
case 2:return Gk.SpecialIndentType.Hanging;default:return Gk.SpecialIndentType.Initial}}static zai(a){switch(a){case 2:return Gk.CapsType.AllCaps;case 1:return Gk.CapsType.SmallCaps;default:return Gk.CapsType.NoCaps}}static Z4f(a){switch(a){case 1:return Gk.Alignment.Left;case 3:return Gk.Alignment.Right;case 2:return Gk.Alignment.Center;case 6:return Gk.Alignment.Justified;case 0:return Gk.Alignment.None;default:return Gk.Alignment.Other}}static JYk(a){switch(a){case 15:return Gk.ListType.Any;case 1:return Gk.ListType.Bullet;
case 42:return Gk.ListType.Invalid;case 13:return Gk.ListType.Lim;case 14:return Gk.ListType.Nil;case 16:return Gk.ListType.NoList;case 0:return Gk.ListType.Numbered;default:return Gk.ListType.Invalid}}static isReference(a){return a.blob&&(7===a.blob.Qf||10===a.blob.Qf)||a.qg&&0<a.qg.length||a.fd&&0<a.fd.length||a.Qa&&0<a.Qa.length?!0:!1}static Tcg(a,d,n){return null==d?null:d[n]&&!d[n].equals(E.a.nil)&&a.Ib?a.Ib.Ta(d[n]):null}O$f(a){if(null==a)return null;if(a.hasProperty(Qb.a.Jp)){var d=a.getValue(Qb.a.Jp);
if(vr.Qej.has(d))return vr.Qej.get(d)}if(a.hasProperty(Qb.a.alb)&&null!=a.getValue(Qb.a.alb))return Gk.ObjectType.FootnoteEndnote;if(a.hasProperty(Qb.a.pageBreak)&&a.getValue(Qb.a.pageBreak))return Gk.ObjectType.PageBreak;if(a.hasProperty(Qb.a.jIb)&&a.getValue(Qb.a.jIb))return Gk.ObjectType.Tab;d=!1;a.hasProperty(Xc.a.wga)?d=a.getValue(Xc.a.wga):a.hasProperty(Qb.a.Cma)&&(d=a.getValue(Qb.a.Cma));return d&&a.hasProperty(Qb.a.imageType)&&1==a.getValue(Qb.a.imageType)?Gk.ObjectType.Image:null}static abm(a){return a.hasProperty(Qb.a.V$b)&&
0<=a.getValue(Qb.a.V$b)?!0:!1}TUi(a){return vr.XAn.has(a)}YRf(a,d,n,z){return null==a||null==d?(k.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),null):z===Gk.AnchorMode.Inline&&null==n?(k.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),null):z===Gk.AnchorMode.Floating&&null!=n?(k.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),
null):0>n?(k.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):vr.abm(a)?null:this.TUi(d)?{referencedPath:["session","doc","main",a.id.toString()],formattedRangeIndex:n,anchorMode:null!==z&&void 0!==z?z:Gk.AnchorMode.Unspecified,anchoredObjectType:z==Gk.AnchorMode.Floating?d:void 0}:null}pVh(a,d,n,z,O){d=this.YRf(d,n,z,O);null!=d&&null!=a&&a.push(d)}oUm(a){const d=[];if(null==a)return k.ULS.sendTraceTag(null,389,10,"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),
d;let n=null;a.hasProperty(Qb.a.H6)&&(n=a.getValue(Qb.a.H6));if(null!=n)for(let z=0;z<n.length;++z){const O=vr.Tcg(a,n,z),ca=this.O$f(O);null!=ca&&this.pVh(d,O,ca,null,Gk.AnchorMode.Floating)}return d}y$h(a){if(null==a||!a.hasProperty(Vd.a.qn))return!1;const d=a.getValue(Vd.a.qn);for(let z=0;z<d.length;z++){var n=vr.Tcg(a,d,z);n=this.O$f(n);if(this.TUi(n))return!0}return!1}}vr.Qej=new Map([[5,Gk.ObjectType.Image],[11,Gk.ObjectType.TextBox],[7,Gk.ObjectType.Chart],[6,Gk.ObjectType.SmartArt],[10,Gk.ObjectType.Drawing],
[2,Gk.ObjectType.EquationObject],[4,Gk.ObjectType.Ink],[19,Gk.ObjectType.PageBreak],[23,Gk.ObjectType.FootnoteEndnote],[24,Gk.ObjectType.FootnoteEndnote],[35,Gk.ObjectType.FootnoteEndnoteReferenceMark],[36,Gk.ObjectType.FootnoteEndnoteReferenceMark],[0,Gk.ObjectType.Other]]);vr.XAn=new Set([Gk.ObjectType.Image,Gk.ObjectType.TextBox,Gk.ObjectType.Chart,Gk.ObjectType.SmartArt,Gk.ObjectType.Drawing,Gk.ObjectType.Ink]);Object(t.a)(vr,"FormattingExtractor",null,[594]);class mN extends Sys.EventArgs{constructor(a){super();
this.EHc=a}}Object(t.a)(mN,"HasNodeEventsEventArgs",Sys.EventArgs,[]);class nN extends Sys.EventArgs{constructor(a){super();this.IAa=a}}Object(t.a)(nN,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class oN{constructor(a,d){this.$Id=a;this.graphNode=d}}Object(t.a)(oN,"NodeEvent",null,[624]);class pN{constructor(){this.Mif=this.Qgf=!1;this.EWb=null;this.ka=new oc.a;this.xFa=new cg.a(0);this.kof=[]}Zxk(a){this.ka.addHandler("IsCollectingNodeEventsChangedKey",a)}ySk(){this.xFa=new cg.a(0);this.EHc=
!1}get EHc(){return this.Qgf}set EHc(a){this.Qgf!==a&&(this.Qgf=a,this.ka.raiseEvent("HasNodeEventsChangedKey",new mN(a),this))}get IAa(){return this.Mif}set IAa(a){this.Mif!==a&&(this.Mif=a,this.ka.raiseEvent("IsCollectingNodeEventsChangedKey",new nN(a),this))}mSg(a,d){if(a)if(this.IAa){var n=a.id,z;({value:z}=this.xFa.Ab(n)).returnValue?z||3!==d?z&&(k.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",n,d),this.xFa.add(n,d)):(k.ULS.sendTraceTag(593761367,389,100,
"Removing node {0} form _nodeIdEventKindMap.",n),this.xFa.remove(n)):(k.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",n,d),Array.enqueue(this.kof,a),this.xFa.add(n,d));this.EHc=0<this.xFa.count}else k.ULS.sendTraceTag(593761369,389,15,"Can't record a node event if not in collecting mode.");else k.ULS.sendTraceTag(593761370,389,15,"node is null.")}uXk(){let a=null;var d=!1;let n=null;for(;this.kof.length&&!d;){n=Array.dequeue(this.kof);if(!n)return k.ULS.sendTraceTag(593761365,
389,15,"graphNode should not be null."),null;a=n.id;d=this.xFa.Na(a)}if(!d)return k.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),this.ySk(),null;d=this.xFa.J(a);this.xFa.remove(a);this.EHc=0<this.xFa.count;k.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",a,d);return new oN(d,n)}J0m(a){this.EWb=a}vXk(){if(!this.EWb)return null;for(var a=0;a<this.EWb.length;a++){const d=this.EWb.J(a).node.id;if(this.xFa.Na(d))return null}a=this.EWb;this.EWb=
null;return a}NSk(){this.EWb=null}Oyn(){this.IAa=!0}X$l(a){return this.xFa.Na(a.id)}}Object(t.a)(pN,"NodeEventsCollection",null,[579]);var rQ=b(268);class qN extends Rs.a{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc){super();this.YM=Fc;this.g8d=new hB.a;this.tyb=!1;this.Fdf=null;this.Jz=d;this.FFa=n;this.rmk=jc.b(z.wZg);this.z9e=a.ea("AugLoopOperationsAreEnabled");this.lg=O;this.aka=ca;this.Su=Da;this.fb=Xa;this.Wu=zb;this.BJ=Vb;this.d0c=new Set;this.ief=new Set;Yc.UCa(this,7);this.E2j=new Set([Vd.a.wk,
Vd.a.bold,Vd.a.italic,Vd.a.underline,Vd.a.font,Vd.a.fontSize,Vd.a.fontColor,lh.a.capitalization,Vd.a.Mj,Vd.a.qn,Qb.a.X4,Qb.a.Fca,Qb.a.jO,Qb.a.W4,Qb.a.Eca,Qb.a.JK,Qb.a.GE,Qb.a.Lt,Qb.a.listID,Qb.a.lM,Qb.a.Oj,Qb.a.Gna,Qb.a.sD,Qb.a.Ui])}get index(){return 7}get BOe(){return this.Fdf}set BOe(a){this.Fdf=a;this.aka.AIg=a?()=>{this.Fdf()}:null}init(){this.sBj()&&this.Tna();this.FFa.Zxk(Object(m.a)(this,this.Jzm,"nodeEventCollection_IsCollectingNodeEventsChanged"))}Tna(){this.Jz?(this.tyb=!0,this.Jz.Rt(Object(m.a)(this,
this.ita,"onParagraphConnect")),this.Jz.vy(Object(m.a)(this,this.Igc,"onParagraphDisconnected")),this.Jz.tq(Object(m.a)(this,this.jta,"onParagraphPropertyChanged")),this.Jz.RCf(Object(m.a)(this,this.O$i,"onParagraphPropertyLoaded")),this.Jz.eWh(Object(m.a)(this,this.B8i,"onBeforeParagraphValidatePersistence"))):k.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}pVc(){this.Jz?(this.tyb=!1,this.Jz.wQ(Object(m.a)(this,this.ita,"onParagraphConnect")),
this.Jz.Hta(Object(m.a)(this,this.Igc,"onParagraphDisconnected")),this.Jz.W0(Object(m.a)(this,this.jta,"onParagraphPropertyChanged")),this.Jz.$Ug(Object(m.a)(this,this.O$i,"onParagraphPropertyLoaded")),this.Jz.zoj(Object(m.a)(this,this.B8i,"onBeforeParagraphValidatePersistence"))):k.ULS.sendTraceTag(39403913,389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}fDe(a){a&&this.g8d.add(a.id,a.fa(Qb.a.Ui,0))}vOj(a){this.g8d.Na(a.id)?(this.aka.eQn(qH.a.aWd,a,this.g8d.J(a.id)),
this.g8d.remove(a.id)):(this.aka.ISk(qH.a.aWd),this.BOe&&this.BOe())}Zlc(a){const d=Lb.App.oa.za.Rb;return!!d&&d.mn&&!!d.xc&&!!d.xc.Ib&&!!a&&!!a.Ib&&a.Ib.id===d.xc.Ib.id}ita(a,d){(a=d.node)&&this.Zlc(a)&&(k.ULS.sendTraceTag(40253400,389,100,"New paragraph Connect event."),Ea.a.zsn(a,this.FFa.IAa,this.z9e,this.rmk)&&(this.FFa.mSg(a,0),this.vOj(a)));this.FFa.IAa&&this.aka.DKd(a)}Igc(a,d){(a=d.node)&&this.Zlc(a)&&(k.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.FFa.IAa&&this.FFa.mSg(a,
3));this.FFa.IAa&&this.aka.N$i(a,3)}jta(a,d){a=d.node;d=d.property;a&&this.E2j.has(d)&&this.Zlc(a)&&(k.ULS.sendTraceTag(40253402,389,100,"New paragraph Modified event."),this.FFa.IAa&&(this.FFa.mSg(a,2),d===Qb.a.Ui&&this.vOj(a)));this.FFa.IAa&&d===Qb.a.Ob&&this.aka.N$i(a,2)}B8i(a,d){(a=d.node)&&Bd.ParagraphReader.nb(a)&&!this.d0c.has(a)&&!this.ief.has(a)&&(this.d0c.add(a),this.l8())}run(){if(0!==this.d0c.size){var a=[];for(let d of this.d0c)a.push(d),this.ief.add(d),100<=a.length&&(this.xki(a),a=
[]);0<a.length&&this.xki(a);this.d0c.clear()}}xki(a){const d=new bf.a(4,1,500,()=>{for(let n of a)this.ief.delete(n),this.updateAnnotationRangeData(n)},158);this.fb.rb(d)}updateAnnotationRangeData(a){var d=this.Wu.Nlb(a,0,z=>this.Ctn(z.jt));if(0<d.count)for(const z of d){d=this.aka.$Ll(z.jt.id);var n=a.Raa;const O=Bd.ParagraphReader.gH(a);z.end<z.begin||(n=rQ.a.YBc(O,n,z.begin,z.end-z.begin,z.begin,z.end-z.begin,a),this.BJ.QTg(a.Ib,d,n))}}Ctn(a){return this.YM?!!a&&this.Su.ZIa(a)&&!!a.content:!!a&&
this.Su.tGe(a.annotationType)&&!!a.content}O$i(a,d){k.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(a=d.node)&&this.lg.vCm(a)}Jzm(){this.sBj()?this.Tna():this.tyb&&!this.FFa.IAa&&this.pVc()}sBj(){return!this.tyb&&this.FFa.IAa}}Object(t.a)(qN,"ParagraphNodeEventHandler",Rs.a,[578]);var sQ=b(876),rN=b(525);class CF extends rN.a{constructor(){super();this.H_=Object.assign(new wq.a,{T_:CF.getTypeName(),B_:CF.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}
Object(t.a)(CF,"DeltaUpdateOperation",rN.a,[]);class sN{constructor(){this.referencedPath=null}}Object(t.a)(sN,"ItemReference",null,[]);class tN extends Sq.a{constructor(){super();this.op=this.delta=this.parentPath=null}}Object(t.a)(tN,"ItemWithPath",Sq.a,[]);var tQ=b(882);class hE extends eq.a{constructor(){super();this.selectedRanges=null;this.H_=Object.assign(new wq.a,{T_:hE.getTypeName(),B_:hE.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(t.a)(hE,"SelectionSignal",eq.a,[]);class DF extends hE{constructor(){super();this.content=null;this.H_=Object.assign(new wq.a,{T_:DF.getTypeName(),B_:DF.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal","AugLoop_Signals_Signal"]}}Object(t.a)(DF,"SelectionContentSignal",hE,[]);class uN{constructor(){this.range=this.tileReference=null}}Object(t.a)(uN,"TextTileRange",null,[]);var uQ=b(1480);class vN{constructor(a,
d,n,z,O,ca,Da,Xa){this.Sda=this.Xef=null;this.Huf=!1;this.Ywa=this.Elf=this.$de=null;this.va=a;this.Nzb=d;this.fb=n;this.xdd=z;this.d3j=this.va.ea("AugLoopOperationsAreEnabled");this.A_b=new qi.a(ma.a.Xi());this.lg=O;this.te=ca;this.yFa=Da;this.Da=Xa;this.v3d=this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1);this.Da.dE(Object(m.a)(this,this.wCa,"processSetSelectionFinished"));Ea.a.ar().then(()=>{this.Sda=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacBox4AugLoopTimeBasedYieldTraversalSettings");
this.va.ea("AugLoopAnnotationsIsEnabled")&&this.Sda.setAnnotationResultCallback(Object.assign(new uQ.a,{handler:zb=>{this.lg.SBk(zb)}}));this.d3j&&this.Nzb.Oyn();this.xzn()}).catch(()=>{})}Qll(){this.te.Fd(()=>{for(this.xdd.reset();this.Nzb.EHc&&!this.xdd.zJb();){var a=void 0;a=this.Nzb.uXk();if(!a||!a.graphNode){k.ULS.sendTraceTag(41719901,389,15,"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");this.xdd.update();continue}if(!this.jsn(a)){k.ULS.sendTraceTag(41719902,389,
50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",a.graphNode.id);this.xdd.update();continue}const d=a.graphNode.id.toString();let n;if(this.A_b.contains(d))switch(a.$Id){case 3:this.A_b.remove(d);n=3;break;default:n=a.$Id}else switch(a.$Id){case 0:case 1:this.A_b.add(d);n=0;break;case 2:this.A_b.add(d);n=0;break;case 3:this.A_b.remove(d);n=3;break;default:n=a.$Id}if(null!=n){const z=this.S$f(a.graphNode,n);this.Sda.submitOperation(Object.assign(new Na.a,{operation:z}));if(this.v3d&&
this.Ywa&&this.Ywa[0]==d)switch(n){case 3:this.Ywa=null;break;case 0:case 1:case 2:this.Ywa[1]=this.yFa.uwe(a.graphNode)}k.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",Gj.a.getTypeNameFor(z),d);switch(n){case 0:this.lg.LKm(a.graphNode);break;case 3:this.lg.MKm(a.graphNode)}}this.xdd.update()}(a=this.Nzb.vXk())&&this.Xpj(a)},"TV:FPEFO")}jsn(a){return 3===a.$Id||this.yFa.n4h(a.graphNode)}xzn(){!this.Xef&&this.Nzb.IAa&&(this.Xef=
new bf.a(4,2,this.va.jb("NodeEventsFiringInterval",500),Object(m.a)(this,this.Qll,"firePreparedEventsForOperations"),131),this.fb.rb(this.Xef))}zag(a){const d=new db.a;d.add("session");d.add("doc");12===a.type&&-1!==a.zla&&(a=Ea.a.twi(a.zla),d.add(a));return d}S$f(a,d){let n=null,z=null;const O=a.id.toString();var ca=null;3!==d&&(ca=this.yFa.eLk(a));if(ca)for(var Da=0;Da<ca.length;Da++)if(ca[Da].metadata.tileId===O){z=Da+1<ca.length?ca[Da+1].metadata.tileId:null;n=Da?ca[Da-1].metadata.tileId:null;
break}Da=this.yFa.qai(a);ca=this.zag(a);a=[Object.assign(new Sq.a,{body:Da,id:O,revId:this.yFa.iDi(a)})];switch(d){case 0:case 1:return Object.assign(new Jn.a,{parentPath:ca.toArray(),items:a,prevId:n,nextId:z});case 2:return Object.assign(new JC.a,{parentPath:ca.toArray(),items:a});case 3:return Object.assign(new Rp.a,{parentPath:ca.toArray(),items:a});default:return k.ULS.sendTraceTag(42084322,389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",d,O),Object.assign(new tQ.a,{parentPath:ca.toArray(),
items:a,prevId:n,nextId:z})}}MRl(a){return this.Ywa&&this.Ywa[0]===a?this.Ywa[1]:null}Jhn(a){if(!this.v3d)return k.ULS.sendTraceTag(545552581,389,10,"sendTile: autoreplace is not enabled"),!1;if(!this.yFa.n4h(a))return!1;const d=a.id.toString();var n=this.A_b.contains(d)?2:0;n=this.S$f(a,n);this.Sda.submitOperation(Object.assign(new Na.a,{operation:n}));this.A_b.add(d);this.Ywa=[d,this.yFa.uwe(a)];return!0}Sgn(a,d){if(this.v3d){var n=a.id.toString(),z=this.zag(a).toArray();d=[Object.assign(new tN,
{id:n,revId:this.yFa.iDi(a),parentPath:z,delta:d})];z=Object.assign(new CF,{parentPath:z,items:d});this.Sda.submitOperation(Object.assign(new Na.a,{R0n:z}));k.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",n);this.Ywa=[n,this.yFa.uwe(a)]}else k.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}wCa(a,d){if(d.zi&&d.zi.length){if(this.v3d)if(a=this.yFa.qHl(d.zi),!a)this.Ywa=null;else if(!this.Ywa||this.Ywa[0]!=a.id.toString()){const n=this.Nzb.X$l(a)?
null:this.yFa.uwe(a);this.Ywa=[a.id.toString(),n]}this.Huf&&(this.tUi()?this.Nzb.J0m(d.zi.Ba):this.Ryj(!1))}}YEk(a,d){if(a.tileReference.referencedPath.length!==d.tileReference.referencedPath.length||a.range.start!==d.range.start||a.range.length!==d.range.length)return!1;for(let n=0;n<a.tileReference.referencedPath.length;n++)if(a.tileReference.referencedPath[n]!==d.tileReference.referencedPath[n])return!1;return!0}XEk(a,d){if(a.selectedRanges.length!==d.selectedRanges.length||a.content!==d.content)return!1;
for(let n=0;n<a.selectedRanges.length;n++)if(!this.YEk(a.selectedRanges[n],d.selectedRanges[n]))return!1;return!0}Xpj(a){if(a){var d=new db.a,n="";for(let ca=0;ca<a.length;ca++){var z=a.J(ca),O=this.yFa.qai(z.node).content;n+=O;O=z.cpBegin<O.length?z.cpBegin:-1;O=Object.assign(new $M.a,{start:O,length:z.cpEnd-z.cpBegin});const Da=z.node.id.toString();z=this.zag(z.node);z.add(Da);d.add(Object.assign(new uN,{range:O,tileReference:Object.assign(new sN,{referencedPath:z.toArray()})}))}a=Object.assign(new DF,
{selectedRanges:d.toArray(),content:n});this.Elf&&this.XEk(a,this.Elf)||(d=this.$de?this.$de:E.a.create().toString(),n=[Object.assign(new Sq.a,{body:a,id:d})],this.$de?d=Object.assign(new JC.a,{parentPath:["session","doc"],items:n}):(this.$de=d,d=Object.assign(new Jn.a,{parentPath:["session","doc"],items:n})),this.Sda.submitOperation(Object.assign(new Na.a,{operation:d})),this.Elf=a)}}ton(a){this.tUi()&&this.Ryj(a)}Ryj(a){(this.Huf=a)?this.Xpj(this.Da.ya.Ba):this.Nzb.NSk()}tUi(){return this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableSendSelectionSignalToAugloop",
!1)}AGn(a){a=this.S$f(a,2);this.Sda.submitOperation(Object.assign(new Na.a,{operation:a}))}}Object(t.a)(vN,"TileView",null,[575]);class xH{constructor(){this.Z=null}get name(){return"Box4.AugmentationLoop"}Hb(a){this.Z=a;const d=this.Z.resolve("Common.IAppSettingsManager"),n=d.ea("AugLoopTaskUseTimeBasedYieldStrategy"),z=new pN,O=n?new qm(d.jb("AugLoopTaskAllowedRunTimeBeforeYielding",10),Ye.a.me):new YM(d.jb("AugLoopTaskNodesToRunBeforeYielding",10));this.Z.ha("Common.ICpuMeter",()=>Ln.a.instance).singleInstance();
this.Z.ha("Box4.AugmentationLoop.AugmentationLoopStateManager",()=>new hN).as("Box4.AugmentationLoop.IAugmentationLoopStateManager").singleInstance();this.Z.ha("Box4.AugmentationLoop.ParagraphNodeEventHandler",()=>new qN(d,Lb.App.jj.Cm.Oe(12),z,this.Z.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),
l.AFrameworkApplication.tb,this.Z.resolve("Box4.Intent.IIntentRangeEditor"),this.Z.resolve("Box4.IIntelligenceEditor"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.StatePersistencePolicyFix",!1),this.Z.resolve("Box4.Graph.IGraphTransactionManager"))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").singleInstance();this.Z.ha("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager",()=>new XM).singleInstance();this.Z.ha("Box4.AugmentationLoop.IFormattingExtractor",
()=>new vr(this.Z.resolve("Common.IAppSettingsManager"),this.Z.sa("Box4.IFeatureHelper"),this.Z.resolve("Box4.List.IListReader"),this.Z.resolve("Box4.IParagraphIndentationReader"),this.Z.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();this.Z.ha("Box4.AugmentationLoop.IAnnotationPolicies",()=>new qH.a(new Nf.a(()=>Lb.App.oa.za.jc.kd),this.Z.resolve("Box4.Intent.IIntentRangeEditor"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.StatePersistencePolicyFix",!1))).singleInstance();
this.Z.ha("Box4.AugmentationLoop.IPersistedAnnotationStorage",()=>new gt(this.Z.resolve("Common.ICpuMeter"),this.Z.resolve("Box4.IIntelligenceReader"),this.Z.resolve("Box4.IIntelligenceEditor"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),new Nf.a(()=>Lb.App.oa.za.jc.kd),a.resolve("Box4.IFeatureHelper"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.StatePersistencePolicyFix",!1))).singleInstance();this.Z.ha("Box4.AugmentationLoop.IAnnotationStorage",()=>
new Qi(this.Z.resolve("Common.IAppSettingsManager"),this.Z.resolve("Common.ICpuMeter"),this.Z.resolve("Box4.Intent.IIntentRangeEditor"),new Nf.a(()=>Lb.App.oa.za.jc.kd),l.AFrameworkApplication.tb,this.Z.sa("Box4.IIntelligenceReader"),this.Z.sa("Box4.IIntelligenceEditor"),this.Z.sa("Box4.AugmentationLoop.IAnnotationPolicies"),this.Z.sa("Box4.AugmentationLoop.IPersistedAnnotationStorage"),a.resolve("Box4.IFeatureHelper"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.StatePersistencePolicyFix",
!1),()=>{try{return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager()}catch(ca){return k.ULS.sendTraceTag(50935320,389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",ca),null}})).singleInstance();this.Z.ha("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AParagraphNode>",()=>new vN(d,z,l.AFrameworkApplication.tb,O,this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Common.ICpuMeter"),new sQ.a(this.Z.resolve("Box4.AugmentationLoop.IFormattingExtractor")),
this.Z.resolve("Box4.ISelectionManager"))).singleInstance();k.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.Z.ha("Box4.AugmentationLoop.IUtilsWrapper",()=>new lN).singleInstance();this.Z.ha("Box4.AugmentationLoop.IAlFactoryWrapper",()=>new kN).singleInstance()}init(){if(l.AFrameworkApplication.K.ea("AugLoopOperationsAreEnabled")){k.ULS.sendTraceTag(35190237,389,50,"Initializing Box4 Augmentation Loop package.");const a=new ur(this.Z.resolve("Common.IAppSettingsManager"),
l.AFrameworkApplication.Gd,Lb.App.Eoa,this.Z.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),Xf.a.instance,this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage")),d=new ZM;this.Z.register(566,"Box4.AugmentationLoop.IAlSessionLifeEventNotifier").singleInstance().qRj(()=>d);const n=Ea.a.mlm(this.Z.resolve("Common.IDynamicScriptLoaderProvider").uG,this.Z.resolve("Common.App.OAuth.IOAuthManager"),this.Z.Ca("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AParagraphNode>"),
a,this.Z.resolve("Common.ISharedDependencyLoader"),d);this.Z.ha("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new jN(n)).singleInstance();this.Z.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler").init();this.Z.resolve("Box4.IIntelligenceReader").init();this.Z.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AParagraphNode>")}}dispose(){}static main(){M.a.instance.Sb(new xH);k.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}
Object(t.a)(xH,"Box4AugmentationLoopPackage",null,[1,2]);var EF=b(460),vQ=b(1479);class iE{constructor(a,d,n,z=null,O=null,ca=null){this.HU=new vQ.a(d,z,O,ca);this.Wa=a;this.Db=n}get type(){return this.HU.type}get id(){return this.HU.id}get jt(){return this.HU.jt}Xc(a){return new iE(a,this.type,this.Db,this.id,this.jt,this.HU.eta)}toString(){return String.format("Core = [{0}], IsStart = {1}",this.HU,this.Db)}}Object(t.a)(iE,"IntentObject",null,[181]);var wN=b(469);class aC{constructor(){this.v1c=
new me.a}fie(a,d,n,z,O=null,ca=null,Da=null){a=a.Vaa(d,a.ja.IPf(d));a.Eg||(a.Eg=new wN.a(a));a.Eg.add(new iE(a,n,z,O,ca,Da));a.isFromErrorRangeSplit=!0}lnj(a){return a.Wa&&a.Wa.Eg&&a.Wa.Eg.zQc(d=>d===a,[a.type])?!0:!1}E6m(a,d){if(a.type===d.type&&a.Db&&!d.Db&&a.Wa&&a.Wa.Eg&&a.Wa.Eg.contains(a)&&d.Wa&&d.Wa.Eg&&d.Wa.Eg.contains(d)){var n=[a.type];a.Wa.Eg.zQc(z=>z===a,n);d.Wa.Eg.zQc(z=>z===d,n)}}VQn(a,d,n){if(!d)return!1;n=new BF.a([n]);for(let z=0;z<a.length;z++){const O=a.J(z);if(!O.Eg)continue;let ca=
!0;n.FZa(O.Eg,void 0,Da=>{Da.id&&d.equals(Da.id)&&(ca=!1)});if(!ca)return!1}return!0}WSm(a,d,n,z){let O=null,ca=null;d=new BF.a([d]);const Da=a.ja;for(let Xa=0;Xa<Da.length;Xa++){const zb=Da.J(Xa);if(!zb.Eg)continue;let Vb=!0;d.FZa(zb.Eg,void 0,(Fc,Yc)=>{if(Yc){var yd=Yc.Wa.cp<n,je=Fc.Wa.cp>z;yd&&Fc.Wa.cp<=n||Yc.Wa.cp>=z&&je||(yd&&je?Vb=!1:yd?O=Fc:je?ca=Yc:this.E6m(Yc,Fc))}});if(!Vb)return!1}if(O){if(!this.lnj(O))return!1;this.fie(a,n,O.type,O.Db,O.id,O.jt,O.HU.eta)}if(ca){if(!this.lnj(ca))return!1;
this.fie(a,z,ca.type,ca.Db,ca.id,ca.jt,ca.HU.eta)}return!0}k4g(a){let d;return({value:d}=this.v1c.Ab(a.type,d)).returnValue?d.k4g(a):!0}Ztm(a,d){if(this.k4g(d)){var n=d.id,z=d.type,O=d.begin,ca=d.end;if(({cpEnd:ca}=aC.GRj(a,O,ca)).returnValue){if(EF.a(z)){if(!this.VQn(a.ja,n,z))return}else if(!this.WSm(a,z,O,ca))return;this.fie(a,O,z,!0,n,d.jt,d.HU.eta);this.fie(a,ca,z,!1,n,d.jt,d.HU.eta)}}}SQe(a,d){Lb.App.oa.Lse(a,()=>{const n=new Ff.GraphTransaction(2);try{n.Sa(a);const z=a.oT();try{const O=a.WR();
try{d()}finally{O&&O.dispose()}}finally{z&&z.dispose()}}finally{n&&n.dispose()}})}nMc(a,d){this.SQe(a,()=>{this.Ztm(a,d)})}aum(a,d){if(d.count){var n=new ra.a,z=new hn.a;for(var O of d){var ca=O.value;EF.a(O.key)||ca.Sc((Xa,zb)=>Xa.begin!==zb.begin?Xa.begin-zb.begin:Xa.end-zb.end);if(aC.ZQn(ca))for(var Da of ca)ca=Da.end,({cpEnd:ca}=aC.GRj(a,Da.begin,ca)).returnValue&&(ca=ca!==Da.end?new cD.a(Da.type,Da.begin,ca,Da.id,Da.jt,Da.HU.eta):Da,n.add(ca.begin),n.add(ca.end),aC.mvk(z,ca))}a.x7b(n);a=a.ja;
for(n=0;n<a.length;n++){O=a.J(n);if(Da=O.Eg)for(const zb of d.keys)Da.DUg(zb);let Xa;({value:Xa}=z.Ab(O.cp,Xa)).returnValue||(Xa=null);if(Xa){Da||(Da=O.Eg=new wN.a(O));for(const zb of Xa)Da.add(zb.Xc(O))}O.isFromErrorRangeSplit=!0}}}ezg(a,d){const n=new me.a;for(const z of d){let O;({value:O}=n.Ab(z.type,O)).returnValue||(O=new db.a,n.$(z.type,O));O.add(z)}this.SQe(a,()=>{this.aum(a,n)})}tJn(a,d){a=a.ja;for(let n=0;n<a.length;n++){const z=a.J(n);z.Eg&&z.Eg.DUg(d)}}d_d(a,d){this.SQe(a,()=>{this.tJn(a,
d)})}sJn(a,d,n){let z=!1;d=d.ja;n=[n];for(let O=0;O<d.length;O++){const ca=d.J(O);ca.Eg&&(z=ca.Eg.zQc(a,n)||z)}return z}Bch(a,d,n){let z=!1;this.SQe(d,()=>{z=this.sJn(a,d,n)});return z}Yyi(a,d,n,z){return!a||0>n||z>a.characterData.length||n>z?new db.a:this.Nlb(a,d,O=>Math.max(O.begin,n)<=Math.min(O.end,z))}Nlb(a,d,n){const z=new db.a;a=a.ja;d=new BF.a([d]);for(let O=0;O<a.length;O++){const ca=a.J(O);ca.Eg&&d.FZa(ca.Eg,void 0,(Da,Xa)=>{Xa&&(Da=new cD.a(Xa.type,Xa.Wa.cp,Da.Wa.cp,Xa.id,Xa.jt,Xa.HU.eta),
n(Da)&&z.add(Da))})}return z}Xud(a,d){const n=new db.a;if(!aC.hhm(a.contextId))return n;let z;const O=a.node;a.contextId!==Kb.a.paragraph?(z=a.cpBegin,a=a.cpEnd):(z=0,a=O.characterData.length);n.addRange(this.Yyi(O,d,z,a));return n}w3m(a){this.v1c.Na(0)||this.v1c.$(0,a)}static GRj(a,d,n){a=Bd.ParagraphReader.textLength(a);if(d>=a)return{returnValue:!1,cpEnd:n};n>a&&(n=a);return{returnValue:!0,cpEnd:n}}static ZQn(a){if(!a.count)return!0;const d=new hl.a,n=a.J(0).type,z=EF.a(n);let O=-1;for(const ca of a){if(ca.type!==
n||(EF.c(ca.type)?ca.begin>ca.end:ca.begin>=ca.end))return!1;if(z){a=ca.id;if(!a||a.equals(E.a.nil)||d.contains(a))return!1;d.add(a)}else if(-1===O)O=ca.end;else if(O>ca.begin)return!1}return!0}static mvk(a,d){let n;({value:n}=a.Ab(d.begin,n)).returnValue||(n=new db.a,a.$(d.begin,n));n.add(new iE(null,d.type,!0,d.id,d.jt,d.HU.eta));({value:n}=a.Ab(d.end,n)).returnValue||(n=new db.a,a.$(d.end,n));n.add(new iE(null,d.type,!1,d.id,d.jt,d.HU.eta))}static hhm(a){return a===Kb.a.Lc||a===Kb.a.Ub||a===Kb.a.paragraph}}
Object(t.a)(aC,"IntentRangeEditor",null,[576]);class yH{constructor(){this.Z=null}get name(){return"Box4.Intent"}Hb(a){this.Z=a;this.Z.ha("Box4.Intent.IntentRangeEditor",()=>new aC(this.Z.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.Intent.IIntentRangeEditor").singleInstance()}init(){this.Z.resolve("Box4.IProofingManager")}dispose(){}static main(){M.a.instance.Sb(new yH)}}Object(t.a)(yH,"PackageManager",null,[1,2]);var fw=b(1222);class zH{constructor(a){this.Esm=a;this.Asm=[]}get handler(){return this.Esm}get o7(){return this.Asm}}
Object(t.a)(zH,"RegisteredListener",null,[]);class iA{constructor(a,d){this.type=0;this.payload=null;this.type=a;this.payload=d}}Object(t.a)(iA,"OfficeSharedCommentsEvent",null,[831]);class FF{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(t.a)(FF,"ViewContainerEvent",null,[831]);class jE{constructor(a){this.tyg=!1;this.BBa=new db.a;this.Nsm=a}f3m(a){a=new zH(a);this.BBa.add(a)}SMj(a){for(let d=0;d<this.BBa.count;++d)if(this.BBa.J(d).handler===
a){this.BBa.removeAt(d);break}}N8a(a=!1){const d=()=>{if(l.AFrameworkApplication.mi)k.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let O=0;O<this.BBa.count;++O){const ca=this.BBa.J(O);for(;0<ca.o7.length;){var n=Array.dequeue(ca.o7);if(Object(Uc.a)(FF,n)){var z=ca.handler;z(n)}else Object(Uc.a)(iA,n)&&(z=ca.handler,z(n.type,n.payload))}}};a?d():this.tyg||(this.tyg=!0,ao.a.oaa(this.Nsm,()=>{d();this.tyg=!1},fw.a.nnl))}}Object(t.a)(jE,
"GenericEventHost",null,[]);class bC{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.contextDrafts=this.smartReplies=null}}Object(t.a)(bC,"BasicEventPayload",null,[867]);class AH{constructor(a){this.nextPopulatedContextDetails=0;this.commentThreadCounts=
null;this.isReadOnly=!1;this.isReadOnly=a}}Object(t.a)(AH,"CommentContextDetails",null,[]);class wQ{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.contextDrafts=null}}Object(t.a)(wQ,"ContextChangeWithSelectedThreadIndex",null,[867]);class xN{constructor(){this.tasks=this.comments=null}}Object(t.a)(xN,"LoadCommentsNoVirtualization",null,[867]);class yN extends jE{constructor(a){super(a);this.hMh=0}Snn(a){this.hMh=
a}D3m(a,d,n,z,O,ca){a=new zH(a);ca&&Array.enqueue(a.o7,this.A_k(ca,this.hMh));ca=d?d.length:0;Array.enqueue(a.o7,this.Hbi(ca,n,z,0));ca&&Array.enqueue(a.o7,this.xci(d,O));this.BBa.add(a);this.N8a()}qVc(a){this.SMj(a)}Ogn(a,d,n,z=0){this.jbc(this.Hbi(a,d,n,z,null));this.N8a()}Pgn(a,d,n){this.jbc(this.Z_k(a,d,n));this.N8a()}ehn(a,d){this.jbc(this.xci(a,d));this.N8a()}selectComment(a){this.jbc(this.tdi(a,6));this.N8a()}highlightComment(a){this.jbc(this.tdi(a,7));this.N8a()}$dh(a,d){this.jbc(this.F2k(a,
d));this.N8a()}jNg(a,d){this.jbc(this.t4k(a,d));this.N8a()}A_k(a,d=0){const n=new bC;n.modelCapabilityFlags=a;n.richTextCapabilityFlags=d;return new iA(12,n)}Hbi(a,d,n,z,O=null){const ca=new bC;ca.numberOfComments=a;ca.numberOfThreads=d;ca.contextDetails=Object.assign(new AH(n),{nextPopulatedContextDetails:z});ca.contextDrafts=O;return new iA(0,ca)}Z_k(a,d,n){const z=new bC;z.comments=a;z.numberOfThreads=d;z.tasks=n;return new iA(2,z)}xci(a,d){const n=new xN;n.comments=a;n.tasks=d;return new iA(1,
n)}tdi(a,d){const n=new bC;n.commentId="";a&&(n.commentId=a);return new iA(d,n)}F2k(a,d){const n=new bC;n.changes=[];n.contextDetails=Object.assign(new AH(d),{nextPopulatedContextDetails:a});return new iA(10,n)}t4k(a,d){const n=new bC;n.commentId=a;n.smartReplies=d;return new iA(15,n)}jbc(a){for(let d=0;d<this.BBa.count;++d)Array.enqueue(this.BBa.J(d).o7,a)}}Object(t.a)(yN,"OfficeSharedCommentsEventHost",jE,[856]);class zN{constructor(){this.muf=this.znh=!1;this.cP=this.Wm=this.Yzh=this.yEh=this.Zge=
this.wvc=this.DPh=this.vrh=this.uG=this.nee=null}initialize(a,d,n,z=null,O=null,ca=null,Da=null,Xa=null,zb=null){this.uG=a;this.vrh=d;this.DPh=n;this.wvc=z;this.Zge=O;this.yEh=ca;this.Yzh=Da;this.Wm=Xa;this.znh=!0;this.cP=zb}G7k(){sharedComments.setWebpackPublicPath(l.AFrameworkApplication.BQ)}lEe(a=null){if(!this.znh)return k.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((d,n)=>{n(ao.a.TG(-2130915313))});if(this.muf)return k.ULS.sendTraceTag(41424204,
201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>{});this.nee||(l.AFrameworkApplication.K.ea("DynamicBundlesIsEnabled")?this.nee=appResourceLoader.loadChunk("sharedComments"):this.nee=this.uG.loadScript("sharedComments"));return this.nee.then(()=>{a?a():this.G7k();this.muf||(this.cP&&this.cP.execute(d=>{d.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),sharedComments.instantiate(this.vrh,
this.DPh,this.wvc,this.Zge,this.yEh,this.Yzh,this.Wm));this.muf=!0})}}Object(t.a)(zN,"CommentActivationManager",null,[899]);class AN extends jE{constructor(a){super(a)}U4m(a){this.f3m(a)}YJn(a){this.SMj(a)}Azj(a){a=this.V_k(a);for(let d=0;d<this.BBa.count;++d)Array.enqueue(this.BBa.J(d).o7,a);this.N8a(!0)}V_k(a){const d=new FF;d.eventType=3;d.viewContainerVisibilityState=a;return d}Mnl(){const a=this.i5k();for(let d=0;d<this.BBa.count;++d)Array.enqueue(this.BBa.J(d).o7,a);this.N8a(!0)}i5k(){const a=
new FF;a.eventType=2;return a}}Object(t.a)(AN,"ViewContainerEventHost",jE,[821]);class BN{constructor(){this.actionBehavior=this.actionType=0}}Object(t.a)(BN,"CommentUIActionPayload",null,[]);class CN{constructor(a,d){this.ga=a;this.$Pb=d;this.lXc=new tb.a;for(let n of this.$Pb)this.lXc.$(n.value.canvasActionId,n.key),a=n.value,a.delayActionsUntilRegistration||this.ma(a)}ma(a){a.withFlags?this.ga.Aa(a.canvasActionId,a.canvasContextId,Object(m.a)(this,this.dTh,"actionHandler"),97):this.ga.ma(a.canvasActionId,
a.canvasContextId,Object(m.a)(this,this.dTh,"actionHandler"))}Oca(a,d){this.$Pb.Na(a)&&(this.$Pb.J(a).delayActionsUntilRegistration&&this.ma(this.$Pb.J(a)),this.$Pb.J(a).registeredCallback=d)}dTh(a,d,n,z,O){if(this.lXc.Na(a)){var ca=this.lXc.J(a);if(!this.$Pb.Na(ca))return 8;const Da=this.$Pb.J(ca);if(Da.preCallback){const Xa=Da.preCallback(a,d,n,z,O);if(2!==Xa)return Xa}if(!Da.registeredCallback)return 1===n?8:2;ca=Object.assign(new BN,{actionType:ca});1===n&&(ca.actionBehavior=1);ca=Da.registeredCallback(ca);
return Da.postCallback?Da.postCallback(ca,a,d,n,z,O):ca?32:8}return 2}}Object(t.a)(CN,"OfficeSharedCommentsActionHost",null,[858]);var xQ=b(1282),yQ=b(282),BH=b(1381),DN=b(459);class kE{constructor(a){this.uea=a;this.VOc=new cg.a;this.enb=new cg.a;this.C3l();this.C_l=[new zn.a(Ji.a.L8h,Ji.a.pVk),new zn.a(Ji.a.K8h,Ji.a.oVk),new zn.a(Ji.a.F8h,Ji.a.iVk),new zn.a(Ji.a.E8h,Ji.a.hVk),new zn.a(Ji.a.N8h,Ji.a.rVk),new zn.a(Ji.a.M8h,Ji.a.qVk)]}gsb(a){this.uea.gsb(a);this.U5m(a)}uqg(a,d){return!!a&&!!a.objectId&&
d.contains(E.a.qe(a.objectId))}rpb(a){a=Object(qa.a)(693,a);return!!a&&!!a.objectId}U5m(a){for(let d of this.C_l)a.classList.remove(d.className,d.Mxd);a.classList.remove(Ji.a.PMg,Ji.a.P8h,Ji.a.G8h,Ji.a.O8h,kE.Fjh)}C3l(){const a=new cg.a,d=new cg.a;a.add(0,null);a.add(1,Ji.a.K8h);a.add(2,Ji.a.L8h);a.add(3,Ji.a.P8h);d.add(0,null);d.add(1,Ji.a.E8h);d.add(2,Ji.a.F8h);d.add(3,Ji.a.G8h);this.enb.$(1,a);this.enb.$(2,d);this.enb.$(3,d);this.VOc.add(0,null);this.VOc.add(1,Ji.a.M8h);this.VOc.add(2,Ji.a.N8h);
this.VOc.add(3,Ji.a.O8h)}}kE.Fjh="CommentImportant";Object(t.a)(kE,"CommentHighlightUtils",null,[]);class CH{constructor(){this.ose=0;this.Y4b=null}}Object(t.a)(CH,"CommentGuidsInElementInfo",null,[]);class EN{constructor(){this.kJi=!1;this.vya=this.Ygc=null;this.L7a=this.fac=0}}Object(t.a)(EN,"HighlightInfoForElement",null,[]);class DH{constructor(){this.qMi=this.sMi=this.rMi=-1;this.uKi=[];this.XAc=[];this.Lzd=this.Mzd=-1;this.cQi=!1}}Object(t.a)(DH,"HighlightInfoForElementsInPara",null,[]);class FN{constructor(){this.zch=
this.cIg=null}}Object(t.a)(FN,"OnAnchorMouseOutData",null,[]);var zQ=b(156),GN=b(744);class lE{constructor(){this.Gnh=null;this.W7=!1;this.ngc=this.dDb=null;this.EH=new ia.a(new Wk.a);this.Cca=new ia.a(new Wk.a);this.WQg=this.Bac=!1}get xq(){return GN.a.xq}set xq(a){GN.a.xq=a}get FBb(){return this.Gnh}set FBb(a){this.Gnh=a}}lE.Cl=1;Object(t.a)(lE,"CommentsState",null,[]);class ti{static get SFe(){void 0===ti.tjf&&(ti.tjf=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfImprovedCommentStartElementRetrieval",
!1));return ti.tjf}static get B4h(){if(void 0===ti.H$e){let a;try{a=CSS.supports("selector(:not(* *))")}catch(d){a=!1}a||k.ULS.sendTraceTag(526263553,324,15,"Cannot use complex CSS selector in CommentHelpers, falling back to less performant alternative");ti.H$e=a}return ti.H$e}static lxd(){return ti.PT||(ti.PT=new Wk.a)}static Drg(a){return!!a&&!!a.Lg}static ypg(a,d,n,z){if(!a||!a.objectId)return!1;const O=n.Ta(E.a.qe(a.objectId)),ca=Xj.a.RGc(O,!0),Da=Xj.a.RGc(O,!1);if(!ca||!Da||ca===Da&&ca!==d||
!Bd.ParagraphReader.TDd(d,ca,Da))return!1;a=!0;var Xa=!1;ca===d&&(Xa=Xj.a.Sla(O,n,!0),a=a&&!!Xa&&Xa.Wa.cp<=z,Xa=!!Xa&&Xa.Wa.cp===z);d===Da&&(d=Xj.a.Sla(O,n,!1),a=a&&!!d&&d.Wa.cp>z,Xa=Xa&&!!d&&d.Wa.cp===z);return a||Xa}static z4a(a){if(!a)return null;a=Ag.a.Ta(a,Ji.a.nld);return null!==a&&void 0!==a?a:[]}static dvi(a){return a?Ag.a.Ta(a,Ji.a.Kne):null}static Q1l(a,d){if(!a)return-1;for(let n=0;n<a.length;n++)if(a[n].KOc.equals(d))return n;return-1}static P1l(a,d){if(!a)return-1;for(let n=0;n<a.length;n++)if(a[n].tOi.equals(d))return n;
return-1}static Wzc(a){return`Comment Object Id: ${a.objectId}`}static gvi(a=!1){var d=document.getElementById(og.AppFrame.VDa);if(ti.SFe)return ti.hvi(d,a);d=d.getElementsByClassName("ParaWrappingDiv");const n=[];for(let z=0;z<d.length;z++)ti.G6f(d[z],n,a);return n}static cyi(){var a=document.getElementById(og.AppFrame.VDa);if(ti.SFe)return ti.ZBl(a);const d=[];if(!ti.GEd)return d;a=a.getElementsByClassName("ParaWrappingDiv");for(let n=0;n<a.length;n++)ti.dyi(a[n],d);return d}static ZBl(a){return ti.GEd?
Array.from(a.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart")):[]}static G6f(a,d,n=!1){if(ti.SFe)d.push(...ti.hvi(a,n));else{var z=a.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart"),O=[];n&&ti.dyi(a,O);for(a=0;a<z.length;a++)-1===O.indexOf(z[a])&&d.push(z[a])}}static hvi(a,d){if(d&&ti.GEd){if(ti.B4h)return Array.from(a.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)"));
d=a.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart");const n=d.length;if(0<n){a=a.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart");const z=[];let O=0;for(let ca=0,Da=a.length;ca<Da;ca++){const Xa=a[ca];O<n&&d[O]===Xa?++O:z.push(Xa)}return z}}return Array.from(a.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart"))}static vYl(a){if(a.nn){for(let d of a.Oh.Bj)if(this.$fg(d))return!0;
return!1}return this.$fg(a.htmlElement)}static $fg(a){if(ti.SFe)return ti.uYl(a);const d=[];ti.G6f(a,d,!0);return 0<d.length}static uYl(a){if(ti.GEd){if(ti.B4h)return!!a.querySelector(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)");const d=a.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart").length;if(0<d)return d!==
a.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart").length}return!!a.querySelector(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart")}static RKc(a){return!!a&&!!a.fa(Qb.a.cK,null)}static YAi(){const a=new Set,d=this.cyi();for(let n=0;n<d.length;n++)ti.z4a(d[n]).forEach(z=>{a.add(z.toString())});return a}static dyi(a,d){if(ti.GEd){a=a.querySelectorAll(`.${zQ.a.CDa} .${Ji.a.mld}`);for(let n=0;n<a.length;n++)d.push(a[n])}}static get GEd(){return 0===
lE.Cl}}ti.PT=null;ti.h7k="CommentDeeplinkNotFound";ti.Zrj=[Box4Intl.Box4Strings.l_HK_Bold,Box4Intl.Box4Strings.l_HK_Bold_Mac,Box4Intl.Box4Strings.l_HK_Italic,Box4Intl.Box4Strings.l_HK_Italic_Mac,Box4Intl.Box4Strings.l_HK_Underline,Box4Intl.Box4Strings.l_HK_Underline_Mac];ti.tjf=void 0;ti.H$e=void 0;Object(t.a)(ti,"CommentHelpers",null,[]);class HN{constructor(a,d,n,z,O,ca,Da,Xa){this.Naf=a;this.Gia=d;this.mk=n;this.vJ=z;this.ga=O;this.fb=ca;this.xf=Da;this.Odb=this.Fj=null;Xa.execute(zb=>{this.Fj=
zb})}j2h(a,d,n,z){const O=new DH,ca=[],Da=this.Gia.rpb(d)?d.objectId:null;for(let Vb=0,Fc=a.length;Vb<Fc;Vb++){var Xa=a[Vb],zb=ti.z4a(Xa);const Yc=ti.dvi(Xa);Xa=new hl.a;const yd=new EN;if(zb){const je=new DN.a(ti.lxd());zb=this.Sni(zb,Da,je);0<zb.length&&(this.EMn(zb,n,Xa,yd,Da,z),ca.push(Object.assign(new CH,{ose:Vb,Y4b:je})))}Yc&&(zb=this.Sni(Yc,Da),0<zb.length&&(this.GMn(zb,n,Xa,yd,O,Da,z,Vb),this.yLn(ca,zb,Vb,yd)));0<n.count&&this.HMn(d,n,yd,z);this.xLn(ca,yd);O.uKi.push(yd)}return O}YYh(a,d,
n){let z=!1;for(let O=0,ca=a.length;O<ca;O++){const Da=a[O],Xa=d.uKi[O],zb=kn.a(Da);if(1!==zb&&2!==zb&&3!==zb)continue;const Vb=3===zb||2===zb&&-1!==Da.className.indexOf(Ji.a.uac);this.Gia.gsb(Da);this.Xvk(Da,Xa,Vb,z);this.bvk(Da,O,zb,Xa,d,n);this.cvk(Da,O,d,Xa);z=Vb}}Sni(a,d,n=null){const z=[];for(let O=0;O<a.length;O++)this.Naf.yAj(a[O],a[O].toString()===d)&&(z.push(a[O]),n&&n.add(a[O]));return z}EMn(a,d,n,z,O,ca){var Da;let Xa=!1,zb=!1;for(let Fc of a){d.add(Fc);n.add(Fc);var Vb=Fc.toString();
Vb===O?(Vb=ca?1:2,z.L7a=Vb,z.fac=Vb):this.uqg(this.Fj.yD,d)&&(Vb===(null===(Da=this.Fj.yD)||void 0===Da?void 0:Da.objectId)&&(zb=!0),Xa=!0)}0<a.length&&!z.L7a&&(z.L7a=zb?1:3,z.fac=Xa?1:3)}GMn(a,d,n,z,O,ca,Da,Xa){var zb,Vb;const Fc=new DN.a(ti.lxd());Da=Da?1:2;let Yc=!1;for(let yd of a){const je=yd.toString();d.contains(yd)||(je===ca?O.qMi=Xa:(O.rMi=Xa,z.L7a=3,(null===(zb=this.Fj.yD)||void 0===zb?void 0:zb.objectId)===je&&(O.sMi=Xa,z.L7a=1)),Fc.add(yd));je===(null===(Vb=this.Fj.yD)||void 0===Vb?void 0:
Vb.objectId)&&(Yc=!0);d.remove(yd);n.contains(yd)&&this.FMn(z,yd,je,ca,Da);je===ca&&(z.L7a=Da)}0<a.length&&!z.L7a&&(z.L7a=Yc?1:3);0<Fc.count&&O.XAc.push(Object.assign(new CH,{ose:Xa,Y4b:Fc}))}yLn(a,d,n,z){0!==a.length&&(d.forEach(O=>{for(let ca=a.length-1;0<=ca;ca--){const Da=a[ca];if(Da.Y4b.contains(O)){Da.ose===n&&(z.vya?z.vya.push(O):z.vya=[O]);Da.Y4b.remove(O);break}}}),a=a.filter(O=>0<O.Y4b.count))}HMn(a,d,n,z){var O,ca;this.uqg(a,d)?n.fac=z?1:2:n.fac||(n.fac=null!=(null===(O=this.Fj.yD)||void 0===
O?void 0:O.objectId)&&d.contains(E.a.qe(null===(ca=this.Fj.yD)||void 0===ca?void 0:ca.objectId))?1:3);n.Ygc||(n.Ygc=[]);for(let Da of d)n.Ygc.push(Da)}xLn(a,d){if(0<a.length){d.vya||(d.vya=[]);for(let n of a[a.length-1].Y4b)d.vya.push(n)}}FMn(a,d,n,z,O){a.kJi=!0;a.Ygc||(a.Ygc=[]);a.Ygc.push(d);n===z&&(a.fac=O)}uqg(a,d){return!!a&&!!a.objectId&&d.contains(E.a.qe(a.objectId))}Xvk(a,d,n,z){!d.L7a||n||z||((n=this.Gia.VOc.J(d.L7a))&&a.classList.add(n),d.kJi&&a.classList.add(Ji.a.PMg))}bvk(a,d,n,z,O,ca){z=
this.Gia.enb.J(n).J(z.fac);d<O.qMi?z=ca?this.Gia.enb.J(n).J(1):this.Gia.enb.J(n).J(2):d<O.rMi&&!z&&(z=d<O.sMi?this.Gia.enb.J(n).J(1):this.Gia.enb.J(n).J(3));z&&(d=O.cQi,a.classList.add(z),d&&a.classList.add(kE.Fjh))}cvk(a,d,n,z){z.vya||(z.vya=this.dvl(d,n)||z.Ygc);d=null;z.vya&&0<z.vya.length&&(this.mk.Ea(vb.a.jM,a,Object(m.a)(this,this.GDm,"onCommentAnchorMouseOver"),z.vya),this.mk.Ea(vb.a.IY,a,Object(m.a)(this,this.FDm,"onCommentAnchorMouseOut"),z.vya),d=z.vya[0]);this.mk.Ea(vb.a.click,a,Object(m.a)(this,
this.R8i,"onCommentAnchorClick"),d);this.mk.Ea(vb.a.vx,a,Object(m.a)(this,this.R8i,"onCommentAnchorClick"),d)}dvl(a,d){for(;0<d.XAc.length&&d.XAc[0].ose===a;)d.XAc.splice(0,1);if(0<d.XAc.length){a=[];for(let n of d.XAc[0].Y4b)a.push(n);return a}return null}GDm(a){if(!this.Fj||this.vJ.hKc)return!0;if(a=a.Dm){if(this.Fj.yD&&a[0].toString()===this.Fj.yD.objectId)return!0;this.Odb&&a[0].equals(this.Odb.zch[0])?this.fb.ie(this.Odb.cIg):(this.Odb&&(this.fb.ie(this.Odb.cIg),this.ga.ob(Sa.a.kld,2,this.Odb.zch)),
this.Fj.cS.dQi(a[0])&&!this.xf.xq||this.ga.ob(Sa.a.Lne,2,a));this.Odb=null}return!0}FDm(a){if(this.vJ.hKc)return!0;const d=a.Dm;d&&(a=new bf.a(2,1,0,()=>{this.ga.ob(Sa.a.kld,2,d);this.Odb=null}),this.fb.rb(a),this.Odb=Object.assign(new FN,{cIg:a,zch:d}));return!0}R8i(a){const d=new bf.a(2,1,0,()=>{if(this.Fj&&!this.Fj.cS.ZL){var n=a.Dm;if(!n)n=Lb.App.oa.Zh.Zd,this.Fj.yD&&(!n||n.name!==Ec.AFrame.IP&&n.name!==Ec.AFrame.Zs)&&this.Fj.clearSelection();else if(!this.Fj.yD||n.toString()!==this.Fj.yD.objectId)if(n=
this.Fj.cS.jba(n.toString()))n=Object.assign(new ew.a,{commentId:n.id,p5:!1,doa:1}),this.ga.ob(Dc.a.selectComment,2,n)}});this.fb.rb(d);return!1}}Object(t.a)(HN,"AllMarkupModeHighlightChangeHandler",null,[688]);var IN=b(1273);class JN extends IN.a{constructor(a){super(100,25);this.kXc=new cg.a(0);this.i2j=6E4;this.pQb=new db.a;this.pQb.add(1);this.pQb.add(6);this.pQb.add(2);this.pQb.add(4);this.pQb.add(10);this.pQb.add(11);this.xe=a;a.MRg&&window.setInterval(Object(m.a)(this,this.knl,"flushAggregatedActions"),
this.i2j)}lXa(a){this.xe.DIn&&this.xe.MRg&&(this.pQb.contains(a)?this.J_m(a):this.sKa(a+""))}J_m(a){this.kXc.$(a,this.kXc.VA(a,0)+1)}knl(){const a=this.kXc.keys;if(a.length){var d="";for(let n=0;n<a.length;n++)d+=a.J(n)+":"+this.kXc.J(a.J(n))+";";this.sKa(d);this.kXc=new cg.a(0)}}}Object(t.a)(JN,"CommentActionInTypingRecorder",IN.a,[696]);class KN{static S6m(a){a&&a.atmention&&delete a.atmention.isCurrentUser;return a}}Object(t.a)(KN,"DeltaFormatHelpers",null,[]);class EH{constructor(){this.optional=
this.attributes=null}}Object(t.a)(EH,"Operation",null,[]);class FH extends EH{constructor(){super();this.insert=null}}Object(t.a)(FH,"DeltaOperation",EH,[]);class LN{constructor(){this.ops=null}}Object(t.a)(LN,"Delta",null,[]);var MN=b(417),GH=b(1038),HH=b(1586);class cC extends HH.ACommentFormatTranslator{constructor(a,d){super(a);this.Xb=d}hah(a){const d=new zv.a;for(let n=0;n<a.length;n++){const z=a[n];z.Ebc=!0;this.FCk(d,z);d.FIa("\n")}return[d.Rtd()]}yEn(a,d){a=zv.a.Mwe(a[0]);a=this.pTm(a);const n=
new db.a;let z=0,O=null,ca=null;for(;z<a.ops.length;){const Da=a.ops[z];O||(O=GH.a.instance.createInstance(393230),O.Ebc=!0,O.lf(Qb.a.Ob,gf.a.HH()),d(O),O.ja.clear(),O.qM(""));"\n"===Da.insert?(ca=this.XLc(O,ca),this.Bpn(O),n.add(O),O=null):ca=this.Rlm(O,Da,ca);z++}return n.toArray()}Bpn(a){if(uf.a.instance.J(6)){var d=a.H3h();for(let n=0;n<d;n++)a.wordRunProperties.Qo.$(n,cC.mzm),a.wordRunProperties.ir.$(n,cC.hEg)}}XLc(a,d){var n=a.T3();n.cp===a.characterData.length?n.Le=!0:(n=Object.assign(new OA.a(a,
a.characterData.length),{Le:!0}),a.ja.add(n));n=a.ja.last;if(d){d=!!d.Xs;const z=this.Y9h(a,n,!d,d,null);n.formatting=z;d&&(a=this.X9h(a,n),n.Wz=a.ng);n.Wh=!0;d=null}n.cp||n.formatting||(n.formatting=new qy.a(n,E.a.nil));return d}Rlm(a,d,n){const z=a.T3(),O=!!d.attributes&&!!d.attributes.link,ca=!!d.attributes&&!!d.attributes.atmention,Da=this.Y9h(a,z,O,ca,d);z.formatting=Da;n&&(n.Xs&&(n=this.X9h(a,z),z.Wz=n.ng),z.Wh=!0,n=null);if(O||ca)this.cKe(z,a,d),n=z.hyperlink;a.qM(a.characterData+d.insert);
return n}X9h(a,d){d=new qy.a(d,E.a.create());let n=this.Cpe();n.setValue(Qb.a.h6a,!0);n=a.Ib.$S(n);d.ng=n.id;return d}Y9h(a,d,n,z,O){d=new qy.a(d,E.a.create());let ca=GH.a.instance.createInstance(1179649);if(n||z)ca.setValue(Vd.a.av,!0),ca.setValue(Vd.a.ES,!0),n&&this.mjn(a,ca);this.xe.x3b&&O&&O.attributes&&this.Tnn(O.attributes,ca);ca=a.Ib.$S(ca);d.ng=ca.id;return d}mjn(a,d){uf.a.instance.J(8)&&(a=this.Xb.rz(a))&&(a=a.Mf(Gh.StyleReader.pwb))&&d.setValue(lh.a.GA,a.id)}Tnn(a,d){this.ilc(a.weight>=
zv.a.uAg,d,Vd.a.bold,!0);this.ilc(a.italic,d,Vd.a.italic,!0);this.ilc(a.underline,d,Vd.a.underline,!0);this.ilc(a.underline,d,Vd.a.underlineType,nn.a.gPb);this.ilc(a.strikethrough,d,Vd.a.strikethrough,!0);if(this.xe.bKc){if(zl.a.pIb(a.highlight)){var n=zl.a.j5a(a.highlight);this.ilc(!!a.highlight,d,Vd.a.highlight,zl.a.BXa(n))}zl.a.pIb(a.color)&&(n=zl.a.j5a(a.color),this.ilc(!!a.color,d,Vd.a.fontColor,zl.a.BXa(n)))}}ilc(a,d,n,z){a&&d.setValue(n,z)}cKe(a,d,n){if(n.attributes&&n.attributes.atmention){var z=
hg.HyperlinkReader.ega(n.attributes.atmention.email);n=n.optional&&n.optional.atmention&&n.optional.atmention.contentId?n.optional.atmention.contentId:cC.Mpl(1===n.attributes.atmention.resolveState);z=new MN.a(a,z,!0,void 0,void 0,void 0,n);this.SZk(z,d.Ib);a.hyperlink=z}else d=hg.HyperlinkReader.ega(n.attributes.link),z=this.p1k(a.paragraph.ja.first),a.hyperlink=new MN.a(a,d,!1,z.ng)}p1k(a){let d=this.mdi();d=a.paragraph.Ib.$S(d);a=new qy.a(a,E.a.nil);a.ng=d.id;return a}SZk(a,d){var n=String.format(' HYPERLINK "{0}"',
a.url),z=a.Xs;const O=this.Cpe();O.setValue(Qb.a.Jp,15);O.setValue(Qb.a.Xs,z);O.setValue(Qb.a.Bga,!0);O.setValue(Qb.a.fieldInstruction,n);a.f3(d.$S(O).id);z=this.Cpe();z.setValue(Qb.a.Jp,47);z.setValue(Qb.a.fieldInstruction,n);a.f3(d.$S(z).id);n=this.Cpe();n.setValue(Qb.a.Jp,16);a.f3(d.$S(n).id)}mdi(){const a=GH.a.instance.createInstance(1179649);a.setValue(Vd.a.av,!0);a.setValue(Vd.a.ES,!0);a.setValue(Vd.a.It,!0);return a}Cpe(){const a=this.mdi();a.setValue(Vd.a.w5,!0);return a}pTm(a){const d=new db.a;
for(let n=0;n<a.ops.length;n++){const z=a.ops[n];z.optional=KN.S6m(z.optional);if(-1!==z.insert.indexOf("\n")&&"\n"!==z.insert){const O=z.insert.split("\n");for(let ca=0;ca<O.length;ca++)if(n!==a.ops.length-1||ca!==O.length-1||O[ca])d.add(Object.assign(new FH,{insert:O[ca],attributes:z.attributes,optional:z.optional})),ca!==O.length-1&&d.add(Object.assign(new FH,{insert:"\n"}))}else d.add(z)}return Object.assign(new LN,{ops:d.toArray()})}static Mpl(a){return HH.ACommentFormatTranslator.mFk+xa.a.create().toString().replace(RegExp("-",
"g"),"").toUpperCase()+(a?"Z":"")}}cC.mzm=0;cC.hEg=0;Object(t.a)(cC,"CommentDeltaFormatTranslator",HH.ACommentFormatTranslator,[]);class Vs{static s9f(a){return a===Vs.create?0:a===Vs.reply?1:a===Vs.edit?2:a===Vs.metadata?3:null}}Vs.create="CREATE";Vs.reply="REPLY";Vs.edit="EDIT";Vs.metadata="METADATA";Object(t.a)(Vs,"CommentSessionType",null,[]);var mE=b(596);class Sw{static Bpm(){const a=document.getElementsByClassName(mE.a.AKg);if(a&&a.length){var d=a[0].clientWidth;for(let n=1;n<a.length;n++){if(a[n].clientWidth!==
d||n===a.length-1){k.ULS.sendTraceTag(540160401,327,50,"{0}:NoOfContainers={1}",a[n].clientWidth-d,a.length);break}d=a[n].clientWidth}}}static Ujh(a,d,n){a&&(a=Lb.App.lc.Mp.hvd(a),TG.CoauthLockEditor.getInstance().hDa(a)&&k.ULS.sendTraceTag(540160402,327,15,`Comment with ObjectId: ${d.objectId} added to a locked ${n?"start":"end"} paragraph. Lock Type ${a.Type.toString()}`))}static pRn(a,d,n){const z=d.Ta(E.a.qe(a.objectId));if(z){var O=Xj.a.Sla(z,d,!0);d=Xj.a.Sla(z,d,!1);null!==O&&void 0!==O&&O.Gv||
(k.ULS.sendTraceTag(540160404,327,15,`CommentRangeStart failed to save. startParaId: ${a.Nyc}, CommentObjectId: ${a.objectId}`),Sw.Z_i(n));null!==d&&void 0!==d&&d.Gv||(k.ULS.sendTraceTag(540160405,327,15,`CommentRangeEnd failed to save. endParaId: ${a.Myc}, CommentObjectId: ${a.objectId}`),Sw.Z_i(n))}else k.ULS.sendTraceTag(540160403,327,15,`Commited Comment missing CommentNode graph object ObjectId: ${a.objectId}`)}static Z_i(a){a.fl("CommentCommit","CommentReferenceFailedToSave",{isIntentional:!1,
isInternal:!0},{name:"CommentDataLoss",isIntentional:!1,isInternal:!0,isSessionEndingError:!1})}static Lom(a,d,n){0!==a.size&&a.forEach(z=>{d.has(z)||Sw.Qom(z,n)})}static Qom(a,d){d.Ta(E.a.qe(a))&&k.ULS.sendTraceTag(539800642,327,15,`comment start missing for ${a}`)}static xQk(a){const d=new Set;a.forEach(n=>{n&&n.Bf&&((n=Sw.lIl(n))?d.add(n):k.ULS.sendTraceTag(539554689,327,15,"Outline Node is undefined"))});d.forEach(n=>{const z=n.fa(bd.a.Rne,[]);0===n.fa(bd.a.Qne,[]).length&&0===z.length&&k.ULS.sendTraceTag(539800644,
327,15,`Outline Element Node ${n.id.toString()} is missing comment info while paragraph has comments. This will cause some comments to fail to load.`)})}static shm(a,d,n,z){a=n.fvi(a);if(!a)return!1;n=a.getValue(Qb.a.mC);z=z.Ta(n);d.has(n.toString())&&k.ULS.sendTraceTag(539800643,327,15,`Para Node ${n} missing comment reference for comment ${a.id}`);return z&&z.Bf?!0:(k.ULS.sendTraceTag(539567714,327,15,`Para Node ${n} with missing comment reference for comment ${a.id} is in a invalid state ${z?"paraNode containingGraph is null":
"paraNode is null"}`),!1)}static lIl(a){let d;try{d=qe.OutlineElementNavigator.Fl(a)}catch(n){k.ULS.sendTraceTag(539567715,327,10,`ParaNode ${a.id} OutlineNode failed to retrieve ${n}`)}return d}static Ayl(a){var d;switch(null===(d=a.YG)||void 0===d?void 0:d.sessionType){case Vs.create:return"CommentThreadInProgress";case Vs.reply:return"CommentReplyInProgress";case Vs.edit:return"CommentEditInProgress"}}}Object(t.a)(Sw,"CommentDiagnosticHelpers",null,[]);var AQ=b(795),BQ=b(794);class nE{constructor(a,
d,n,z,O,ca,Da,Xa,zb,Vb,Fc){this.Jh=a;this.fb=d;this.te=n;this.F$a=z;this.xe=O;this.Rbb=ca;this.xf=Da;this.G1=Xa;this.sh=zb;this.m_=Vb;this.OH=Fc;this.HTb=null;this.age=0;this.fWb=!1;this.nce=0;this.Hoc=this.WVd=this.Dqh=this.y5c=this.M1b=!1;this.updateViewportInfo=()=>{this.m_.Z4g()&&this.sh.updateViewportInfo(this.fWb,this.YJg)};this.YJg=()=>{this.xe.fua?this.Q7b():this.Kvb();this.m_.XJg()};this.tYg=()=>{this.Q7b()};this.e8g=()=>{!this.M1b&&this.m_.c4g()&&(this.nce=this.azf.scrollTop,this.M1b=!0,
this.F$a.lXa(2))};this.CSg=(Yc,yd)=>{this.M1b&&(Yc=this.azf.scrollTop,Yc-this.nce?(this.y5c||yd.X0d||this.updatePosition(),this.y5c||1!==yd.X0d||this.Kvb(),this.xDf(Yc),this.m_.JIg()):this.y5c=this.M1b=!1)};this.azf=this.sh.Ooa;this.sta=mE.a.PPe;this.mu=this.sh.mu;this.sh.J9h()}get AFe(){return this.m_.fsg()}get sta(){return this.sh.sta}set sta(a){this.sh.sta=a}get LZh(){return"1"===this.mu.CH.style.opacity}bAj(a){this.WVd||(this.WVd=!0,this.sh.ofj(),this.HTb=a(this.mu.KUa,this.sh.Unj,()=>{this.updatePosition()}),
this.sh.t0i(this.HTb),this.m_.initialize(this.HTb,this),this.sh.initialize(this.HTb,this.m_.RJb),this.sh.ylj(),this.sh.Yzj(),this.sh.Zzj(),this.sh.aAj(this.m_.eHf,this.m_.NOe,this.m_.MOe),this.wTg())}RUd(){}QYe(){return this.sh.DAj()}setInitialActiveContainerId(a,d,n=null){this.sh.setInitialActiveContainerId(a,0,n)}updatePosition(){if(!this.Hoc&&this.AFe&&this.Jh.AHc()){var a=Ye.a.me()-this.age<mE.a.JPj;a||this.fWb||(this.xe.fua?this.Q7b():this.Kvb(a))}}eGf(){this.Kvb()}HKa(a,d,n){this.sh.HKa(a,d,
n)}deleteContainer(a,d,n=!1){this.sh.deleteContainer(a,d,()=>{this.Jh.ggg()||this.sh.bhg();this.m_.PGg()},n)}addContainer(a,d,n){this.sh.addContainer(a,d,n,this.sh.ef,this.m_.xvd,this.m_.GFg)}dej(a){this.Hoc=!0;a();this.Hoc=!1}YQd(a,d,n){this.sh.YQd(a,d,n)}BAc(){this.sh.BAc()}$Pj(){const a="1"===this.mu.CH.style.opacity;switch(!0){case a&&!this.Jh.ggg():this.sh.bhg();break;case !a&&this.Jh.ggg():this.sh.umc()}}qah(a=!0){this.m_.U4g&&this.sh.wJj(a)}static pwi(a,d=null){const n=new yb.a;for(let z of a)z.Lg||
z.Dv!==qo.beingCreated&&(!d||d(z))&&nE.juk(n,z.objectId,z);return n}static juk(a,d,n){let z;({value:z}=a.Ab(d,z)).returnValue||(z=[],a.$(d,z));z.push(n)}wTg(){this.sh.ef&&(this.sh.ef.h3(()=>{this.xe.fua?this.Rbb.value.measure(this.updateViewportInfo):this.updateViewportInfo()}),this.xe.G$k&&(this.xe.fua?this.sh.ef.kgd(this.tYg):(this.nce=this.azf.scrollTop,this.sh.ef.kgd(this.e8g),this.sh.ef.YCf(this.CSg))))}xDf(a){this.mu.CH.style.top=a-this.nce+"px";this.y5c=!1}Kvb(a=!1){a=new bf.a(0,1,0,()=>{this.NXf()},
129,void 0,!a);this.fb.rb(a);this.fWb=!0;this.y5c=this.M1b;this.F$a.lXa(10)}Tye(a){return this.sh.ajb({contentAnchorPositions:a.contentAnchorPositions})}NXf(){this.fWb=!1;if(this.mu.KUa&&this.HTb&&this.Jh.AHc()){this.sh.vqd();var a=0;this.te.Fd(()=>{a=this.sh.FFc()},"FCM:UP:GET");var d=null,n=null;this.te.Fd(()=>{const z=this.m_.jvi(a,this.sh.ef);d=z.EVk;n=this.Tye(z)},"FCM:UP:GP");this.te.Fd(()=>{this.M1b?(this.sh.Nji(n),this.M1b=!1):this.HTb.emitEvent(3,n);this.G1.vTe()},"FCM:UP:RC");this.HTb.setFirstCommentRenderDone();
"0"===this.mu.CH.style.opacity&&0<d.count&&!this.xf.xq&&this.te.Fd(()=>{this.sh.umc()},"FCM:UP:SFC");this.xe.tKb&&!this.Dqh&&0<d.count&&(ao.a.oaa(this.fb,this.sh.Q0i,fw.a.P0i),this.Dqh=!0);this.age=Ye.a.me();this.F$a.lXa(6)}else this.age=Ye.a.me()}Q7b(){this.fWb||(this.Rbb.value.measure(()=>{const a=this.sh.FFc(),d=new BQ.a;d.contentAnchorPositions=this.m_.R6f(a,this.sh.ef).YBb;this.Rbb.value.yJb(()=>{this.sh.Vmi(d);this.age=Ye.a.me();this.fWb=!1})}),this.fWb=!0)}}Object(t.a)(nE,"FloatingCommentManager",
null,[675,676]);var dC;(function(a){a[a.V8n=0]="singleHint";a[a.B5n=1]="multiHint";a[a.J7n=2]="resolvedHint";a[a.C5n=3]="multiResolvedHint";a[a.entryPoint=4]="entryPoint";a[a.unknown=void 0]="unknown"})(dC||(dC={}));Object(t.b)("CommentIconType",dC);const CQ={[1]:"ShowAllCommentsSelected_16x16x32",[0]:"SharedCommentBubbleSelected_16x16x32",[2]:"MarkCommentDone1Selected_16x16x32",[3]:"ShowAllCommentsResolvedSelected_16x16x32",[4]:"NewComment_16x16x32",[dC.unknown]:""},NN={[1]:"ShowAllCommentsHover_16x16x32",
[0]:"SharedCommentBubbleHover_16x16x32",[2]:"MarkCommentDone1Hover_16x16x32",[3]:"ShowAllCommentsResolvedHover_16x16x32",[4]:"NewComment_16x16x32",[dC.unknown]:""},eD={[1]:"ShowAllComments_16x16x32",[0]:"SharedCommentBubble_16x16x32",[2]:"MarkCommentDone1_16x16x32",[3]:"ShowAllCommentsResolved_16x16x32",[4]:"NewComment_16x16x32",[dC.unknown]:""},fD=(a,d)=>{d===dC.unknown&&k.ULS.sendTraceTag(545056465,327,15,`Unknown hint IconType with state : ${a}`);switch(a){case 1:return CQ[d];case 2:return NN[d];
case 3:return eD[d];default:return""}};class Tw{}Tw.EKi=16;Tw.I_l=1;Tw.$ig=20;Tw.PVj=2;Object(t.a)(Tw,"CommentIconConstants",null,[]);class ON{constructor(){this.NNf=0;this.Dhd=!1}}Object(t.a)(ON,"CommentHintCensus",null,[]);class PN{constructor(a,d,n,z,O){this.zrh=a;this.Nxc=n;this.w7j=z;this.Fib=O;this.AQa=-1;this.Maf=new Set(d)}get y(){if(-1!==this.AQa)return this.AQa;const a=Sys.UI.DomElement.getBounds(this.zrh),d=this.zrh.getClientRects();0<d.length&&d[0]?this.AQa=this.w7j?a.y/this.Nxc+Tw.PVj:
Math.floor(d[0].height)/(2*this.Nxc)+a.y/this.Nxc-Tw.EKi/2:(k.ULS.shipAssertTag(40731970,327,!1,"Failed to access bounding rects {0}, Element bounds {1}",JSON.stringify(d),JSON.stringify(a)),this.AQa=0);return this.AQa}get YAc(){return Array.from(this.Maf)}fxk(a){this.Maf=new Set([...this.Maf,...a])}}Object(t.a)(PN,"HintInfo",null,[708]);class Qt extends Sb.a{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc){var yd;super();this.xe=a;this.ag=d;this.mk=n;this.PQ=z;this.ga=O;this.Jh=Vb;this.BEa=Fc;this.F$a=
Yc;this.vZc={};this.Uyb=this.KAb=null;this.gFh={};this.FUc={IUc:-1,qEg:-1};this.wsn=null===(yd=l.AFrameworkApplication.K)||void 0===yd?void 0:yd.getBooleanFeatureGate("Microsoft.Office.WordOnline.QueryCommentHintsOnSplits",!1)}Olc(a){return Lb.App.T4e&&a.qb.gj&&this.wsn?ti.vYl(a):ti.$fg(a.htmlElement)}Q5b(a){const d=this.zoom,n=a.bha,z=a.Kac,O=a.V3b(1,Tw.$ig,d);this.F$a.lXa(1);let ca=[];z.forEach((Da,Xa)=>{const zb=a.IUa[Xa].y/d,Vb=Yc=>this.r1k(n,Yc,Yc.y-zb,O),Fc=()=>Qt.R2k(n);Da=this.xe.ZDg?this.A1k(this.hyi(Da,
Xa),Vb,Fc):this.z1k(this.hyi(Da,Xa),Vb);ca=ca.concat(Da)});return ca}z1k(a,d){const n=[];for(let z of a){a=d(z);for(let ca of z.YAc)this.vZc[ca.toString()]=a;const O=this.M$f(z.YAc);this.Ldh(O,a);a.Fib=z.Fib;n.push(a)}this.dac(this.Uyb);this.fnb(this.KAb);return n}A1k(a,d,n){n=n();const z=[];for(let O of a){a=d(O);for(let Da of O.YAc)this.vZc[Da.toString()]=a;const ca=this.M$f(O.YAc);this.Ldh(ca,a);null===n.Fib&&(n.Fib=O.Fib);n.appendChild(a);z.push(a)}this.dac(this.Uyb);this.fnb(this.KAb);(d=Ag.a.Ta(n,
Qt.Jyd))&&(this.gFh[d.toString()]=z);return[n]}Icl(a,d){var n;a=null===(n=null===a||void 0===a?void 0:a.htmlElement)||void 0===n?void 0:n.querySelectorAll("."+Qt.rcj);return 0<(null===a||void 0===a?void 0:a.length)&&a[0]&&(n=Ag.a.Ta(a[0],Qt.Jyd),n=this.gFh[n.toString()])?this.yfn(n,d):!1}yfn(a,d){let n=0,z=a.length-1,O;for(;z>=n;){O=Math.floor((z-n)/2+n);const ca=a[O];if(ca.offsetTop>=d-2&&ca.offsetTop<=d+2)return!0;ca.offsetTop>d+2?z=O-1:n=O+1}return!1}M$f(a){let d=0,n=0;for(let z of a)this.Jh.Jqg(z)&&
(this.Jh.dQi(z)?n+=1:d+=1);a=new ON;a.NNf=d+n;a.Dhd=0===d;return a}wVc(a){if(a=this.vZc[a.objectId]){var d=ti.z4a(a);d=this.M$f(d);this.Ldh(d,a)}}Ldh(a,d){const n=d.firstElementChild;if(n){n.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;if(1===a.NNf){var z=a.Dhd?2:0;n.alt=a.Dhd?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel}else 1<=a.NNf&&(z=a.Dhd?3:1,n.alt=a.Dhd?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:
WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel);d.style.display="block";n.className=Vf.getImageClassWithCluster(l.AFrameworkApplication.YL,eD[z]);Ag.a.ql(n,Qt.S8h,z)}}gvl(a){const d=[];ti.G6f(a,d,!0);return d}hyi(a,d){a=this.s1k(a,d);a.sort((n,z)=>n.y-z.y);return this.kwm(a)}s1k(a,d){const n=[],z=this.xe.As,O=this.zoom;a=this.gvl(a);for(let ca=0,Da=a.length;ca<Da;ca++){const Xa=a[ca],zb=ti.z4a(Xa);zb&&n.push(new PN(Xa,zb,O,z,d))}return n}kwm(a){let d=null;const n=[];for(let z=
0;z<a.length;z++)d&&Math.abs(a[z].y-d.y)<Tw.EKi+Tw.I_l?d.fxk(a[z].YAc):(d=a[z],n.push(d));return n}r1k(a,d,n,z){const O=a.Cf.ownerDocument,ca=O.createElement("div");ca.className=Qt.R8h;ca.style.top=n+"px";ca.style.left=z+"px";ca.style.right="auto";Ag.a.ql(ca,Ji.a.nld,d.YAc);d=O.createElement("img");d.className=Vf.getImageClassWithCluster(l.AFrameworkApplication.YL,eD[0]);d.src=l.AFrameworkApplication.ln;d.title=CommonUIStrings.l_CommentHintTooltip;d.alt=CommonUIStrings.l_CommentHintTooltip+WordEditorIntl.WordEditorStrings.L_AccHelpShortcutMsgToMoveFocusCommentToDocument;
d.setAttribute("role","button");ca.appendChild(d);this.ag.vD(vb.a.click,d,Object(m.a)(this,this.RFm,"onHintClick"),a);this.ag.Ea(vb.a.nz,d,Object(m.a)(this,this.UFm,"onHintDoubleClick"));this.mk.Ea(vb.a.jM,d,Object(m.a)(this,this.WFm,"onHintMouseOver"),null);this.mk.Ea(vb.a.IY,d,Object(m.a)(this,this.VFm,"onHintMouseExit"),null);this.PQ.Ea(d,Object(m.a)(this,this.TFm,"onHintContextMenu"));return ca}static R2k(a){const d=a.Cf.ownerDocument.createElement("div");d.className=Qt.rcj;let n=Ag.a.Ta(a.Ia,
Qt.Jyd);n||(n=E.a.create(),Ag.a.ql(a.Ia,Qt.Jyd,n));Ag.a.ql(d,Qt.Jyd,n);return d}TFm(){return!0}UFm(){return!0}RFm(a){const d=ti.z4a(a.qk.parentNode);a.eventName===vb.a.vx&&(this.BEa.iMf(),this.i7h());this.ga.ob(Sa.a.QNf,2,d);return!0}WFm(a){this.DTa(this.Uyb)!==a.qk&&(a=ti.z4a(a.qk.parentNode),this.ga.ob(Sa.a.Lne,2,a));return!0}VFm(){this.ga.processAction(Sa.a.kld,2);return!0}dac(a){this.i7h();this.Uyb=a;this.vDk()}vDk(){this.wDk(this.DTa(this.Uyb),this.DTa(this.KAb))}fnb(a){this.mSk();this.KAb=a;
if(a=this.DTa(this.KAb))a.className=Vf.getImageClass(fD(1,this.Gxe(a)))}DTa(a){if(!a)return null;let d=null;if(a=this.Jh.jba(a))if(a=a.Lg?this.Jh.NP(a.Lg):a)d=a.objectId;return d&&this.vZc[d]?this.vZc[d].firstChild:null}i7h(){this.oSk(this.DTa(this.Uyb),this.DTa(this.KAb))}oSk(a,d){if(a){const n=this.Gxe(a);a.className=a===d?Vf.getImageClass(fD(1,n)):Vf.getImageClass(fD(3,n));this.Uyb=null}}wDk(a,d){a&&(a.title=0<this.FUc.qEg&&1<this.FUc.IUc?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,
this.FUc.qEg,this.FUc.IUc):CommonUIStrings.l_CommentHintTooltip,d!==a&&(d=this.Gxe(a),a.className=Vf.getImageClass(fD(2,d))))}mSk(){const a=this.DTa(this.Uyb),d=this.DTa(this.KAb);if(d){const n=this.Gxe(d);d.className=a===d?Vf.getImageClass(fD(2,n)):Vf.getImageClass(fD(3,n));this.KAb=null}}Gxe(a){return Ag.a.Ta(a,Qt.S8h)}}Qt.R8h="clip16x16 HintContainer";Qt.rcj="OutlineElementHintMargin";Qt.Jyd="MarginElementId";Qt.S8h="CommentIconType";Object(t.a)(Qt,"CommentHintActor",Sb.a,[691]);var QN=b(884);
class RN extends QN.a{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb){super();this.dK=a;this.pX=d;this.uq=n;this.taskManager=z;this.Ahe=O;this.bDb=ca;this.sh=Da;this.getSelectedText=Xa;this.$Sn=zb;this.Wg=Vb;this.FJd=()=>{};this.ONe=()=>{};this.woh=!1;this.lPk={[0]:()=>this.w8k(),[1]:()=>this.Bmc.eGf()};this.XJg=()=>{this.Ahe.lXa(11)};this.eHf=Fc=>{if(this.pX.x3b)for(let Yc of ti.Zrj)Fc.bindAction(gb.KeyInputManager.mH(Yc),Dc.a.rJf)};this.NOe=()=>{this.ONe()};this.MOe=(Fc,Yc)=>{if(Fc.name!==Ec.AFrame.Zs&&Yc){var yd=
this.uq.Ou?this.uq.Ou.id:"";this.dK.ngc||(this.dK.ngc=ao.a.oaa(this.taskManager,()=>{this.FJd(yd)}))}};this.Saj=()=>{};this.RJb=()=>{this.dCj()};this.GFg=(Fc,Yc)=>{0===Yc&&(this.bDb.vTe(),this.Ahe.lXa(0))};this.PGg=()=>{this.Ahe.lXa(5)};this.xvd=Fc=>{let Yc=0;const yd=this.uq.eba();for(let je=0;je<yd.length;je++){if(yd[je].Lg||yd[je].done)continue;if((yd[je].Dv===qo.beingCreated?yd[je].YG.draftId:yd[je].id)===Fc.contentId)break;const Le=this.Rz.getContentAnchorPosition(yd[je].id);!Le||4<Math.abs(Fc.anchorTop-
Le.anchorTop)||Yc++}return Yc};this.m8i=()=>{this.bDb.vTe()};this.JIg=()=>{this.Ahe.lXa(2)};this.dCj=()=>{if(!this.woh&&this.sh.Ooa){const Fc=this.sh.Ooa.getElementsByClassName(Qt.R8h);for(let Yc=0;Yc<Fc.length;Yc++)Fc[Yc].style.opacity="1";this.woh=!0}}}get U4g(){return this.hga()}get Xhi(){return this.$Sn.XDi()}initialize(a,d){this.Rz=a;this.Bmc=d;this.VPd()}Ikn(a,d){this.ONe=a;this.FJd=d}R6f(a,d){return{YBb:this.Cvl(a,d),containerContentByType:{}}}jvi(a,d){const n=nE.pwi(this.uq.eba(),this.uq.M5a),
z=[],O=ti.gvi(!0);var ca=this.uq.eba();d=this.WUm(d,ca,n);!d.XNg&&d.contentAnchorPosition&&(z.push(d.contentAnchorPosition),d.contentAnchorPosition=null);for(ca=0;ca<O.length;ca++){const Da=O[ca],Xa=ti.z4a(Da);if(Xa)for(let zb=0;zb<Xa.length;zb++){const Vb=this.getContentAnchorPosition(a,n,Da,Xa[zb]);Vb&&(z.push(Vb),d.XNg&&d.contentAnchorPosition&&Vb.contentId===d.XNg.id&&(z.push(d.contentAnchorPosition),d.contentAnchorPosition=null))}}d.contentAnchorPosition&&z.splice(0,0,d.contentAnchorPosition);
return{EVk:n,contentAnchorPositions:z}}fsg(){var a;return!(null===(a=this.Rz)||void 0===a||!a.getAreContainersEnabled())}hga(){return this.uq.AHc()}c4g(){return this.hga()}sVd(){return this.hga()}Z4g(){return this.Rz&&this.sh.Ooa&&this.hga()}Jaj(a){0!==a&&this.FJd(this.uq.Ou?this.uq.Ou.id:"")}getContentAnchorPosition(a,d,n,z){let O=null;return({value:O}=d.Ab(z.toString(),O)).returnValue?(d=O[0])&&!d.Lg?Object.assign(Object.assign({},new AQ.a),{anchorTop:(mE.a.Ztd(n)-a)/this.sh.A3a,anchorLeft:0,containerContentType:0,
contentId:d.id}):null:null}WUm(a,d,n){var z,O;const ca={};"CREATE"===(null===(O=null===(z=this.uq.ZL)||void 0===z?void 0:z.YG)||void 0===O?void 0:O.sessionType)&&(z=this.sh.Ooa.getElementsByClassName(Ji.a.Zre),a=this.sh.Wsi((0<z.length?z[0]:null)||this.getSelectedText(),this.uq.ZL.YG.draftId,0,a),ca.XNg=this.FJl(d,n),ca.contentAnchorPosition=a);return ca}FJl(a,d){var n=Array.indexOf(a,this.uq.ZL);for(--n;-1<n;n--)if(d.Na(a[n].objectId))return a[n]}Cvl(a,d){return this.jvi(a,d).contentAnchorPositions}VPd(){this.bDb.JLb("OnAfterTrackChangeMarkupViewChange",
(a,d)=>{if(d)this.lPk[d.Cl]()})}w8k(){const a=ti.cyi();if(0!==a.length){var d=nE.pwi(this.uq.eba()),n=this.uq.Q3;for(let z=0;z<a.length;z++){const O=ti.z4a(a[z]);for(let ca=0;ca<O.length;ca++){let Da;({value:Da}=d.Ab(O[ca].toString(),Da)).returnValue&&(Da.forEach(Xa=>{var zb;Xa&&!Xa.Lg&&(this.Bmc.deleteContainer(Xa.id,0,!1),(null===(zb=n.yD)||void 0===zb?void 0:zb.id)===Xa.id&&n.clearSelection())}),this.Wg.wf(Ec.AFrame.ao))}}}}}Object(t.a)(RN,"CommentFloatingContainerActor",QN.a,[695]);class SN extends kj.a{constructor(a,
d,n,z,O,ca,Da,Xa,zb){super();this.cmf=a;this.Bxb=d;this.Naf=n;this.te=O;this.Gia=Xa;this.G1=zb;this.Fj=null;this.Cl=1;z.execute(Vb=>{this.Fj=Vb});this.lja=[];this.wZc=new Hm.ScriptSharpLegacyMap;this.h2m(ca,Da);this.VPd()}get $i(){return this.cmf.value}get commentEditor(){return this.Bxb}get kAa(){return!!this.Fj}get eac(){return 0}get HGb(){return this.lja}get Wyh(){return this.wZc.Na(this.Cl)?this.wZc.J(this.Cl):this.wZc.J(0)}rpb(a){return this.Gia.rpb(a)}VFb(a,d){if(a=Object(qa.a)(693,a))for(let n of this.kVm(a))d.add(n)}o7a(a,
d){this.kAa&&this.te.Fd(()=>{this.ZHm(a,d)},"CHA:OPHC")}ZHm(a,d){if(this.Fj.cS.AHc()){var n=this.YB.z3a,z=new qi.a(new Wk.a),O=d.xic("*"),ca=this.ivl(n),Da=!!n&&!n.action||!!ca&&ca===this.Fj.yD,Xa;this.te.Fd(()=>{this.Naf.YHl(a.id,z,null===ca||void 0===ca?void 0:ca.objectId)},"OPHC:GOI");this.te.Fd(()=>{Xa=this.Wyh.j2h(O,ca,z,Da);Xa.cQi=this.aQi(n)&&0===n.action},"OPHC:BHI");this.te.Fd(()=>{this.Wyh.YYh(O,Xa,Da)},"OPHC:AH")}}ivl(a){let d=null;!this.aQi(a)||0!==a.action&&2!==a.action||(d=this.YB.z3a.pK);
return d||this.Fj.yD}kVm(a){if(!a)return[];a=this.$i.Ta(E.a.qe(a.objectId));return this.commentEditor.Lye(a,null)}xmj(){return!1}rM(a,d,n){this.kAa&&(a=Object.assign(new Y.a,{action:a,type:0,pK:d,zV:n}),this.YB.rM(a))}iMf(){this.kAa&&(this.rM(3,this.Fj.fIc,this.Fj.fIc),this.Fj.fIc=null)}h2m(a,d){this.wZc.add(1,a);this.wZc.add(0,d)}VPd(){this.G1.JLb("OnBeforeTrackChangeMarkupViewChange",(a,d)=>{d&&d.eEg!==this.Cl&&(this.Cl=d.eEg)})}aQi(a){return a&&0===a.type}}Object(t.a)(SN,"CommentHighlightActor",
kj.a,[694,221]);var TN=b(900),IH=b(939);class UN{constructor(a,d){this.sVk=a;this.zFg=d}}Object(t.a)(UN,"CommentEndParaIdBeforeChangeInfo",null,[]);class oE{constructor(a=!1){this.J0=null;this.AGb=!1;a&&(this.J0=new qi.a(new Wk.a))}}Object(t.a)(oE,"OpenCommentInfo",null,[]);class VN{constructor(a,d,n,z,O,ca){this.Xy=a;this.xf=d;this.Jh=n;this.G1=z;this.Nm=O;this.te=ca;this.uRb=null;this.vab=new ia.a(new TN.a);this.pAb=new IH.a(ti.lxd());this.G1.JLb("OnCommentNodeAdded",Object(m.a)(this,this.XUm,"processIncomingNewComment"));
["OnCommentPaneOpen","OnCommentPaneClose"].forEach(Da=>{this.G1.JLb(Da,Object(m.a)(this,this.h7l,"invalidateParaNodeForPaneOnlyComments"))});a=this.Nm.Oe(12);a.vy(Object(m.a)(this,this.p7a,"onParagraphNodeDisconnected"));a.Rt(Object(m.a)(this,this.sCm,"onAnchorParaNodesConnected"));this.Nm.Oe(40).QBb(Object(m.a)(this,this.GCm,"onBeforeCommentEndParaIdChange"));this.Nm.Oe(40).tq(Object(m.a)(this,this.IDm,"onCommentEndParaIdChange"));iC.a.uKa(Object(m.a)(this,this.LDm,"onCommentRangeObjAdded"))}get DH(){return this.Xy.value}get kd(){return this.DH.kd}YHl(a,
d,n){if(this.uOm(a))for(let z of this.xf.EH.J(a).J0)!this.yAj(z,n===z.toString())||d.add(z)}yAj(a,d){const n=this.kd.Ta(a),z=ti.RKc(n);return!n||z?!1:(a=this.Jh.jba(a.toString()))&&(this.xf.xq||this.Jh.M5a(a)||d)?!0:!1}uOm(a){return this.fOm(a)}XUm(a,d){(a=d.commentNode)&&!ti.RKc(a)&&(d=this.Jh.E6f(a),E.a.Ap(d.OWd,d.aqd)||this.qOj(d,a)||this.i6h(d.JRa,d.W2a,a)||this.beh(a))}beh(a){if(a){var d=Xj.a.Lye(a,null),n=new ra.a;for(let z=1;z<d.length-1;z++)this.nBf(d[z].id,a.id),n.add(d[z]);kn.b(n)}}fOm(a){if(!this.xf.W7)return!1;
let d=null;if(({value:d}=this.xf.EH.Ab(a,d)).returnValue)return d.AGb;let n=!1;this.te.Fd(()=>{const z=ti.gvi();for(let O=0;O<z.length;O++)n=this.WNn(z[O],a,n);n||(this.xf.EH.add(a,new oE),this.xf.EH.J(a).AGb=!1)},"CHORA:PHOC");return n}WNn(a,d,n){a=ti.z4a(a);if(!a)return n;for(let z=0;z<a.length;z++){const O=this.kd.Ta(a[z]);O&&!ti.RKc(O)&&(n=n||this.BPk(O,d))}return n}BPk(a,d){var n=this.Jh.E6f(a);if(this.qOj(n,a))return!1;var z=n.OWd;const O=n.aqd;n=n.JRa;if(z!==E.a.nil&&(z.equals(O)||z.equals(d)))return!1;
for(z=Bd.ParagraphReader.qh(n,!1);z&&!z.id.equals(O);){if(z.id.equals(d))return this.nBf(d,a.id),!0;z=Bd.ParagraphReader.qh(z,!1)}return!1}nBf(a,d){this.xf.Cca.Na(d)||this.xf.Cca.add(d,new qi.a(new Wk.a));this.xf.Cca.J(d).add(a);this.xf.EH.Na(a)?this.xf.EH.J(a).J0||(this.xf.EH.J(a).J0=new qi.a(new Wk.a)):this.xf.EH.add(a,new oE(!0));this.xf.EH.J(a).AGb=!0;this.xf.EH.J(a).J0.add(d)}GCm(a,d){d.property===Qb.a.RA&&(a=d.node.fa(Qb.a.RA,E.a.nil),this.uRb=new UN(d.node.id,a))}IDm(a,d){a=d.node;if(d.property===
Qb.a.RA&&a){var n=a.fa(Qb.a.mC,E.a.nil);d=a.fa(Qb.a.RA,E.a.nil);var z=this.uRb?this.kd.Ta(this.uRb.zFg):null;!ti.RKc(a)&&n&&!n.equals(d)&&this.uRb&&a.id.equals(this.uRb.sVk)&&!n.equals(this.uRb.zFg)&&z&&z.isConnected&&this.nBf(this.uRb.zFg,a.id);d&&this.xf.EH.Na(d)&&(n=this.xf.EH.J(d),n.AGb&&(k.ULS.shipAssertTag(572835481,327,!!n.J0,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),n.J0&&n.J0.contains(a.id)&&(n.J0.remove(a.id),n.J0.count||(n.AGb=!1),this.xf.Cca.Na(a.id)?
this.xf.Cca.J(a.id).remove(d):k.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}}p7a(a,d){a=d.node.id;this.xf.EH.Na(a)&&this.V6m(a)}V6m(a){if(this.xf.EH.J(a).J0)for(let d of this.xf.EH.J(a).J0)this.xf.Cca.Na(d)?this.xf.Cca.J(d).remove(a):k.ULS.sendTraceTag(572835483,327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");this.xf.EH.remove(a)}h7l(){const a=new ra.a;for(let d of this.Jh.eba())d.Lg||d.Dv===qo.beingCreated||this.Jh.M5a(d)||
this.Jh.zPj(d,a);kn.b(a)}qOj(a,d){let n=!1;if(!a.L_e||!a.Ese){n=!0;if(!a.JRa||!a.W2a)return k.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",!a.JRa,!a.W2a),!0;a.L_e||this.vab.Na(a.JRa)||this.vab.add(a.JRa,{commentNode:d,currentNode:a.JRa,OPe:a.W2a,zTf:!0});a.Ese||this.vab.Na(a.W2a)||this.vab.add(a.W2a,{commentNode:d,currentNode:a.W2a,OPe:a.JRa,zTf:!1})}return n}i6h(a,d,n){a=Xj.a.rTa(a,n.id,!0);d=Xj.a.rTa(d,n.id,!1);let z;a||({value:z}=this.pAb.Ab(n.id,z),this.pAb.$(n.id,
z&1));d||({value:z}=this.pAb.Ab(n.id,z),this.pAb.$(n.id,z&2));return!a||!d}sCm(a,d){d&&d.node&&this.vab.Na(d.node)&&(a=this.vab.J(d.node).OPe,this.vab.Na(a)||(a=this.vab.J(d.node),this.i6h(a.zTf?a.currentNode:a.OPe,a.zTf?a.OPe:a.currentNode,a.commentNode)||this.beh(a.commentNode)),this.vab.remove(d.node))}LDm(a,d){const n=a.vi;if(!d&&this.pAb.Na(n)){var z;(z=this.pAb).$(n,z.J(n)&(a.Db?-2:-3));this.pAb.J(n)||(this.beh(this.kd.Ta(n)),this.pAb.remove(n))}}}Object(t.a)(VN,"CommentHighlightOnRestActor",
null,[692]);class WN{constructor(a,d){this.K1b=a;this.Dva=d}getViewContainer(){return this.K1b}registerForViewContainerEvents(a){this.Dva.U4m(a)}unregisterForViewContainerEvents(a){this.Dva.YJn(a)}}Object(t.a)(WN,"ViewContainerProvider",null,[820]);class JH{constructor(a,d,n,z){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=a;this.appLocale=d;this.uiCulture=n;this.dataCulture=z}}Object(t.a)(JH,"LocalizationDetails",null,[]);var DQ=b(997);class XN{constructor(a,
d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le,Ve,gg,Lh,Ki,Ak,Uk,Rl,kk,dn,fs,lp,zt){this.zs=a;this.uq=d;this.ZAc=n;this.Jqa=z;this.pX=O;this.dK=ca;this.Lue=Da;this.bIc=Xa;this.nm=zb;this.Tb=Vb;this.dynamicScriptLoader=Fc;this.Tcn=Yc;this.Wg=yd;this.XNf=je;this.AVk=Le;this.iTh=Ve;this.zRn=gg;this.kDa=Lh;this.bDb=Ki;this.cen=Ak;this.fil=Uk;this.BBm=Rl;this.ARn=kk;this.YNf=dn;this.m_=fs;this.sh=lp;this.OH=zt;this.G8d=this.leb=null;this.Uzh=!1;this.epf=[];this.gMh=this.Vzh=!1;this.initialize=(Ro,qr)=>{this.N2l(qr)};
this.MDm=()=>{this.aNi()};this.uAl=(Ro,qr,wy)=>{Ro=Object.assign(Object.assign({},new DQ.a),{containerPanel:Ro,paneOpenedCallback:qr,paneClosedCallback:wy,ulsLogger:new No.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,isRtl:l.AFrameworkApplication.isRtl&&this.pX.tKb,viewportInfo:this.sh.x7f(),interactivePerfImprovementEnabled:!0,deselectionEnabled:!0,synchronousContainerPositioningEnabled:this.pX.fua,floatingContainerVirtualizationEnabled:this.pX.EEc,destroyAllContainersCallback:()=>
{this.dK.xq||k.ULS.sendTraceTag(571342851,327,10,"The pane is not open but we are destroying the containers!")},trackChangeInSidetrackEnabled:this.pX.trackChangeInSidetrackEnabled,featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.pX.EEc,synchronousContainerPositioningEnabled:this.pX.fua,trackChangeInSidetrackEnabled:this.pX.trackChangeInSidetrackEnabled,improveJumpingFixEnabled:!1,shouldInitialize:!0,scrollingPerfImprovementEnabled:!1}});return floatingContainerManager.FactoryGlobal.getFCManagerInstance(Ro)};
this.nFm=Ro=>{2!==this.zs.mode&&3!==this.zs.mode&&this.uq.Ou&&Ro===this.uq.Ou.id&&this.zs.clearSelection();Lb.App.oa.updateCommandUI(!0)};this.T8i=(Ro,qr)=>{this.FBb&&!Ro&&this.WLm();this.ZAc.HBb&&this.pX.B6b&&this.Tb.processAction(Sa.a.newComment,2);qr&&qr()};this.bDb.JLb("OnCommentInit",this.initialize);this.bDb.JLb("OnCommentRenderedOnce",this.MDm);this.m_.Ikn(()=>{},this.nFm)}get U_a(){return this.zs}get FBb(){return this.dK.FBb}N2l(a){this.dK.W7?a&&a.xWa&&a.xWa():this.Uzh?(null===a||void 0===
a?0:a.xWa)&&this.epf.push(a.xWa):(this.pX.eyd?this.YNf.Lq("CommentLoad",0):mn.a.gNc("canvas","floatingComments"),this.Uzh=!0,this.uq.initialize(this.zs),this.ZAc.initialize(this.zs,null),this.ZAc.$zj(this.zs),this.bIc.w3l(this.Jqa.qon),Ph.a.ot(this.fil).continueWith(d=>{(this.leb=d.result)||k.ULS.sendTraceTag(574734881,327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.XNf.initialize(this.leb);this.U_a.KNf.initialize(this.U_a,this.uq,this.leb,this.XNf);this.iTh.initialize(this.dynamicScriptLoader,
this.U_a.KNf,this.BBm,this.leb,new WN(this.zRn,this.ARn),this.Vzi(),"",this.XNf.XDi(),this.kDa);this.OH.trackChangeInSidetrackEnabled?this.sh.wYi().then(()=>{this.RUd();this.lEe(a)}):this.lEe(a)}))}lEe(a){this.G8d=this.iTh.lEe();this.kAd(a);this.dK.W7=!0;this.pX.A6g&&this.AVk.initialize()}kAd(a){if(!this.dK.Bac){var d=this.nm.Pe("Task","InitiateCommentingSession");try{const n=this.nm.Pe("Task","InitiateCommentingSession-UpdateModel");this.uq.a3l();n.stop();this.pX.As&&this.uq.AHc()&&k.ULS.sendTraceTag(574734882,
327,50,String.format("Comments loaded into the model at {0}",Ye.a.me()));Bi.a.get_instance().dG(12);k.ULS.sendTraceTag(574734883,327,50,"CommentRendered AppInitializationStatus was set");this.dK.Bac=!0;this.G8d.then(()=>{this.sh.p3l();if(this.pX.As){let O=!1;if(this.FBb){var z=this.Jqa.nwe(this.FBb);z?(l.AFrameworkApplication.Yi("3ge3g205;cha3g788"),z=this.Jqa.owe(z,0),z)?this.uq.M5a(z)||(O=!0,this.XLm(z)):(O=!0,this.b7a()):O=!0}z=a?a.w9i:null;this.OH.trackChangeInSidetrackEnabled?this.T8i(O,z):this.wlm(O,
z)}a&&a.xWa&&a.xWa();for(let O of this.epf)O();this.Vzh&&this.aNi();this.epf=[]})}catch(n){k.ULS.sendTraceTag(539567713,327,10,`Comments Initialization Failed: ${n}`)}finally{d.stop()}this.Tb.processAction(Sa.a.MNf,2)}}XLm(a){this.Tb.processAction(Sa.a.o1,2);this.m_.dCj();ao.a.oaa(l.AFrameworkApplication.tb,()=>{this.Jqa.selectComment(a,Object.assign(Object.assign({},new ew.a),{p5:!0,doa:1}));this.Wg.wf(Ec.AFrame.Zs);k.ULS.sendTraceTag(574734912,327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",
(new Date).getTime()-l.AFrameworkApplication.WJ)},fw.a.Rfn);this.YNf.hM(Sa.a.Jne);l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordLinkToCommentSettings")}b7a(){this.Tb.processAction(Sa.a.b7a,2)}wlm(a,d){this.sh.wYi().then(()=>{this.RUd();this.T8i(a,d)}).catch(n=>{k.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+n.toString())})}RUd(){this.OH.trackChangeInSidetrackEnabled?this.Lue.RUd():this.Lue.bAj(this.uAl)}aNi(){this.gMh||(this.dK.W7&&
this.G8d?(this.G8d.then(()=>{const a=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();this.cen.execute(d=>{a.registerSafelinksNavigator(d.cVc.bind(d))});this.Tcn.execute(d=>{d.k2m(a)})}),this.gMh=!0):(k.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),this.Vzh=!0))}Vzi(){return new JH(l.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,l.AFrameworkApplication.uiCulture,l.AFrameworkApplication.dataCulture)}WLm(){this.Jqa.suj(this.FBb,
Object.assign(Object.assign({},new ew.a),{G4g:!1,oCd:!0}));this.YNf.hM(Sa.a.Jne)}}Object(t.a)(XN,"CommentInitActor",null,[]);class GF{constructor(a,d,n,z,O,ca){this.ag=a;this.mk=d;this.PQ=n;this.ga=z;this.y_a=O;this.Bg=ca;this.xfh=this.Kbb=null}get zoom(){let a=1;this.Bg&&this.Bg.instance&&(a=this.Bg.instance.Ei);return 0<a?a:1}Xil(a){if(!this.xfh)return null;const d=this.zoom,n=a.bha,z=a.V3b(1,Tw.$ig,d);return this.G0k(n,(this.xfh.y-a.IUa[0].y)/d+Tw.PVj,z)}G0k(a,d,n){if(this.Kbb){var z=this.Kbb.parentElement;
z&&z.removeChild(this.Kbb);this.swj(a,this.Kbb,d,n);return this.Kbb}const O=a.Cf.ownerDocument;z=O.createElement("div");z.className=GF.lVk;this.swj(a,z,d,n);d=O.createElement("img");d.className=Vf.getImageClassWithCluster(l.AFrameworkApplication.YL,eD[4]);d.src=l.AFrameworkApplication.ln;d.title=CommonUIStrings.l_CommentNewCommentButton;d.alt=CommonUIStrings.l_CommentNewCommentButton;d.setAttribute("role","button");z.appendChild(d);this.i3m(d,a);return this.Kbb=z}i3m(a,d){this.ag.vD(vb.a.click,a,
this.UEm.bind(this),d);this.ag.Ea(vb.a.nz,a,this.WEm.bind(this));this.mk.Ea(vb.a.jM,a,this.YEm.bind(this));this.mk.Ea(vb.a.IY,a,this.XEm.bind(this));this.PQ.Ea(a,this.VEm.bind(this))}j_l(){if(this.Kbb){const a=this.Kbb.parentElement;a&&a.removeChild(this.Kbb)}}swj(a,d,n,z){this.y_a.Icl(a,n)?d.style.left=z+Tw.$ig+"px":d.style.left=z+"px";d.style.top=n+"px";d.style.right="auto";d.style.display="block";d.style.position="absolute";d.style.overflow="hidden";d.style.cursor="default"}WEm(){return!0}UEm(a){this.ga.gz=
30;this.ga.processAction(Sa.a.newComment,2);a=a.qk;a.className=Vf.getImageClassWithCluster(l.AFrameworkApplication.YL,eD[4]);a=a.parentElement;(null===a||void 0===a?0:a.parentElement)&&a.parentElement.removeChild(a);return!0}YEm(a){a.qk.className=Vf.getImageClassWithCluster(l.AFrameworkApplication.YL,NN[4]);return!0}XEm(a){a.qk.className=Vf.getImageClassWithCluster(l.AFrameworkApplication.YL,eD[4]);return!0}VEm(){return!0}}GF.lVk="clip16x16 EntryPointContainer";Object(t.a)(GF,"CommentMarginEntryPointActor",
null,[]);var HF=b(912);class YN{constructor(a){this.W8h=a;this.I1c=null;this.SFh=void 0;this.TFh=null;this.G8c=new Map;this.Adf=new Map}L4m(){HF.a.uKa(this.wLn.bind(this))}wLn(a,d){let n=a.id.toString();var z=a.getValue(Qb.a.IF).toString();d?(this.G8c.delete(n),this.Adf.delete(z)):(this.G8c.set(n,a),this.Adf.set(z,a));0===this.G8c.size&&this.I1c&&(a=+new Date-+this.I1c,this.I1c=null,k.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${a}`));
d||this.SFh!==z||(d=+new Date-+this.TFh,k.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${d}`),z=new Sg.a,z.durationMs=d,this.W8h.fl("CommentDeepLink","CommentFoundAfterDeeplinkAttempt",{isInternal:!0,EA:z},{name:"CommentDeepLinkNavigationFailed",isIntentional:!1,isInternal:!0,isSessionEndingError:!1,EA:z}));this.I1c||(this.I1c=new Date)}set txm(a){this.SFh=a;this.TFh=new Date;if(a=this.bvl(a))k.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${a.id} present but failed to load`),
a=new Sg.a,this.W8h.fl("CommentDeepLink","CommentPresentButFailedToLoad",{isInternal:!0},{name:"CommentDeepLinkNavigationFailed",isIntentional:!1,isInternal:!0,isSessionEndingError:!1,EA:a})}cvl(){return[...this.G8c.keys()]}bvl(a){return this.Adf.get(a)}fvi(a){return this.G8c.get(a)}}Object(t.a)(YN,"CommentNodeTracker",null,[]);class eC extends Sys.EventArgs{constructor(){super();this.w9i=this.xWa=null}}Object(t.a)(eC,"OnCommentInitArgs",Sys.EventArgs,[]);class pE{constructor(){this.commentId=null;
this.xEd=!1}}Object(t.a)(pE,"CommentToSelectOnPaneLoadData",null,[]);class ZN{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je){this.zs=a;this.cS=d;this.Q8h=n;this.Jqa=z;this.bDb=O;this.dK=ca;this.Lue=Da;this.pX=Xa;this.ZAc=zb;this.SFd=Vb;this.Tb=Fc;this.gkm=Yc;this.Wg=yd;this.mj=je;this.Tb.ma(Sa.a.QNb,Cd.a.frame,this.zs.QNb.bind(this.zs));this.Tb.ma(Sa.a.spd,Cd.a.frame,this.spd.bind(this));this.Tb.ma(Sa.a.ild,Cd.a.frame,this.EDm.bind(this));this.Tb.ma(Sa.a.z8h,Cd.a.frame,this.DDm.bind(this));this.Tb.ma(Sa.a.YDg,
Cd.a.frame,this.wHm.bind(this));this.Tb.ma(Sa.a.fXf,Cd.a.frame,this.IEm.bind(this));this.Tb.ma(Sa.a.QNf,Cd.a.frame,this.SFm.bind(this));this.Tb.Aa(Sa.a.Lne,Cd.a.frame,this.eDk.bind(this),64);this.Tb.Aa(Sa.a.kld,Cd.a.frame,this.V5m.bind(this),64);this.Tb.ma(Dc.a.selectComment,Cd.a.frame,this.Jqa.Ofn.bind(this.Jqa));this.fUh(Dc.a.vod,!1);this.fUh(Dc.a.kVf,!0);this.Tb.Aa(Dc.a.Nne,Cd.a.frame,this.Nne.bind(this),64);this.Tb.ma(Dc.a.f0i,Cd.a.frame,Bc.ActionManager.Ke);this.pX.x3b&&this.Tb.ma(Dc.a.rJf,Cd.a.frame,
this.GLk.bind(this))}get uq(){return this.cS}get mode(){return this.zs.mode}get yD(){return this.zs.yD}get $C(){return this.pX.As}get $i(){return this.SFd.value}get Oa(){return this.gkm.value}get Q3(){return this.zs}spd(a,d,n,z,O){if(!O)return k.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8;if(!O)return k.ULS.sendTraceTag(540160449,327,10,"ActionData could not be cast to dict: DoesCommentExist"),8;a=this.Jqa.nwe(O.NavigationId);if(this.pX.Gcl){if(!a)return 8}else if(a)return 32;
return this.Jqa.owe(a,1)?32:8}EDm(a,d,n,z,O){O&&this.bDb.rKa("OnCommentInit",Object.assign(Object.assign({},new eC),{xWa:()=>{var ca=this.Jqa.nwe(O.NavigationId);if(ca){var Da=this.Jqa.owe(ca,1);Da?this.ZAc.isVisible?(this.QSd(Da,1),this.Wg.Wv(Ec.AFrame.Zs)):this.uq.M5a(Da)?(ca=ti.Drg(Da),this.Jqa.selectComment(Da,Object.assign(Object.assign({},new ew.a),{p5:!ca,doa:1})),this.Wg.Wv(Ec.AFrame.IP)):(this.dK.xq||this.Tb.processAction(Sa.a.o1,2),ao.a.oaa(l.AFrameworkApplication.tb,()=>{this.QSd(Da,1)},
fw.a.QSd)):this.Tb.processAction(Sa.a.b7a,2)}}}));return 32}DDm(a,d,n,z,O){O?(a=this.uq.wtd(O))?this.Q3.CNc(a.id):k.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.Q3.CNc(null);return 32}wHm(a,d,n,z,O){if(O){if(this.dK.Bac){for(a=0;a<O.length;a++)this.uq.pwj(O[a]);this.zs.Vic()}else this.uq.ixk(O);this.Vom(O)}return 32}IEm(a,d,n,z,O){if(O)if(this.dK.Bac){for(a=0;a<O.length;a++)this.uq.pwj(O[a],!0);this.zs.Vic()}else this.uq.xSk();return 32}SFm(a,
d,n,z,O){this.$C||this.dK.xq||this.Tb.processAction(Sa.a.o1,2);if(O){a=null;if(!this.yD||2!==this.mode&&3!==this.mode){if(!O)return 8;if(this.$C)a=this.dkl(O);else for(d=0;d<O.length&&(a=this.uq.jba(O[d].toString()),this.Lue.AFe&&(!a||a.done));d++);}else a=this.yD;this.QSd(a,1);a&&this.dK.W7&&this.Wg.wf(this.$C&&!this.dK.xq?Ec.AFrame.IP:Ec.AFrame.Zs)}else k.ULS.sendTraceTag(5017933,327,10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}eDk(a,d,n,z,O){var ca;if(!O)return 32;
if(O&&0<O.length){d=a=n=0;z=!1;for(let Da=0;Da<O.length;Da++)O[Da].toString()===(null===(ca=this.yD)||void 0===ca?void 0:ca.objectId)?(z=!0,a++):this.cS.Jqg(O[Da])&&(z&&0===n&&(n=Da,d=a),a++);(ca=this.cS.jba(O[n].toString()))?(this.Q8h.FUc.qEg=d+1,this.Q8h.FUc.IUc=a,this.Q3.CNc(ca.id)):(O=O[n],this.$i.Ta(O)?k.ULS.sendTraceTag(540148256,327,10,`Comment Node with ObjectId ${O} has no corresponding comment in Model`):k.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",
O.toString()))}return 32}V5m(){this.Q3.CNc(null);return 32}fUh(a,d){this.Tb.ma(a,Cd.a.frame,(n,z,O)=>this.nEm(O,d))}nEm(a,d=!1){if(2===a)a=this.uq.Iba.Wb(15),a.Sa(this.uq.gwb),this.mj.Fd(()=>{this.vod(d)},"ECM:DAC"),a.dispose();else if(1===a&&!this.uq.AHc())return 2;return 32}vod(a=!1){this.zs.mode=1;const d=this.uq.eba();for(let n of d)n.Dv===qo.beingCreated||a&&!n.done||n.Lg||this.zs.deleteComment(n);this.Wg.wf(Ec.AFrame.ao);0<(a?this.uq.eba().filter(n=>n.done):this.uq.eba()).length?k.ULS.sendTraceTag(540160454,
327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",a):k.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",a)}Nne(a,d,n){if(2===n)if(a=this.Wg.Zd.name,a!==Ec.AFrame.Zs&&a!==Ec.AFrame.IP){!this.$C||this.dK.xq?(this.dK.xq||this.Tb.processAction(Sa.a.o1,2),this.Wg.wf(Ec.AFrame.Zs)):this.Wg.wf(Ec.AFrame.IP);var z=this.Oa.ya.Ba;if(!z||!z.ra)return 2;a=z.ra.cpBegin;d=z.ra.node;z=!!this.yD&&(Qd.SelectionEditor.qj(z)||z.bM)&&ti.ypg(this.yD,d,
this.$i,a);a=!!this.yD&&(2===this.mode||3===this.mode);if(z||a)return this.Q3.wuj(this.yD.id,!0),32;z=this.$C&&!this.dK.xq?this.uq.ivi(!0,!0):null;this.Q3.Yfn(z)}else this.uq.Ou&&(this.zs.bIc.ruj(this.uq.Ou,!0),this.zs.bIc.fnb(null===(z=this.uq.Ou)||void 0===z?void 0:z.objectId)),this.Wg.wf(Ec.AFrame.ao);return 32}GLk(){return 4}Vom(a){const d=new Set;for(let n=0;n<a.length;n++){const z=this.uq.wtd(a[n]);z&&d.add(z.Lg?z.Lg:z.id)}k.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",
d.size.toString())}QSd(a,d){a?this.ZAc&&!this.dK.W7?this.dK.dDb=Object.assign(new pE,{commentId:a.id,xEd:!1}):this.Jqa.selectComment(a,Object.assign(new ew.a,{p5:!!d,doa:d})):k.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}dkl(a){let d=null,n=!1;for(let z=0;z<a.length;z++){const O=a[z].toString();if(this.uq.Jqg(a[z])){d||(d=O);if(n&&this.uq.Ou.objectId!==O)return this.uq.jba(O);n=n||!!this.uq.Ou&&this.uq.Ou.objectId===O}}return d?this.uq.jba(d):null}}Object(t.a)(ZN,
"CommentsActionManager",null,[]);var IF=b(1632),JF;(function(a){a[a.i0n=0]="commentDeeplink";a[a.catchUpActivity=1]="catchUpActivity"})(JF||(JF={}));Object(t.b)("DeeplinkSource",JF);class $N{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc){this.ga=a;this.Jh=d;this.Fz=n;this.Oaf=z;this.mW=O;this.ANh=ca;this.ib=Da;this.xf=Xa;this.xe=zb;this.odb=Vb;this.vRb=Fc;this.bW=Yc;this.avf=!1;this.qon=yd=>{if(this.xe.As&&!this.xf.xq){const je=new bf.a(0,1,0,()=>{this.cwj(yd)},136,void 0,!0);l.AFrameworkApplication.tb.rb(je)}else this.cwj(yd)}}get cS(){return this.Jh}get Oa(){return this.odb.value}Oji(a){let d=
a.Dv===qo.beingCreated?a.YG.draftId:a.id,n=null;a.Lg&&(d=a.Lg,n=()=>{this.ANh.selectComment(a.id)});this.mW.setInitialActiveContainerId(d,0,n)}Ofn(a,d,n,z,O){if(!O.commentId)return 2;a=this.Jh.NP(O.commentId);if(!a)return 2;this.FMb(a,O);return 32}uuj(a,d){var n,z;if(a){var O=(null===(z=null===(n=this.Jh.ZL)||void 0===n?void 0:n.YG)||void 0===z?void 0:z.draftId)===a?this.Jh.ZL:this.Jh.NP(a);this.selectComment(O,d)}}selectComment(a,d){a&&this.FMb(a,d)}suj(a,d){var n=this.nwe(a);n&&((n=this.owe(n,0))?
d.G4g?(this.xf.dDb=Object.assign(new pE,{commentId:n.id,xEd:!0}),k.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):(this.FMb(n,Object.assign(new ew.a,{commentId:n.id,doa:1,p5:!0,oCd:!0})),this.xe.As&&void 0!==a&&null!==a&&this.Oji(n),ao.a.oaa(l.AFrameworkApplication.tb,()=>{this.ib.wf(this.xe.As&&!this.xf.xq?Ec.AFrame.IP:Ec.AFrame.Zs)},fw.a.Kkn),pk.a.instance.Hd(ai.a.yUf,(new Date).getTime()),a=this.xe.As?"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",
a+=", elapsed since boot: {0} ms",k.ULS.sendTraceTag(579608865,327,50,a,(new Date).getTime()-l.AFrameworkApplication.WJ)):this.ga.processAction(Sa.a.b7a,2))}nwe(a){let d=null;var n=null;if(w.a.UHb(a))d=a;else if(({at:n}=x.d(a)).returnValue&&(a=n))if($D.a.comment in a)d=a[$D.a.comment];else if($D.a.YEg in a)return k.ULS.sendTraceTag(553763410,327,50,"Navigation Id is meant for nudge to web, not comments."),d;d||(n=n?Object.keys(n):null,k.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",
n?n.join(","):"Not Json."));return d?d.toString():null}owe(a,d){const n=this.Jh.wtd(a),z=0===d;z&&this.bW.Lq("CommentDeepLink",0);if(!n){k.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",a,d);const O=new ba.a;O.name="DeepLinkSource";O.string=JF[d];this.bW.logActivity(ti.h7k,{dataFields:[O]});z&&(this.bW.fl("CommentDeepLink","CommentNotFound",{isIntentional:!1,isInternal:!0}),this.vRb.txm=a)}return n}cwj(a){this.avf=!0;this.Oa.setSelection(a);
this.avf=!1}FMb(a,d){if(a){this.xf.ngc&&(l.AFrameworkApplication.tb.ie(this.xf.ngc),this.xf.ngc=null);var n=this.Jh.Ou,z=this.cS.RBi(a),O=2===d.doa,ca={};O&&(ca.TriggeredByFindReplace=!0);if(this.xf.xq)O&&(ca.PaneAlreadyOpen=!0),xk.UISurfaces.Nv().then(Da=>{Da.setSelectedTaskPane(IF.a.One);return null});else if(a.Dv!==qo.beingCreated&&!this.cS.M5a(a))this.xf.W7?this.ga.processAction(Dc.a.o1,2):this.xf.dDb=Object.assign(new pE,{commentId:a.id,xEd:d.oCd}),O&&(ca.OpeningPaneToSelect=!0);else if(this.xe.As){const Da=
z.Dv===qo.beingCreated;Da?this.mW.HKa(z.YG.draftId,0,d.p5):this.mW.HKa(z.id,0,d.p5);!Da&&O&&(ca.SelectingDHC=!0)}ao.a.oaa(l.AFrameworkApplication.tb,()=>{this.xf.W7&&(d.p5&&this.ib.wf(this.xe.As&&!this.xf.xq?Ec.AFrame.IP:Ec.AFrame.Zs),d.oCd&&this.cS.M5a(a)||!d.p5&&!d.doa||this.ANh.selectComment(a.id))},fw.a.J0g);this.Jh.selectComment(a);this.Oaf.highlightComment(a,!0);this.Fz.rM(0,z,n);Lb.App.oa.updateCommandUI(!0);0<Object.keys(ca).length&&this.bW.hM(Dc.a.selectComment,{customData:ca})}}}Object(t.a)($N,
"CommentSelectionActor",null,[689]);class qE extends eq.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new wq.a,{T_:qE.getTypeName(),B_:qE.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(t.a)(qE,"CommentSmartReplySignal",eq.a,[]);class KF extends Op.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=
null;this.H_=Object.assign(new wq.a,{T_:KF.getTypeName(),B_:KF.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(t.a)(KF,"SmartReply",Op.a,[]);class LF{constructor(a){this.AEa=a}ond(a,d){return Object.assign(new kb.a,{parentPath:["Signal",qE.getTypeName()],items:[Object.assign(new Sq.a,{body:Object.assign(new qE,{commentId:a,comment:d})})]})}jNg(a){const d=new db.a;if(a&&a.CommentId&&a.ResultSets&&0<a.ResultSets.length&&
a.ResultSets[0].Documents&&0<a.ResultSets[0].Documents.length){for(const n of a.ResultSets[0].Documents)d.add(n.Caption);0<d.count&&this.AEa.jNg(a.CommentId,d.toArray())}else k.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return KF.getTypeName()}}Object(t.a)(LF,"BaseCommentSmartReplyProvider",null,[940]);class aO extends LF{constructor(a,d,n,z){super(a);this.lg=d;this.Qea=n;this.h3j=z}initialize(){this.Qea.ar().then(()=>{this.lg.Ea(this,LF.prototype.getTypeName.call(this))})}invoke(a,
d){this.Qea.ar().then(()=>{this.h3j.getAugLoopRuntimeManager().submitOperation(Object.assign(new Na.a,{operation:this.ond(a,d)}))})}sS(a,d){a&&Gj.a.getTypeNameFor(a.content)===this.getTypeName()&&d===Jn.a.getTypeName()?this.jNg(a.content):k.ULS.sendTraceTag(579170963,327,10,"Invalid annotation event for smart replies")}}Object(t.a)(aO,"CommentSmartReplyProvider",LF,[280]);class oz{}oz.commentNode=null;oz.imj=null;Object(t.a)(oz,"CanaryCommentNode",null,[]);class bO{constructor(a,d,n,z,O,ca){this.va=
a;this.Ja=d;this.Xy=n;this.Rlf=z;this.vRb=O;this.OH=ca;this.TUb=!1;this.vRb.L4m();this.wrh=this.EHl();this.MRg&&(Qc.a.addHandler(window.self,vb.a.JDf,()=>{this.TUb=!0}),Qc.a.addHandler(window.self,vb.a.KDf,()=>{this.TUb=!1}));0<this.wrh&&(l.AFrameworkApplication.Yi("i1708223;c2j3e430"),l.AFrameworkApplication.Yi("WoCom926;WoCom926cf"),l.AFrameworkApplication.Yi("9aed8253;eb09b796"),l.AFrameworkApplication.Yi("h6f1a346;8cc44455"),l.AFrameworkApplication.Yi("aed6f872;c1818808"))}get DH(){return this.Xy?
this.Xy.value:null}get yib(){return this.Rlf.value}get DIn(){return this.TUb}get eyd(){return 0<this.wrh}get As(){return this.OH.As}get Eal(){return!0}get tKb(){return this.va.ea("OutlineViewElementDisplayWrapperForDhcsIsEnabled")}get Anc(){return this.Ja.isFeatureEnabled(193)&&!Rj.App.KDd}get NRd(){return this.va.ea("RetainSelectionForNewCommentIsEnabled")}get Ugn(){return this.Ja.isFeatureEnabled(53)&&this.va.ea("SendErrorReportOnCommentInboundCrashIsEnabled")}get ZDg(){return this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.newCommentEntryPointEnabled",
!1)}get CVe(){return this.Ja.isFeatureEnabled(30)}get G$k(){return this.OH.tgi}get B8h(){return this.va.ea("CommentAnchorHighlightOnIpSelectionIsEnabled")}get fua(){return this.OH.fua}get Z7k(){return this.va.ea("DelayLoadCommentNodeInModelOnPasteIsEnabled")}get MRg(){return this.va.ea("RecordCommentActionsInTypingIsEnabled")}get A6i(){return this.va.ea("NoHighlightWhenCommentDraftInProgressIsEnabled")}get OAm(){return this.va.ea("NotifyResolvedCommentsLocationIsEnabled")}get B6b(){return this.As&&
!this.eyd&&!this.va.Ga("BootActivityNavigationId")&&I.a.xm}get x3b(){return this.Ja.isFeatureEnabled(16)}get oFk(){return this.va.ea("AtMentionUserFloodGateCampaignIsEnabled")}get nVk(){return this.va.ea("CommentFriendlyTimestampsIsEnabled")}get Bal(){return this.va.Ga("DisabledChangeGatesInSharedComments")}get EEc(){return this.OH.EEc}get Dmc(){return this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",!1)}get jCb(){return this.Ja.isFeatureEnabled(27)}get A6g(){return this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",
!1)}get Z4(){return this.va.Ga("PresenceUserId")}get removePersonalInformation(){return Rj.App.c5e&&!!mi.PageReader.instance&&mi.PageReader.instance.NN(Lb.App.oa.za.jc).removePersonalInformation}get Fel(){return this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableLoggingForEmptyComments",!1)}get tQk(){return this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckIfCommitUiRefreshEventReceived",!1)}get bKc(){return this.Ja.isFeatureEnabled(86)}get sEb(){return this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",
!1)}get Hhi(){return this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.DoNotFocusFloatingCommentOnEdit",!1)}get Q4i(){return this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.MissingCommentsDiagnosticsEnabled",!1)}get R5k(){return this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.CtrlEnterTipIsEnabled",!1)}get pFk(){return this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.AtMentionHintMessageIsEnabled",!1)}get klm(){return this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.SharedCommentsLivePersonaCardForWeb",
!1)}get rcn(){return this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.RetryLoadForFailedCommentEnabled",!1)}get rCn(){return this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",!1)}get GVk(){return this.va.ea("CommentsTasksFpsIsEnabled")}get trackChangeInSidetrackEnabled(){return this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1)}get wVk(){return this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReactionsFPSEnabled",
!1)}get Gcl(){return this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.DoesCommentExistFixIsEnabled",!1)}get U8h(){return this.va.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentManagerResolveCrashFixIsEnabled",!1)}EHl(){if(this.DH&&this.yib){var a=new Dd.GraphIterator;a.set(this.DH);this.yib.vJb(a);let d=0;39===a.Yc&&(d=a.Sr());if(0<d)for(a=Yi.a.Ql(a.currentNode);a.moveNext();)if(a.currentNode&&40===a.currentNode.type){oz.commentNode=a.currentNode;break}return d}return-1}}Object(t.a)(bO,
"CommentsSettings",null,[]);class cO{constructor(a){this.Gia=a}j2h(a,d,n){const z=new DH;d=this.Gia.rpb(d)?d.objectId:null;if(!d)return z;d=E.a.qe(d);if(n.contains(d))return z.Mzd=0,z.Lzd=a.length,z;for(let ca=0,Da=a.length;ca<Da;ca++){var O=a[ca];n=ti.z4a(O);O=ti.dvi(O);n&&lF.a.r$h(n,d)&&(z.Mzd=ca);if(O&&lF.a.r$h(O,d)){z.Lzd=ca;break}}return z}YYh(a,d,n){const z=-1===d.Mzd&&-1===d.Lzd,O=-1<d.Mzd?d.Mzd:-1;d=-1<d.Lzd?d.Lzd:a.length;const ca=!z&&O===d;var Da=!1;for(let Xa=0;Xa<a.length;Xa++){const zb=
a[Xa],Vb=kn.a(zb);if(1!==Vb&&2!==Vb&&3!==Vb)continue;this.Gia.gsb(zb);if(z||Xa<O||Xa>d)continue;const Fc=3===Vb||2===Vb&&-1!==zb.className.indexOf(Ji.a.uac),Yc=n?1:2;this.ZDk(Xa,O,d,Yc,Fc,Da,zb,ca);if(Xa!==d||ca)(Da=this.Gia.enb.J(Vb).J(Yc))&&zb.classList.add(Da),Da=Fc}}ZDk(a,d,n,z,O,ca,Da,Xa){a!==d&&a!==n||O||ca||((a=this.Gia.VOc.J(z))&&Da.classList.add(a),Xa&&Da.classList.add(Ji.a.PMg))}}Object(t.a)(cO,"DefaultHighlightChangeHandler",null,[688]);var MF;(function(a){a[a.success=0]="success";a[a.noSelection=
1]="noSelection";a[a.invalidContent=2]="invalidContent"})(MF||(MF={}));Object(t.b)("AnchorCreationResult",MF);class dO{}Object(t.a)(dO,"EditorAnchorInfo",null,[704]);class zy{constructor(a,d,n,z,O){this.tNh=null;this.cmf=a;this.odb=d;this.qW=n;this.y_a=z;this.ic=O;this.qW.MLb(this.y_a)}get Oa(){return this.odb.value}get $i(){return this.cmf.value}initialize(){}w3l(a){this.tNh=a}dispose(){}fnb(a){this.y_a.fnb(a)}dac(a){this.y_a.dac(a)}highlightComment(a){this.ruj(a,!1);this.y_a.fnb(a.objectId)}wVc(a){this.y_a.wVc(a)}DTa(a){return this.y_a.DTa(a)}ruj(a,
d){if(!a.Dv){var n=this.$i.Ta(E.a.qe(a.objectId)),z=Xj.a.Sla(n,this.$i,!0);n=Xj.a.Sla(n,this.$i,!1);if(z&&n){const O=z.Wa.paragraph;z=z.Wa.cp;if(this.lfm(O,z))Lb.App.oa.updateCommandUI(!0);else{z=ye.SelectionFactory.Pc(O,z);n=fe.a.Kb(n.Wa.paragraph,n.Wa.cp);if(zy.If.t4(z.ra)||zy.If.t4(n))a.rKc=!0,a.sfc();a=d?ye.SelectionFactory.Mx(z,n):z;this.tNh(a)}}}}lSk(){this.y_a.dac(null);this.y_a.fnb(null)}QZk(){let a=new dO;return{returnValue:MF.success,anchor:a}}lfm(a,d){if(a&&Object(Uc.a)(WG.PageView,this.ic.sc)){var n=
a.Qd(this.ic.sc.Za);a=document.getElementById(og.AppFrame.VDa);if(n&&a){d=iu.a.xl(n,d);if(!d)return!1;d=d.y;n=Sys.UI.DomElement.getBounds(a).y;a=a.offsetHeight;if(d>=n&&d<=n+a)return!0}}return!1}static get If(){return aj.a.instance}static getInstance(){return zy.al()}static al(){return zy.na||(zy.na=new zy(new Nf.a(()=>Lb.App.oa.za.jc.kd),new Nf.a(()=>Lg.a.instance),la.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,la.a.instance.resolve("WordEditor.Comments.CommentHintActor"),
Ic.InteractiveViewManager.instance))}}zy.na=null;Object(t.a)(zy,"EditorCommentHintManager",null,[686,687,12]);var EQ=b(1004);class pz extends yo.a{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le,Ve,gg,Lh,Ki,Ak,Uk,Rl,kk){super(Da);this.aj=d;this.odb=Xa;this.KNf=Vb;this.BEa=Fc;this.Raf=Yc;this.mW=yd;this.xe=je;this.jk=Le;this.Aab=Ve;this.xf=gg;this.G1=Lh;this.Ad=Ak;this.bW=Uk;this.te=Rl;this.m_=kk;this.ROh=this.vcb=null;this.lCm=()=>{var dn=()=>!0;this.$C&&!this.xf.xq&&(dn=fs=>this.cS.M5a(fs));
dn=this.cS.$5f(dn);this.Vic(dn)};this.ga=Da;this.wC=1===this.ga.mode?0:1;this.y9=O;this.Jh=z;this.mja=ca;this.ib=zb;Ki&&Ki.h3(()=>{this.uzn()});n.LLb(this.BEa);(this.xe.B8h||this.xe.ZDg)&&this.Oa.dE(Object(m.a)(this,this.cCa,"onSelectionChange"));a.CWR(()=>a.result.oC.RBb(Object(m.a)(this,this.cCm,"onAfterKickout")));l.AFrameworkApplication.la&&l.AFrameworkApplication.la.l2a(Object(m.a)(this,this.pId,"modeSwitched"));this.G1.JLb("OnAfterTrackChangeMarkupViewChange",this.lCm);l.AFrameworkApplication.QH&&
l.AFrameworkApplication.QH(()=>{this.vQk()})}get Oa(){return this.odb.value}get uq(){return this.Jh}get cS(){return this.Jh}get $C(){return this.xe.As}get q6i(){return!0}get fIc(){return this.vcb}set fIc(a){this.vcb=a}get yD(){return this.model&&this.model.Ou?this.model.Ou.Lg?this.model.NP(this.model.Ou.Lg):this.model.Ou:null}get $i(){return this.aj.value}get fCj(){return!1}get removePersonalInformation(){return this.xe.removePersonalInformation}pId(a){2===a.mode?this.wC=1:1===a.mode&&(this.wC=0);
this.Jh.ZL&&0===this.wC?k.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",this.Jh.ZL.YG.sessionType):this.xf.W7&&(this.$C||this.y9.isVisible)&&this.Vic()}Vic(a=null,d=null){const n=this.cS,z=!this.wC,O=this.Fna.mVk,ca=n.zye();O.$dh(ca?5:1,z);a=this.xe.Dmc&&a?a:n.H6f(this.xe.Dmc&&this.$C&&!this.xf.xq);O.Pgn(a,ca,n.Bab);d&&k.ULS.sendTraceTag(572281362,327,50,d)}fKd(a,d,n=!1){this.xf.xq?this.mW.$Pj():d?this.mW.deleteContainer(a.Dv===
qo.beingCreated?a.YG.draftId:a.id,0,n):this.FZm(a)}FZm(a){const {MDn:d}=this.Jh.$Cl(a),n=this.mja.DTa(a.objectId);n&&this.mW.addContainer(a.id,n.parentElement,0,d)}Auj(a){const d=this.yD;this.GRc();this.BEa.rM(0,this.Jh.Ou,d);this.$C&&this.Jh.Ou&&!this.xf.xq&&this.mW.HKa(this.Jh.Ou.id,0,1===a)}Zfn(){const a=this.yD;this.HRc();this.BEa.rM(0,this.Jh.Ou,a);this.$C&&this.Jh.Ou&&!this.xf.xq&&this.mW.HKa(this.Jh.Ou.id,0,!1)}wVc(a){this.mja.wVc(a)}mel(a,d){this.mW.addContainer(a,null,0,d)}ZPm(a){this.mW.dej(a)}nel(a,
d){this.mW.YQd(a,d,0)}iMn(){this.mW.eGf()}tuj(a){if(a&&(2!==this.mode||a.Dv===qo.beingCreated)){var d=this.Jh.Ou;d!==a&&(this.Jh.selectComment(a),this.y9.isVisible?this.xf.W7?(this.y9.selectComment(a,1),this.Dva.selectComment(a.id)):this.xf.dDb=Object.assign(new pE,{commentId:a.id,xEd:!1}):this.$C&&!a.done&&(this.wuj(a.id,!1),this.Dva.selectComment(a.id)),!this.y9.isVisible&&this.$C&&a.done||(this.bIc.fnb(a.objectId),this.BEa.rM(0,this.yD,d)))}}cCm(){this.xf.Bac?this.mode=0:this.wC=0}kAd(){}AZf(){this.xf.Bac=
!1}v2b(a){this.xe.A6i&&this.Jh.Ou&&this.clearSelection();super.v2b(a);this.bW.Lq("CommentThreadInProgress",0);if(this.$C){const d=this.Jh.dRl(a.draftId);this.mel(a.draftId,d)}}addReply(a,d){this.bW.Lq("CommentReplyInProgress",0);super.addReply(a,d)}TGa(a){this.$C&&null!=a.YG&&this.Jh.Pmj(a.YG.draftId);super.TGa(a);this.mja.fnb(a.objectId);k.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",ti.Wzc(a));this.bW.Lq("CommentCommit",0);this.yQk(a);Sw.pRn(a,this.$i,this.bW)}yQk(a){if(a.Lg){var d=
this.Jh.RBi(a);if(d.Myc&&d.Nyc){var n=this.$i.Ta(E.a.qe(d.Nyc));d=d.Nyc===d.Myc?null:this.$i.Ta(E.a.qe(d.Myc));Sw.Ujh(n,a,!0);Sw.Ujh(d,a,!1)}}}wod(a){super.wod(a);this.yD&&this.yD.id===a.id&&(super.clearSelection(),this.$C&&this.mW.BAc());if(this.$C)if(ti.Drg(a)){var d=[];let n=null;for(let z of this.model.eba())z!==a&&(z.Lg===a.Lg&&d.push(z),z.id===a.Lg&&(n=z));n&&n.id&&n.objectId&&!n.done&&this.cS.uH(n.objectId)&&!this.cS.Pej(n.objectId)&&!d.length&&this.fKd(n,!0)}else d=a.Dv===qo.beingCreated,
a.done||this.fKd(a,!0),d&&this.Jh.Pmj(a.YG.draftId)}editComment(a,d){1===this.mode&&a&&(this.Jh.Ipd(a,d),Vs.edit===d.sessionType&&this.bW.Lq("CommentEditInProgress",0),this.xe.Anc&&3!==Vs.s9f(d.sessionType)?this.Aab.selectComment(a,Object.assign(new ew.a,{p5:!this.xe.Hhi,doa:0})):this.xe.jCb||this.Aab.selectComment(a,Object.assign(new ew.a,{p5:!this.xe.Hhi,doa:0})))}EWe(a){this.$C&&!this.xf.xq||super.EWe(a)}deleteComment(a){a.Dv!==qo.beingCreated&&this.cS.Efi(E.a.qe(a.objectId));this.vcb&&this.vcb.id===
a.id&&(this.Jh.Ou&&this.vcb.id===this.Jh.Ou.id?this.vcb=null:this.BEa.iMf());!this.Jh.Ou||this.Jh.Ou.id!==a.id&&this.Jh.Ou.Lg!==a.id?this.Jh.Ou&&this.BEa.rM(0,this.Jh.Ou,null):void 0===a.Lg||null===a.Lg?this.clearSelection():this.Jh.selectComment(this.Jh.NP(a.Lg));a.rKc&&k.ULS.sendTraceTag(556360779,327,50,"The comment selected for deletion is currently locked: {0}.",ti.Wzc(a));super.deleteComment(a);k.ULS.sendTraceTag(50426377,327,50,`${ti.Wzc(a)} deleted by user action. DurableId: ${a.d7b}`)}t4b(a,
d){super.t4b(a,d);this.$C&&!this.xf.xq&&d&&(this.Jh.Ou&&this.Jh.Ou.id===a.id&&this.clearSelection(),this.fIc&&this.fIc.id===a.id&&this.BEa.iMf())}Yfn(a=null){(a=this.cS.$ul(a))?this.Aab.selectComment(a,Object.assign(new ew.a,{p5:!0,doa:1})):this.Auj(1)}cCa(a,d){a=d.zi.Ba;if((this.$C||this.Fna&&this.Fna.isVisible)&&!this.Aab.avf&&a&&2!==this.mode&&3!==this.mode){d=Qd.SelectionEditor.qj(a);var n=a.bM;this.xe.ZDg&&(!d||n?this.i2k(a):this.Raf.j_l());this.xe.B8h&&this.mHn(a,d,n)}}i2k(a){const d=a.ra.node;
let n=qe.OutlineElementNavigator.Fl(d);this.te.Fd(()=>{const O=Dd.GraphIterator.ua(n);let ca=null;do O.tn()&&(ca=O.parentNode?qe.OutlineElementNavigator.Fl(O.parentNode):null)&&(n=ca,O.set(n));while(ca)},"ECM:FOOE");if(null===n||void 0===n?0:n.GQ)for(var z of n.GQ)if(z&&z){const O=EQ.a.$ci(z);this.Raf.xfh=this.ejl(d,a);if(a=this.Raf.Xil(O))z.htmlElement.appendChild(a),z.BD(a);break}}ejl(a,d){let n;for(let z of a.GQ)if(z&&z){n=z;break}a=d.ra.cpBegin;return!n||0>a?null:iu.a.oP(a,n,!1,!1)}mHn(a,d,n){const z=
this.ib.Zd;let O=null;if(d||n){d=a.ra.cpBegin;a=a.ra.node;if(this.yD&&ti.ypg(this.yD,a,this.$i,d))return;O=this.LGl(a,d)}O?!this.$C||this.xf.xq?ao.a.oaa(l.AFrameworkApplication.tb,()=>{this.tuj(O)},fw.a.Qfn):this.tuj(O):!this.Jh.Ou||z&&z.name===Ec.AFrame.IP||this.clearSelection()}LGl(a,d){let n=null;const z=this.model.eba();for(let O=z.length-1;0<=O;O--){const ca=z[O];if(ca.objectId&&!(ca.Lg||this.$C&&!this.Fna.isVisible&&ca.done)&&ti.ypg(ca,a,this.$i,d)){n=ca;break}}return n}selectComment(a,d=1){this.Aab.uuj(a,
Object.assign(new ew.a,{p5:1===d,doa:d}))}wuj(a,d){const n=this.Jh.NP(a);n?this.$C&&!ti.Drg(n)&&n.Dv!==qo.beingCreated&&this.mW.HKa(a,0,d):k.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const a=this.model.Ou;super.clearSelection();this.BEa.rM(1,a,a);this.$C&&this.mW.BAc()}Zem(){var a;return 500>(null===(a=this.ROh)||void 0===a?void 0:a.ti)}CNc(a,d=1){if(!this.xe.A6i||!this.Jh.ZL){var n=this.Jh.NP(a),z=null;n||(z=this.vcb);var O=this.Zem(),ca=!1;1===d&&
this.Dva&&(O?ca=!0:this.Dva.highlightComment(a));a?n?O?ca=!0:this.mja.dac(n.objectId):k.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):this.mja.dac(null);n?O?ca=!0:(this.vcb=n,this.BEa.rM(2,n,z)):(this.vcb=null,this.BEa.rM(3,null,z));ca&&k.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}uzn(){this.Ad&&(this.ROh=this.Ad.Pe("UserAction","StartScrollDetectionStopwatch"))}notify(a,d){this.jk.sendNotification(a,
d)}vQk(){if(this.uq&&this.uq.ZL){var a=this.uq.ZL;if(a.YG.sessionType!==Vs.metadata){k.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${a.Dv} present on app shutdown`);a=Sw.Ayl(a);const d=new Sg.a;d.inStaging=!0;a&&this.bW.fl(a,"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:"CommentExperienceDegraded",isIntentional:!1,isInternal:!0,isSessionEndingError:!1,EA:d})}}}static getInstance(){return pz.al()}static al(){pz.Gh||(pz.Gh=new pz(Lb.App.Sra(),new Nf.a(()=>Lb.App.oa.za.jc.kd),la.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,
la.a.instance.resolve("Common.Comments.ICommentModel"),la.a.instance.resolve("Common.Comments.ICommentPane"),zy.getInstance(),l.AFrameworkApplication.pa,new Nf.a(()=>Lg.a.instance),ic.FocusManager.instance(),la.a.instance.resolve("WordEditor.Comments.IWordEditorSharedCommentAPI"),la.a.instance.resolve("WordEditor.Comments.ICommentHighlightActor"),la.a.instance.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),la.a.instance.resolve("WordEditor.Comments.IFloatingCommentManager"),la.a.instance.resolve("WordEditor.Comments.CommentsSettings"),
la.a.instance.resolve("Common.Utils.IAriaNotifier"),la.a.instance.resolve("WordEditor.Comments.ICommentSelectionActor"),la.a.instance.resolve("WordEditor.Comments.CommentsState"),la.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),Rj.App.wn.za.Rb,Lb.App.oa.Np,la.a.instance.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),Ln.a.instance,la.a.instance.resolve("WordEditor.Comments.ICommentFloatingContainerActor")),pz.Gh.Elc=!0);return pz.Gh}}pz.Gh=null;Object(t.a)(pz,"EditorCommentManager",
yo.a,[682,683,684,12]);var eO=b(1631);class fO{constructor(a,d){this.CommentId=a;this.ResolveState=d}}Object(t.a)(fO,"CommentProperties",null,[]);var jA;(function(a){a[a.unsaved=0]="unsaved";a[a.sentToServer=1]="sentToServer";a[a.succeeded=2]="succeeded";a[a.failed=3]="failed";a[a.saveNotNeeded=4]="saveNotNeeded"})(jA||(jA={}));Object(t.b)("CommentSaveStatus",jA);var FQ=b(26),GQ=b(1037),gO=b(1467);class fC{constructor(a,d="",n="",z="",O=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;
this.IsCurrentUser=!1;this.UserId=a;this.Provider=d;this.DisplayName=n;this.Email=z;this.IsCurrentUser=O}}Object(t.a)(fC,"OfficeSharedCommentUser",null,[]);class hO extends fC{constructor(a,d="",n="",z="",O=!1){super(a,d,n,z,O);this.DateUtc=null}}Object(t.a)(hO,"CommentReactionUser",fC,[]);var rE;(function(a){a[a.like=1]="like"})(rE||(rE={}));Object(t.b)("ReactionType",rE);var Nx;(function(a){a[a.first=0]="first";a[a.done=0]="done";a[a.undone=1]="undone";a[a.addComment=2]="addComment";a[a.deleteComment=
3]="deleteComment";a[a.editComment=4]="editComment";a[a.addReaction=5]="addReaction";a[a.removeReaction=6]="removeReaction";a[a.last=7]="last"})(Nx||(Nx={}));Object(t.b)("CommentChangeType",Nx);var iO=b(548);class jO{constructor(){this.rNh=this.cPh=!1;this.zqk=[]}get NUc(){return this.zqk}get Ymc(){return this.cPh}set Ymc(a){this.cPh=a;for(const d of this.NUc)d.Ymc=a}get elc(){return this.rNh}set elc(a){this.rNh=a;for(const d of this.NUc)d.elc=a}jvb(a){for(const d of this.NUc)a=d.jvb(a);return a}}
Object(t.a)(jO,"AggregateCommentTaskPersonTransformer",null,[906]);var KH=b(1416);class kO{constructor(a,d){this.wek=new Nf.a(()=>d.jvb(a.value))}zxl(){return new Date}Rib(a,d,n){if(0===a)throw k.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");const z=xa.a.create().toString();n=new KH.a(a,this.wek.value,n,z,!1);n.commentId=d;k.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",
a);return n}}Object(t.a)(kO,"HistoryRecordFactory",null,[908]);var LH=b(1483);class lO{constructor(a,d,n,z,O,ca){this.isLossy=a;this.title=d;this.assignees=n;this.schedule=z;this.completion=O;this.priority=ca}}Object(t.a)(lO,"CommentTaskState",null,[]);class mO{constructor(){this.commentId=null}}Object(t.a)(mO,"HistoryItem",null,[]);class MH{constructor(a,d,n,z,O,ca,Da){this.Tif=!1;if(1!==d.type)throw Error.argument("createRecord");this.H_c=n;this.E_c=z;this.F_c=O;this.AGh=1;this.c8d=a;this.igk=ca;
this._state=new lO(!1,this.H_c,Da,new LH.a,this.F_c,this.E_c);this._history=[];this.Jci(d)}fCc(a,d){if(1!==a.type)throw Error.argument("createRecordTemplate");const n=MH.QPl(a,this.AGh);this.AGh++;return Object.assign(new KH.a(d,a.user,a.time,n),{commentId:a.commentId})}get BWi(){return this.history[this.history.length-1]}get $Ii(){return this.state.completion===this.F_c}get ZIi(){return this.state.priority===this.E_c}get aJi(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&
(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get bJi(){return this.state.title===this.H_c}Jci(a){a=Object.assign(new mO,{commentId:a.commentId,records:[a]});this.history.push(a)}lti(a){let d=-1;for(let n=0;n<this.state.assignees.length;n++)if(this.c8d.equals(this.state.assignees[n],a)){d=n;break}return d}Mqn(a){const d=this.BWi,n=d.records[d.records.length-1];return this.c8d.equals(n.user,a.user)&&d.commentId===a.commentId&&n.time.getTime()===a.time.getTime()?!0:!1}bQn(a){switch(a.type){case 2:-1===
this.lti(a.assignee)&&this.state.assignees.push(a.assignee);break;case 3:const d=this.lti(a.assignee);0<=d&&this.state.assignees.splice(d,1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=a.schedule;break;case 6:this.state.completion=a.completion;break;case 9:this.state.title=a.title;break;case 10:this.state.priority=a.priority;break;case 0:this.state.isLossy=!0;break;case 1:k.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.Tif=
!0;break;case 8:this.Tif=!1;break;case -1:k.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}a.isLossy&&(this.state.isLossy=!0);this.Mqn(a)?this.BWi.records.push(a):this.Jci(a)}get isDeleted(){return this.Tif}get state(){return this._state}get history(){return this._history}gCl(a){if(!a)return this.history;const d=Array.clone(this.history),n=d[0],z=n.records.shift();if(!this.igk){var O=this.fCc(z,4);n.records.unshift(O)}!a.$Ii&&this.$Ii&&
(O=this.fCc(z,6),O.completion=this.F_c,n.records.unshift(O));!a.ZIi&&this.ZIi&&(O=this.fCc(z,10),O.priority=this.E_c,n.records.unshift(O));!a.aJi&&this.aJi&&(O=this.fCc(z,5),O.schedule=new LH.a,n.records.unshift(O));!a.bJi&&this.bJi&&(O=this.fCc(z,9),O.title=this.H_c,n.records.unshift(O));a.isDeleted&&(a=this.fCc(z,8),n.records.unshift(a));return d}static QPl(a,d){return"Synthesized-"+a.recordId+"-"+d}}Object(t.a)(MH,"CommentTaskStateBuilder",null,[]);class nO{constructor(a,d,n,z){this.id=a;this.commentId=
d;this.currentState=n;this.history=z}}Object(t.a)(nO,"CommentTaskItem",null,[]);var NF=b(1415);const sE=a=>{const d=new NF.a(a.UserId,a.Provider,a.DisplayName,a.Email);d.IsCurrentUser=a.IsCurrentUser;return d};var HQ=b(1627);class gD{static clone(a){a=gD.GTk(a.extensions);return new HQ.a(a)}static P7h(a){return a?gD.clone(a):null}static isEmpty(a){return!a.extensions||!a.extensions.count}static le(a){return!a||gD.isEmpty(a)}static GTk(a){if(!a)return null;const d=new cg.a;a.forEach((n,z)=>{d.add(n,
z);return!0});return d}}Object(t.a)(gD,"ExtensionListExtensions",null,[]);class oO{static clone(a){var d=sE(a.user);d=new KH.a(a.type,d,a.time,a.recordId,a.isLossy);d.commentId=a.commentId;d.anchorExtensionList=gD.P7h(a.anchorExtensionList);d.recordExtensionList=gD.P7h(a.recordExtensionList);a.assignee&&(d.assignee=sE(a.assignee));if(a.schedule){var n=a.schedule;const z=new LH.a;z.startDate=n.startDate;z.endDate=n.endDate;d.schedule=z}d.completion=a.completion;d.title=a.title;d.priority=a.priority;
d.undoId=a.undoId;return d}}Object(t.a)(oO,"HistoryRecordExtensions",null,[]);class pO{constructor(a,d,n,z,O,ca,Da,Xa=!1){this.c8d=a;this.Ybe=d;this.n1a=n;this.h6j=z;this.H_c=O;this.E_c=ca;this.F_c=Da;this.v9d=Xa}L4k(a,d,n,z=null){if(!a)throw k.ULS.sendTraceTag(42796181,327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!d)throw k.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");if(!n||!n.length)throw k.ULS.sendTraceTag(42796183,
327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==n[0].type)throw k.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var O=[],ca=null,Da=this.RVm(n);for(var Xa of n)if(!Da.contains(Xa.recordId))if(n=this.cGi(Xa.commentId,z),n=this.hql(Xa,n),1===n.type){let Vb=[];this.v9d&&ca&&ca.state&&(Vb=ca.state.assignees);ca=new MH(this.c8d,n,this.H_c,this.E_c,this.F_c,this.v9d,Vb);O.push(ca)}else if(ca)ca.bQn(n);
else throw k.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");Da=null;Xa=[];if(ca){ca.isDeleted||(Da=ca.state);ca=null;for(var zb of O)O=zb.gCl(ca),Array.addRange(Xa,O),ca=zb}zb=this.cGi(d,z);Da&&(Da.completion=this.tWk(d,z,Da.completion));return new nO(a,zb,Da,Xa)}Xri(a,d,n,z=null){if(!d)throw k.ULS.sendTraceTag(42796185,
327,10,"update cannot be null."),Error.argumentNull("update");if(n&&!a)throw k.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const O=[],ca=this.n1a.zxl();if(n){var Da=this.n1a.Rib(1,a,ca);O.push(Da)}Da=null;if(d.assigneeUpdate){if(!d.assigneeUpdate.assigneesToAdd||!d.assigneeUpdate.assigneesToRemove)throw k.ULS.sendTraceTag(536999254,327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var Xa=0;Xa<
d.assigneeUpdate.assigneesToAdd.length;Xa++){var zb=this.Kci(2,d.assigneeUpdate.assigneesToAdd[Xa],a,ca);zb&&O.push(zb)}for(Xa=0;Xa<d.assigneeUpdate.assigneesToRemove.length;Xa++)(zb=this.Kci(3,d.assigneeUpdate.assigneesToRemove[Xa],a,ca))&&O.push(zb)}else d.assignee&&(n||(Da=this.n1a.Rib(4,a,ca),O.push(Da)),Xa=this.n1a.Rib(2,a,ca),Da=this.Ybe.jvb(d.assignee),Xa.assignee=Da,O.push(Xa));d.title?(z=this.n1a.Rib(9,a,ca),z.title=d.title,O.push(z)):n&&z&&(Xa=this.n1a.Rib(9,a,ca),Xa.title=this.h6j.cSl(z,
Da),O.push(Xa));if(d.schedule){if(d.schedule.startDate>d.schedule.endDate)throw k.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");z=this.n1a.Rib(5,a,ca);z.schedule=d.schedule;O.push(z)}if(void 0!==d.completion&&null!==d.completion){z=d.completion;if(0>z||100<z)throw k.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");n||k.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",
z);n=this.n1a.Rib(6,a,ca);n.completion=z;O.push(n)}if(void 0!==d.priority&&null!==d.priority){d=d.priority;if(0>d||10<d)throw k.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");a=this.n1a.Rib(10,a,ca);a.priority=d;O.push(a)}return O}Kci(a,d,n,z){if(2!==a&&3!==a)return k.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;a=this.n1a.Rib(a,n,z);a.assignee=this.Ybe.jvb(d);return a}RVm(a){const d=
new hl.a,n=new hl.a;for(let z=a.length-1;0<=z;z--){const O=a[z],ca=n.contains(O.recordId);ca||-1!==O.type||(n.contains(O.undoId)?k.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):n.add(O.undoId));if(ca||-1===O.type)d.contains(O.recordId)?k.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):d.add(O.recordId)}return d}hql(a,d){const n=oO.clone(a);n.commentId=d;n.user=this.Ybe.jvb(a.user);
n.assignee=this.Ybe.jvb(a.assignee);return n}tWk(a,d,n){let z=n;a&&d&&(({value:d}=d.Ab(a)).returnValue?(z=d.ResolveState?100:100===n?0:n,z!==n&&k.ULS.sendTraceTag(592719873,327,50,"Task completion state has been changed to match comment resolution state for comment {0}",a)):k.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",a));return z}cGi(a,d){let n=a;a&&d&&(({value:d}=d.Ab(a)).returnValue?n=d.CommentId:(k.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",
a),n=a));return n}}Object(t.a)(pO,"CommentTaskTranslatorImpl",null,[907]);var hD=b(909);class qO{constructor(){this.kEb=CommonUIStrings.l_Ellipsis}cSl(a,d){if(!a)throw k.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");try{var n=zv.a.Mwe(a)}catch(zb){throw k.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var z=a=0,O=0;const ca=RegExp("\\s+","g"),Da=new Sys.StringBuilder;
for(var Xa of n.ops)Xa.attributes&&Xa.attributes.atmention&&Xa.attributes.atmention.email&&d&&(n=Xa.attributes.atmention.email,0<n.length&&(n===d.UserId||n===d.Email||n===hD.a.GEb(d.UserId))&&(z=a,O=z+Xa.insert.length)),n=Xa.insert.replace(ca," "),a+=n.length,Da.append(n);!O&&d&&k.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",d.Provider);d=Da.toString().trimEnd();a=d.length;255<a?(Xa=(255-(O-z))/2,0>z-Xa?(a=Hr.a.instance.t4a(d,255-this.kEb.length),O=d.substring(0,a)+this.kEb,
a="Trimmed End"):O+Xa>a?(z=Hr.a.instance.BTa(d,a-255+this.kEb.length),O=this.kEb+d.substring(z,a),a="Trimmed Start"):(z=Hr.a.instance.BTa(d,z-Xa+this.kEb.length),a=Hr.a.instance.t4a(d,O+Xa-this.kEb.length),O=this.kEb+d.substring(z,a)+this.kEb,a="Trimmed Both")):(a="No Trim",O=d);k.ULS.sendTraceTag(592998804,327,50,a);return O}}Object(t.a)(qO,"ContentExtractor",null,[]);class rO{constructor(a,d){this.jbk=a;this.yek=d;this.elc=this.Ymc=!1}jvb(a){if(!a)return null;if(void 0===a.UserId||null===a.UserId)throw k.ULS.sendTraceTag(593368219,
327,10,"Unexpected user missing UserId field"),Error.argumentType();if(a.IsCurrentUser||!this.jbk.equals(this.yek.value,a))return a;a=sE(a);a.IsCurrentUser=!0;return a}}Object(t.a)(rO,"EnsureIsCurrentUserSetTransformer",null,[906]);class sO{constructor(){this.elc=this.Ymc=!1}jvb(a){if(!a)return null;if(void 0===a.UserId||null===a.UserId)return a;if(!a.Email||""===a.Email){let d;if(d=hD.a.GEb(a.UserId))return a=sE(a),a.Email=d,a}return a}}Object(t.a)(sO,"RestoreEmailTransformer",null,[906]);class OF{constructor(){this.elc=
this.Ymc=!1}jvb(a){if(!a)return null;if(void 0!==a.UserId&&null!==a.UserId)return a;switch(this.Ymc?this.elc?2:1:0){case 0:if(void 0===a.UserId||null===a.UserId)throw k.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");a=sE(a);break;case 1:if(void 0===a.Id||null===a.Id)throw k.ULS.sendTraceTag(593368214,327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===a.Email||null===a.Email)throw k.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),
Error.argument("assignee.Email");var d=OF.Pdj(a.Id,a.Email,null);if(!d||""===d)throw k.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var n=l.AFrameworkApplication.K.Ga("HostAuthType")||"";if("aad"!==n.toLowerCase()||d.startsWith("S::")){if("msa"===n.toLowerCase())throw k.ULS.sendTraceTag(593368210,327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");k.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",
n)}else throw k.ULS.sendTraceTag(593368211,327,10,"Unexpected UserID format"),Error.argument("userId");a=new NF.a(d,"AD",a.DisplayName,a.Email);break;case 2:if(void 0===a.UserPrincipalName||null===a.UserPrincipalName)throw k.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");if(void 0!==a.SuggestionSubtype&&null!==a.SuggestionSubtype)if("OrganizationUser"===a.SuggestionSubtype)d="AD";else throw k.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",
a.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw k.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");n=OF.Pdj(a.Id,a.UserPrincipalName,a.AadObjectId);if(!n||""===n)throw k.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===d&&!n.startsWith("S::"))throw k.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");a=new NF.a(n,
d,a.Name,a.UserPrincipalName);break;default:throw k.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return a}static Pdj(a,d,n){if(!d||""===d)return k.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),a;if(n&&""!==n)return"S::"+d+"::"+n;if(!a||""===a)return k.ULS.sendTraceTag(593368217,327,50,"Missing ID"),a;if(a.startsWith("S::"))return a;if(-1!==a.indexOf("@")){n=a.split("@");if(xa.a.Yb(n[0]))return"S::"+d+"::"+n[0];k.ULS.sendTraceTag(593368216,327,50,
"ID is not in AadObjectId@TenantId format")}return a}}Object(t.a)(OF,"UserIdCanonicalizationTransformer",null,[906]);class kA{constructor(a,d,n=!1,z=!1){this.t8j=a;this.fqh=d;this.cfk=n;this.v9d=z}O_k(){const a=new hD.a;var d=new Nf.a(kA.gxl);const n=new jO;this.fqh&&(n.NUc.push(new OF),n.NUc.push(new sO));this.t8j&&n.NUc.push(new rO(a,d));n.Ymc=this.fqh;n.elc=this.cfk;d=new kO(d,n);const z=new qO;return new pO(a,n,d,z,kA.L7k,kA.B7k,kA.C7k,this.v9d)}static gxl(){const a=new NF.a(l.AFrameworkApplication.K.Ga("PresenceUserId")||
"",l.AFrameworkApplication.K.Ga("PresenceProvider")||"",l.AFrameworkApplication.userName||"");a.IsCurrentUser=!0;return a}}kA.L7k="";kA.B7k=5;kA.C7k=0;Object(t.a)(kA,"CommentTaskTranslatorFactory",null,[898]);var IQ=b(666),JQ=b(1270);class tO{create(){return new HF.a}}Object(t.a)(tO,"CommentNodeFactory",null,[244]);var uO=b(930);class vO{constructor(){this.aqd=this.OWd=null;this.Ese=this.L_e=!1;this.W2a=this.JRa=null}}Object(t.a)(vO,"CommentAnchorParaNodesStatus",null,[]);class wO extends Rs.a{constructor(a){super();
this.Mkk=a}get index(){return 2}run(){this.Mkk()}H8h(a,d){d.property===Vd.a.jf&&this.l8()}}Object(t.a)(wO,"CommentContentPropertyTracker",Rs.a,[]);class xO{constructor(a,d){this.KOc=a;this.tOi=d}}Object(t.a)(xO,"CommentIntentIdentifier",null,[]);class yO extends Rs.a{constructor(a,d){super();this.uxb=new qi.a(new TN.a);this.txc=new IH.a(ti.lxd());this.uxc=new Hm.ScriptSharpLegacyMap;this.Ygk=a;this.aik=d;this.uxc.add(Qb.a.S6,1);this.uxc.add(Qb.a.gE,0);this.uxc.add(Vd.a.jf,0);this.uxc.add(Qb.a.Aaa,
2)}get index(){return 4}run(){let a="";for(let d of this.uxb)if(this.Ygk(d),this.txc.Na(d.id))for(let n of this.txc.J(d.id))a+="_"+n;this.aik(a);this.uxb.clear();this.txc=new IH.a(ti.lxd())}tVk(a,d){a=d.property;if(a===Qb.a.S6||a===Qb.a.gE||a===Vd.a.jf||Rj.App.c5e&&a===Qb.a.W4b||a===Qb.a.Aaa)this.uxb.add(d.node),this.uxc.Na(a)&&(this.txc.Na(d.node.id)||this.txc.add(d.node.id,new ra.a),this.txc.J(d.node.id).add(this.uxc.J(a))),this.l8()}DVk(a,d){d.property===Vd.a.wk&&(a=d.node,a.Ebc&&(this.uxb.add(a),
this.l8()))}uCn(a,d){this.uxb.add(d.node);this.l8()}}Object(t.a)(yO,"CommentNodeTransactionCompletedProcessor",Rs.a,[]);class zO{constructor(){this.zdf=new Map;this.Agf=new Map}iuk(a,d){if(this.zdf.has(a))throw Error("DuplicateDurableId");if(this.Agf.has(d))throw Error("DuplicateGuardId");this.zdf.set(a,d);this.Agf.set(d,a)}uBl(a){return this.zdf.get(a)}Cyl(a){return this.Agf.get(a)}}Object(t.a)(zO,"CommentIdMapper",null,[]);class ls extends eO.a{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le,
Ve,gg,Lh,Ki,Ak,Uk,Rl,kk,dn,fs,lp,zt=null){super();this.Xy=a;this.bmf=d;this.Rlf=n;this.Nb=z;this.A5j=O;this.odb=ca;this.vzf=Da;this.uZc=Xa;this.va=zb;this.Ja=Vb;this.Wu=Fc;this.zuc=Yc;this.ZM=yd;this.quc=je;this.ZDh=Le;this.xe=Ve;this.Gj=gg;this.F$a=Lh;this.xf=Ki;this.G1=Ak;this.U1j=Uk;this.vRb=Rl;this.bW=kk;this.Wfb=dn;this.yZc=[];this.Bab=[];this.axf=new cg.a(0);this.jde=new cg.a;this.Ife=new qi.a(ma.a.Xi());this.Iwf=new qi.a(ma.a.Xi());this.N5d=null;this.SSb=new cg.a;this.Fcf=!1;this.VCh=null;
this.j4d=new hl.a;this.mAh=this.Ojf=this.eHh=!1;this.Qaf=new Set;this.a6=[];this.ksc=2;this.bQa=new cg.a(!1);this.p8c=new hl.a;this.$$e=!1;this.F0c=new Map;this.Paf=new zO;this.h4d=0;this.z5j=5;this.M5a=Ro=>{if(!this.xe.As||Ro.done)return!1;if(Ro.Dv===qo.beingCreated)return!0;if(Ro.objectId){if(this.b9l(Ro))return!1;if(!this.qcm(Ro.objectId)||Ro.Lg)return!0;for(let qr of this.eba())if(qr.Lg===Ro.id)return!0}return!1};ls.yx=zt;this.qae=new qi.a(ma.a.Xi());!this.xe.B6b&&this.xe.As||HF.a.uKa(Object(m.a)(this,
this.g8i,"onAddedOrDeleted"));this.xe.NRd&&(lp.zyc(Object(m.a)(this,this.BJd,"onAggregateIntentRangeRendered")),fs&&fs.vy((Ro,qr)=>{Ro=ti.Q1l(this.a6,qr.node.id);0<this.a6.length&&(!Ro||Ro===this.a6.length-1)&&(this.ksc=1,this.a6=[])}))}get Q3(){return this.Fj}get SDf(){return this.oh}get qWi(){return this.VCh||(this.VCh=Object.assign(new IQ.a,{yqa:WoncaIntl.WoncaStrings.l_InboundingCommentFailed,IGa:1}))}get Iba(){return this.Nb}get DH(){return this.Xy.value}get kd(){return this.DH.kd}get gwb(){return this.bmf.value}get yib(){return this.Rlf.value}get Oa(){return this.odb.value}get Z4(){return this.va.Ga("PresenceUserId")}get xrb(){return this.va.Ga("PresenceProvider")}Jmb(a,
d,n,z){if(n&&this.ZL&&(!this.ZL||!this.ZL.Lg)){var O=!1;for(let ca of n)if(3===ca.type)switch(O=!0,n=ti.P1l(this.a6,ca.id),-1<n&&(this.a6[n].KOc=d.id),a.classList.add(Ji.a.Zre),z){case 1:a.classList.add(Ji.a.jYf);break;case 0:a.classList.add(Ji.a.kYf)}O||a.classList.remove(Ji.a.Zre,Ji.a.kYf,Ji.a.jYf);this.F$a.lXa(3)}}BJd(a,d){a=d.paragraphNode;for(let n of d.contents)this.Jmb(n.element,a,n.YIc,n.dS)}H6f(a=!1){return this.vzf.fpl(this.oh,l.AFrameworkApplication.pa.mode,d=>!this.xe.Dmc||!a||this.M5a(d))}$5f(a){return this.vzf.Ttl(this.Fj.model.eba(),
l.AFrameworkApplication.pa.mode,a)}RBi(a){if(!a||!a.Lg)return a;a=a.Lg;for(let d=0;d<this.oh.length;d++)if(this.oh[d].id===a)return this.oh[d];return null}N_k(){const a=[];if(this.Ja.isFeatureEnabled(193)){var d=this.quc.value;for(let n of d.pFi())(d=this.gsi(n))&&a.push(d)}return a}R1l(a){if(!this.Bab)throw U.a.invalidOperation("UpdateContent must have been called before this.");for(let d=0;d<this.Bab.length;d++)if(this.Bab[d].id===a)return d;return-1}UMi(){const a=new yb.a;for(let n of this.oh)if(n.objectId&&
n.b5a){var d=E.a.qe(n.objectId);if((d=this.kd.Ta(d))&&d.hasProperty(Qb.a.IF))if(d=d.getValue(Qb.a.IF).toString(),a.Na(d)){const z=a.J(d).CommentId;this.YYj(z,n,d)}else a.add(d,new fO(n.id,n.done))}this.N5d=a}YYj(a,d,n){a!==d.b5a?(k.ULS.sendTraceTag(42866777,327,10,"Multiple comments contains the same DurableId [{0}], GuardId [{1}], GuardId of existing entry: {2}",n,d.b5a,a),this.bW.fl("CommentLoad","MultipleCommentsWithSameDurableId",{isInternal:!0},{name:"CommentExperienceDegraded",isInternal:!0})):
k.ULS.sendTraceTag(554297428,327,15,"Duplicate entry of same comment with DurableId [{0}], GuardId [{1}]",n,d.b5a)}gsi(a){const d=this.ZDh.value;var n=this.quc.value;const z=n.ZGc(a);if(void 0===z||null===z)return k.ULS.sendTraceTag(592234717,3003,50,"GenerateTaskItemForTaskId was called with a taskId [{0}] that has no comment anchor id.",a),null;n=n.nFi(a);try{return d.L4k(a,z.toString(),n,this.N5d)}catch(O){return k.ULS.sendTraceTag(42856716,3003,10,"CreateTaskItemFromHistoryRecords Failed due to [{0}]",
O.message),null}}ivi(a=!1,d=!1){const n=new hl.a,z=d?ti.YAi():new Set;this.bQa.keys.forEach(O=>{z.has(O)||a&&this.bQa.J(O)||n.add(O);return!0});return n}zye(){if(!this.oh)return 0;let a=0;for(let d of this.oh)d.Lg||a++;return a}kuk(a){if(a.Dv===qo.beingCreated){if(this.Fj.mode=2,this.azb=a,this.Oa.ya){var d=this.Oa.ya.Ba;if(d&&d.ra){if(Qd.SelectionEditor.qj(d)){var n=Qd.SelectionEditor.SU(d.ra,!1);n&&(this.Oa.setSelection(n),d=n)}for(n=0;n<d.length&&this.xe.NRd;n++){var z=d.J(n).node;if(!Bd.ParagraphReader.nb(z)||
!(-1!==d.J(n).cpBegin&&-1!==d.J(n).cpEnd||-1!==d.J(n).Gm&&-1!==d.J(n).$w))continue;var O=-1===d.J(n).cpBegin?d.J(n).Gm:d.J(n).cpBegin;const ca=-1===d.J(n).cpEnd?d.J(n).$w:d.J(n).cpEnd,Da=E.a.create();this.Wu.nMc(z,new cD.a(3,O,ca,Da));this.a6.push(new xO(z.id,Da))}}}}else this.JTe(a);n=({index:d}=this.xbh(a)).returnValue;if(!a.Lg){z=null;O=this.ivi();a.Dv!==qo.beingCreated&&(z=this.YNl(a),O.remove(a.objectId));z=({index:O}=this.IGl(z,O)).returnValue;d=-1<O?O:d;O=0;if(z)for(;d<this.oh.length&&this.oh[d].Lg;)d++;
if(!z&&this.xe.As&&a.Dv===qo.beingCreated)for(z=0;z<d;z++)this.oh[z].Lg||this.oh[z].done||O++;this.nAn(a,O)}n&&Array.insert(this.oh,d,a)}TGa(a){super.TGa(a);this.j4d.add(a.id)}nAn(a,d){this.xe.As&&a.Dv===qo.beingCreated&&a.YG&&this.axf.$(a.YG.draftId,d)}dRl(a){return this.axf.J(a)}Pmj(a){this.axf.remove(a)}$Cl(a){let d=0,n=0;for(let z=0;z<this.oh.length;z++){if(this.oh[z].id===a.id){n=z;break}this.oh[z].Lg||this.oh[z].done||d++}return{returnValue:n,MDn:d}}Kbg(a){var d=null,n=this.kd.Ta(a);a=Xj.a.Sla(n,
this.kd,!0);n=Xj.a.Sla(n,this.kd,!1);a&&n&&(d=ye.SelectionFactory.Pc(a.Wa.paragraph,a.Wa.cp),d=ye.SelectionFactory.Mx(d,fe.a.Kb(n.Wa.paragraph,n.Wa.cp)));a&&n||this.bW.fl("CommentLoad","ParaNodeNotConnected",{isIntentional:!1,isInternal:!0});return d}YNl(a){a=E.a.qe(a.objectId);return this.Kbg(a)}rUg(a,d){var n=this.kd.Ta(a);if(n){var z=this.kd.Ta(n.getValue(Qb.a.mC));n=this.kd.Ta(n.getValue(Qb.a.RA));if(z===n)for(n=0;n<z.ja.length&&!z.ja.J(n).ZLj(a,d);n++);}}IGl(a,d){let n=-1;var z=null;a||(a=this.Oa.ya?
this.Oa.ya.Ba:null);if(!a||!a.ra)return{returnValue:null,index:n};const O=this.lCi(a.ra);if(!O)return{returnValue:null,index:n};var ca=Xj.a.dEl(O.iterator.currentNode,a.ra.cpBegin,this.xe.As,d);ca&&(z=this.jba(ca.vi.toString()),ca=Array.indexOf(this.oh,z),z=0<=ca?z:null,n=0<=ca?ca+1:n);z||(a=this.evi(O,a.ra,this.xe.As,d),z=0<=a?this.oh[a]:null,n=0<=a?a:n);return{returnValue:z,index:n}}$ul(a=null){var d=null;d=this.Oa.ya.Ba;return d&&d.ra?this.eAl(d.ra,this.xe.As,a):null}lCi(a){const d=new Dd.GraphIterator;
d.set(a.node);return d.tn()?Yi.a.Yo(d,d.origin):null}eAl(a,d,n=null){const z=this.lCi(a);a=this.evi(z,a,d,n);return-1<a?this.oh[a]:null}evi(a,d,n,z=null){let O=-1;if(a)for(d=d.cpBegin;-1===O&&a.moveNext();)Bd.ParagraphReader.Zf(a.iterator)&&((d=Xj.a.D6f(a.iterator.currentNode,d,n,z))&&(O=Array.indexOf(this.oh,this.jba(d.vi.toString()))),d=0);return O}dQi(a){const d=a.toString();return this.bQa.Na(d)&&this.bQa.J(d)||this.p8c.contains(a)&&this.kd.Xra(a)&&this.kd.Ta(a).fa(Qb.a.S6,!1)}pwj(a,d=!1){if(a=
this.wtd(a))a.eqg=!d}Jqg(a){return this.bQa.Na(a.toString())||this.p8c.contains(a)&&this.kd.Xra(a)&&!this.kd.Ta(a).fa(Qb.a.cK,null)}JTe(a){!a.objectId||a.Lg||this.bQa.Na(a.objectId)||this.bQa.add(a.objectId,a.done)}deleteComment(a){a&&!a.Lg&&(this.xe.As&&a.Dv!==qo.beingCreated?this.bQa.remove(a.objectId):a.Dv===qo.beingCreated&&this.OMj());this.j4d.remove(a.id);return super.deleteComment(a)}Z7f(a){return a&&a.hasProperty(Qb.a.IF)?a.Se(Qb.a.IF).toString():""}wtd(a){if(!a)return null;if(this.xe.sEb)return this.NP(a);
for(let d of this.oh){const n=this.kd.Ta(E.a.qe(d.objectId));if(this.Z7f(n)===a.toString())return a=n.Se(Qb.a.gE),this.NP(a)}return null}zQg(a,d=!1){if(a&&Xj.a.YEe(a)&&this.Ja.isFeatureEnabled(193)){const n=this.Z7f(a);if(""!==n){if(d){let z;if(this.N5d&&({value:z}=this.N5d.Ab(n,z)).returnValue&&z.ResolveState===a.fa(Qb.a.S6,!1))return}(a=this.SSb.J(Number.parseInvariant(n)))&&this.Ife.add(a)}}}g8i(a,d){if(a.Ib.id.equals(this.kd.id)){this.F$a.lXa(7);var n=a.getValue(Qb.a.gE),z=a.getValue(Qb.a.IF).toString();
n=this.xe.sEb?this.F0c.has(z)?this.F0c.get(z):z:n;n=this.NP(n);if(d){if(n){this.ZL&&this.ZL.Lg===n.id&&(k.ULS.sendTraceTag(592188698,327,50,"Draft lost by parent deletion"),this.bW.fl("CommentReplyInProgress","DraftCommentLostOnParentDelete",{isIntentional:!1,isInternal:!0},{name:"CommentDataLoss",isIntentional:!1,isInternal:!0,isSessionEndingError:!1}));d=n.Lg?"The comment is a reply":"";z=a.fa(Qb.a.mC,E.a.nil).toString();const O=a.fa(Qb.a.RA,E.a.nil).toString();this.j4d.contains(n.id)&&!Xj.a.Y9l(n.d7b)?
(this.j4d.remove(n.id),k.ULS.sendTraceTag(577307335,327,15,"New session comment deleted by inbound change: {0}. duration: {1}. startParaId: {2}. endParaId: {3}. {4}.",ti.Wzc(n),+new Date-+n.date,z,O,d)):k.ULS.sendTraceTag(50426379,327,50,"{0} deleted by inbound changes. startParaId: {1}. endParaId: {2}. {3}.",ti.Wzc(n),z,O,d);this.Fj.wod(n);this.Efi(a.id)}}else if(!n){this.bW.z7b();this.xe.U8h?la.a.instance.sa("WordEditor.Comments.EditorCommentManager")||k.ULS.sendTraceTag(525379405,327,10,"comment Manager resolve failed"):
la.a.instance.resolve("WordEditor.Comments.EditorCommentManager");if(this.xe.B6b&&!this.xf.W7){this.G1.rKa("OnCommentInit",Object.assign(new eC,{w9i:()=>{this.HGg(a);this.Uic()}}));return}this.xe.As||this.xf.W7||this.G1.rKa("OnCommentInit");d=!1;this.xe.Z7k&&(d=this.ZXm(a));d||this.HGg(a)}this.Fcf=!0}}ZXm(a){const d=this.E6f(a);let n=!1;d.L_e&&d.Ese||(this.p8c.add(a.id),n=!0,this.S8i(a));return n}S8i(a){ao.a.oaa(l.AFrameworkApplication.tb,()=>{this.HGg(a);this.p8c.remove(a.id);this.p8c.count||(this.Uic(),
this.Q3.iMn())},"DelayLoadCommentNodeIntoModel")}HGg(a){if(!this.Fj&&(k.ULS.sendTraceTag(525379406,327,10,"Comment Manager Not initialized"),this.xe.U8h&&this.h4d<this.z5j)){this.h4d+=1;this.S8i(a);k.ULS.sendTraceTag(525378784,327,50,`Comment Node add Retry attempt ${this.h4d}`);return}var d=this.uFc();d.rg(a);d.Vz()?(d=this.QQf(d),this.Fj.addComment(d,null),2!==this.Fj.mode&&3!==this.Fj.mode&&(this.Fj.mode=1),this.zQg(a),this.yAm(d)):this.yZc.push(a);this.G1.rKa("OnCommentNodeAdded",{commentNode:a})}yAm(a){this.xe.As&&
!this.xf.xq&&this.Q3.yD&&a.Lg&&this.Q3.yD.id===a.Lg&&this.Q3.notify(String.format(Box4Intl.Box4Strings.L_CommentReplyAdded,a.author),!1)}E6f(a){const d=new vO;d.OWd=a.fa(Qb.a.mC,E.a.nil);d.aqd=a.fa(Qb.a.RA,E.a.nil);a=d.OWd.equals(E.a.nil);const n=d.aqd.equals(E.a.nil);a||(d.JRa=this.kd.Ta(d.OWd),d.L_e=!!d.JRa&&d.JRa.isConnected);n||(d.W2a=this.kd.Ta(d.aqd),d.Ese=!!d.W2a&&d.W2a.isConnected);return d}Iki(a,d){const n=this.R1l(a);-1!==n&&Array.removeAt(this.Bab,n);d||((a=this.gsi(a))?this.Bab.push(a):
k.ULS.sendTraceTag(42870813,3003,10,"GenerateTaskItemForTaskId returned null"))}ofl(){for(let a of this.Ife)this.Iki(a,!1);this.Ife.clear();for(let a of this.Iwf)this.Iki(a,!0);this.Iwf.clear()}Uic(a=null){this.xe.Anc&&this.UMi();this.xe.Anc&&this.ofl();this.xe.tQk&&a&&(this.$$e&&0>a.indexOf("0")&&k.ULS.sendTraceTag(558687680,327,15,"Expected Commit Ui Refresh but its missing."),this.$$e=!1);this.Q3.Vic(void 0,a);this.F$a.lXa(8)}ebj(a,d,n){if(a.Ib.id.equals(this.kd.id)){var z=a.fa(Qb.a.taskId,"");
if(""===z)k.ULS.sendTraceTag(42856717,3003,10,"Newly added or deleted task node does not have a task id.");else{if(d)if(this.Iwf.add(z),z=this.quc.value.lFi(a),void 0!==z&&null!==z)this.SSb.remove(z);else{k.ULS.sendTraceTag(591971722,3003,10,"A task without comment id was deleted even though that shouldn't be possible.");return}else if(this.Ife.add(z),d=this.quc.value,a=d.lFi(a),void 0!==a&&null!==a)for(this.SSb.J(a)?this.SSb.$(a,z):this.SSb.add(a,z),a=d.nFi(z),d=0;d<a.length;d++){var O=a[d].commentId;
O&&(O=Number.parseInvariant(O),this.SSb.J(O)||this.SSb.add(O,z))}else{k.ULS.sendTraceTag(591971723,3003,10,"A task without comment id was added or modified even though that shouldn't be possible.");return}n&&this.Uic()}}}xbh(a){var d=this.oh.length,n=!1;if(a.Lg){var z=(n=this.NP(a.Lg))&&n.objectId?this.kd.Ta(E.a.qe(n.objectId)):null;z=!!z&&z.hasProperty(Qb.a.RGa);d=Array.indexOf(this.oh,n);n=0>d;for(d+=1;d<this.oh.length&&this.oh[d].Lg===a.Lg&&this.oh[d]!==this.ZL&&!(z&&a.date<this.oh[d].date);)d++}return{returnValue:!n,
index:d}}M_l(){const a=new yO(Object(m.a)(this,this.sLn,"updateComment"),Object(m.a)(this,this.Uic,"refreshCommentsPane")),d=Lb.App.jj.Cm;d.Oe(40).tq(Object(m.a)(a,a.tVk,"commentPropertyChanged"));d.Oe(12).tq(Object(m.a)(a,a.DVk,"commentTextChanged"));this.Ja.isFeatureEnabled(193)&&d.Oe(72).tq(Object(m.a)(a,a.uCn,"taskPropertyChanged"));yq.GraphTransactionManager.instance.UCa(a,3)}sLn(a){if(Xj.a.YEe(a)){const n=this.jba(a.id.toString());if(n){var d=Dd.GraphIterator.ua(a);n.text=this.U8b(d);n.done=
a.fa(Qb.a.S6,!1);this.xe.jCb&&a.hasProperty(Qb.a.Aaa)&&(d=(d=a.getValue(Qb.a.Aaa))?x.b(d||""):null,n.usersByReactionType=d,this.FQk(n));this.vLn(a,n);n.Lg||this.zLn(a,n)}}else this.Ja.isFeatureEnabled(193)&&72===a.type?this.ebj(a,!1,!1):this.uLn(a)}FQk(a){if(a&&this.Qaf.has(a.id)){var d=a.usersByReactionType[1];for(let n=0;d&&n<d.length;n++)if(d[n].UserId===this.Z4)return;k.ULS.sendTraceTag(542765345,327,15,`Like by current user on Comment ${a.objectId} removed by inbound changes`)}}zLn(a,d){this.QTk(d);
const n=this.xe.As;n&&this.tYl(d)?(this.Y7k(d),this.zQg(a),this.IOn(d)):n||this.zQg(a,!0)}uLn(a){let d=new Dd.GraphIterator;d.set(a);d.La(40);d.tc(40);if(d.currentNode){if(a=this.jba(d.currentNode.id.toString()))a.text=this.U8b(d)}else k.ULS.sendTraceTag(592738053,327,15,"UpdateComment Unexpected Node Type: "+Dw.a[a.type])}IOn(a){if(!this.xf.xq){var d=new ra.a;this.zPj(a,d);0<d.count&&kn.b(d)}}Y7k(a){const d=new bf.a(0,1,0,()=>{this.tLn(a)},137,void 0,!0);l.AFrameworkApplication.tb.rb(d)}QTk(a){var d;
null!==(d=this.ZL)&&void 0!==d&&d.YG&&this.ZL.YG.sessionType!==Vs.metadata&&(d=this.ZL,a.Lg||!a.done||d.Lg!==a.id&&d.id!==a.id||(k.ULS.sendTraceTag(592188699,327,15,"Draft comment lost on parent resolve, DraftType: {0}",d.Dv),this.bW.fl("CommentReplyInProgress","DraftCommentLostOnParentResolve",{isIntentional:!1,isInternal:!0},{name:"CommentDataLoss",isIntentional:!1,isInternal:!0,isSessionEndingError:!1}),d.Dv===qo.beingCreated?(this.Fj.clearSelection(),this.deleteComment(d),this.selectComment(a)):
d.Dv===qo.beingEdited&&(d.Dv=qo.normal,d.K8a=jA.succeeded,this.Fj.AKf())))}vLn(a,d){if(this.xe.sEb){if(a=a.getValue(Qb.a.IF).toString(),d.id!==a){if(!d.Lg)for(var n=Array.indexOf(this.oh,d)+1;n<this.oh.length&&this.oh[n].Lg===d.id;n++)this.oh[n].Lg=a;k.ULS.sendTraceTag(555044877,327,50,"durable Id updated.");d.id=a;this.F0c.has(a)&&this.F0c.delete(a)}}else if(a=a.getValue(Qb.a.gE),d.id!==a){if(!d.Lg)for(n=Array.indexOf(this.oh,d)+1;n<this.oh.length&&this.oh[n].Lg===d.id;n++)this.oh[n].Lg=a;d.id=a}}tYl(a){return this.bQa.Na(a.objectId)&&
this.bQa.J(a.objectId)!==a.done}tLn(a){this.bQa.$(a.objectId,a.done);if(a.done)if(this.Q3.wVc(a),this.xf.xq)this.Q3.fKd(a,!0);else{var d=new bf.a(0,1,0,()=>{this.Q3.fKd(a,!0,!1);this.jde.remove(a.id)},139);this.jde.add(a.id,d);l.AFrameworkApplication.tb.rb(d);this.qw&&a.id===(void 0===this.qw.Lg||null===this.qw.Lg?this.qw.id:this.qw.Lg)&&this.Q3.clearSelection()}else this.Q3.wVc(a),d=null,({value:d}=this.jde.Ab(a.id)).returnValue?(l.AFrameworkApplication.tb.ie(d),this.jde.remove(a.id)):this.Q3.fKd(a,
!1)}L_l(){const a=new wO(Object(m.a)(this,this.pfl,"ensureCommentsAndTasksConnected")),d=Lb.App.jj.Cm;d.Oe(39).tq(Object(m.a)(a,a.H8h,"commentContainerPropertyChanged"));this.Ja.isFeatureEnabled(193)&&d.Oe(71).tq(Object(m.a)(a,a.H8h,"commentContainerPropertyChanged"));yq.GraphTransactionManager.instance.UCa(a,3)}pfl(){const a=this.uFc();for(this.yZc.sort((d,n)=>{const z=d.fa(Qb.a.cK,null),O=n.fa(Qb.a.cK,null);if(!z&&O)return-1;if(!O&&z)return 1;d.hasProperty(Qb.a.RGa)&&n.hasProperty(Qb.a.RGa)?(d=
d.getValue(Qb.a.RGa),n=n.getValue(Qb.a.RGa),n=d<n):(d=new Date(d.getValue(Qb.a.WAc)),n=new Date(n.getValue(Qb.a.WAc)),n=d<n);return n?-1:1});this.yZc.length;){const d=this.yZc[0];a.Vra(d)&&(a.rg(d),this.Fj.addComment(this.QQf(a),null),this.Fj.mode=1);Array.removeAt(this.yZc,0)}if(a.Va(1))for(;a.Kd(1););this.Ja.isFeatureEnabled(193)&&this.quc.value.pFi();this.Fcf&&(this.Uic(),this.Fcf=!1)}jba(a){for(let d=0;d<this.oh.length;d++){const n=this.oh[d];if(n.objectId===a)return n}return null}ixk(a){if(a)for(let d of a)d&&
this.qae.add(d)}xSk(){this.qae.clear()}a3l(){this.xf.Bac&&k.ULS.sendTraceTag(50972491,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",FQ.Debug.q7());this.xe.eyd&&this.Z2l();this.b3l();this.$2l()}Z2l(){this.oh=[];var a=new Uj.a,d=new cg.a(0);const n=Yi.a.Ql(this.gwb),z=new Set,O=new Set;this.Ja.isFeatureEnabled(138)&&this.Nvk(n,d);let ca=this.uFc();d=new Set;const Da=new Set,Xa=new Ff.GraphTransaction(2),zb=Ye.a.me();try{if(Xa.Ir(ca),ca.Bo(1)){for(;n.moveNext();){if(!Bd.ParagraphReader.Zf(n.iterator))continue;
const Fc=n.iterator.currentNode,Yc=Bd.ParagraphReader.rFb(Fc,0);Fc&&Fc.id.equals(oz.imj)&&this.Tnm(Yc,Fc);O.add(Fc.id.toString());this.jgj(Yc,d,ca,z,a,Da)}const Vb=this.jvl(z,O);0<Vb.length&&this.scn(Vb,O,ca,d);0<a.length&&this.vcn(a,z)}}finally{Xa&&Xa.dispose()}a=Ye.a.me();this.Ojf&&this.U1j.sKa(Object.assign(new GQ.a,{name:"GraphWalkToLoadComments",durationMs:a-zb}));0==z.size&&this.xe.eyd&&k.ULS.sendTraceTag(589322444,327,15,"Comments not loaded in model while graph has comments");Sw.Lom(Da,d,
this.kd)}jgj(a,d,n,z,O,ca){for(let Da of a)a=Da.vi.toString(),(this.xe.As?!Da.Db:Da.Db)?d.has(a)||ca.add(a):d.has(a)?k.ULS.sendTraceTag(594363285,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",Da.vi):(d.add(a),this.luk(Da,n,z,O))}scn(a,d,n,z){const O=this.TIl(a);this.xe.Q4i&&Sw.xQk(O);if(this.xe.rcn){var ca=new Set,Da=new Set;O.forEach(zb=>{d.has(zb.id.toString())||Da.has(zb.id.toString())||(Da.add(zb.id.toString()),zb=Bd.ParagraphReader.rFb(zb,0),k.ULS.sendTraceTag(538056651,327,
50,`Retrying loading ${zb.length} CommentRangeObjects`),this.jgj(zb,z,n,ca,new Uj.a,new Set))});var Xa=[];a.forEach(zb=>{ca.has(zb)||Xa.push(zb)});0<Xa.length&&k.ULS.sendTraceTag(526729491,327,15,`Comments Failed To Load on Retry: ${Xa.join(",")}`)}else this.Yom(a)}TIl(a){const d=[];a.forEach(n=>{if(n=this.vRb.fvi(n))n=n.getValue(Qb.a.mC),(n=this.kd.Ta(n))&&n.Bf&&d.push(n)});return d}b3l(){!this.xe.B6b&&this.xe.As&&HF.a.uKa(Object(m.a)(this,this.g8i,"onAddedOrDeleted"));this.M_l();this.L_l()}luk(a,
d,n,z){const O=this.kd.Ta(a.vi);d.rg(O);40===d.Yc&&O?(a=this.QQf(d),d=this.Rwe(a),this.qae.contains(d)&&(a.eqg=!0,this.qae.remove(d)),({index:d}=this.xbh(a)).returnValue?(Array.insert(this.oh,d,a),this.JTe(a),n.add(a.objectId),this.Y_i(a),a.Lg&&this.oml(a)):z.add(a)):(k.ULS.sendTraceTag(594363295,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",!O,!a.vi),39===d.Yc||this.uFc())}jvl(a,d){let n=[];const z=this.vRb.cvl();if(a.size===z.length)return n;
z.forEach(O=>{!a.has(O)&&Sw.shm(O,d,this.vRb,this.kd)&&n.push(O)});return n}$2l(){this.xe.Anc&&this.UMi();this.xe.Anc&&(this.Bab=this.N_k(),uO.a.uKa(Object(m.a)(this,this.ebj,"onTaskChanged")))}Y_i(a){this.xe.Q4i&&k.ULS.sendTraceTag(539800645,327,50,`Comment added to Model. ${ti.Wzc(a)} `)}Yom(a){0<a.length&&(k.ULS.sendTraceTag(543745805,327,15,`Comments Failed To Load: ${a.join(",")}`),this.bW.fl("CommentLoad","CommentsPresentButFailedToLoad",{isInternal:!0},{name:"CommentExperienceDegraded",isInternal:!0}))}oml(a){if(a.Lg){var d=
this.NP(a.Lg);if(d&&d.Lg){const n=this.NP(d.Lg);n&&(n.Lg?k.ULS.sendTraceTag(574763869,327,10,"Multiple chain of replies parented to other replies"):(a.Lg=d.Lg,k.ULS.sendTraceTag(574763870,327,15,`Comment reply id pointing to another reply. objectid: ${a.objectId} parentObjectId: ${d.objectId}`)))}}}vcn(a,d){for(let n=0;n<a.length;n++){let z;const O=a.J(n);({index:z}=this.xbh(O)).returnValue?(Array.insert(this.oh,z,O),this.JTe(O),d.add(O.objectId),this.Y_i(O)):k.ULS.sendTraceTag(37028936,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ParentId: {2}",
O.b5a,O.d7b,O.Lg))}}Tnm(a,d){if(oz.commentNode){var n=!1;for(let z=0;z<a.length;z++)if(a[z].vi.equals(oz.commentNode.id)){n=!0;break}n||k.ULS.sendTraceTag(571019914,327,15,"CommentDataMissing: matching para does not have expected rangeobject. is paraNode Connected: {0}",d.isConnected)}}d9l(a,d,n){if(!oz.commentNode||this.eHh)return!1;var z=oz.commentNode;const O=z.fa(Qb.a.mC,E.a.nil),ca=z.fa(Qb.a.RA,E.a.nil);if(O.equals(E.a.nil)&&ca.equals(E.a.nil))return!1;const Da=a.fa(Vd.a.rP,null);if(!Da)return!1;
for(let Xa=0;Xa<Da.length;Xa++){z=this.kd.Ta(Da[Xa]);if(!Bd.ParagraphReader.nb(z))continue;const zb=z.id.equals(O),Vb=z.id.equals(ca);if(zb||Vb){d=zb&&!d;n=Vb&&!n;a=a.isConnected;this.eHh=!0;oz.imj=z.id;if(d||n)return k.ULS.sendTraceTag(571019915,327,15,"CommentDataMissing: Graph has commentNode with matching para in OE but OE has empty starts {0} and ends {1}. is OE Connected: {2}",d,n,a),!0;break}}return!1}Nvk(a,d){a.zj(n=>{if(11===n.Yc){if(this.Ojf)return!0;var z=n.currentNode;const O=z.fa(bd.a.Rne,
null),ca=z.fa(bd.a.Qne,null);if(this.d9l(z,O,ca))return k.ULS.sendTraceTag(560537753,327,15,"OE filtering disabled for this session"),this.Ojf=!0;n=!!O&&0<O.length;const Da=!!ca&&0<ca.length;n&&O.forEach(zb=>{const Vb=this.kd.Ta(zb);Vb&&!ti.RKc(Vb)&&d.add(zb,0)});Da&&ca.forEach(zb=>{d.Na(zb)&&d.remove(zb)});(z=z.fa(Vd.a.rP,null))&&z.forEach(zb=>{const Vb=this.kd.Ta(zb);Bd.ParagraphReader.nb(Vb)&&!this.xf.EH.Na(zb)&&this.xf.EH.add(zb,new oE)});const Xa=d.keys;for(let zb=0;zb<Xa.length;zb++){z&&0<d.J(Xa.J(zb))&&
(this.xf.Cca.Na(Xa.J(zb))||this.xf.Cca.add(Xa.J(zb),new qi.a(new Wk.a)),z.forEach(Fc=>{const Yc=this.kd.Ta(Fc);Bd.ParagraphReader.nb(Yc)&&(this.xf.EH.J(Fc).J0||(this.xf.EH.J(Fc).J0=new qi.a(new Wk.a)),this.xf.Cca.J(Xa.J(zb)).add(Fc),this.xf.EH.J(Fc).AGb=!0,this.xf.EH.J(Fc).J0.add(Xa.J(zb)))}));let Vb;d.$(Vb=d.keys.J(zb),d.J(Vb)+1)}return n||Da}return!0},null)}QQf(a){40!==a.Yc&&k.ULS.sendTraceTag(594363294,327,15,"[CreateCommentForNode] Iterator is not at commentNode");const d=a.currentNode;var n=
d.getValue(Qb.a.W4b);const z=d.getValue(Qb.a.gE),O=d.getValue(Qb.a.IF).toString(),ca=d.getValue(Qb.a.WAc);let Da=null,Xa=null;this.Ja.hq(27);if(this.xe.jCb&&d.hasProperty(Qb.a.Aaa)){var zb=d.getValue(Qb.a.Aaa);Da=zb?x.b(zb||""):null}d.hasProperty(Qb.a.RGa)&&(Xa=d.getValue(Qb.a.RGa));let Vb=null,Fc=null;this.Ja.isFeatureEnabled(30)&&d.hasProperty(Qb.a.jld)&&d.hasProperty(Qb.a.VAc)&&(Vb=d.getValue(Qb.a.jld),Fc=d.getValue(Qb.a.VAc));zb=d.fa(Qb.a.mC,E.a.nil).toString();const Yc=d.fa(Qb.a.RA,E.a.nil).toString(),
yd=d.fa(Qb.a.S6,!1),je=d.fa(Qb.a.cK,null),Le=d.fa(Qb.a.Qmb,!1),Ve=this.U8b(a);n=new gO.Comment(this.xe.sEb?O:z,z,n,Xa||new Date(ca),this.xe.sEb?this.Paf.Cyl(je):je,yd,Ve,gO.Comment.Zcj,Le,Fc,Vb,Da);n.Nyc=zb;n.Myc=Yc;n.objectId=d.id.toString();n.d7b=O;this.VTh(O,z);a.tc(39);return n}VTh(a,d){(!a||Number.parseInvariant(a)>=Xj.a.m3i)&&k.ULS.sendTraceTag(544022547,327,10,`Durable Id is invalid ${a}`);d||k.ULS.sendTraceTag(544022548,327,10,`Guard Id is invalid ${d}`);try{this.Paf.iuk(a,d)}catch(n){"DuplicateDurableId"===
n.message?k.ULS.sendTraceTag(544511521,327,10,`Duplicate Durable Id: ${a} with Guard Id: ${d}`):"DuplicateGuardId"===n.message?k.ULS.sendTraceTag(544511522,327,10,`Duplicate GuardId: ${d} with Durable Id: ${a}`):k.ULS.sendTraceTag(544022549,327,10,`Unkown Error when adding to CommentIds map: ${n}`)}}U8b(a){if(40!==a.Yc)return k.ULS.sendTraceTag(594379426,327,15,"Trying to get text from node of type: {0}",a.Yc),this.uZc.hah([]);const d=a.Hm.id.toString();let n=a.Yc+":";const z=a.Sr();0<z&&(a.Rc(),
n+=a.Yc+":");const O=Array(z);for(let ca=0;ca<z;ca++){a.Rc();n+=a.Yc+":";const Da=a.currentNode;Da.Ebc=!0;O[ca]=Da;Da.ja||k.ULS.sendTraceTag(594363293,327,15,"[GetCommentText_Crash] "+n);!Da.ja&&this.xe.Ugn&&(l.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordSendErrorReportOnCommentInboundCrashSettings"),this.jq());a.hb();a.yg();n+=ca<z-1?":"+a.Yc+":":":"}this.xe.Fel&&1===O.length&&(a=Bd.ParagraphReader.text(O[0]),w.a.AU(a)&&k.ULS.sendTraceTag(562135946,327,50,"Comment with ObjectId:{0} is an empty comment. Was Comment Text Null: {1}",
d,!a));return this.uZc.hah(O)}jq(){if(Zd.WoncaApp.E1e){var a=new JQ.a(!0,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportTitle,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportDescription,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportPrivacyStatement);a.wc=1;a.ee(1,WoncaIntl.WoncaStrings.l_SendErrorReport);a.ee(0,WoncaIntl.WoncaStrings.l_NoThanks);a.j5(1);a.aw(tl.a.cpe,CommonUIStrings.l_DefaultDialogTitle,WoncaIntl.WoncaStrings.l_InboundingCommentFailed,Object(m.a)(this,this.J$k,"dialogResponseHandler"),
!1)}else this.ZM.dB(tl.a.cpe,this.qWi)}J$k(a){1===a&&(Zd.WoncaApp.E1e.rbi(),this.zuc.value.UMb(!0,"CommentInboundFailed"));this.ZM.dB(tl.a.cpe,this.qWi)}Rwe(a){if(!a||!a.objectId)return"";a=E.a.qe(a.objectId);a=this.kd.Ta(a);return this.Z7f(a)}KJl(a){return this.Rwe(a.Lg?this.NP(a.Lg):a)}f1m(a,d){if(this.Ja.isFeatureEnabled(193))if(this.xe.removePersonalInformation)k.ULS.sendTraceTag(595128897,3003,50,"RecordTaskChanges no ops because filter PII flag on"),this.Uic();else{this.Wfb.hM(Sa.a.FYe);var n=
null===d||void 0===d?void 0:d.taskId,z=!n;z?this.Wfb.Lq("TaskCreate",0):this.Wfb.Lq("TaskEngagement",0);try{const zb=this.quc.value,Vb=this.Rwe(a);if(""===Vb)this.EKe(z,"FailedDurableIdForComment");else{var O=this.KJl(a);if(""===O)this.EKe(z,"FailedDurableIdForParentComment");else if(z&&a.YG.sessionType!==Vs.create&&a.YG.sessionType!==Vs.reply)k.ULS.sendTraceTag(42856725,3003,10,"Unexpected create task for drafting session type [{0}]",a.YG.sessionType),this.Wfb.fl("TaskCreate","FailedTaskCreateInvalidSessionType");
else{var ca=null;a.YG.sessionType!==Vs.metadata&&(ca=Vb);var Da=this.ZDh.value;var Xa=Fg.a.le(a.text)?Da.Xri(ca,d,z):Da.Xri(ca,d,z,a.text[0]);0<Xa.length?z?(zb.xDb(Number.parseInvariant(O),Xa)||this.Wfb.fl("TaskCreate","TaskCreateFailed"),this.Uic()):(this.Wfb.Lq("TaskEngagement",0),zb.KCk(n,Xa)||this.Wfb.fl("TaskEngagement","TaskEngagementFailed")):this.EKe(z,"HistoryRecordsLengthZero")}}}catch(zb){this.EKe(z,"RecordTaskChangesFailed")}}}EKe(a,d){const n={name:"TaskExperienceDegraded",isInternal:!0};
a?this.Wfb.fl("TaskCreate",d,n):this.Wfb.fl("TaskEngagement",d,n)}Rhe(a,d){if(this.xe.jCb&&a){var n=l.AFrameworkApplication.userName,z=d.toString();a.usersByReactionType||(a.usersByReactionType={});var O=a.usersByReactionType[z];n=new hO(this.Z4,this.xrb,n);n.DateUtc=new Date;O?O.push(n):a.usersByReactionType[z]=[n];k.ULS.sendTraceTag(572014993,327,50,"Reaction type {0} added to {1} with Object Id: {2} ",d,a.Lg?"reply":"parent",a.objectId);z=[a];this.bW.hM(Dc.a.uVk,{succeeded:!0,customData:{reactionType:rE[d]}});
this.tPd(z,Nx.addReaction);this.Qaf.add(a.id)}}mUe(a,d){if(this.xe.jCb&&a&&a.usersByReactionType){var n=a.usersByReactionType[d.toString()];if(n&&n.length){for(let z=0;z<n.length;z++)if(n[z].UserId===this.Z4){Array.removeAt(n,z);break}k.ULS.sendTraceTag(572014994,327,50,"Reaction type {0} removed from {1} with Object Id: {2} ",d,a.Lg?"reply":"parent",a.objectId);n=[a];this.bW.hM(Dc.a.vVk,{succeeded:!0,customData:{reactionType:rE[d]}});this.Qaf.delete(a.id);this.tPd(n,Nx.removeReaction)}}}tPd(a,d){const n=
this.Nb.Wb(15);n.Sa(this.gwb);this.DH.uE.cfa(3);switch(d){case Nx.deleteComment:for(d=0;d<a.length;d++){var z=a[d];if(z.Dv!==qo.beingCreated){var O=E.a.qe(z.objectId);(O=this.kd.Ta(O))&&Xj.a.Gqe(O,this.kd);k.ULS.sendTraceTag(39364559,327,50,`Deleting Comment: [CommentObjectId:${z.objectId}]`)}}break;case Nx.addComment:this.Fj.mode=1;a=a[0];a.date=new Date;d=this.H2k(a);z=d.getValue(Qb.a.IF).toString();a.d7b=z;this.xe.sEb&&this.F0c.set(z,a.id);z=a.text;O=this.uFc();if(a.Lg){var ca=this.NP(a.Lg),Da=
this.kd.Ta(E.a.qe(ca.objectId));d.setValue(Qb.a.cK,Da.getValue(Qb.a.gE));this.addReply(d,z,this.kd,O,Da);k.ULS.sendTraceTag(39364560,327,50,`Adding Reply: [ObjectId:${a.objectId}][ParentObjectId:${ca.objectId}]`)}else(ca=this.Oa.ya.Ba)&&ca.ra&&(Qd.SelectionEditor.qj(ca)&&(Da=Qd.SelectionEditor.SU(ca.ra,!1))&&(this.Oa.setSelection(Da),ca=Da,k.ULS.sendTraceTag(592569872,327,50,"[RecordChanges] Selection extended")),Bd.ParagraphReader.nb(ca.ra.node)&&Bd.ParagraphReader.nb(ca.Fb.node)&&(this.v2b(d,z,
O,ca),k.ULS.sendTraceTag(39364561,327,50,`Adding Comment: [ObjectId:${a.objectId}]`)));z=d.fa(Qb.a.gE,null);a.b5a=z;a.K8a=jA.sentToServer;a.K8a=jA.succeeded;a.objectId=d.id.toString();this.JTe(a);this.VTh(a.d7b,a.b5a);this.$$e=!0;break;case Nx.editComment:this.Fj.mode=1;a=a[0];d=E.a.qe(a.objectId);d=this.kd.Ta(d);z=a.b5a;a.b5a||(z=d.getValue(Qb.a.gE),k.ULS.sendTraceTag(554446870,327,15,`Missing GuardID for Comment with objectId ${a.objectId} while editing`),z=this.xe.sEb?z:a.id);this.XNj(d,a.text,
z);k.ULS.sendTraceTag(39364562,327,50,`Editing Comment: [CommentObjectId:${a.objectId}]`);a.K8a=jA.sentToServer;a.K8a=jA.succeeded;break;case Nx.addReaction:case Nx.removeReaction:d=a[0];a=E.a.qe(d.objectId);a=this.kd.Ta(a);d=this.xe.jCb?(d=d.usersByReactionType)?x.c(d):"":null;d&&a.setValue(Qb.a.Aaa,d);break;case Nx.done:case Nx.undone:for(d=0;d<a.length;d++)z=a[d],O=E.a.qe(z.objectId),this.kd.Ta(O).setValue(Qb.a.S6,z.done),k.ULS.sendTraceTag(594124932,327,50,`${z.done?"Resolved":"Re-opened"} Comment: [CommentObjectId:${z.objectId}]`)}this.Gj.$A();
k.ULS.sendTraceTag(572281361,327,50,"Disposing transaction, should raise context reload event");n.dispose()}uFc(){const a=new Dd.GraphIterator;a.set(this.DH);this.yib.vJb(a);return a}GRc(){return this.Buj(!0)}HRc(){return this.Buj(!1)}Buj(a){if(!this.oh.length)return null;let d=this.qw;do{if(d){const n=this.xe.As&&!this.xf.xq;d=a?this.cAl(d,n):this.dAl(d,n)}else d=a?this.oh[0]:this.oh[this.oh.length-1];if(!d)return null}while(d.Lg&&""!==d.Lg);this.selectComment(d);return d}Fbi(a,d,n,z,O){const ca=
this.A5j.create(1074135127);this.xe.removePersonalInformation&&(d=CommonUIStrings.l_RemovedAuthorName,n=null);ca.setValue(Qb.a.commentId,gf.a.HH());ca.setValue(Qb.a.IF,Xj.a.Y7f());ca.setValue(Qb.a.KRa,l.AFrameworkApplication.userSessionId);ca.setValue(Qb.a.gE,a);ca.setValue(Qb.a.W4b,d);ca.setValue(Qb.a.RNf,d);ca.setValue(Qb.a.WAc,n?iO.a.lve(n,"MM/dd/yyyy HH:mm:ss",iO.a.dataCulture):"");ca.setValue(Qb.a.RGa,n);ca.setValue(Qb.a.S6,z);this.xe.jCb&&O&&(a=O?x.c(O):"",ca.setValue(Qb.a.Aaa,a));this.Ja.isFeatureEnabled(30)&&
(ca.setValue(Qb.a.VAc,this.Z4),ca.setValue(Qb.a.jld,this.xrb));return ca}H2k(a){var d;const n=this.Fbi(a.id,a.author,a.date,a.done,null!==(d=a.usersByReactionType)&&void 0!==d?d:{});a.Lg&&(this.xe.sEb?((d=this.Paf.uBl(a.Lg))||k.ULS.sendTraceTag(555008772,327,10,`Missing guardId for Comment With Durable Id ${a.Lg}`),a=d):a=a.Lg,n.setValue(Qb.a.cK,a));return n}addReply(a,d,n,z,O){this.addComment(a,d,z);d=ls.$Uh(a,n,O,!0);n=ls.$Uh(a,n,O,!1);d&&a.setValue(Qb.a.mC,d.Wa.paragraph.id);n&&(a.setValue(Qb.a.RA,
n.Wa.paragraph.id),n.Wa.paragraph.id||k.ULS.shipAssertTag(5564303,327,!1,"Comment node has no end anchor!"))}v2b(a,d,n,z){this.addComment(a,d,n);let O,ca;({start:d,end:O,startCp:n,endCp:ca}=this.fMk());let Da;if(-1===n||-1===ca){d=z.ra.node;n=Qs.a.a9b(z,!0);O=z.Fb.node;ca=Qs.a.a9b(z,!1);if(2<z.length){Da=[];for(let Xa=0;Xa<z.length;Xa++)Da.push(z.J(Xa).node.id);this.JUh(a,Da)}this.xe.NRd&&k.ULS.sendTraceTag(51233603,327,50,"Intents invalid reason {0}",this.ksc)}else if(2<this.a6.length){Da=[];for(z=
0;z<this.a6.length;z++)Da.push(this.a6[z].KOc);this.JUh(a,Da)}Xj.a.iyc(d,a.id,n,!0);Xj.a.iyc(O,a.id,ca,!1);a.setValue(Qb.a.mC,d.id);a.setValue(Qb.a.RA,O.id);this.OMj();O.id||k.ULS.shipAssertTag(5564304,327,!1,"Comment node has no end anchor!")}JUh(a,d){if(!(2>=d.length||!a||ti.RKc(a))){this.xf.Cca.add(a.id,new qi.a(new Wk.a));for(var n=E.a.Ap(d[0],d[1])?2:1,z=d.length-2;n<=z;n++){const O=d[n];this.xf.EH.Na(O)?this.xf.EH.J(O).J0||(this.xf.EH.J(O).J0=new qi.a(new Wk.a)):this.xf.EH.add(O,new oE(!0));
this.xf.EH.J(O).AGb=!0;this.xf.EH.J(O).J0.add(a.id);this.xf.Cca.J(a.id).add(O)}}}fMk(){let a=null,d=-1,n=null;var z=-1;if(!this.xe.NRd||!this.a6.length||2!==this.ksc)return{start:a,end:n,startCp:d,endCp:z};a=this.kd.Ta(this.a6[0].KOc);n=1===this.a6.length?a:this.kd.Ta(this.a6[this.a6.length-1].KOc);if(Bd.ParagraphReader.nb(a)&&Bd.ParagraphReader.nb(n)){z=ca=>3===ca.type;let O=this.Wu.Nlb(a,3,z);d=0<O.count?O.J(0).begin:-1;a!==n&&(O=this.Wu.Nlb(n,3,z));z=0<O.count?O.J(0).end:-1}this.ksc=-1===d||-1===
z?0:2;this.mAh||0!==this.ksc||(this.bW.fl("CommentThreadInProgress","DraftSelectionLost",{isInternal:!0},{name:"CommentExperienceDegraded",isInternal:!0}),this.mAh=!0);return{start:a,end:n,startCp:d,endCp:z}}OMj(){if(this.xe.NRd){for(let a of this.a6){const d=this.kd.Ta(a.KOc);Bd.ParagraphReader.nb(d)&&this.Wu.d_d(d,3)}this.a6=[];this.ksc=2}}addComment(a,d,n){a.anchor||(n.Re(a,1),n.rg(a),this.qwj(a,d,n))}qwj(a,d,n){let z=0;var O=null;d=this.uZc.yEn(d,ca=>{const Da=new Dq.a;n.Re(Da,1);n.rg(Da);n.Re(ca,
2);n.rg(ca);n.hb();n.hb()});for(let ca=0;ca<d.length;ca++)O=d[ca],z=O.getValue(Qb.a.Ob),ls.paragraphEditor.e$a(O),ls.yx&&ls.yx.zRa&&ls.yx.UXa(fe.a.create(O));a.setValue(Qb.a.gE,z.toString());return O}vJc(a,d){return ls.lPi(a,d)}AYl(){return 0<this.a6.length}mnd(a){if(a.ra&&Bd.ParagraphReader.nb(a.ra.node)&&Bd.ParagraphReader.nb(a.Fb.node)){const d=this.Fbi(Bd.ParagraphReader.gH(a.Fb.node).toString(),l.AFrameworkApplication.userName,new Date,!1,{}),n=new zv.a;n.FIa("\n");this.v2b(d,[n.Rtd()],this.uFc(),
a);return d}return null}Vt(a){return!this.vzf.y4g(this.wtd(a.getValue(Qb.a.IF)))}XNj(a,d,n){const z=new Dd.GraphIterator;for(z.set(a);z.Rc();)z.wg();this.qwj(a,d,z).lf(Qb.a.Ob,Number.parseInvariant(n));a.setValue(Qb.a.gE,n);if(d=this.jba(a.id.toString()))d.A$h=!1;a.setValue(Qb.a.Qmb,!1)}WNj(a,d){this.XNj(a,[Sys.Serialization.JavaScriptSerializer.serialize(d)],a.getValue(Qb.a.gE))}uH(a){a=this.kd.Ta(E.a.qe(a));return!!a&&a.fa(Qb.a.uH,!1)}Pej(a){a=this.kd.Ta(E.a.qe(a));return!!a&&a.fa(Qb.a.Uld,!1)}b9l(a){const d=
ti.YAi();return a&&d.has(a.objectId)}qcm(a){const d=this.kd.Ta(E.a.qe(a));return d?this.uDd(d):(k.ULS.sendTraceTag(562562755,341,15,"CommentNode is null, commentObjectId: "+a),!1)}uDd(a){var d=a.id,n=a.getValue(Qb.a.mC),z=a.getValue(Qb.a.RA);if(!E.a.Ap(n,z))return!1;n=a.Ib.Ta(n);if(!n)return!1;z=({ukd:a}=this.Mmd(n,d,!0)).returnValue;var O=({ukd:d}=this.Mmd(n,d,!1)).returnValue;if(-1===z||-1===O)return!1;n=n.ja;z=n.J(a);O=n.J(d);if(!z.hyperlink||!z.hyperlink.Yz||!O.Wh)return!1;for(a+=1;a<d;a++)if(z=
n.J(a),z.hyperlink||z.Wh)return!1;return!0}ggg(){return ls.JYl(this.oh,a=>this.uH(a),a=>this.Pej(a))}Mmd(a,d,n){let z;for(z=0;z<a.ja.length;z++){const O=a.ja.J(z);if(O.fd)for(let ca=0;ca<O.fd.length;ca++){const Da=O.fd.J(ca);if(Da.vi.equals(d)&&Da.Db===n)return{returnValue:O.cp,ukd:z}}}return{returnValue:-1,ukd:z}}Efi(a){if(this.xf.Cca.Na(a)){const d=new ra.a;for(let n of this.xf.Cca.J(a))this.W5m(n,a,d);this.xf.Cca.remove(a);kn.b(d)}}zPj(a,d){if(a.objectId){a=E.a.qe(a.objectId);var n=this.kd.Ta(a);
if(n){var z=n.fa(Qb.a.mC,E.a.nil);n=n.fa(Qb.a.RA,E.a.nil);z.equals(E.a.nil)||d.add(this.kd.Ta(z));n.equals(E.a.nil)||d.add(this.kd.Ta(n));if(this.xf.Cca.Na(a))for(let O of this.xf.Cca.J(a))d.add(this.kd.Ta(O))}}}W5m(a,d,n){let z;({value:z}=this.xf.EH.Ab(a,z));z&&(z.J0.remove(d),z.J0.count||(z.AGb=!1,n.add(this.kd.Ta(a))))}static get paragraphEditor(){return ls.Ki||(ls.Ki=la.a.instance.resolve("Box4.IParagraphEditor"))}static getInstance(){return ls.al()}static al(){if(ls.na)return ls.na;const a=new Nf.a(()=>
(new kA(!0,!0,!0)).O_k()),d=la.a.instance;ls.na=new ls(new Nf.a(()=>Lb.App.oa.za.jc),new Nf.a(()=>Lb.App.oa.za.Rb.xc),new Nf.a(()=>BH.a.instance),new jn.a,new tO,new Nf.a(()=>Lg.a.instance),d.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),d.resolve("WordEditor.Comments.ICommentFormatTranslator"),d.resolve("Common.IAppSettingsManager"),d.resolve("Box4.IFeatureHelper"),d.resolve("Box4.Intent.IIntentRangeEditor"),new Nf.a(()=>Lb.App.y5),d.resolve("Box4.IKickoutExecutor"),d.vf("WordEditor.Tasks.ITaskActor"),
a,d.resolve("WordEditor.Comments.CommentsSettings"),d.resolve("Box4.IUndoManager"),d.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),d.resolve("WordEditor.Comments.CommentsState"),d.resolve("WordEditor.Comments.WordCommentEventsActor"),d.resolve("Common.SharedCommentsTelemetryRecorder<Common.CommentActivityData>"),d.resolve("WordEditor.Comments.CommentNodeTracker"),d.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),d.resolve("WordEditor.Comments.ITasksUsageAndHealthLogger"),
Lb.App.jj.Cm.Oe(12),d.resolve("Box4.ParagraphRenderEvents"),d.resolve("Box4.CatchUpActivity.IChangeIdEditor"));return ls.na}static $Uh(a,d,n,z){d=Xj.a.Sla(n,d,z);if(!d)return null;d=d.Wa.fd;return Xj.a.Qhe(a.id,d,d.J(0).Gv,z)}static lPi(a,d){if(Lb.App.lostSession||(d?!Lb.App.Vt:!Lb.App.Vt&&!Lb.App.ap)||1===a.mode||!Object(Uc.a)(WG.PageView,Ic.InteractiveViewManager.instance.sc))return!1;a=Ic.InteractiveViewManager.instance.sc.Oa.Ag;return!a||aj.a.instance.E3(a)||a.contextId===Kb.a.anchoredObject?
!1:!0}static JYl(a,d,n){const z=new ra.a,O=new ra.a,ca=new yb.a,Da=new yb.a;for(let Vb of a){var Xa=Vb.id,zb=Vb.objectId;a=Vb.done;const Fc=!!zb&&d(zb);Xa&&(a&&z.add(Xa),Fc&&O.add(Xa),zb&&ca.$(Xa,zb));if(Xa=Vb.Lg)({value:zb}=Da.Ab(Xa,0)).returnValue||(zb=0),Da.$(Xa,zb+1);if(!Xa&&!a&&!Fc)return!0}for(let Vb of O){if(z.contains(Vb))continue;let Fc;if(({value:Fc}=ca.Ab(Vb,Fc)).returnValue&&n(Fc))return!0;let Yc;if(({value:Yc}=Da.Ab(Vb,0)).returnValue&&0<Yc)return!0}return!1}}ls.na=null;ls.Ki=null;ls.yx=
null;Object(t.a)(ls,"EditorCommentModel",eO.a,[679,680,681]);b(1274);class iD{constructor(a,d){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=a;this.canvasContextId=d}}Object(t.a)(iD,"CommentUIAction",null,[]);class NH{constructor(a,d,n,z){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=a;this.body=d;this.confirmButton=n;this.cancelButton=
z}}Object(t.a)(NH,"ViewContainerModalDialogStrings",null,[]);class AO{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je,Le,Ve){this.ga=a;this.ag=d;this.Cc=n;this.ib=z;this.Bq=O;this.gh=ca;this.YW=Da;this.AEa=Xa;this.Zge=zb;this.Zyf=Vb;this.fb=Fc;this.mW=Yc;this.xe=yd;this.xf=je;this.Aab=Le;this.G1=Ve;this.Oaf=this.Fj=null;this.xNh=this.Hnh=!1;this.Y$c=null;this.lXc=this.LZk()}get isVisible(){return this.xf.xq}get HBb(){return this.Hnh}set HBb(a){this.Hnh=a}get zqn(){return"SharedCommentsTaskPaneProps"}get MLd(){return null}get f6i(){return null}get HP(){return this.Bq}get Fna(){return null}get mVk(){return this.AEa}get As(){try{return this.xe.As}catch(a){return!1}}Vzi(){return new JH(l.AFrameworkApplication.isRtl,
Sys.CultureInfo.CurrentCulture.name,l.AFrameworkApplication.uiCulture,l.AFrameworkApplication.dataCulture)}LZk(){const a=new me.a,d=new iD(Sa.a.newComment,Cd.a.frame);d.preCallback=Object(m.a)(this,this.ttk,"addActionPreCallback");const n=new iD(Dc.a.nEg,Cd.a.frame),z=new iD(Dc.a.dOg,Cd.a.frame),O=new iD(Dc.a.deleteComment,Cd.a.frame);O.preCallback=Object(m.a)(this,this.d8k,"deleteActionPreCallback");O.postCallback=Object(m.a)(this,this.lal,"disableOnClosePaneOrNoSelection");this.As&&(n.preCallback=
Object(m.a)(this,this.AMi,"initCommentSessionPreCallback"),z.preCallback=Object(m.a)(this,this.AMi,"initCommentSessionPreCallback"));const ca=new iD(Sa.a.o1,Cd.a.frame);ca.preCallback=Object(m.a)(this,this.avn,"showHideActionPreCallback");a.$(6,ca);a.$(0,d);a.$(1,n);a.$(2,z);a.$(3,O);return a}avn(a,d,n){return 2!==n||this.xf.W7?1===n?32:2:(this.G1.rKa("OnCommentInit",Object.assign(new eC,{xWa:()=>{this.ga.processAction(Sa.a.o1,2)}})),32)}AMi(a,d,n){return 1!==n||this.xf.W7?2:8}ttk(a,d,n){if(1===n)return!this.vJc()||
this.HBb?8:this.xf.W7?2:32;if(!this.xf.W7)return this.HBb=!0,this.G1.rKa("OnCommentInit",Object.assign(new eC,{xWa:()=>{this.As||this.xf.xq||this.ga.processAction(Sa.a.o1,2)}})),32;this.As||this.xf.xq||this.ga.processAction(Sa.a.o1,2);(this.As||this.xf.xq)&&this.ib.wf(this.xf.xq?Ec.AFrame.Zs:Ec.AFrame.IP);return 2}d8k(a,d,n){return 1===n&&Yb.SessionStatusManager.instance.oj?8:2}lal(a,d,n,z){return 1!==z||(this.As||this.isVisible)&&this.Fj.model.Ou?a||this.Fj.model.Ou?32:8:8}$zj(a){this.xNh||(this.Cpk=
this.jze(),this.YW.t3a(),this.cqn(),this.Zpn(a),this.xNh=!0)}Zpn(a){this.Fj=a;this.Oaf=a.bIc;this.Fj.Dli=this.AEa}initialize(a){this.$zj(a);this.lb()}Sjg(){this.Y$c&&this.ib.wf(Ec.AFrame.Zs);this.HBb&&!this.As?(this.ga.processAction(Sa.a.newComment,2),this.HBb=!1):this.xf.dDb&&ao.a.oaa(l.AFrameworkApplication.tb,()=>{const a=this.xf.dDb.commentId,d=this.xf.dDb.xEd;this.ga.ob(Dc.a.selectComment,2,Object.assign(new ew.a,{commentId:a,doa:1,p5:!0,oCd:d}));d&&(ao.a.oaa(l.AFrameworkApplication.tb,()=>{this.ib.wf(Ec.AFrame.Zs)},
fw.a.J0g),pk.a.instance.Hd(ai.a.yUf,(new Date).getTime()));k.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",(new Date).getTime()-l.AFrameworkApplication.WJ);this.xf.dDb=null},fw.a.Pfn)}dispose(){}dda(){}selectComment(){this.isVisible||this.As||this.HCj();this.gh.updateCommandUI(!0)}lb(){this.ga.ma(Sa.a.cnb,Cd.a.frame,Object(m.a)(this,this.cnb,"hideCommentPane"));this.ga.Aa(Sa.a.xLb,Cd.a.frame,Object(m.a)(this,this.xLb,"queryToggleCommentPane"),96)}sfc(){-1!==
this.Fj.mode&&(this.Fj.mode||this.Mji())}Mji(){const a=this.Fj,d=a.cS,n=d.zye(),z=d.H6f(this.xe.Dmc&&this.xe.As&&!this.xf.xq);this.AEa.Ogn(z.length,n,!a.mode,n?5:1);this.AEa.ehn(z,d.Bab)}cqn(){const a=this.ib.Kc(Ec.AFrame.Zs);a.parent=Ec.AFrame.hp;a.uK=!0;a.IRd=!0;a.qPb=!0;a.Zgb((d,n)=>{mE.a.k4h(n.name)||(this.xf.ngc=ao.a.oaa(this.fb,()=>{n.name!==Ec.AFrame.IP&&2!==this.Fj.mode&&3!==this.Fj.mode&&(this.Fj.clearSelection(),this.gh.updateCommandUI(!0));this.xf.ngc=null},fw.a.JDm))});this.Bq.CR(Ec.AFrame.Zs);
if(this.xe.x3b)for(let d of ti.Zrj)a.bindAction(gb.KeyInputManager.mH(d),Dc.a.rJf)}xkn(){this.Y$c&&this.Zyf.Mnl()}Z5h(){this.D9j&&this.xkn()}RDm(a,d,n,z){const O=this.Fj,ca=O.cS.ZL;ca&&ca.YG?O.KNf.endCommentSession(ca.YG.draftId):k.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.cnb(a,d,n,z,!0);ao.a.oaa(this.fb,()=>{this.gh.updateCommandUI(!0)},fw.a.Xcn)}YCm(){this.Y$c&&this.ib.wf(Ec.AFrame.Zs);this.gh.updateCommandUI(!0)}kXa(a){a.zq(this.ib.kN);a.zq(this.ib.lN)}QNb(a,
d,n){if(1===n)return 32;this.HCj();return 32}HCj(){this.isVisible||(this.xf.W7?(this.Yal(),this.xf.xq=!0,this.G1.vTe(),this.ib.Wxc(Ec.AFrame.Zs),this.As&&this.xe.Dmc&&this.Fj.Vic(this.Fj.model.$5f(()=>!0)),this.D9j=!0,xk.UISurfaces.Nv().then(a=>{a.showTaskPane(IF.a.One,this.Cpk);return null}).catch(()=>{k.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.Fj.CNc(null),this.gh.updateCommandUI(!0),this.kXa(this.ib.Kc(Ec.AFrame.Zs)),this.G1.rKa("OnCommentPaneOpen"),k.ULS.sendTraceTag(37007903,
327,50,"New Comment Pane opened.")):this.G1.rKa("OnCommentInit",Object.assign(new eC,{xWa:()=>{this.xf.xq||this.ga.processAction(Sa.a.o1,2)}})))}Yal(){this.ga.ob(Dc.a.fra,2,null);this.ga.ob(Dc.a.e7,2,null)}vJc(){return ls.lPi(this.ga,!1)}v2b(){}show(){this.isVisible||this.ga.processAction(Sa.a.o1,2)}editComment(){return 2}cnb(a,d,n,z,O){if(1===n||!this.xf.xq)return 32;if(!this.As&&2===n&&(2===this.Fj.mode||3===this.Fj.mode))return O=new NH(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,
CommentPaneStrings.DiscardDialogAbandon,CommentPaneStrings.DiscardDialogResume),this.Zge.invokeModalConfirmationDialog(()=>{this.RDm(a,d,n,z)},()=>{this.YCm()},O),32;this.Z$b();if(this.As)return 32;O&&this.Mji();return 32}Z$b(){this.Fj.paneClosing();this.xf.xq=!1;if(this.As&&this.xe.Dmc){const d=this.Fj.model;this.Fj.Vic(d.$5f(n=>d.M5a(n)))}var a=ic.FocusManager.instance();a.Zd&&a.Zd.name===Ec.AFrame.Zs&&a.wf(this.As&&(2===this.Fj.mode||3===this.Fj.mode||this.Fj.uq.Ou)?Ec.AFrame.IP:a.uI);this.Bq.gx(Ec.AFrame.Zs);
this.ib.wCc(Ec.AFrame.Zs);xk.UISurfaces.Nv().then(d=>{d.hideTaskPane(IF.a.One,2);return null}).catch(()=>{k.ULS.sendTraceTag(559273378,327,10,"Error hiding Comment Pane.")});this.As&&(a=this.Fj.model.Ou)&&this.CLn(a);this.G1.rKa("OnCommentPaneClose");k.ULS.sendTraceTag(572281360,327,50,"New Comment Pane closed.")}CLn(a){a.done?this.Fj.clearSelection():this.Aab.Oji(a)}GKm(a=null){this.Zyf.Azj(3);this.Sjg();if(a){this.Z5h();Qc.a.UTe(a,[vb.a.contextMenu]);const d=this.ib.Kc(Ec.AFrame.Zs);this.ag.IBb(Ec.AFrame.Zs,
a,d.qPb)}}EIm(a){this.Bq.bE(Ec.AFrame.Zs);1!==a&&ao.a.oaa(l.AFrameworkApplication.tb,()=>{this.ib.Wv(Ec.AFrame.Zs)},fw.a.J0g)}onTaskPaneClose(){this.xf.W7&&this.Zyf.Azj(1)}jze(){const a={type:this.zqn,y2n:this.Z5h};return Object.assign(new yk.a,{title:WordEditorIntl.WordEditorStrings.L_Comments,contentProps:a,hideHeader:!1,width:300,location:2,onOpen:d=>{this.Y$c=d;this.GKm(d);this.mW.qah(!0)},onClose:()=>{this.Y$c=null;this.ga.ob(Sa.a.cnb,2,!0);this.gh.updateCommandUI(!0);this.onTaskPaneClose();
this.mW.qah(!1)},onShow:d=>{this.EIm(d)}})}o1(){return 32}xLb(a,d,n,z,O){if(1===n)return 32;O[Yf.a.On]=this.isVisible;return 32}}Object(t.a)(AO,"OfficeSharedCommentPane",null,[12,677,678]);class BO{constructor(a,d){this.containerType="full-pane";this.identifier=null;this.ga=a;this.identifier=d}openView(){this.ga.processAction(Sa.a.QNb,2)}closeView(){this.ga.ob(Sa.a.cnb,2,!0)}invokeModalConfirmationDialog(a,d,n){const z=new $g.StandardDialog;n&&n.title&&n.body&&n.confirmButton&&n.cancelButton||(k.ULS.sendTraceTag(35678229,
327,10,"InvokeModalConfirmationDialog: No localized strings provided."),n=new NH("","","",""));z.wc=1;z.ee(1,n.confirmButton);z.ee(0,n.cancelButton);z.iu(n.title,n.body,1,O=>{1===O?a():d()})}}Object(t.a)(BO,"ViewContainerAPI",null,[673,674]);class CO{constructor(a,d,n){this.zFn=a;this.dK=d;this.iZa=n;this.Zc=new oc.a;this.zFn.execute(z=>{this.iZa.aUe("OnBeforeTrackChangeMarkupViewChange",(O,ca)=>{ca&&ca.eEg!==z.Cl&&this.Zc.raiseEvent("OnBeforeTrackChangeMarkupViewChange",ca)});this.iZa.aUe("OnAfterTrackChangeMarkupViewChangeEventKey",
(O,ca)=>{ca&&ca.Cl===z.Cl&&(lE.Cl=z.Cl,this.Zc.raiseEvent("OnAfterTrackChangeMarkupViewChange",ca))})})}JLb(a,d){this.Zc.addHandler(a,d)}rKa(a,d){this.Zc.raiseEvent(a,d)}vTe(){this.dK.WQg||(this.dK.WQg=!0,this.Zc.raiseEvent("OnCommentRenderedOnce"))}}Object(t.a)(CO,"WordCommentEventsActor",null,[]);class OH{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(t.a)(OH,"InitCommentSessionResult",null,[]);class DO extends OH{constructor(){super();
this.updatedDraftSessionConfiguration=null}}Object(t.a)(DO,"BeginDraftingHostResult",OH,[]);class EO{constructor(a,d,n,z,O,ca,Da,Xa,zb,Vb,Fc,Yc,yd,je){this.wvc=this.bU=this.Om=null;this.G5j="WordWebCommitNewCommentActivity";this.H5j="WordWebCommitTaskActivity";this.C5j="WordWebCommentReactionActivity";this.Saf=null;this.hQh=0;this.Osf=null;this.xf=je;this.fb=a;this.AEa=d;this.I1j=n;this.Ic=z;this.D5j=O;this.xe=ca;this.gh=Da;this.ib=Xa;this.cP=zb;this.ga=Vb;this.te=Fc;this.Aab=yd}get kyb(){return this.bU}bTm(a){var d;
const n=this.kyb.ZL,z=this.bU.eba();if(z&&n){const O=hD.a.GEb(null!==(d=n.hX)&&void 0!==d?d:"");d=new fC(n.hX,n.szc,n.author,null!==O&&void 0!==O?O:"",!0);a.author=d;a.insertIndex=Array.indexOf(z,n);a.authorName=n.author;a.authorIdentity="";return null}return ao.a.TG(-2130915320)}initialize(a,d,n,z){this.Om=a;this.bU=d;this.wvc=n;this.Saf=z}beginDraftingAsync(a){if(!a)return new Promise((z,O)=>{O(ao.a.TG(-2130915327))});const d=new DO,n=Vs.s9f(a.sessionType);return void 0===n||null===n?new Promise((z,
O)=>{O(ao.a.TG(-2130915317))}):new Promise((z,O)=>{ao.a.oaa(this.fb,()=>{if(1!==this.Om.mode)k.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",this.Om.mode),O(ao.a.TG(-2130915325));else{this.B5h();try{switch(n){case 0:if(!this.Om.Fna.vJc()){O(ao.a.TG(-2130915326));return}k.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${a.draftId}`);this.Om.v2b(a);break;case 1:if(!a.threadId||""===a.threadId){O(ao.a.TG(-2130915324));return}if(this.xe.A6g){let Xa=this.bU.NP(a.threadId);
if(Xa){const zb=this.bU.$ui(Xa,!1),Vb=cE.U8b(Xa,zb,Xa.hX===this.xe.Z4);Vb&&this.D5j.invoke(a.threadId,Vb)}else k.ULS.sendTraceTag(579170962,327,10,"Smart reply provider not invoked since comment is null",this.Om.mode)}this.Om.addReply(a.threadId,a);break;case 3:if(!a.threadId||""===a.threadId){O(ao.a.TG(-2130915324));return}var ca=this.bU.NP(a.threadId);if(!ca){O(ao.a.TG(-2130915323));return}this.Om.editComment(ca,a);break;case 2:if(!a.commentId||""===a.commentId){O(ao.a.TG(-2130915324));return}let Da=
this.bU.NP(a.commentId);if(!Da){O(ao.a.TG(-2130915323));return}this.Om.editComment(Da,a)}}catch(Da){O(Da);this.zqj();k.ULS.sendTraceTag(553677466,327,10,`Drafting Exception ${Da} on Session ${n}`);return}(ca=this.bTm(d))?O(ca):z(d);this.zqj()}},fw.a.beginDraftingAsync)})}commit(a,d,n){const z=this.kyb.ZL;if(!z)throw ao.a.TG(-2130915320);var O=z.YG;if(!O)throw ao.a.TG(-2130915320);const ca=Vs.s9f(O.sessionType);if(void 0===ca||null===ca)throw ao.a.TG(-2130915317);if(a!==O.draftId)throw ao.a.TG(-2130915327);
let Da=!1,Xa=!1;O=!1;switch(ca){case 3:if(!n)throw ao.a.TG(-2130915327);break;case 0:this.te.Fd(()=>{if(!this.Om.Fna.vJc())throw ao.a.TG(-2130915326);z.text=[d];this.Om.$C&&!this.xf.xq?this.Om.ZPm(()=>{this.Om.TGa(z);this.Om.nel(a,z.id)}):this.Om.TGa(z);Xa=n&&null!=n.Task;Da=this.Om.$C;ao.a.oaa(this.fb,()=>{this.FMb(z.id)},fw.a.FMb)},"WESCA:C:C");break;case 1:this.te.Fd(()=>{z.text=[d];this.Om.TGa(z);Xa=n&&null!=n.Task;Da=this.Om.$C},"WESCA:C:R");break;case 2:this.te.Fd(()=>{z.text=[d];this.Om.$Ac(z);
this.ngj(Dc.a.Cmm)},"WESCA:C:E");break;default:throw ao.a.TG(-2130915322);}n&&(n.Resolve&&(this.rwj(z,n.Resolve.isResolved),n.Resolve.isResolved&&!this.xf.xq&&(this.Om.notify(Box4Intl.Box4Strings.L_CommentResolved,!0),this.xe.OAm&&(this.hQh++,3===this.hQh&&(k.ULS.sendTraceTag(590424158,327,50,"Resolve callout shown"),this.JAm())))),n.Task&&this.Om.MVk(z,n.Task),n.Reaction&&(O=this.xe.wVk,n.Reaction.isActive?this.Om.Rhe(z,n.Reaction.reactionType):this.Om.mUe(z,n.Reaction.reactionType)));this.xe.GVk&&
Xa&&this.cP.execute(zb=>zb.logActivity(this.H5j,"CommentsTasksFpsIsEnabled"));Da&&this.cP.execute(zb=>{zb.logActivity(this.G5j,"CommentsFpsIsEnabled")});O&&this.cP.execute(zb=>{zb.logActivity(this.C5j,"CommentReactionsFpsIsEnabled")});return z.id}JAm(){xk.UISurfaces.oK().then(a=>{var d=Object.assign(new aq.a,{target:'[data-unique-id~="ShowCommentsTopBar"]',showCloseIcon:!0,title:WordEditorIntl.WordEditorStrings.L_ResolvedCommentsAndTasksLocationCalloutTitle,content:WordEditorIntl.WordEditorStrings.L_ResolvedCommentsAndTasksLocationCalloutContent,
useTeachingStyles:!0,preventLightDismiss:!0,calloutProps:Object.assign(new hm.a,{directionalHint:6,gapSpace:4,isBeakVisible:!0})});d=a.callout(d);const n=Object.assign(new rm.a,{expirationOptions:Object.assign(new Hk.a,{displayTimeoutSeconds:10,onExpire:Object(m.a)(this,this.Ual,"dismissResolvedCommentsLocationNotification")})});this.Osf=a.addNotification(d,n)})}Ual(){xk.UISurfaces.oK().then(a=>{a.removeNotification(this.Osf);return this.Osf=null})}endCommentSession(a){const d=this.kyb.ZL;if(d){if(d.YG&&
d.YG.draftId!==a)throw ao.a.TG(-2130915327);if(d.Dv===qo.beingCreated)this.Om.deleteComment(d),!this.Om.$C||d.Lg||this.xf.xq||this.ib.wf(Ec.AFrame.ao);else{if(3!==this.Om.mode){k.ULS.sendTraceTag(33621450,327,50,"CommentingMode != EditingComment at the time of ending a comment session");return}d.Dv=qo.normal;d.K8a=jA.succeeded;d.YG=null;this.Om.AKf()}}this.gh&&this.gh.updateCommandUI(!0);this.kyb.zye()||this.AEa.$dh(1,!this.Om.mode)}deleteComment(a){(a=this.bU.NP(a))?(this.Om.deleteComment(a),this.Om.$C&&
!this.xf.xq?a.Lg||this.ib.wf(Ec.AFrame.ao):this.ib.Wv(Ec.AFrame.Zs),this.Ic.y4g(a)&&this.ngj(Dc.a.f0i)):k.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(a){this.FMb(a,0)}highlightComment(a){this.Om.CNc(a,0)}setThreadResolvedState(a,d){(a=this.bU.NP(a))&&this.rwj(a,d)}rwj(a,d){if(a.Lg&&""!==a.Lg)throw ao.a.TG(-2130915321);this.Om.t4b(a,d);d&&!this.xf.xq&&this.ib.wf(Ec.AFrame.ao)}presentLinkToComment(a){var d=this.bU.NP(a);d?(d=this.kyb.Rwe(d))?this.ga.ob(Sa.a.wkb,
2,{["nav"]:btoa(`{"${$D.a.comment}":${d}}`),["mode"]:"copy"}):k.ULS.sendTraceTag(578058146,327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",a):k.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",a)}selectFirstThreadInNextCommentContext(){this.Om.Auj(0)}selectLastThreadInPreviousCommentContext(){this.Om.Zfn()}registerForCommentEvents(a){const d=this.kyb.H6f(this.xe.Dmc&&this.xe.As&&!this.xf.xq),n=this.kyb.Bab,z=this.kyb.zye(),O=!this.Om.mode;this.AEa.Snn(this.Saf.GMl());
this.Saf.jGl().then(ca=>{this.AEa.D3m(a,d,z,O,n,ca);this.AEa.$dh(z?5:1,O);this.gh&&this.gh.updateCommandUI(!0)})}unregisterForCommentEvents(a){this.AEa.qVc(a)}registerForAction(a,d){this.I1j.Oca(a,d)}unregisterForAction(){}checkAtMentionCapability(){return this.wvc?this.wvc.atMentionsEnabledAsync():(k.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),new Promise(a=>{a(!1)}))}resolveSupported(){return!0}loadThreads(){k.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}B5h(){const a=
this.Om.$C&&!this.xf.xq?Ec.AFrame.IP:Ec.AFrame.Zs;if(a===Ec.AFrame.Zs){if(!this.xf.xq)return;xk.UISurfaces.Nv().then(d=>{d.setSelectedTaskPane(IF.a.One);return null})}this.ib.Wv(a)}FMb(a,d=1){this.B5h();this.Aab.uuj(a,Object.assign(new ew.a,{doa:d,p5:1===d}))}zqj(){this.Om.Fna.HBb&&(this.Om.Fna.HBb=!1)}ngj(a){this.ga.processAction(a,2)}}Object(t.a)(EO,"WordEditorSharedCommentAPI",null,[666,667]);class PH{constructor(a,d,n,z,O,ca,Da=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=
null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=a;this.parentId=d;this.commentBody=n;this.author=z;this.date=O;this.commentFlags=ca;this.usersByReactionType=Da}}Object(t.a)(PH,"OfficeSharedCommentModel",null,[]);class FO{constructor(a,d,n){this.va=a;this.xe=d;this.SFd=n;this.vTh="AD";this.xZc=new cg.a;this.Kyf=new cg.a;this.NFk=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.yrh=new hl.a}get mRj(){return this.va.Ga("UserPrincipalName")}get xrb(){return this.va.Ga("PresenceProvider")}get Z4(){return this.va.Ga("PresenceUserId")}get $i(){return this.SFd.value}K6i(a){const d=
this.NFk.exec(a);return d?d[1]:a}WDi(a,d=!1){let n=0;a.done&&(n=a.Lg&&""!==a.Lg?n|4:n|8);a.A$h&&(n|=2);d&&(n|=1);this.xe.CVe&&this.y4g(a)&&(n|=16);a.eqg&&(n|=32);this.pZl(a)||(n|=128);return n}pZl(a){return a?(a=this.$i.Ta(a.objectId))?a.hasProperty(Qb.a.Aaa):!1:!1}y4g(a){if(!a)return!1;if(void 0===a.hX||null===a.hX||""===a.hX)return this.Ixg(a.id,a.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.Z4||null===this.Z4||""===this.Z4)return this.Ixg(a.id,a.objectId,"PresenceUserId null or empty"),
!1;if(this.Z4==a.hX&&a.szc==this.xrb)return!1;const d=this.Hte(a.hX),n=this.Hte(this.Z4);if(this.xrb===this.vTh&&d&&n&&d[0]!=this.mRj&&d[1]!=n[1])return!0;this.Ixg(a.id,a.objectId,"Unknown");return!1}isCurrentUser(a){if(!a||void 0===a.hX||null===a.hX||""===a.hX||void 0===this.Z4||null===this.Z4||""===this.Z4)return!1;if(this.Z4==a.hX&&a.szc==this.xrb)return!0;a=this.Hte(a.hX);const d=this.Hte(this.Z4);return this.xrb===this.vTh&&a&&d?a[0]==this.mRj||a[1]==d[1]:!1}Hte(a){if(void 0===a||null===a)return null;
a=a.split("::");return 3===a.length?a.slice(1,3):null}Ixg(a,d,n){a&&!this.yrh.contains(a)&&(k.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${d}; reason: ${n}`),this.yrh.add(a))}yri(a,d){var n;if(!a)return null;const z=a.WGe;let O=!1;1===d&&(O=!0);d=a.author?this.K6i(a.author):"";const ca=hD.a.GEb(null!==(n=a.hX)&&void 0!==n?n:"");n=new fC(this.xe.CVe&&a.hX?a.hX:"",a.szc,d,null!==ca&&void 0!==ca?ca:"",this.isCurrentUser(a));return new PH(a.id?a.id:"",a.Lg?a.Lg:"",a.text&&
a.text.length?a.text[0]:null,n,a.date||z?a.date:new Date,this.WDi(a,O),this.YDi(a.usersByReactionType))}fpl(a,d,n){const z=[],O=new cg.a;if(!a)return this.xe.CVe?z:null;for(let ca of a)ca.Dv!==qo.beingCreated&&n(ca)&&(ca.id&&this.xZc.Na(ca.id)?(a=this.xZc.J(ca.id),a=this.w2k(ca,a,d),z.push(a),O.$(ca.id,a)):ca.id?(a=this.yri(ca,d),z.push(a),O.$(ca.id,a)):k.ULS.sendTraceTag(50667679,327,10,"CommentId should not be null"));this.xZc=O;return z}Ttl(a,d,n){const z=[];for(let O of a)O.Dv!==qo.beingCreated&&
n(O)&&(O.id&&this.xZc.Na(O.id)?z.push(this.xZc.J(O.id)):O.id&&z.push(this.yri(O,d)));return z}w2k(a,d,n){var z=a.WGe,O=1===n;n=a.Lg?a.Lg:"";const ca=a.text&&a.text.length?a.text[0]:null,Da=a.author?this.K6i(a.author):"",Xa=this.xe.CVe&&a.hX?a.hX:"",zb=a.szc?a.szc:"",Vb=hD.a.GEb(Xa);z=a.date||z?a.date:new Date;O=this.WDi(a,O);const Fc=this.isCurrentUser(a),Yc=this.YDi(a.usersByReactionType);return d.parentId===n&&d.commentBody===ca&&d.author.DisplayName===Da&&d.author.UserId===Xa&&d.author.Provider===
zb&&d.author.IsCurrentUser===Fc&&d.date===z&&d.commentFlags===O&&this.VEk(d.usersByReactionType,Yc)?d:(d=new fC(Xa,zb,Da,null!==Vb&&void 0!==Vb?Vb:"",Fc),new PH(a.id,n,ca,d,z,O,Yc))}VEk(a,d){if(!a&&!d)return!0;if(!d||!a)return!1;var n=Object.keys(a);if(n.length!==Object.keys(d).length)return!1;for(let z of n){if(!(z in d))return!1;n=a[z];const O=d[z];if(n.length!==O.length)return!1;for(let ca=0;ca<n.length;ca++)if(!this.LEk(n[ca],O[ca]))return!1}return!0}LEk(a,d){return a||d?a&&d&&a.UserId===d.UserId&&
a.Provider===d.Provider&&a.Email===d.Email&&a.DisplayName===d.DisplayName&&a.IsCurrentUser===d.IsCurrentUser?!0:!1:!0}YDi(a){if(!a)return null;const d={},n=this.va.Ga("PresenceUserId");for(let O of Object.keys(a)){const ca=[];var z=a[O];for(let Da of z){z=Da.UserId===n;let Xa;this.Kyf.Na(Da.UserId)?(Xa=this.Kyf.J(Da.UserId),Xa.IsCurrentUser=z):(Xa=new fC(Da.UserId,Da.Provider,Da.DisplayName,Da.Email,z),this.Kyf.add(Da.UserId,Xa));ca.push(Xa)}d[O]=ca}return d}}Object(t.a)(FO,"WordEditorSharedCommentModelTranslator",
null,[665]);class QH{constructor(){this.Wm=null;this.q3d=this.gKh=this.Doh=this.CPh=this.URh=this.wGh=this.LLh=!1}XDi(){this.Wm||(k.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.Qyj());return this.Wm}jGl(){return new Promise((a,d)=>{this.q3d?a(this.mAi()):this.Tvj().then(()=>{a(this.mAi())}).catch(n=>{d(n)})})}mAi(){this.q3d||k.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");
let a;a=33;this.Doh&&(a|=2);this.LLh&&(a|=8);this.URh&&(a|=16);this.wGh&&(a|=4);this.CPh&&(a|=64);this.gKh&&(a|=128);return a}}Object(t.a)(QH,"OfficeSharedCommentsAppCapabilities",null,[857]);class GO extends QH{constructor(a){super();this.leb=null;this.xe=a;this.Lon();this.Qyj()}Lon(){this.CPh=this.xe.Anc;this.URh=!1;this.gKh=this.wGh=this.LLh=!0}initialize(a){this.leb=a;this.Tvj()}GMl(){let a=120;this.xe.bKc&&(a|=1536);return a}Qyj(){this.Wm={};this.Wm.LivePersonaPicker="true";this.Wm.PersonaColor=
"true";this.Wm.DiscreteHostedComments=this.xe.Eal.toString();this.Wm.NewCommentButton="true";this.Wm.DisabledChangeGates="WebThemeIntegrationHighContrastFixes,"+this.xe.Bal;this.Wm.CommentsFluentUI="true";this.Wm.CommentTasks=this.xe.Anc.toString();this.Wm.CommentTasksFromReply=this.Wm.CommentTasks;this.Wm.CommentsFluentUIV2="true";this.Wm.CommentFriendlyTimestamps=this.xe.nVk.toString();this.Wm.AtMentionFloodgateSurvey=this.xe.oFk.toString();this.Wm.HyperlinksInComments="true";this.Wm.NewModelState=
"true";this.Wm.LogDraftCommentIdPair="true";this.Wm.RichTextFormattingInWeb=this.xe.x3b.toString();this.Wm.NoDiscardOnFocusLoss="true";this.Wm.NewResolvedCardDesignInWeb="true";this.Wm.RichContentEditIntegration="true";this.Wm.HyperlinksWithDisplayText="true";this.Wm.SmartReplies=this.xe.A6g.toString();this.Wm.NewBorderAndFocusLookInWeb="true";this.Wm.LinkToComment="true";this.Wm.TaskPaneWithNewInfrastructure="true";this.Wm.CommentReactions=this.xe.jCb.toString();this.Wm.WebThemeIntegration="true";
this.Wm.NewSelectionInteractions="true";this.Wm.QuillInitializationTelemetry="true";this.Wm.PersonaIconImageForWeb="true";this.Wm.HighlightsAndFontColorInWebComments=this.xe.bKc.toString();this.Wm.TruncationUIWithReadMoreText="true";this.Wm.CtrlEnterTip=this.xe.R5k.toString();this.Wm.AtMentionHintMessage=this.xe.pFk.toString();this.Wm.LivePersonaCardForWeb=this.xe.klm.toString();this.Wm.TaskHistoryRecordIDs=this.xe.rCn.toString();this.Wm.ContentNavigation=this.xe.trackChangeInSidetrackEnabled.toString()}Tvj(){return new Promise((a,
d)=>{this.leb?this.leb.atMentionsEnabledAsync().then(n=>{this.Doh=n;this.q3d=!0;a(this.q3d)}):(k.ULS.sendTraceTag(588292830,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),d(ao.a.TG(-2130915320)))})}}Object(t.a)(GO,"WordSharedCommentsAppCapabilities",QH,[611]);class PF{constructor(){this.Z=null;this._initialized=!1;this.FVk={fjb:"webasynccollabeng",featureName:"Comments",GUc:"CommentsFeatureUsage",gpc:7};this.wCn=
{fjb:"webasynccollabeng",featureName:"Tasks",GUc:"TasksFeatureUsage",gpc:7}}get name(){return"WordEditor.Comments"}Hb(a){this.Z=a;a.ha("WordEditor.Comments.ICommentsUsageAndHealthLogger",()=>new Pp.a(ja.Health.instance,new Qr.a,this.FVk)).as("WordEditor.Comments.ICommentsUsageAndHealthLogger").singleInstance();a.ha("WordEditor.Comments.ITasksUsageAndHealthLogger",()=>new Pp.a(ja.Health.instance,new Qr.a,this.wCn)).as("WordEditor.Comments.ITasksUsageAndHealthLogger").singleInstance();a.ha("WordEditor.Comments.CommentNodeTracker",
()=>new YN(this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.CommentNodeTracker").singleInstance();a.ha("WordEditor.Comments.CommentsSettings",()=>new bO(l.AFrameworkApplication.K,this.Z.resolve("Box4.IFeatureHelper"),new Nf.a(()=>Lb.App.oa.za.jc),new Nf.a(()=>BH.a.instance),this.Z.resolve("WordEditor.Comments.CommentNodeTracker"),this.Z.resolve("WordEditor.Sidetrack.SidetrackSettings"))).as("WordEditor.Comments.CommentsSettings").singleInstance();a.ha("WordEditor.Comments.CommentsState",
()=>new lE).singleInstance();a.ha("WordEditor.Comments.WordCommentEventsActor",()=>new CO(a.Ca("Box4.TrackChange.ITrackChangeManager"),a.resolve("WordEditor.Comments.CommentsState"),a.resolve("Box4.TrackChange.ITrackChangeEventsActor"))).singleInstance();a.ha("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new FO(l.AFrameworkApplication.K,this.Z.resolve("WordEditor.Comments.CommentsSettings"),new Nf.a(()=>Lb.App.oa.za.jc.kd))).as("WordEditor.Comments.IWordEditorSharedCommentModelTranslator").singleInstance();
a.ha("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new cC(a.resolve("WordEditor.Comments.CommentsSettings"),a.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Comments.ICommentFormatTranslator").singleInstance();a.ha("Common.Comments.OfficeSharedCommentsEventHost",()=>new yN(l.AFrameworkApplication.tb)).as("Common.Comments.IOfficeSharedCommentsEventHost").singleInstance();a.ha("WordEditor.Comments.CommentActionInTypingRecorder",()=>new JN(this.Z.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentActionInTypingRecorder").singleInstance();
a.ha("WordEditor.Comments.EditorCommentModel",ls.getInstance).as("Common.Comments.ICommentModel").as("WordEditor.Comments.IWordEditorCommentModel").as("WordEditor.Comments.IEditorCommentModel").singleInstance();a.ha("WordEditor.Comments.CommentHighlightOnRestActor",()=>new VN(new Nf.a(()=>Lb.App.oa.za.jc),a.resolve("WordEditor.Comments.CommentsState"),a.resolve("WordEditor.Comments.IEditorCommentModel"),a.resolve("WordEditor.Comments.WordCommentEventsActor"),a.resolve("Box4.INotebookManager").Cm,
Ln.a.instance)).as("WordEditor.Comments.ICommentHighlightOnRestActor").singleInstance();a.ha("WordEditor.Comments.CommentHighlightUtils",()=>new kE(a.resolve("Box4.Highlight.IHighlightManager"))).singleInstance();a.ha("WordEditor.Comments.DefaultHighlightChangeHandler",()=>new cO(a.resolve("WordEditor.Comments.CommentHighlightUtils"))).singleInstance();a.ha("WordEditor.Comments.AllMarkupModeHighlightChangeHandler",()=>new HN(a.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),a.resolve("WordEditor.Comments.CommentHighlightUtils"),
l.AFrameworkApplication.la.dZ,l.AFrameworkApplication.la.l1,l.AFrameworkApplication.pa,l.AFrameworkApplication.tb,a.resolve("WordEditor.Comments.CommentsState"),a.Ca("WordEditor.Comments.IEditorCommentManager"))).singleInstance();a.ha("WordEditor.Comments.CommentHighlightActor",()=>new SN(new Nf.a(()=>Lb.App.oa.za.jc.kd),a.resolve("WordEditor.CommentsInteractive.ICommentEditor"),a.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),a.Ca("WordEditor.Comments.IEditorCommentManager"),Ln.a.instance,
a.resolve("WordEditor.Comments.AllMarkupModeHighlightChangeHandler"),a.resolve("WordEditor.Comments.DefaultHighlightChangeHandler"),a.resolve("WordEditor.Comments.CommentHighlightUtils"),a.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("WordEditor.Comments.ICommentHighlightActor").singleInstance();a.ha("WordEditor.Comments.CommentHintActor",()=>new Qt(a.resolve("WordEditor.Comments.CommentsSettings"),Ae.a.instance,Eg.a.instance,Kc.a.instance,l.AFrameworkApplication.pa,Sf.TableCellReader.pSi,
Uf.moveToLastRenderedCellOfTheRow,new so.a,a.Ca("Box4.ContentControlConfigSettings"),a.resolve("WordEditor.Comments.IEditorCommentModel"),a.resolve("WordEditor.Comments.ICommentHighlightActor"),a.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"))).as("WordEditor.Comments.ICommentHintActor").singleInstance();a.ha("WordEditor.Comments.CommentMarginEntryPointActor",()=>new GF(Ae.a.instance,Eg.a.instance,Kc.a.instance,l.AFrameworkApplication.pa,a.resolve("WordEditor.Comments.ICommentHintActor"),
a.Ca("Common.IZoomManager"))).singleInstance();a.ha("WordEditor.Comments.ViewContainerAPI",()=>new BO(l.AFrameworkApplication.pa,"OfficeSharedCommentPaneSurface")).as("WordEditor.Comments.IWordViewContainerAPI").singleInstance();a.ha("Common.Comments.CommentActivationManager",()=>new zN).as("Common.Comments.ICommentActivationManager").singleInstance();a.ha("Common.Comments.ViewContainerEventHost",()=>new AN(l.AFrameworkApplication.tb,"OfficeSharedCommentPaneSurface")).as("Common.Comments.IViewContainerEventHost").singleInstance();
a.ha("WordEditor.Comments.CommentSmartReplyProvider",()=>new aO(this.Z.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.Z.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).as("Common.Comments.ICommentSmartReplyProvider").singleInstance();a.ha("WordEditor.Comments.WordSharedCommentsAppCapabilities",()=>new GO(a.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.IWordSharedCommentsAppCapabilities").singleInstance()}init(){this.Z.resolve("Box4.IFeatureHelper").tk.continueWith(()=>
{this.Po()})}Po(){if(this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(28)){this.Z.ha("WordEditor.Comments.OfficeSharedCommentPane",()=>new AO(l.AFrameworkApplication.pa,l.AFrameworkApplication.la.Qu,l.AFrameworkApplication.la.oB,l.AFrameworkApplication.la.Zh,l.AFrameworkApplication.la.rn,Lb.App.oa,zp.a.instance,this.Z.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.Z.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.Z.resolve("Common.Comments.IViewContainerEventHost"),
l.AFrameworkApplication.tb,this.Z.resolve("WordEditor.Comments.IFloatingCommentManager"),this.Z.resolve("WordEditor.Comments.CommentsSettings"),this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("WordEditor.Comments.ICommentSelectionActor"),this.Z.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("Common.Comments.ICommentPane").as("WordEditor.Comments.IOfficeSharedCommentPane").singleInstance();this.Z.ha("Common.Comments.OfficeSharedCommentsActionHost",()=>new CN(l.AFrameworkApplication.pa,
this.Z.resolve("WordEditor.Comments.IOfficeSharedCommentPane").lXc)).as("Common.Comments.IOfficeSharedCommentsActionHost").singleInstance();this.Z.ha("WordEditor.Comments.WordEditorSharedCommentAPI",()=>new EO(l.AFrameworkApplication.tb,this.Z.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.Z.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),this.Z.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),this.Z.resolve("Common.Comments.ICommentSmartReplyProvider"),
this.Z.resolve("WordEditor.Comments.CommentsSettings"),Lb.App.oa,l.AFrameworkApplication.la.Zh,this.Z.Ca("Common.ISystemInitiatedFeedback"),l.AFrameworkApplication.pa,Ln.a.instance,xk.UISurfaces.oK(),this.Z.resolve("WordEditor.Comments.ICommentSelectionActor"),this.Z.resolve("WordEditor.Comments.CommentsState"))).as("WordEditor.Comments.IWordEditorSharedCommentAPI").singleInstance();yo.a.factory=pz.getInstance;this.Z.ha("WordEditor.Comments.EditorCommentManager",pz.getInstance).as("Common.Comments.ICommentManagerCore").as("WordEditor.Comments.IEditorCommentManager").singleInstance();
this.Z.ha("WordEditor.Comments.CommentFloatingContainerActor",()=>new RN(this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("WordEditor.Comments.CommentsSettings"),this.Z.resolve("WordEditor.Comments.IEditorCommentModel"),l.AFrameworkApplication.tb,this.Z.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.Z.resolve("WordEditor.Comments.WordCommentEventsActor"),this.Z.resolve("WordEditor.Sidetrack.ISidetrackHelper"),()=>document.querySelector(`#${og.AppFrame.VDa} .${yQ.a.vjb}`),
this.Z.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),l.AFrameworkApplication.la.Zh)).as("WordEditor.Comments.ICommentFloatingContainerActor").singleInstance();var a=this.Z.resolve("WordEditor.Sidetrack.SidetrackSettings"),d=a.trackChangeInSidetrackEnabled;d&&this.Z.resolve("WordEditor.Sidetrack.IFloatingContainerActorConsumer").Clj(this.Z.resolve("WordEditor.Comments.ICommentFloatingContainerActor"));this.Z.ha("WordEditor.Comments.FloatingCommentManager",()=>new nE(this.Z.resolve("WordEditor.Comments.IEditorCommentModel"),
l.AFrameworkApplication.tb,Ln.a.instance,this.Z.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.Z.resolve("WordEditor.Comments.CommentsSettings"),xQ.a.get_instance(),this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("WordEditor.Comments.WordCommentEventsActor"),this.Z.resolve("WordEditor.Sidetrack.ISidetrackHelper"),this.Z.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),a)).singleInstance();this.Z.ha("WordEditor.Comments.IFloatingCommentManager",()=>
d?this.Z.resolve("WordEditor.Sidetrack.SidetrackManager"):this.Z.resolve("WordEditor.Comments.FloatingCommentManager")).as("Box4.IFloatingObjectUpdater").singleInstance();this.Z.ha("WordEditor.Comments.CommentSelectionActor",()=>new $N(l.AFrameworkApplication.pa,this.Z.resolve("Common.Comments.ICommentModel"),this.Z.resolve("WordEditor.Comments.ICommentHighlightActor"),zy.getInstance(),this.Z.resolve("WordEditor.Comments.IFloatingCommentManager"),this.Z.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
l.AFrameworkApplication.la.Zh,this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("WordEditor.Comments.CommentsSettings"),new Nf.a(()=>Lg.a.instance),this.Z.resolve("WordEditor.Comments.CommentNodeTracker"),this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.ICommentSelectionActor").singleInstance();this.Z.ha("WordEditor.Comments.CommentInitActor",()=>new XN(this.Z.resolve("WordEditor.Comments.IEditorCommentManager"),this.Z.resolve("WordEditor.Comments.IEditorCommentModel"),
this.Z.resolve("WordEditor.Comments.IOfficeSharedCommentPane"),this.Z.resolve("WordEditor.Comments.ICommentSelectionActor"),this.Z.resolve("WordEditor.Comments.CommentsSettings"),this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("WordEditor.Comments.IFloatingCommentManager"),zy.getInstance(),Lb.App.oa.Np,l.AFrameworkApplication.pa,this.Z.resolve("Common.IDynamicScriptLoaderProvider").uG,this.Z.Ca("WordEditor.Comments.ICommentRibbonCommandHandler"),l.AFrameworkApplication.la.Zh,this.Z.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),
this.Z.resolve("Common.Comments.ICommentSmartReplyProvider"),this.Z.resolve("Common.Comments.ICommentActivationManager"),this.Z.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.Z.Ca("Common.ISystemInitiatedFeedback"),this.Z.resolve("WordEditor.Comments.WordCommentEventsActor"),this.Z.Ca("Common.App.SafeLinks.ISafeLinksManager"),this.Z.Ca("Common.App.People.IExternalPeopleAPI"),this.Z.resolve("Common.OfficeSharedCommentsTelemetry"),this.Z.resolve("Common.Comments.IViewContainerEventHost"),
this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.Z.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),this.Z.resolve("WordEditor.Sidetrack.ISidetrackHelper"),a)).singleInstance();this.Z.ha("WordEditor.Comments.CommentsActionManager",()=>new ZN(this.Z.resolve("WordEditor.Comments.EditorCommentManager"),this.Z.resolve("WordEditor.Comments.EditorCommentModel"),this.Z.resolve("WordEditor.Comments.ICommentHintActor"),this.Z.resolve("WordEditor.Comments.ICommentSelectionActor"),
this.Z.resolve("WordEditor.Comments.WordCommentEventsActor"),this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("WordEditor.Comments.IFloatingCommentManager"),this.Z.resolve("WordEditor.Comments.CommentsSettings"),this.Z.resolve("Common.Comments.ICommentPane"),new Nf.a(()=>Lb.App.oa.za.jc.kd),l.AFrameworkApplication.pa,new Nf.a(()=>Lg.a.instance),ic.FocusManager.instance(),Ln.a.instance)).as("WordEditor.Comments.CommentsActionManager").singleInstance();this.Z.resolve("WordEditor.Comments.CommentInitActor");
var n=this.Z.resolve("WordEditor.Comments.CommentsSettings").As,z=this.Z.resolve("WordEditor.Comments.EditorCommentManager"),O=this.Z.resolve("WordEditor.Comments.CommentsSettings");this.Z.resolve("WordEditor.Comments.CommentsActionManager");z&&n&&(this.Z.resolve("WordEditor.Comments.CommentsState").FBb=PF.Hti(),O.B6b||this.Z.resolve("WordEditor.Comments.WordCommentEventsActor").rKa("OnCommentInit"));Sw.Bpm();O.eyd&&Lb.App.oa.za.zki();yo.a.instance&&(O.B6b||Bi.a.get_instance().Ik(4,()=>{this.KDm(n)},
11).continueWith(()=>{this.Y2l()}),this._initialized=!0);this.g2m(this.Z.Ca("Box4.Accessibility.IAccessibilityContextManager"),this.Z.resolve("Box4.IParagraphReader"),this.Z.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}}Y2l(){this.Z.resolve("WordEditor.Comments.WordCommentEventsActor").rKa("OnCommentInit")}KDm(a){a||this.WTl()}WTl(){const a=PF.Hti();a&&(k.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-l.AFrameworkApplication.WJ),this.Z.resolve("WordEditor.Comments.WordCommentEventsActor").rKa("OnCommentInit",
Object.assign(new eC,{xWa:()=>{yo.a.instance.Fna.isVisible||l.AFrameworkApplication.pa.processAction(Sa.a.o1,2);this.Z.resolve("WordEditor.Comments.ICommentSelectionActor").suj(a,Object.assign(new ew.a,{G4g:!0}))}})),this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger").hM(Sa.a.Jne))}g2m(a,d,n){a&&a.execute(z=>{z.Pca(new qz(d,n))})}dispose(){this._initialized&&(yo.a.instance&&yo.a.instance.dispose(),this._initialized=!1)}static Hti(){return l.AFrameworkApplication.K.Ga("BootActivityNavigationId")}}
Object(t.a)(PF,"PackageManager",null,[1,2]);class HO{YEe(a){return Xj.a.YEe(a)}Qmg(a){return Xj.a.Qmg(a)}FGg(a,d){Xj.a.FGg(a,d)}JGg(a,d){Xj.a.JGg(a,d)}ERf(a){return Xj.a.ERf(a)}vJb(a){return BH.a.instance.vJb(a)}deleteComment(a,d){Xj.a.deleteComment(a,d)}Gqe(a,d){Xj.a.Gqe(a,d)}TLb(a){Xj.a.TLb(a)}Sla(a,d,n){return Xj.a.Sla(a,d,n)}rTa(a,d,n){return Xj.a.rTa(a,d,n)}RGc(a,d){return Xj.a.RGc(a,d)}D6f(a,d,n,z=null){return Xj.a.D6f(a,d,n,z)}iyc(a,d,n,z){Xj.a.iyc(a,d,n,z)}Qhe(a,d,n,z){return Xj.a.Qhe(a,d,
n,z)}get Dbc(){return Xj.a.Dbc}set Dbc(a){Xj.a.Dbc=a}JWa(a,d){Xj.a.JWa(a,d)}kQd(a){Xj.a.kQd(a)}YTg(a){Xj.a.YTg(a)}Lye(a,d){return Xj.a.Lye(a,d)}GGg(a,d){Xj.a.GGg(a,d)}IGg(a,d){Xj.a.IGg(a,d)}uNe(a,d,n,z,O,ca){Xj.a.uNe(a,d,n,z,O,ca)}SZf(a,d){Xj.a.SZf(a,d)}yNd(a,d,n,z){return Xj.a.yNd(a,d,n,z)}FNd(a,d,n,z){return Xj.a.FNd(a,d,n,z)}}Object(t.a)(HO,"CommentEditorProxy",null,[308]);class IO{constructor(){this.vPh=this.Z=null}get TBn(){return this.vPh||(this.vPh=la.a.instance.Ca("WordEditor.ITableEditor"))}get name(){return"WordEditor.CommentsInteractive"}Hb(a){this.Z=
a;a.ha("WordEditor.CommentsInteractive.CommentEditorProxy",()=>new HO).as("WordEditor.CommentsInteractive.ICommentEditor").singleInstance()}init(){this.Z.resolve("Box4.IFeatureHelper").tk.continueWith(()=>{this.Po()})}Po(){this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(28)&&this.N_l()}dispose(){}N_l(){iC.a.uKa(Xj.a.JGg);$f.SCf(Xj.a.GGg);$f.Gie(Xj.a.IGg);$f.pyk(Xj.a.HDm);this.TBn.execute(a=>{a.TCf(Xj.a.JWa)});Lb.App.jj.Cm.Oe(39).tq(Xj.a.FGg);$f.Hxk(Xj.a.OCm);$f.Dxk(Xj.a.mCm)}}Object(t.a)(IO,
"PackageManager",null,[1,2]);var KQ=b(1802),JO=b(1484);class RH{constructor(a,d,n,z,O,ca,Da){this.O1a=a;this.yka=d;this.Oea=n;this.mc=z;this.K$j=O;this.tof=ca;this.YWb=Da;JO.a.oyk((Xa,zb)=>{this.Zwk(zb.graphNode,zb.gVk)});JO.a.Lyk((Xa,zb)=>{this.kZk(zb.graphNode,zb.ITk)})}Sxe(){var a=this.K$j();const d=this.mc.Sl();d.set(a);if(this.yka.tIn(d))return d;d.set(a);jm.PageNavigator.instance.pQ(d);a=this.Oea.K4k(d.currentNode);d.rg(a);return d}aAe(a){const d=this.Sxe();let n=null;this.yka.eve(d,z=>{this.Oea.oFi(z)===
a&&(n=z);return!n});return n}kFi(a){const d=this.Sxe();let n=null;this.yka.eve(d,z=>{this.Oea.ZGc(z)===a&&(n=z);return!n});return n}K0i(a,d,n){k.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",a,d,n)}pFi(){const a=this.Sxe(),d=[];this.yka.eve(a,n=>{d.push(this.Oea.oFi(n));return!0});return d}xDb(a,d){if(!d.length)return this.YWb&&k.ULS.sendTraceTag(42812043,3003,10,"A task must always have at least one history record."),null;const n=
this.Sxe(),z=xa.a.create().toString(),O=new Uj.a;for(let ca of d)O.add(ca),this.K0i(ca.type,z,ca.completion);d=this.O1a.s_g(O);this.Oea.xDb(n.currentNode,z,a,d);this.tof();return z}ie(a){(a=this.aAe(a))?(this.Oea.ie(a),this.tof()):this.YWb&&k.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}ZGc(a){a=this.aAe(a);return a?this.Oea.ZGc(a):(this.YWb&&k.ULS.sendTraceTag(42812044,3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}lFi(a){return this.Oea.ZGc(a)}nFi(a){a=
this.aAe(a);if(!a)return this.YWb&&k.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;a=this.Oea.Pbg(a);return this.O1a.PCc(a).toArray()}KCk(a,d){if(!d.length)return this.YWb&&k.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const n=this.aAe(a);if(!n)return this.YWb&&k.ULS.sendTraceTag(42812046,3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const z=this.Oea.Pbg(n),O=this.O1a.PCc(z);for(let ca of d)O.add(ca),
this.K0i(ca.type,a,ca.completion);a=this.O1a.s_g(O);a!==z&&(this.Oea.son(n,a),this.tof());return!0}Zwk(a,d){if(d=this.kFi(d)){const n=this.mc.Sl();n.set(a);this.Oea.rb(d.clone(),this.Oea.pgl(d,n))}}Fkj(a,d,n){if(d.Na(a))return d.J(a);const z=xa.a.create().toString();d.add(a,z);n&&this.YWb&&k.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");return z}kZk(a,d){const n=new hn.a;var z=this.mc.Sl();z.set(a);z.Va(38)&&this.yka.eve(z,O=>{const ca=
this.Oea.ZGc(O);void 0!==ca&&null!==ca&&n.add(ca,O);return!0});for(let O of d)if(a=null,({value:a}=n.Ab(O.key,a)).returnValue)if(O.value===O.key)a=this.kFi(O.key),this.Oea.Xon(a,parseInt(O.key));else{a=this.Oea.Pbg(a);if(!a||""===a){k.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}a=this.O1a.PCc(a);z=new yb.a;for(let ca=0;ca<a.length;ca++){if(a.J(ca).commentId){const Da=Number.parseInvariant(a.J(ca).commentId);d.Na(Da)?
a.J(ca).commentId=d.J(Da).toString():a.J(ca).commentId=null}a.J(ca).recordId=this.Fkj(a.J(ca).recordId,z,!1);-1===a.J(ca).type&&(a.J(ca).undoId=this.Fkj(a.J(ca).undoId,z,!0))}this.xDb(O.value,a.toArray())}}static Ao(){return new RH(la.a.instance.resolve("WordEditor.Tasks.ITaskHistorySerialization"),la.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),la.a.instance.resolve("WordEditor.Tasks.ITaskEditor"),new so.a,()=>Lb.App.oa.za.jc,()=>{la.a.instance.Ca("Common.Interface.IEditNotificationManager").execute(a=>
{a.hse()})},!0)}}Object(t.a)(RH,"TaskActor",null,[315]);var LQ=b(991);class KO{create(){return new LQ.a}}Object(t.a)(KO,"TaskContentNodeFactory",null,[244]);class LO{create(){return new uO.a}}Object(t.a)(LO,"TaskNodeFactory",null,[244]);class tE{constructor(a,d,n,z,O,ca){this.yka=a;this.Nb=d;this.mc=n;this.ypk=z;this.Apk=O;this.zqc=ca}z3k(a,d,n){const z=this.Apk.create(1074135162);z.setValue(Qb.a.taskId,a);z.setValue(Qb.a.JOb,d);z.setValue(Qb.a.yDa,n);return z}aHc(a){const d=this.Nb.Wb(4);d.Sa(a);
this.zqc();return d}oFi(a){return this.yka.idc(a)?a.getValue(Qb.a.taskId):(k.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}ZGc(a){return this.yka.idc(a)?a.hasProperty(Qb.a.JOb)?a.getValue(Qb.a.JOb):null:(k.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}Pbg(a){return this.yka.idc(a)?a.getValue(Qb.a.yDa):(k.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),null)}K4k(a){if(7!==a.type)return k.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const d=
this.aHc(a);try{const n=this.ypk.create(1074135161),z=this.mc.Sl();z.set(a);z.E6(n,38,tE.pCn);return n}finally{d&&d.dispose()}}xDb(a,d,n,z){if(!this.yka.Hsg(a))return k.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const O=this.aHc(a);try{const ca=this.z3k(d,n,z),Da=this.mc.Sl();Da.set(a);Da.E6(ca,1,new E.a(xa.a.Tqa(n.toString()),1));return ca}finally{O&&O.dispose()}}ie(a){if(this.yka.idc(a))if(a.anchor&&a.anchor.Zk){var d=a.anchor.Zk.Dj.node;if(this.yka.Hsg(d)){var n=this.aHc(d);
try{const z=this.mc.Sl();z.set(d);z.rg(a.anchor.node);z.wg()}finally{n&&n.dispose()}}else k.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else k.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else k.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}son(a,d){if(this.yka.idc(a)){var n=this.aHc(a);try{a.setValue(Qb.a.yDa,d)}finally{n&&n.dispose()}}else k.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}Xon(a,d){if(this.yka.idc(a)){var n=
this.aHc(a);try{const z=a.hasProperty(Qb.a.JOb)?a.getValue(Qb.a.JOb):null;void 0===z||null===z||z===d?a.lf(Qb.a.JOb,d):k.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{n&&n.dispose()}}else k.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}pgl(a,d){if(!d.Bo(38)){const n=this.mc.Sl();n.set(a);n.La(71);n.tc(71);a=Bq.a(n.currentNode,a.Zg().Ib,!0);d.Re(a,38)}return d.Va(38)}rb(a,d){if(this.yka.Hsg(d)){var n=this.aHc(d);try{const z=this.mc.Sl();z.set(d);z.Re(a,1)}finally{n&&
n.dispose()}}else k.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static Ao(){return new tE(la.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),new jn.a,new so.a,new KO,new LO,()=>{Rj.App.wn.za.jc.uE.cfa(10)})}}tE.pCn=new E.a(xa.a.qe("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),1);Object(t.a)(tE,"TaskEditor",null,[307]);class SH{constructor(a,d){this.Xy=a;this.ivc=d}idc(a){return!!a&&72===a.type}wgm(a){return!!a&&71===a.Yc}Hsg(a){return!!a&&71===a.type}tIn(a){a.set(this.Xy.value);this.ivc.pQ(a);
return!!a.Va(38)}eve(a,d){if(a&&d)if(this.wgm(a))for(var n=!0,z=a.Va(1);n&&z;)this.idc(z)||k.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",z.type),n=d(z),z=a.Kd(1);else k.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",a.Yc);else k.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static Ao(){return new SH(new Nf.a(()=>Lb.App.oa.za.jc),jm.PageNavigator.instance)}}Object(t.a)(SH,"TaskNavigator",null,[306]);class MO{constructor(){this.Z=null}get name(){return"WordEditor.Tasks"}init(){this.Z.resolve("Box4.IFeatureHelper").tk.continueWith(()=>
{this.Po()})}dispose(){}Hb(a){this.Z=a;a.ha("WordEditor.Tasks.JsonTaskHistorySerialization",()=>new KQ.a).as("WordEditor.Tasks.ITaskHistorySerialization").singleInstance();a.ha("WordEditor.Tasks.TaskNavigator",()=>SH.Ao()).as("WordEditor.Tasks.ITaskNavigator").singleInstance();a.ha("WordEditor.Tasks.TaskEditor",()=>tE.Ao()).as("WordEditor.Tasks.ITaskEditor").singleInstance();a.ha("WordEditor.Tasks.TaskActor",()=>RH.Ao()).as("WordEditor.Tasks.ITaskActor").singleInstance()}Po(){this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(193)}}
Object(t.a)(MO,"TasksPackage",null,[1,2]);class NO{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(t.a)(NO,"TaskPaneGroupAppProps",null,[]);class OO{static QVk(a,d){ic.FocusManager.jA()&&(Eg.a.instance.Gxa(a,d,!1),Pm.a.instance.Gxa(a,d,!1),l.AFrameworkApplication.la.rn.CR(a))}}Object(t.a)(OO,"ReactTaskPaneManagerUtils",
null,[]);class PO{constructor(){this.type=null}}Object(t.a)(PO,"SampleTaskPaneProps",null,[]);var MQ=b(1482);class QO{constructor(){this.entry=null;this.show=!1}}Object(t.a)(QO,"AnimationBatchEntry",null,[]);var NQ=b(1481);class yv{constructor(){this.bJh=[];this.cJh=[];this.kxa={};this.NMa=this.B_a=null;this.Jfe=!1;this.m6=null;this.xde=this.z$d=0;this.GXc=[];this.akf=!!l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.b6a;this.uv=!1}initialize(){this.Jfe=!1;(this.uv=!!l.AFrameworkApplication.la&&
l.AFrameworkApplication.la.eb.T7)&&this.DSf()}FSf(a,d,n,z){d=this.cAe(d);k.ULS.sendTraceTag(4290588,320,50,"Create new task pane.");this.DSf();const O=document.createElement("div");O.id=d;O.className=yv.VRn;O.style.width="0";this.akf||(this.Kuk(n,d,O),this.kxa[d]=a.FSf(d,n,z,O));return O}DSf(){this.Jfe||this.oqn()}Kuk(a,d,n){let z=null,O=null;0===a?(z=this.B_a,O=this.bJh):1===a&&(z=this.NMa,O=this.cJh);if(z){a=!1;for(let ca=0;ca<O.length;ca++)if(!a)O[ca]===d&&(a=!0);else if(O[ca]in this.kxa){this.u6l(z,
n,this.kxa[O[ca]]);return}z.appendChild(n)}}u6l(a,d,n){a.insertBefore(d,n.element)}Cbl(a){a=this.cAe(a);if(a in this.kxa){const d=this.kxa[a];d.element.parentNode.removeChild(d.element);delete this.kxa[a]}}hDj(a){a=this.cAe(a);a in this.kxa&&(a=this.kxa[a])&&!a.isVisible&&(this.yCj(a,!0),this.cXh(a.position,!0,this.E3h(a,!0)),1===a.position&&1<ta.a.count(this.kxa)&&this.Srm())}u_l(a){a=this.cAe(a);a in this.kxa&&(a=this.kxa[a])&&a.isVisible&&(this.yCj(a,!1),this.cXh(a.position,!1,this.E3h(a,!1)))}gCc(a){if(this.m6)return this.m6;
const d=document.createElement("div");document.body.appendChild(d);d&&(this.m6=new ZE(d,a));return this.m6}yCj(a,d){a.element&&(a.isVisible=d,this.GXc.push(Object.assign(new QO,{entry:a,show:d})));0===a.position?this.z$d+=d?1:-1:this.xde+=d?1:-1;1===this.GXc.length&&window.setTimeout(Object(m.a)(this,this.mzn,"startPaneAnimation"),0);this.uv&&a.element&&a.element.parentNode&&(0===a.position&&!this.z$d||1===a.position&&!this.xde?(a.element.parentNode.style.minHeight="0px",a.element.parentNode.style.height=
"0px",a.element.parentNode.style.overflow="hidden"):(a.element.parentNode.style.minHeight="",a.element.parentNode.style.height="",a.element.parentNode.style.overflow=""))}mzn(){this.K$i();var a=sg.where(sg.asEnumerable(this.GXc),O=>0===O.entry.position),d=sg.where(a,O=>!O.show);if(sg.any(d)&&sg.Ct(d)!==sg.Ct(a)){for(var n of d)n.entry.element.style.width="0";a=sg.where(a,O=>O.show)}d=sg.where(sg.asEnumerable(this.GXc),O=>1===O.entry.position);n=sg.where(d,O=>!O.show);if(sg.any(n)&&sg.Ct(n)!==sg.Ct(d)){for(var z of n)z.entry.element.style.width=
"0";d=sg.where(d,O=>O.show)}for(let O of sg.concat(a,d))a=O.entry,jp.WacAirSpace.$I(a.element,xm.a.yZe),z=new NQ.a(a.element),O.show?z.jje(0,a.width):z.jje(a.width,0),jp.WacAirSpace.animate(z,null,null);this.GXc.length=0}K$i(){}E3h(a,d){let n=a.width;a=0===a.position?this.z$d:this.xde;if(d&&1===a||!d&&!a)n+=1;return n}oqn(){this.Jfe||(this.B_a||(this.B_a=document.createElement("div"),this.B_a.id=yv.TRn,this.B_a.className=yv.rSj,Sys.UI.DomElement.addCssClass(this.B_a,"alignLeft"),l.AFrameworkApplication.la&&
l.AFrameworkApplication.la.eb.iV&&Sys.UI.DomElement.addCssClass(this.B_a,"FlexBoxLayout"),this.akf&&Sys.UI.DomElement.addCssClass(this.B_a,yv.nSj),this.mVh(0,this.B_a)),this.NMa||(this.NMa=document.createElement("div"),this.NMa.id=yv.URn,this.NMa.className=yv.rSj,Sys.UI.DomElement.addCssClass(this.NMa,"alignRight"),this.NMa.setAttribute(pd.a.Xu,pd.a.Rm),l.AFrameworkApplication.la&&l.AFrameworkApplication.la.eb.iV&&Sys.UI.DomElement.addCssClass(this.NMa,"FlexBoxLayout"),this.akf&&Sys.UI.DomElement.addCssClass(this.NMa,
yv.nSj),this.mVh(1,this.NMa)),this.fbj(this.B_a,this.NMa),this.Jfe=!0)}fbj(){}NQa(a,d){Array.add(1===a?this.cJh:this.bJh,d)}cAe(a){return a+"-Entry"}Srm(){let a=0;for(const d of ta.a.NF(this.kxa)){const n=Object(qa.a)(924,this.kxa[d]);n&&n.isVisible&&1===n.position&&a++}2===a?k.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<a&&k.ULS.sendTraceTag(595179605,320,50,a+" simultaneous panes open")}}yv.TRn="WACTaskPaneContainerLeft";yv.URn="WACTaskPaneContainerRight";yv.rSj="WACTaskPaneContainer";
yv.VRn="WACTaskPaneEntry";yv.nSj="WACReactTaskPaneContainer";Object(t.a)(yv,"BaseTaskPaneManager",null,[925]);class TH extends yv{constructor(a,d){super();this.m8c=this.l8c=this.czf=this.bzf=0;this.ga=a;this.BAh=d}mVh(a,d){const n=Lb.App.oa.Ow;n.parentNode&&(a?1===a&&(this.uv?((a=Lb.App.oa.Di.getRegion(Lb.App.oa.Di.BV.J("FarPane")))&&a.appendChild(d),d.classList.add("regionComposer"),Lb.App.oa.Di.registerBoundingWindowRectsChanged("farPane",(z,O)=>{"DP"===O||3===O?d.classList.add("DL"):d.classList.remove("DL")})):
n.parentNode.insertBefore(d,n.nextSibling)):this.uv?((a=Lb.App.oa.Di.getRegion(Lb.App.oa.Di.BV.J("NearPane")))&&a.appendChild(d),d.classList.add("regionComposer")):n.parentNode.insertBefore(d,n))}cXh(a,d,n){this.uv||(d=d?n:-n,a?this.m8c+=d:this.l8c+=d)}K$i(){if(!this.uv){var a=Lb.App.oa.Ow;jp.WacAirSpace.$I(a,xm.a.yZe);if(this.bzf!==this.l8c){const d=new Jr.a(a);d.aYh(this.bzf,this.l8c,this.BAh);jp.WacAirSpace.animate(d,null,Object(m.a)(this,this.Dqi,"forceInteractiveViewRefreshOutline"));this.bzf=
this.l8c}this.czf!==this.m8c&&(a=new Jr.a(a),a.bYh(this.czf,this.m8c,this.BAh),jp.WacAirSpace.animate(a,null,Object(m.a)(this,this.Dqi,"forceInteractiveViewRefreshOutline")),this.czf=this.m8c)}}Dqi(){Ic.InteractiveViewManager.instance.forEach(a=>{a.ksd()})}}Object(t.a)(TH,"TaskPaneManager",yv,[]);class QF extends TH{constructor(a,d){super(a,d);this.kN=gb.KeyInputManager.$a(xb.a.Nw,0);this.lN=gb.KeyInputManager.$a(xb.a.Nw,4);this.Msf=this.Q7c=null;this.eEh="AccCheckerTaskPane";this.ka=new oc.a;this.isPaneOpen=
!1;this.Q7e=this.uef=null;this.NQa(0,"SampleTaskPane");this.NQa(0,sn.a.SEb);this.NQa(1,sn.a.jFk);this.NQa(1,"CustomTaskPane");this.NQa(1,sn.a.Ukg);this.NQa(1,Ec.AFrame.Zs);this.NQa(1,Ec.AFrame.xAf);this.NQa(1,Ec.AFrame.vAf);this.NQa(1,sn.a.nve);this.NQa(1,sn.a.Hod);this.NQa(1,sn.a.zqd);this.ydk=(this.loh=!!l.AFrameworkApplication.la&&!!l.AFrameworkApplication.la.eb)&&l.AFrameworkApplication.la.eb.LGe;this.Hck=Rj.App.tdc;this.Pck=this.loh&&l.AFrameworkApplication.la.eb.urg;this.initialize();a.Aa(Dc.a.Y5g,
Kb.a.application,QF.Y5g,96)}get aRi(){null==this.Q7e&&(this.Q7e=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",!1):!1);return this.Q7e}get xVe(){if(!Lb.App.oa||!Lb.App.oa.Ow)return null;this.Msf||(this.Msf=new ZE(Lb.App.oa.Ow,ic.FocusManager.instance()));return this.Msf}lb(){}fbj(a,d){const n=lk.a.instance,z=ic.FocusManager.instance(),O=Io.EventHandlerManager.instance,ca=this;xk.UISurfaces.Nv().then(Da=>
{ca.Q7c=ca.gCc(z);let Xa;Da.renderTaskPaneGroups(a,d,(Xa=new NO,Xa.middleContainer=Lb.App.oa.Ow,Xa.onTabStripFocus=()=>{z.Wv(sn.a.UTc)},Xa.onOpen=(zb,Vb)=>{ca.yrg(zb)&&OO.QVk(zb,Vb);O.lyc(Vb,"focus",ca.yDi(zb,z),!0);var Fc=ca.sSi(zb),Yc=Da.selectors.getTabbedTaskPaneCount(Fc?1:2);Fc=Fc?sn.a.G0e:sn.a.UTc;1===Yc&&(n.Ixa(Fc),this.isPaneOpen=!0,this.Yij({isPaneOpen:this.isPaneOpen,g1e:Vb}));Vb=ca.B8f(zb);if(Yc=z.Kc(Vb))Yc.Gib=Fc,ca.Btn(zb)&&(Yc.zq(ca.kN),Yc.zq(ca.lN)),n.BFe(Vb)&&n.gx(Vb);this.aRi&&this.Ete&&
this.Ete.OA(!0)},Xa.onClose=(zb,Vb)=>{ca.yrg(zb);const Fc=ca.sSi(zb),Yc=Fc?sn.a.G0e:sn.a.UTc;Da.selectors.getTabbedTaskPaneCount(Fc?1:2)||(n.gx(Yc),this.isPaneOpen=!1,this.Yij({isPaneOpen:this.isPaneOpen,g1e:Vb}));O.tQc(Vb,"focus",ca.yDi(zb,z),!0);this.aRi&&this.Ete&&this.Ete.OA(!0)},Xa.setFocusCallback=(zb,Vb)=>{ca.yrg(zb)&&Vb&&(zb=z.Kc(ca.B8f(zb)),zb.t7h(),zb.naa(Vb))},Xa.onOverflowMenuOpen=()=>{if(ca.Q7c)ca.Q7c.onMenuOpen()},Xa.onOverflowMenuClose=()=>{if(ca.Q7c)ca.Q7c.onMenuClose()},Xa.onShow=
(zb,Vb)=>{2===Vb&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{z.wf(zb)},0)})},Xa.onHide=(zb,Vb,Fc)=>{Fc&&1!==Vb&&z.wf(z.uI)},Xa.onResizeStart=()=>{if(Lb.App.oa&&(Lb.App.oa.Ow.className=og.AppFrame.YVc,ca.xVe))ca.xVe.onMenuOpen()},Xa.onResizeEnd=()=>{if(Lb.App.oa&&(Qk.a.NGe()||(Lb.App.oa.Ow.className+=" "+Lb.App.oa.Sle),ca.xVe))ca.xVe.onMenuClose()},Xa));this.Wta(sn.a.UTc,z,d,ca);this.Wta(sn.a.G0e,z,a,ca);return null})}Wta(a,d,n,z){const O=d.Kc(a);O.parent=Ec.AFrame.hp;O.uK=!0;Eg.a.instance.Gxa(a,
n,!1);Pm.a.instance.Gxa(a,n,!1);a=new kd.DOMFocusListing(()=>n);a.Ln(3);a.Ln(2);a.Ln(4);a.Ln(1);d.jfa(()=>n,O,a).MS=!0;O.zq(z.kN);O.zq(z.lN)}B8f(a){return a===this.eEh?sn.a.ISh:a}yDi(a,d){return()=>{d.Wv(this.B8f(a))}}Btn(a){return a===this.eEh?!1:!0}oam(a){return a===sn.a.SEb}yrg(a){return this.oam(a)||a===sn.a.ISh||0<=a.indexOf("AppForOfficePanel")||a===sn.a.nve||a===sn.a.Ukg&&this.ydk||a===sn.a.Hod&&this.Hck||a===sn.a.zqd&&this.Pck||a===MQ.a.o8b?!0:!1}sSi(a){return a===sn.a.SEb||"SampleTaskPane"===
a}static CQl(){return new QF(l.AFrameworkApplication.pa,l.AFrameworkApplication.isRtl)}static Y5g(a,d,n,z,O){if(1===n)return 32;xk.UISurfaces.Nv().then(ca=>{ca.showTaskPane(O,Object.assign(new yk.a,{title:"Sample Task Pane",width:320,location:2,contentProps:Object.assign(new PO,{type:"SampleTaskPaneProps"})}));return null});return 32}hhb(a){this.ka.addHandler("onPaneToggle",a)}MQd(a){this.ka.removeHandler("onPaneToggle",a)}Yij(a){this.ka.raiseEvent("onPaneToggle",a)}get Ete(){this.uef||(this.uef=
la.a.instance.sa("WordEditor.Actors.ExternalContentFloatieEventManager"));return this.uef}}Object(t.a)(QF,"TaskPaneManager",TH,[305]);class RO{constructor(){this.rR=null}get name(){return"WordEditor.TaskPaneManager"}Hb(){}init(){this.rR=QF.CQl();this.rR.lb();Lb.App.oa.L9a=this.rR}dispose(){}}Object(t.a)(RO,"PackageManager",null,[1,2]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");
Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4CS");Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");
Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");
Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");
Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");Type.registerNamespace("Wonca.UI");Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");Type.registerNamespace("WordEditor.Sidetrack");Type.registerNamespace("WordEditor.ContextualSearch");
Type.registerNamespace("WordEditor.CritiqueCounts");Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");
Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");Type.registerNamespace("WordEditor.TableStyle");
Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");J.main();Type.registerNamespace("Common.App.WopiIdentity");da.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Eb.main();Type.registerNamespace("WordEditor.Comments");
Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");pH.main();xH.main();yH.main();M.a.instance.Sb(new RO);M.a.instance.Sb(new MO);M.a.instance.Sb(new IO);M.a.instance.Sb(new PF);bc.main();ab.main();dc.main();mH.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");xd.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");
Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");Je.main();Type.registerNamespace("Common.App.WildFire");Oa.main();Type.registerNamespace("Common.App.BrowserInfoLogger");Xe.main();Type.registerNamespace("Common.App.HostNotification");pf.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");id.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");Type.registerNamespace("Common.App.LivePersonaUtils");
li.main();Type.registerNamespace("CNT");ui.main();Type.registerNamespace("Common.App.NewAndOpen.Core");M.a.instance.Sb(new Be);Type.registerNamespace("Common.App.NewAndOpen.UX");M.a.instance.Sb(new Kj);Type.registerNamespace("Common.App.OneDriveFilePickerApi");uk.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");tn.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SessionExpiration");
Type.registerNamespace("Common.App.SessionExpiration");yi.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");ub.main();Type.registerNamespace("CADWLTR");Cc.main();Type.registerNamespace("Common.App.DirectPrint");M.a.instance.Sb(new di);Type.registerNamespace("Common.App.SearchOAuthManager");wi.main();co.main();oh.main();Pk.main();Ck.main();xj.main();Qh.main();M.a.instance.Sb(new zd);ie.main();Gi.main();pc.main();M.a.instance.Sb(new Wm);Type.registerNamespace("Common.App.SaveStatus");
M.a.instance.Sb(new eo);Type.registerNamespace("Common.App.EventsCacheManager");Fn.main();Type.registerNamespace("CUIB");ms.main();Type.registerNamespace("CommandUI.TaskPane");try{M.a.instance.Sb(new xq(Lb.App.oa.za))}catch(a){k.ULS.shipAssertTag(575930383,3016,!1,a.message)}pp.main();Type.registerNamespace("Common.App.Insights");Zo;M.a.instance.Sb(new hr);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.CommentsSmartReply");
Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");Tk("Begin");M.a.instance.Sb(new ap);try{M.a.instance.Sb(new Et(Bi.a.get_instance(),Lb.App.oa.za,Lb.App.oa.eb))}catch(a){k.ULS.shipAssertTag(575930384,3016,!1,a.message)}Ib.main();M.a.instance.Sb(new ge);zq.main();kr.main();Xt.main();Gu.main();Yt.main();Cv.main();ux.main();mu.main();M.a.instance.Sb(new jy);Jz.main();AA.main();zx.main();Kz.main();oH.main();M.a.instance.Sb(new Ax);M.a.instance.Sb(new IA);
Gw.main();qu.main();tu.main();M.a.instance.Sb(new Sz);M.a.instance.Sb(new Zy);Wz;fg.main();qp.main();Px.main();nA.main();uE;M.a.instance.Sb(new rz);M.a.instance.Sb(new Bu);qC.main();qA.main();WF.main();M.a.instance.Sb(new bI);M.a.instance.Sb(new oI);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=cv;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");
dG.main();fG.main();gG.main();dP;DG.main();DP;window.MSOJS=ZA;aH.main();dH.main();M.a.instance.Sb(new RM);M.a.instance.Sb(new TM);(()=>Object(ov.__awaiter)(void 0,void 0,void 0,function*(){l.AFrameworkApplication.K.ea("WPMPackageIsEnabled")&&(yield b.e(14).then(b.bind(null,1799)).then(a=>{a.initializeOnDemandPackage()}))}))()},645:function(C,L,b){Object.defineProperty(L,"__esModule",{value:!0});var f=b(87);f.__exportStar(b(834),L);f.__exportStar(b(1058),L);f.__exportStar(b(835),L);f.__exportStar(b(1059),
L);f.__exportStar(b(1060),L);f.__exportStar(b(1061),L);C.exports.getChangeGateDictionary||Object.defineProperty(C.exports,"getChangeGateDictionary",{enumerable:!0,get:function(){return C.exports.jui}});C.exports.getFeatureGateDictionary||Object.defineProperty(C.exports,"getFeatureGateDictionary",{enumerable:!0,get:function(){return C.exports.$wi}});C.exports.makeGetTypedFeatureGate||Object.defineProperty(C.exports,"makeGetTypedFeatureGate",{enumerable:!0,get:function(){return C.exports.J2i}});C.exports.makeTypedIsChangeGateEnabled||
Object.defineProperty(C.exports,"makeTypedIsChangeGateEnabled",{enumerable:!0,get:function(){return C.exports.N2i}})},776:function(C,L,b){function f(){return b(776)}function c(fb){for(var db=[],Qa=1;Qa<arguments.length;Qa++)db[Qa-1]=arguments[Qa];return c.eZd.apply(c,Object(Ha.__spreadArray)([fb,void 0],db,!1))}function u(fb){return r(fb)&&"WorkerError"===fb.name&&"object"===typeof fb.info}function r(fb){return null==fb?!1:fb instanceof Error?!0:"string"===typeof fb.name&&"string"===typeof fb.message&&
(null==fb.stack||"string"===typeof fb.stack)}function t(fb){if(r(fb))var db=fb;else{db=Error;var Qa="(non-Error object) ".concat;a:{var wb=typeof fb;switch(wb){case "function":case "symbol":case "undefined":fb="<".concat(wb,">");break a;case "object":fb=JSON.stringify(fb);break a;default:fb="".concat(fb)}}db=db(Qa.call("(non-Error object) ",fb))}return db}function k(fb){var db=fb.name,Qa=u(fb)?fb.wGk:fb.message,wb=fb.stack;u(fb)?(fb=fb.info,fb=Object(Ha.__assign)(Object(Ha.__assign)({},fb),{error:fb.error?
k(fb.error):void 0})):fb=void 0;return{name:db,message:Qa,stack:wb,info:fb}}function m(fb){return r(fb)?{Vba:!0,value:k(fb)}:{Vba:!1,value:fb}}function l(fb){if("WorkerError"===fb.name){var db=fb.message;var Qa=fb.info;Qa=Object(Ha.__assign)(Object(Ha.__assign)({},Qa),{error:Qa.error?l(Qa.error):void 0});db=new X(db,Qa)}else(db=W[fb.name])?db=new db(fb.message):(db=Error(fb.message),db.name=fb.name);null!=fb.stack&&(db.stack=fb.stack);return db}function x(fb){return fb.Vba?l(fb.value):fb.value}function w(){return"undefined"!==
typeof Blob&&"undefined"!==typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!==typeof Worker}function G(fb){if(fa)throw new TypeError("setConfig has already been called");fa=fb}function D(){var fb=null!==fa&&void 0!==fa?fa:{};return{createTimeout:fb.createTimeout,createMode:fb.createMode,importScriptUrls:fb.importScriptUrls?Object(Ha.__spreadArray)([],fb.importScriptUrls,!0):void 0,typedWorkersUrl:fb.typedWorkersUrl,typedWorkersName:fb.typedWorkersName,Gig:fb.Gig}}
function H(fb){var db,Qa;return null!==(Qa=null!==(db=null===fb||void 0===fb?void 0:fb.createTimeout)&&void 0!==db?db:null===fa||void 0===fa?void 0:fa.createTimeout)&&void 0!==Qa?Qa:3E5}function M(fb){var db,Qa;fb=null!==(Qa=null!==(db=null===fb||void 0===fb?void 0:fb.createMode)&&void 0!==db?db:null===fa||void 0===fa?void 0:fa.createMode)&&void 0!==Qa?Qa:"Thread";return"ThreadOrLocal"===fb?w()?"Thread":"Local":fb}function J(fb){setTimeout(function(){throw fb;})}function F(){return"undefined"!==typeof self&&
"__typed_workers_thread"in self?self:void 0}function A(fb){var db=F();void 0!==db?(fb={kind:1,error:m(fb)},db.postMessage(fb)):console.warn(fb)}function N(fb){var db;try{(null!==(db=null===fa||void 0===fa?void 0:fa.L6n)&&void 0!==db?db:A)(fb)}catch(Qa){console.warn(fb),J(Qa)}}function B(fb){var db=F();void 0!==db&&db.postMessage({kind:2,stats:fb})}function E(fb){var db;try{(null!==(db=null===fa||void 0===fa?void 0:fa.g6n)&&void 0!==db?db:B)(fb)}catch(Qa){J(Qa)}}function P(fb,db){return fb.then(function(Qa){db();
return Qa},function(Qa){db();return Promise.reject(Qa)})}function T(fb,db,Qa){if(1073741824<fb)return Qa;var wb=setTimeout(db,Math.max(0,fb));return{resolve:function(ib){clearTimeout(wb);Qa.resolve(ib)},reject:function(ib){clearTimeout(wb);Qa.reject(ib)}}}function V(){var fb=Object.create(null);fb.key=void 0;delete fb.key;return fb}function I(){try{return"function"===typeof Proxy&&!0===(new Proxy({},{get:function(){return!0}})).k}catch(fb){return!1}}function R(fb,db){var Qa=V(),wb=Aa("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?
function(ib,Ta){var jb;return"then"===Ta?void 0:null!==(jb=ib[Ta])&&void 0!==jb?jb:ib[Ta]=fb(Ta)}:function(ib,Ta){var jb;return null!==(jb=ib[Ta])&&void 0!==jb?jb:ib[Ta]=fb(Ta)};if(!db)return new Proxy(Qa,{get:wb});db.forEach(function(ib){return wb(Qa,ib)});return Qa}function ba(fb){throw fb;}function ha(){return{status:"Pending",start:Pa()}}function na(fb,db,Qa){"Pending"===fb.status&&(fb.status=db,fb.end=Math.max(fb.start,null!==Qa&&void 0!==Qa?Qa:Pa()))}function da(fb,db){function Qa(wb){na(fb,
u(wb)&&"Timeout"===wb.info.M6?"Timeout":"Error");throw wb;}try{return db().then(function(wb){var ib;return null!==(ib=na(fb,"Success"))&&void 0!==ib?ib:wb},Qa)}catch(wb){Qa(wb)}}function ia(fb,db,Qa){var wb,ib,Ta,jb=null!==(wb=null===fb||void 0===fb?void 0:fb.start)&&void 0!==wb?wb:Infinity;wb=jb<db?db:jb>Qa?Qa:jb;jb=null!==(ib=null===fb||void 0===fb?void 0:fb.end)&&void 0!==ib?ib:Infinity;Qa=jb<db?db:jb>Qa?Qa:jb;return{status:null!==(Ta=null===fb||void 0===fb?void 0:fb.status)&&void 0!==Ta?Ta:"Pending",
start:Math.round(1E3*(wb-db))/1E3,end:Math.round(1E3*(Qa-db))/1E3,duration:Math.round(1E3*(Qa-wb))/1E3}}function ma(fb,db,Qa){Qa="def"in Qa?Qa:c(Qa);var wb=Qa.def,ib=Qa.args;return"function"!==typeof wb?Promise.reject(new X("Loading an InsideScript to create a local worker is unimplemented",{M6:"InternalError",oH:{type:"Endpoint",Amc:"Inside",id:fb.options.id}})):Promise.resolve().then(function(){return da(db.Skg=ha(),function(){return wb.apply(void 0,Object(Ha.__spreadArray)([{config:D(),importTypedWorkers:f,
connection:fb}],ib,!1)).then(function(){})})})}function qa(fb,db,Qa,wb,ib){var Ta=new MessageChannel,jb=Ta.port2,$a;return Promise.all([wb({port:Ta.port1,options:fb,createMode:db}),da(Qa.zpe=ha(),function(){return za.zpe({port:jb,options:fb,createMode:db},function(ya){return ib($a=ya)})})]).then(function(){return $a},function(ya){$a?$a.close("Force"):jb.close();return Promise.reject(ya)})}function ka(fb,db,Qa,wb){return qa(fb,"Local",db,function(ib){return ma(ib,db,Qa)},wb)}function va(fb,db,Qa,wb){db.Npe=
ha();try{var ib=new Sa(fb,Qa)}catch(Ta){return na(db.Npe,"Error"),Promise.reject(Ta)}na(db.Npe,"Success");return qa(fb,"Thread",db,function(Ta){return ib.CRf(Ta,db)},wb).then(function(Ta){Ta.nYl()?ib.terminate():Ta.Tgk=ib.terminate.bind(ib);return Ta},function(Ta){ib.terminate();return Promise.reject(Ta)})}function ja(fb,db,Qa){void 0===Qa&&(Qa=function(){});var wb=M(fb),ib="local"in db?"Local"===wb?db.local:db.LDn:db,Ta="Local"===wb?ka:va,jb={id:fb.id,createMode:wb,QSf:ha()};db=da(jb.QSf,function(){return Ta({id:fb.id,
createTimeout:fb.createTimeout,createMode:fb.createMode,importScriptUrls:fb.importScriptUrls,Gig:fb.Gig},jb,ib,Qa)});return P(db,function(){var $a=jb.createMode;var ya=jb.QSf,wa=jb.Skg,Fa=jb.zpe,bb=jb.Npe,Eb=ya.status,hb=ya.start;ya=ya.end;$a="Pending"!==Eb&&void 0!==ya?{id:jb.id,createMode:$a,QSf:{status:Eb,BZn:hb,duration:Math.round(1E3*(ya-hb))/1E3},Npe:"Thread"===$a?ia(bb,hb,ya):void 0,zpe:ia(Fa,hb,ya),Skg:ia(wa,hb,ya)}:void 0;$a&&E($a)})}function Ma(fb,db){if(0===db)importScripts.apply(void 0,
fb);else for(var Qa=0;Qa<fb.length;Qa++)a:{for(var wb=void 0,ib=fb[Qa],Ta=db,jb=0;jb<=Ta;jb+=1)try{wb=importScripts;if(0<jb){var $a=ib,ya=String(jb),wa=$a.indexOf("?");if(0>wa)var Fa="".concat($a,"?").concat("retries","=").concat(ya);else{var bb=$a.slice(0,wa+1),Eb=$a.slice(wa+1).split("&");for($a=0;$a<Eb.length&&("="!==Eb[$a][7]||"retries"!==Eb[$a].slice(0,7));$a+=1);Eb[$a]="".concat("retries","=").concat(ya);Fa=bb+Eb.join("&")}}else Fa=ib;wb(Fa);break a}catch(hb){wb=hb}throw wb;}}b.r(L);var Ha=
b(87),X=function(fb){function db(Qa,wb){var ib=this.constructor,Ta;var jb=fb.call(this,"".concat(Qa,"; info = ").concat(JSON.stringify(Object(Ha.__assign)(Object(Ha.__assign)({},wb),{error:null===(Ta=wb.error)||void 0===Ta?void 0:Ta.message}))))||this;jb.wGk=Qa;jb.info=wb;jb.name="WorkerError";Qa=ib.prototype;Object.getPrototypeOf(jb)!==Qa&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(jb,Qa):jb.__proto__=Qa);return jb}Object(Ha.__extends)(db,fb);return db}(Error),W={Error,EvalError,RangeError,
ReferenceError,SyntaxError,TypeError,URIError},fa;c.eZd=function(fb,db){for(var Qa=[],wb=2;wb<arguments.length;wb++)Qa[wb-2]=arguments[wb];return{def:fb,args:Qa,transferables:null!==db&&void 0!==db?db:[]}};var ra=b(645),Aa=Object(ra.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample","OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]);Object(ra.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0});var Ba,ta=-1,xa=function(){function fb(db,Qa){function wb(){var wa;return null===(wa=
jb.onClose)||void 0===wa?void 0:wa.call(jb)}var ib,Ta,jb=this;this.oH=db;this.port=Qa;this.RBd=!1;this.exports={};this.h_d=V();var $a=(ib={},ib[0]=this.eOe.bind(this),ib[1]=this.onResult.bind(this),ib[2]=function(wa){var Fa;wa=wa.kpl;null===(Fa=jb.jGm)||void 0===Fa?void 0:Fa.call(jb,R(jb.q3k.bind(jb),wa),R(jb.z_k.bind(jb),wa))},ib[3]=wb,ib),ya=(Ta={},Ta[0]=this.QJm.bind(this),Ta[1]=this.Laj.bind(this),Ta[2]=wb,Ta[3]=wb,Ta);this.port.onmessage=function(wa){wa=wa.data;return $a[wa.kind](wa)};this.port.onmessageerror=
function(wa){wa=wa.data;return ya[wa.kind](wa)}}fb.prototype.nkn=function(db){this.exports=db;if(null!==Ba&&void 0!==Ba?Ba:Ba=I())db=void 0;else{for(var Qa=V();null!=db;){for(var wb=0,ib=Object.getOwnPropertyNames(db);wb<ib.length;wb++){var Ta=ib[wb];try{"function"===typeof db[Ta]&&(Qa[Ta]=!0)}catch(jb){}}db=Object.getPrototypeOf(db)}db=Object.getOwnPropertyNames(Qa)}this.port.postMessage({kind:2,kpl:db})};fb.prototype.close=function(){if(!this.RBd){this.RBd=!0;this.port.postMessage({kind:3});this.port.close();
for(var db in this.h_d){var Qa=this.h_d[db],wb=Qa.reject;Qa=Qa.p7;Qa=new X("Importing Endpoint closed while waiting for ".concat(Qa," result"),{M6:"Connection",oH:this.oH,p7:Qa});wb(Qa)}}};fb.prototype.eOe=function(db){var Qa=this,wb=db.zqa,ib=db.p7,Ta=db.args;db=Promise.resolve().then(function(){var jb=Qa.exports[ib];if(jb)return jb.apply(Qa.exports,Ta);throw new X("Exporting Endpoint received a ".concat(0<=wb?"call":"post"," to unknown function ").concat(ib),{M6:"Connection",oH:Qa.oH,zqa:wb,p7:ib});
});0<=wb?db.then(function(jb){return Qa.g_g(wb,ib,!0,jb)},function(jb){return Qa.g_g(wb,ib,!1,jb)}):db.catch(function(jb){jb=t(jb);N(new X("Exporting Endpoint's ".concat(ib," implementation threw or rejected"),{M6:"UnhandledError",oH:Qa.oH,error:jb,zqa:wb,p7:ib}))})};fb.prototype.g_g=function(db,Qa,wb,ib){ib=m(ib);db={kind:1,zqa:db,p7:Qa,Nam:wb,prj:ib};try{this.port.postMessage(db,void 0)}catch(Ta){this.Laj(db,t(Ta))}};fb.prototype.Laj=function(db,Qa){var wb=db.zqa,ib=db.p7;db=db.prj;Qa=new X(Qa?
"Exporting Endpoint failed to send ".concat(ib," result"):"Importing Endpoint failed to deserialize ".concat(ib," result"),{M6:"MessageError",oH:this.oH,error:Qa,zqa:wb,p7:ib});db.Vba?N(Qa):this.g_g(wb,ib,!1,Qa)};fb.prototype.a1e=function(db){var Qa=this.h_d[db];Qa&&delete this.h_d[db];return Qa};fb.prototype.djn=function(db,Qa,wb,ib){var Ta=this;return 1073741824<wb?ib:T(wb,function(){var jb=Ta.a1e(db);jb&&jb.reject(new X("Importing Endpoint's call to ".concat(Qa," timed out"),{M6:"Timeout",oH:Ta.oH,
timeout:wb,zqa:db,p7:Qa}))},ib)};fb.prototype.Ggn=function(db,Qa,wb,ib){var Ta=this;return new Promise(function(jb,$a){var ya=ta+=1,wa={kind:0,zqa:ya,p7:db,args:Qa};Ta.h_d[ya]=Object(Ha.__assign)(Object(Ha.__assign)({},Ta.djn(ya,db,wb,{resolve:jb,reject:$a})),{p7:db});try{Ta.port.postMessage(wa,ib)}catch(Fa){if(jb=Ta.a1e(ya))$a=t(Fa),jb.reject(new X("Importing Endpoint failed to send call to ".concat(db),{M6:"MessageError",oH:Ta.oH,error:$a,zqa:ya,p7:db}))}})};fb.prototype.phn=function(db,Qa,wb,ib){Qa=
{kind:0,zqa:-1,p7:db,args:Qa};try{this.port.postMessage(Qa,ib)}catch(Ta){ib=t(Ta),wb(new X("Importing Endpoint failed to post to ".concat(db),{M6:"MessageError",oH:this.oH,error:ib,zqa:-1,p7:db}))}};fb.prototype.QJm=function(db){var Qa,wb=db.zqa;db=db.p7;db=new X("Exporting Endpoint failed to deserialize ".concat(0<=wb?"call":"post"," to ").concat(db),{M6:"MessageError",oH:this.oH,zqa:wb,p7:db});wb=0<=wb?this.a1e(wb):void 0;(null!==(Qa=null===wb||void 0===wb?void 0:wb.reject)&&void 0!==Qa?Qa:N)(db)};
fb.prototype.onResult=function(db){var Qa=db.zqa,wb=db.p7,ib=db.Nam;db=db.prj;0<=Qa?(Qa=this.a1e(Qa))&&(ib?Qa.resolve:Qa.reject)(x(db)):N(new X("Exporting Endpoint sent a result for a post to ".concat(wb),{M6:"InternalError",oH:this.oH,zqa:Qa,p7:wb}))};fb.prototype.q3k=function(db){function Qa(){for(var ib=[],Ta=0;Ta<arguments.length;Ta++)ib[Ta]=arguments[Ta];return Qa.eZd.apply(Qa,Object(Ha.__spreadArray)([void 0],ib,!1))}var wb=this;Qa.eZd=function(ib){for(var Ta,jb,$a,ya=[],wa=1;wa<arguments.length;wa++)ya[wa-
1]=arguments[wa];wb.RBd||(wa=null!==($a=null!==(Ta=Qa.$$i)&&void 0!==Ta?Ta:null===(jb=wb.UHl)||void 0===jb?void 0:jb.call(wb))&&void 0!==$a?$a:ba,wb.phn(db,ya,wa,ib))};return Qa};fb.prototype.z_k=function(db){function Qa(){for(var ib=[],Ta=0;Ta<arguments.length;Ta++)ib[Ta]=arguments[Ta];return Qa.eZd.apply(Qa,Object(Ha.__spreadArray)([void 0],ib,!1))}var wb=this;Qa.eZd=function(ib){for(var Ta,jb,$a,ya=[],wa=1;wa<arguments.length;wa++)ya[wa-1]=arguments[wa];if(wb.RBd)return Promise.reject(new X("".concat(wb.oH.Amc,
" Endpoint's call.").concat(db," called after close"),{M6:"Connection",oH:wb.oH,p7:db}));wa=null!==($a=null!==(Ta=Qa.cKf)&&void 0!==Ta?Ta:null===(jb=wb.Utl)||void 0===jb?void 0:jb.call(wb))&&void 0!==$a?$a:Infinity;return wb.Ggn(db,ya,wa,ib)};Qa.cKf=void 0;return Qa};return fb}(),za=function(){function fb(db,Qa,wb){function ib(Ta){return function(){throw new X("".concat(db.Amc," Endpoint's ").concat(Ta," referenced before the ").concat("Outside"===db.Amc?"inside":"outside"," Endpoint started"),{M6:"Connection",
oH:db});}}this.cKf=Infinity;this.$$i=ba;this.$7d=db;this._state=Qa;this.createMode=wb;Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:ib("post")},call:{configurable:!0,enumerable:!1,get:ib("call")}})}fb.osh=function(db,Qa,wb){var ib=Qa.port,Ta=Qa.options;Qa=Qa.createMode;var jb={type:"Endpoint",Amc:db,id:null===Ta||void 0===Ta?void 0:Ta.id};try{var $a=new xa(jb,ib);var ya=new fb(jb,$a,Qa)}catch(wa){return Promise.reject(wa)}return(new Promise(function(wa,Fa){var bb;$a.Utl=function(){return ya.cKf};
$a.UHl=function(){return ya.$$i};$a.jGm=function(Pb,bc){Object.defineProperties(ya,{post:{configurable:!0,enumerable:!1,writable:!1,value:Pb},call:{configurable:!0,enumerable:!1,writable:!1,value:bc}});hb.resolve()};$a.onClose=function(){return ya.close("Force")};var Eb=H(Ta),hb=T(Eb,function(){var Pb=new X("".concat(db," Endpoint timed out waiting for the ").concat("Outside"===db?"inside":"outside"," to start"),{M6:"Timeout",oH:jb,timeout:Eb});hb.reject(Pb)},{resolve:wa,reject:Fa});ya.X3d=function(){hb.resolve()};
try{var nb=wb(ya)}catch(Pb){return hb.reject(Pb)}null===(bb=ya._state)||void 0===bb?void 0:bb.nkn(nb)})).then(function(){ya.X3d=void 0;return ya},function(wa){ya.X3d=void 0;ya.close();return Promise.reject(wa)})};fb.prototype.nYl=function(){return void 0===this._state};fb.prototype.close=function(db){var Qa;if(this._state){if(this.X3d)if("Force"===db)this.X3d();else{var wb={M6:"Connection",oH:this.$7d};throw new X("".concat(this.$7d.Amc," Endpoint's close called during creation"),wb);}db=this._state;
this._state=void 0;try{db.close(),null===(wb=this.Tgk)||void 0===wb?void 0:wb.call(this),null===(Qa=this.onClose)||void 0===Qa?void 0:Qa.call(this)}catch(ib){wb={M6:"Connection",oH:this.$7d,error:t(ib)},N(new X("".concat(this.$7d.Amc," Endpoint's close threw an error"),wb))}}};fb.zpe=function(db,Qa){void 0===Qa&&(Qa=function(){});return fb.osh("Outside",db,Qa)};fb.CRf=function(db,Qa){return fb.osh("Inside",db,Qa)};return fb}(),la=-1,Sa=function(){function fb(db,Qa){var wb;try{var ib=void 0;var Ta=
"def"in Qa?Qa:c(Qa),jb=Ta.def,$a=Ta.args,ya=Ta.transferables;if("function"!==typeof jb)var wa=[jb,$a,ya,void 0];else{var Fa="__generatedInsideInit".concat(la+=1);wa=[{scriptUrl:void 0,insideInitName:Fa},$a,ya,"var ".concat(Fa," = ").concat(jb.toString(),";")]}this.script=wa[0];this.args=wa[1];this.transferables=wa[2];ib=wa[3];this.Lke=URL.createObjectURL(new Blob(void 0===ib?['!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return f})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return s})),r.d(t,"__createBinding",(function(){return d})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return _})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return h})),r.d(t,"__asyncGenerator",(function(){return m})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return j})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return E}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var d=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||d(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var G=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&d(t,e,r);return G(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function E(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?null:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t,r=o();return null!==r&&(null===(t=r[e])||void 0===t||t)},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return void 0===t?(0,o.setChangeGateDictionaryGetter)(void 0):(0,o.setChangeGateDictionaryGetter)((function(){var r=t();return null===r?null:n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function S(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);']:
[ib,"\n\n",'!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return f})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return s})),r.d(t,"__createBinding",(function(){return d})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return _})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return h})),r.d(t,"__asyncGenerator",(function(){return m})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return j})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return E}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var d=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||d(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var G=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&d(t,e,r);return G(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function E(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?null:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t,r=o();return null!==r&&(null===(t=r[e])||void 0===t||t)},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return void 0===t?(0,o.setChangeGateDictionaryGetter)(void 0):(0,o.setChangeGateDictionaryGetter)((function(){var r=t();return null===r?null:n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function S(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);'],
{type:"application/javascript"}));Qa={};null!=db.id&&(Qa.name=db.id);this.Jua=new Worker(this.Lke,Qa)}catch(bb){throw null===(wb=this.Jua)||void 0===wb?void 0:wb.terminate(),this.Jrj(),bb;}}fb.prototype.Jrj=function(){void 0!==this.Lke&&(URL.revokeObjectURL(this.Lke),this.Lke=void 0)};fb.prototype.CRf=function(db,Qa){var wb=this,ib=db.port,Ta=db.options,jb={type:"Thread",Amc:"Outside",id:Ta.id},$a=this.Jua;db=new Promise(function(ya,wa){wb.FBc={resolve:ya,reject:wa};ya={config:D(),port:ib,options:Ta,
script:wb.script,args:wb.args,featureGateDictionary:Object(ra.getFeatureGateDictionary)(),W_n:Object(ra.getChangeGateDictionary)()};$a.postMessage(ya,Object(Ha.__spreadArray)([ib],wb.transferables,!0));$a.onerror=function(Fa){Fa.preventDefault();Fa=r(Fa.error)?u(Fa.error)?Fa.error:new X("".concat("worker.onerror"," received an unhandled error"),{M6:"UnhandledError",oH:jb,error:Fa.error}):null==Fa.message?new X("".concat("worker.onerror"," received a non-error (worker script fetch probably failed)"),
{M6:"UnhandledError",oH:jb}):new X("".concat("worker.onerror"," received an unhandled error: ").concat("".concat(Fa.message," at ").concat(Fa.filename,":").concat(Fa.lineno,":").concat(Fa.colno)),{M6:"UnhandledError",oH:jb});wb.FBc?wb.FBc.reject(Fa):N(Fa)};$a.onmessage=function(Fa){var bb,Eb;Fa=Fa.data;switch(Fa.kind){case 0:return Qa.Skg=Fa.dF,void 0===Fa.error?null===(bb=wb.FBc)||void 0===bb?void 0:bb.resolve():null===(Eb=wb.FBc)||void 0===Eb?void 0:Eb.reject(x(Fa.error));case 1:return N(x(Fa.error));
case 2:return E(Fa.stats)}}});return P(db,function(){return void(wb.FBc=void 0)})};fb.prototype.terminate=function(){var db;if(this.Jua){var Qa=this.Jua;this.Jua=void 0;null===(db=this.FBc)||void 0===db?void 0:db.resolve();Qa.terminate();this.Jrj()}};return fb}(),Pa="undefined"!==typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};b.d(L,"WorkerError",function(){return X});b.d(L,"isThreadingSupported",function(){return w});
b.d(L,"setConfig",function(){return G});b.d(L,"dispatchWorkerError",function(){return N});b.d(L,"paramInsideDef",function(){return c});b.d(L,"Endpoint",function(){return za});b.d(L,"createWorker",function(){return ja});b.d(L,"importScriptsWithRetry",function(){return Ma})},834:function(C,L,b){function f(){return"undefined"===typeof __get_feature_gate_dictionary_variable?r:__get_feature_gate_dictionary_variable()}function c(t,k){var m;return null!==(m=f()[t])&&void 0!==m?m:k}Object.defineProperty(L,
"__esModule",{value:!0});L.D0g=L.getIntFeatureGate=L.SAi=L.getBooleanFeatureGate=L.getStringFeatureGate=L.$wi=void 0;var u=b(915),r={};L.$wi=f;L.getStringFeatureGate=c;L.getBooleanFeatureGate=function(t,k){var m;t=null===(m=c(t))||void 0===m?void 0:m.trim().toLowerCase();return"true"===t?!0:"false"===t?!1:k};L.SAi=function(t,k){var m;t=null===(m=c(t))||void 0===m?void 0:m.trim().toLowerCase();if(void 0===t)return k;if("infinity"===t||"+infinity"===t)return Infinity;if("-infinity"===t)return-Infinity;
m=parseFloat(t);return isNaN(m)?k:m};L.getIntFeatureGate=function(t,k){var m;t=null===(m=c(t))||void 0===m?void 0:m.trim();if(void 0===t)return k;m=parseInt(t,10);return isNaN(m)?k:m};L.D0g=function(t){var k=u.globalThis.t1j;u.globalThis.t1j=t;return k}},835:function(C,L,b){function f(){return"undefined"===typeof __get_change_gate_dictionary_variable?null:__get_change_gate_dictionary_variable()}Object.defineProperty(L,"__esModule",{value:!0});L.hXe=L.isChangeGateEnabled=L.jui=void 0;var c=b(915);
L.jui=f;L.isChangeGateEnabled=function(u){var r,t=f();return null===t?!1:null!==(r=t[u])&&void 0!==r?r:!0};L.hXe=function(u){var r=c.globalThis.s1j;c.globalThis.s1j=u;return r}},847:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{constructor(){this.method=this.api=0}}Object(C.a)(f,"Message",null,[])},915:function(C,L,b){Object.defineProperty(L,"__esModule",{value:!0});L.globalThis=void 0;C=b(1055);L.globalThis=C},925:function(C,L,b){function f(N,B=self){B.addEventListener("message",
function T(P){if(P&&P.data){var {id:V,type:I,path:R}=Object.assign({path:[]},P.data),ba=(P.data.Hhd||[]).map(m);try{const na=R.slice(0,-1).reduce((ia,ma)=>ia[ma],N),da=R.reduce((ia,ma)=>ia[ma],N);switch(I){case "GET":var ha=da;break;case "SET":na[R.slice(-1)[0]]=m(P.data.value);ha=!0;break;case "APPLY":ha=da.apply(na,ba);break;case "CONSTRUCT":const ia=new da(...ba);ha=Object.assign(ia,{[w]:!0});break;case "ENDPOINT":const {port1:ma,port2:qa}=new MessageChannel;f(N,qa);ha=t(ma,[ma]);break;case "RELEASE":ha=
void 0;break;default:return}}catch(na){ha={value:na,[H]:0}}Promise.resolve(ha).catch(na=>({value:na,[H]:0})).then(na=>{const [da,ia]=k(na);B.postMessage(Object.assign(Object.assign({},da),{id:V}),ia);"RELEASE"===I&&(B.removeEventListener("message",T),"MessagePort"===B.constructor.name&&B.close())})}});B.start&&B.start()}function c(N){if(N)throw Error("Proxy has been released and is not useable");}function u(N,B=[],E=function(){}){let P=!1;const T=new Proxy(E,{get(V,I){c(P);if(I===D)return()=>l(N,
{type:"RELEASE",path:B.map(R=>R.toString())}).then(()=>{"MessagePort"===N.constructor.name&&N.close();P=!0});if("then"===I){if(0===B.length)return{then:()=>T};V=l(N,{type:"GET",path:B.map(R=>R.toString())}).then(m);return V.then.bind(V)}return u(N,[...B,I])},set(V,I,R){c(P);const [ba,ha]=k(R);return l(N,{type:"SET",path:[...B,I].map(na=>na.toString()),value:ba},ha).then(m)},apply(V,I,R){c(P);V=B[B.length-1];if(V===G)return l(N,{type:"ENDPOINT"}).then(m);if("bind"===V)return u(N,B.slice(0,-1));const [ba,
ha]=r(R);return l(N,{type:"APPLY",path:B.map(na=>na.toString()),Hhd:ba},ha).then(m)},construct(V,I){c(P);const [R,ba]=r(I);return l(N,{type:"CONSTRUCT",path:B.map(ha=>ha.toString()),Hhd:R},ba).then(m)}});return T}function r(N){N=N.map(k);return[N.map(B=>B[0]),Array.prototype.concat.apply([],N.map(B=>B[1]))]}function t(N,B){F.set(N,B);return N}function k(N){for(const [B,E]of J)if(E.Ijd(N)){const [P,T]=E.serialize(N);return[{type:"HANDLER",name:B,value:P},T]}return[{type:"RAW",value:N},F.get(N)||[]]}
function m(N){switch(N.type){case "HANDLER":return J.get(N.name).deserialize(N.value);case "RAW":return N.value}}function l(N,B,E){return new Promise(P=>{const T=x();N.addEventListener("message",function R(I){I.data&&I.data.id&&I.data.id===T&&(N.removeEventListener("message",R),P(I.data))});N.start&&N.start();N.postMessage(Object.assign({id:T},B),E)})}function x(){return Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}C=b(0);const w=Symbol("Comlink.proxy"),
G=Symbol("Comlink.endpoint"),D=Symbol("Comlink.releaseProxy"),H=Symbol("Comlink.thrown"),M=N=>"object"===typeof N&&null!==N||"function"===typeof N,J=new Map([["proxy",{Ijd:N=>M(N)&&N[w],serialize(N){const {port1:B,port2:E}=new MessageChannel;f(N,B);return[E,[E]]},deserialize(N){N.start();return u(N,[],void 0)}}],["throw",{Ijd:N=>M(N)&&H in N,serialize({value:N}){return[N instanceof Error?{Vba:!0,value:{message:N.message,name:N.name,stack:N.stack}}:{Vba:!1,value:N},[]]},deserialize(N){if(N.Vba)throw Object.assign(Error(N.value.message),
N.value);throw N.value;}}]]),F=new WeakMap;b.d(L,"a",function(){return A});class A{static $ih(N){var B=self;A.e1c[N.name]=N;f(A.e1c,B)}static gnh(N){A.TEa=N;A.Lzf=u(N,[],void 0)}static get Endpoint(){return A.TEa}static get inh(){return A.Lzf}}A.e1c={};Object(C.a)(A,"WorkerUtils",null,[])},936:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{}Object(C.a)(f,"WaterlineOverrideSettings",null,[])},937:function(C,L,b){function f(x){return{scriptUrl:x,insideInitName:"window.UlsWorkerService.ulsWorkerInsideInit"}}
b.r(L);b.d(L,"UlsWorkerService",function(){return m});b.d(L,"ulsWorkerInsideInit",function(){return l});b.d(L,"ulsWorkerInsideScript",function(){return f});C=b(0);var c=b(776),u=b(886),r=b(23),t=b(2),k=b(784);class m{constructor(x,w,G,D,H){this.Oqk=new u.a(x,w,G,D,H)}kH(x){this.Oqk.kH(x)}}Object(C.a)(m,"UlsWorkerService",null,[]);const l=({config:x,connection:w})=>{"Thread"===w.createMode&&c.setConfig(x);x=r.a.instance.sa("Common.IRefreshableAppSettings");const G=new m(k.a.MDb,!0,t.AFrameworkApplication.Gd,
null!==x&&void 0!==x?x:t.AFrameworkApplication.K,x);return c.Endpoint.CRf(w,()=>G)}},938:function(C,L,b){C=b(0);var f=b(466),c=b(497),u=b(626),r=b(228);class t extends r.a{constructor(){super();this.LowWaterline=this.HighWaterline=this.FileId=null}Jk(){return 97}static JR(G,D,H){const M=new t;M.FileId=G;M.HighWaterline=D;M.LowWaterline=H;return M}}Object(C.a)(t,"GetActivitiesRequest",r.a,[]);class k extends r.a{constructor(G,D,H){super();this.Settings=this.Waterline=this.FileId=null;this.FileId=G;
this.Waterline=D;this.Settings=H}Jk(){return 107}static JR(G,D,H){return new k(G,D,H)}}Object(C.a)(k,"GetRelevantActivitiesRequest",r.a,[]);class m extends r.a{constructor(G,D){super();this.WaterlineOverrideSettings=this.FileId=null;this.FileId=G;this.WaterlineOverrideSettings=D}Jk(){return 96}static JR(G,D){return new m(G,D)}}Object(C.a)(m,"GetWywaActivitiesRequest",r.a,[]);class l{}Object(C.a)(l,"RelevantActivitiesSettings",null,[]);class x extends r.a{constructor(){super();this.FileId=null}Jk(){return 109}static JR(G){const D=
new x;D.FileId=G;return D}}Object(C.a)(x,"UpdateWaterlineRequest",r.a,[]);b.d(L,"a",function(){return w});class w{constructor(G,D,H,M,J){this.aof=G;this.hfb=D;this.Fad=H;this.Yua=M;this.N$e=J}requestWYWAActivities(G){G=m.JR(this.hfb(),G);return f.a.then(this.x_(G,"wywa"),D=>D)}requestActivities(G,D){G=t.JR(this.hfb(),G,D);return f.a.then(this.x_(G,"activities"),H=>H)}tqj(){const G=x.JR(this.hfb());return f.a.then(this.x_(G,"waterline"),D=>D)}requestRelevantActivities(G,D){D=Object.assign(new l,{FirstDocumentOpen:D,
MockDataEnabled:!1});G=k.JR(this.hfb(),G,D);return f.a.then(this.x_(G,"relevant"),H=>H)}requestActivityFeed(){return f.a.ZYa(this.N$e,G=>G.getActivityFeed(null))}x_(G,D){const H={"Content-Type":"application/json; charset=utf-8"};return f.a.then(f.a.ZYa(this.aof,M=>M.Zx(this.Fad,H,c.a.koe(G,this.Yua),D)),M=>{if(!(M&&M.args&&M.args.data&&M.args.data.Rd))return null;let J;({group:J}=u.a.b9(M.args.data.Rd,J));return J&&J.Responses&&J.Responses.length?J.Responses[0]:null})}}Object(C.a)(w,"SharedActivityRepository",
null,[])}}]);

//# sourceMappingURL=https://wordwebclientbuilds.blob.core.windows.net/ooui/c5f763da10f22c3478db857ec7ab2f59faeda6ad/WordEditorDS.box4.dll1.js.map