/*! For license information please see microsoft.office.smartlookup.host.runtime.js.LICENSE.txt */
!function(){var e={8442:function(e,t,n){"use strict";var r;n(2981),n(6858),n(5098),n(2026),n(4836),n(1875),n(270),n(8127),n(7134),n(222),n(7446),n(1871),n(284),n(110),n(3289),n(8855),n(5991),n(8689),n(3373),n(1881),function(e){e.Wac="Wac",e.DesktopBrowserPane="DesktopBrowserPane",e.DesktopAgave="DesktopAgave"}(r||(r={})),n(9544),n(372),n(7807);var i,o=n(8075);n(5754),function(e){e.CopyPicture="CopyPicture",e.DataTypeSearch="DataTypeSearch",e.DocumentPreviewEnabled="DocumentPreviewEnabled",e.FetchDocumentContent="FetchDocumentContent",e.FindInDocCard="FindInDocCard",e.GetShredderTokenAsyncAPI="GetShredderTokenAsyncAPI",e.InDocument="InDocument",e.InsertInlinePicture="InsertInlinePicture",e.InsertBinaryInlinePicture="InsertBinaryInlinePicture",e.InsertOoxml="InsertOoxml",e.InsertHyperlink="InsertHyperlink",e.InsertHtmlText="InsertHtmlText",e.InsertText="InsertText",e.InsertDataType="InsertDataType",e.OpenNavigationPane="OpenNavigationPane",e.OpenPrivacySettings="OpenPrivacySettings",e.ReusePDFContent="ReusePDFContent",e.SuggestedCommands="SuggestedCommands",e.TemplatesProviderEnabled="TemplatesProviderEnabled",e.Tap3SProverEnabled="Tap3SProverEnabled",e.ZeroTermKPE="ZeroTermKPE"}(i||(i={}));var a=function(){function e(){}return e.IsFeatureAvailable=function(t,n,r,i,a,s){var u=function(e){switch(e.toUpperCase()){case"WORD":case"WINWORD":case"WINWORDD":case"WORDWAC":return o.HostApplication.Word;case"POWERPNT":case"PPTWAC":case"POWERPOINT":return o.HostApplication.PowerPoint;case"EXCEL":case"EXCELWAC":return o.HostApplication.Excel;default:return o.HostApplication.Outlook;case"ONENOTE":return o.HostApplication.OneNote;case"VISIO":return o.HostApplication.Visio}}(r);return this.Registry.some((function(r){return r.feature===t&&r.platforms.some((function(e){return e===n}))&&r.applications.some((function(e){return e===u}))&&e.IsVersionWithinRange(i,r.minVersion,r.maxVersion,a)&&(!s||e.IsFeatureFGsEnabled(r.featureFGs,s))}))},e.IsFeatureFGsEnabled=function(e,t){if(!t||!e||0===e.length)return!0;for(var n=0;n<e.length;n++)if(!0!==t[e[n]])return!1;return!0},e.IsVersionWithinRange=function(t,n,r,i){if(void 0===i&&(i=!0),!t&&i)return!0;if(!t&&!i)return!1;t=t.replace(/[()]/g,"");var o=n?e.CompareAppVersions(n,t)<=0:e.CompareAppVersions("16.0.12320.10000",t)<=0,a=!r||e.CompareAppVersions(t,r)<=0;return o&&a},e.CompareAppVersions=function(e,t){if(e&&t&&0!==e.length&&0!==t.length){var n=e.split(".").map((function(e){return parseInt(e)})),r=t.split(".").map((function(e){return parseInt(e)}));if(!(n.length<3||r.length<3||n.some((function(e){return isNaN(e)}))||r.some((function(e){return isNaN(e)})))){for(var i=0;i<Math.min(n.length,r.length);i++)if(n[i]!==r[i])return n[i]<r[i]?-1:n[i]>r[i]?1:0;return 0}}},e}();a.Registry=[{feature:i.CopyPicture,platforms:[o.Platform.Win32],applications:[o.HostApplication.Word,o.HostApplication.PowerPoint,o.HostApplication.Excel,o.HostApplication.Outlook,o.HostApplication.OneNote,o.HostApplication.Visio]},{feature:i.FetchDocumentContent,platforms:[o.Platform.OfficeOnline],applications:[o.HostApplication.Word]},{feature:i.InsertInlinePicture,platforms:[o.Platform.OfficeOnline],applications:[o.HostApplication.Word,o.HostApplication.PowerPoint]},{feature:i.InsertBinaryInlinePicture,platforms:[o.Platform.OfficeOnline],applications:[o.HostApplication.Word]},{feature:i.InsertOoxml,platforms:[o.Platform.Win32],applications:[o.HostApplication.Word,o.HostApplication.Outlook]},{feature:i.InsertOoxml,platforms:[o.Platform.OfficeOnline],applications:[o.HostApplication.Word]},{feature:i.InsertHyperlink,platforms:[o.Platform.Win32],applications:[o.HostApplication.PowerPoint]},{feature:i.InsertHyperlink,platforms:[o.Platform.Win32],applications:[o.HostApplication.Excel],minVersion:"16.0.14813.10000"},{feature:i.InsertHtmlText,platforms:[o.Platform.Win32],applications:[o.HostApplication.Word,o.HostApplication.Outlook]},{feature:i.InsertHtmlText,platforms:[o.Platform.OfficeOnline],applications:[o.HostApplication.Word,o.HostApplication.PowerPoint]},{feature:i.InsertText,platforms:[o.Platform.Win32],applications:[o.HostApplication.PowerPoint,o.HostApplication.Excel],minVersion:"16.0.13426.10000"},{feature:i.InsertDataType,platforms:[o.Platform.Win32],applications:[o.HostApplication.Excel],minVersion:"16.0.13803.10000"},{feature:i.OpenPrivacySettings,platforms:[o.Platform.Win32],applications:[o.HostApplication.Word,o.HostApplication.PowerPoint,o.HostApplication.Excel,o.HostApplication.Outlook]},{feature:i.OpenPrivacySettings,platforms:[o.Platform.OfficeOnline],applications:[o.HostApplication.Word,o.HostApplication.PowerPoint]},{feature:i.ZeroTermKPE,platforms:[o.Platform.Win32,o.Platform.OfficeOnline],applications:[o.HostApplication.Word]},{feature:i.DocumentPreviewEnabled,platforms:[o.Platform.Win32],applications:[o.HostApplication.Word,o.HostApplication.PowerPoint,o.HostApplication.Excel,o.HostApplication.Outlook],minVersion:"16.0.11601.0000"},{feature:i.DocumentPreviewEnabled,platforms:[o.Platform.OfficeOnline],applications:[o.HostApplication.Word,o.HostApplication.PowerPoint,o.HostApplication.Excel,o.HostApplication.Outlook]},{feature:i.TemplatesProviderEnabled,platforms:[o.Platform.Win32],applications:[o.HostApplication.Word]},{feature:i.InDocument,platforms:[o.Platform.Win32],applications:[o.HostApplication.Word],featureFGs:["EnableInDocumentSearch","IsAgave"]},{feature:i.InDocument,platforms:[o.Platform.Win32],applications:[o.HostApplication.Outlook],featureFGs:["EnableInDocumentSearch","EnableInDocumentSearchAlways"]},{feature:i.InDocument,platforms:[o.Platform.OfficeOnline],applications:[o.HostApplication.Word],featureFGs:["EnableInDocumentSearch"]},{feature:i.SuggestedCommands,platforms:[o.Platform.Win32,o.Platform.OfficeOnline],applications:[o.HostApplication.Word]},{feature:i.DataTypeSearch,platforms:[o.Platform.Win32],applications:[o.HostApplication.Excel],minVersion:"16.0.14026.20246"},{feature:i.DataTypeSearch,platforms:[o.Platform.Win32],applications:[o.HostApplication.Word,o.HostApplication.Outlook],minVersion:"16.0.13929.20000"},{feature:i.OpenNavigationPane,platforms:[o.Platform.Win32],applications:[o.HostApplication.PowerPoint,o.HostApplication.Excel],minVersion:"16.0.14729.20002"},{feature:i.OpenNavigationPane,platforms:[o.Platform.Win32],applications:[o.HostApplication.Word,o.HostApplication.Outlook]},{feature:i.Tap3SProverEnabled,platforms:[o.Platform.Win32],applications:[o.HostApplication.Word,o.HostApplication.PowerPoint,o.HostApplication.Excel,o.HostApplication.Outlook,o.HostApplication.OneNote,o.HostApplication.Visio],minVersion:"16.0.14528.0000"},{feature:i.Tap3SProverEnabled,platforms:[o.Platform.OfficeOnline],applications:[o.HostApplication.Word,o.HostApplication.PowerPoint,o.HostApplication.Excel,o.HostApplication.Outlook,o.HostApplication.OneNote,o.HostApplication.Visio]},{feature:i.ReusePDFContent,platforms:[o.Platform.Win32],applications:[o.HostApplication.Word,o.HostApplication.Outlook]},{feature:i.ReusePDFContent,platforms:[o.Platform.OfficeOnline],applications:[o.HostApplication.Word,o.HostApplication.PowerPoint]},{feature:i.FindInDocCard,platforms:[o.Platform.Win32],applications:[o.HostApplication.Outlook]}];var s,u,c,d="gzip",l="deflate";!function(e){e[e.Feedback=0]="Feedback",e[e.Help=1]="Help",e[e.FindReplace=2]="FindReplace",e[e.Find=3]="Find",e[e.Navigation=4]="Navigation"}(s||(s={})),function(e){e[e.ImmersiveReader=0]="ImmersiveReader",e[e.Translate=1]="Translate"}(u||(u={})),function(e){e[e.None=0]="None",e[e.ExcludeRelatedMatches=1]="ExcludeRelatedMatches",e[e.MatchCase=2]="MatchCase",e[e.FindWholeWord=4]="FindWholeWord"}(c||(c={}));var p,h,f,v,g,y=n(4668);function m(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e){e[e.Error=0]="Error",e[e.Warn=1]="Warn",e[e.Info=2]="Info",e[e.Debug=3]="Debug",e[e.Spam=4]="Spam",e[e.Critical=5]="Critical"}(p||(p={})),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(h||(h={})),function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(f||(f={})),function(e){e[e.Seen=0]="Seen",e[e.Tried=1]="Tried",e[e.Kept=2]="Kept"}(v||(v={})),function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Int64=2]="Int64",e[e.Double=3]="Double"}(g||(g={}));var I=function(){function e(e,t){this.transports=[],this.activityTransport=void 0;for(var n,r=m(e);!(n=r()).done;){var i=n.value;this.transports.push(i)}this.activityTransport=t}var t=e.prototype;return t.enableConsoleSink=function(){for(var e,t=m(this.transports);!(e=t()).done;)e.value.enableConsoleSink()},t.addCorrelationID=function(e){for(var t,n=m(this.transports);!(t=n()).done;)t.value.addCorrelationID(e);this.activityTransport&&this.activityTransport.addCorrelationID(e)},t.addTransactionId=function(e){for(var t,n=m(this.transports);!(t=n()).done;)t.value.addTransactionId(e);this.activityTransport&&this.activityTransport.addTransactionId(e)},t.addIsHidden=function(e){for(var t,n=m(this.transports);!(t=n()).done;)t.value.addIsHidden(e);this.activityTransport&&this.activityTransport.addIsHidden(e)},t.addMarket=function(e){for(var t,n=m(this.transports);!(t=n()).done;)t.value.addMarket(e);this.activityTransport&&this.activityTransport.addMarket(e)},t.addEntryPoint=function(e){for(var t,n=m(this.transports);!(t=n()).done;)t.value.addEntryPoint(e);this.activityTransport&&this.activityTransport.addEntryPoint(e)},t.addIsZeroTerm=function(e){for(var t,n=m(this.transports);!(t=n()).done;)t.value.addIsZeroTerm(e);this.activityTransport&&this.activityTransport.addIsZeroTerm(e)},t.log=function(e,t,n,r,i){for(var o,a=m(this.transports);!(o=a()).done;)o.value.logEvent(null,e,t,n,f.Measure,r,void 0,i)},t.info=function(e,t,n){for(var r,i=m(this.transports);!(r=i()).done;)r.value.logEvent(null,e,p.Info,t,f.Measure,n)},t.warn=function(e,t,n){for(var r,i=m(this.transports);!(r=i()).done;)r.value.logEvent(null,e,p.Warn,t,f.Measure,n)},t.error=function(e,t,n){for(var r,i=m(this.transports);!(r=i()).done;)r.value.logEvent("Error",e,p.Error,t,f.CriticalBusinessImpact,null,void 0,n)},t.debug=function(e,t,n){for(var r,i=m(this.transports);!(r=i()).done;)r.value.logEvent(null,e,p.Debug,t,f.Measure,n)},t.logEvent=function(e,t,n,r,i,o,a,s){for(var u,c=m(this.transports);!(u=c()).done;)u.value.logEvent(e,t,n,r,i,o,a,s)},t.createActivity=function(e,t,n,r){return this.activityTransport?this.activityTransport.createActivity(e,t,n,r):null},t.correlationStart=function(e){return e},t.correlationEnd=function(){},t.getCorrelationId=function(){return""},e}(),T=n(4684),R=function(e,t){this.responseMessageType=void 0,this.externalFunction=void 0,this.responseMessageType=e,this.externalFunction=t},b=function(){function e(t){var n=this;this.messengerListener=void 0,this.desktopMessagesMap={},this.onHostSkillEventHandler=function(e){n.onMessage(e)},this.externalWindow=void 0,e.logger=t,this.externalWindow=(0,y.IsTestPage)()&&!function(){try{return window.external.test={},!0}catch(e){return!1}}()?window:window.external,this.setupExternalFunctionMap()}e.getInstance=function(t){return e.instance||(e.instance=new e(t)),null==e.logger&&(e.logger=t),e.instance};var t=e.prototype;return t.executeAction=function(e){var t=this;return new Promise((function(n,r){try{n(t.executeActionSync(e))}catch(i){r(i)}}))},t.executeActionSync=function(t){if(t)try{var n=this.desktopMessagesMap[t.actionType];return this.getResponse(t,n)}catch(r){e.logger.error(558409856,"[DesktopBrowserPaneMessenger.executeAction] Failed to execute action on host, actionType: "+t.actionType,{error:r})}return null},t.onMessage=function(t){if(this.messengerListener)try{if(t){var n,r=JSON.parse(t),i={actionType:r.Type,transactionId:r.TransactionId,data:(null===(n=r.ActionJson)||void 0===n?void 0:n.length)>0?JSON.parse(r.ActionJson):{},timestamp:r.CreateTimeUTC,paneSessionId:r.PaneSessionId};this.messengerListener.actionHandler(i)}}catch(o){e.logger.error(558409857,"[DesktopBrowserPaneMessenger.onMessage] Failed to deserialize the message from Host: ",{error:o})}},t.registerMessengerListener=function(e,t){var n=this;return new Promise((function(r,i){return n.messengerListener=e,n.externalWindow&&n.externalWindow.SetMessageCallback&&n.externalWindow.SetMessageCallback(t,n.onHostSkillEventHandler),r()}))},t.unregisterMessengerListener=function(e,t){var n=this;return new Promise((function(t,r){if(n.messengerListener==e)return n.messengerListener=null,t()}))},t.close=function(){},t.getResponse=function(e,t){var n;if(null==e||null==t)return n;var r=t.externalFunction(e);return null!=r&&(n=r),n},t.setupExternalFunctionMap=function(){var e=this;this.desktopMessagesMap[y.ActionType.ApplicationPropertiesRequest]=new R(y.ActionType[y.ActionType.ApplicationProperties],(function(){return e.externalWindow&&e.externalWindow.GetApplicationProperties&&e.externalWindow.GetApplicationProperties()||void 0})),this.desktopMessagesMap[y.ActionType.SelectionRequest]=new R(y.ActionType[y.ActionType.Selection],(function(t){return e.externalWindow&&e.externalWindow.GetSelection&&e.externalWindow.GetSelection()||void 0})),this.desktopMessagesMap[y.ActionType.PageRendered]=new R(y.ActionType[y.ActionType.PageRendered],(function(t){return e.externalWindow&&e.externalWindow.PageRendered&&e.externalWindow.PageRendered()||void 0})),this.desktopMessagesMap[y.ActionType.DismissPane]=new R(y.ActionType[y.ActionType.DismissPane],(function(t){return e.externalWindow&&e.externalWindow.DismissPane&&e.externalWindow.DismissPane()||void 0})),this.desktopMessagesMap[y.ActionType.Telemetry]=new R(y.ActionType[y.ActionType.Telemetry],(function(t){if(null!=t.data)return e.externalWindow&&e.externalWindow.SendTelemetryEvent&&e.externalWindow.SendTelemetryEvent(t.data)||void 0})),this.desktopMessagesMap[y.ActionType.OpenUrlInBrowser]=new R(y.ActionType[y.ActionType.OpenUrlInBrowser],(function(t){if(null!=t.data)return e.externalWindow&&e.externalWindow.LaunchUrl&&e.externalWindow.LaunchUrl(t.data)||void 0})),this.desktopMessagesMap[y.ActionType.InsertDataType]=new R(y.ActionType[y.ActionType.InsertDataType],(function(t){if(null!==t.data)return e.externalWindow&&e.externalWindow.InsertDataType&&e.externalWindow.InsertDataType(t.data)||void 0})),this.desktopMessagesMap[y.ActionType.DisambiguateEntity]=new R(y.ActionType[y.ActionType.DisambiguateEntity],(function(t){if(null!==t.data)return e.externalWindow&&e.externalWindow.DisambiguateEntity&&e.externalWindow.DisambiguateEntity(t.data)||void 0})),this.desktopMessagesMap[y.ActionType.OpenPrivacySettings]=new R(y.ActionType[y.ActionType.OpenPrivacySettings],(function(t){return e.externalWindow&&e.externalWindow.OpenPrivacySettings&&e.externalWindow.OpenPrivacySettings()||void 0})),this.desktopMessagesMap[y.ActionType.InsertHtmlText]=new R(y.ActionType[y.ActionType.InsertHtmlText],(function(t){if(null!=t.data)return e.externalWindow&&e.externalWindow.InsertHtml&&e.externalWindow.InsertHtml(t.data)||void 0})),this.desktopMessagesMap[y.ActionType.InsertText]=new R(y.ActionType[y.ActionType.InsertText],(function(t){if(null!==t.data)return e.externalWindow&&e.externalWindow.InsertText&&e.externalWindow.InsertText(t.data)||void 0})),this.desktopMessagesMap[y.ActionType.InsertOoxml]=new R(y.ActionType[y.ActionType.InsertOoxml],(function(t){if(null!=t.data)return e.externalWindow&&e.externalWindow.InsertOoxml&&e.externalWindow.InsertOoxml(t.data)||void 0})),this.desktopMessagesMap[y.ActionType.InsertImage]=new R(y.ActionType[y.ActionType.InsertImage],(function(t){if(null!=t.data)return e.externalWindow&&e.externalWindow.InsertImage&&e.externalWindow.InsertImage(t.data)||void 0})),this.desktopMessagesMap[y.ActionType.InsertLink]=new R(y.ActionType[y.ActionType.InsertLink],(function(t){if(null!=t.data){var n=t.data;return e.externalWindow&&e.externalWindow.InsertHyperlink&&e.externalWindow.InsertHyperlink(n.url,n.displayName)||void 0}})),this.desktopMessagesMap[y.ActionType.NavigateToPane]=new R(y.ActionType[y.ActionType.NavigateToPane],(function(t){if(t.data&&e.externalWindow){var n=t.data;switch(n.targetPane){case s.Feedback:return e.externalWindow.LaunchFeedback&&e.externalWindow.LaunchFeedback(n.isPosFeedback,n.data)||void 0;case s.Help:return e.externalWindow.LaunchHelp&&e.externalWindow.LaunchHelp(n.assetId)||void 0;case s.Find:case s.FindReplace:return e.externalWindow.LaunchPane&&e.externalWindow.LaunchPane(n.targetPane,n.query)||void 0;case s.Navigation:return e.externalWindow.LaunchPane&&e.externalWindow.LaunchPane(n.targetPane)||void 0;default:return}}})),this.desktopMessagesMap[y.ActionType.SendCopytoClipBoard]=new R(y.ActionType[y.ActionType.SendCopytoClipBoard],(function(t){if(null!=t.data){var n=t.data.html,r=t.data.text;return e.externalWindow&&e.externalWindow.SendCopytoClipBoard&&e.externalWindow.SendCopytoClipBoard(n,r)||void 0}})),this.desktopMessagesMap[y.ActionType.OpenFilesInNativeApp]=new R(y.ActionType[y.ActionType.OpenFilesInNativeApp],(function(t){if(null!=t.data){var n=t.data.path,r=t.data.fileType;return e.externalWindow&&e.externalWindow.OpenFilesInNativeApp&&e.externalWindow.OpenFilesInNativeApp(n,n,r)||void 0}})),this.desktopMessagesMap[y.ActionType.BrowseFiles]=new R(y.ActionType[y.ActionType.BrowseFiles],(function(t){return e.externalWindow&&e.externalWindow.BrowseFiles&&e.externalWindow.BrowseFiles()||void 0})),this.desktopMessagesMap[y.ActionType.InsertFilesContent]=new R(y.ActionType[y.ActionType.InsertFilesContent],(function(t){if(null!=t.data){var n=t.data.json,r=t.data.callback,i=t.transactionId;return e.externalWindow&&e.externalWindow.InsertFilesContent&&e.externalWindow.InsertFilesContent(i,n,r)||void 0}})),this.desktopMessagesMap[y.ActionType.MakeFilesEnterpriseHTTPCall]=new R(y.ActionType[y.ActionType.MakeFilesEnterpriseHTTPCall],(function(t){if(null!=t.data){var n=t.data.json,r=t.data.callback;return e.externalWindow&&e.externalWindow.MakeFilesEnterpriseHTTPCall&&e.externalWindow.MakeFilesEnterpriseHTTPCall(n,r)||void 0}})),this.desktopMessagesMap[y.ActionType.GetFilesFriendlyPath]=new R(y.ActionType[y.ActionType.GetFilesFriendlyPath],(function(t){if(null!=t.data&&null!=t.data.url)return e.externalWindow&&e.externalWindow.GetFilesFriendlyPath&&e.externalWindow.GetFilesFriendlyPath(t.data.url)||void 0})),this.desktopMessagesMap[y.ActionType.GetLocalDocumentManifest]=new R(y.ActionType[y.ActionType.GetLocalDocumentManifest],(function(t){return e.externalWindow&&e.externalWindow.GetLocalDocumentManifest&&e.externalWindow.GetLocalDocumentManifest(t.data.json,t.data.callback)||void 0})),this.desktopMessagesMap[y.ActionType.InsertContentFromLocalDocument]=new R(y.ActionType[y.ActionType.InsertContentFromLocalDocument],(function(t){return e.externalWindow&&e.externalWindow.InsertContentFromLocalDocument&&e.externalWindow.InsertContentFromLocalDocument(t.data.json,t.data.callback)||void 0})),this.desktopMessagesMap[y.ActionType.GetShredderAccessToken]=new R(y.ActionType[y.ActionType.GetShredderAccessToken],(function(t){return e.externalWindow&&e.externalWindow.GetShredderAccessToken&&e.externalWindow.GetShredderAccessToken()||void 0})),this.desktopMessagesMap[y.ActionType.GetShredderAccessTokenAsync]=new R(y.ActionType[y.ActionType.GetShredderAccessTokenAsync],(function(t){if(null!=t.data){var n=t.data.callback,r=t.transactionId;return e.externalWindow&&e.externalWindow.GetShredderAccessTokenAsync&&e.externalWindow.GetShredderAccessTokenAsync(r,n)||void 0}})),this.desktopMessagesMap[y.ActionType.SmartLookupApplicationInterface]=new R(y.ActionType[y.ActionType.SmartLookupApplicationInterface],(function(t){return e.externalWindow&&e.externalWindow.GetSmartLookupApplicationInterface&&e.externalWindow.GetSmartLookupApplicationInterface()||void 0})),this.desktopMessagesMap[y.ActionType.PaneReady]=new R(y.ActionType[y.ActionType.PaneReady],(function(t){var n={Type:t.actionType,PaneId:y.ChannelId[y.ChannelId.SmartLookup],PaneSessionId:t.paneSessionId,TransactionId:t.transactionId,ActionJson:null!=t.data?JSON.stringify(t.data):"",CreateTimeUTC:Date.now()};return e.externalWindow&&e.externalWindow.ExecuteAction&&e.externalWindow.ExecuteAction(JSON.stringify(n),"",n.PaneId)||void 0})),this.desktopMessagesMap[y.ActionType.PaneHydrated]=new R(y.ActionType[y.ActionType.PaneHydrated],(function(t){var n={Type:t.actionType,PaneId:y.ChannelId[y.ChannelId.SmartLookup],PaneSessionId:t.paneSessionId,TransactionId:t.transactionId,ActionJson:null!=t.data?JSON.stringify(t.data):"",CreateTimeUTC:Date.now()};return e.externalWindow&&e.externalWindow.ExecuteAction&&e.externalWindow.ExecuteAction(JSON.stringify(n),"",n.PaneId)||void 0})),this.desktopMessagesMap[y.ActionType.Search]=new R(y.ActionType[y.ActionType.Search],(function(t){if(null!=t.data){var n={Type:t.actionType,PaneId:y.ChannelId[y.ChannelId.SmartLookup],PaneSessionId:t.paneSessionId,TransactionId:t.transactionId,ActionJson:t.data,CreateTimeUTC:Date.now()};return e.externalWindow&&e.externalWindow.ExecuteAction&&e.externalWindow.ExecuteAction(JSON.stringify(n),"",n.PaneId)||void 0}})),this.desktopMessagesMap[y.ActionType.SelectRangeInDocument]=new R(y.ActionType[y.ActionType.SelectRangeInDocument],(function(t){var n;if(null!=t.data)return e.externalWindow&&e.externalWindow.SelectRange&&e.externalWindow.SelectRange(null!==(n=t.data.subdocumentId)&&void 0!==n?n:"",t.data.startParagraphIndex,t.data.startParagraphOffset,t.data.endParagraphIndex,t.data.endParagraphOffset)||void 0})),this.desktopMessagesMap[y.ActionType.GetDocumentRevisionRequest]=new R(y.ActionType[y.ActionType.GetDocumentRevisionRequest],(function(t){var n={Type:t.actionType,PaneId:y.ChannelId[y.ChannelId.SmartLookup],PaneSessionId:t.paneSessionId,TransactionId:t.transactionId,ActionJson:"",CreateTimeUTC:Date.now()};return e.externalWindow&&e.externalWindow.ExecuteAction&&e.externalWindow.ExecuteAction(JSON.stringify(n),"",n.PaneId)||void 0})),this.desktopMessagesMap[y.ActionType.HighlightInDocument]=new R(y.ActionType[y.ActionType.HighlightInDocument],(function(t){var n={Type:t.actionType,PaneId:y.ChannelId[y.ChannelId.SmartLookup],PaneSessionId:t.paneSessionId,TransactionId:t.transactionId,ActionJson:t.data,CreateTimeUTC:Date.now()};return e.externalWindow&&e.externalWindow.ExecuteAction&&e.externalWindow.ExecuteAction(JSON.stringify(n),"",n.PaneId)||void 0})),this.desktopMessagesMap[y.ActionType.GetDocumentSelectionRequest]=new R(y.ActionType[y.ActionType.GetDocumentSelectionRequest],(function(t){var n={Type:t.actionType,PaneId:y.ChannelId[y.ChannelId.SmartLookup],PaneSessionId:t.paneSessionId,TransactionId:t.transactionId,ActionJson:"",CreateTimeUTC:Date.now()};return e.externalWindow&&e.externalWindow.ExecuteAction&&e.externalWindow.ExecuteAction(JSON.stringify(n),"",n.PaneId)||void 0})),this.desktopMessagesMap[y.ActionType.ClearDocumentSelection]=new R(y.ActionType[y.ActionType.ClearDocumentSelection],(function(t){var n={Type:t.actionType,PaneId:y.ChannelId[y.ChannelId.SmartLookup],PaneSessionId:t.paneSessionId,TransactionId:t.transactionId,ActionJson:"",CreateTimeUTC:Date.now()};return e.externalWindow&&e.externalWindow.ExecuteAction&&e.externalWindow.ExecuteAction(JSON.stringify(n),"",n.PaneId)||void 0})),this.desktopMessagesMap[y.ActionType.SearchInDocumentRequestV2]=new R(y.ActionType[y.ActionType.SearchInDocumentRequestV2],(function(t){if(null!==t.data){var n={Type:t.actionType,PaneId:y.ChannelId[y.ChannelId.SmartLookup],PaneSessionId:t.paneSessionId,TransactionId:t.transactionId,ActionJson:t.data,CreateTimeUTC:Date.now()};return e.externalWindow&&e.externalWindow.ExecuteAction&&e.externalWindow.ExecuteAction(JSON.stringify(n),"",n.PaneId)||void 0}}))},e}();b.instance=void 0,b.logger=void 0;var P=n(8470),E=n.n(P),x=(n(1237),function(){function e(){}return e.stringify=function(e){return JSON.stringify(e,(function(e,t){return"symbol"===typeof t?"$$Symbol:"+Symbol.keyFor(t):t}))},e.parse=function(e){return JSON.parse(e,(function(e,t){var n=t&&t.match&&t.match(/^\$\$Symbol:(.*)$/);return n?Symbol.for(n[1]):t}))},e}()),A=function(){function e(t,n,r){this.channelId=n,this.postWindow=void 0,this.messengerListener=void 0,this.pendingActions={},e.logger=t,this.onMessage=this.onMessage.bind(this),window.addEventListener("message",this.onMessage.bind(this)),r==y.HostType.PaneUX&&(this.postWindow=window.parent)}e.getInstance=function(t,n,r){return e.instance||(e.instance=new e(t,n,r)),null==e.logger&&(e.logger=t),e.instance};var t=e.prototype;return t.registerMessengerListener=function(e,t,n){var r=this;return new Promise((function(t){r.messengerListener=e,t()}))},t.executeActionSync=function(t){this.postWindow&&!this.postWindow.closed?(t.channelId=this.channelId,this.postWindow.postMessage(x.stringify(t),"*")):e.logger.warn(561616583,"Sending message to null or closed target window: ",{action:t.actionType})},t.executeAction=function(t,n,r,i){var o=this;void 0===n&&(n=6e4),void 0===i&&(i=p.Error),t.actionId=E()();var a=t.actionType+t.actionId;return this.executeActionSync(t),t.actionType===y.ActionType.Telemetry?Promise.resolve(void 0):new Promise((function(s){o.pendingActions[a]=s,setTimeout((function(){var n=o.pendingActions[a];n&&(delete o.pendingActions[a],e.logger.log(561616584,i,"Wac Action did not receive response!",{action:t.actionType,timeout:6e4})),r&&n(r)}),n)}))},t.onMessage=function(t){var n;try{if((n=t.data)&&"string"===typeof n&&(n=x.parse(n)),t.source!==window&&this.isDescriptorValid(n)){var r=this.pendingActions[n.actionType+n.actionId];if(r)return r(n.data),void delete this.pendingActions[n.actionType+n.actionId];this.messengerListener&&this.messengerListener.isApprovedOrigin(t.origin)&&this.channelId===n.channelId&&(this.messengerListener.shouldUpdateTarget(n)&&this.updateTargetWindow(t.source),this.messengerListener.actionHandler(n))}}catch(h){var i,o,a,s,u,c,d,l,p=Object.assign({actionType:null===(i=n)||void 0===i?void 0:i.actionType,paneSessionId:null===(o=n)||void 0===o?void 0:o.paneSessionId,transactionId:null===(a=n)||void 0===a?void 0:a.transactionId},null!==(s=n)&&void 0!==s&&s.data?Object.assign({messageType:n.data.messageType},n.data.payload?{renderedResultsPresent:!!n.data.payload.renderedResults,renderedResultsHasState:!(null===(u=n.data.payload.renderedResults)||void 0===u||!u.state),renderedResultsHasHtml:!(null===(c=n.data.payload.renderedResults)||void 0===c||!c.html),resultGroups:n.data.payload.results?n.data.payload.results.map((function(e){return e.resultGroupTypeId})):"N/A",renderError:null===(d=n.data.payload.renderedResults)||void 0===d?void 0:d.renderError,errorStack:null===(l=n.data.payload.renderedResults)||void 0===l?void 0:l.errorStack}:null):null);e.logger.error(561616585,"[WebBrowserPaneMessenger.onMessage] Failed to process incoming message from Host: ",Object.assign({error:null===h||void 0===h?void 0:h.message,errorStackTrace:null===h||void 0===h?void 0:h.stack},p))}},t.close=function(){this.updateTargetWindow(null)},t.updateTargetWindow=function(e){this.postWindow=e},t.unregisterMessengerListener=function(e,t){return new Promise((function(e){return e()}))},t.isDescriptorValid=function(e){return!(!e||void 0===e.actionType)},e}();function w(e,t,n,i,o){switch(e){case r.DesktopBrowserPane:return b.getInstance(t);case r.DesktopAgave:return y.AgaveMessenger.getInstance(n,o);case r.Wac:default:return A.getInstance(t,n,i)}}function C(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}A.instance=void 0,A.logger=void 0,n(7505);var k=function(){function e(){}return e.isDocumentIndexUnregistered=function(e){var t;if(null===e||void 0===e||null===(t=e.payload)||void 0===t||!t.results)return!1;var n=e.payload;if(!n||!n.results)return!1;if(n.compressed)return!1;var r=n.results.filter((function(e){return e.resultGroupTypeId==T.ResultGroupType.QNA}));if(r)for(var i,o=C(r);!(i=o()).done;)for(var a,s=C(i.value.results);!(a=s()).done;){var u=a.value;if("Provider.Qna"==u.providerId&&u.payload){var c=u.payload;if(5===c.Type&&!1===c.IsDocIdRegistered)return!0}}return!1},e}(),O=(n(1938),n(4398),n(2152),n(3294),n(1615),n(1157),n(472),n(3083),n(2906),n(6959),n(9293),n(8723),n(8951),n(1737),n(2566),n(6289),n(8131),n(8660),n(9199),n(1378),n(9319),n(2895),n(2336),n(727),n(2112),n(6025),n(9470),{}),M=Uint8Array,F=Uint16Array,_=Uint32Array,L=new M([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),q=new M([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),G=new M([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),W=function(e,t){for(var n=new F(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var i=new _(n[30]);for(r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)i[o]=o-n[r]<<5|r;return[n,i]},N=W(L,2),U=N[0],H=N[1];U[28]=258,H[258]=28;for(var j=W(q,0),B=j[0],Q=j[1],V=new F(32768),J=0;J<32768;++J){var Z=(43690&J)>>>1|(21845&J)<<1;Z=(61680&(Z=(52428&Z)>>>2|(13107&Z)<<2))>>>4|(3855&Z)<<4,V[J]=((65280&Z)>>>8|(255&Z)<<8)>>>1}var z=function(e,t,n){for(var r=e.length,i=0,o=new F(t);i<r;++i)++o[e[i]-1];var a,s=new F(t);for(i=0;i<t;++i)s[i]=s[i-1]+o[i-1]<<1;if(n){a=new F(1<<t);var u=15-t;for(i=0;i<r;++i)if(e[i])for(var c=i<<4|e[i],d=t-e[i],l=s[e[i]-1]++<<d,p=l|(1<<d)-1;l<=p;++l)a[V[l]>>>u]=c}else for(a=new F(r),i=0;i<r;++i)e[i]&&(a[i]=V[s[e[i]-1]++]>>>15-e[i]);return a},K=new M(288);for(J=0;J<144;++J)K[J]=8;for(J=144;J<256;++J)K[J]=9;for(J=256;J<280;++J)K[J]=7;for(J=280;J<288;++J)K[J]=8;var Y=new M(32);for(J=0;J<32;++J)Y[J]=5;var $=z(K,9,0),X=z(K,9,1),ee=z(Y,5,0),te=z(Y,5,1),ne=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},re=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},ie=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},oe=function(e){return(e+7)/8|0},ae=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var r=new(e instanceof F?F:e instanceof _?_:M)(n-t);return r.set(e.subarray(t,n)),r},se=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ue=function(e,t,n){var r=new Error(t||se[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,ue),!n)throw r;return r},ce=function(e,t,n){var r=e.length;if(!r||n&&n.f&&!n.l)return t||new M(0);var i=!t||n,o=!n||n.i;n||(n={}),t||(t=new M(3*r));var a=function(e){var n=t.length;if(e>n){var r=new M(Math.max(2*n,e));r.set(t),t=r}},s=n.f||0,u=n.p||0,c=n.b||0,d=n.l,l=n.d,p=n.m,h=n.n,f=8*r;do{if(!d){s=re(e,u,1);var v=re(e,u+1,3);if(u+=3,!v){var g=e[(A=oe(u)+4)-4]|e[A-3]<<8,y=A+g;if(y>r){o&&ue(0);break}i&&a(c+g),t.set(e.subarray(A,y),c),n.b=c+=g,n.p=u=8*y,n.f=s;continue}if(1==v)d=X,l=te,p=9,h=5;else if(2==v){var m=re(e,u,31)+257,S=re(e,u+10,15)+4,I=m+re(e,u+5,31)+1;u+=14;for(var T=new M(I),R=new M(19),b=0;b<S;++b)R[G[b]]=re(e,u+3*b,7);u+=3*S;var P=ne(R),E=(1<<P)-1,x=z(R,P,1);for(b=0;b<I;){var A,w=x[re(e,u,E)];if(u+=15&w,(A=w>>>4)<16)T[b++]=A;else{var C=0,D=0;for(16==A?(D=3+re(e,u,3),u+=2,C=T[b-1]):17==A?(D=3+re(e,u,7),u+=3):18==A&&(D=11+re(e,u,127),u+=7);D--;)T[b++]=C}}var k=T.subarray(0,m),O=T.subarray(m);p=ne(k),h=ne(O),d=z(k,p,1),l=z(O,h,1)}else ue(1);if(u>f){o&&ue(0);break}}i&&a(c+131072);for(var F=(1<<p)-1,_=(1<<h)-1,W=u;;W=u){var N=(C=d[ie(e,u)&F])>>>4;if((u+=15&C)>f){o&&ue(0);break}if(C||ue(2),N<256)t[c++]=N;else{if(256==N){W=u,d=null;break}var H=N-254;if(N>264){var j=L[b=N-257];H=re(e,u,(1<<j)-1)+U[b],u+=j}var Q=l[ie(e,u)&_],V=Q>>>4;if(Q||ue(3),u+=15&Q,O=B[V],V>3&&(j=q[V],O+=ie(e,u)&(1<<j)-1,u+=j),u>f){o&&ue(0);break}i&&a(c+131072);for(var J=c+H;c<J;c+=4)t[c]=t[c-O],t[c+1]=t[c+1-O],t[c+2]=t[c+2-O],t[c+3]=t[c+3-O];c=J}}n.l=d,n.p=W,n.b=c,n.f=s,d&&(s=1,n.m=p,n.d=l,n.n=h)}while(!s);return c==t.length?t:ae(t,0,c)},de=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>>8},le=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>>8,e[r+2]|=n>>>16},pe=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var i=n.length,o=n.slice();if(!i)return[Se,0];if(1==i){var a=new M(n[0].s+1);return a[n[0].s]=1,[a,1]}n.sort((function(e,t){return e.f-t.f})),n.push({s:-1,f:25001});var s=n[0],u=n[1],c=0,d=1,l=2;for(n[0]={s:-1,f:s.f+u.f,l:s,r:u};d!=i-1;)s=n[n[c].f<n[l].f?c++:l++],u=n[c!=d&&n[c].f<n[l].f?c++:l++],n[d++]={s:-1,f:s.f+u.f,l:s,r:u};var p=o[0].s;for(r=1;r<i;++r)o[r].s>p&&(p=o[r].s);var h=new F(p+1),f=he(n[d-1],h,0);if(f>t){r=0;var v=0,g=f-t,y=1<<g;for(o.sort((function(e,t){return h[t.s]-h[e.s]||e.f-t.f}));r<i;++r){var m=o[r].s;if(!(h[m]>t))break;v+=y-(1<<f-h[m]),h[m]=t}for(v>>>=g;v>0;){var S=o[r].s;h[S]<t?v-=1<<t-h[S]++-1:++r}for(;r>=0&&v;--r){var I=o[r].s;h[I]==t&&(--h[I],++v)}f=t}return[new M(h),f]},he=function(e,t,n){return-1==e.s?Math.max(he(e.l,t,n+1),he(e.r,t,n+1)):t[e.s]=n},fe=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new F(++t),r=0,i=e[0],o=1,a=function(e){n[r++]=e},s=1;s<=t;++s)if(e[s]==i&&s!=t)++o;else{if(!i&&o>2){for(;o>138;o-=138)a(32754);o>2&&(a(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(a(i),--o;o>6;o-=6)a(8304);o>2&&(a(o-3<<5|8208),o=0)}for(;o--;)a(i);o=1,i=e[s]}return[n.subarray(0,r),t]},ve=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},ge=function(e,t,n){var r=n.length,i=oe(t+2);e[i]=255&r,e[i+1]=r>>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var o=0;o<r;++o)e[i+o+4]=n[o];return 8*(i+4+r)},ye=function(e,t,n,r,i,o,a,s,u,c,d){de(t,d++,n),++i[256];for(var l=pe(i,15),p=l[0],h=l[1],f=pe(o,15),v=f[0],g=f[1],y=fe(p),m=y[0],S=y[1],I=fe(v),T=I[0],R=I[1],b=new F(19),P=0;P<m.length;++P)b[31&m[P]]++;for(P=0;P<T.length;++P)b[31&T[P]]++;for(var E=pe(b,7),x=E[0],A=E[1],w=19;w>4&&!x[G[w-1]];--w);var C,D,k,O,M=c+5<<3,_=ve(i,K)+ve(o,Y)+a,W=ve(i,p)+ve(o,v)+a+14+3*w+ve(b,x)+(2*b[16]+3*b[17]+7*b[18]);if(M<=_&&M<=W)return ge(t,d,e.subarray(u,u+c));if(de(t,d,1+(W<_)),d+=2,W<_){C=z(p,h,0),D=p,k=z(v,g,0),O=v;var N=z(x,A,0);for(de(t,d,S-257),de(t,d+5,R-1),de(t,d+10,w-4),d+=14,P=0;P<w;++P)de(t,d+3*P,x[G[P]]);d+=3*w;for(var U=[m,T],H=0;H<2;++H){var j=U[H];for(P=0;P<j.length;++P){var B=31&j[P];de(t,d,N[B]),d+=x[B],B>15&&(de(t,d,j[P]>>>5&127),d+=j[P]>>>12)}}}else C=$,D=K,k=ee,O=Y;for(P=0;P<s;++P)if(r[P]>255){B=r[P]>>>18&31,le(t,d,C[B+257]),d+=D[B+257],B>7&&(de(t,d,r[P]>>>23&31),d+=L[B]);var Q=31&r[P];le(t,d,k[Q]),d+=O[Q],Q>3&&(le(t,d,r[P]>>>5&8191),d+=q[Q])}else le(t,d,C[r[P]]),d+=D[r[P]];return le(t,d,C[256]),d+D[256]},me=new _([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Se=new M(0),Ie=function(e,t,n,r,i,o){var a=e.length,s=new M(r+a+5*(1+Math.ceil(a/7e3))+i),u=s.subarray(r,s.length-i),c=0;if(!t||a<8)for(var d=0;d<=a;d+=65535){var l=d+65535;l<a?c=ge(u,c,e.subarray(d,l)):(u[d]=o,c=ge(u,c,e.subarray(d,a)))}else{for(var p=me[t-1],h=p>>>13,f=8191&p,v=(1<<n)-1,g=new F(32768),y=new F(v+1),m=Math.ceil(n/3),S=2*m,I=function(t){return(e[t]^e[t+1]<<m^e[t+2]<<S)&v},T=new _(25e3),R=new F(288),b=new F(32),P=0,E=0,x=(d=0,0),A=0,w=0;d<a;++d){var C=I(d),D=32767&d,k=y[C];if(g[D]=k,y[C]=D,A<=d){var O=a-d;if((P>7e3||x>24576)&&O>423){c=ye(e,u,0,T,R,b,E,x,w,d-w,c),x=P=E=0,w=d;for(var G=0;G<286;++G)R[G]=0;for(G=0;G<30;++G)b[G]=0}var W=2,N=0,U=f,j=D-k&32767;if(O>2&&C==I(d-j))for(var B=Math.min(h,O)-1,V=Math.min(32767,d),J=Math.min(258,O);j<=V&&--U&&D!=k;){if(e[d+W]==e[d+W-j]){for(var Z=0;Z<J&&e[d+Z]==e[d+Z-j];++Z);if(Z>W){if(W=Z,N=j,Z>B)break;var z=Math.min(j,Z-2),K=0;for(G=0;G<z;++G){var Y=d-j+G+32768&32767,$=Y-g[Y]+32768&32767;$>K&&(K=$,k=Y)}}}j+=(D=k)-(k=g[D])+32768&32767}if(N){T[x++]=268435456|H[W]<<18|Q[N];var X=31&H[W],ee=31&Q[N];E+=L[X]+q[ee],++R[257+X],++b[ee],A=d+W,++P}else T[x++]=e[d],++R[e[d]]}}c=ye(e,u,o,T,R,b,E,x,w,d-w,c),!o&&7&c&&(c=ge(u,c+1,Se))}return ae(s,0,r+oe(c)+i)},Te=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var n=t,r=9;--r;)n=(1&n&&-306674912)^n>>>1;e[t]=n}return e}(),Re=function(){var e=-1;return{p:function(t){for(var n=e,r=0;r<t.length;++r)n=Te[255&n^t[r]]^n>>>8;e=n},d:function(){return~e}}},be=function(e,t,n,r,i){return Ie(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,n,r,!i)},Pe=function(e,t,n){for(var r=e(),i=e.toString(),o=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/ /g,"").split(","),a=0;a<r.length;++a){var s=r[a],u=o[a];if("function"==typeof s){t+=";"+u+"=";var c=s.toString();if(s.prototype)if(-1!=c.indexOf("[native code]")){var d=c.indexOf(" ",8)+1;t+=c.slice(d,c.indexOf("(",d))}else for(var l in t+=c,s.prototype)t+=";"+u+".prototype."+l+"="+s.prototype[l].toString();else t+=c}else n[u]=s}return[t,n]},Ee=[],xe=function(){return[M,F,_,L,q,G,U,B,X,te,V,se,z,ne,re,ie,oe,ae,ue,ce,Ue,ke,Oe]},Ae=function(){return[M,F,_,L,q,G,H,Q,$,K,ee,Y,V,me,Se,z,de,le,pe,he,fe,ve,ge,ye,oe,ae,Ie,be,Ne,ke]},we=function(){return[_e,Ge,Fe,Re,Te]},Ce=function(){return[Le,qe]},De=function(){return[We]},ke=function(e){return postMessage(e,[e.buffer])},Oe=function(e){return e&&e.size&&new M(e.size)},Me=function(e,t,n,r,i,o){var a=function(e,t,n,r){var i;if(!Ee[n]){for(var o="",a={},s=e.length-1,u=0;u<s;++u)o=(i=Pe(e[u],o,a))[0],a=i[1];Ee[n]=Pe(e[s],o,a)}var c=function(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n}({},Ee[n][1]);return function(e,t,n,r,i){var o=new Worker(O[t]||(O[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return o.onmessage=function(e){var t=e.data,n=t.$e$;if(n){var r=new Error(n[0]);r.code=n[1],r.stack=n[2],i(r,null)}else i(null,t)},o.postMessage(n,r),o}(Ee[n][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",n,c,function(e){var t=[];for(var n in e)(e[n]instanceof M||e[n]instanceof F||e[n]instanceof _)&&t.push((e[n]=new e[n].constructor(e[n])).buffer);return t}(c),r)}(n,r,i,(function(e,t){a.terminate(),o(e,t)}));return a.postMessage([e,t],t.consume?[e.buffer]:[]),function(){a.terminate()}},Fe=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},_e=function(e,t){var n=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&Fe(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){e[3]=8;for(var r=0;r<=n.length;++r)e[r+10]=n.charCodeAt(r)}},Le=function(e){31==e[0]&&139==e[1]&&8==e[2]||ue(6,"invalid gzip data");var t=e[3],n=10;4&t&&(n+=e[10]|2+(e[11]<<8));for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(2&t)},qe=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},Ge=function(e){return 10+(e.filename&&e.filename.length+1||0)},We=function(e){(8!=(15&e[0])||e[0]>>>4>7||(e[0]<<8|e[1])%31)&&ue(6,"invalid zlib data"),32&e[1]&&ue(6,"invalid zlib data: preset dictionaries not supported")};function Ne(e,t){return be(e,t||{},0,0)}function Ue(e,t){return ce(e,t)}function He(e,t){t||(t={});var n=Re(),r=e.length;n.p(e);var i=be(e,t,Ge(t),8),o=i.length;return _e(i,t),Fe(i,o-8,n.d()),Fe(i,o-4,r),i}function je(e,t){return ce(e.subarray(Le(e),-8),t||new M(qe(e)))}function Be(e,t){return ce((We(e),e.subarray(2,-4)),t)}function Qe(e,t,n){return n||(n=t,t={}),"function"!=typeof n&&ue(7),31==e[0]&&139==e[1]&&8==e[2]?function(e,t,n){return n||(n=t,t={}),"function"!=typeof n&&ue(7),Me(e,t,[xe,Ce,function(){return[je]}],(function(e){return ke(je(e.data[0]))}),3,n)}(e,t,n):8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31?function(e,t,n){return n||(n=t,t={}),"function"!=typeof n&&ue(7),Me(e,t,[xe],(function(e){return ke(Ue(e.data[0],Oe(e.data[1])))}),1,n)}(e,t,n):function(e,t,n){return n||(n=t,t={}),"function"!=typeof n&&ue(7),Me(e,t,[xe,De,function(){return[Be]}],(function(e){return ke(Be(e.data[0],Oe(e.data[1])))}),5,n)}(e,t,n)}var Ve="undefined"!=typeof TextEncoder&&new TextEncoder,Je="undefined"!=typeof TextDecoder&&new TextDecoder;try{Je.decode(Se,{stream:!0})}catch(Zn){}function Ze(e,t){if(t){for(var n=new M(e.length),r=0;r<e.length;++r)n[r]=e.charCodeAt(r);return n}if(Ve)return Ve.encode(e);var i=e.length,o=new M(e.length+(e.length>>1)),a=0,s=function(e){o[a++]=e};for(r=0;r<i;++r){if(a+5>o.length){var u=new M(a+8+(i-r<<1));u.set(o),o=u}var c=e.charCodeAt(r);c<128||t?s(c):c<2048?(s(192|c>>6),s(128|63&c)):c>55295&&c<57344?(s(240|(c=65536+(1047552&c)|1023&e.charCodeAt(++r))>>18),s(128|c>>12&63),s(128|c>>6&63),s(128|63&c)):(s(224|c>>12),s(128|c>>6&63),s(128|63&c))}return ae(o,0,a)}function ze(e,t){if(t){for(var n="",r=0;r<e.length;r+=16384)n+=String.fromCharCode.apply(null,e.subarray(r,r+16384));return n}if(Je)return Je.decode(e);var i=function(e){for(var t="",n=0;;){var r=e[n++],i=(r>127)+(r>223)+(r>239);if(n+i>e.length)return[t,ae(e,n-1)];i?3==i?(r=((15&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536,t+=String.fromCharCode(55296|r>>10,56320|1023&r)):t+=1&i?String.fromCharCode((31&r)<<6|63&e[n++]):String.fromCharCode((15&r)<<12|(63&e[n++])<<6|63&e[n++]):t+=String.fromCharCode(r)}}(e),o=i[0];return i[1].length&&ue(8),o}function Ke(e,t,n,r){var i=new URL(e);return i.searchParams.append("X-CorrelationId",encodeURI(t)),i.searchParams.append("X-Platform",encodeURI(o.Platform.OfficeOnline)),n&&i.searchParams.append("X-SessionId",encodeURI(n)),r&&i.searchParams.append("X-App",encodeURI(r)),i}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout,n(4049),n(5979);var Ye=function(){function e(e,t,n,r){this.intentServiceUrl=e,this.logger=t,this.onMessageReceived=n,this.onConnectionClosedCallback=r,this.webSocket=void 0,this.requestQueue=void 0,this.webSocketId=void 0,this.contentEncoding=void 0,this.enableWebsocketCustomCompression=void 0,this.pingRequest=null,this.webSocketPingId=null,this.websocketLatency=500,this.sessionId=void 0,this.noRequestPingStopTimeout=216e5,this.lastSearchRequestTime=Date.now(),this.app=void 0,this.lastReceivedMessageTimeStamp=void 0,this.WebSocketEnabled=!0,this.requestQueue=[],this.processRequestQueue=this.processRequestQueue.bind(this),this.initializeCustomCompression=this.initializeCustomCompression.bind(this),this.onConnectionClosed=this.onConnectionClosed.bind(this),this.ResetConnection=this.ResetConnection.bind(this),this.pingServer=this.pingServer.bind(this),setTimeout(this.pingServer,0)}var t=e.prototype;return t.ResetConnection=function(e,t){if(this.requestQueue=[],this.webSocketId=null,this.contentEncoding=void 0,this.webSocket){try{this.webSocket.onmessage=function(){},this.webSocket.onerror=function(){},this.webSocket.onopen=function(){},this.webSocket.close(e,t)}catch(ue){this.logger.warn(557097183,"Unable to close websocket due to error",ue)}this.webSocket=null}},t.ResetQueue=function(e,t){this.requestQueue=[],this.enableWebsocketCustomCompression=e,this.sessionId=null===t||void 0===t?void 0:t.sessionId,this.app=null===t||void 0===t?void 0:t.app,this.lastSearchRequestTime=Date.now()},t.ProcessRequest=function(e){this.webSocketPingId||(this.webSocketPingId=setInterval(this.pingServer,6e4)),e&&(this.requestQueue.push(e),this.ensureConnectionAndProcessRequests(e.transactionId))},t.GetActiveWebsocketId=function(){return this.webSocketId},t.GetWebsocketTimeout=function(){return this.websocketLatency+1e3},t.pingServer=function(){var e=this,t=E()();this.pingRequest={data:{messageType:T.WSMessageType.Ping,correlationId:t,payload:Date.now()},transactionId:t};var n=this.lastReceivedMessageTimeStamp;this.ProcessRequest(this.pingRequest),setTimeout((function(){e.lastReceivedMessageTimeStamp===n&&(e.WebSocketEnabled=!1)}),2500),this.lastSearchRequestTime<Date.now()-this.noRequestPingStopTimeout&&this.stopPingingServer()},t.ensureConnectionAndProcessRequests=function(e){var t,n,r,i,o,a=this;if(void 0===window.WebSocket)return this.logger.logEvent("WebSocketNotSupport",0,p.Error,"",f.Diagnostics),void(this.WebSocketEnabled=!1);if((null===(t=this.webSocket)||void 0===t?void 0:t.readyState)!==WebSocket.CONNECTING)if((null===(n=this.webSocket)||void 0===n?void 0:n.readyState)!==WebSocket.OPEN){var s,u=this.logger.createActivity("CreateWebSocket",f.CriticalBusinessImpact);u.addDataField("TransactionId",e,g.String,h.SystemMetadata),null!==(r=this.requestQueue)&&void 0!==r&&null!==(i=r[0])&&void 0!==i&&null!==(o=i.data)&&void 0!==o&&o.messageType&&u.addDataField("MessageType",null===(s=this.requestQueue[0].data)||void 0===s?void 0:s.messageType,g.String,h.SystemMetadata),this.webSocketId=E()(),u.addDataField("WebsocketId",this.webSocketId,g.String,h.SystemMetadata);var c=Ke(this.intentServiceUrl,this.webSocketId,this.sessionId,this.app);try{this.webSocket=new WebSocket(c.href),this.webSocket.onerror=function(e){u&&(u.addDataField("error",e.type,g.String,h.SystemMetadata),u.fail(),u=null),a.logger.logEvent("WebSocketError",0,p.Error,e.type,f.CriticalBusinessImpact)},this.webSocket.onopen=function(t){u&&(u.end(),u=null),a.initializeCustomCompression(e),a.processRequestQueue()},this.webSocket.binaryType="arraybuffer",this.webSocket.onmessage=function(e){try{if(a.WebSocketEnabled=!0,a.lastReceivedMessageTimeStamp=Date.now(),"string"===typeof e.data){var t=JSON.parse(e.data);t.messageType===T.WSMessageType.Pong?a.pingRequest&&(a.websocketLatency=Date.now()-a.pingRequest.data.payload,a.pingRequest=null):(null===t||void 0===t?void 0:t.messageType)===T.WSMessageType.HandShakeResponse?a.contentEncoding=t.payload.contentEncoding:a.onMessageReceived(t)}else a.contentEncoding!==d&&a.contentEncoding!==l||Qe(new Uint8Array(e.data),(function(e,t){a.onMessageReceived(JSON.parse(ze(t)))}))}catch(ue){a.logger.error(556393798,"Error parsing response from server.","Error: "+ue+", message: "+(null===ue||void 0===ue?void 0:ue.message))}},this.webSocket.onclose=function(e){u&&(u.addDataField("code",e.code,g.String,h.SystemMetadata),u.addDataField("reason",e.reason,g.String,h.SystemMetadata),u.fail(),u=null),1e3!==e.code&&(a.WebSocketEnabled=!1),a.onConnectionClosed(e)}}catch(ue){this.logger.error(557097184,"Exception when creating websocket, likely badly formed URL.","URL: "+c.href+", Error: "+ue+", message: "+(null===ue||void 0===ue?void 0:ue.message)+", stack: "+(null===ue||void 0===ue?void 0:ue.stack)+" ")}}else this.processRequestQueue()},t.initializeCustomCompression=function(e){var t;if(this.enableWebsocketCustomCompression&&-1==window.navigator.userAgent.indexOf("MSIE")&&-1==window.navigator.userAgent.indexOf("Trident/")&&(null===(t=this.webSocket.extensions)||void 0===t||!t.includes("permessage-deflate"))){var n={acceptEncoding:[d,l]},r={messageType:T.WSMessageType.HandShakeRequest,correlationId:e,payload:n};this.webSocket.send(JSON.stringify(r)),this.logger.logEvent("WebSocketCustomCompressionInitiated",0,p.Info,"Custom compression handshake request sent.",f.Diagnostics)}},t.stopPingingServer=function(){this.webSocketPingId&&clearInterval(this.webSocketPingId),this.webSocketPingId=null,this.WebSocketEnabled=!0},t.onConnectionClosed=function(e){1e3===e.code&&this.stopPingingServer(),this.contentEncoding=void 0,this.logger.logEvent("IntentServiceProxyOnConnectionClosed",0,p.Info,"Connection Closed, code: "+(null===e||void 0===e?void 0:e.code)+", reason: "+(null===e||void 0===e?void 0:e.reason),f.Diagnostics),this.onConnectionClosedCallback&&this.onConnectionClosedCallback()},t.sendRequest=function(e){var t=this;e&&setTimeout((function(){var n,r;(null===(n=t.webSocket)||void 0===n?void 0:n.readyState)!==WebSocket.OPEN&&t.logger.warn(557097185,"Attempting to make request while websocket is not open!");var i,o,a,s=Date.now();try{t.contentEncoding===d?(i=Ze(JSON.stringify(e.data)),o=function(e,n){t.webSocket.send(n)},a||(a=o,o={}),"function"!=typeof a&&ue(7),Me(i,o,[Ae,we,function(){return[He]}],(function(e){return ke(He(e.data[0],e.data[1]))}),2,a)):t.contentEncoding===l?function(e,t,n){n||(n=t,t={}),"function"!=typeof n&&ue(7),Me(e,t,[Ae],(function(e){return ke(Ne(e.data[0],e.data[1]))}),0,n)}(Ze(JSON.stringify(e.data)),(function(e,n){t.webSocket.send(n)})):t.contentEncoding||t.webSocket.send(JSON.stringify(e.data))}catch(ue){t.logger.error(557097186,"Issue sending the request message over the websocket.",{error:ue,message:null===ue||void 0===ue?void 0:ue.message,stack:null===ue||void 0===ue?void 0:ue.stack})}var u=Date.now()-s,c=null===(r=e.data)||void 0===r?void 0:r.messageType;c!==T.WSMessageType.Ping&&t.logger.logEvent("SendWebSocketRequest",0,p.Info,"",f.Diagnostics,{messageType:c,latency:u})}),0)},t.processRequestQueue=function(){for(var e=this.requestQueue.shift();e;)this.sendRequest(e),e=this.requestQueue.shift()},e}();function $e(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function Xe(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){$e(o,r,i,a,s,"next",e)}function s(e){$e(o,r,i,a,s,"throw",e)}a(void 0)}))}}n(2911),n(217);var et,tt=n(7159),nt=n.n(tt);function rt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return it(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?it(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function it(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e){e.All="All",e.Data="Data",e.Define="Define",e.File="File",e.Help="Help",e.Image="Image",e.Indoc="Indoc",e.Slide="Slide",e.Top="Top",e.TermSuggestion="TermSuggestion",e.Web="Web",e.Notes="Notes",e.SuggestedCommands="SuggestedCommands",e.Conversations="Conversations",e.Signage="Signage",e.Unknown="Unknown"}(et||(et={}));var ot,at,st,ut,ct,dt,lt,pt,ht,ft,vt,gt,yt,mt,St,It,Tt,Rt,bt,Pt,Et,xt=function(){function e(e,t,n,r){this.intentServiceUrl=e,this.logger=t,this.onMessageReceived=n,this.onConnectionErrorCallback=r,this.providerContextMap=new Map,this.baseRequest=void 0,this.indocIndexRequest=void 0,this.needBuildIndexRequest=!1,this.authRequestReceived=!1,this.primaryRequestReceived=!1,this.requiredProvidersForRequest=[T.QnaLocalProviderIdentifier.Id],this.requestSent=!1,this.shouldSendHttpRequest=!1,this.pendingProvidersForRequest=new Set(this.requiredProvidersForRequest),this.sessionId=void 0,this.app=void 0,this.landingTab=void 0}var t=e.prototype;return t.Reset=function(e){this.baseRequest=null,this.authRequestReceived=!1,this.primaryRequestReceived=!1,this.pendingProvidersForRequest=new Set(this.requiredProvidersForRequest),this.requestSent=!1,this.sessionId=null===e||void 0===e?void 0:e.sessionId,this.app=null===e||void 0===e?void 0:e.app,this.shouldSendHttpRequest=!1,this.needBuildIndexRequest=!0},t.ProcessRequest=function(e,t){if(e){var n,r;if(this.updateRequestRequirements(e,t),(null===(n=e.data)||void 0===n?void 0:n.messageType)===T.WSMessageType.InDocSearchRequest)this.indocIndexRequest=e;else if((null===(r=e.data)||void 0===r?void 0:r.messageType)===T.WSMessageType.SearchRequest){var i,o,a,s,u;this.baseRequest=e,!1===(null===e||void 0===e||null===(i=e.data)||void 0===i||null===(o=i.payload)||void 0===o||null===(a=o.intentContext)||void 0===a?void 0:a.isEnterpriseUser)&&(this.authRequestReceived=!0);var c=null===e||void 0===e||null===(s=e.data)||void 0===s||null===(u=s.payload)||void 0===u?void 0:u.providerContexts;if(c)for(var d,l=rt(c);!(d=l()).done;){var p=d.value;this.providerContextMap.set(p.providerId,p),p.providerId!==T.TapProviderIdentifier.TAP_SEARCH_SP_PROVIDER_ID&&p.providerId.startsWith("Provider.Tap")&&(this.authRequestReceived=!0)}}this.shouldSendHttpRequest&&this.SendRequest()}},t.SendRequest=function(){var e=Xe(regeneratorRuntime.mark((function e(t){var n,r,i,o,a,s,u,c,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!1),this.shouldSendHttpRequest=!0,this.requestSent||!t&&!this.readyToSendRequest()){e.next=35;break}if(this.logger.info(559940881,"Ready to send the http request. Force send request: "+t),!(n=this.createRequest())){e.next=35;break}return(r=this.logger.createActivity("HttpRequestActivity",f.CriticalBusinessImpact)).addDataField("TransactionId",this.baseRequest.transactionId,g.String,h.SystemMetadata),(i=Ke(this.intentServiceUrl,this.baseRequest.transactionId,this.sessionId,this.app)).protocol=i.protocol.replace("ws","http"),this.requestSent=!0,e.prev=11,e.next=14,nt()(i,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Connection:"keep-alive"},body:JSON.stringify(n)});case 14:if(o=e.sent,r.addDataField("status",o.status,g.Int64,h.SystemMetadata),!o.ok){e.next=24;break}return e.next=19,o.text();case 19:a=e.sent,r.end();try{if(s=JSON.parse(a),Array.isArray(s))for(u=rt(s);!(c=u()).done;)d=c.value,this.onMessageReceived(d);else this.onMessageReceived(s)}catch(ue){this.logger.error(556393799,"Error parsing response from server. Error: "+ue+", message: "+(null===ue||void 0===ue?void 0:ue.message))}e.next=27;break;case 24:r.fail(),this.logger.error(559940882,"Error occurred while fetching data from service.","Status: "+o.status+", message: "+o.statusText),this.onConnectionErrorCallback(n.transactionId);case 27:e.next=35;break;case 29:e.prev=29,e.t0=e.catch(11),r.addDataField("error",null===e.t0||void 0===e.t0?void 0:e.t0.message,g.String,h.SystemMetadata),r.fail(),this.logger.error(559940883,"Error occurred while fetching data from service.",e.t0),this.onConnectionErrorCallback(n.transactionId);case 35:case"end":return e.stop()}}),e,this,[[11,29]])})));return function(t){return e.apply(this,arguments)}}(),t.updateRequestRequirements=function(e,t){var n;if(e&&(null===(n=e.data)||void 0===n?void 0:n.messageType)===T.WSMessageType.SearchRequest){var r,i,o,a,s,u,c=null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.payload;t&&(this.primaryRequestReceived=!0,this.landingTab=null===c||void 0===c||null===(u=c.intentContext)||void 0===u?void 0:u.landingTab),!1===(null===c||void 0===c||null===(i=c.intentContext)||void 0===i?void 0:i.isEnterpriseUser)&&(this.authRequestReceived=!0),null!==c&&void 0!==c&&null!==(o=c.intentContext)&&void 0!==o&&o.inDocSearchIndexId&&(this.needBuildIndexRequest=!1);var d=null===e||void 0===e||null===(a=e.data)||void 0===a||null===(s=a.payload)||void 0===s?void 0:s.providerContexts;if(d)for(var l,p=rt(d);!(l=p()).done;){var h=l.value;h.providerId===T.QnaLocalProviderIdentifier.Id&&t&&h.qnaProviderEnabled||this.pendingProvidersForRequest.delete(h.providerId)}}},t.readyToSendRequest=function(){return!(!this.baseRequest||!this.primaryRequestReceived||this.needBuildIndexRequest&&!this.indocIndexRequest||this.landingTab!==et.Indoc&&!this.authRequestReceived||0!==this.pendingProvidersForRequest.size)},t.updateIndocProviderContextForCurrentRequest=function(e){var t;if(this.needBuildIndexRequest)if(null!==(t=this.indocIndexRequest)&&void 0!==t&&t.data){var n,r=null===(n=this.indocIndexRequest.data.payload)||void 0===n?void 0:n.revision;e.payload.intentContext.inDocSearchIndexId=T.InDocSearchSpecialDocIds.CurrentSession,e.payload.intentContext.documentRevision=r,this.providerContextMap.has(T.QnaProviderIdentifier.Id)&&(this.providerContextMap.get(T.QnaProviderIdentifier.Id).inDocSearchIndexId=T.InDocSearchSpecialDocIds.CurrentSession,this.providerContextMap.get(T.QnaProviderIdentifier.Id).documentRevision=r),this.providerContextMap.has(T.QnaQuerySuggestProviderIdentifier.Id)&&(this.providerContextMap.get(T.QnaQuerySuggestProviderIdentifier.Id).inDocSearchIndexId=T.InDocSearchSpecialDocIds.CurrentSession)}else this.providerContextMap.has(T.QnaProviderIdentifier.Id)&&(this.providerContextMap.get(T.QnaProviderIdentifier.Id).qnaProviderEnabled=!1),this.providerContextMap.has(T.QnaQuerySuggestProviderIdentifier.Id)&&(this.providerContextMap.get(T.QnaQuerySuggestProviderIdentifier.Id).providerEnabled=!1)},t.createRequest=function(){var e,t,n,r,i=[];return this.baseRequest?(null!==(e=this.baseRequest)&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.payload&&((n=Object.assign({},this.baseRequest.data)).payload.providerContexts=Array.from(this.providerContextMap.values())),i.push(n),this.updateIndocProviderContextForCurrentRequest(n),this.needBuildIndexRequest&&null!==(r=this.indocIndexRequest)&&void 0!==r&&r.data&&(this.indocIndexRequest.data.correlationId=this.baseRequest.transactionId,this.indocIndexRequest.data.payload&&(this.indocIndexRequest.data.payload.correlationId=this.baseRequest.transactionId),i.push(this.indocIndexRequest.data)),i):null},e}(),At=function(){function e(e,t,n,r){this.logger=t,this.onMessageReceived=n,this.onConnectionErrorCallback=r,this.sessionId=void 0,this.app=void 0,this.retryCount=3,this.intentServiceUrl=void 0,this.messageNumber=0,this.targetServer=void 0,this.primaryRequestSent=!1,this.requestQueue=[],this.intentServiceUrl=new URL(y.ServiceEndpoints.SearchEndpointV3,e).href}var t=e.prototype;return t.Reset=function(e){this.targetServer=null,this.primaryRequestSent=!1,this.requestQueue=[]},t.getIntentServiceHttpUrl=function(e){var t=Ke(this.intentServiceUrl,e,this.sessionId,this.app);return t.protocol=t.protocol.replace("ws","http"),t},t.sendAndLogRequest=function(){var e=Xe(regeneratorRuntime.mark((function e(t){var n,r,i,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getIntentServiceHttpUrl(t.correlationId),(r=this.logger.createActivity("SearchHttpV3Request",f.CriticalBusinessImpact)).addDataField("TransactionId",t.correlationId,g.String,h.SystemMetadata),r.addDataField("RequestType",t.messageType,g.String,h.SystemMetadata),e.prev=4,o={Accept:"application/json","Content-Type":"application/json",Connection:"keep-alive"},this.targetServer&&(o[T.HeaderNames.MachineAffinity]=this.targetServer),t.requestMessageNumber=++this.messageNumber,e.next=10,nt()(n.href,{method:"POST",headers:o,body:JSON.stringify(t)});case 10:return a=e.sent,r.addDataField("Status",a.status,g.Int64,h.SystemMetadata),r.addDataField("MessageNumber",t.requestMessageNumber,g.Int64,h.SystemMetadata),r.addDataField("MachineName",a.headers.get(T.HeaderNames.MachineAffinity),g.String,h.SystemMetadata),r.addDataField("ProcessId",a.headers.get(T.HeaderNames.ProcessId),g.String,h.SystemMetadata),r.addDataField("Cluster",a.headers.get(T.HeaderNames.OfficeCluster),g.String,h.SystemMetadata),this.targetServer=null!==(i=a.headers.get(T.HeaderNames.MachineAffinity))&&void 0!==i?i:this.targetServer,a.ok?r.end():(r.addDataField("Error",a.statusText,g.Int64,h.SystemMetadata),r.fail()),e.abrupt("return",a);case 21:throw e.prev=21,e.t0=e.catch(4),r.addDataField("Error",JSON.stringify(e.t0,Object.getOwnPropertyNames(e.t0)),g.String,h.SystemMetadata),r.fail(),e.t0;case 26:case"end":return e.stop()}}),e,this,[[4,21]])})));return function(t){return e.apply(this,arguments)}}(),t.processHttpApiRequestInternal=function(){var e=Xe(regeneratorRuntime.mark((function e(t,n,r){var i,o,a,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r=0),e.prev=1,e.next=4,this.sendAndLogRequest(t);case 4:if(!(i=e.sent).ok){e.next=17;break}if(t.messageType!==T.WSMessageType.InDocSearchRequest){e.next=14;break}return e.next=9,i.text();case 9:o=e.sent,a=JSON.parse(o),this.onMessageReceived(a),e.next=15;break;case 14:n&&setTimeout(Xe(regeneratorRuntime.mark((function e(){var n,r,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!0,r={correlationId:t.correlationId,messageType:T.WSMessageType.FetchSearchResponse,payload:{intentContext:t.payload.intentContext}},i=0;case 3:if(!(n&&i<s.retryCount)){e.next=26;break}return e.prev=4,e.next=7,s.sendAndLogRequest(r);case 7:if(!(o=e.sent).ok){e.next=12;break}return e.delegateYield(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.text();case 2:t=e.sent,(r=JSON.parse(t)).messageType===T.WSMessageType.SearchResponse&&(n=r.payload.moreData),setTimeout((function(){s.onMessageReceived(r)}),0);case 6:case"end":return e.stop()}}),e)}))(),"t0",10);case 10:e.next=18;break;case 12:if(404!==o.status){e.next=17;break}return s.logger.error(539267139,"Request not found on the server. Not retrying anymore."),e.abrupt("break",26);case 17:i++;case 18:e.next=24;break;case 20:e.prev=20,e.t1=e.catch(4),s.logger.error(539342737,"Error parsing response from server. Error: "+e.t1+", message: "+(null===e.t1||void 0===e.t1?void 0:e.t1.message)),i++;case 24:e.next=3;break;case 26:i>=s.retryCount&&(s.logger.error(539342738,"Error occurred while fetching data from service after retries."),s.onConnectionErrorCallback(t.correlationId));case 27:case"end":return e.stop()}}),e,null,[[4,20]])}))),0);case 15:e.next=19;break;case 17:this.logger.error(539342739,"Error occurred while fetching data from service. Status: "+i.status+", message: "+i.statusText+" "),r<this.retryCount&&this.processHttpApiRequestInternal(t,n,r+1);case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(1),this.logger.error(539342740,"Error occurred while fetching data from service. Retrying - "+e.t0),r<this.retryCount&&this.processHttpApiRequestInternal(t,n,r+1);case 25:case"end":return e.stop()}}),e,this,[[1,21]])})));return function(t,n,r){return e.apply(this,arguments)}}(),t.processHttpAPIRequest=function(){var e=Xe(regeneratorRuntime.mark((function e(t,n){var r,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.data,this.requestQueue.push(r),this.primaryRequestSent||n){e.next=4;break}return e.abrupt("return");case 4:i=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.requestQueue.shift(),!o.primaryRequestSent){e.next=5;break}setTimeout((function(){o.processHttpApiRequestInternal(t,!1)}),0),e.next=8;break;case 5:return e.next=7,o.processHttpApiRequestInternal(t,!0);case 7:o.primaryRequestSent=!0;case 8:case"end":return e.stop()}}),e)}));case 5:if(!(this.requestQueue.length>0)){e.next=9;break}return e.delegateYield(i(),"t0",7);case 7:e.next=5;break;case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),e}();function wt(e,t,n,r,i,a,s){var u=Ct(e,t,n,r,i,a,null,s),c=[];c.push({providerId:T.ImagesProviderIdentifier.IMAGES_PROVIDER_ID,imagesLicense:"any"});var d=function(e){if(e.environment.platform===o.Platform.Win32)return{providerId:T.EnrichmentProviderIdentifier.Id,dataEnabled:e.dataEnabled,dataDomainId:e.dataDomainId,dataDomainMarket:e.dataDomainMarket,dataStockEnabled:e.dataStockEnabled,dataStockMarket:e.dataStockMarket}}(t);d&&c.push(d),c.push({providerId:T.QnaProviderIdentifier.Id,qnaProviderEnabled:t.featureGates.EnableInDocumentSearch});var l=(0,o.getInDocLaunchData)(e.launchData);return c.push({providerId:T.QnaLocalProviderIdentifier.Id,qnaProviderEnabled:t.featureGates.EnableInDocumentSearch&&t.featureGates.EnableLocalSearch&&!t.featureGates.EnableInDocLocalProviderSuppression,matchCase:null===l||void 0===l?void 0:l.matchCase,matchWholeWordOnly:null===l||void 0===l?void 0:l.matchWholeWord}),c.push({providerId:T.QnaQuerySuggestProviderIdentifier.Id,providerEnabled:t.featureGates.EnableInDocumentQuerySuggest}),c.push(Dt(T.TapProviderIdentifier.TAP_SEARCH_SP_PROVIDER_ID,"",t)),u.providerContexts=c,{messageType:T.WSMessageType.SearchRequest,correlationId:i,payload:u}}function Ct(e,t,n,r,i,a,s,u){var c,d,l,p;void 0===s&&(s=null);var h={staticContentPath:".",applicationType:o.ApplicationType.SmartLookup,platform:(null===(c=t.environment)||void 0===c?void 0:c.platform)||o.Platform.OfficeOnline,isRTL:null,isDarkTheme:null};t.environment=h;var f=t.enterpriseUserInfo&&t.enterpriseUserInfo.IsEnterpriseEnabled,v={correlationId:i,renderOnServer:r,intentContext:{sessionId:t.sessionId,query:null!==(d=(0,o.getInDocLaunchQuery)(e.launchData))&&void 0!==d?d:e.selection.neighborhood.substring(e.selection.mentionStart,e.selection.mentionStart+e.selection.mentionLength),neighborhood:e.selection.neighborhood,mentionStart:e.selection.mentionStart,mentionLength:e.selection.mentionLength,targetProviders:a,app:t.applicationName,appVersion:t.applicationVersion,platform:t.environment.platform,market:t.market,uiLanguage:t.uiLanguage,clientDetectedLanguage:e.selection.clientDetectedLanguage,uiLanguageLcid:t.lcid.toString(),clientUserAgent:t.applicationName,clientIP:"",paneCorrelationId:t.appCorrelationId,correlationId:i,transactionId:i,entryPoint:o.SmartLookupEntryPoint[e.entryPoint],userId:t.anid,userToken:f?null!==s&&void 0!==s?s:t.accessToken:"",tenantId:f?t.enterpriseUserInfo.TenantRoot:"",tenantGroup:f?"GeneratedByShredder":"",isEnterpriseUser:t.enterpriseUserInfo&&t.enterpriseUserInfo.IsEnterpriseEnabled,isShreddingEnabled:f,firstParagraph:"",currentParagraph:"",documentTitle:"",flights:t.featureGates,staticContentPath:n,theme:parseInt(t.themeId,10),landingTab:null===(l=e.launchData)||void 0===l?void 0:l.landingTab,landingData:null===(p=e.launchData)||void 0===p?void 0:p.data,additionalData:e.zeroTermData,processorOnlyMode:!!t.processorOnlyMode&&t.processorOnlyMode,subscription:t.subscription,isFeedbackEnabled:t.isFeedbackEnabled,rankingModels:t.featureGates.RankingModels}};return u&&(v.intentContext.searchSourceOnSerplet=u),v}function Dt(e,t,n,r){var i;void 0===r&&(r=!1);var o=0;switch(e){case T.TapProviderIdentifier.TAP_SEARCH_OLS_PROVIDER_ID:case T.TapProviderIdentifier.TAP_SEARCH_OLS_ZERO_TERM_PROVIDER_ID:r&&(o=50);break;case T.TapProviderIdentifier.TAP_SEARCH_3S_PROVIDER_ID:r&&(o=20)}var a=n.enterpriseUserInfo&&n.enterpriseUserInfo.IsEnterpriseEnabled;return{providerId:e,tapIsEchoScenario:!1,tapEnterpriseFeaturesEnabled:a,tapServiceEndpoint:a?n.enterpriseUserInfo.ServiceEndpoint||"https://shredder.osi.office.net/":"",tenantRoot:n.enterpriseUserInfo&&n.enterpriseUserInfo.TenantRoot,userToken:null!==(i=n.featureGates)&&void 0!==i&&i.EnableHttpApiV4?void 0:t,tapRowLimit:o}}function kt(e,t,n){var r=Object.assign({},e,{providerContexts:[{providerId:T.QnaProviderIdentifier.Id,qnaProviderEnabled:!0,inDocSearchIndexId:t,documentRevision:n},{providerId:T.QnaQuerySuggestProviderIdentifier.Id,inDocSearchIndexId:t,providerEnabled:e.intentContext.flights.EnableInDocumentQuerySuggest}]});return{messageType:T.WSMessageType.SearchRequest,correlationId:r.correlationId,payload:r}}function Ot(e,t,n){var r=Object.assign({},e,{providerContexts:[{providerId:T.QnaLocalProviderIdentifier.Id,qnaProviderEnabled:!0,results:t,documentRevision:n}]});return{messageType:T.WSMessageType.SearchRequest,correlationId:r.correlationId,payload:r}}n(9655),function(e){e.TAP_SEARCH_QF_PROVIDER_ID="Provider.Tap.Search.QF",e.TAP_SEARCH_OLS_PROVIDER_ID="Provider.Tap.Search.OLS",e.TAP_SEARCH_OLS_ZERO_TERM_PROVIDER_ID="Provider.Tap.Search.OLS.ZeroTerm",e.TAP_SEARCH_SP_PROVIDER_ID="Provider.Tap.Search.SP",e.TAP_SEARCH_3S_PROVIDER_ID="Provider.Tap.Search.3S",e.TAP_SEARCH_ZERO_TERM_CACHE_PROVIDER_ID="Provider.Tap.Search.ZeroTerm.Cache",e.DOCUMENT_ID="EntityGroup.Tap.Document"}(ot||(ot={})),function(e){e.DICTIONARY_PROVIDER_ID="Provider.UCI.Dictionary",e.DICTIONARY_WORDS_GROUP_ID="EntityGroup.UCI.Dictionary.Words",e.DICTIONARY_SUGGESTED_WORDS_GROUP_ID="EntityGroup.UCI.Dictionary.SuggestedWords"}(at||(at={})),function(e){e.SUBSTRATE_PROVIDER_ID="Provider.Substrate",e.ACRONYM_GROUP_ID="EntityGroup.Substrate.Acronym",e.PEOPLE_GROUP_ID="EntityGroup.Substrate.People",e.TOPIC_GROUP_ID="EntityGroup.Substrate.Topic",e.MESSAGE_GROUP_ID="EntityGroup.Substrate.Message",e.NOTE_GROUP_ID="EntityGroup.Substrate.Note"}(st||(st={})),function(e){e.IMAGES_PROVIDER_ID="Provider.UCI.Images",e.IMAGES_ID="EntityGroup.UCI.Images.Images"}(ut||(ut={})),function(e){e.PREMIUM_IMAGES_PROVIDER_ID="Provider.UCI.PremiumImages",e.PREMIUM_IMAGES_ID="EntityGroup.UCI.Images.PremiumImages"}(ct||(ct={})),function(e){e.INSIGHTS_PROVIDER_ID="Provider.UCI.Insights",e.BINGANSWER_COMPUTATION_ID="EntityGroup.UCI.Insights.BingAnswer.Computation",e.BINGANSWER_CURRENCY_ID="EntityGroup.UCI.Insights.BingAnswer.Currency",e.BINGANSWER_FACTS_ID="EntityGroup.UCI.Insights.BingAnswer.Facts",e.BINGANSWER_FINANCE_ID="EntityGroup.UCI.Insights.BingAnswer.Finance",e.BINGANSWER_NEWS_ID="EntityGroup.UCI.Insights.BingAnswer.News",e.BINGANSWER_WEATHER_ID="EntityGroup.UCI.Insights.BingAnswer.Weather",e.DICTIONARY_ID="EntityGroup.UCI.Insights.Dictionary",e.ENTITIES_ID="EntityGroup.UCI.Insights.Entities",e.IMAGES_ID="EntityGroup.UCI.Insights.Images",e.PACKAGETRACKING_ID="EntityGroup.UCI.Insights.PackageTrackingAnswer",e.PREMIUM_IMAGES_ID="EntityGroup.UCI.Insights.PremiumImages",e.WEBRESULTS_ID="EntityGroup.UCI.Insights.WebResults",e.WIKIPEDIARESULTS_ID="EntityGroup.UCI.Insights.WikipediaResults"}(dt||(dt={})),function(e){e.Id="Provider.EntitySuggestion",e.DataTypeId="EntityGroup.EntitySuggestion.Results"}(lt||(lt={})),function(e){e.Id="Provider.Enrichment",e.DataTypeId="EntityGroup.Enrichment.Results",e.DisambiguationDataTypeId="EntityGroup.Enrichment.DisambiguationResults",e.StockDataTypeId="EntityGroup.Enrichment.StockResults",e.ZeroTermDataTypeId="EntityGroup.Enrichment.ZeroTermResults"}(pt||(pt={})),function(e){e.Id="Provider.UCI.Help",e.DataTypeId="EntityGroup.UCI.Help.Support"}(ht||(ht={})),function(e){e.Id="Provider.UCI.HelpSoc",e.DataTypeId="EntityGroup.UCI.HelpSoc.Support"}(ft||(ft={})),function(e){e.Id="Provider.UCI.HelpVideos",e.DataTypeId="EntityGroup.UCI.Help.Videos"}(vt||(vt={})),function(e){e.Id="Provider.Dynamics",e.DataTypeId="Provider.Dynamics.Contact"}(gt||(gt={})),function(e){e.Id="Provider.Qna",e.DataTypeId="Provider.Qna.Results",e.QnaDataTypeId="Provider.Qna.QnaResults"}(yt||(yt={})),function(e){e.Id="Provider.QnaLocal",e.DataTypeId="Provider.QnaLocal.Results"}(mt||(mt={})),function(e){e.Id="Provider.QnaQuerySuggest",e.DataTypeId="Provider.QnaQuerySuggest.Results"}(St||(St={})),function(e){e.Id="Provider.KeyPhrases",e.DataTypeId="Provider.KeyPhrases.Results"}(It||(It={})),function(e){e.Id="Provider.ZeroTermMenu",e.DataTypeId="Provider.ZeroTermMenu.Results"}(Tt||(Tt={})),function(e){e.Id="Provider.Templates",e.DataTypeId="Provider.Templates.Results"}(Rt||(Rt={})),function(e){e.Id="Provider.SuggestedCommands",e.DataTypeId="Provider.SuggestedCommands.Results"}(bt||(bt={})),function(e){e.ConversationsId="Provider.FileInsights.Conversations",e.ConversationsDataTypeId="Provider.FileInsights.Conversations.Results"}(Pt||(Pt={})),function(e){e.Id="Provider.ContextLogging",e.DataTypeId="Provider.ContextLogging.Results"}(Et||(Et={}));var Mt=n(5138),Ft=JSON.parse('{"JP":[{"ProviderId":"Provider.UCI.Images","ProviderResultRelationship":[{"ResultDataType":"EntityGroup.UCI.Images.Images","ResultGroupType":"Pictures","IsDocumentResultType":false}],"LandingTabs":["All","Image"],"DocumentContentDependent":{"ZeroTermSearch":true,"TermSearch":false}},{"ProviderId":"Provider.UCI.PremiumImages","ProviderResultRelationship":[{"ResultDataType":"EntityGroup.UCI.Images.PremiumImages","ResultGroupType":"Pictures","IsDocumentResultType":false}],"LandingTabs":["All","Image"]},{"ProviderId":"Provider.KeyPhrases","LandingTabs":["All"]},{"ProviderId":"Provider.ZeroTermMenu","LandingTabs":["All"]},{"ProviderId":"Provider.UCI.Dictionary","ProviderResultRelationship":[{"ResultDataType":"EntityGroup.UCI.Dictionary.Words","ResultGroupType":"DictionaryKnowledge","IsDocumentResultType":false}],"LandingTabs":["All"]},{"ProviderId":"Provider.Substrate","ProviderResultRelationship":[{"ResultDataType":"EntityGroup.Substrate.Acronym","ResultGroupType":"EnterpriseKnowledge","IsDocumentResultType":false},{"ResultDataType":"EntityGroup.Substrate.People","ResultGroupType":"EnterpriseKnowledge","IsDocumentResultType":false},{"ResultDataType":"EntityGroup.Substrate.Topic","ResultGroupType":"EnterpriseKnowledge","IsDocumentResultType":false},{"ResultDataType":"EntityGroup.Substrate.Message","ResultGroupType":"Messages","IsDocumentResultType":true},{"ResultDataType":"EntityGroup.Substrate.Note","ResultGroupType":"Notes","IsDocumentResultType":true}],"LandingTabs":["All","Notes"],"IsAuthenticated":true},{"ProviderId":"Provider.Tap.Search.QF","ProviderResultRelationship":[{"ResultDataType":"EntityGroup.Tap.Document","ResultGroupType":"Files","IsDocumentResultType":true}],"LandingTabs":["All","File"],"IsAuthenticated":true},{"ProviderId":"Provider.Tap.Search.OLS","ProviderResultRelationship":[{"ResultDataType":"EntityGroup.Tap.Document","ResultGroupType":"Files","IsDocumentResultType":true}],"LandingTabs":["All","File"],"IsAuthenticated":true},{"ProviderId":"Provider.Tap.Search.OLS.ZeroTerm","ProviderResultRelationship":[{"ResultDataType":"EntityGroup.Tap.Document","ResultGroupType":"Files","IsDocumentResultType":true}],"LandingTabs":["All","File"],"IsAuthenticated":true},{"ProviderId":"Provider.Tap.Search.SP","ProviderResultRelationship":[{"ResultDataType":"EntityGroup.Tap.Document","ResultGroupType":"Files","IsDocumentResultType":true}],"LandingTabs":["All","File"],"IsAuthenticated":true,"DocumentContentDependent":{"ZeroTermSearch":true,"TermSearch":false}},{"ProviderId":"Provider.Tap.Search.3S","ProviderResultRelationship":[{"ResultDataType":"EntityGroup.Tap.Document","ResultGroupType":"Files","IsDocumentResultType":true}],"LandingTabs":["All","File"],"IsAuthenticated":true,"DocumentContentDependent":{"ZeroTermSearch":true,"TermSearch":false}},{"ProviderId":"Provider.Tap.Search.ZeroTerm.Cache","ProviderResultRelationship":[{"ResultDataType":"EntityGroup.Tap.Document","ResultGroupType":"Files","IsDocumentResultType":true}],"LandingTabs":["All","File"],"IsAuthenticated":true},{"ProviderId":"Provider.UCI.Insights","ProviderResultRelationship":[{"ResultDataType":"EntityGroup.UCI.Insights.BingAnswer.News","ResultGroupType":"AnswerKnowledge","IsDocumentResultType":false},{"ResultDataType":"EntityGroup.UCI.Insights.BingAnswer.Computation","ResultGroupType":"AnswerKnowledge","IsDocumentResultType":false},{"ResultDataType":"EntityGroup.UCI.Insights.BingAnswer.Currency","ResultGroupType":"AnswerKnowledge","IsDocumentResultType":false},{"ResultDataType":"EntityGroup.UCI.Insights.BingAnswer.Facts","ResultGroupType":"AnswerKnowledge","IsDocumentResultType":false},{"ResultDataType":"EntityGroup.UCI.Insights.BingAnswer.Weather","ResultGroupType":"AnswerKnowledge","IsDocumentResultType":false},{"ResultDataType":"EntityGroup.UCI.Insights.PackageTrackingAnswer","ResultGroupType":"AnswerKnowledge","IsDocumentResultType":false},{"ResultDataType":"EntityGroup.UCI.Insights.Entities","ResultGroupType":"EntityKnowledge","IsDocumentResultType":false},{"ResultDataType":"EntityGroup.UCI.Insights.WebResults","ResultGroupType":"Web","IsDocumentResultType":true},{"ResultDataType":"EntityGroup.UCI.Insights.WikipediaResults","ResultGroupType":"Web","IsDocumentResultType":true}],"LandingTabs":["All","Web"],"DocumentContentDependent":{"ZeroTermSearch":true,"TermSearch":false}},{"ProviderId":"Provider.UCI.HelpSoc","ProviderResultRelationship":[{"ResultDataType":"EntityGroup.UCI.HelpSoc.Support","ResultGroupType":"Help","IsDocumentResultType":true}],"LandingTabs":["All","Help"]},{"ProviderId":"Provider.UCI.HelpVideos","ProviderResultRelationship":[{"ResultDataType":"EntityGroup.UCI.Help.Videos","ResultGroupType":"Help","IsDocumentResultType":true}],"LandingTabs":["All","Help"]},{"ProviderId":"Provider.Qna","ProviderResultRelationship":[{"ResultDataType":"Provider.Qna.Results","ResultGroupType":"Qna","IsDocumentResultType":false},{"ResultDataType":"Provider.Qna.QnaResults","ResultGroupType":"Qna","IsDocumentResultType":true}],"LandingTabs":["All","Indoc"],"DocumentContentDependent":{"ZeroTermSearch":false,"TermSearch":true}},{"ProviderId":"Provider.QnaLocal","ProviderResultRelationship":[{"ResultDataType":"Provider.QnaLocal.Results","ResultGroupType":"Qna","IsDocumentResultType":false}],"LandingTabs":["All","Indoc"]},{"ProviderId":"Provider.QnaQuerySuggest","ProviderResultRelationship":[{"ResultDataType":"Provider.QnaQuerySuggest.Results","ResultGroupType":"Qna","IsDocumentResultType":false}],"LandingTabs":["All","Indoc"],"DocumentContentDependent":{"ZeroTermSearch":true,"TermSearch":true}},{"ProviderId":"Provider.Enrichment","ProviderResultRelationship":[{"ResultDataType":"EntityGroup.Enrichment.Results","ResultGroupType":"RichEntity","IsDocumentResultType":false},{"ResultDataType":"EntityGroup.Enrichment.DisambiguationResults","ResultGroupType":"RichEntity","IsDocumentResultType":false},{"ResultDataType":"EntityGroup.Enrichment.StockResults","ResultGroupType":"RichEntity","IsDocumentResultType":false},{"ResultDataType":"EntityGroup.Enrichment.ZeroTermResults","ResultGroupType":"RichEntity","IsDocumentResultType":false}],"LandingTabs":["All","Data"]},{"ProviderId":"Provider.EntitySuggestion","ProviderResultRelationship":[{"ResultDataType":"EntityGroup.EntitySuggestion.Results","ResultGroupType":"EntitySuggestion","IsDocumentResultType":false}],"LandingTabs":["All"],"DocumentContentDependent":{"ZeroTermSearch":true,"TermSearch":false}},{"ProviderId":"Provider.SuggestedCommands","ProviderResultRelationship":[{"ResultDataType":"Provider.SuggestedCommands.Results","ResultGroupType":"CommandSuggestion","IsDocumentResultType":false}],"LandingTabs":["All"]},{"ProviderId":"Provider.Templates","ProviderResultRelationship":[{"ResultDataType":"Provider.Templates.Results","ResultGroupType":"Web","IsDocumentResultType":true}],"LandingTabs":["All","Web"]},{"ProviderId":"Provider.FileInsights.Conversations","ProviderResultRelationship":[{"ResultDataType":"Provider.FileInsights.Conversations.Results","ResultGroupType":"FileInsights","IsDocumentResultType":true}],"LandingTabs":["All"]}],"Xu":{"LandingTab":[{"LandingTab":"File","QRTimeout":3250},{"LandingTab":"Default","QRTimeout":1250,"Timeout":5000,"WSTimeout":10000,"Comment":"QTTimeout is timeout for http V4 quick request, Timeout is timeout for http request(older http versions and regular http request for http v4), WSTimeout is timeout for websocket request"}],"EntryPoint":[{"EntryPoint":"Files","Timeout":3250},{"EntryPoint":"Dummy","QRTimeout":1250,"Timeout":5000,"WSTimeout":10000}]},"CR":{"P":[{"LandingTab":"File","Timeout":3500,"QRTimeout":3500},{"LandingTab":"All","Timeout":3500,"QRTimeout":500},{"LandingTab":"Default","Timeout":1500,"QRTimeout":1500}],"N":[{"EntryPoint":"Files","Timeout":3500,"QRTimeout":3500}]}}');function _t(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return Lt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lt(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var qt=function(){function e(){this.providerGroupMap=new Map,this.providerResultTypeMap=new Map,this.resultTypeGroupMap=new Map,this.documentResultTypeId=new Set,this.documentGroupType=new Set,this.documentContentDependentProvidersTermSearch=new Set,this.documentContentDependentProvidersZeroTermSearch=new Set,this.authenticatedProviders=new Set,this.landingTabToProviderNameMap=new Map,this.providerExecutionTimeoutQRLandingTab=new Map,this.providerExecutionTimeoutLandingTab=new Map,this.providerExecutionTimeoutWSLandingTab=new Map,this.providerExecutionTimeoutQREntryPoint=new Map,this.providerExecutionTimeoutEntryPoint=new Map,this.providerExecutionTimeoutWSEntryPoint=new Map,this.contextRetrievalTimeoutLandingTab=new Map,this.contextRetrievalTimeoutLandingTabQR=new Map,this.contextRetrievalTimeoutEntrypoint=new Map,this.contextRetrievalTimeoutEntrypointQR=new Map,this.loadProviderSettings(),this.loadTimeoutSettings()}var t=e.prototype;return t.loadTimeoutSettings=function(){if(Ft.Xu){if(Ft.Xu.LandingTab)for(var e,t=_t(Ft.Xu.LandingTab);!(e=t()).done;){var n=e.value;n.QRTimeout&&this.providerExecutionTimeoutQRLandingTab.set(n.LandingTab,n.QRTimeout),n.Timeout&&this.providerExecutionTimeoutLandingTab.set(n.LandingTab,n.Timeout),n.WSTimeout&&this.providerExecutionTimeoutWSLandingTab.set(n.LandingTab,n.WSTimeout)}if(Ft.Xu.EntryPoint)for(var r,i=_t(Ft.Xu.EntryPoint);!(r=i()).done;){var o=r.value;o.QRTimeout&&this.providerExecutionTimeoutQREntryPoint.set(o.EntryPoint,o.QRTimeout),o.Timeout&&this.providerExecutionTimeoutEntryPoint.set(o.EntryPoint,o.Timeout),o.WSTimeout&&this.providerExecutionTimeoutWSEntryPoint.set(o.EntryPoint,o.WSTimeout)}if(Ft.CR.P)for(var a,s=_t(Ft.CR.P);!(a=s()).done;){var u=a.value;u.Timeout&&this.contextRetrievalTimeoutLandingTab.set(u.LandingTab,u.Timeout),u.QRTimeout&&this.contextRetrievalTimeoutLandingTabQR.set(u.LandingTab,u.Timeout)}if(Ft.CR.N)for(var c,d=_t(Ft.CR.N);!(c=d()).done;){var l=c.value;l.Timeout&&this.contextRetrievalTimeoutEntrypoint.set(l.EntryPoint,l.Timeout),l.QRTimeout&&this.contextRetrievalTimeoutEntrypointQR.set(l.EntryPoint,l.Timeout)}}},t.loadProviderSettings=function(){if(Ft.JP)for(var e,t=_t(Ft.JP);!(e=t()).done;){var n,r,i=e.value;if(i.LandingTabs&&i.LandingTabs.length>0)for(var o,a=_t(i.LandingTabs);!(o=a()).done;){var s=o.value;this.landingTabToProviderNameMap.has(s)||this.landingTabToProviderNameMap.set(s,new Set),this.landingTabToProviderNameMap.get(s).add(i.ProviderId)}if(i.ProviderResultRelationship)for(var u,c=i.ProviderId,d=_t(i.ProviderResultRelationship);!(u=d()).done;){var l=u.value;this.registerRelationships(c,l.ResultDataType,l.ResultGroupType,l.IsDocumentResultType)}i.IsAuthenticated&&this.authenticatedProviders.add(i.ProviderId),null!==(n=i.DocumentContentDependent)&&void 0!==n&&n.ZeroTermSearch&&this.documentContentDependentProvidersZeroTermSearch.add(i.ProviderId),null!==(r=i.DocumentContentDependent)&&void 0!==r&&r.TermSearch&&this.documentContentDependentProvidersTermSearch.add(i.ProviderId)}},t.registerRelationships=function(e,t,n,r){e&&t&&n&&(this.providerGroupMap.has(e)||this.providerGroupMap.set(e,new Set),this.providerGroupMap.get(e).add(n),this.providerResultTypeMap.has(e)||this.providerResultTypeMap.set(e,new Set),this.providerResultTypeMap.get(e).add(t),this.resultTypeGroupMap.set(t,n),r&&(this.documentResultTypeId.add(t),this.documentGroupType.add(n)))},t.isProviderSupported=function(e,t,n){return this.landingTabToProviderNameMap.has(t)?!!this.landingTabToProviderNameMap.get(t).has(e):(n.error(526721543,"[SerpletConfigHandler.isProviderSupported] Unable to find this landing tab in the service config: "+t),!1)},t.getSupportedProviders=function(e,t){return this.landingTabToProviderNameMap.has(e)?this.landingTabToProviderNameMap.get(e):(t&&t.error(526721544,"[SerpletConfigHandler.getSupportedProviders] Unable to find this landing tab in the service config: "+e),new Set)},t.getSupportedLandingTabsForProvider=function(e){for(var t,n=new Set,r=_t(this.landingTabToProviderNameMap.entries());!(t=r()).done;){var i=t.value,o=i[0];i[1].has(e)&&n.add(o)}return n},t.getResultGroupTypeForResultType=function(e){return this.resultTypeGroupMap.has(e)?this.resultTypeGroupMap.get(e):T.ResultGroupType.UNKNOWN},t.getResultGroupTypeForProviders=function(e){return this.providerGroupMap.has(e)?Array.from(this.providerGroupMap.get(e)):[]},t.isDocumentResultGroup=function(e){return this.documentGroupType.has(e)},t.isDocumentResultType=function(e){return this.documentResultTypeId.has(e)},t.isAuthenticatedProvider=function(e){return this.authenticatedProviders.has(e)},t.isDocumentContentDependent=function(e,t){return t?this.documentContentDependentProvidersZeroTermSearch.has(e):this.documentContentDependentProvidersTermSearch.has(e)},t.getResultTypeForProviders=function(e){return this.providerResultTypeMap.has(e)?Array.from(this.providerResultTypeMap.get(e)):[]},t.getProviderExecutionTimeout=function(e,t,n,r){var i=n?this.providerExecutionTimeoutQRLandingTab:this.providerExecutionTimeoutWSLandingTab,o=n?this.providerExecutionTimeoutQREntryPoint:this.providerExecutionTimeoutWSEntryPoint;if(e){if(i.has(e))return i.get(e)}else if(o.has(t))return o.get(t);return i.get("Default")},t.getContextRetrievalTimeout=function(e,t,n){var r=n?this.contextRetrievalTimeoutLandingTabQR:this.contextRetrievalTimeoutLandingTab,i=n?this.contextRetrievalTimeoutEntrypointQR:this.contextRetrievalTimeoutEntrypoint;if(e){if(r.has(e))return r.get(e)}else if(i.has(t))return i.get(t);return r.get("Default")},e}();function Gt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return Wt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wt(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Nt,Ut,Ht,jt,Bt,Qt,Vt,Jt,Zt,zt=function(){function e(e,t,n,r){this.sendLog=t,this.onConnectionErrorCallback=r,this.intentServiceUrl=void 0,this.providerContextMap=new Map,this.baseRequest=void 0,this.indocIndexRequest=void 0,this.needBuildIndexRequest=!0,this.shouldWaitForAuthProviders=!0,this.authRequestReceived=!1,this.primaryRequestReceived=!1,this.requestSent=!1,this.pendingProvidersForRequest=new Set,this.landingTab=void 0,this.entryPoint=void 0,this.isZeroTerm=void 0,this.buildIndexResponse=void 0,this.waitForRequestCompleteTimer=void 0,this.isFullRequest=!1,this.fullRequestCorrelationId=E()(),this.cachedMessages=[],this.onMessageReceived=void 0,this.serpletConfigHandler=void 0,(0,Mt.polyfill)(),this.serpletConfigHandler=new qt,this.intentServiceUrl=e.slice(0,e.indexOf(o.ServiceEndpoints.OfficeAugmentationPath))+o.ServiceEndpoints.SearchEndpointV4,this.intentServiceUrl=this.intentServiceUrl.replace("ws","http"),this.onMessageReceived=n,this.createAndSendRequest.bind(this)}var t=e.prototype;return t.Reset=function(e){var t;this.baseRequest=null,this.indocIndexRequest=null,this.buildIndexResponse=null,this.providerContextMap.clear(),this.primaryRequestReceived=!1,this.authRequestReceived=!1,this.requestSent=!1,this.landingTab=null===e||void 0===e?void 0:e.landingTab,this.entryPoint=null===e||void 0===e?void 0:e.entryPoint,this.isZeroTerm=!((t=null===e||void 0===e?void 0:e.query)&&""!==t),this.waitForRequestCompleteTimer=null,this.isFullRequest=!1,this.needBuildIndexRequest=!0,this.cachedMessages=[],this.setRequestSendRequirements(),this.resetWaitForContext()},t.SendFullRequest=function(e){this.isFullRequest=!0,this.fullRequestCorrelationId=null!==e&&void 0!==e?e:E()(),this.requestSent=!1,this.resetWaitForContext(),this.createAndSendRequest()},t.setRequestSendRequirements=function(){if(this.shouldWaitForAuthProviders=!0,this.needBuildIndexRequest=!0,this.pendingProvidersForRequest=new Set,this.landingTab){this.shouldWaitForAuthProviders=!1,this.needBuildIndexRequest=!1,this.landingTab===o.TabType.Indoc&&this.pendingProvidersForRequest.add(T.QnaLocalProviderIdentifier.Id);var e=this.serpletConfigHandler.getSupportedProviders(this.landingTab);if(e)for(var t,n=Gt(e);!(t=n()).done;){var r=t.value;this.serpletConfigHandler.isAuthenticatedProvider(r)&&(this.shouldWaitForAuthProviders=!0),this.serpletConfigHandler.isDocumentContentDependent(r,this.isZeroTerm)&&(this.needBuildIndexRequest=!0)}}},t.getWaitForContextTimeout=function(){return this.serpletConfigHandler.getContextRetrievalTimeout(this.landingTab,this.entryPoint,!this.isFullRequest)},t.resetWaitForContext=function(){var e=this;this.waitForRequestCompleteTimer&&clearTimeout(this.waitForRequestCompleteTimer),this.waitForRequestCompleteTimer=setTimeout((function(){e.requestSent||e.createAndSendRequest(!0)}),this.getWaitForContextTimeout())},t.CacheMessage=function(e){e&&this.cachedMessages.push(e)},t.GetCachedMessages=function(){return this.cachedMessages},t.RegisterMessageHandler=function(e){this.onMessageReceived=e},t.ProcessRequest=function(e,t){var n,r;if(e)if(this.updateRequestRequirements(e,t),(null===(n=e.data)||void 0===n?void 0:n.messageType)===T.WSMessageType.InDocSearchRequest)this.indocIndexRequest=e;else if((null===(r=e.data)||void 0===r?void 0:r.messageType)===T.WSMessageType.SearchRequest){var i,o;this.updateBaseRequestWithNewData(e);var a=null===e||void 0===e||null===(i=e.data)||void 0===i||null===(o=i.payload)||void 0===o?void 0:o.providerContexts;if(a)for(var s,u=Gt(a);!(s=u()).done;){var c=s.value;this.providerContextMap.set(c.providerId,c)}}this.createAndSendRequest(!1)},t.updateBaseRequestWithNewData=function(e){var t,n,r,i,a;e&&(this.baseRequest?null!==(t=this.baseRequest)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&null!==(r=n.payload)&&void 0!==r&&r.intentContext&&null!==e&&void 0!==e&&null!==(i=e.data)&&void 0!==i&&null!==(a=i.payload)&&void 0!==a&&a.intentContext&&(0,o.ObjectAssign)(this.baseRequest.data.payload.intentContext,e.data.payload.intentContext,!0):this.baseRequest=e)},t.createAndSendRequest=function(){var e=Xe(regeneratorRuntime.mark((function e(t,n){var r,i,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!1),void 0===n&&(n=1),this.requestSent||!t&&!this.readyToSendRequest()){e.next=23;break}if(this.sendLog("Diagnostics","[Http Request Manager V4] Ready to send the http request. Force send request: "+t),!(r=this.createRequest())){e.next=23;break}o=0;case 7:if(!(o<=n)){e.next=22;break}return e.prev=8,e.next=11,this.sendRequest(r,o);case 11:return a=e.sent,this.processResponse(a),e.abrupt("return");case 16:e.prev=16,e.t0=e.catch(8),this.sendLog("Error","[Http Request Manager V4] Error occurred while fetching data from service. "+(null===e.t0||void 0===e.t0?void 0:e.t0.message));case 19:o++,e.next=7;break;case 22:this.onConnectionErrorCallback(null===r||void 0===r||null===(i=r[0])||void 0===i?void 0:i.correlationId);case 23:case"end":return e.stop()}}),e,this,[[8,16]])})));return function(t,n){return e.apply(this,arguments)}}(),t.processResponse=function(e){if(Array.isArray(e))for(var t,n=Gt(e);!(t=n()).done;){var r=t.value;r.messageType===T.WSMessageType.InDocSearchResponse&&(this.buildIndexResponse=r,this.needBuildIndexRequest=!1),this.onMessageReceived(r)}else this.onMessageReceived(e)},t.sendRequest=function(){var e=Xe(regeneratorRuntime.mark((function e(t,n){var r,i,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[{name:"TransactionId",dataType:0,value:this.baseRequest.transactionId,classification:4},{name:"RetryCount",dataType:0,value:n.toString(),classification:4}],this.requestSent=!0,e.prev=2,e.next=5,nt()(this.intentServiceUrl,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Connection:"keep-alive"},body:JSON.stringify(t)});case 5:if(i=e.sent,r.push({name:"status",dataType:0,value:i.status,classification:4}),!i.ok){e.next=23;break}return e.next=10,i.text();case 10:return o=e.sent,this.sendLog("HttpRequestActivity","[Http Request Manager V4] HttpRequestActivity",r),e.prev=12,a=JSON.parse(o),e.abrupt("return",a);case 17:throw e.prev=17,e.t0=e.catch(12),this.sendLog("Error","[Http Request Manager V4] Error parsing response from server. Error: ${err}, message: ${err?.message}`"),new Error("Error parsing response from service");case 21:e.next=25;break;case 23:throw this.sendLog("Error","[Http Request Manager V4] Error occurred while fetching data from service. `Status: ${fetchResponse.status}, message: ${fetchResponse.statusText}`"),new Error("Something went wrong with fetching data.");case 25:e.next=33;break;case 27:throw e.prev=27,e.t1=e.catch(2),r.push({name:"error",dataType:0,value:null===e.t1||void 0===e.t1?void 0:e.t1.message,classification:4}),this.sendLog("HttpRequestActivity","[Http Request Manager V4] HttpRequestActivity",r),this.sendLog("Error","[Http Request Manager V4] Error occurred while fetching data from service. "+(null===e.t1||void 0===e.t1?void 0:e.t1.message)),new Error("Something went wrong with fetching data.");case 33:case"end":return e.stop()}}),e,this,[[2,27],[12,17]])})));return function(t,n){return e.apply(this,arguments)}}(),t.updateRequestRequirements=function(e,t){var n;if(e&&(null===(n=e.data)||void 0===n?void 0:n.messageType)===T.WSMessageType.SearchRequest){var r,i,o,a,s,u=null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.payload;t&&(this.primaryRequestReceived=!0),!1===(null===u||void 0===u||null===(i=u.intentContext)||void 0===i?void 0:i.isEnterpriseUser)&&(this.shouldWaitForAuthProviders=!1),null!==u&&void 0!==u&&null!==(o=u.intentContext)&&void 0!==o&&o.inDocSearchIndexId&&(this.needBuildIndexRequest=!1);var c=null===e||void 0===e||null===(a=e.data)||void 0===a||null===(s=a.payload)||void 0===s?void 0:s.providerContexts;if(c)for(var d,l=Gt(c);!(d=l()).done;){var p=d.value;p.providerId!==T.TapProviderIdentifier.TAP_SEARCH_SP_PROVIDER_ID&&0===p.providerId.indexOf("Provider.Tap")&&(this.authRequestReceived=!0),p.providerId===T.QnaLocalProviderIdentifier.Id&&t&&p.qnaProviderEnabled||this.pendingProvidersForRequest.delete(p.providerId)}}},t.readyToSendRequest=function(){return!(!this.baseRequest||!this.primaryRequestReceived||this.needBuildIndexRequest&&!this.indocIndexRequest||this.shouldWaitForAuthProviders&&!this.authRequestReceived||0!==this.pendingProvidersForRequest.size)},t.updateIndocProviderContextForCurrentRequest=function(e){var t;if(this.needBuildIndexRequest)if(null!==(t=this.indocIndexRequest)&&void 0!==t&&t.data){var n,r=null===(n=this.indocIndexRequest.data.payload)||void 0===n?void 0:n.revision;e.payload.intentContext.inDocSearchIndexId=T.InDocSearchSpecialDocIds.CurrentSession,e.payload.intentContext.documentRevision=r,this.providerContextMap.has(T.QnaProviderIdentifier.Id)&&(this.providerContextMap.get(T.QnaProviderIdentifier.Id).inDocSearchIndexId=T.InDocSearchSpecialDocIds.CurrentSession,this.providerContextMap.get(T.QnaProviderIdentifier.Id).documentRevision=r),this.providerContextMap.has(T.QnaQuerySuggestProviderIdentifier.Id)&&(this.providerContextMap.get(T.QnaQuerySuggestProviderIdentifier.Id).inDocSearchIndexId=T.InDocSearchSpecialDocIds.CurrentSession)}else this.providerContextMap.has(T.QnaProviderIdentifier.Id)&&(this.providerContextMap.get(T.QnaProviderIdentifier.Id).qnaProviderEnabled=!1),this.providerContextMap.has(T.QnaQuerySuggestProviderIdentifier.Id)&&(this.providerContextMap.get(T.QnaQuerySuggestProviderIdentifier.Id).providerEnabled=!1);else if(this.buildIndexResponse){var i,o,a,s;e.payload.intentContext.inDocSearchIndexId=null===(i=this.buildIndexResponse.payload)||void 0===i?void 0:i.docId,e.payload.intentContext.inDocSearchMachineId=null===(o=this.buildIndexResponse.payload)||void 0===o?void 0:o.machineId,null!==(a=this.indocIndexRequest)&&void 0!==a&&a.data&&(e.payload.intentContext.documentRevision=null===(s=this.indocIndexRequest.data.payload)||void 0===s?void 0:s.revision),this.providerContextMap.has(T.QnaProviderIdentifier.Id)&&(this.providerContextMap.get(T.QnaProviderIdentifier.Id).inDocSearchIndexId=e.payload.intentContext.inDocSearchIndexId,this.providerContextMap.get(T.QnaProviderIdentifier.Id).documentRevision=e.payload.intentContext.documentRevision),this.providerContextMap.has(T.QnaQuerySuggestProviderIdentifier.Id)&&(this.providerContextMap.get(T.QnaQuerySuggestProviderIdentifier.Id).inDocSearchIndexId=e.payload.intentContext.inDocSearchIndexId)}},t.createRequest=function(){var e,t,n,r,i=[];return this.baseRequest?(null!==(e=this.baseRequest)&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.payload&&((n=Object.assign({},this.baseRequest.data)).payload.providerContexts=Array.from(this.providerContextMap.values()),n.payload.intentContext.isQuickResponseCall=!this.isFullRequest),this.isFullRequest&&(n.correlationId=this.fullRequestCorrelationId,n.payload.correlationId=this.fullRequestCorrelationId,n.payload.intentContext.correlationId=this.fullRequestCorrelationId,n.payload.renderOnServer=!1),this.updateIndocProviderContextForCurrentRequest(n),i.push(n),this.needBuildIndexRequest&&null!==(r=this.indocIndexRequest)&&void 0!==r&&r.data&&(this.indocIndexRequest.data.correlationId=n.correlationId,this.indocIndexRequest.data.payload&&(this.indocIndexRequest.data.payload.correlationId=n.correlationId),i.push(this.indocIndexRequest.data)),i):null},e}(),Kt=function(){function e(e,t,n,r,i){this.logger=t,this.onSearchResult=n,this.onConnectionErrorCallback=i,this.requestQueue=void 0,this.searchRequestSendActivity=void 0,this.webSocketManager=void 0,this.httpRequestManager=void 0,this.httpApiRequestManager=void 0,this.httpApiRequestManagerV4=void 0,this.featureGates=void 0,this.currentSearchTransactionId=void 0,this.currentSearchCorrelationId=void 0,this.currentEntryPoint=void 0,this.lastReceivedMessageTimeStamp=void 0,this.requestsInLastFewSecs=void 0,this.onDataMessageReceived=this.onDataMessageReceived.bind(this),this.onConnectionError=this.onConnectionError.bind(this),this.LogEvent=this.LogEvent.bind(this),this.webSocketManager=new Ye(e,t,this.onDataMessageReceived,r),this.httpRequestManager=new xt(e,t,this.onDataMessageReceived,this.onConnectionError),this.httpApiRequestManager=new At(e,t,this.onDataMessageReceived,this.onConnectionError),this.httpApiRequestManagerV4=new zt(e,this.LogEvent,this.onDataMessageReceived,this.onConnectionError),this.requestQueue=[],this.currentSearchTransactionId=null,this.currentSearchCorrelationId=null,this.searchRequestSendActivity=null,this.requestsInLastFewSecs=new Set}var t=e.prototype;return t.CloseConnection=function(e,t){this.webSocketManager.ResetConnection(e,t)},t.ProcessRequest=function(e,t){var n,r,i,o;null!==(n=this.featureGates)&&void 0!==n&&n.EnableHttpApiV4?(this.currentSearchCorrelationId=null===(i=e.data)||void 0===i||null===(o=i.correlationId)||void 0===o?void 0:o.toLowerCase(),this.logHttpRequest(t),this.httpApiRequestManagerV4.ProcessRequest(e,t)):null!==(r=this.featureGates)&&void 0!==r&&r.EnableHttpAPICall?(this.logHttpRequest(t),this.httpApiRequestManager.processHttpAPIRequest(e,t)):(this.queueRequest(e,t),this.processV2Request(e.transactionId,t))},t.SendFollowupSearchRequest=function(e){this.currentSearchCorrelationId=null===e||void 0===e?void 0:e.toLowerCase(),this.logHttpRequest(!0,!0),this.httpApiRequestManagerV4.SendFullRequest(this.currentSearchCorrelationId)},t.ResetRequestQueue=function(e,t,n){var r;this.requestQueue=[],this.webSocketManager.ResetQueue(n,t),this.currentSearchTransactionId=null===e||void 0===e?void 0:e.toLowerCase(),this.currentSearchCorrelationId=this.currentSearchTransactionId,this.httpRequestManager.Reset(t),this.httpApiRequestManager.Reset(t),this.httpApiRequestManagerV4.Reset(t),this.featureGates=y.FeatureGates.getFeatureGates(null===t||void 0===t?void 0:t.flights),null!==(r=this.featureGates)&&void 0!==r&&r.EnableHttpAPICall&&this.CloseConnection(1e3,"Using Http API")},t.onConnectionError=function(e){this.searchRequestSendActivity&&(this.searchRequestSendActivity.fail(),this.searchRequestSendActivity=null),this.onConnectionErrorCallback(e)},t.onDataMessageReceived=function(e){try{var t,n=null===(t=e.correlationId)||void 0===t?void 0:t.toLowerCase();if(this.logResponse(n,e),e.messageType===T.WSMessageType.SearchResponse&&n!==this.currentSearchCorrelationId)return void this.logger.warn(559433032,"Response not for current search request.","Current correlationId: "+this.currentSearchCorrelationId+", response correlationId: "+n);this.searchRequestSendActivity&&(this.searchRequestSendActivity.end(),this.searchRequestSendActivity=null),this.lastReceivedMessageTimeStamp=Date.now(),e.messageType===T.WSMessageType.InDocSearchResponse||e.messageType===T.WSMessageType.SearchResponse?this.onSearchResult&&this.onSearchResult(e,e.correlationId):e.messageType===T.WSMessageType.Acknowledge||this.logger.warn(559433033,"Unknown websocket message type: "+e.messageType)}catch(ue){this.logger.error(559433034,"Error processing response from server.","Error: "+ue+", message: "+(null===ue||void 0===ue?void 0:ue.message))}},t.logHttpRequest=function(e,t){void 0===t&&(t=!1),e&&(this.searchRequestSendActivity&&(this.searchRequestSendActivity.end(),this.searchRequestSendActivity=null),this.searchRequestSendActivity=this.logger.createActivity("SendSearchRequest",f.CriticalBusinessImpact),this.searchRequestSendActivity.addDataField("isHttpRequest",!0,g.Boolean,h.SystemMetadata),this.searchRequestSendActivity.addDataField("isFollowupRequest",t,g.Boolean,h.SystemMetadata))},t.processV2Request=function(e,t){var n=this;if(t){this.searchRequestSendActivity=this.logger.createActivity("SendSearchRequest",f.CriticalBusinessImpact);var r=this.lastReceivedMessageTimeStamp;if(this.webSocketManager.WebSocketEnabled){this.searchRequestSendActivity.addDataField("isHttpRequest",!1,g.Boolean,h.SystemMetadata),this.searchRequestSendActivity.addDataField("WebsocketId",this.webSocketManager.GetActiveWebsocketId(),g.String,h.SystemMetadata);var i=function(){n.lastReceivedMessageTimeStamp===r?(n.searchRequestSendActivity&&n.searchRequestSendActivity.fail(),n.searchRequestSendActivity=null,n.logger.error(559433036,"IntentSvc did not acknowledge before timeout."),n.CloseConnection(),n.logger.info(559433037,"Websocket connection failed. Switching to http request for fallback"),n.webSocketManager.WebSocketEnabled=!1,n.processV2Request(e,t)):n.searchRequestSendActivity&&(n.searchRequestSendActivity.end(),n.searchRequestSendActivity=null)};this.currentEntryPoint!==y.SmartLookupEntryPoint[y.SmartLookupEntryPoint.Prefetch]&&setTimeout((function(){setTimeout(i,0)}),this.webSocketManager.GetWebsocketTimeout())}else this.searchRequestSendActivity.addDataField("isHttpRequest",!0,g.Boolean,h.SystemMetadata),setTimeout((function(){n.logger.info(559433035,"Request sending timeout was hit for http requests. Force sending the requests if it is not already sent"),n.httpRequestManager.SendRequest(!0),n.searchRequestSendActivity&&(n.searchRequestSendActivity.end(),n.searchRequestSendActivity=null)}),1e3)}this.processRequestQueue()},t.queueRequest=function(e,t){var n,r,i=this,o=null===(n=e.transactionId)||void 0===n?void 0:n.toLowerCase();if((null===(r=e.data)||void 0===r?void 0:r.messageType)===T.WSMessageType.InDocSearchRequest)this.requestQueue.push(e),this.httpRequestManager.ProcessRequest(e,!1);else if(t||!this.currentSearchTransactionId||this.currentSearchTransactionId===o){var a,s,u,c,d;this.currentSearchTransactionId=o,this.currentSearchCorrelationId=null!==(a=null===(s=e.data)||void 0===s||null===(u=s.correlationId)||void 0===u?void 0:u.toLowerCase())&&void 0!==a?a:o,this.requestQueue.push(e);var l=null===e||void 0===e||null===(c=e.data)||void 0===c?void 0:c.payload;this.currentEntryPoint=null===l||void 0===l||null===(d=l.intentContext)||void 0===d?void 0:d.entryPoint,this.httpRequestManager.ProcessRequest(e,t),t&&this.currentEntryPoint&&this.currentEntryPoint!==y.SmartLookupEntryPoint[y.SmartLookupEntryPoint.Prefetch]&&(this.requestsInLastFewSecs.add(o),setTimeout((function(){i.requestsInLastFewSecs.has(o)&&i.requestsInLastFewSecs.delete(o)}),15e3))}},t.dequeueRequest=function(){return this.requestQueue.shift()},t.processRequestQueue=function(){if(!this.webSocketManager.WebSocketEnabled)return this.logger.info(559433038,"Websocket is disabled, sending http request"),void this.httpRequestManager.SendRequest();for(var e=this.dequeueRequest();e;)this.webSocketManager.ProcessRequest(e),e=this.dequeueRequest()},t.logResponse=function(e,t){if(t.messageType===T.WSMessageType.SearchResponse){if(this.requestsInLastFewSecs.has(e)){var n,r,i=t.payload;null!==i&&void 0!==i&&null!==(n=i.renderedResults)&&void 0!==n&&n.html?this.logResponseEvent("SSR_HTML",e):null!==i&&void 0!==i&&null!==(r=i.renderedResults)&&void 0!==r&&r.state?this.logResponseEvent("SSR_State",e):this.logResponseEvent("Providers",e)}}else t.messageType===T.WSMessageType.InDocSearchResponse?this.logResponseEvent("InDocIndex",e):t.messageType===T.WSMessageType.Acknowledge&&this.logResponseEvent("Acknowledge",e)},t.logResponseEvent=function(e,t){t&&this.logger.addTransactionId(t),this.logger.logEvent("ResponseFromService",0,p.Info,e,f.CriticalBusinessImpact),this.currentSearchTransactionId&&this.logger.addTransactionId(this.currentSearchTransactionId)},t.LogEvent=function(e,t,n){this.logger.logEvent(e,0,p.Info,t,f.CriticalBusinessImpact,n)},e}();function Yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(Zt=Nt||(Nt={}))[Zt.String=0]="String",Zt[Zt.Boolean=1]="Boolean",Zt[Zt.Int64=2]="Int64",Zt[Zt.Double=3]="Double",Zt[Zt.Guid=4]="Guid",(Jt=Ut||(Ut={}))[Jt.EssentialServiceMetadata=1]="EssentialServiceMetadata",Jt[Jt.AccountData=2]="AccountData",Jt[Jt.SystemMetadata=4]="SystemMetadata",Jt[Jt.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",Jt[Jt.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",Jt[Jt.CustomerContent=32]="CustomerContent",Jt[Jt.AccessControl=64]="AccessControl",function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(Ht||(Ht={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(jt||(jt={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(Bt||(Bt={})),function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"}(Qt||(Qt={})),function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent",e[e.AlwaysOnNecessaryServiceDataEvent=120]="AlwaysOnNecessaryServiceDataEvent"}(Vt||(Vt={}));var $t,Xt,en,tn,nn,rn=function(){function e(e){this.messenger=e}return e.prototype.sendTelemetryEvent=function(e){var t={eventName:e.eventName.substr(e.eventName.lastIndexOf(".")+1),isActivity:!1,isFeedbackActivity:!1,eventFlags:{},dataFields:[]};if(e.dataFields.find((function(e){return"IsFeedback"===e.name&&!0===e.value}))&&(t.isFeedbackActivity=!0),e.eventContract&&"Office.System.Activity"===e.eventContract.name){t.activityContract={correlationVector:"",duration:0,count:0,aggMode:0,success:!0,resultType:"",resultTag:0,resultCode:0},t.isActivity=!0;for(var n,r=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return Yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yt(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e.eventContract.dataFields);!(n=r()).done;){var i=n.value;if(i)switch(i.name){case"Activity.CV":t.activityContract.correlationVector=i.value;break;case"Activity.Duration":t.activityContract.duration=i.value;break;case"Activity.Count":t.activityContract.count=i.value;break;case"Activity.AggMode":t.activityContract.aggMode=i.value;break;case"Activity.Success":t.activityContract.success=i.value;break;case"Activity.Result.Type":t.activityContract.resultType=i.value;break;case"Activity.Result.Tag":t.activityContract.resultTag=i.value;break;case"Activity.Result.Code":t.activityContract.resultCode=i.value}}}t.dataFields=e.dataFields.map((function(e){var t,n=e.dataType?e.dataType:Nt.String,r=e.classification?e.classification:Ut.SystemMetadata;switch(n){case Nt.Int64:case Nt.Double:t="number"===typeof e.value?e.value.toString():"0";break;case Nt.Boolean:t="boolean"===typeof e.value?e.value.toString():"false";break;case Nt.String:case Nt.Guid:t="string"===typeof e.value?e.value:"";break;default:t=""}return{name:e.name,dataType:n,value:t,classification:r}})),t.eventFlags={samplingPolicy:"string"===typeof Ht[e.eventFlags.samplingPolicy]?e.eventFlags.samplingPolicy:Ht.Diagnostics,costPriority:"string"===typeof Bt[e.eventFlags.costPriority]?e.eventFlags.costPriority:Bt.NotSet,diagnosticLevel:"string"===typeof Vt[e.eventFlags.diagnosticLevel]?e.eventFlags.diagnosticLevel:Vt.NecessaryServiceDataEvent,persistencePriority:"string"===typeof jt[e.eventFlags.persistencePriority]?e.eventFlags.persistencePriority:jt.NotSet,dataCategories:"string"===typeof Qt[e.eventFlags.dataCategories]?e.eventFlags.dataCategories:Qt.NotSet},this.messenger.executeAction({actionType:y.ActionType.Telemetry,data:JSON.stringify(t)}).catch((function(){}))},e}(),on=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}(),an=new on;function sn(e,t,n){an.fireEvent({level:e,category:t,message:n})}function un(e,t){return{name:e,dataType:Nt.Boolean,value:t,classification:Ut.SystemMetadata}}function cn(e,t){return{name:e,dataType:Nt.Int64,value:t,classification:Ut.SystemMetadata}}function dn(e,t){return{name:e,dataType:Nt.String,value:t,classification:Ut.SystemMetadata}}!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}($t||($t={})),function(e){e[e.Core=0]="Core",e[e.Sink=1]="Sink",e[e.Transport=2]="Transport"}(Xt||(Xt={})),function(e){e[e.Aria=0]="Aria",e[e.Nexus=1]="Nexus"}(en||(en={})),function(e){var t={},n={},r={};function i(e){if("object"!==typeof e)throw new Error("tokenTree must be an object");r=u(r,e)}function o(e){if(t[e])return t[e];var n=s(e,en.Aria);return"string"===typeof n?(t[e]=n,n):void 0}function a(e){if(n[e])return n[e];var t=s(e,en.Nexus);return"number"===typeof t?(n[e]=t,t):void 0}function s(e,t){var n=e.split("."),i=r,o=void 0;if(i){for(var a=0;a<n.length-1;a++)i[n[a]]&&(i=i[n[a]],t===en.Aria&&"string"===typeof i.ariaTenantToken?o=i.ariaTenantToken:t===en.Nexus&&"number"===typeof i.nexusTenantToken&&(o=i.nexusTenantToken));return o}}function u(e,t){if("object"!==typeof t)return t;for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];i in e&&(e[i],1)?e[i]=u(e[i],t[i]):e[i]=t[i]}return e}e.setTenantToken=function(e,t,n){var r=e.split(".");if(r.length<2||"Office"!==r[0])sn($t.Error,Xt.Core,(function(){return"Invalid namespace: "+e}));else{var o=Object.create(Object.prototype);t&&(o.ariaTenantToken=t),n&&(o.nexusTenantToken=n);var a,s=o;for(a=r.length-1;a>=0;--a){var u=Object.create(Object.prototype);u[r[a]]=s,s=u}i(s)}},e.setTenantTokens=i,e.getTenantTokens=function(e){var t=o(e),n=a(e);if(!n||!t)throw new Error("Could not find tenant token for "+e);return{ariaTenantToken:t,nexusTenantToken:n}},e.getAriaTenantToken=o,e.getNexusTenantToken=a,e.clear=function(){t={},n={},r={}}}(tn||(tn={})),function(e){var t=/^[A-Z][a-zA-Z0-9]*$/,n=/^[a-zA-Z0-9_\.]*$/;function r(e){return void 0!==e&&n.test(e)}function i(e){if(!((t=e.name)&&r(t)&&t.length+5<100))throw new Error("Invalid dataField name");var t;e.dataType===Nt.Int64&&o(e.value)}function o(e){if("number"!==typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;var n,r=e.split("."),i=r[r.length-1];return function(e){return!!e&&e.length>=3&&"Office"===e[0]}(r)&&(void 0!==(n=i)&&t.test(n))}(e.eventName))throw new Error("Invalid eventName");if(e.eventContract&&!r(e.eventContract.name))throw new Error("Invalid eventContract");if(null!=e.dataFields)for(var n=0;n<e.dataFields.length;n++)i(e.dataFields[n])},e.validateInt=o}(nn||(nn={}));var ln,pn=function(){return pn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},pn.apply(this,arguments)},hn=function(){function e(e,t,n){var r,i;this.onSendEvent=new on,this.persistentDataFields=[],this.config=n||{},e?(this.onSendEvent=e.onSendEvent,(r=this.persistentDataFields).push.apply(r,e.persistentDataFields),this.config=pn(pn({},e.getConfig()),this.config)):this.persistentDataFields.push(dn("OTelJS.Version","3.1.68")),t&&(i=this.persistentDataFields).push.apply(i,t)}return e.prototype.sendTelemetryEvent=function(e){var t;try{if(0===this.onSendEvent.getListenerCount())return void sn($t.Warning,Xt.Core,(function(){return"No telemetry sinks are attached."}));t=this.cloneEvent(e),this.processTelemetryEvent(t)}catch(n){return void function(e,t,n){sn($t.Error,e,(function(){return"SendTelemetryEvent: "+(n instanceof Error?n.message:"")}))}(Xt.Core,0,n)}try{this.onSendEvent.fireEvent(t)}catch(r){}},e.prototype.processTelemetryEvent=function(e){var t;e.telemetryProperties||(e.telemetryProperties=tn.getTenantTokens(e.eventName)),e.dataFields&&this.persistentDataFields&&(t=e.dataFields).unshift.apply(t,this.persistentDataFields),this.config.disableValidation||nn.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.onSendEvent.addListener((function(t){return e.sendTelemetryEvent(t)}))},e.prototype.setTenantToken=function(e,t,n){tn.setTenantToken(e,t,n)},e.prototype.setTenantTokens=function(e){tn.setTenantTokens(e)},e.prototype.cloneEvent=function(e){return function(e){var t={eventName:e.eventName,eventFlags:e.eventFlags};return e.telemetryProperties&&(t.telemetryProperties={ariaTenantToken:e.telemetryProperties.ariaTenantToken,nexusTenantToken:e.telemetryProperties.nexusTenantToken}),e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t.dataFields=e.dataFields?e.dataFields.slice():[],t}(e)},e.prototype.getConfig=function(){return this.config},e}();!function(e){var t,n=0;e.getNext=function(){return void 0===t&&(t=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(Math.random()*e.length)));return t.join("")}()),new r(t,++n)},e.getNextChild=function(e){return new r(e.getString(),++e.nextChild)};var r=function(){function e(e,t){this.base=e,this.id=t,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=r}(ln||(ln={}));var fn=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(Zn){o(Zn)}}function s(e){try{u(r.throw(e))}catch(Zn){o(Zn)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},vn=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(Zn){o=[6,Zn],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},gn=function(){return 1e3*Date.now()};"object"===typeof window&&"object"===typeof window.performance&&"now"in window.performance&&(gn=function(){return 1e3*Math.floor(window.performance.now())});var yn,mn,Sn,In,Tn,Rn,bn,Pn,En=function(){function e(e,t,n){this._optionalEventFlags={},this._ended=!1,this._telemetryLogger=e,this._activityName=t,this._cv=n?ln.getNextChild(n._cv):ln.getNext(),this._dataFields=[],this._success=void 0,this._startTime=gn()}return e.createNew=function(t,n){return new e(t,n)},e.prototype.createChildActivity=function(t){return new e(this._telemetryLogger,t,this)},e.prototype.setEventFlags=function(e){this._optionalEventFlags=e},e.prototype.addDataField=function(e){this._dataFields.push(e)},e.prototype.addDataFields=function(e){var t;(t=this._dataFields).push.apply(t,e)},e.prototype.setSuccess=function(e){this._success=e},e.prototype.setResult=function(e,t,n){this._result={code:e,type:t,tag:n}},e.prototype.endNow=function(){if(!this._ended){void 0===this._success&&void 0===this._result&&sn($t.Warning,Xt.Core,(function(){return"Activity does not have success or result set"}));var e=gn()-this._startTime;this._ended=!0;var t={duration:e,count:1,aggMode:0,cV:this._cv.getString(),success:this._success,result:this._result};return this._telemetryLogger.sendActivity(this._activityName,t,this._dataFields,this._optionalEventFlags)}sn($t.Error,Xt.Core,(function(){return"Activity has already ended"}))},e.prototype.executeAsync=function(e){return fn(this,void 0,void 0,(function(){var t=this;return vn(this,(function(n){return[2,e(this).then((function(e){return t.endNow(),e})).catch((function(e){throw t.endNow(),e}))]}))}))},e.prototype.executeSync=function(e){try{var t=e(this);return this.endNow(),t}catch(Zn){throw this.endNow(),Zn}},e.prototype.executeChildActivityAsync=function(e,t){return fn(this,void 0,void 0,(function(){return vn(this,(function(n){return[2,this.createChildActivity(e).executeAsync(t)]}))}))},e.prototype.executeChildActivitySync=function(e,t){return this.createChildActivity(e).executeSync(t)},e}();function xn(e,t,n){e.push(dn("zC."+t,n))}!function(e){e.getFields=function(e,t){var n=[];return n.push(cn(e+".Code",t.code)),void 0!==t.type&&n.push(dn(e+".Type",t.type)),void 0!==t.tag&&n.push(cn(e+".Tag",t.tag)),void 0!==t.isExpected&&n.push(un(e+".IsExpected",t.isExpected)),xn(n,e,"Office.System.Result"),n}}(yn||(yn={})),function(e){e.contractName="Office.System.Activity",e.getFields=function(t){var n=[];return void 0!==t.cV&&n.push(dn("Activity.CV",t.cV)),n.push(cn("Activity.Duration",t.duration)),n.push(cn("Activity.Count",t.count)),n.push(cn("Activity.AggMode",t.aggMode)),void 0!==t.success&&n.push(un("Activity.Success",t.success)),void 0!==t.result&&n.push.apply(n,yn.getFields("Activity.Result",t.result)),xn(n,"Activity",e.contractName),n}}(mn||(mn={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(dn(e+".Id",t.id)),void 0!==t.version&&n.push(dn(e+".Version",t.version)),void 0!==t.sessionId&&n.push(dn(e+".SessionId",t.sessionId)),xn(n,e,"Office.System.Host"),n}}(Sn||(Sn={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push(dn(e+".Alias",t.alias)),void 0!==t.primaryIdentityHash&&n.push(dn(e+".PrimaryIdentityHash",t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push(dn(e+".PrimaryIdentitySpace",t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push(dn(e+".TenantId",t.tenantId)),void 0!==t.tenantGroup&&n.push(dn(e+".TenantGroup",t.tenantGroup)),void 0!==t.isAnonymous&&n.push(un(e+".IsAnonymous",t.isAnonymous)),xn(n,e,"Office.System.User"),n}}(In||(In={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(dn(e+".Id",t.id)),void 0!==t.version&&n.push(dn(e+".Version",t.version)),void 0!==t.instanceId&&n.push(dn(e+".InstanceId",t.instanceId)),void 0!==t.name&&n.push(dn(e+".Name",t.name)),void 0!==t.marketplaceType&&n.push(dn(e+".MarketplaceType",t.marketplaceType)),void 0!==t.sessionId&&n.push(dn(e+".SessionId",t.sessionId)),void 0!==t.browserToken&&n.push(dn(e+".BrowserToken",t.browserToken)),void 0!==t.osfRuntimeVersion&&n.push(dn(e+".OsfRuntimeVersion",t.osfRuntimeVersion)),void 0!==t.officeJsVersion&&n.push(dn(e+".OfficeJsVersion",t.officeJsVersion)),void 0!==t.hostJsVersion&&n.push(dn(e+".HostJsVersion",t.hostJsVersion)),void 0!==t.assetId&&n.push(dn(e+".AssetId",t.assetId)),void 0!==t.providerName&&n.push(dn(e+".ProviderName",t.providerName)),void 0!==t.type&&n.push(dn(e+".Type",t.type)),xn(n,e,"Office.System.SDX"),n}}(Tn||(Tn={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.name&&n.push(dn(e+".Name",t.name)),void 0!==t.state&&n.push(dn(e+".State",t.state)),xn(n,e,"Office.System.Funnel"),n}}(Rn||(Rn={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(cn(e+".Id",t.id)),void 0!==t.name&&n.push(dn(e+".Name",t.name)),void 0!==t.commandSurface&&n.push(dn(e+".CommandSurface",t.commandSurface)),void 0!==t.parentName&&n.push(dn(e+".ParentName",t.parentName)),void 0!==t.triggerMethod&&n.push(dn(e+".TriggerMethod",t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push(cn(e+".TimeOffsetMs",t.timeOffsetMs)),xn(n,e,"Office.System.UserAction"),n}}(bn||(bn={})),function(e){e.getFields=function(e,t){var n=[];return n.push(dn(e+".ErrorGroup",t.errorGroup)),n.push(cn(e+".Tag",t.tag)),void 0!==t.code&&n.push(cn(e+".Code",t.code)),void 0!==t.id&&n.push(cn(e+".Id",t.id)),void 0!==t.count&&n.push(cn(e+".Count",t.count)),xn(n,e,"Office.System.Error"),n}}(Pn||(Pn={}));var An,wn=mn,Cn=yn,Dn=Pn,kn=Rn,On=Sn,Mn=Tn,Fn=bn,_n=In;!function(e){!function(e){var t;(t=e.System||(e.System={})).Activity=wn,t.Result=Cn,t.Error=Dn,t.Funnel=kn,t.Host=On,t.SDX=Mn,t.User=_n,t.UserAction=Fn}(e.Office||(e.Office={}))}(An||(An={}));var Ln=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ln(t,e),t.prototype.executeActivityAsync=function(e,t){return n=this,r=void 0,o=function(){return function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(Zn){o=[6,Zn],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(n){return[2,this.createNewActivity(e).executeAsync(t)]}))},new((i=void 0)||(i=Promise))((function(e,t){function a(e){try{u(o.next(e))}catch(Zn){t(Zn)}}function s(e){try{u(o.throw(e))}catch(Zn){t(Zn)}}function u(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}u((o=o.apply(n,r||[])).next())}));var n,r,i,o},t.prototype.executeActivitySync=function(e,t){return this.createNewActivity(e).executeSync(t)},t.prototype.createNewActivity=function(e){return En.createNew(this,e)},t.prototype.sendActivity=function(e,t,n,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:An.Office.System.Activity.contractName,dataFields:An.Office.System.Activity.getFields(t)},dataFields:n,eventFlags:r})},t.prototype.sendError=function(e){var t=An.Office.System.Error.getFields("Error",e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t}(hn),Gn=function(e){return e&&-1!=e.search("file:")&&(e=e.replace(/file:\/\/(.*)SmartLookupCache/g,"~")),e},Wn=function(){function e(e,t){this.disabled=t,this.activityScope=void 0,this.activityScope=e}var t=e.prototype;return t.addDataField=function(e,t,n,r){var i;if(void 0!=t){switch(n){case g.Boolean:i=un(e,t);break;case g.Double:i=function(e,t){return{name:e,dataType:Nt.Double,value:t,classification:Ut.SystemMetadata}}(e,t);break;case g.Int64:i=cn(e,t);break;case g.String:i=dn(e,t);break;default:throw new Error("Invalid activity data type: "+n)}i.classification=r,this.activityScope.addDataField(i)}},t.end=function(){this.disabled||(this.logEndTime(),this.activityScope.setSuccess(!0),this.activityScope.endNow())},t.fail=function(){this.disabled||(this.logEndTime(),this.activityScope.setSuccess(!1),this.activityScope.endNow())},t.logEndTime=function(){var e={classification:Ut.SystemMetadata,dataType:Nt.String,name:"Activity_Time_ISOString_End",value:(new Date).toISOString()};this.activityScope.addDataField(e)},e}();function Nn(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return Un(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Un(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Un(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Hn=function(){function e(){}var t=e.prototype;return t.sendTelemetryEvent=function(e){if((0,o.IsTridentControl)()){var t=new OfficeCore.RequestContext,n=[];this.addDataFields(n,e.dataFields);var r=e.eventContract?e.eventContract.name:"";e.eventContract&&this.addDataFields(n,e.eventContract.dataFields),t.telemetry.sendTelemetryEvent(e.telemetryProperties,e.eventName,r,this.getEffectiveEventFlags(e),n),t.sync().catch((function(){}))}else Office.sendTelemetryEvent(e)},t.addDataFields=function(e,t){if(t)for(var n,r=Nn(t);!(n=r()).done;){var i=n.value;e.push({name:i.name,value:i.value,classification:i.classification?i.classification:4,type:i.dataType})}},t.getEffectiveEventFlags=function(e){var t={costPriority:Bt.Normal,samplingPolicy:f.Measure,persistencePriority:jt.Normal,dataCategories:Qt.NotSet,diagnosticLevel:Vt.FullEvent};return e.eventFlags?(e.eventFlags.costPriority&&(t.costPriority=e.eventFlags.costPriority),e.eventFlags.samplingPolicy&&(t.samplingPolicy=e.eventFlags.samplingPolicy),e.eventFlags.persistencePriority&&(t.persistencePriority=e.eventFlags.persistencePriority),e.eventFlags.dataCategories&&(t.dataCategories=e.eventFlags.dataCategories),e.eventFlags.diagnosticLevel&&(t.diagnosticLevel=e.eventFlags.diagnosticLevel),t):t},e}(),jn=function(){function e(){}var t=e.prototype;return t.getDataField=function(e,t){var n=e.dataFields&&e.dataFields.find((function(e){return e.name==t}));return n&&n.value},t.sendTelemetryEvent=function(e){var t=this.getDataField(e,"Level"),n="0x"+this.getDataField(e,"Tag_Hex"),r=this.getDataField(e,"Message"),i=this.getDataField(e,"Data"),o=this.getDataField(e,"Error"),a=r?n+": "+r:e,s=r?{data:i,error:o,fullEvent:e}:void 0,u=/Chrome/.test(navigator.userAgent)&&/Google/.test(navigator.vendor),c=new RegExp("[?&]verbose=([^&#]*)").exec(window.location.search);"Error"==t?console.error(a,s):"Warn"==t?console.warn(a,s):c?console.log(a,s):u&&console.debug(a,s)},e}(),Bn=function(){function e(e,t,n,i,a,s,u){var c,d,l;void 0===a&&(a=!1),this.debugMode=i,this.namespace=void 0,this.defaultEventName=void 0,this.correlationID=void 0,this.transactionId=void 0,this.isHidden=void 0,this.market=void 0,this.entryPoint=void 0,this.isZeroTerm=void 0,this.sink=void 0,this.isConsoleEnabled=void 0,this.clientVersion="2022.5.13468272",this.telemetryLogger=void 0,this.telemetryLogger=new qn,this.namespace=["Office",e.tenantName,t].join("."),this.defaultEventName=[this.namespace,n].join("."),s?this.sink=s:null!==(l=window)&&void 0!==l&&l.isAgave&&window.isAgave()?this.sink=new Hn:this.sink=new rn(w(a?r.Wac:r.DesktopBrowserPane,null,o.ChannelId.SmartLookup,o.HostType.PaneUX,u)),this.telemetryLogger.addSink(this.sink),this.telemetryLogger.setTenantTokens({Office:(d={},d[e.tenantName]=(c={ariaTenantToken:e.ariaTenantToken,nexusTenantToken:e.nexusTenantToken},c[t]={},c),d)}),i&&(this.telemetryLogger.addSink(new jn),this.isConsoleEnabled=!0)}var t=e.prototype;return t.enableConsoleSink=function(){this.isConsoleEnabled||(this.telemetryLogger.addSink(new jn),this.isConsoleEnabled=!0)},t.addCorrelationID=function(e){this.correlationID=e},t.addTransactionId=function(e){this.transactionId=e},t.addIsHidden=function(e){this.isHidden=e},t.addMarket=function(e){this.market=e},t.addEntryPoint=function(e){this.entryPoint=e},t.addIsZeroTerm=function(e){this.isZeroTerm=e},t.logEvent=function(e,t,n,r,i,o,a,s){if(e||n===p.Error||n===p.Critical||this.debugMode){n=n===p.Critical?p.Info:n;var u=this.defaultEventName;e&&(u=[this.namespace,e].join(".")),this.sendLog(u,t,n,r,i,o,a,s)}},t.createActivity=function(e,t,n,r){var i=[this.namespace,e].join("."),o=this.telemetryLogger.createNewActivity(i);n&&o.addDataFields(An.Office.System.Funnel.getFields("Funnel",{name:e,state:v[n]}));var a={classification:Ut.SystemMetadata,dataType:Nt.String,name:"Activity_Time_ISOString_Start",value:(new Date).toISOString()};o.addDataField(a);for(var s,u=Nn(this.createBaseDataFields(0,p.Critical,""));!(s=u()).done;){var c=s.value;o.addDataField(c)}return o.setEventFlags({diagnosticLevel:Vt.NecessaryServiceDataEvent,dataCategories:Qt.ProductServiceUsage,samplingPolicy:t}),new Wn(o,this.entryPoint===y.SmartLookupEntryPoint[y.SmartLookupEntryPoint.Prefetch])},t.sendLog=function(e,t,n,r,i,o,a,s){n=n<=p.Debug?n:p.Debug;var u=this.createBaseDataFields(t,n,r);o&&u.push({name:"Data",value:Gn(JSON.stringify(o)),dataType:Nt.String,classification:Ut.SystemMetadata}),a&&u.push.apply(u,An.Office.System.Funnel.getFields("Funnel",{name:e,state:v[a]})),s&&u.push({name:"Error",value:Gn(JSON.stringify(s,Object.getOwnPropertyNames(s))),dataType:Nt.String,classification:Ut.SystemMetadata}),this.telemetryLogger.sendTelemetryEvent({eventName:e,dataFields:u,eventFlags:{persistencePriority:jt.Normal,costPriority:Bt.Normal,samplingPolicy:i,dataCategories:Qt.ProductServiceUsage,diagnosticLevel:Vt.NecessaryServiceDataEvent}})},t.createBaseDataFields=function(e,t,n){return[{name:"Tag",value:e.toString(),dataType:Nt.String,classification:Ut.SystemMetadata},{name:"Tag_Hex",value:e.toString(16),dataType:Nt.String,classification:Ut.SystemMetadata},{name:"Level",value:p[t],dataType:Nt.String,classification:Ut.SystemMetadata},{name:"Message",value:Gn(n),dataType:Nt.String,classification:Ut.SystemMetadata},{name:"Event_Time_ISOString",value:(new Date).toISOString(),dataType:Nt.String,classification:Ut.SystemMetadata},{name:"JSClientVersion",value:this.clientVersion,dataType:Nt.String,classification:Ut.SystemMetadata},{classification:Ut.SystemMetadata,dataType:Nt.String,name:"CorrelationID",value:this.correlationID?this.correlationID:""},{classification:Ut.SystemMetadata,dataType:Nt.String,name:"TransactionID",value:this.transactionId?this.transactionId:""},{classification:Ut.SystemMetadata,dataType:Nt.Boolean,name:"IsHidden",value:this.isHidden||!1},{classification:Ut.SystemMetadata,dataType:Nt.String,name:"Market",value:this.market?this.market:""},{classification:Ut.SystemMetadata,dataType:Nt.String,name:"EntryPoint",value:this.entryPoint?this.entryPoint:""},{classification:Ut.SystemMetadata,dataType:Nt.Boolean,name:"IsZeroTerm",value:this.isZeroTerm||!1}]},e}();function Qn(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return Vn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vn(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Jn=function(){t.setup=function(e,n,i,o,a){for(var s,u=new Bn({tenantName:"Insights",ariaTenantToken:y.InsightsAriaTenantToken,nexusTenantToken:1757},"SmartLookup","Diagnostics",!1,!0,a,null),c=new I([u],u),d={},l=Qn(n);!(s=l()).done;){var h=s.value;d[h.getId()]=h}var f={configurationProvider:e,messenger:w(r.Wac,c,y.ChannelId.SmartLookup,y.HostType.Client,null),logger:c,isSSR:i,executors:d,intentServiceEndpoint:o};return c.log(0,p.Info,"Hub created for",{channelId:e.channelId}),new t(f)};var e=t.prototype;function t(e){var t=this;this.args=e,this.originChecker=void 0,this.currentTransactionId=void 0,this.currentCorrelationId=void 0,this.previousTransactionIds=void 0,this.zeroTermCaches=void 0,this.keepConnectionAlive=void 0,this.inDocSearchIndexId=void 0,this.inDocSearchMachineId=void 0,this.inDocSearchIndexExpiryTime=void 0,this.failedRequests=new Set,this.documentRevision=void 0,this.featureGates=void 0,this.searchResults=void 0,this.localSearchResults=void 0,this.intentServiceProxy=void 0,this.searchEntry=void 0,this.paneSessionId=void 0,this.paneState=void 0,this.searchRequest=void 0,this.wsRequest=void 0,this.appProperties=void 0,this.onHostSkillEventHandler=void 0,this.augloopDocContentFetchActivity=void 0,this.paneState=y.PaneState.Closed,this.zeroTermCaches=new Map,this.previousTransactionIds=new Set,this.resetDocumentIndex(),this.args.configurationProvider.approvedOriginPattern&&(this.originChecker=new RegExp(this.args.configurationProvider.approvedOriginPattern,"i")),this.args.messenger.registerMessengerListener(this).catch((function(e){t.args.logger.log(562677470,p.Error,"Failed calling registerMessengerListener",JSON.stringify(e))})),this.intentServiceProxy=new Kt(this.args.intentServiceEndpoint,this.args.logger,this.onSearchResult.bind(this),this.onConnectionClosed.bind(this),this.onConnectionError.bind(this)),this.handleInLocalSearchResults=this.handleInLocalSearchResults.bind(this)}return e.setOnHostSkillEventHandler=function(e){this.onHostSkillEventHandler=e},e.onPaneStateChanged=function(e){try{e?this.onPaneOpen():this.onPaneClose()}catch(Zn){this.args.logger.log(562677467,p.Info,"Exception while changing pane state.",{open:e},Zn)}},e.onPaneThemeChanged=function(e){try{var t={actionType:y.ActionType.PaneThemeChanged,data:e.toString()};this.args.messenger.executeActionSync(t)}catch(Zn){this.args.logger.log(540096656,p.Info,"Exception while updating pane theme.",{themeId:e},Zn)}},e.setupFeatureGates=function(e){if(!this.featureGates){if(e.featureGates)if("string"===typeof e.featureGates)try{this.featureGates=JSON.parse(e.featureGates)}catch(Zn){this.args.logger.error(529306589,"Fail to parse appProperties.featureGates.")}else this.featureGates=e.featureGates;this.featureGates=y.FeatureGates.getFeatureGates(this.featureGates)}e.featureGates=this.featureGates},e.search=function(e,t,n,r,i){this.paneState=y.PaneState.Closed,this.setupFeatureGates(t),this.featureGates.ShowDebugInfo&&this.args.logger.enableConsoleSink(),this.appProperties=t,this.sendSearchEvent("PrimaryStart"),i||(this.onHostSkillEventHandler=void 0),this.searchRequest=e;var o=wt(e,t,r,!t.isClientSideRendering&&!i,t.appCorrelationId);this.searchFromHostInitial(o,t.sessionId),this.sendSearchEvent("Primary")},e.searchAuthenticatedProviders=function(e,t,n,r,i,o){this.sendSearchEvent("AuthenticatedProvidersStart"),this.appProperties=t,o||(i&&0!==i.length?o=i[0].token:this.args.logger.error(562677468,"Attempting to call authenticated providers without provider tokens")),o||this.args.logger.error(562677469,"Attempting to call authenticated shredderToken providers without token!");var a=function(e,t,n,r,i,o,a){var s=Ct(e,n,r,i,o,void 0,t),u=function(e,t,n){for(var r,i,o,a,s=[],u=0,c=[T.TapProviderIdentifier.TAP_SEARCH_OLS_ZERO_TERM_PROVIDER_ID,T.TapProviderIdentifier.TAP_SEARCH_SP_PROVIDER_ID,T.TapProviderIdentifier.TAP_SEARCH_3S_PROVIDER_ID,T.TapProviderIdentifier.TAP_SEARCH_ZERO_TERM_CACHE_PROVIDER_ID];u<c.length;u++){var d=c[u];s.push(Dt(d,n,e,t))}return s.push(function(e,t,n){return{providerId:e,isEnabled:n.enterpriseUserInfo&&n.enterpriseUserInfo.IsEnabled,userToken:n.featureGates.EnableHttpApiV4?void 0:t}}(T.SubstrateProviderIdentifier.SUBSTRATE_PROVIDER_ID,n,e)),null!==(r=e.currentDocument)&&void 0!==r&&r.filePath&&e.featureGates.FileInsightsEnabled&&s.push((o=e.featureGates.EnableHttpApiV4?void 0:n,a=null===(i=e.currentDocument)||void 0===i?void 0:i.filePath,{providerId:Pt.ConversationsId,userToken:o,filePath:a})),s}(n,0===e.selection.mentionLength,t);return s.providerContexts=[].concat(s.providerContexts||[],u),s.intentContext.transactionId=o,{messageType:T.WSMessageType.SearchRequest,correlationId:n.appCorrelationId,payload:s}}(e,o,t,r,this.wsRequest.payload.renderOnServer,t.appCorrelationId),s={actionType:y.ActionType.Search,data:a,transactionId:this.wsRequest.correlationId,paneSessionId:t.appCorrelationId};this.intentServiceProxy.ProcessRequest(s,!1),this.sendSearchEvent("AuthenticatedProviders")},e.handleDocumentContentAugloopAnnotation=function(e){var t=this;this.augloopDocContentFetchActivity&&(this.hasAugloopDocContentFetchFailed(e)?this.augloopDocContentFetchActivity.fail():this.augloopDocContentFetchActivity.end(),this.augloopDocContentFetchActivity=null);var n=this.wsRequest.payload;setTimeout((function(){t.sendDocumentBuildRequest(n,T.InDocSearchExecutionPlan.BuildIndex,void 0,e)}),0)},e.resetLoggerProperties=function(e){var t,n,r,i;this.args.logger.addCorrelationID(null===e||void 0===e?void 0:e.correlationId),this.args.logger.addTransactionId(null===e||void 0===e||null===(t=e.intentContext)||void 0===t?void 0:t.transactionId),this.args.logger.addEntryPoint(null===e||void 0===e||null===(n=e.intentContext)||void 0===n?void 0:n.entryPoint),this.args.logger.addMarket(null===e||void 0===e||null===(r=e.intentContext)||void 0===r?void 0:r.market),this.args.logger.addIsZeroTerm(0===(null===e||void 0===e||null===(i=e.intentContext)||void 0===i?void 0:i.mentionLength))},e.searchFromHostInitial=function(e,t){this.paneSessionId=t,this.wsRequest=e,this.executeSearchAction()},e.prefetchZeroTerm=function(e,t,n,r,i,o){if(this.setupFeatureGates(e),this.featureGates.ShowDebugInfo&&this.args.logger.enableConsoleSink(),!this.featureGates.EnableClientSideRendering){this.args.logger.logEvent("prefetchZeroTerm",0,p.Info,i,f.CriticalBusinessImpact);var a={selection:{neighborhood:"",mentionLength:0,mentionStart:0},entryPoint:y.SmartLookupEntryPoint.Prefetch,queryTimestamp:Date.now(),launchData:{landingTab:i,data:o}};this.searchRequest=a;var s=wt(a,e,n,!0,e.appCorrelationId,void 0);this.keepConnectionAlive=r,this.zeroTermCaches.set(i,null),this.searchFromHostInitial(s,e.sessionId)}},e.actionHandler=function(e){var t=this;try{if(!e)return;switch(e.actionType){case y.ActionType.PaneReady:this.onPaneReady();break;case y.ActionType.PaneHydrated:this.onPaneHydrated();break;case y.ActionType.SSRHtmlReady:this.onPaneRendered();break;case y.ActionType.Reset:this.executePaneResetAction();break;case y.ActionType.InsertOnlinePicture:this.insertOnlinePicture(e.data);break;case y.ActionType.InsertHtmlText:this.insertHtmlText(e.data);break;case y.ActionType.ExecuteCommand:this.executeCommand(e.data);break;case y.ActionType.OpenUrlInBrowser:this.openUrlInBrowser(e.data);break;case y.ActionType.NavigateToPane:this.navigateToPane(e.data);break;case y.ActionType.BrowseFiles:this.browseFiles();break;case y.ActionType.GetAllParagraphsInDocumentRequest:this.getAllParagraphsInDocument(e.transactionId,e.paneSessionId);break;case y.ActionType.SelectRangeInDocument:this.selectRange(e.data);break;case y.ActionType.SearchInDocumentRequestV2:this.searchInDocumentV2(e.data,(function(n){var r={actionType:y.ActionType.SearchInDocumentResponse,data:n,transactionId:e.transactionId,paneSessionId:e.paneSessionId,channelId:y.ChannelId.SmartLookup};t.args.messenger.executeActionSync(r)}));break;case y.ActionType.HighlightInDocument:this.highlight(e.data);break;case y.ActionType.SelectNextPrevHighlightRequest:this.selectNextPrevHighlight(e.data,e.transactionId,e.paneSessionId);break;case y.ActionType.GetDocumentRevisionRequest:this.retrieveDocumentRevision(e.transactionId,e.paneSessionId);break;case y.ActionType.GetDocumentSelectionRequest:this.getDocumentSelection(e.transactionId,e.paneSessionId);break;case y.ActionType.ClearDocumentSelection:this.clearDocumentSelection();break;case y.ActionType.GetCurrentSelectionRequest:this.retrieveCurrentSelection(e.transactionId,e.paneSessionId);break;case y.ActionType.InsertContentFromStreamUrl:this.insertContentFromStreamUrl(e.data);break;case y.ActionType.Telemetry:case y.ActionType.ApplicationPropertiesRequest:case y.ActionType.SmartLookupApplicationInterface:case y.ActionType.GetAuthToken:case y.ActionType.ResizePane:break;case y.ActionType.Search:this.wsRequest=JSON.parse(e.data),e.data=this.wsRequest,this.args.logger.addTransactionId(null===e||void 0===e?void 0:e.transactionId),this.searchCore(e,!0);break;case y.ActionType.SendFollowUpSearchRequest:this.args.logger.addCorrelationID(e.data),this.intentServiceProxy.SendFollowupSearchRequest(e.data);break;case y.ActionType.OpenPrivacySettings:this.openPrivacySettings();break;case y.ActionType.GetCommandMetadata:this.getCommandMetadata(e);break;default:this.args.logger.log(562677471,p.Error,"Unsupported Action Type in executeHubAction.",{actionType:e.actionType})}}catch(Zn){this.args.logger.log(562677472,p.Error,"Exception while processing action.",{actionType:e.actionType,err:JSON.stringify(Zn,Object.getOwnPropertyNames(Zn))},Zn)}},e.isApprovedOrigin=function(e){return!(!e||!(window.location.origin===e||this.originChecker&&this.originChecker.test(e)))||(this.args.logger.log(562677473,p.Error,"Message received from unapproved origin.",{origin:e,ownOrigin:window.location.origin,approvedOriginPattern:this.args.configurationProvider.approvedOriginPattern}),!1)},e.shouldUpdateTarget=function(e){return e.actionType===y.ActionType.PaneReady||e.actionType===y.ActionType.ApplicationPropertiesRequest},e.executeSearchAction=function(){var e={actionType:y.ActionType.Search,data:this.wsRequest,transactionId:this.wsRequest.correlationId,paneSessionId:this.paneSessionId};this.searchCore(e,!1)},e.resetDocumentIndex=function(){this.inDocSearchIndexId=null,this.inDocSearchMachineId=null,this.inDocSearchIndexExpiryTime=null},e.searchCore=function(e,t){this.searchEntry=e,this.searchResults=[],this.localSearchResults=null;var n=this.wsRequest.payload;if(this.resetLoggerProperties(n),!this.previousTransactionIds.has(null===e||void 0===e?void 0:e.transactionId)){var r,i,o=!this.currentTransactionId||this.currentTransactionId!==(null===e||void 0===e?void 0:e.transactionId)||!this.currentCorrelationId||this.currentCorrelationId!==(null===n||void 0===n?void 0:n.correlationId);if(o)this.previousTransactionIds.add(this.currentTransactionId),this.currentTransactionId=null===e||void 0===e?void 0:e.transactionId,this.currentCorrelationId=null===n||void 0===n?void 0:n.correlationId,this.intentServiceProxy.ResetRequestQueue(null===e||void 0===e?void 0:e.transactionId,null===n||void 0===n?void 0:n.intentContext,y.FeatureGates.ChangeGate(this.featureGates,y.ChangeGates.EnableWebsocketCustomCompression)),y.FeatureGates.ChangeGate(this.featureGates,y.ChangeGates.EnableEarlyLocalInDocRequest)&&this.isInDocRequested(n)&&this.handleInDocLocalSearch(n,this.wsRequest.correlationId),this.canUsePreFetchedResponse(t,n)&&(this.args.logger.logEvent("LaunchWithCache",0,p.Info,"The Serplet is launched with zeroterm cache",f.CriticalBusinessImpact),(i=this.searchResults).push.apply(i,this.zeroTermCaches.get(this.searchRequest.launchData.landingTab).searchResponses),this.paneState===y.PaneState.Loading&&this.notifyPaneWithSearchResults()),null!==(r=this.featureGates)&&void 0!==r&&r.EnableCrossMachineCIS&&this.validateIndexAndUpdateSearchRequest(n);else this.updateSearchRequestForIndoc(n);this.intentServiceProxy.ProcessRequest(e,o),o&&(this.handleDocIndexBuild(n),this.handleInDocRequest(n),t||this.notifyPaneWithNewSearch())}},e.canUsePreFetchedResponse=function(e,t){return!e&&this.isEmptyQuery(t.intentContext.query)&&this.searchRequest.launchData&&!!this.zeroTermCaches.get(this.searchRequest.launchData.landingTab)},e.isDocIndexFailed=function(){return this.inDocSearchIndexId===T.InDocSearchSpecialDocIds.DocumentContentFetchFailed||this.inDocSearchIndexId===T.InDocSearchSpecialDocIds.ServiceFailed},e.validateIndexAndUpdateSearchRequest=function(e){var t;if(this.searchRequest.entryPoint===y.SmartLookupEntryPoint.Prefetch)return!0;var n=this.executeGetDocumentRevision();return null!==(t=this.featureGates)&&void 0!==t&&t.EnableCrossMachineCIS&&!(this.inDocSearchIndexExpiryTime&&this.inDocSearchIndexExpiryTime>new Date)||n&&(n!==this.documentRevision||!this.inDocSearchIndexId||this.isDocIndexFailed())?(this.documentRevision=n,this.resetDocumentIndex(),!1):(this.sendSearchEvent("InDocSkipped"),this.args.logger.logEvent("InDocDebug",556021960,p.Info,"Revision up to date: revision: "+n+", inDocSearchIndexId: "+this.inDocSearchIndexId,f.CriticalBusinessImpact),this.updateSearchRequestForIndoc(e),!0)},e.updateSearchRequestForIndoc=function(e){var t;null!==(t=this.featureGates)&&void 0!==t&&t.EnableCrossMachineCIS&&(e.intentContext.inDocSearchIndexId=this.inDocSearchIndexId,e.intentContext.inDocSearchMachineId=this.inDocSearchMachineId,e.intentContext.documentRevision=this.documentRevision)},e.handleDocIndexBuild=function(e){var t,n=this;if(!this.isDocIndexBuildDesired(e))return this.sendSearchEvent("InDocSkipped"),void this.args.logger.logEvent("InDocDebug",556021959,p.Info,"DocIndexBuild is not desired",f.CriticalBusinessImpact);if(null!==(t=this.featureGates)&&void 0!==t&&t.EnableCrossMachineCIS){if(this.inDocSearchIndexId)return}else if(this.validateIndexAndUpdateSearchRequest(e))return;this.featureGates.EnableALDocumentContentExtraction?setTimeout((function(){n.augloopDocContentFetchActivity=n.args.logger.createActivity("GetDocumentContentFromAugloop",f.CriticalBusinessImpact),n.executeSubmitDocumentContentExtractionSignal()}),0):setTimeout((function(){n.sendDocumentBuildRequest(e)}),0)},e.isDocIndexBuildDesired=function(e){var t,n;return(null===(t=e.intentContext)||void 0===t||null===(n=t.flights)||void 0===n?void 0:n.EnableInDocumentSearch)||a.IsFeatureAvailable(i.ZeroTermKPE,e.intentContext.platform,e.intentContext.app)},e.isInDocRequested=function(e){var t,n;return(null===(t=e.intentContext)||void 0===t||null===(n=t.flights)||void 0===n?void 0:n.EnableInDocumentSearch)&&this.searchRequest.entryPoint!==y.SmartLookupEntryPoint.Prefetch&&e.providerContexts.some((function(e){return e.providerId===T.QnaProviderIdentifier.Id}))},e.handleInDocRequest=function(e){var t=this;if(this.isInDocRequested(e)){if(null!==this.inDocSearchIndexId){var n=this.getInDocSearchAction(e);this.intentServiceProxy.ProcessRequest(n,!1),this.sendSearchEvent("InDoc")}y.FeatureGates.ChangeGate(this.featureGates,y.ChangeGates.EnableEarlyLocalInDocRequest)||setTimeout((function(){t.handleInDocLocalSearch(e,t.wsRequest.correlationId)}),0)}},e.handleInDocLocalSearch=function(e,t){var n,r,i,o=this;if(this.isEmptyQuery(e.intentContext.query))this.handleInLocalSearchResults({results:[],totalResultCount:0,hasTooManyResults:!1},t);else{var a=e.providerContexts.find((function(e){return e.providerId===T.QnaLocalProviderIdentifier.Id})),s={matchCase:null!==(n=null===a||void 0===a?void 0:a.matchCase)&&void 0!==n&&n,matchWholeWordOnly:null!==(r=null===a||void 0===a?void 0:a.matchWholeWordOnly)&&void 0!==r&&r,totalResultLimit:null!==(i=null===a||void 0===a?void 0:a.totalResultLimit)&&void 0!==i?i:200,query:e.intentContext.query};this.searchInDocumentV2(s,(function(e){return o.handleInLocalSearchResults(e,t)}))}},e.handleInLocalSearchResults=function(e,t){if(t===this.wsRequest.correlationId){var n=this.wsRequest.payload;this.localSearchResults={results:e,query:n.intentContext.query,documentRevision:this.documentRevision,correlationId:n.intentContext.transactionId},this.notifyPaneWithLocalSearchResults();var r=this.getInDocLocalSearchAction(n,e);this.intentServiceProxy.ProcessRequest(r,!1)}},e.getInDocSearchAction=function(e){return{actionType:y.ActionType.Search,data:kt(e,this.inDocSearchIndexId,this.documentRevision),transactionId:this.wsRequest.correlationId,paneSessionId:this.paneSessionId}},e.getInDocLocalSearchAction=function(e,t){return{actionType:y.ActionType.Search,data:Ot(e,t,this.documentRevision),transactionId:this.wsRequest.correlationId,paneSessionId:this.paneSessionId}},e.isEmptyQuery=function(e){return!e||0===e.length},e.areDocContentParamsValid=function(e){var t,n,r;return e&&(null===(t=e.documentContentKey)||void 0===t?void 0:t.length)>0&&(null===(n=e.dataCenterEndpoint)||void 0===n?void 0:n.length)>0&&(null===(r=e.documentContentTableName)||void 0===r?void 0:r.length)>0},e.hasAugloopDocContentFetchFailed=function(e){return(null===e||void 0===e?void 0:e.documentContentKey)!==T.InDocSearchSpecialDocIds.DocumentTooLong&&(null===e||void 0===e?void 0:e.documentContentKey)!==T.InDocSearchSpecialDocIds.DocumentTooShort&&!this.areDocContentParamsValid(e)},e.getSpecialDocIdIfAny=function(e,t){return(null===e||void 0===e?void 0:e.length)>T.InDocSearchDocumentCharacterCountUpperBound?T.InDocSearchSpecialDocIds.DocumentTooLong:(null===e||void 0===e?void 0:e.length)<T.InDocSearchDocumentCharacterCountLowerBound?T.InDocSearchSpecialDocIds.DocumentTooShort:t&&t in T.InDocSearchSpecialDocIds?t:void 0},e.buildDocRequest=function(e,t,n,r){if(!this.featureGates.EnableALDocumentContentExtraction||this.hasAugloopDocContentFetchFailed(r)){var i=this.args.logger.createActivity("GetDocumentContentFromClient",f.CriticalBusinessImpact),o=this.executeGetAllParagraphsInDocument();n=o?o.join("\n"):null,i.end()}var a=this.getSpecialDocIdIfAny(n,null===r||void 0===r?void 0:r.documentContentKey),s={market:e.intentContext.market,uiLanguage:e.intentContext.uiLanguage,uiLanguageLcid:e.intentContext.uiLanguageLcid};return{docId:a,correlationId:e.correlationId,inDocServerAction:t,docContent:a?null:n,docContentParams:a?null:r,languageInfo:s,revision:this.documentRevision,sessionId:e.intentContext.sessionId,flights:e.intentContext.flights,machineId:null}},e.shouldIssueIndexBuildRequest=function(e){return!!e.docContent||!!e.docContentParams||!!e.docId},e.sendDocumentBuildRequest=function(e,t,n,r){if(void 0===t&&(t=T.InDocSearchExecutionPlan.BuildIndex),!this.intentServiceProxy)return this.sendSearchEvent("InDocSkipped"),void this.args.logger.error(562677474,"Unexpected call to sendDocumentBuildRequest with missing intentServiceProxy!");var i=this.buildDocRequest(e,t,n,r);if(this.shouldIssueIndexBuildRequest(i)){var o={messageType:T.WSMessageType.InDocSearchRequest,correlationId:i.correlationId,payload:i},a={actionType:y.ActionType.Search,transactionId:o.correlationId,data:o,paneSessionId:this.paneSessionId};this.intentServiceProxy.ProcessRequest(a,!1),this.sendSearchEvent("InDocIndex")}else this.sendSearchEvent("InDocSkipped"),this.args.logger.warn(556021961,"No document content or no document params ready")},e.insertContentIntoObjectStore=function(e,t){var n=this.wsRequest.payload;this.sendDocumentBuildRequest(n,T.InDocSearchExecutionPlan.InsertContentToObjectStore,e,t)},e.clearSearch=function(){this.searchRequest=void 0},e.executePaneResetAction=function(){this.clearSearch()},e.onPaneOpen=function(){this.paneState=y.PaneState.Opened,this.args.logger.logEvent("OnPaneOpened",0,p.Info,"Search pane is opened",f.CriticalBusinessImpact)},e.onPaneClose=function(){if(this.args.logger.logEvent("OnPaneClosed",0,p.Info,this.paneState,f.CriticalBusinessImpact),y.PaneState[this.paneState]!==y.PaneState.Interactive){var e=this.args.logger.createActivity("LaunchPaneCanceled",f.CriticalBusinessImpact);e.addDataField("PaneSessionId",this.searchEntry.paneSessionId,g.String,h.SystemMetadata),e.addDataField("PaneStateOnClosing",y.PaneState[this.paneState],g.String,h.SystemMetadata),e.end()}this.paneState=y.PaneState.Closed},e.onPaneReady=function(){this.args.logger.logEvent("OnPaneReady",0,p.Info,"Search pane is ready",f.CriticalBusinessImpact),this.paneState=y.PaneState.Loading,this.notifyPaneWithSearchResults()},e.onPaneRendered=function(){this.args.logger.logEvent("OnPaneRendered",0,p.Info,"Search pane is rendered",f.CriticalBusinessImpact),this.paneState=y.PaneState.Rendered},e.onPaneHydrated=function(){(this.appProperties.isClientSideRendering||this.paneState===y.PaneState.Loading||this.paneState===y.PaneState.Rendered)&&(this.args.logger.logEvent("OnPaneHydrated",0,p.Info,"Search pane is hydrated",f.CriticalBusinessImpact),this.paneState=y.PaneState.Interactive,this.notifyPaneWithNewSearch(),this.notifyPaneWithSearchResults(),this.notifyPaneWithLocalSearchResults())},e.insertOnlinePicture=function(e){this.args.executors.InsertContentExecutor&&this.args.executors.InsertContentExecutor.insertOnlinePicture(e)},e.insertContentFromStreamUrl=function(e){this.args.executors.InsertContentExecutor&&this.args.executors.InsertContentExecutor.insertContentFromStreamUrl(e)},e.insertHtmlText=function(e){this.args.executors.InsertContentExecutor&&this.args.executors.InsertContentExecutor.insertHtmlText(e)},e.getAllParagraphsInDocument=function(e,t){var n=this.executeGetAllParagraphsInDocument();if(n){var r={actionType:y.ActionType.GetAllParagraphsInDocumentResponse,data:n,transactionId:e,paneSessionId:t,channelId:y.ChannelId.SmartLookup};this.args.messenger.executeActionSync(r)}},e.executeGetAllParagraphsInDocument=function(){return this.args.executors.DocumentContentExecutor?this.args.executors.DocumentContentExecutor.getAllParagraphsInDocument():null},e.executeSubmitDocumentContentExtractionSignal=function(){this.args.executors.DocumentContentExecutor&&this.args.executors.DocumentContentExecutor.submitDocumentContentExtractionSignal()},e.selectRange=function(e){this.args.executors.DocumentContentExecutor&&this.args.executors.DocumentContentExecutor.selectRange(e.startParagraphIndex,e.startParagraphOffset,e.endParagraphIndex,e.endParagraphOffset,e.clickedPassage)},e.searchInDocumentV2=function(e,t){this.args.executors.DocumentContentExecutor&&this.args.executors.DocumentContentExecutor.searchWithParamV2(e,t)},e.retrieveCurrentSelection=function(e,t){var n=this.executeGetCurrentSelection();if(n){var r={actionType:y.ActionType.GetCurrentSelectionResponse,data:n,transactionId:e,paneSessionId:t,channelId:y.ChannelId.SmartLookup};this.args.messenger.executeActionSync(r)}},e.retrieveDocumentRevision=function(e,t){var n=this.executeGetDocumentRevision();if(n){var r={actionType:y.ActionType.GetDocumentRevisionResponse,data:n,transactionId:e,paneSessionId:t,channelId:y.ChannelId.SmartLookup};this.args.messenger.executeActionSync(r)}},e.executeGetDocumentRevision=function(){var e=null;return this.args.executors.DocumentContentExecutor&&(e=this.args.executors.DocumentContentExecutor.getRevision()),null===e&&this.args.logger.error(562677475,"Failed to get document revision."),e},e.executeGetCurrentSelection=function(){var e=null;return this.args.executors.DocumentContentExecutor&&(e=this.args.executors.DocumentContentExecutor.getSelectedText()),null===e&&this.args.logger.error(562677504,"Failed to get current selection."),e},e.getDocumentSelection=function(e,t){if(this.args.executors.DocumentContentExecutor){var n=this.args.executors.DocumentContentExecutor.getDocumentSelection(),r={actionType:y.ActionType.GetDocumentSelectionResponse,data:n,transactionId:e,paneSessionId:t,channelId:y.ChannelId.SmartLookup};this.args.messenger.executeActionSync(r)}},e.clearDocumentSelection=function(){this.args.executors.DocumentContentExecutor&&this.args.executors.DocumentContentExecutor.clearDocumentSelection()},e.highlight=function(e){if(this.args.executors.DocumentContentExecutor){var t=this.args.executors.DocumentContentExecutor;"string"===typeof e?t.highlight(e):t.highlightWithParam(e)}},e.selectNextPrevHighlight=function(e,t,n){if(this.args.executors.DocumentContentExecutor){var r=this.args.executors.DocumentContentExecutor.selectNextPrevHighlight(e),i={actionType:y.ActionType.SelectNextPrevHighlightResponse,data:r,transactionId:t,paneSessionId:n,channelId:y.ChannelId.SmartLookup};this.args.messenger.executeActionSync(i)}},e.openUrlInBrowser=function(e){var t=null;try{t=window.open(e)}catch(n){throw this.args.logger.log(562677505,p.Error,"Issue opening url in a new window",{url:e,window:null==window?"windowAbsent":"windowPresent",open:null==window.open?"openMethodAbsent":"openMethodPresent"},n),n}null===t&&this.args.logger.log(562677506,p.Warn,"Host Runtime failed to open new window with window.open")},e.executeCommand=function(e){this.args.executors.SerpletExecutor&&this.args.executors.SerpletExecutor.executeCommand(e)},e.navigateToPane=function(e){switch(e.TargetPane){case s.Feedback:var t=e;this.openFeedbackPane(t);break;case s.FindReplace:if(this.featureGates.EnableOpenFindReplaceTaskPaneV2){var n=e;this.openFindReplaceTaskPaneV2(n)}else{var r=e;this.openFindReplaceTaskPane(r.Query)}break;case s.Find:var i=e;this.openFindTaskPane(i.Query);break;case s.Help:var o=e;this.openHelpTaskPane(o.AssetId);break;case s.Navigation:this.openNavigationPane();break;default:this.args.logger.log(562677507,p.Error,"Unsupported TargetPane Type in navigateToPane",{targetPane:e,TargetPane:s})}},e.openFeedbackPane=function(e){this.args.executors.SerpletExecutor&&this.args.executors.SerpletExecutor.openFeedbackPane(e)},e.openFindReplaceTaskPane=function(e){this.args.executors.SerpletExecutor&&this.args.executors.SerpletExecutor.openFindReplaceTaskPane(e)},e.openFindReplaceTaskPaneV2=function(e){this.args.executors.SerpletExecutor&&this.args.executors.SerpletExecutor.openFindReplaceTaskPaneV2(e)},e.openFindTaskPane=function(e){this.args.executors.SerpletExecutor&&this.args.executors.SerpletExecutor.openFindTaskPane(e)},e.openHelpTaskPane=function(e){this.args.executors.SerpletExecutor&&this.args.executors.SerpletExecutor.openHelpTaskPane(e)},e.openNavigationPane=function(){this.args.executors.SerpletExecutor&&this.args.executors.SerpletExecutor.openNavigationPane()},e.openPrivacySettings=function(){this.args.executors.SerpletExecutor&&this.args.executors.SerpletExecutor.openPrivacySettings()},e.getCommandMetadata=function(e){if(this.args.executors.SerpletExecutor){var t=e.data,n=this.args.executors.SerpletExecutor.getCommandMetadata(t),r=Object.assign({},e,{data:n});this.args.messenger.executeActionSync(r)}},e.browseFiles=function(){this.args.executors.SerpletExecutor&&this.args.executors.SerpletExecutor.browseFiles()},e.notifyPaneWithNewSearch=function(){var e=Object.assign({},this.searchEntry,{data:this.searchRequest});this.args.messenger.executeActionSync(e)},e.notifyPaneWithSearchResult=function(e){var t,n,r,i,o=e.payload;null!==o&&void 0!==o&&null!==(t=o.renderedResults)&&void 0!==t&&t.html&&null!==o&&void 0!==o&&null!==(n=o.renderedResults)&&void 0!==n&&n.state?(this.notifyPaneWithSearchResultInternal(e,"SSR_HTML"),this.notifyPaneWithSearchResultInternal(e,"SSR_State"),this.notifyPaneWithSearchResultInternal(e,"Providers")):null!==o&&void 0!==o&&null!==(r=o.renderedResults)&&void 0!==r&&r.html?this.notifyPaneWithSearchResultInternal(e,"SSR_HTML"):null!==o&&void 0!==o&&null!==(i=o.renderedResults)&&void 0!==i&&i.state?this.notifyPaneWithSearchResultInternal(e,"SSR_State"):this.notifyPaneWithSearchResultInternal(e,"Providers")},e.notifyPaneWithSearchResultInternal=function(e,t){this.sendActionToPane(y.ActionType.ResultsUpdated,e.correlationId,this.searchEntry.paneSessionId,e,t)},e.sendActionToPane=function(e,t,n,r,i){var o=this.args.logger.createActivity("NotifyPaneWithSearchResult",f.CriticalBusinessImpact),a={actionType:e,data:r,transactionId:t,paneSessionId:n,channelId:y.ChannelId.SmartLookup};if(this.args.messenger.executeActionSync(a),this.onHostSkillEventHandler){var s={TransactionId:t,Type:e,CreateTimeUTC:Date.now,PaneSessionId:t,ActionJson:JSON.stringify(r)};this.onHostSkillEventHandler(JSON.stringify(s))}o.addDataField("ActionType",y.ActionType[e],g.String,h.SystemMetadata),o.addDataField("PaneSessionId",this.searchEntry.paneSessionId,g.String,h.SystemMetadata),o.addDataField("CorrelationId",t,g.String,h.SystemMetadata),o.addDataField("responseType",i,g.String,h.SystemMetadata),o.addDataField("PaneState",this.paneState,g.String,h.SystemMetadata),o.end()},e.notifyPaneWithSearchResults=function(){if(this.searchEntry)if(this.paneState!==y.PaneState.Interactive)for(var e,t=Qn(this.searchResults);!(e=t()).done;){var n,r=e.value;null!==r&&void 0!==r&&null!==(n=r.payload)&&void 0!==n&&n.renderedResults&&this.notifyPaneWithSearchResult(r)}else for(;this.searchResults.length>0;){var i=this.searchResults.shift();this.notifyPaneWithSearchResult(i)}},e.notifyPaneWithLocalSearchResults=function(){if(this.paneState===y.PaneState.Interactive&&this.localSearchResults){var e,t={actionType:y.ActionType.InDocFallbackDataReceived,data:this.localSearchResults,transactionId:this.searchEntry.transactionId,paneSessionId:this.searchEntry.paneSessionId,channelId:y.ChannelId.SmartLookup},n=this.args.logger.createActivity("NotifyPaneWithLocalSearchResults",f.CriticalBusinessImpact);n.addDataField("TotalResultCount",null===(e=this.localSearchResults.results)||void 0===e?void 0:e.totalResultCount,g.Int64,h.SystemMetadata),n.end(),this.args.messenger.executeActionSync(t),this.localSearchResults=null}},e.onSearchResult=function(e,t){if(this.searchRequest.entryPoint===y.SmartLookupEntryPoint.Prefetch){var n=this.zeroTermCaches.get(this.searchRequest.launchData.landingTab);n?(n.searchRequest=this.wsRequest,n.searchResponses.push(e)):(n={timestamp:Date.now(),searchRequest:this.wsRequest,searchResponses:[e]},this.zeroTermCaches.set(this.searchRequest.launchData.landingTab,n)),e.payload.moreData||this.keepConnectionAlive||this.intentServiceProxy.CloseConnection(1e3),this.featureGates.isAutoLaunchEnabled&&this.args.executors.SerpletExecutor&&this.args.executors.SerpletExecutor.sendAutoLaunchSearchRequest()}else if(e.messageType===T.WSMessageType.SearchResponse)k.isDocumentIndexUnregistered(e)&&this.resetDocumentIndex(),this.paneState===y.PaneState.Interactive?this.notifyPaneWithSearchResult(e):(this.featureGates.isAutoLaunchEnabled&&this.searchRequest.entryPoint===y.SmartLookupEntryPoint.SmartLookupAutoLaunch&&this.paneState===y.PaneState.Closed&&this.args.executors.SerpletExecutor&&this.args.executors.SerpletExecutor.openSerpletTaskPane(),this.searchResults.push(e),this.paneState===y.PaneState.Loading&&this.notifyPaneWithSearchResults());else if(e.messageType===T.WSMessageType.InDocSearchResponse){var r=this.wsRequest.payload;this.inDocSearchIndexId=e.payload.docId,this.inDocSearchMachineId=e.payload.machineId,e.payload.indexExpiry&&(this.inDocSearchIndexExpiryTime=new Date(e.payload.indexExpiry));var i=this.getInDocSearchAction(r);this.intentServiceProxy.ProcessRequest(i,!1),this.sendSearchEvent("InDoc")}},e.onConnectionClosed=function(){var e;null!==(e=this.featureGates)&&void 0!==e&&e.EnableCrossMachineCIS||this.resetDocumentIndex()},e.onConnectionError=function(e){var t,n,r=this;this.failedRequests.has(e)||(null!==(t=this.featureGates)&&void 0!==t&&t.EnableCrossMachineCIS||this.resetDocumentIndex(),this.failedRequests.add(e),setTimeout((function(){r.failedRequests.delete(e)}),15e3),null!==(n=navigator)&&void 0!==n&&n.onLine?this.sendActionToPane(y.ActionType.ServiceConnectionError,e,this.searchEntry.paneSessionId,{},"ConnectionError"):this.sendActionToPane(y.ActionType.NetworkError,e,this.searchEntry.paneSessionId,{},"NetworkError"))},e.sendSearchEvent=function(e){this.args.logger.logEvent("SearchFromRuntime",0,p.Info,e,f.CriticalBusinessImpact)},t}();window.SmartLookupHostRuntime=Jn},4684:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(1886),t),i(n(2430),t),i(n(3165),t),i(n(1998),t),i(n(3943),t),i(n(5363),t),i(n(2143),t),i(n(6261),t),i(n(7955),t),i(n(2294),t),i(n(2159),t),i(n(1897),t),i(n(5478),t),i(n(6622),t),i(n(2156),t),i(n(209),t),i(n(2557),t),i(n(1130),t),i(n(85),t),i(n(6729),t),i(n(4362),t),i(n(5488),t),i(n(3396),t),i(n(4586),t),i(n(9443),t),i(n(8791),t),i(n(5010),t),i(n(1903),t),i(n(5880),t),i(n(2794),t),i(n(4092),t),i(n(9522),t),i(n(5816),t),i(n(8001),t),i(n(8856),t),i(n(6852),t),i(n(1773),t),i(n(7868),t),i(n(7311),t),i(n(386),t),i(n(5037),t)},1886:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DataSourceType=void 0,(n=t.DataSourceType||(t.DataSourceType={})).Public="Public",n.User="User",n.Tenant="Tenant",n.Uninitalized="Uninitalized"},2430:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderNames=void 0,(n=t.HeaderNames||(t.HeaderNames={})).MachineAffinity="x-officefe",n.OfficeCluster="x-officecluster",n.ProcessId="x-officeprocessid"},3165:function(e,t,n){"use strict";
/**
 * @copyright Microsoft Corporation.  All rights reserved.
 */n(7186),Object.defineProperty(t,"__esModule",{value:!0}),t.transform=void 0,t.transform=function(e,t){for(var n={},r=0,i=Object.keys(e);r<i.length;r++){var o=i[r],a=t(o,e,n);void 0!==a&&(n[o]=a)}return n}},1998:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3943:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3396:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5363:function(e,t){"use strict";var n,r,i,o,a;Object.defineProperty(t,"__esModule",{value:!0}),t.SubdocumentType=t.SearchMethod=t.AltType=t.InDocSearchExecutionPlan=t.InDocSearchSpecialDocIds=t.InDocCrossMachineIndexExpiryInMSDefaultValue=t.InDocCrossMachineIndexExpiryInMSSettingName=t.InDocSearchDocumentCharacterCountLowerBound=t.InDocSearchDocumentCharacterCountUpperBound=t.InDocSearchDocumentPageCountLimit=t.InDocSearchDocumentCharacterEstimatePerPage=t.CisThresholdForSearchMore=void 0,t.CisThresholdForSearchMore=15,t.InDocSearchDocumentCharacterEstimatePerPage=5e3,t.InDocSearchDocumentPageCountLimit=20,t.InDocSearchDocumentCharacterCountUpperBound=t.InDocSearchDocumentCharacterEstimatePerPage*t.InDocSearchDocumentPageCountLimit,t.InDocSearchDocumentCharacterCountLowerBound=1,t.InDocCrossMachineIndexExpiryInMSSettingName="CrossMachineIndexExpiry",t.InDocCrossMachineIndexExpiryInMSDefaultValue=72e5,(a=t.InDocSearchSpecialDocIds||(t.InDocSearchSpecialDocIds={})).ServiceFailed="ServiceFailed",a.DocumentContentFetchFailed="DocumentContentFetchFailed",a.DocumentTooLong="DocumentTooLong",a.DocumentTooShort="DocumentTooShort",a.CurrentSession="CurrentSession",(o=t.InDocSearchExecutionPlan||(t.InDocSearchExecutionPlan={})).BuildIndex="build_index",o.BuildIndexCost="build_index_cost",o.ClearIndex="clear_index",o.FetchContext="fetch_context",o.FetchDocumentContent="fetch_full_doc_content",o.FetchDocumentMetadata="get_document_metadata",o.FetchZeroTerm="fetch_zeroTerm",o.QuerySuggest="query_suggest",o.StoreZeroTerm="store_zeroTerm",o.TopKSearch="topk_search",o.InsertContentToObjectStore="insert_content_to_objectstore",(i=t.AltType||(t.AltType={}))[i.None=0]="None",i[i.Prefix=1]="Prefix",i[i.Semantic=2]="Semantic",i[i.Undefined=-1]="Undefined",(r=t.SearchMethod||(t.SearchMethod={}))[r.BrutalForceExactMatch=0]="BrutalForceExactMatch",r[r.PrefixTreeExactMatch=1]="PrefixTreeExactMatch",r[r.SingleTermPrefixTreeFuzzySearch=2]="SingleTermPrefixTreeFuzzySearch",r[r.SingleTermSemanticFuzzySearch=3]="SingleTermSemanticFuzzySearch",r[r.MultiTermAdjacency=4]="MultiTermAdjacency",r[r.MultiTermSemanticSimilarity=5]="MultiTermSemanticSimilarity",r[r.SentenceSemanticSimilarity=6]="SentenceSemanticSimilarity",r[r.Undefined=-1]="Undefined",(n=t.SubdocumentType||(t.SubdocumentType={}))[n.Main=0]="Main",n[n.Header=1]="Header",n[n.Footer=2]="Footer",n[n.Comment=3]="Comment",n[n.Textbox=4]="Textbox",n[n.Endnote=5]="Endnote",n[n.Footnote=6]="Footnote"},2143:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CustomInputNames=void 0,(n=t.CustomInputNames||(t.CustomInputNames={})).ZeroTermMenuRequest="ZeroTermMenuRequest",n.DocumentContext="DocumentContext"},6261:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7955:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2294:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2159:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ProviderEnabledStatus=void 0,(n=t.ProviderEnabledStatus||(t.ProviderEnabledStatus={}))[n.Enabled=0]="Enabled",n[n.Disabled=1]="Disabled",n[n.NotSureYet=2]="NotSureYet"},1897:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayCache=t.DictionaryCache=void 0;t.DictionaryCache=function(){this.cacheResponse={}};t.ArrayCache=function(){this.cacheResponse=[]}},5478:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6622:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2156:function(e,t){"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.ProviderErrorType=t.ProviderResultStatus=void 0,(r=t.ProviderResultStatus||(t.ProviderResultStatus={})).Invalid="Invalid",r.Success="Success",r.Error="Error",r.Pending="Pending",r.NoResult="NoResult",r.Disabled="Disabled",r.Incomplete="Incomplete",r.Deferred="Deferred",(n=t.ProviderErrorType||(t.ProviderErrorType={})).NotSet="NotSet",n.Timeout="Timeout",n.ExecutionStartTimeout="ExecutionStartTimeout",n.NetworkError="NetworkError",n.ServiceError="ServiceError",n.ParsingError="ParsingError",n.AuthenticationError="AuthenticationError",n.UnhandledException="UnhandledException",n.ShouldNotExecuteError="ShouldNotExecuteError",n.ContextValidationError="ContextValidationError",n.NonCompliant="NonCompliant"},209:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2557:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1130:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},85:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6729:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4362:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5488:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4586:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9443:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5010:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1903:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5880:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2794:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9522:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5816:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8001:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6852:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8856:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4092:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1773:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8791:function(e,t){"use strict";var n,r,i,o,a,s,u,c,d,l,p,h,f,v,g,y,m,S,I,T,R;Object.defineProperty(t,"__esModule",{value:!0}),t.ContextLoggingProviderIdentifier=t.FileInsightsProviderIdentifier=t.SuggestedCommandsProviderIdentifier=t.TemplatesProviderIdentifier=t.ZeroTermMenuProviderIdentifier=t.KeyPhrasesProviderIdentifier=t.QnaQuerySuggestProviderIdentifier=t.QnaLocalProviderIdentifier=t.QnaProviderIdentifier=t.DynamicsProviderIdentifier=t.HelpVideoProviderIdentifier=t.HelpSocProviderIdentifier=t.HelpProviderIdentifier=t.EnrichmentProviderIdentifier=t.EntitySuggestionProviderIdentifier=t.InsightsProviderIdentifier=t.PremiumImagesProviderIdentifier=t.ImagesProviderIdentifier=t.SubstrateProviderIdentifier=t.DictionaryProviderIdentifier=t.TapProviderIdentifier=void 0,(R=t.TapProviderIdentifier||(t.TapProviderIdentifier={})).TAP_SEARCH_QF_PROVIDER_ID="Provider.Tap.Search.QF",R.TAP_SEARCH_OLS_PROVIDER_ID="Provider.Tap.Search.OLS",R.TAP_SEARCH_OLS_ZERO_TERM_PROVIDER_ID="Provider.Tap.Search.OLS.ZeroTerm",R.TAP_SEARCH_SP_PROVIDER_ID="Provider.Tap.Search.SP",R.TAP_SEARCH_3S_PROVIDER_ID="Provider.Tap.Search.3S",R.TAP_SEARCH_ZERO_TERM_CACHE_PROVIDER_ID="Provider.Tap.Search.ZeroTerm.Cache",R.DOCUMENT_ID="EntityGroup.Tap.Document",(T=t.DictionaryProviderIdentifier||(t.DictionaryProviderIdentifier={})).DICTIONARY_PROVIDER_ID="Provider.UCI.Dictionary",T.DICTIONARY_WORDS_GROUP_ID="EntityGroup.UCI.Dictionary.Words",T.DICTIONARY_SUGGESTED_WORDS_GROUP_ID="EntityGroup.UCI.Dictionary.SuggestedWords",(I=t.SubstrateProviderIdentifier||(t.SubstrateProviderIdentifier={})).SUBSTRATE_PROVIDER_ID="Provider.Substrate",I.ACRONYM_GROUP_ID="EntityGroup.Substrate.Acronym",I.PEOPLE_GROUP_ID="EntityGroup.Substrate.People",I.TOPIC_GROUP_ID="EntityGroup.Substrate.Topic",I.MESSAGE_GROUP_ID="EntityGroup.Substrate.Message",I.NOTE_GROUP_ID="EntityGroup.Substrate.Note",(S=t.ImagesProviderIdentifier||(t.ImagesProviderIdentifier={})).IMAGES_PROVIDER_ID="Provider.UCI.Images",S.IMAGES_ID="EntityGroup.UCI.Images.Images",(m=t.PremiumImagesProviderIdentifier||(t.PremiumImagesProviderIdentifier={})).PREMIUM_IMAGES_PROVIDER_ID="Provider.UCI.PremiumImages",m.PREMIUM_IMAGES_ID="EntityGroup.UCI.Images.PremiumImages",(y=t.InsightsProviderIdentifier||(t.InsightsProviderIdentifier={})).INSIGHTS_PROVIDER_ID="Provider.UCI.Insights",y.BINGANSWER_COMPUTATION_ID="EntityGroup.UCI.Insights.BingAnswer.Computation",y.BINGANSWER_CURRENCY_ID="EntityGroup.UCI.Insights.BingAnswer.Currency",y.BINGANSWER_FACTS_ID="EntityGroup.UCI.Insights.BingAnswer.Facts",y.BINGANSWER_FINANCE_ID="EntityGroup.UCI.Insights.BingAnswer.Finance",y.BINGANSWER_NEWS_ID="EntityGroup.UCI.Insights.BingAnswer.News",y.BINGANSWER_WEATHER_ID="EntityGroup.UCI.Insights.BingAnswer.Weather",y.DICTIONARY_ID="EntityGroup.UCI.Insights.Dictionary",y.ENTITIES_ID="EntityGroup.UCI.Insights.Entities",y.IMAGES_ID="EntityGroup.UCI.Insights.Images",y.PACKAGETRACKING_ID="EntityGroup.UCI.Insights.PackageTrackingAnswer",y.PREMIUM_IMAGES_ID="EntityGroup.UCI.Insights.PremiumImages",y.WEBRESULTS_ID="EntityGroup.UCI.Insights.WebResults",y.WIKIPEDIARESULTS_ID="EntityGroup.UCI.Insights.WikipediaResults",(g=t.EntitySuggestionProviderIdentifier||(t.EntitySuggestionProviderIdentifier={})).Id="Provider.EntitySuggestion",g.DataTypeId="EntityGroup.EntitySuggestion.Results",(v=t.EnrichmentProviderIdentifier||(t.EnrichmentProviderIdentifier={})).Id="Provider.Enrichment",v.DataTypeId="EntityGroup.Enrichment.Results",v.DisambiguationDataTypeId="EntityGroup.Enrichment.DisambiguationResults",v.StockDataTypeId="EntityGroup.Enrichment.StockResults",v.ZeroTermDataTypeId="EntityGroup.Enrichment.ZeroTermResults",(f=t.HelpProviderIdentifier||(t.HelpProviderIdentifier={})).Id="Provider.UCI.Help",f.DataTypeId="EntityGroup.UCI.Help.Support",(h=t.HelpSocProviderIdentifier||(t.HelpSocProviderIdentifier={})).Id="Provider.UCI.HelpSoc",h.DataTypeId="EntityGroup.UCI.HelpSoc.Support",(p=t.HelpVideoProviderIdentifier||(t.HelpVideoProviderIdentifier={})).Id="Provider.UCI.HelpVideos",p.DataTypeId="EntityGroup.UCI.Help.Videos",(l=t.DynamicsProviderIdentifier||(t.DynamicsProviderIdentifier={})).Id="Provider.Dynamics",l.DataTypeId="Provider.Dynamics.Contact",(d=t.QnaProviderIdentifier||(t.QnaProviderIdentifier={})).Id="Provider.Qna",d.DataTypeId="Provider.Qna.Results",d.QnaDataTypeId="Provider.Qna.QnaResults",(c=t.QnaLocalProviderIdentifier||(t.QnaLocalProviderIdentifier={})).Id="Provider.QnaLocal",c.DataTypeId="Provider.QnaLocal.Results",(u=t.QnaQuerySuggestProviderIdentifier||(t.QnaQuerySuggestProviderIdentifier={})).Id="Provider.QnaQuerySuggest",u.DataTypeId="Provider.QnaQuerySuggest.Results",(s=t.KeyPhrasesProviderIdentifier||(t.KeyPhrasesProviderIdentifier={})).Id="Provider.KeyPhrases",s.DataTypeId="Provider.KeyPhrases.Results",(a=t.ZeroTermMenuProviderIdentifier||(t.ZeroTermMenuProviderIdentifier={})).Id="Provider.ZeroTermMenu",a.DataTypeId="Provider.ZeroTermMenu.Results",(o=t.TemplatesProviderIdentifier||(t.TemplatesProviderIdentifier={})).Id="Provider.Templates",o.DataTypeId="Provider.Templates.Results",(i=t.SuggestedCommandsProviderIdentifier||(t.SuggestedCommandsProviderIdentifier={})).Id="Provider.SuggestedCommands",i.DataTypeId="Provider.SuggestedCommands.Results",(r=t.FileInsightsProviderIdentifier||(t.FileInsightsProviderIdentifier={})).ConversationsId="Provider.FileInsights.Conversations",r.ConversationsDataTypeId="Provider.FileInsights.Conversations.Results",(n=t.ContextLoggingProviderIdentifier||(t.ContextLoggingProviderIdentifier={})).Id="Provider.ContextLogging",n.DataTypeId="Provider.ContextLogging.Results"},7868:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ResultGroupType=void 0,(n=t.ResultGroupType||(t.ResultGroupType={})).FILES="Files",n.ENTITYSUGGESTION="EntitySuggestion",n.COMMANDSUGGESTION="CommandSuggestion",n.HELP="Help",n.ENTITYKNOWLEDGE="EntityKnowledge",n.ANSWERKNOWLEDGE="AnswerKnowledge",n.DICTIONARYKNOWLEDGE="DictionaryKnowledge",n.KNOWLEDGE="Knowledge",n.ENTERPRISEKNOWLEDGE="EnterpriseKnowledge",n.PICTURES="Pictures",n.MIX="Mix",n.WEB="Web",n.QNA="Qna",n.RICHENTITY="RichEntity",n.MESSAGES="Messages",n.NOTES="Notes",n.FILEINSIGHTS="FileInsights",n.UNKNOWN="Unknown"},7311:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.RequestType=void 0,(n=t.RequestType||(t.RequestType={})).SearchIntentCache="SearchIntentCache",n.ProviderCache="ProviderCache",n.DocumentContentExtraction="DocumentContentExtraction"},386:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.replFdPrefix=t.fdPrefix=t.certificateConfigName=t.pingFrequencyInMs=t.requestTimeoutInMs=t.documentContentTableName=t.skiNamespace=void 0,t.skiNamespace="SKI",t.documentContentTableName="DocumentContent",t.requestTimeoutInMs=1e3,t.pingFrequencyInMs=30,t.certificateConfigName="ObjectStoreCertificateName",t.fdPrefix="ObjectStoreFDPrefix",t.replFdPrefix="ObjectStoreReplFDPrefix"},5037:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.WSMessageType=void 0,(n=t.WSMessageType||(t.WSMessageType={})).SearchRequest="SearchRequest",n.SearchResponse="SearchResponse",n.FetchSearchResponse="FetchSearchResponse",n.InDocSearchRequest="InDocSearchRequest",n.InDocSearchResponse="InDocSearchResponse",n.Acknowledge="Acknowledge",n.HandShakeRequest="HandShakeRequest",n.HandShakeResponse="HandShakeResponse",n.Ping="Ping",n.Pong="Pong"},8075:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i,o,a,s,u,c,d,l,p,h,f,v,g,y,m,S,I;function T(e,t,n){if(null==e||!t)throw new TypeError("Cannot convert undefined or null to object");var r=Object(e);for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(n&&(!t[i]||""===t[i]))continue;r[i]=t[i]}return r}function R(){return window.location.href.search("isTestPage")>0}function b(){var e,t;return-1!=(null===(e=navigator.userAgent)||void 0===e?void 0:e.indexOf("Trident"))||-1!=(null===(t=navigator.userAgent)||void 0===t?void 0:t.indexOf("MSIE"))}n.d(t,{ActionType:function(){return A},AgaveMessenger:function(){return M},ApplicationType:function(){return a},ChangeGates:function(){return S},ChannelId:function(){return w},FeatureGates:function(){return D},HostApplication:function(){return h},HostType:function(){return C},InsightsAriaTenantToken:function(){return F},IsTestPage:function(){return R},IsTridentControl:function(){return b},ObjectAssign:function(){return T},PaneState:function(){return y},Platform:function(){return p},ServiceEndpoints:function(){return q},SmartLookupEntryPoint:function(){return i},TabType:function(){return u},getInDocLaunchData:function(){return P},getInDocLaunchQuery:function(){return E}}),n(5098),n(7807),n(3289),n(2981),n(8855),n(5991),n(270),n(8689),n(3373),n(1881),n(4836),n(8127),n(2026),n(4049),n(5979),n(1871),n(3661),(l=i||(i={}))[l.Other=0]="Other",l[l.SearchBoxSearch=1]="SearchBoxSearch",l[l.SearchBoxDictionary=2]="SearchBoxDictionary",l[l.SearchBoxQuickAnswer=3]="SearchBoxQuickAnswer",l[l.SmartLookupRibbon=4]="SmartLookupRibbon",l[l.SmartLookupContextMenu=5]="SmartLookupContextMenu",l[l.Entity=6]="Entity",l[l.Dictionary=7]="Dictionary",l[l.Web=8]="Web",l[l.Pictures=9]="Pictures",l[l.Files=10]="Files",l[l.Bookmarks=11]="Bookmarks",l[l.Help=12]="Help",l[l.ChartRecommendation=13]="ChartRecommendation",l[l.LinkSkill=14]="LinkSkill",l[l.SearchBoxFindInDocument=15]="SearchBoxFindInDocument",l[l.SearchBoxEntity=16]="SearchBoxEntity",l[l.SearchSkill=17]="SearchSkill",l[l.ControlF=18]="ControlF",l[l.RibbonFindButton=19]="RibbonFindButton",l[l.ReuseSlides=20]="ReuseSlides",l[l.Data=21]="Data",l[l.ContextMenuDictionary=22]="ContextMenuDictionary",l[l.ContextMenuSearchSuggestion=23]="ContextMenuSearchSuggestion",l[l.ContextMenuSynonyms=24]="ContextMenuSynonyms",l[l.ContextMenuSearchBoxSearch=25]="ContextMenuSearchBoxSearch",l[l.SearchBoxSearchZeroTerm=26]="SearchBoxSearchZeroTerm",l[l.ContextMenuSearchZeroTerm=27]="ContextMenuSearchZeroTerm",l[l.Note=28]="Note",l[l.SmartLookupAutoLaunch=29]="SmartLookupAutoLaunch",l[l.ContextMenuSmartLookupInSubMenu=30]="ContextMenuSmartLookupInSubMenu",l[l.DataDisambiguate=31]="DataDisambiguate",l[l.LinkFiles=32]="LinkFiles",l[l.SearchBoxNoteL2=33]="SearchBoxNoteL2",l[l.ContextMenuLaunchL2Document=34]="ContextMenuLaunchL2Document",l[l.Prefetch=99]="Prefetch",function(e){e.SearchBox="SearchBox",e.Dictionary="Dictionary",e.ContextMenu="ContextMenu",e.EntityFacts="EntityFacts",e.WordSuggestion="WordSuggestion",e.QnAQuerySuggestion="QnAQuerySuggestion",e.QnAInDocRefresh="QnAInDocRefresh",e.ZeroTermSuggestion="ZeroTermSuggestion",e.AutoRefresh="AutoRefresh",e.BackButton="BackButton"}(o||(o={})),function(e){e[e.SmartLookup=0]="SmartLookup"}(a||(a={})),function(e){e[e.Web=0]="Web",e[e.Help=1]="Help",e[e.Notes=2]="Notes",e[e.Files=3]="Files",e[e.InDoc=4]="InDoc"}(s||(s={})),(d=u||(u={})).All="All",d.Data="Data",d.Define="Define",d.File="File",d.Help="Help",d.Image="Image",d.Indoc="Indoc",d.Slide="Slide",d.Top="Top",d.TermSuggestion="TermSuggestion",d.Web="Web",d.Notes="Notes",d.SuggestedCommands="SuggestedCommands",d.Conversations="Conversations",d.Signage="Signage",d.Unknown="Unknown",// this is current image license selection on Hedwig side
function(e){e.CreativeCommonsLicenseFilterValue="any",e.NoLicenseFilterValue="all"}(c||(c={})),c.CreativeCommonsLicenseFilterValue,function(e){e.Win32="DESKTOP",e.OfficeOnline="WEB",e.Mac="MAC",e.iOS="IOS",e.Android="ANDROID",e.WinRT="WINRT"}(p||(p={})),(I=h||(h={})).Word="WORD",I.PowerPoint="POWERPNT",I.Excel="EXCEL",I.Outlook="OUTLOOK",I.OneNote="ONENOTE",I.Visio="VISIO",I.Local="LOCAL",function(e){e.Perpetual="Perpetual",e.Subscription="Subscription"}(f||(f={})),function(e){e.InvalidSelection="InvalidSelection",e.InvalidOperationInCellEditMode="InvalidOperationInCellEditMode",e.InvalidOperationOnCurrentSelection="InvalidOperationOnCurrentSelection"}(v||(v={})),function(e){e.Invalid="Invalid",e.Success="Success",e.Error="Error",e.Pending="Pending",e.NoResult="NoResult",e.Disabled="Disabled",e.Incomplete="Incomplete",e.Deferred="Deferred"}(g||(g={})),function(e){e.Opened="Opened",e.Loading="Loading",e.Rendered="Rendered",e.Interactive="Interactive",e.Closed="Closed"}(y||(y={})),function(e){e.FirstPaint="SearchPaneStart",e.FirstMeaningfulPaint="ClientRendered",e.Interactive="SmartLookupHydrate",e.Performance="Performance"}(m||(m={})),function(e){e.EnableSearchBoxZTFix="EnableSearchBoxZTFix",e.DisableFocusReset="DisableFocusReset",e.AgaveSubsequentLaunchAI="AgaveSubsequentLaunchAI",e.EnableWebsocketCustomCompression="EnableWebsocketCustomCompression",e.EnableDeferredProviderForIndocHttpFallback="EnableDeferredProviderForIndocHttpFallback",e.PreloadClientJavaScriptForSetupDelivery="PreloadClientJavaScriptForSetupDelivery",e.EnableCacheForZeroTermAndTermWithNeighborhood="EnableCacheForZeroTermAndTermWithNeighborhood",e.EnableCacheForAuthenticatedProviders="EnableCacheForAuthenticatedProviders",e.EnableEarlyLocalInDocRequest="EnableEarlyLocalInDocRequest",e.EnableReduceWebSocketResponseMessageCount="EnableReduceWebSocketResponseMessageCount"}(S||(S={}));var P=function(e){var t=null===e||void 0===e?void 0:e.data;return(null===t||void 0===t?void 0:t.type)===s.InDoc?t:null},E=function(e){var t=P(e);return null===t||void 0===t?void 0:t.query};function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var A,w,C,D=function(){function e(){this.SmartLookupServicePath=void 0,this.UseNextUXVersion=void 0,this.UXBundleVersion=void 0,this.ShowDebugInfo=void 0,this.DebugCommands=void 0,this.ChangeGates=void 0,this.IsAgave=void 0,this.EnableClientSideRendering=void 0,this.SearchFromPane=void 0,this.IntentServiceEndpoint=void 0,this.QuerySuggestionServiceEnabled=void 0,this.SuggestedQueryCount=void 0,this.UseBingForQuerySuggestion=void 0,this.EnableNativeClipboardCopy=void 0,this.QueryHighlighting=void 0,this.EnableWikiL2=void 0,this.EnablePeopleSearch=void 0,this.EnableMessageSearch=void 0,this.QuerySuggestionFiles=void 0,this.WordEnableInlineDictionary=void 0,this.IgnoreNeighborhoodContext=void 0,this.EnableNativeFileSearch=void 0,this.EnableDocumentsViewFilters=void 0,this.EnableInDocumentSearch=void 0,this.EnableInDocumentSearchReplace=void 0,this.EnableInDocumentSearchFindPane=void 0,this.EnableInDocumentParamLocalSearch=void 0,this.EnableLocalSearch=void 0,this.EnableInDocumentStickyFilters=void 0,this.EnableInDocumentQuerySuggest=void 0,this.EnableInDocumentQuestionGeneration=void 0,this.EnableInDocumentGlobalEncoder=void 0,this.EnableInDocumentExperiment1=void 0,this.EnableInDocumentExperiment2=void 0,this.EnableInDocumentExperiment3=void 0,this.MinimumQnaAnswerScore=void 0,this.EnableFullDocumentReuse=void 0,this.UseAltAnswerEndpoint1=void 0,this.UseAltAnswerEndpoint2=void 0,this.UseAltAnswerEndpoint3=void 0,this.EnableInDocumentSearchAlways=void 0,this.RankingModels=void 0,this.EnableZeroTermAutoRefresh=void 0,this.SearchPreloadRemoterEnabled=void 0,this.SharedSerpletFeatureGate1=void 0,this.SharedSerpletFeatureGate2=void 0,this.SharedSerpletFeatureGate3=void 0,this.SharedSerpletFeatureGate5=void 0,this.SharedSerpletFeatureGate6=void 0,this.SharedSerpletFeatureGate7=void 0,this.SharedSerpletFeatureGate8=void 0,this.SharedSerpletFeatureGate9=void 0,this.SharedSerpletFeatureGate10=void 0,this.SharedSerpletFeatureGate12=void 0,this.SharedSerpletFeatureGate13=void 0,this.SharedSerpletFeatureGate14=void 0,this.SharedSerpletFeatureGate15=void 0,this.SharedSerpletFeatureGate16=void 0,this.SharedSerpletFeatureGate17=void 0,this.SharedSerpletFeatureGate18=void 0,this.SharedSerpletFeatureGate19=void 0,this.SharedSerpletFeatureGate20=void 0,this.SharedSerpletFeatureGate21=void 0,this.SharedSerpletFeatureGate22=void 0,this.SharedSerpletFeatureGate23=void 0,this.SharedSerpletFeatureGate25=void 0,this.SharedSerpletFeatureGate26=void 0,this.SharedSerpletFeatureGate27=void 0,this.SharedSerpletFeatureGate28=void 0,this.SharedSerpletFeatureGate29=void 0,this.SharedSerpletFeatureGate30=void 0,this.SharedSerpletFeatureGate31=void 0,this.SharedSerpletFeatureGate32=void 0,this.SharedSerpletFeatureGate33=void 0,this.SharedSerpletFeatureGate34=void 0,this.SharedSerpletFeatureGate35=void 0,this.SharedSerpletFeatureGate37=void 0,this.SharedSerpletFeatureGate38=void 0,this.SharedSerpletFeatureGate39=void 0,this.SharedSerpletFeatureGate40=void 0}var t,n;return e.getFeatureGates=function(t){var n=new e;if(T(n,e.getDefault()),t)try{T(n,t)}catch(r){}return n},e.getDefault=function(){return{RankingModels:"",SmartLookupServicePath:"https://cdn.uci.officeapps.live.com/mirrored/smartlookup/current/",UXBundleVersion:"",SuggestedQueryCount:5,MinimumQnaAnswerScore:.5,DebugCommands:""}},e.ChangeGate=function(e,t){if(!e.ChangeGates)return!0;for(var n,r=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e.ChangeGates.split(";"));!(n=r()).done;)if(-1!=n.value.indexOf(t))return!1;return!0},t=e,(n=[{key:"EnableExcelHelpIntentClassifierVnext",get:function(){return this.SharedSerpletFeatureGate1}},{key:"EnableWholePageRanking",get:function(){return this.SharedSerpletFeatureGate2}},{key:"EnableGuardlistNLX",get:function(){return this.SharedSerpletFeatureGate3}},{key:"unusedFG5",get:function(){return this.SharedSerpletFeatureGate5}},{key:"EnableInDocLocalProviderSuppression",get:function(){return this.SharedSerpletFeatureGate6}},{key:"EnablePremiumImagesProvider",get:function(){return this.SharedSerpletFeatureGate7}},{key:"EnableInDocOptOut",get:function(){return this.SharedSerpletFeatureGate8}},{key:"unusedFG9",get:function(){return this.SharedSerpletFeatureGate9}},{key:"EnableALDocumentContentExtraction",get:function(){return this.SharedSerpletFeatureGate10}},{key:"EnableUciServiceImageRankingBoost",get:function(){return this.SharedSerpletFeatureGate12}},{key:"unusedFG13",get:function(){return this.SharedSerpletFeatureGate13}},{key:"unusedFG14",get:function(){return this.SharedSerpletFeatureGate14}},{key:"EnableInDocHighlightNavigation",get:function(){return this.SharedSerpletFeatureGate15}},{key:"EnableOpenFindReplaceTaskPaneV2",get:function(){return this.SharedSerpletFeatureGate16}},{key:"EnableHttpAPICall",get:function(){return this.SharedSerpletFeatureGate17}},{key:"DictionaryWordSuggestionEnabled",get:function(){return this.SharedSerpletFeatureGate18}},{key:"unusedFG19",get:function(){return this.SharedSerpletFeatureGate19}},{key:"EnableMixedSectionTitle",get:function(){return this.SharedSerpletFeatureGate20}},{key:"EnableHttpApiV4",get:function(){return this.SharedSerpletFeatureGate21}},{key:"EnableDeferredProviderExecution",get:function(){return this.SharedSerpletFeatureGate22}},{key:"EnableL2PaneResizing",get:function(){return this.SharedSerpletFeatureGate23}},{key:"EnableCardViewInSearchPane",get:function(){return this.SharedSerpletFeatureGate25}},{key:"EnableNativeFilesOnly",get:function(){return this.SharedSerpletFeatureGate26}},{key:"unusedFG27",get:function(){return this.SharedSerpletFeatureGate27}},{key:"EnableL4Experiments",get:function(){return this.SharedSerpletFeatureGate28}},{key:"EnableMoreWebCardsInAllTab",get:function(){return this.SharedSerpletFeatureGate29}},{key:"unusedFG30",get:function(){return this.SharedSerpletFeatureGate30}},{key:"unusedFG31",get:function(){return this.SharedSerpletFeatureGate31}},{key:"EnableInDocNavPaneQuerySync",get:function(){return this.SharedSerpletFeatureGate32}},{key:"DemoteFilesInExcelMixedSection",get:function(){return this.SharedSerpletFeatureGate33}},{key:"UseDynamicBundling",get:function(){return this.SharedSerpletFeatureGate34}},{key:"unusedFG35",get:function(){return this.SharedSerpletFeatureGate35}},{key:"EnableDataTypeSearchZeroTerm",get:function(){return this.SharedSerpletFeatureGate37}},{key:"FileInsightsEnabled",get:function(){return this.SharedSerpletFeatureGate38}},{key:"EnableCrossMachineCIS",get:function(){return this.SharedSerpletFeatureGate39||this.EnableHttpAPICall||this.EnableHttpApiV4}},{key:"EnableInDocFloodgateSurvey",get:function(){return this.SharedSerpletFeatureGate40}},{key:"isAutoLaunchEnabled",get:function(){return!1}}])&&r(t.prototype,n),e}();!function(e){e[e.OpenUrlInBrowser=0]="OpenUrlInBrowser",e[e.EnterpriseUserInfo=3]="EnterpriseUserInfo",e[e.InsertOnlinePicture=4]="InsertOnlinePicture",e[e.InsertHtmlText=5]="InsertHtmlText",e[e.Reset=6]="Reset",e[e.Search=13]="Search",e[e.PaneReady=14]="PaneReady",e[e.PaneClosing=15]="PaneClosing",e[e.ResultsUpdated=16]="ResultsUpdated",e[e.SendFollowUpSearchRequest=17]="SendFollowUpSearchRequest",e[e.NavigateToPane=24]="NavigateToPane",e[e.InsertContentFromStreamUrl=25]="InsertContentFromStreamUrl",e[e.SSRJsUpdated=26]="SSRJsUpdated",e[e.SSRHtmlReady=27]="SSRHtmlReady",e[e.PaneHydrated=28]="PaneHydrated",e[e.NetworkError=29]="NetworkError",e[e.MakeHTTPCall=30]="MakeHTTPCall",e[e.ServiceConnectionError=31]="ServiceConnectionError",e[e.ResizePane=32]="ResizePane",e[e.ResetPaneWidth=33]="ResetPaneWidth",e[e.OfficeJsLoaded=34]="OfficeJsLoaded",e[e.PaneLaunchAction=35]="PaneLaunchAction",e[e.NotifyUXVersion=36]="NotifyUXVersion",e[e.PaneThemeChanged=37]="PaneThemeChanged",e[e.PaneFullyRendered=38]="PaneFullyRendered",e[e.LocalSearch=39]="LocalSearch",e[e.DismissPane=40]="DismissPane",e[e.ApplicationPropertiesRequest=101]="ApplicationPropertiesRequest",e[e.SelectionRequest=102]="SelectionRequest",e[e.Telemetry=103]="Telemetry",e[e.Ready=104]="Ready",e[e.ApplicationProperties=105]="ApplicationProperties",e[e.Selection=106]="Selection",e[e.Keyboard=107]="Keyboard",e[e.Navigate=108]="Navigate",e[e.NewInsightsRequest=109]="NewInsightsRequest",e[e.PageRendered=110]="PageRendered",e[e.TakeFocus=111]="TakeFocus",e[e.LostFocus=112]="LostFocus",e[e.InsertOoxml=113]="InsertOoxml",e[e.InsertImage=114]="InsertImage",e[e.InsertLink=115]="InsertLink",e[e.InsertText=116]="InsertText",e[e.SendCopytoClipBoard=117]="SendCopytoClipBoard",e[e.SmartLookupApplicationInterface=118]="SmartLookupApplicationInterface",e[e.ExcecuteAction=119]="ExcecuteAction",e[e.OpenPrivacySettings=120]="OpenPrivacySettings",e[e.InsertDataType=121]="InsertDataType",e[e.DisambiguateEntity=122]="DisambiguateEntity",e[e.OpenFilesInNativeApp=201]="OpenFilesInNativeApp",e[e.InsertFilesContent=202]="InsertFilesContent",e[e.MakeFilesEnterpriseHTTPCall=203]="MakeFilesEnterpriseHTTPCall",e[e.GetFilesFriendlyPath=204]="GetFilesFriendlyPath",e[e.GetShredderAccessToken=205]="GetShredderAccessToken",e[e.GetAuthToken=206]="GetAuthToken",e[e.GetShredderAccessTokenAsync=207]="GetShredderAccessTokenAsync",e[e.BrowseFiles=208]="BrowseFiles",e[e.GetLocalDocumentManifest=209]="GetLocalDocumentManifest",e[e.InsertContentFromLocalDocument=210]="InsertContentFromLocalDocument",e[e.GetAllParagraphsInDocumentRequest=301]="GetAllParagraphsInDocumentRequest",e[e.GetAllParagraphsInDocumentResponse=302]="GetAllParagraphsInDocumentResponse",e[e.SelectRangeInDocument=303]="SelectRangeInDocument",e[e.SearchInDocumentResponse=305]="SearchInDocumentResponse",e[e.HighlightInDocument=306]="HighlightInDocument",e[e.GetDocumentRevisionRequest=307]="GetDocumentRevisionRequest",e[e.GetDocumentRevisionResponse=308]="GetDocumentRevisionResponse",e[e.BuildIndexRequest=310]="BuildIndexRequest",e[e.GetDocumentSelectionRequest=311]="GetDocumentSelectionRequest",e[e.GetDocumentSelectionResponse=312]="GetDocumentSelectionResponse",e[e.SearchInDocumentRequestV2=313]="SearchInDocumentRequestV2",e[e.ClearDocumentSelection=314]="ClearDocumentSelection",e[e.GetCurrentSelectionRequest=315]="GetCurrentSelectionRequest",e[e.GetCurrentSelectionResponse=316]="GetCurrentSelectionResponse",e[e.InDocFallbackDataReceived=317]="InDocFallbackDataReceived",e[e.SelectNextPrevHighlightRequest=318]="SelectNextPrevHighlightRequest",e[e.SelectNextPrevHighlightResponse=319]="SelectNextPrevHighlightResponse",e[e.GetCommandMetadata=320]="GetCommandMetadata",e[e.ExecuteCommand=321]="ExecuteCommand",e[e.GetInDocumentOptOutRequest=330]="GetInDocumentOptOutRequest",e[e.GetInDocumentOptOutResponse=331]="GetInDocumentOptOutResponse",e[e.SetInDocumentOptOut=332]="SetInDocumentOptOut"}(A||(A={})),function(e){e.SmartLookup="SmartLookup"}(w||(w={})),function(e){e.Client="Client",e.PaneUX="PaneUX"}(C||(C={})),n(7316),n(5754);var k=n(8470),O=n.n(k),M=function(){function e(e,t){var n,r,i=this;this.channelId=e,this.paneSessionId=t,this.messengerListener=void 0,this.isSkillOnHostSkillEventRegistered=!1,this.onHostSkillEventHandler=function(e){i.onMessage(e)},this.Action_Timeout=1e4,this.sdxInstanceId=void 0,this.pendingActions={},this.sdxInstanceId=null===(n=Office.context.document.settings._clientSettingsManager)||void 0===n||null===(r=n._osfClientContext)||void 0===r?void 0:r.GetInstanceId()}e.getInstance=function(t,n){return e.instance?e.instance.paneSessionId=n:e.instance=new e(t,n),e.instance};var t=e.prototype;return t.executeActionSync=function(e){if(e){var t=new OfficeCore.RequestContext;if(t.firstParty.skill&&t.firstParty.skill.executeAction){e.actionId||(e.actionId=e.actionType+O()());var n={Type:e.actionType,PaneId:this.channelId,PaneSessionId:this.paneSessionId,SdxInstanceId:this.sdxInstanceId,TransactionId:e.transactionId,ActionId:e.actionId,ActionJson:e.data&&"string"!==typeof e.data?JSON.stringify(e.data):e.data,CreateTimeUTC:Date.now()};t.firstParty.skill.executeAction(this.channelId,e.actionId,JSON.stringify(n)),t.sync()}}return null},t.executeAction=function(e,t){var n=this;e.actionId=O()();var r=e.actionType+e.actionId,i=new OfficeCore.RequestContext;return i.firstParty.skill&&i.firstParty.skill.executeAction&&this.executeActionSync(e),e.callback?(this.pendingActions[e.actionType]=e.callback,Promise.resolve(null)):new Promise((function(e,i){n.pendingActions[r]=e;try{setTimeout((function(){var e=n.pendingActions[r];e&&delete n.pendingActions[r],t&&e(t)}),n.Action_Timeout)}catch(o){return i(o)}}))},t.onMessage=function(e){if(this.messengerListener&&e&&e.data){var t,n=JSON.parse(e.data);if(n.PaneSessionId!==this.paneSessionId)return;try{t=JSON.parse(n.ActionJson)}catch(a){t=n.ActionJson}var r={actionType:n.Type,transactionId:n.TransactionId,data:t,timestamp:n.CreateTimeUTC,paneSessionId:n.PaneSessionId,actionId:n.ActionId},i=this.pendingActions[r.actionType+r.actionId],o=this.pendingActions[r.actionType];i?(i(r.data),delete this.pendingActions[e.actionType+e.actionId]):o?o(r.data):this.messengerListener.actionHandler(r)}},t.registerMessengerListener=function(e,t){var n=this;return new Promise((function(t,r){if(n.isSkillOnHostSkillEventRegistered)return n.messengerListener=e,t();var i=new OfficeCore.RequestContext;i.firstParty.skill&&i.firstParty.skill.onHostSkillEvent&&i.firstParty.skill.onHostSkillEvent.add(n.onHostSkillEventHandler),i.sync().then((function(){return n.isSkillOnHostSkillEventRegistered=!0,n.messengerListener=e,t()})).catch((function(e){return r(e)}))}))},t.unregisterMessengerListener=function(e,t){var n=this;return new Promise((function(t,r){if(n.messengerListener==e&&(n.messengerListener=null),!n.isSkillOnHostSkillEventRegistered)return t();var i=new OfficeCore.RequestContext;i.firstParty.skill&&i.firstParty.skill.onHostSkillEvent&&i.firstParty.skill.onHostSkillEvent.remove(n.onHostSkillEventHandler),i.sync().then((function(){return n.isSkillOnHostSkillEventRegistered=!1,t()})).catch((function(e){return r(e)}))}))},t.close=function(){},e}();M.instance=void 0;var F="250a372c4a854d8fb120ef0366f9410c-dd39bcd8-3b38-4c6c-9f8d-3821e5c28b47-7487",_=function(){function e(){}return e.setEnvironment=function(t){e.isWeb=t},e.GetPaneWidth=function(){return e.isServer?e.ServerWindowWidth:window.innerWidth<=50?50:window.innerWidth},e.GetPaneWidthWithMargin=function(){var t,n="undefined"===typeof document?null:null===(t=document)||void 0===t?void 0:t.getElementById("SmartLookupResultContainer");return n?n.clientWidth+8:(e.isWeb,e.GetPaneWidth()-(e.isWeb?16:0))},e.GetPaneContentWidth=function(){return e.GetPaneWidthWithMargin()-8},e.ShowTwoRowsForImagesOnAllTab=function(e){var t=document.getElementById("ImageCardTapestry"+e);if(null!==t&&void 0!==t&&t.children.length)for(var n,r=t.children[0].offsetTop,i=1;i<t.children.length;i++){var o=t.children[i].offsetTop;o>r&&(n?o>n&&(t.children[i].style.display="none",t.children[i].setAttribute("data-navitem-disabled","true")):n=o)}},e}();_.ServerWindowWidth=400,_.isServer=!1,_.isWeb=void 0;var L,q=function(){};q.OfficeAugmentationPath="/officeaugmentation",q.SearchSuggestionEndpoint=q.OfficeAugmentationPath+"/searchsuggestionendpoint/",q.IntentEndpoint=q.OfficeAugmentationPath+"/intentendpoint/",q.SearchEndpoint=q.OfficeAugmentationPath+"/searchendpoint/",q.SearchEndpointV2=q.OfficeAugmentationPath+"/searchendpointv2/",q.SearchEndpointV3=q.OfficeAugmentationPath+"/searchendpointv3/",q.SearchEndpointV4=q.OfficeAugmentationPath+"/searchendpointv4/",q.QueryIntentEndpoint=q.OfficeAugmentationPath+"/queryintentendpoint/",q.QueryAgiEndpoint=q.OfficeAugmentationPath+"/queryagiendpoint/",q.VerificationEndpoint=q.OfficeAugmentationPath+"/verificationendpoint/",q.TestModeEndpoint=q.OfficeAugmentationPath+"/testmodeendpoint/",q.TopKSearch=q.OfficeAugmentationPath+"/topKSearch/",q.BuildIndex=q.OfficeAugmentationPath+"/buildindex/",q.RankingEndpoint=q.OfficeAugmentationPath+"/rankingendpoint/",q.GuardlistEndpoint=q.OfficeAugmentationPath+"/guardlistendpoint/",q.GuardlistEndpointPartnerDiagnostics=q.OfficeAugmentationPath+"/guardlistendpointpartnerdiagnostics/",q.PingEndpoint=q.OfficeAugmentationPath+"/pingendpoint/",q.ShredderServiceFetchUserIdEndpoint="/ShredderService/api/getuserid",q.CISEndpoint=q.OfficeAugmentationPath+"/cisendpoint/",function(e){e.V2="v2",e.V3="v3",e.V4="v4"}(L||(L={}))},7316:function(){},4668:function(e,t,n){"use strict";n.d(t,{ActionType:function(){return s.ActionType},AgaveMessenger:function(){return s.AgaveMessenger},ChangeGates:function(){return s.ChangeGates},ChannelId:function(){return s.ChannelId},FeatureGates:function(){return s.FeatureGates},HostType:function(){return s.HostType},InsightsAriaTenantToken:function(){return s.InsightsAriaTenantToken},IsTestPage:function(){return s.IsTestPage},PaneState:function(){return s.PaneState},ServiceEndpoints:function(){return s.ServiceEndpoints},SmartLookupEntryPoint:function(){return s.SmartLookupEntryPoint}});var r=n(7031);n.o(r,"ActionType")&&n.d(t,{ActionType:function(){return r.ActionType}}),n.o(r,"AgaveMessenger")&&n.d(t,{AgaveMessenger:function(){return r.AgaveMessenger}}),n.o(r,"ChangeGates")&&n.d(t,{ChangeGates:function(){return r.ChangeGates}}),n.o(r,"ChannelId")&&n.d(t,{ChannelId:function(){return r.ChannelId}}),n.o(r,"FeatureGates")&&n.d(t,{FeatureGates:function(){return r.FeatureGates}}),n.o(r,"HostType")&&n.d(t,{HostType:function(){return r.HostType}}),n.o(r,"InsightsAriaTenantToken")&&n.d(t,{InsightsAriaTenantToken:function(){return r.InsightsAriaTenantToken}}),n.o(r,"IsTestPage")&&n.d(t,{IsTestPage:function(){return r.IsTestPage}}),n.o(r,"PaneState")&&n.d(t,{PaneState:function(){return r.PaneState}}),n.o(r,"ServiceEndpoints")&&n.d(t,{ServiceEndpoints:function(){return r.ServiceEndpoints}}),n.o(r,"SmartLookupEntryPoint")&&n.d(t,{SmartLookupEntryPoint:function(){return r.SmartLookupEntryPoint}});var i=n(9708);n.o(i,"ActionType")&&n.d(t,{ActionType:function(){return i.ActionType}}),n.o(i,"AgaveMessenger")&&n.d(t,{AgaveMessenger:function(){return i.AgaveMessenger}}),n.o(i,"ChangeGates")&&n.d(t,{ChangeGates:function(){return i.ChangeGates}}),n.o(i,"ChannelId")&&n.d(t,{ChannelId:function(){return i.ChannelId}}),n.o(i,"FeatureGates")&&n.d(t,{FeatureGates:function(){return i.FeatureGates}}),n.o(i,"HostType")&&n.d(t,{HostType:function(){return i.HostType}}),n.o(i,"InsightsAriaTenantToken")&&n.d(t,{InsightsAriaTenantToken:function(){return i.InsightsAriaTenantToken}}),n.o(i,"IsTestPage")&&n.d(t,{IsTestPage:function(){return i.IsTestPage}}),n.o(i,"PaneState")&&n.d(t,{PaneState:function(){return i.PaneState}}),n.o(i,"ServiceEndpoints")&&n.d(t,{ServiceEndpoints:function(){return i.ServiceEndpoints}}),n.o(i,"SmartLookupEntryPoint")&&n.d(t,{SmartLookupEntryPoint:function(){return i.SmartLookupEntryPoint}});var o=n(8156);n.o(o,"ActionType")&&n.d(t,{ActionType:function(){return o.ActionType}}),n.o(o,"AgaveMessenger")&&n.d(t,{AgaveMessenger:function(){return o.AgaveMessenger}}),n.o(o,"ChangeGates")&&n.d(t,{ChangeGates:function(){return o.ChangeGates}}),n.o(o,"ChannelId")&&n.d(t,{ChannelId:function(){return o.ChannelId}}),n.o(o,"FeatureGates")&&n.d(t,{FeatureGates:function(){return o.FeatureGates}}),n.o(o,"HostType")&&n.d(t,{HostType:function(){return o.HostType}}),n.o(o,"InsightsAriaTenantToken")&&n.d(t,{InsightsAriaTenantToken:function(){return o.InsightsAriaTenantToken}}),n.o(o,"IsTestPage")&&n.d(t,{IsTestPage:function(){return o.IsTestPage}}),n.o(o,"PaneState")&&n.d(t,{PaneState:function(){return o.PaneState}}),n.o(o,"ServiceEndpoints")&&n.d(t,{ServiceEndpoints:function(){return o.ServiceEndpoints}}),n.o(o,"SmartLookupEntryPoint")&&n.d(t,{SmartLookupEntryPoint:function(){return o.SmartLookupEntryPoint}});var a=n(1718);n.o(a,"ActionType")&&n.d(t,{ActionType:function(){return a.ActionType}}),n.o(a,"AgaveMessenger")&&n.d(t,{AgaveMessenger:function(){return a.AgaveMessenger}}),n.o(a,"ChangeGates")&&n.d(t,{ChangeGates:function(){return a.ChangeGates}}),n.o(a,"ChannelId")&&n.d(t,{ChannelId:function(){return a.ChannelId}}),n.o(a,"FeatureGates")&&n.d(t,{FeatureGates:function(){return a.FeatureGates}}),n.o(a,"HostType")&&n.d(t,{HostType:function(){return a.HostType}}),n.o(a,"InsightsAriaTenantToken")&&n.d(t,{InsightsAriaTenantToken:function(){return a.InsightsAriaTenantToken}}),n.o(a,"IsTestPage")&&n.d(t,{IsTestPage:function(){return a.IsTestPage}}),n.o(a,"PaneState")&&n.d(t,{PaneState:function(){return a.PaneState}}),n.o(a,"ServiceEndpoints")&&n.d(t,{ServiceEndpoints:function(){return a.ServiceEndpoints}}),n.o(a,"SmartLookupEntryPoint")&&n.d(t,{SmartLookupEntryPoint:function(){return a.SmartLookupEntryPoint}}),n(4684);var s=n(8075)},7031:function(){},9708:function(){},8156:function(){},1718:function(){},3200:function(e,t,n){var r=n(7230),i=n(933),o=n(321),a=r.TypeError;e.exports=function(e){if(i(e))return e;throw a(o(e)+" is not a function")}},4831:function(e,t,n){var r=n(7230),i=n(3538),o=n(321),a=r.TypeError;e.exports=function(e){if(i(e))return e;throw a(o(e)+" is not a constructor")}},8563:function(e,t,n){var r=n(7230),i=n(933),o=r.String,a=r.TypeError;e.exports=function(e){if("object"==typeof e||i(e))return e;throw a("Can't set "+o(e)+" as a prototype")}},186:function(e,t,n){var r=n(7952),i=n(6997),o=n(7108),a=r("unscopables"),s=Array.prototype;void 0==s[a]&&o.f(s,a,{configurable:!0,value:i(null)}),e.exports=function(e){s[a][e]=!0}},3264:function(e,t,n){"use strict";var r=n(2370).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},5209:function(e,t,n){var r=n(7230),i=n(2346),o=r.TypeError;e.exports=function(e,t){if(i(t,e))return e;throw o("Incorrect invocation")}},3536:function(e,t,n){var r=n(7230),i=n(6913),o=r.String,a=r.TypeError;e.exports=function(e){if(i(e))return e;throw a(o(e)+" is not an object")}},7337:function(e){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},7740:function(e,t,n){"use strict";var r,i,o,a=n(7337),s=n(6079),u=n(7230),c=n(933),d=n(6913),l=n(3225),p=n(996),h=n(321),f=n(5399),v=n(3926),g=n(7108).f,y=n(2346),m=n(5024),S=n(1403),I=n(7952),T=n(4525),R=u.Int8Array,b=R&&R.prototype,P=u.Uint8ClampedArray,E=P&&P.prototype,x=R&&m(R),A=b&&m(b),w=Object.prototype,C=u.TypeError,D=I("toStringTag"),k=T("TYPED_ARRAY_TAG"),O=T("TYPED_ARRAY_CONSTRUCTOR"),M=a&&!!S&&"Opera"!==p(u.opera),F=!1,_={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},L={BigInt64Array:8,BigUint64Array:8},q=function(e){if(!d(e))return!1;var t=p(e);return l(_,t)||l(L,t)};for(r in _)(o=(i=u[r])&&i.prototype)?f(o,O,i):M=!1;for(r in L)(o=(i=u[r])&&i.prototype)&&f(o,O,i);if((!M||!c(x)||x===Function.prototype)&&(x=function(){throw C("Incorrect invocation")},M))for(r in _)u[r]&&S(u[r],x);if((!M||!A||A===w)&&(A=x.prototype,M))for(r in _)u[r]&&S(u[r].prototype,A);if(M&&m(E)!==A&&S(E,A),s&&!l(A,D))for(r in F=!0,g(A,D,{get:function(){return d(this)?this[k]:void 0}}),_)u[r]&&f(u[r],k,r);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:M,TYPED_ARRAY_CONSTRUCTOR:O,TYPED_ARRAY_TAG:F&&k,aTypedArray:function(e){if(q(e))return e;throw C("Target is not a typed array")},aTypedArrayConstructor:function(e){if(c(e)&&(!S||y(x,e)))return e;throw C(h(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n){if(s){if(n)for(var r in _){var i=u[r];if(i&&l(i.prototype,e))try{delete i.prototype[e]}catch(o){}}A[e]&&!n||v(A,e,n?t:M&&b[e]||t)}},exportTypedArrayStaticMethod:function(e,t,n){var r,i;if(s){if(S){if(n)for(r in _)if((i=u[r])&&l(i,e))try{delete i[e]}catch(o){}if(x[e]&&!n)return;try{return v(x,e,n?t:M&&x[e]||t)}catch(o){}}for(r in _)!(i=u[r])||i[e]&&!n||v(i,e,t)}},isView:function(e){if(!d(e))return!1;var t=p(e);return"DataView"===t||l(_,t)||l(L,t)},isTypedArray:q,TypedArray:x,TypedArrayPrototype:A}},2292:function(e,t,n){"use strict";var r=n(7230),i=n(1916),o=n(6079),a=n(7337),s=n(567),u=n(5399),c=n(7777),d=n(3694),l=n(5209),p=n(4982),h=n(6092),f=n(4800),v=n(7419),g=n(5024),y=n(1403),m=n(7852).f,S=n(7108).f,I=n(240),T=n(9663),R=n(5411),b=n(21),P=s.PROPER,E=s.CONFIGURABLE,x=b.get,A=b.set,w="ArrayBuffer",C="Wrong index",D=r.ArrayBuffer,k=D,O=k&&k.prototype,M=r.DataView,F=M&&M.prototype,_=Object.prototype,L=r.Array,q=r.RangeError,G=i(I),W=i([].reverse),N=v.pack,U=v.unpack,H=function(e){return[255&e]},j=function(e){return[255&e,e>>8&255]},B=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},Q=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},V=function(e){return N(e,23,4)},J=function(e){return N(e,52,8)},Z=function(e,t){S(e.prototype,t,{get:function(){return x(this)[t]}})},z=function(e,t,n,r){var i=f(n),o=x(e);if(i+t>o.byteLength)throw q(C);var a=x(o.buffer).bytes,s=i+o.byteOffset,u=T(a,s,s+t);return r?u:W(u)},K=function(e,t,n,r,i,o){var a=f(n),s=x(e);if(a+t>s.byteLength)throw q(C);for(var u=x(s.buffer).bytes,c=a+s.byteOffset,d=r(+i),l=0;l<t;l++)u[c+l]=d[o?l:t-l-1]};if(a){var Y=P&&D.name!==w;if(d((function(){D(1)}))&&d((function(){new D(-1)}))&&!d((function(){return new D,new D(1.5),new D(NaN),Y&&!E})))Y&&E&&u(D,"name",w);else{(k=function(e){return l(this,O),new D(f(e))}).prototype=O;for(var $,X=m(D),ee=0;X.length>ee;)($=X[ee++])in k||u(k,$,D[$]);O.constructor=k}y&&g(F)!==_&&y(F,_);var te=new M(new k(2)),ne=i(F.setInt8);te.setInt8(0,2147483648),te.setInt8(1,2147483649),!te.getInt8(0)&&te.getInt8(1)||c(F,{setInt8:function(e,t){ne(this,e,t<<24>>24)},setUint8:function(e,t){ne(this,e,t<<24>>24)}},{unsafe:!0})}else O=(k=function(e){l(this,O);var t=f(e);A(this,{bytes:G(L(t),0),byteLength:t}),o||(this.byteLength=t)}).prototype,F=(M=function(e,t,n){l(this,F),l(e,O);var r=x(e).byteLength,i=p(t);if(i<0||i>r)throw q("Wrong offset");if(i+(n=void 0===n?r-i:h(n))>r)throw q("Wrong length");A(this,{buffer:e,byteLength:n,byteOffset:i}),o||(this.buffer=e,this.byteLength=n,this.byteOffset=i)}).prototype,o&&(Z(k,"byteLength"),Z(M,"buffer"),Z(M,"byteLength"),Z(M,"byteOffset")),c(F,{getInt8:function(e){return z(this,1,e)[0]<<24>>24},getUint8:function(e){return z(this,1,e)[0]},getInt16:function(e){var t=z(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=z(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return Q(z(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return Q(z(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return U(z(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return U(z(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){K(this,1,e,H,t)},setUint8:function(e,t){K(this,1,e,H,t)},setInt16:function(e,t){K(this,2,e,j,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){K(this,2,e,j,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){K(this,4,e,B,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){K(this,4,e,B,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){K(this,4,e,V,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){K(this,8,e,J,t,arguments.length>2?arguments[2]:void 0)}});R(k,w),R(M,"DataView"),e.exports={ArrayBuffer:k,DataView:M}},8012:function(e,t,n){"use strict";var r=n(987),i=n(2966),o=n(1646),a=Math.min;e.exports=[].copyWithin||function(e,t){var n=r(this),s=o(n),u=i(e,s),c=i(t,s),d=arguments.length>2?arguments[2]:void 0,l=a((void 0===d?s:i(d,s))-c,s-u),p=1;for(c<u&&u<c+l&&(p=-1,c+=l-1,u+=l-1);l-- >0;)c in n?n[u]=n[c]:delete n[u],u+=p,c+=p;return n}},240:function(e,t,n){"use strict";var r=n(987),i=n(2966),o=n(1646);e.exports=function(e){for(var t=r(this),n=o(t),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),u=a>2?arguments[2]:void 0,c=void 0===u?n:i(u,n);c>s;)t[s++]=e;return t}},7004:function(e){e.exports=function(e,t){for(var n=0,r=t.length,i=new e(r);r>n;)i[n]=t[n++];return i}},8897:function(e,t,n){"use strict";var r=n(7230),i=n(1248),o=n(4225),a=n(987),s=n(6996),u=n(1855),c=n(3538),d=n(1646),l=n(3859),p=n(9853),h=n(6418),f=r.Array;e.exports=function(e){var t=a(e),n=c(this),r=arguments.length,v=r>1?arguments[1]:void 0,g=void 0!==v;g&&(v=i(v,r>2?arguments[2]:void 0));var y,m,S,I,T,R,b=h(t),P=0;if(!b||this==f&&u(b))for(y=d(t),m=n?new this(y):f(y);y>P;P++)R=g?v(t[P],P):t[P],l(m,P,R);else for(T=(I=p(t,b)).next,m=n?new this:[];!(S=o(T,I)).done;P++)R=g?s(I,v,[S.value,P],!0):S.value,l(m,P,R);return m.length=P,m}},7945:function(e,t,n){var r=n(9164),i=n(2966),o=n(1646),a=function(e){return function(t,n,a){var s,u=r(t),c=o(u),d=i(a,c);if(e&&n!=n){for(;c>d;)if((s=u[d++])!=s)return!0}else for(;c>d;d++)if((e||d in u)&&u[d]===n)return e||d||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},1569:function(e,t,n){var r=n(1248),i=n(1916),o=n(6801),a=n(987),s=n(1646),u=n(1204),c=i([].push),d=function(e){var t=1==e,n=2==e,i=3==e,d=4==e,l=6==e,p=7==e,h=5==e||l;return function(f,v,g,y){for(var m,S,I=a(f),T=o(I),R=r(v,g),b=s(T),P=0,E=y||u,x=t?E(f,b):n||p?E(f,0):void 0;b>P;P++)if((h||P in T)&&(S=R(m=T[P],P,I),e))if(t)x[P]=S;else if(S)switch(e){case 3:return!0;case 5:return m;case 6:return P;case 2:c(x,m)}else switch(e){case 4:return!1;case 7:c(x,m)}return l?-1:i||d?d:x}};e.exports={forEach:d(0),map:d(1),filter:d(2),some:d(3),every:d(4),find:d(5),findIndex:d(6),filterReject:d(7)}},3604:function(e,t,n){"use strict";var r=n(251),i=n(9164),o=n(4982),a=n(1646),s=n(2245),u=Math.min,c=[].lastIndexOf,d=!!c&&1/[1].lastIndexOf(1,-0)<0,l=s("lastIndexOf"),p=d||!l;e.exports=p?function(e){if(d)return r(c,this,arguments)||0;var t=i(this),n=a(t),s=n-1;for(arguments.length>1&&(s=u(s,o(arguments[1]))),s<0&&(s=n+s);s>=0;s--)if(s in t&&t[s]===e)return s||0;return-1}:c},9321:function(e,t,n){var r=n(3694),i=n(7952),o=n(7806),a=i("species");e.exports=function(e){return o>=51||!r((function(){var t=[];return(t.constructor={})[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},2245:function(e,t,n){"use strict";var r=n(3694);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){throw 1},1)}))}},8605:function(e,t,n){var r=n(7230),i=n(3200),o=n(987),a=n(6801),s=n(1646),u=r.TypeError,c=function(e){return function(t,n,r,c){i(n);var d=o(t),l=a(d),p=s(d),h=e?p-1:0,f=e?-1:1;if(r<2)for(;;){if(h in l){c=l[h],h+=f;break}if(h+=f,e?h<0:p<=h)throw u("Reduce of empty array with no initial value")}for(;e?h>=0:p>h;h+=f)h in l&&(c=n(c,l[h],h,d));return c}};e.exports={left:c(!1),right:c(!0)}},9663:function(e,t,n){var r=n(1916);e.exports=r([].slice)},8813:function(e,t,n){var r=n(9663),i=Math.floor,o=function(e,t){var n=e.length,u=i(n/2);return n<8?a(e,t):s(e,o(r(e,0,u),t),o(r(e,u),t),t)},a=function(e,t){for(var n,r,i=e.length,o=1;o<i;){for(r=o,n=e[o];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==o++&&(e[r]=n)}return e},s=function(e,t,n,r){for(var i=t.length,o=n.length,a=0,s=0;a<i||s<o;)e[a+s]=a<i&&s<o?r(t[a],n[s])<=0?t[a++]:n[s++]:a<i?t[a++]:n[s++];return e};e.exports=o},3824:function(e,t,n){var r=n(7230),i=n(4893),o=n(3538),a=n(6913),s=n(7952)("species"),u=r.Array;e.exports=function(e){var t;return i(e)&&(t=e.constructor,(o(t)&&(t===u||i(t.prototype))||a(t)&&null===(t=t[s]))&&(t=void 0)),void 0===t?u:t}},1204:function(e,t,n){var r=n(3824);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},6996:function(e,t,n){var r=n(3536),i=n(5635);e.exports=function(e,t,n,o){try{return o?t(r(n)[0],n[1]):t(n)}catch(a){i(e,"throw",a)}}},1964:function(e,t,n){var r=n(7952)("iterator"),i=!1;try{var o=0,a={next:function(){return{done:!!o++}},return:function(){i=!0}};a[r]=function(){return this},Array.from(a,(function(){throw 2}))}catch(s){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o={};o[r]=function(){return{next:function(){return{done:n=!0}}}},e(o)}catch(s){}return n}},2248:function(e,t,n){var r=n(1916),i=r({}.toString),o=r("".slice);e.exports=function(e){return o(i(e),8,-1)}},996:function(e,t,n){var r=n(7230),i=n(6695),o=n(933),a=n(2248),s=n(7952)("toStringTag"),u=r.Object,c="Arguments"==a(function(){return arguments}());e.exports=i?a:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(n){}}(t=u(e),s))?n:c?a(t):"Object"==(r=a(t))&&o(t.callee)?"Arguments":r}},3342:function(e,t,n){"use strict";var r=n(7108).f,i=n(6997),o=n(7777),a=n(1248),s=n(5209),u=n(5103),c=n(3392),d=n(6898),l=n(6079),p=n(3792).fastKey,h=n(21),f=h.set,v=h.getterFor;e.exports={getConstructor:function(e,t,n,c){var d=e((function(e,r){s(e,h),f(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),l||(e.size=0),void 0!=r&&u(r,e[c],{that:e,AS_ENTRIES:n})})),h=d.prototype,g=v(t),y=function(e,t,n){var r,i,o=g(e),a=m(e,t);return a?a.value=n:(o.last=a={index:i=p(t,!0),key:t,value:n,previous:r=o.last,next:void 0,removed:!1},o.first||(o.first=a),r&&(r.next=a),l?o.size++:e.size++,"F"!==i&&(o.index[i]=a)),e},m=function(e,t){var n,r=g(e),i=p(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return o(h,{clear:function(){for(var e=g(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,l?e.size=0:this.size=0},delete:function(e){var t=this,n=g(t),r=m(t,e);if(r){var i=r.next,o=r.previous;delete n.index[r.index],r.removed=!0,o&&(o.next=i),i&&(i.previous=o),n.first==r&&(n.first=i),n.last==r&&(n.last=o),l?n.size--:t.size--}return!!r},forEach:function(e){for(var t,n=g(this),r=a(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!m(this,e)}}),o(h,n?{get:function(e){var t=m(this,e);return t&&t.value},set:function(e,t){return y(this,0===e?0:e,t)}}:{add:function(e){return y(this,e=0===e?0:e,e)}}),l&&r(h,"size",{get:function(){return g(this).size}}),d},setStrong:function(e,t,n){var r=t+" Iterator",i=v(t),o=v(r);c(e,t,(function(e,t){f(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),d(t)}}},5003:function(e,t,n){"use strict";var r=n(5302),i=n(7230),o=n(1916),a=n(4545),s=n(3926),u=n(3792),c=n(5103),d=n(5209),l=n(933),p=n(6913),h=n(3694),f=n(1964),v=n(5411),g=n(8089);e.exports=function(e,t,n){var y=-1!==e.indexOf("Map"),m=-1!==e.indexOf("Weak"),S=y?"set":"add",I=i[e],T=I&&I.prototype,R=I,b={},P=function(e){var t=o(T[e]);s(T,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(m&&!p(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return m&&!p(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(m&&!p(e))&&t(this,0===e?0:e)}:function(e,n){return t(this,0===e?0:e,n),this})};if(a(e,!l(I)||!(m||T.forEach&&!h((function(){(new I).entries().next()})))))R=n.getConstructor(t,e,y,S),u.enable();else if(a(e,!0)){var E=new R,x=E[S](m?{}:-0,1)!=E,A=h((function(){E.has(1)})),w=f((function(e){new I(e)})),C=!m&&h((function(){for(var e=new I,t=5;t--;)e[S](t,t);return!e.has(-0)}));w||((R=t((function(e,t){d(e,T);var n=g(new I,e,R);return void 0!=t&&c(t,n[S],{that:n,AS_ENTRIES:y}),n}))).prototype=T,T.constructor=R),(A||C)&&(P("delete"),P("has"),y&&P("get")),(C||x)&&P(S),m&&T.clear&&delete T.clear}return b[e]=R,r({global:!0,forced:R!=I},b),v(R,e),m||n.setStrong(R,e,y),R}},1831:function(e,t,n){var r=n(3225),i=n(3697),o=n(5027),a=n(7108);e.exports=function(e,t){for(var n=i(t),s=a.f,u=o.f,c=0;c<n.length;c++){var d=n[c];r(e,d)||s(e,d,u(t,d))}}},937:function(e,t,n){var r=n(7952)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(i){}}return!1}},560:function(e,t,n){var r=n(3694);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},1623:function(e,t,n){"use strict";var r=n(7824).IteratorPrototype,i=n(6997),o=n(8828),a=n(5411),s=n(3019),u=function(){return this};e.exports=function(e,t,n){var c=t+" Iterator";return e.prototype=i(r,{next:o(1,n)}),a(e,c,!1,!0),s[c]=u,e}},5399:function(e,t,n){var r=n(6079),i=n(7108),o=n(8828);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},8828:function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},3859:function(e,t,n){"use strict";var r=n(5831),i=n(7108),o=n(8828);e.exports=function(e,t,n){var a=r(t);a in e?i.f(e,a,o(0,n)):e[a]=n}},3392:function(e,t,n){"use strict";var r=n(5302),i=n(4225),o=n(7442),a=n(567),s=n(933),u=n(1623),c=n(5024),d=n(1403),l=n(5411),p=n(5399),h=n(3926),f=n(7952),v=n(3019),g=n(7824),y=a.PROPER,m=a.CONFIGURABLE,S=g.IteratorPrototype,I=g.BUGGY_SAFARI_ITERATORS,T=f("iterator"),R="keys",b="values",P="entries",E=function(){return this};e.exports=function(e,t,n,a,f,g,x){u(n,t,a);var A,w,C,D=function(e){if(e===f&&_)return _;if(!I&&e in M)return M[e];switch(e){case R:case b:case P:return function(){return new n(this,e)}}return function(){return new n(this)}},k=t+" Iterator",O=!1,M=e.prototype,F=M[T]||M["@@iterator"]||f&&M[f],_=!I&&F||D(f),L="Array"==t&&M.entries||F;if(L&&(A=c(L.call(new e)))!==Object.prototype&&A.next&&(o||c(A)===S||(d?d(A,S):s(A[T])||h(A,T,E)),l(A,k,!0,!0),o&&(v[k]=E)),y&&f==b&&F&&F.name!==b&&(!o&&m?p(M,"name",b):(O=!0,_=function(){return i(F,this)})),f)if(w={values:D(b),keys:g?_:D(R),entries:D(P)},x)for(C in w)(I||O||!(C in M))&&h(M,C,w[C]);else r({target:t,proto:!0,forced:I||O},w);return o&&!x||M[T]===_||h(M,T,_,{name:f}),v[t]=_,w}},4832:function(e,t,n){var r=n(5030),i=n(3225),o=n(3081),a=n(7108).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});i(t,e)||a(t,e,{value:o.f(e)})}},6079:function(e,t,n){var r=n(3694);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},2200:function(e,t,n){var r=n(7230),i=n(6913),o=r.document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},5941:function(e){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},3050:function(e,t,n){var r=n(2200)("span").classList,i=r&&r.constructor&&r.constructor.prototype;e.exports=i===Object.prototype?void 0:i},1346:function(e,t,n){var r=n(7749).match(/firefox\/(\d+)/i);e.exports=!!r&&+r[1]},417:function(e){e.exports="object"==typeof window},7636:function(e,t,n){var r=n(7749);e.exports=/MSIE|Trident/.test(r)},4370:function(e,t,n){var r=n(7749),i=n(7230);e.exports=/ipad|iphone|ipod/i.test(r)&&void 0!==i.Pebble},4619:function(e,t,n){var r=n(7749);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},5009:function(e,t,n){var r=n(2248),i=n(7230);e.exports="process"==r(i.process)},2811:function(e,t,n){var r=n(7749);e.exports=/web0s(?!.*chrome)/i.test(r)},7749:function(e,t,n){var r=n(1223);e.exports=r("navigator","userAgent")||""},7806:function(e,t,n){var r,i,o=n(7230),a=n(7749),s=o.process,u=o.Deno,c=s&&s.versions||u&&u.version,d=c&&c.v8;d&&(i=(r=d.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},7041:function(e,t,n){var r=n(7749).match(/AppleWebKit\/(\d+)\./);e.exports=!!r&&+r[1]},9799:function(e){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},5302:function(e,t,n){var r=n(7230),i=n(5027).f,o=n(5399),a=n(3926),s=n(746),u=n(1831),c=n(4545);e.exports=function(e,t){var n,d,l,p,h,f=e.target,v=e.global,g=e.stat;if(n=v?r:g?r[f]||s(f,{}):(r[f]||{}).prototype)for(d in t){if(p=t[d],l=e.noTargetGet?(h=i(n,d))&&h.value:n[d],!c(v?d:f+(g?".":"#")+d,e.forced)&&void 0!==l){if(typeof p==typeof l)continue;u(p,l)}(e.sham||l&&l.sham)&&o(p,"sham",!0),a(n,d,p,e)}}},3694:function(e){e.exports=function(e){try{return!!e()}catch(t){return!0}}},4430:function(e,t,n){"use strict";n(5098);var r=n(1916),i=n(3926),o=n(9735),a=n(3694),s=n(7952),u=n(5399),c=s("species"),d=RegExp.prototype;e.exports=function(e,t,n,l){var p=s(e),h=!a((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),f=h&&!a((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[p]=/./[p]),n.exec=function(){return t=!0,null},n[p](""),!t}));if(!h||!f||n){var v=r(/./[p]),g=t(p,""[e],(function(e,t,n,i,a){var s=r(e),u=t.exec;return u===o||u===d.exec?h&&!a?{done:!0,value:v(t,n,i)}:{done:!0,value:s(n,t,i)}:{done:!1}}));i(String.prototype,e,g[0]),i(d,p,g[1])}l&&u(d[p],"sham",!0)}},2913:function(e,t,n){var r=n(3694);e.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},251:function(e){var t=Function.prototype,n=t.apply,r=t.bind,i=t.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?i.bind(n):function(){return i.apply(n,arguments)})},1248:function(e,t,n){var r=n(1916),i=n(3200),o=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?o(e,t):function(){return e.apply(t,arguments)}}},4225:function(e){var t=Function.prototype.call;e.exports=t.bind?t.bind(t):function(){return t.apply(t,arguments)}},567:function(e,t,n){var r=n(6079),i=n(3225),o=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,s=i(o,"name"),u=s&&"something"===function(){}.name,c=s&&(!r||r&&a(o,"name").configurable);e.exports={EXISTS:s,PROPER:u,CONFIGURABLE:c}},1916:function(e){var t=Function.prototype,n=t.bind,r=t.call,i=n&&n.bind(r);e.exports=n?function(e){return e&&i(r,e)}:function(e){return e&&function(){return r.apply(e,arguments)}}},1223:function(e,t,n){var r=n(7230),i=n(933),o=function(e){return i(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?o(r[e]):r[e]&&r[e][t]}},6418:function(e,t,n){var r=n(996),i=n(5048),o=n(3019),a=n(7952)("iterator");e.exports=function(e){if(void 0!=e)return i(e,a)||i(e,"@@iterator")||o[r(e)]}},9853:function(e,t,n){var r=n(7230),i=n(4225),o=n(3200),a=n(3536),s=n(321),u=n(6418),c=r.TypeError;e.exports=function(e,t){var n=arguments.length<2?u(e):t;if(o(n))return a(i(n,e));throw c(s(e)+" is not iterable")}},5048:function(e,t,n){var r=n(3200);e.exports=function(e,t){var n=e[t];return null==n?void 0:r(n)}},6968:function(e,t,n){var r=n(1916),i=n(987),o=Math.floor,a=r("".charAt),s=r("".replace),u=r("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,d=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,l,p){var h=n+e.length,f=r.length,v=d;return void 0!==l&&(l=i(l),v=c),s(p,v,(function(i,s){var c;switch(a(s,0)){case"$":return"$";case"&":return e;case"`":return u(t,0,n);case"'":return u(t,h);case"<":c=l[u(s,1,-1)];break;default:var d=+s;if(0===d)return i;if(d>f){var p=o(d/10);return 0===p?i:p<=f?void 0===r[p-1]?a(s,1):r[p-1]+a(s,1):i}c=r[d-1]}return void 0===c?"":c}))}},7230:function(e){var t=function(e){return e&&e.Math==Math&&e};e.exports=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof window&&window)||function(){return this}()||Function("return this")()},3225:function(e,t,n){var r=n(1916),i=n(987),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},7076:function(e){e.exports={}},5812:function(e,t,n){var r=n(7230);e.exports=function(e,t){var n=r.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))}},6507:function(e,t,n){var r=n(1223);e.exports=r("document","documentElement")},4253:function(e,t,n){var r=n(6079),i=n(3694),o=n(2200);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},7419:function(e,t,n){var r=n(7230).Array,i=Math.abs,o=Math.pow,a=Math.floor,s=Math.log,u=Math.LN2;e.exports={pack:function(e,t,n){var c,d,l,p=r(n),h=8*n-t-1,f=(1<<h)-1,v=f>>1,g=23===t?o(2,-24)-o(2,-77):0,y=e<0||0===e&&1/e<0?1:0,m=0;for((e=i(e))!=e||e===1/0?(d=e!=e?1:0,c=f):(c=a(s(e)/u),e*(l=o(2,-c))<1&&(c--,l*=2),(e+=c+v>=1?g/l:g*o(2,1-v))*l>=2&&(c++,l/=2),c+v>=f?(d=0,c=f):c+v>=1?(d=(e*l-1)*o(2,t),c+=v):(d=e*o(2,v-1)*o(2,t),c=0));t>=8;p[m++]=255&d,d/=256,t-=8);for(c=c<<t|d,h+=t;h>0;p[m++]=255&c,c/=256,h-=8);return p[--m]|=128*y,p},unpack:function(e,t){var n,r=e.length,i=8*r-t-1,a=(1<<i)-1,s=a>>1,u=i-7,c=r-1,d=e[c--],l=127&d;for(d>>=7;u>0;l=256*l+e[c],c--,u-=8);for(n=l&(1<<-u)-1,l>>=-u,u+=t;u>0;n=256*n+e[c],c--,u-=8);if(0===l)l=1-s;else{if(l===a)return n?NaN:d?-1/0:1/0;n+=o(2,t),l-=s}return(d?-1:1)*n*o(2,l-t)}}},6801:function(e,t,n){var r=n(7230),i=n(1916),o=n(3694),a=n(2248),s=r.Object,u=i("".split);e.exports=o((function(){return!s("z").propertyIsEnumerable(0)}))?function(e){return"String"==a(e)?u(e,""):s(e)}:s},8089:function(e,t,n){var r=n(933),i=n(6913),o=n(1403);e.exports=function(e,t,n){var a,s;return o&&r(a=t.constructor)&&a!==n&&i(s=a.prototype)&&s!==n.prototype&&o(e,s),e}},4335:function(e,t,n){var r=n(1916),i=n(933),o=n(1393),a=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return a(e)}),e.exports=o.inspectSource},3792:function(e,t,n){var r=n(5302),i=n(1916),o=n(7076),a=n(6913),s=n(3225),u=n(7108).f,c=n(7852),d=n(3959),l=n(4525),p=n(2913),h=!1,f=l("meta"),v=0,g=Object.isExtensible||function(){return!0},y=function(e){u(e,f,{value:{objectID:"O"+v++,weakData:{}}})},m=e.exports={enable:function(){m.enable=function(){},h=!0;var e=c.f,t=i([].splice),n={};n[f]=1,e(n).length&&(c.f=function(n){for(var r=e(n),i=0,o=r.length;i<o;i++)if(r[i]===f){t(r,i,1);break}return r},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:d.f}))},fastKey:function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!s(e,f)){if(!g(e))return"F";if(!t)return"E";y(e)}return e[f].objectID},getWeakData:function(e,t){if(!s(e,f)){if(!g(e))return!0;if(!t)return!1;y(e)}return e[f].weakData},onFreeze:function(e){return p&&h&&g(e)&&!s(e,f)&&y(e),e}};o[f]=!0},21:function(e,t,n){var r,i,o,a=n(5506),s=n(7230),u=n(1916),c=n(6913),d=n(5399),l=n(3225),p=n(1393),h=n(375),f=n(7076),v="Object already initialized",g=s.TypeError,y=s.WeakMap;if(a||p.state){var m=p.state||(p.state=new y),S=u(m.get),I=u(m.has),T=u(m.set);r=function(e,t){if(I(m,e))throw new g(v);return t.facade=e,T(m,e,t),t},i=function(e){return S(m,e)||{}},o=function(e){return I(m,e)}}else{var R=h("state");f[R]=!0,r=function(e,t){if(l(e,R))throw new g(v);return t.facade=e,d(e,R,t),t},i=function(e){return l(e,R)?e[R]:{}},o=function(e){return l(e,R)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=i(t)).type!==e)throw g("Incompatible receiver, "+e+" required");return n}}}},1855:function(e,t,n){var r=n(7952),i=n(3019),o=r("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||a[o]===e)}},4893:function(e,t,n){var r=n(2248);e.exports=Array.isArray||function(e){return"Array"==r(e)}},933:function(e){e.exports=function(e){return"function"==typeof e}},3538:function(e,t,n){var r=n(1916),i=n(3694),o=n(933),a=n(996),s=n(1223),u=n(4335),c=function(){},d=[],l=s("Reflect","construct"),p=/^\s*(?:class|function)\b/,h=r(p.exec),f=!p.exec(c),v=function(e){if(!o(e))return!1;try{return l(c,d,e),!0}catch(t){return!1}};e.exports=!l||i((function(){var e;return v(v.call)||!v(Object)||!v((function(){e=!0}))||e}))?function(e){if(!o(e))return!1;switch(a(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}return f||!!h(p,u(e))}:v},4545:function(e,t,n){var r=n(3694),i=n(933),o=/#|\.prototype\./,a=function(e,t){var n=u[s(e)];return n==d||n!=c&&(i(t)?r(t):!!t)},s=a.normalize=function(e){return String(e).replace(o,".").toLowerCase()},u=a.data={},c=a.NATIVE="N",d=a.POLYFILL="P";e.exports=a},2604:function(e,t,n){var r=n(6913),i=Math.floor;e.exports=Number.isInteger||function(e){return!r(e)&&isFinite(e)&&i(e)===e}},6913:function(e,t,n){var r=n(933);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},7442:function(e){e.exports=!1},385:function(e,t,n){var r=n(6913),i=n(2248),o=n(7952)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},7581:function(e,t,n){var r=n(7230),i=n(1223),o=n(933),a=n(2346),s=n(9264),u=r.Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return o(t)&&a(t.prototype,u(e))}},5103:function(e,t,n){var r=n(7230),i=n(1248),o=n(4225),a=n(3536),s=n(321),u=n(1855),c=n(1646),d=n(2346),l=n(9853),p=n(6418),h=n(5635),f=r.TypeError,v=function(e,t){this.stopped=e,this.result=t},g=v.prototype;e.exports=function(e,t,n){var r,y,m,S,I,T,R,b=n&&n.that,P=!(!n||!n.AS_ENTRIES),E=!(!n||!n.IS_ITERATOR),x=!(!n||!n.INTERRUPTED),A=i(t,b),w=function(e){return r&&h(r,"normal",e),new v(!0,e)},C=function(e){return P?(a(e),x?A(e[0],e[1],w):A(e[0],e[1])):x?A(e,w):A(e)};if(E)r=e;else{if(!(y=p(e)))throw f(s(e)+" is not iterable");if(u(y)){for(m=0,S=c(e);S>m;m++)if((I=C(e[m]))&&d(g,I))return I;return new v(!1)}r=l(e,y)}for(T=r.next;!(R=o(T,r)).done;){try{I=C(R.value)}catch(D){h(r,"throw",D)}if("object"==typeof I&&I&&d(g,I))return I}return new v(!1)}},5635:function(e,t,n){var r=n(4225),i=n(3536),o=n(5048);e.exports=function(e,t,n){var a,s;i(e);try{if(!(a=o(e,"return"))){if("throw"===t)throw n;return n}a=r(a,e)}catch(u){s=!0,a=u}if("throw"===t)throw n;if(s)throw a;return i(a),n}},7824:function(e,t,n){"use strict";var r,i,o,a=n(3694),s=n(933),u=n(6997),c=n(5024),d=n(3926),l=n(7952),p=n(7442),h=l("iterator"),f=!1;[].keys&&("next"in(o=[].keys())?(i=c(c(o)))!==Object.prototype&&(r=i):f=!0),void 0==r||a((function(){var e={};return r[h].call(e)!==e}))?r={}:p&&(r=u(r)),s(r[h])||d(r,h,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:f}},3019:function(e){e.exports={}},1646:function(e,t,n){var r=n(6092);e.exports=function(e){return r(e.length)}},3012:function(e,t,n){var r,i,o,a,s,u,c,d,l=n(7230),p=n(1248),h=n(5027).f,f=n(7823).set,v=n(4619),g=n(4370),y=n(2811),m=n(5009),S=l.MutationObserver||l.WebKitMutationObserver,I=l.document,T=l.process,R=l.Promise,b=h(l,"queueMicrotask"),P=b&&b.value;P||(r=function(){var e,t;for(m&&(e=T.domain)&&e.exit();i;){t=i.fn,i=i.next;try{t()}catch(n){throw i?a():o=void 0,n}}o=void 0,e&&e.enter()},v||m||y||!S||!I?!g&&R&&R.resolve?((c=R.resolve(void 0)).constructor=R,d=p(c.then,c),a=function(){d(r)}):m?a=function(){T.nextTick(r)}:(f=p(f,l),a=function(){f(r)}):(s=!0,u=I.createTextNode(""),new S(r).observe(u,{characterData:!0}),a=function(){u.data=s=!s})),e.exports=P||function(e){var t={fn:e,next:void 0};o&&(o.next=t),i||(i=t,a()),o=t}},3479:function(e,t,n){var r=n(7230);e.exports=r.Promise},8724:function(e,t,n){var r=n(7806),i=n(3694);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},4169:function(e,t,n){var r=n(3694),i=n(7952),o=n(7442),a=i("iterator");e.exports=!r((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,r){t.delete("b"),n+=r+e})),o&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://").host||"#%D0%B1"!==new URL("http://a#").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},5506:function(e,t,n){var r=n(7230),i=n(933),o=n(4335),a=r.WeakMap;e.exports=i(a)&&/native code/.test(o(a))},6935:function(e,t,n){"use strict";var r=n(3200),i=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new i(e)}},6487:function(e,t,n){var r=n(7230),i=n(385),o=r.TypeError;e.exports=function(e){if(i(e))throw o("The method doesn't accept regular expressions");return e}},5016:function(e,t,n){"use strict";var r=n(6079),i=n(1916),o=n(4225),a=n(3694),s=n(6127),u=n(7375),c=n(5486),d=n(987),l=n(6801),p=Object.assign,h=Object.defineProperty,f=i([].concat);e.exports=!p||a((function(){if(r&&1!==p({b:1},p(h({},"a",{enumerable:!0,get:function(){h(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach((function(e){t[e]=e})),7!=p({},e)[n]||s(p({},t)).join("")!=i}))?function(e,t){for(var n=d(e),i=arguments.length,a=1,p=u.f,h=c.f;i>a;)for(var v,g=l(arguments[a++]),y=p?f(s(g),p(g)):s(g),m=y.length,S=0;m>S;)v=y[S++],r&&!o(h,g,v)||(n[v]=g[v]);return n}:p},6997:function(e,t,n){var r,i=n(3536),o=n(7673),a=n(9799),s=n(7076),u=n(6507),c=n(2200),d=n(375)("IE_PROTO"),l=function(){},p=function(e){return"<script>"+e+"<\/script>"},h=function(e){e.write(p("")),e.close();var t=e.parentWindow.Object;return e=null,t},f=function(){try{r=new ActiveXObject("htmlfile")}catch(t){}f="undefined"!=typeof document?document.domain&&r?h(r):function(){var e,t=c("iframe");return t.style.display="none",u.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(p("document.F=Object")),e.close(),e.F}():h(r);for(var e=a.length;e--;)delete f.prototype[a[e]];return f()};s[d]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(l.prototype=i(e),n=new l,l.prototype=null,n[d]=e):n=f(),void 0===t?n:o(n,t)}},7673:function(e,t,n){var r=n(6079),i=n(7108),o=n(3536),a=n(9164),s=n(6127);e.exports=r?Object.defineProperties:function(e,t){o(e);for(var n,r=a(t),u=s(t),c=u.length,d=0;c>d;)i.f(e,n=u[d++],r[n]);return e}},7108:function(e,t,n){var r=n(7230),i=n(6079),o=n(4253),a=n(3536),s=n(5831),u=r.TypeError,c=Object.defineProperty;t.f=i?c:function(e,t,n){if(a(e),t=s(t),a(n),o)try{return c(e,t,n)}catch(r){}if("get"in n||"set"in n)throw u("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},5027:function(e,t,n){var r=n(6079),i=n(4225),o=n(5486),a=n(8828),s=n(9164),u=n(5831),c=n(3225),d=n(4253),l=Object.getOwnPropertyDescriptor;t.f=r?l:function(e,t){if(e=s(e),t=u(t),d)try{return l(e,t)}catch(n){}if(c(e,t))return a(!i(o.f,e,t),e[t])}},3959:function(e,t,n){var r=n(2248),i=n(9164),o=n(7852).f,a=n(9663),s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return s&&"Window"==r(e)?function(e){try{return o(e)}catch(t){return a(s)}}(e):o(i(e))}},7852:function(e,t,n){var r=n(3821),i=n(9799).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},7375:function(e,t){t.f=Object.getOwnPropertySymbols},5024:function(e,t,n){var r=n(7230),i=n(3225),o=n(933),a=n(987),s=n(375),u=n(560),c=s("IE_PROTO"),d=r.Object,l=d.prototype;e.exports=u?d.getPrototypeOf:function(e){var t=a(e);if(i(t,c))return t[c];var n=t.constructor;return o(n)&&t instanceof n?n.prototype:t instanceof d?l:null}},2346:function(e,t,n){var r=n(1916);e.exports=r({}.isPrototypeOf)},3821:function(e,t,n){var r=n(1916),i=n(3225),o=n(9164),a=n(7945).indexOf,s=n(7076),u=r([].push);e.exports=function(e,t){var n,r=o(e),c=0,d=[];for(n in r)!i(s,n)&&i(r,n)&&u(d,n);for(;t.length>c;)i(r,n=t[c++])&&(~a(d,n)||u(d,n));return d}},6127:function(e,t,n){var r=n(3821),i=n(9799);e.exports=Object.keys||function(e){return r(e,i)}},5486:function(e,t){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},1403:function(e,t,n){var r=n(1916),i=n(3536),o=n(8563);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(a){}return function(n,r){return i(n),o(r),t?e(n,r):n.__proto__=r,n}}():void 0)},4168:function(e,t,n){"use strict";var r=n(6695),i=n(996);e.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},7013:function(e,t,n){var r=n(7230),i=n(4225),o=n(933),a=n(6913),s=r.TypeError;e.exports=function(e,t){var n,r;if("string"===t&&o(n=e.toString)&&!a(r=i(n,e)))return r;if(o(n=e.valueOf)&&!a(r=i(n,e)))return r;if("string"!==t&&o(n=e.toString)&&!a(r=i(n,e)))return r;throw s("Can't convert object to primitive value")}},3697:function(e,t,n){var r=n(1223),i=n(1916),o=n(7852),a=n(7375),s=n(3536),u=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(s(e)),n=a.f;return n?u(t,n(e)):t}},5030:function(e,t,n){var r=n(7230);e.exports=r},7731:function(e){e.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}},8888:function(e,t,n){var r=n(3536),i=n(6913),o=n(6935);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},7777:function(e,t,n){var r=n(3926);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},3926:function(e,t,n){var r=n(7230),i=n(933),o=n(3225),a=n(5399),s=n(746),u=n(4335),c=n(21),d=n(567).CONFIGURABLE,l=c.get,p=c.enforce,h=String(String).split("String");(e.exports=function(e,t,n,u){var c,l=!!u&&!!u.unsafe,f=!!u&&!!u.enumerable,v=!!u&&!!u.noTargetGet,g=u&&void 0!==u.name?u.name:t;i(n)&&("Symbol("===String(g).slice(0,7)&&(g="["+String(g).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!o(n,"name")||d&&n.name!==g)&&a(n,"name",g),(c=p(n)).source||(c.source=h.join("string"==typeof g?g:""))),e!==r?(l?!v&&e[t]&&(f=!0):delete e[t],f?e[t]=n:a(e,t,n)):f?e[t]=n:s(t,n)})(Function.prototype,"toString",(function(){return i(this)&&l(this).source||u(this)}))},5731:function(e,t,n){var r=n(7230),i=n(4225),o=n(3536),a=n(933),s=n(2248),u=n(9735),c=r.TypeError;e.exports=function(e,t){var n=e.exec;if(a(n)){var r=i(n,e,t);return null!==r&&o(r),r}if("RegExp"===s(e))return i(u,e,t);throw c("RegExp#exec called on incompatible receiver")}},9735:function(e,t,n){"use strict";var r=n(4225),i=n(1916),o=n(9851),a=n(8608),s=n(9154),u=n(3268),c=n(6997),d=n(21).get,l=n(5021),p=n(2916),h=u("native-string-replace",String.prototype.replace),f=RegExp.prototype.exec,v=f,g=i("".charAt),y=i("".indexOf),m=i("".replace),S=i("".slice),I=function(){var e=/a/,t=/b*/g;return r(f,e,"a"),r(f,t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),T=s.UNSUPPORTED_Y||s.BROKEN_CARET,R=void 0!==/()??/.exec("")[1];(I||R||T||l||p)&&(v=function(e){var t,n,i,s,u,l,p,b=this,P=d(b),E=o(e),x=P.raw;if(x)return x.lastIndex=b.lastIndex,t=r(v,x,E),b.lastIndex=x.lastIndex,t;var A=P.groups,w=T&&b.sticky,C=r(a,b),D=b.source,k=0,O=E;if(w&&(C=m(C,"y",""),-1===y(C,"g")&&(C+="g"),O=S(E,b.lastIndex),b.lastIndex>0&&(!b.multiline||b.multiline&&"\n"!==g(E,b.lastIndex-1))&&(D="(?: "+D+")",O=" "+O,k++),n=new RegExp("^(?:"+D+")",C)),R&&(n=new RegExp("^"+D+"$(?!\\s)",C)),I&&(i=b.lastIndex),s=r(f,w?n:b,O),w?s?(s.input=S(s.input,k),s[0]=S(s[0],k),s.index=b.lastIndex,b.lastIndex+=s[0].length):b.lastIndex=0:I&&s&&(b.lastIndex=b.global?s.index+s[0].length:i),R&&s&&s.length>1&&r(h,s[0],n,(function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(s[u]=void 0)})),s&&A)for(s.groups=l=c(null),u=0;u<A.length;u++)l[(p=A[u])[0]]=s[p[1]];return s}),e.exports=v},8608:function(e,t,n){"use strict";var r=n(3536);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},9154:function(e,t,n){var r=n(3694),i=n(7230).RegExp;t.UNSUPPORTED_Y=r((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=r((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},5021:function(e,t,n){var r=n(3694),i=n(7230).RegExp;e.exports=r((function(){var e=i(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},2916:function(e,t,n){var r=n(3694),i=n(7230).RegExp;e.exports=r((function(){var e=i("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},7105:function(e,t,n){var r=n(7230).TypeError;e.exports=function(e){if(void 0==e)throw r("Can't call method on "+e);return e}},1262:function(e){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},746:function(e,t,n){var r=n(7230),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},6898:function(e,t,n){"use strict";var r=n(1223),i=n(7108),o=n(7952),a=n(6079),s=o("species");e.exports=function(e){var t=r(e),n=i.f;a&&t&&!t[s]&&n(t,s,{configurable:!0,get:function(){return this}})}},5411:function(e,t,n){var r=n(7108).f,i=n(3225),o=n(7952)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},375:function(e,t,n){var r=n(3268),i=n(4525),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},1393:function(e,t,n){var r=n(7230),i=n(746),o="__core-js_shared__",a=r[o]||i(o,{});e.exports=a},3268:function(e,t,n){var r=n(7442),i=n(1393);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.19.0",mode:r?"pure":"global",copyright:" 2021 Denis Pushkarev (zloirock.ru)"})},640:function(e,t,n){var r=n(3536),i=n(4831),o=n(7952)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||void 0==(n=r(a)[o])?t:i(n)}},2370:function(e,t,n){var r=n(1916),i=n(4982),o=n(9851),a=n(7105),s=r("".charAt),u=r("".charCodeAt),c=r("".slice),d=function(e){return function(t,n){var r,d,l=o(a(t)),p=i(n),h=l.length;return p<0||p>=h?e?"":void 0:(r=u(l,p))<55296||r>56319||p+1===h||(d=u(l,p+1))<56320||d>57343?e?s(l,p):r:e?c(l,p,p+2):d-56320+(r-55296<<10)+65536}};e.exports={codeAt:d(!1),charAt:d(!0)}},7137:function(e,t,n){"use strict";var r=n(7230),i=n(1916),o=2147483647,a=/[^\0-\u007E]/,s=/[.\u3002\uFF0E\uFF61]/g,u="Overflow: input needs wider integers to process",c=r.RangeError,d=i(s.exec),l=Math.floor,p=String.fromCharCode,h=i("".charCodeAt),f=i([].join),v=i([].push),g=i("".replace),y=i("".split),m=i("".toLowerCase),S=function(e){return e+22+75*(e<26)},I=function(e,t,n){var r=0;for(e=n?l(e/700):e>>1,e+=l(e/t);e>455;r+=36)e=l(e/35);return l(r+36*e/(e+38))},T=function(e){var t=[];e=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=h(e,n++);if(i>=55296&&i<=56319&&n<r){var o=h(e,n++);56320==(64512&o)?v(t,((1023&i)<<10)+(1023&o)+65536):(v(t,i),n--)}else v(t,i)}return t}(e);var n,r,i=e.length,a=128,s=0,d=72;for(n=0;n<e.length;n++)(r=e[n])<128&&v(t,p(r));var g=t.length,y=g;for(g&&v(t,"-");y<i;){var m=o;for(n=0;n<e.length;n++)(r=e[n])>=a&&r<m&&(m=r);var T=y+1;if(m-a>l((o-s)/T))throw c(u);for(s+=(m-a)*T,a=m,n=0;n<e.length;n++){if((r=e[n])<a&&++s>o)throw c(u);if(r==a){for(var R=s,b=36;;b+=36){var P=b<=d?1:b>=d+26?26:b-d;if(R<P)break;var E=R-P,x=36-P;v(t,p(S(P+E%x))),R=l(E/x)}v(t,p(S(R))),d=I(s,T,y==g),s=0,++y}}++s,++a}return f(t,"")};e.exports=function(e){var t,n,r=[],i=y(g(m(e),s,"."),".");for(t=0;t<i.length;t++)n=i[t],v(r,d(a,n)?"xn--"+T(n):n);return f(r,".")}},7823:function(e,t,n){var r,i,o,a,s=n(7230),u=n(251),c=n(1248),d=n(933),l=n(3225),p=n(3694),h=n(6507),f=n(9663),v=n(2200),g=n(4619),y=n(5009),m=s.setImmediate,S=s.clearImmediate,I=s.process,T=s.Dispatch,R=s.Function,b=s.MessageChannel,P=s.String,E=0,x={};try{r=s.location}catch(k){}var A=function(e){if(l(x,e)){var t=x[e];delete x[e],t()}},w=function(e){return function(){A(e)}},C=function(e){A(e.data)},D=function(e){s.postMessage(P(e),r.protocol+"//"+r.host)};m&&S||(m=function(e){var t=f(arguments,1);return x[++E]=function(){u(d(e)?e:R(e),void 0,t)},i(E),E},S=function(e){delete x[e]},y?i=function(e){I.nextTick(w(e))}:T&&T.now?i=function(e){T.now(w(e))}:b&&!g?(a=(o=new b).port2,o.port1.onmessage=C,i=c(a.postMessage,a)):s.addEventListener&&d(s.postMessage)&&!s.importScripts&&r&&"file:"!==r.protocol&&!p(D)?(i=D,s.addEventListener("message",C,!1)):i="onreadystatechange"in v("script")?function(e){h.appendChild(v("script")).onreadystatechange=function(){h.removeChild(this),A(e)}}:function(e){setTimeout(w(e),0)}),e.exports={set:m,clear:S}},2966:function(e,t,n){var r=n(4982),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},4800:function(e,t,n){var r=n(7230),i=n(4982),o=n(6092),a=r.RangeError;e.exports=function(e){if(void 0===e)return 0;var t=i(e),n=o(t);if(t!==n)throw a("Wrong length or index");return n}},9164:function(e,t,n){var r=n(6801),i=n(7105);e.exports=function(e){return r(i(e))}},4982:function(e){var t=Math.ceil,n=Math.floor;e.exports=function(e){var r=+e;return r!==r||0===r?0:(r>0?n:t)(r)}},6092:function(e,t,n){var r=n(4982),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},987:function(e,t,n){var r=n(7230),i=n(7105),o=r.Object;e.exports=function(e){return o(i(e))}},1302:function(e,t,n){var r=n(7230),i=n(9643),o=r.RangeError;e.exports=function(e,t){var n=i(e);if(n%t)throw o("Wrong offset");return n}},9643:function(e,t,n){var r=n(7230),i=n(4982),o=r.RangeError;e.exports=function(e){var t=i(e);if(t<0)throw o("The argument can't be less than 0");return t}},5962:function(e,t,n){var r=n(7230),i=n(4225),o=n(6913),a=n(7581),s=n(5048),u=n(7013),c=n(7952),d=r.TypeError,l=c("toPrimitive");e.exports=function(e,t){if(!o(e)||a(e))return e;var n,r=s(e,l);if(r){if(void 0===t&&(t="default"),n=i(r,e,t),!o(n)||a(n))return n;throw d("Can't convert object to primitive value")}return void 0===t&&(t="number"),u(e,t)}},5831:function(e,t,n){var r=n(5962),i=n(7581);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},6695:function(e,t,n){var r={};r[n(7952)("toStringTag")]="z",e.exports="[object z]"===String(r)},9851:function(e,t,n){var r=n(7230),i=n(996),o=r.String;e.exports=function(e){if("Symbol"===i(e))throw TypeError("Cannot convert a Symbol value to a string");return o(e)}},321:function(e,t,n){var r=n(7230).String;e.exports=function(e){try{return r(e)}catch(t){return"Object"}}},8298:function(e,t,n){"use strict";var r=n(5302),i=n(7230),o=n(4225),a=n(6079),s=n(3462),u=n(7740),c=n(2292),d=n(5209),l=n(8828),p=n(5399),h=n(2604),f=n(6092),v=n(4800),g=n(1302),y=n(5831),m=n(3225),S=n(996),I=n(6913),T=n(7581),R=n(6997),b=n(2346),P=n(1403),E=n(7852).f,x=n(9740),A=n(1569).forEach,w=n(6898),C=n(7108),D=n(5027),k=n(21),O=n(8089),M=k.get,F=k.set,_=C.f,L=D.f,q=Math.round,G=i.RangeError,W=c.ArrayBuffer,N=W.prototype,U=c.DataView,H=u.NATIVE_ARRAY_BUFFER_VIEWS,j=u.TYPED_ARRAY_CONSTRUCTOR,B=u.TYPED_ARRAY_TAG,Q=u.TypedArray,V=u.TypedArrayPrototype,J=u.aTypedArrayConstructor,Z=u.isTypedArray,z="BYTES_PER_ELEMENT",K="Wrong length",Y=function(e,t){J(e);for(var n=0,r=t.length,i=new e(r);r>n;)i[n]=t[n++];return i},$=function(e,t){_(e,t,{get:function(){return M(this)[t]}})},X=function(e){var t;return b(N,e)||"ArrayBuffer"==(t=S(e))||"SharedArrayBuffer"==t},ee=function(e,t){return Z(e)&&!T(t)&&t in e&&h(+t)&&t>=0},te=function(e,t){return t=y(t),ee(e,t)?l(2,e[t]):L(e,t)},ne=function(e,t,n){return t=y(t),!(ee(e,t)&&I(n)&&m(n,"value"))||m(n,"get")||m(n,"set")||n.configurable||m(n,"writable")&&!n.writable||m(n,"enumerable")&&!n.enumerable?_(e,t,n):(e[t]=n.value,e)};a?(H||(D.f=te,C.f=ne,$(V,"buffer"),$(V,"byteOffset"),$(V,"byteLength"),$(V,"length")),r({target:"Object",stat:!0,forced:!H},{getOwnPropertyDescriptor:te,defineProperty:ne}),e.exports=function(e,t,n){var a=e.match(/\d+$/)[0]/8,u=e+(n?"Clamped":"")+"Array",c="get"+e,l="set"+e,h=i[u],y=h,m=y&&y.prototype,S={},T=function(e,t){_(e,t,{get:function(){return function(e,t){var n=M(e);return n.view[c](t*a+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,r){var i=M(e);n&&(r=(r=q(r))<0?0:r>255?255:255&r),i.view[l](t*a+i.byteOffset,r,!0)}(this,t,e)},enumerable:!0})};H?s&&(y=t((function(e,t,n,r){return d(e,m),O(I(t)?X(t)?void 0!==r?new h(t,g(n,a),r):void 0!==n?new h(t,g(n,a)):new h(t):Z(t)?Y(y,t):o(x,y,t):new h(v(t)),e,y)})),P&&P(y,Q),A(E(h),(function(e){e in y||p(y,e,h[e])})),y.prototype=m):(y=t((function(e,t,n,r){d(e,m);var i,s,u,c=0,l=0;if(I(t)){if(!X(t))return Z(t)?Y(y,t):o(x,y,t);i=t,l=g(n,a);var p=t.byteLength;if(void 0===r){if(p%a)throw G(K);if((s=p-l)<0)throw G(K)}else if((s=f(r)*a)+l>p)throw G(K);u=s/a}else u=v(t),i=new W(s=u*a);for(F(e,{buffer:i,byteOffset:l,byteLength:s,length:u,view:new U(i)});c<u;)T(e,c++)})),P&&P(y,Q),m=y.prototype=R(V)),m.constructor!==y&&p(m,"constructor",y),p(m,j,y),B&&p(m,B,u),S[u]=y,r({global:!0,forced:y!=h,sham:!H},S),z in y||p(y,z,a),z in m||p(m,z,a),w(u)}):e.exports=function(){}},3462:function(e,t,n){var r=n(7230),i=n(3694),o=n(1964),a=n(7740).NATIVE_ARRAY_BUFFER_VIEWS,s=r.ArrayBuffer,u=r.Int8Array;e.exports=!a||!i((function(){u(1)}))||!i((function(){new u(-1)}))||!o((function(e){new u,new u(null),new u(1.5),new u(e)}),!0)||i((function(){return 1!==new u(new s(2),1,void 0).length}))},6425:function(e,t,n){var r=n(7004),i=n(4647);e.exports=function(e,t){return r(i(e),t)}},9740:function(e,t,n){var r=n(1248),i=n(4225),o=n(4831),a=n(987),s=n(1646),u=n(9853),c=n(6418),d=n(1855),l=n(7740).aTypedArrayConstructor;e.exports=function(e){var t,n,p,h,f,v,g=o(this),y=a(e),m=arguments.length,S=m>1?arguments[1]:void 0,I=void 0!==S,T=c(y);if(T&&!d(T))for(v=(f=u(y,T)).next,y=[];!(h=i(v,f)).done;)y.push(h.value);for(I&&m>2&&(S=r(S,arguments[2])),n=s(y),p=new(l(g))(n),t=0;n>t;t++)p[t]=I?S(y[t],t):y[t];return p}},4647:function(e,t,n){var r=n(7740),i=n(640),o=r.TYPED_ARRAY_CONSTRUCTOR,a=r.aTypedArrayConstructor;e.exports=function(e){return a(i(e,e[o]))}},4525:function(e,t,n){var r=n(1916),i=0,o=Math.random(),a=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++i+o,36)}},9264:function(e,t,n){var r=n(8724);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3081:function(e,t,n){var r=n(7952);t.f=r},7952:function(e,t,n){var r=n(7230),i=n(3268),o=n(3225),a=n(4525),s=n(8724),u=n(9264),c=i("wks"),d=r.Symbol,l=d&&d.for,p=u?d:d&&d.withoutSetter||a;e.exports=function(e){if(!o(c,e)||!s&&"string"!=typeof c[e]){var t="Symbol."+e;s&&o(d,e)?c[e]=d[e]:c[e]=u&&l?l(t):p(t)}return c[e]}},1938:function(e,t,n){"use strict";var r=n(5302),i=n(1916),o=n(3694),a=n(2292),s=n(3536),u=n(2966),c=n(6092),d=n(640),l=a.ArrayBuffer,p=a.DataView,h=p.prototype,f=i(l.prototype.slice),v=i(h.getUint8),g=i(h.setUint8);r({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:o((function(){return!new l(2).slice(1,void 0).byteLength}))},{slice:function(e,t){if(f&&void 0===t)return f(s(this),e);for(var n=s(this).byteLength,r=u(e,n),i=u(void 0===t?n:t,n),o=new(d(this,l))(c(i-r)),a=new p(this),h=new p(o),y=0;r<i;)g(h,y++,v(a,r++));return o}})},9655:function(e,t,n){"use strict";var r=n(5302),i=n(7230),o=n(3694),a=n(4893),s=n(6913),u=n(987),c=n(1646),d=n(3859),l=n(1204),p=n(9321),h=n(7952),f=n(7806),v=h("isConcatSpreadable"),g=9007199254740991,y="Maximum allowed index exceeded",m=i.TypeError,S=f>=51||!o((function(){var e=[];return e[v]=!1,e.concat()[0]!==e})),I=p("concat"),T=function(e){if(!s(e))return!1;var t=e[v];return void 0!==t?!!t:a(e)};r({target:"Array",proto:!0,forced:!S||!I},{concat:function(e){var t,n,r,i,o,a=u(this),s=l(a,0),p=0;for(t=-1,r=arguments.length;t<r;t++)if(T(o=-1===t?a:arguments[t])){if(p+(i=c(o))>g)throw m(y);for(n=0;n<i;n++,p++)n in o&&d(s,p,o[n])}else{if(p>=g)throw m(y);d(s,p++,o)}return s.length=p,s}})},7505:function(e,t,n){"use strict";var r=n(5302),i=n(1569).filter;r({target:"Array",proto:!0,forced:!n(9321)("filter")},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},1871:function(e,t,n){"use strict";var r=n(5302),i=n(1569).find,o=n(186),a="find",s=!0;a in[]&&Array(1).find((function(){s=!1})),r({target:"Array",proto:!0,forced:s},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o(a)},5991:function(e,t,n){var r=n(5302),i=n(8897);r({target:"Array",stat:!0,forced:!n(1964)((function(e){Array.from(e)}))},{from:i})},6025:function(e,t,n){"use strict";var r=n(5302),i=n(7945).includes,o=n(186);r({target:"Array",proto:!0},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},4836:function(e,t,n){"use strict";var r=n(9164),i=n(186),o=n(3019),a=n(21),s=n(3392),u="Array Iterator",c=a.set,d=a.getterFor(u);e.exports=s(Array,"Array",(function(e,t){c(this,{type:u,target:r(e),index:0,kind:t})}),(function(){var e=d(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},284:function(e,t,n){"use strict";var r=n(5302),i=n(1916),o=n(6801),a=n(9164),s=n(2245),u=i([].join),c=o!=Object,d=s("join",",");r({target:"Array",proto:!0,forced:c||!d},{join:function(e){return u(a(this),void 0===e?",":e)}})},372:function(e,t,n){"use strict";var r=n(5302),i=n(1569).map;r({target:"Array",proto:!0,forced:!n(9321)("map")},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},3289:function(e,t,n){"use strict";var r=n(5302),i=n(7230),o=n(4893),a=n(3538),s=n(6913),u=n(2966),c=n(1646),d=n(9164),l=n(3859),p=n(7952),h=n(9321),f=n(9663),v=h("slice"),g=p("species"),y=i.Array,m=Math.max;r({target:"Array",proto:!0,forced:!v},{slice:function(e,t){var n,r,i,p=d(this),h=c(p),v=u(e,h),S=u(void 0===t?h:t,h);if(o(p)&&(n=p.constructor,(a(n)&&(n===y||o(n.prototype))||s(n)&&null===(n=n[g]))&&(n=void 0),n===y||void 0===n))return f(p,v,S);for(r=new(void 0===n?y:n)(m(S-v,0)),i=0;v<S;v++,i++)v in p&&l(r,i,p[v]);return r.length=i,r}})},8855:function(e,t,n){var r=n(6079),i=n(567).EXISTS,o=n(1916),a=n(7108).f,s=Function.prototype,u=o(s.toString),c=/^\s*function ([^ (]*)/,d=o(c.exec);r&&!i&&a(s,"name",{configurable:!0,get:function(){try{return d(c,u(this))[1]}catch(e){return""}}})},7134:function(e,t,n){"use strict";n(5003)("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(3342))},110:function(e,t,n){var r=n(5302),i=n(5016);r({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},7446:function(e,t,n){var r=n(5302),i=n(3694),o=n(3959).f;r({target:"Object",stat:!0,forced:i((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:o})},7186:function(e,t,n){var r=n(5302),i=n(987),o=n(6127);r({target:"Object",stat:!0,forced:n(3694)((function(){o(1)}))},{keys:function(e){return o(i(e))}})},2981:function(e,t,n){var r=n(6695),i=n(3926),o=n(4168);r||i(Object.prototype,"toString",o,{unsafe:!0})},5754:function(e,t,n){"use strict";var r,i,o,a,s=n(5302),u=n(7442),c=n(7230),d=n(1223),l=n(4225),p=n(3479),h=n(3926),f=n(7777),v=n(1403),g=n(5411),y=n(6898),m=n(3200),S=n(933),I=n(6913),T=n(5209),R=n(4335),b=n(5103),P=n(1964),E=n(640),x=n(7823).set,A=n(3012),w=n(8888),C=n(5812),D=n(6935),k=n(7731),O=n(21),M=n(4545),F=n(7952),_=n(417),L=n(5009),q=n(7806),G=F("species"),W="Promise",N=O.get,U=O.set,H=O.getterFor(W),j=p&&p.prototype,B=p,Q=j,V=c.TypeError,J=c.document,Z=c.process,z=D.f,K=z,Y=!!(J&&J.createEvent&&c.dispatchEvent),$=S(c.PromiseRejectionEvent),X="unhandledrejection",ee=!1,te=M(W,(function(){var e=R(B),t=e!==String(B);if(!t&&66===q)return!0;if(u&&!Q.finally)return!0;if(q>=51&&/native code/.test(e))return!1;var n=new B((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};return(n.constructor={})[G]=r,!(ee=n.then((function(){}))instanceof r)||!t&&_&&!$})),ne=te||!P((function(e){B.all(e).catch((function(){}))})),re=function(e){var t;return!(!I(e)||!S(t=e.then))&&t},ie=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;A((function(){for(var r=e.value,i=1==e.state,o=0;n.length>o;){var a,s,u,c=n[o++],d=i?c.ok:c.fail,p=c.resolve,h=c.reject,f=c.domain;try{d?(i||(2===e.rejection&&ue(e),e.rejection=1),!0===d?a=r:(f&&f.enter(),a=d(r),f&&(f.exit(),u=!0)),a===c.promise?h(V("Promise-chain cycle")):(s=re(a))?l(s,a,p,h):p(a)):h(r)}catch(v){f&&!u&&f.exit(),h(v)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&ae(e)}))}},oe=function(e,t,n){var r,i;Y?((r=J.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),c.dispatchEvent(r)):r={promise:t,reason:n},!$&&(i=c["on"+e])?i(r):e===X&&C("Unhandled promise rejection",n)},ae=function(e){l(x,c,(function(){var t,n=e.facade,r=e.value;if(se(e)&&(t=k((function(){L?Z.emit("unhandledRejection",r,n):oe(X,n,r)})),e.rejection=L||se(e)?2:1,t.error))throw t.value}))},se=function(e){return 1!==e.rejection&&!e.parent},ue=function(e){l(x,c,(function(){var t=e.facade;L?Z.emit("rejectionHandled",t):oe("rejectionhandled",t,e.value)}))},ce=function(e,t,n){return function(r){e(t,r,n)}},de=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,ie(e,!0))},le=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw V("Promise can't be resolved itself");var r=re(t);r?A((function(){var n={done:!1};try{l(r,t,ce(le,n,e),ce(de,n,e))}catch(i){de(n,i,e)}})):(e.value=t,e.state=1,ie(e,!1))}catch(i){de({done:!1},i,e)}}};if(te&&(Q=(B=function(e){T(this,Q),m(e),l(r,this);var t=N(this);try{e(ce(le,t),ce(de,t))}catch(n){de(t,n)}}).prototype,(r=function(e){U(this,{type:W,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=f(Q,{then:function(e,t){var n=H(this),r=n.reactions,i=z(E(this,B));return i.ok=!S(e)||e,i.fail=S(t)&&t,i.domain=L?Z.domain:void 0,n.parent=!0,r[r.length]=i,0!=n.state&&ie(n,!1),i.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r,t=N(e);this.promise=e,this.resolve=ce(le,t),this.reject=ce(de,t)},D.f=z=function(e){return e===B||e===o?new i(e):K(e)},!u&&S(p)&&j!==Object.prototype)){a=j.then,ee||(h(j,"then",(function(e,t){var n=this;return new B((function(e,t){l(a,n,e,t)})).then(e,t)}),{unsafe:!0}),h(j,"catch",Q.catch,{unsafe:!0}));try{delete j.constructor}catch(pe){}v&&v(j,Q)}s({global:!0,wrap:!0,forced:te},{Promise:B}),g(B,W,!1,!0),y(W),o=d(W),s({target:W,stat:!0,forced:te},{reject:function(e){var t=z(this);return l(t.reject,void 0,e),t.promise}}),s({target:W,stat:!0,forced:u||te},{resolve:function(e){return w(u&&this===o?B:this,e)}}),s({target:W,stat:!0,forced:ne},{all:function(e){var t=this,n=z(t),r=n.resolve,i=n.reject,o=k((function(){var n=m(t.resolve),o=[],a=0,s=1;b(e,(function(e){var u=a++,c=!1;s++,l(n,t,e).then((function(e){c||(c=!0,o[u]=e,--s||r(o))}),i)})),--s||r(o)}));return o.error&&i(o.value),n.promise},race:function(e){var t=this,n=z(t),r=n.reject,i=k((function(){var i=m(t.resolve);b(e,(function(e){l(i,t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}})},222:function(e,t,n){var r=n(6079),i=n(7230),o=n(1916),a=n(4545),s=n(8089),u=n(5399),c=n(7108).f,d=n(7852).f,l=n(2346),p=n(385),h=n(9851),f=n(8608),v=n(9154),g=n(3926),y=n(3694),m=n(3225),S=n(21).enforce,I=n(6898),T=n(7952),R=n(5021),b=n(2916),P=T("match"),E=i.RegExp,x=E.prototype,A=i.SyntaxError,w=o(f),C=o(x.exec),D=o("".charAt),k=o("".replace),O=o("".indexOf),M=o("".slice),F=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,_=/a/g,L=/a/g,q=new E(_)!==_,G=v.UNSUPPORTED_Y;if(a("RegExp",r&&(!q||G||R||b||y((function(){return L[P]=!1,E(_)!=_||E(L)==L||"/a/i"!=E(_,"i")}))))){for(var W=function(e,t){var n,r,i,o,a,c,d=l(x,this),f=p(e),v=void 0===t,g=[],y=e;if(!d&&f&&v&&e.constructor===W)return e;if((f||l(x,e))&&(e=e.source,v&&(t="flags"in y?y.flags:w(y))),e=void 0===e?"":h(e),t=void 0===t?"":h(t),y=e,R&&"dotAll"in _&&(r=!!t&&O(t,"s")>-1)&&(t=k(t,/s/g,"")),n=t,G&&"sticky"in _&&(i=!!t&&O(t,"y")>-1)&&(t=k(t,/y/g,"")),b&&(o=function(e){for(var t,n=e.length,r=0,i="",o=[],a={},s=!1,u=!1,c=0,d="";r<=n;r++){if("\\"===(t=D(e,r)))t+=D(e,++r);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:C(F,M(e,r+1))&&(r+=2,u=!0),i+=t,c++;continue;case">"===t&&u:if(""===d||m(a,d))throw new A("Invalid capture group name");a[d]=!0,o[o.length]=[d,c],u=!1,d="";continue}u?d+=t:i+=t}return[i,o]}(e),e=o[0],g=o[1]),a=s(E(e,t),d?this:x,W),(r||i||g.length)&&(c=S(a),r&&(c.dotAll=!0,c.raw=W(function(e){for(var t,n=e.length,r=0,i="",o=!1;r<=n;r++)"\\"!==(t=D(e,r))?o||"."!==t?("["===t?o=!0:"]"===t&&(o=!1),i+=t):i+="[\\s\\S]":i+=t+D(e,++r);return i}(e),n)),i&&(c.sticky=!0),g.length&&(c.groups=g)),e!==y)try{u(a,"source",""===y?"(?:)":y)}catch(I){}return a},N=function(e){e in W||c(W,e,{configurable:!0,get:function(){return E[e]},set:function(t){E[e]=t}})},U=d(E),H=0;U.length>H;)N(U[H++]);x.constructor=W,W.prototype=x,g(i,"RegExp",W)}I("RegExp")},5098:function(e,t,n){"use strict";var r=n(5302),i=n(9735);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},6858:function(e,t,n){"use strict";var r=n(1916),i=n(567).PROPER,o=n(3926),a=n(3536),s=n(2346),u=n(9851),c=n(3694),d=n(8608),l="toString",p=RegExp.prototype,h=p.toString,f=r(d),v=c((function(){return"/a/b"!=h.call({source:"a",flags:"b"})})),g=i&&h.name!=l;(v||g)&&o(RegExp.prototype,l,(function(){var e=a(this),t=u(e.source),n=e.flags;return"/"+t+"/"+u(void 0===n&&s(p,e)&&!("flags"in p)?f(e):n)}),{unsafe:!0})},1875:function(e,t,n){"use strict";n(5003)("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(3342))},3661:function(e,t,n){"use strict";var r=n(5302),i=n(1916),o=n(5027).f,a=n(6092),s=n(9851),u=n(6487),c=n(7105),d=n(937),l=n(7442),p=i("".endsWith),h=i("".slice),f=Math.min,v=d("endsWith");r({target:"String",proto:!0,forced:!(!l&&!v&&function(){var e=o(String.prototype,"endsWith");return e&&!e.writable}())&&!v},{endsWith:function(e){var t=s(c(this));u(e);var n=arguments.length>1?arguments[1]:void 0,r=t.length,i=void 0===n?r:f(a(n),r),o=s(e);return p?p(t,o,i):h(t,i-o.length,i)===o}})},9470:function(e,t,n){"use strict";var r=n(5302),i=n(1916),o=n(6487),a=n(7105),s=n(9851),u=n(937),c=i("".indexOf);r({target:"String",proto:!0,forced:!u("includes")},{includes:function(e){return!!~c(s(a(this)),s(o(e)),arguments.length>1?arguments[1]:void 0)}})},270:function(e,t,n){"use strict";var r=n(2370).charAt,i=n(9851),o=n(21),a=n(3392),s="String Iterator",u=o.set,c=o.getterFor(s);a(String,"String",(function(e){u(this,{type:s,string:i(e),index:0})}),(function(){var e,t=c(this),n=t.string,i=t.index;return i>=n.length?{value:void 0,done:!0}:(e=r(n,i),t.index+=e.length,{value:e,done:!1})}))},1237:function(e,t,n){"use strict";var r=n(4225),i=n(4430),o=n(3536),a=n(6092),s=n(9851),u=n(7105),c=n(5048),d=n(3264),l=n(5731);i("match",(function(e,t,n){return[function(t){var n=u(this),i=void 0==t?void 0:c(t,e);return i?r(i,t,n):new RegExp(t)[e](s(n))},function(e){var r=o(this),i=s(e),u=n(t,r,i);if(u.done)return u.value;if(!r.global)return l(r,i);var c=r.unicode;r.lastIndex=0;for(var p,h=[],f=0;null!==(p=l(r,i));){var v=s(p[0]);h[f]=v,""===v&&(r.lastIndex=d(i,a(r.lastIndex),c)),f++}return 0===f?null:h}]}))},9544:function(e,t,n){"use strict";var r=n(251),i=n(4225),o=n(1916),a=n(4430),s=n(3694),u=n(3536),c=n(933),d=n(4982),l=n(6092),p=n(9851),h=n(7105),f=n(3264),v=n(5048),g=n(6968),y=n(5731),m=n(7952)("replace"),S=Math.max,I=Math.min,T=o([].concat),R=o([].push),b=o("".indexOf),P=o("".slice),E="$0"==="a".replace(/./,"$0"),x=!!/./[m]&&""===/./[m]("a","$0");a("replace",(function(e,t,n){var o=x?"$":"$0";return[function(e,n){var r=h(this),o=void 0==e?void 0:v(e,m);return o?i(o,e,r,n):i(t,p(r),e,n)},function(e,i){var a=u(this),s=p(e);if("string"==typeof i&&-1===b(i,o)&&-1===b(i,"$<")){var h=n(t,a,s,i);if(h.done)return h.value}var v=c(i);v||(i=p(i));var m=a.global;if(m){var E=a.unicode;a.lastIndex=0}for(var x=[];;){var A=y(a,s);if(null===A)break;if(R(x,A),!m)break;""===p(A[0])&&(a.lastIndex=f(s,l(a.lastIndex),E))}for(var w,C="",D=0,k=0;k<x.length;k++){for(var O=p((A=x[k])[0]),M=S(I(d(A.index),s.length),0),F=[],_=1;_<A.length;_++)R(F,void 0===(w=A[_])?w:String(w));var L=A.groups;if(v){var q=T([O],F,M,s);void 0!==L&&R(q,L);var G=p(r(i,void 0,q))}else G=g(O,s,M,F,L,i);M>=D&&(C+=P(s,D,M)+G,D=M+O.length)}return C+P(s,D)}]}),!!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!E||x)},2026:function(e,t,n){"use strict";var r=n(4225),i=n(4430),o=n(3536),a=n(7105),s=n(1262),u=n(9851),c=n(5048),d=n(5731);i("search",(function(e,t,n){return[function(t){var n=a(this),i=void 0==t?void 0:c(t,e);return i?r(i,t,n):new RegExp(t)[e](u(n))},function(e){var r=o(this),i=u(e),a=n(t,r,i);if(a.done)return a.value;var c=r.lastIndex;s(c,0)||(r.lastIndex=0);var l=d(r,i);return s(r.lastIndex,c)||(r.lastIndex=c),null===l?-1:l.index}]}))},7807:function(e,t,n){"use strict";var r=n(251),i=n(4225),o=n(1916),a=n(4430),s=n(385),u=n(3536),c=n(7105),d=n(640),l=n(3264),p=n(6092),h=n(9851),f=n(5048),v=n(9663),g=n(5731),y=n(9735),m=n(9154),S=n(3694),I=m.UNSUPPORTED_Y,T=4294967295,R=Math.min,b=[].push,P=o(/./.exec),E=o(b),x=o("".slice),A=!S((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));a("split",(function(e,t,n){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var o=h(c(this)),a=void 0===n?T:n>>>0;if(0===a)return[];if(void 0===e)return[o];if(!s(e))return i(t,o,e,a);for(var u,d,l,p=[],f=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),g=0,m=new RegExp(e.source,f+"g");(u=i(y,m,o))&&!((d=m.lastIndex)>g&&(E(p,x(o,g,u.index)),u.length>1&&u.index<o.length&&r(b,p,v(u,1)),l=u[0].length,g=d,p.length>=a));)m.lastIndex===u.index&&m.lastIndex++;return g===o.length?!l&&P(m,"")||E(p,""):E(p,x(o,g)),p.length>a?v(p,0,a):p}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:i(t,this,e,n)}:t,[function(t,n){var r=c(this),a=void 0==t?void 0:f(t,e);return a?i(a,t,r,n):i(o,h(r),t,n)},function(e,r){var i=u(this),a=h(e),s=n(o,i,a,r,o!==t);if(s.done)return s.value;var c=d(i,RegExp),f=i.unicode,v=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(I?"g":"y"),y=new c(I?"^(?:"+i.source+")":i,v),m=void 0===r?T:r>>>0;if(0===m)return[];if(0===a.length)return null===g(y,a)?[a]:[];for(var S=0,b=0,P=[];b<a.length;){y.lastIndex=I?0:b;var A,w=g(y,I?x(a,b):a);if(null===w||(A=R(p(y.lastIndex+(I?b:0)),a.length))===S)b=l(a,b,f);else{if(E(P,x(a,S,b)),P.length===m)return P;for(var C=1;C<=w.length-1;C++)if(E(P,w[C]),P.length===m)return P;b=S=A}}return E(P,x(a,S)),P}]}),!A,I)},217:function(e,t,n){"use strict";var r=n(5302),i=n(1916),o=n(5027).f,a=n(6092),s=n(9851),u=n(6487),c=n(7105),d=n(937),l=n(7442),p=i("".startsWith),h=i("".slice),f=Math.min,v=d("startsWith");r({target:"String",proto:!0,forced:!(!l&&!v&&function(){var e=o(String.prototype,"startsWith");return e&&!e.writable}())&&!v},{startsWith:function(e){var t=s(c(this));u(e);var n=a(f(arguments.length>1?arguments[1]:void 0,t.length)),r=s(e);return p?p(t,r,n):h(t,n,n+r.length)===r}})},3373:function(e,t,n){"use strict";var r=n(5302),i=n(6079),o=n(7230),a=n(1916),s=n(3225),u=n(933),c=n(2346),d=n(9851),l=n(7108).f,p=n(1831),h=o.Symbol,f=h&&h.prototype;if(i&&u(h)&&(!("description"in f)||void 0!==h().description)){var v={},g=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:d(arguments[0]),t=c(f,this)?new h(e):void 0===e?h():h(e);return""===e&&(v[t]=!0),t};p(g,h),g.prototype=f,f.constructor=g;var y="Symbol(test)"==String(h("test")),m=a(f.toString),S=a(f.valueOf),I=/^Symbol\((.*)\)[^)]+$/,T=a("".replace),R=a("".slice);l(f,"description",{configurable:!0,get:function(){var e=S(this),t=m(e);if(s(v,e))return"";var n=y?R(t,7,-1):T(t,I,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:g})}},1881:function(e,t,n){n(4832)("iterator")},8689:function(e,t,n){"use strict";var r=n(5302),i=n(7230),o=n(1223),a=n(251),s=n(4225),u=n(1916),c=n(7442),d=n(6079),l=n(8724),p=n(3694),h=n(3225),f=n(4893),v=n(933),g=n(6913),y=n(2346),m=n(7581),S=n(3536),I=n(987),T=n(9164),R=n(5831),b=n(9851),P=n(8828),E=n(6997),x=n(6127),A=n(7852),w=n(3959),C=n(7375),D=n(5027),k=n(7108),O=n(5486),M=n(9663),F=n(3926),_=n(3268),L=n(375),q=n(7076),G=n(4525),W=n(7952),N=n(3081),U=n(4832),H=n(5411),j=n(21),B=n(1569).forEach,Q=L("hidden"),V="Symbol",J=W("toPrimitive"),Z=j.set,z=j.getterFor(V),K=Object.prototype,Y=i.Symbol,$=Y&&Y.prototype,X=i.TypeError,ee=i.QObject,te=o("JSON","stringify"),ne=D.f,re=k.f,ie=w.f,oe=O.f,ae=u([].push),se=_("symbols"),ue=_("op-symbols"),ce=_("string-to-symbol-registry"),de=_("symbol-to-string-registry"),le=_("wks"),pe=!ee||!ee.prototype||!ee.prototype.findChild,he=d&&p((function(){return 7!=E(re({},"a",{get:function(){return re(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=ne(K,t);r&&delete K[t],re(e,t,n),r&&e!==K&&re(K,t,r)}:re,fe=function(e,t){var n=se[e]=E($);return Z(n,{type:V,tag:e,description:t}),d||(n.description=t),n},ve=function(e,t,n){e===K&&ve(ue,t,n),S(e);var r=R(t);return S(n),h(se,r)?(n.enumerable?(h(e,Q)&&e[Q][r]&&(e[Q][r]=!1),n=E(n,{enumerable:P(0,!1)})):(h(e,Q)||re(e,Q,P(1,{})),e[Q][r]=!0),he(e,r,n)):re(e,r,n)},ge=function(e,t){S(e);var n=T(t),r=x(n).concat(Ie(n));return B(r,(function(t){d&&!s(ye,n,t)||ve(e,t,n[t])})),e},ye=function(e){var t=R(e),n=s(oe,this,t);return!(this===K&&h(se,t)&&!h(ue,t))&&(!(n||!h(this,t)||!h(se,t)||h(this,Q)&&this[Q][t])||n)},me=function(e,t){var n=T(e),r=R(t);if(n!==K||!h(se,r)||h(ue,r)){var i=ne(n,r);return!i||!h(se,r)||h(n,Q)&&n[Q][r]||(i.enumerable=!0),i}},Se=function(e){var t=ie(T(e)),n=[];return B(t,(function(e){h(se,e)||h(q,e)||ae(n,e)})),n},Ie=function(e){var t=e===K,n=ie(t?ue:T(e)),r=[];return B(n,(function(e){!h(se,e)||t&&!h(K,e)||ae(r,se[e])})),r};if(l||(Y=function(){if(y($,this))throw X("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?b(arguments[0]):void 0,t=G(e),n=function(e){this===K&&s(n,ue,e),h(this,Q)&&h(this[Q],t)&&(this[Q][t]=!1),he(this,t,P(1,e))};return d&&pe&&he(K,t,{configurable:!0,set:n}),fe(t,e)},F($=Y.prototype,"toString",(function(){return z(this).tag})),F(Y,"withoutSetter",(function(e){return fe(G(e),e)})),O.f=ye,k.f=ve,D.f=me,A.f=w.f=Se,C.f=Ie,N.f=function(e){return fe(W(e),e)},d&&(re($,"description",{configurable:!0,get:function(){return z(this).description}}),c||F(K,"propertyIsEnumerable",ye,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!l,sham:!l},{Symbol:Y}),B(x(le),(function(e){U(e)})),r({target:V,stat:!0,forced:!l},{for:function(e){var t=b(e);if(h(ce,t))return ce[t];var n=Y(t);return ce[t]=n,de[n]=t,n},keyFor:function(e){if(!m(e))throw X(e+" is not a symbol");if(h(de,e))return de[e]},useSetter:function(){pe=!0},useSimple:function(){pe=!1}}),r({target:"Object",stat:!0,forced:!l,sham:!d},{create:function(e,t){return void 0===t?E(e):ge(E(e),t)},defineProperty:ve,defineProperties:ge,getOwnPropertyDescriptor:me}),r({target:"Object",stat:!0,forced:!l},{getOwnPropertyNames:Se,getOwnPropertySymbols:Ie}),r({target:"Object",stat:!0,forced:p((function(){C.f(1)}))},{getOwnPropertySymbols:function(e){return C.f(I(e))}}),te&&r({target:"JSON",stat:!0,forced:!l||p((function(){var e=Y();return"[null]"!=te([e])||"{}"!=te({a:e})||"{}"!=te(Object(e))}))},{stringify:function(e,t,n){var r=M(arguments),i=t;if((g(t)||void 0!==e)&&!m(e))return f(t)||(t=function(e,t){if(v(i)&&(t=s(i,this,e,t)),!m(t))return t}),r[1]=t,a(te,null,r)}}),!$[J]){var Te=$.valueOf;F($,J,(function(e){return s(Te,this)}))}H(Y,V),q[Q]=!0},2152:function(e,t,n){"use strict";var r=n(1916),i=n(7740),o=r(n(8012)),a=i.aTypedArray;(0,i.exportTypedArrayMethod)("copyWithin",(function(e,t){return o(a(this),e,t,arguments.length>2?arguments[2]:void 0)}))},3294:function(e,t,n){"use strict";var r=n(7740),i=n(1569).every,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("every",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},1615:function(e,t,n){"use strict";var r=n(7740),i=n(4225),o=n(240),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("fill",(function(e){var t=arguments.length;return i(o,a(this),e,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}))},1157:function(e,t,n){"use strict";var r=n(7740),i=n(1569).filter,o=n(6425),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("filter",(function(e){var t=i(a(this),e,arguments.length>1?arguments[1]:void 0);return o(this,t)}))},3083:function(e,t,n){"use strict";var r=n(7740),i=n(1569).findIndex,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("findIndex",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},472:function(e,t,n){"use strict";var r=n(7740),i=n(1569).find,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("find",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},2906:function(e,t,n){"use strict";var r=n(7740),i=n(1569).forEach,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("forEach",(function(e){i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},6959:function(e,t,n){"use strict";var r=n(7740),i=n(7945).includes,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("includes",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},9293:function(e,t,n){"use strict";var r=n(7740),i=n(7945).indexOf,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("indexOf",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},8723:function(e,t,n){"use strict";var r=n(7230),i=n(1916),o=n(567).PROPER,a=n(7740),s=n(4836),u=n(7952)("iterator"),c=r.Uint8Array,d=i(s.values),l=i(s.keys),p=i(s.entries),h=a.aTypedArray,f=a.exportTypedArrayMethod,v=c&&c.prototype[u],g=!!v&&"values"===v.name,y=function(){return d(h(this))};f("entries",(function(){return p(h(this))})),f("keys",(function(){return l(h(this))})),f("values",y,o&&!g),f(u,y,o&&!g)},8951:function(e,t,n){"use strict";var r=n(7740),i=n(1916),o=r.aTypedArray,a=r.exportTypedArrayMethod,s=i([].join);a("join",(function(e){return s(o(this),e)}))},1737:function(e,t,n){"use strict";var r=n(7740),i=n(251),o=n(3604),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("lastIndexOf",(function(e){var t=arguments.length;return i(o,a(this),t>1?[e,arguments[1]]:[e])}))},2566:function(e,t,n){"use strict";var r=n(7740),i=n(1569).map,o=n(4647),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("map",(function(e){return i(a(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(o(e))(t)}))}))},8131:function(e,t,n){"use strict";var r=n(7740),i=n(8605).right,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("reduceRight",(function(e){var t=arguments.length;return i(o(this),e,t,t>1?arguments[1]:void 0)}))},6289:function(e,t,n){"use strict";var r=n(7740),i=n(8605).left,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("reduce",(function(e){var t=arguments.length;return i(o(this),e,t,t>1?arguments[1]:void 0)}))},8660:function(e,t,n){"use strict";var r=n(7740),i=r.aTypedArray,o=r.exportTypedArrayMethod,a=Math.floor;o("reverse",(function(){for(var e,t=this,n=i(t).length,r=a(n/2),o=0;o<r;)e=t[o],t[o++]=t[--n],t[n]=e;return t}))},9199:function(e,t,n){"use strict";var r=n(7230),i=n(7740),o=n(1646),a=n(1302),s=n(987),u=n(3694),c=r.RangeError,d=i.aTypedArray;(0,i.exportTypedArrayMethod)("set",(function(e){d(this);var t=a(arguments.length>1?arguments[1]:void 0,1),n=this.length,r=s(e),i=o(r),u=0;if(i+t>n)throw c("Wrong length");for(;u<i;)this[t+u]=r[u++]}),u((function(){new Int8Array(1).set({})})))},1378:function(e,t,n){"use strict";var r=n(7740),i=n(4647),o=n(3694),a=n(9663),s=r.aTypedArray;(0,r.exportTypedArrayMethod)("slice",(function(e,t){for(var n=a(s(this),e,t),r=i(this),o=0,u=n.length,c=new r(u);u>o;)c[o]=n[o++];return c}),o((function(){new Int8Array(1).slice()})))},9319:function(e,t,n){"use strict";var r=n(7740),i=n(1569).some,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("some",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},2895:function(e,t,n){"use strict";var r=n(7230),i=n(1916),o=n(3694),a=n(3200),s=n(8813),u=n(7740),c=n(1346),d=n(7636),l=n(7806),p=n(7041),h=r.Array,f=u.aTypedArray,v=u.exportTypedArrayMethod,g=r.Uint16Array,y=g&&i(g.prototype.sort),m=!!y&&!(o((function(){y(new g(2),null)}))&&o((function(){y(new g(2),{})}))),S=!!y&&!o((function(){if(l)return l<74;if(c)return c<67;if(d)return!0;if(p)return p<602;var e,t,n=new g(516),r=h(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,r[e]=e-2*t+3;for(y(n,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==r[e])return!0}));v("sort",(function(e){return void 0!==e&&a(e),S?y(this,e):s(f(this),function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!==n?-1:t!==t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}}(e))}),!S||m)},2336:function(e,t,n){"use strict";var r=n(7740),i=n(6092),o=n(2966),a=n(4647),s=r.aTypedArray;(0,r.exportTypedArrayMethod)("subarray",(function(e,t){var n=s(this),r=n.length,u=o(e,r);return new(a(n))(n.buffer,n.byteOffset+u*n.BYTES_PER_ELEMENT,i((void 0===t?r:o(t,r))-u))}))},727:function(e,t,n){"use strict";var r=n(7230),i=n(251),o=n(7740),a=n(3694),s=n(9663),u=r.Int8Array,c=o.aTypedArray,d=o.exportTypedArrayMethod,l=[].toLocaleString,p=!!u&&a((function(){l.call(new u(1))}));d("toLocaleString",(function(){return i(l,p?s(c(this)):c(this),s(arguments))}),a((function(){return[1,2].toLocaleString()!=new u([1,2]).toLocaleString()}))||!a((function(){u.prototype.toLocaleString.call([1,2])})))},2112:function(e,t,n){"use strict";var r=n(7740).exportTypedArrayMethod,i=n(3694),o=n(7230),a=n(1916),s=o.Uint8Array,u=s&&s.prototype||{},c=[].toString,d=a([].join);i((function(){c.call({})}))&&(c=function(){return d(this)});var l=u.toString!=c;r("toString",c,l)},4398:function(e,t,n){n(8298)("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},8127:function(e,t,n){var r=n(7230),i=n(5941),o=n(3050),a=n(4836),s=n(5399),u=n(7952),c=u("iterator"),d=u("toStringTag"),l=a.values,p=function(e,t){if(e){if(e[c]!==l)try{s(e,c,l)}catch(r){e[c]=l}if(e[d]||s(e,d,t),i[t])for(var n in a)if(e[n]!==a[n])try{s(e,n,a[n])}catch(r){e[n]=a[n]}}};for(var h in i)p(r[h]&&r[h].prototype,h);p(o,"DOMTokenList")},5979:function(e,t,n){"use strict";n(4836);var r=n(5302),i=n(7230),o=n(1223),a=n(4225),s=n(1916),u=n(4169),c=n(3926),d=n(7777),l=n(5411),p=n(1623),h=n(21),f=n(5209),v=n(933),g=n(3225),y=n(1248),m=n(996),S=n(3536),I=n(6913),T=n(9851),R=n(6997),b=n(8828),P=n(9853),E=n(6418),x=n(7952),A=n(8813),w=x("iterator"),C="URLSearchParams",D="URLSearchParamsIterator",k=h.set,O=h.getterFor(C),M=h.getterFor(D),F=o("fetch"),_=o("Request"),L=o("Headers"),q=_&&_.prototype,G=L&&L.prototype,W=i.RegExp,N=i.TypeError,U=i.decodeURIComponent,H=i.encodeURIComponent,j=s("".charAt),B=s([].join),Q=s([].push),V=s("".replace),J=s([].shift),Z=s([].splice),z=s("".split),K=s("".slice),Y=/\+/g,$=Array(4),X=function(e){return $[e-1]||($[e-1]=W("((?:%[\\da-f]{2}){"+e+"})","gi"))},ee=function(e){try{return U(e)}catch(t){return e}},te=function(e){var t=V(e,Y," "),n=4;try{return U(t)}catch(r){for(;n;)t=V(t,X(n--),ee);return t}},ne=/[!'()~]|%20/g,re={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},ie=function(e){return re[e]},oe=function(e){return V(H(e),ne,ie)},ae=function(e,t){if(t)for(var n,r,i=z(t,"&"),o=0;o<i.length;)(n=i[o++]).length&&(r=z(n,"="),Q(e,{key:te(J(r)),value:te(B(r,"="))}))},se=function(e){this.entries.length=0,ae(this.entries,e)},ue=function(e,t){if(e<t)throw N("Not enough arguments")},ce=p((function(e,t){k(this,{type:D,iterator:P(O(e).entries),kind:t})}),"Iterator",(function(){var e=M(this),t=e.kind,n=e.iterator.next(),r=n.value;return n.done||(n.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),n})),de=function(){f(this,le);var e,t,n,r,i,o,s,u,c,d=arguments.length>0?arguments[0]:void 0,l=this,p=[];if(k(l,{type:C,entries:p,updateURL:function(){},updateSearchParams:se}),void 0!==d)if(I(d))if(e=E(d))for(n=(t=P(d,e)).next;!(r=a(n,t)).done;){if(o=(i=P(S(r.value))).next,(s=a(o,i)).done||(u=a(o,i)).done||!a(o,i).done)throw N("Expected sequence with length 2");Q(p,{key:T(s.value),value:T(u.value)})}else for(c in d)g(d,c)&&Q(p,{key:c,value:T(d[c])});else ae(p,"string"==typeof d?"?"===j(d,0)?K(d,1):d:T(d))},le=de.prototype;if(d(le,{append:function(e,t){ue(arguments.length,2);var n=O(this);Q(n.entries,{key:T(e),value:T(t)}),n.updateURL()},delete:function(e){ue(arguments.length,1);for(var t=O(this),n=t.entries,r=T(e),i=0;i<n.length;)n[i].key===r?Z(n,i,1):i++;t.updateURL()},get:function(e){ue(arguments.length,1);for(var t=O(this).entries,n=T(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){ue(arguments.length,1);for(var t=O(this).entries,n=T(e),r=[],i=0;i<t.length;i++)t[i].key===n&&Q(r,t[i].value);return r},has:function(e){ue(arguments.length,1);for(var t=O(this).entries,n=T(e),r=0;r<t.length;)if(t[r++].key===n)return!0;return!1},set:function(e,t){ue(arguments.length,1);for(var n,r=O(this),i=r.entries,o=!1,a=T(e),s=T(t),u=0;u<i.length;u++)(n=i[u]).key===a&&(o?Z(i,u--,1):(o=!0,n.value=s));o||Q(i,{key:a,value:s}),r.updateURL()},sort:function(){var e=O(this);A(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=O(this).entries,r=y(e,arguments.length>1?arguments[1]:void 0),i=0;i<n.length;)r((t=n[i++]).value,t.key,this)},keys:function(){return new ce(this,"keys")},values:function(){return new ce(this,"values")},entries:function(){return new ce(this,"entries")}},{enumerable:!0}),c(le,w,le.entries,{name:"entries"}),c(le,"toString",(function(){for(var e,t=O(this).entries,n=[],r=0;r<t.length;)e=t[r++],Q(n,oe(e.key)+"="+oe(e.value));return B(n,"&")}),{enumerable:!0}),l(de,C),r({global:!0,forced:!u},{URLSearchParams:de}),!u&&v(L)){var pe=s(G.has),he=s(G.set),fe=function(e){if(I(e)){var t,n=e.body;if(m(n)===C)return t=e.headers?new L(e.headers):new L,pe(t,"content-type")||he(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),R(e,{body:b(0,T(n)),headers:b(0,t)})}return e};if(v(F)&&r({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return F(e,arguments.length>1?fe(arguments[1]):{})}}),v(_)){var ve=function(e){return f(this,q),new _(e,arguments.length>1?fe(arguments[1]):{})};q.constructor=ve,ve.prototype=q,r({global:!0,forced:!0},{Request:ve})}}e.exports={URLSearchParams:de,getState:O}},4049:function(e,t,n){"use strict";n(270);var r,i=n(5302),o=n(6079),a=n(4169),s=n(7230),u=n(1248),c=n(4225),d=n(1916),l=n(7673),p=n(3926),h=n(5209),f=n(3225),v=n(5016),g=n(8897),y=n(9663),m=n(2370).codeAt,S=n(7137),I=n(9851),T=n(5411),R=n(5979),b=n(21),P=b.set,E=b.getterFor("URL"),x=R.URLSearchParams,A=R.getState,w=s.URL,C=s.TypeError,D=s.parseInt,k=Math.floor,O=Math.pow,M=d("".charAt),F=d(/./.exec),_=d([].join),L=d(1..toString),q=d([].pop),G=d([].push),W=d("".replace),N=d([].shift),U=d("".split),H=d("".slice),j=d("".toLowerCase),B=d([].unshift),Q="Invalid scheme",V="Invalid host",J="Invalid port",Z=/[a-z]/i,z=/[\d+-.a-z]/i,K=/\d/,Y=/^0x/i,$=/^[0-7]+$/,X=/^\d+$/,ee=/^[\da-f]+$/i,te=/[\0\t\n\r #%/:<>?@[\\\]^|]/,ne=/[\0\t\n\r #/:<>?@[\\\]^|]/,re=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,ie=/[\t\n\r]/g,oe=function(e,t){var n,r,i;if("["==M(t,0)){if("]"!=M(t,t.length-1))return V;if(!(n=se(H(t,1,-1))))return V;e.host=n}else if(ve(e)){if(t=S(t),F(te,t))return V;if(null===(n=ae(t)))return V;e.host=n}else{if(F(ne,t))return V;for(n="",r=g(t),i=0;i<r.length;i++)n+=he(r[i],ce);e.host=n}},ae=function(e){var t,n,r,i,o,a,s,u=U(e,".");if(u.length&&""==u[u.length-1]&&u.length--,(t=u.length)>4)return e;for(n=[],r=0;r<t;r++){if(""==(i=u[r]))return e;if(o=10,i.length>1&&"0"==M(i,0)&&(o=F(Y,i)?16:8,i=H(i,8==o?1:2)),""===i)a=0;else{if(!F(10==o?X:8==o?$:ee,i))return e;a=D(i,o)}G(n,a)}for(r=0;r<t;r++)if(a=n[r],r==t-1){if(a>=O(256,5-t))return null}else if(a>255)return null;for(s=q(n),r=0;r<n.length;r++)s+=n[r]*O(256,3-r);return s},se=function(e){var t,n,r,i,o,a,s,u=[0,0,0,0,0,0,0,0],c=0,d=null,l=0,p=function(){return M(e,l)};if(":"==p()){if(":"!=M(e,1))return;l+=2,d=++c}for(;p();){if(8==c)return;if(":"!=p()){for(t=n=0;n<4&&F(ee,p());)t=16*t+D(p(),16),l++,n++;if("."==p()){if(0==n)return;if(l-=n,c>6)return;for(r=0;p();){if(i=null,r>0){if(!("."==p()&&r<4))return;l++}if(!F(K,p()))return;for(;F(K,p());){if(o=D(p(),10),null===i)i=o;else{if(0==i)return;i=10*i+o}if(i>255)return;l++}u[c]=256*u[c]+i,2!=++r&&4!=r||c++}if(4!=r)return;break}if(":"==p()){if(l++,!p())return}else if(p())return;u[c++]=t}else{if(null!==d)return;l++,d=++c}}if(null!==d)for(a=c-d,c=7;0!=c&&a>0;)s=u[c],u[c--]=u[d+a-1],u[d+--a]=s;else if(8!=c)return;return u},ue=function(e){var t,n,r,i;if("number"==typeof e){for(t=[],n=0;n<4;n++)B(t,e%256),e=k(e/256);return _(t,".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,n=1,r=null,i=0,o=0;o<8;o++)0!==e[o]?(i>n&&(t=r,n=i),r=null,i=0):(null===r&&(r=o),++i);return i>n&&(t=r,n=i),t}(e),n=0;n<8;n++)i&&0===e[n]||(i&&(i=!1),r===n?(t+=n?":":"::",i=!0):(t+=L(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},ce={},de=v({},ce,{" ":1,'"':1,"<":1,">":1,"`":1}),le=v({},de,{"#":1,"?":1,"{":1,"}":1}),pe=v({},le,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),he=function(e,t){var n=m(e,0);return n>32&&n<127&&!f(t,e)?e:encodeURIComponent(e)},fe={ftp:21,file:null,http:80,https:443,ws:80,wss:443},ve=function(e){return f(fe,e.scheme)},ge=function(e){return""!=e.username||""!=e.password},ye=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},me=function(e,t){var n;return 2==e.length&&F(Z,M(e,0))&&(":"==(n=M(e,1))||!t&&"|"==n)},Se=function(e){var t;return e.length>1&&me(H(e,0,2))&&(2==e.length||"/"===(t=M(e,2))||"\\"===t||"?"===t||"#"===t)},Ie=function(e){var t=e.path,n=t.length;!n||"file"==e.scheme&&1==n&&me(t[0],!0)||t.length--},Te=function(e){return"."===e||"%2e"===j(e)},Re={},be={},Pe={},Ee={},xe={},Ae={},we={},Ce={},De={},ke={},Oe={},Me={},Fe={},_e={},Le={},qe={},Ge={},We={},Ne={},Ue={},He={},je=function(e,t,n,i){var o,a,s,u,c,d=n||Re,l=0,p="",h=!1,v=!1,m=!1;for(n||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=W(t,re,"")),t=W(t,ie,""),o=g(t);l<=o.length;){switch(a=o[l],d){case Re:if(!a||!F(Z,a)){if(n)return Q;d=Pe;continue}p+=j(a),d=be;break;case be:if(a&&(F(z,a)||"+"==a||"-"==a||"."==a))p+=j(a);else{if(":"!=a){if(n)return Q;p="",d=Pe,l=0;continue}if(n&&(ve(e)!=f(fe,p)||"file"==p&&(ge(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=p,n)return void(ve(e)&&fe[e.scheme]==e.port&&(e.port=null));p="","file"==e.scheme?d=_e:ve(e)&&i&&i.scheme==e.scheme?d=Ee:ve(e)?d=Ce:"/"==o[l+1]?(d=xe,l++):(e.cannotBeABaseURL=!0,G(e.path,""),d=Ne)}break;case Pe:if(!i||i.cannotBeABaseURL&&"#"!=a)return Q;if(i.cannotBeABaseURL&&"#"==a){e.scheme=i.scheme,e.path=y(i.path),e.query=i.query,e.fragment="",e.cannotBeABaseURL=!0,d=He;break}d="file"==i.scheme?_e:Ae;continue;case Ee:if("/"!=a||"/"!=o[l+1]){d=Ae;continue}d=De,l++;break;case xe:if("/"==a){d=ke;break}d=We;continue;case Ae:if(e.scheme=i.scheme,a==r)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=y(i.path),e.query=i.query;else if("/"==a||"\\"==a&&ve(e))d=we;else if("?"==a)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=y(i.path),e.query="",d=Ue;else{if("#"!=a){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=y(i.path),e.path.length--,d=We;continue}e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=y(i.path),e.query=i.query,e.fragment="",d=He}break;case we:if(!ve(e)||"/"!=a&&"\\"!=a){if("/"!=a){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,d=We;continue}d=ke}else d=De;break;case Ce:if(d=De,"/"!=a||"/"!=M(p,l+1))continue;l++;break;case De:if("/"!=a&&"\\"!=a){d=ke;continue}break;case ke:if("@"==a){h&&(p="%40"+p),h=!0,s=g(p);for(var S=0;S<s.length;S++){var I=s[S];if(":"!=I||m){var T=he(I,pe);m?e.password+=T:e.username+=T}else m=!0}p=""}else if(a==r||"/"==a||"?"==a||"#"==a||"\\"==a&&ve(e)){if(h&&""==p)return"Invalid authority";l-=g(p).length+1,p="",d=Oe}else p+=a;break;case Oe:case Me:if(n&&"file"==e.scheme){d=qe;continue}if(":"!=a||v){if(a==r||"/"==a||"?"==a||"#"==a||"\\"==a&&ve(e)){if(ve(e)&&""==p)return V;if(n&&""==p&&(ge(e)||null!==e.port))return;if(u=oe(e,p))return u;if(p="",d=Ge,n)return;continue}"["==a?v=!0:"]"==a&&(v=!1),p+=a}else{if(""==p)return V;if(u=oe(e,p))return u;if(p="",d=Fe,n==Me)return}break;case Fe:if(!F(K,a)){if(a==r||"/"==a||"?"==a||"#"==a||"\\"==a&&ve(e)||n){if(""!=p){var R=D(p,10);if(R>65535)return J;e.port=ve(e)&&R===fe[e.scheme]?null:R,p=""}if(n)return;d=Ge;continue}return J}p+=a;break;case _e:if(e.scheme="file","/"==a||"\\"==a)d=Le;else{if(!i||"file"!=i.scheme){d=We;continue}if(a==r)e.host=i.host,e.path=y(i.path),e.query=i.query;else if("?"==a)e.host=i.host,e.path=y(i.path),e.query="",d=Ue;else{if("#"!=a){Se(_(y(o,l),""))||(e.host=i.host,e.path=y(i.path),Ie(e)),d=We;continue}e.host=i.host,e.path=y(i.path),e.query=i.query,e.fragment="",d=He}}break;case Le:if("/"==a||"\\"==a){d=qe;break}i&&"file"==i.scheme&&!Se(_(y(o,l),""))&&(me(i.path[0],!0)?G(e.path,i.path[0]):e.host=i.host),d=We;continue;case qe:if(a==r||"/"==a||"\\"==a||"?"==a||"#"==a){if(!n&&me(p))d=We;else if(""==p){if(e.host="",n)return;d=Ge}else{if(u=oe(e,p))return u;if("localhost"==e.host&&(e.host=""),n)return;p="",d=Ge}continue}p+=a;break;case Ge:if(ve(e)){if(d=We,"/"!=a&&"\\"!=a)continue}else if(n||"?"!=a)if(n||"#"!=a){if(a!=r&&(d=We,"/"!=a))continue}else e.fragment="",d=He;else e.query="",d=Ue;break;case We:if(a==r||"/"==a||"\\"==a&&ve(e)||!n&&("?"==a||"#"==a)){if(".."===(c=j(c=p))||"%2e."===c||".%2e"===c||"%2e%2e"===c?(Ie(e),"/"==a||"\\"==a&&ve(e)||G(e.path,"")):Te(p)?"/"==a||"\\"==a&&ve(e)||G(e.path,""):("file"==e.scheme&&!e.path.length&&me(p)&&(e.host&&(e.host=""),p=M(p,0)+":"),G(e.path,p)),p="","file"==e.scheme&&(a==r||"?"==a||"#"==a))for(;e.path.length>1&&""===e.path[0];)N(e.path);"?"==a?(e.query="",d=Ue):"#"==a&&(e.fragment="",d=He)}else p+=he(a,le);break;case Ne:"?"==a?(e.query="",d=Ue):"#"==a?(e.fragment="",d=He):a!=r&&(e.path[0]+=he(a,ce));break;case Ue:n||"#"!=a?a!=r&&("'"==a&&ve(e)?e.query+="%27":e.query+="#"==a?"%23":he(a,ce)):(e.fragment="",d=He);break;case He:a!=r&&(e.fragment+=he(a,de))}l++}},Be=function(e){var t,n,r=h(this,Qe),i=arguments.length>1?arguments[1]:void 0,a=I(e),s=P(r,{type:"URL"});if(void 0!==i)try{t=E(i)}catch(l){if(n=je(t={},I(i)))throw C(n)}if(n=je(s,a,null,t))throw C(n);var u=s.searchParams=new x,d=A(u);d.updateSearchParams(s.query),d.updateURL=function(){s.query=I(u)||null},o||(r.href=c(Ve,r),r.origin=c(Je,r),r.protocol=c(Ze,r),r.username=c(ze,r),r.password=c(Ke,r),r.host=c(Ye,r),r.hostname=c($e,r),r.port=c(Xe,r),r.pathname=c(et,r),r.search=c(tt,r),r.searchParams=c(nt,r),r.hash=c(rt,r))},Qe=Be.prototype,Ve=function(){var e=E(this),t=e.scheme,n=e.username,r=e.password,i=e.host,o=e.port,a=e.path,s=e.query,u=e.fragment,c=t+":";return null!==i?(c+="//",ge(e)&&(c+=n+(r?":"+r:"")+"@"),c+=ue(i),null!==o&&(c+=":"+o)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?a[0]:a.length?"/"+_(a,"/"):"",null!==s&&(c+="?"+s),null!==u&&(c+="#"+u),c},Je=function(){var e=E(this),t=e.scheme,n=e.port;if("blob"==t)try{return new Be(t.path[0]).origin}catch(r){return"null"}return"file"!=t&&ve(e)?t+"://"+ue(e.host)+(null!==n?":"+n:""):"null"},Ze=function(){return E(this).scheme+":"},ze=function(){return E(this).username},Ke=function(){return E(this).password},Ye=function(){var e=E(this),t=e.host,n=e.port;return null===t?"":null===n?ue(t):ue(t)+":"+n},$e=function(){var e=E(this).host;return null===e?"":ue(e)},Xe=function(){var e=E(this).port;return null===e?"":I(e)},et=function(){var e=E(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+_(t,"/"):""},tt=function(){var e=E(this).query;return e?"?"+e:""},nt=function(){return E(this).searchParams},rt=function(){var e=E(this).fragment;return e?"#"+e:""},it=function(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}};if(o&&l(Qe,{href:it(Ve,(function(e){var t=E(this),n=I(e),r=je(t,n);if(r)throw C(r);A(t.searchParams).updateSearchParams(t.query)})),origin:it(Je),protocol:it(Ze,(function(e){var t=E(this);je(t,I(e)+":",Re)})),username:it(ze,(function(e){var t=E(this),n=g(I(e));if(!ye(t)){t.username="";for(var r=0;r<n.length;r++)t.username+=he(n[r],pe)}})),password:it(Ke,(function(e){var t=E(this),n=g(I(e));if(!ye(t)){t.password="";for(var r=0;r<n.length;r++)t.password+=he(n[r],pe)}})),host:it(Ye,(function(e){var t=E(this);t.cannotBeABaseURL||je(t,I(e),Oe)})),hostname:it($e,(function(e){var t=E(this);t.cannotBeABaseURL||je(t,I(e),Me)})),port:it(Xe,(function(e){var t=E(this);ye(t)||(""==(e=I(e))?t.port=null:je(t,e,Fe))})),pathname:it(et,(function(e){var t=E(this);t.cannotBeABaseURL||(t.path=[],je(t,I(e),Ge))})),search:it(tt,(function(e){var t=E(this);""==(e=I(e))?t.query=null:("?"==M(e,0)&&(e=H(e,1)),t.query="",je(t,e,Ue)),A(t.searchParams).updateSearchParams(t.query)})),searchParams:it(nt),hash:it(rt,(function(e){var t=E(this);""!=(e=I(e))?("#"==M(e,0)&&(e=H(e,1)),t.fragment="",je(t,e,He)):t.fragment=null}))}),p(Qe,"toJSON",(function(){return c(Ve,this)}),{enumerable:!0}),p(Qe,"toString",(function(){return c(Ve,this)}),{enumerable:!0}),w){var ot=w.createObjectURL,at=w.revokeObjectURL;ot&&p(Be,"createObjectURL",u(ot,w)),at&&p(Be,"revokeObjectURL",u(at,w))}T(Be,"URL"),i({global:!0,forced:!a,sham:!o},{URL:Be})},5138:function(e){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */
e.exports=function(){"use strict";function e(e){return"function"===typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},n=0,r=void 0,i=void 0,o=function(e,t){p[n]=e,p[n+1]=t,2===(n+=2)&&(i?i(h):f())};var a="undefined"!==typeof window?window:void 0,s=a||{},u=s.MutationObserver||s.WebKitMutationObserver,c="undefined"===typeof self&&"undefined"!==typeof process&&"[object process]"==={}.toString.call(process),d="undefined"!==typeof Uint8ClampedArray&&"undefined"!==typeof importScripts&&"undefined"!==typeof MessageChannel;function l(){var e=setTimeout;return function(){return e(h,1)}}var p=new Array(1e3);function h(){for(var e=0;e<n;e+=2)(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0;n=0}var f=void 0;function v(e,t){var n=this,r=new this.constructor(m);void 0===r[y]&&C(r);var i=n._state;if(i){var a=arguments[i-1];o((function(){return A(i,r,a,n._result)}))}else E(n,r,e,t);return r}function g(e){if(e&&"object"===typeof e&&e.constructor===this)return e;var t=new this(m);return T(t,e),t}f=c?function(){return process.nextTick(h)}:u?function(){var e=0,t=new u(h),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}():d?function(){var e=new MessageChannel;return e.port1.onmessage=h,function(){return e.port2.postMessage(0)}}():void 0===a?function(){try{var e=Function("return this")().require("vertx");return"undefined"!==typeof(r=e.runOnLoop||e.runOnContext)?function(){r(h)}:l()}catch(t){return l()}}():l();var y=Math.random().toString(36).substring(2);function m(){}var S=void 0;function I(t,n,r){n.constructor===t.constructor&&r===v&&n.constructor.resolve===g?function(e,t){1===t._state?b(e,t._result):2===t._state?P(e,t._result):E(t,void 0,(function(t){return T(e,t)}),(function(t){return P(e,t)}))}(t,n):void 0===r?b(t,n):e(r)?function(e,t,n){o((function(e){var r=!1,i=function(e,t,n,r){try{e.call(t,n,r)}catch(i){return i}}(n,t,(function(n){r||(r=!0,t!==n?T(e,n):b(e,n))}),(function(t){r||(r=!0,P(e,t))}),e._label);!r&&i&&(r=!0,P(e,i))}),e)}(t,n,r):b(t,n)}function T(e,t){if(e===t)P(e,new TypeError("You cannot resolve a promise with itself"));else if(function(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}(t)){var n=void 0;try{n=t.then}catch(r){return void P(e,r)}I(e,t,n)}else b(e,t)}function R(e){e._onerror&&e._onerror(e._result),x(e)}function b(e,t){e._state===S&&(e._result=t,e._state=1,0!==e._subscribers.length&&o(x,e))}function P(e,t){e._state===S&&(e._state=2,e._result=t,o(R,e))}function E(e,t,n,r){var i=e._subscribers,a=i.length;e._onerror=null,i[a]=t,i[a+1]=n,i[a+2]=r,0===a&&e._state&&o(x,e)}function x(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,o=e._result,a=0;a<t.length;a+=3)r=t[a],i=t[a+n],r?A(n,r,i,o):i(o);e._subscribers.length=0}}function A(t,n,r,i){var o=e(r),a=void 0,s=void 0,u=!0;if(o){try{a=r(i)}catch(c){u=!1,s=c}if(n===a)return void P(n,new TypeError("A promises callback cannot return that same promise."))}else a=i;n._state!==S||(o&&u?T(n,a):!1===u?P(n,s):1===t?b(n,a):2===t&&P(n,a))}var w=0;function C(e){e[y]=w++,e._state=void 0,e._result=void 0,e._subscribers=[]}var D=function(){function e(e,n){this._instanceConstructor=e,this.promise=new e(m),this.promise[y]||C(this.promise),t(n)?(this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===this.length?b(this.promise,this._result):(this.length=this.length||0,this._enumerate(n),0===this._remaining&&b(this.promise,this._result))):P(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===S&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===g){var i=void 0,o=void 0,a=!1;try{i=e.then}catch(u){a=!0,o=u}if(i===v&&e._state!==S)this._settledAt(e._state,t,e._result);else if("function"!==typeof i)this._remaining--,this._result[t]=e;else if(n===k){var s=new n(m);a?P(s,o):I(s,e,i),this._willSettleAt(s,t)}else this._willSettleAt(new n((function(t){return t(e)})),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===S&&(this._remaining--,2===e?P(r,n):this._result[t]=n),0===this._remaining&&b(r,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;E(e,void 0,(function(e){return n._settledAt(1,t,e)}),(function(e){return n._settledAt(2,t,e)}))},e}();var k=function(){function t(e){this[y]=w++,this._result=this._state=void 0,this._subscribers=[],m!==e&&("function"!==typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){T(e,t)}),(function(t){P(e,t)}))}catch(n){P(e,n)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var n=this,r=n.constructor;return e(t)?n.then((function(e){return r.resolve(t()).then((function(){return e}))}),(function(e){return r.resolve(t()).then((function(){throw e}))})):n.then(t,t)},t}();return k.prototype.then=v,k.all=function(e){return new D(this,e).promise},k.race=function(e){var n=this;return t(e)?new n((function(t,r){for(var i=e.length,o=0;o<i;o++)n.resolve(e[o]).then(t,r)})):new n((function(e,t){return t(new TypeError("You must pass an array to race."))}))},k.resolve=g,k.reject=function(e){var t=new this(m);return P(t,e),t},k._setScheduler=function(e){i=e},k._setAsap=function(e){o=e},k._asap=o,k.polyfill=function(){var e=void 0;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof self)e=self;else try{e=Function("return this")()}catch(r){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(r){}if("[object Promise]"===n&&!t.cast)return}e.Promise=k},k.Promise=k,k}()},7159:function(e,t){"use strict";var n=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n)return n;throw new Error("unable to locate global object")}();e.exports=t=n.fetch,n.fetch&&(t.default=n.fetch.bind(n)),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response},2911:function(e){
/**
 * Copyright (c) 2014-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var t=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(k){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=t&&t.prototype instanceof g?t:g,o=Object.create(i.prototype),a=new w(r||[]);return o._invoke=function(e,t,n){var r=l;return function(i,o){if(r===h)throw new Error("Generator is already running");if(r===f){if("throw"===i)throw o;return D()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===l)throw r=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var u=d(e,t,n);if("normal"===u.type){if(r=n.done?f:p,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=f,n.method="throw",n.arg=u.arg)}}}(e,n,a),o}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(k){return{type:"throw",arg:k}}}e.wrap=c;var l="suspendedStart",p="suspendedYield",h="executing",f="completed",v={};function g(){}function y(){}function m(){}var S={};u(S,o,(function(){return this}));var I=Object.getPrototypeOf,T=I&&I(I(C([])));T&&T!==n&&r.call(T,o)&&(S=T);var R=m.prototype=g.prototype=Object.create(S);function b(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function n(i,o,a,s){var u=d(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"===typeof l&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var i;this._invoke=function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}}function E(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=d(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function C(e){if(e){var n=e[o];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:D}}function D(){return{value:t,done:!0}}return y.prototype=m,u(R,"constructor",m),u(m,"constructor",y),y.displayName=u(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,s,"GeneratorFunction")),e.prototype=Object.create(R),e},e.awrap=function(e){return{__await:e}},b(P.prototype),u(P.prototype,a,(function(){return this})),e.AsyncIterator=P,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new P(c(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(R),u(R,s,"Generator"),u(R,o,(function(){return this})),u(R,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=C,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:C(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=t}catch(n){"object"===typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},1906:function(){!function(e){var t=function(){try{return!!Symbol.iterator}catch(e){return!1}}(),n=function(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t&&(n[Symbol.iterator]=function(){return n}),n},r=function(e){return encodeURIComponent(e).replace(/%20/g,"+")},i=function(e){return decodeURIComponent(String(e).replace(/\+/g," "))};(function(){try{var t=e.URLSearchParams;return"a=1"===new t("?a=1").toString()&&"function"===typeof t.prototype.set&&"function"===typeof t.prototype.entries}catch(n){return!1}})()||function(){var i=function(e){Object.defineProperty(this,"_entries",{writable:!0,value:{}});var t=typeof e;if("undefined"===t);else if("string"===t)""!==e&&this._fromString(e);else if(e instanceof i){var n=this;e.forEach((function(e,t){n.append(t,e)}))}else{if(null===e||"object"!==t)throw new TypeError("Unsupported input's type for URLSearchParams");if("[object Array]"===Object.prototype.toString.call(e))for(var r=0;r<e.length;r++){var o=e[r];if("[object Array]"!==Object.prototype.toString.call(o)&&2===o.length)throw new TypeError("Expected [string, any] as entry at index "+r+" of URLSearchParams's input");this.append(o[0],o[1])}else for(var a in e)e.hasOwnProperty(a)&&this.append(a,e[a])}},o=i.prototype;o.append=function(e,t){e in this._entries?this._entries[e].push(String(t)):this._entries[e]=[String(t)]},o.delete=function(e){delete this._entries[e]},o.get=function(e){return e in this._entries?this._entries[e][0]:null},o.getAll=function(e){return e in this._entries?this._entries[e].slice(0):[]},o.has=function(e){return e in this._entries},o.set=function(e,t){this._entries[e]=[String(t)]},o.forEach=function(e,t){var n;for(var r in this._entries)if(this._entries.hasOwnProperty(r)){n=this._entries[r];for(var i=0;i<n.length;i++)e.call(t,n[i],r,this)}},o.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),n(e)},o.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),n(e)},o.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),n(e)},t&&(o[Symbol.iterator]=o.entries),o.toString=function(){var e=[];return this.forEach((function(t,n){e.push(r(n)+"="+r(t))})),e.join("&")},e.URLSearchParams=i}();var o=e.URLSearchParams.prototype;"function"!==typeof o.sort&&(o.sort=function(){var e=this,t=[];this.forEach((function(n,r){t.push([r,n]),e._entries||e.delete(r)})),t.sort((function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0})),e._entries&&(e._entries={});for(var n=0;n<t.length;n++)this.append(t[n][0],t[n][1])}),"function"!==typeof o._fromString&&Object.defineProperty(o,"_fromString",{enumerable:!1,configurable:!1,writable:!1,value:function(e){if(this._entries)this._entries={};else{var t=[];this.forEach((function(e,n){t.push(n)}));for(var n=0;n<t.length;n++)this.delete(t[n])}var r,o=(e=e.replace(/^\?/,"")).split("&");for(n=0;n<o.length;n++)r=o[n].split("="),this.append(i(r[0]),r.length>1?i(r[1]):"")}})}("undefined"!==typeof window||"undefined"!==typeof window?window:"undefined"!==typeof self?self:this),function(e){if(function(){try{var t=new e.URL("b","http://a");return t.pathname="c d","http://a/c%20d"===t.href&&t.searchParams}catch(n){return!1}}()||function(){var t=e.URL,n=function(t,n){"string"!==typeof t&&(t=String(t)),n&&"string"!==typeof n&&(n=String(n));var r,i=document;if(n&&(void 0===e.location||n!==e.location.href)){n=n.toLowerCase(),(r=(i=document.implementation.createHTMLDocument("")).createElement("base")).href=n,i.head.appendChild(r);try{if(0!==r.href.indexOf(n))throw new Error(r.href)}catch(p){throw new Error("URL unable to set base "+n+" due to "+p)}}var o=i.createElement("a");o.href=t,r&&(i.body.appendChild(o),o.href=o.href);var a=i.createElement("input");if(a.type="url",a.value=t,":"===o.protocol||!/:/.test(o.href)||!a.checkValidity()&&!n)throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:o});var s=new e.URLSearchParams(this.search),u=!0,c=!0,d=this;["append","delete","set"].forEach((function(e){var t=s[e];s[e]=function(){t.apply(s,arguments),u&&(c=!1,d.search=s.toString(),c=!0)}})),Object.defineProperty(this,"searchParams",{value:s,enumerable:!0});var l=void 0;Object.defineProperty(this,"_updateSearchParams",{enumerable:!1,configurable:!1,writable:!1,value:function(){this.search!==l&&(l=this.search,c&&(u=!1,this.searchParams._fromString(this.search),u=!0))}})},r=n.prototype;["hash","host","hostname","port","protocol"].forEach((function(e){!function(e){Object.defineProperty(r,e,{get:function(){return this._anchorElement[e]},set:function(t){this._anchorElement[e]=t},enumerable:!0})}(e)})),Object.defineProperty(r,"search",{get:function(){return this._anchorElement.search},set:function(e){this._anchorElement.search=e,this._updateSearchParams()},enumerable:!0}),Object.defineProperties(r,{toString:{get:function(){var e=this;return function(){return e.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(e){this._anchorElement.href=e,this._updateSearchParams()},enumerable:!0},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(e){this._anchorElement.pathname=e},enumerable:!0},origin:{get:function(){var e={"http:":80,"https:":443,"ftp:":21}[this._anchorElement.protocol],t=this._anchorElement.port!=e&&""!==this._anchorElement.port;return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(t?":"+this._anchorElement.port:"")},enumerable:!0},password:{get:function(){return""},set:function(e){},enumerable:!0},username:{get:function(){return""},set:function(e){},enumerable:!0}}),n.createObjectURL=function(e){return t.createObjectURL.apply(t,arguments)},n.revokeObjectURL=function(e){return t.revokeObjectURL.apply(t,arguments)},e.URL=n}(),void 0!==e.location&&!("origin"in e.location)){var t=function(){return e.location.protocol+"//"+e.location.hostname+(e.location.port?":"+e.location.port:"")};try{Object.defineProperty(e.location,"origin",{get:t,enumerable:!0})}catch(n){setInterval((function(){e.location.origin=t()}),100)}}}("undefined"!==typeof window||"undefined"!==typeof window?window:"undefined"!==typeof self?self:this)},8470:function(e,t,n){var r=n(775),i=n(1673),o=i;o.v1=r,o.v4=i,e.exports=o},269:function(e){for(var t=[],n=0;n<256;++n)t[n]=(n+256).toString(16).substr(1);e.exports=function(e,n){var r=n||0,i=t;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},6546:function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0===(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},775:function(e,t,n){var r,i,o=n(6546),a=n(269),s=0,u=0;e.exports=function(e,t,n){var c=t&&n||0,d=t||[],l=(e=e||{}).node||r,p=void 0!==e.clockseq?e.clockseq:i;if(null==l||null==p){var h=o();null==l&&(l=r=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==p&&(p=i=16383&(h[6]<<8|h[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),v=void 0!==e.nsecs?e.nsecs:u+1,g=f-s+(v-u)/1e4;if(g<0&&void 0===e.clockseq&&(p=p+1&16383),(g<0||f>s)&&void 0===e.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=f,u=v,i=p;var y=(1e4*(268435455&(f+=122192928e5))+v)%4294967296;d[c++]=y>>>24&255,d[c++]=y>>>16&255,d[c++]=y>>>8&255,d[c++]=255&y;var m=f/4294967296*1e4&268435455;d[c++]=m>>>8&255,d[c++]=255&m,d[c++]=m>>>24&15|16,d[c++]=m>>>16&255,d[c++]=p>>>8|128,d[c++]=255&p;for(var S=0;S<6;++S)d[c+S]=l[S];return t||a(d)}},1673:function(e,t,n){var r=n(6546),i=n(269);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||i(a)}},5791:function(e,t,n){"use strict";var r="URLSearchParams"in self,i="Symbol"in self&&"iterator"in Symbol,o="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),a="FormData"in self,s="ArrayBuffer"in self;if(s)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&u.indexOf(Object.prototype.toString.call(e))>-1};function d(e){if("string"!==typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function l(e){return"string"!==typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i&&(t[Symbol.iterator]=function(){return t}),t}function h(e){this.map={},e instanceof h?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function f(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function v(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function g(e){var t=new FileReader,n=v(t);return t.readAsArrayBuffer(e),n}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"===typeof e?this._bodyText=e:o&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:a&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&o&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"===typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?f(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=v(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(T)}),this.json=function(){return this.text().then(JSON.parse)},this}h.prototype.append=function(e,t){e=d(e),t=l(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},h.prototype.delete=function(e){delete this.map[d(e)]},h.prototype.get=function(e){return e=d(e),this.has(e)?this.map[e]:null},h.prototype.has=function(e){return this.map.hasOwnProperty(d(e))},h.prototype.set=function(e,t){this.map[d(e)]=l(t)},h.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},h.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),p(e)},h.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),p(e)},h.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),p(e)},i&&(h.prototype[Symbol.iterator]=h.prototype.entries);var S=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function I(e,t){var n=(t=t||{}).body;if(e instanceof I){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new h(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new h(t.headers)),this.method=function(e){var t=e.toUpperCase();return S.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function T(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function R(e){var t=new h;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t}function b(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new h(t.headers),this.url=t.url||"",this._initBody(e)}I.prototype.clone=function(){return new I(this,{body:this._bodyInit})},m.call(I.prototype),m.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},b.error=function(){var e=new b(null,{status:0,statusText:""});return e.type="error",e};var P=[301,302,303,307,308];b.redirect=function(e,t){if(-1===P.indexOf(t))throw new RangeError("Invalid status code");return new b(null,{status:t,headers:{location:e}})};var E=self.DOMException;try{new E}catch(A){(E=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),E.prototype.constructor=E}function x(e,t){return new Promise((function(n,r){var i=new I(e,t);if(i.signal&&i.signal.aborted)return r(new E("Aborted","AbortError"));var a=new XMLHttpRequest;function s(){a.abort()}a.onload=function(){var e={status:a.status,statusText:a.statusText,headers:R(a.getAllResponseHeaders()||"")};e.url="responseURL"in a?a.responseURL:e.headers.get("X-Request-URL");var t="response"in a?a.response:a.responseText;n(new b(t,e))},a.onerror=function(){r(new TypeError("Network request failed"))},a.ontimeout=function(){r(new TypeError("Network request failed"))},a.onabort=function(){r(new E("Aborted","AbortError"))},a.open(i.method,i.url,!0),"include"===i.credentials?a.withCredentials=!0:"omit"===i.credentials&&(a.withCredentials=!1),"responseType"in a&&o&&(a.responseType="blob"),i.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),i.signal&&(i.signal.addEventListener("abort",s),a.onreadystatechange=function(){4===a.readyState&&i.signal.removeEventListener("abort",s)}),a.send("undefined"===typeof i._bodyInit?null:i._bodyInit)}))}x.polyfill=!0,self.fetch||(self.fetch=x,self.Headers=h,self.Request=I,self.Response=b)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n(1906),n(5791),n(8442)}();
//# sourceMappingURL=microsoft.office.smartlookup.host.runtime.js.map