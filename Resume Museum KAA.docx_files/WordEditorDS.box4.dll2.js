'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1289:function(C,L,b){b.r(L);C=b(0);var f=b(244),c=b(1312),u=b(1296),r=b(1452),t=b(1453);class k{constructor(l,x){this.lzb=!1;this.Usa=null;if(!l)throw Error.argumentNull("annotations");if(!l.nLc(x))throw Error.argument("structTypeID","Invalid struct type ID");this.Jy=l;this.hMc=this.Jy.RAi(x);this.Sok=x}get Qyc(){return this.Jy}get isReadOnly(){return this.lzb}get u9a(){return this.Sok}BFb(l){if(0>l||l>=this.hMc)throw Error.argument("iField",
"Invalid field index");return this.Usa&&null!=this.Usa[l]?this.Usa[l]:this.Jy.vEi(this.u9a,l)}E0g(l,x){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>l||l>=this.hMc)throw Error.argument("iField","Invalid field index");if(!this.Jy.oKc(this.Jy.l$b(this.u9a,l),x))throw Error.argument("value","Value is not of the correct type for the specified field");(this.Usa||(this.Usa=Array(this.hMc)))[l]=x}Noa(){const {Annotations:l}=b(1289);let x="[";if(this.Usa){let w=
!0;for(let G=0;G<this.hMc;++G){if(null==this.Usa[G])continue;const D=this.Jy.l$b(this.u9a,G);if(l.CPb(D,this.Usa[G],this.Jy.vEi(this.u9a,G)))continue;w?w=!1:x+=", ";x+=this.Jy.wEi(this.u9a,G);x+="=";const H=this.Jy.Noa(D,this.Usa[G]);D===l.hia?(x+='"',x+=c.a.P_f(H),x+='"'):x+=H}}return x+"]"}isEqual(l){const {Annotations:x}=b(1289);if(this===l)return!0;if(!l||this.Jy!==l.Qyc||this.u9a!==l.u9a)return!1;for(let w=0;w<this.hMc;++w)if(!x.CPb(this.Jy.l$b(this.u9a,w),this.BFb(w),l.BFb(w)))return!1;return!0}clone(){const l=
new k(this.Jy,this.u9a);this.Usa&&(l.Usa=Array.clone(this.Usa));return l}j_(){return this.isReadOnly?this.clone():this}Fwg(){const {Annotations:l}=b(1289);if(!this.isReadOnly&&(this.lzb=!0,this.Usa))for(let x=0;x<this.hMc;++x){const w=this.Usa[x];null!=w&&l.yec(w)}}toString(){return this.Noa()}}Object(C.a)(k,"StructValue",null,[1157,1158]);b.d(L,"Annotations",function(){return m});class m{constructor(l,x){if(!l)throw Error.argumentNull("initData");if(!x)throw Error.argumentNull("objectFetcher");this.xsm=
x.Qcl;let w=0;var G=x.lFb(l.J(w));++w;this.Dyg=new r.a(new t.a(G));this.x8j=l.J(w);++w;this.V1i=Array(this.bte);this.vHd=Array(this.bte);this.$Ib=Array(this.bte);for(G=0;G<this.bte;++G){this.V1i[G]=x.getString(l.J(w));++w;this.vHd[G]=l.J(w);++w;var D=l.J(w);++w;this.$Ib[G]=Array(D);for(var H=0;H<D;++H)this.$Ib[G][H]=x.getString(l.J(w)),++w}this.Rok=l.J(w);++w;this.z2i=Array(this.cXd);this.RKe=Array(this.cXd);this.SKe=Array(this.cXd);this.QKe=Array(this.cXd);for(G=0;G<this.cXd;++G)for(this.z2i[G]=
x.getString(l.J(w)),++w,D=l.J(w),++w,this.RKe[G]=Array(D),this.SKe[G]=Array(D),this.QKe[G]=Array(D),H=0;H<D;++H)this.RKe[G][H]=x.getString(l.J(w)),++w,this.SKe[G][H]=l.J(w),++w,this.QKe[G][H]=({asa:w}=this.Wya(this.SKe[G][H],l,w,null,null,null)).returnValue,m.yec(this.QKe[G][H]);this.Z2j=l.J(w);++w;this.jyg=Array(this.qzc);this.kyg=Array(this.qzc);this.iyg=Array(this.qzc);for(G=0;G<this.qzc;++G)this.jyg[G]=x.getString(l.J(w)),++w,this.kyg[G]=l.J(w),++w,this.iyg[G]=({asa:w}=this.Wya(this.kyg[G],l,
w,null,null,null)).returnValue,m.yec(this.iyg[G])}Usd(l){for(let x=0;x<this.qzc;++x)if(this.jyg[x]===l)return x;return-1}mti(l){if(!this.lLc(l))throw Error.argument("attrID","Invalid attribute ID");return this.jyg[l]}getAttributeType(l){if(!this.lLc(l))throw Error.argument("attrID","Invalid attribute ID");return this.kyg[l]}l$b(l,x){if(!this.nLc(l))throw Error.argument("structTypeID","Invalid struct type ID");l=this.SKe[m.dXd(l)];if(0>x||x>=l.length)throw Error.argument("iField","Invalid field index");
return l[x]}Noa(l,x){if(!this.otg(l))throw Error.argument("typeID","Invalid type ID");if(!this.oKc(l,x))throw Error.argument("value","Value is not of the correct type");switch(l){case m.hia:return x;case m.zLa:return x?"True":"False";case m.vZa:case m.JDa:return x.toString();case m.t1:return x.Noa();default:if(!m.yM(l)&&m.OZd(l)){l=m.C_f(l);const D=this.$Ib[l].length;switch(this.vHd[l]){case 0:return this.$Ib[l][x];case 1:if(x){var w="";for(var G=1;G<D;++G)x&1<<G-1&&(0<w.length&&(w+=" & "),w+=this.$Ib[l][G]);
return w}return this.$Ib[l][0];case 2:w="";for(G=0;G<D;++G)x&1<<G&&(0<w.length&&(w+=" & "),w+=this.$Ib[l][G]);return w;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.vHd[l]);}}else return x.Noa()}}otg(l){switch(l){case m.hia:case m.zLa:case m.vZa:case m.JDa:case m.t1:return!0;default:return m.yM(l)?this.otg(m.Vlb(l)):m.OZd(l)?this.jhm(l):this.nLc(l)}}jhm(l){l=m.C_f(l);return 0<=l&&l<this.V1i.length}nLc(l){l=m.dXd(l);return 0<=l&&l<this.z2i.length}lLc(l){return 0<=l&&l<
this.qzc}oKc(l,x){if(null==x)return!1;switch(l){case m.hia:return"string"===typeof x;case m.zLa:return"boolean"===typeof x;case m.vZa:return"number"===typeof x;case m.JDa:return"number"===typeof x;case m.t1:return Object(f.a)(1155,x);default:if(m.yM(l))return Object(f.a)(1156,x)&&x.qca===m.Vlb(l);if(m.OZd(l)){if("number"!==typeof x)return!1;l=m.C_f(l);const w=this.$Ib[l].length;switch(this.vHd[l]){case 0:return 0<=x&&x<w;case 1:return!(x&-1<<w-1);case 2:return!!x&&!(x&-1<<w);default:throw Error.invalidOperation("Unrecognized enum type flavor "+
this.vHd[l]);}}else return Object(f.a)(1157,x)&&x.u9a===l}}get qzc(){return this.Z2j}get bte(){return this.x8j}get cXd(){return this.Rok}zsl(l){if(!this.lLc(l))throw Error.argument("attrID","Invalid attribute ID");return this.iyg[l]}RAi(l){if(!this.nLc(l))throw Error.argument("structTypeID","Invalid struct type ID");return this.RKe[m.dXd(l)].length}wEi(l,x){if(!this.nLc(l))throw Error.argument("structTypeID","Invalid struct type ID");return this.RKe[m.dXd(l)][x]}vEi(l,x){if(!this.nLc(l))throw Error.argument("structTypeID",
"Invalid struct type ID");l=this.QKe[m.dXd(l)];if(0>x||x>=l.length)throw Error.argument("iField","Invalid field index");return l[x]}Wya(l,x,w,G,D,H){if(!x)throw Error.argumentNull("initData");if(m.yM(l)){var M=x.J(w);++w;l=m.Vlb(l);var J=new u.a(this,l);for(var F=0;F<M;++F)Array.add(J.items,({asa:w}=this.Wya(l,x,w,G,D,H)).returnValue);return{returnValue:J,asa:w}}switch(l){case m.hia:return{returnValue:(G||this.Dyg).getString(x.J(w++)),asa:w};case m.zLa:return{returnValue:1===x.J(w++),asa:w};case m.vZa:return{returnValue:x.J(w++),
asa:w};case m.JDa:return{returnValue:(D||this.xsm)[x.J(w++)],asa:w};case m.t1:l=x.J(w++);M=new c.a(this);for(J=0;J<l;++J)F=x.J(w),++w,H&&(F=H[F]),M.kB(F,({asa:w}=this.Wya(this.getAttributeType(F),x,w,G,D,H)).returnValue);return{returnValue:M,asa:w};default:if(m.OZd(l))return{returnValue:x.J(w++),asa:w};if(m.pMj(l)){M=x.J(w++);J=new k(this,l);for(F=0;F<M;++F){const A=x.J(w);++w;J.E0g(A,({asa:w}=this.Wya(this.l$b(l,A),x,w,G,D,H)).returnValue)}return{returnValue:J,asa:w}}throw Error.argument("typeID",
"Invalid type ID");}}static OZd(l){return 16<=(l&16383)&&16384!==(l&16384)&&32768!==(l&32768)}static pMj(l){return 16<=(l&16383)&&16384===(l&16384)&&32768!==(l&32768)}static yM(l){return 32768===(l&32768)}static fFl(l){if(m.yM(l))throw Error.argument("nonListTypeID","Non-list type ID required");return l|32768}static Vlb(l){if(!m.yM(l))throw Error.argument("listTypeID","List type ID required");return l&-32769}static CPb(l,x,w){switch(l){case m.hia:case m.zLa:case m.vZa:case m.JDa:return x===w;case m.t1:return x.isEqual(w);
default:return m.yM(l)?x.isEqual(w):m.OZd(l)?x===w:x.isEqual(w)}}static yec(l){Object(f.a)(1158,l)&&l.Fwg()}static j_(l){return Object(f.a)(1158,l)?l.j_():l}static C_f(l){return l-16}static dXd(l){return(l&-16385)-16}}m.hia=1;m.zLa=2;m.vZa=3;m.JDa=5;m.t1=9;Object(C.a)(m,"Annotations",null,[1159])},1290:function(C,L,b){C=b(0);var f=b(17),c=b(42),u=b(6),r=b(109),t=b(146),k=b(726),m=b(199),l=b(577),x=b(2),w=b(362),G=b(23),D=b(41),H=b(245),M=b(1),J=b(1371);class F{constructor(E,P){this.A8j=E;this.HF=
P}J(E){return this.A8j.VA(E,this.HF)}}Object(C.a)(F,"PropertyMergeStrategies",null,[]);var A=b(1447),N=b(1542);b.d(L,"a",function(){return B});class B{constructor(E=null){this.BKh=this.Ja=null;this.Fuc=E||this.mvd()}get Dp(){return 1}get nJb(){return this.Fuc}mvd(){return[Object(D.a)(this,this.aIn,"tryPreProcessFavoredRevision"),Object(D.a)(this,this.yTk,"cloneObjectAndRemoveNeededProperties"),Object(D.a)(this,this.RHn,"tryMergeNodeInternal")]}set Ka(E){this.Ja=E}get HF(){return 5}get RNd(){return this.BKh||
(this.BKh=new F(this.El(),this.HF))}kG(E,P){const T=E.vg.value.We;t.a.instance.xa(4016352,1,3,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",T.id,T.Jb);E.jm.logger.Fg(Object.assign(new N.a,{Dp:this.Dp,dNc:T.Jb,QNd:P}));return!1}Lbh(E){const P=E.vg.value;t.a.instance.xa(4016353,1,4,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",P.We.id,P.We.Jb);for(let T=0;T<this.nJb.length;T++)if(!(0,this.nJb[T])(E))return t.a.instance.xa(4016354,
1,3,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",P.We.id,P.We.Jb,T),E.jm.logger.vKe("GraphNodeComplexMerge.GetMergeFunctions()",T),this.cnm(E),E.Gl=null,!1;t.a.instance.xa(4016355,1,4,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",P.We.id,P.We.Jb);return!0}cnm(E){E.Qgh||(E.Qgh=!0,A.a(E.vg.value.Uv,"Base",1),A.a(E.vg.value.We,"Favored",1),A.a(E.wo.value.We,"Conflict",1))}aIn(E){const P=E.vg.value,T=this.RNd;if(!P.pY)return!0;let V=
!0;P.Pna.forEach((I,R)=>{if(!R.pY||E.hg.contains(I))return!0;R=T.J(I);if(5===R){const ba=P.Uv.Jb;t.a.instance.xa(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",ba,I,R);E.jm.logger.Fg(Object.assign(new N.a,{Dp:this.Dp,dNc:ba,QNd:I,cId:R}));return V=!1}6===R&&E.xPg.add(I);return!0});return V}yTk(E){E.Gl=E.vg.value.We.AF();const P=E.xPg,T=E.Gl;P&&P.forEach(V=>{T.removeProperty(k.a.MX(V));return!0});
return!0}RHn(E){const P=E.wo.value,T=P.Uv.Jb,V=this.RNd;let I=!0;P.Pna.forEach((R,ba)=>{const ha=V.J(R);I=this.SHn(E,ba,R,ha);I||(E.Gl=null,t.a.instance.xa(4018177,1,3,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",T,R,ha),E.jm.logger.Fg(Object.assign(new N.a,{Dp:this.Dp,dNc:T,QNd:R,cId:ha})));return I});return I}SHn(E,P,T,V){const I=E.Gl;if(!P.pY&&8!==V||2===V||7===V||E.hg.contains(T))return!0;if(5===V)return!1;if(4===V||3===V){let R;if(({value:R}=E.vg.value.Pna.Ab(T)).returnValue&&
R.pY)return 4!==V;V=0}8===V&&(V=0);if(0===V){if(!P.isDeleted)return E=k.a.MX(T),(B.fRn(P,T,E)||B.Isn())&&I.c1(E,P.newValue),!0;V=6}return 6===V?(I.removeProperty(k.a.MX(T)),!0):1===V?this.kG(E,T):!1}nwm(E,P,T,V,I,R){E=E||new m.a;P=P||new m.a;T=T||new m.a;var ba=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",E.length,P.length,T.length),ha=E.length<=P.length&&E.length<=T.length;this.DSi()&&ha&&t.a.instance.xa(541181455,
1,1,ba);if(!ha&&this.bRi(R.runtime.Ka))return null;if(this.DSi())for(ba=0;ba<E.length;ba++){ha=E.Rf(ba);var na=P.Rf(ba);let da=T.Rf(ba);ha=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",ha,na,da,ba,E.length);t.a.instance.xa(541181457,1,1,ha)}if(this.bRi(R.runtime.Ka))for(R=0;R<E.length;R++)if(ba=E.Rf(R),ha=P.Rf(R),na=T.Rf(R),!V(ba,ha)||!V(ba,na))return null;E=E.I8();V=new l.a;R=
E.length;for(ba=R;ba<P.length;ba++)ha=P.Rf(ba),E.add(ha),V.add(ha);for(;R<T.length;R++)P=T.Rf(R),V.contains(P)?t.a.instance.xa(4018180,1,4,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",P):(E.add(P),I(P));return E}DSi(){return!!x.AFrameworkApplication.K&&x.AFrameworkApplication.K.ea("LogMPALErrors")}bRi(E){if(!E)return!1;E.TAe(1000008);return E.Cmb(1000008)}Cfm(E){if(!E)return!1;E.TAe(1000009);return E.Cmb(1000009)}h4i(E,P,T,V){return J.a(E,
P,T,V)}O6a(E,P,T){E=E||new m.a;P=P||new m.a;T=T||new m.a;const V=E.iG(),I=P.iG(),R=T.iG();E=B.filter(E,ba=>I.contains(ba)&&R.contains(ba));E.iG();E.$B(E.length,B.filter(P,ba=>!V.contains(ba)));E.$B(E.length,B.filter(T,ba=>!V.contains(ba)&&!I.contains(ba)));return E}jwm(E,P){const T=k.a.MX(P),V=E.Mc;var I=V.getPropertyObjectIds(E.vg.value.Uv,T),R=V.getPropertyObjectIds(E.vg.value.We,T);const ba=V.getPropertyObjectIds(E.wo.value.We,T);I=this.O6a(I,R,ba);R=E.Gl;0<I.length?V.setPropertyObjectIds(R,T,
I):R.removeProperty(T);E.hg.add(P)}pDb(E,P,T){E.hasProperty(T)?P.c1(T,E.Cy(T)):P.removeProperty(T)}P9m(E,P){var T=P.Dh();for(const V of T)P.removeProperty(V);T=E.Dh();for(const V of T)P.c1(V,E.Cy(V))}Ttg(E,P,T,V,I){P=E.getPropertyInt32(P,I);T=E.getPropertyInt32(T,I);T=null!=P&&null!=T?Math.max(P,T):null!=T?T:null!=P?P:null;null!=T?E.setPropertyInt32(V,I,T):V.removeProperty(I)}zLf(E,P,T,V,I,R){P=E(P,I);T=E(T,I);E=E(V,I);V=P.iG();let ba=!1;R&&(ba=R(P,T,E));ba?(R=!0,V=!1):(R=V.$Of(T),V=V.$Of(E));t.a.instance.xa(588011013,
1,3,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",k.a.Ra(I),P.Dr(),T.Dr(),E.Dr(),R,V);return{Nld:E,Cob:R,sob:V}}hQk(E,P,T,V,I){let R;P=E(P,I);T=E(T,I);E=E(V,I);V=this.MUi(P,T);R=this.MUi(P,E);t.a.instance.xa(588011014,1,3,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
k.a.Ra(I),P.Dr(),T.Dr(),E.Dr(),V,R);return{Nld:E,Cob:V,sob:R}}MUi(E,P){if(!E&&!P)return!0;if(!E||!P)return!1;if(!E.count&&!P.count)return!0;let T=!1;P.forEach((V,I)=>T=E.Na(V)&&I==E.J(V));return T}El(){let E;E=this.Cfm(this.Ja)?B.Eek.value:B.Dek.value;const P=new w.a(0);for(let T=0;T<E.length;T++)P.$(E[T],7);return P}static Afa(){return new B}static get instance(){return B.na.value}static Isn(){return G.a.instance.sa("Box4.IFeatureHelper").isFeatureEnabled(126)}static fRn(E,P,T){if(void 0!==E.newValue&&
null!==E.newValue||M.a.qGe(T.type))return!0;B.fom(E,P,T);return!1}static fom(E,P,T){T=T.type===M.a.string;P=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",P);T||(P+=String.format(" [NewValue: {0}] [OldValue: {1}]",E.newValue,E.oldValue));t.a.instance.xa(19145822,1,2,P)}static filter(E,P){const T=new m.a;E.forEach(V=>{P(V)&&T.add(V);return!0});return T}static xCl(){return[k.a.Ra(f.a.gqd),k.a.Ra(f.a.lastModifiedTime),k.a.Ra(f.a.NI),k.a.Ra(f.a.CXa),k.a.Ra(f.a.URd),k.a.Ra(c.a.Rfc),
k.a.Ra(u.a.gBc),k.a.Ra(u.a.JSa),k.a.Ra(r.a.AYg)]}static yCl(){return[k.a.Ra(f.a.gqd),k.a.Ra(f.a.lastModifiedTime),k.a.Ra(f.a.NI),k.a.Ra(f.a.CXa),k.a.Ra(f.a.URd),k.a.Ra(c.a.Rfc),k.a.Ra(u.a.gBc),k.a.Ra(r.a.AYg)]}}B.na=new H.a(B.Afa);B.Dek=new H.a(B.xCl);B.Eek=new H.a(B.yCl);Object(C.a)(B,"GraphNodeComplexMerge",null,[1888])},1294:function(C,L,b){C=b(0);var f=b(265);class c{constructor(){this.userId=this.email=this.displayName=null}}Object(C.a)(c,"InsertMentionParameters",null,[]);class u{constructor(){this.neighborhood=
null;this.mentionLength=this.mentionStart=0}}Object(C.a)(u,"InsightsParameters",null,[]);var r=b(1552),t=b(1553),k=b(1554),m=b(1555),l=b(2),x=b(1355),w=b(1368),G=b(32),D=b(15),H=b(16),M=b(1285);b.d(L,"a",function(){return J});class J{static get Tkg(){return"Insights_16x16x32"}static get Fkl(){return"Find_16x16x32"}static get Bdj(){return"-Parameterized"}static get p6g(){return"Parameterized"}static get L2e(){return"bTryQuery"}static get Tbh(){return"TellMeSuggestion_"}static get XLj(){return"bTryQueryAlternate"}static get t$g(){return"MenuTellMe"}static get eQm(){const F=
{},A=[];Array.add(A,{Term:{PeopleType:"Person"}});F.And=A;return F}static SSf(F){return F+J.Bdj}static getParameter(F){let A="",N="";if(F)for(let B=0;B<F.xni;++B)"Type"===F.n8f(B)?A=F.getValue(B):"Value"===F.n8f(B)&&(N=F.getValue(B));return new f.a(A,N)}static Z5b(F){F=Object.assign(new u,{neighborhood:F,mentionStart:0,mentionLength:F.length});return G.c(F)}static vdi(F,A,N){F=Object.assign(new c,{displayName:F,email:A,userId:N});return G.c(F)}static ejb(F,A,N=null){F=Object.assign(new w.a,{neighborhood:F,
mentionStart:0,mentionLength:F?F.length:0});A=Object.assign(new x.a,{selection:F,userIntent:null,entryPoint:A,launchData:N});return G.c(A)}static Rbn(F,A){return J.ejb(F,J.Sbn(A))}static Sbn(F){switch(F){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;default:return 0}}static BRi(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.ea("IsGoLocalEnvironment")}static $cc(){const F=l.AFrameworkApplication.K?
l.AFrameworkApplication.K.Ga("SovereignEnvironmentName"):null;return!!F&&0<F.length}static isEnterpriseUser(){const F=l.AFrameworkApplication.K?l.AFrameworkApplication.K.Ga("HostAuthType"):null;return!!F&&"aad"===F.toLowerCase()||"external"===F&&J.Bng()}static a4g(F){return F.NCn&&!J.$cc()}static nUi(){const F=l.AFrameworkApplication.K?l.AFrameworkApplication.K.Ga("UiHostIntegrationType"):"";return!!l.AFrameworkApplication.K&&"UnifiedUiHostTeams"===F&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static $3g(F){return F.M9a&&F.hjl&&(F.dYd||F.bYd||F.mpb)&&!J.nUi()&&J.isEnterpriseUser()&&!J.$cc()}static AVa(){return l.AFrameworkApplication.K?l.AFrameworkApplication.bLa||l.AFrameworkApplication.K.ea("SmartLookupEnableNativePane"):l.AFrameworkApplication.bLa}static O7(F){return!F||J.JUi(F.Qg)}static JUi(F){return!F||!F.trim().length}static fbh(F){if(!F)return 0;const A=Math.pow(10,5);return Math.round(F*A)/A}static BEn(){var F=new Date;return F?new Date(F.getUTCFullYear(),F.getUTCMonth(),F.getUTCDate(),
F.getUTCHours(),F.getUTCMinutes(),F.getUTCSeconds(),F.getUTCMilliseconds()):null}static $cg(F){F=new Date(F);return(J.BEn().getTime()-F.getTime())/1E3}static gVi(F){const {InsightsMenuItemFactory:A}=b(1551);switch(F){case r.a.Pgg:case t.a.fpi:case A.iOi:case k.a.C6i:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":return!0}return F.startsWith(J.L2e)||
F.startsWith(J.Tbh)||F.startsWith(J.XLj)||F.startsWith("PeopleSuggestion")||F.startsWith("FileSuggestion")||F.startsWith("FindInDocumentSuggestion")||F.startsWith("NotesSuggestion")||F.startsWith("OnenoteNotesSuggestion")||F.startsWith("SmartLookupFromTellMe")||F.startsWith("GetHelpFromTellMe")||F.startsWith("GetHelpWithDescriptionFromTellMe")||F.startsWith("AddinSuggestion")?!0:!1}static J8f(F,A){const N=[];Array.add(N,new m.a(400,F));Array.add(N,new m.a(200,A));F={};F.parts=N;return JSON.stringify(F)}static Zsd(F){const A=
F.indexOf("<b0>"),N=F.lastIndexOf("</b0>"),B=[];Array.add(B,new m.a(400,F.substring(0,A)));Array.add(B,new m.a(600,F.substring(A+4,N)));Array.add(B,new m.a(400,F.substring(N+5,F.length)));F={};F.parts=B;return JSON.stringify(F)}static MFi(F){const A=J.$cg(F);return 60>A?CommonUIStrings.l_TimeSince_SecsAgo:3600>A?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(A/60).toString()):86400>A?String.format(CommonUIStrings.l_TimeSince_HoursAgo,Math.floor(A/3600).toString()):172800>A?CommonUIStrings.l_TimeSince_Yesterday:
String.format(CommonUIStrings.l_TimeSince_Date,(new Date(F)).localeFormat("MMMM dd, yyyy"))}static Rul(F){const A=Array(F.length);for(let N=0;N<F.length;N++)A[N]=F[N].commandId;return A}static Bng(){if("Dev Box"===l.AFrameworkApplication.K.Ga("StatusBarEnvironmentNameToUse"))return!0;let F=l.AFrameworkApplication.K.Ga("UserPrincipalName");F=M.c(F)?"":H.a.He(F);const A=l.AFrameworkApplication.K.iz("TellMeIntEnabledForFeatureCrew")?l.AFrameworkApplication.K.kx("TellMeIntEnabledForFeatureCrew"):[];return 0<=
Array.indexOf(A,F)&&"inner"===l.AFrameworkApplication.K.Ga("Microsoft365Ring")}static tCl(F){switch(F.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"SaveAsPowerPointPotx_20";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"SaveAsWordDocx_20";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"SaveAsExcelXlsx_20";
case "pdf":return"PdfFile_32";case "one":case "onepkg":return"OneNote_32";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio_32"}return""}static Fy(){return D.a.n0&&!D.a.el}}J.X1e=9E5;Object(C.a)(J,"TellMeUtils",null,[])},1295:function(C,L,b){b.r(L);C=b(0);var f=b(41),c=b(244),u=b(70),r=b(1469),t=b(904);class k{constructor(Db,ab,dc,tb,yb,rc){this.groupType=Db;this.resultType=ab;
this.C8g=dc;this.fga=tb;this.pXf=yb;this.resultIndex=rc}}Object(C.a)(k,"ClickLoggingInfo",null,[]);const m=Db=>{const ab=[];for(;Db;)Array.add(ab,"{ContextId:"+Db.contextId+", IsGraphNodeContext:"+Db.Cj+"}"),Db=Db.Am;ab.reverse();return"{"+ab.join(", ")+"}"};class l{constructor(){this.gsa=this.sessionId=null}}Object(C.a)(l,"CorrelationRecord",null,[1040]);var x=b(1322);class w{constructor(Db,ab){this.Id=null;this.TimeStamp=0;this.Id=Db;this.TimeStamp=ab}}Object(C.a)(w,"MRUControl",null,[]);var G=
b(1449),D=b(1450),H=b(1294),M=b(2),J=b(1190);class F{constructor(Db,ab){this.Ffk=10;this.Fea=[];this.COa=[];this.OBh=this.NBh=!1;this.a8c=this.Z7c="";this.N0a=ab;this.Gb=Db;this.rCh=Db.lo}Htd(){!this.NBh&&this.rCh&&this.Gb&&D.a.HSi()&&(this.Z7c="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.Gb.application,this.Fea=this.Uti(),this.NBh=!0);return this.Fea}wLl(){!this.OBh&&this.rCh&&this.Gb&&D.a.HSi()&&(this.a8c="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.Gb.application,this.COa=this.Uti(!0),this.OBh=
!0);return this.COa}zgm(Db){return Db.startsWith("TellMeUpsell")||"OpenInClientUpsell"===Db||"TryOfficeUpsell"===Db}fng(Db){return this.i8l(Db)||this.zgm(Db)||H.a.gVi(Db)?!1:!0}e2a(Db){Db=Db.ControlId;this.fng(Db)&&(Db=this.GUg(Db),this.U6m(Db),this.jtm(),Array.insert(this.Fea,0,new w(Db,Date.now())),this.Z7c.length&&(Db=JSON.stringify(this.Fea),J.a.instance.setItem(this.Z7c,Db)))}iP(Db){this.itm();Array.insert(this.COa,0,new w(G.a[Db],Date.now()));this.a8c.length&&(Db=JSON.stringify(this.COa),J.a.instance.setItem(this.a8c,
Db))}Uti(Db=!1){if(!this.Fea.length){var ab=Db?J.a.instance.getItem(this.a8c):J.a.instance.getItem(this.Z7c);if(!ab||""===ab)return Db?this.COa:this.Fea;let dc=null;try{dc=JSON.parse(ab)}catch(tb){this.ZRk(Db),dc=null}if(!dc||!dc.length||10<dc.length)return Db?this.COa:this.Fea;ab=0;for(const tb of dc)if(Db||this.Gb.NHe(tb.Id)&&this.fng(tb.Id))if(Db?Array.insert(this.COa,ab++,tb):Array.insert(this.Fea,ab++,tb),ab===this.N0a)break}return Db?this.COa:this.Fea}bPf(Db){Db=this.GUg(Db);for(const ab of this.Fea)if(ab.Id===
Db)return!0;return!1}ZRk(Db=!1){J.a.instance.setItem(Db?this.a8c:this.Z7c,"")}C9l(Db){Db=this.GUg(Db.ControlId);return this.fng(Db)?this.bPf(Db):!1}U6m(Db){if(0<this.Fea.length){let ab=0;for(const dc of this.Fea){if(dc.Id===Db){Array.removeAt(this.Fea,ab);break}ab++}}}GUg(Db){return"Excel"===this.Gb.application&&Db.startsWith("m_excelWebRenderer_ewaCtl_")?Db.substr(26,Db.length):Db}jtm(){this.Fea.length===this.N0a&&Array.removeAt(this.Fea,this.Fea.length-1)}itm(){this.COa.length===this.Ffk&&Array.removeAt(this.COa,
this.COa.length-1)}i8l(Db){Db=Db.split("|");let ab="";if(6<=Db.length)ab=Db[0];else if(3<=Db.length){if("3"===Db[0])return!0;ab=Db[1]}return ab.startsWith("WA")}static createInstance(Db){let ab=3;M.AFrameworkApplication.K&&(ab=M.AFrameworkApplication.K.jb("TellMeMaxRecommendedResultsToReturn",3));return new F(Db,ab)}}Object(C.a)(F,"MruControlsManager",null,[1039]);class A{constructor(Db){this.KYb=Db}Iaa(Db,ab){let dc;return Db.aG&&(dc=this.KYb[Db.value])?dc.Iaa(Db,ab):(dc=this.Xui(Db.value))?dc.Iaa(dc.Lxm,
ab):null}BJl(Db,ab){if(Db=this.KYb[Db])for(const dc of ab)if(ab=H.a.getParameter(dc),ab.key===Db.HLg)return ab.value;return null}AAm(Db){(Db=this.Xui(Db))&&Db.xAm()}Xui(Db){const ab=Db.indexOf(H.a.Bdj);return 0<ab?this.KYb[Db.substring(0,ab)]:null}}Object(C.a)(A,"ParameterizedCommandManager",null,[1038]);var N=b(1334);class B{constructor(Db,ab){this.Qg=Db;this.lLb=ab}}Object(C.a)(B,"TellMeQuery",null,[]);var E=b(1451);class P{constructor(Db,ab){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=Db;
this.TimeElapsedSinceClick=ab}}Object(C.a)(P,"CommandClickedEvent",null,[]);var T=b(1285);class V{constructor(Db,ab){this.Dhk=Db;this.RFa=ab}resultsUpdated(Db){this.Dhk(T.c(Db.query)?"":Db.query.Qg,Db.lp,Db.attributes,this.RFa,Db.KKc)}}Object(C.a)(V,"ResultsUpdatedCallback",null,[1037]);var I=b(75);class R{constructor(Db,ab){this.menuModel=Db;this.nrj=ab}}Object(C.a)(R,"GeneratedMenuModel",null,[]);class ba{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=
null}}Object(C.a)(ba,"MenuModel",null,[]);class ha{constructor(Db,ab,dc){this.Gb=Db;this.KYb=ab;this.bqa=dc}bql(Db,ab,dc){const {TellMeActor:tb}=b(1295);let yb=0;const rc=new ba,fc=[];let uc="";rc.sections=[];let Uc=new I.a;const tc=!!this.Gb&&this.Gb.lpb;var Tb=!!this.Gb&&this.Gb.Qtb||M.AFrameworkApplication.la.eb.Qtb;for(const Jb of Db){Db=0;tc||(Uc=new I.a);const Zb=new I.a;let ec=Jb.displayName;for(const zc of Jb.results){if(0<=zc.value.indexOf(H.a.p6g)){if(zc.aG){var qb=this.KYb[zc.value];if(qb&&
zc.value.endsWith(H.a.p6g)){if("FindParameterized"!==zc.value&&!Tb){const Oc=[];Oc.push(appChrome.actions.setControlLabel(zc.value,qb.Wxe(zc)));Oc.push(appChrome.actions.setButtonCommandValueId(zc.value,qb.C6f(zc)));appChrome.api.dispatch(Oc)}qb=zc.value.replace(H.a.p6g,"");Uc.remove(qb)?Db--:Zb.add(qb);Uc.add(zc.value);Db++}}}else switch(zc.type){case 5:Zb.contains(zc.value)||(Uc.add(zc.value),Db++);break;case 7:Uc.add(zc.aG);Db++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 6:case 19:case 20:case 21:case 25:Uc.add(zc.value),
Db++}13===Jb.groupType&&(ec=H.a.AVa()?0<ab.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,ab):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,ab));21===Jb.groupType&&(ec=CommonUIStrings.l_LearningUILiveText)}yb+=Db;""!==ec&&0<Db&&(uc+=" , "+Db.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+ec+" , ");0<Uc.count&&!tc&&(Db=appChrome.api.menuSection(Uc.toArray(),Jb.displayName,null,N.a[Jb.groupType]),fc.push(Db))}Tb=
null;0<yb&&(Tb=0<ab.length?1!==yb?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,yb,ab):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,ab):1!==yb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,yb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,tc?(ab=appChrome.api.menuSection(Uc.toArray(),"",null,null),fc.push(ab)):Tb+=uc);dc&&(this.Gb.Fmb?tb.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Tb)):
appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Tb)));rc.sections=fc;return new R(rc,yb,[])}static get mZf(){return ha.Xuh||(ha.Xuh=new R(Object.assign(new ba,{sections:[]}),0,[]))}}ha.Xuh=null;Object(C.a)(ha,"TellMeMenuDefintionGenerator",null,[]);var na;(function(Db){Db[Db.TellMeControlActivated=0]="TellMeControlActivated";Db[Db.TellMeQueryExecuted=1]="TellMeQueryExecuted";Db[Db.TellMeResultsRendered=2]="TellMeResultsRendered";Db[Db.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(na||
(na={}));Object(C.b)("PerformanceMarker",na);var da;(function(Db){Db[Db.TellMeTimeToRender=0]="TellMeTimeToRender";Db[Db.TellMeSessionLength=1]="TellMeSessionLength";Db[Db.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(da||(da={}));Object(C.b)("PerformanceMeasure",da);class ia{mark(Db){window.performance.mark(na[Db])}measure(Db,ab,dc){const {TellMeActor:tb}=b(1295);try{window.performance.measure(da[Db],na[ab],na[dc])}catch(yb){tb.instance.Qe.onError("TellMePerformance:Measure","error measuring "+
da[Db])}}sxg(Db,ab,dc){const {TellMeActor:tb}=b(1295);tb.instance.Qe.Gxg(ab,dc,Db,this.LFl(Db))}vSk(){var Db=[0,1,2,3];for(const ab of Db)window.performance.clearMarks(na[ab])}clearMeasures(Db){for(const ab of Db)window.performance.clearMeasures(da[ab])}LFl(Db){let ab=0;(Db=this.wrl(Db))&&0<Db.length&&(ab=Db[Db.length-1].duration);return ab}wrl(Db){return window.performance.getEntriesByName(da[Db],"measure")}}Object(C.a)(ia,"TellMePerformance",null,[]);var ma=b(1374),qa=b(1373),ka=b(32);class va{constructor(Db){this.Mpk=
Db}Rgc(Db,ab,dc){const {TellMeActor:tb}=b(1295);tb.instance.Qe.$ga(ab,qa.a.EPc,Db.data.Ge.toString(),Math.round(window.performance.now()-dc),qa.a.EPc,!0,ma.a.o5a);Db=ka.b(Db.data.Rd);ab=-1;Db.Index&&(ab=Db.Index);tb.instance.Qe.mqm(ab,this.Mpk)}zgc(Db,ab,dc){const {TellMeActor:tb}=b(1295);tb.instance.Qe.$ga(ab,qa.a.EPc,Db.data.Ge.toString(),Math.round(window.performance.now()-dc),qa.a.EPc,!1,ma.a.o5a)}BLl(Db){if(Db&&""!==Db.trim()){const dc=window.performance.now(),tb=M.AFrameworkApplication.s1e;
var ab={};ab.Text=Db;ab.IsFileHash="false";ab=ka.c(ab);M.AFrameworkApplication.Gd.Ni(tb,2,ab,{"Content-Type":"application/json",Accept:"application/json"},!1,0,yb=>{this.Rgc(yb,Db.length,dc)},yb=>{this.zgc(yb,Db.length,dc)},null,null,!1,4E3,6E3)}}}Object(C.a)(va,"TellMeQueryIndexCallback",null,[]);var ja=b(1299);class Ma{constructor(Db,ab,dc){this.xml=Db;this.nrj=ab;this.rbl=dc}}Object(C.a)(Ma,"GeneratedMenuXml",null,[]);var Ha=b(1552),X=b(16);class W{constructor(Db,ab){this.A4d=Db||{};this.feb=ab}get F8a(){return 5}Iaa(Db,
ab=null){return this.feb.Iaa(Db,ab)||this.JIk(Db.value)}JIk(Db){return W.OIf(Db,this.A4d[Db]||null)}static OIf(Db,ab=null){Db=String.format('<ClonedControl Id="{0}" ',Db);for(let yb in ab){var dc=yb,tb=ab[yb];tb=tb?X.a.Vd(tb.toString()):"";Db+=String.format('{0}="{1}" ',dc,tb)}return Db+"/>"}}Object(C.a)(W,"CommandMenuItemFactory",null,[1034]);var fa=b(230);class ra{constructor(){this.h9j=CommonUIStrings.l_FindInDocumentText}get F8a(){return 8}Iaa(Db){var ab=Db.aG;Db=X.a.Vd(Db.value);const dc=X.a.Vd(ab);
ab=X.a.Vd(String.format(this.h9j,ab));return this.Dpl(Db,dc,ab)}Dpl(Db,ab,dc){return fa.a(Db,"1540292897",dc,H.a.Fkl,null,ab,dc,null,null)}}Object(C.a)(ra,"FindInDocumentMenuItemFactory",null,[1034]);var Aa=b(1553),Ba=b(1551),ta=b(1554);class xa{get F8a(){return 7}Iaa(Db){const ab=Object(u.a)(E.a,Db);return this.iql(X.a.Vd(Db.value),ab.id)}iql(Db,ab){return fa.a(ab,"1404166600",Db,null,null,Db,Db,null,null)}}Object(C.a)(xa,"TryQueryMenuItemFactory",null,[1034]);class za{constructor(Db){this.jea=[];
this.Gb=Db}yzl(Db){for(const ab of this.jea)if(ab.F8a===Db)return ab;return null}ha(Db){this.jea.push(Db)}t2m(Db){this.ha(new W(this.Gb.ZXk,Db));this.ha(new ta.a(this.Gb.Dzm));this.ha(new Ha.a(this.Gb.Bfn,this.Gb.Afn,this.Gb.XCn,this.Gb.d_l,this.Gb.Yrn));this.ha(new Ba.InsightsMenuItemFactory);this.ha(new ra);this.ha(new Aa.a);this.ha(new xa);this.Gb.rlj(this)}}Object(C.a)(za,"MenuItemFactoryRegistry",null,[]);var la=b(1300);class Sa{constructor(Db,ab){this.Gb=Db;this.AFh=new za(this.Gb);this.AFh.t2m(ab)}cql(Db,
ab){let dc=0;const tb=[],yb=[];for(const fc of Db){Db=H.a.t$g;var rc=[];for(const uc of fc.results){const Uc=this.AFh.yzl(uc.type).Iaa(uc,ab);Db=H.a.t$g;rc.push(Uc);if(13===uc.type||14===uc.type)Db="Menu32";17===uc.type&&(Db="MenuTellMeExtended");uc.groupType=fc.groupType;yb.push(Object(u.a)(la.a,uc))}dc=dc?dc:rc.length;rc=fa.e("TellMeDropdownControls",rc);Db=fa.j("TellMeDropdownMenuSection",rc,Db,fc.displayName);tb.push(Db)}ab=fa.k(tb,"LookupDropdownMenu");return new Ma(ab,dc,yb)}static get xse(){return Sa.Yuh||
(Sa.Yuh=new Ma(fa.k([],"LookupDropdownMenu"),0,[]))}}Sa.Yuh=null;Object(C.a)(Sa,"TellMeXmlGenerator",null,[]);class Pa{}Pa.pym="MRU";Pa.test="Test";Object(C.a)(Pa,"ActionType",null,[]);var fb=b(1359),db;(function(Db){Db[Db.Service=0]="Service";Db[Db.Local=1]="Local";Db[Db.MRU=2]="MRU";Db[Db.TestResult=3]="TestResult";Db[Db.Unknown=4]="Unknown"})(db||(db={}));Object(C.b)("SubResultType",db);var Qa=b(73);class wb{constructor(Db,ab,dc,tb,yb=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=
this.SubResultType=this.ResultType=null;this.CommandId=Db;this.IsEnabled=ab;this.ResultType=G.a[dc];this.SubResultType=db[tb];this.OptionalData=yb?Qa.a.toJSON(yb):null}}Object(C.a)(wb,"ResultInfo",null,[]);var ib=b(96),Ta=b(131),jb=b(232);class $a{constructor(Db,ab=null){this.L8d="TellMeWAC.";this.ajk=Db;this.Eqk=ab}SXa(Db,ab,dc){ab=ib.a.KU(ab);Db=ib.a.hCc(Db,this.ajk,this.Eqk,dc,ab);Ta.a.SXa(Db,this.L8d)}KKa(Db,ab,dc=0){ab=ib.a.KU(ab);Ta.a.KKa(Object.assign(new jb.a,{name:Db,dataFields:ab,durationMs:dc}),
this.L8d)}}Object(C.a)($a,"TellMeOtelLogger",null,[1066]);var ya=b(130);class wa{constructor(Db,ab,dc,tb,yb,rc,fc){this.Rja=this.Lea=this.qrh=null;this.i_a=Db;this.qrc=ab;this.m1a=dc;this.RVb=tb;this.cdb=yb;this.Qdk=rc;this.Rja=fc?fc:new $a(this.RVb?t.CuiHelper.o6g:t.CuiHelper.u1e)}get lo(){return this.RVb}get sKa(){return this.m1a}aYe(Db){this.qrh=Db;switch(Db){case ja.a.contextMenu:this.Lea=ja.a.contextMenu;break;default:this.Lea=ja.a.tellMe}}MGk(Db,ab){this.m1a.gsa||(this.m1a.gsa=ya.a.create().toString(),
this.R_i(Db,!0,ab))}jki(Db,ab=!0){this.m1a.gsa&&this.Vmm(Db,ab);this.RVb&&appChrome.api.updateTellMeCorrelationId("");this.m1a.gsa=null}R_i(Db,ab,dc){const {TellMeActor:tb}=b(1295),yb=this.ula(x.a.aob);yb[fb.a.culture]=this.qrc;yb[fb.a.appName]=this.i_a;yb[fb.a.context]=Db;yb[fb.a.XGe]=this.cdb;yb[fb.a.xgm]=this.Qdk;yb[fb.a.yfm]=dc;yb[fb.a.Dbm]=ab;yb[fb.a.contentType]=tb.instance.$pe;this.Rja.SXa(x.a.aob,yb,this.qrh);this.RVb&&appChrome.api.updateTellMeCorrelationId(this.m1a.gsa)}Vmm(Db,ab){const dc=
this.ula(x.a.qbc);dc[fb.a.kdl]=Db;dc[fb.a.Cbm]=ab;this.Rja.KKa(x.a.qbc,dc)}lqm(Db,ab,dc){let tb=0;!dc&&0<Db.length&&(tb=Db.trim().split(" ").length);const yb=this.ula(x.a.query);yb[fb.a.query]="!";yb[fb.a.pic]=ab;yb[fb.a.Chj]=Db.length;yb[fb.a.VVi]=dc;yb[fb.a.cTn]=tb;this.Rja.SXa(x.a.query,yb,this.Lea)}lom(Db,ab,dc,tb,yb,rc,fc,uc=null){const Uc=this.ula(x.a.latency);Uc[fb.a.culture]=this.qrc;Uc[fb.a.Chj]=Db;Uc[fb.a.wMj]=ab;Uc[fb.a.statusCode]=dc;Uc[fb.a.jin]=yb;Uc[fb.a.isSuccess]=rc;Uc[fb.a.pjm]=
fc;uc&&(Uc[fb.a.TEn]=uc);this.Rja.KKa(x.a.latency,Uc,tb)}Gxg(Db,ab,dc,tb){const yb=this.ula(x.a.performance);yb[fb.a.culture]=this.qrc;yb[fb.a.QGk]=na[Db];yb[fb.a.Vel]=na[ab];yb[fb.a.vQm]=da[dc];this.Rja.KKa(x.a.performance,yb,tb)}wqm(Db,ab){var {TellMeActor:dc}=b(1295);const {CommandResultsUtility:tb}=b(1342);if(Db.results.length){var yb=this.ula(x.a.Apj);yb[fb.a.fga]=ab.toString();yb[fb.a.groupType]=N.a[Db.groupType];16===Db.groupType&&(yb[fb.a.ifm]=dc.instance.z0d);ab=[];dc=[];var rc=[];for(const fc of Db.results)yb[fb.a.resultType]||
(yb[fb.a.resultType]=G.a[fc.type]),Db={},25===fc.type&&(Db.AssetId=fc.pN),dc.push(tb.UBd(fc.value)),ab.push(fc.value),rc.push(new wb(fc.value,tb.UBd(fc.value),fc.type,fc.xGj,Db));0<ab.length&&(yb[fb.a.Ubn]="{"+ab.join(", ")+"}",yb[fb.a.Eel]="{"+dc.join(", ")+"}",yb[fb.a.Pbn]=ka.c(rc));this.Rja.SXa(x.a.Apj,yb,this.Lea)}}Fql(Db,ab){if(4===Db)return Pa.pym;switch(ab){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return G.a[ab]}Bmm(Db,
ab,dc,tb,yb){const rc=this.ula(x.a.click);rc[fb.a.wMj]=Db;rc[fb.a.GOm]=ab;rc[fb.a.commandId]=dc;rc[fb.a.Gqa]=tb;rc[fb.a.actionType]=this.Fql(yb.groupType,yb.resultType);rc[fb.a.resultType]=G.a[yb.resultType];rc[fb.a.C8g]=db[yb.C8g];rc[fb.a.groupType]=N.a[yb.groupType];rc[fb.a.fga]=yb.fga.toString();rc[fb.a.pXf]=yb.pXf.toString();rc[fb.a.resultIndex]=yb.resultIndex.toString();this.Rja.SXa(x.a.click,rc,this.Lea)}Emm(Db,ab){this.m1a.gsa||(this.m1a.gsa=ya.a.create().toString(),this.R_i("",!1,ab));ab=
this.ula(x.a.dai);ab[fb.a.pic]=Db;this.Rja.KKa(x.a.dai,ab)}l0i(Db,ab,dc){if(Db){if(dc)for(let tb in dc)Db[tb]=dc[tb];this.Rja.KKa(x.a.events,Db,ab)}}bna(Db,ab,dc=null){const tb=this.ula(x.a.events);tb[fb.a.event]=Db;this.l0i(tb,Math.round(ab),dc)}UGd(Db,ab,dc=null){const tb=this.ula(x.a.events);tb[fb.a.event]=x.a.error;tb[fb.a.module]=Db;tb[fb.a.errorMessage]=ab;tb[fb.a.message]=ab;this.l0i(tb,Math.round(window.performance.now()),dc)}Amm(Db){const ab=this.ula(x.a.t8h);ab[fb.a.value]=Db;ab[fb.a.pRg]=
this.RVb;this.Rja.SXa(x.a.t8h,ab,this.Lea)}dmm(Db){const ab=this.ula(x.a.cTh);ab[fb.a.value]=Db;ab[fb.a.pRg]=this.RVb;this.Rja.SXa(x.a.cTh,ab,this.Lea)}jqm(Db){const ab=this.ula(x.a.Ygj);ab[fb.a.value]=Db;ab[fb.a.pRg]=this.RVb;this.Rja.SXa(x.a.Ygj,ab,this.Lea)}kmm(Db){const ab=this.ula(x.a.Bvj);ab[fb.a.value]=Db;this.Rja.SXa(x.a.Bvj,ab,this.Lea)}nqm(Db,ab){const dc=this.ula(x.a.zhj);dc[fb.a.EPc]=Db;ab&&(dc[fb.a.gsa]=ab);this.Rja.KKa(x.a.zhj,dc)}ula(Db){return{["SessionID"]:this.m1a.sessionId,["CorrelationID"]:this.m1a.gsa,
["Time"]:(new Date).getTime(),["Event"]:Db,["Scenario"]:this.Lea}}}Object(C.a)(wa,"UsageLogger",null,[1036]);var Fa=b(53),bb=b(1511),Eb=b(1053),hb=b(81),nb=b(59),Pb=b(212),bc=b(353),gb=b(15),Lb=b(551),Ic=b(66),vb=b(13);b.d(L,"TellMeActor",function(){return xb});class xb{constructor(){this.feb=this.u$=this.ib=this.va=this.z1=this.Pw=this.fb=this.ga=this.Qe=this.GG=this.unf=this.ASh=this.SFa=this.Gb=null;this.buc=!1;this.Gaf=[];this.mrh=[];this.iGh=[];this.jGh=[];this.qCh=!1;this.Zqc=this.bqa=null;
this.h5c=this.cdb=!1;this.eae=!0;this.y6=this.t3c=this.eyh=this.Inf=this.XFh=null;this.YH=[];this.Nxb=this.Irc=this.ZMa=null;this.vtc=!1;this.Bnf=0;this.Hqc=null;this.RFa=-1;this.CFh=0;this.t5c=!1;this.pyb=null;this.yRh=!1;this.ty=null}get $pe(){return this.z1?this.z1.contentType:xb.unknown}get actions(){return this.YH}set actions(Db){this.YH=Db}dAe(){return this.Qe?this.Qe.sKa.gsa:null}WU(){return this.Gb}get zxm(){return this.eae}get YRn(){return this.XFh}performance(){return this.GG}get z0d(){return this.yRh}set z0d(Db){this.yRh=
Db}jF(Db){const ab=window.performance.now();this.bqa&&!T.c(Db)&&(this.bqa(Db),this.Qe.pD(x.a.jF,window.performance.now()-ab))}initialize(Db,ab=null,dc=null,tb=null,yb=null,rc=null,fc=null,uc=null,Uc=null,tc=null,Tb=null){const {InteractionLogger:qb}=b(1723),{GroupsPlacementInfo:Jb}=b(1719),{AggregatorResultsProvider:Zb}=b(1574);this.Gb=Db;this.cdb=!!M.AFrameworkApplication.la&&M.AFrameworkApplication.la.eb.Xcc;this.Qe=tb;if(!tb){tb=new l;tb.sessionId=M.AFrameworkApplication.userSessionId;const ec=
Lb.a.yf(M.AFrameworkApplication.lcid)||Lb.a.fJc;this.Qe=new qb(new wa(this.Gb.application,ec.name,tb,this.Gb.lo,this.cdb,Db.M9a,null),this.Gb.gYk,this.Gb)}this.feb=new A(this.Gb.parameterData);this.ASh=dc||new Sa(this.Gb,this.feb);this.bqa=fc;this.unf=this.unf||new ha(this.Gb,this.Gb.parameterData,fc);this.ib=Fa.FocusManager.instance();this.u$=F.createInstance(this.Gb);this.eyh=new Jb(Db);this.ga=yb||M.AFrameworkApplication.pa;this.fb=rc||M.AFrameworkApplication.tb;this.Pw=Uc;this.SFa=ab;this.ty=
Tb;this.GG=new ia;Uc?Uc.execute(ec=>{ec.isFeatureEnabled(xb.MCn,!0).then(zc=>{const {AggregatorResultsProvider:Oc}=b(1574);this.t5c=zc;this.SFa=this.SFa||Oc.createInstance(this.u$,this.Gb,this.feb,this.t5c);return null})}):(this.t5c=!0,this.SFa=this.SFa||Zb.createInstance(this.u$,this.Gb,this.feb,this.t5c));this.va=uc;this.ZMa=Sa.xse;this.XFh=new Promise(ec=>{this.Inf=ec});tc&&tc.execute(ec=>{this.z1=ec});this.Gb.lo&&H.a.nUi()&&(Db=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.Gb.application),
appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(Db,Db)))}lb(){this.$wk()}t3m(Db){this.t3c=Db}$wk(){this.ga.Aa(vb.a.tellMe,Ic.a.frame,Object(f.a)(this,this.tellMe,"tellMe"),96);this.ga.Aa(vb.a.k1e,Ic.a.frame,Object(f.a)(this,this.e3h,"cacheAsyncMenuRefreshFunction"),96);this.ga.Aa(vb.a.n1e,Ic.a.frame,Object(f.a)(this,this.C0i,"logItemExecuted"),96);this.ga.Aa(vb.a.q1e,Ic.a.frame,Object(f.a)(this,this.a0i,"logControlDeactivation"),96);this.ga.Aa(vb.a.p1e,Ic.a.frame,Object(f.a)(this,
this.x0i,"logInputFocus"),96);this.ga.Aa(vb.a.m1e,Ic.a.frame,Object(f.a)(this,this.aob,"interactionBegin"),96);this.ga.Aa(vb.a.t1e,Ic.a.frame,Object(f.a)(this,this.aob,"interactionBegin"),96);this.ga.Aa(vb.a.o1e,Ic.a.frame,Object(f.a)(this,this.w0i,"logInputBlur"),96);this.ga.Aa(vb.a.r1e,Ic.a.frame,Object(f.a)(this,this.$_i,"logControlActivated"),96);this.ga.Aa(vb.a.hUc,Ic.a.frame,Object(f.a)(this,this.bqi,"focusSearchBox"),96);this.ga.Aa(vb.a.j1e,Ic.a.frame,Object(f.a)(this,this.b$h,"constructLiveNotificationForMenu"),
96);this.ga.Aa(vb.a.w1e,Ic.a.frame,Object(f.a)(this,this.Qkg,"insertTryQuery"),96);this.ga.Aa(vb.a.LIe,Ic.a.frame,Object(f.a)(this,this.Qkg,"insertTryQuery"),96);this.ga.Aa(vb.a.fue,Ic.a.frame,Object(f.a)(this,this.r7a,"openOrInsertUrl"),96);this.ga.Aa(vb.a.gue,Ic.a.frame,Object(f.a)(this,this.r7a,"openOrInsertUrl"),96);this.ga.Aa(vb.a.hue,Ic.a.frame,Object(f.a)(this,this.r7a,"openOrInsertUrl"),96);this.ga.Aa(vb.a.iue,Ic.a.frame,Object(f.a)(this,this.r7a,"openOrInsertUrl"),96);this.ga.Aa(vb.a.jue,
Ic.a.frame,Object(f.a)(this,this.r7a,"openOrInsertUrl"),96);this.ga.Aa(vb.a.mPe,Ic.a.frame,Object(f.a)(this,this.r7a,"openOrInsertUrl"),96);this.ga.Aa(vb.a.nPe,Ic.a.frame,Object(f.a)(this,this.r7a,"openOrInsertUrl"),96);this.ga.Aa(vb.a.oPe,Ic.a.frame,Object(f.a)(this,this.r7a,"openOrInsertUrl"),96);this.ga.Aa(vb.a.MQe,Ic.a.frame,Object(f.a)(this,this.Unb,"insertMention"),96);this.ga.Aa(vb.a.NQe,Ic.a.frame,Object(f.a)(this,this.Unb,"insertMention"),96);this.ga.Aa(vb.a.OQe,Ic.a.frame,Object(f.a)(this,
this.Unb,"insertMention"),96);this.ga.Aa(vb.a.l1e,Ic.a.frame,Object(f.a)(this,this.Kbj,"openFeedback"),96);this.ga.Aa(vb.a.z1e,Ic.a.frame,Object(f.a)(this,this.r7a,"openOrInsertUrl"),96);this.ga.Aa(vb.a.Vie,Ic.a.frame,Object(f.a)(this,this.yIe,"launchAddin"),96);this.ga.Aa(vb.a.Wie,Ic.a.frame,Object(f.a)(this,this.yIe,"launchAddin"),96);this.ga.Aa(vb.a.Xie,Ic.a.frame,Object(f.a)(this,this.yIe,"launchAddin"),96);this.ga.Aa(vb.a.XNb,Ic.a.frame,Object(f.a)(this,this.XNb,"showTellMeCoachmark"),96)}T1m(Db){this.eae=
!1;const ab=window.performance.now();Db.C6a.isCompleted?(this.eae=!0,this.Inf(!0)):Db.QJ(()=>{this.eae=!0;this.Inf(!0);this.Qe.pD(x.a.o9k,window.performance.now()-ab)});this.x2m(Db)}x2m(Db){bc.a.kQc(Object(f.a)(this,this.lXf,"dispatcher"));bc.a.v7b([new Pb.a(vb.a.tellMe,Ic.a.frame,96),new Pb.a(vb.a.k1e,Ic.a.frame,96),new Pb.a(vb.a.n1e,Ic.a.frame,96),new Pb.a(vb.a.q1e,Ic.a.frame,96),new Pb.a(vb.a.p1e,Ic.a.frame,96),new Pb.a(vb.a.m1e,Ic.a.frame,96),new Pb.a(vb.a.t1e,Ic.a.frame,96),new Pb.a(vb.a.o1e,
Ic.a.frame,96),new Pb.a(vb.a.r1e,Ic.a.frame,96),new Pb.a(vb.a.hUc,Ic.a.frame,96),new Pb.a(vb.a.j1e,Ic.a.frame,96),new Pb.a(vb.a.w1e,Ic.a.frame,96),new Pb.a(vb.a.LIe,Ic.a.frame,96),new Pb.a(vb.a.fue,Ic.a.frame,96),new Pb.a(vb.a.gue,Ic.a.frame,96),new Pb.a(vb.a.hue,Ic.a.frame,96),new Pb.a(vb.a.iue,Ic.a.frame,96),new Pb.a(vb.a.jue,Ic.a.frame,96),new Pb.a(vb.a.mPe,Ic.a.frame,96),new Pb.a(vb.a.nPe,Ic.a.frame,96),new Pb.a(vb.a.oPe,Ic.a.frame,96),new Pb.a(vb.a.MQe,Ic.a.frame,96),new Pb.a(vb.a.NQe,Ic.a.frame,
96),new Pb.a(vb.a.OQe,Ic.a.frame,96),new Pb.a(vb.a.l1e,Ic.a.frame,96),new Pb.a(vb.a.z1e,Ic.a.frame,96),new Pb.a(vb.a.Vie,Ic.a.frame,96),new Pb.a(vb.a.Wie,Ic.a.frame,96),new Pb.a(vb.a.Xie,Ic.a.frame,96),new Pb.a(vb.a.XNb,Ic.a.frame,96)],Db)}lXf(Db,ab,dc,tb,yb){if(ab.contextId===Ic.a.frame)switch(Db){case vb.a.tellMe:return this.tellMe(Db,ab,dc,tb,yb);case vb.a.k1e:return this.e3h(Db,ab,dc,tb,yb);case vb.a.n1e:return this.C0i(Db,ab,dc,tb,yb);case vb.a.q1e:return this.a0i(Db,ab,dc,tb,yb);case vb.a.p1e:return this.x0i(Db,
ab,dc,tb,yb);case vb.a.m1e:return this.aob(Db,ab,dc,tb,yb);case vb.a.t1e:return this.Fbn(dc);case vb.a.o1e:return this.w0i(Db,ab,dc,tb,yb);case vb.a.r1e:return this.$_i(Db,ab,dc,tb,yb);case vb.a.hUc:return this.bqi(Db,ab,dc,tb,yb);case vb.a.j1e:return this.b$h(Db,ab,dc,tb,yb);case vb.a.w1e:case vb.a.LIe:return this.Qkg(Db,ab,dc,tb,yb);case vb.a.fue:case vb.a.gue:case vb.a.hue:case vb.a.iue:case vb.a.jue:case vb.a.mPe:case vb.a.nPe:case vb.a.oPe:case vb.a.z1e:return this.r7a(Db,ab,dc,tb,yb);case vb.a.MQe:case vb.a.NQe:case vb.a.OQe:return this.Unb(Db,
ab,dc,tb,yb);case vb.a.l1e:return this.Kbj(Db,ab,dc,tb,yb);case vb.a.Vie:case vb.a.Wie:case vb.a.Xie:return this.yIe(Db,ab,dc,tb,yb);case vb.a.XNb:return this.XNb(Db,ab,dc,tb,yb)}return 2}bqi(Db,ab,dc){if(1===dc)return 32;this.Yyj();Db=!1;(this.Gb.M9a||this.cdb)&&(ab=document.getElementById("SearchButton"))&&ab.click();if(!this.Gb.M9a&&this.cdb)for(ab=document.getElementsByClassName("ms-suiteux-search-box"),dc=0;dc<ab.length;dc++){const tb=ab[dc].querySelector("input[type=search]");tb&&(Db=Fa.FocusManager.iJ(tb))}else Db=
Fa.FocusManager.iJ($get(this.Gb.lo?t.CuiHelper.o6g:t.CuiHelper.u1e));this.h5c=!0;return Db?32:8}Qkg(Db,ab,dc,tb,yb){if(1===dc)return 32;if(T.c(yb))return this.Qe.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.Yyj();Db=yb.CommandValueId;ab=this.Gb.lo?t.CuiHelper.o6g:t.CuiHelper.u1e;this.Gb.lo&&!T.c(yb[Eb.a.c9a])&&(yb[Eb.a.c9a]=!1);if(Db){if(this.Gb.lo)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Db)),this.pyb=[19],32;if(yb=$get(ab))yb.value=Db}return Fa.FocusManager.iJ($get(ab))?
32:8}Yyj(){this.ib.bG(this.Gb.M9a||this.cdb?this.Gb.h5a:this.Gb.AKa,!1)}xql(Db,ab){switch(Db){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,ab);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,ab);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,ab);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,ab)}return ab}b$h(Db,ab,dc,tb,yb){if(1===dc)return 32;
if(T.c(yb))return this.Qe.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;Db=this.ZMa?this.ZMa.nrj:0;yb.Value=1!==Db?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Db):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.ZMa)for(const rc of this.ZMa.rbl)yb=Object(c.a)(E.a,rc)?rc.id:X.a.replaceAll(rc.value,'"',""),(yb=$get(yb+"-"+H.a.t$g))&&nb.a.Qq(yb,nb.a.Vka,X.a.Vd(this.xql(rc.groupType,yb.innerText)));return 32}e3h(Db,
ab,dc,tb,yb){if(1===dc)return 32;if(T.c(yb))return this.Qe.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.Hqc=new hb.a(2,1,0,()=>{yb[bb.a.Callback]()},97);this.ZMa&&this.fb.rb(this.Hqc);return 32}C0i(Db,ab,dc,tb,yb){if(1===dc)return 32;if(T.c(yb))return this.Qe.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;yb.CloseAllMenus&&(Db=void 0===yb.ParentControlId||null===yb.ParentControlId?"<NA>":yb.ParentControlId,ab=this.Zqc?this.Zqc[yb.ControlId]:
null,!ab&&this.Zqc&&"<NA>"!==Db&&(ab=this.Zqc[Db]),ab||(ab=this.buc&&this.u$.C9l(yb),ab=this.q$k(ab,yb.ControlId),ab=new k(ab,26,4,-1,-1,-1),this.Qe.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+yb.ControlId+" determined group:"+N.a[ab.groupType])),this.Qe.CDm(yb.ControlId,Db,yb.CommandId,yb.CloseAllMenus,ab),this.feb.AAm(yb.ControlId),yb.Location!==ja.a.contextMenu&&(this.u$.e2a(yb),this.u$.iP(ab.resultType),this.Gb.YYe&&this.SFa.tvk(yb.CommandId)));return 32}a0i(Db,ab,dc,tb,
yb){if(1===dc)return 32;D.a.ygm()&&(new va(this.dAe())).BLl(this.Irc);Db=this.Irc;ab=this.RFa;dc=this.Qe.b5d;if(T.c(yb))return this.Qe.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;yb=yb.UILocation;Db&&0<Db.length&&this.t5c&&H.a.a4g(this.Gb)&&this.Gb.zHe&&19!==yb&&ab>dc&&!this.Gb.K8&&(this.Qe.Hxg(Db),this.Qe.h0g(ab));this.Qe.Nan();this.Gb.d4e&&19!==yb&&(this.GG.mark(3),this.GG.measure(1,0,3),this.GG.measure(2,2,3),this.GG.sxg(0,1,2),this.GG.sxg(2,2,3),this.GG.sxg(1,0,3),
this.GG.vSk(),this.GG.clearMeasures([0,2,1]));this.Qe.dEm(window.performance.now()-this.Bnf);this.Gb.lo&&(this.Nxb=null,this.Qe.QJa());this.h5c=this.vtc=!1;this.Irc="";return 32}x0i(Db,ab,dc){if(1===dc)return 32;this.Qe.cKb(m(ab),this.h5c);return 32}w0i(Db,ab,dc){if(1===dc)return 32;this.Qe.QJa();this.vtc=!1;return 32}$_i(Db,ab,dc,tb,yb){if(1===dc)return 32;this.y6=null;yb&&(this.y6=yb);this.Gb.d4e&&(T.c(this.y6)||this.y6.Location!==ja.a.contextMenu)&&this.GG.mark(0);this.Qe.aYe(T.c(this.y6)||T.c(this.y6.Location)?
ja.a.unknown:this.y6.Location);this.Qe.cEm(this.CFh,this.h5c);this.vtc||this.Qqb();return 32}Ubi(Db,ab){const dc=[],tb=Date.now();for(let yb of Db)Db=(tb-yb.timeStamp)/1E3,Db=H.a.fbh(Db),Array.add(dc,new P(ab?yb.commandId:yb.controlId,Db));return dc}zci(Db=!1){var ab=Db?this.u$.wLl():this.u$.Htd();Db=[];const dc=Date.now();for(const tb of ab)ab=(dc-tb.TimeStamp)/1E3,ab=H.a.fbh(ab),Array.add(Db,new P(tb.Id,ab));return Db}Qqb(){if(!this.vtc){this.buc=this.vtc=!0;""!==this.Gb.lZg&&M.AFrameworkApplication.Zi(this.Gb.lZg);
if(!this.qCh){this.qCh=!0;const Db={};Db.IsMLREnabled=this.Gb.Fcm;Db.IsReactRibbonEnabled=this.Gb.lo;Db.IsSharedHeaderEnabled=!!M.AFrameworkApplication.la&&M.AFrameworkApplication.la.eb.eM;Db.IsSearchUxEnabled=this.cdb;Db.IsTellMeInHeaderEnabled=this.Gb.M9a;Db.IsGoLocalEnv=H.a.BRi();Db.IsSovereignEnvironment=H.a.$cc();Db.IsTellMeServiceResultsEnabled=H.a.a4g(this.Gb);Db.IsSubstrateProviderEnabled=H.a.$3g(this.Gb);Db.ShouldFetchTokens=!!M.AFrameworkApplication.la&&M.AFrameworkApplication.la.eb.GNb;
Db.IsSerpletEnabled=H.a.AVa();Db.FirstOnClickTimeInMS=Math.round(window.performance.now());Db.IsHeaderHidden=M.AFrameworkApplication.hideHeader||M.AFrameworkApplication.nH;Db.IsSearchInHeaderHidden=M.AFrameworkApplication.k5a;void 0!==window.performance.timing&&null!==window.performance.timing&&(Db.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));Db.IsFindWithMatchesEnabled=this.Gb.nue;Db.HelpShowsTopSearchResult=this.Gb.cVd;Db.HelpShowsNumberOfMatches=this.Gb.RSc;
M.AFrameworkApplication.K&&(Db.UiHost=M.AFrameworkApplication.K.Ga("UiHostIntegrationType"));this.Qe.Rqm(JSON.stringify(Db))}this.Gaf=this.Ubi(r.a.instance.vtd(),!1);this.mrh=this.Ubi(r.a.instance.ZEc(),!0);this.iGh=this.zci();this.jGh=this.zci(!0);this.Qe.Qqb()}}aob(Db,ab,dc,tb,yb){if(1===dc)return 32;if(T.c(yb))return this.Qe.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(gb.a.Ema)return 32;this.Bnf=window.performance.now();this.Qqb();Db=new V(Object(f.a)(this,this.tV,"onRequestCompleted"),
0);this.RFa++;this.Qe.beginQuery("",this.RFa,this.buc);this.ZMa=Sa.xse;this.Nxb=ha.mZf;if(this.SFa)xb.instance.actions=[],this.SFa.HS(new B("",this.RFa),Db,this.Gb.lo);else this.Qe.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.Hqc&&this.fb.rb(this.Hqc);return 32}Fbn(Db){if(1===Db)return 32;this.ib.QI(this.Gb.M9a||this.cdb?this.Gb.h5a:this.Gb.AKa,!1);return 32}tellMe(Db,ab,dc,tb,yb){if(1===dc)return 32;if(T.c(yb))return this.Qe.onError("TellMeActor:TellMe","actiondata comes null"),
16;this.y6=yb;this.Qe.aYe(T.c(this.y6.Location)?ja.a.unknown:this.y6.Location);Db=this.y6.Value;this.Gb.lo||Db&&""!==Db.trim()?(!this.Nxb&&this.Gb.lo&&(this.Qe.cKb(m(ab),this.h5c),this.Qqb()),this.vhl(Db,this.y6.Location),this.y6.PopulationXML=this.ZMa.xml):this.buc?this.y6.PopulationXML=this.ZMa.xml:(this.y6.PopulationXML=Sa.xse.xml,this.Nxb=ha.mZf,this.Irc="");return 32}vhl(Db,ab){this.Bnf=window.performance.now();this.Gb.d4e&&ab!==ja.a.contextMenu&&this.GG.mark(1);this.Gb.lo&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Db));
Db&&0<Db.trim().length&&(this.buc=!1);this.Gb.wgl();ab=T.c(ab)?ja.a.tellMe:ab;if(Db!==this.Irc||this.Gb.lo){this.RFa++;this.Qe.beginQuery(Db,this.RFa,this.buc);const dc=new B(Db,this.RFa),tb=new V(Object(f.a)(this,this.tV,"onRequestCompleted"),this.RFa);this.ZMa=Sa.xse;this.Nxb=ha.mZf;if(this.SFa)xb.instance.actions=[],this.SFa.HS(dc,tb,this.Gb.lo,ab,this.pyb),this.pyb=null;else this.Qe.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.CFh=this.RFa;this.Irc=Db}}cNn(Db){if(this.Gb.lo){var ab=
appChrome.selectors.getActiveControlStates();if(ab=Object(u.a)(Object,ab[Db.value])){Db.label=ab.label;let dc=null;"description"in ab&&(dc=ab.description);dc&&Object.getType(dc)===String?Db.description=dc:"secondaryText"in ab?Db.description=ab.secondaryText:"fullDescriptionLabel"in ab&&(Db.description=ab.fullDescriptionLabel)}}}pRm(Db){this.Zqc={};let ab=0,dc=0;for(const tb of Db){Db=0;for(const yb of tb.results)this.Zqc[yb.value]=new k(yb.groupType,yb.type,yb.xGj,ab,Db,dc),Db++,dc++,yb.label||5!==
yb.type||this.cNn(yb);0<Db&&ab++}}$gc(Db,ab,dc,tb,yb){if(1===dc)return 32;if(T.c(yb))return this.Qe.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(Db=yb.CommandValueId)&&window.open(Db,"_blank");return 32}Unb(Db,ab,dc,tb,yb){if(1===dc)return 32;if(T.c(yb))return this.Qe.onError("TellMeActor:InsertMention","actiondata comes null"),16;Db=yb.UILocation;let rc;yb=yb.CommandValueId;try{rc=ka.a(yb)}catch(fc){return this.Qe.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),
16}return T.c(rc)?(this.Qe.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):T.c(this.t3c)?(this.Qe.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==Db?(this.Qe.onError("TellMeActor:InsertMention","location "+Db+" is unexpected"),16):this.t3c.Unb(rc.displayName,rc.email,rc.userId)?32:(this.Qe.onError("TellMeActor:InsertMention","mention is not inserted"),16)}r7a(Db,ab,dc,tb,yb){return 1===dc?32:T.c(yb)?(this.Qe.onError("TellMeActor:OpenOrInsertUrl",
"actiondata comes null"),16):19===yb.UILocation?this.B6l(dc,yb):this.$gc(Db,ab,dc,tb,yb)}Kbj(Db,ab,dc,tb,yb){if(1===dc)return 32;if(T.c(yb))return this.Qe.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.ty&&this.ty.execute(rc=>{rc.wmc("TellMeSurvey",null)});return 32}B6l(Db,ab){if(1===Db)return 32;if(T.c(ab))return this.Qe.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(T.c(this.t3c))return this.Qe.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),
16;Db=ab.CommandValueId;return T.c(Db)?(this.Qe.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.t3c.insertHtmlText(Db)?32:(this.Qe.onError("TellMeActor:InsertUrl","url is not inserted"),16)}tV(Db,ab,dc,tb,yb){dc=window.performance.now();this.pRm(ab);this.Qe.Nln(ab);this.Gb.lo?(this.Nxb=this.unf.bql(ab,Db,yb),this.Gb.Fmb?(this.YH.push(appChrome.actions.updateTellMeSearchResults(this.Nxb.menuModel,Db,yb)),appChrome.api.dispatch(this.YH)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.Nxb.menuModel,
Db,yb)),this.Gb.d4e&&this.vtc&&(T.c(this.y6)||this.y6.Location!==ja.a.contextMenu)&&(this.GG.mark(2),this.GG.measure(0,1,2))):this.ZMa=this.ASh.cql(ab,this.Qe.sKa);this.Hqc&&this.fb.rb(this.Hqc);yb={};yb.GroupsCount=ab.length;yb.QueryID=tb;yb.QueryLength=Db.length;this.Qe.pD(x.a.N3k,window.performance.now()-dc,yb)}q$k(Db,ab){return ab.startsWith(this.Gb.lo?H.a.Tbh:H.a.L2e)?5:Db?4:"bSearchHelp"===ab||ab.startsWith("GetHelpFromTellMe")?8:"bInsights"===ab||ab.startsWith("SmartLookupFromTellMe")?13:ab===
this.Gb.J1f?2:0}iP(Db,ab){this.SFa&&this.SFa.iP(Db,ab)}yIe(Db,ab,dc,tb,yb){({AddinResultsProvider:Db}=b(1465));yb=yb.CommandValueId;if(T.b(yb))return this.Qe.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!Db.L2b[yb])return this.Qe.onError("TellMeActor:LaunchAddin","Add-in with assetId "+yb+" doesn't not exist in entitlements"),16;Db=b(1465).AddinResultsProvider.L2b[yb];ab={};ab.solutionId=Db.id;ab.assetId=Db.assetId;ab.appVersion=Db.appVersion;ab.storeId=Db.storeId;ab.assetStoreId=
Db.assetStoreId;ab.displayName=Db.displayName;ab.assetStoreId=Db.assetStoreId;ab.targetType=Db.targetType;ab.height=Db.height;ab.width=Db.width;ab.storeType=Db.storeType;Db=this.ga.ob(vb.a.ZDe,2,ab);if(32!==Db)this.Qe.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+Db+". AssetId: "+yb);return Db}XNb(){if(!T.c(this.ty))for(let Db of r.a.instance.ZEc()){if("ShowContextMenuWithFloatie"===Db.commandId)return this.ty.execute(ab=>{ab.logActivity("TellMe1TabSwitchCoachMarkActivity",
null)}),32;if(Db.commandId&&-1===Db.commandId.indexOf("Tab"))break}return 8}static get instance(){return xb.na||(xb.na=new xb)}}xb.na=null;xb.MCn="mso_tellMeService";xb.unknown="Unknown";Object(C.a)(xb,"TellMeActor",null,[])},1296:function(C,L,b){b.d(L,"a",function(){return c});C=b(0);var f=b(1312);class c{constructor(u,r){this.lzb=!1;const {Annotations:t}=b(1289);if(!u)throw Error.argumentNull("annotations");if(!u.otg(r))throw Error.argument("memberTypeID","Invalid type ID");if(t.yM(r))throw Error.argument("memberTypeID",
"Lists of lists are not permitted");this.Jy=u;this.Pfk=r;this.jl=[]}get Qyc(){return this.Jy}get isReadOnly(){return this.lzb}get qca(){return this.Pfk}get items(){return this.jl}Noa(){const {Annotations:u}=b(1289);let r="[";for(let t=0,k=this.items.length;t<k;++t){0<t&&(r+=", ");const m=this.Jy.Noa(this.qca,this.items[t]);this.qca===u.hia?(r+='"',r+=f.a.P_f(m),r+='"'):r+=m}return r+"]"}isEqual(u){const {Annotations:r}=b(1289);if(this===u)return!0;if(!u||u.Qyc!==this.Jy||u.qca!==this.qca||u.items.length!==
this.items.length)return!1;for(let t=0;t<this.items.length;++t)if(!r.CPb(this.qca,this.items[t],u.items[t]))return!1;return!0}clone(){const u=new c(this.Jy,this.qca);Array.addRange(u.items,this.items);return u}j_(){return this.isReadOnly?this.clone():this}Fwg(){const {Annotations:u}=b(1289);if(!this.isReadOnly){this.lzb=!0;for(const r of this.items)u.yec(r)}}toString(){return this.Noa()}}Object(C.a)(c,"ListValue",null,[1156,1158])},1299:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{}
f.tellMe="TellMe";f.contextMenu="ContextMenu";f.unknown="Unknown";Object(C.a)(f,"TellMeScenario",null,[])},1300:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{constructor(c,u,r=null,t=null,k=4,m=-99999,l=0){this.pN="";this.bje=-1;this.value=c;this.type=u;this.xGj=k;this.label=this.aG=r;this.groupType=25;this.description=t;this.score=m;this.count=l}}Object(C.a)(f,"ResultBinding",null,[])},1305:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{constructor(c){this.attributes=
null;this.query=c;this.lp=[]}DA(c){this.lp.push(c)}yUg(c){const u=[];for(const r of this.lp)r.groupType!==c&&u.push(r);this.lp.length!==u.length&&(this.lp=u)}get KKc(){return!1}}Object(C.a)(f,"SimpleResultsUpdatedEventArgs",null,[1016])},1306:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{constructor(c=25,u=""){this.ow=[];this.groupType=c;this.displayName=u}get results(){return this.ow}DB(c){c.groupType=this.groupType;Array.add(this.results,c)}zUg(c=1){if(this.results.length>=c)for(let u=
0;u<c;u++)Array.removeAt(this.results,this.results.length-1)}}Object(C.a)(f,"SimpleResultGroup",null,[1017])},1312:function(C,L,b){C=b(0);class f{constructor(u,r){this.kCb=u;this.value=r}}Object(C.a)(f,"AttrValuePair",null,[]);b.d(L,"a",function(){return c});class c{constructor(u){this.lzb=!1;if(!u)throw Error.argumentNull("annotations");this.Jy=u;this.I4=[]}get Qyc(){return this.Jy}get isReadOnly(){return this.lzb}get Sfg(){return 0<this.I4.length}ns(u){if(!this.Jy.lLc(u))throw Error.argument("attributeID",
"Invalid attribute ID");for(const r of this.I4)if(u===r.kCb)return u=r.value,{returnValue:!0,value:u};return{returnValue:!1,value:null}}kB(u,r){var {Annotations:t}=b(1289);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Jy.lLc(u))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Jy.oKc(this.Jy.getAttributeType(u),r))throw Error.argument("value","Value is not of the correct type for the specified attribute");t.yec(r);
for(t=0;t<this.I4.length;++t){const k=this.I4[t];if(u===k.kCb){k.value=r;return}}Array.add(this.I4,new f(u,r))}RLb(u){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Jy.lLc(u))throw Error.argument("attributeID","Invalid attribute ID");for(let r=0;r<this.I4.length;++r)if(u===this.I4[r].kCb){Array.removeAt(this.I4,r);break}}ave(u){if(!u)throw Error.argumentNull("action");for(const r of this.I4)u(r.kCb,r.value)}clone(){const u=new c(this.Jy);
u.Pib(this);return u}Pib(u){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!u)throw Error.argumentNull("other");if(u.Qyc!==this.Jy)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.I4);u.ave((r,t)=>{this.kB(r,t)})}Noa(){const {Annotations:u}=b(1289);let r="[",t=!0;for(const k of this.I4){t?t=!1:r+=", ";r+=this.Jy.mti(k.kCb);r+="=";const m=this.Jy.getAttributeType(k.kCb),l=this.Jy.Noa(m,k.value);m===u.hia?(r+=
'"',r+=c.P_f(l),r+='"'):r+=l}return r+"]"}isEqual(u){const {Annotations:r}=b(1289);if(!u)throw Error.argumentNull("other");if(this===u)return!0;if(!u||this.Jy!==u.Qyc||this.Sfg!==u.Sfg)return!1;let t=0,k=null,m=!1;u.ave((l,x)=>{++t;if(!m){var w=-1;for(let G=0,D=this.I4.length;G<D;++G)if(this.I4[G].kCb===l){w=G;break}0>w?m=!0:(k||(k=Array(this.I4.length)),k[w]=x)}});if(this.I4.length!==t||m)return!1;for(let l=0,x=this.I4.length;l<x;++l)if(!r.CPb(this.Jy.getAttributeType(this.I4[l].kCb),this.I4[l].value,
k[l]))return!1;return!0}j_(){return this.isReadOnly?this.clone():this}Fwg(){const {Annotations:u}=b(1289);if(!this.isReadOnly){this.lzb=!0;for(const r of this.I4)u.yec(r.value)}}toString(){return this.Noa()}static P_f(u){return u.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(C.a)(c,"FeatureBundle",null,[1155,1158])},1322:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{}f.click="Click";f.aob="InteractionBegin";f.qbc="InteractionEnd";f.dai="ControlActivated";
f.query="Query";f.zhj="QueryIndexRecorded";f.t8h="Clicks";f.cTh="ActionEvents";f.Bvj="SessionContext";f.latency="Latency";f.performance="Performance";f.Apj="RenderedResults";f.events="Events";f.N3k="CreateResultsMenu";f.jF="UpdateRibbonControls";f.Tbn="ResultsAggregation";f.HS="IssueQuery";f.bVk="CommandSuggestions";f.error="Error";f.dwg="LoadModelData";f.o9k="DepsResolveTime";f.Axm="ModelDataWaitTime";f.timedOut="TimedOut";f.gAk="AddinQueryCommandReady";f.Wql="GetAddinEntitlements";f.Ygj="ProviderMRUEvents";
Object(C.a)(f,"EventNames",null,[])},1328:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{constructor(){this.Ayg=null;this.ena=this.Cyg=0}O3f(c,u,r){if(!c)throw Error.argumentNull("referenceList");if(0>u||u>c.length)throw Error.argumentOutOfRange("startIndex");if(0>r||r>c.length)throw Error.argumentOutOfRange("length");if(u+r>c.length)throw Error.argument("Invalid start-length range");this.Ayg=c;this.Cyg=u;this.ena=r}fFb(c,u,r){this.O3f(c.Ayg,c.Cyg+u,r)}J(c){if(0>c||c>=this.ena)throw Error.argumentOutOfRange("index");
return this.Ayg[this.Cyg+c]}get count(){return this.ena}static eSf(c){const u=new f;u.O3f(c,0,c.length);return u}}Object(C.a)(f,"ReadOnlyList",null,[1173])},1334:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);var f;(function(c){c[c.Classifier=0]="Classifier";c[c.AppsForOffice=1]="AppsForOffice";c[c.FindInDocument=2]="FindInDocument";c[c.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";c[c.RecentlyUsed=4]="RecentlyUsed";c[c.TryQuery=5]="TryQuery";c[c.Empty=6]="Empty";c[c.TryCommand=
7]="TryCommand";c[c.Assistance=8]="Assistance";c[c.Answer=9]="Answer";c[c.Definition=10]="Definition";c[c.Entity=11]="Entity";c[c.WolframAnswer=12]="WolframAnswer";c[c.Insights=13]="Insights";c[c.People=14]="People";c[c.Document=15]="Document";c[c.Recommended=16]="Recommended";c[c.ServiceClassifier=17]="ServiceClassifier";c[c.ServiceRecommended=18]="ServiceRecommended";c[c.Image=19]="Image";c[c.Notes=20]="Notes";c[c.Learning=21]="Learning";c[c.Feedback=22]="Feedback";c[c.Template=23]="Template";c[c.Addin=
24]="Addin";c[c.None=25]="None";c[c.MergedActions=26]="MergedActions";c[c.MergedScopedSearches=27]="MergedScopedSearches";c[c.MergedSuggestedSearches=28]="MergedSuggestedSearches"})(f||(f={}));Object(C.b)("ResultGroupType",f)},1340:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);b=b(1395);class f extends b.a{constructor(){super();this.info=this.wj=this.eventId=null}get rra(){return"Misc"}n9b(){this.detail.$("Type",this.rra);this.detail.$("EventId",this.eventId);this.detail.$("Func",this.wj);
this.detail.$("Info",this.info);return this.detail}}Object(C.a)(f,"BasicMergeFailureDetail",b.a,[])},1341:function(C,L,b){b.d(L,"a",function(){return r});C=b(0);var f=b(577),c=b(726),u=b(1358);class r{constructor(t,k=!0){this.Wj=k&&t?t.AF():t;this.pxc=new f.a}wF(t){this.pxc.add(c.a.Ra(t))}gpn(t){this.pxc=t}r4i(t){this.Wj&&(new u.a(this.Wj,t)).Pna.forEach((k,m)=>{m.pY&&!this.pxc.contains(k)&&(this.pxc.add(k),m.isDeleted?(m=this.Wj,m.hasProperty(c.a.MX(k))&&m.removeProperty(c.a.MX(k))):this.Wj.c1(c.a.MX(k),
m.newValue));return!0})}}Object(C.a)(r,"PartialMergeResult",null,[])},1342:function(C,L,b){b.r(L);b.d(L,"CommandResultsUtility",function(){return x});C=b(0);var f=b(1359),c=b(1322),u=b(1360),r=b(1300),t=b(1306),k=b(1295),m=b(1294),l=b(2);class x{static r_d(w,G){if(G&&G.lo){const D={};for(const H of w)G.NHe(H)&&(D[H]=appChrome.selectors.getModelType(H));k.TellMeActor.instance.jF(D)}}static YCn(w){return w.startsWith("btnTellMeOfficeAddIn")}static UBd(w){const G=k.TellMeActor.instance.WU();return!!G&&
G.lo&&!appChrome.selectors.isControlDisabled(w)}static nKe(w,G,D,H){if(k.TellMeActor.instance.Qe&&w){const M=[];for(const J of w)M.push(String.format('{{"Id":"{0}","Score":{1}}}',J.commandId,J.score));w={};w[f.a.suggestions]="[{"+M.join(",")+"}]";w[f.a.VVi]=G;w[f.a.groupType]=D;w[f.a.provider]=H;k.TellMeActor.instance.Qe.pD(c.a.bVk,window.performance.now(),w)}}static qwl(w,G){const D=[],H=[];for(const M of G){G=M.commandId;let J=M;M.commandId in w&&(G=w[M.commandId],J=new u.a(G,M.score));Array.contains(H,
G)||(D.push(J),H.push(G))}return D}static pze(w,G,D,H,M,J,F){G.d7f&&(w=x.qwl(G.d7f,w));var A=m.a.Rul(w);x.r_d(A,G);var N=[],B=[];A=[];const E=new t.a(J);J=16===J||18===J||7===J||4===J?l.AFrameworkApplication.K?l.AFrameworkApplication.K.jb("TellMeMaxRecommendedResultsToReturn",3):3:0===J||17===J?5:0;for(const P of w)if(!x.A9l(P.commandId)){w=x.YCn(P.commandId);if(G.NHe(P.commandId)&&!w){if(m.a.gVi(P.commandId))continue;w=null;H&&M&&(w=H.BJl(P.commandId,M));x.UBd(P.commandId)?Array.add(N,new r.a(P.commandId,
5,w,null,F,P.score)):Array.add(B,new r.a(P.commandId,5,w,null,F,P.score))}else G.uhb&&w&&D&&Array.add(A,P.commandId.substr(21));if(N.length+A.length>=J)break}G=0;for(H=0;H<N.length&&G<J;H++,G++)E.DB(N[H]);for(N=0;N<B.length&&G<J;N++,G++)E.DB(B[N]);for(B=0;B<A.length&&G<J;B++,G++)D.JOn(A[B],E);return E}static A9l(w){x.M0h||(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.iz("TellMeControlPredictionBlockList")&&(x.L0h=l.AFrameworkApplication.K.kx("TellMeControlPredictionBlockList")),x.M0h=!0);
return Array.contains(x.L0h,w.toLowerCase())}static Pmg(w){return 2<w.length&&";"===w.charAt(0)&&";"===w.charAt(w.length-1)&&!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.ea("TellMeCommandHookIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static Zui(w){const G=new t.a(0);var D=w.split(";");w=k.TellMeActor.instance.WU();for(const H of D)if(0<H.length){D=H.split(":");const M=2===D.length?D[0]:H;if(!w.NHe(M))break;
if(1===D.length)D=new r.a(M,5,null,null,1),G.DB(D);else if(2===D.length)D=new r.a(M,5,D[1],null,1),G.DB(D);else break}return G}static avk(w,G,D){if(!(G&&G.results&&G.results.length&&w&&w.results&&w.results.length))return{returnValue:!1,XAf:w,bCf:G};const H=[];for(var M of G.results)Array.add(H,M.value);M=0;const J=G.results[0].score;for(const F of w.results)if(F.score>D&&!Array.contains(H,F.value)&&x.UBd(F.value)&&(F.score=J,Array.insert(G.results,M,F),M++),2===M)break;return 0<M?(D=G.results.length-
5,0<D&&G.zUg(D),{returnValue:!0,XAf:w,bCf:G}):{returnValue:!1,XAf:w,bCf:G}}}x.M0h=!1;x.L0h=[];Object(C.a)(x,"CommandResultsUtility",null,[])},1357:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{static uEn(c){return c.toString().charCodeAt(0)}static ggm(c){return 55296<=c&&57343>=c}static charAt(c,u){return c.charAt(u)}static NZh(c,u){if(c===u)return!0;"\u00a0"===c&&(c=" ");"\u00a0"===u&&(u=" ");return c===u}static MZh(c,u){if(c===u)return!0;if(!c||!u||c.length!==u.length)return!1;
c=f.Ipj(c);u=f.Ipj(u);return c===u}static Ipj(c){return c.replace(f.cqb," ")}static dua(c,u,r){return c.substring(u,u+r)}}f.cqb=RegExp("\u00a0","g");Object(C.a)(f,"CharUtils",null,[])},1358:function(C,L,b){b.d(L,"a",function(){return k});C=b(0);var f=b(362),c=b(726),u=b(245),r=b(41),t=b(1541);class k{constructor(m,l){this.Pgk=m;this.ugk=l;this.Wif=new u.a(()=>this.qCd());this.kkk=new u.a(Object(r.a)(this,this.Wgl,"evaluatePropertyDiffs"))}get Uv(){return this.Pgk}get We(){return this.ugk}get qHb(){return!!this.We&&
!this.Uv}get isDeleted(){return!this.We&&!!this.Uv}get pY(){return this.qHb||this.isDeleted||this.Wif.value}get Pna(){return this.kkk.value}qCd(m=null){let l=!1;this.Pna.forEach((x,w)=>{l=w.pY&&(!m||7!==m.J(x));return!l});return l}Wgl(){const m=new f.a;var l=this.We,x=this.Uv;if(this.qHb){x=l.Dh();for(var w=0;w<x.length;w++){var G=x[w];m.$(c.a.Ra(G),new t.a(G,null,l.Cy(G)))}}else if(this.isDeleted)for(l=x.Dh(),w=0;w<l.length;w++)G=l[w],m.$(c.a.Ra(G),new t.a(G,x.Cy(G),null));else{w=x.Dh();for(G=0;G<
w.length;G++){var D=w[G],H=c.a.Ra(D),M=x.Cy(D);const J=l.hasProperty(D)?l.Cy(D):null;m.$(H,new t.a(D,M,J))}w=l.Dh();for(G=0;G<w.length;G++)D=w[G],x.hasProperty(D)||(H=c.a.Ra(D),M=l.Cy(D),m.$(H,new t.a(D,null,M)))}return m}}Object(C.a)(k,"MergeableObjectDiff",null,[])},1359:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{}f.appName="AppName";f.Gqa="CloseAllMenus";f.commandId="CommandId";f.context="Context";f.culture="Culture";f.message="Message";f.errorMessage="ErrorMessage";f.event=
"Event";f.gsa="CorrelationID";f.GOm="ParentUiElement";f.query="Input";f.pic="QueryID";f.Chj="QueryLength";f.EPc="QueryIndex";f.Ubn="ResultsList";f.suggestions="Suggestions";f.scenario="Scenario";f.sessionId="SessionID";f.source="Source";f.timeStamp="Time";f.wMj="UiElement";f.pRg="ReactUx";f.value="Val";f.statusCode="StatusCode";f.jin="Service";f.isSuccess="IsSuccess";f.TEn="TokenAcquired";f.pjm="LatencyType";f.groupName="GroupName";f.fga="GroupIndex";f.groupType="GroupType";f.Pbn="ResultInfoList";
f.resultType="ResultType";f.C8g="SubResultType";f.Cbm="IsInputBlur";f.Dbm="IsInputFocus";f.yfm="IsShortCutUsed";f.actionType="ActionType";f.count="Count";f.kdl="DwellTime";f.VVi="IsZeroTerm";f.cTn="WordsCount";f.XGe="IsSearchUxEnabled";f.xgm="IsTellMeInHeaderEnabled";f.module="Module";f.resultIndex="ResultIndex";f.pXf="DisplayIndex";f.Eel="EnableList";f.provider="Provider";f.contentType="ContentType";f.ifm="IsSelectionBased";f.QGk="BeginPerformanceMarker";f.Vel="EndPerformanceMarker";f.vQm="PerformanceMeasure";
Object(C.a)(f,"Columns",null,[])},1360:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{constructor(c,u){this.commandId=c;this.score=u}}Object(C.a)(f,"CommandSuggestion",null,[])},1371:function(C,L,b){b.d(L,"b",function(){return t});b.d(L,"a",function(){return m});var f=b(199),c=b(362),u=b(577),r=b(1543);const t=(x,w,G)=>{const D=k(x,w,G);let H=0,M=0,J=0,F=new r.a;const A=new f.a;for(let N=0;N<D.length;N++){const B=D.Rf(N+1);F.xje(x.Rf(H));F.zje(w.Rf(M));F.Cje(G.Rf(J));H++;M++;for(J++;H<
x.length&&(!B||!B.equals(x.Rf(H)));)F.xje(x.Rf(H)),H++;for(;M<w.length&&(!B||!B.equals(w.Rf(M)));)F.zje(w.Rf(M)),M++;for(;J<G.length&&(!B||!B.equals(G.Rf(J)));)F.Cje(G.Rf(J)),J++;A.add(F);F=new r.a}for(;H<x.length;)F.xje(x.Rf(H)),H++;for(;M<w.length;)F.zje(w.Rf(M)),M++;for(;J<G.length;)F.Cje(G.Rf(J)),J++;F.isEmpty||A.add(F);return A},k=(x,w,G)=>{const D=new f.a,H=w.iG(),M=G.iG();x.forEach(J=>{H.contains(J)&&M.contains(J)&&D.add(J);return!0});return D},m=(x,w,G)=>{x=x||new f.a;w=w||new f.a;G=G||new f.a;
const D=new f.a,H=new c.a(0),M=new u.a;for(var J=0;J<x.length;J++){var F=x.Rf(J);H.$(F,J)}for(x=J=0;J<w.length&&x<G.length;){F=w.Rf(J);let A=G.Rf(x),N=H.VA(F,-1),B=H.VA(A,-1);-1===N?(l(M,D,F),J++):-1===B?(l(M,D,A),x++):N===B?(l(M,D,F),J++,x++):N<B?J++:x++}for(;J<w.length;J++)F=w.Rf(J),-1===H.VA(F,-1)&&l(M,D,F);for(;x<G.length;x++)w=G.Rf(x),-1===H.VA(w,-1)&&l(M,D,w);return D},l=(x,w,G)=>{x.contains(G)||(w.add(G),x.add(G))}},1372:function(C,L,b){b.d(L,"a",function(){return c});C=b(0);var f=b(51);class c{constructor(){this.cp=
0;this.id=f.a.create()}}Object(C.a)(c,"LcsUpdateHint",null,[1199,68])},1373:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{}f.tellMe="TellMe";f.loki="Loki";f.substrate="Substrate";f.EPc="QueryIndex";f.kIj="TellMeRanker";f.lIj="TellMeRankerLogging";Object(C.a)(f,"Services",null,[])},1374:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{}f.o5a="HttpRequest";f.provider="Provider";Object(C.a)(f,"LatencyTypes",null,[])},1377:function(C,L,b){C=b(0);var f=b(17),c=b(6),u=b(199),
r=b(146),t=b(192),k=b(51),m=b(577),l=b(41),x=b(234),w=b(1395);class G extends w.a{constructor(){super();this.JVe=null}get rra(){return"CreateMergeBlock"}n9b(){this.detail.$("Type",this.rra);this.detail.$("Revision",this.JVe);return this.detail}}Object(C.a)(G,"CreateMergeBlockFailureDetail",w.a,[]);var D=b(1445),H=b(1447),M=b(1540),J=b(1396),F=b(1341),A=b(1595);b.d(L,"a",function(){return N});class N{static wpe(B,E,P,T,V,I,R){let ba;ba="";const ha=new u.a;for(let da=0;da<P.length;da++){var na=void 0;
let ia;na=D.a.Gwl(E,P.J(da),T,V,I,R,B);if(!na)return{returnValue:null,hqb:ba};({Xzg:ia,hqb:na}=na.eAi());if(!ia)return{returnValue:null,hqb:ba};ba+=na;ha.$B(ha.length,ia)}return{returnValue:ha,hqb:ba}}static Cci(B,E,P,T,V,I,R,ba){let ha,na,da,ia,ma,qa;qa=ma=ia=da=na=ha=null;({hqb:ia,returnValue:ha}=N.wpe(E,ka=>B.runtime.pk.J(ka),P,1,I,R,ba));if(!ha)return r.a.instance.xa(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),
B.logger.Fg(Object.assign(new G,{JVe:"Base"})),{returnValue:!1,mP:ha,ird:na,a_d:da,Fke:ia,Ute:ma,d3e:qa};({hqb:ma,returnValue:na}=N.wpe(E,ka=>B.runtime.Zu.J(ka)||B.runtime.pk.J(ka),T,2,I,R,ba));if(!na)return r.a.instance.xa(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),B.logger.Fg(Object.assign(new G,{JVe:"Favored"})),{returnValue:!1,mP:ha,ird:na,a_d:da,Fke:ia,Ute:ma,d3e:qa};({hqb:qa,returnValue:da}=
N.wpe(E,ka=>B.runtime.Kr.J(ka)||B.runtime.pk.J(ka),V,4,I,R,ba));return da?{returnValue:!0,mP:ha,ird:na,a_d:da,Fke:ia,Ute:ma,d3e:qa}:(r.a.instance.xa(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),B.logger.Fg(Object.assign(new G,{JVe:"Unfavored"})),{returnValue:!1,mP:ha,ird:na,a_d:da,Fke:ia,Ute:ma,d3e:qa})}static r8h(B,E=!1){const P=new u.a;let T=0;for(;T<B.length;){var V=B.J(T);if(1===V.type||
4===V.type||2===V.type)P.add(V),T++;else if(3===V.type){let R="";R+=V.character;T++;let ba=V.$5a,ha=!1;for(;T<B.length;T++){var I=B.J(T);3===I.type?V.runId===I.runId&&V.EN.equals(I.EN)&&(V.i4===I.i4||V.oUa===I.oUa)&&V.YI.jD(I.YI)&&(!E||V.Wt&&V.Wt.equals(I.Wt))?(R+=I.character,I.$5a&&(ba=!0)):ha=!0:ha=!0;if(ha){V=new A.a(null,V.source,V.Vj,V.zf,V.runId,V.EN,R,V.DJb,!0,ba,V.i4,V.oUa,V.V7a,V.YI,V.Wt);P.add(V);break}}}}r.a.instance.xa(17044302,1,3,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
P.Dr());return P}static TUk(B,E=!1){const P=new u.a;let T=0;for(;T<B.length;){var V=B.J(T);if(1===V.type||4===V.type||2===V.type)P.add(V),T++;else if(3===V.type){let R=V.character.toString();T++;let ba=V.$5a;for(;T<B.length;T++){var I=B.J(T);if(3===I.type&&N.bsn(V,I,E))R+=I.character,I.$5a&&(ba=!0);else break}V=new A.a(null,V.source,V.Vj,V.zf,V.runId,V.EN,R,V.DJb,!0,ba,V.i4,V.oUa,V.V7a,V.YI,V.Wt);P.add(V)}}r.a.instance.xa(50931345,1,3,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
P.Dr());return P}static bsn(B,E,P){return B.runId===E.runId&&B.EN.equals(E.EN)&&(B.i4===E.i4||B.oUa===E.oUa)&&B.YI.jD(E.YI)&&(!P||!!B.Wt&&B.Wt.equals(E.Wt))}static Bnn(B,E,P,T,V,I,R,ba,ha,na,da,ia,ma,qa,ka,va){B.setPropertyString(P.Wj,f.a.wk,V);B.setPropertyUint32(P.Wj,c.a.Ob,T);B.setPropertyUint32s(P.Wj,c.a.Qo,I);B.setPropertyUint32s(P.Wj,c.a.ir,R);B.setPropertyObjectIds(P.Wj,f.a.qn,ha);B.hasProperty(P.Wj,c.a.Ui)&&B.setPropertyUint32(P.Wj,c.a.Ui,N.Npl());E&&E(21)&&B.setPropertyObjectIds(P.Wj,c.a.Bv,
va);T=!1;for(V=0;V<na.length;V++)if(na.J(V)){T=!0;break}T&&B.setPropertyBools(P.Wj,c.a.pMe,na);N.hMk(E,B,P,da,ia,ma,qa);N.iMk(B,P,ka);P.wF(f.a.wk);P.wF(c.a.Ob);P.wF(c.a.Qo);P.wF(c.a.ir);P.wF(f.a.qn);P.wF(c.a.pMe);P.wF(f.a.Vi);P.wF(f.a.gLa);P.wF(c.a.Fba);P.wF(c.a.w8);P.wF(f.a.E0);P.wF(c.a.Bv);B.hasProperty(P.Wj,c.a.Ui)&&P.wF(c.a.Ui);0<ba.length?B.setPropertyUint32s(P.Wj,f.a.Vi,ba):P.Wj.removeProperty(f.a.Vi)}static hMk(B,E,P,T,V,I,R){if(B(160)){B=T.contains(!0,(ba,ha)=>ha);N.P1g(E,P,f.a.E0,B?T:null);
N.P1g(E,P,f.a.gLa,N.Nqj(T,V));N.P1g(E,P,c.a.Fba,N.Nqj(T,I));T=!1;for(V=0;V<R.length;V++)0!==R.J(V)&&(T=!0);T?E.setPropertyUint32s(P.Wj,c.a.w8,R):P.Wj.removeProperty(c.a.w8)}}static iMk(B,E,P){const T=R=>R;var V=Object(l.a)(B,B.setPropertyBools,"setPropertyBools");N.E2a(E,P.SUa,T,V,c.a.pga);N.E2a(E,P.tSa,T,V,c.a.d7);N.E2a(E,P.yrb,T,V,c.a.nha);V=R=>0<R.length;var I=Object(l.a)(B,B.setPropertyStrings,"setPropertyStrings");N.E2a(E,P.YGb,V,I,c.a.qga);N.E2a(E,P.NDb,V,I,c.a.Ffa);N.E2a(E,P.YKb,V,I,c.a.cia);
V=R=>!!R;I=Object(l.a)(B,B.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");N.E2a(E,P.ZGb,V,I,c.a.rga);N.E2a(E,P.zjb,V,I,c.a.Gfa);N.E2a(E,P.$Kb,V,I,c.a.dia);P.yrb.any(T)?N.E2a(E,P.ZKb,()=>!0,Object(l.a)(B,B.setPropertyObjectIds,"setPropertyObjectIds"),c.a.rda):E.Wj.removeProperty(c.a.rda)}static Nqj(B,E){const P=new u.a;let T=!1;for(let V=0;V<B.length;V++){const I=E.J(V)&&!B.J(V);P.add(I);T=I||T}return T?P:null}static P1g(B,E,P,T){T?B.setPropertyBools(E.Wj,P,T):E.Wj.removeProperty(P)}static Npl(){return t.a.HH()}static WAi(B,
E){return B.runtime.Zu.VA(E,B.runtime.pk.J(E)||B.runtime.Kr.get(E))}static nvd(B,E,P,T,V){let I;I=new u.a;const R=!!P&&P(21);if(B.runtime.Ka.isFeatureEnabled(125)){var ba=N.TUk(T,R);var ha=N.r8h(T,R);ba.length!==ha.length&&B.runtime.Ka.hq(125)}else ba=N.r8h(T,R);ha=0;let na="",da=new u.a,ia=new u.a,ma=new u.a,qa=new u.a,ka=new u.a,va=new u.a,ja=new u.a,Ma=new u.a,Ha=new u.a;const X=new M.a;let W=new u.a;var fa=ba.J(ba.length-1);if(2!==fa.type&&4!==fa.type)return r.a.instance.xa(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",
fa.type),B.logger.Fg(Object.assign(new J.a,{wj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",fa.type)})),{returnValue:!1,xQe:I};var ra=0;for(fa=0;fa<ba.length;fa++){var Aa=ba.J(fa),Ba=null;if(1===Aa.type||3===Aa.type)Ba=Aa,na+=Ba.text;else if(4===Aa.type){Aa=N.WAi(B,Aa.Vj);Aa=new F.a(Aa);I.add(Aa);continue}Ba?(da.add(Ba.runId),ia.add(Ba.zf),ra+=Ba.text.length,ma.add(ra),qa.add(Ba.EN),ka.add(Ba.DJb),va.add(Ba.$5a),ja.add(Ba.i4),
Ma.add(Ba.oUa),Ha.add(Ba.V7a),X.SUa.add(Ba.YI.VYl),X.tSa.add(Ba.YI.xYl),X.yrb.add(Ba.YI.oZl),X.YGb.add(Ba.YI.insertion.author),X.NDb.add(Ba.YI.deletion.author),X.YKb.add(Ba.YI.$Wa.author),X.ZGb.add(Ba.YI.insertion.gId),X.zjb.add(Ba.YI.deletion.gId),X.$Kb.add(Ba.YI.$Wa.gId),X.ZKb.add(Ba.YI.$Wa.fOg),R&&W.add(Ba.Wt)):da.length||(da.add(0),ia.add(0),ma.add(0),qa.add(k.a.nil),ka.add(!1),va.add(!1),ja.add(!1),Ma.add(!1),Ha.add(0),X.SUa.add(!1),X.tSa.add(!1),X.yrb.add(!1),X.YGb.add(""),X.NDb.add(""),X.YKb.add(""),
X.ZGb.add(0),X.zjb.add(0),X.$Kb.add(0),X.ZKb.add(k.a.nil));if(2===Aa.type){ra=Aa;Aa=ra.Ob;ma.wI(ma.length-1);Ba=V.J(ha);if(!Ba)return r.a.instance.xa(17044307,1,2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",ha,V.length,T.length,fa,ba.length),B.logger.Fg(Object.assign(new J.a,{wj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),
r.a.instance.Z8(17044308,1,3,"GetMergeableObjectsFromMergeBlocks Paragraphs",V.Dr()),r.a.instance.Z8(17044309,1,3,"GetMergeableObjectsFromMergeBlocks MergeBlocks",T.Dr()),r.a.instance.Z8(17044310,1,3,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",ba.Dr()),{returnValue:!1,xQe:I};if(Ba=N.WAi(B,Ba))Ba=new F.a(Ba.AF()),N.Bnn(E,P,Ba,ra.Ob,na,da,ia,ma,qa,ka,va,ja,Ma,Ha,X,W),I.add(Ba);r.a.instance.xa(17044312,1,3,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",
ra.Vj,Aa,da.Dr(),ia.Dr(),ma.Dr(),va.Dr(),ja.Dr(),Ma.Dr(),qa.Dr(),"",Ha.Dr());ha++;na="";da=new u.a;ia=new u.a;ma=new u.a;qa=new u.a;ka=new u.a;va=new u.a;ja=new u.a;Ma=new u.a;Ha=new u.a;X.reset();ra=0;W=new u.a}}return{returnValue:!0,xQe:I}}static fbn(B,E){const P=B.runtime.zm.J(x.a.DO),T=E.getPropertyObjectIds(P.Wj,c.a.D5);for(let V=0;V<T.length;V++)B.runtime.zm.remove(T.J(V));E.setPropertyObjectIds(P.Wj,c.a.D5,new u.a);E.setPropertyString(P.Wj,c.a.CZa,k.a.nil.toString());P.wF(c.a.D5);P.wF(c.a.CZa)}static t4l(B,
E){if(B.runtime.zm.Na(x.a.DO))return null;const P=new F.a(B.runtime.pk.J(x.a.DO).AF());E.setPropertyString(P.Wj,c.a.CZa,B.output.NS.last().id.toString());E.setPropertyObjectIds(P.Wj,c.a.D5,new u.a);P.wF(c.a.D5);P.wF(c.a.CZa);B.runtime.zm.$(x.a.DO,P);return P}static g$f(B){const E=new u.a;B.forEach(P=>{E.add(P.id);return!0});return E}static aMc(B,E,P,T){let V=0;P.forEach(I=>{H.a(I,E+V++,1);393230===I.Jb&&B.getPropertyObjectIds(I,f.a.qn).forEach(R=>{T.add(R);return!0});return!0})}static bnm(B,E){const P=
new m.a;let T=0;E.forEach(V=>{if(P.contains(V))return!0;P.add(V);if(({index:T}=N.ixg("BaseFormatting_",T,V,I=>B.runtime.pk.J(I))).returnValue||({index:T}=N.ixg("FavoredFormatting_",T,V,I=>B.runtime.Zu.J(I))).returnValue||({index:T}=N.ixg("ConflictingFormatting_",T,V,I=>B.runtime.Kr.J(I))).returnValue)return!0;T++;return!0})}static ixg(B,E,P,T){if(P=T(P))if(H.a(P,B+E,1),1179649===P.Jb)return E++,{returnValue:!0,index:E};return{returnValue:!1,index:E}}static aYf(B){return!!B.runtime.pk.J(x.a.DO)}static E2a(B,
E,P,T,V){E.any(P)?(T(B.Wj,V,E),B.wF(V)):B.Wj.removeProperty(V)}static Byj(B,E){const P=new u.a;P.add(0);const T=B?B.length:0;for(let V=0;V<T;V++)P.insert(V+1,B.Rf(V));P.insert(P.length,E);return P}}Object(C.a)(N,"ParagraphMergeUtils",null,[])},1393:function(C,L,b){b.d(L,"a",function(){return c});C=b(0);var f=b(199);class c{constructor(u,r,t){this.En=null;this.wl=u;this.source=r;this.Vj=t}get type(){return this.wl}get pub(){return!1}get Kam(){return 1===(this.source&1)}get Lam(){return 2===(this.source&
2)}get Mam(){return 4===(this.source&4)}eca(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",this.ctl(),this.gFc())}ctl(){let u="";this.Kam&&(u+="Base");this.Lam&&(u+="FavoredUpdate");this.Mam&&(u+="UnfavoredUpdate");return u}gFc(){return""}jD(u){return this.type===u.type}HWd(){const u=new f.a;u.add(this);return u}get length(){return 0}}Object(C.a)(c,"AMergeBlock",null,[71,72])},1394:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);b=b(1393);class f extends b.a{constructor(c,
u,r){super(2,c,u);this.Ob=r}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),this.Ob,this.Vj)}gFc(){return"Eop"}clone(){return new f(this.source,this.Vj,this.Ob)}jD(c,u,r,t=!1,k=!0){return super.jD(c,u,r,t)?k?c.Ob===this.Ob:c.Vj===this.Vj&&c.Ob===this.Ob:!1}get length(){return 1}}Object(C.a)(f,"EopMergeBlock",b.a,[])},1395:function(C,L,b){b.d(L,"a",function(){return c});C=b(0);var f=b(362);class c{constructor(){this.detail=new f.a}}Object(C.a)(c,"AMergeFailureDetail",
null,[1835])},1396:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);b=b(1340);class f extends b.a{constructor(){super()}get rra(){return"ParagraphMerge"}}Object(C.a)(f,"ParagraphMergeFailureDetail",b.a,[])},1397:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);b=b(1340);class f extends b.a{constructor(){super()}get rra(){return"RdOpLcs"}}Object(C.a)(f,"ReducedOpsLcsFailureDetail",b.a,[])},1398:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);b=b(1340);class f extends b.a{constructor(){super()}get rra(){return"TableMerge"}}
Object(C.a)(f,"TableMergeFailureDetail",b.a,[])},1401:function(C,L,b){C=b(0);class f{constructor(){this.OYd=this.vAd=null;this.Fzg=this.score=this.KHd=0}PLg(D,H,M){this.score=D.J(H);++H;this.vAd=D.J(H)?M.Kza(D.J(H)):null;++H;this.OYd=D.J(H)?M.Kza(D.J(H)):null;++H;this.KHd=D.J(H);++H;this.Fzg=D.J(H);++H;return H}}Object(C.a)(f,"TokenStringGeneratorInit",null,[]);class c{constructor(D,H,M,J,F){this.VEb=D;this.count=H;this.Fue=M;this.NU=J;this.depth=F}}Object(C.a)(c,"ErrorTolerantTrieMatch",null,[]);
var u=b(1462),r=b(1561);class t{constructor(D=null,H=0,M=0,J=0){this.Dqk=D||new r.a;this.JHa=H;this.NU=M;this.depth=J}get sda(){return this.Dqk}getKey(){return this.sda.Xz.toString()+":"+this.JHa.toString()}}Object(C.a)(t,"TrieBookmark",null,[]);class k{constructor(D,H){this.K6a=D;this.vyg=H}lsm(D){if(null==D)throw Error.argumentNull("prefix");let H={};var M=H[""]=new t;this.$Ce(M,H);for(M=0;M<D.length;++M){const J=D.charCodeAt(M),F={};for(let A in H)this.NAk(J,H[A],F);H=F}return this.oGn(H)}$Ce(D,
H){if(!(D.NU>=this.vyg)&&(D=new t(u.a.OMf(D.sda),D.JHa,D.NU+1,D.depth),D.sda.lJ&u.a.Cwb&&(D.JHa+=1),this.K6a.doc(D.sda))){D.depth+=1;let M=!0;for(;M;)k.F3e(D,H),this.$Ce(D,H),D.JHa+=this.K6a.zFc(D.sda,!0)+(D.sda.lJ&u.a.Cwb?1:0),M=this.K6a.fZd(D.sda)}}NAk(D,H,M){H.NU+1<=this.vyg&&(H.NU+=1,k.F3e(H,M),--H.NU);H.sda.lJ&u.a.Cwb&&(H.JHa+=1);if(this.K6a.doc(H.sda)){H.depth+=1;let J=!0;for(;J;)H.sda.spc===D?(k.F3e(H,M),this.$Ce(H,M)):H.NU+1<=this.vyg&&(H.NU+=1,k.F3e(H,M),this.$Ce(H,M),--H.NU),H.JHa+=this.K6a.zFc(H.sda,
!0)+(H.sda.lJ&u.a.Cwb?1:0),J=this.K6a.fZd(H.sda)}}oGn(D){const H=[];for(var M in D){const J=D[M];if(!J.sda.Xz)continue;const F=!!(J.sda.lJ&u.a.Cwb),A=this.K6a.zFc(J.sda,!1)+(F?1:0);Array.add(H,new c(J.JHa,A,F,J.NU,J.depth))}H.sort((J,F)=>{let A=J.VEb-F.VEb;return A||(A=-(J.count-F.count))?A:A=J.depth-F.depth});if(2>H.length)return H;D=[];for(M=0;M<H.length;)M+=k.FKj(M,H,D);return D}static F3e(D,H){const M=D.getKey();M in H?(H=H[M],H.NU=Math.min(H.NU,D.NU)):H[M]=new t(u.a.OMf(D.sda),D.JHa,D.NU,D.depth)}static FKj(D,
H,M){const J=H[D];let F=J.VEb;const A=F+J.count;let N=1,B=J.Fue;for(;D+N<H.length&&H[D+N].VEb<A;){const E=H[D+N];E.VEb>F&&(Array.add(M,new c(F,E.VEb-F,B,J.NU,J.depth)),B=!1);N+=k.FKj(D+N,H,M);F=E.VEb+E.count}F<A&&Array.add(M,new c(F,A-F,B,J.NU,J.depth));return N}}Object(C.a)(k,"ErrorTolerantTrieLookupEngine",null,[1210]);class m extends f{constructor(D,H,M){super();this.dMi=this.Hbj=!1;this.wli=null;if(D){var J=0;try{J=this.PLg(D,J,H);this.Hbj=1===D.J(J);++J;this.dMi=1===D.J(J);++J;const F=D.J(J);
this.wli=this.ZOm(M,F)}catch(F){throw Error.argument("initData");}}}ZOm(D,H){return new k(D,H)}}Object(C.a)(m,"FuzzyMatchTokenStringGeneratorInit",f,[]);class l extends f{constructor(D,H){super();this.query=this.name=null;if(D){this.hf=H.hf;var M=0;try{M=this.PLg(D,M,H),this.name=H.getString(D.J(M)),++M,this.query=H.KP(D.J(M))}catch(J){throw Error.argument("initData");}}}}Object(C.a)(l,"QueryTokenStringGeneratorInit",f,[]);class x extends f{constructor(D,H){super();if(D)try{this.PLg(D,0,H)}catch(M){throw Error.argument("initData");
}}}Object(C.a)(x,"SurfaceStringTokenStringGeneratorInit",f,[]);var w=b(1328);b.d(L,"a",function(){return G});class G{constructor(D){this.myg=D}get vAd(){return this.myg.vAd}get OYd(){return this.myg.OYd}get KHd(){return this.myg.KHd}static create(D,H,M){const {SurfaceStringTokenStringGenerator:J}=b(1681),{QueryTokenStringGenerator:F}=b(1682),{FuzzyMatchTokenStringGenerator:A}=b(1683);let N=0;try{if(D.J(N)!==G.S3b)throw Error.argument("initData","Input does not represent a token string generator");
++N;const B=D.J(N);++N;const E=new w.a;E.fFb(D,N,D.count-N);switch(B){case J.tjd:return new J(new x(E,H));case F.tjd:return new F(new l(E,H));case A.tjd:return new A(new m(E,H,M));default:throw Error.argument("initData");}}catch(B){throw Error.argument("initData");}}static vVh(D,H,M,J,F,A){D=D.YEn.getId(H,null);if(0>D)return++A,A;G.wVh(D,M,J,F);return A}static wVh(D,H,M,J){Array.add(J.o8g,D);Array.add(J.hGj,H);++J.CUc[M]}}G.S3b=1099767983;Object(C.a)(G,"TokenStringGenerator",null,[1189])},1444:function(C,
L,b){b.d(L,"a",function(){return u});C=b(0);var f=b(199);L=b(1393);var c=b(1357);class u extends L.a{constructor(r,t,k){super(r,t,k)}eyn(r){let t;t=null;if(!this.text||!this.pub||0>=r||r>=this.length)return{returnValue:!1,GEj:t};t=new f.a;const k=this.clone();k.MUd(c.a.dua(this.text,0,r));const m=this.clone();m.MUd(c.a.dua(this.text,r,this.length-r));t.add(k);t.add(m);return{returnValue:!0,GEj:t}}eca(){return!0}get length(){return this.text.length}}Object(C.a)(u,"ATextMergeBlock",L.a,[])},1445:function(C,
L,b){b.d(L,"a",function(){return c});C=b(0);var f=b(146);class c{HEf(u,r){return u+("[Block: "+r+"] ")}static Gwl(u,r,t,k,m,l,x){const {ParagraphMergeBlockCreator:w}=b(1726),{TableMergeBlockCreator:G}=b(1730);if(393230===r.Jb)return new w(u,r,t,m,l,k(21),x);if(393250===r.Jb)return new G(r,t);f.a.instance.xa(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",r.Jb);return null}}Object(C.a)(c,"MergeBlockCreator",null,[])},1446:function(C,L,b){b.d(L,"a",function(){return r});
C=b(0);var f=b(6),c=b(51);L=b(1444);var u=b(1358);class r extends L.a{constructor(t,k,m,l,x,w,G,D,H,M,J,F,A,N){super(k,m,l);this.zf=x;this.runId=w;this.DJb=D;this.N9j=G;this.O8e=t;this.$5a=H;this.i4=M;this.oUa=J;this.V7a=F;this.YI=A;this.Wt=N}get tgd(){return this.O8e}get EN(){return this.N9j}get t8b(){return this.tgd(this.EN)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",super.toString(),this.zf,this.runId,
this.DJb,this.Vj,this.EN.toString(),this.Wt?this.Wt.toString():"NULL")}jD(t,k,m,l=!1){if(!super.jD(t,k,m,l))return!1;if(l)return!0;if(!this.YI.jD(t.YI)||this.Wt&&!this.Wt.equals(t.Wt))return!1;if(this.EN.equals(t.EN)||this.EN.equals(c.a.nil)||t.EN.equals(c.a.nil))return!0;t=new u.a(this.t8b,t.t8b);k=k.ici(this.t8b,m);return t.qCd(k.RNd)?!1:!0}get m8l(){return this.eca()&&"\ufffc"===this.text&&this.t8b?this.t8b.hasProperty(f.a.Jp)||1179725!==this.t8b.Jb?!0:!1:!1}}Object(C.a)(r,"AUserRunMergeBlock",
L.a,[])},1447:function(C,L,b){b.d(L,"a",function(){return c});var f=b(146);const c=(u,r,t=4)=>{u?f.a.instance.Z8(4273285,t,3,r,u.cZa()):f.a.instance.xa(4293845,t,1,r,"{0}: Node was null.",r)}},1448:function(C,L,b){b.d(L,"e",function(){return k});b.d(L,"a",function(){return m});b.d(L,"d",function(){return l});b.d(L,"b",function(){return x});b.d(L,"c",function(){return w});var f=b(6),c=b(17),u=b(51),r=b(910),t=b(1371);const k=(H,M,J)=>{const F=new r.a;let A=u.a.nil;M=F.getPropertyObjectId(M,f.a.MYa);
M.equals(u.a.nil)||(H=H.runtime.pk.J(M),J&&(H=J.VA(M,H)),H&&(A=F.getPropertyObjectId(H,f.a.MYa)));return A},m=(H,M,J,F,A)=>{const N=new r.a;let B=null;var E=N.getPropertyObjectId(J,f.a.MYa);E!==u.a.nil&&(B=H.runtime.pk.J(E),M&&(B=M.VA(E,B)));if(B){E=N.getPropertyObjectIds(B,c.a.jf);for(A=0;A<E.length&&!E.J(A).equals(J.id);A++);A===E.length&&(A=-1)}J=k(H,J,M);if(!J.equals(u.a.nil)&&(H=H.runtime.pk.J(J),M&&(H=M.VA(J,H)),H)){M=N.getPropertyObjectIds(H,c.a.jf);for(F=0;F<M.length&&!M.J(F).equals(B.id);F++);
F===M.length&&(F=-1)}return{rowIndex:F,OAc:A}},l=(H,M,J,F,A)=>{var N=new r.a;let B=null;var E=H.runtime.pk.J(J);M&&(E=M.VA(J,E));if(!E)return null;E=N.getPropertyObjectIds(E,c.a.jf);J=null;F<E.length&&(F=E.J(F),J=H.runtime.pk.J(F),M&&(J=M.VA(F,J)));J&&(N=N.getPropertyObjectIds(J,c.a.jf),A<N.length&&(A=N.J(A),B=H.runtime.pk.J(A),M&&(B=M.VA(A,B))));return B},x=(H,M,J)=>{let F,A;A=F=-1;const N=(new r.a).getPropertyObjectId(J,f.a.MYa);var B=k(H,J,M);if(B.equals(u.a.nil)||N.equals(u.a.nil))return{rowIndex:F,
OAc:A};M=H.runtime.C9g;var E=M.J(B);if(!E){E=G(H,B);if(!E)return{rowIndex:F,OAc:A};M.$(B,E)}for(B=0;B<E.length;B++)if(E.J(B).equals(N)){F=B;break}E=M.J(N);if(!E){E=D(H,N);if(!E)return{rowIndex:F,OAc:A};M.$(N,E)}for(H=0;H<E.length;H++)if(E.J(H).equals(J.id)){A=H;break}return{rowIndex:F,OAc:A}},w=(H,M,J,F)=>{if(0>J||0>F)return u.a.nil;new r.a;const A=H.runtime.C9g;let N=A.J(M);if(!N){N=G(H,M);if(!N)return u.a.nil;A.$(M,N)}if(J<N.length)M=N.J(J);else return u.a.nil;J=A.J(M);if(!J){J=D(H,M);if(!J)return u.a.nil;
A.$(M,J)}if(F<J.length)H=J.J(F);else return u.a.nil;return H},G=(H,M)=>{var J=new r.a;const F=H.runtime.pk.J(M);if(F){var A=H.runtime.Zu.VA(M,F);H=H.runtime.Kr.VA(M,F);M=J.getPropertyObjectIds(F,c.a.jf);A=J.getPropertyObjectIds(A,c.a.jf);J=J.getPropertyObjectIds(H,c.a.jf);return M.Ap(A,(N,B)=>N.equals(B))?J:M.Ap(J,(N,B)=>N.equals(B))?A:t.a(M,A,J,(N,B)=>N.equals(B))}return(A=H.runtime.Zu.J(M))?J.getPropertyObjectIds(A,c.a.jf):(A=H.runtime.Kr.J(M))?J.getPropertyObjectIds(A,c.a.jf):null},D=(H,M)=>{var J=
new r.a;const F=H.runtime.pk.J(M);if(F){var A=H.runtime.Zu.VA(M,F);H=H.runtime.Kr.VA(M,F);M=J.getPropertyObjectIds(F,c.a.jf);A=J.getPropertyObjectIds(A,c.a.jf);J=J.getPropertyObjectIds(H,c.a.jf);return M.Ap(A,(N,B)=>N.equals(B))?J:M.Ap(J,(N,B)=>N.equals(B))?A:null}return(A=H.runtime.Zu.J(M))?J.getPropertyObjectIds(A,c.a.jf):(A=H.runtime.Kr.J(M))?J.getPropertyObjectIds(A,c.a.jf):null}},1449:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);var f;(function(c){c[c.Answer=0]="Answer";c[c.Definition=
1]="Definition";c[c.Entity=2]="Entity";c[c.WolframAnswer=3]="WolframAnswer";c[c.Assistance=4]="Assistance";c[c.Command=5]="Command";c[c.Document=6]="Document";c[c.TryQuery=7]="TryQuery";c[c.FindInDocument=8]="FindInDocument";c[c.HelpAction=9]="HelpAction";c[c.Insights=10]="Insights";c[c.People=11]="People";c[c.Image=12]="Image";c[c.FirstRunResult=13]="FirstRunResult";c[c.NoCommandsFoundResult=14]="NoCommandsFoundResult";c[c.TestResult=15]="TestResult";c[c.AppsForOffice_Installed=16]="AppsForOffice_Installed";
c[c.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";c[c.AppsForOffice_Query=18]="AppsForOffice_Query";c[c.Notes_Onenote=19]="Notes_Onenote";c[c.Notes_Samsung=20]="Notes_Samsung";c[c.Notes_Sticky=21]="Notes_Sticky";c[c.Learning=22]="Learning";c[c.Feedback=23]="Feedback";c[c.Template=24]="Template";c[c.Addin=25]="Addin";c[c.Unknown=26]="Unknown"})(f||(f={}));Object(C.b)("ResultType",f)},1450:function(C,L,b){b.d(L,"a",function(){return c});C=b(0);var f=b(1294);b=b(2);class c{static ygm(){return!f.a.BRi()&&
!f.a.$cc()&&c.isFeatureEnabled(0)}static GUi(){return c.isFeatureEnabled(1)}static HSi(){return c.isFeatureEnabled(2)}static isFeatureEnabled(u){return!!(c.T8j&1<<u)}}c.T8j=b.AFrameworkApplication.K?b.AFrameworkApplication.K.jb("TellMeFeatureConfigValue",0):0;Object(C.a)(c,"TellMeFeatureAvailability",null,[])},1451:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);b=b(1300);class f extends b.a{constructor(c,u,r,t,k=null){super(c,u,k,null,r);this.id=t}}Object(C.a)(f,"TryQueryResultBinding",b.a,
[])},1452:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{constructor(c){this.Pa=c}get Gqb(){return this.Pa.Gqb}get bBn(){return 4!==this.Pa.style}get dBn(){return!0}get trie(){return this.Pa.trie}getId(c,u){if(!this.bBn)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Pa.style){case 0:return this.vCl(c,u);default:throw Error.notImplemented();}}getString(c){if(!this.dBn)throw Error.invalidOperation("String lookup not supported on this string table");
if(0>c||c>=this.Gqb)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Pa.style){case 0:return this.jPl(c);case 4:return this.iPl(c);default:throw Error.notImplemented();}}vCl(c,u){c=this.Pa.trie.D1i(c,0,c.length,u);if(!c.succeeded)return-1;if(0>c.PUc||c.PUc>=this.Pa.Gqb)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Pa.gZd?this.Pa.hPd.hB(this.Pa.gZd+4*c.PUc,4):c.PUc}jPl(c){if(this.Pa.gZd){let u=0;for(;u<this.Pa.Gqb&&this.Pa.hPd.hB(this.Pa.gZd+
4*u,4)!==c;++u);if(u>=this.Pa.Gqb)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Pa.trie.uEi(u)}return this.Pa.trie.uEi(c)}iPl(c){const u=this.Pa.hPd.hB(this.Pa.eGj+4*c,4);c=this.Pa.hPd.hB(this.Pa.fGj+4*c,4);if(0>c||0>u)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const r=Array(u);for(let t=0;t<u;++t)r[t]=({v0l:c}=this.c_m(c)).returnValue;return String.fromCharCode.apply(null,r)}c_m(c){let u=0;for(let r=0;3>r;++r){const t=
this.Pa.hPd.J(this.Pa.K5h+c)^182;++c;u|=(t&127)<<7*r;if(!(t&128))break}return{returnValue:u,v0l:c}}}Object(C.a)(f,"StringTable",null,[1175])},1453:function(C,L,b){b.d(L,"a",function(){return c});C=b(0);var f=b(1462);class c{constructor(u){this.trie=null;this.K5h=this.eGj=this.fGj=this.gZd=0;if(u){this.hPd=u;var r=0;if(u.hB(r,4)!==c.S3b)throw Error.argument("bytes","Input does not represent a string table");r+=4;this.Gqb=u.hB(r,4);r+=4;this.style=u.hB(r,4);r+=4;switch(this.style){case 0:const t=1===
u.hB(r,4);r+=4;t||(this.gZd=r,r+=4*this.Gqb);u.hB(r,4);this.trie=this.wPm(u,r+4);break;case 4:this.fGj=r;this.eGj=r+=4*this.Gqb;r+=4*this.Gqb;u.hB(r,4);this.K5h=r+4;break;default:throw Error.argument("bytes");}}}wPm(u,r){return new f.a(u,r)}}c.S3b=1025118440;Object(C.a)(c,"StringTableInit",null,[])},1459:function(C,L,b){C=b(0);var f=b(6),c=b(577),u=b(146),r=b(199),t=b(51),k=b(362),m=b(70),l;(function(ya){ya[ya.none=0]="none";ya[ya.mergeConflict=1]="mergeConflict";ya[ya.containerBaseIdValidationFailure=
2]="containerBaseIdValidationFailure";ya[ya.failedToApplyHints=3]="failedToApplyHints";ya[ya.validateUpdateHintsAreComplete=4]="validateUpdateHintsAreComplete";ya[ya.other=5]="other"})(l||(l={}));Object(C.b)("ParagraphMergeUsingHintsFailureReason",l);var x=b(910),w=b(234),G=b(807);const D=ya=>{const wa=new r.a;ya.forEach(Fa=>{wa.add(Fa);return!0});return wa};var H=b(1394),M=b(1371),J=b(1397);const F=(ya,wa)=>{if(ya.length!==wa.length)return!1;for(let Fa=0;Fa<ya.length;Fa++)ya.J(Fa).En=wa.J(Fa),wa.J(Fa).En=
ya.J(Fa);return!0},A=(ya,wa,Fa)=>{let bb,Eb,hb;bb=0;Eb=!1;hb=0;var nb;if(!({cY:nb}=T(ya,wa)).returnValue)return u.a.instance.xa(18969440,1,4,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",wa,ya.Dr()),{returnValue:!1,Ixd:bb,AJb:Eb,OId:hb};if(!Fa&&2===ya.J(nb).type)return{returnValue:!0,Ixd:nb,AJb:Eb,OId:hb};if(!ya.J(nb).eca())return u.a.instance.xa(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",
nb,Fa,ya.Dr()),{returnValue:!1,Ixd:bb,AJb:Eb,OId:hb};let Pb=!1,bc=0;for(;nb<ya.length&&ya.J(nb).Vj.equals(wa);nb++){if(Fa===bc){Pb=!0;break}if(Fa>bc&&Fa<bc+ya.J(nb).length){Eb=Pb=!0;hb=Fa-bc;break}bc+=ya.J(nb).length}Pb||Fa!==bc||(Pb=!0);Pb&&(bb=nb);return{returnValue:Pb,Ixd:bb,AJb:Eb,OId:hb}},N=(ya,wa,Fa)=>{let bb,Eb,hb;hb=Eb=0;bb=!1;let nb=0,Pb=!1;for(;Eb<ya.length;Eb++){if(wa===nb){Pb=!0;break}if(wa>nb&&wa<nb+ya.J(Eb).length){bb=Pb=!0;hb=wa-nb;break}nb+=ya.J(Eb).length}Pb||wa!==nb||(Pb=!0);Pb||
(ya=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",ya.length,nb,wa),u.a.instance.xa(573178201,1,2,ya),Fa.Fg(Object.assign(new J.a,{eventId:"8k6fz",info:ya})));return{returnValue:Pb,AJb:bb,K0h:Eb,J0h:hb}},B=(ya,wa,Fa)=>{let bb;if(ya.J(wa).eca()&&({GEj:bb}=ya.J(wa).eyn(Fa)).returnValue)return ya.$B(wa+1,bb),ya.wI(wa),!0;u.a.instance.xa(18969441,1,4,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",wa,Fa,
ya.Dr());return!1},E=(ya,wa,Fa)=>{let bb,Eb;if(!({Ixd:Fa,AJb:Eb,OId:bb}=A(ya,wa,Fa)).returnValue)return{returnValue:!1,index:0};if(!Eb)return{returnValue:!0,index:Fa};if(B(ya,Fa,bb))return{returnValue:!0,index:Fa+1};u.a.instance.xa(18969442,1,4,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",wa,bb,ya.Dr());return{returnValue:!1,index:0}},P=(ya,wa,Fa)=>{let bb;if(!({AJb:bb,K0h:wa,J0h:Fa}=N(ya,wa,Fa)).returnValue)return{returnValue:!1,index:0};if(!bb)return{returnValue:!0,
index:wa};if(B(ya,wa,Fa))return{returnValue:!0,index:wa+1};u.a.instance.xa(574433311,1,4,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",Fa,ya.Dr());return{returnValue:!1,index:0}},T=(ya,wa)=>{let Fa;Fa=0;for(let bb=0;bb<ya.length;bb++)if(ya.J(bb).Vj.equals(wa))return Fa=bb,{returnValue:!0,cY:Fa};u.a.instance.xa(18969443,1,4,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",wa,ya.Dr());return{returnValue:!1,cY:Fa}},V=(ya,wa)=>
{let Fa;Fa=-1;for(let bb=wa;bb<ya.length;bb++)if(2===ya.J(bb).type)return Fa=bb,{returnValue:!0,ora:Fa};u.a.instance.xa(18969472,1,4,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",wa,ya.Dr());return{returnValue:!1,ora:Fa}},I=(ya,wa,Fa)=>{let bb;bb=-1;for(let Eb=Fa;Eb<ya.length;Eb++)if(2===ya.J(Eb).type&&ya.J(Eb).Vj.equals(wa))return bb=Eb,{returnValue:!0,ora:bb};u.a.instance.xa(18969473,1,4,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",
wa,Fa,ya.Dr());return{returnValue:!1,ora:bb}},R=(ya,wa)=>{let Fa;Fa=0;var bb;if(!({cY:bb}=T(ya,wa)).returnValue)return u.a.instance.xa(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",wa,ya),{returnValue:!1,length:Fa};for(;bb<ya.length;bb++)if(6!==ya.J(bb).type){if(2===ya.J(bb).type)return{returnValue:!0,length:Fa};u.a.instance.shipAssertTag(17342617,1,ya.J(bb).eca(),"We found something other than text with type "+ya.J(bb).type);u.a.instance.shipAssertTag(17877021,1,ya.J(bb).Vj.equals(wa),
"Unexpected GraphNodeId {0} for ParaId {1}",ya.J(bb).Vj,wa);Fa+=ya.J(bb).length}u.a.instance.xa(18969474,1,4,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",wa,ya);return{returnValue:!1,length:Fa}},ba=ya=>{const wa=new r.a;for(let Fa=0;Fa<ya.length;Fa++)wa.add(ya.J(Fa).clone());return wa};var ha=b(1396),na=b(1357);class da{constructor(ya,wa,Fa=null,bb=null){this.Vj=ya;this.type=wa;this.text=Fa;this.Ob=bb}isEqual(ya){return ya.Vj.equals(this.Vj)&&this.type===ya.type&&this.Ob===ya.Ob&&na.a.MZh(this.text,
ya.text)}toString(){let ya=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.Vj,this.Ob,this.type);this.text&&(ya+=String.format(" [TextLength: {0}]",this.text.length));return ya}}Object(C.a)(da,"MergeBlockValidationState",null,[]);var ia=b(244),ma=b(840),qa=b(779),ka=b(507),va=b(458),ja=b(839),Ma=b(778),Ha=b(1340),X=b(1550),W;(function(ya){ya[ya.base=1]="base";ya[ya.favoredUpdate=2]="favoredUpdate";ya[ya.unfavoredUpdate=4]="unfavoredUpdate";ya[ya.min=1]="min";ya[ya.max=
7]="max"})(W||(W={}));Object(C.b)("MergeBlockSource",W);class fa{constructor(ya,wa,Fa,bb){this.zf=ya;this.cp=wa;this.Eke=Fa;this.e0d=bb}}Object(C.a)(fa,"MergedListBlocksWithUpdatedFormattingIds",null,[]);var ra=b(1393);class Aa extends ra.a{constructor(ya,wa){super(6,ya,wa);this.Ob=0}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Vj)}gFc(){return"Selection"}clone(){return new Aa(this.source,this.Vj)}jD(){return!1}get length(){return 0}}Object(C.a)(Aa,"SelectionMergeBlock",
ra.a,[]);var Ba;(function(ya){ya[ya.success=0]="success";ya[ya.selfSplit=1]="selfSplit";ya[ya.noSecondaryBlockToSplit=2]="noSecondaryBlockToSplit";ya[ya.unexpected=3]="unexpected"})(Ba||(Ba={}));Object(C.b)("SplitTwinListResult",Ba);var ta=b(1444);class xa extends ta.a{constructor(ya,wa,Fa,bb){super(5,ya,wa);this._text=null;this.MUd(Fa);this.frk=bb}get text(){return this._text}MUd(ya){this._text=ya}get E_d(){return this.frk}clone(){return new xa(this.source,this.Vj,this.text,this.E_d)}get pub(){return this.text&&
this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(C.a)(xa,"UpdateHintTextMergeBlock",ta.a,[]);class za{constructor(ya,wa,Fa,bb){this.s$=!1;this.wAb=new k.a;this.Ld=ya;this.fRh=bb;this.eqh=Fa;this._base=wa;this.Jcf=ba(wa);if(!F(this.base,this.ve))throw u.a.instance.xa(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),ya.logger.Fg(Object.assign(new Ha.a,{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get ve(){return this.Jcf}get mergeConflict(){return this.s$}oFf(ya,
wa){switch(ya.type){case 1:return this.BDk(ya,wa);case 2:return this.VEf(ya,wa);case 3:return this.kEk(ya,wa);case 4:return this.SDk(ya);case 5:return this.SCk(ya,wa);case 6:return this.TEf(ya);default:return!1}}nFf(ya,wa){switch(ya.type){case 1:return this.ZEf(ya,wa);case 2:return this.UEf(ya,wa);case 3:return this.jEk(ya,wa);case 4:return this.RDk(ya);case 5:return this.RCk(ya,wa);case 6:return this.SEf(ya);default:return{returnValue:!1,iw:null}}}BDk(ya,wa){let Fa;const bb=({esa:Fa}=this.qYa(ya.zf,
wa,!1,ya.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==bb&&1!==bb)return 3!==bb&&(u.a.instance.xa(590202197,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",W[wa],Ba[bb]),this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.s$=!1;wa=new xa(wa,ya.zf,ya.text,ya.id);this.qkg(ya,Fa,wa);return!0}VEf(ya,wa){let Fa,bb=({esa:Fa}=this.qYa(ya.zf,wa,!1,ya.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;
if(0!==bb&&1!==bb)return 3!==bb&&(u.a.instance.xa(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",W[wa],Ba[bb]),this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let Eb;({esa:Eb,returnValue:bb}=this.qYa(ya.zf,wa,!1,ya.cp+ya.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==bb&&1!==bb)return 3!==bb&&(u.a.instance.xa(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",
W[wa],Ba[bb]),this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),!1;this.s$=!1;this.lVf(ya,Fa,Eb);return!0}kEk(ya,wa){let Fa;const bb=({eig:Fa}=this.Gyi(ya,wa,!1)).returnValue;if(0!==bb&&1!==bb)return 3!==bb&&(u.a.instance.xa(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",W[wa],Ba[bb]),this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),
!1;this.s$=!1;wa=new H.a(wa,ya.Av,ya.oGa);this.qkg(ya,Fa,wa);return!0}SDk(ya){let wa;if(!({dDe:wa}=this.Hyi(ya,this.ve,"Derived")).returnValue)return!1;this.lVf(ya,wa,wa+1);return!0}SCk(ya,wa){let Fa;if(!({Wzg:wa,dig:Fa}=this.dAi(ya,!1,wa)).returnValue)return!1;this.qkg(ya,Fa,wa);return!0}TEf(ya){let wa;if(!({cDe:wa}=this.Ayi(ya,this.ve,"Derived")).returnValue)return!1;this.lVf(ya,wa,wa+1);return!0}aZh(ya,wa,Fa){const bb=({esa:wa}=this.qYa(ya,Fa,!1,wa,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;
if(0!==bb&&1!==bb)return 3!==bb&&(u.a.instance.xa(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",W[Fa],Ba[bb]),this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vz"}))),!1;this.s$=!1;ya=new Aa(Fa,ya);this.ve.insert(wa,ya);return!0}ZEf(ya,wa){var Fa=null;if(za.YQi(ya.text.length))return{returnValue:!1,iw:Fa};let bb,Eb,hb;var nb=({esa:bb,zIa:Eb,Oqa:hb}=this.qYa(ya.zf,wa,!0,ya.cp,!1,
"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==nb&&2!==nb)return 3!==nb&&(u.a.instance.xa(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",W[wa],Ba[nb]),this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,iw:Fa};this.s$=!1;({ora:nb}=V(this.ve,Eb));nb=this.ve.J(nb).Vj;Fa=new xa(wa,ya.zf,ya.text,ya.id);wa=new xa(wa,nb,ya.text,ya.id);Fa.En=wa;wa.En=Fa;
this.base.insert(bb,Fa);this.ve.insert(Eb,wa);Fa=new r.a;Fa.add(new va.a(nb,hb,ya.text,ya.id,ya.$o));return{returnValue:!0,iw:Fa}}UEf(ya,wa){let Fa;Fa=null;if(za.YQi(ya.text.length))return{returnValue:!1,iw:Fa};let bb;var Eb,hb=({esa:bb,zIa:nb,Oqa:Eb}=this.qYa(ya.zf,wa,!0,ya.cp,!1,"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==hb){if(2!==hb)return 3!==hb&&(u.a.instance.xa(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",
W[wa],Ba[hb]),this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,iw:Fa};var nb=0;for({cY:Eb}=T(this.base,ya.zf);Eb<this.base.length&&nb<ya.cp;Eb++)nb+=this.base.J(Eb).length;nb-=this.base.J(Eb-1).length;({zIa:nb,Oqa:Eb,returnValue:hb}=this.qYa(ya.zf,wa,!0,nb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==hb)return 3!==hb&&(u.a.instance.xa(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",
W[wa],Ba[hb]),this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,iw:Fa};this.s$=!1}var Pb,bc;({esa:Pb,zIa:bc,Oqa:gb,returnValue:hb}=this.qYa(ya.zf,wa,!0,ya.cp+ya.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==hb){if(2!==hb)return 3!==hb&&(u.a.instance.xa(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",W[wa],Ba[hb]),this.Ld.logger.Fg(Object.assign(new X.a,
{wj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,iw:Fa};var gb=0;for({cY:bc}=T(this.base,ya.zf);bc<this.base.length&&gb<ya.cp+ya.text.length;bc++)gb+=this.base.J(bc).length;({zIa:bc,Oqa:gb,returnValue:hb}=this.qYa(ya.zf,wa,!0,gb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==hb)return 3!==hb&&(u.a.instance.xa(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",W[wa],Ba[hb]),this.Ld.logger.Fg(Object.assign(new X.a,
{wj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,iw:Fa};this.s$=!1}wa="";Fa=new r.a;for(--bc;bc>=nb;bc--)if(6!==this.ve.J(bc).type)if(this.ve.J(bc).En)wa=this.ve.J(bc).text+wa,this.ve.wI(bc);else{if(5===this.ve.J(bc).type)hb=gb-wa.length;else if(2===this.ve.J(bc).type){if(hb=0,!({length:gb}=R(this.ve,this.ve.J(bc).Vj)).returnValue)return u.a.instance.xa(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),this.Ld.logger.Fg(Object.assign(new X.a,
{wj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,iw:Fa}}else return u.a.instance.xa(589898051,1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,iw:Fa};if(!({ora:Lb}=V(this.ve,bc+1)).returnValue)return u.a.instance.xa(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.Ld.logger.Fg(Object.assign(new X.a,
{wj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,iw:Fa};var Lb=this.ve.J(Lb).Vj;Fa.add(new ka.DeleteTextUpdateHint(Lb,hb,wa));wa=""}for(--Pb;Pb>=bb;Pb--)this.base.wI(Pb);if(!({ora:Lb}=V(this.ve,nb)).returnValue)return u.a.instance.xa(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,iw:Fa};Lb=this.ve.J(Lb).Vj;wa&&wa.length&&Fa.add(new ka.DeleteTextUpdateHint(Lb,
Eb,wa,ya.id,ya.$o));return{returnValue:!0,iw:Fa}}jEk(ya,wa){var Fa=null;let bb,Eb,hb;var nb=({eig:bb,vLi:Eb,Oqa:hb}=this.Gyi(ya,wa,!0)).returnValue;if(0!==nb)return 3!==nb&&(u.a.instance.xa(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",W[wa],Ba[nb]),this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),{returnValue:!1,iw:Fa};var Pb;if(!({ora:Pb}=V(this.ve,Eb)).returnValue)return u.a.instance.xa(17342618,
1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),{returnValue:!1,iw:Fa};nb=this.ve.J(Pb).Vj;const bc=this.ve.J(Pb).Ob;let gb,Lb,Ic;({Av:Pb,bfa:gb,oGa:Lb,cla:Ic}=this.WGl(ya,Pb));this.G5h(this.ve,Pb,gb,Ic,Eb);Fa=new H.a(wa,ya.Av,ya.oGa);wa=new H.a(wa,Pb,Lb);Fa.En=wa;wa.En=Fa;this.base.insert(bb,Fa);this.ve.insert(Eb,wa);Fa=new r.a;Fa.add(new Ma.a(nb,bc,hb,Pb,Lb,gb,Ic,ya.id,ya.$o));return{returnValue:!0,iw:Fa}}RDk(ya){let wa;wa=null;let Fa,bb;var Eb;if(!({dDe:Fa}=
this.Hyi(ya,this.base,"Base")).returnValue)return{returnValue:!1,iw:wa};if(!this.base.J(Fa).En||!({ora:bb}=I(this.ve,this.base.J(Fa).En.Vj,0)).returnValue)return u.a.instance.xa(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc1"})),this.s$=!0,{returnValue:!1,iw:wa};if(!({ora:Eb}=V(this.ve,bb+1)).returnValue)return u.a.instance.xa(17342620,
1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.s$=!0,{returnValue:!1,iw:wa};let hb,nb,Pb,bc,gb,Lb;({jqb:Eb,kqb:Pb,hEg:hb,ozm:bc,Vym:nb,Wym:gb}=this.axl(ya,bb,Eb));if(!({length:Lb}=R(this.ve,Eb)).returnValue)return{returnValue:!1,iw:wa};this.F5h(this.ve,Eb,Pb,bb);this.ve.wI(bb);this.base.wI(Fa);wa=new r.a;wa.add(new ja.MergeParagraphUpdateHint(hb,
bc,Lb,nb,gb,Eb,Pb,ya.id,ya.$o));return{returnValue:!0,iw:wa}}RCk(ya,wa){var Fa=null;let bb,Eb,hb;if(!({Wzg:hb,dig:bb}=this.dAi(ya,!0,wa)).returnValue)return{returnValue:!1,iw:Fa};if(!({NGb:Eb}=this.Rud(this.base,this.ve,bb,!0)).returnValue)return u.a.instance.xa(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),{returnValue:!1,iw:Fa};if(0<Eb&&2!==this.ve.J(Eb-1).type)return u.a.instance.xa(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),
this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.s$=!0,{returnValue:!1,iw:Fa};let nb;if(!({Av:nb}=this.wsi(Eb)).returnValue)return{returnValue:!1,iw:Fa};wa=new H.a(wa,ya.zf,ya.Ob);Fa=hb;Fa.En=wa;wa.En=Fa;this.base.insert(bb,hb);this.ve.insert(Eb,wa);Fa=new r.a;Fa.add(new ma.AddParagraphUpdateHint(ya.zf,ya.Ob,nb,ya.id,ya.$o));return{returnValue:!0,iw:Fa}}SEf(ya){let wa;wa=null;let Fa;var bb;if(!({cDe:bb}=this.Ayi(ya,this.base,"Base")).returnValue)return{returnValue:!1,
iw:wa};if(!this.base.J(bb).En||!this.base.J(bb).En.Vj.equals(ya.zf))return u.a.instance.xa(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),this.s$=!0,{returnValue:!1,iw:wa};if(!({NGb:Fa}=this.Rud(this.base,this.ve,bb,!0)).returnValue)return u.a.instance.xa(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),
{returnValue:!1,iw:wa};if(0<Fa&&2!==this.ve.J(Fa).type)return u.a.instance.xa(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.s$=!0,{returnValue:!1,iw:wa};const Eb=this.ve.J(Fa).Vj,hb=this.ve.J(Fa).Ob;this.ve.wI(Fa);this.base.wI(bb);({Av:bb}=this.wsi(Fa));0<Fa&&6===this.ve.J(Fa-1).type&&this.YRm(Fa-1,bb);wa=new r.a;wa.add(new qa.a(Eb,hb,bb,ya.id,
ya.$o));return{returnValue:!0,iw:wa}}$Yh(ya,wa,Fa){let bb;var Eb=({esa:wa,zIa:bb}=this.qYa(ya,Fa,!0,wa,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==Eb)return 3!==Eb&&(u.a.instance.xa(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",W[Fa],Ba[Eb]),this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({ora:Eb}=V(this.ve,bb));Eb=this.ve.J(Eb).Vj;
ya=new Aa(Fa,ya);Fa=new Aa(Fa,Eb);ya.En=Fa;Fa.En=ya;this.base.insert(wa,ya);this.ve.insert(bb,Fa);return!0}axl(ya,wa,Fa){let bb,Eb,hb;bb=ya.jqb.equals(ya.zf)?this.ve.J(wa).Vj:this.ve.J(Fa).Vj;ya=ya.kqb===ya.Ob?this.ve.J(wa).Ob:this.ve.J(Fa).Ob;Eb=this.ve.J(wa).Vj;wa=this.ve.J(wa).Ob;hb=this.ve.J(Fa).Vj;Fa=this.ve.J(Fa).Ob;return{jqb:bb,kqb:ya,hEg:Eb,ozm:wa,Vym:hb,Wym:Fa}}WGl(ya,wa){let Fa;var bb=ya.zf.equals(ya.Av)?ya.bfa:ya.Av;const Eb=ya.Ob===ya.oGa?ya.cla:ya.oGa;ya.zf.equals(ya.Av)?Fa=this.ve.J(wa).Vj:
(Fa=bb,bb=this.ve.J(wa).Vj);ya.Ob===ya.oGa?(ya=this.ve.J(wa).Ob,wa=Eb):(ya=Eb,wa=this.ve.J(wa).Ob);return{Av:Fa,bfa:bb,oGa:ya,cla:wa}}H5h(ya,wa,Fa,bb){for(;bb<ya.length;bb++){if(!ya.J(bb).eca()&&6!==ya.J(bb).type&&2!==ya.J(bb).type){u.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+ya.J(bb).type);break}ya.J(bb).Vj=wa;if(2===ya.J(bb).type){ya.J(bb).Ob=Fa;break}}}G5h(ya,wa,Fa,bb,Eb){this.H5h(ya,Fa,bb,Eb);za.I5h(ya,wa,Eb)}F5h(ya,wa,Fa,bb){this.H5h(ya,wa,Fa,bb+1);za.I5h(ya,wa,bb)}Hyi(ya,
wa,Fa){let bb,Eb=-1;if(!({ora:bb}=I(wa,ya.zf,0)).returnValue)return u.a.instance.xa(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+Fa+"for GraphNodeId "+ya.zf),{returnValue:!1,dDe:bb};if(!({ora:Eb}=V(wa,bb+1)).returnValue||!wa.J(Eb).Vj.equals(ya.bfa))return u.a.instance.xa(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+bb+1+" in "+Fa+" of length "+wa.length),{returnValue:!1,dDe:bb};this.F5h(wa,ya.jqb,ya.kqb,bb);return{returnValue:!0,dDe:bb}}Gyi(ya,wa,Fa){let bb;
const Eb=Fa?this.base:this.ve,hb=Fa?"Base":"Derived",nb=({esa:wa,zIa:Fa,Oqa:bb}=this.qYa(ya.zf,wa,Fa,ya.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===nb||2===nb)return u.a.instance.xa(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+hb),{returnValue:nb,eig:wa,vLi:Fa,Oqa:bb};this.G5h(Eb,ya.Av,ya.bfa,ya.cla,wa);return{returnValue:nb,eig:wa,vLi:Fa,Oqa:bb}}Ayi(ya,wa,Fa){return({cY:ya}=T(wa,ya.zf)).returnValue?2!==wa.J(ya).type?(u.a.instance.xa(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+
Fa),{returnValue:!1,cDe:-1}):{returnValue:!0,cDe:ya}:(u.a.instance.xa(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+Fa),{returnValue:!1,cDe:-1})}YRm(ya,wa){var Fa=this.ve.J(ya);if(wa){let bb;({ora:bb}=I(this.ve,wa,0));Fa=Fa.clone();Fa.Vj=wa;this.ve.wI(ya);this.ve.insert(bb,Fa)}else this.ve.length>ya&&(this.ve.J(ya+1).eca()||2===this.ve.J(ya+1).type)&&(Fa.Vj=this.ve.J(ya+1).Vj)}dAi(ya,wa,Fa){var bb=wa?this.base:this.ve;wa=wa?"Base":"Derived";Fa=new H.a(Fa,ya.zf,ya.Ob);if(ya.Av){if(!({ora:bb}=
I(bb,ya.Av,0)).returnValue)return u.a.instance.xa(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",ya.Av,wa),{returnValue:!1,Wzg:Fa,dig:bb};bb+=1}else bb=0;return{returnValue:!0,Wzg:Fa,dig:bb}}wsi(ya){let wa;wa=null;let Fa=ya-1;if(-1===Fa)return{returnValue:!0,Av:wa};6===this.ve.J(Fa).type&&Fa--;if(2===this.ve.J(Fa).type||4===this.ve.J(Fa).type)return wa=this.ve.J(Fa).Vj,{returnValue:!0,Av:wa};u.a.instance.xa(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",
this.ve.J(ya-1).type);return{returnValue:!1,Av:wa}}Rud(ya,wa,Fa,bb){let Eb,hb=!0;Eb=-1;if(Fa>ya.length)return u.a.instance.xa(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,NGb:Eb};if(Fa<ya.length){if(-1<Fa&&Fa<ya.length&&!ya.J(Fa).En){hb=!1;for(var nb=Fa+1;nb<ya.length;nb++)if(ya.J(nb).En){Fa=nb;hb=!0;break}}if(!hb)return{returnValue:!1,NGb:Eb};hb=!1;for(nb=0;ya.J(Fa)&&nb<wa.length;nb++)if(wa.J(nb).En===ya.J(Fa)){Eb=nb;hb=!0;break}if(!hb)return{returnValue:!1,
NGb:Eb}}else Eb=wa.length;if(0<Eb&&bb&&!wa.J(Eb-1).En){for(ya=Eb-1;0<=ya&&!wa.J(ya).En;ya--);Eb=ya+1;6===wa.J(Eb).type&&5!==this.Ld.input.source&&Eb++}return{returnValue:!0,NGb:Eb}}qYa(ya,wa,Fa,bb,Eb,hb){let nb;var Pb;let bc;var gb=this.base;let Lb=this.ve,Ic=!1;Fa||(gb=this.ve,Lb=this.base);bc=Pb=nb=0;let vb,xb,Db=0;if(!({Ixd:bb,AJb:vb,OId:xb}=A(gb,ya,bb)).returnValue)return u.a.instance.xa(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),
{returnValue:3,esa:nb,zIa:Pb,Oqa:bc};0<=bb&&bb<gb.length&&!gb.J(bb).En&&vb&&!Eb&&(u.a.instance.xa(17044296,1,3,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",hb),this.s$=!0,Db=wa===gb.J(bb).source?1:2,Ic=!0);Eb&&!gb.J(bb)&&bb--;Eb&&vb&&!gb.J(bb).En&&(vb=!1,xb=0);if(!Fa&&!({cY:ya}=T(Lb,ya)).returnValue&&!vb)return{returnValue:0,esa:bb,zIa:Pb,Oqa:bc};if(!({NGb:ya}=this.Rud(gb,Lb,bb,Fa&&!vb)).returnValue&&!Ic&&(wa=
!1,1===this.fRh&&0<bb&&!xb&&(bb--,{NGb:ya,returnValue:wa}=this.Rud(gb,Lb,bb,Fa&&!vb),wa&&(bb++,ya<Lb.length-1?ya++:wa=!1)),!wa))return u.a.instance.xa(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),this.Ld.logger.Fg(Object.assign(new X.a,{wj:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.s$=!0,{returnValue:3,esa:nb,zIa:Pb,Oqa:bc};if(vb&&(!B(gb,bb,xb)||!Ic&&!B(Lb,ya,xb)))return u.a.instance.shipAssertTag(17044297,
1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,esa:nb,zIa:Pb,Oqa:bc};nb=bb;Pb=ya;vb&&(nb=bb+1,Ic||(Pb=gb.J(bb),Fa=Lb.J(ya),Pb.En=Fa,Fa.En=Pb,gb=gb.J(bb+1),Pb=Lb.J(ya+1),gb.En=Pb,Pb.En=gb,Pb=ya+1));if(Pb>=Lb.length)return u.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+Pb+" secondaryList length was "+Lb.length),{returnValue:3,esa:nb,zIa:Pb,Oqa:bc};
for(gb=0;gb<Pb;gb++)Lb.J(gb).Vj.equals(Lb.J(Pb).Vj)&&(bc+=Lb.J(gb).length);return{returnValue:Db,esa:nb,zIa:Pb,Oqa:bc}}lVf(ya,wa,Fa){this.eqh.contains(ya.id)&&this.wAb.$(ya.id,new r.a);for(--Fa;Fa>=wa;Fa--)this.eqh.contains(ya.id)?this.wAb.J(ya.id).insert(this.wAb.J(ya.id).length,this.ve.J(Fa)):this.ve.J(Fa).En&&(this.ve.J(Fa).En.En=null),this.ve.wI(Fa)}qkg(ya,wa,Fa){if(this.wAb.Na(ya.$o)){const bb=this.wAb.J(ya.$o);for(let Eb=0;Eb<bb.length;Eb++)bb.J(Eb).Vj=Fa.Vj,Object(ia.a)(H.a,Fa)&&Object(ia.a)(H.a,
bb.J(Eb))&&(bb.J(Eb).Ob=Fa.Ob);this.ve.$B(wa,this.wAb.J(ya.$o));this.wAb.remove(ya.$o)}else this.ve.insert(wa,Fa)}iSl(ya){let wa,Fa;Fa=wa=-1;if(!ya.En)return{returnValue:!1,OCc:wa,IVf:Fa};var bb;let Eb=0,hb=!1;if(!({cY:bb}=T(this.ve,ya.En.Vj)).returnValue)return{returnValue:!1,OCc:wa,IVf:Fa};for(;bb<this.ve.length;bb++){if(ya.En===this.ve.J(bb)){wa=bb;Fa=Eb;hb=!0;break}Eb+=this.ve.J(bb).length}return{returnValue:hb,OCc:wa,IVf:Fa}}M1f(ya){let wa;wa=new r.a;let Fa=0,bb=0;for(;Fa<ya.length;){if(bb>=
this.base.length)return u.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,nVc:wa};if(ya.J(Fa).length>this.base.J(bb).length){if(!B(ya,Fa,this.base.J(bb).length))return u.a.instance.xa(17335389,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",Fa,this.base.J(bb).length),{returnValue:!1,nVc:wa}}else if(ya.J(Fa).length<this.base.J(bb).length){var Eb=
!!this.base.J(bb).En,hb=0;if(Eb&&!({NGb:hb}=this.Rud(this.base,this.ve,bb,!1)).returnValue)return u.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",bb),{returnValue:!1,nVc:wa};if(!B(this.base,bb,ya.J(Fa).length)||Eb&&!B(this.ve,hb,ya.J(Fa).length))return u.a.instance.xa(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),
{returnValue:!1,nVc:wa};if(Eb){Eb=this.base.J(bb);var nb=this.ve.J(hb);Eb.En=nb;nb.En=Eb;Eb=this.base.J(bb+1);hb=this.ve.J(hb+1);Eb.En=hb;hb.En=Eb}}if(this.base.J(bb).En&&5!==this.base.J(bb).type&&this.base.J(bb).eca()&&(hb=this.base.J(bb),Eb=ya.J(Fa),!hb.EN.equals(Eb.EN)||!hb.YI.jD(Eb.YI))){let Pb;if(!({OCc:nb,IVf:Pb}=this.iSl(this.base.J(bb))).returnValue)return{returnValue:!1,nVc:wa};wa.add(new fa(this.ve.J(nb).Vj,Pb,hb,Eb))}Fa++;bb++}return{returnValue:!0,nVc:wa}}static I5h(ya,wa,Fa){for(--Fa;0<=
Fa;Fa--){if(!ya.J(Fa).eca()&&6!==ya.J(Fa).type){u.a.instance.shipAssertTag(17311187,1,2===ya.J(Fa).type||4===ya.J(Fa).type,"Found merge block of type "+ya.J(Fa).type);break}ya.J(Fa).Vj=wa}}static YQi(ya){return ya?!1:(u.a.instance.xa(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),!0)}}Object(C.a)(za,"ParagraphMergeUsingHintsTwinList",null,[1834]);var la=b(1548),Sa=b(1549),Pa=b(1545),fb=b(1547),db=b(1546);class Qa{constructor(ya,wa,
Fa,bb){this.cp=ya;this.length=wa;this.Eke=Fa;this.e0d=bb}}Object(C.a)(Qa,"UpdateFormattingIdsPosInfo",null,[]);class wb{constructor(ya,wa,Fa){this.s$=!1;this.wAb=new k.a;this.Ld=ya;this.fRh=Fa;this._base=wa;this.Jcf=ba(wa);if(!F(this.base,this.ve))throw u.a.instance.xa(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),ya.logger.Fg(Object.assign(new J.a,{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get ve(){return this.Jcf}get mergeConflict(){return this.s$}oFf(ya,
wa){switch(ya.type){case 11:return this.zDk(ya,wa);case 8:return this.VEf(ya,wa);case 10:return this.TEf(ya);default:return!1}}nFf(ya,wa){switch(ya.type){case 11:return this.yDk(ya,wa);case 8:return this.UEf(ya,wa);case 10:return this.SEf(ya);default:return{returnValue:!1,iw:null}}}aZh(){u.a.instance.xa(574433295,1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.Ld.logger.Fg(Object.assign(new J.a,{wj:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}$Yh(){u.a.instance.xa(574433296,
1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.Ld.logger.Fg(Object.assign(new J.a,{wj:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}M1f(ya){let wa;wa=new r.a;let Fa=0,bb=0,Eb=0;for(;Fa<ya.length;){if(bb>=this.base.length)return u.a.instance.shipAssertTag(574433297,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.Ld.logger.Fg(Object.assign(new J.a,{wj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),
{returnValue:!1,d0d:wa};if(ya.J(Fa).length>this.base.J(bb).length){if(!B(ya,Fa,this.base.J(bb).length))return u.a.instance.xa(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.Ld.logger.Fg(Object.assign(new J.a,{wj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6s"})),{returnValue:!1,d0d:wa}}else if(ya.J(Fa).length<this.base.J(bb).length&&!this.cub(Eb+ya.J(Fa).length,!0).returnValue)return u.a.instance.xa(574433299,1,2,
"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),this.Ld.logger.Fg(Object.assign(new J.a,{wj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,d0d:wa};if(this.base.J(bb).En&&5!==this.base.J(bb).type&&this.base.J(bb).eca()){const hb=this.base.J(bb),nb=ya.J(Fa);if(!hb.EN.equals(nb.EN)||!hb.YI.jD(nb.YI)){let Pb,bc;if(({OCc:Pb,Xfi:bc}=this.jSl(this.base.J(bb))).returnValue)wa.add(new Qa(bc,this.ve.J(Pb).length,hb,nb));else return u.a.instance.xa(571757956,
1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),this.Ld.logger.Fg(Object.assign(new J.a,{wj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,d0d:wa}}}Eb+=this.base.J(bb).length;Fa++;bb++}return{returnValue:!0,d0d:wa}}zDk(ya,wa){let Fa;if(!({uSa:Fa}=this.cub(ya.cp,!0)).returnValue)return u.a.instance.xa(574433300,1,2,"ApplyInsertTextHintToDerived"),this.Ld.logger.Fg(Object.assign(new J.a,{wj:"ApplyInsertTextHintToDerived",
eventId:"8ps6u"})),!1;for(let Eb=0;Eb<ya.F7.length;Eb++)switch(ya.F7.J(Eb).type){case 7:var bb=ya.F7.J(Eb);this.ve.insert(Fa,new xa(wa,null,bb.text,bb.id));break;case 9:bb=ya.F7.J(Eb);this.ve.insert(Fa,new H.a(wa,bb.zf,bb.Ob));break;default:return u.a.instance.xa(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.Ld.logger.Fg(Object.assign(new J.a,{wj:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}VEf(ya,wa){let Fa,bb;if(!({uSa:Fa}=this.cub(ya.cp,!0)).returnValue||!({uSa:bb}=this.cub(ya.cp+
ya.text.length,!1)).returnValue)return u.a.instance.xa(575706433,1,2,"ApplyDeleteTextHintToDerived"),this.Ld.logger.Fg(Object.assign(new J.a,{wj:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(ya=bb;ya>=Fa;ya--)this.ve.J(ya).source!==wa&&this.Eqe(this.ve,ya);return!0}TEf(ya){let wa;if(!({uSa:wa}=this.cub(ya.cp,!0)).returnValue)return u.a.instance.xa(574433302,1,2,"ApplyDeleteParaHintToDerived"),this.Ld.logger.Fg(Object.assign(new J.a,{wj:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),
!1;this.tVf(this.ve,ya,wa);return!0}yDk(ya,wa){let Fa;Fa=null;let bb,Eb;if(!({w3b:bb,uSa:Eb}=this.cub(ya.cp,!0)).returnValue)return u.a.instance.xa(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.Ld.logger.Fg(Object.assign(new J.a,{wj:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,iw:Fa};var hb=this.g7f(this.ve,Eb-1);hb=new db.a(hb);for(let nb=0;nb<ya.F7.length;nb++)switch(ya.F7.J(nb).type){case 7:hb.F7.add(this.ZEf(ya.F7.J(nb),wa,bb,Eb));break;
case 9:hb.F7.add(this.ADk(ya.F7.J(nb),wa,bb,Eb));break;default:return u.a.instance.xa(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),this.Ld.logger.Fg(Object.assign(new J.a,{wj:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,iw:Fa}}Fa=new r.a;Fa.add(hb);return{returnValue:!0,iw:Fa}}ZEf(ya,wa,Fa,bb){const Eb=new xa(wa,ya.zf,ya.text,ya.id);wa=new xa(wa,ya.zf,ya.text,ya.id);Eb.En=wa;wa.En=Eb;this.base.insert(Fa,Eb);this.ve.insert(bb,wa);Fa=new fb.a(ya.zf,ya.text);Fa.id=ya.id;return Fa}ADk(ya,
wa,Fa,bb){const Eb=new H.a(wa,ya.zf,ya.Ob);wa=new H.a(wa,ya.zf,ya.Ob);Eb.En=wa;wa.En=Eb;this.base.insert(Fa,Eb);this.ve.insert(bb,wa);return new Pa.a(ya.zf,ya.Ob)}UEf(ya){let wa;wa=new r.a;let Fa;var bb;let Eb;if(!({w3b:Fa,uSa:bb}=this.cub(ya.cp,!0)).returnValue||!({w3b:Eb,uSa:hb}=this.cub(ya.cp+ya.text.length,!1)).returnValue)return u.a.instance.xa(588001990,1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.Ld.logger.Fg(Object.assign(new J.a,{wj:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),
{returnValue:!1,iw:wa};for(ya=hb;ya>=bb;ya--)if(this.ve.J(ya).En){var hb=ya;wa.add(({fzm:ya}=this.nkl(ya,bb)).returnValue);this.Eqe(this.ve,ya,hb)}for(bb=Eb;bb>=Fa;bb--)this.Eqe(this.base,bb);return{returnValue:!0,iw:wa}}SEf(ya){let wa;wa=null;let Fa,bb;if(!({w3b:Fa,uSa:bb}=this.cub(ya.cp,!0)).returnValue)return u.a.instance.xa(574433305,1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.Ld.logger.Fg(Object.assign(new J.a,{wj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),{returnValue:!1,iw:wa};
if(!this.tVf(this.base,ya,Fa))return u.a.instance.xa(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),this.Ld.logger.Fg(Object.assign(new J.a,{wj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,iw:wa};this.tVf(this.ve,ya,bb)&&(wa=new r.a,wa.add(new la.a(this.g7f(this.ve,bb-1),ya.zf,ya.Ob)));return{returnValue:!0,iw:wa}}cub(ya,wa){var Fa;var bb=Fa=-1;let Eb,hb;if(!({AJb:hb,K0h:ya,J0h:Eb}=N(this.base,ya,this.Ld.logger)).returnValue)return{returnValue:!1,w3b:Fa,
uSa:bb};const nb=ya>=this.base.length;nb&&ya--;if(this.base.J(ya).En){const Pb=this.Bll(this.ve,this.base.J(ya));if(hb){if(0>Pb||!B(this.base,ya,Eb)||!B(this.ve,Pb,Eb))return u.a.instance.xa(575706444,1,2,"SplitTwinListAndFindIdx"),this.Ld.logger.Fg(Object.assign(new J.a,{wj:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,w3b:Fa,uSa:bb};Fa=this.base.J(ya);bb=this.ve.J(Pb);Fa.En=bb;bb.En=Fa;Fa=this.base.J(ya+1);bb=this.ve.J(Pb+1);Fa.En=bb;bb.En=Fa;Fa=wa?ya+1:ya;bb=wa?Pb+1:Pb}else wa?(Fa=
nb?ya+1:ya,bb=nb?Pb+1:Pb):(Fa=nb?ya:ya-1,bb=nb?Pb:Pb-1)}else if(hb){if(B(this.base,ya,Eb))Fa=wa?ya+1:ya;else return u.a.instance.xa(575706445,1,2,"SplitTwinListAndFindIdx"),this.Ld.logger.Fg(Object.assign(new J.a,{wj:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,w3b:Fa,uSa:bb};wa?(bb=({sac:bb}=this.sEc(this.base,this.ve,ya,!1)).returnValue?bb+1:0,bb=bb>=this.ve.length?this.ve.length-1:bb):(bb=({sac:bb}=this.sEc(this.base,this.ve,ya,!0)).returnValue?bb-1:this.ve.length-1,bb=0>bb?0:bb)}else wa?
(({sac:bb}=this.sEc(this.base,this.ve,ya,!0)).returnValue||(({sac:bb}=this.sEc(this.base,this.ve,ya,!1)).returnValue?bb+=1:(bb=nb?this.ve.length-1:0,bb=0>bb?0:bb)),Fa=nb?ya+1:ya):(({sac:bb}=this.sEc(this.base,this.ve,ya,!1)).returnValue||(({sac:bb}=this.sEc(this.base,this.ve,ya,!0)).returnValue?--bb:(bb=ya?this.ve.length-1:0,bb=0>bb?0:bb)),Fa=nb?ya:ya-1);return{returnValue:!0,w3b:Fa,uSa:bb}}sEc(ya,wa,Fa,bb){let Eb=null;if(bb)for(;Fa<ya.length;Fa++){if(ya.J(Fa).En){Eb=ya.J(Fa).En;break}}else for(;0<=
Fa;Fa--)if(ya.J(Fa).En){Eb=ya.J(Fa).En;break}if(Eb)for(ya=0;ya<wa.length;ya++)if(wa.J(ya)===Eb)return wa=ya,{returnValue:!0,sac:wa};return{returnValue:!1,sac:-1}}Bll(ya,wa){for(let Fa=0;Fa<ya.length;Fa++)if(ya.J(Fa).En===wa)return Fa;return-1}Eqe(ya,wa,Fa=-1){for(Fa=0>Fa?wa:Fa;Fa>=wa;Fa--)ya.J(Fa).En&&(ya.J(Fa).En.En=null),ya.wI(Fa)}g7f(ya,wa){let Fa=0;for(;0<=wa;wa--)Fa+=ya.J(wa).length;return Fa}OQl(ya){ya=Object(m.a)(ta.a,ya);ya||(u.a.instance.xa(575706448,1,2,"GetTextBlock"),this.Ld.logger.Fg(Object.assign(new J.a,
{wj:"GetTextBlock",eventId:"8ujvq"})));return ya}nkl(ya,wa){let Fa="";for(;ya>=wa&&this.ve.J(ya).En&&2!==this.ve.J(ya).type;)Fa=this.OQl(this.ve.J(ya)).text+Fa,ya--;wa=0>ya?0:this.g7f(this.ve,ya);ya+=1;return{returnValue:new Sa.a(wa,Fa),fzm:ya}}jSl(ya){let wa,Fa,bb=!1;Fa=wa=0;if(!ya.En)return{returnValue:!1,OCc:wa,Xfi:Fa};for(wa=0;wa<this.ve.length;wa++){if(this.ve.J(wa).En===ya){bb=!0;break}Fa+=this.ve.J(wa).length}return{returnValue:bb,OCc:wa,Xfi:Fa}}tVf(ya,wa,Fa){Fa=Fa===ya.length?--Fa:Fa;Fa>ya.length-
1&&(u.a.instance.xa(571757957,1,2,"DeleteEopInList: Idx out of range"),this.Ld.logger.Fg(Object.assign(new J.a,{wj:"DeleteEopInList",eventId:"8ffwf"})));if(2===ya.J(Fa).type){const bb=ya.J(Fa);if(bb.Vj!==wa.zf||bb.Ob!==wa.Ob)return!1;this.Eqe(ya,Fa);return!0}return!1}}Object(C.a)(wb,"ParagraphMergeUsingHintsTwinListLcs",null,[1834]);var ib=b(1377),Ta=b(1341),jb=b(1544);b.d(L,"a",function(){return $a});class $a{constructor(ya,wa,Fa,bb,Eb,hb,nb=null,Pb=null,bc=null){this.yW=this.iGa=this.$_a=this.vEa=
null;this._initialized=!1;this.Ld=ya;this.nJ=wa;this.nQa=bb;this.yNa=Fa;this.XEa=Eb;this.T9e=new c.a;for(ya=0;ya<this.nJ.length;ya++)this.T9e.add(this.nJ.J(ya).id);this.Qvh=new c.a;for(ya=0;ya<this.yNa.length;ya++)this.Qvh.add(this.yNa.J(ya).id);this.WQh=new c.a;for(ya=0;ya<this.nQa.length;ya++)this.WQh.add(this.nQa.J(ya).id);this.Mg=hb;this.yyf=nb||G.a.instance;this.UM=Pb;this.Z2=bc;this.eWb=1===(this.UM&&this.Z2&&1===this.UM.AZa&&1===this.Z2.AZa?1:0);this.WEa=0}get FXg(){return 1!==this.WEa}s4l(){var ya=
!0;if(this.UM&&this.Z2)return ya;if(this.UM||this.Z2)return u.a.instance.xa(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),!1;this.Ld.runtime.Zu.Na(w.a.DO)&&(ya=this.Ld.runtime.Zu.J(w.a.DO),ya=this.lgh(ya,this.Ld.runtime.MRa.id,"favored")&&({updateHints:this.UM}=this.dNi(ya,this.T9e,this.Qvh,this.Ld.runtime.Zu,"favored")).returnValue);ya&&this.Ld.runtime.Kr.Na(w.a.DO)&&
(ya=this.Ld.runtime.Kr.J(w.a.DO),ya=this.lgh(ya,this.Ld.runtime.MRa.id,"unfavored")&&({updateHints:this.Z2}=this.dNi(ya,this.T9e,this.WQh,this.Ld.runtime.Kr,"unfavored")).returnValue);this.UM=this.UM?this.UM:new jb.a(new r.a,0);this.Z2=this.Z2?this.Z2:new jb.a(new r.a,0);ya&&this.Ld.input.mIc&&(ya=this.Ld.input.nda.last().Wlb(w.a.DO),ya=this.lgh(ya,this.Ld.input.nda.last().uaa.id,"alreadyMerged"));return ya}U2l(){const ya=new c.a;if(this.eWb)return ya;const wa=this.UM?this.UM.updateHints.I8():new r.a;
let Fa=0;for(;Fa<wa.length-1;){const bb=wa.J(Fa);let Eb,hb=!1;for(Eb=Fa+1;Eb<wa.length;Eb++){const nb=wa.J(Eb);if(bb.vpg(nb)){ya.add(bb.id);wa.wI(Eb);wa.wI(Fa);hb=!0;break}}hb||Fa++}return ya}lgh(ya,wa,Fa){ya=this.Mg.getPropertyString(ya,f.a.CZa);ya=t.a.qe(ya);return wa.equals(ya)?!0:(this.hUd(2),u.a.instance.xa(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",this.Ld.runtime.MRa.id,
ya,Fa),!1)}dNi(ya,wa,Fa,bb,Eb){let hb;hb=new jb.a(new r.a,0);ya=this.Mg.getPropertyObjectIds(ya,f.a.D5).I8();for(let Pb=0;Pb<ya.length;Pb++){if(!bb.Na(ya.J(Pb)))return u.a.instance.xa(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",ya.J(Pb),Eb),{returnValue:!1,updateHints:hb};const bc=bb.J(ya.J(Pb));var nb=t.a.qe(this.Mg.getPropertyString(bc,f.a.E5));if(wa.contains(nb)||Fa.contains(nb)){nb=this.yyf.$wd(bc);
if(!nb)return u.a.instance.xa(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",bc.id,Eb),{returnValue:!1,updateHints:hb};hb.updateHints.add(nb)}}0<ya.length&&u.a.instance.xa(17162308,1,4,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",Eb,ya.Dr(),hb.updateHints.Dr());return{returnValue:!0,updateHints:hb}}K3l(){return({mP:this.vEa,
ird:this.$_a,a_d:this.iGa}=ib.a.Cci(this.Ld,this.Mg,this.nJ,this.yNa,this.nQa,this.XEa,!0,!0)).returnValue?!0:!1}p4l(ya){const wa=ib.a.wpe(this.Mg,Fa=>this.Ld.runtime.pk.J(Fa),this.nJ,1,this.XEa,!0,!0).returnValue;if(!wa)return u.a.instance.xa(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.yW=this.eWb?new wb(this.Ld,wa,1):new za(this.Ld,wa,ya,this.UM?this.UM.AZa:0);return!0}initialize(){if(this._initialized)return!1;this._initialized=!0;
if(!this.s4l()||!this.K3l())return!1;const ya=this.U2l();return this.p4l(ya)?!0:!1}fAi(ya){const wa=new r.a;let Fa="";for(let bb=0;bb<ya.length;bb++){const Eb=ya.J(bb);Eb.eca()?Fa+=ya.J(bb).text:2===Eb.type?(wa.add(new da(Eb.Vj,Eb.type,Fa,Eb.Ob)),Fa=""):4===Eb.type&&(wa.add(new da(Eb.Vj,Eb.type)),Fa="")}return wa}validateUpdateHintsAreComplete(ya,wa,Fa){wa=this.fAi(wa);ya=this.fAi(ya);let bb=wa.length===ya.length;if(bb)for(let Eb=0;Eb<wa.length;Eb++)if(!wa.J(Eb).isEqual(ya.J(Eb))){bb=!1;break}bb||
(this.hUd(4),u.a.instance.xa(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",Fa,ya.Dr(),wa.Dr()));return bb}AZh(ya,wa,Fa){(wa=({Ivb:ya}=this.DEk(ya,wa,Fa)).returnValue)||this.hUd(this.yW.mergeConflict?1:3);return{returnValue:wa,Ivb:ya}}DEk(ya,wa,Fa){let bb;bb=new r.a;let Eb=!0;var hb=0;let nb=null,Pb=this.UM?this.UM.updateHints.length:0;for(var bc=0;bc<Pb&&Eb;bc++)nb=this.UM.updateHints.J(bc),
hb<this.Z2.updateHints.length&&nb.id.equals(this.Z2.updateHints.J(hb).id)&&5!==this.Ld.input.source?({returnValue:Eb}=this.yW.nFf(nb,2),hb++):Eb=this.yW.oFf(nb,2);if(!Eb)return u.a.instance.xa(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",nb.toString()),{returnValue:!1,Ivb:bb};if(!this.validateUpdateHintsAreComplete(this.yW.ve,this.$_a,"Favored"))return{returnValue:!1,Ivb:bb};if(ya&&1===this.Ld.input.rca&&!this.yW.aZh(wa,Fa,2))return u.a.instance.xa(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",
wa,Fa),{returnValue:!1,Ivb:bb};Eb=!0;bc=new r.a;for(Pb=this.Z2?this.Z2.updateHints.length:0;hb<Pb&&Eb;hb++){nb=this.Z2.updateHints.J(hb);let gb;({iw:gb,returnValue:Eb}=this.yW.nFf(nb,4));Eb&&gb&&bc.$B(bc.length,gb)}return Eb?this.validateUpdateHintsAreComplete(this.yW.base,this.iGa,"Unfavored")?ya&&2===this.Ld.input.rca&&!this.yW.$Yh(wa,Fa,4)?(u.a.instance.xa(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",wa,Fa),{returnValue:!1,Ivb:bb}):{returnValue:!0,
Ivb:bc}:{returnValue:!1,Ivb:bb}:(u.a.instance.xa(17044291,1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",nb.id,nb.type),{returnValue:!1,Ivb:bb})}OFl(){let ya,wa=0;let Fa=0,bb=t.a.nil;for(ya=new k.a;Fa<this.yW.base.length;){const nb=this.yW.base.J(Fa);bb.equals(nb.Vj)||(wa=0,bb=nb.Vj);if(5===nb.type){var Eb=wa+nb.length;var hb=void 0;let Pb;const bc=ba(this.iGa);if(!({index:hb}=E(bc,nb.Vj,wa)).returnValue||!({index:Pb}=E(bc,nb.Vj,Eb)).returnValue)return u.a.instance.xa(17335384,
1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",nb.E_d),{returnValue:!1,$3i:ya};for(Eb=new r.a;hb<Pb;hb++)Eb.add(bc.J(hb));ya.$(nb.E_d,Eb)}wa+=nb.length;Fa++}return{returnValue:!0,$3i:ya}}PFl(){let ya;ya=new k.a;let wa=0;for(let bb=0;bb<this.yW.base.length;bb++){const Eb=this.yW.base.J(bb);if(5===Eb.type){var Fa=void 0;let hb;const nb=ba(this.iGa);if(!({index:Fa}=P(nb,wa,this.Ld.logger)).returnValue||!({index:hb}=
P(nb,wa+Eb.length,this.Ld.logger)).returnValue)return u.a.instance.xa(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),{returnValue:!1,a4i:ya};const Pb=new r.a;for(;Fa<hb;Fa++)Pb.add(nb.J(Fa));ya.$(Eb.E_d,Pb)}wa+=Eb.length}return{returnValue:!0,a4i:ya}}TDk(ya){let wa;wa=new r.a;let Fa;if(this.eWb){if(!({a4i:Fa}=this.PFl()).returnValue)return{returnValue:!1,fId:wa}}else if(!({$3i:Fa}=this.OFl()).returnValue)return{returnValue:!1,fId:wa};let bb;bb=this.eWb?
new wb(this.Ld,ba(this.$_a),1):new za(this.Ld,ba(this.$_a),new c.a,this.UM?this.UM.AZa:0);for(var Eb=0;Eb<ya.length;Eb++)if(!bb.oFf(ya.J(Eb),4))return{returnValue:!1,fId:wa};for(ya=bb.ve.length-1;0<=ya;ya--)5===bb.ve.J(ya).type&&(Eb=bb.ve.J(ya).E_d,bb.ve.wI(ya),bb.ve.$B(ya,Fa.J(Eb)));this.eWb&&(this.Kei(bb.ve),this.Kei(this.yW.ve));if(!this.validateUpdateHintsAreComplete(this.yW.ve,bb.ve,"Merged"))return{returnValue:!1,fId:wa};wa=bb.ve;return{returnValue:!0,fId:wa}}Kei(ya){const wa=new k.a;for(let Fa=
ya.length-1;0<=Fa;Fa--){const bb=Object(m.a)(H.a,ya.J(Fa));bb&&(wa.Na(bb.Ob)?wa.J(bb.Ob).source!==bb.source&&ya.wI(Fa):wa.add(bb.Ob,bb))}}CEk(ya){let wa;if(!({d0d:wa}=this.yW.M1f(ba(this.iGa))).returnValue)return!1;for(let bb=0;bb<wa.length;bb++){const Eb=wa.J(bb);let hb,nb;if(!({index:hb}=P(ya,Eb.cp,this.Ld.logger)).returnValue||!({index:nb}=P(ya,Eb.cp+Eb.length,this.Ld.logger)).returnValue)return u.a.instance.xa(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.Ld.logger.Fg(Object.assign(new J.a,
{wj:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var Fa=!1;for(let Pb=hb;Pb<nb&&!Fa;Pb++)Fa=!Eb.Eke.EN.equals(ya.J(Pb).EN);if(!Fa){for(Fa=hb;Fa<nb;Fa++)ya.wI(hb);ya.insert(hb,Eb.e0d)}}return!0}BEk(ya){let wa;if(!({nVc:wa}=this.yW.M1f(ba(this.iGa))).returnValue)return!1;for(let Eb=0;Eb<wa.length;Eb++){var Fa=wa.J(Eb);let hb,nb;if(({index:hb}=E(ya,Fa.zf,Fa.cp)).returnValue&&({index:nb}=E(ya,Fa.zf,Fa.cp+Fa.e0d.length)).returnValue){var bb=!1;for(let Pb=hb;Pb<nb&&!bb;Pb++)bb=!Fa.Eke.EN.equals(ya.J(Pb).EN)||
!Fa.Eke.YI.jD(ya.J(Pb).YI);if(bb){if(this.UM&&1===this.UM.AZa||this.Z2&&1===this.Z2.AZa)return!1}else{for(bb=hb;bb<nb;bb++)ya.wI(hb);ya.insert(hb,Fa.e0d)}}else if(Fa=Fa.e0d.m8l,u.a.instance.xa(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",Fa),Fa||this.UM&&1===this.UM.AZa||this.Z2&&1===this.Z2.AZa)return!1}return!0}SJl(ya){let wa,Fa;Fa=new r.a;wa=this.Ld.runtime.zm.J(w.a.DO);let bb;({jAg:bb}=$a.Usi(this.Ld,
this.Mg));const Eb=new r.a;for(let nb=0;nb<ya.length;nb++){if(bb.contains(ya.J(nb).id,(bc,gb)=>bc.equals(gb)))continue;if(this.Ld.runtime.zm.Na(ya.J(nb).id))return u.a.instance.shipAssertTag(17044293,1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",ya.J(nb).id),{returnValue:!1,zQe:wa,yQe:Fa};Eb.add(ya.J(nb).id);var hb=ya.J(nb).JTa();const Pb=new Ta.a(hb);hb=hb.Dh();for(const bc of hb)Pb.wF(bc);Fa.add(Pb)}ya=this.Mg.getPropertyObjectIds(wa.Wj,f.a.D5);ya.$B(ya.length,Eb);this.Mg.setPropertyObjectIds(wa.Wj,
f.a.D5,ya);return{returnValue:!0,zQe:wa,yQe:Fa}}axe(ya){return String.format("Name: {0}, Message: {1}, Stack: {2}",ya.name,ya.message,ya.stack)}hUd(ya){0===this.WEa&&(this.WEa=ya)}WUc(){let ya;ya=null;let wa,Fa;var bb;try{if({zm:ya,zQe:wa,yQe:Fa,returnValue:bb}=this.fHn(),bb){if(wa&&Fa){this.Ld.runtime.zm.$(wa.Wj.id,wa);for(bb=0;bb<Fa.length;bb++){const Pb=Fa.J(bb);this.Ld.runtime.zm.$(Pb.Wj.id,Pb)}const Eb=wa.Wj,hb=this.Mg.getPropertyObjectIds(Eb,f.a.D5),nb=this.Mg.getPropertyString(Eb,f.a.CZa);
u.a.instance.xa(17162312,1,4,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",hb.Dr(),nb)}else u.a.instance.xa(593826831,1,4,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,zm:ya}}}catch(Eb){u.a.instance.xa(17162313,1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.axe(Eb))}this.hUd(5);u.a.instance.xa(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",
this.WEa,this.FXg);this.Qpb();this.UM&&1===this.UM.AZa&&this.Ld.logger.Fg(Object.assign(new ha.a,{eventId:"bc04c",wj:"ParagraphMergeUsingHints.TryDoMerge",info:l[this.WEa]+"/LCS"}));return{returnValue:!1,zm:ya}}fHn(){let ya,wa,Fa;Fa=wa=ya=null;let bb;bb=this.initialize();this.Ld.logger.A0("PMUH Initialize");let Eb=null;bb=bb&&({Ivb:Eb}=this.AZh(!1,t.a.nil,0)).returnValue;this.Ld.logger.A0("PMUH ApplyUpdateHints");let hb=new r.a;bb=bb&&({fId:hb}=this.TDk(Eb)).returnValue;this.Ld.logger.A0("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");
bb=this.eWb?bb&&this.CEk(hb):bb&&this.BEk(hb);this.Ld.logger.A0("PMUH ApplyUnfavoredFormattingChanges");this.eWb&&!this.Gcn(hb)&&(u.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.Ld.logger.Fg(Object.assign(new J.a,{wj:"ReuseParaIdsIfPossible",eventId:"8ettb"})),bb=!1);const nb=this.Iye(hb);bb=bb&&({xQe:ya}=ib.a.nvd(this.Ld,this.Mg,this.XEa,hb,nb)).returnValue;this.Ld.logger.A0("PMUH GetMergeableObjectsFromMergeBlocks");this.UM&&1===this.UM.AZa&&this.Z2&&1===this.Z2.AZa||(bb=
bb&&({zQe:wa,yQe:Fa}=this.SJl(D(Eb))).returnValue,this.Ld.logger.A0("PMUH GetPartialMergeResultForUpdateHintNodes"));return{returnValue:bb,mergeConflict:!!this.yW&&this.yW.mergeConflict,zm:ya,zQe:wa,yQe:Fa}}Iye(ya){const wa=new r.a;for(let Fa=0;Fa<ya.length;Fa++)2===ya.J(Fa).type&&wa.add(ya.J(Fa).Vj);return wa}f8f(ya){const wa=new r.a;for(let Fa=0;Fa<ya.length;Fa++)2===ya.J(Fa).type&&wa.add(ya.J(Fa));return wa}Gcn(ya){var wa=this.f8f(this.vEa),Fa=this.f8f(this.$_a),bb=this.f8f(this.iGa),Eb=this.Iye(wa),
hb=this.Iye(Fa),nb=this.Iye(bb);hb=M.b(Eb,hb,nb);Eb=new r.a;for(nb=0;nb<hb.length;nb++)Eb.$B(Eb.length,hb.J(nb).Dll());hb=this.Hll(ya);wa=this.Ell(hb,Eb,wa,Fa,bb);Fa=0;bb=new c.a;for(Eb=0;Eb<ya.length;Eb++)if(hb=ya.J(Eb),2===hb.type)if(bb.contains(hb.Vj))if(Fa<wa.length)ya.wI(Eb),ya.insert(Eb,wa.J(Fa)),Fa++;else return!1;else bb.add(hb.Vj);0<ya.length&&2!==ya.J(ya.length-1).type&&Fa<wa.length&&ya.insert(ya.length,wa.J(Fa));return!0}Hll(ya){const wa=new c.a;for(let Fa=0;Fa<ya.length;Fa++)2===ya.J(Fa).type&&
wa.add(ya.J(Fa).Vj);return wa}Ell(ya,wa,Fa,bb,Eb){const hb=new r.a;for(let nb=0;nb<wa.length;nb++){const Pb=wa.J(nb);if(!ya.contains(Pb)){let bc;(({block:bc}=this.E1f(bb,Pb)).returnValue||({block:bc}=this.E1f(Eb,Pb)).returnValue||({block:bc}=this.E1f(Fa,Pb)).returnValue)&&bc&&hb.add(bc)}}return hb}E1f(ya,wa){for(let Fa=0;Fa<ya.length;Fa++)if(2===ya.J(Fa).type&&ya.J(Fa).Vj===wa)return ya=ya.J(Fa),{returnValue:!0,block:ya};return{returnValue:!1,block:null}}Qpb(){const ya=new r.a;ib.a.aMc(this.Mg,"BaseObjects_",
this.nJ,ya);ib.a.aMc(this.Mg,"FavoredObjects_",this.yNa,ya);ib.a.aMc(this.Mg,"ConflictObjects_",this.nQa,ya)}ZMk(){let ya,wa;ya=t.a.nil;wa=-1;let Fa=0;for(let bb=0;bb<this.yW.ve.length;bb++){const Eb=this.yW.ve.J(bb);if(Eb.eca())Fa+=Eb.length;else if(6!==Eb.type)Fa=0;else return ya=Eb.Vj,wa=Fa,{returnValue:!0,objectId:ya,cp:wa}}u.a.instance.xa(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:ya,cp:wa}}v_d(ya,wa){let Fa,bb;bb=wa;Fa=ya;try{let Eb=
this.initialize();if(Eb=(Eb=Eb&&this.AZh(!0,ya,wa).returnValue)&&({objectId:Fa,cp:bb}=this.ZMk()).returnValue)return u.a.instance.xa(17409924,1,4,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",Fa,bb),{returnValue:!0,Bsb:Fa,KCa:bb}}catch(Eb){u.a.instance.xa(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.axe(Eb))}this.hUd(5);u.a.instance.xa(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",
this.WEa,this.FXg);this.Qpb();return{returnValue:!1,Bsb:Fa,KCa:bb}}static Usi(ya,wa){let Fa;Fa=new r.a;if(!ya.input.mIc)return{returnValue:!0,jAg:Fa};ya=ya.input.nda.last().Wlb(w.a.DO);Fa=wa.getPropertyObjectIds(ya,f.a.D5);return{returnValue:!0,jAg:Fa}}static ySm(ya){if(!ib.a.aYf(ya))return!0;const wa=new x.a;ya.runtime.zm.$(w.a.DO,ib.a.t4l(ya,wa));return!0}static hSm(ya){if(!ya.runtime.zm.Na(w.a.DO)||!ya.runtime.Kr.Na(w.a.DO))return!0;const wa=new x.a,Fa=ya.runtime.zm.J(w.a.DO);var bb=wa.getPropertyString(Fa.Wj,
f.a.CZa);if(t.a.qe(bb).equals(t.a.nil))return!0;bb=wa.getPropertyObjectIds(Fa.Wj,f.a.D5);const Eb=wa.getPropertyObjectIds(ya.runtime.Kr.J(w.a.DO),f.a.D5);let hb;({jAg:hb}=$a.Usi(ya,wa));for(let nb=0;nb<Eb.length;nb++)bb.contains(Eb.J(nb),(Pb,bc)=>Pb.equals(bc))||hb.contains(Eb.J(nb),(Pb,bc)=>Pb.equals(bc))||(bb.add(Eb.J(nb)),ya.runtime.zm.$(Eb.J(nb),new Ta.a(ya.runtime.Kr.J(Eb.J(nb)).AF())));wa.setPropertyObjectIds(Fa.Wj,f.a.D5,bb);return!0}}Object(C.a)($a,"ParagraphMergeUsingHints",null,[1780])},
1462:function(C,L,b){C=b(0);class f{constructor(m){this.u6i=m;this.succeeded=!1;this.PUc=m?m.PUc:0;this.tgm=!1;this.length=this.lCn=0}}Object(C.a)(f,"TrieResult",null,[]);class c{constructor(m,l,x){this.bJb=new f(null);this.Fsm=m;this.xHd=l;this.U1i=l+x-1}get result(){return this.bJb}yAi(){let m;return this.xHd<=this.U1i?(m=this.Fsm.charAt(this.xHd),++this.xHd,{returnValue:!0,ch:m}):{returnValue:!1,ch:"\x00"}}ETg(m,l,x){m&&(this.bJb.tgm=!0,this.bJb.lCn=l);this.bJb.length=this.xHd;this.bJb.succeeded=
!0;this.bJb.PUc=x;this.xHd!==this.U1i+1&&(this.bJb=new f(this.bJb))}}Object(C.a)(c,"LookUpStringVisitor",null,[1188]);var u=b(1561);class r{constructor(){this.k5h=this.Y2h=this.$2h=this.X2h=this.Z2h=this.uJf=this.tJf=this.wJf=this.sJf=0}}Object(C.a)(r,"TRIESTATS",null,[]);class t{constructor(){this.symbol=this.kJd=0}}Object(C.a)(t,"TrieSymbol",null,[]);b.d(L,"a",function(){return k});class k{constructor(m,l){this.oca=null;this.MKe=this.i2i=this.g2i=this.k2i=this.c2i=this.j2i=this.h2i=this.l2i=this.d2i=
0;this.cO=m;if(m.hB(l,4)!==k.S3b)throw Error.argument("Input does not represent a trie");l+=4;this.W1i=1===m.hB(l,4);l+=4;this.Csm=1===m.hB(l,4);l+=4;this.ysm=m.hB(l,4);l+=4;if(m.hB(l,4)){m=l+4;this.oca=this.j_m(m);this.d2i=l=m+k.ILk;this.l2i=l+=k.xle*(this.oca.sJf+(this.oca.sJf%2?1:0));this.h2i=l+=k.xle*(this.oca.wJf+(this.oca.wJf%2?1:0));this.j2i=l+=k.xle*(this.oca.tJf+(this.oca.tJf%2?1:0));this.c2i=l+=k.xle*(this.oca.uJf+(this.oca.uJf%2?1:0));this.k2i=l+=k.yJf*this.oca.X2h;this.g2i=l+=k.zJf*this.oca.$2h;
this.i2i=l+=k.zJf*this.oca.Y2h;l+=k.zJf*this.oca.Z2h;if(l!==m+this.oca.k5h)throw Error.argument("Corrupted trie binary");this.MKe=l}else this.oca=null}D1i(m,l,x,w){m=new c(m,l,x);this.jSj(m,w);return m.result}uEi(m){if(this.W1i)if(m)--m;else return"";if(!this.oca)throw Error.argument("Invalid trieID");const l=new u.a;l.lJ=0;this.doc(l);const x=[];for(;;){if(l.lJ&k.Cwb)if(m)--m;else return Array.add(x,l.spc),String.fromCharCode.apply(null,x);const w=!!(l.lJ&k.m7e),G=this.zFc(l,!0);if(w||m<G){if(Array.add(x,
l.spc),!this.doc(l))throw Error.argument("Invalid trieID");}else if(m-=G,!this.fZd(l))throw Error.argument("Invalid trieID");}}jSj(m,l){let x=0;this.W1i&&(m.ETg(this.Csm,this.ysm,0),++x);if(this.oca){var w=new u.a;w.lJ=0;if(this.doc(w))for(;;){var G=void 0;if(!({ch:G}=m.yAi()).returnValue)break;l&&(G=l(G));G=G.toString().charCodeAt(0);let D=!1;for(;!D;){const H=!!(w.lJ&k.Cwb);if(w.spc===G){if(D=!0,H&&m.ETg(!!(w.lJ&k.smh),w.Z0e,x),!this.doc(w))return}else if(x+=this.zFc(w,!0),!this.fZd(w))return;H&&
++x}}}}doc(m){if(!m.lJ)return this.$ah(m),!0;if(!(m.lJ&k.l7e))return!1;m.r5a=0;m.Xz=m.MGb;this.$ah(m);return!0}fZd(m){if(m.lJ&k.m7e)return!1;this.$ah(m);return!0}zFc(m,l){return m.lJ&k.rmh?m.wle:m.lJ&k.l7e?!l&&m.lJ&k.m7e?this.vwl(m):1:0}vwl(m){m=k.OMf(m);if(!this.doc(m))return 0;let l=0;do m.lJ&k.Cwb&&++l,l+=this.zFc(m,!1);while(this.fZd(m));return l}$ah(m){m.lJ||(m.r5a=0,m.Xz=this.MKe);var l=this.mqe(this.d2i,m.Xz),x=l.symbol;m.Xz+=l.kJd;l=this.cO.hB(this.c2i+k.yJf*x,k.yJf);m.spc=l&65535;m.lJ=l>>
16;m.lJ&k.rmh&&(m.wle=this.b7k(m));m.lJ&k.smh&&(l=this.mqe(this.l2i,m.Xz),x=l.symbol,m.Xz+=l.kJd,m.Z0e=this.cO.hB(this.k2i+4*x,4));m.lJ&k.f0j?(m.MGb=this.MKe+((this.cO.J(m.Xz)<<8|this.cO.J(m.Xz+1))<<8|this.cO.J(m.Xz+2)),m.Xz+=3):m.lJ&k.g0j?(m.MGb=m.Xz,m.r5a=m.MGb):m.lJ&k.h0j?(l=this.mqe(this.h2i,m.Xz),x=l.symbol,m.Xz+=l.kJd,m.MGb=this.MKe+this.cO.hB(this.g2i+4*x,4)):m.lJ&k.l7e&&(l=this.mqe(this.j2i,m.Xz),x=l.symbol,m.Xz+=l.kJd,m.r5a||(m.r5a=m.Xz),m.r5a+=this.cO.hB(this.i2i+4*x,4),m.MGb=m.r5a)}mqe(m,
l){const x=new t;let w=0;for(;;){w+=this.cO.J(l);++l;++x.kJd;const G=this.cO.hB(m,2);if(w<G)break;x.symbol+=G;w-=G;m+=2;w<<=8}x.symbol+=w;return x}b7k(m){let l=this.cO.J(m.Xz);192<=l?(l=(l&63)<<15|(this.cO.J(m.Xz+1)&127)<<8,l|=this.cO.J(m.Xz+2),m.Xz+=3):128<=l?(l=(l&127)<<8|this.cO.J(m.Xz+1),m.Xz+=2):m.Xz+=1;return l}j_m(m){const l=new r;l.sJf=this.cO.hB(m+12,2);l.wJf=this.cO.hB(m+14,2);l.tJf=this.cO.hB(m+16,2);l.uJf=this.cO.hB(m+18,2);l.Z2h=this.cO.hB(m+24,4);l.X2h=this.cO.hB(m+28,4);l.$2h=this.cO.hB(m+
32,4);l.Y2h=this.cO.hB(m+36,4);l.k5h=this.cO.hB(m+40,4);return l}static OMf(m){const l=new u.a;l.spc=m.spc;l.lJ=m.lJ;l.wle=m.wle;l.Xz=m.Xz;l.MGb=m.MGb;l.r5a=m.r5a;l.Z0e=m.Z0e;return l}}k.S3b=1654263084;k.ILk=48;k.xle=2;k.zJf=4;k.yJf=4;k.Cwb=1;k.m7e=2;k.rmh=4;k.smh=8;k.l7e=16;k.g0j=64;k.h0j=128;k.f0j=256;Object(C.a)(k,"Trie",null,[1186])},1465:function(C,L,b){b.r(L);C=b(0);b(1299);var f=b(1322),c=b(1295),u=b(2),r=b(81),t=b(13);class k{constructor(){this.Fvf=0}bOd(H){this.Fvf=window.performance.now();
this.qia(()=>{const M=window.performance.now(),J={};!u.AFrameworkApplication.K.ea("AppsForOfficeThirdPartyIsDisabled")&&u.AFrameworkApplication.K.ea("AppsForOfficeAllowExternalMarketplace")&&u.AFrameworkApplication.j3b&&(J.callback=F=>{H(F,OSF.StoreTypeEnum.MarketPlace,M)},u.AFrameworkApplication.pa.ob(t.a.Hrb,2,J));u.AFrameworkApplication.K.ea("AppsForOfficePrivateCatalogIsEnabled")&&(J.callback=F=>{H(F,OSF.StoreTypeEnum.PrivateCatalog,M)},J.storeType=OSF.StoreTypeEnum.PrivateCatalog,u.AFrameworkApplication.pa.ob(t.a.Hrb,
2,J))},0,()=>{c.TellMeActor.instance.Qe.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+(window.performance.now()-this.Fvf)+" ms")})}qia(H,M=0,J=null){2!==u.AFrameworkApplication.pa.processAction(t.a.Hrb,1)?(c.TellMeActor.instance.Qe.pD(f.a.gAk,window.performance.now()-this.Fvf),H()):20>M?u.AFrameworkApplication.tb.rb(new r.a(2,1,500,()=>{this.qia(H,M+1,J)})):J&&J()}static get instance(){k.na||(k.na=new k);return k.na}}k.na=null;Object(C.a)(k,"AddinEntitlementsQuery",
null,[]);class m{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(C.a)(m,"AddinInfo",null,[]);var l=b(1300),x=b(1306),w=b(1305),G=b(1294);b.d(L,"AddinResultsProvider",function(){return D});class D{constructor(H){this.Gb=H;this.FFm=(M,J,F)=>{if(M){const A=M.errorCode,N={};N.StoreType=J;N.ErrorCode=A;N.AddinCount=M.value?M.value.length:
0;c.TellMeActor.instance.Qe.pD(f.a.Wql,window.performance.now()-F,N);if(0===A&&M.value){D.L2b=D.L2b||{};M=M.value;for(const B of M)M=new m,M.displayName=B[0],M.id=B[1],M.description=B[2],M.targetType=B[3],M.appVersion=4<B.length?B[4]:"",M.assetId=5<B.length?B[5]:"",M.assetStoreId=6<B.length?B[6]:"",M.width=7<B.length?B[7]:0,M.height=8<B.length?B[8]:0,M.iconUrl=9<B.length?B[9]:"",M.providerName=10<B.length?B[10]:"",M.storeId=11<B.length?B[11]:"",M.storeType=12<B.length?B[12]:"",D.L2b[M.id]=M,0<M.iconUrl.length&&
appChrome.addInApi.registerAddinIcon("AddinIcon_"+M.id,M.iconUrl)}}};k.instance.bOd(this.FFm)}ZX(){return"Add-ins"}Bba(){return 0===this.Gb.WA?0:1===this.Gb.WA?1:2}HS(H,M,J,F,A=null){J=new w.a(H);A&&!Array.contains(A,24)||G.a.O7(H)||(A=new x.a(24),A.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,this.sDl(H.Qg,A),0<A.results.length&&J.DA(A));M.resultsUpdated(J)}sDl(H,M){if((H=this.zfn(H))&&0<H.length){let J=0;H.forEach(F=>{if(!(3<=++J)){var A="AddinSuggestion"+J,N={};N["default"]=0<F.iconUrl.length?
"AddinIcon_"+F.id:"AppForOfficeLogo_20";var B=[];B.push(appChrome.actions.setControlLabel(A,F.displayName));B.push(appChrome.actions.setControlIconSet(A,N));B.push(appChrome.actions.setCompoundButtonCommandValueId(A,F.id));B.push(appChrome.actions.updateCompoundButtonDescription(A,F.description));appChrome.api.dispatch(B);A=new l.a(A,25,void 0,void 0,1);A.pN=Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.id,F.providerName);M.DB(A)}})}}zfn(H){if(!D.L2b)return null;const M=[],J=D.L2b;for(let A in J){var F=
J[A];F&&0<=F.displayName.toLowerCase().indexOf(H.toLowerCase())&&Array.add(M,F)}return M}}D.L2b=null;Object(C.a)(D,"AddinResultsProvider",null,[1035])},1540:function(C,L,b){b.d(L,"a",function(){return c});C=b(0);var f=b(199);class c{constructor(){this.ZKb=this.$Kb=this.zjb=this.ZGb=this.YKb=this.NDb=this.YGb=this.yrb=this.tSa=this.SUa=null;this.reset()}reset(){this.SUa=new f.a;this.tSa=new f.a;this.yrb=new f.a;this.YGb=new f.a;this.NDb=new f.a;this.YKb=new f.a;this.ZGb=new f.a;this.zjb=new f.a;this.zjb=
new f.a;this.$Kb=new f.a;this.ZKb=new f.a}gRn(u){return this.e5a(this.SUa,u)&&this.e5a(this.tSa,u)&&this.e5a(this.yrb,u)&&this.e5a(this.YGb,u)&&this.e5a(this.NDb,u)&&this.e5a(this.YKb,u)&&this.e5a(this.ZGb,u)&&this.e5a(this.zjb,u)&&this.e5a(this.$Kb,u)&&this.e5a(this.ZKb,u)}e5a(u,r){return!u||!u.length||u.length===r}}Object(C.a)(c,"MergeableTrackedChangesProperties",null,[])},1541:function(C,L,b){b.d(L,"a",function(){return r});C=b(0);var f=b(726),c=b(245),u=b(41);class r{constructor(t,k,m){this.jkk=
t;this.Rgk=k;this.wgk=m;this.Wif=new c.a(Object(u.a)(this,this.uQk,"checkIfDifferent"))}get zCa(){return this.jkk}get oldValue(){return this.Rgk}get newValue(){return this.wgk}get qHb(){return!(void 0===this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get pY(){return this.qHb||this.isDeleted||this.Wif.value}uQk(){return this.qHb||this.isDeleted?
!0:!f.a.ake(this.zCa,this.oldValue,this.newValue)}}Object(C.a)(r,"PropertyDiff",null,[])},1542:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);b=b(1395);class f extends b.a{constructor(){super();this.dNc=this.cId=this.Dp=null;this.QNd=0}get rra(){return"Property"}n9b(){this.detail.$("Type",this.rra);this.detail.$("ComplexMerger",null!=this.Dp?this.Dp:-1);this.detail.$("Strategy",null!=this.cId?this.cId:-1);this.detail.$("ClassId",null!=this.dNc?this.dNc:-1);this.detail.$("PropId",this.QNd);
return this.detail}}Object(C.a)(f,"PropertyMergeFailureDetail",b.a,[])},1543:function(C,L,b){b.d(L,"a",function(){return u});C=b(0);var f=b(199),c=b(577);class u{constructor(){this.m_a=new f.a;this.Z_a=new f.a;this.X1a=new f.a}get v3b(){return this.m_a}get c1f(){return this.Z_a}get hPb(){return this.X1a}get isEmpty(){return!this.m_a.length&&!this.Z_a.length&&!this.X1a.length}get OHd(){return Math.max(Math.max(this.m_a.length,this.Z_a.length),this.X1a.length)}get lxm(){return Math.min(Math.min(this.m_a.length,
this.Z_a.length),this.X1a.length)}xje(r){this.m_a.add(r)}zje(r){this.Z_a.add(r)}Cje(r){this.X1a.add(r)}Dll(){const r=new c.a,t=new f.a;let k=0;for(;k<this.m_a.length||k<this.Z_a.length||k<this.X1a.length;)k<this.m_a.length&&!r.contains(this.m_a.J(k))&&(t.add(this.m_a.J(k)),r.add(this.m_a.J(k))),k<this.Z_a.length&&!r.contains(this.Z_a.J(k))&&(t.add(this.Z_a.J(k)),r.add(this.Z_a.J(k))),k<this.X1a.length&&!r.contains(this.X1a.J(k))&&(t.add(this.X1a.J(k)),r.add(this.X1a.J(k))),k++;return t}}Object(C.a)(u,
"ObjectCollection",null,[])},1544:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{constructor(c,u){this.AZa=u;this.updateHints=c}}Object(C.a)(f,"UpdateHintCollection",null,[])},1545:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);b=b(1372);class f extends b.a{constructor(c,u){super();this.zf=c;this.Ob=u}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.zf,this.Ob)}}Object(C.a)(f,"LcsInsertParaUpdateHint",
b.a,[])},1546:function(C,L,b){b.d(L,"a",function(){return c});C=b(0);var f=b(199);b=b(1372);class c extends b.a{constructor(u){super();this.F7=new f.a;this.cp=u}get type(){return 11}toString(){let u="";for(let r=0;r<this.F7.length;r++)u+=String.format("({0}), ",this.F7.J(r).toString());return String.format("[Cp:{0}] {1}",this.cp,u)}}Object(C.a)(c,"LcsInsertUpdateHint",b.a,[])},1547:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);b=b(1372);class f extends b.a{constructor(c,u){super();this.text=
u;this.zf=c}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",this.cp,this.type,this.zf,this.text)}}Object(C.a)(f,"LcsInsertTextUpdateHint",b.a,[])},1548:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);b=b(1372);class f extends b.a{constructor(c,u,r){super();this.cp=c;this.zf=u;this.Ob=r}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.zf,this.Ob)}}Object(C.a)(f,"LcsDeleteParaUpdateHint",
b.a,[])},1549:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);b=b(1372);class f extends b.a{constructor(c,u){super();this.cp=c;this.text=u}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",this.cp,this.type,this.text)}}Object(C.a)(f,"LcsDeleteTextUpdateHint",b.a,[])},1550:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);b=b(1340);class f extends b.a{constructor(){super()}get rra(){return"Conflict"}}Object(C.a)(f,"ConflictMergeFailureDetail",b.a,[])},
1551:function(C,L,b){b.r(L);b.d(L,"InsightsMenuItemFactory",function(){return r});C=b(0);var f=b(1294),c=b(230),u=b(16);class r{constructor(t=null){this.Ubk=t||CommonUIStrings.l_InsightsButtonText}get F8a(){return 10}Iaa(t){var k=t.aG;t=f.a.AVa()?f.a.ejb(k,1):f.a.Z5b(k);k=String.format(this.Ubk,k);return this.Ipl(t,k)}Ipl(t,k){return c.a(r.iOi,f.a.AVa()?"1914896509":"3317204163",u.a.Vd(k),f.a.Tkg,null,u.a.Vd(t),u.a.Vd(k),null,null)}}r.iOi="bInsights";Object(C.a)(r,"InsightsMenuItemFactory",null,[1034])},
1552:function(C,L,b){b.d(L,"a",function(){return u});C=b(0);var f=b(230),c=b(16);class u{constructor(r,t,k,m,l){this.Htf=r;this.Gtf=t;this.Qpk=k;this.Iak=m;this.szh=l}get F8a(){return 4}Iaa(r,t=null){t=t.sessionId+"|"+t.gsa+"|"+r.aG;if(this.szh||this.Iak){let k=this.szh||c.a.gw(CommonUIStrings.l_HelpTooltip)===c.a.gw(r.aG.trim());if(this.Qpk&&2<r.aG.length){const m=r.aG;";"===m.charAt(0)&&";"===m.charAt(m.length-1)&&m.substring(1,m.length-1)===u.Pgg&&(k=!0)}r=k?CommonUIStrings.l_HelpButtonTextNoPlaceholder:
String.format(CommonUIStrings.l_TextWithQuotation,r.aG);return this.fsi(t,c.a.Vd(r),k)}return this.fsi(t,c.a.Vd(String.format(CommonUIStrings.l_TextWithQuotation,r.aG)),!1)}fsi(r,t,k){return f.a(u.Pgg,k?this.Gtf:this.Htf,t,"OfficeAssistant_16x16x32","A0",c.a.Vd(r),t,null,null)}}u.Pgg="bSearchHelp";Object(C.a)(u,"AssistanceMenuItemFactory",null,[1034])},1553:function(C,L,b){b.d(L,"a",function(){return t});C=b(0);var f=b(2),c=b(230),u=b(97),r=b(16);class t{get F8a(){return 13}Iaa(){return t.bJk()}static bJk(){return c.b(t.fpi,
"798637440",r.a.Vd(CommonUIStrings.l_LookupFirstRunExperienceTitle),f.AFrameworkApplication.ln,u.getImageClass("Info_32x32x32"),null,null,r.a.Vd(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,r.a.Vd(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}t.fpi="bTellMeFirstRun";Object(C.a)(t,"FirstRunMenuItemFactory",null,[1034])},1554:function(C,L,b){b.d(L,"a",function(){return r});C=b(0);var f=b(2),c=b(230),u=b(16);class r{constructor(t=null,k=null){this.CGh=t;this.Bgk=
k||CommonUIStrings.l_LookupNoResultsDescription}get F8a(){return 14}Iaa(t){t=String.format(this.Bgk,t.aG);return this.SJk(t)}SJk(t){return c.b(r.C6i,"798637440",u.a.Vd(CommonUIStrings.l_LookupNoResultsTitle),this.CGh?f.AFrameworkApplication.ln:null,this.CGh,null,null,u.a.Vd(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,u.a.Vd(t),null,null)}}r.C6i="lookupNoResults";Object(C.a)(r,"NoCommandsFoundMenuItemFactory",null,[1034])},1555:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);
class f{constructor(c,u){this.FontWeight=0;this.Text=null;this.FontWeight=c;this.Text=u}}Object(C.a)(f,"LabelFormatted",null,[])},1556:function(C,L,b){b.d(L,"a",function(){return T});C=b(0);var f=b(75),c=b(1299),u=b(1441),r=b(1359),t=b(1322),k=b(1374),m=b(1557),l=b(1342),x=b(1360),w=b(1558),G=b(1300),D=b(1306),H=b(1305),M=b(1582),J=b(1559),F=b(1373),A=b(1295),N=b(1294),B=b(2),E=b(32),P=b(130);class T{constructor(V,I,R){this.scd=this.Bee=this.Cee=this.Aee=!1;this.AW=null;this.M9=-1;this.jQa=this.edd=
null;this.Bdd="";this.IWb=0;this.Gb=V;const ba=N.a.AVa();this.pyb=I||[];this.nf=B.AFrameworkApplication.Gd;this.WNh=V.dKg;this.Dee=V.cKg;this.Kuf=ba&&this.JNb();this.Luf=ba&&this.KNb();this.Gnk=ba&&this.LNb();this.Nuf=this.MNb();this.XNh=this.WSc();V.M8g&&N.a.$3g(V)&&(this.edd=new M.a(V),this.Aee=V.bYd,this.Cee=V.dYd,this.Bee=V.mpb,this.scd=this.Aee&&this.tK("File")||this.Cee&&this.tK("People")||this.Bee&&this.tK("Notes"));this.zee=this.Ssn();this.Hee=V.dLd;this.Muf=this.gtn();this.T$a=this.JQl();
this.Boh=new m.a(V);this.sbk=new w.a(V);this.Ppk=new J.a(V);this.Iad=R;this.Jtf=new u.a;this.Hee&&(this.Boh=new m.a(V))}tK(V){return Array.contains(this.pyb,V)?!0:!1}ZX(){return"TellMeService"}Bba(){return 0===this.Gb.WA?0:1===this.Gb.WA?1:3===this.Gb.WA?3:this.tK("Command")||this.tK("Recommended")?2:3}GQl(V){let I="";if(!V&&this.tK("Command")&&this.Gb.aqg){I+="CommandSearch_DLIS,";var R=this.Gb.nIj;0<R.length&&(I+=R+",")}V&&this.tK("Recommended")&&this.Dee&&(R=this.Gb.oIj,0<R.length&&(I+=R+","));
!V&&this.tK("Help")&&(V=this.Gb.mIj,0<V.length&&(I+=V+","));0<I.length&&(I=I.substr(0,I.length-1));return I}HS(V,I,R,ba=c.a.tellMe,ha=null){const na=new H.a(V);R=N.a.O7(V);if(this.scd&&(!this.IWb||window.performance.now()-this.IWb>=N.a.X1e)){var da=this.Jtf.KQl();if(da)this.IWb=window.performance.now(),da.then(ka=>{this.Bdd=ka},ka=>{A.TellMeActor.instance.Qe.onError("TellMeServiceProvider:issueQuery","tellMeServiceToken promise rejected: "+ka)});else if(A.TellMeActor.instance.Qe)A.TellMeActor.instance.Qe.onError("TellMeServiceProvider:IssueQuery",
"undefined token promise")}var ia=this.scd&&!!this.Bdd;da=ia||R&&this.tK("Recommended")&&this.Dee;ia=ia||!R&&(this.WNh&&this.tK("Command")||this.Kuf&&this.tK("Answer")||this.Luf&&this.tK("Definition")||this.XNh&&this.tK("Image")||this.Hee&&this.tK("Help")||this.Nuf&&this.tK("WolframAnswer")||this.Muf&&this.tK("Template"));if(da||ia)if(this.jQa=ba,ba={"Content-Type":"application/json",Accept:"application/json"},ba["X-Office-Version"]=B.AFrameworkApplication.buildVersion,ba["X-Office-Application"]=
B.AFrameworkApplication.K.Ga("Application"),ba["X-Office-Platform"]="WAC",ba["X-TellMe-SqmUserId"]=B.AFrameworkApplication.K.Ga("LoggableUserId")||"",ba["X-TellMe-SessionId"]=A.TellMeActor.instance.dAe(),this.Bdd&&(ba.Authorization="Bearer "+this.Bdd),da=this.GQl(R),0<da.length&&(ba["X-TellMe-Flights"]=da),da=[],!R&&this.tK("Answer")&&this.Kuf&&(ha?Array.contains(ha,9):1)&&Array.add(da,"Answer"),!R&&this.tK("Command")&&this.WNh&&!l.CommandResultsUtility.Pmg(V.Qg)&&(ha?Array.contains(ha,17):1)&&Array.add(da,
"Command"),!R&&this.tK("Definition")&&this.Luf&&(ha?Array.contains(ha,10):1)&&Array.add(da,"Definition"),!R&&this.tK("Help")&&this.Hee&&(ha?Array.contains(ha,8):1)&&Array.add(da,"Help"),!R&&this.tK("WolframAnswer")&&this.Nuf&&(ha?Array.contains(ha,12):1)&&Array.add(da,"WolframAnswer"),R&&this.tK("Recommended")&&this.Dee&&!A.TellMeActor.instance.z0d&&(ha?Array.contains(ha,18):1)&&Array.add(da,"Recommended"),!R&&this.tK("Image")&&this.XNh&&(ha?Array.contains(ha,19):1)&&Array.add(da,"Image"),this.Bdd&&
this.scd&&(ha?Array.contains(ha,14)||Array.contains(ha,15)||Array.contains(ha,20):1)&&(this.edd.gMb(),this.Aee&&this.tK("File")&&Array.add(da,"File"),this.Cee&&this.tK("People")&&Array.add(da,"People"),this.Bee&&this.tK("Notes")&&Array.add(da,"Notes")),!R&&this.tK("Template")&&this.Muf&&(ha?Array.contains(ha,23):1)&&Array.add(da,"Template"),da.length){ba["X-TellMe-SuggestionTypes"]=da.join(",");ba["X-TellMe-Culture"]=B.AFrameworkApplication.uiCulture;ba["X-TellMe-ProcessSessionId"]=B.AFrameworkApplication.userSessionId;
var ma=this.AW=P.a.create().toString();ba["Client-Request-Id"]=ma;var qa=window.performance.now();this.ERa();this.M9=window.setTimeout(()=>{if(ma===this.AW){this.AW="";this.M9=-1;I.resultsUpdated(na);const ka={};ka[r.a.provider]=this.ZX();ka[r.a.pic]=V.lLb;A.TellMeActor.instance.Qe.pD(t.a.timedOut,this.Iad,ka)}},this.Iad);this.nf.Ni(this.T$a,2,this.IQl(V.Qg),ba,!1,0,ka=>{this.Qgc(ka,V,I,ma,qa,ha)},ka=>{this.ygc(ka,V,I,ma,qa)},null,null,!1,4E3,6E3)}else A.TellMeActor.instance.Qe.onError("IssueQuery",
"Empty Online Provider List: No online calls by provider"),I.resultsUpdated(na);else I.resultsUpdated(na)}ERa(){-1!==this.M9&&(window.clearTimeout(this.M9),this.M9=-1)}Qgc(V,I,R,ba,ha,na){const da=new H.a(I);if(ba===this.AW){this.ERa();A.TellMeActor.instance.Qe.$ga(I.Qg.length,this.pyb.join(","),V.data.Ge.toString(),Math.round(window.performance.now()-ha),F.a.tellMe,!0,k.a.o5a);ba=V.data.Rd;V=null;try{V=E.b(ba)}catch(ja){A.TellMeActor.instance.Qe.onError("OnSuccessCallBack","Exception occured while deserializing response:"+
ja);return}ba=N.a.O7(I);if("Groups"in V&&V.Groups){var ia=V.Groups;for(var ma of ia)if("GroupType"in ma&&"Suggestions"in ma&&ma.Suggestions)if("Commands"===ma.GroupType&&(na?Array.contains(na,17):1)||"Recommended"===ma.GroupType&&(na?Array.contains(na,18):1)){var qa=(ia="Recommended"===ma.GroupType)?"DLIS":"NaiveBayes";"Source"in ma&&ma.Source&&(qa=ma.Source);var ka=ma.Suggestions;new f.a;var va=[];for(const ja of ka)this.fhm(ja)&&(ka=ja.Type,("Command"===ka||ia&&"Recommended"===ka)&&va.push(new x.a(ja.CommandId,
ja.Score)));l.CommandResultsUtility.nKe(va,!I.Qg.trim().length,ma.GroupType,qa);qa=A.TellMeActor.instance.u$;ka=[];for(const ja of va)ia&&qa&&qa.bPf(ja.commandId)||ka.push(ja);va=l.CommandResultsUtility.pze(ka,this.Gb,null,null,null,ia?18:17,0);0<va.results.length&&(this.jQa!==c.a.contextMenu&&(va.displayName=ia?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),da.DA(va))}else if("Answer"===ma.GroupType){ka=ma.Suggestions;ia=null;va=2147483647;qa="";for(const ja of ka)if(this.ehm(ja))if(qa=
ja.Type,ka=this.dze(qa),"Answer"===qa&&this.Kuf){ia=this.pdi(qa,ja,I.Qg);break}else ka&&ka<va&&(va=ka,ia=this.pdi(qa,ja,I.Qg));va=N.a.Rbn(I.Qg,qa);ia&&(na?Array.contains(na,ia.type):1)&&(qa=[],this.zee?this.Gb.Fmb?(A.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ia.value,ia.aG)),A.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ia.value,ia.description)),A.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ia.value,
va))):(qa.push(appChrome.actions.setControlLabel(ia.value,ia.aG)),qa.push(appChrome.actions.updateCompoundButtonDescription(ia.value,ia.description)),qa.push(appChrome.actions.setCompoundButtonCommandValueId(ia.value,va)),appChrome.api.dispatch(qa)):this.Gb.Fmb?(A.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ia.value,ia.aG+" - "+ia.description)),A.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ia.value,va))):(qa.push(appChrome.actions.setControlLabel(ia.value,
ia.aG+" - "+ia.description)),qa.push(appChrome.actions.setButtonCommandValueId(ia.value,va)),appChrome.api.dispatch(qa)),va=this.q4k(ia.type),va.DB(ia),da.DA(va))}else"Help"===ma.GroupType&&ma.Suggestions.length&&(na?Array.contains(na,8):1)?this.Hee&&(ia=this.Boh.uHc(I,ma.Suggestions))&&0<ia.results.length&&da.DA(ia):"Template"===ma.GroupType&&(na?Array.contains(na,23):1)?(ia=ma.Suggestions)&&0<ia.length&&this.Ppk.uHc(I,da,ia):"Substrate"===ma.GroupType&&this.scd&&"Type"in ma&&("File"===ma.Type&&
this.Aee&&(na?Array.contains(na,15):1)?(ia=this.edd.hxi(ma.Suggestions,ba,this.jQa))&&0<ia.results.length&&da.DA(ia):"People"===ma.Type&&this.Cee&&(na?Array.contains(na,14):1)?(ia=this.edd.WBi(ma.Suggestions,ba,this.jQa))&&0<ia.results.length&&da.DA(ia):"Notes"===ma.Type&&this.Bee&&(na?Array.contains(na,14):1)&&(ia=this.edd.QAi(ma.Suggestions,ba,I))&&0<ia.results.length&&da.DA(ia));else A.TellMeActor.instance.Qe.onError("OnSuccessCallBack","GroupType"in ma?"Invalid group suggestions found for "+ma.GroupType:
"Invalid group found")}if(V.Intents){ma=V.Intents;for(const ja of ma)this.jtg(ja)&&("Image"===ja.GroupType&&ja.ConfidenceScore>ja.ConfidenceThreshold&&(na?Array.contains(na,19):1)?this.sbk.uHc(I,da,0,ja):"Commands"===ja.GroupType&&ja.ConfidenceScore<ja.ConfidenceThreshold&&(na?Array.contains(na,17):1)&&(ma=new D.a(17),da.DA(ma)))}R.resultsUpdated(da);A.TellMeActor.instance.Qe.$ga(I.Qg.length,this.pyb.join(","),"",Math.round(window.performance.now()-ha),"",!0,k.a.provider)}}ygc(V,I,R,ba,ha){const na=
new H.a(I);ba===this.AW&&(this.ERa(),A.TellMeActor.instance.Qe.$ga(I.Qg.length,this.pyb.join(","),V.data.Ge.toString(),Math.round(window.performance.now()-ha),F.a.tellMe,!1,k.a.o5a));R.resultsUpdated(na)}dze(V){switch(V){case "Entity":return this.Gnk?3:0;case "Definition":return this.Luf?5:0;case "WolframAnswer":return this.Nuf?2:0;default:return 0}}pdi(V,I,R){switch(V){case "Answer":return new G.a(this.zee?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===I.Title?R:I.Title,I.Description,0);case "Entity":return new G.a(this.zee?
"AnswerForSearch":"AnswerForSearchSingleLine",2,""===I.Title?R:I.Title,I.Description,0);case "Definition":return new G.a(this.zee?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===I.Title?R:I.Title,I.Description,0);case "WolframAnswer":return new G.a("WolframForSearch",3,""===I.Title?R:I.Title,I.Description,0);default:return null}}q4k(V){switch(V){case 0:return new D.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new D.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new D.a(10,
CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new D.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new D.a(19,this.Gb.SSc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}ehm(V){return"Type"in V&&!!V.Type&&""!==V.Type&&"Description"in V&&!!V.Description&&""!==V.Description}fhm(V){return"Type"in V&&!!V.Type&&""!==V.Type&&"CommandId"in V&&!!V.CommandId&&""!==V.CommandId&&"Score"in V&&!!V.Score}jtg(V){if("GroupType"in V&&V.GroupType&&"ConfidenceScore"in
V&&"ConfidenceThreshold"in V)return!0;A.TellMeActor.instance.Qe.onError("IsValidIntentGroup","Invalid intents found");return!1}IQl(V){const I=N.a.JUi(V),R={};R.Query=V;I&&this.Dee&&(R.CommandClickedEvents=A.TellMeActor.instance.Gaf,R.CommandActionEvents=A.TellMeActor.instance.mrh,R.TellMeCommandClickMruEvents=A.TellMeActor.instance.iGh,R.ContentType=A.TellMeActor.instance.$pe);this.Muf&&(V={},V.Application=this.Gb.application,R.TemplateInfo=V);return E.c(R)}JNb(){return!!this.Gb&&this.Gb.JNb||!!B.AFrameworkApplication.la&&
B.AFrameworkApplication.la.eb.JNb}KNb(){return!!this.Gb&&this.Gb.KNb||!!B.AFrameworkApplication.la&&B.AFrameworkApplication.la.eb.KNb}LNb(){return!!this.Gb&&this.Gb.LNb||!!B.AFrameworkApplication.la&&B.AFrameworkApplication.la.eb.LNb}MNb(){return!!this.Gb&&this.Gb.MNb||!!B.AFrameworkApplication.la&&B.AFrameworkApplication.la.eb.MNb}WSc(){return!!this.Gb&&(this.Gb.WSc||this.Gb.K8)}Ssn(){return!!this.Gb&&!this.Gb.lpb}gtn(){return!!this.Gb&&this.Gb.UEd}Lsg(){return!!B.AFrameworkApplication.K&&B.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",
!1)}Nsg(){return!!B.AFrameworkApplication.K&&B.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}JQl(){if(!B.AFrameworkApplication.K)return"";if(this.Nsg())return B.AFrameworkApplication.K.Ga("TellMeServiceProdEndpointForSearch");if(this.Lsg())return B.AFrameworkApplication.K.Ga("TellMeServiceEdogEndpointForSearch");if(N.a.Bng())return B.AFrameworkApplication.K.Ga("TellMeServiceIntEndpointForSearch");let V=B.AFrameworkApplication.K.Ga("TellMeServiceSearchEndpoint");
V&&""!==V||(V=B.AFrameworkApplication.v1e);return V}static Idi(V,I){if(I)return new T(V,["Command","Recommended"],V.Bzl);I=N.a.AVa()?"Answer Definition Help WolframAnswer Image File People Notes Template".split(" "):"Help WolframAnswer File People Notes Template".split(" ");return new T(V,I,V.bEi)}}Object(C.a)(T,"TellMeServiceProvider",null,[1035])},1557:function(C,L,b){b.d(L,"a",function(){return k});C=b(0);b(1299);var f=b(1300),c=b(1306),u=b(1305),r=b(1294),t=b(16);class k{constructor(m){this.Gb=
m}ZX(){return"Assistance"}Bba(){return 0===this.Gb.WA?0:1===this.Gb.WA?1:this.Gb.dLd?3:2}HS(m,l,x=!1,w,G=null){w=new u.a(m);if((!G||Array.contains(G,8))&&!r.a.O7(m)){G=new c.a(8);if(x){x=t.a.gw(CommonUIStrings.l_HelpTooltip)===t.a.gw(m.Qg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,m.Qg);const D=[];this.Gb.lpb&&(this.Gb.iZe||D.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),x=this.MAi(m.Qg));const H=
"||"+m.Qg;D.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",x));D.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",H));appChrome.api.dispatch(D);m=new f.a("GetHelpFromTellMe",4,m.Qg,null,1)}else m=new f.a("bSearchHelp",4,m.Qg,null,1);G.DB(m);G.displayName=CommonUIStrings.l_HelpButtonTitle;w.DA(G)}l.resultsUpdated(w)}uHc(m,l=null){const x=new c.a(8),w=t.a.gw(CommonUIStrings.l_HelpTooltip)===t.a.gw(m.Qg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
m.Qg);for(let D=0;D<l.length&&2>D;D++){var G=void 0;G=[];let H="GetHelpWithDescriptionFromTellMe"+(D+1).toString(),M=4;if(this.Gb.RSc)G.push(appChrome.actions.setControlLabel(H,w)),G.push(appChrome.actions.setCompoundButtonCommandValueId(H,m.Qg)),G.push(appChrome.actions.updateCompoundButtonDescription(H,this.fdg(l.length)));else if(this.Gb.cVd){let J=this.VFi(l[D]);H="GetHelpFromTellMe"+(D+1).toString();this.Gb.lpb&&(J=this.MAi(J));M=9;G.push(appChrome.actions.setControlLabel(H,J));G.push(appChrome.actions.setButtonCommandValueId(H,
this.ERl(l[D])))}appChrome.api.dispatch(G);G=new f.a(H,M,null,null,0);G.label=this.VFi(l[D]);G.description=this.DRl(l[D]);x.DB(G);if(this.Gb.cVd)break}x.displayName=CommonUIStrings.l_HelpButtonTitle;return x}fdg(m){return 1===m?String.format(CommonUIStrings.l_SearchResultText,m):String.format(CommonUIStrings.l_SearchResultsText,m)}MAi(m){return this.Gb.osg?r.a.J8f(m,CommonUIStrings.l_HelpScopedButtonText):m+CommonUIStrings.l_HelpScopedButtonText}VFi(m){return m.name?m.name:""}DRl(m){return m.description?
m.description:""}ERl(m){return m.id?"AssetID="+m.id:""}}Object(C.a)(k,"AssistanceResultsProvider",null,[1035])},1558:function(C,L,b){b.d(L,"a",function(){return m});C=b(0);b(1299);var f=b(1300),c=b(1306),u=b(1305),r=b(1295),t=b(1294),k=b(1370);class m{constructor(l){this.Gb=l}ZX(){return"Image"}Bba(){return 0===this.Gb.WA?0:1===this.Gb.WA?1:3===this.Gb.WA?3:2}HS(l,x,w,G,D=null){w=new u.a(l);(!D||Array.contains(D,19))&&t.a.O7(l)&&this.Gb.K8&&this.uHc(l,w,1);x.resultsUpdated(w)}uHc(l,x,w,G=null){var D=
[];let H;r.TellMeActor.instance.WU()&&r.TellMeActor.instance.WU().lpb?(H=this.Gb.osg?t.a.J8f(l.Qg,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):l.Qg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.Gb.iZe||D.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):H=this.Gb.K8?t.a.O7(l)?this.Gb.Ghd?t.a.Zsd(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.Gb.Ghd?t.a.Zsd(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,
l.Qg)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,l.Qg):this.Gb.SSc?CommonUIStrings.l_TellMeImageSuggestionButtonText:l.Qg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.Gb.Fmb?(r.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",H)),D=t.a.ejb(l.Qg,9,Object.assign(new k.a,{landingTab:"Image"})),r.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",D))):(D.push(appChrome.actions.setControlLabel("ImageForSearch",
H)),l=t.a.ejb(l.Qg,9,Object.assign(new k.a,{landingTab:"Image"})),D.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",l)),appChrome.api.dispatch(D));w=new f.a("ImageForSearch",12,null,null,w);G&&(w.score=G.ConfidenceScore);G=new c.a(19,this.Gb.SSc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);G.DB(w);x.DA(G)}}Object(C.a)(m,"ImageResultsProvider",null,[1035])},1559:function(C,L,b){b.d(L,"a",function(){return k});C=b(0);b(1299);var f=b(1300),c=b(1306),u=b(1305),
r=b(1294),t=b(2);class k{constructor(m){this.Gb=m}ZX(){return"Template"}Bba(){return 0===this.Gb.WA?0:1===this.Gb.WA?1:3}HS(m,l){m=new u.a(m);l.resultsUpdated(m)}uHc(m,l,x){var w=[];let G;G=this.Gb.K8?this.Gb.Ghd?r.a.Zsd(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,m.Qg)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,m.Qg):String.format(CommonUIStrings.l_TellMeTemplateButtonText,m.Qg);w.push(appChrome.actions.setControlLabel("TemplateForSearch",G));w.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(t.AFrameworkApplication.K.Ga("TellMeTemplateProviderURL"),t.AFrameworkApplication.uiCulture,m.Qg)));appChrome.api.dispatch(w);m=new c.a(23);m.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;w=new f.a("TemplateForSearch",24,null,null,0);w.label=x[0].Title?x[0].Title:"";w.description=x[0].Description?x[0].Description:"";m.DB(w);l.DA(m)}}Object(C.a)(k,"TemplateResultsProvider",null,[1035])},1560:function(C,L,b){b.d(L,"a",function(){return x});C=b(0);b(1299);var f=b(1342),c=b(1300),
u=b(1306),r=b(1305),t=b(1451),k=b(1295),m=b(1294),l=b(16);class x{constructor(w,G,D,H){this.u$=w;this.lBb=G;this.JQh=H;this.q9j=D;this.Gb=k.TellMeActor.instance.WU()}ZX(){return"EmptyQuery"}Bba(){return 1===this.Gb.WA?1:0}HS(w,G,D=!1,H,M=null){H=new r.a(w);if((!M||Array.contains(M,5)||Array.contains(M,6)||Array.contains(M,4))&&m.a.O7(w)){this.u$.Htd().length||!this.q9j||this.JQh||(w=new u.a(6),M=new c.a(null,13,void 0,void 0,1),w.DB(M),H.DA(w));w=new u.a(4);if(0<this.u$.Htd().length){w.displayName=
CommonUIStrings.l_TellMeRecentlyUsedTitle;M=this.u$.Htd();var J=[];for(var F of M)J.push(F.Id);f.CommandResultsUtility.r_d(J,this.Gb);for(var A of M)f.CommandResultsUtility.UBd(A.Id)&&w.DB(new c.a(A.Id,5,null,null,2));H.DA(w)}if(this.JQh&&0<this.lBb.length&&this.u$.Htd().length<x.H3i){F=new u.a(5);F.displayName=CommonUIStrings.l_TellMeTryQueryTitle;A=x.H3i-w.results.length;w=[];for(M=0;M<this.lBb.length&&M<A;++M){if(D){J=m.a.Tbh+(M+1);const N=this.lBb[M].key,B=l.a.replaceAll(N,'"',"");w.push(appChrome.actions.setControlLabel(J,
N));w.push(appChrome.actions.setButtonCommandValueId(J,B));J=new t.a(N,7,0,B,J)}else J=new t.a(this.lBb[M].key,7,0,this.lBb[M].value);F.DB(J)}0<w.length&&appChrome.api.dispatch(w);H.DA(F)}}G.resultsUpdated(H)}}x.H3i=5;Object(C.a)(x,"EmptyQueryResultsProvider",null,[1035])},1561:function(C,L,b){b.d(L,"a",function(){return f});C=b(0);class f{constructor(){this.Z0e=this.r5a=this.MGb=this.Xz=this.wle=this.lJ=this.spc=0}}Object(C.a)(f,"TRIESCAN",null,[])},1574:function(C,L,b){b.r(L);var f=b(0),c=b(1299),
u=b(1359),r=b(1322),t=b(1465);class k{constructor(Ua,Hb){this.fMa=Ua;this.Vf=Hb}resultsUpdated(Ua){this.fMa.Nnn(this.Vf,Ua)}}Object(f.a)(k,"AggregatorResultsProviderCallback",null,[1037]);var m=b(1306),l=b(1305);class x{constructor(Ua){this.nEa=null;this.Gb=Ua;this.Gb.uhb&&(this.nEa=this.Gb.Rve())}ZX(){return"AppsForOffice"}Bba(){return 0===this.Gb.WA?0:1===this.Gb.WA?1:2}HS(Ua,Hb,$b,sc,Wc=null){$b=new l.a(Ua);if(!Wc||Array.contains(Wc,1))Wc=new m.a(1),this.nEa.kxk(Wc,Ua.Qg),$b.DA(Wc);Hb.resultsUpdated($b)}}
Object(f.a)(x,"AppsForOfficeRecommendationResultsProvider",null,[1035]);var w=b(1557),G=b(1289),D=b(1312),H=b(244);class M{constructor(Ua,Hb){this.Pa=Ua;this.Bsm=Hb}isMatch(Ua,Hb){if(!Object(H.a)(1155,Ua))throw Error.argument("objToTest","Expected feature bundle");let $b;return({value:$b}=Ua.ns(this.Pa.DGa)).returnValue?this.Pa.ogh.isMatch($b,Hb):this.Bsm}}Object(f.a)(M,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1176]);class J{constructor(Ua,Hb){this.Pa=Ua;this.syg=Hb}isMatch(Ua){if(!Object(H.a)(1155,
Ua))throw Error.argument("objToTest","Expected feature bundle");return!!(this.syg^Ua.ns(this.Pa.DGa).returnValue)}}Object(f.a)(J,"AnnotatedWithAnnotationFilter",null,[1176]);class F{constructor(Ua){this.Pa=Ua}isMatch(Ua,Hb){if(!Object(H.a)(1157,Ua))throw Error.argument("objToTest","Expected struct value");return this.Pa.ogh.isMatch(Ua.BFb(this.Pa.e4a),Hb)}}Object(f.a)(F,"FieldValueMatchesStructFilter",null,[1176]);class A{constructor(Ua,Hb){Ua&&(this.e4a=Ua.J(0),this.ogh=Hb.Kza(Ua.J(1)))}}Object(f.a)(A,
"FieldValueMatchesStructFilterInit",null,[]);class N{constructor(Ua){this.syg=Ua}isMatch(Ua){if(!Object(H.a)(1155,Ua))throw Error.argument("objToTest","Expected feature bundle");return!!(this.syg^Ua.Sfg)}}Object(f.a)(N,"HasAnnotationsAnnotationFilter",null,[1176]);class B{constructor(Ua,Hb){this.Pa=Ua;this.Pga=Hb}isMatch(Ua,Hb){if(!Object(H.a)(1156,Ua))throw Error.argument("objToTest","Expected list value");switch(this.Pga){case 0:for(const $b of Ua.items)if(this.Pa.filter.isMatch($b,Hb))return!0;
return!1;case 1:for(const $b of Ua.items)if(!this.Pa.filter.isMatch($b,Hb))return!1;return!0;default:throw Error.notImplemented();}}}Object(f.a)(B,"ItemTestListFilter",null,[1176]);class E{constructor(Ua){this.Pa=Ua}isMatch(Ua,Hb){if(!Object(H.a)(1156,Ua))throw Error.argument("objToTest","Expected list value");return this.Pa.filter.isMatch(Ua.items.length,Hb)}}Object(f.a)(E,"LengthMatchesListFilter",null,[1176]);class P{constructor(Ua,Hb){this.Pa=Ua;this.Pga=Hb}isMatch(Ua,Hb,$b=null){let sc=0===this.Pga;
for(const Wc of this.Pa.z6h)if((sc=Wc.isMatch(Ua,Hb,$b))?1===this.Pga:0===this.Pga)return sc;2===this.Pga&&(sc=!sc);return sc}}Object(f.a)(P,"NonterminalFilter",null,[1176]);class T{constructor(Ua,Hb){if(Ua){var $b=Ua.J(0);this.z6h=Array($b);for(let sc=0;sc<$b;++sc)this.z6h[sc]=Hb.Kza(Ua.J(1+sc))}}}Object(f.a)(T,"NonterminalFilterInit",null,[]);class V{constructor(Ua,Hb){this.Pa=Ua;this.Pga=Hb}isMatch(Ua,Hb){if("number"!==typeof Ua)throw Error.argument("objToTest","Expected number value");let $b=
this.Pa.number;if(this.Pa.query){Hb=this.Pa.query.ev(null,Hb);if("number"!==typeof Hb)throw Error.invalidOperation("Query did not return number");$b+=Hb}switch(this.Pga){case 0:return Ua===$b;case 1:return Ua<$b;case 2:return Ua<=$b;case 3:return Ua>$b;case 4:return Ua>=$b;default:throw Error.notImplemented();}}}Object(f.a)(V,"NumberFilter",null,[1176]);class I{constructor(Ua,Hb){Ua&&(this.number=Ua.J(0),this.query=Ua.J(1)?Hb.KP(Ua.J(1)):null)}}Object(f.a)(I,"NumberFilterInit",null,[]);class R{constructor(Ua,
Hb,$b){this.fxe=this.Ezl;this.Hsm=Ua;this.$1i=Hb;this.Z1i=$b}aLf(Ua){this.$1i=Ua}Ezl(Ua){if(!Ua)throw Error.argument("name","Invalid named feature bundle reference");const Hb=Ua.substr(1);return 1===Ua.charCodeAt(0)&&Hb===this.Hsm?this.$1i:this.Z1i?this.Z1i.fxe(Ua):null}}Object(f.a)(R,"SimpleNamedFeatureBundleResolver",null,[1197]);class ba{constructor(Ua){this.Pa=Ua}isMatch(Ua,Hb){if(!Object(H.a)(1155,Ua))throw Error.argument("objToTest","Expected feature bundle");Ua=this.Pa.query.ev(null,new R(this.Pa.v4e,
Ua,Hb));if("boolean"!==typeof Ua)throw Error.invalidOperation("Query did not return bool");return Ua}}Object(f.a)(ba,"PredicateAnnotationFilter",null,[1176]);class ha{constructor(Ua,Hb){Ua&&(this.v4e=Hb.getString(Ua.J(0)),this.query=Hb.KP(Ua.J(1)))}}Object(f.a)(ha,"PredicateAnnotationFilterInit",null,[]);class na{constructor(Ua){this.Pa=Ua}isMatch(Ua,Hb){if("boolean"!==typeof Ua)throw Error.argument("objToTest","Expected bool value");Hb=this.Pa.query.ev(null,Hb);if("boolean"!==typeof Hb)throw Error.invalidOperation("Query did not return bool");
return Ua===Hb}}Object(f.a)(na,"QueryBooleanFilter",null,[1176]);class da{constructor(Ua,Hb){this.Pa=Ua;this.Pga=Hb}isMatch(Ua,Hb){if("number"!==typeof Ua)throw Error.argument("objToTest","Expected integer");Hb=this.Pa.query.ev(null,Hb);if("number"!==typeof Hb)throw Error.invalidOperation("Query did not return an enum value");switch(this.Pga){case 0:return Ua===Hb;case 1:return 0!==(Ua&Hb);case 2:return Ua===(Ua&Hb);case 3:return Hb===(Ua&Hb);default:throw Error.notImplemented();}}}Object(f.a)(da,
"QueryEnumFilter",null,[1176]);class ia{constructor(Ua,Hb){Ua&&(this.pGe=1===Ua.J(0),this.query=Hb.KP(Ua.J(1)))}}Object(f.a)(ia,"QueryEnumFilterInit",null,[]);class ma{constructor(Ua,Hb){this.Pa=Ua;this.Pga=Hb}isMatch(Ua,Hb){if(!Object(H.a)(1156,Ua))throw Error.argument("objToTest","Expected list value");Hb=this.Pa.query.ev(null,Hb);if(!Object(H.a)(1156,Hb))throw Error.invalidOperation("Query did not return list value");if(Ua.qca!==Hb.qca)return!1;switch(this.Pga){case 0:return G.Annotations.CPb(G.Annotations.fFl(Ua.qca),
Ua,Hb);case 1:for(const $b of Ua.items)for(const sc of Hb.items)if(G.Annotations.CPb(Ua.qca,$b,sc))return!0;return!1;case 2:for(const $b of Ua.items)for(const sc of Hb.items)if(!G.Annotations.CPb(Ua.qca,$b,sc))return!1;return!0;case 3:for(const $b of Hb.items)for(const sc of Ua.items)if(!G.Annotations.CPb(Ua.qca,$b,sc))return!1;return!0;default:throw Error.notImplemented();}}}Object(f.a)(ma,"QueryListFilter",null,[1176]);class qa{constructor(Ua,Hb){this.Pa=Ua;this.Pga=Hb}isMatch(Ua,Hb){if("string"!==
typeof Ua)throw Error.argument("objToTest","Expected string");Hb=this.Pa.query.ev(null,Hb);if("string"!==typeof Hb)throw Error.invalidOperation("Query did not return string");this.Pa.Emg&&(Ua=Ua.toUpperCase(),Hb=Hb.toUpperCase());switch(this.Pga){case 0:return Ua===Hb;case 1:return 0<=Ua.indexOf(Hb);case 2:return Ua.startsWith(Hb);case 3:return Ua.endsWith(Hb);case 4:return 0<=Hb.indexOf(Ua);case 5:return Hb.startsWith(Ua);case 6:return Hb.endsWith(Ua);default:throw Error.notImplemented();}}}Object(f.a)(qa,
"QueryStringFilter",null,[1176]);class ka{constructor(Ua,Hb){Ua&&(this.query=Hb.KP(Ua.J(0)),this.Emg=1===Ua.J(1))}}Object(f.a)(ka,"QueryStringFilterInit",null,[]);class va{constructor(Ua){this.Pa=Ua}isMatch(Ua,Hb){if(!Object(H.a)(1157,Ua))throw Error.argument("objToTest","Expected struct value");Hb=this.Pa.query.ev(null,Hb);if(!Object(H.a)(1157,Hb))throw Error.invalidOperation("Query did not return struct value");return Ua.isEqual(Ua)}}Object(f.a)(va,"QueryStructFilter",null,[1176]);class ja{constructor(Ua){this.Pa=
Ua}isMatch(Ua,Hb){Ua=this.Pa.query.ev(null,Hb);if("boolean"!==typeof Ua)throw Error.invalidOperation("Query did not return bool");return Ua}}Object(f.a)(ja,"QueryWhereConstraintFilter",null,[1176]);class Ma{constructor(Ua){this.Pa=Ua}isMatch(Ua){if("string"!==typeof Ua)throw Error.argument("objToTest","Expected string");return this.Pa.KSg.test(Ua)}}Object(f.a)(Ma,"RegexStringFilter",null,[1176]);class Ha{constructor(Ua,Hb){Ua&&(this.KSg=Hb.EGc(Ua.J(0)))}}Object(f.a)(Ha,"RegexStringFilterInit",null,
[]);class X{constructor(Ua,Hb){Ua&&(this.filter=Hb.Kza(Ua.J(0)))}}Object(f.a)(X,"SingleFilterFilterInit",null,[]);class W{constructor(Ua,Hb){Ua&&(this.query=Hb.KP(Ua.J(0)))}}Object(f.a)(W,"SingleQueryFilterInit",null,[]);class fa{constructor(Ua){this.Pa=Ua}isMatch(Ua){if("boolean"!==typeof Ua)throw Error.argument("objToTest","Expected bool value");return Ua===this.Pa.value}}Object(f.a)(fa,"StoredValueBooleanFilter",null,[1176]);class ra{constructor(Ua){Ua&&(this.value=1===Ua.J(0))}}Object(f.a)(ra,
"StoredValueBooleanFilterInit",null,[]);class Aa{constructor(Ua,Hb){this.Pa=Ua;this.Pga=Hb}isMatch(Ua){if("number"!==typeof Ua)throw Error.argument("objToTest","Expected integer");switch(this.Pga){case 0:return this.Pa.pGe?this.Pa.value?!!(Ua&this.Pa.value):!Ua:Ua===this.Pa.value;case 1:return this.Pa.pGe?(Ua&this.Pa.value)===this.Pa.value:32>Ua&&(1<<Ua&this.Pa.value)===this.Pa.value;case 2:return this.Pa.pGe?!!(Ua&this.Pa.value):32>Ua&&!!(1<<Ua&this.Pa.value);default:throw Error.notImplemented();
}}}Object(f.a)(Aa,"StoredValueEnumFilter",null,[1176]);class Ba{constructor(Ua){Ua&&(this.pGe=1===Ua.J(0),this.value=Ua.J(1))}}Object(f.a)(Ba,"StoredValueEnumFilterInit",null,[]);class ta{constructor(){this.FOm=null;this.xJf=this.rac=0}}Object(f.a)(ta,"WHEREConstraintData",null,[]);class xa{constructor(Ua){this.Pa=Ua}isMatch(Ua,Hb){if(!Object(H.a)(ta,Ua))throw Error.argument("objToTest","Expected WHERE constraint data");let $b=-1,sc=-1;const Wc=Ua.FOm;switch(this.Pa.JKf){case 4:$b=Wc.Nrd;sc=Wc.U6g;
break;case 5:$b=Ua.rac;sc=Wc.Nrd-Ua.rac;break;case 6:$b=Wc.Nrd+Wc.U6g;sc=Ua.rac+Ua.xJf-$b;break;case 1:case 2:case 3:let dd=!1;for(let td=Wc.Q_n;td;td=td.next)if(this.Pa.BQn===td.name){dd=!0;1===this.Pa.JKf?($b=td.Nrd,sc=td.U6g):2===this.Pa.JKf?($b=Ua.rac,sc=td.Nrd-Ua.rac):($b=td.Nrd+td.U6g,sc=Ua.rac+Ua.xJf-$b);break}if(!dd)return!1;break;case 7:$b=Ua.rac;sc=Ua.xJf;break;default:throw Error.notImplemented();}return null!==this.Pa.Eyn.T2n(Wc.J9n,$b,sc,$b,!0,2,Hb)}}Object(f.a)(xa,"SubSreWhereConstraintFilter",
null,[1176]);class za{constructor(Ua,Hb){if(Ua){var $b=Hb.getString(Ua.J(0));this.JKf=$b.charCodeAt(0);this.BQn=$b.substr(1);this.Eyn=Hb.lNl(Ua.J(1))}}}Object(f.a)(za,"SubSreWhereConstraintFilterInit",null,[]);class la{constructor(Ua){this.Pa=Ua}isMatch(Ua,Hb,$b=null){if(!Object(H.a)(1155,Ua))throw Error.argument("objToTest","Expected feature bundle");if(null==$b)throw Error.argumentNull("parentTextForSpan");if(this.Pa.kYh&&!this.Pa.kYh.isMatch(Ua,Hb))return!1;if(this.Pa.B$g){let sc;if(({value:sc}=
Ua.ns(this.Pa.Nxn)).returnValue){if(!this.Pa.B$g.isMatch(sc,Hb))return!1}else{let Wc,dd;if(!({value:Wc}=Ua.ns(this.Pa.lEj)).returnValue||!({value:dd}=Ua.ns(this.Pa.kEj)).returnValue||0>Wc||0>dd||Wc+dd>$b.length||!this.Pa.B$g.isMatch($b.substr(Wc,dd),Hb))return!1}}if(this.Pa.lFj){let sc;if(!({value:sc}=Ua.ns(this.Pa.lEj)).returnValue||!this.Pa.lFj.isMatch(sc,Hb))return!1}if(this.Pa.BXi){let sc;if(!({value:sc}=Ua.ns(this.Pa.kEj)).returnValue||!this.Pa.BXi.isMatch(sc,Hb))return!1}return!0}}Object(f.a)(la,
"TextSpanFilter",null,[1176]);class Sa{constructor(Ua,Hb){Ua&&(this.hf=Hb.hf,this.lEj=Ua.J(0),this.kEj=Ua.J(1),this.Nxn=Ua.J(2),this.B$g=Ua.J(3)?Hb.Kza(Ua.J(3)):null,this.kYh=Ua.J(4)?Hb.Kza(Ua.J(4)):null,this.lFj=Ua.J(5)?Hb.Kza(Ua.J(5)):null,this.BXi=Ua.J(6)?Hb.Kza(Ua.J(6)):null)}}Object(f.a)(Sa,"TextSpanFilterInit",null,[]);class Pa{constructor(Ua,Hb){Ua&&(this.hf=Hb.hf,this.DGa=Ua.J(0),this.ogh=Ua.J(1)?Hb.Kza(Ua.J(1)):null)}}Object(f.a)(Pa,"ValueFilterAnnotationFilterInit",null,[]);var fb=b(1328);
class db{Kza(Ua,Hb){const $b=Ua.J(0),sc=new fb.a;sc.fFb(Ua,1,Ua.count-1);switch($b){case 1:return new P(new T(sc,Hb),0);case 2:return new P(new T(sc,Hb),1);case 3:return new P(new T(sc,Hb),2);case 101:return new Ma(new Ha(sc,Hb));case 103:return new qa(new ka(sc,Hb),0);case 104:return new qa(new ka(sc,Hb),1);case 105:return new qa(new ka(sc,Hb),2);case 106:return new qa(new ka(sc,Hb),3);case 107:return new qa(new ka(sc,Hb),4);case 108:return new qa(new ka(sc,Hb),5);case 109:return new qa(new ka(sc,
Hb),6);case 201:return new fa(new ra(sc));case 202:return new na(new W(sc,Hb));case 301:return new V(new I(sc,Hb),0);case 302:return new V(new I(sc,Hb),1);case 303:return new V(new I(sc,Hb),2);case 304:return new V(new I(sc,Hb),3);case 305:return new V(new I(sc,Hb),4);case 401:return new Aa(new Ba(sc),0);case 402:return new Aa(new Ba(sc),1);case 403:return new Aa(new Ba(sc),2);case 404:return new da(new ia(sc,Hb),0);case 405:return new da(new ia(sc,Hb),1);case 406:return new da(new ia(sc,Hb),2);case 407:return new da(new ia(sc,
Hb),3);case 501:return new F(new A(sc,Hb));case 502:return new va(new W(sc,Hb));case 601:return new B(new X(sc,Hb),0);case 602:return new B(new X(sc,Hb),1);case 603:return new E(new X(sc,Hb));case 604:return new ma(new W(sc,Hb),0);case 605:return new ma(new W(sc,Hb),1);case 606:return new ma(new W(sc,Hb),2);case 607:return new ma(new W(sc,Hb),3);case 701:return new N(!1);case 702:return new N(!0);case 703:return new J(new Pa(sc,Hb),!1);case 704:return new J(new Pa(sc,Hb),!0);case 705:return new M(new Pa(sc,
Hb),!1);case 706:return new M(new Pa(sc,Hb),!0);case 707:return new ba(new ha(sc,Hb));case 901:return new la(new Sa(sc,Hb));case 1002:return new ja(new W(sc,Hb));case 1001:return new xa(new za(sc,Hb));default:throw Error.argument("initData");}}}Object(f.a)(db,"FilterFactory",null,[1154]);var Qa=b(1296);class wb{constructor(Ua){this.Pa=Ua}get qH(){return this.Pa.qH}get Tca(){return this.Pa.Tca}get s0e(){return this.Pa.s0e}get dFe(){return this.Pa.dFe}load(Ua,Hb){return this.ev(Ua,Ua?new R("root",Ua,
Hb):Hb)}store(Ua,Hb,$b){this.FTc(Ua,Hb,Ua?new R("root",Ua,$b):$b,null)}ev(Ua,Hb){if(!this.dFe&&!this.Pa.hf.oKc(this.qH,Ua))throw Error.argument("input","Input value not of expected type");let $b=this.Pa.hpi;for(;$b;)Ua=$b.load(Ua,Hb),$b=$b.next;return Ua}FTc(Ua,Hb,$b,sc){if(!this.s0e)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.dFe&&!this.Pa.hf.oKc(this.qH,Ua))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Pa.hf.oKc(this.Tca,
Hb))throw Error.argument("rvalue","Rvalue not of expected type");return this.Pa.hpi.store(Ua,Hb,$b,sc)}static i8h(Ua,Hb,$b,sc){if($b===sc)return Hb;if(G.Annotations.yM($b)&&G.Annotations.yM(sc)){$b=G.Annotations.Vlb($b);sc=G.Annotations.Vlb(sc);const Wc=new Qa.a(Ua,sc);for(const dd of Hb.items)Array.add(Wc.items,wb.i8h(Ua,dd,$b,sc));return Wc}if($b===G.Annotations.vZa){if(sc===G.Annotations.JDa)return Hb;if(sc===G.Annotations.hia)return Hb.toString()}else if($b===G.Annotations.JDa){if(sc===G.Annotations.vZa)return Math.floor(Hb);
if(sc===G.Annotations.hia)return Hb.toString()}else if($b===G.Annotations.hia){if(sc===G.Annotations.vZa)return parseInt(Hb);if(sc===G.Annotations.JDa)return parseFloat(Hb)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(f.a)(wb,"AnnotationQuery",null,[1179]);class ib{constructor(){this.Tca=this.qH=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}amb(Ua){if(this.next)return{returnValue:this.next,vYa:Ua};if(Ua){const Hb=Ua.cai;Ua=Ua.cgj;return{returnValue:Hb,
vYa:Ua}}return{returnValue:null,vYa:Ua}}}Object(f.a)(ib,"AnnotationQueryStep",null,[1202]);class Ta extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){Hb=this.Pa.query.ev(Ua,Hb);if(G.Annotations.yM(this.qH)){var $b=G.Annotations.Vlb(this.qH);let Wc=new Qa.a(this.Pa.hf,$b);if(G.Annotations.yM(this.Pa.query.Tca)){if(Ua.items.length!==Hb.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let dd=0,td=Ua.items.length;dd<td;++dd)Array.add(Wc.items,
this.Ale(Ua.items[dd],Hb.items[dd],$b===G.Annotations.JDa))}else for(var sc of Ua.items)Array.add(Wc.items,this.Ale(sc,Hb,$b===G.Annotations.JDa));return Wc}if(G.Annotations.yM(this.Pa.query.Tca)){sc=new Qa.a(this.Pa.hf,this.qH);for($b of Hb.items)Array.add(sc.items,this.Ale(Ua,$b,this.qH===G.Annotations.JDa));return sc}return this.Ale(Ua,Hb,this.qH===G.Annotations.JDa)}Ale(Ua,Hb,$b){Ua=this.cAc(Ua,Hb);return $b?Ua:Math.floor(Ua)}}Object(f.a)(Ta,"NumericAnnotationQueryStep",ib,[]);class jb extends Ta{constructor(Ua){super(Ua)}cAc(Ua,
Hb){return Ua+Hb}}Object(f.a)(jb,"AddAnnotationQueryStep",Ta,[]);class $a extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){if(this.qH===G.Annotations.zLa&&this.Pa.query.Tca===G.Annotations.zLa){let Wc;if(({result:Wc}=this.x4h(Ua)).returnValue)return Wc}if(G.Annotations.yM(this.qH)){var $b=new Qa.a(this.Pa.hf,G.Annotations.zLa);Hb=this.Pa.query.ev(Ua,Hb);if(G.Annotations.yM(this.Pa.query.Tca)){if(Ua.items.length!==Hb.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");
for(let Wc=0,dd=Ua.items.length;Wc<dd;++Wc)Array.add($b.items,this.zld(Hb.items[Wc],Ua.items[Wc]))}else for(var sc of Ua.items)Array.add($b.items,this.zld(Hb,sc));return $b}sc=this.Pa.query.ev(Ua,Hb);if(G.Annotations.yM(this.Pa.query.Tca)){Hb=new Qa.a(this.Pa.hf,G.Annotations.zLa);for($b of sc.items)Array.add(Hb.items,this.zld($b,Ua));return Hb}return this.zld(sc,Ua)}}Object(f.a)($a,"BinaryBooleanAnnotationQueryStep",ib,[]);class ya extends $a{constructor(Ua){super(Ua)}x4h(Ua){return{returnValue:!Ua,
result:!1}}zld(Ua,Hb){return Ua&&Hb}}Object(f.a)(ya,"AndAnnotationQueryStep",$a,[]);class wa{constructor(Ua){Ua&&(this.hf=Ua)}}Object(f.a)(wa,"AnnotationsOnlyQueryStepInit",null,[]);class Fa extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){Hb=this.Pa.query.ev(Ua,Hb);Ua=Ua.clone();G.Annotations.yM(this.Pa.query.Tca)?Array.addRange(Ua.items,Hb.items):Array.add(Ua.items,Hb);return Ua}}Object(f.a)(Fa,"AppendAnnotationQueryStep",ib,[]);class bb extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,
Hb){if(this.qH===G.Annotations.t1)return this.Sqd(Ua,Hb);const $b=new Qa.a(this.Pa.hf,G.Annotations.t1);for(const sc of Ua.items)Array.add($b.items,this.Sqd(sc,Hb));return $b}Sqd(Ua,Hb){const $b=new D.a(this.Pa.hf);$b.Pib(Ua);Ua=new D.a(this.Pa.hf);this.Pa.script.mza(null,new R("Input",$b,new R("Output",Ua,Hb)));return Ua}}Object(f.a)(bb,"ApplyAnnotationQueryStep",ib,[]);class Eb extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){if(this.qH===G.Annotations.t1)return Hb=this.Sqd(Ua,Hb),Hb.ns(this.Pa.iYh).returnValue||
new Qa.a(this.Pa.hf,G.Annotations.t1),Hb;const $b=new Qa.a(this.Pa.hf,G.Annotations.t1);for(const sc of Ua.items)if(Ua=this.Sqd(sc,Hb),({value:Ua}=Ua.ns(this.Pa.iYh)).returnValue)for(const Wc of Ua.items)Array.add($b.items,Wc);return $b}Sqd(Ua,Hb){const $b=new D.a(this.Pa.hf);$b.Pib(Ua);Ua=new D.a(this.Pa.hf);this.Pa.script.mza(null,new R("Input",$b,new R("Output",Ua,Hb)));return Ua}}Object(f.a)(Eb,"ApplyExpandAnnotationQueryStep",ib,[]);class hb{constructor(Ua,Hb){Ua&&(this.hf=Hb.hf,this.script=
Hb.L8b(Ua.J(0)),this.iYh=Ua.J(1))}}Object(f.a)(hb,"ApplyExpandQueryStepInit",null,[]);class nb{constructor(Ua,Hb){Ua&&(this.hf=Hb.hf,this.script=Hb.L8b(Ua.J(0)))}}Object(f.a)(nb,"ApplyQueryStepInit",null,[]);class Pb extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua){if(this.qH===G.Annotations.t1)return this.eKe(Ua);const Hb=new Qa.a(this.Pa.hf,this.Pa.hf.getAttributeType(this.Pa.DGa));for(const $b of Ua.items)Array.add(Hb.items,this.eKe($b));return Hb}store(Ua,Hb,$b,sc){if(this.qH===G.Annotations.t1){var Wc=
Hb,dd=({vYa:sc}=this.amb(sc)).returnValue;dd&&(Wc=dd.store(G.Annotations.j_(this.eKe(Ua)),Hb,$b,sc));Ua.kB(this.Pa.DGa,Wc)}else{var td=Hb;if(Wc=({vYa:sc}=this.amb(sc)).returnValue){td=new Qa.a(this.Pa.hf,this.Pa.hf.getAttributeType(this.Pa.DGa));for(dd of Ua.items)Array.add(td.items,this.eKe(dd));td=Wc.store(td,Hb,$b,sc)}Hb=td;if(Hb.items.length!==Ua.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let oe=0,Ld=Ua.items.length;oe<Ld;++oe)$b=Ua.items[oe],
$b.isReadOnly&&($b=$b.clone(),Ua.items[oe]=$b),$b.kB(this.Pa.DGa,Hb.items[oe])}return Ua}eKe(Ua){({value:Ua}=Ua.ns(this.Pa.DGa)).returnValue||(Ua=this.Pa.hf.zsl(this.Pa.DGa));return Ua}}Object(f.a)(Pb,"AttrAnnotationQueryStep",ib,[]);class bc{constructor(Ua,Hb){Ua&&(this.hf=Hb,this.DGa=Ua.J(0))}}Object(f.a)(bc,"AttrQueryStepInit",null,[]);class gb extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua){const Hb=new D.a(this.Pa.hf);Hb.Pib(Ua);return this.Pa.module.execute(Hb)}}Object(f.a)(gb,"CallModuleAnnotationQueryStep",
ib,[]);class Lb{constructor(Ua,Hb){Ua&&(this.hf=Hb.hf,this.module=Hb.l$f(Ua.J(0)))}}Object(f.a)(Lb,"CallModuleQueryStepInit",null,[]);class Ic extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){if(G.Annotations.yM(this.qH)){var $b=this.Pa.query.ev(Ua,Hb);Hb=new Qa.a(this.Pa.hf,G.Annotations.hia);let dd="string"===typeof $b;for(var sc of Ua.items)if(dd)Array.add(Hb.items,sc+$b);else for(var Wc of $b.items)Array.add(Hb.items,sc+Wc);return Hb}sc=this.Pa.query.ev(Ua,Hb);if("string"===typeof sc)return Ua+
sc;Wc=new Qa.a(this.Pa.hf,G.Annotations.hia);for($b of sc.items)Array.add(Wc.items,Ua+$b);return Wc}}Object(f.a)(Ic,"ConcatAnnotationQueryStep",ib,[]);class vb extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua){return wb.i8h(this.Pa.hf,Ua,this.qH,this.Tca)}}Object(f.a)(vb,"ConvertAnnotationQueryStep",ib,[]);class xb extends ib{constructor(){super()}load(Ua){return Ua.items.length}}Object(f.a)(xb,"CountAnnotationQueryStep",ib,[]);class Db extends Ta{constructor(Ua){super(Ua)}cAc(Ua,Hb){return Ua/
Hb}}Object(f.a)(Db,"DivideAnnotationQueryStep",Ta,[]);class ab extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){Hb=new R(this.Pa.v4e,null,Hb);for(const $b of Ua.items)if(Hb.aLf($b),this.Pa.query.ev($b,Hb))return!0;return!1}}Object(f.a)(ab,"ExistsAnnotationQueryStep",ib,[]);class dc extends Ta{constructor(Ua){super(Ua)}cAc(Ua,Hb){return Math.pow(Ua,Hb)}}Object(f.a)(dc,"ExpAnnotationQueryStep",Ta,[]);class tb{constructor(Ua,Hb){Ua&&(this.c4a=Hb.getString(Ua.J(0)))}}Object(f.a)(tb,"FeatureBundleNameQueryStepInit",
null,[]);class yb extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua){if(G.Annotations.yM(this.qH)){const Hb=new Qa.a(this.Pa.hf,this.Pa.hf.l$b(G.Annotations.Vlb(this.qH),this.Pa.e4a));for(const $b of Ua.items)Array.add(Hb.items,$b.BFb(this.Pa.e4a));return Hb}return Ua.BFb(this.Pa.e4a)}store(Ua,Hb,$b,sc){if(G.Annotations.yM(this.qH)){var Wc=Hb,dd=({vYa:sc}=this.amb(sc)).returnValue;if(dd){Wc=new Qa.a(this.Pa.hf,this.Pa.hf.l$b(G.Annotations.Vlb(this.qH),this.Pa.e4a));for(var td of Ua.items)Array.add(Wc.items,
td.BFb(this.Pa.e4a));Wc=dd.store(Wc,Hb,$b,sc)}Hb=Wc;if(Hb.items.length!==Ua.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let oe=0,Ld=Ua.items.length;oe<Ld;++oe)$b=Ua.items[oe],$b.isReadOnly&&($b=$b.clone(),Ua.items[oe]=$b),$b.E0g(this.Pa.e4a,Hb.items[oe])}else dd=Hb,(td=({vYa:sc}=this.amb(sc)).returnValue)&&(dd=td.store(G.Annotations.j_(Ua.BFb(this.Pa.e4a)),Hb,$b,sc)),Ua.E0g(this.Pa.e4a,dd);return Ua}}Object(f.a)(yb,"FieldAnnotationQueryStep",
ib,[]);class rc{constructor(Ua,Hb){Ua&&(this.hf=Hb,this.e4a=Ua.J(0))}}Object(f.a)(rc,"FieldQueryStepInit",null,[]);class fc extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){for(const $b of Ua.items)if(this.Pa.filter.isMatch($b,Hb))return $b;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(Ua,Hb,$b,sc){let Wc=Hb,dd=-1;for(let oe=0,Ld=Ua.items.length;oe<Ld;oe++)if(this.Pa.filter.isMatch(Ua.items[oe],$b)){dd=oe;break}if(0>dd)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");
const td=({vYa:sc}=this.amb(sc)).returnValue;td&&(Wc=td.store(G.Annotations.j_(Ua.items[dd]),Hb,$b,sc));Ua.items[dd]=Wc;return Ua}}Object(f.a)(fc,"FirstItemMatchingAnnotationQueryStep",ib,[]);class uc extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){Hb=new R(this.Pa.v4e,null,Hb);for(const $b of Ua.items)if(Hb.aLf($b),!this.Pa.query.ev($b,Hb))return!1;return!0}}Object(f.a)(uc,"ForAllAnnotationQueryStep",ib,[]);class Uc extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){Ua=Hb?Hb.fxe(this.Pa.c4a):
null;if(!Ua)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Pa.c4a+'"');return Ua}store(Ua,Hb,$b,sc){Ua=$b?$b.fxe(this.Pa.c4a):null;if(!Ua)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Pa.c4a+'"');let Wc=Hb;const dd=({vYa:sc}=this.amb(sc)).returnValue;dd&&(Wc=dd.store(Ua,Hb,$b,sc));Ua!==Wc&&Ua.Pib(Wc);return Ua}}Object(f.a)(Uc,"GetAnnotationQueryStep",ib,[]);class tc{constructor(Ua,Hb){this.r6j=Ua;this.Qjk=Hb}get cai(){return this.r6j}get cgj(){return this.Qjk}}
Object(f.a)(tc,"AnnotationQueryStoreContinuation",null,[1209]);class Tb extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){return this.Pa.A1e.ev(Ua,Hb)?this.Pa.jLj.ev(Ua,Hb):this.Pa.Qte?this.Pa.Qte.ev(Ua,Hb):Ua}store(Ua,Hb,$b,sc){var Wc=this.Pa.A1e.ev(Ua,$b);this.next&&(sc=new tc(this.next,sc));if(Wc)return this.Pa.jLj.FTc(Ua,Hb,$b,sc);if(this.Pa.Qte)return this.Pa.Qte.FTc(Ua,Hb,$b,sc);Wc=Hb;let dd=null;sc&&(dd=sc.cai,sc=sc.cgj);dd&&(Wc=dd.store(G.Annotations.j_(Ua),Hb,$b,sc));return Wc}}Object(f.a)(Tb,
"IfAnnotationQueryStep",ib,[]);class qb{constructor(Ua,Hb){Ua&&(this.A1e=Hb.KP(Ua.J(0)),this.jLj=Hb.KP(Ua.J(1)),this.Qte=Ua.J(2)?Hb.KP(Ua.J(2)):null)}}Object(f.a)(qb,"IfQueryStepInit",null,[]);class Jb{constructor(Ua,Hb){Ua&&(this.V1l=Hb.KP(Ua.J(0)),this.YVi=Hb.KP(Ua.J(1)))}}Object(f.a)(Jb,"IndexAndItemQueryStepInit",null,[]);class Zb extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){const $b=this.Pa.V1l.ev(Ua,Hb);Hb=this.Pa.YVi.ev(Ua,Hb);Ua=Ua.clone();if(0>$b||$b>Ua.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");
if(G.Annotations.yM(this.Pa.YVi.Tca))for(let sc=0;sc<Hb.items.length;++sc)Array.insert(Ua.items,$b+sc,Hb.items[sc]);else Array.insert(Ua.items,$b,Hb);return Ua}}Object(f.a)(Zb,"InsertAtAnnotationQueryStep",ib,[]);class ec extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){return!(!Hb||!Hb.fxe(this.Pa.c4a))}}Object(f.a)(ec,"IsDefinedAnnotationQueryStep",ib,[]);class zc extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){Hb=this.PP(Ua,Hb);return Ua.items[Hb]}store(Ua,Hb,$b,sc){const Wc=
this.PP(Ua,$b);let dd=Hb;const td=({vYa:sc}=this.amb(sc)).returnValue;td&&(dd=td.store(G.Annotations.j_(Ua.items[Wc]),Hb,$b,sc));Ua.items[Wc]=dd;return Ua}PP(Ua,Hb){Hb=this.Pa.query.ev(Ua,Hb);if(0>Hb||Hb>=Ua.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Hb}}Object(f.a)(zc,"ItemAnnotationQueryStep",ib,[]);class Oc extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){const $b=new Qa.a(this.Pa.hf,G.Annotations.Vlb(this.qH));for(const sc of Ua.items)this.Pa.filter.isMatch(sc,
Hb)&&Array.add($b.items,sc);return $b}}Object(f.a)(Oc,"ItemsMatchingAnnotationQueryStep",ib,[]);class ud extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){Hb=this.PP(Ua,Hb);return Ua.items[Ua.items.length-Hb-1]}store(Ua,Hb,$b,sc){const Wc=this.PP(Ua,$b);let dd=Hb;const td=({vYa:sc}=this.amb(sc)).returnValue;td&&(dd=td.store(G.Annotations.j_(Ua.items[Ua.items.length-Wc-1]),Hb,$b,sc));Ua.items[Ua.items.length-Wc-1]=dd;return Ua}PP(Ua,Hb){Hb=this.Pa.query?this.Pa.query.ev(Ua,Hb):0;if(0>Hb||Hb>=
Ua.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return Hb}}Object(f.a)(ud,"LastItemAnnotationQueryStep",ib,[]);class Ad extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua){if(G.Annotations.yM(this.qH)){const Hb=new Qa.a(this.Pa.hf,G.Annotations.vZa);for(const $b of Ua.items)Array.add(Hb.items,$b.length);return Hb}return Ua.length}}Object(f.a)(Ad,"LengthAnnotationQueryStep",ib,[]);class xd extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){if(G.Annotations.yM(this.qH)){const $b=
new Qa.a(this.Pa.hf,G.Annotations.zLa);for(const sc of Ua.items)Array.add($b.items,this.Pa.filter.isMatch(sc,Hb));return $b}return this.Pa.filter.isMatch(Ua,Hb)}}Object(f.a)(xd,"MatchesAnnotationQueryStep",ib,[]);class re extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){return this.Pa.filter.isMatch(Ua,Hb)}}Object(f.a)(re,"MatchesAsListAnnotationQueryStep",ib,[]);class mc extends Ta{constructor(Ua){super(Ua)}cAc(Ua,Hb){return Ua%Hb}}Object(f.a)(mc,"ModuloAnnotationQueryStep",Ta,[]);class Ab extends Ta{constructor(Ua){super(Ua)}cAc(Ua,
Hb){return Ua*Hb}}Object(f.a)(Ab,"MultiplyAnnotationQueryStep",Ta,[]);class oc extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua){if(G.Annotations.yM(this.qH)){const Hb=new Qa.a(this.Pa.hf,G.Annotations.zLa);for(const $b of Ua.items)Array.add(Hb.items,!$b);return Hb}return!Ua}}Object(f.a)(oc,"NotAnnotationQueryStep",ib,[]);class Mc extends $a{constructor(Ua){super(Ua)}x4h(Ua){return{returnValue:Ua,result:!0}}zld(Ua,Hb){return Ua||Hb}}Object(f.a)(Mc,"OrAnnotationQueryStep",$a,[]);class Ec extends ib{constructor(Ua){super();
this.Pa=Ua}load(Ua,Hb){const $b=this.Pa.M7g.ev(Ua,Hb);Ua=this.Pa.Lmd.ev(Ua,Hb);Hb=new Qa.a(this.Pa.hf,G.Annotations.vZa);for(let sc=0;sc<Ua;++sc)Array.add(Hb.items,$b+sc);return Hb}}Object(f.a)(Ec,"RangeAnnotationQueryStep",ib,[]);class kd{constructor(Ua,Hb){Ua&&(this.hf=Hb.hf,this.filter=Hb.Kza(Ua.J(0)))}}Object(f.a)(kd,"SingleFilterQueryStepInit",null,[]);class Xd{constructor(Ua,Hb){Ua&&(this.hf=Hb.hf,this.query=Ua.J(0)?Hb.KP(Ua.J(0)):null)}}Object(f.a)(Xd,"SingleOptionalQueryQueryStepInit",null,
[]);class Bc{constructor(Ua,Hb){Ua&&(this.hf=Hb.hf,this.query=Hb.KP(Ua.J(0)))}}Object(f.a)(Bc,"SingleQueryQueryStepInit",null,[]);class jd{constructor(Ua,Hb){Ua&&(this.hf=Hb.hf,this.M7g=Hb.KP(Ua.J(0)),this.Lmd=Ua.J(1)?Hb.KP(Ua.J(1)):null)}}Object(f.a)(jd,"StartAndCountOrLengthQueryStepInit",null,[]);class Vc extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){let $b;({startIndex:Hb,length:$b}=this.Kze(Ua,Hb));const sc=new Qa.a(this.Pa.hf,Ua.qca);for(let Wc=0;Wc<$b;++Wc)Array.add(sc.items,Ua.items[Hb+
Wc]);return sc}store(Ua,Hb,$b,sc){let Wc,dd;({startIndex:Wc,length:dd}=this.Kze(Ua,$b));var td=Hb;const oe=({vYa:sc}=this.amb(sc)).returnValue;if(oe){td=new Qa.a(this.Pa.hf,Ua.qca);for(let Ld=0;Ld<dd;++Ld)Array.add(td.items,Ua.items[Wc+Ld]);td=oe.store(td,Hb,$b,sc)}Hb=td;for($b=0;$b<dd;++$b)Array.removeAt(Ua.items,Wc);for(let Ld=0,Mf=Hb.items.length;Ld<Mf;++Ld)Array.insert(Ua.items,Wc+Ld,Hb.items[Ld]);return Ua}Kze(Ua,Hb){let $b;$b=this.Pa.M7g.ev(Ua,Hb);if(0>$b)throw Error.invalidOperation("Invalid start index in Sublist() query step");
Hb=this.Pa.Lmd?this.Pa.Lmd.ev(Ua,Hb):Ua.items.length-$b;if(0>Hb||$b+Hb>Ua.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:$b,length:Hb}}}Object(f.a)(Vc,"SublistAnnotationQueryStep",ib,[]);class Ye extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua,Hb){if(G.Annotations.yM(this.qH)){const $b=new Qa.a(this.Pa.hf,G.Annotations.hia);for(let sc=0,Wc=Ua.items.length;sc<Wc;++sc)Array.add($b.items,this.FEi(Ua.items[sc],Hb));return $b}return this.FEi(Ua,
Hb)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}FEi(Ua,Hb){let $b;({startIndex:Hb,length:$b}=this.Kze(Ua,Hb));return Ua.substr(Hb,$b)}Kze(Ua,Hb){let $b;$b=this.Pa.M7g.ev(Ua,Hb);if(0>$b)throw Error.invalidOperation("Invalid start index in Substring() query step");Hb=this.Pa.Lmd?this.Pa.Lmd.ev(Ua,Hb):Ua.length-$b;if(0>Hb||$b+Hb>Ua.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:$b,length:Hb}}}
Object(f.a)(Ye,"SubstringAnnotationQueryStep",ib,[]);class Cd extends Ta{constructor(Ua){super(Ua)}cAc(Ua,Hb){return Ua-Hb}}Object(f.a)(Cd,"SubtractAnnotationQueryStep",Ta,[]);class of extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua){const Hb=new Qa.a(this.Pa.hf,G.Annotations.hia);for(let $b=0;$b<Ua.length;++$b)Array.add(Hb.items,Ua.charAt($b).toString());return Hb}}Object(f.a)(of,"ToCharListAnnotationQueryStep",ib,[]);class Je extends ib{constructor(Ua){super();this.Pa=Ua}load(Ua){const Hb=
new Qa.a(this.Pa.hf,this.qH);Array.add(Hb.items,Ua);return Hb}}Object(f.a)(Je,"ToListAnnotationQueryStep",ib,[]);class gd extends ib{constructor(Ua){super();this.Pa=Ua}load(){return this.Pa.value}}Object(f.a)(gd,"ValueAnnotationQueryStep",ib,[]);class Te{constructor(Ua,Hb){if(Ua){var $b=Ua.J(0),sc=1;this.value=({asa:sc}=Hb.Wya($b,Ua,sc,null,null,null)).returnValue;G.Annotations.yec(this.value)}}}Object(f.a)(Te,"ValueQueryStepInit",null,[]);class cg{constructor(Ua,Hb){Ua&&(this.v4e=Hb.getString(Ua.J(0)),
this.query=Hb.KP(Ua.J(1)))}}Object(f.a)(cg,"VarNameAndQueryQueryStepInit",null,[]);class Jg{constructor(Ua,Hb){this.zwh=null;if(Ua){this.hf=Hb.hf;var $b=0;this.qH=Ua.J($b);++$b;this.Tca=Ua.J($b);++$b;this.s0e=1===Ua.J($b);++$b;this.dFe=1===Ua.J($b);++$b;var sc=Ua.J($b);++$b;if(sc){var Wc=$b,dd=$b+sc,td=$b+2*sc;$b+=3*sc;var oe=Ua.count-$b,Ld=null;for(let Rf=0;Rf<sc;++Rf){var Mf=$b+Ua.J(td+Rf);const yi=(Rf===sc-1?oe:Ua.J(td+Rf+1))-Ua.J(td+Rf),$i=new fb.a;$i.fFb(Ua,Mf,yi);Mf=Jg.YGl(Ua.J(dd+Rf),$i,Hb);
Mf.qH=Ua.J(Wc+Rf);Mf.Tca=Rf===sc-1?this.Tca:Ua.J(Wc+Rf+1);Ld?Ld.next=Mf:this.zwh=Mf;Ld=Mf}}}}get hpi(){return this.zwh}static YGl(Ua,Hb,$b){switch(Ua){case 1:return new Uc(new tb(Hb,$b));case 2:return new ec(new tb(Hb,$b));case 3:return new Pb(new bc(Hb,$b.hf));case 4:return new yb(new rc(Hb,$b.hf));case 5:return new Tb(new qb(Hb,$b));case 6:return new xd(new kd(Hb,$b));case 43:return new re(new kd(Hb,$b));case 45:return new bb(new nb(Hb,$b));case 49:return new Eb(new hb(Hb,$b));case 46:return new gd(new Te(Hb,
$b.hf));case 51:return new gb(new Lb(Hb,$b));case 52:return new Ec(new jd(Hb,$b));case 53:return new vb(new wa($b.hf));case 13:return new zc(new Bc(Hb,$b));case 14:return new ud(new Xd(Hb,$b));case 15:return new xb;case 18:return new fc(new kd(Hb,$b));case 16:return new uc(new cg(Hb,$b));case 17:return new ab(new cg(Hb,$b));case 22:return new Zb(new Jb(Hb,$b));case 24:return new Fa(new Bc(Hb,$b));case 26:return new Vc(new jd(Hb,$b));case 27:return new Oc(new kd(Hb,$b));case 30:return new Je(new wa($b.hf));
case 31:return new Ye(new jd(Hb,$b));case 32:return new Ic(new Bc(Hb,$b));case 47:return new Ad(new wa($b.hf));case 48:return new of(new wa($b.hf));case 34:return new jb(new Bc(Hb,$b));case 35:return new Cd(new Bc(Hb,$b));case 36:return new Ab(new Bc(Hb,$b));case 37:return new Db(new Bc(Hb,$b));case 38:return new mc(new Bc(Hb,$b));case 39:return new dc(new Bc(Hb,$b));case 40:return new ya(new Bc(Hb,$b));case 41:return new Mc(new Bc(Hb,$b));case 42:return new oc(new wa($b.hf));default:throw Error.argument("currStepInitData");
}}}Object(f.a)(Jg,"AnnotationQueryInit",null,[]);class Ga{constructor(Ua){this.Pa=Ua}execute(Ua,Hb){this.mza(Ua,Ua?new R("root",Ua,Hb):Hb)}mza(Ua,Hb){for(const $b of this.Pa.commands)Hb=$b.execute(Ua,Hb)}}Object(f.a)(Ga,"AnnotationScript",null,[1178]);class Oa{constructor(Ua){this.Pa=Ua}execute(Ua,Hb){const $b=this.Pa.N4l.ev(Ua,Hb),sc=this.Pa.XMm.ev(Ua,Hb);this.Pa.script.mza(Ua,new R("Input",$b,new R("Output",sc,Hb)));return Hb}}Object(f.a)(Oa,"ApplyAnnotationScriptCommand",null,[1200]);class Wb{constructor(Ua,
Hb){Ua&&(this.N4l=Hb.KP(Ua.J(0)),this.XMm=Hb.KP(Ua.J(1)),this.script=Hb.L8b(Ua.J(2)))}}Object(f.a)(Wb,"ApplyScriptCommandInit",null,[]);class Ac{constructor(Ua){this.Pa=Ua}execute(Ua,Hb){const $b=this.Pa.BYg.ev(Ua,Hb);this.Pa.JKe.FTc(Ua,$b,Hb,null);return Hb}}Object(f.a)(Ac,"AssignAnnotationScriptCommand",null,[1200]);class sd{constructor(Ua){this.Pa=Ua}execute(Ua,Hb){const $b=this.Pa.JKe.ev(Ua,Hb);Ua=this.Pa.BYg.ev(Ua,Hb);$b!==Ua&&$b.Pib(Ua);return Hb}}Object(f.a)(sd,"CopyAnnotationScriptCommand",
null,[1200]);class Xe{constructor(Ua){this.Pa=Ua}execute(Ua,Hb){let $b=this.Pa.Ivg.ev(Ua,Hb);if(this.Pa.Ivg.s0e){$b=G.Annotations.j_($b);var sc=new R(this.Pa.c4a,null,Hb);for(let dd=0,td=$b.items.length;dd<td;++dd){var Wc=this.Rli(Ua,$b.items[dd],sc);if(0>this.Pa.DVe)$b.items[dd]=Wc;else if(({value:Wc}=Wc.ns(this.Pa.DVe)).returnValue)$b.items[dd]=Wc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Pa.Ivg.FTc(Ua,$b,Hb,null)}else{sc=new R(this.Pa.c4a,
null,Hb);for(let dd=0,td=$b.items.length;dd<td;++dd)this.Rli(Ua,$b.items[dd],sc)}return Hb}Rli(Ua,Hb,$b){let sc;0>this.Pa.DVe?sc=G.Annotations.j_(Hb):(sc=new D.a(this.Pa.hf),sc.kB(this.Pa.DVe,Hb));$b.aLf(sc);this.Pa.zHk.mza(Ua,$b);return sc}}Object(f.a)(Xe,"EnumerateAnnotationScriptCommand",null,[1200]);class xe{constructor(Ua,Hb){Ua&&(this.hf=Hb.hf,this.c4a=Hb.getString(Ua.J(0)),this.Ivg=Hb.KP(Ua.J(1)),this.zHk=Hb.L8b(Ua.J(2)),this.DVe=Ua.J(3))}}Object(f.a)(xe,"EnumerateScriptCommandInit",null,[]);
class we{constructor(Ua){this.Pa=Ua}execute(Ua,Hb){this.Pa.A1e.ev(Ua,Hb)?this.Pa.QGn.mza(Ua,Hb):this.Pa.Umi&&this.Pa.Umi.mza(Ua,Hb);return Hb}}Object(f.a)(we,"IfAnnotationScriptCommand",null,[1200]);class bf{constructor(Ua,Hb){Ua&&(this.A1e=Hb.KP(Ua.J(0)),this.QGn=Hb.L8b(Ua.J(1)),this.Umi=Ua.J(2)?Hb.L8b(Ua.J(2)):null)}}Object(f.a)(bf,"IfScriptCommandInit",null,[]);class ch{constructor(Ua,Hb){Ua&&(this.hf=Hb.hf,this.JKe=Hb.KP(Ua.J(0)),this.BYg=Hb.KP(Ua.J(1)))}}Object(f.a)(ch,"LvalueAndRvalueQueryScriptCommandInit",
null,[]);class Pf{constructor(Ua){this.Pa=Ua}execute(Ua,Hb){const $b=this.Pa.BYg.ev(this.Pa.JKe.ev(Ua,Hb),Hb);this.Pa.JKe.FTc(Ua,$b,Hb,null);return Hb}}Object(f.a)(Pf,"ModifyAnnotationScriptCommand",null,[1200]);class Eg{constructor(Ua){this.Pa=Ua}execute(Ua,Hb){const $b=new D.a(this.Pa.hf);this.Pa.query&&$b.Pib(this.Pa.query.ev(Ua,Hb));return Hb=new R(this.Pa.c4a,$b,Hb)}}Object(f.a)(Eg,"NewAnnotationScriptCommand",null,[1200]);class th{constructor(Ua,Hb){Ua&&(this.hf=Hb.hf,this.c4a=Hb.getString(Ua.J(0)),
this.query=Ua.J(1)?Hb.KP(Ua.J(1)):null)}}Object(f.a)(th,"NewScriptCommandInit",null,[]);class Ph{constructor(Ua){this.Pa=Ua}execute(Ua,Hb){Ua=this.Pa.query.ev(Ua,Hb);if(this.Pa.query.Tca===G.Annotations.t1)Ua.RLb(this.Pa.DGa);else for(const $b of Ua.items)$b.RLb(this.Pa.DGa);return Hb}}Object(f.a)(Ph,"RemoveAnnotationScriptCommand",null,[1200]);class pf{constructor(Ua,Hb){Ua&&(this.hf=Hb.hf,this.query=Hb.KP(Ua.J(0)),this.DGa=Ua.J(1))}}Object(f.a)(pf,"RemoveScriptCommandInit",null,[]);class rk{constructor(Ua,
Hb){if(Ua){var $b=0,sc=Ua.J($b);++$b;if(sc){var Wc=$b,dd=$b+sc;$b+=2*sc;var td=Ua.count-$b;this.commands=Array(sc);for(let oe=0;oe<sc;++oe){const Ld=$b+Ua.J(dd+oe),Mf=(oe===sc-1?td:Ua.J(dd+oe+1))-Ua.J(dd+oe),Rf=new fb.a;Rf.fFb(Ua,Ld,Mf);this.commands[oe]=rk.PGl(Ua.J(Wc+oe),Rf,Hb)}}}}static PGl(Ua,Hb,$b){switch(Ua){case 1:return new Ac(new ch(Hb,$b));case 2:return new Pf(new ch(Hb,$b));case 3:return new Ph(new pf(Hb,$b));case 6:return new Eg(new th(Hb,$b));case 7:return new Xe(new xe(Hb,$b));case 8:return new we(new bf(Hb,
$b));case 9:return new sd(new ch(Hb,$b));case 10:return new Oa(new Wb(Hb,$b));default:throw Error.argument("initData");}}}Object(f.a)(rk,"AnnotationScriptInit",null,[]);var Xi=b(1462);class Vf{constructor(Ua){this.uC=Ua;this.Bx=0}oha(){const Ua=this.uC.hB(this.Bx,4);this.Bx+=4;return Ua}get Thd(){return this.uC}get offset(){return this.Bx}set offset(Ua){this.Bx=Ua}}Object(f.a)(Vf,"ByteArrayReader",null,[]);class Qc{constructor(){this.cO=null;this.e2i=this.ena=0}J(Ua){if(0>Ua||Ua>=this.ena)throw Error.argumentOutOfRange("index");
return this.cO.hB(this.e2i+4*Ua,4)}get count(){return this.ena}static $0k(Ua,Hb,$b){const sc=new Qc;sc.cO=Ua;sc.e2i=Hb;sc.ena=$b;return sc}}Object(f.a)(Qc,"ReadOnlyListOverByteArray",null,[1173]);class pd{constructor(Ua,Hb){this.Y1i=this.X1i=!1;this.Jy=this.K6a=this.hyg=this.a2i=null;try{this.Jy=Hb.hf;const $b=Hb.lFb(Ua.J(0)),sc=new Vf($b);if(-914743053!==sc.oha())throw Error.argument("Input does not represent a flat lexicon");this.X1i=1===sc.oha();this.Y1i=1===sc.oha();const Wc=sc.oha();sc.offset+=
Wc;const dd=sc.oha();this.hyg=pd.KOm(sc,dd,this.Jy);const td=sc.oha();this.a2i=pd.aPm(sc,td);const oe=sc.oha();this.K6a=new Xi.a(sc.Thd,sc.offset);sc.offset+=oe}catch($b){throw Error.argument("initData");}}get trie(){return this.K6a}Xtl(Ua){return"i"===Ua&&this.Y1i?"\u0130":Ua.toUpperCase()}Emg(){return this.X1i}Xrl(Ua){let Hb;Hb=new Qa.a(this.Jy,G.Annotations.t1);if(1!==Ua)if(0===Ua)Ua=new D.a(this.Jy),Array.add(Hb.items,Ua);else if(Ua&1073741824){Ua=this.a2i[Ua&-1073741825];for(let sc=0;sc<Ua.length;++sc){var $b=
Ua[sc];$b=0===$b?new D.a(this.Jy):this.hyg[$b-2];Array.add(Hb.items,$b)}}else Array.add(Hb.items,this.hyg[Ua-2]);return{returnValue:!0,ukm:Hb}}static KOm(Ua,Hb,$b){if(Hb%4)throw Error.argument("reader");const sc=Qc.$0k(Ua.Thd,Ua.offset,Hb/4);Ua.offset+=Hb;Ua=[];for(Hb=0;Hb<sc.count;){const Wc=({asa:Hb}=$b.Wya(G.Annotations.t1,sc,Hb,null,null,null)).returnValue;Array.add(Ua,Wc)}return Ua}static aPm(Ua,Hb){Hb=Ua.offset+Hb;const $b=[];for(;Ua.offset<Hb;){const sc=Ua.oha(),Wc=Array(sc);for(let dd=0;dd<
sc;++dd){const td=Ua.oha();Wc[dd]=td}Array.add($b,Wc)}return $b}}Object(f.a)(pd,"RawFlatLexicon",null,[1177]);var mf=b(1452),ef=b(1453);class Ae{constructor(Ua){if(null==Ua)throw Error.argumentNull("base64String");const Hb=Ua.length;if(Hb%4)throw Error.argument("base64String's length must be a multiple of 4");this.ena=.75*Hb;this.Sec=Array(Math.ceil(this.ena/4));Ua.endsWith("==")?this.ena-=2:Ua.endsWith("=")&&--this.ena;let $b=0;for(let sc=0;sc<Hb;sc+=4){const Wc=Ae.iWe[Ua.charCodeAt(sc)-43]<<18|
Ae.iWe[Ua.charCodeAt(sc+1)-43]<<12|Ae.iWe[Ua.charCodeAt(sc+2)-43]<<6|Ae.iWe[Ua.charCodeAt(sc+3)-43];let dd=Wc>>16&255;this.Sec[Math.floor($b/4)]|=dd<<$b%4*8;++$b;dd=Wc>>8&255;this.Sec[Math.floor($b/4)]|=dd<<$b%4*8;++$b;dd=Wc&255;this.Sec[Math.floor($b/4)]|=dd<<$b%4*8;++$b}}get length(){return this.ena}J(Ua){if(0>Ua||Ua>=this.ena)throw Error.argumentOutOfRange("i");return this.Rti(Ua)}hB(Ua,Hb){if(0>Ua||0>Hb||Ua+Hb>this.ena)throw Error.argument("Bad range");let $b=0;for(let sc=0;sc<Hb;++sc)$b|=this.Rti(Ua+
sc)<<8*sc;return $b}m_m(Ua,Hb){let $b=0,sc=0,Wc=Math.floor(Ua/8);for(Ua%=8;sc<Hb;){const dd=8-Ua>Hb-sc?Hb-sc:8-Ua,td=this.J(Wc);$b|=(td>>Ua&~(255<<dd))<<sc;sc+=dd;++Wc;Ua=0}return $b}Rti(Ua){return this.Sec[Math.floor(Ua/4)]>>Ua%4*8&255}}Ae.iWe=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(f.a)(Ae,"ByteArray",null,[]);class id{constructor(Ua,
Hb,$b){this.xH=Ua;this.Dsm=Hb;this.Gsm=$b;this.m2i=Array(Ua.b?Ua.b.length:0);this.Dyg=new mf.a(new ef.a(this.lFb(this.xH.s)));this.Oga=Array(Ua.t.length);this.mJ=new G.Annotations(this.kFb(0),this)}get hf(){return this.mJ}get Qcl(){return this.xH.d}qGl(){if(!(""in this.xH.m))throw Error.argument("name","Unrecognized module");return this.l$f(this.xH.m[""])}lFb(Ua){if(0>Ua||!this.xH.b||Ua>=this.xH.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.m2i[Ua]||(this.m2i[Ua]=new Ae(this.xH.b[Ua]))}getString(Ua){if(1>
Ua||Ua>=this.xH.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.xH.t[Ua])throw Error.argument("blobID","Requested blob is not a string");if(null==this.Oga[Ua]){const Hb=this.kFb(Ua).J(0);this.Oga[Ua]=this.Dyg.getString(Hb)}return this.Oga[Ua]}EGc(Ua){if(1>Ua||Ua>=this.xH.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.xH.t[Ua])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.Oga[Ua]){var Hb=this.kFb(Ua);const $b=this.getString(Hb.J(0));Hb=1===Hb.J(1);
this.Oga[Ua]=new RegExp($b,Hb?"i":"")}return this.Oga[Ua]}lNl(Ua){if(1>Ua||Ua>=this.xH.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.xH.t[Ua])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}l$f(Ua){if(1>Ua||Ua>=this.xH.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.xH.t[Ua])throw Error.argument("blobID","Requested blob is not an NL module");return this.Oga[Ua]||(this.Oga[Ua]=this.Gsm.GGl(this.kFb(Ua),this))}KP(Ua){if(1>Ua||
Ua>=this.xH.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.xH.t[Ua])throw Error.argument("blobID","Requested blob is not an annotation query");return this.Oga[Ua]||(this.Oga[Ua]=new wb(new Jg(this.kFb(Ua),this)))}L8b(Ua){if(1>Ua||Ua>=this.xH.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.xH.t[Ua])throw Error.argument("blobID","Requested blob is not an annotation script");return this.Oga[Ua]||(this.Oga[Ua]=new Ga(new rk(this.kFb(Ua),this)))}Kza(Ua){if(1>Ua||Ua>=this.xH.t.length)throw Error.argumentOutOfRange("blobID");
if(7!==this.xH.t[Ua])throw Error.argument("blobID","Requested blob is not a filter");return this.Oga[Ua]||(this.Oga[Ua]=this.Dsm.Kza(this.kFb(Ua),this))}GLl(Ua){if(1>Ua||Ua>=this.xH.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.xH.t[Ua])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.Oga[Ua]||(this.Oga[Ua]=new pd(this.kFb(Ua),this))}kFb(Ua){const Hb=this.xH.n[Ua];Ua=(Ua<this.xH.t.length-1?this.xH.n[Ua+1]:this.xH.n.length)-Hb;if(0>Hb||0>Ua||Hb+
Ua>this.xH.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Hb+","+Ua+")");const $b=new fb.a;$b.O3f(this.xH.n,Hb,Ua);return $b}}Object(f.a)(id,"ObjectFetcher",null,[1153]);class Ah{constructor(Ua,Hb,$b){if(!Ua)throw Error.argumentNull("prediction");if(!Hb)throw Error.argumentNull("fieldNames");if(!$b)throw Error.argumentNull("values");if(Hb.length!==$b.length)throw Error.argument("values","fieldNames and values do not have same length");this.Fjk=Ua;this.Tec=Hb;this.AHd=
$b}get prediction(){return this.Fjk}get xni(){return this.Tec.length}n8f(Ua){return 0<=Ua&&Ua<this.Tec.length?this.Tec[Ua]:null}getValue(Ua){return 0<=Ua&&Ua<this.AHd.length?this.AHd[Ua]:null}}Object(f.a)(Ah,"PredictionData",null,[]);class Bh{constructor(Ua,Hb){if(!Ua)throw Error.argumentNull("predictions");if(!Hb)throw Error.argumentNull("tokenAttributes");this.Jsm=Ua;this.Osm=Hb}Lag(){return this.Jsm}Ssi(){return this.Osm}}Object(f.a)(Bh,"PredictionDataWithTokenAttributes",null,[]);class wg{constructor(Ua,
Hb){this.prediction=null;this.score=0;this.prediction=Ua;this.score=Hb}}Object(f.a)(wg,"PredictionWithScore",null,[]);class li{constructor(Ua,Hb){if(!Ua)throw Error.argumentNull("predictions");if(!Hb)throw Error.argumentNull("attributes");this.Gjk=Ua;this.a3j=Hb}Lag(){return this.Gjk}Ssi(){return this.a3j}}Object(f.a)(li,"PredictionsWithTokenAttributes",null,[]);class Hh{constructor(Ua,Hb,$b){if(!Ua)throw Error.argumentNull("attributeName");if(!Hb)throw Error.argumentNull("fieldNames");if(!$b)throw Error.argumentNull("values");
if(Hb.length!==$b.length)throw Error.argument("values","fieldNames and values do not have same length");this.$2j=Ua;this.Tec=Hb;this.AHd=$b}get attributeName(){return this.$2j}get xni(){return this.Tec.length}n8f(Ua){return 0<=Ua&&Ua<this.Tec.length?this.Tec[Ua]:null}getValue(Ua){return 0<=Ua&&Ua<this.AHd.length?this.AHd[Ua]:null}}Object(f.a)(Hh,"TokenAttributes",null,[]);var vj=b(41),uh=b(632);class ai{constructor(Ua,Hb,$b,sc,Wc){this.N1d=0;this.hih=null;this.O1d=this.rWc=0;this.v5e=this.Cpc=this.gEa=
this.sWc=null;this.iih=0;this.fof=this.Ps=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.lZ=Ua;this.XVj=this.aWj=Hb;this.WVj=this.ZVj=$b;this.L1d=this.YVj=sc;this.M1d=this.$Vj=Wc}bWj(){this.O1d=0;return this.fih}fih(){if(!(this.O1d<this.L1d))return this.gih;this.sWc=this.XVj.items[this.O1d+this.WVj];this.gEa=new D.a(this.lZ.Pa.hf);1!==this.L1d&&this.lZ.Pa.PBd||this.gEa.Pib(this.sWc);if(0<=this.lZ.Pa.ZLe){({value:this.Cpc}=
this.gEa.ns(this.lZ.Pa.ZLe)).returnValue?this.Cpc=this.Cpc.j_():this.Cpc=new Qa.a(this.lZ.Pa.hf,G.Annotations.t1);this.v5e=this.M1d.items;this.iih=this.v5e.length;for(this.N1d=0;this.N1d<this.iih;++this.N1d)this.hih=this.v5e[this.N1d],Array.add(this.Cpc.items,this.hih);this.gEa.kB(this.lZ.Pa.ZLe,this.Cpc)}else 0<=this.lZ.Pa.q6g?this.gEa.kB(this.lZ.Pa.q6g,this.M1d.items[0]):0<=this.lZ.Pa.DHf?this.gEa.kB(this.lZ.Pa.DHf,!0):this.lZ.Pa.nTi?this.M1d.items[0].ave((Ua,Hb)=>this.gEa.kB(Ua,Hb)):(this.gEa.Pib(this.M1d.items[0]),
1!==this.L1d&&this.lZ.Pa.PBd||(({value:this.rWc}=this.sWc.ns(this.lZ.Pa.saa)).returnValue&&this.gEa.kB(this.lZ.Pa.saa,this.rWc),({value:this.rWc}=this.sWc.ns(this.lZ.Pa.afa)).returnValue&&this.gEa.kB(this.lZ.Pa.afa,this.rWc),this.sWc.ns(this.lZ.Pa.lCb).returnValue&&this.gEa.kB(this.lZ.Pa.lCb,this.rWc)));this.Ps=this.gEa;this._state=2;return this.dWj}gih(){this._state=3}cWj(){this.O1d++;return this.fih}dWj(){return 1<this.L1d&&this.lZ.Pa.PBd?this.gih:this.cWj}dispose(){}getEnumerator(){return-1===
this._state?(this._state=0,this):(new ai(this.lZ,this.aWj,this.ZVj,this.YVj,this.$Vj)).getEnumerator()}[Symbol.iterator](){return Object(uh.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.fof=this.bWj());for(;1===this._state;)this.fof=this.fof();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.Ps}}Object(f.a)(ai,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",
null,[12,80,114]);class pk{constructor(Ua,Hb,$b){this.yHd=this.f2i=0;this.iMc=null;this.Eyg=this.nyg=this.gMc=this.KKe=this.qyg=0;this.LKe=!1;this.zyg=Ua;this.Gyg=Hb;this.Ism=$b}yAi(){null===this.iMc&&({AIj:this.iMc,pLi:this.qyg,length:this.KKe,zil:Ua}=this.zyg.TFi(this.Gyg.items[this.yHd],this.Ism),this.LKe=Ua||this.LKe);if(this.gMc<this.KKe){var Ua=this.iMc.charAt(this.qyg+this.gMc);++this.gMc;return{returnValue:!0,ch:Ua}}if(this.yHd===this.Gyg.items.length-1)return{returnValue:!1,ch:"\x00"};++this.yHd;
this.gMc=0;this.iMc=null;return{returnValue:!0,ch:" "}}ETg(Ua,Hb){this.gMc===this.KKe&&this.iMc&&(this.Eyg=Hb,this.nyg=this.yHd-this.f2i+1)}abn(Ua){if(0>Ua||Ua>=this.Gyg.items.length)throw Error.argumentOutOfRange("iToken");this.yHd=this.f2i=Ua;this.iMc=null;this.nyg=this.gMc=this.KKe=this.qyg=0;this.Eyg=-1;this.LKe=!1}uFl(){return{HLk:this.nyg,Eim:this.Eyg,yil:this.LKe}}}Object(f.a)(pk,"TriePrefixVisitor",null,[1188]);class fk{constructor(Ua){this.Pa=Ua}execute(Ua){if(!({value:$b}=Ua.ns(this.Pa.u2a)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let Hb;({value:Hb}=Ua.ns(this.Pa.Dhb)).returnValue||(Hb=null);var $b=this.erl($b,Hb);Ua=G.Annotations.j_(Ua);Ua.kB(this.Pa.u2a,$b);return Ua}erl(Ua,Hb){let $b=null;const sc=this.Pa.flatLexicon.trie,Wc=new pk(this,Ua,Hb);let dd=null;this.Pa.flatLexicon.Emg()&&(dd=Object(vj.a)(this.Pa.flatLexicon,this.Pa.flatLexicon.Xtl,"getCaseInsensitiveForm"));let td=0,oe;var Ld;let Mf;for(;td<Ua.items.length;){const Rf=Ua.items[td];Wc.abn(td);sc.jSj(Wc,dd);({HLk:oe,Eim:Ld,yil:Mf}=Wc.uFl());if(0<oe){({ukm:Ld}=this.Pa.flatLexicon.Xrl(Ld));
for(let yi of this.D2k(Ua,td,oe,Ld)){1<oe&&this.Pa.PBd&&this.j3k(Ua,Hb,td,Rf,oe,Mf,yi);if(!$b)for($b=new Qa.a(this.Pa.hf,G.Annotations.t1),Ld=0;Ld<td;++Ld)Array.add($b.items,Ua.items[Ld]);Array.add($b.items,yi)}td+=oe}else $b&&Array.add($b.items,Rf),++td}return $b||Ua}j3k(Ua,Hb,$b,sc,Wc,dd,td){if(dd)dd=!0;else if(this.Pa.dTi){dd=!1;var oe=-1;for(var Ld=0;Ld<Wc;Ld++){var Mf=Ua.items[$b+Ld];let he;var Rf=void 0;if(!({value:he}=Mf.ns(this.Pa.saa)).returnValue||!({value:Rf}=Mf.ns(this.Pa.afa)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<Ld){if(he>oe+1){dd=!0;break}if(0>oe||null===Hb||oe>=Hb.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Hb.charAt(oe)){dd=!0;break}}oe=he+Rf}}else dd=!1;if(dd){Rf=new Sys.StringBuilder;for(dd=0;dd<Wc;++dd)({AIj:oe,pLi:Ld,length:Mf}=this.TFi(Ua.items[$b+dd],Hb)),0<dd&&Rf.append(" "),Rf.append(oe.substr(Ld,Mf));td.kB(this.Pa.lCb,Rf.toString())}Ua=Ua.items[$b+Wc-1];let yi,$i;({value:sc}=sc.ns(this.Pa.saa)).returnValue&&
({value:yi}=Ua.ns(this.Pa.saa)).returnValue&&({value:$i}=Ua.ns(this.Pa.afa)).returnValue?(td.kB(this.Pa.saa,sc),td.kB(this.Pa.afa,yi+$i-sc)):(td.RLb(this.Pa.saa),td.RLb(this.Pa.afa))}D2k(Ua,Hb,$b,sc){return new ai(this,Ua,Hb,$b,sc)}TFi(Ua,Hb){let $b,sc;if(({value:$b}=Ua.ns(this.Pa.lCb)).returnValue)sc=!0,Hb=0,Ua=$b.length;else{sc=!1;if(null===Hb)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");$b=Hb;if(!({value:Hb}=Ua.ns(this.Pa.saa)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:Ua}=Ua.ns(this.Pa.afa)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Hb||0>Ua||Hb+Ua>$b.length)throw Error.argument("Token start/length values out of range","token");}return{AIj:$b,pLi:Hb,length:Ua,zil:sc}}}Object(f.a)(fk,"FlatLexiconNLModule",null,[1172]);class ak{constructor(Ua,Hb){this.DHf=this.ZLe=this.q6g=this.lCb=this.afa=this.saa=this.Dhb=this.u2a=0;this.nTi=this.dTi=this.PBd=!1;this.flatLexicon=null;this.hf=Hb.hf;let $b=
0;try{this.u2a=Ua.J($b),++$b,this.Dhb=Ua.J($b),++$b,this.saa=Ua.J($b),++$b,this.afa=Ua.J($b),++$b,this.lCb=Ua.J($b),++$b,this.q6g=Ua.J($b),++$b,this.ZLe=Ua.J($b),++$b,this.DHf=Ua.J($b),++$b,this.PBd=1===Ua.J($b),++$b,this.dTi=1===Ua.J($b),++$b,this.nTi=1===Ua.J($b),++$b,this.flatLexicon=Hb.GLl(Ua.J($b))}catch(sc){throw Error.argument("initData");}}}Object(f.a)(ak,"FlatLexiconNLModuleInit",null,[]);class Kg{constructor(){this.czd=0;this.y1f=null;this.GSd=0}}Object(f.a)(Kg,"FeatureGenStackRec",null,
[]);class sk{constructor(Ua){this.sah=Array(Ua);this.CUc=Array(Ua);this.o8g=[];this.hGj=[]}}Object(f.a)(sk,"TokenStringLattice",null,[]);const fh=(Ua,Hb,$b)=>{for(let sc=0;sc<Ua.length;sc++)$b=Hb($b,Ua[sc]);return $b},Hf=(Ua,Hb)=>{const $b=Array(Ua.length);for(let sc=0;sc<Ua.length;sc++)$b[sc]=Hb(Ua[sc]);return $b},ui=(Ua,Hb)=>{Hb=Array(Math.min(Hb,Ua.length));for(let $b=0;$b<Hb.length;$b++)Hb[$b]=Ua[$b];return Hb},Nf=(Ua,Hb)=>{const $b=[];for(const sc of Ua)Hb(sc)&&Array.add($b,sc);return $b};class Mk{constructor(Ua,
Hb){this.key=Ua;this.value=Hb}}Object(f.a)(Mk,"KeyValuePair",null,[]);const Nj=(Ua,Hb)=>({returnValue:Hb in Ua,value:Ua[Hb]}),nj=Ua=>{const Hb=[];for(let $b in Ua){const sc=new Mk($b,Ua[$b]);Array.add(Hb,sc)}return Hb};class $k{constructor(Ua){this.SFi=this.sRl;this.Pa=Ua;this.NKe=this.wyg=this.xyg=0;for(const Hb of this.Pa.Wte)this.xyg=Math.max(this.xyg,Hb.xNg),this.wyg=Math.max(this.wyg,Hb.sNg),this.NKe=Math.max(this.NKe,Hb.eOb.length)}get Sjl(){return this.Pa.Y1e.trie}execute(Ua){if(!Ua)throw Error.argumentNull("input");
let Hb,$b;({Ioa:Hb,rjm:$b}=this.tRl(Ua));let sc=null,Wc=null,dd={};if(this.Pa.DCd){Hb=G.Annotations.j_(Hb);for(var td=0;td<Hb.items.length;++td)Hb.items[td]=G.Annotations.j_(Hb.items[td])}else({cni:Wc,returnValue:sc}=this.gBi(Ua,dd));td=Array(this.NKe);const oe=Array(this.NKe);for(var Ld=0;Ld<oe.length;++Ld)oe[Ld]=new Kg;for(Ld=-this.xyg;Ld<Hb.items.length+this.wyg;++Ld){let Mf=null;this.Pa.DCd&&(Mf=Hb.items[Ld],dd={},{cni:Wc,returnValue:sc}=this.gBi(Mf,dd));for(const Rf of this.Pa.Wte){if(0>Ld&&
-Ld>Rf.xNg||Ld>=Hb.items.length&&Ld-Hb.items.length+1>Rf.sNg)continue;let yi=!0;for(let $i=0;$i<Rf.eOb.length;++$i){const he=Ld+Rf.eOb[$i];td[$i]=he;if(0>he?0>this.Pa.yNg:he>=Hb.items.length?0>this.Pa.tNg:!$b.CUc[he]){yi=!1;break}}yi&&({X5k:sc,Y5k:Wc}=this.G6l(Rf,$b,sc,Wc,dd,oe,td))}this.Pa.DCd&&(Mf.kB(this.Pa.Iob?this.Pa.pzc:this.Pa.nzc,sc),this.Pa.Iob&&Mf.kB(this.Pa.ozc,Wc))}Ua=G.Annotations.j_(Ua);this.Pa.DCd?Ua.kB(this.Pa.u2a,Hb):(Ua.kB(this.Pa.Iob?this.Pa.pzc:this.Pa.nzc,sc),this.Pa.Iob&&Ua.kB(this.Pa.ozc,
Wc));return Ua}tRl(Ua){let Hb,$b;if(!Ua||!({value:Hb}=Ua.ns(this.Pa.u2a)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let sc;({value:sc}=Ua.ns(this.Pa.Dhb)).returnValue||(sc="");$b=new sk(Hb.items.length);const Wc=Nf(this.Pa.uah,dd=>!dd.vAd||dd.vAd.isMatch(Ua,null));for(let dd=0;dd<Hb.items.length;++dd){const td=Hb.items[dd];let oe=null;$b.sah[dd]=$b.o8g.length;let Ld=$b.CUc[dd]=0;for(const Mf of Wc)0<Mf.KHd&&$b.CUc[dd]+Ld>=Mf.KHd||Mf.OYd&&!Mf.OYd.isMatch(td,
null)||({PYd:oe,sjd:Ld}=Mf.apply(this,td,dd,$b,sc,oe,Ld))}return{Ioa:Hb,rjm:$b}}G6l(Ua,Hb,$b,sc,Wc,dd,td){let oe=0;dd[0].czd=-1;for(dd[0].y1f=Ua.ksj;;){var Ld=td[oe],Mf=0>Ld||Ld>=Hb.CUc.length?1:Hb.CUc[Ld];let $i=!1;for(;dd[oe].czd<Mf-1;){++dd[oe].czd;var Rf=void 0,yi=void 0;0>Ld?(Rf=this.Pa.yNg,yi=1):Ld>=Hb.sah.length?(Rf=this.Pa.tNg,yi=1):(yi=Hb.sah[Ld]+dd[oe].czd,Rf=Hb.o8g[yi],yi=Hb.hGj[yi]);dd[oe].GSd=yi*(oe?dd[oe-1].GSd:Ua.score);if(({value:Rf}=Nj(dd[oe].y1f,Rf.toString())).returnValue){oe===
Ua.eOb.length-1?(Ld=Rf,dd[oe].GSd&&(({value:Mf}=Nj(Wc,Ld.toString())).returnValue||(Mf=-1),0>Mf&&($b=G.Annotations.j_($b),Array.add($b.items,Ld)),this.Pa.Iob&&(sc=G.Annotations.j_(sc),0>Mf?Array.add(sc.items,dd[oe].GSd):sc.items[Mf]+=dd[oe].GSd),0>Mf&&(this.Pa.yVi||this.Pa.Iob)&&(Wc[Ld.toString()]=$b.items.length-1))):(++oe,dd[oe].czd=-1,dd[oe].y1f=Rf);$i=!0;break}}if(!$i&&(--oe,0>oe))break}return{X5k:$b,Y5k:sc}}gBi(Ua,Hb){let $b;if(({value:$b}=Ua.ns(this.Pa.Iob?this.Pa.pzc:this.Pa.nzc)).returnValue)for(let sc=
0;sc<$b.items.length;++sc)Hb[$b.items[sc].toString()]=sc;else $b=new Qa.a(this.Pa.hf,G.Annotations.vZa);if(this.Pa.Iob){if(({value:Hb}=Ua.ns(this.Pa.ozc)).returnValue||(Hb=new Qa.a(this.Pa.hf,G.Annotations.JDa)),Hb.items.length!==$b.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Pa.hf.Noa(G.Annotations.t1,Ua));}else Hb=null;return{returnValue:$b,cni:Hb}}get YEn(){return this.Pa.Y1e}sRl(Ua,Hb){var $b;if(({value:$b}=
Hb.ns(this.Pa.lCb)).returnValue)Ua=$b;else{if(!({value:$b}=Hb.ns(this.Pa.saa)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Hb}=Hb.ns(this.Pa.afa)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>$b||0>Hb||$b+Hb>Ua.length)throw Error.argument("Token indices are out of range");Ua=Ua.substr($b,Hb)}return Ua}}Object(f.a)($k,"NGramNLModule",null,[1172,1174]);class ql{constructor(Ua){this.eOb=null;this.score=this.sNg=this.xNg=0;this.ksj=null;if(Ua){var Hb=
0;try{if(Ua.J(Hb)!==ql.S3b)throw Error.argument("initData","Input does not represent a feature template");++Hb;const $b=Ua.J(Hb);++Hb;this.eOb=Array($b);for(let sc=0;sc<$b;++sc)this.eOb[sc]=Ua.J(Hb),++Hb;this.xNg=Ua.J(Hb);++Hb;this.sNg=Ua.J(Hb);++Hb;this.score=Ua.J(Hb);++Hb;this.ksj=({jLi:Hb}=ql.Qjj(Ua,Hb)).returnValue}catch($b){throw Error.argument("initData");}}}static Qjj(Ua,Hb){const $b=Ua.J(Hb);++Hb;const sc={};for(let Wc=0;Wc<$b;++Wc){const dd=Ua.J(Hb);++Hb;Ua.J(Hb)?sc[dd.toString()]=({jLi:Hb}=
ql.Qjj(Ua,Hb)).returnValue:(++Hb,sc[dd.toString()]=Ua.J(Hb),++Hb)}return{returnValue:sc,jLi:Hb}}}ql.S3b=240803228;Object(f.a)(ql,"FeatureTemplate",null,[1190]);var Oj=b(1401);class wm{constructor(Ua,Hb){this.Iob=this.yVi=this.DCd=!1;this.lCb=this.afa=this.saa=this.u2a=this.Dhb=this.ozc=this.pzc=this.nzc=0;this.Y1e=null;this.tNg=this.yNg=0;this.Wte=this.uah=null;if(Ua){this.hf=Hb.hf;var $b=0;try{this.DCd=1===Ua.J($b);++$b;this.yVi=1===Ua.J($b);++$b;this.Iob=1===Ua.J($b);++$b;this.nzc=Ua.J($b);++$b;
this.pzc=Ua.J($b);++$b;this.ozc=Ua.J($b);++$b;this.Dhb=Ua.J($b);++$b;this.u2a=Ua.J($b);++$b;this.saa=Ua.J($b);++$b;this.afa=Ua.J($b);++$b;this.lCb=Ua.J($b);++$b;this.Y1e=this.sPm(Hb.lFb(Ua.J($b)));++$b;this.yNg=Ua.J($b);++$b;this.tNg=Ua.J($b);++$b;const sc=Ua.J($b);++$b;this.uah=Array(sc);for(let dd=0;dd<sc;++dd){const td=Ua.J($b);++$b;const oe=this.Y1e.trie,Ld=new fb.a;Ld.fFb(Ua,$b,td);this.uah[dd]=this.vPm(Ld,Hb,oe);$b+=td}const Wc=Ua.J($b);++$b;this.Wte=Array(Wc);for(Hb=0;Hb<Wc;++Hb){const dd=
Ua.J($b);++$b;const td=new fb.a;td.fFb(Ua,$b,dd);this.Wte[Hb]=this.bPm(td);$b+=dd}}catch(sc){throw Error.argument("initData");}}}sPm(Ua){return new mf.a(new ef.a(Ua))}vPm(Ua,Hb,$b){return Oj.a.create(Ua,Hb,$b)}bPm(Ua){return new ql(Ua)}}Object(f.a)(wm,"NGramNLModuleInit",null,[]);class rl{constructor(Ua){this.Pa=Ua}execute(Ua){if(!Ua)throw Error.argumentNull("input");Ua=Ua.clone();this.Pa.script.execute(Ua,null);return Ua}}Object(f.a)(rl,"ScriptNLModule",null,[1172]);class Hl{constructor(Ua,Hb){Ua&&
(this.script=Hb.L8b(Ua.J(0)))}}Object(f.a)(Hl,"ScriptNLModuleInit",null,[]);const vi=Ua=>{Ua=Hf(Ua,Hb=>Hb*Hb);return Math.sqrt(fh(Ua,(Hb,$b)=>Hb+$b,0))},Pj=Ua=>fh(Ua,(Hb,$b)=>Hb>$b?Hb:$b,Ua[0]);class kl{constructor(Ua){this.Pa=Ua}execute(Ua){if(!Ua)throw Error.argumentNull("input");var Hb=[],$b=[];this.yUk(Ua,Hb,$b);this.rAk(Hb,$b);const sc={};for(let dd=0;dd<Hb.length;++dd){var Wc=Hb[dd];const td=this.Pa.zOi.J(Wc);Wc=this.Pa.AOi.J(Wc);for(let oe=0;oe<Wc;++oe){const Ld=this.Pa.pfa.J(this.Pa.G6h.J(td+
oe)),Mf=this.Pa.H6h.J(td+oe);let Rf;({value:Rf}=Nj(sc,Ld)).returnValue||(Rf=0);sc[Ld]=Rf+$b[dd]*Mf}}$b=nj(sc);$b.sort((dd,td)=>{var oe=dd.value,Ld=td.value;(oe=-(oe>Ld?1:oe<Ld?-1:0))||(oe=dd.key.localeCompare(td.key));return oe});Hb=new Qa.a(this.Pa.hf,G.Annotations.t1);for(const dd of ui($b,this.Pa.Aum))$b=new D.a(this.Pa.hf),$b.kB(this.Pa.CFk,dd.key),$b.kB(this.Pa.EFk,dd.value),Array.add(Hb.items,$b);Ua.kB(this.Pa.DFk,Hb);return Ua}yUk(Ua,Hb,$b){if(({value:Ua}=Ua.ns(this.Pa.BFk)).returnValue){let sc;
if(({value:sc}=Ua.ns(this.Pa.pzc)).returnValue){let Wc;if(!({value:Wc}=Ua.ns(this.Pa.ozc)).returnValue||sc.items.length!==Wc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.Bne(sc,Wc,Hb,$b)}if(({value:sc}=Ua.ns(this.Pa.GFk)).returnValue){let Wc;if(!({value:Wc}=Ua.ns(this.Pa.HFk)).returnValue||sc.items.length!==Wc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.Bne(sc,Wc,Hb,$b)}({value:sc}=Ua.ns(this.Pa.nzc)).returnValue&&this.Bne(sc,null,Hb,$b);({value:sc}=Ua.ns(this.Pa.FFk)).returnValue&&this.Bne(sc,null,Hb,$b)}}Bne(Ua,Hb,$b,sc){for(let dd=0;dd<Ua.items.length;++dd){var Wc=void 0;Ua.qca===G.Annotations.hia?({value:Wc}=Nj(this.Pa.Uii,Ua.items[dd])).returnValue||(Wc=-1):(Wc=Ua.items[dd],Wc=Wc>=this.Pa.CAg&&Wc<=this.Pa.fvm?this.Pa.zEg?this.Pa.zEg.J(Wc-this.Pa.CAg)-1:Wc-this.Pa.CAg:-1);if(0<=Wc){let td;td=Hb?Hb.items[dd]:1;0<td&&(Array.add($b,Wc),Array.add(sc,
td))}}}rAk(Ua,Hb){if(Ua.length){switch(this.Pa.lXm){case 0:break;case 1:for(var $b=0;$b<Hb.length;++$b)Hb[$b]=1+Math.log(Hb[$b]);break;case 2:$b=Pj(Hb);for(let sc=0;sc<Hb.length;++sc)Hb[sc]=.5+Hb[sc]/$b*.5;break;case 3:for($b=0;$b<Hb.length;++$b)Hb[$b]=1;break;default:throw Error.notImplemented();}if(this.Pa.sEe)for($b=0;$b<Hb.length;++$b)Hb[$b]*=this.Pa.sEe.J(Ua[$b]);Ua=vi(Hb);for($b=0;$b<Hb.length;++$b)Hb[$b]/=Ua}}}Object(f.a)(kl,"TfIdfRankerNLModule",null,[1172]);class ag{constructor(Ua,Hb=0){if(!Ua)throw Error.argumentNull("byteArray");
this.OKe=Hb;if(604662927!==Ua.hB(this.OKe+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.Ig=Ua.hB(this.OKe+4,4);this.Q1i=Ua.hB(this.OKe+8,4);this.wsm=Ua}J(Ua){if(0>Ua||Ua>=this.count)throw Error.argumentOutOfRange("index");return this.wsm.m_m(8*this.OKe+96+Ua*this.Q1i,this.Q1i)}get count(){return this.Ig}}Object(f.a)(ag,"CompactIntArray",null,[1173]);const bo=(Ua,Hb)=>{Hb=Array(Hb);for(let dd=0;dd<Hb.length;dd++){var $b=dd,sc=Ua.oha(),Wc=1===(sc>>31&1)?
-1:1;const td=sc&8388607;sc=sc>>23&255;256===sc+1?Wc=td?Number.NaN:1===Wc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:sc?(sc-=127,Wc=Wc*xh(td,1)*Math.pow(2,sc)):Wc=Wc*xh(td,0)*Math.pow(2,-126);Hb[$b]=Wc}return Hb},xh=(Ua,Hb)=>{let $b=0;for(let sc=0;23>sc;sc++)$b+=(Ua>>22-sc&1)/Math.pow(2,sc+1);return Hb+$b};class Xl{constructor(Ua,Hb){this.zEg=null;this.l7i=0;this.AOi=this.zOi=this.sEe=null;this.k7i=0;this.H6h=this.G6h=null;this.hf=Hb.hf;let $b=0;this.FFk=Ua.J($b);++$b;this.nzc=Ua.J($b);++$b;
this.GFk=Ua.J($b);++$b;this.HFk=Ua.J($b);++$b;this.pzc=Ua.J($b);++$b;this.ozc=Ua.J($b);++$b;this.BFk=Ua.J($b);++$b;this.DFk=Ua.J($b);++$b;this.CFk=Ua.J($b);++$b;this.EFk=Ua.J($b);++$b;var sc=Ua.J($b);++$b;var Wc=Array(sc);for(var dd=0;dd<sc;++dd)Wc[dd]=Hb.getString(Ua.J($b)),++$b;this.pfa=fb.a.eSf(Wc);this.Aum=Ua.J($b);++$b;this.lXm=Ua.J($b);++$b;sc=Ua.J($b);++$b;this.Uii={};for(Wc=0;Wc<sc;++Wc){dd=Hb.getString(Ua.J($b));++$b;const td=Ua.J($b);++$b;this.Uii[dd]=td}this.CAg=Ua.J($b);++$b;this.fvm=
Ua.J($b);++$b;sc=Ua.J($b);++$b;0<sc&&(sc=Hb.lFb(Ua.J($b)),++$b,this.zEg=this.sQe(new Vf(sc)));++$b;Ua=Hb.lFb(Ua.J($b));this.hPm(Ua)}sQe(Ua){return new ag(Ua.Thd,Ua.offset)}hPm(Ua){try{const Hb=new Vf(Ua);this.l7i=Hb.oha();1===Hb.oha()?this.sEe=fb.a.eSf(bo(Hb,this.l7i)):this.sEe=null;const $b=Hb.oha();this.zOi=this.sQe(Hb);Hb.offset+=$b;const sc=Hb.oha();this.AOi=this.sQe(Hb);Hb.offset+=sc;this.k7i=Hb.oha();const Wc=Hb.oha();this.G6h=this.sQe(Hb);Hb.offset+=Wc;this.H6h=fb.a.eSf(bo(Hb,this.k7i))}catch(Hb){throw Error.argument("byteReader");
}}}Object(f.a)(Xl,"TfIdfRankerNLModuleInit",null,[]);class Ih{constructor(Ua,Hb,$b,sc){this.NLg=Ua;this.$oi=$b;this.Ioa=sc;this.Mya=Hb;this.XRc=-1;this.WWe=0}}Object(f.a)(Ih,"TokenizerData",null,[]);class Aj{constructor(Ua){this.Pa=Ua}execute(Ua){if(!Ua)throw Error.argumentNull("input");if(!({value:sc}=Ua.ns(this.Pa.Dhb)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Hb;({value:Hb}=Ua.ns(this.Pa.saa)).returnValue||(Hb=0);let $b;({value:$b}=
Ua.ns(this.Pa.afa)).returnValue||($b=sc.length-Hb);if(0>Hb||Hb>sc.length)throw Error.argument("input","Start index out of range");if(0>$b||$b>sc.length)throw Error.argument("input","Length out of range");if(Hb+$b>sc.length)throw Error.argument("input","Bad start-length range");var sc=new Ih(sc,Hb,Hb+$b,new Qa.a(this.Pa.hf,G.Annotations.t1));this.ZEn(sc);Ua=Ua.isReadOnly?Ua.clone():Ua;Ua.kB(this.Pa.u2a,sc.Ioa);return Ua}ZEn(Ua){for(;Ua.Mya<Ua.$oi;){if(this.Pa.Xeg){var Hb=this.Pa.Xeg.D1i(Ua.NLg,Ua.Mya,
Ua.$oi-Ua.Mya,null);!Hb.succeeded&&Hb.u6i&&(Hb=Hb.u6i);if(Hb.succeeded){this.z$i(Ua,Hb.length,this.Pa.GHi);Ua.Mya+=Hb.length;continue}}Hb=Ua.NLg.substr(Ua.Mya);let $b=-1,sc=-1,Wc=-1;for(let dd=0;dd<this.Pa.aWe.length;++dd){const td=this.Pa.aWe[dd].exec(Hb);td&&0<td[1].length&&(0>$b||td[0].length>sc)&&($b=dd,sc=td[0].length,Wc=td[1].length)}0<=$b?(this.z$i(Ua,Wc,this.Pa.oYg[$b]),Ua.Mya+=Wc):Ua.Mya+=1}}z$i(Ua,Hb,$b){if(this.Pa.uUi)$b!==Aj.PLk&&(0>Ua.XRc&&(Ua.XRc=Ua.Mya),Ua.WWe=Ua.Mya+Hb-Ua.XRc,$b===
Aj.OLk&&(0<=Ua.XRc&&0<Ua.WWe&&(Hb=new D.a(this.Pa.hf),Hb.kB(this.Pa.saa,Ua.XRc),Hb.kB(this.Pa.afa,Ua.WWe),Hb.kB(this.Pa.mGf,Aj.QLk),Hb.kB(this.Pa.Dhb,Ua.NLg),Array.add(Ua.Ioa.items,Hb)),Ua.XRc=-1,Ua.WWe=0));else{let sc=new D.a(this.Pa.hf);sc.kB(this.Pa.saa,Ua.Mya);sc.kB(this.Pa.afa,Hb);sc.kB(this.Pa.mGf,$b);Array.add(Ua.Ioa.items,sc)}}}Aj.PLk="GAP";Aj.OLk="EOS_CHUNK";Aj.QLk="SENTENCE";Object(f.a)(Aj,"TokenizerNLModule",null,[1172]);class Be{constructor(Ua,Hb){this.afa=this.saa=this.mGf=this.u2a=this.Dhb=
0;this.uUi=!1;this.oYg=this.aWe=this.GHi=this.Xeg=null;if(Ua){this.hf=Hb.hf;var $b=0;try{this.Dhb=Ua.J($b);++$b;this.u2a=Ua.J($b);++$b;this.mGf=Ua.J($b);++$b;this.saa=Ua.J($b);++$b;this.afa=Ua.J($b);++$b;this.uUi=1===Ua.J($b);++$b;var sc=Ua.J($b);++$b;0<sc&&(this.Xeg=Hb.l$f(sc).Sjl);this.GHi=Ua.J($b)?Hb.getString(Ua.J($b)):"";++$b;const Wc=Ua.J($b);++$b;this.aWe=Array(Wc);this.oYg=Array(Wc);for(sc=0;sc<Wc;++sc)this.aWe[sc]=new RegExp(Hb.getString(Ua.J($b))),++$b,this.oYg[sc]=Hb.getString(Ua.J($b)),
++$b}catch(Wc){throw Error.argument("initData");}}}}Object(f.a)(Be,"TokenizerNLModuleInit",null,[]);class Sd{constructor(Ua){this.Pa=Ua}execute(Ua){if(!Ua)throw Error.argumentNull("input");let Hb;if(!({value:Hb}=Ua.ns(this.Pa.u_h)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const $b of this.Pa.w7g)Hb=$b.apply(Hb);Ua=G.Annotations.j_(Ua);Ua.kB(this.Pa.v_h,Hb);return Ua}static mFf(Ua,Hb){const $b=new Sys.StringBuilder;for(let sc=0;sc<Ua.length;++sc)$b.append(Hb(Ua.substr(sc,
1)));return $b.toString()}}Object(f.a)(Sd,"TransliteratorNLModule",null,[1172]);class Rd{constructor(Ua){Ua&&(this.style=Ua.J(0))}apply(Ua){return Sd.mFf(Ua,Hb=>Rd.iPk(Hb,this.style))}static iPk(Ua,Hb){switch(Hb){case 0:return Ua.toLowerCase();case 1:return"I"===Ua?"\u0131":Ua.toLowerCase();case 2:return Ua.toUpperCase();case 3:return"i"===Ua?"\u0130":Ua.toUpperCase();default:throw Error.invalidOperation();}}}Rd.T3b=0;Object(f.a)(Rd,"ChangeCaseTransliterationStage",null,[1187]);class ng{apply(Ua){return Sd.mFf(Ua,
ng.bGn)}static bGn(Ua){const Hb=Ua.charCodeAt(0);return 65281<=Hb&&65374>=Hb?String.fromCharCode(Hb-65248):Ua}}ng.T3b=4;Object(f.a)(ng,"LatinFullWidthToHalfWidthTransliterationStage",null,[1187]);class Al{constructor(Ua,Hb){Ua&&(this.KSg=Hb.EGc(Ua.J(0)),this.l$m=Hb.getString(Ua.J(1)))}apply(Ua){return Ua.replace(this.KSg,this.l$m)}}Al.T3b=1;Object(f.a)(Al,"RegexReplaceTransliterationStage",null,[1187]);class sl{constructor(Ua,Hb){if(Ua){var $b=Ua.J(0),sc=Hb.getString(Ua.J(1)),Wc=new ag(Hb.lFb(Ua.J(2)));
Ua=0>Ua.J(3)?null:new ag(Hb.lFb(Ua.J(3)));this.L8g={};for(Hb=0;Hb<$b;++Hb)this.L8g[sc.charAt(Hb).toString()]=sc.substr(Wc.J(Hb),Ua?Ua.J(Hb):1)}}apply(Ua){return Sd.mFf(Ua,Hb=>Hb in this.L8g?this.L8g[Hb]:Hb)}}sl.T3b=2;Object(f.a)(sl,"SingleCharSubstitutionsTransliterationStage",null,[1187]);class Bl{constructor(Ua,Hb){this.v_h=this.u_h=0;this.w7g=null;if(Ua){this.hf=Hb.hf;var $b=0;try{this.u_h=Ua.J($b);++$b;this.v_h=Ua.J($b);++$b;const sc=Ua.J($b);++$b;this.w7g=Array(sc);for(let Wc=0;Wc<sc;++Wc){const dd=
Ua.J($b);++$b;const td=Ua.J($b);++$b;const oe=new fb.a;oe.fFb(Ua,$b,td);$b+=td;this.w7g[Wc]=this.rPm(dd,oe,Hb)}}catch(sc){throw Error.argument("initData");}}}rPm(Ua,Hb,$b){switch(Ua){case Rd.T3b:return new Rd(Hb);case Al.T3b:return new Al(Hb,$b);case sl.T3b:return new sl(Hb,$b);case ng.T3b:return new ng;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(f.a)(Bl,"TransliteratorNLModuleInit",null,[]);class Ai{GGl(Ua,Hb){const $b=Ua.J(0),sc=new fb.a;
sc.fFb(Ua,1,Ua.count-1);switch($b){case 0:return new rl(new Hl(sc,Hb));case 2:return new Aj(new Be(sc,Hb));case 3:return new $k(new wm(sc,Hb));case 5:return new fk(new ak(sc,Hb));case 9:return new Sd(new Bl(sc,Hb));case 10:return new kl(new Xl(sc,Hb));default:throw Error.notImplemented();}}}Object(f.a)(Ai,"NLModuleFactory",null,[1160]);class Tf{constructor(Ua){this.MLk=";";if(!Ua)throw Error.argumentNull("resource");this.Vsa=new id(Ua,new db,new Ai);this.zyg=this.Vsa.qGl();this.P1i=this.Vsa.hf.Usd("Text.Text");
this.N1i=this.Vsa.hf.Usd("Classification.Predictions");this.lyg=this.Vsa.hf.Usd("Classification.PredictionString");this.O1i=this.Vsa.hf.Usd("Classification.Probability");this.vsm=this.Vsa.hf.Usd("NLMod.Tokens");if(0>this.P1i||0>this.N1i||0>this.lyg||0>this.O1i)throw Error.argument("resourceObj","Resource does not represent a ranker");}Rsl(){const Ua=[];this.c0f(void 0,this.xti(Ua),null);return Ua}Tsl(Ua,Hb){const $b=[],sc=[];this.c0f(Ua,this.xti($b),(Wc,dd)=>{const td=this.Vsa.hf.mti(Wc),oe=[],Ld=
[];Hb&&Hb.length&&-1===Array.indexOf(Hb,td)||(Wc=this.Vsa.hf.getAttributeType(Wc),this.kfj(Wc,dd,oe,Ld),dd=new Hh(td,oe,Ld),Array.add(sc,dd))});return new li($b,sc)}Ssl(Ua){const Hb=[];this.c0f(Ua,$b=>{let sc;if(({value:sc}=$b.ns(this.lyg)).returnValue){let Wc;({value:Wc}=$b.ns(this.O1i)).returnValue&&Array.add(Hb,new wg(sc,Wc))}},null);return Hb}c0f(Ua,Hb,$b){var sc=new D.a(this.Vsa.hf);sc.kB(this.P1i,Ua);Ua=this.zyg.execute(sc);if(({value:sc}=Ua.ns(this.N1i)).returnValue)for(const Wc of sc.items)Hb(Wc);
if($b&&({value:Hb}=Ua.ns(this.vsm)).returnValue)for(const Wc of Hb.items)Wc.ave($b)}kfj(Ua,Hb,$b,sc){if(G.Annotations.yM(Ua))for(var Wc of Hb.items)this.kfj(Hb.qca,Wc,$b,sc);else if(G.Annotations.pMj(Ua)){Wc=this.Vsa.hf.RAi(Ua);for(let dd=0;dd<Wc;dd++)Array.add($b,this.Vsa.hf.wEi(Ua,dd)),Array.add(sc,this.Vsa.hf.Noa(this.Vsa.hf.l$b(Ua,dd),Hb.BFb(dd)))}else Array.add($b,"VALUE"),Array.add(sc,this.Vsa.hf.Noa(Ua,Hb))}xti(Ua){return Hb=>{let $b;({value:$b}=Hb.ns(this.lyg)).returnValue&&Array.add(Ua,this.xKl($b))}}xKl(Ua){const Hb=
Ua.indexOf(this.MLk);return 0>Hb?Ua:Ua.substring(0,Hb)}}Object(f.a)(Tf,"Ranker",null,[]);var de=b(1342),bk=b(1360),fj=b(1300),Pe=b(1295),Jh=b(1294),Kj=b(2);class $g{constructor(Ua,Hb){this.yDh="";this.Urf=null;this.Vrf=!1;this.nEa=null;this.c3j=["TellMe.TellMeParamCollection"];this.Gb=Ua;this.feb=Hb;this.Gb.uhb&&(this.nEa=this.Gb.Rve())}get XSe(){if(!this.Urf&&!this.Vrf){let Ua=null;try{Ua=window.TellMeModel}catch(Hb){if(Pe.TellMeActor.instance.Qe)Pe.TellMeActor.instance.Qe.onError("QueryRanker",
"TellMeModel not found. Exception: "+Hb)}if(Ua){try{this.Urf=new Tf(Ua)}catch(Hb){if(Pe.TellMeActor.instance.Qe)Pe.TellMeActor.instance.Qe.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Hb)}this.Vrf=!0}else if(Pe.TellMeActor.instance.Qe)Pe.TellMeActor.instance.Qe.onError("QueryRanker","Classifier model not found")}return this.Urf}ZX(){return"Command"}Bba(){return 0===this.Gb.WA?0:1===this.Gb.WA?1:2}HS(Ua,Hb,$b=!1,sc=c.a.tellMe,Wc=null){const dd=new l.a(Ua);if((!Wc||
Array.contains(Wc,0))&&!Jh.a.O7(Ua)){if(!this.XSe&&this.Vrf){if(Pe.TellMeActor.instance.Qe)Pe.TellMeActor.instance.Qe.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.Gb.uhb&&this.nEa&&this.nEa.initialize();if(de.CommandResultsUtility.Pmg(Ua.Qg)&&(Wc=de.CommandResultsUtility.Zui(Ua.Qg),0<Wc.results.length)){Wc.displayName="Classifier Debug";dd.DA(Wc);Hb.resultsUpdated(dd);return}Wc=Ua?this.yDh=Ua.Qg:
this.yDh;if(Kj.AFrameworkApplication.K.ea("TellMeParameterizedQueriesEnabled")){Wc=this.zKl(Wc);var td=this.lwe(Wc.Lag());Wc=Wc.Ssi()}else Wc=this.yKl(Wc),td=this.Uul(Wc),Wc=[];de.CommandResultsUtility.nKe(td,!1,"Classifier","TFIDF");td=de.CommandResultsUtility.pze(td,this.Gb,this.nEa,this.feb,Wc,0,1);0<td.results.length&&sc!==c.a.contextMenu&&(td.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);$b||td.results.length||this.Gb.hY||this.Gb.bLa||(Ua=new fj.a("lookupNoResults",14,Ua.Qg,null,
1),td.DB(Ua));0<td.results.length&&dd.DA(td);dd.attributes=Wc}Hb.resultsUpdated(dd)}Lag(){let Ua=[];try{Ua=this.XSe.Rsl()}catch(Hb){if(Pe.TellMeActor.instance.Qe)Pe.TellMeActor.instance.Qe.onError("GetPredictions","Exception: "+Hb)}return Ua}yKl(Ua){let Hb=[];try{Hb=this.XSe.Ssl(Ua)}catch($b){if(Pe.TellMeActor.instance.Qe)Pe.TellMeActor.instance.Qe.onError("GetPredictionsWithScore","Exception: "+$b)}return Hb}zKl(Ua){try{return this.XSe.Tsl(Ua,this.c3j)}catch(Hb){if(Pe.TellMeActor.instance.Qe)Pe.TellMeActor.instance.Qe.onError("GetPredictionsWithTokenAttributes",
"Exception: "+Hb)}return new li([],[])}lwe(Ua){const Hb=[];if(Ua)for(const $b of Ua)Hb.push(new bk.a($b,-99999));return Hb}Uul(Ua){const Hb=[];if(Ua)for(const $b of Ua)Hb.push(new bk.a($b.prediction,$b.score));return Hb}}Object(f.a)($g,"CommandResultsProvider",null,[1035]);var Nk=b(1560);class df{constructor(Ua){this.Gb=Ua}ZX(){return"Feedback"}Bba(){return 0===this.Gb.WA?0:1===this.Gb.WA?1:2}HS(Ua,Hb,$b,sc,Wc=null){Ua=new l.a(Ua);if(!Wc||Array.contains(Wc,21))Wc=[],Wc.push(appChrome.actions.setControlLabel("TellMeFeedback",
CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Wc),Wc=new m.a(22),Wc.displayName="",Wc.DB(new fj.a("TellMeFeedback",23,null,null,1)),Ua.DA(Wc);Hb.resultsUpdated(Ua)}}Object(f.a)(df,"FeedbackResultsProvider",null,[1035]);class tk{constructor(Ua,Hb,$b,sc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=Ua;this.CommandId=Hb;this.CommandValueId=$b;this.InputText=sc}}Object(f.a)(tk,"FindInDocumentProp",null,[]);var Ng=b(1370),yh=b(16);class Bj{constructor(Ua){this.jnf=
2;this.BXb=[];this.Lzb=[];this.Gb=Ua;Bj.ZSa=Ua.J1f;Bj.roi="FindInDocumentSuggestion";Bj.tej="FindInDocumentSuggestion3";this.Nlf=Object.assign(new Ng.a,{landingTab:"Indoc",data:null});this.Umk=this.Gb.Qtb||!!Kj.AFrameworkApplication.la&&Kj.AFrameworkApplication.la.eb.Qtb}ZX(){return"FindInDocument"}Bba(){return 0===this.Gb.WA?0:1===this.Gb.WA?1:3===this.Gb.WA?this.Gb.RDj?2:3:2}HS(Ua,Hb,$b=!1,sc,Wc=null){const dd=new l.a(Ua);if(Wc&&!Array.contains(Wc,2))Hb.resultsUpdated(dd);else if(Array.clear(this.BXb),
Jh.a.O7(Ua)){if($b&&this.DBj()){$b=new m.a(2);$b.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Wc=1;sc="";if(0<this.Lzb.length&&!this.Gb.SSc)for(var td of this.Lzb)if(""!==td.Label.toLowerCase()){if(Wc>=this.jnf)break;this.RPj($b,td.Label,td.CommandValueId,Bj.roi+Wc,td.InputText);Wc++}td="";this.Gb.K8?(dd.DA($b),$b=new m.a(3),td=this.Gb.Ghd?Jh.a.Zsd(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):CommonUIStrings.l_TellMeOpenFindPaneTextV2):td=CommonUIStrings.l_TellMeOpenFindPaneText;
sc=this.Yui("");this.RPj($b,td,sc,Bj.tej,"");dd.DA($b)}Hb.resultsUpdated(dd)}else td="",$b&&($b=this.Yui(Ua.Qg),sc=[],this.Gb.lpb?(this.Gb.iZe&&sc.push(appChrome.actions.setControlIconSet(Bj.ZSa,{"default":"FindInDocument_20"})),td=this.Gb.osg?Jh.a.J8f(Ua.Qg,CommonUIStrings.l_FindInDocumentScopedButtonText):Ua.Qg+CommonUIStrings.l_FindInDocumentScopedButtonText):this.Gb.K8?(td=this.Gb.Ghd?Jh.a.Zsd(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,Ua.Qg)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,
Ua.Qg),sc.push(appChrome.actions.setControlIconSet(Bj.ZSa,{"default":"FindInDocument_20"}))):td=this.Gb.SSc?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,Ua.Qg),this.Gb.Fmb?(Pe.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Bj.ZSa,td)),Pe.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Bj.ZSa,$b))):(sc.push(appChrome.actions.setControlLabel(Bj.ZSa,td)),sc.push(appChrome.actions.setButtonCommandValueId(Bj.ZSa,
$b)),appChrome.api.dispatch(sc)),this.Txj(td,Bj.ZSa,$b,Ua.Qg)),this.Gb.RDj?(td=new fj.a(Bj.ZSa,8,Ua.Qg),$b=new m.a(2),$b.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,$b.DB(td),dd.DA($b),Hb.resultsUpdated(dd)):this.Gb.kxe(Ua.Qg).then(oe=>{const Ld=new fj.a(Bj.ZSa,8,Ua.Qg,null,1);Ld.count=oe;oe=new m.a(2);oe.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;oe.DB(Ld);dd.DA(oe);Hb.resultsUpdated(dd)},oe=>{Pe.TellMeActor.instance.Qe.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+oe);oe=new fj.a(Bj.ZSa,8,Ua.Qg,null,1);const Ld=new m.a(2);Ld.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Ld.DB(oe);dd.DA(Ld);Hb.resultsUpdated(dd)})}DBj(){return!!this.Gb&&this.Gb.YYe}RPj(Ua,Hb,$b,sc,Wc=null){const dd=[];Hb&&dd.push(appChrome.actions.setControlLabel(sc,Hb));this.Gb.K8&&dd.push(appChrome.actions.setControlIconSet(sc,{"default":"FindInDocument_20"}));dd.push(appChrome.actions.setButtonCommandValueId(sc,$b));appChrome.api.dispatch(dd);
this.Txj(Hb,sc,$b,"");Ua.DB(new fj.a(sc,8,Wc,null,1,-99999))}Yui(Ua){return this.Umk?Jh.a.ejb(Ua,15,this.Nlf):yh.a.Vd(Ua)}Txj(Ua,Hb,$b,sc){this.DBj()&&this.BXb.length<this.jnf&&(Ua=new tk(Ua,Hb,$b,sc),Array.add(this.BXb,Ua))}pmn(Ua){for(let Hb=0;Hb<this.BXb.length;Hb++)if(this.BXb[Hb].CommandId===Ua){const $b=this.BXb[Hb].Label;let sc=!1;if(0<this.Lzb.length){let Wc=0;for(const dd of this.Lzb){if(dd.Label===$b){Array.removeAt(this.Lzb,Wc);sc=!0;break}Wc++}}!sc&&this.Lzb.length>=this.jnf-1&&Array.removeAt(this.Lzb,
1);Array.insert(this.Lzb,0,this.BXb[Hb])}}}Bj.ZSa=null;Bj.roi=null;Bj.tej=null;Object(f.a)(Bj,"FindInDocumentResultsProvider",null,[1035]);var xi=b(1558);class Ue{constructor(Ua){this.Gb=Ua}ZX(){return"Insights"}Bba(){return 0===this.Gb.WA?0:1===this.Gb.WA?1:2}HS(Ua,Hb,$b=!1,sc,Wc=null){sc=new l.a(Ua);if(!Wc||Array.contains(Wc,13))if(this.atn()||!Jh.a.O7(Ua)){Wc=new m.a(13);var dd=""===Ua.Qg.trim(),td=dd?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",oe=new fj.a(td,10,Ua.Qg,null,1);$b&&($b=
null,Jh.a.AVa()?dd?dd=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(dd=this.Gb.SSc?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,Ua.Qg),$b=Jh.a.ejb(Ua.Qg,1)):(dd=String.format(CommonUIStrings.l_InsightsButtonText,Ua.Qg),$b=Jh.a.Z5b(Ua.Qg)),this.Gb.Fmb?(Pe.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(td,dd)),$b&&Pe.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
$b))):(Ua=[],Ua.push(appChrome.actions.setControlLabel(td,dd)),$b&&Ua.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",$b)),appChrome.api.dispatch(Ua)),oe.label=dd);Wc.DB(oe);sc.DA(Wc)}Hb.resultsUpdated(sc)}atn(){return Jh.a.AVa()&&this.Gb.LCn}}Object(f.a)(Ue,"InsightsResultsProvider",null,[1035]);var sf=b(1555);class lm{constructor(Ua){this.Gb=Ua}ZX(){return"Learning"}Bba(){return 0===this.Gb.WA?0:1===this.Gb.WA?1:2}HS(Ua,Hb,$b,sc,Wc=null){$b=new l.a(Ua);Wc&&!Array.contains(Wc,
21)||!Jh.a.O7(Ua)||(Wc=[],sc=this.Gb.mkm,Wc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",sc)),sc=lm.WAl(sc),Wc.push(appChrome.actions.setControlLabel("LearningForSearch",sc)),appChrome.api.dispatch(Wc),Ua=new fj.a("LearningForSearch",22,Ua.Qg,null,1),Wc=new m.a(21),Wc.DB(Ua),$b.DA(Wc));Hb.resultsUpdated($b)}static WAl(Ua){const Hb=[];Array.add(Hb,new sf.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Hb,new sf.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(Hb,new sf.a(600,Ua));Array.add(Hb,new sf.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));Ua={};Ua.parts=Hb;return JSON.stringify(Ua)}}Object(f.a)(lm,"LearningProvider",null,[1035]);var Sc=b(441);class De{constructor(Ua,Hb){this.fuc=this.xxc=this.lAb=this.dae=null;this.Rs=!1;this.Huc=Ua;this.J6j=Hb;Ua&&this.Emi(Ua)}G2e(){this.Huc.G2e()&&this.Emi(this.Huc)}FPl(Ua){let Hb=[];var $b=[];Ua=De.cAm(Ua);var sc="";Array.clear($b);for(let Wc=0;Wc<Ua.length;Wc++){const dd=Ua.charAt(Wc);-1!==
" ".indexOf(dd)?(sc.length&&Array.add($b,sc),sc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(dd)?(sc.length&&Array.add($b,sc),sc=dd,Array.add($b,sc),sc=""):sc+=dd}sc.length&&Array.add($b,sc);for(Ua=0;Ua<$b.length;Ua++)sc=this.Tul($b[Ua]),sc=this.CYk(sc),Hb=De.$vm(Hb,sc);return Hb=this.cwk(Hb)}Ypg(){this.Rs||this.G2e();return this.Rs}lqe(Ua){return this.dae[Ua.toString()]}cwk(Ua){for(let Hb=0;Hb<Ua.length;Hb++){const $b=this.lAb[Hb];if(Ua[Hb].commandId!==this.lqe($b[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let sc;(sc=Ua[Hb]).score=sc.score+$b[1]}return Ua}CYk(Ua){const Hb=[];for(var $b=0;$b<this.lAb.length;$b++)Hb.push(new bk.a(this.lqe(this.lAb[$b][0]),-5));$b=new Sc.a;for(var sc=0;sc<Ua.length;sc++)$b.add(this.lqe(Ua[sc][0]));for(sc=0;sc<Hb.length;sc++){const dd=Hb[sc];for(let td=0;td<Ua.length;td++){var Wc=Ua[td];const oe=this.lqe(Wc[0]);Wc=Wc[1];if(oe===dd.commandId){dd.score=Wc;$b.remove(oe);break}}if(!$b.count)break}return Hb}Tul(Ua){const Hb=1>Ua.length;for(let td=0;2>=td;td++){const oe=this.fuc;
for(let Ld in oe){var $b=oe[Ld],sc=Ua,Wc=Ld;const Mf=Wc.length+1,Rf=Array((sc.length+1)*Mf);for(var dd=0;dd<=sc.length;dd++)Rf[dd*Mf]=dd;for(dd=0;dd<=Wc.length;dd++)Rf[dd]=dd;for(dd=0;dd<Wc.length;dd++)for(let yi=0;yi<sc.length;yi++)Rf[(yi+1)*Mf+(dd+1)]=sc.charAt(yi)===Wc.charAt(dd)?Rf[yi*Mf+dd]:Math.min(Math.min(Rf[yi*Mf+(dd+1)]+1,Rf[(yi+1)*Mf+dd]+1),Rf[yi*Mf+dd]+1);sc=Rf[sc.length*Mf+Wc.length];if((!sc||!Hb)&&sc<=td)return $b}}return this.xxc}Emi(Ua){this.dae=Ua.k$f();this.lAb=Ua.aLl();this.xxc=
Ua.rSl();this.fuc=Ua.ODl();if(this.Rs=!!this.dae&&!!this.lAb&&!!this.fuc&&!!this.xxc)this.Rs=0<this.lAb.length&&De.gmg(this.lAb);this.Rs&&(this.Rs=0<this.xxc.length&&De.gmg(this.xxc));this.Rs&&(this.fuc=De.XSl(this.fuc));this.Rs||(this.fuc=this.xxc=this.lAb=this.dae=null)}FRl(Ua){Ua=this.FPl(Ua);return this.Ijl(Ua,this.J6j)}Ijl(Ua,Hb){let $b=[];for(let sc=0;sc<Ua.length;sc++)Ua[sc].score>=Hb&&$b.push(Ua[sc]);$b.sort((sc,Wc)=>sc.score<Wc.score?1:sc.score>Wc.score?-1:0);0<$b.length-10&&($b=$b.slice(0,
10));return $b}static $vm(Ua,Hb){if(!Ua.length)return Hb;if(Ua.length!==Hb.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let $b=0;$b<Ua.length;$b++){if(Ua[$b].commandId!==Hb[$b].commandId)throw Error.create("Incorrect CommandId");let sc;(sc=Ua[$b]).score=sc.score+Hb[$b].score}return Ua}static cAm(Ua){return yh.a.He(Ua)}static gmg(Ua){for(let Hb=0;Hb<Ua.length;Hb++)if(2!==Ua[Hb].length)return!1;return!0}static XSl(Ua){const Hb={};for(let Wc in Ua){var $b=
Wc,sc=Ua[Wc];const dd=sc;dd.length&&De.gmg(dd)&&(Hb[$b]=sc)}return Hb}}Object(f.a)(De,"NaiveBayesClassifierModel",null,[]);class uk{constructor(Ua,Hb){this.nEa=null;this.Gb=Ua;this.R7c=new De(Hb,Ua.HGl);this.Gb.uhb&&(this.nEa=this.Gb.Rve())}ZX(){return"NBCommand"}Bba(){return 0===this.Gb.WA?0:1===this.Gb.WA?1:2}HS(Ua,Hb,$b=!1,sc=c.a.tellMe,Wc=null){const dd=new l.a(Ua);if((!Wc||Array.contains(Wc,0))&&!Jh.a.O7(Ua)){if(de.CommandResultsUtility.Pmg(Ua.Qg)&&(Wc=de.CommandResultsUtility.Zui(Ua.Qg),0<Wc.results.length)){Wc.displayName=
"Classifier Debug";dd.DA(Wc);Hb.resultsUpdated(dd);return}if(!this.R7c.Ypg()){if(Pe.TellMeActor.instance.Qe)Pe.TellMeActor.instance.Qe.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.Gb.uhb&&this.nEa&&this.nEa.initialize();Wc=this.R7c.FRl(Ua.Qg);de.CommandResultsUtility.nKe(Wc,!1,"Classifier","NaiveBayesian");Wc=de.CommandResultsUtility.pze(Wc,this.Gb,this.nEa,null,null,0,1);0<Wc.results.length&&
sc!==c.a.contextMenu&&(Wc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);$b||Wc.results.length||this.Gb.hY||this.Gb.bLa||(Ua=new fj.a("lookupNoResults",14,Ua.Qg,null,1),Wc.DB(Ua));0<Wc.results.length&&dd.DA(Wc)}Hb.resultsUpdated(dd)}}Object(f.a)(uk,"NaiveBayesCommandProvider",null,[1035]);class Th{constructor(){this.wXb=null;this.Rs=!1;this.G2e()}G2e(){this.Rs||(this.wXb=window.NBCRM)&&4===this.wXb.length&&(this.Rs=!0);return this.Rs}aLl(){return this.Rs?this.wXb[1]:null}rSl(){return this.Rs?
this.wXb[2]:null}ODl(){return this.Rs?this.wXb[3][0]:null}k$f(){return this.Rs?this.wXb[0][0]:null}}Object(f.a)(Th,"NaiveBayesModelAdapter",null,[1068]);var kc=b(75),ei=b(265),jg=b(1374),gj=b(1334),Vk=b(1373),Ef=b(32),tn=b(130),kh=b(1285);class Qe{constructor(Ua){this.AW=null;this.M9=-1;this.Hzg=14;this.Lzg=12;this.attributes=this.nyf=this.query=null;this.KKc=!1;this.Yvc=[];this.nf=Kj.AFrameworkApplication.Gd;Kj.AFrameworkApplication.K&&(this.Hzg=Kj.AFrameworkApplication.K.jb("TellMeMaxTermedResults",
this.Hzg),this.Lzg=Kj.AFrameworkApplication.K.jb("TellMeMaxZeroTermResults",this.Lzg));this.B0=Ua}get lp(){return this.Yvc}get g3e(){return this.nyf}DA(Ua){let Hb=!1;for(let $b=0;$b<this.lp.length;$b++)if(25!==this.lp[$b].groupType&&this.lp[$b].groupType===Ua.groupType){this.NBf(this.lp[$b],Ua);Hb=!0;break}Hb||this.lp.push(Ua)}NBf(Ua,Hb){for(let $b=0;$b<Hb.results.length;$b++)Ua.DB(Hb.results[$b])}yUg(Ua){const Hb=[];for(const $b of this.lp)$b.groupType!==Ua&&Hb.push($b);this.lp.length!==Hb.length&&
(this.Yvc=Hb)}M6m(Ua){let Hb=null,$b=null,sc=null;for(let Wc=0;Wc<Ua.length;Wc++){const dd=Ua[Wc];if(dd&&dd.lp&&dd.lp.length)for(const td of dd.lp)if(17===td.groupType||18===td.groupType)Hb=td;else if(0===td.groupType||16===td.groupType)$b=td,sc=dd}Hb&&$b&&0<$b.results.length&&(17===Hb.groupType&&(Hb.results.length?{XAf:$b,bCf:Hb}=de.CommandResultsUtility.avk($b,Hb,this.B0.WU()?this.B0.WU().Cul:-.6):sc.yUg(Hb.groupType)),sc.yUg($b.groupType))}Fxn(){new kc.a;this.oWd(this.B0.r2i)}KEd(Ua,Hb){return this.query.Qg.length>
this.B0.WU().CLl&&this.Udm(Ua,Hb)||this.query.Qg.length>this.B0.WU().DLl&&this.Vfm(Ua,Hb)?!0:!1}Vfm(Ua,Hb){return Ua&&Ua.length&&Hb&&Hb.length?-1===Hb.toLowerCase().indexOf(Ua.toLowerCase())?!1:!0:!1}Udm(Ua,Hb){return Ua&&Ua.length&&Hb&&Hb.length?Hb.toLowerCase().startsWith(Ua.toLowerCase()):!1}Qjl(Ua){const Hb=[];for(const $b of this.B0.WU().K8?this.g3e:this.lp)Ua.contains($b.groupType)||Hb.push($b);this.B0.WU().K8?this.nyf=Hb:this.Yvc=Hb}KOn(Ua,Hb){const $b=[];for(const sc of this.lp){const Wc=
sc;if(13!==Wc.groupType){const dd=Ua[gj.a[Wc.groupType].toLowerCase()];let td="False";dd<Hb&&(td="True");Wc.displayName=Wc.displayName+" ("+td+": "+dd+")"}$b.push(Wc)}this.Yvc=$b}oWd(Ua,Hb=!1,$b=null){if(this.B0.WU().K8){if(!Hb)for(this.nyf=Array(this.lp.length),Hb=0;Hb<this.lp.length;Hb++)this.g3e[Hb]=this.lp[Hb];this.B0.x2i.oWd(this.lp,this.g3e,this.query,Ua,$b)}else{for($b=new kc.a;this.lp.length;){Hb=this.lp.pop();const sc=gj.a[Hb.groupType].toLowerCase(),Wc=Ua[sc];if(kh.c(Wc))throw Error.create("GroupId "+
sc+" missed from group SortingOrder");$b.add(new ei.a(Wc,Hb))}$b.Sc((sc,Wc)=>sc.key<Wc.key?-1:1);for(Ua=0;Ua<$b.count;Ua++)Hb=$b.J(Ua).value,this.lp.push(Hb)}}Gxn(){var Ua=!1;let Hb=!1,$b=!1;for(let Wc=0;Wc<this.lp.length;Wc++){var sc=this.lp[Wc];const dd=sc.groupType;if(8===dd||15===dd||14===dd){sc=sc.results;for(let td=0;td<sc.length;td++){if(8===dd&&this.KEd(this.query.Qg,sc[td].label)){Ua=!0;break}if(15===dd&&this.KEd(this.query.Qg,sc[td].label)){Hb=!0;break}if(14===dd){if(this.KEd(this.query.Qg,
sc[td].label)||this.KEd(this.query.Qg,sc[td].description)){$b=!0;break}const oe=sc[td].label.split(" ");for(const Ld of oe)if(this.KEd(this.query.Qg,Ld)){$b=!0;break}}}}}Ua=this.B0.eNl(Ua,Hb,$b);this.oWd(Ua)}Qgc(Ua,Hb,$b,sc,Wc,dd){if(Wc===this.AW){var td=Ua.data.Rd;Wc=null;try{Wc=Ef.b(td)}catch(Xg){Pe.TellMeActor.instance.Qe.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+Xg);return}if("RankerResults"in Wc&&Wc.RankerResults){this.ERa();var oe=Wc.RankerResults,
Ld=new kc.a,Mf=new kc.a;td=0;for(var Rf of oe){oe=Rf.ProviderId;var yi=Rf.Score;td+=yi;Ld.add(new ei.a(oe,yi))}Ld.Sc((Lm,Fi)=>Lm.value>Fi.value?-1:1);yi=dd?dd.PDi:1E-6;Rf={};oe={};let Xg=0;for(var $i=0;$i<Ld.count;$i++){let Lm=parseInt(Ld.J($i).key),Fi=Ld.J($i).value/td;1===Lm&&(oe.answer=Xg++,oe.entity=Xg++,oe.definition=Xg++,oe.wolframanswer=Xg++,Fi<yi&&(Mf.add(9),Mf.add(11),Mf.add(10),Mf.add(12)),Rf.answer=Fi,Rf.entity=Fi,Rf.definition=Fi,Rf.wolframanswer=Fi);2===Lm&&(oe.assistance=Xg++,Fi<yi&&
Mf.add(8),Rf.assistance=Fi);3===Lm&&(oe.classifier=Xg++,oe.serviceclassifier=Xg++,Fi<yi&&(Mf.add(0),Mf.add(17)),Rf.classifier=Fi,Rf.serviceclassifier=Fi);4===Lm&&(oe.people=Xg++,Fi<yi&&Mf.add(14),Rf.people=Fi);5===Lm&&(oe.document=Xg++,Fi<yi&&Mf.add(15),Rf.document=Fi);6===Lm&&(oe.findindocument=Xg++,Fi<yi&&Mf.add(2),Rf.findindocument=Fi);7===Lm&&(oe.notes=Xg++,Fi<yi&&Mf.add(20),Rf.notes=Fi);8===Lm&&(oe.image=Xg++,Fi<yi&&Mf.add(19),Rf.image=Fi)}Ld=new kc.a;Ld.add("classifier");Ld.add("serviceclassifier");
Ld.add("appsforoffice");Ld.add("addin");Ld.add("findindocument");Ld.add("assistance");Ld.add("document");Ld.add("people");Ld.add("answer");Ld.add("wolframanswer");Ld.add("definition");Ld.add("entity");Ld.add("image");Ld.add("template");for($i=0;$i<Ld.count;$i++)Ld.J($i)in oe||(oe[Ld.J($i)]=Xg++);oe.learning=Xg++;oe.insights=Xg++;oe.feedback=Xg++;dd&&dd.NSi&&this.KOn(Rf,yi);dd&&dd.OSi&&this.Qjl(Mf);Mf={};for(var he in Rf)Mf[he]=Rf[he]*td;this.oWd(oe,!0,Mf)}if(dd.cHe&&"Intents"in Wc&&Wc.Intents){he=
Wc.Intents;for(var fi of he)if(this.jtg(fi)&&"Serplet"===fi.GroupType&&fi.ConfidenceScore>fi.ConfidenceThreshold){he=!1;Wc=0;if(dd.dHe){td=new fj.a("",26);for(Mf=0;Mf<this.lp.length;Mf++)if((Ld=this.lp[Mf].results)&&0<Ld.length){Wc=Mf;td=Ld[0];break}2===td.groupType&&(he=!0)}td=new m.a(13);he&&dd.dHe&&(td=new m.a(13,CommonUIStrings.l_TellMeWebTitle));Mf=new fj.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Qg,null,0);Ld=[];Rf=null;Rf=Jh.a.AVa()?Jh.a.ejb(this.query.Qg,1):Jh.a.Z5b(this.query.Qg);
Ld.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",Rf));Rf=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Qg);Ld.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",Rf));appChrome.api.dispatch(Ld);td.DB(Mf);Mf=[];if(he&&dd.dHe)for(Mf.push(this.lp[Wc]),Mf.push(td),he=Wc+1;he<this.lp.length;he++)(Wc=this.lp[he].results)&&0<Wc.length&&Mf.push(this.lp[he]);else for(Mf.push(td),he=0;he<this.lp.length;he++)(Wc=this.lp[he].results)&&
0<Wc.length&&Mf.push(this.lp[he]);this.Yvc=Mf}}if(dd.UEd&&!dd.K8){fi=he=-1;for(Wc=0;Wc<this.lp.length;Wc++)switch(this.lp[Wc].groupType){case 23:he=Wc;break;case 0:case 17:case 2:-1===fi&&(fi=Wc)}if(-1!==he){fi=-1===fi?0:he>fi?fi+1:fi;he=this.lp[he];Wc=Array(this.lp.length);td=0;for(Mf=0;Mf<Wc.length;Mf++)Mf===fi?Wc[Mf]=he:(23===this.lp[td].groupType&&td++,Wc[Mf]=this.lp[td],td++);this.Yvc=Wc}}sc.resultsUpdated(this);sc=Pe.TellMeActor.instance.Qe;sc.$ga(Hb.length,"RankerInference",Ua.data.Ge.toString(),
Math.round(window.performance.now()-$b),Vk.a.kIj,!0,jg.a.o5a);this.KKc&&sc&&(Ua=this.query.lLb,Hb=sc.b5d,dd.zHe&&Ua>Hb&&!dd.K8&&(sc.Hxg(this.query.Qg),sc.h0g(Ua)))}}jtg(Ua){if("GroupType"in Ua&&Ua.GroupType&&"ConfidenceScore"in Ua&&"ConfidenceThreshold"in Ua)return!0;Pe.TellMeActor.instance.Qe.onError("IsValidIntentGroup","Invalid intents found");return!1}ygc(Ua,Hb,$b,sc,Wc){sc===this.AW&&(this.ERa(),Pe.TellMeActor.instance.Qe.$ga(Hb.length,"RankerInference",Ua.data.Ge.toString(),Math.round(window.performance.now()-
$b),Vk.a.kIj,!1,jg.a.o5a));Wc.resultsUpdated(this)}ERa(){-1!==this.M9&&(window.clearTimeout(this.M9),this.M9=-1)}Hxn(Ua){let Hb;Hb=this.B0.WU().K8?Pe.TellMeActor.instance.Qe.pcg(this.g3e,this.query.Qg):Pe.TellMeActor.instance.Qe.pcg(this.lp,this.query.Qg);var $b=this.B0.WU().ODi;""!==$b&&($b="_"+$b);let sc="";this.B0.WU().mGe&&(sc="RankerInference"+$b+",");this.B0.WU().cHe&&(sc+="SerpletClassifier");","===sc.charAt(sc.length-1)&&(sc=sc.substring(0,sc.length-1));$b=Pe.TellMeActor.instance.Qe.rFi(sc);
const Wc=this.AW=tn.a.create().toString();$b["Client-Request-Id"]=Wc;const dd=window.performance.now(),td=this.B0.WU()?this.B0.WU().QDi:1E3;this.ERa();this.M9=window.setTimeout(()=>{if(Wc===this.AW){this.AW="";this.M9=-1;Ua.resultsUpdated(this);const oe={};oe[u.a.provider]="Ranker";oe[u.a.pic]=this.query.lLb;Pe.TellMeActor.instance.Qe.pD(r.a.timedOut,td,oe)}},td);this.nf.Ni(Pe.TellMeActor.instance.Qe.sFi(),2,Hb,$b,!1,0,oe=>{this.Qgc(oe,this.query.Qg,dd,Ua,Wc,this.B0.WU())},oe=>{this.ygc(oe,this.query.Qg,
dd,Wc,Ua)},null,null,!1,4E3,6E3)}HGn(){var Ua=0,Hb=new kc.a,$b=this.B0.p2i,sc=this.B0.q2i;for(var Wc=0;Wc<this.lp.length;Wc++){var dd=this.lp[Wc],td=gj.a[dd.groupType].toLowerCase(),oe=$b[td];Ua+=dd.results.length;dd.results.length>oe&&(td=sc[td],kh.c(td)||Hb.add(new ei.a(td,dd)))}sc=!this.query||""===this.query.Qg.trim();Wc=Ua-(sc?this.Lzg:this.Hzg);if(!(0>=Wc)){sc=window.performance.now();Ua=Ua.toString()+" total,"+Wc.toString()+" to remove.";if(0<Hb.count)for(Hb.Sc((Ld,Mf)=>Ld.key>Mf.key?-1:1),
dd=0;dd<Hb.count&&0<Wc;dd++){td=Hb.J(dd).value;oe=gj.a[td.groupType].toLowerCase();let Ld=td.results.length-$b[oe];Ld>Wc&&(Ld=Wc);0<Ld&&(td.zUg(Ld),Ua+=oe+": "+Ld.toString()+" results removed.",Wc-=Ld)}if(0<Wc){Ua+=Wc.toString()+" results left after trimming.";Hb=new kc.a;$b=this.B0.u2i;for(dd=0;dd<this.lp.length;dd++)td=this.lp[dd],oe=$b[gj.a[td.groupType].toLowerCase()],kh.c(oe)||Hb.add(new ei.a(oe,td));Hb.Sc((Ld,Mf)=>Ld.key<Mf.key?-1:1);for($b=0;0<Wc;)dd=Hb.J($b++).value,Wc>=dd.results.length?
(Array.remove(this.lp,dd),Ua+=gj.a[dd.groupType]+": "+dd.results.length.toString()+" results force removed.",Wc-=dd.results.length):(dd.zUg(Wc),Ua+=gj.a[dd.groupType]+": "+Wc.toString()+" results force removed.",Wc=0)}Pe.TellMeActor.instance.Qe&&(Hb={},Hb[u.a.message]=Ua,Pe.TellMeActor.instance.Qe.pD("ShowOptimal",window.performance.now()-sc,Hb))}}}Object(f.a)(Qe,"CombineResultsUpdatedEventArgs",null,[1016]);var Nn=b(1450);class xg{constructor(Ua,Hb,$b,sc=!1,Wc=""){this.Cqf=this.Rsf=!1;this.Tq=Ua;
this.c_b=[];this.FKh=Hb.length;this.Gb=Pe.TellMeActor.instance.WU();this.M9d=sc;this.jQa=Wc;this.Ywc={};for(Ua=0;Ua<Hb.length;++Ua)this.Ywc[Ua.toString()]=$b?0:Hb[Ua].Bba()}Nnn(Ua,Hb){Hb&&Hb.query&&Hb.query.lLb<Pe.TellMeActor.instance.RFa||(this.c_b[Ua]=Hb,this.Cqf?this.Rsf=!0:(!this.Gb||3!==this.Gb.WA||3!==this.Ywc[Ua.toString()]||this.Ggi())&&this.pHb())}XPm(){this.Cqf=!0}uJn(){this.Cqf=!1;this.Rsf&&(this.Rsf=!1,this.pHb())}Ggi(){if(this.c_b.length<this.FKh)return!1;for(let Ua=0;Ua<this.FKh;++Ua)if(!this.c_b[Ua])return!1;
return!0}pHb(){var Ua=this.Ggi();const Hb=window.performance.now(),$b=new Qe(Pe.TellMeActor.instance.eyh);$b.M6m(this.c_b);for(var sc=0;sc<this.c_b.length;++sc){var Wc=this.c_b[sc];if(Wc&&Wc.lp&&Wc.lp.length&&($b.query=Wc.query,Wc.attributes&&0<Wc.attributes.length&&($b.attributes=Wc.attributes),Wc&&Wc.lp&&(Ua||this.dRk(sc,this.c_b))))for(const dd of Wc.lp)$b.DA(dd)}$b.lp&&$b.lp.length&&($b.KKc=Ua,this.Gb&&this.Gb.r2e&&$b.HGn(),Nn.a.GUi()&&(this.Gb&&this.Gb.Uem&&$b.query.Qg&&0<$b.query.Qg.length?
$b.Gxn():$b.Fxn()),Nn.a.GUi()&&this.Gb&&(this.Gb.mGe||this.Gb.cHe)&&this.M9d&&$b.query.Qg&&0<$b.query.Qg.length&&$b.KKc&&this.jQa!==c.a.contextMenu?(3===this.Gb.WA&&Ua||this.Tq.resultsUpdated($b),$b.Hxn(this.Tq)):this.Tq.resultsUpdated($b),Ua=Pe.TellMeActor.instance.Qe,$b.KKc&&Ua&&(sc=$b.query.lLb,Wc=Ua.b5d,$b.query.Qg&&0<$b.query.Qg.length&&this.M9d&&this.Gb.zHe&&this.jQa!==c.a.contextMenu&&sc>Wc&&!this.Gb.mGe&&!this.Gb.K8&&(Ua.Hxg($b.query.Qg),Ua.h0g(sc)),Ua.pD(r.a.Tbn,window.performance.now()-
Hb)))}dRk(Ua,Hb){if(!(this.Ywc&&Ua.toString()in this.Ywc)||Hb.length<=Ua||!Hb[Ua])return!1;if(!Hb[Ua].lp.length)return!0;const $b=this.Ywc[Ua.toString()];if(0===$b)return!0;const sc=this.Ywc;for(let dd in sc){var Wc=sc[dd];const td=Number.parseInvariant(dd);if(td!==Ua&&Wc===$b&&!(Hb.length>td&&Hb[td]))return!1}return!0}}Object(f.a)(xg,"ResultsAggregator",null,[]);var el=b(1582);class jh{constructor(){this.uUc=this.vUc=this.tUc=this.logCount=this.logRank=this.invertedRank=0}Ruk(Ua,Hb){switch(Ua){case 1:this.invertedRank=
Hb;break;case 3:this.logRank=Hb;break;case 2:this.logCount=Hb;break;case 5:this.tUc=Hb;break;case 4:this.vUc=Hb;break;case 6:this.uUc=Hb}}}Object(f.a)(jh,"CommandFeatures",null,[]);class gh{constructor(Ua){this.Xvh=0;this.bgk=Ua;this.r5j={}}get modelId(){return this.bgk}get featureIntercept(){return this.Xvh}get Vkd(){return this.r5j}$tk(Ua,Hb,$b){0===Hb?this.Xvh=$b:(this.Vkd[Ua]||(this.Vkd[Ua]=new jh),this.Vkd[Ua].Ruk(Hb,$b))}}Object(f.a)(gh,"CoefficientsModel",null,[]);const Ed=(Ua,Hb)=>Math.pow(10,
-Hb/(60*Math.LN10/Math.LN2*Ua));class Vj{constructor(Ua,Hb){this.Ig=1;this.zTb=new jh;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=Ua?1/Ua:0;this.features.logRank=2/Math.pow(2,Ua);this.features.tUc=Ed(10,Hb);this.features.vUc=Ed(2,Hb);this.features.uUc=Ed(1,Hb)}get count(){return this.Ig}get features(){return this.zTb}jMi(){this.Ig=this.count+1;this.features.logCount=1+Math.log(this.count)/Math.LN2}vOn(Ua){const Hb=2/Math.pow(2,Ua);this.features.invertedRank=Math.max(this.features.invertedRank,
Ua?1/Ua:0);this.features.logRank=Math.max(this.features.logRank,Hb)}JPn(Ua){const Hb=Ed(10,Ua),$b=Ed(2,Ua);Ua=Ed(1,Ua);this.features.tUc=Math.max(this.features.tUc,Hb);this.features.vUc=Math.max(this.features.vUc,$b);this.features.uUc=Math.max(this.features.uUc,Ua)}}Object(f.a)(Vj,"CommandModel",null,[]);class hj{constructor(Ua){this.mZc=null;if(!Ua&&Pe.TellMeActor.instance.Qe)Pe.TellMeActor.instance.Qe.onError("PredictionEngine","IModelAdapter can't be null");this.Huc=Ua;this.cae=this.dwg()}dwg(){const Ua=
this.Huc.kGl(),Hb=this.Huc.k$f();if(void 0===Ua||null===Ua||void 0===Hb||null===Hb)return!1;try{window.performance.now();this.mZc={};for(let $b=0;$b<Ua.length;$b++){const sc=Ua[$b],Wc=Hb[sc[0].toString()].trim(),dd=sc[1],td=0!==dd?Hb[sc[2].toString()].trim():"",oe=sc[3];Wc in this.mZc||(this.mZc[Wc]=new gh(Wc));this.mZc[Wc].$tk(td,dd,oe)}}catch($b){if(Pe.TellMeActor.instance.Qe)Pe.TellMeActor.instance.Qe.onError("LoadModelData","Error Loading Suggestions Model: "+$b);return!1}return!0}Hpl(){const Ua=
this.Huc.nDl(),Hb={};if(!Ua)return Hb;let $b=1;for(let sc=0;sc<Ua.length;sc++){const Wc=Ua[sc];Wc.Id in Hb?(Hb[Wc.Id].jMi(),Hb[Wc.Id].vOn($b),Hb[Wc.Id].JPn(Wc.TimeElapsedSinceClick)):Hb[Wc.Id]=new Vj($b,Wc.TimeElapsedSinceClick);$b++}return Hb}Ypg(){this.cae||(this.cae=this.dwg());return this.cae}wKl(){let Ua=[];if(!this.cae){if(Pe.TellMeActor.instance.Qe)Pe.TellMeActor.instance.Qe.onError("GetPredictedCommands","IModelAdapter returned no data");return Ua}const Hb=this.Hpl(),$b=this.mZc;for(let Wc in $b){const dd=
$b[Wc],td=dd.modelId;let oe=0;for(let Ld in Hb){var sc=Ld;const Mf=Hb[Ld].features;(sc=sc in dd.Vkd?dd.Vkd[sc]:null)&&(oe+=Mf.invertedRank*sc.invertedRank+Mf.logRank*sc.logRank+Mf.logCount*sc.logCount+Mf.tUc*sc.tUc+Mf.vUc*sc.vUc+Mf.uUc*sc.uUc)}oe+=dd.featureIntercept;Ua.push(new bk.a(td,oe))}Ua.sort((Wc,dd)=>Wc.score<dd.score?1:Wc.score>dd.score?-1:0);0<Ua.length-10&&(Ua=Ua.slice(0,10));return Ua}}Object(f.a)(hj,"PredictionEngine",null,[]);class zf{constructor(){this.VMh={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),
"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),
"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),
"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),
"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}lwe(Ua,Hb){return Hb&&"word"===Hb.application.toLowerCase()&&
Ua in this.VMh?this.VMh[Ua]:[]}}Object(f.a)(zf,"SuggestionResultsUtility",null,[]);class Ke{constructor(Ua,Hb,$b){this.Gb=Hb;this.R7c=new hj(Ua);this.u$=$b;this.ZOh=new zf}ZX(){return"Suggestion"}Bba(){return 0===this.Gb.WA?0:1===this.Gb.WA?1:2}HS(Ua,Hb,$b,sc=c.a.tellMe,Wc=null){$b=new l.a(Ua);Pe.TellMeActor.instance.z0d=!1;if((!Wc||Array.contains(Wc,16))&&Jh.a.O7(Ua)){if(!this.R7c.Ypg()){if(Pe.TellMeActor.instance.Qe)Pe.TellMeActor.instance.Qe.onError("CRASH","SuggestionResultsProvider: Found invalid Model data");
throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}if(this.ZGe()&&0<this.ZOh.lwe(Pe.TellMeActor.instance.$pe,this.Gb).length){Wc=this.ZOh.lwe(Pe.TellMeActor.instance.$pe,this.Gb);Ua=[];for(var dd of Wc)this.Gb.YYe&&"Find"===dd||Ua.push(new bk.a(dd,0));Pe.TellMeActor.instance.z0d=!0}else Ua=this.R7c.wKl();de.CommandResultsUtility.nKe(Ua,!0,"Recommended","LRE");dd=[];for(var td of Ua)this.u$&&this.u$.bPf(td.commandId)||dd.push(td);td=de.CommandResultsUtility.pze(dd,this.Gb,
null,null,null,16,1);0<td.results.length&&sc!==c.a.contextMenu&&(td.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<td.results.length&&$b.DA(td)}Hb.resultsUpdated($b)}ZGe(){return!!this.Gb&&(this.Gb.ZGe||this.Gb.Vhm)}}Object(f.a)(Ke,"SuggestionResultsProvider",null,[1035]);class Bg{nDl(){return Pe.TellMeActor.instance.Gaf}kGl(){return window.TellMeSuggestionModel}k$f(){return window.CoefficientModelIdMap}}Object(f.a)(Bg,"SuggestionsModelAdapter",null,[1067]);var wj=b(1556),Ok=b(1559);b.d(L,
"AggregatorResultsProvider",function(){return Yb});class Yb{constructor(Ua=!1){this.Ovc={};this.Ovc[c.a.tellMe]=[];this.Ovc[c.a.contextMenu]=[];this.M9d=Ua}XVi(Ua,Hb,$b,sc,Wc=null){let dd;var td=!1;switch(sc){case c.a.contextMenu:dd=this.Ovc[c.a.contextMenu];td=!0;break;default:dd=this.Ovc[c.a.tellMe]}Hb=new xg(Hb,dd,td,this.M9d,sc);Hb.XPm();for(let oe=0;oe<dd.length;++oe){const Ld=window.performance.now(),Mf=new k(Hb,oe);(td=Pe.TellMeActor.instance.WU())&&td.$Hk?window.setTimeout(()=>{dd[oe].HS(Ua,
Mf,$b,sc,Wc);if(Pe.TellMeActor.instance.Qe){const Rf={};Rf[u.a.provider]=dd[oe].ZX();Rf[u.a.pic]=Ua.lLb;Pe.TellMeActor.instance.Qe.pD(r.a.HS,window.performance.now()-Ld,Rf)}},0):(dd[oe].HS(Ua,Mf,$b,sc,Wc),Pe.TellMeActor.instance.Qe&&(td={},td[u.a.provider]=dd[oe].ZX(),td[u.a.pic]=Ua.lLb,Pe.TellMeActor.instance.Qe.pD(r.a.HS,window.performance.now()-Ld,td)))}Hb.uJn()}ZX(){return"Aggregator"}Bba(){return 0}HS(Ua,Hb,$b=!1,sc=c.a.tellMe,Wc=null){if(Pe.TellMeActor.instance.zxm)this.XVi(Ua,Hb,$b,sc,Wc);
else{const dd=window.performance.now();Pe.TellMeActor.instance.YRn.then(()=>{Pe.TellMeActor.instance.Qe&&Pe.TellMeActor.instance.Qe.pD(r.a.Axm,window.performance.now()-dd);this.XVi(Ua,Hb,$b,sc,Wc);return!0})}}iP(Ua,Hb){this.Ovc[Hb].push(Ua)}tvk(Ua){switch(Ua){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Hb=this.Ovc[c.a.tellMe];for(const $b of Hb)if("FindInDocument"===$b.ZX()){$b.pmn(Ua);break}}}static createInstance(Ua,Hb,$b,sc){const Wc=sc&&Jh.a.a4g(Hb);
var dd=Wc&&Hb.cKg;const td=Hb.Jsg&&!Jh.a.$cc(),oe=new Yb(Wc);if(Hb.btn){var Ld=new lm(Hb);oe.iP(Ld,c.a.tellMe)}Ld=Hb.lo?Kj.AFrameworkApplication.K.ea("TellMeIsSuggestionsForSimplifiedUxEnabled"):Kj.AFrameworkApplication.K.ea("TellMeSuggestionsIsEnabled");const Mf=!Ld&&Kj.AFrameworkApplication.K.ea("TellMeFirstRunExperienceIsEnabled");oe.iP(new Nk.a(Ua,Hb.eIn,Mf,!1),c.a.tellMe);Ld&&oe.iP(new Ke(new Bg,Hb,Ua),c.a.tellMe);Ua=Kj.AFrameworkApplication.la.eb.Ksg?new uk(Hb,new Th):new $g(Hb,$b);oe.iP(Ua,
c.a.contextMenu);(Wc&&Hb.dKg||dd)&&oe.iP(wj.a.Idi(Hb,!0),c.a.tellMe);oe.iP(Ua,c.a.tellMe);!Hb.noi||"Word"===Hb.application&&Hb.nue||oe.iP(new Bj(Hb),c.a.tellMe);Hb.uhb&&(dd=new x(Hb),oe.iP(dd,c.a.tellMe),oe.iP(dd,c.a.contextMenu));!Hb.Bhb||Hb.cVd||Hb.RSc||oe.iP(new w.a(Hb),c.a.tellMe);sc&&(Hb.hY||Jh.a.AVa())&&(dd=new Ue(Hb),oe.iP(dd,c.a.tellMe),oe.iP(dd,c.a.contextMenu));Wc&&oe.iP(wj.a.Idi(Hb,!1),c.a.tellMe);sc&&!Hb.M8g&&Jh.a.$3g(Hb)&&(oe.iP(new el.a(Hb),c.a.tellMe),Hb.GGj&&oe.iP(new el.a(Hb),c.a.contextMenu));
td&&oe.iP(new df(Hb),c.a.tellMe);(Hb.WSc||Hb.K8)&&oe.iP(new xi.a(Hb),c.a.tellMe);Hb.UEd&&oe.iP(new Ok.a(Hb),c.a.tellMe);sc&&Kj.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ForbiddenCatalogGetLoaderParamsFromCallback",!1)&&Hb.Tlg&&oe.iP(new t.AddinResultsProvider(Hb),c.a.tellMe);return oe}}Object(f.a)(Yb,"AggregatorResultsProvider",null,[1035])},1576:function(C,L,b){C=b(0);var f=b(17),c=b(6),u=b(146),r=b(199),t=b(362),k=b(51),m=b(70),l=b(840),x=b(779),w=b(507);b(458);
var G=b(1548),D=b(1549),H=b(1545),M=b(1547),J=b(1546),F=b(839),A=b(778);class N{constructor(ma,qa,ka){this.lpl=ma;this.tGk=qa;this.tPk=ka}}Object(C.a)(N,"BacktraceAndMakeUpdateHintsInput",null,[]);var B=b(1357),E;(function(ma){ma[ma.EOP=0]="EOP";ma[ma.character=1]="character";ma[ma.embeddedMarker=2]="embeddedMarker"})(E||(E={}));Object(C.b)("LCSBlockType",E);class P{toString(){return String.format("[Type: {0}]",E[this.type])}}Object(C.a)(P,"ALCSBlock",null,[]);class T extends P{constructor(ma,qa){super();
this.U$e=qa;this.mqf=ma}get type(){return 1}get character(){return this.U$e}get Wx(){return this.mqf}jD(ma){return 1===ma.type&&B.a.NZh(ma.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(C.a)(T,"CharacterLCSBlock",P,[]);class V extends P{constructor(ma,qa,ka){super();this.mqf=ma;this.xzf=qa;this.D6c=ka}get type(){return 0}get Ob(){return this.xzf}get length(){return this.D6c}get Wx(){return this.mqf}jD(ma){return 0!==ma.type?!1:
ma.Wx===this.Wx&&ma.Ob===this.Ob}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),this.Wx.toString(),this.Ob,this.length)}}Object(C.a)(V,"EOPLCSBlock",P,[]);class I extends T{constructor(ma,qa,ka){super(ma,"\ufffc");this.sfk=qa;this.NTb=ka}get type(){return 2}get hi(){return this.sfk}get ng(){return this.NTb}jD(ma){return 2!==ma.type?!1:ma.hi===this.hi&&this.ng.equals(ma.ng)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),
this.hi,this.ng)}}Object(C.a)(I,"EmbeddedMarkerLCSBlock",T,[]);class R{constructor(ma,qa){this.x=ma;this.y=qa}equals(ma){return ma.x===this.x&&ma.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(C.a)(R,"IntPair",null,[873]);var ba=b(1396),ha=b(1377),na=b(1397),da=b(1544);b.d(L,"a",function(){return ia});class ia{constructor(ma,qa){this.Mg=ma;this.Ld=qa}Sdi(ma,qa,ka,va,ja,Ma,Ha){return this.e5k(ma,qa,ka,va,ja,Ma,Ha)}e5k(ma,qa,ka,va,ja,Ma,Ha){let X;X=null;({returnValue:ma}=this.Vxe(ma,
qa));if(!ma)return u.a.instance.xa(575706449,1,2,"Failed to get LCS blocks from objects for base"),this.Ld.logger.A0("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:X};({returnValue:ka}=this.Vxe(ka,va));if(!ka)return u.a.instance.xa(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.Ld.logger.A0("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:X};this.Ld.logger.A0("GetLCSBlocksFromObject");X=this.d5k(ma,ka,ja,Ma,Ha);return X?{returnValue:!0,updateHints:X}:(u.a.instance.xa(575706451,
1,2,"Failed to Create UpdateHints"),{returnValue:!1,updateHints:X})}doi(ma,qa,ka,va){({returnValue:ma}=this.Vxe(ma,qa));if(!ma)return-1;({returnValue:ka}=this.Vxe(ka,va));if(!ka)return-1;({fUf:ka}=this.hoi(ma,ka));return ka}Vxe(ma,qa){let ka;const va=new r.a;ka=new r.a;if(!ma.length)return u.a.instance.xa(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.Ld.logger.Fg(Object.assign(new ba.a,{wj:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,D_f:ka};for(let Ha=0;Ha<
ma.length;Ha++)if(this.Ld.runtime.hG("GetLCSBlocksFromObject: paraObjs#"+Ha),393230===ma.J(Ha).Jb){const X=this.Mg.getPropertyString(ma.J(Ha),f.a.wk),W=this.Mg.getPropertyUint32(ma.J(Ha),c.a.Ob);if(null==W)return u.a.instance.xa(594124835,1,2,"Abandoning LCS due to missing WordId"),this.Ld.logger.Fg(Object.assign(new ba.a,{wj:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,D_f:ka};let fa=this.Mg.getPropertyUint32s(ma.J(Ha),f.a.Vi);fa=ha.a.Byj(fa,X.length);const ra=this.Mg.getPropertyObjectIds(ma.J(Ha),
f.a.qn);let Aa;for(Aa=0;Aa<fa.length-1;Aa++){var ja=qa(ra.Rf(Aa)),Ma=void 0;Ma=ja?(Ma=this.Mg.getPropertyBool(ja,f.a.w5))?Ma:!1:!1;if(Ma)va.add(this.C0k(ma.J(Ha).id,ja));else for(ja=fa.Rf(Aa);ja<fa.Rf(Aa+1);ja++)va.add(new T(ma.J(Ha).id,B.a.charAt(X,ja)))}va.add(new V(ma.J(Ha).id,W,fa.J(Aa)));ka.add(va.length-1)}else return u.a.instance.xa(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",ma.J(Ha).Jb),this.Ld.logger.Fg(Object.assign(new ba.a,{wj:"GetLCSBlocksFromObject",
eventId:"900ba"})),{returnValue:null,D_f:ka};this.Ld.runtime.hG("LCS: GetLCSBlocks for base");return{returnValue:va,D_f:ka}}C0k(ma,qa){const ka=null==this.Mg.getPropertyInt32(qa,c.a.Jp)?0:this.Mg.getPropertyInt32(qa,c.a.Jp);return new I(ma,ka,qa.id)}d5k(ma,qa,ka,va,ja){va=({fUf:ka}=this.hoi(ma,qa,ka,va,ja)).returnValue;this.Ld.logger.A0("FindFurthestPaths");ma=new N(va,ma,qa);ma=new da.a(this.oGk(ma,ka),1);this.Ld.logger.A0("BacktraceAndMakeUpdateHints");return ma}hoi(ma,qa,ka=-1,va=-1,ja=-1){let Ma;
if(-1===ka||-1===va||-1===ja)ja=va=ka=-1;Ma=-1;const Ha=new t.a;Ha.$(new R(-1,1),new R(0,-1));if(-1!==ka){Ha.$(new R(0,0),new R(ka,ka));var X=1}else X=0,va=ma.length,ja=qa.length;for(ka=0;X<=ma.length+qa.length;X++){let W=!1;for(let fa=-X;fa<=X;fa+=2){let ra,Aa;fa===-X?(ra=Ha.J(new R(X-1,fa+1)).x,Aa=Ha.J(new R(X-1,fa+1)).y+1):fa===X?(ra=Ha.J(new R(X-1,fa-1)).x+1,Aa=Ha.J(new R(X-1,fa-1)).y):Ha.J(new R(X-1,fa-1)).x>=Ha.J(new R(X-1,fa+1)).x?(ra=Ha.J(new R(X-1,fa-1)).x+1,Aa=Ha.J(new R(X-1,fa-1)).y):(ra=
Ha.J(new R(X-1,fa+1)).x,Aa=Ha.J(new R(X-1,fa+1)).y+1);for(;ra<va&&Aa<ja&&ma.J(ra).jD(qa.J(Aa));)ra++,Aa++;Ha.$(new R(X,fa),new R(ra,Aa));if(ra===va&&Aa===ja){W=!0;Ma=X;ka=fa;break}}if(W)break;this.Ld.runtime.hG("LCS FindFurthestPaths")}if(ka!==va-ja)return{returnValue:null,fUf:Ma};Ha.$(new R(Ma,ka),new R(va+1,ja+1));u.a.instance.xa(593826837,1,3,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",ma.length,qa.length,Ma);return{returnValue:Ha,fUf:Ma}}oGk(ma,qa){const ka=
ma.lpl,va=ma.tGk;ma=ma.tPk;const ja=new r.a;let Ma=va.length,Ha=ma.length;for(;0<Ma||0<Ha;){var X=Ma-1,W=Ha-1;if(this.VPm(ka,qa,Ma,Ha)){X=ma.J(W);if(1===X.type||2===X.type)this.x6l(ja,Ma,X);else if(0===X.type)this.c6l(ja,Ma,X);else return u.a.instance.xa(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",X.type),this.Ld.logger.Fg(Object.assign(new na.a,{wj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;Ha--;qa--}else if(this.UPm(ka,qa,Ma,Ha)){W=va.J(X);if(1===W.type||
2===W.type)this.e9k(ja,X,W);else if(0===W.type)this.Q8k(ja,X,W);else return u.a.instance.xa(575706453,1,2,"Abandoning LCS due to unexpected block of type {0}",W.type),this.Ld.logger.Fg(Object.assign(new na.a,{wj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;Ma--;qa--}else if(Ma&&Ha&&va.J(X).jD(ma.J(W)))Ma--,Ha--;else return u.a.instance.xa(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.Ld.logger.Fg(Object.assign(new na.a,{wj:"BacktraceAndMakeUpdateHints",eventId:"0"})),
null}this.Ld.runtime.hG("LCS: CreateUpdateHintsFromLCSBlocks");return ja}UPm(ma,qa,ka,va){qa=new R(qa-1,ka-va-1);return ma.Na(qa)&&ma.J(qa).x===ka-1&&ma.J(qa).y===va}VPm(ma,qa,ka,va){qa=new R(qa-1,ka-va+1);return ma.Na(qa)&&ma.J(qa).x===ka&&ma.J(qa).y===va-1}addPara(ma,qa,ka,va,ja,Ma){var Ha=null;ka.block?Ha=ka.block.Wx:0<=ja&&0===ma.J(ja).type&&(Ha=ma.J(ja).Wx);ka=ma=Ma.Wx;if(va.Jyc.contains(ma))for(ja=0,ma=k.a.qe("{00000000-0000-0000-0000-000000000000}{"+ja+"}");va.Jyc.contains(ma);)ja++,ma=k.a.qe("{00000000-0000-0000-0000-000000000000}{"+
ja+"}");Ha=new l.AddParagraphUpdateHint(ma,Ma.Ob,Ha);Ha.yMm=ka;qa.updateHints.add(Ha);va.Wx=ma;va.Ob=Ma.Ob;va.Jyc.add(ma);va.C7a=0}c6l(ma,qa,ka){ka=new H.a(ka.Wx,ka.Ob);let va=!1;if(0<ma.length&&11===ma.Rf(ma.length-1).type){const ja=ma.Rf(ma.length-1);ja.cp===qa&&(va=!0,ja.F7.add(ka))}va||(qa=new J.a(qa),qa.F7.add(ka),ma.add(qa))}splitPara(ma,qa,ka,va,ja,Ma,Ha,X){ma=this.Tkl(Ma.Wx,ma,qa,va);if(!ma)return!1;qa=new A.a(Ma.Wx,Ma.Ob,Ma.C7a,ma.Wx,ma.Ob,Ha.Wx,Ha.Ob);ka.updateHints.add(qa);Ma.Ob=ma.Ob;
ma!==X?(ja.block=ma,ja.r0n=Ma.C7a,ja=new l.AddParagraphUpdateHint(X.Wx,X.Ob,ma.Wx),ka.updateHints.add(ja),Ma.Wx=X.Wx,Ma.Ob=X.Ob,Ma.Jyc.add(X.Wx),Ma.C7a=0):Ma.Jyc.add(Ha.Wx);return!0}x6l(ma,qa,ka){var va=!1;if(0<ma.length&&11===ma.Rf(ma.length-1).type){const ja=ma.Rf(ma.length-1);ja.cp===qa&&((va=Object(m.a)(M.a,ja.F7.J(ja.F7.length-1)))?va.text=ka.character.toString()+va.text:ja.F7.add(new M.a(ka.Wx,ka.character.toString())),va=!0)}va||(qa=new J.a(qa),qa.F7.add(new M.a(ka.Wx,ka.character.toString())),
ma.add(qa))}deletePara(ma,qa,ka,va,ja,Ma){let Ha=-1;for(let X=0;X<ja.length;X++)if(ja.J(X)===Ma){0<X&&(Ha=X-1);break}Ma=null;0<=Ha&&(Ma=va.J(ja.J(Ha)));va=new x.a(ka.Wx,ka.Ob,Ma?Ma.Wx:null);ma.updateHints.add(va);Ma&&qa.Wx.equals(ka.Wx)&&(qa.C7a=Ma.length,qa.Wx=Ma.Wx,qa.Ob=Ma.Ob);qa.Jyc.remove(ka.Wx)}Q8k(ma,qa,ka){qa=new G.a(qa,ka.Wx,ka.Ob);ma.add(qa)}mergePara(ma,qa,ka){ma.updateHints.add(new F.MergeParagraphUpdateHint(ka.Wx,ka.Ob,ka.length,qa.Wx,qa.Ob,ka.Wx,qa.Ob));qa.C7a=ka.length;qa.Jyc.remove(qa.Wx);
qa.Wx=ka.Wx}deleteText(ma,qa,ka){let va=!1;if(0<ma.updateHints.length&&2===ma.updateHints.Rf(ma.updateHints.length-1).type){const ja=ma.updateHints.Rf(ma.updateHints.length-1);ja.zf.equals(qa.Wx)&&ja.cp===qa.C7a&&(ja.cp=qa.C7a-1,ja.text=ka.character.toString()+ja.text,va=!0)}va||ma.updateHints.add(new w.DeleteTextUpdateHint(qa.Wx,qa.C7a-1,ka.character.toString()));--qa.C7a}e9k(ma,qa,ka){let va=!1;if(0<ma.length&&8===ma.Rf(ma.length-1).type){const ja=ma.Rf(ma.length-1);ja.cp===qa+1&&(ja.text=ka.character.toString()+
ja.text,--ja.cp,va=!0)}va||ma.add(new D.a(qa,ka.character.toString()))}Tkl(ma,qa,ka,va){for(;0<=va;){var ja=qa.J(ka.J(va));if(0!==ja.type)break;if(ja.Wx.equals(ma))return ja;va--}return null}}Object(C.a)(ia,"LCSUpdateHintGenerator",null,[])},1580:function(C,L,b){b.r(L);C=b(0);var f=b(17),c=b(6),u=b(146),r=b(362),t=b(577),k=b(199),m=b(51),l=b(41),x=b(1340);class w extends x.a{constructor(){super()}get rra(){return"ChildNodeListMerge"}}Object(C.a)(w,"ChildNodeListMergeFailureDetail",x.a,[]);class G{ePb(R,
ba,ha){return ba.VA(R,ha.J(R))}BLj(R,ba,ha,na){let da;return({value:da}=ba.Ab(R)).returnValue||({value:da}=ha.Ab(R)).returnValue?da:na.J(R)}}Object(C.a)(G,"ChildNodeListMergeUtils",null,[1870]);var D=b(1371),H=b(1597),M=b(1447);class J{constructor(R,ba){this.classId=R;this.xIn=ba}}Object(C.a)(J,"NodeChildrenTransformation",null,[]);var F=b(726),A=b(1358);class N{constructor(R,ba,ha){this.pI=R;this.LDa=ha;this.Rfa=ba}eSe(R){let ba,ha;return({Vgj:ba}=this.FLj(this.LDa,R)).returnValue&&ba.pY||({Vgj:ha}=
this.FLj(this.Rfa,R)).returnValue&&ha.pY}FLj(R,ba){let ha;return{returnValue:({value:ha}=(new A.a(this.pI,R)).Pna.Ab(F.a.Ra(ba))).returnValue,Vgj:ha}}}Object(C.a)(N,"NodeTriplet",null,[]);var B=b(1543);class E{constructor(R,ba,ha){this.Ld=R;this.Mg=ba;this.mU=ha;this.gdd=!0}get jm(){return this.Ld}get Mc(){return this.Mg}get JLa(){return this.mU}get success(){return this.gdd}RJl(){u.a.instance.xa(4220310,1,4,"Evaluating ParentObjects");const R=new r.a;this.$If(R,ba=>this.jm.runtime.pk.J(ba));this.$If(R,
ba=>this.JLa.ePb(ba,this.jm.runtime.Zu,this.jm.runtime.pk));this.$If(R,ba=>this.JLa.ePb(ba,this.jm.runtime.Kr,this.jm.runtime.pk));return R}$If(R,ba){const ha=ba(b(1580).ChildNodeListMerge.WPe);this.Mc.getPropertyObjectIds(ha,f.a.jf).forEach(na=>{this.Mc.getPropertyObjectIds(ba(na),f.a.jf).forEach(da=>{R.Na(da)&&!na.equals(R.J(da))&&(this.gdd=!1,u.a.instance.xa(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",da,na,R.J(da)));R.$(da,na);return!0});return!0})}}
Object(C.a)(E,"OutlineGroupParentFinder",null,[]);var P=b(1341),T=b(1398),V=b(1448);b.d(L,"ChildNodeListMerge",function(){return I});class I{constructor(R,ba=null,ha=null,na=null,da=null){this.Mg=R;this.vOm=ba||H.a.ULj;this.zMe=ha||this.pHl();this.JLa=na||new G;this.c4i=da||this.RFl()}get Mc(){return this.Mg}pHl(){return[new J(393227,Object(l.a)(this,this.xNm,"pageContentNodeThreewayChildMerge")),new J(1073872968,Object(l.a)(this,this.ZSn,"wordSectionNodeThreewayChildMerge")),new J(393241,Object(l.a)(this,
this.QPe,"outlineElementContainerThreewayChildMerge")),new J(393252,Object(l.a)(this,this.PBn,"tableCellThreewayChildMergev2")),new J(1074135125,Object(l.a)(this,this.QPe,"outlineElementContainerThreewayChildMerge")),new J(1074135123,Object(l.a)(this,this.QPe,"outlineElementContainerThreewayChildMerge")),new J(1074135127,Object(l.a)(this,this.QPe,"outlineElementContainerThreewayChildMerge"))]}RFl(){return[Object(l.a)(this,this.cTm,"prepareObjectGroupings"),Object(l.a)(this,this.nWl,"handleInterOutlineGroupMerge"),
Object(l.a)(this,this.uQm,"performThreewayChildMerge")]}Zvm(R){let ba=0;for(;ba<this.c4i.length;ba++)if(!(0,this.c4i[ba])(R))return u.a.instance.xa(4273296,1,3,"MergeChildNodeLists: Merged failed. [Function: {0}]",ba),R.logger.vKe("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",ba),!1;return!0}cTm(R){const ba=new r.a,ha=new r.a,na=new t.a;R.runtime.Zu.forEach((da,ia)=>I.Sdj(ia,ba));R.runtime.Kr.forEach((da,ia)=>I.Sdj(ia,ha));for(let da=0;da<this.zMe.length;da++){const ia=this.zMe[da].classId;
R.runtime.GJb.$(ia,new r.a);ba.Na(ia)&&ba.J(ia).forEach(ma=>{var qa=R.runtime.pk.J(ma.id);qa&&(qa=new N(qa,ma,R.runtime.Kr.VA(ma.id,qa)),R.runtime.GJb.J(ia).add(ma.id,qa),na.add(ma.id));return!0});ha.Na(ia)&&ha.J(ia).forEach(ma=>{if(na.contains(ma.id))return!0;const qa=R.runtime.pk.J(ma.id);qa&&R.runtime.GJb.J(ia).add(ma.id,new N(qa,qa,ma));return!0})}R.runtime.hG("PrepareObjectGroupings");R.logger.Rsa("PrepareObjectGroupings");return!0}uQm(R){let ba=!0;for(let ha=0;ba&&ha<this.zMe.length;ha++){const na=
this.zMe[ha];R.runtime.hG("Before function#"+ha);const da=na.classId;R.runtime.GJb.J(da).forEach((ia,ma)=>{R.runtime.O2a.contains(ma.pI.id)||(ba=na.xIn(R,ma)&&ba);ba||(u.a.instance.xa(4273297,1,3,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",da,ma.pI.id),R.logger.Fg(Object.assign(new w,{wj:"PerformThreewayChildMerge",eventId:"aqtsr"})));return ba});R.runtime.hG("PerformThreewayChildMerge"+ha)}R.logger.Rsa("PerformThreewayChildMerge");return ba}xNm(R,ba){if(ba.eSe(f.a.jf)){var ha=
this.Mc.getPropertyObjectIds(ba.pI,f.a.jf);const na=this.Mc.getPropertyObjectIds(ba.Rfa,f.a.jf);ba=this.Mc.getPropertyObjectIds(ba.LDa,f.a.jf);ha=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",ha.length,na.length,ba.length,R.input.source);u.a.instance.xa(4030551,1,3,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",ha);R.logger.Fg(Object.assign(new w,{wj:"PageContentNodeThreewayChildMerge",eventId:"apybx",info:ha}));
return!1}return!0}ZSn(R,ba){if(ba.eSe(f.a.jf)){const ka=new t.a,va=new t.a,ja=new t.a,Ma=new t.a;var ha=this.Mc.getPropertyObjectIds(ba.pI,f.a.jf),na=ha.iG(),da,ia=({$ai:da}=this.XRj(ba.Rfa,na,ka,"Favored")).returnValue,ma=({$ai:qa}=this.XRj(ba.LDa,na,va,"Unfavored")).returnValue;if(!ia||!ma)return ha=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",na.count,ka.count,
va.count,da,qa),R.logger.Fg(Object.assign(new w,{wj:"WordSectionNodeThreewayChildMerge",info:ha})),!1;ha.forEach(Ha=>{ka.contains(Ha)||ja.add(Ha);va.contains(Ha)||Ma.add(Ha);return!0});ba=ba.pI.AF();na=new k.a;for(da=0;da<ha.length;da++){var qa=ha.Rf(da);if(ja.contains(qa)||Ma.contains(qa)){if(R.runtime.O2a.add(qa),na.length&&(ia=na.Rf(na.length-1),ia=R.runtime.GJb.J(393241).J(ia),ma=R.runtime.GJb.J(393241).J(qa),ia&&ma))ja.contains(qa)?Ma.contains(qa)||(ia.pI=ia.pI.AF(),ia.LDa=ia.LDa.AF(),this.yje(ia.pI,
ma.pI),this.yje(ia.LDa,ma.LDa)):(ia.pI=ia.pI.AF(),ia.Rfa=ia.Rfa.AF(),this.yje(ia.pI,ma.pI),this.yje(ia.Rfa,ma.Rfa))}else na.add(qa)}this.Mc.setPropertyObjectIds(ba,f.a.jf,na);ha=new P.a(ba);ha.wF(f.a.jf);R.runtime.zm.$(ba.id,ha)}return!0}yje(R,ba){const ha=this.Mc.getPropertyObjectIds(R,f.a.jf);ba=this.Mc.getPropertyObjectIds(ba,f.a.jf);const na=ha.I8();ba.forEach(da=>{na.add(da);return!0});this.Mc.setPropertyObjectIds(R,f.a.jf,na)}XRj(R,ba,ha,na){let da=0,ia=!0;this.Mc.getPropertyObjectIds(R,f.a.jf).forEach(ma=>
{ba.contains(ma)?ha.add(ma):(ia=!1,u.a.instance.xa(573912977,1,3,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",na,ma),da++);return!0});return{returnValue:ia,$ai:da}}nWl(R){let ba=!0;R.runtime.GJb.J(393241).forEach((ha,na)=>{if(this.Kbm(na)){u.a.instance.xa(4220302,1,3,"OutlineGroup {0} requires inter-OG merge.",na.pI.id);let da;const ia=new E(R,this.Mc,this.JLa);if(({vcj:ha,uVj:da}=this.kHn(R,ia.RJl(),na)).returnValue)return u.a.instance.xa(4220303,1,3,"Merging WordSection {0} as a unit.",
da),ba=ia.success&&this.Bwm(R,da,ha)&&ba,ba||(u.a.instance.xa(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",na.pI.id,ia.success),R.logger.Fg(Object.assign(new w,{wj:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",ia.success)}))),ba}return!0});return ba}Kbm(R){if(!R.eSe(f.a.jf))return!1;const ba=this.Mc.getPropertyObjectIds(R.pI,f.a.jf).J(0),ha=this.Mc.getPropertyObjectIds(R.Rfa,
f.a.jf);R=this.Mc.getPropertyObjectIds(R.LDa,f.a.jf);return!ha.contains(ba,(na,da)=>na.equals(da))||!R.contains(ba,(na,da)=>na.equals(da))}kHn(R,ba,ha){ba=ba.J(ha.pI.id);u.a.instance.xa(4220304,1,3,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",ha.pI.id,ba);if(R.runtime.O2a.contains(ba))return u.a.instance.xa(4220305,1,4,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",
ba),{returnValue:!1,vcj:null,uVj:ba};const na=new B.a;ha=R.runtime.pk.J(ba);this.Mc.getPropertyObjectIds(ha,f.a.jf).forEach(da=>{na.xje(da);return!0});ha=this.JLa.ePb(ba,R.runtime.Zu,R.runtime.pk);this.Mc.getPropertyObjectIds(ha,f.a.jf).forEach(da=>{na.zje(da);return!0});R=this.JLa.ePb(ba,R.runtime.Kr,R.runtime.pk);this.Mc.getPropertyObjectIds(R,f.a.jf).forEach(da=>{na.Cje(da);return!0});return{returnValue:!0,vcj:na,uVj:ba}}TNg(R,ba,ha,na,da){let ia=!0;R.forEach(ma=>{const qa=ba(ma);this.Mc.getPropertyObjectIds(qa,
f.a.jf).forEach(ka=>{ha.add(ka);if(na.Na(ka))return(ia=na.J(ka).equals(ma)&&ia)||u.a.instance.xa(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",da,ka,ma,na.J(ka)),ia;na.$(ka,ma);return!0});return!0});return ia}jIl(R,ba){let ha,na,da,ia;ha=new k.a;na=new k.a;da=new k.a;ia=new r.a;const ma=R.runtime.pk;return this.TNg(ba.v3b,qa=>ma.J(qa),ha,ia,"Base")&&this.TNg(ba.c1f,qa=>this.JLa.ePb(qa,R.runtime.Zu,ma),na,ia,"Favored")&&
this.TNg(ba.hPb,qa=>this.JLa.ePb(qa,R.runtime.Kr,ma),da,ia,"Unfavored")?{returnValue:!0,p0h:ha,Wmi:na,KMj:da,C7i:ia}:{returnValue:!1,p0h:ha,Wmi:na,KMj:da,C7i:ia}}Lll(R,ba,ha,na){let da=!0;const ia=R.runtime.pk,ma=R.runtime.Zu,qa=R.runtime.Kr,ka=R.runtime.zm,va=new k.a,ja=new r.a;ha.forEach(Ma=>{const Ha=na.J(Ma);if(!Ha)return u.a.instance.xa(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",Ma),R.logger.Fg(Object.assign(new w,{wj:"FinishInterOutlineGroupMerge",
eventId:"aqgws"})),da=!1;Ha.equals(va.last())||(va.add(Ha),ja.add(Ha,new k.a));ja.J(Ha).add(Ma);R.runtime.O2a.add(Ma);return!0});if(!da)return!1;ja.forEach((Ma,Ha)=>{const X=this.JLa.BLj(Ma,ma,qa,ia).AF();this.Mc.setPropertyObjectIds(X,f.a.jf,Ha);ka.$(Ma,new P.a(X));ka.J(Ma).wF(f.a.jf);R.runtime.O2a.add(Ma);return da});ha=this.JLa.BLj(ba,ma,qa,ia).AF();this.Mc.setPropertyObjectIds(ha,f.a.jf,va);ka.$(ba,new P.a(ha));ka.J(ba).wF(f.a.jf);R.runtime.O2a.add(ba);return da}Bwm(R,ba,ha){let na,da;if(!({p0h:ia,
Wmi:na,KMj:da,C7i:ha}=this.jIl(R,ha)).returnValue)return!1;var ia=D.b(ia,na,da);ia=this.CKg(R,ia);return!!ia&&this.Lll(R,ba,ia,ha)}QPe(R,ba){return this.qcj(R,ba)}qcj(R,ba){if(ba.eSe(f.a.jf)){var ha=this.iIl(ba);ha=this.CKg(R,ha);if(!ha)return u.a.instance.xa(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",ba.pI.id),R.logger.Fg(Object.assign(new w,{wj:"OutlineElementContainerThreewayChildMerge",
eventId:"aqgwu"})),M.a(ba.pI,"OutlineElementContainerThreewayChildMerge_Base",1),M.a(ba.Rfa,"OutlineElementContainerThreewayChildMerge_Favored",1),M.a(ba.LDa,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var na=this.Mc.getPropertyObjectIds(ba.pI,f.a.jf);const da=ha.iG();na.forEach(ia=>{da.contains(ia)||(ia=this.Mc.getPropertyObjectIds(ba.pI,f.a.rP),0<ia.length&&R.runtime.pLg.add(ia.J(0)));return!0});na=ba.Rfa.AF();this.Mc.setPropertyObjectIds(na,f.a.jf,ha);R.runtime.zm.$(na.id,new P.a(na));
R.runtime.zm.J(na.id).wF(f.a.jf)}return!0}gdc(R){if(!R)return u.a.instance.xa(573957964,1,2,"Feature helper is null"),!1;R.hq(177);return R.isFeatureEnabled(177)}PBn(R,ba){if(!this.gdc(R.runtime.Ka))return this.A9g(R,ba);var ha=ba.pI.id,na=V.e(R,ba.pI,null);if(na.equals(m.a.nil))return u.a.instance.xa(573957965,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",ha),R.logger.Fg(Object.assign(new T.a,{info:"Table node ID could not be found for table cell"})),!1;var da=R.runtime.c5b.J(na);
if(da&&(da=da.J(ha)))if(da.we)ba=ba.Rfa.AF(),ba.removeProperty(f.a.jf),this.Mc.setPropertyBool(ba,c.a.ghostCell,!0),null!=da.colSpan?this.Mc.setPropertyUint32(ba,c.a.colSpan,da.colSpan):ba.removeProperty(c.a.colSpan),R.runtime.zm.$(ba.id,new P.a(ba)),R.runtime.zm.J(ba.id).wF(f.a.jf),R.runtime.zm.J(ba.id).wF(c.a.ghostCell),R.runtime.zm.J(ba.id).wF(c.a.colSpan);else{let ia,ma;({Cke:na,Ste:ia,b3e:ma}=this.XEl(R,ba,da,na));if(!ia.length&&!ma.length)return u.a.instance.xa(573957966,1,2,"A non-ghost cell does not have OE nodes on either side. Table cell ID: {0}",
ha),R.logger.Fg(Object.assign(new T.a,{info:"A non-ghost cell does not have OE nodes on either side"})),!1;ia.length?ma.length?(ha=D.b(na,ia,ma),ha=this.CKg(R,ha)):ha=ia:ha=ma;if(!ha)return u.a.instance.xa(573957920,1,1,"TableCellThreewayChildMergev2: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",ba.pI.id),R.logger.Fg(Object.assign(new w,{wj:"TableCellThreewayChildMergev2",eventId:"8n426"})),M.a(ba.pI,"TableCellThreewayChildMergev2_Base",
1),M.a(ba.Rfa,"TableCellThreewayChildMergev2_Favored",1),M.a(ba.LDa,"TableCellThreewayChildMergev2_Unfavored",1),!1;ba=ba.Rfa.AF();this.Mc.setPropertyObjectIds(ba,f.a.jf,ha);ba.removeProperty(c.a.ghostCell);ha=da.rowSpan;da=da.colSpan;null!=ha&&null!=da&&(1<ha||1<da)?(this.Mc.setPropertyUint32(ba,c.a.rowSpan,ha),this.Mc.setPropertyUint32(ba,c.a.colSpan,da)):(ba.removeProperty(c.a.rowSpan),ba.removeProperty(c.a.colSpan));R.runtime.zm.$(ba.id,new P.a(ba));R.runtime.zm.J(ba.id).wF(f.a.jf);R.runtime.zm.J(ba.id).wF(c.a.ghostCell);
R.runtime.zm.J(ba.id).wF(c.a.rowSpan);R.runtime.zm.J(ba.id).wF(c.a.colSpan)}else return this.A9g(R,ba);R.logger.Rsa("TableCellThreewayChildMergev2");return!0}XEl(R,ba,ha,na){let da,ia;({Cke:ba,Ste:da,b3e:ia}=this.Gwi(ba));ba||(ba=new k.a);da||(da=new k.a);ia||(ia=new k.a);var ma=ba.iG(),qa=da.iG(),ka=ia.iG(),va=ha.TMe;if(va)for(var ja=0;ja<va.length;ja++){var Ma=va.J(ja),Ha=R.runtime.pk.J(Ma);!ma.contains(Ma)&&Ha&&(ma.add(Ma),ba.add(Ma));!qa.contains(Ma)&&R.runtime.Zu.VA(Ma,Ha)&&(qa.add(Ma),da.add(Ma));
!ka.contains(Ma)&&R.runtime.Kr.VA(Ma,Ha)&&(ka.add(Ma),ia.add(Ma))}R.logger.Rsa("OENodesAddedToChildrenList");if(va=ha.Beg)for(ja=0;ja<va.length;ja++)if(Ma=va.J(ja),Ha=R.runtime.pk.J(Ma)){var X=this.Mc.getPropertyObjectIds(Ha,f.a.jf);if(X)for(var W=0;W<X.length;W++){var fa=X.J(W);ma.contains(fa)||(ma.add(fa),ba.add(fa))}X=R.runtime.Zu.VA(Ma,Ha);if(X=this.Mc.getPropertyObjectIds(X,f.a.jf))for(W=0;W<X.length;W++)fa=X.J(W),qa.contains(fa)||(qa.add(fa),da.add(fa));Ma=R.runtime.Kr.VA(Ma,Ha);if(Ma=this.Mc.getPropertyObjectIds(Ma,
f.a.jf))for(Ha=0;Ha<Ma.length;Ha++)X=Ma.J(Ha),ka.contains(X)||(ka.add(X),ia.add(X))}R.logger.Rsa("GhostCellOENodesAddedToChildrenList");if(ha=ha.BEg)for(ma=0;ma<ha.length;ma++)if(qa=ha.J(ma),qa=R.runtime.c5b.J(na).J(qa))if(qa=qa.TMe){qa=qa.iG();ka=new k.a;for(va=0;va<ba.length;va++)qa.contains(ba.J(va))||ka.add(ba.J(va));ba=ka;ka=new k.a;for(va=0;va<da.length;va++)qa.contains(da.J(va))||ka.add(da.J(va));da=ka;ka=new k.a;for(va=0;va<ia.length;va++)qa.contains(ia.J(va))||ka.add(ia.J(va));ia=ka}R.logger.Rsa("NonGhostCellsOENodesRemovedFromChildrenList");
return{Cke:ba,Ste:da,b3e:ia}}A9g(R,ba){let ha=ba.Rfa.hasProperty(f.a.jf),na=ba.LDa.hasProperty(f.a.jf);ha&&(ha=!!this.Mc.getPropertyObjectIds(ba.Rfa,f.a.jf).length);na&&(na=!!this.Mc.getPropertyObjectIds(ba.LDa,f.a.jf).length);if(ha!==na)if(this.ngm(R.runtime.Ka))R.logger.P_i(Object.assign(new T.a,{info:"TableCell OE missing children, ghost cell likely touched"}));else return R.logger.Fg(Object.assign(new T.a,{info:"TableCell OE missing children, ghost cell likely touched"})),!1;return this.qcj(R,
ba)}iIl(R){let ba,ha;({Cke:R,Ste:ba,b3e:ha}=this.Gwi(R));return D.b(R,ba,ha)}CKg(R,ba){u.a.instance.xa(4220309,1,4,"Considering {0} OutlineElement collections for merge.",ba.length);const ha=new k.a;let na=!0;ba.forEach(da=>{if(!da)return u.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),R.logger.Fg(Object.assign(new w,{wj:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),na=!1;if(1===da.lxm&&1===da.OHd){const X=da.v3b.J(0),W=da.c1f.J(0),fa=da.hPb.J(0);if(X&&X.equals(W)&&
X.equals(fa))return ha.add(X),!0;if(1!==ba.length)return u.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",X,W,fa,ba.length),R.logger.Fg(Object.assign(new w,{wj:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),na=!1}const ia=new r.a,ma=new k.a,qa=new k.a,ka=new k.a,va=new k.a,ja=new k.a,Ma=new k.a,Ha=R.runtime.pk;
da.v3b.forEach(X=>na=this.QOg(R,X,W=>Ha.J(W),ma,va,ia,"Base"));if(!na)return u.a.instance.xa(4285026,1,3,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),R.logger.Fg(Object.assign(new w,{wj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),!1;da.c1f.forEach(X=>na=this.QOg(R,X,W=>this.JLa.ePb(W,R.runtime.Zu,Ha),qa,ja,ia,"Favored"));if(!na)return u.a.instance.xa(4285027,1,3,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),
R.logger.Fg(Object.assign(new w,{wj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;da.hPb.forEach(X=>na=this.QOg(R,X,W=>this.JLa.ePb(W,R.runtime.Kr,Ha),ka,Ma,ia,"Unfavored"));if(!na)return u.a.instance.xa(4285056,1,3,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),R.logger.Fg(Object.assign(new w,{wj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;R.runtime.Ka&&R.runtime.Ka.Cmb(1000005)&&(ja.length&&this.Kil(ja,R.runtime.Zu)?
(this.uVh(ja,R,ha,ia),this.xie(R,ia,Ma)):this.uVh(Ma,R,ha,ia));if(ma.length){da=null;if(!({zm:da}=this.vOm(R,ma,qa,ka,da)).returnValue||!da)return na=!1;da.forEach(X=>{0<X.pxc.count&&R.runtime.zm.$(X.Wj.id,X);ha.add(ia.J(X.Wj.id));return!0})}return!0});return na?ha:null}Kil(R,ba){for(let ha=0;ha<R.length;ha++)if(ba.get(R.Rf(ha).id))return!0;return!1}xie(R,ba,ha){ha.length&&(ha.forEach(na=>{R.runtime.qTc.add(na.id);R.runtime.qTc.add(ba.J(na.id));return!0}),H.a.xie(R,this.Mc,ha.J(0)))}uVh(R,ba,ha,na){R.forEach(da=>
{const ia=new P.a(da.AF());ba.runtime.zm.$(da.id,ia);ha.add(na.J(da.id));return!0})}QOg(R,ba,ha,na,da,ia,ma){var qa=ha(ba);if(!qa)return u.a.instance.xa(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",ma,ba),R.logger.Fg(Object.assign(new w,{wj:"ProcessOutlineElement",eventId:"aqwkb",info:String.format("[Revision: {0}] Failed to find OutlineElement",ma)})),!1;const ka=this.Mc.getPropertyObjectIds(qa,f.a.rP);if(!ka||!ka.length)return u.a.instance.xa(4285058,1,1,
"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",ma,ba),R.logger.Fg(Object.assign(new w,{wj:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",ma)})),M.a(qa,"ProcessOutlineElement_"+ma,1),!1;qa=ka.Rf(0);ha=ha(qa);if(!ha)return u.a.instance.xa(4285059,1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",ma,qa,ba),R.logger.Fg(Object.assign(new w,{wj:"ProcessOutlineElement",
eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",ma)})),!1;if((ma=this.Mc.getPropertyString(ha,c.a.CQ))&&""!==ma&&R.runtime.Ka&&(R.runtime.Ka.TAe(1000005),R.runtime.Ka.Cmb(1000005)))return da.add(ha),ia.add(qa,ba),R.runtime.O2a.add(qa),!0;na.add(ha);ia.add(qa,ba);R.runtime.O2a.add(qa);return!0}Gwi(R){let ba,ha;ba=this.Mc.getPropertyObjectIds(R.pI,f.a.jf);ha=this.Mc.getPropertyObjectIds(R.Rfa,f.a.jf);R=this.Mc.getPropertyObjectIds(R.LDa,f.a.jf);
return{Cke:ba,Ste:ha,b3e:R}}ngm(R){if(!R)return u.a.instance.xa(51422868,1,2,"Feature Helper is null"),!1;R.hq(175);return R.isFeatureEnabled(175)}static Sdj(R,ba){ba.Na(R.Jb)||ba.$(R.Jb,new k.a);ba.J(R.Jb).add(R);return!0}}I.WPe=m.a.qe("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(C.a)(I,"ChildNodeListMerge",null,[1836])},1582:function(C,L,b){C=b(0);var f=b(1299),c=b(1441),u=b(1359),r=b(1322),t=b(1374);class k{constructor(R,ba){this.DimensionValue=this.DimensionName=null;this.DimensionName=
R;this.DimensionValue=ba}}Object(C.a)(k,"Dimension",null,[]);class m{constructor(R,ba,ha,na,da){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=R;this.Query=ba;this.From=ha;this.Size=na;da&&(this.Filter=da)}}Object(C.a)(m,"EntityRequest",null,[]);class l{constructor(R){this.QueryString=null;this.QueryString=R}}Object(C.a)(l,"Query",null,[]);var x=b(1300);class w{constructor(R,ba){this.Dimensions=this.Name=null;this.Name=R;this.Dimensions=ba}}Object(C.a)(w,"Scenario",
null,[]);var G=b(1306),D=b(1305);class H{constructor(R,ba,ha,na){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=R;this.TimeZone=ba;this.Cvid=ha;this.Scenario=na}}Object(C.a)(H,"SubstrateBody",null,[]);var M=b(1373),J=b(1295),F=b(1294),A=b(2),N=b(1526),B=b(1525),E=b(1370),P=b(32),T=b(16),V=b(130);b.d(L,"a",function(){return I});class I{constructor(R){this.j9c=this.EAb=this.Aae=this.u1c=this.o$c=0;this.JGh=this.KJh=this.AW=null;this.IWb=0;this.M9=-1;this.fdd="";this.nf=
A.AFrameworkApplication.Gd;this.Gb=R;this.dwf=this.EPl();this.Jtf=new c.a;this.qFh=this.Gb.r2e?3:2;this.GPh=this.Gb.r2e&&this.Gb.PCj?5:3;this.BSh=this.Gb.YYe?2:3;this.CSh=1;this.Q$d=this.Gb.UAi;this.vOh=this.Gb.Efm;this.Iad=R.bEi;A.AFrameworkApplication.K&&(this.KJh=A.AFrameworkApplication.K.Ga("AppCatalogUrl")+A.AFrameworkApplication.K.Ga("SearchPersonaPhotoBaseUrl"))}ZX(){return"Substrate"}Bba(){return 0===this.Gb.WA?0:1===this.Gb.WA?1:3}HS(R,ba,ha,na=f.a.tellMe,da=null){const ia=new D.a(R);if(!da||
Array.contains(da,14)||Array.contains(da,15)||Array.contains(da,20))if(!this.IWb||window.performance.now()-this.IWb>=F.a.X1e)if(ha=this.Jtf.DEi())this.IWb=window.performance.now(),ha.then(ma=>{ma&&""!==ma?(this.fdd=ma,""!==this.AW&&this.CEi(R,na,this.fdd,ba,da)):(J.TellMeActor.instance.Qe.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),ba.resultsUpdated(ia))},ma=>{J.TellMeActor.instance.Qe.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+
ma);ba.resultsUpdated(ia)});else{if(J.TellMeActor.instance.Qe)J.TellMeActor.instance.Qe.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");ba.resultsUpdated(ia)}else this.fdd&&""!==this.fdd?this.CEi(R,na,this.fdd,ba,da):(ba.resultsUpdated(ia),J.TellMeActor.instance.Qe.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else ba.resultsUpdated(ia)}gMb(){this.EAb=this.j9c=this.Aae=this.u1c=this.o$c=0}CEi(R,ba,ha,na,da){this.gMb();const ia=new D.a(R),ma=this.AW=
V.a.create().toString();this.ERa();this.M9=window.setTimeout(()=>{if(ma===this.AW){this.AW="";this.M9=-1;na.resultsUpdated(ia);const va={};va[u.a.provider]=this.ZX();va[u.a.pic]=R.lLb;J.TellMeActor.instance.Qe.pD(r.a.timedOut,this.Iad,va)}},this.Iad);const qa={"Content-Type":"application/json",Accept:"application/json"};qa.Authorization="Bearer "+ha;qa["X-Office-Version"]=A.AFrameworkApplication.buildVersion;qa["X-Office-Application"]=A.AFrameworkApplication.K.Ga("Application");qa["X-Office-Platform"]=
"WAC";qa["X-TellMe-SessionId"]=J.TellMeActor.instance.dAe();qa["X-TellMe-Culture"]=A.AFrameworkApplication.uiCulture;qa["X-TellMe-ProcessSessionId"]=A.AFrameworkApplication.userSessionId;qa["Client-Request-Id"]=ma;const ka=window.performance.now();this.nf.Ni(this.xPl(),2,this.yPl(R.Qg,this.Gb.application,J.TellMeActor.instance.dAe(),F.a.O7(R)),qa,!1,0,va=>{this.Qgc(va,R,na,ma,ka,ba,da)},va=>{this.ygc(va,R,na,ma,ka)},null,null,!1,4E3,6E3)}ERa(){-1!==this.M9&&(window.clearTimeout(this.M9),this.M9=-1)}Qgc(R,
ba,ha,na,da,ia,ma){J.TellMeActor.instance.Qe.$ga(ba.Qg.length,this.dwf.join(","),R.data.Ge.toString(),Math.round(window.performance.now()-da),M.a.substrate,!0,t.a.o5a);const qa=F.a.O7(ba),ka=new D.a(ba);if(na===this.AW){this.ERa();R=P.b(R.data.Rd);if(R.Groups){R=R.Groups;for(const va of R)"People"===va.Type&&this.Gb.dYd&&(ma?Array.contains(ma,14):1)?(R=this.WBi(va.Suggestions,qa,ia),0<R.results.length&&ka.DA(R)):"File"===va.Type&&this.Gb.bYd&&(ma?Array.contains(ma,15):1)?(R=this.hxi(va.Suggestions,
qa,ia),0<R.results.length&&ka.DA(R)):"Notes"===va.Type&&this.Gb.mpb&&ia!==f.a.contextMenu&&(ma?Array.contains(ma,20):1)&&(R=this.QAi(va.Suggestions,qa,ba),0<R.results.length&&ka.DA(R))}ha.resultsUpdated(ka);J.TellMeActor.instance.Qe.$ga(ba.Qg.length,this.dwf.join(","),"",Math.round(window.performance.now()-da),"",!0,t.a.provider)}else ha.resultsUpdated(ka)}QAi(R,ba,ha){const na=new G.a(20);na.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const da of R)this.thm(da)&&(R=da.NotesType,R=
T.a.He(R),R=this.zHl(R,da.LastModifiedTime,da.BodyPreview,da.Subject,ba,ha,da))&&(R.groupType=20,na.DB(R));return na}WBi(R,ba,ha){const na=new G.a(14);na.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const ia of R)if(this.uhm(ia)){var da=ia.Id.split("@")[0];R=ia.EmailAddresses[0];let ma=ia.Type;if(void 0===ma||null===ma)ma="User";if(da=this.bKl(ma,ia.DisplayName,ia.JobTitle,R,da,ha,ba))da.description=R,R=ia.JobTitle,"Department"in ia&&"CompanyName"in ia&&(R+="@"+ia.Department+"@"+ia.CompanyName),
da.pN=R,na.DB(da)}return na}hxi(R,ba,ha){const na=new G.a(15);na.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const ma of R)if(this.khm(ma)){var da=ma.FileName;R=ma.FileExtension;const qa=da.length>R.length?da.substr(0,da.length-R.length-1):ma.Title;var ia=void 0;R=0;"DateCreated"in ma?(R=F.a.$cg(ma.DateCreated),ia=F.a.MFi(ma.DateCreated),ia=String.format(CommonUIStrings.l_CreatedTimeFormatString,ma.Author,ia)):ia=ma.Author;const ka=ma.AccessUrl+"?web=1",va=T.a.gIc(ka);da=String.format('<a href="{0}">{1}</a>',
va,T.a.FI(da));if(ha!==f.a.contextMenu||T.a.gQ(ka))if(da=this.Ozl(qa,ha===f.a.contextMenu?da:ka,ia,ma.FileExtension,ma.Text,ba))da.description=ma.Author,da.bje=R,na.DB(da)}return na}ygc(R,ba,ha,na,da){na===this.AW&&(this.ERa(),J.TellMeActor.instance.Qe.$ga(ba.Qg.length,this.dwf.join(","),R.data.Ge.toString(),Math.round(window.performance.now()-da),M.a.substrate,!1,t.a.o5a));R=new D.a(ba);ha.resultsUpdated(R)}bKl(R,ba,ha,na,da,ia,ma){ma=ma?this.CSh:this.qFh;if(!window.LPC&&!F.a.Bng()||this.o$c===ma)return null;
this.o$c+=1;ma="PeopleSuggestion"+this.o$c.toString();var qa=this.KJh+"?size=1&accountName="+na;R=Object.assign(new N.a,{PersonaType:R,Smtp:na,ProfilePictureUrl:qa,AadObjectId:da});const ka=Object.assign(new B.a,{identifiers:R,displayName:ba});R=ia===f.a.contextMenu;this.Gb.Fmb?(J.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(ma,ka,ba,ha)),ia===f.a.contextMenu&&(ha=F.a.vdi(ba,na,da),J.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ma,ha))),
J.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(ma,R))):(qa=[],qa.push(appChrome.actions.setPersonaButtonCoauthor(ma,ka,ba,ha)),ia===f.a.contextMenu&&(ha=F.a.vdi(ba,na,da),qa.push(appChrome.actions.setButtonCommandValueId(ma,ha))),qa.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(ma,R)),appChrome.api.dispatch(qa));return new x.a(ma,11,ba,na,0)}zHl(R,ba,ha,na,da,ia,ma){if(da&&!this.Gb.jVi||this.Aae===this.Q$d||this.j9c===this.Q$d||
this.EAb===this.Q$d)return null;var qa=null;this.Aae+=1;da="";const ka=[],va={};ma.type="Notes";this.JGh=Object.assign(new E.a,{landingTab:"Notes",data:ma});ia=F.a.ejb(ia.Qg,33,this.JGh);if("onenotepagepreviews"===R){if(!("ClickthroughUrl"in ma&&ma.ClickthroughUrl)||""===ma.ClickthroughUrl)return null;this.j9c+=1;da="OnenoteNotesSuggestion"+this.j9c.toString();va["default"]="SaveAsonetoc2_20";qa=ma.ClickthroughUrl;ka.push(appChrome.actions.setControlIconSet(da,va));ka.push(appChrome.actions.setCompoundButtonCommandValueId(da,
qa));qa=new x.a(da,19,null,null,0)}else if("stickynote"===R){if(!this.vOh)return null;this.EAb+=1;da="NotesSuggestion"+this.EAb.toString();va["default"]="ShowAllNotes_20";ka.push(appChrome.actions.setControlIconSet(da,va));ka.push(appChrome.actions.setCompoundButtonCommandValueId(da,ia));qa=new x.a(da,21,null,null,0)}else if("samsung"===R){if(!this.vOh)return null;this.EAb+=1;da="NotesSuggestion"+this.EAb.toString();va["default"]="CategoryCollapsed_20";ka.push(appChrome.actions.setControlIconSet(da,
va));ka.push(appChrome.actions.setCompoundButtonCommandValueId(da,ia));qa=new x.a(da,20,null,null,0)}""!==da&&(R=F.a.MFi(ba),R=String.format(CommonUIStrings.l_LastModifiedString,R),qa.label=na,qa.bje=F.a.$cg(ba),ka.push(appChrome.actions.setControlLabel(da,na)),ka.push(appChrome.actions.updateCompoundButtonDescription(da,R)),ka.push(appChrome.actions.setControlCustomTooltip(da,ha)),appChrome.api.dispatch(ka));return qa}Ozl(R,ba,ha,na,da,ia){if(this.u1c===(ia?this.BSh:this.GPh))return null;this.u1c+=
1;ia="FileSuggestion"+this.u1c.toString();const ma=[],qa={};qa["default"]=F.a.tCl(na);this.Gb.Fmb?(J.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ia,R)),J.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(ia,qa)),J.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ia,ha)),J.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ia,ba)),J.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(ia,
da))):(ma.push(appChrome.actions.setControlLabel(ia,R)),ma.push(appChrome.actions.setControlIconSet(ia,qa)),ma.push(appChrome.actions.updateCompoundButtonDescription(ia,ha)),ma.push(appChrome.actions.setCompoundButtonCommandValueId(ia,ba)),ma.push(appChrome.actions.setControlCustomTooltip(ia,da)),appChrome.api.dispatch(ma));return new x.a(ia,6,R,ha,0)}EPl(){const R=[];this.Gb.dYd&&Array.add(R,"People");this.Gb.bYd&&Array.add(R,"File");this.Gb.mpb&&Array.add(R,"Notes");return R}yPl(R,ba,ha,na){var da=
new l(R);R=new m("File",da,0,na?this.BSh:this.GPh,null);na=new m("People",da,0,na?this.CSh:this.qFh,F.a.eQm);da=new m("Notes",da,0,this.Q$d,null);ba=new k("app",ba.toLowerCase());var ia=[];Array.add(ia,ba);ba=new w("tellmesearch",ia);ia=[];this.Gb.bYd&&Array.add(ia,R);this.Gb.dYd&&Array.add(ia,na);this.Gb.mpb&&Array.add(ia,da);ha=new H(ia,"UTC",ha,ba);return P.c(ha)}xPl(){let R=this.Gb.GAn;this.Gb.mpb&&(R+="?&setflight=NotesFrom3S");""!==this.Gb.EEi&&(R=R+"&"+this.Gb.EEi);return R}uhm(R){return"DisplayName"in
R&&"Id"in R&&"EmailAddresses"in R&&!!R.Id&&!!R.EmailAddresses}khm(R){return"FileExtension"in R&&!!R.FileExtension&&"FileName"in R&&!!R.FileName&&""!==R.FileName&&"AccessUrl"in R&&!!R.AccessUrl&&""!==R.AccessUrl}thm(R){return"Id"in R&&!!R.Id&&"NotesType"in R&&!!R.NotesType&&"Subject"in R&&!!R.Subject&&""!==R.Subject}}Object(C.a)(I,"SubstrateResultsProvider",null,[1035])},1583:function(C,L,b){C=b(0);var f=b(161),c=b(6),u=b(17),r=b(146),t=b(79),k=b(141),m=b(199),l=b(577),x=b(51),w=b(362),G=b(2),D=b(1256),
H=b(692);class M{constructor(ka,va=0){this.mRf=null;this.ZLg=0;this.NS=ka;this.owm=va}}Object(C.a)(M,"GraphMergerResponse",null,[]);var J=b(41),F=b(1),A=b(295),N=b(1214),B=b(650),E=b(1340),P=b(1395);class T extends P.a{constructor(){super();this.ZEj=null;this.MSj=!1}get rra(){return"Crash"}n9b(){this.detail.$("Type",this.rra);this.detail.$("Trace",this.RGn(this.ZEj));this.detail.$("Continue",this.MSj);return this.detail}RGn(ka){ka=ka.split("\n");const va=4<ka.length?4:ka.length,ja=new Sys.StringBuilder;
for(let Ma=0;Ma<va;Ma++)Ma===va-1?ja.append(String.format("{0}...",ka[Ma])):ja.append(String.format("{0}\n",ka[Ma]));return ja.toString()}}Object(C.a)(T,"CrashMergeFailureDetail",P.a,[]);var V=b(1721),I=b(1358),R=b(1459),ba=b(1341),ha=b(1541);class na{constructor(){this.f1h=new w.a;this.V8h=new w.a;this.I$h=new w.a}}Object(C.a)(na,"RangeMarkers",null,[]);class da{constructor(){this.colSpan=this.rowSpan=null;this.we=!1;this.ogf=new m.a;this.oof=new m.a;this.Hof=new m.a}get Beg(){return this.ogf.I8()}set Beg(ka){ka||
(this.ogf=new m.a);this.ogf=ka.I8()}get BEg(){return this.oof.I8()}set BEg(ka){ka||(this.oof=new m.a);this.oof=ka.I8()}get TMe(){return this.Hof.I8()}set TMe(ka){ka||(this.Hof=new m.a);this.Hof=ka.I8()}}Object(C.a)(da,"TableCellStructureInfo",null,[]);var ia=b(1398),ma=b(1448);b.d(L,"a",function(){return qa});class qa{constructor(){this.SAe=0;this.Yxh=this.Kyb=this.Fuc=this.Mg=this.YLh=this.$vc=null;this.oFh=0;this.MCh=50;this.Bbe=this.sZc=this.V$a=this.gaa=this.Wvh=this.Hqh=null}get Grj(){return this.$vc}get Ncn(){return this.YLh}get Mc(){return this.Mg}get nJb(){return this.Fuc}get xHi(){return this.Kyb}get lUl(){return this.Yxh}get rMc(){return this.oFh}get A6h(){return this.Hqh}get jrd(){return this.Wvh}KHe(ka){null==
this.gaa&&(ka?(ka.hq(34),this.gaa=ka.isFeatureEnabled(34)):(this.gaa=!1,r.a.instance.xa(528761236,1,2,"Feature helper is null")));return this.gaa}vmg(ka){null==this.V$a&&(ka?(ka.hq(18),this.V$a=ka.isFeatureEnabled(18)):(this.V$a=!1,r.a.instance.xa(527292032,1,2,"Feature helper is null")));return this.V$a}c9l(ka){null==this.sZc&&(ka?void 0===N.a.LNf||null===N.a.LNf?this.sZc=!1:(ka.hq(N.a.LNf),this.sZc=ka.isFeatureEnabled(N.a.LNf)):(this.sZc=!1,r.a.instance.xa(526164233,1,2,"Feature helper is null")));
return this.sZc}wTi(ka){null==this.Bbe&&(ka?(ka.TAe(1000010),this.Bbe=ka.Cmb(1000010)):(this.Bbe=!1,r.a.instance.xa(527034191,1,2,"Feature helper is null")));return this.Bbe}zMc(ka,va,ja,Ma,Ha,X,W){ja=this.o2k(ka,va,Ma,Ha,X,W,this.jrd);Ma=0;const fa=ja.runtime.bZe;let ra=null;try{this.Jom(fa,ja,W,ka,va,Ha,X);for(ka=1;Ma<this.nJb.length;Ma++)if(!(0,this.nJb[Ma])(ja)){ka=2;ja.logger.vKe("GraphMerger.GetMergeFunctions()",Ma);break}return ra=new M(ja.output.NS,ka)}catch(Aa){const Ba=!ja.output.timeout;
ja.output.crash=Ba;const ta=this.axe(Aa),xa=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",Ba?"Crashed":"Timed Out",ja.input.mfc,!!ja.output.NS,ta);Ba?(r.a.instance.xa(4051608,1,1,"MergeChanges Crash. [Error: {0}]",xa),ja.logger.Fg(Object.assign(new T,{ZEj:ta,MSj:!!ja.output.NS}))):r.a.instance.xa(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",xa);if(ja.output.NS)return ra=new M(ja.output.NS,2);throw Aa;}finally{ja.output.succeeded?this.Gom(fa,ja,Ma):ja.output.timeout?
this.Iom(ja,Ma):ja.output.crash?ja.output.NS?this.Hom(ja,Ma):this.Fom(ja,Ma):this.Eom(ja,Ma);ja.logger.Dom();r.a.instance.Z8(42350232,1,ja.output.succeeded?3:2,"MergeLogger",ja.logger.UFl());ja.logger.iWa.jJi()&&r.a.instance.Z8(559015903,1,2,"MarkerInfo",ja.logger.iWa.toString());if(ja.runtime.Ka&&ja.runtime.Ka.isFeatureEnabled(120))try{this.fmm(ja)}catch(Aa){r.a.instance.xa(571619421,1,3,"Error logging references: {0}",Aa.toString())}this.kqm(ja);ra.ZLg|=(ja.output.succeeded?2:1)<<2*(W-1);if(ra)try{ra.mRf=
this.MSm(ja)}catch(Aa){r.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",Aa)}}}kqm(ka){if(!ka.output.succeeded){ka=ka.logger.dhj?ka.logger.dhj.rra:"Unknown";const va=new A.a;t.Health.instance.recordQosError(ka,["MergeFailure"],!0,!0,!1,!1,va)}}fmm(ka){const va=Ha=>{const X=this.uTa()-ka.input.r9a>this.rMc;if(0<this.rMc&&X)throw r.a.instance.xa(571619422,1,2,"Timed out while calculating added and deleted nodes: {0}",Ha),k.a.invalidOperation(Ha);};let ja=ka.runtime.Zu.keys,
Ma=Ha=>ka.runtime.Zu.J(Ha);this.Kwg(ka,va,ja,Ma,"Favored");ja=ka.runtime.Kr.keys;Ma=Ha=>ka.runtime.Kr.J(Ha);this.Kwg(ka,va,ja,Ma,"Unfavored");ja=ka.runtime.zm.keys;Ma=Ha=>{const X=ka.runtime.zm.J(Ha);return X?X.Wj:ka.runtime.Zu.J(Ha)};this.Kwg(ka,va,ja,Ma,"Merged")}Kwg(ka,va,ja,Ma,Ha){var X=new m.a;const W=new m.a;for(let fa=0;fa<ja.length;fa++){va("LogAddedAndDeletedNodes");const ra=Ma(ja.J(fa));if(4325465===ra.Jb)continue;const Aa=ka.runtime.pk.J(ra.id);Aa&&this.gmm(X,W,ra,Aa)}this.I0i(W,fa=>ka.runtime.pk.J(fa),
va);this.I0i(X,Ma,va);va=new Sys.StringBuilder;for(ja=0;ja<X.length;ja++)va.append(X.J(ja).toString()+",");X=new Sys.StringBuilder;for(ja=0;ja<W.length;ja++)X.append(W.J(ja).toString()+",");r.a.instance.Z8(571619423,1,3,Ha+" revision: Added references",va.toString());r.a.instance.Z8(571619424,1,3,Ha+" revision: Deleted references",X.toString())}gmm(ka,va,ja,Ma){const Ha=ja.Dh();for(let W=0;W<Ha.length;W++){const fa=Ha[W];if(this.tPi(fa)){var X=this.Mc.getPropertyObjectIds(ja,fa);this.Gnm(ka,va,Ma,
fa,X)}else this.fTi(fa)&&(X=this.Mc.getPropertyObjectId(ja,fa),this.Fnm(ka,va,Ma,fa,X))}}I0i(ka,va,ja){ja("LogNestedReferences");ja=new m.a;const Ma=new l.a;for(let Ha=0;Ha<ka.length;Ha++){const X=ka.J(Ha);this.Axg(X,ja,Ma,va)}for(va=0;va<ja.length;va++)ka.add(ja.J(va))}Axg(ka,va,ja,Ma){const Ha=Ma(ka);if(Ha){const W=Ha.Dh();for(let fa=0;fa<W.length;fa++){var X=W[fa];if(this.tPi(X)){X=this.Mc.getPropertyObjectIds(Ha,X);for(let ra=0;ra<X.length;ra++)ja.contains(X.J(ra))||(va.add(X.J(ra)),ja.add(X.J(ra)),
this.Axg(X.J(ra),va,ja,Ma))}else this.fTi(X)&&(X=this.Mc.getPropertyObjectId(Ha,X),ja.contains(X)||(va.add(X),ja.add(X),this.Axg(ka,va,ja,Ma)))}}}Gnm(ka,va,ja,Ma,Ha){if(this.Mc.hasProperty(ja,Ma)){ja=this.Mc.getPropertyObjectIds(ja,Ma);const X=ja.iG();Ma=Ha.iG();for(let W=0;W<Ha.length;W++)X.contains(Ha.J(W))||ka.add(Ha.J(W));for(ka=0;ka<ja.length;ka++)Ma.contains(ja.J(ka))||va.add(ja.J(ka))}else for(va=0;va<Ha.length;va++)ka.add(Ha.J(va))}Fnm(ka,va,ja,Ma,Ha){Ha&&(this.Mc.hasProperty(ja,Ma)?(ja=this.Mc.getPropertyObjectId(ja,
Ma),Ha.equals(ja)||(ka.add(Ha),va.add(ja))):ka.add(Ha))}Com(ka){r.a.instance.xa(4535064,1,3,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",ka.input.mfc,ka.output.crash,ka.output.timeout)}Jom(ka,va,ja,Ma,Ha,X,W){if(ka){ka=Ma.length?Ma.Rf(Ma.length-1):null;var fa=Ha.length?Ha.Rf(Ha.length-1):null;ja=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",
va.input.mfc,Ma.length,ka?ka.id:x.a.nil,ka?ka.uaa?ka.uaa.id:x.a.nil:x.a.nil,Ha.length,fa?fa.id:x.a.nil,fa?fa.uaa?fa.uaa.id:x.a.nil:x.a.nil,X,W,this.rMc,ja);switch(va.input.source){case 5:r.a.instance.xa(51663493,1,3,ja);break;default:r.a.instance.xa(4051606,1,3,ja)}}}Gom(ka,va,ja){if(ka)switch(ka=this.$td(va,ja,"Succeeded"),va.input.source){case 5:r.a.instance.xa(51663494,1,3,ka);break;default:r.a.instance.xa(4059162,1,3,ka)}}Iom(ka,va){va=this.$td(ka,va,"Timeout");switch(ka.input.source){case 5:r.a.instance.xa(51663495,
1,3,va);break;default:r.a.instance.xa(4059163,1,2,va)}}Eom(ka,va){va=this.$td(ka,va,"Rejection");switch(ka.input.source){case 5:r.a.instance.xa(51663496,1,3,va);break;default:r.a.instance.xa(4059164,1,2,va)}}Hom(ka,va){va=this.$td(ka,va,"Crash - Rejection");switch(ka.input.source){case 5:r.a.instance.xa(51663497,1,3,va);break;default:r.a.instance.xa(4059165,1,2,va)}}Fom(ka,va){va=this.$td(ka,va,"Crash - Failed");switch(ka.input.source){case 5:r.a.instance.xa(51663498,1,3,va);break;default:r.a.instance.xa(4059166,
1,2,va)}}$td(ka,va,ja){const Ma=ka.output.NS,Ha=Ma&&Ma.length?Ma.Rf(Ma.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",ka.input.mfc,ja,this.uTa()-ka.input.r9a,va,Ma?Ma.length:0,Ha?Ha.id:x.a.nil,Ha?Ha.uaa?Ha.uaa.id:x.a.nil:x.a.nil,ka.input.source)}o2k(ka,va,ja,Ma,Ha,X,W){const fa=new V.a,ra=fa.input;ra.nda=ka;ra.VLa=va;ra.gl=ja;ra.rca=Ma;ra.mIc=Ha;ra.source=
X;ra.jrd=W;ra.r9a=this.uTa();fa.logger.Con(ra.r9a);ka=fa.runtime;ka.oVd=r.a.instance.jT(1,4);ka.bZe=r.a.instance.jT(1,3);let Aa="";ka.hG=Ba=>{if(this.rMc){var ta=this.uTa()-ra.r9a,xa=ta>this.rMc;Aa+=String.format(" ({0}: {1})",Ba,ta);xa&&(fa.output.timeout=!0,Ba=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",ra.mfc,this.rMc,Ba,ta,Aa),r.a.instance.xa(528061012,1,2,Ba),this.PDn(Ba))}};return fa}mvd(){return[Object(J.a)(this,
this.CMm,"otherAuthorsHaveChangesToMerge"),Object(J.a)(this,this.Ebm,"isInputValid"),Object(J.a)(this,this.O3l,"initializeOutputMergeState"),Object(J.a)(this,this.JDe,"initializeRuntimeMergeState"),R.a.ySm,Object(J.a)(this,this.xSm,"preProcessTableStructure"),Object(J.a)(this.A6h,this.A6h.Zvm,"mergeChildNodeLists"),Object(J.a)(this,this.XHn,"tryObjectMerge"),R.a.hSm,Object(J.a)(this,this.Wjl,"finalizeObjectMerge"),Object(J.a)(this,this.validateMarkers,"validateMarkers"),Object(J.a)(this,this.wvk,
"addMergeResultsToOutput")]}CMm(ka){const va=ka.input.nda;ka=ka.output;return va?va.length?!0:(r.a.instance.xa(4051610,1,4,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),ka.NS=va,ka.succeeded=!0,!1):(r.a.instance.xa(4051609,1,4,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),ka.NS=va,ka.succeeded=!0,!1)}Ebm(ka){var va=ka.input;const ja=va.nda,Ma=va.VLa,Ha=va.gl,X=va.rca;va=va.mIc;ka=ka.output;if(!Ma||!Ma.length)return r.a.instance.xa(42350233,
1,4,"IsInputValid: No local changes to merge."),ka.NS=ja,ka.succeeded=!0,!1;let W=!0;if(2!==X&&1!==X)return ka.NS=ja,!1;Ha&&Ha!==x.a.nil||(W=!1);ja.length<(va?2:1)&&(r.a.instance.xa(4051614,1,4,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",va),W=!1);W||(ka.NS=2===X?ja:Ma);return W}JDe(ka){var va=ka.input,ja=va.nda,Ma=va.VLa,Ha=va.rca,X;let W;({wDn:X,wTn:W,MRa:va}=this.gEl(ka,ja,Ma,va.mIc));if(!va)return r.a.instance.xa(4273301,
1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",X.id,W.id),ka.logger.Fg(Object.assign(new E.a,{wj:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.d1i(X,ja.length,"TheirChanges"),this.d1i(W,Ma.length,"YourChanges"),ka.output.NS=2===Ha?ja:Ma,!1;ka.runtime.MRa=va;({cJn:ja,Lil:Ma}=this.F$k(Ha,X,W));({dJn:va,Mil:Ha,xGk:X}=this.nGl(ka,ja,Ma,va));ka.runtime.pk=X;ka.runtime.Kr=va;ka.runtime.Zu=Ha;ka.runtime.zm=
new w.a;ka.runtime.Tte=Ma.id;ka.runtime.c3e=ja.id;ka.runtime.GJb=new w.a;ka.runtime.O2a=new l.a;ka.runtime.hVf=new w.a;ka.runtime.c5b=new w.a;ka.runtime.C9g=new w.a;ka.runtime.Iic=new na;ka.runtime.yLe=new m.a;ka.runtime.pLg=new l.a;ka.runtime.qTc=new m.a;ka.runtime.Ka=ka.input.jrd(ka);ka.runtime.Ka.agd(1000001,"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",f.a.sIj);ka.runtime.Ka.agd(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",f.a.gJj);
ka.runtime.Ka.agd(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",f.a.Mmi);ka.runtime.Ka.agd(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",f.a.Rmj);ka.runtime.Ka.agd(1000010,"Microsoft.Office.WordOnline.ValidateMarkers","08367149;c570e399",f.a.JRj);ka.runtime.hNi=!0;G.AFrameworkApplication.K&&(this.MCh=G.AFrameworkApplication.K.jb("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}d1i(ka,
va,ja){const Ma=new m.a;for(;ka;)Ma.add(ka),ka=ka.uaa;const Ha=new Sys.StringBuilder;Ha.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",ja,va,Ma.length));let X=Ma.length,W=0;Ma.forEach(fa=>({oLi:X,A1i:W}=this.Jwk(Ha,fa,Ma,X,W)).returnValue);r.a.instance.xa(4273302,1,3,Ha.toString())}Jwk(ka,va,ja,Ma,Ha){ka.append(String.format(" [{0} {1} {2}]",Ma,va.kJa?"S":"B",va.id));Ma--;Ha++;return 50<Ha&&ja.length!==Ha?(ka.append(" ...Truncated."),{returnValue:!1,oLi:Ma,A1i:Ha}):{returnValue:!0,
oLi:Ma,A1i:Ha}}gEl(ka,va,ja,Ma){va=va.Rf(va.length-1-(Ma?1:0));ja=ja.Rf(ja.length-1);Ma=va.sFb(ja);ka.runtime.hG("GetCommonBase");ka.logger.Rsa("GetCommonBase");return{wDn:va,wTn:ja,MRa:Ma}}nGl(ka,va,ja,Ma){let Ha,X;({result:Ha}=va.BMc(Ma));ka.runtime.hG("GetUnfavoredChanges");ka.logger.Rsa("GetUnfavoredChanges");({result:X}=ja.BMc(Ma));5===ka.input.source&&(ka.runtime.Qil=B.a.XCi(ja),ka.runtime.xch=B.a.XCi(va));ka.runtime.hG("GetFavoredChanges");ka.logger.Rsa("GetFavoredChanges");va=new D.a(Object(J.a)(Ma,
Ma.Wlb,"getMergeableObject"));ka.runtime.hG("GetModifiedObjects");ka.logger.Rsa("GetModifiedObjects");return{dJn:Ha,Mil:X,xGk:va}}F$k(ka,va,ja){2===ka?(ka=va,va=ja):ka=ja;return{cJn:va,Lil:ka}}O3l(ka){const va=ka.input,ja=va.nda,Ma=va.VLa;ka.output.NS=(2===va.rca?ja:Ma).I8();ka.runtime.hG("InitializeOutputMergeState");ka.logger.Rsa("InitializeOutputMergeState");return!0}wvk(ka){var va=ka.input.gl;const ja=ka.runtime.zm,Ma=ka.output.NS;va=this.p2k(ka,Ma.Rf(Ma.length-1),va,x.a.create());this.Ajl(ka,
va,ja);Ma.add(va);return ka.output.succeeded=!0}p2k(ka,va,ja,Ma){ka.runtime.bZe&&r.a.instance.xa(4051616,1,3,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",ja,Ma);ka=this.Ncn(Ma);ka.SGk(va,ja);return ka}Ajl(ka,va,ja){ka.runtime.bZe&&r.a.instance.xa(4059167,1,3,"FillRevision: Adding {0} objects to merged revision.",ja.count);ja.forEach((Ma,Ha)=>{va.swk(Ha.Wj);return!0})}gdc(ka){if(!ka)return r.a.instance.xa(573957952,1,2,"Feature helper is null"),!1;ka.hq(177);
return ka.isFeatureEnabled(177)}xSm(ka){if(!this.gdc(ka.runtime.Ka))return!0;const va=ka.runtime.Zu,ja=ka.runtime.Kr,Ma=ka.runtime.pk;let Ha=!0;va.forEach((X,W)=>{393252===W.Jb&&(Ha=this.zfj(ka,X,W,Ma,va));return Ha});if(!Ha)return!1;ja.forEach((X,W)=>{393252===W.Jb&&(Ha=this.zfj(ka,X,W,Ma,ja));return Ha});ka.logger.Rsa("PreProcessTableStructure");return Ha}zfj(ka,va,ja,Ma,Ha){const X=null==this.Mc.getPropertyBool(ja,c.a.ghostCell)?!1:this.Mc.getPropertyBool(ja,c.a.ghostCell),W=null==this.Mc.getPropertyUint32(ja,
c.a.rowSpan)?1:this.Mc.getPropertyUint32(ja,c.a.rowSpan),fa=null==this.Mc.getPropertyUint32(ja,c.a.colSpan)?1:this.Mc.getPropertyUint32(ja,c.a.colSpan);if(X)return!0;var ra=Ma.J(va);if(ra){Ma=null==this.Mc.getPropertyBool(ra,c.a.ghostCell)?!1:this.Mc.getPropertyBool(ra,c.a.ghostCell);var Aa=null==this.Mc.getPropertyUint32(ra,c.a.rowSpan)?1:this.Mc.getPropertyUint32(ra,c.a.rowSpan);var Ba=null==this.Mc.getPropertyUint32(ra,c.a.colSpan)?1:this.Mc.getPropertyUint32(ra,c.a.colSpan);Ma=Ma!==X;Aa=Aa!==
W;Ba=Ba!==fa}else Ba=Aa=Ma=!0;const ta=ma.e(ka,ja,Ha);if(ta.equals(x.a.nil))return r.a.instance.xa(573957953,1,2,"Table cell's containing table node id could not be found. Table Cell ID: {0}",va),ka.logger.Fg(Object.assign(new ia.a,{info:"Table Cell's containing table node ID could not be found"})),!1;let xa=ka.runtime.c5b.J(ta);xa||(ka.runtime.c5b.$(ta,new w.a),xa=ka.runtime.c5b.J(ta));let za=xa.J(va),la=new m.a;const Sa=new m.a,Pa=new m.a;Ma&&(za||(la=this.Mc.getPropertyObjectIds(ja,u.a.jf)));if(Aa||
Ba)if(za){if(za.we)return r.a.instance.xa(573957961,1,3,"Table cell has conflicting ghostcell properties we are not handling"),ka.logger.Fg(Object.assign(new ia.a,{info:"A table cell is ghost in one revision while non-ghost in another."})),!1;if(null!=za.rowSpan&&W!==za.rowSpan||null!=za.colSpan&&fa!==za.colSpan)return r.a.instance.xa(573957962,1,3,"Same table cell has different rowSpan/colSpan in conflicting revisions"),ka.logger.Fg(Object.assign(new ia.a,{info:"A table cell has different rowSpan/colSpan in the conflicting revisions"})),
!1}else{var fb;({rowIndex:ja,OAc:fb}=ma.b(ka,Ha,ja));if(-1===ja||-1===fb)return r.a.instance.xa(573957954,1,2,"Table cell location could not be found. Table Cell ID: {0}",va),ka.logger.Fg(Object.assign(new ia.a,{info:"Table cell location could not be found"})),!1;for(var db=ja;db<ja+W;db++)for(var Qa=fb;Qa<fb+fa;Qa++){var wb=ma.c(ka,ta,db,Qa);if(wb.equals(x.a.nil))return r.a.instance.xa(573957955,1,3,"Other revision deleted the table cells this revision is trying to merge"),ka.logger.Fg(Object.assign(new ia.a,
{info:"Ghost cell not found in the table bounds"})),!1;var ib=Ha.VA(wb,ka.runtime.pk.J(wb));if(!ib)return r.a.instance.xa(573957956,1,3,"Other revision has inserted cells in between the cells this revision is trying to merge"),ka.logger.Fg(Object.assign(new ia.a,{info:"Newly inserted cell in another revision cannot be merged with the cell in current revision"})),!1;if(!wb.equals(va)){if(null==this.Mc.getPropertyBool(ib,c.a.ghostCell)||!this.Mc.getPropertyBool(ib,c.a.ghostCell))return r.a.instance.xa(573957957,
1,3,"Other revision deleted some of the cells this revision is trying to merge"),ka.logger.Fg(Object.assign(new ia.a,{info:"Cannot merge a non-ghost cell with the controlling cell"})),!1;var Ta=xa.J(wb);if(Ta)return r.a.instance.xa(573957958,1,3,"The ghost cell is already merged with some other cells in the other revision"),ka.logger.Fg(Object.assign(new ia.a,{info:"Ghost cell is already merged with some other cell"})),!1;Sa.add(wb);Ta=new da;Ta.we=!0;ib=this.Mc.getPropertyUint32(ib,c.a.colSpan);
null!=ib&&(Ta.colSpan=ib);xa.$(wb,Ta)}}if(ra&&(null==this.Mc.getPropertyBool(ra,c.a.ghostCell)||!this.Mc.getPropertyBool(ra,c.a.ghostCell))&&(Ha=null==this.Mc.getPropertyUint32(ra,c.a.rowSpan)?1:this.Mc.getPropertyUint32(ra,c.a.rowSpan),ja=null==this.Mc.getPropertyUint32(ra,c.a.colSpan)?1:this.Mc.getPropertyUint32(ra,c.a.colSpan),Ha>W||ja>fa)){db=fb=-1;({rowIndex:fb,OAc:db}=ma.a(ka,null,ra,fb,db));if(-1===fb||-1===db)return r.a.instance.xa(573957959,1,2,"Table cell location could not be found in base revision. Table Cell ID: {0}",
va),ka.logger.Fg(Object.assign(new ia.a,{info:"Table cell location could not be found in base revision, although the object is present itself"})),!1;ra=Sa.iG();for(Qa=fb;Qa<fb+Ha;Qa++)for(wb=db;wb<db+ja;wb++){Ta=ma.d(ka,null,ta,Qa,wb);if(!Ta)return r.a.instance.xa(573957960,1,2,"Table cell could not be found within table bounds"),ka.logger.Fg(Object.assign(new ia.a,{info:"Ghost cell not found in the table bounds"})),!1;Ta.id.equals(va)||ra.contains(Ta.id)||Pa.add(Ta.id)}}}!za&&(Ma||Aa||Ba)&&(r.a.instance.xa(573957963,
1,3,"Adding cell info structure to the ComplexTableStructure Dictionary for table cell id: {0}",va),za=new da,za.rowSpan=W,za.colSpan=fa,za.we=X,za.TMe=la,za.Beg=Sa,za.BEg=Pa,xa.add(va,za));return!0}XHn(ka){return this.SLj(ka,!1)}Wjl(ka){return this.SLj(ka,!0)}SLj(ka,va){const ja=ka.runtime,Ma=ja.pk,Ha=ja.Zu,X=va?ja.hVf:ja.Kr,W=ja.zm;let fa=!0;const ra=ka.runtime.oVd;let Aa=0,Ba=0,ta=0;X.forEach((xa,za)=>{ra&&r.a.instance.xa(4051617,1,4,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",xa,
za.Jb,va);Ba++;this.MCh===Ba&&(Aa++,ka.runtime.hG(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",Aa,ta,va)),Ba=0);if(ka.runtime.Ka&&ka.runtime.Ka.Cmb(1000005)&&ka.runtime.qTc.contains(za.id,(Pa,fb)=>Pa.equals(fb))||this.Vwn(za.Jb))return!0;if(!va&&this.$7k(za.Jb,ka.runtime.Ka))return ja.hVf.$(xa,za),!0;var la=Ha.get(xa);if(!la)return W.Na(xa)?W.J(xa).r4i(za):W.$(xa,new ba.a(za,!1)),!0;if(!Ma.J(xa)&&!this.Awm(la.Jb)){var Sa=!!ka.input.nda&&!!ka.input.nda.last()&&ka.input.nda.last().sY(xa);
const Pa=!!ka.input.VLa&&!!ka.input.VLa.last()&&ka.input.VLa.last().sY(xa),fb=new I.a(la,za);if(!fb.pY)return W.$(xa,new ba.a(la,!1)),!0;r.a.instance.xa(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",xa,za.Jb,va,Sa,Pa,!fb.pY,ka.input.source);ka.logger.Fg(Object.assign(new E.a,{wj:"GraphMerger.TryObjectMerge",eventId:"ap3k8"}));
return fa=!1}Sa=W.VA(xa,new ba.a(Ma.J(xa)));({Gl:la,returnValue:fa}=this.lUl.merge(ka,this.xHi,this.Mc,Sa,la,za));ta++;fa&&(ka.runtime.hG(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",xa,za.Jb,ta,Aa,va)),la&&(W.Na(la.Wj.id)?W.J(la.Wj.id).r4i(la.Wj):W.$(la.Wj.id,la)));return fa});ka.logger.Rsa("ObjectMerge");fa&&5===ka.input.source&&ka.runtime.xch.length&&Ha.forEach((xa,za)=>393230===za.Jb&&ka.runtime.xch.contains(xa,(la,Sa)=>la.equals(Sa))&&
(fa=Ma.J(xa)?!(new ha.a(u.a.wk,this.Mc.getPropertyString(Ma.J(xa),u.a.wk),this.Mc.getPropertyString(za,u.a.wk))).pY:!1,!fa)?(r.a.instance.xa(16869081,1,2,"Failed to Merge Object {0} which was changed in the favored and removed in the unfavored, finalize: {1}",xa,va),ka.logger.Fg(Object.assign(new E.a,{wj:"GraphMerger.TryObjectMerge",eventId:"baw1z"})),!1):!0);ra&&r.a.instance.xa(4059168,1,4,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",X.count,ta,va);return fa}validateMarkers(ka){try{if(this.wTi(ka.runtime.Ka)){for(let va=
0;va<ka.runtime.yLe.length;va++){const ja=ka.runtime.yLe.J(va);if(ka.runtime.zm.J(ja)){if(!this.scc(ka,ja,null,H.CommonProperties.nil,null))return!1}else r.a.instance.xa(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");ka.runtime.hG("Validate markers taking too long")}return!0}this.KHe(ka.runtime.Ka)||ka.runtime.Iic.I$h.forEach(va=>{var ja=ka.runtime.zm.J(va);if(ja){var Ma=this.Mc.getPropertyObjectId(ja.Wj,c.a.fi);ja=this.Mc.getPropertyObjectId(ja.Wj,c.a.vj);if(!Ma||!ja){let Ha;
(Ha=ka.logger.iWa).bJc=Ha.bJc+1;return!0}Ma=this.scc(ka,Ma,va,c.a.nd,Ha=>38===Ha||40===Ha);va=this.scc(ka,ja,va,c.a.nd,Ha=>39===Ha||41===Ha);if(!Ma||!va){let Ha;(Ha=ka.logger.iWa).bJc=Ha.bJc+1}}else r.a.instance.xa(559535576,1,2,"ValidateMerge: Couldn't find merged node to verify");ka.runtime.hG("Validate markers taking too long");return!0});this.vmg(ka.runtime.Ka)||ka.runtime.Iic.f1h.forEach(va=>{var ja=ka.runtime.zm.J(va);if(ja){var Ma=this.Mc.getPropertyObjectId(ja.Wj,c.a.fG);ja=this.Mc.getPropertyObjectId(ja.Wj,
c.a.QU);if(!Ma||!ja){let Ha;(Ha=ka.logger.iWa).$Ic=Ha.$Ic+1;return!0}Ma=this.scc(ka,Ma,va,c.a.Nhb,Ha=>44===Ha);va=this.scc(ka,ja,va,c.a.Nhb,Ha=>45===Ha);if(!Ma||!va){let Ha;(Ha=ka.logger.iWa).$Ic=Ha.$Ic+1}}else r.a.instance.xa(559535577,1,2,"ValidateMerge: Couldn't find merged node to verify");ka.runtime.hG("Validate markers taking too long");return!0});this.c9l(ka.runtime.Ka)||ka.runtime.Iic.V8h.forEach(va=>{var ja=ka.runtime.zm.J(va);if(ja){var Ma=this.Mc.getPropertyObjectId(ja.Wj,c.a.mC);ja=this.Mc.getPropertyObjectId(ja.Wj,
c.a.RA);if(!Ma||!ja){let Ha;(Ha=ka.logger.iWa).aJc=Ha.aJc+1;return!0}Ma=this.scc(ka,Ma,va,c.a.vi,Ha=>33===Ha);va=this.scc(ka,ja,va,c.a.vi,Ha=>34===Ha);if(!Ma||!va){let Ha;(Ha=ka.logger.iWa).aJc=Ha.aJc+1}}else r.a.instance.xa(559535578,1,2,"ValidateMerge: Couldn't find merged node to verify");ka.runtime.hG("Validate markers taking too long");return!0})}catch(va){r.a.instance.xa(559535579,1,2,"ValidateMerge threw an exception: {0}",va)}return ka.logger.iWa.jJi()?!1:!0}ntn(ka){return 38===ka||39===ka||
40===ka||41===ka||44===ka||45===ka||33===ka||34===ka?!1:!0}GFl(ka){switch(ka){case 38:case 39:case 40:case 41:return c.a.nd;case 44:case 45:return c.a.Nhb;case 33:case 34:return c.a.vi}return H.CommonProperties.nil}$Qn(ka,va){const ja=this.Mc.getPropertyUint32(ka,c.a.Jp);if(!ja||this.ntn(ja))return!0;ka=this.Mc.getPropertyObjectId(ka,this.GFl(ja));return qa.OFc(va,ka)?!0:(va.logger.iWa.uEe=ja,!1)}scc(ka,va,ja,Ma,Ha){if(ka.runtime.pLg.contains(va))return!1;var X=qa.OFc(ka,va);va=this.wTi(ka.runtime.Ka);
if(X){X=this.Mc.getPropertyObjectIds(X,u.a.qn);for(let ra=0;ra<X.length;ra++){var W=qa.OFc(ka,X.Rf(ra));if(W)if(va){if(!this.$Qn(W,ka))return!1}else{var fa=this.Mc.getPropertyBool(W,u.a.w5);if(fa&&fa&&(fa=this.Mc.getPropertyUint32(W,c.a.Jp),W=this.Mc.getPropertyObjectId(W,Ma),Ha(fa)&&W.equals(ja)))return!0}}}return va}Vwn(ka){switch(ka){case 1074135137:case 1074135138:case 1074135139:case 1074135140:case 131162:case 4325465:return!0}return!1}$7k(ka,va){let ja=!1;if(1074135145===ka)return!0;va&&va.hq(210);
va&&va.isFeatureEnabled(210)&&1074135153===ka&&(ja=!0);return ja}Awm(ka){switch(ka){case 1074135162:return!0}return!1}i4k(ka,va){const ja=new m.a,Ma=new m.a,Ha=new m.a;var X=ka.runtime.MRa;const W=X?X.id:x.a.nil;this.Jvg(X).forEach(fa=>{ja.add(va(fa));return!0});X=ka.input.nda.Rf(ka.input.nda.length-1);this.Jvg(X,W).forEach(fa=>{Ma.add(va(fa));return!0});ka=ka.input.VLa.Rf(ka.input.VLa.length-1);this.Jvg(ka,W).forEach(fa=>{Ha.add(va(fa));return!0});return{vGk:ja,xDn:Ma,xTn:Ha}}Jvg(ka,va=null){const ja=
new m.a;va||(va=x.a.nil);for(;ka&&!va.equals(ka.id);)ja.add(ka),ka=ka.uaa;ja.reverse();return ja}cBn(ka){const va=3===this.SAe;let ja=!1;!ka.output.succeeded&&(2===this.SAe||ka.output.crash&&1===this.SAe)&&(ja=!0);let Ma=!1;ka.input.nda&&0<ka.input.nda.length&&(va||ja)&&ka.runtime.Zu&&ka.runtime.pk&&ka.runtime.Ka&&(Ma=ka.runtime.Ka.isFeatureEnabled(83));return Ma}tPi(ka){return 9===F.a.hIa(F.a.vve(ka))}fTi(ka){return 8===F.a.hIa(F.a.vve(ka))}static jBl(ka){return ka.output.crash?2:ka.output.succeeded?
3:1}static OFc(ka,va){if(!va||va===x.a.nil)return null;const ja=ka.runtime.zm.J(va);return ja?ja.Wj:ka.runtime.pk.J(va)}}qa.RAe=x.a.qe("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");Object(C.a)(qa,"GraphMergerBase",null,[1273])},1595:function(C,L,b){C=b(0);var f=b(199),c=b(1446),u=b(141),r=b(1357);class t extends c.a{constructor(m,l,x,w,G,D,H,M,J,F,A,N,B,E){super(m,3,l,x,w,G,D,M,J,F,A,N,B,E);this.U$e=H}get character(){return this.U$e}get text(){return this.character.toString()}MUd(){throw u.a.notImplemented();
}toString(){return String.format("{0}",super.toString())}gFc(){return"CharRun"}clone(){return new t(this.tgd,this.source,this.Vj,this.zf,this.runId,this.EN,this.character,this.DJb,this.$5a,this.i4,this.oUa,this.V7a,this.YI,this.Wt)}jD(m,l,x,w=!1){return super.jD(m,l,x,w)?m.character===this.character?!0:r.a.NZh(m.character,this.character):!1}}Object(C.a)(t,"CharRunMergeBlock",c.a,[]);b.d(L,"a",function(){return k});class k extends c.a{constructor(m,l,x,w,G,D,H,M,J,F,A,N,B,E,P){super(m,1,l,x,w,G,D,
M,F,A,N,B,E,P);this._text=H;this.kwf=J}get text(){return this._text}MUd(m){this._text=m}get pub(){return this.kwf&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",super.toString(),this.kwf)}gFc(){return"TextRun"}clone(){return new k(this.tgd,this.source,this.Vj,this.zf,this.runId,this.EN,this._text,this.DJb,this.kwf,this.$5a,this.i4,this.oUa,this.V7a,this.YI,this.Wt)}jD(m,l,x,w=!1){return super.jD(m,l,x,w)?r.a.MZh(this._text,m._text):!1}HWd(){const m=
new f.a;for(let x=0;x<this.text.length;x++){var l=r.a.charAt(this._text,x);if(r.a.ggm(r.a.uEn(l))){let w="";w+=l;l=r.a.charAt(this._text,++x);w+=l;l=new k(this.tgd,this.source,this.Vj,this.zf,this.runId,this.EN,w,this.DJb,!1,this.$5a,this.i4,this.oUa,this.V7a,this.YI,this.Wt);m.add(l)}else l=new t(this.tgd,this.source,this.Vj,this.zf,this.runId,this.EN,l,this.DJb,this.$5a,this.i4,this.oUa,this.V7a,this.YI,this.Wt),m.add(l)}return m}}Object(C.a)(k,"TextRunMergeBlock",c.a,[])},1596:function(C,L,b){C=
b(0);var f=b(893),c=b(17),u=b(362),r=b(199),t=b(51);b(726);var k=b(577),m=b(146),l=b(141),x=b(910),w;(function(J){J[J.none=0]="none";J[J.browser=1]="browser";J[J.serverPutChanges=2]="serverPutChanges";J[J.syncDiff=3]="syncDiff";J[J.docxMerge=4]="docxMerge";J[J.undo=5]="undo"})(w||(w={}));Object(C.b)("GraphMergeSource",w);var G=b(1580),D=b(1371),H=b(1576);b.d(L,"a",function(){return M});class M{constructor(J){this.RD=new x.a;this.wW=new u.a;this.jQh=new u.a(0);this.Z2d=new r.a;this.Xyh=new r.a;this.mGh=
new r.a;this.cEh=new r.a;this.GFh="";this.Qbb=null;this.Pp=this.xlf=0;this.Cbe=new u.a(0);this.Bef=this.jJh=this.h$d=0;const {MarkerValidation:F}=b(1679);this._state=J;this.tfk=new F}get iWa(){return this.tfk}get dhj(){return this.Qbb}Con(J){this.xlf=J}vKe(J,F){this.GFh=String.format("{0}-{1}",J,F)}RXe(J){this.gSk();this.Bef=J}q1g(){this.Bef=0}gSk(){this.Qbb&&this.Z2d.add(this.Qbb);this.Qbb=null}Fg(J){this.Qbb||(this.Qbb=J);switch(this.Bef){case 1:this.Xyh.add(J);break;case 2:this.mGh.add(J);break;
case 3:this.cEh.add(J);break;default:this.Qbb&&this.Z2d.add(J)}}P_i(J){this.Z2d.add(J)}Dom(){this.Pp=this.uTa();this.Rsa("MergeEnd")}Rsa(J){const F=this.uTa();this.jQh.$(J,F-this.xlf);this.xlf=F}cnn(){this.h$d=this.uTa();this.jJh++}A0(J){const F=this.uTa();let A;({value:A}=this.Cbe.Ab(J)).returnValue?(A+=F-this.h$d,this.Cbe.$(J,A)):this.Cbe.$(J,F-this.h$d);this.h$d=F}UFl(){this.wW.$("Id",this._state.input.mfc.toString());this.wW.$("Source",w[this._state.input.source]);this.wW.$("Base",M.ULa(this.Msl()));
this.wW.$("Favored",M.ULa(this.jDi(!0)));this.wW.$("Unfavored",M.ULa(this.jDi(!1)));this.wW.$("NodesRolledBackIfFailed",M.ULa(this.uHl()));if(!this._state.output.succeeded){let J,F,A,N,B;({yGk:J,Oil:F,eJn:A,DGk:N,fJn:B}=this.Yjl(this._state.runtime));this.wW.$("CharactersLost",this.sul(J,F,A));this.wW.$("CharactersLostInComments",this.Xul());this.wW.$("CharactersLostInTables",this.Orl(B,N))}this.wW.$("FuncStep",this.GFh);this.wW.$("FailureDetail",M.ULa(this.n9b()));this.wW.$("FailDetailHints",this.dxe(this.Xyh));
this.wW.$("FailDetailNaiveMerge",this.dxe(this.mGh));this.wW.$("FailDetailLcs",this.dxe(this.cEh));this.wW.$("ExtraDetails",this.dxe(this.Z2d));this.wW.$("Timeline",M.ULa(this.jQh));this.wW.$("ParagraphMergesCount",this.jJh);this.wW.$("ParagraphMergeDurations",M.ULa(this.Cbe));this.wW.$("MarkerInfo",M.ULa(this.iWa.mwi()));this.wW.$("Result",M.ULa(this.WFl()));return JSON.stringify(M.ULa(this.wW))}uTa(){return(new Date).getTime()}Msl(){const J=new u.a,F=this._state.input.VLa,A=this._state.runtime.MRa?
this._state.runtime.MRa.id:t.a.nil;let N=!1,B=0;for(;B<F.length;B++)if(F.J(B).id.equals(A)){N=!0;break}J.$("LastId",A.toString());J.$("Length",N?B+1:-1);return J}jDi(J){const F=new u.a;if(0===this._state.input.rca)return null;J=J?2===this._state.input.rca?this._state.input.nda:this._state.input.VLa:2===this._state.input.rca?this._state.input.VLa:this._state.input.nda;F.$("FirstId",J.J(0).id.toString());F.$("LastId",J.length?J.J(J.length-1).id.toString():null);F.$("Length",J.length);return F}uHl(){if(!this._state.runtime.hNi)return null;
const J=this._state.runtime.Kr,F=new u.a(0);J.forEach((A,N)=>{({value:A}=F.Ab(N.Jb.toString()));F.$(N.Jb.toString(),A+1);return!0});return F}sul(J,F,A){let N=null,B=null,E=null;const P=this._state.runtime.Kr;let T=0;try{E=new H.a(this.RD,this._state);N=D.b(J,F,A);B=new k.a;for(J=0;J<N.length;J++)if(!N.J(J).v3b.Ap(N.J(J).hPb,(V,I)=>V.equals(I))){const V=this.Kgi(N.J(J),E);T+=V;B.add(N.J(J))}N&&P.forEach((V,I)=>{if(393230===I.Jb){I=null;for(let R=0;R<N.length;R++)if(!B.contains(N.J(R))&&N.J(R).hPb.contains(V,
(ba,ha)=>ba===ha)){I=N.J(R);break}I&&(V=this.Kgi(I,E),B.add(I),T+=V)}return!0});return T}catch(V){return m.a.instance.xa(579190992,1,2,"Exception in GetCharactersLost: "+V.toString()),-1}}Yjl(J){let F,A,N,B,E;J.hG=T=>{if(750<this.uTa()-this._state.input.r9a)throw m.a.instance.xa(579190991,1,2,"Timed out while calculating characters lost: {0}",T),l.a.invalidOperation(T);};F=new r.a;A=new r.a;N=new r.a;B=new r.a;const P=new r.a;E=new r.a;try{if(J.pk){const T=J.pk.J(G.ChildNodeListMerge.WPe);let V,I;
V=J.Zu.J(G.ChildNodeListMerge.WPe)||T;I=J.Kr.J(G.ChildNodeListMerge.WPe)||T;this.C1f(T,R=>J.pk.J(R),F,B);this.C1f(V,R=>J.Zu.J(R)||J.pk.J(R),A,P);this.C1f(I,R=>J.Kr.J(R)||J.pk.J(R),N,E)}}catch(T){m.a.instance.xa(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+T.toString())}return{yGk:F,Oil:A,eJn:N,DGk:B,fJn:E}}Orl(J,F){try{let N=0;const B=this._state.runtime;var A=T=>B.Kr.J(T)||B.pk.J(T);const E=new k.a,P=this.wll(J,B,A,E);for(J=0;J<P.count;J++){let T=P.keys.J(J);const V=P.J(T);if(!E.contains(T)){let I=
this.TEi(B,A,E,T,V);if(-1!==I)N+=I;else return m.a.instance.xa(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(A=0;A<F.length;A++){let T=F.J(0);if(!E.contains(T)){let V=this.fAe(B.pk.J(T));if(-1===V)return m.a.instance.xa(573089734,1,2,"Error calculating characters lost in table deleted from base"),-1;N+=V}}return N}catch(N){return m.a.instance.xa(573089735,1,2,"Exception in GetAllTablesCharactersLost: "+N.toString()),-1}}TEi(J,F,A,N,B){J.hG("GetTableCharactersLost");
let E=0;B=this.RD.getPropertyObjectIds(B,c.a.jf);for(let R=0;R<B.length;R++){var P=F(B.J(R));P=this.RD.getPropertyObjectIds(P,c.a.jf);for(let ba=0;ba<P.length;ba++){var T=F(P.J(ba));if(J.pk.J(B.J(R))&&J.pk.J(P.J(ba))){var V=J.pk.J(P.J(ba));if(!V)return m.a.instance.xa(573089737,1,2,"Base cell unexpectedly null"),-1;T=this.RD.getPropertyObjectIds(V,c.a.jf);var I=J.Zu.J(P.J(ba))||J.pk.J(P.J(ba));I=this.RD.getPropertyObjectIds(I,c.a.jf);V=this.RD.getPropertyObjectIds(V,c.a.jf);T=D.b(T,I,V);for(V=0;V<
T.length;V++){I=T.J(V);const ha=this.oQl(J,F,A,I);if(-1===ha)return m.a.instance.xa(573089738,1,2,"Error getting characters lost for parition {0}",I.toString()),-1;E+=ha}}else{V=this.SQl(F,T,A);if(-1===V)return m.a.instance.xa(573089736,1,2,"Error getting text length of cell {0}",T.id.toString()),-1;E+=V}}}A.add(N);return E}oQl(J,F,A,N){let B=0;var E=new r.a,P=new r.a;const T=new u.a;new u.a;for(var V=0;V<N.v3b.length;V++){var I=J.pk.J(N.v3b.J(V));I=this.RD.getPropertyObjectIds(I,c.a.rP);if(1!==I.length)return m.a.instance.xa(573089739,
1,2,"Unexpected number of ContentNodes: {0}",I.length),-1;var R=J.pk.J(I.J(0));393230===R.Jb?E.add(R):393250===R.Jb&&T.add(I.J(0),R)}for(V=0;V<N.hPb.length;V++){I=F(N.hPb.J(V));I=this.RD.getPropertyObjectIds(I,c.a.rP);if(1!==I.length)return m.a.instance.xa(573089740,1,2,"Unexpected number of ContentNodes: {0}",I.length),-1;R=F(I.J(0));if(393230===R.Jb)P.add(R);else if(393250===R.Jb){R=this.TEi(J,F,A,I.J(0),R);if(-1===R)return m.a.instance.xa(573089741,1,2,"Error diffing table {0}",I.J(0).toString()),
-1;B+=R}}V=new H.a(this.RD,this._state);if(0<E.length&&0<P.length){E=V.doi(E,ba=>J.pk.J(ba),P,ba=>F(ba));if(-1===E)return m.a.instance.xa(573089742,1,2,"Problem diffing parition {0} with LCS",N.toString()),-1;B+=E}else if(0<E.length)for(N=0;N<E.length;N++)B+=this.RD.getPropertyString(E.J(N),c.a.wk).length+1;else if(0<P.length)for(N=0;N<P.length;N++)B+=this.RD.getPropertyString(P.J(N),c.a.wk).length+1;for(N=0;N<T.count;N++)if(E=T.keys.J(N),!A.contains(E)){P=this.fAe(T.J(E));if(-1===P)return m.a.instance.xa(573089743,
1,2,"Error getting length of table {0}",E.toString()),-1;B+=P}return B}SQl(J,F,A){let N=0;F=this.RD.getPropertyObjectIds(F,c.a.jf);for(let P=0;P<F.length;P++){var B=J(F.J(P));B=this.RD.getPropertyObjectIds(B,c.a.rP);if(1!==B.length)return m.a.instance.xa(573089744,1,2,"Unexpected number of ContentNodes: {0}",B.length),-1;var E=J(B.J(0));if(393230===E.Jb)N+=this.RD.getPropertyString(E,c.a.wk).length+1;else if(393250===E.Jb){E=this.fAe(E);if(-1===E)return m.a.instance.xa(573089745,1,2,"Problem finding text length of table {0}",
B.J(0).toString()),-1;N+=E;A.add(B.J(0))}}return N}fAe(J){this._state.runtime.hG("GetTextLengthOfTable");let F=0;const A=T=>this._state.runtime.Kr.J(T)||this._state.runtime.pk.J(T);J=this.RD.getPropertyObjectIds(J,c.a.jf);for(let T=0;T<J.length;T++){var N=A(J.J(T));N=this.RD.getPropertyObjectIds(N,c.a.jf);for(let V=0;V<N.length;V++){var B=A(N.J(V));B=this.RD.getPropertyObjectIds(B,c.a.jf);for(let I=0;I<B.length;I++){var E=A(B.J(I));E=this.RD.getPropertyObjectIds(E,c.a.rP);if(1!==E.length)return m.a.instance.xa(573089746,
1,2,"Unexpected number of ContentNodes: {0}",E.length),-1;var P=A(E.J(0));if(393230===P.Jb)F+=this.RD.getPropertyString(P,c.a.wk).length+1;else if(393250===P.Jb){P=this.fAe(P);if(-1===P)return m.a.instance.xa(573089747,1,2,"Error finding the text length of table {0}",E.J(0)),-1;F+=P}}}}return F}wll(J,F,A,N){const B=new u.a;for(let E=0;E<J.length;E++){let P=!1;F.Kr.J(J.J(E))&&(P=!0);const T=A(J.J(E)),V=this.RD.getPropertyObjectIds(T,c.a.jf);if(!P)for(let I=0;I<V.length;I++)if(F.Kr.J(V.J(I))){P=!0;
break}P?B.add(J.J(E),T):N.add(J.J(E))}return B}Kgi(J,F){return this.Jgi(J.v3b,J.hPb,F)}Jgi(J,F,A){const N=new r.a;for(var B=0;B<J.length;B++)N.add(this._state.runtime.pk.J(J.J(B)));J=new r.a;for(B=0;B<F.length;B++)J.add(this._state.runtime.Kr.J(F.J(B))||this._state.runtime.pk.J(F.J(B)));return A.doi(N,E=>this._state.runtime.pk.J(E),J,E=>this._state.runtime.Kr.J(E)||this._state.runtime.pk.J(E))}C1f(J,F,A,N){if(393227===J.Jb){J=this.RD.getPropertyObjectIds(J,c.a.jf);for(let B=0;B<J.length;B++){const E=
this.RD.getPropertyObjectIds(F(J.J(B)),c.a.jf);for(let P=0;P<E.length;P++){const T=this.RD.getPropertyObjectIds(F(E.J(P)),c.a.jf);for(let V=0;V<T.length;V++){const I=this.RD.getPropertyObjectIds(F(T.J(V)),c.a.rP);if(1!==I.length)return;const R=F(I.J(0));393230===R.Jb?A.add(I.J(0)):393250===R.Jb?N.add(I.J(0)):m.a.instance.xa(573089748,1,2,"Unsupported class id in GetCharactersLost: "+f.a[R.Jb])}}}}}D1f(J,F){J=this.RD.getPropertyObjectIds(J,c.a.jf);const A=new r.a;for(let N=0;N<J.length;N++){const B=
this.RD.getPropertyObjectIds(F(J.J(N)),c.a.rP);if(1!==B.length)return null;A.add(B.J(0))}return A}Xul(){let J=0;const F=this._state.runtime,A=F.Kr,N=E=>F.Kr.J(E)||F.pk.J(E);let B=null;F.hG=E=>{if(750<this.uTa()-this._state.input.r9a)throw m.a.instance.xa(573089749,1,2,"Timed out while calculating comment characters lost: {0}",E),l.a.invalidOperation(E);};try{A.forEach((E,P)=>{if(1074135127===P.Jb){E=this.D1f(P,N);var T=F.pk.J(P.id);if(T)T=this.D1f(T,I=>F.pk.J(I)),B||(B=new H.a(this.RD,this._state)),
J+=this.Jgi(T,E,B);else for(T=0;T<E.length;T++)J+=this.RD.getPropertyString(F.Kr.J(E.J(T)),c.a.wk).length+1}if(1074135126===P.Jb&&(E=this.RD.getPropertyObjectIds(P,c.a.jf).iG(),P=F.pk.J(P.id)))for(P=this.RD.getPropertyObjectIds(P,c.a.jf),T=0;T<P.length;T++)if(!E.contains(P.J(T))){var V=F.pk.J(P.J(T));V=this.D1f(V,I=>F.pk.J(I));for(let I=0;I<V.length;I++)J+=this.RD.getPropertyString(F.pk.J(V.J(I)),c.a.wk).length+1}return!0})}catch(E){return m.a.instance.xa(573089750,1,2,"Exception in GetCommentCharactersLost: "+
E.toString()),-1}return J}n9b(){return this.Qbb?this.Qbb.n9b():null}dxe(J){const F=new r.a;J.forEach(A=>{F.add(M.ULa(A.n9b()));return!0});return F.toArray()}WFl(){const J=new u.a;J.$("Succeeded",this._state.output.succeeded);J.$("Timeout",this._state.output.timeout);J.$("Crash",this._state.output.crash);J.$("MergedRevisions",this._state.output.NS?this._state.output.NS.length:-1);J.$("Duration",this.Pp-this._state.input.r9a);return J}static ULa(J){if(!J)return null;const F={};J.forEach((A,N)=>{F[A.toString()]=
N;return!0});return F}}Object(C.a)(M,"MergeLogger",null,[])},1597:function(C,L,b){C=b(0);var f=b(245),c=b(17),u=b(6),r=b(109),t=b(726),k=b(146),m=b(199),l=b(362),x=b(1290);class w{constructor(H,M,J){this.position=H;this.leader=M;this.val=J}equals(H){return this.position===H.position&&this.leader===H.leader&&this.val===H.val}toString(){return this.position.toString()}}Object(C.a)(w,"TabStop",null,[]);var G=b(1680);b.d(L,"a",function(){return D});class D extends x.a{constructor(){super()}get Dp(){return 20}get HF(){return 0}El(){const H=
super.El();H.$(t.a.Ra(c.a.wk),1);H.$(t.a.Ra(c.a.qn),1);H.$(t.a.Ra(c.a.Vi),1);H.$(t.a.Ra(u.a.ir),1);H.$(t.a.Ra(u.a.Qo),1);H.$(t.a.Ra(u.a.Ob),1);H.$(t.a.Ra(c.a.gLa),1);H.$(t.a.Ra(u.a.Fba),1);H.$(t.a.Ra(u.a.w8),1);H.$(t.a.Ra(c.a.E0),1);H.$(t.a.Ra(u.a.pga),1);H.$(t.a.Ra(u.a.d7),1);H.$(t.a.Ra(u.a.qga),1);H.$(t.a.Ra(u.a.Ffa),1);H.$(t.a.Ra(u.a.rga),1);H.$(t.a.Ra(u.a.Gfa),1);H.$(t.a.Ra(u.a.nha),1);H.$(t.a.Ra(u.a.cia),1);H.$(t.a.Ra(u.a.dia),1);H.$(t.a.Ra(u.a.rda),1);H.$(t.a.Ra(u.a.Bv),1);H.$(t.a.Ra(u.a.uV),
1);H.$(t.a.Ra(u.a.vV),1);H.$(t.a.Ra(u.a.kM),1);H.$(t.a.Ra(r.a.wH),6);H.$(t.a.Ra(r.a.YDa),6);H.$(t.a.Ra(u.a.SCb),7);H.$(t.a.Ra(r.a.wH),6);H.$(t.a.Ra(u.a.y6g),2);H.$(t.a.Ra(r.a.t$h),2);H.$(t.a.Ra(r.a.sdj),2);H.$(t.a.Ra(u.a.X9a),2);H.$(t.a.Ra(u.a.fvb),2);H.$(t.a.Ra(u.a.uLa),2);H.$(t.a.Ra(u.a.Joa),2);H.$(t.a.Ra(u.a.gvb),2);H.$(t.a.Ra(u.a.hvb),2);H.$(t.a.Ra(u.a.lockNotFullySupportedParagraphInBlockContentControl),2);return H}kG(H,M){if(M===t.a.Ra(c.a.wk)||M===t.a.Ra(c.a.qn)||M===t.a.Ra(c.a.Vi)||M===t.a.Ra(u.a.ir)||
M===t.a.Ra(u.a.Qo)||M===t.a.Ra(u.a.Ob)||M===t.a.Ra(c.a.gLa)||M===t.a.Ra(u.a.Fba)||M===t.a.Ra(u.a.w8)||M===t.a.Ra(c.a.E0)||M===t.a.Ra(u.a.pga)||M===t.a.Ra(u.a.d7)||M===t.a.Ra(u.a.qga)||M===t.a.Ra(u.a.Ffa)||M===t.a.Ra(u.a.rga)||M===t.a.Ra(u.a.Gfa)||M===t.a.Ra(u.a.nha)||M===t.a.Ra(u.a.cia)||M===t.a.Ra(u.a.dia)||M===t.a.Ra(u.a.rda)||M===t.a.Ra(u.a.Bv)||M===t.a.Ra(u.a.CQ)){var J=H.wo.value.Uv,F=H.wo.value.We;M=H.vg.value.We;if(H.jm.runtime.O2a.contains(J.id))return k.a.instance.xa(18989579,1,3,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",
J.id),!0;if(H.jm.runtime.Ka.Cmb(1000005)&&this.$wn(H,M,F))return H.Gl=M.AF(),D.CUh(H),D.xie(H.jm,H.Mc,F),!0;const A=new m.a;A.add(J);J=new m.a;J.add(F);F=new m.a;F.add(M);if(!({zm:M}=D.ULj(H.jm,A,F,J)).returnValue)return H.Qgh=!0,H.Gl=null,!1;D.CUh(H);H.Gl=M.Rf(0).Wj;return!0}return M===t.a.Ra(u.a.uV)||M===t.a.Ra(u.a.vV)||M===t.a.Ra(u.a.kM)?(this.bHn(H),H.hg.add(t.a.Ra(u.a.uV)),H.hg.add(t.a.Ra(u.a.vV)),H.hg.add(t.a.Ra(u.a.kM)),!0):!1}$wn(H,M,J){M=H.Mc.getPropertyString(M,u.a.CQ);H=H.Mc.getPropertyString(J,
u.a.CQ);return M||H?!0:!1}bHn(H){const M=H.Mc,J=H.Gl;var F=H.wo.value.We,A=H.vg.value.We;H=this.B7f(H.wo.value.Uv,M);A=this.B7f(A,M);F=this.B7f(F,M);({Dwm:F,Ewm:H,Fwm:A}=this.YFl(H,A,F));F.length?(M.setPropertyUint32s(J,u.a.kM,F),M.setPropertyUint32s(J,u.a.uV,H),M.setPropertyUint32s(J,u.a.vV,A)):this.a6m(J)}B7f(H,M){const J=M.getPropertyUint32s(H,u.a.kM),F=M.getPropertyUint32s(H,u.a.uV);H=M.getPropertyUint32s(H,u.a.vV);M=new m.a;if(!J)return M;for(let A=0;A<J.length;++A)M.add(new w(J.J(A),F.J(A),
H.J(A)));return M}YFl(H,M,J){({icj:M,jcj:B,kcj:N}=this.Xvi(H,M));let F,A;({icj:J,jcj:F,kcj:A}=this.Xvi(H,J));H=this.rVl(H,B,N,F,A);var N=this.qVl(H,M,J);H=new m.a;M=new m.a;var B=new m.a;for(J=0;J<N.length;++J)H.add(N.J(J).position),M.add(N.J(J).leader),B.add(N.J(J).val);return{Dwm:H,Ewm:M,Fwm:B}}Xvi(H,M){let J,F,A;J=new m.a;F=new l.a;A=new l.a;let N,B;for(N=B=0;N<H.length&&B<M.length;)H.J(N).position===M.J(B).position?(H.J(N).equals(M.J(B))||A.$(H.J(N).position,M.J(B)),++N,++B):H.J(N).position<M.J(B).position?
(F.$(H.J(N).position,H.J(N)),++N):(J.add(M.J(B)),++B);for(;N<H.length;)F.$(H.J(N).position,H.J(N)),++N;for(;B<M.length;)J.add(M.J(B)),++B;return{icj:J,jcj:F,kcj:A}}rVl(H,M,J,F,A){const N=new m.a;for(let B=0;B<H.length;++B){const E=H.J(B).position;M.Na(E)||(J.Na(E)?N.add(J.J(E)):F.Na(E)||(A.Na(E)?N.add(A.J(E)):N.add(H.J(B))))}return N}qVl(H,M,J){M=this.m4i(M,J);return this.m4i(H,M)}m4i(H,M){const J=new m.a;let F,A;for(F=A=0;F<H.length&&A<M.length;)H.J(F).position<=M.J(A).position?(J.add(H.J(F)),H.J(F).position===
M.J(A).position&&++A,++F):J.add(M.J(A++));for(;F<H.length;)J.add(H.J(F++));for(;A<M.length;)J.add(M.J(A++));return J}a6m(H){H.removeProperty(u.a.kM);H.removeProperty(u.a.uV);H.removeProperty(u.a.vV)}static ai(){return new D}static get instance(){return D.Gh.value}static CUh(H){H.hg.add(t.a.Ra(c.a.wk));H.hg.add(t.a.Ra(c.a.qn));H.hg.add(t.a.Ra(c.a.Vi));H.hg.add(t.a.Ra(u.a.ir));H.hg.add(t.a.Ra(u.a.Qo));H.hg.add(t.a.Ra(u.a.Ob));H.hg.add(t.a.Ra(c.a.gLa));H.hg.add(t.a.Ra(u.a.Fba));H.hg.add(t.a.Ra(u.a.w8));
H.hg.add(t.a.Ra(c.a.E0));H.hg.add(t.a.Ra(u.a.pga));H.hg.add(t.a.Ra(u.a.d7));H.hg.add(t.a.Ra(u.a.qga));H.hg.add(t.a.Ra(u.a.Ffa));H.hg.add(t.a.Ra(u.a.rga));H.hg.add(t.a.Ra(u.a.Gfa));H.hg.add(t.a.Ra(u.a.nha));H.hg.add(t.a.Ra(u.a.cia));H.hg.add(t.a.Ra(u.a.dia));H.hg.add(t.a.Ra(u.a.rda));H.hg.add(t.a.Ra(u.a.Bv));H.hg.add(t.a.Ra(u.a.CQ))}static ULj(H,M,J,F){return(new G.a(H,M,J,F)).WUc()}static xie(H,M,J){J=M.getPropertyObjectIds(J,c.a.qn);for(let A=0;A<J.length;A++){var F=H.runtime.Kr.J(J.Rf(A));if(F&&
(F=M.getPropertyObjectId(F,u.a.nd))){H.runtime.qTc.add(F);break}}}}D.Gh=new f.a(D.ai);Object(C.a)(D,"ParagraphNodeComplexMerge",x.a,[])},1679:function(C,L,b){b.r(L);b.d(L,"MarkerValidation",function(){return u});C=b(0);var f=b(362),c=b(1596);class u{constructor(){this.uEe=this.bJc=this.aJc=this.$Ic=0}mwi(){const r=new f.a(0);r.$("InvalidBookmarks",this.$Ic);r.$("InvalidComments",this.aJc);r.$("InvalidContentControls",this.bJc);0!==this.uEe&&r.$("InvalidMarkerType",this.uEe);return r}jJi(){return 0<
this.$Ic||0<this.aJc||0<this.bJc||0!==this.uEe?!0:!1}toString(){return JSON.stringify(c.a.ULa(this.mwi()))}}Object(C.a)(u,"MarkerValidation",null,[])},1680:function(C,L,b){b.d(L,"a",function(){return k});C=b(0);var f=b(146),c=b(910),u=b(234),r=b(1459),t=b(1377);class k{constructor(m,l,x,w,G=null,D=null,H=null,M=null){this.Ld=m;this.nJ=l;this.yNa=x;this.nQa=w;this.Tfk=G;this.S8j=D;this.Vqk=H;this.XEa=M||this.XQf()}XQf(){return m=>!!this.Ld.runtime.Ka&&this.Ld.runtime.Ka.isFeatureEnabled(m)}N0k(){return()=>
this.Ld.runtime.Ka}aYf(){return!!this.Ld.runtime.pk.J(u.a.DO)}gEj(){let m;if(1===this.Ld.input.source||2===this.Ld.input.source)m=129;else if(4===this.Ld.input.source||3===this.Ld.input.source)m=59;else if(5===this.Ld.input.source)m=204;else return!1;return this.aYf()&&this.XEa(m)}dGj(m,...l){return String.format.apply(null,[m].concat(l))}Kye(m){const {ParagraphMerge:l}=b(1722);let x=this.Ld,w=this.yNa,G=this.nQa;m||(x=this.Tfk||this.Ld,w=this.S8j||w,G=this.Vqk||G);var D=t.a.g$f(this.nJ);const H=
t.a.g$f(w),M=t.a.g$f(G);D=this.dGj("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",x.input.source,x.runtime.MRa.id,x.runtime.Tte,x.runtime.c3e,D.Dr(),H.Dr(),M.Dr());return m?{returnValue:new r.a(x,this.nJ,w,G,this.XQf(),new c.a),Dr:D}:{returnValue:new l(x,this.nJ,w,G,this.XQf(),this.N0k(),new c.a),Dr:D}}WUc(){this.Ld.logger.cnn();var m=this.gEj();var l=({Dr:w}=this.Kye(m)).returnValue;f.a.instance.xa(18994389,
1,3,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",m,w);this.Ld.logger.A0("ParagraphMergeSelector initialization");m?this.Ld.logger.RXe(1):this.Ld.logger.RXe(2);let x=({zm:l}=l.WUc()).returnValue;this.Ld.logger.q1g();var w=!x;m=!!this.Ld.runtime.pk.J(u.a.DO)&&(m&&!x||!m);w&&({Dr:w,returnValue:l}=this.Kye(!1),{zm:l,returnValue:x}=l.WUc(),f.a.instance.xa(18994390,1,x?3:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",x,w));m&&(w=new c.a,t.a.fbn(this.Ld,w));this.Ld.logger.A0("ParagraphMergeSelector finalization");
return{returnValue:x,zm:l}}v_d(m,l){let x,w,G;const D=this.gEj()&&this.XEa(205);let H=({Dr:G}=this.Kye(D)).returnValue,M=({Bsb:x,KCa:w}=H.v_d(m,l)).returnValue;f.a.instance.xa(18994391,1,3,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",D,G);D&&!M&&H.FXg&&({Dr:G,returnValue:H}=this.Kye(!1),{Bsb:x,KCa:w,returnValue:M}=H.v_d(m,l),f.a.instance.xa(18994392,1,M?3:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",M,G));return{returnValue:M,
Bsb:x,KCa:w}}}Object(C.a)(k,"ParagraphMergeSelector",null,[1780])},1681:function(C,L,b){b.r(L);b.d(L,"SurfaceStringTokenStringGenerator",function(){return c});C=b(0);var f=b(1401);class c extends f.a{constructor(u){super(u);this.Pa=u}apply(u,r,t,k,m,l,x){null==l&&(l=u.SFi(m,r));x=f.a.vVh(u,l,this.Pa.score,t,k,x);return{PYd:l,sjd:x}}}c.tjd=0;Object(C.a)(c,"SurfaceStringTokenStringGenerator",f.a,[])},1682:function(C,L,b){b.r(L);b.d(L,"QueryTokenStringGenerator",function(){return u});C=b(0);var f=b(1401),
c=b(1289);class u extends f.a{constructor(r){super(r);this.Pa=r}apply(r,t,k,m,l,x,w){t=this.Pa.query.load(t,null);l=0;let G=null;this.Pa.query.Tca===c.Annotations.zLa?t&&(G=this.Pa.name):((G=this.Pa.name)&&(G+="_"),G+=this.Pa.hf.Noa(this.Pa.query.Tca,t));null!=G&&(l=f.a.vVh(r,G,this.Pa.score,k,m,l));return{PYd:x,sjd:w+l}}}u.tjd=1;Object(C.a)(u,"QueryTokenStringGenerator",f.a,[])},1683:function(C,L,b){b.r(L);b.d(L,"FuzzyMatchTokenStringGenerator",function(){return c});C=b(0);var f=b(1401);class c extends f.a{constructor(u){super(u);
this.Pa=u}apply(u,r,t,k,m,l,x){null==l&&(l=u.SFi(m,r));u=this.Pa.wli.lsm(l);if(this.Pa.Hbj)for(var w of u)if(!w.NU&&w.Fue)return{PYd:l,sjd:x};w=0;for(const G of u)if(G.NU&&!({vJf:w}=this.CZh(G,!0,t,k,w)).returnValue)return{PYd:l,sjd:x};if(this.Pa.dMi)for(const G of u)if(!({vJf:w}=this.CZh(G,!1,t,k,w)).returnValue)break;return{PYd:l,sjd:x}}CZh(u,r,t,k,m){let l;r?(r=0,l=u.Fue?1:0):(r=u.Fue?1:0,l=u.count-r);for(let x=0;x<l;++x)if(f.a.wVh(u.VEb+r+x,this.Pa.score,t,k),++m,0<this.Pa.Fzg&&m>=this.Pa.Fzg)return{returnValue:!1,
vJf:m};return{returnValue:!0,vJf:m}}}c.tjd=2;Object(C.a)(c,"FuzzyMatchTokenStringGenerator",f.a,[])},1713:function(C,L,b){C=b(0);var f=b(6),c=b(245),u=b(1290);class r extends u.a{constructor(){super()}get Dp(){return 2}get HF(){return 7}static ai(){return new r}static get instance(){return r.Gh.value}}r.Gh=new c.a(r.ai);Object(C.a)(r,"AppBindingNodeComplexMerge",u.a,[]);var t=b(17),k=b(726),m=b(146),l=b(1341);class x extends u.a{constructor(){super()}get Dp(){return 3}get HF(){return 7}El(){const tb=
super.El();tb.$(k.a.Ra(t.a.hca),1);return tb}kG(tb,yb){if(yb===k.a.Ra(t.a.hca)){const fc=tb.Gl;var rc=tb.Mc;m.a.instance.xa(6633221,1,3,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",fc.id,fc.Jb,yb);yb=rc.getPropertyMilliseconds(tb.vg.value.We,t.a.hca);rc=rc.getPropertyMilliseconds(tb.wo.value.We,t.a.hca);yb<rc&&this.vvl(tb);tb.hg.add(k.a.Ra(t.a.hca));return!0}m.a.instance.xa(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
tb.vg.value.We.id,yb);return!1}vvl(tb){this.P9m(tb.wo.value.We,tb.Gl);this.N6f(tb,f.a.Igd);this.N6f(tb,f.a.qje);this.N6f(tb,f.a.mje)}N6f(tb,yb){var rc=tb.Mc,fc=tb.Gl;if(rc.hasProperty(fc,yb)&&(yb=rc.getPropertyObjectIds(fc,yb))&&yb.length)for(rc=tb.jm.runtime.Kr,tb=tb.jm.runtime.zm,fc=0;fc<yb.length;fc++){const uc=yb.J(fc);if(!rc.Na(uc))continue;const Uc=rc.J(uc).AF();tb.add(uc,new l.a(Uc,!1))}}static ai(){return new x}static get instance(){return x.Gh.value}}x.Gh=new c.a(x.ai);Object(C.a)(x,"AppNodeComplexMerge",
u.a,[]);class w extends u.a{constructor(){super()}get Dp(){return 4}get HF(){return 7}static ai(){return new w}static get instance(){return w.Gh.value}}w.Gh=new c.a(w.ai);Object(C.a)(w,"AppPropNodeComplexMerge",u.a,[]);class G extends u.a{constructor(){super()}get Dp(){return 5}get HF(){return 7}static ai(){return new G}static get instance(){return G.Gh.value}}G.Gh=new c.a(G.ai);Object(C.a)(G,"AppRefNodeComplexMerge",u.a,[]);var D=b(362),H=b(577),M=b(199),J=b(16);class F{constructor(tb,yb){this.id=
tb;this.Iyn=yb}}Object(C.a)(F,"IdAndTime",null,[]);class A extends u.a{constructor(){super()}get Dp(){return 6}El(){const tb=super.El();tb.$(k.a.Ra(f.a.ZQa),1);return tb}kG(tb,yb){if(yb===k.a.Ra(f.a.ZQa)){const rc=tb.Gl,fc=tb.Mc;m.a.instance.xa(6633224,1,3,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",rc.id,rc.Jb,yb);yb=fc.getPropertyObjectIds(tb.vg.value.Uv,f.a.ZQa);const uc=fc.getPropertyObjectIds(tb.vg.value.We,f.a.ZQa),Uc=fc.getPropertyObjectIds(tb.wo.value.We,
f.a.ZQa);yb=this.Qvm(tb,yb,uc,Uc);0<yb.length?fc.setPropertyObjectIds(rc,f.a.ZQa,yb):rc.removeProperty(f.a.ZQa);tb.hg.add(k.a.Ra(f.a.ZQa));return!0}m.a.instance.xa(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.vg.value.We.id,yb);return!1}Qvm(tb,yb,rc,fc){const uc=this.O6a(yb,rc,fc),Uc=yb.iG(),tc=rc.iG(),Tb=fc.iG();yb=u.a.filter(uc,Zb=>!Uc.contains(Zb)&&tc.contains(Zb));rc=u.a.filter(uc,Zb=>!Uc.contains(Zb)&&Tb.contains(Zb));
if(!yb.length||!rc.length)return uc;const qb=new D.a;yb.forEach(Zb=>{const ec=new F(Zb,this.iti(tb,Zb,!1));this.fti(tb,Zb,!1).forEach(zc=>{qb.add(zc,ec);return!0});return!0});const Jb=new H.a;rc.forEach(Zb=>{const ec=this.iti(tb,Zb,!0);this.fti(tb,Zb,!0).forEach(zc=>qb.Na(zc)?(Jb.add(qb.J(zc).Iyn>=ec?Zb:qb.J(zc).id),!1):!0);return!0});return u.a.filter(uc,Zb=>!Jb.contains(Zb))}iti(tb,yb,rc){return(yb=this.STa(tb,yb,rc))?tb.Mc.getPropertyMilliseconds(yb,t.a.hca):0}STa(tb,yb,rc){tb=rc?tb.jm.runtime.Kr:
tb.jm.runtime.Zu;return tb.Na(yb)?tb.J(yb):null}fti(tb,yb,rc){const fc=new M.a,uc=new H.a,Uc=tb.Mc;yb=this.STa(tb,yb,rc);var tc=this.TCi(Uc,yb);if(tc)for(fc.add(tc),uc.add(tc),yb=Uc.getPropertyObjectIds(yb,f.a.Igd),tc=0;yb&&tc<yb.length;tc++){const Tb=this.TCi(Uc,this.STa(tb,yb.J(tc),rc));if(!Tb)break;uc.contains(Tb)||(fc.add(Tb),uc.add(Tb))}return fc}TCi(tb,yb){if(!tb.hasProperty(yb,f.a.X2b)||!tb.hasProperty(yb,f.a.Jgd)||!tb.hasProperty(yb,f.a.Kgd))return null;const rc=tb.getPropertyString(yb,f.a.X2b),
fc=tb.getPropertyString(yb,f.a.Jgd);tb=tb.getPropertyString(yb,f.a.Kgd);return J.a.gw(rc+";"+fc+";"+tb)}static ai(){return new A}static get instance(){return A.Gh.value}}A.Gh=new c.a(A.ai);Object(C.a)(A,"AppsNodeComplexMerge",u.a,[]);class N extends u.a{constructor(){super()}get Dp(){return 36}El(){const tb=super.El();tb.$(k.a.Ra(f.a.Gvb),1);return tb}kG(tb,yb){m.a.instance.xa(51430790,1,3,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",yb);if(yb===k.a.Ra(f.a.Gvb)){var rc=tb.vg.value.We,
fc=tb.wo.value.We;yb=tb.Gl;var uc=tb.Mc.getPropertyStrings(tb.vg.value.Uv,f.a.Gvb);rc=tb.Mc.getPropertyStrings(rc,f.a.Gvb);fc=tb.Mc.getPropertyStrings(fc,f.a.Gvb);uc=this.O6a(uc,rc,fc);tb.Mc.setPropertyStrings(yb,f.a.Gvb,uc);tb.hg.add(k.a.Ra(f.a.Gvb));return!0}return!1}static ai(){return new N}static get instance(){return N.Gh.value}}N.Gh=new c.a(N.ai);Object(C.a)(N,"AutoSaveParametersNodeComplexMerge",u.a,[]);class B extends u.a{constructor(){super()}get Dp(){return 44}El(){const tb=super.El();tb.$(k.a.Ra(t.a.jf),
1);return tb}kG(tb,yb){const rc=tb.jm.runtime.Ka;if(yb===k.a.Ra(t.a.jf))return m.a.instance.xa(589608865,1,3,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",tb.Gl.id,tb.Gl.Jb,yb),rc.hq(210),rc.isFeatureEnabled(210)?this.Tvm(tb,yb):this.jwm(tb,yb),!0;m.a.instance.xa(589608912,1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",tb.vg.value.We.id,yb);return!1}Tvm(tb,
yb){const rc=k.a.MX(yb),fc=tb.Mc;var uc=fc.getPropertyObjectIds(tb.vg.value.Uv,rc),Uc=fc.getPropertyObjectIds(tb.vg.value.We,rc),tc=fc.getPropertyObjectIds(tb.wo.value.We,rc);tc=B.pSl(tb,Uc,tc);uc=this.O6a(uc,Uc,tc);Uc=tb.Gl;0<uc.length?fc.setPropertyObjectIds(Uc,rc,uc):Uc.removeProperty(rc);tb.hg.add(yb)}static ai(){return new B}static get instance(){return B.Gh.value}static pSl(tb,yb,rc){const fc=new M.a,uc=new D.a;yb.forEach(Uc=>{const tc=tb.jm.runtime.Zu.J(Uc);tc&&uc.add(tc.Cy(f.a.Ut).toString(),
Uc);return!0});rc.forEach(Uc=>{var tc=tb.jm.runtime.Kr.J(Uc);tc?(tc=tc.Cy(f.a.Ut).toString(),uc.Na(tc)&&uc.get(tc)!==Uc?m.a.instance.xa(557061773,1,3,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):fc.add(Uc)):fc.add(Uc);return!0});return fc}}B.Gh=new c.a(B.ai);Object(C.a)(B,"BookmarkContainerNodeComplexMerge",u.a,[]);var E=b(1542);class P extends u.a{constructor(){super();this.V$a=null}get Dp(){return 41}vmg(tb){null==this.V$a&&
(tb?(tb.hq(18),this.V$a=tb.isFeatureEnabled(18)):(this.V$a=!1,m.a.instance.xa(527213633,1,2,"Feature helper is null")));return this.V$a}El(){const tb=super.El();tb.$(k.a.Ra(f.a.vCb),1);tb.$(k.a.Ra(f.a.Ut),1);tb.$(k.a.Ra(f.a.fG),1);tb.$(k.a.Ra(f.a.QU),1);return tb}kG(tb,yb){if(yb===k.a.Ra(f.a.vCb))return tb.hg.add(k.a.Ra(f.a.vCb)),!0;if(yb===k.a.Ra(f.a.Ut))return tb.hg.add(k.a.Ra(f.a.Ut)),!0;if(!this.vmg(tb.jm.runtime.Ka)&&(yb===k.a.Ra(f.a.fG)||yb===k.a.Ra(f.a.QU))){var rc=tb.vg.value.We,fc=tb.wo.value.We,
uc=tb.Gl;var Uc=(new Date).toString();const tc=tb.jm.runtime.Ka;tc.hq(210);if(tc.isFeatureEnabled(210))return m.a.instance.xa(556656202,1,3,"BookmarkNodeComplexMerge: Started at [timestamp: {0}]",Uc),uc=this.PLj(tb,rc,fc,uc,k.a.Ra(f.a.fG))&&this.PLj(tb,rc,fc,uc,k.a.Ra(f.a.QU)),uc||(m.a.instance.xa(557061774,1,1,"BookmarkNodeComplexMerge: Failed to merge Bookmark [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",tb.vg.value.We.id,yb),tb.jm.logger.Fg(Object.assign(new E.a,{Dp:this.Dp,dNc:tb.vg.value.Uv.Jb,
QNd:yb,cId:this.RNd.J(yb)}))),Uc=(new Date).toString(),m.a.instance.xa(556656203,1,3,"BookmarkNodeComplexMerge: Ended at [timestamp: {0}]",Uc),uc;Uc=tb.Mc.getPropertyString(rc,f.a.fG);yb=tb.Mc.getPropertyString(fc,f.a.fG);Uc=this.le(Uc)?yb:this.le(yb)?Uc:null;if(this.le(Uc))return!1;tb.Mc.setPropertyString(uc,f.a.fG,Uc);tb.hg.add(k.a.Ra(f.a.fG));rc=tb.Mc.getPropertyString(rc,f.a.QU);fc=tb.Mc.getPropertyString(fc,f.a.QU);fc=this.le(rc)?yb:this.le(fc)?rc:null;if(this.le(fc))return!1;tb.Mc.setPropertyString(uc,
f.a.QU,fc);tb.hg.add(k.a.Ra(f.a.QU));return!0}return!1}PLj(tb,yb,rc,fc,uc){const Uc=k.a.MX(uc);yb=tb.Mc.getPropertyObjectId(yb,Uc);rc=tb.Mc.getPropertyObjectId(rc,Uc);var tc=tb.vg.value.We.id;m.a.instance.xa(557061775,1,3,"BookmarkNodeComplexMerge: Merging [favoredBookmarkParaId: {0}] and [conflictBookmarkParaId: {1}]",yb,rc);const Tb=this.uTi(tb,yb,tc,k.a.Ra(f.a.fG)===uc,!0);tc=this.uTi(tb,rc,tc,k.a.Ra(f.a.fG)===uc,!1);if(!Tb&&!tc||Tb&&tc&&!yb.equals(rc))return m.a.instance.xa(557061776,1,1,"BookmarkNodeComplexMerge: Failed to merge BookmarkParaIds [Id: {0}] and [Id: {1}] for [Type: {3}] because either no BookmarkParagraph Start/End is found, or two BookmarkParagraph Start/End are found in different paragraphs respectively",
yb,rc,k.a.Ra(f.a.fG)===uc?"StartBookmarkParaId":"EndBookmarkParaId"),!1;tb.Mc.setPropertyObjectId(fc,Uc,Tb?yb:rc);tb.hg.add(uc);m.a.instance.xa(557061777,1,3,"BookmarkNodeComplexMerge: Successfully completed custom merge on bookmarks");return!0}uTi(tb,yb,rc,fc,uc){if(!yb)return m.a.instance.xa(557061778,1,1,"BookmarkNodeComplexMerge: paragraphId is null, skip this paragraph"),!1;const Uc=tb.jm.runtime.zm;var tc=Uc.get(yb),Tb=null;if(tc&&tc.Wj)Tb=tc.Wj;else{tc=tb.jm.runtime.Zu.get(yb)||tb.jm.runtime.pk.J(yb);
if(!tc)return m.a.instance.xa(557061779,1,3,"BookmarkNodeComplexMerge: paragraphNode or paragraph object is null, skip this paragraph"),!1;Tb=tc}if(!Tb.hasProperty(t.a.qn))return m.a.instance.xa(557061661,1,3,"BookmarkNodeComplexMerge: Paragraph does not paragraph properties, skip this paragraph"),!1;tc=tb.Mc.getPropertyObjectIds(Tb,t.a.qn);if(!tc)return m.a.instance.xa(557061662,1,3,"BookmarkNodeComplexMerge: textRunFormattingGuids is null, skip this paragraph"),!1;Tb=!1;for(let ec=0;ec<tc.length;ec++){const zc=
tb.jm.runtime.pk.J(tc.J(ec));if(zc&&zc.hasProperty(f.a.Jp)&&rc.equals(tb.Mc.getPropertyObjectId(zc,f.a.Nhb))){Tb=!0;if(!fc&&44===tb.Mc.getPropertyUint32(zc,f.a.Jp))return m.a.instance.xa(557061780,1,3,"BookmarkNodeComplexMerge: Paragraph contains BookMarkStart Placeholder but we are looking for BookmarkEnd Placeholder, skip this paragraph"),!1;if(fc&&45===tb.Mc.getPropertyUint32(zc,f.a.Jp))return m.a.instance.xa(557061781,1,3,"BookmarkNodeComplexMerge: Paragraph contains BookmarkEnd Placeholder but we are looking for BookMarkStart Placeholder, skip this paragraph"),
!1}}if(!Tb)return m.a.instance.xa(557061782,1,3,"BookmarkNodeComplexMerge: Paragraph does not contain BookMark PlaceholderKind, skip this paragraph"),!1;let qb=null,Jb=!0;(uc?tb.jm.runtime.Zu:tb.jm.runtime.Kr).forEach((ec,zc)=>{393229===zc.Jb&&tb.Mc.getPropertyObjectIds(zc,t.a.rP).iG().contains(yb)&&(qb=zc,Jb=!1);return Jb});if(!qb)return m.a.instance.xa(557061783,1,3,"BookmarkNodeComplexMerge: Paragraph does not map to an OE, skip this paragraph"),!1;let Zb=null;Jb=!0;Uc.forEach((ec,zc)=>{393241===
zc.Wj.Jb&&tb.Mc.getPropertyObjectIds(zc.Wj,t.a.jf).iG().contains(qb.id)&&(Zb=zc.Wj,Jb=!1);return Jb});return Zb?!0:(m.a.instance.xa(557061784,1,3,"BookmarkNodeComplexMerge: OE does not map to an OGN, skip this paragraph"),!1)}le(tb){return tb&&tb.length?!1:!0}static ai(){return new P}static get instance(){return P.Gh.value}}P.Gh=new c.a(P.ai);Object(C.a)(P,"BookmarkNodeComplexMerge",u.a,[]);class T extends u.a{constructor(){super();this.XEe=!1}get Dp(){return 7}El(){const tb=super.El();tb.$(k.a.Ra(t.a.jf),
1);return tb}kG(tb,yb){if(yb===k.a.Ra(t.a.jf)){const uc=tb.Gl,Uc=tb.Mc;var rc=tb.jm.runtime.Ka;rc&&(this.XEe=rc.isFeatureEnabled(121));m.a.instance.xa(4511579,1,3,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",uc.id,uc.Jb,yb);yb=Uc.getPropertyObjectIds(tb.vg.value.Uv,t.a.jf);rc=Uc.getPropertyObjectIds(tb.vg.value.We,t.a.jf);var fc=Uc.getPropertyObjectIds(tb.wo.value.We,t.a.jf);yb=this.awm(yb,rc,fc);if(this.XEe&&0<yb.length){rc=new Sys.StringBuilder;
for(fc=0;fc<yb.length;fc++)rc.append(yb.J(fc).toString()+",");m.a.instance.xa(559710276,1,3,"Merge result for CommentContentNode {0}: {1}",uc.id,rc.toString())}0<yb.length?Uc.setPropertyObjectIds(uc,t.a.jf,yb):uc.removeProperty(t.a.jf);tb.hg.add(k.a.Ra(t.a.jf));return!0}m.a.instance.xa(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.vg.value.We.id,yb);return!1}awm(tb,yb,rc){const fc=new M.a,uc=new D.a(0);
this.yjl(tb,rc,fc,uc);return this.w$k(yb,uc,fc)}yjl(tb,yb,rc,fc){tb=tb||new M.a;yb=yb||new M.a;tb.forEach(uc=>{fc.$(uc,1);return!0});yb.forEach(uc=>{fc.Ab(uc).returnValue?fc.$(uc,2):(fc.$(uc,0),rc.add(uc));return!0})}w$k(tb,yb,rc){tb=tb||new M.a;const fc=new M.a,uc=new M.a,Uc=new M.a;tb.forEach(tc=>{let Tb=!0,qb;({value:qb}=yb.Ab(tc)).returnValue&&(0===qb?yb.$(tc,2):1===qb&&(Tb=!1));Tb?fc.add(tc):this.XEe&&uc.add(tc);return!0});rc.forEach(tc=>{let Tb=!1,qb;({value:qb}=yb.Ab(tc)).returnValue?0===qb&&
(Tb=!0,yb.$(tc,2)):m.a.instance.xa(4511585,1,3,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",tc);Tb?fc.add(tc):this.XEe&&Uc.add(tc);return!0});this.a1i(uc,"Favored");this.a1i(Uc,"Unfavored");return fc}a1i(tb,yb){if(tb.length){var rc=new Sys.StringBuilder;for(let fc=0;fc<tb.length;fc++)rc.append(tb.J(fc).toString()+",");m.a.instance.xa(561637572,1,3,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",
yb,rc.toString())}}static ai(){return new T}static get instance(){return T.Gh.value}}T.Gh=new c.a(T.ai);Object(C.a)(T,"CommentContentNodeComplexMerge",u.a,[]);class V extends u.a{constructor(){super()}get Dp(){return 8}El(){const tb=super.El();tb.$(k.a.Ra(f.a.S6),3);tb.$(k.a.Ra(f.a.IF),3);tb.$(k.a.Ra(f.a.WAc),2);tb.$(k.a.Ra(f.a.commentId),2);tb.$(k.a.Ra(f.a.RNf),2);tb.$(k.a.Ra(f.a.RGa),2);tb.$(k.a.Ra(f.a.KRa),1);tb.$(k.a.Ra(f.a.Qmb),1);tb.$(k.a.Ra(f.a.rob),1);tb.$(k.a.Ra(f.a.Aaa),1);tb.$(k.a.Ra(f.a.uH),
1);tb.$(k.a.Ra(f.a.VAc),2);tb.$(k.a.Ra(f.a.jld),2);tb.$(k.a.Ra(f.a.W4b),2);tb.$(k.a.Ra(f.a.Mne),2);tb.$(k.a.Ra(f.a.cK),1);tb.$(k.a.Ra(t.a.jf),0);tb.$(k.a.Ra(f.a.gE),0);return tb}kG(tb,yb){if(yb===k.a.Ra(f.a.cK)){var rc=tb.Mc.getPropertyString(tb.wo.value.We,f.a.cK);this.le(rc)?tb.Gl.removeProperty(f.a.cK):tb.Gl.c1(f.a.cK,rc);return!0}if(yb!==k.a.Ra(f.a.KRa)&&yb!==k.a.Ra(f.a.Qmb)&&yb!==k.a.Ra(f.a.rob)&&yb!==k.a.Ra(f.a.uH)&&yb!==k.a.Ra(f.a.Aaa))return!1;var fc=tb.vg.value.We,uc=tb.wo.value.We;rc=tb.Gl;
if(yb===k.a.Ra(f.a.KRa)){fc=tb.Mc.getPropertyString(fc,f.a.KRa);uc=tb.Mc.getPropertyString(uc,f.a.KRa);uc=this.le(fc)?uc:this.le(uc)?fc:null;if(this.le(uc))return!0;tb.Mc.setPropertyString(rc,f.a.KRa,uc);tb.hg.add(k.a.Ra(f.a.KRa));return!0}if(yb===k.a.Ra(f.a.rob))return fc=tb.Mc.getPropertyBool(fc,f.a.rob),uc=tb.Mc.getPropertyBool(uc,f.a.rob),fc=null!=fc?fc:!1,fc=(null!=uc?uc:!1)||fc,tb.Mc.setPropertyBool(rc,f.a.rob,fc),tb.hg.add(k.a.Ra(f.a.rob)),!0;if(yb===k.a.Ra(f.a.Qmb)){fc=tb.Mc.getPropertyBool(fc,
f.a.Qmb);uc=tb.Mc.getPropertyBool(uc,f.a.Qmb);if(fc===uc)return!0;fc=null!=fc?fc:!1;fc=(null!=uc?uc:!1)||fc;tb.Mc.setPropertyBool(rc,f.a.Qmb,fc);return!0}if(yb===k.a.Ra(f.a.uH)){fc=tb.Mc.getPropertyBool(fc,f.a.uH);uc=tb.Mc.getPropertyBool(uc,f.a.uH);if(fc===uc)return!0;fc=null!=fc?fc:!1;fc=(null!=uc?uc:!1)||fc;tb.Mc.setPropertyBool(rc,f.a.uH,fc);tb.hg.add(k.a.Ra(f.a.uH));return!0}if(yb===k.a.Ra(f.a.Aaa)){yb=tb.jm.runtime.Ka;yb.hq(27);if(!yb.isFeatureEnabled(27))return!1;fc=tb.Mc.getPropertyString(fc,
f.a.Aaa);uc=tb.Mc.getPropertyString(uc,f.a.Aaa);if(fc===uc)return!0;tb.Mc.setPropertyString(rc,f.a.Aaa,uc||fc);tb.hg.add(k.a.Ra(f.a.Aaa));return!0}return!1}le(tb){return tb&&tb.length?!1:!0}static ai(){return new V}static get instance(){return V.Gh.value}}V.Gh=new c.a(V.ai);Object(C.a)(V,"CommentNodeComplexMerge",u.a,[]);class I extends u.a{constructor(){super()}get Dp(){return 46}El(){const tb=super.El();tb.$(k.a.Ra(f.a.contentControlNode),1);tb.$(k.a.Ra(t.a.lastModifiedTime),0);tb.$(k.a.Ra(f.a.pBc),
2);return tb}kG(tb,yb){if(!tb.jm.runtime.Ka.Cmb(1000005))return!1;if(yb===k.a.Ra(f.a.contentControlNode))return m.a.instance.xa(556865370,1,3,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",tb.Gl.id,tb.Gl.Jb,yb),I.e4i(tb,this);m.a.instance.xa(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",tb.vg.value.We.id,yb);return!1}static ai(){return new I}static get instance(){return I.Gh.value}static e4i(tb,
yb){const rc=k.a.Ra(f.a.contentControlNode),fc=f.a.contentControlNode,uc=tb.Mc;var Uc=uc.getPropertyObjectIds(tb.vg.value.Uv,fc);const tc=uc.getPropertyObjectIds(tb.vg.value.We,fc);var Tb=uc.getPropertyObjectIds(tb.wo.value.We,fc);Tb=I.YSl(Tb,tb.jm.runtime.qTc);yb=yb.O6a(Uc,tc,Tb);Uc=tb.Gl;0<yb.length?uc.setPropertyObjectIds(Uc,fc,yb):Uc.removeProperty(fc);tb.hg.add(rc);return!0}static YSl(tb,yb){const rc=new M.a;tb.forEach(fc=>{yb.contains(fc,(uc,Uc)=>uc.equals(Uc))||rc.add(fc);return!0});return rc}}
I.Gh=new c.a(I.ai);Object(C.a)(I,"ContentControlContainerNodeComplexMerge",u.a,[]);var R=b(51),ba=b(1583);class ha extends u.a{constructor(){super();this.gaa=null}KHe(tb){null==this.gaa&&(tb?(tb.hq(34),this.gaa=tb.isFeatureEnabled(34)):(this.gaa=!1,m.a.instance.xa(528761235,1,2,"Feature helper is null")));return this.gaa}get Dp(){return 37}El(){const tb=super.El();tb.$(k.a.Ra(f.a.V6),1);tb.$(k.a.Ra(f.a.vj),1);tb.$(k.a.Ra(f.a.fi),1);tb.$(k.a.Ra(f.a.VOb),1);tb.$(k.a.Ra(f.a.emd),2);tb.$(k.a.Ra(f.a.qBc),
2);tb.$(k.a.Ra(f.a.contentControlNode),1);tb.$(k.a.Ra(f.a.J7),1);tb.$(k.a.Ra(f.a.U6),1);tb.$(k.a.Ra(f.a.t5b),1);tb.$(k.a.Ra(f.a.tBc),1);tb.$(k.a.Ra(f.a.c3a),1);tb.$(k.a.Ra(f.a.b3a),1);tb.$(k.a.Ra(f.a.Aoe),2);tb.$(k.a.Ra(f.a.s5b),1);tb.$(k.a.Ra(f.a.sBc),1);tb.$(k.a.Ra(f.a.Nqa),1);return tb}kG(tb,yb){var rc=tb.vg.value.We,fc=tb.wo.value.We;const uc=tb.Gl;if(yb===k.a.Ra(f.a.contentControlNode))return I.e4i(tb,this);if(yb===k.a.Ra(f.a.J7)){yb=tb.Mc.getPropertyBool(rc,f.a.J7);fc=tb.Mc.getPropertyBool(fc,
f.a.J7);if(null!=yb&&yb||null!=fc&&fc)tb.Mc.setPropertyBool(uc,f.a.J7,!0),tb.hg.add(k.a.Ra(f.a.J7));return!0}if(yb===k.a.Ra(f.a.U6))return yb=tb.Mc.getPropertyBool(rc,f.a.U6),fc=tb.Mc.getPropertyBool(fc,f.a.U6),tb.Mc.setPropertyBool(uc,f.a.U6,null!=yb&&!!yb&&null!=fc&&!!fc),tb.hg.add(k.a.Ra(f.a.U6)),!0;if(yb===k.a.Ra(f.a.t5b))return yb=tb.Mc.getPropertyUint32(fc,f.a.t5b),null!=yb&&(tb.Mc.setPropertyUint32(uc,f.a.t5b,yb),tb.hg.add(k.a.Ra(f.a.t5b))),!0;if(yb===k.a.Ra(f.a.tBc)||yb===k.a.Ra(f.a.c3a)||
yb===k.a.Ra(f.a.b3a))return(fc=tb.Mc.getPropertyString(fc,k.a.MX(yb)))&&0<fc.length&&(tb.Mc.setPropertyString(uc,k.a.MX(yb),fc),tb.hg.add(yb)),!0;if(yb===k.a.Ra(f.a.s5b)||yb===k.a.Ra(f.a.sBc)){var Uc=tb.Mc.getPropertyObjectId(rc,k.a.MX(yb));if(ba.a.OFc(tb.jm,Uc))return!0;if((fc=tb.Mc.getPropertyObjectId(fc,k.a.MX(yb)))&&fc!==R.a.nil)return tb.Mc.setPropertyObjectId(uc,k.a.MX(yb),fc),tb.hg.add(yb),!0;uc.removeProperty(k.a.MX(yb));tb.hg.add(yb);return!0}if(yb===k.a.Ra(f.a.Nqa)){Uc=tb.Mc.getPropertyObjectId(rc,
f.a.Nqa);if((Uc=ba.a.OFc(tb.jm,Uc))&&tb.Mc.getPropertyObjectIds(Uc,f.a.contentControlNode).iG().contains(tb.Gl.id))return!0;fc=tb.Mc.getPropertyObjectId(fc,f.a.Nqa);return(Uc=ba.a.OFc(tb.jm,fc))&&tb.Mc.getPropertyObjectIds(Uc,f.a.contentControlNode).iG().contains(tb.Gl.id)?(tb.Mc.setPropertyObjectId(uc,f.a.Nqa,fc),tb.hg.add(yb),!0):!1}if(yb===k.a.Ra(f.a.V6))return yb=tb.Mc.getPropertyBool(fc,f.a.V6),null==yb||yb||(tb.Mc.setPropertyBool(uc,f.a.V6,!1),tb.hg.add(k.a.Ra(f.a.V6))),!0;if(yb===k.a.Ra(f.a.VOb)){yb=
tb.Mc.getPropertyObjectId(rc,f.a.VOb);fc=tb.Mc.getPropertyObjectId(fc,f.a.VOb);if(yb&&!yb.equals(fc))return!1;if(yb=yb||fc)tb.Mc.setPropertyObjectId(uc,f.a.VOb,yb),tb.hg.add(k.a.Ra(f.a.VOb));return!0}if(this.KHe(tb.jm.runtime.Ka)&&(yb===k.a.Ra(f.a.vj)||yb===k.a.Ra(f.a.fi)))return uc.removeProperty(k.a.MX(yb)),tb.hg.add(yb),!0;if(!this.KHe(tb.jm.runtime.Ka)&&(yb===k.a.Ra(f.a.vj)||yb===k.a.Ra(f.a.fi))){Uc=k.a.MX(yb);rc=tb.Mc.getPropertyObjectId(rc,Uc);fc=tb.Mc.getPropertyObjectId(fc,Uc);const tc=this.tTi(tb,
tb.Gl.id,rc),Tb=this.tTi(tb,tb.Gl.id,fc);if(rc&&rc.equals(fc))return!0;if(rc&&!tb.jm.runtime.zm.get(rc)||tc&&Tb)return!1;(fc=tc?rc:Tb?fc:null)?tb.Mc.setPropertyObjectId(uc,Uc,fc):uc.removeProperty(Uc);tb.hg.add(yb);return!0}return!1}tTi(tb,yb,rc){if(!rc)return!1;const fc=tb.jm.runtime.zm;rc=fc.get(rc);if(!rc||!rc.Wj)return!1;rc=tb.Mc.getPropertyObjectIds(rc.Wj,t.a.qn);if(!rc)return!1;for(let Uc=0;Uc<rc.length;Uc++){var uc=rc.J(Uc);if((uc=fc.get(uc))&&uc.Wj&&(uc=tb.Mc.getPropertyObjectId(uc.Wj,f.a.nd))&&
uc.equals(yb))return!0}return!1}static ai(){return new ha}static get instance(){return ha.Gh.value}}ha.Gh=new c.a(ha.ai);Object(C.a)(ha,"ContentControlNodeComplexMerge",u.a,[]);class na extends u.a{constructor(){super()}get Dp(){return 10}El(){const tb=super.El();tb.$(k.a.Ra(f.a.customXmlPartNode),1);return tb}kG(tb,yb){if(yb===k.a.Ra(f.a.customXmlPartNode)){yb=tb.Gl;const fc=tb.Mc;var rc=fc.getPropertyObjectIds(tb.vg.value.Uv,f.a.customXmlPartNode);const uc=fc.getPropertyObjectIds(tb.vg.value.We,
f.a.customXmlPartNode),Uc=fc.getPropertyObjectIds(tb.wo.value.We,f.a.customXmlPartNode);rc=this.fwm(rc,uc,Uc);0<rc.length?fc.setPropertyObjectIds(yb,f.a.customXmlPartNode,rc):yb.removeProperty(f.a.customXmlPartNode);tb.hg.add(k.a.Ra(f.a.customXmlPartNode));return!0}return!1}fwm(tb,yb,rc){return this.O6a(tb,yb,rc)}static ai(){return new na}static get instance(){return na.Gh.value}}na.Gh=new c.a(na.ai);Object(C.a)(na,"CustomXmlPartContainerNodeComplexMerge",u.a,[]);class da extends u.a{constructor(){super()}get Dp(){return 9}get HF(){return 0}static ai(){return new da}static get instance(){return da.Gh.value}}
da.Gh=new c.a(da.ai);Object(C.a)(da,"CustomXmlPartNodeComplexMerge",u.a,[]);class ia extends u.a{constructor(){super()}get Dp(){return 29}get HF(){return 3}El(){const tb=super.El();tb.$(k.a.Ra(f.a.embeddedFontNode),1);return tb}kG(tb,yb){if(yb===k.a.Ra(f.a.embeddedFontNode)){yb=tb.Mc;var rc=yb.getPropertyObjectIds(tb.vg.value.Uv,f.a.embeddedFontNode),fc=yb.getPropertyObjectIds(tb.vg.value.We,f.a.embeddedFontNode);const uc=yb.getPropertyObjectIds(tb.wo.value.We,f.a.embeddedFontNode);rc=this.O6a(rc,
fc,uc);fc=tb.Gl;0<rc.length?yb.setPropertyObjectIds(fc,f.a.embeddedFontNode,rc):fc.removeProperty(f.a.embeddedFontNode);tb.hg.add(k.a.Ra(f.a.embeddedFontNode));return!0}return!1}static ai(){return new ia}static get instance(){return ia.Gh.value}}ia.Gh=new c.a(ia.ai);Object(C.a)(ia,"EmbeddedFontContainerNodeComplexMerge",u.a,[]);class ma extends u.a{constructor(){super()}get Dp(){return 30}get HF(){return 3}static ai(){return new ma}static get instance(){return ma.Gh.value}}ma.Gh=new c.a(ma.ai);Object(C.a)(ma,
"EmbeddedFontNodeComplexMerge",u.a,[]);class qa extends u.a{constructor(){super()}get Dp(){return 11}El(){const tb=super.El();tb.$(k.a.Ra(f.a.Vfa),4);tb.$(k.a.Ra(f.a.jTa),1);return tb}kG(tb,yb){if(yb===k.a.Ra(f.a.jTa)){const rc=tb.Gl,fc=tb.Mc;m.a.instance.xa(4063307,1,3,"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",rc.id,rc.Jb,yb);yb=fc.getPropertyObjectIds(tb.vg.value.Uv,f.a.jTa);const uc=fc.getPropertyObjectIds(tb.vg.value.We,
f.a.jTa),Uc=fc.getPropertyObjectIds(tb.wo.value.We,f.a.jTa);yb=this.h4i(yb,uc,Uc,(tc,Tb)=>tc.equals(Tb));0<yb.length?fc.setPropertyObjectIds(rc,f.a.jTa,yb):rc.removeProperty(f.a.jTa);tb.hg.add(k.a.Ra(f.a.jTa));return!0}m.a.instance.xa(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.vg.value.We.id,yb);return!1}static ai(){return new qa}static get instance(){return qa.Gh.value}}qa.Gh=new c.a(qa.ai);
Object(C.a)(qa,"FootnoteEndnoteContainerNodeComplexMerge",u.a,[]);class ka extends u.a{constructor(){super()}get Dp(){return 12}get HF(){return 3}El(){const tb=super.El();tb.$(k.a.Ra(f.a.vra),1);return tb}kG(tb,yb){const rc=tb.Gl,fc=tb.Mc;if(yb===k.a.Ra(f.a.vra)){let uc=-1;m.a.instance.xa(5002527,1,3,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",rc.id,rc.Jb,yb);const Uc=fc.getPropertyInt32(tb.vg.value.We,f.a.vra),tc=fc.getPropertyInt32(tb.wo.value.We,
f.a.vra);null!=Uc&&-1!==Uc?uc=Uc:null!=tc&&(uc=tc);fc.setPropertyInt32(rc,f.a.vra,uc);tb.hg.add(yb);return!0}m.a.instance.xa(5002528,1,3,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.vg.value.Uv.id,yb);return!1}static ai(){return new ka}static get instance(){m.a.instance.xa(5002526,1,3,"FootnoteEndnoteNodeComplexMerge: Got Instance");return ka.Gh.value}}ka.Gh=new c.a(ka.ai);Object(C.a)(ka,"FootnoteEndnoteNodeComplexMerge",
u.a,[]);class va extends u.a{constructor(){super()}get Dp(){return 13}get HF(){return 3}El(){const tb=super.El();tb.$(k.a.Ra(f.a.Wca),4);return tb}static ai(){return new va}static get instance(){return va.Gh.value}}va.Gh=new c.a(va.ai);Object(C.a)(va,"HeaderFooterContainerNodeComplexMerge",u.a,[]);var ja=b(42);class Ma extends u.a{constructor(){super()}get Dp(){return 14}get HF(){return 3}El(){const tb=super.El();tb.$(k.a.Ra(f.a.runId),3);tb.$(k.a.Ra(f.a.Ob),3);tb.$(k.a.Ra(f.a.$lg),3);tb.$(k.a.Ra(f.a.$U),
1);tb.$(k.a.Ra(ja.a.n4),1);tb.$(k.a.Ra(t.a.imageAltText),1);tb.$(k.a.Ra(f.a.dY),1);tb.$(k.a.Ra(t.a.Ica),1);tb.$(k.a.Ra(ja.a.OLa),1);tb.$(k.a.Ra(f.a.ohb),1);return tb}kG(tb,yb){if(yb===k.a.Ra(t.a.imageAltText)||yb===k.a.Ra(f.a.dY)||yb===k.a.Ra(f.a.$U)||yb===k.a.Ra(f.a.uS)||yb===k.a.Ra(t.a.sIa)||yb===k.a.Ra(t.a.Ica)||yb===k.a.Ra(ja.a.n4)||yb===k.a.Ra(ja.a.OLa)||yb===k.a.Ra(f.a.ohb)){const fc=tb.Gl;var rc=tb.Mc;m.a.instance.xa(4018185,1,3,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
fc.id,fc.Jb,yb);const uc=rc.getPropertyInt32(tb.vg.value.We,ja.a.n4);rc=rc.getPropertyInt32(tb.wo.value.We,ja.a.n4);if(null!=uc&&(0===uc||2===uc))return!0;if(null!=rc&&(0===rc||2===rc))return yb=tb.wo.value.We,this.pDb(yb,fc,t.a.imageAltText),this.pDb(yb,fc,f.a.dY),this.pDb(yb,fc,f.a.uS),yb.hasProperty(f.a.$U)&&this.pDb(yb,fc,f.a.$U),this.pDb(yb,fc,t.a.sIa),this.pDb(yb,fc,t.a.Ica),this.pDb(yb,fc,ja.a.n4),this.pDb(yb,fc,ja.a.OLa),tb.hg.add(k.a.Ra(t.a.imageAltText)),tb.hg.add(k.a.Ra(f.a.dY)),tb.hg.add(k.a.Ra(f.a.uS)),
tb.hg.add(k.a.Ra(f.a.$U)),tb.hg.add(k.a.Ra(t.a.sIa)),tb.hg.add(k.a.Ra(t.a.Ica)),tb.hg.add(k.a.Ra(ja.a.n4)),tb.hg.add(k.a.Ra(ja.a.OLa)),tb.hg.add(k.a.Ra(f.a.ohb)),!0}m.a.instance.xa(4018186,1,3,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.vg.value.Uv.id,yb);return!1}static ai(){return new Ma}static get instance(){return Ma.Gh.value}}Ma.Gh=new c.a(Ma.ai);Object(C.a)(Ma,"ImageNodeComplexMerge",u.a,[]);class Ha extends u.a{constructor(){super()}get Dp(){return 40}get HF(){return 0}static ai(){return new Ha}static get instance(){return Ha.Gh.value}}
Ha.Gh=new c.a(Ha.ai);Object(C.a)(Ha,"IntelligenceAnnotationNodeComplexMerge",u.a,[]);class X extends u.a{constructor(){super()}get Dp(){return 32}get HF(){return 0}static ai(){return new X}static get instance(){return X.Gh.value}}X.Gh=new c.a(X.ai);Object(C.a)(X,"IntelligenceContentLocatorNodeComplexMerge",u.a,[]);class W extends u.a{constructor(){super()}get Dp(){return 34}get HF(){return 0}El(){const tb=super.El();tb.$(k.a.Ra(f.a.E5a),1);return tb}kG(tb,yb){const rc=tb.Gl,fc=tb.Mc;if(yb===k.a.Ra(f.a.E5a)){yb=
fc.getPropertyObjectIds(tb.vg.value.Uv,f.a.E5a);const uc=fc.getPropertyObjectIds(tb.vg.value.We,f.a.E5a),Uc=fc.getPropertyObjectIds(tb.wo.value.We,f.a.E5a);yb=this.O6a(yb,uc,Uc);fc.setPropertyObjectIds(rc,f.a.E5a,yb);tb.hg.add(k.a.Ra(f.a.E5a));return!0}return!1}static ai(){return new W}static get instance(){return W.Gh.value}}W.Gh=new c.a(W.ai);Object(C.a)(W,"IntelligenceRegionNodeComplexMerge",u.a,[]);class fa extends u.a{constructor(){super()}get Dp(){return 35}get HF(){return 0}static ai(){return new fa}static get instance(){return fa.Gh.value}}
fa.Gh=new c.a(fa.ai);Object(C.a)(fa,"IntelligenceRejectionNodeComplexMerge",u.a,[]);class ra extends u.a{constructor(){super()}get Dp(){return 39}get HF(){return 0}static ai(){return new ra}static get instance(){return ra.Gh.value}}ra.Gh=new c.a(ra.ai);Object(C.a)(ra,"IntelligenceReviewedNodeComplexMerge",u.a,[]);class Aa extends u.a{constructor(){super()}get Dp(){return 33}get HF(){return 0}El(){const tb=super.El();tb.$(k.a.Ra(f.a.nbc),1);tb.$(k.a.Ra(f.a.VIc),1);tb.$(k.a.Ra(f.a.LAd),1);tb.$(k.a.Ra(f.a.MAd),
1);return tb}kG(tb,yb){const rc=tb.Gl,fc=tb.Mc;if(yb===k.a.Ra(f.a.nbc)||yb===k.a.Ra(f.a.VIc)||yb===k.a.Ra(f.a.LAd)||yb===k.a.Ra(f.a.MAd)){yb=yb===k.a.Ra(f.a.nbc)?f.a.nbc:f.a.VIc;var uc=fc.getPropertyObjectIds(tb.vg.value.Uv,yb);const Uc=fc.getPropertyObjectIds(tb.vg.value.We,yb),tc=fc.getPropertyObjectIds(tb.wo.value.We,yb);uc=this.O6a(uc,Uc,tc);fc.setPropertyObjectIds(rc,yb,uc);tb.hg.add(k.a.Ra(yb));return!0}return!1}static ai(){return new Aa}static get instance(){return Aa.Gh.value}}Aa.Gh=new c.a(Aa.ai);
Object(C.a)(Aa,"IntelligenceRootNodeComplexMerge",u.a,[]);class Ba extends u.a{constructor(){super()}get Dp(){return 15}get HF(){return 3}static ai(){return new Ba}static get instance(){return Ba.Gh.value}}Ba.Gh=new c.a(Ba.ai);Object(C.a)(Ba,"NumberListNodeComplexMerge",u.a,[]);var ta=b(109);class xa extends u.a{constructor(){super()}get Dp(){return 16}get HF(){return 0}El(){const tb=super.El();tb.$(k.a.Ra(f.a.gCb),1);tb.$(k.a.Ra(ta.a.Rne),7);tb.$(k.a.Ra(ta.a.Qne),7);return tb}kG(tb,yb){const rc=
tb.Gl,fc=tb.Mc;if(yb===k.a.Ra(f.a.gCb))return this.Ttg(fc,tb.vg.value.We,tb.wo.value.We,rc,f.a.gCb),tb.hg.add(yb),!0;m.a.instance.xa(4207940,1,3,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.vg.value.Uv.id,yb);return!1}static ai(){return new xa}static get instance(){return xa.Gh.value}}xa.Gh=new c.a(xa.ai);Object(C.a)(xa,"OutlineElementNodeComplexMerge",u.a,[]);class za extends u.a{constructor(){super()}get Dp(){return 17}El(){const tb=
super.El();tb.$(k.a.Ra(f.a.gCb),1);tb.$(k.a.Ra(f.a.g7),1);tb.$(k.a.Ra(ta.a.NB),1);tb.$(k.a.Ra(ta.a.Qdc),1);tb.$(k.a.Ra(ta.a.RY),8);return tb}kG(tb,yb){const rc=tb.Gl,fc=tb.Mc;if(yb===k.a.Ra(f.a.gCb))return this.Ttg(fc,tb.vg.value.We,tb.wo.value.We,rc,f.a.gCb),tb.hg.add(yb),!0;if(yb===k.a.Ra(f.a.g7)){var uc=fc.getPropertyBool(tb.vg.value.We,f.a.g7),Uc=fc.getPropertyBool(tb.wo.value.We,f.a.g7);fc.setPropertyBool(rc,f.a.g7,null==uc?!1:uc&&null==Uc?!1:Uc);tb.hg.add(yb);return!0}if(yb===k.a.Ra(ta.a.Qdc))return this.Ttg(fc,
tb.vg.value.We,tb.wo.value.We,rc,ta.a.Qdc),tb.hg.add(yb),!0;if(yb===k.a.Ra(ta.a.NB))return uc=fc.getPropertyBool(tb.vg.value.We,ta.a.NB),Uc=fc.getPropertyBool(tb.wo.value.We,ta.a.NB),fc.setPropertyBool(rc,ta.a.NB,null==uc?!0:uc||null==Uc?!0:Uc),tb.hg.add(yb),!0;m.a.instance.xa(4057305,1,3,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.vg.value.Uv.id,yb);return!1}static ai(){return new za}static get instance(){return za.Gh.value}}
za.Gh=new c.a(za.ai);Object(C.a)(za,"OutlineGroupNodeComplexMerge",u.a,[]);var la=b(161),Sa=b(41);class Pa extends u.a{constructor(){super()}get Dp(){return 18}get HF(){return 2}El(){const tb=super.El();tb.$(k.a.Ra(f.a.hyd),3);tb.$(k.a.Ra(t.a.T4),this.HF);tb.$(k.a.Ra(f.a.Ar),1);tb.$(k.a.Ra(f.a.Kka),1);tb.$(k.a.Ra(f.a.cha),1);tb.$(k.a.Ra(f.a.BY),1);tb.$(k.a.Ra(f.a.Co),1);tb.$(k.a.Ra(la.a.CY),1);tb.$(k.a.Ra(la.a.Yfc),1);return tb}kG(tb,yb){const rc=tb.Mc;if(tb.jm.runtime.Ka.isFeatureEnabled(116)){var fc=
tb.jm.runtime.Ka.isFeatureEnabled(209),uc=this.Bzi(fc),Uc=this.Fzi(fc);if(yb===k.a.Ra(f.a.Ar)||yb===k.a.Ra(f.a.cha)||yb===k.a.Ra(uc)||yb===k.a.Ra(f.a.Co)||yb===k.a.Ra(Uc))return this.sIn(rc,tb,fc)}else if(yb===k.a.Ra(f.a.Ar)||yb===k.a.Ra(f.a.Co)){({Nld:yb,Cob:fc,sob:uc}=this.zLf(Object(Sa.a)(rc,rc.getPropertyUint32s,"getPropertyUint32s"),tb.vg.value.Uv,tb.vg.value.We,tb.wo.value.We,f.a.Ar,null));if(!uc&&!fc)return m.a.instance.xa(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
tb.vg.value.We.id,k.a.Ra(f.a.Ar)),!0;let tc,Tb;({Nld:Uc,Cob:tc,sob:Tb}=this.zLf(Object(Sa.a)(rc,rc.getPropertyObjectIds,"getPropertyObjectIds"),tb.vg.value.Uv,tb.vg.value.We,tb.wo.value.We,f.a.Co,null));if(!tc&&!Tb)return m.a.instance.xa(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",tb.vg.value.We.id,k.a.Ra(f.a.Co)),!0;const qb=tc&&!Tb;if((fc&&!uc)!==qb)return m.a.instance.xa(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
tb.vg.value.We.id,k.a.Ra(f.a.Ar),k.a.Ra(f.a.Co)),!1;qb&&(rc.setPropertyObjectIds(tb.Gl,f.a.Co,Uc),rc.setPropertyUint32s(tb.Gl,f.a.Ar,yb));m.a.instance.xa(4318877,1,3,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",tb.vg.value.We.id,k.a.Ra(f.a.Ar),fc,uc,k.a.Ra(f.a.Co),tc,Tb);tb.hg.add(k.a.Ra(f.a.Co));tb.hg.add(k.a.Ra(f.a.Ar));
return!0}m.a.instance.xa(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.vg.value.We.id,yb);return!1}NJi(tb,yb,rc,fc){let uc;({Nld:yb,Cob:fc,sob:uc}=this.zLf(yb,rc.vg.value.Uv,rc.vg.value.We,rc.wo.value.We,tb,fc));return uc||fc?{returnValue:!0,GOf:yb,Cob:fc,sob:uc}:(m.a.instance.xa(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
rc.vg.value.We.id.toString(),k.a.Ra(tb)),{returnValue:!1,GOf:yb,Cob:fc,sob:uc})}SIi(tb,yb,rc,fc,uc){let Uc;let tc,Tb,qb,Jb;({GOf:Uc,Cob:Zb,sob:tc,returnValue:qb}=this.NJi(tb,Object(Sa.a)(rc,rc.getPropertyUint32s,"getPropertyUint32s"),fc,null));({GOf:rc,Cob:uc,sob:Tb,returnValue:Jb}=this.NJi(yb,Object(Sa.a)(rc,rc.getPropertyObjectIds,"getPropertyObjectIds"),fc,uc));var Zb=Zb&&!tc;return qb&&Jb?Zb!==(uc&&!Tb)?(m.a.instance.xa(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
fc.vg.value.We.id.toString(),k.a.Ra(tb),k.a.Ra(yb)),{returnValue:2,goe:Uc,foe:rc,b1e:Zb}):{returnValue:0,goe:Uc,foe:rc,b1e:Zb}:{returnValue:1,goe:Uc,foe:rc,b1e:Zb}}Vng(tb){let yb=!0;tb.forEach(rc=>rc!==R.a.nil?yb=!1:!0);return yb}tzl(tb,yb,rc){return this.Vng(tb)&&this.Vng(yb)&&this.Vng(rc)?!0:!1}sIn(tb,yb,rc){const fc=this.Bzi(rc);rc=this.Fzi(rc);let uc,Uc,tc,Tb,qb,Jb;var Zb=({goe:Tb,foe:qb,b1e:Uc}=this.SIi(fc,f.a.Co,tb,yb,null)).returnValue;if(2===Zb||1===Zb)return!0;({goe:tc,foe:Jb,b1e:uc,returnValue:Zb}=
this.SIi(f.a.Ar,f.a.cha,tb,yb,Object(Sa.a)(this,this.tzl,"getExtendedGuidEquivalence")));if(2===Zb||1===Zb)return!0;let ec;({Nld:Zb,Cob:zc,sob:ec}=this.hQk(Object(Sa.a)(tb,tb.getPropertyDictionary,"getPropertyDictionary"),yb.vg.value.Uv,yb.vg.value.We,yb.wo.value.We,rc));if(!ec&&!zc)return m.a.instance.xa(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",yb.vg.value.We.id.toString(),k.a.Ra(rc)),!0;var zc=zc&&!ec;
if(uc!==Uc||uc!==zc)return m.a.instance.xa(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",yb.vg.value.We.id.toString(),k.a.Ra(f.a.Ar),k.a.Ra(fc),k.a.Ra(rc),Uc,uc,zc),!0;uc&&(tb.setPropertyObjectIds(yb.Gl,f.a.Co,qb),tb.setPropertyUint32s(yb.Gl,fc,Tb),tb.setPropertyObjectIds(yb.Gl,
f.a.cha,Jb),tb.setPropertyUint32s(yb.Gl,f.a.Ar,tc),tb.setPropertyDictionary(yb.Gl,rc,Zb));m.a.instance.xa(592545118,1,3,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingAbsListId: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",yb.vg.value.We.id.toString(),Uc,uc,zc);yb.hg.add(k.a.Ra(fc));yb.hg.add(k.a.Ra(f.a.Co));yb.hg.add(k.a.Ra(f.a.Ar));yb.hg.add(k.a.Ra(f.a.cha));yb.hg.add(k.a.Ra(rc));return!0}Bzi(tb){return tb?la.a.Yfc:f.a.Kka}Fzi(tb){return tb?la.a.CY:
f.a.BY}static ai(){return new Pa}static get instance(){return Pa.Gh.value}}Pa.Gh=new c.a(Pa.ai);Object(C.a)(Pa,"PageContentNodeComplexMerge",u.a,[]);class fb extends u.a{constructor(){super()}get Dp(){return 19}El(){const tb=super.El();tb.$(k.a.Ra(f.a.WKa),1);tb.$(k.a.Ra(f.a.appsNode),2);tb.$(k.a.Ra(f.a.customXmlPartContainerNode),2);return tb}kG(tb,yb){if(yb===k.a.Ra(f.a.WKa)){const fc=tb.Mc;var rc=fc.getPropertyObjectIds(tb.vg.value.Uv,f.a.WKa);const uc=fc.getPropertyObjectIds(tb.vg.value.We,f.a.WKa),
Uc=fc.getPropertyObjectIds(tb.wo.value.We,f.a.WKa);if((rc=this.nwm(rc,uc,Uc,(tc,Tb)=>tc.equals(Tb),tc=>{let Tb;({value:Tb}=tb.jm.runtime.Kr.Ab(tc)).returnValue?tb.jm.runtime.zm.$(tc,new l.a(Tb,!1)):m.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},tb.jm))&&0<rc.length)return fc.setPropertyObjectIds(tb.Gl,f.a.WKa,rc),tb.hg.add(k.a.Ra(f.a.WKa)),!0}m.a.instance.xa(4018187,1,3,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
tb.vg.value.We.id,yb);return!1}static ai(){return new fb}static get instance(){return fb.Gh.value}}fb.Gh=new c.a(fb.ai);Object(C.a)(fb,"PageManifestNodeComplexMerge",u.a,[]);class db extends u.a{constructor(){super()}get Dp(){return 43}El(){const tb=super.El();tb.$(k.a.Ra(f.a.pqa),0);tb.$(k.a.Ra(f.a.LKb),0);tb.$(k.a.Ra(f.a.gIb),0);tb.$(k.a.Ra(f.a.Tra),1);return tb}kG(tb,yb){if(yb===k.a.Ra(f.a.Tra)){yb=tb.Mc;var rc=tb.vg.value.Uv,fc=tb.wo.value.We,uc=tb.vg.value.We;rc=rc?yb.getPropertyObjectId(rc,
f.a.Tra):null;fc=fc?yb.getPropertyObjectId(fc,f.a.Tra):null;uc=uc?yb.getPropertyObjectId(uc,f.a.Tra):null;m.a.instance.xa(589657691,1,3,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",rc?rc.toString():"NULL",fc?fc.toString():"NULL",uc?uc.toString():"NULL");if(fc){if(uc&&fc.equals(uc))return tb.hg.add(k.a.Ra(f.a.Tra)),yb.setPropertyObjectId(tb.Gl,f.a.Tra,fc),!0;if(ba.a.RAe.equals(fc))return tb.hg.add(k.a.Ra(f.a.Tra)),yb.setPropertyObjectId(tb.Gl,f.a.Tra,ba.a.RAe),!0}if(uc&&
ba.a.RAe.equals(uc))return tb.hg.add(k.a.Ra(f.a.Tra)),yb.setPropertyObjectId(tb.Gl,f.a.Tra,ba.a.RAe),!0;m.a.instance.xa(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",rc?rc.toString():"NULL",fc?fc.toString():"NULL",uc?uc.toString():"NULL")}return!1}static ai(){return new db}static get instance(){return db.Gh.value}}db.Gh=new c.a(db.ai);Object(C.a)(db,"PageMetadataNodeComplexMerge",u.a,[]);var Qa=b(1597),wb=b(127);class ib extends u.a{constructor(){super()}get Dp(){return 31}El(){const tb=
super.El();tb.$(k.a.Ra(wb.a.Ju),1);tb.$(k.a.Ra(f.a.listID),1);tb.$(k.a.Ra(f.a.je),1);for(let yb=0;yb<ib.Kpb.length;yb++)tb.$(ib.Kpb[yb],1);return tb}kG(tb,yb){const rc=tb.Mc,fc=tb.Gl,uc=tb.jm.runtime.Ka.isFeatureEnabled(112);k.a.MX(yb);if(yb===k.a.Ra(wb.a.Ju)){const Uc=rc.getPropertyUint32(tb.vg.value.We,wb.a.Ju),tc=rc.getPropertyUint32(tb.wo.value.We,wb.a.Ju);if(null!=Uc&&null!=tc&&Uc===tc)return rc.setPropertyUint32(fc,wb.a.Ju,Uc),tb.hg.add(yb),!0;if(null==Uc&&null==tc)return uc?fc.removeProperty(wb.a.Ju):
rc.setPropertyUint32(fc,wb.a.Ju,Uc),tb.hg.add(k.a.Ra(wb.a.Ju)),!0;if(null!=Uc&&null==tc)return rc.setPropertyUint32(fc,wb.a.Ju,Uc),tb.hg.add(yb),!0;if(null==Uc&&null!=tc)return rc.setPropertyUint32(fc,wb.a.Ju,tc),tb.hg.add(yb),!0}else if(yb===k.a.Ra(f.a.je)){if(uc)return this.QHn(rc,tb)}else if(yb===k.a.Ra(f.a.listID)){if(uc)return this.THn(tb,f.a.listID)}else if(Array.contains(ib.Kpb,yb)&&uc)return this.PHn(tb);return!1}THn(tb,yb){const rc=tb.Gl;var fc=tb.wo.value,uc=tb.vg.value;let Uc;const tc=
fc.Pna.Ab(k.a.Ra(yb)).returnValue,Tb=({value:Uc}=uc.Pna.Ab(k.a.Ra(yb))).returnValue;uc=uc.We;fc=fc.We;let qb=!1;Tb?Uc.isDeleted?(rc.removeProperty(yb),qb=!0):Uc.pY?(rc.c1(yb,uc.Cy(f.a.listID)),qb=!0):tc&&(fc.hasProperty(f.a.listID)?rc.c1(yb,fc.Cy(f.a.listID)):rc.removeProperty(yb),qb=!0):tc&&(fc.hasProperty(f.a.listID)?(rc.c1(yb,fc.Cy(f.a.listID)),qb=!0):m.a.instance.xa(578851419,1,1,"PersistablePropertySetComplexMerge: Merging ListId property. Not present in [base]: {0} [favored] : {1} conflict {2}.]",
tb.vg.value.Uv.cZa(),tb.vg.value.We.cZa(),tb.wo.value.We.cZa()));return qb?(tb.hg.add(k.a.Ra(yb)),!0):!1}PHn(tb){let yb=!0,rc=!0,fc,uc;({dam:yb,g9l:rc,Pil:fc,TWk:uc}=this.iQk(tb));m.a.instance.xa(578932993,1,3,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",tb.vg.value.We.id.toString(),yb,rc);return yb&&!rc?(this.X4i(uc,tb),!0):yb?!1:(this.X4i(fc,tb),!0)}iQk(tb){let yb,rc,fc,uc;const Uc=tb.wo.value;let tc;
const Tb=tb.vg.value;let qb;rc=yb=!0;fc=new D.a;uc=new D.a;for(let Jb=0;Jb<ib.Kpb.length;Jb++){const Zb=ib.Kpb[Jb],ec=({value:tc}=Uc.Pna.Ab(Zb)).returnValue;({value:qb}=Tb.Pna.Ab(Zb)).returnValue&&(yb=this.ELj(tb.vg,fc,qb,Zb)&&yb);ec&&(rc=this.ELj(tb.wo,uc,tc,Zb)&&rc)}return{dam:yb,g9l:rc,Pil:fc,TWk:uc}}ELj(tb,yb,rc,fc){const uc=k.a.MX(fc);tb=tb.value.We;yb.$(fc,tb.hasProperty(uc)?tb.Cy(uc):null);return!rc.pY}X4i(tb,yb){const rc=yb.Gl;for(let uc=0;uc<ib.Kpb.length;uc++){var fc=ib.Kpb[uc];const Uc=
k.a.MX(fc);(fc=tb.J(fc))?rc.c1(Uc,fc):rc.removeProperty(Uc)}for(tb=0;tb<ib.Kpb.length;tb++)yb.hg.add(ib.Kpb[tb]);m.a.instance.xa(578932994,1,3,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",yb.vg.value.We.id.toString())}QHn(tb,yb){const rc=yb.Gl,fc=tb.getPropertyInt32(yb.vg.value.We,f.a.je),uc=tb.getPropertyInt32(yb.wo.value.We,f.a.je);return null!=fc&&null!=uc&&fc===uc?(tb.setPropertyInt32(rc,f.a.je,fc),yb.hg.add(k.a.Ra(f.a.je)),!0):null==fc&&null==uc?(rc.removeProperty(f.a.je),
yb.hg.add(k.a.Ra(f.a.je)),!0):null!=fc&&null==uc?(tb.setPropertyInt32(rc,f.a.je,fc),yb.hg.add(k.a.Ra(f.a.je)),!0):null==fc&&null!=uc?(tb.setPropertyInt32(rc,f.a.je,uc),yb.hg.add(k.a.Ra(f.a.je)),!0):!1}static ai(){return new ib}static get instance(){return ib.Gh.value}}ib.Gh=new c.a(ib.ai);ib.Kpb=[k.a.Ra(f.a.Oj),k.a.Ra(f.a.Ny),k.a.Ra(t.a.rQ),k.a.Ra(f.a.D4),k.a.Ra(f.a.fr),k.a.Ra(f.a.gq),k.a.Ra(t.a.JS),k.a.Ra(f.a.Dke),k.a.Ra(t.a.font),k.a.Ra(ta.a.Psa)];Object(C.a)(ib,"PersistablePropertySetComplexMerge",
u.a,[]);class Ta extends u.a{constructor(){super()}get Dp(){return 21}get HF(){return 0}static ai(){return new Ta}static get instance(){return Ta.Gh.value}}Ta.Gh=new c.a(Ta.ai);Object(C.a)(Ta,"RevisionMetadataNodeComplexMerge",u.a,[]);class jb extends u.a{constructor(){super()}get Dp(){return 22}El(){const tb=super.El();tb.$(k.a.Ra(f.a.languageHint),7);tb.$(k.a.Ra(f.a.XHb),2);return tb}static ai(){return new jb}static get instance(){return jb.Gh.value}}jb.Gh=new c.a(jb.ai);Object(C.a)(jb,"SharedPersistablePropertySetComplexMerge",
u.a,[]);class $a extends u.a{constructor(){super()}get Dp(){return 38}get HF(){return 3}static ai(){return new $a}static get instance(){return $a.Gh.value}}$a.Gh=new c.a($a.ai);Object(C.a)($a,"StylePropertySetComplexMerge",u.a,[]);var ya=b(1398),wa=b(1448);class Fa extends u.a{constructor(){super()}get Dp(){return 23}get HF(){return 0}El(){const tb=super.El();tb.$(k.a.Ra(t.a.jf),4);tb.$(k.a.Ra(f.a.rowSpan),1);tb.$(k.a.Ra(f.a.colSpan),1);tb.$(k.a.Ra(f.a.ghostCell),1);tb.$(k.a.Ra(la.a.NZa),1);tb.$(k.a.Ra(la.a.dUa),
1);tb.$(k.a.Ra(f.a.Y9a),2);tb.$(k.a.Ra(f.a.ivb),2);tb.$(k.a.Ra(f.a.mLa),2);tb.$(k.a.Ra(f.a.MYa),5);return tb}gdc(tb){if(!tb)return m.a.instance.xa(573957923,1,2,"Feature helper is null"),!1;tb.hq(177);return tb.isFeatureEnabled(177)}mQ(tb){if(!tb)return m.a.instance.xa(540120285,1,2,"Feature helper is null"),!1;tb.hq(179);return tb.isFeatureEnabled(179)}kG(tb,yb){tb.jm.runtime.hG("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+yb);var rc=yb===k.a.Ra(f.a.rowSpan)||yb===k.a.Ra(f.a.colSpan)||
yb===k.a.Ra(f.a.ghostCell);this.mQ(tb.jm.runtime.Ka)&&(rc=rc||yb===k.a.Ra(la.a.NZa)||yb===k.a.Ra(la.a.dUa));if(!this.gdc(tb.jm.runtime.Ka))return!rc;var fc=tb.wo.value.Uv,uc=wa.e(tb.jm,fc,null);if(uc.equals(R.a.nil))return m.a.instance.xa(573845783,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",fc.id),tb.jm.logger.Fg(Object.assign(new ya.a,{info:"Table node ID could not be found for table cell"})),!1;var Uc=tb.jm.runtime.c5b.J(uc).J(fc.id);if(!Uc)return!rc;fc=tb.Gl;uc=tb.Mc;
if(yb===k.a.Ra(f.a.ghostCell))return uc.setPropertyBool(fc,f.a.ghostCell,Uc.we),tb.hg.add(k.a.Ra(f.a.ghostCell)),!0;if(yb===k.a.Ra(f.a.rowSpan))return yb=Uc.rowSpan,Uc=Uc.colSpan,null!=yb&&null!=Uc&&(1<yb||1<Uc)?uc.setPropertyUint32(fc,f.a.rowSpan,yb):fc.removeProperty(f.a.rowSpan),tb.hg.add(k.a.Ra(f.a.rowSpan)),!0;if(yb===k.a.Ra(f.a.colSpan))return yb=Uc.rowSpan,rc=Uc.colSpan,Uc=Uc.we,null!=yb&&null!=rc&&(1<yb||1<rc)?uc.setPropertyUint32(fc,f.a.colSpan,rc):Uc&&null!=rc?uc.setPropertyUint32(fc,f.a.colSpan,
rc):fc.removeProperty(f.a.colSpan),tb.hg.add(k.a.Ra(f.a.colSpan)),!0;m.a.instance.xa(573690910,1,2,"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property whose merge strategy is not custom merge. PropertyID:{0}",yb);tb.jm.logger.Fg(Object.assign(new ya.a,{info:"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property which should not be custom merged"}));return!rc}static ai(){return new Fa}static get instance(){return Fa.Gh.value}}Fa.Gh=new c.a(Fa.ai);Object(C.a)(Fa,
"TableCellNodeComplexMerge",u.a,[]);class bb extends u.a{constructor(){super()}get Dp(){return 24}gdc(tb){if(!tb)return m.a.instance.xa(573845782,1,2,"Feature helper is null"),!1;tb.hq(177);return tb.isFeatureEnabled(177)}get HF(){return 0}El(){const tb=super.El();tb.$(k.a.Ra(t.a.jf),1);tb.$(k.a.Ra(t.a.yO),1);tb.$(k.a.Ra(t.a.kua),1);tb.$(k.a.Ra(f.a.Aub),1);tb.$(k.a.Ra(f.a.u5),1);tb.$(k.a.Ra(f.a.Y9a),2);tb.$(k.a.Ra(f.a.ivb),2);tb.$(k.a.Ra(f.a.mLa),2);return tb}kG(tb,yb){tb.jm.runtime.hG("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+
yb);if(yb===k.a.Ra(t.a.jf)||yb===k.a.Ra(t.a.yO)||yb===k.a.Ra(f.a.Aub)||yb===k.a.Ra(f.a.u5)||yb===k.a.Ra(t.a.kua)){const uc=tb.Gl;var rc=tb.Mc;m.a.instance.xa(4273303,1,3,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",uc.id,uc.Jb,yb);if(this.Jbl(tb))return!1;var fc=rc.getPropertyObjectIds(tb.vg.value.Uv,t.a.jf);const Uc=rc.getPropertyObjectIds(tb.vg.value.We,t.a.jf),tc=rc.getPropertyObjectIds(tb.wo.value.We,t.a.jf);fc=this.h4i(fc,Uc,tc,(Tb,qb)=>Tb.equals(qb));
if(0<fc.length)return rc.setPropertyObjectIds(uc,t.a.jf,fc),rc.setPropertyInt32(uc,t.a.kua,fc.length),this.gdc(tb.jm.runtime.Ka)&&({value:yb}=tb.wo.value.Pna.Ab(k.a.Ra(t.a.yO)),{value:rc}=tb.vg.value.Pna.Ab(k.a.Ra(t.a.yO)),yb.pY?uc.c1(t.a.yO,yb.newValue):uc.c1(t.a.yO,rc.newValue)),tb.hg.add(k.a.Ra(t.a.jf)),tb.hg.add(k.a.Ra(t.a.yO)),tb.hg.add(k.a.Ra(t.a.kua)),tb.hg.add(k.a.Ra(f.a.Aub)),tb.hg.add(k.a.Ra(f.a.u5)),!0}m.a.instance.xa(4018189,1,3,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
tb.vg.value.We.id,yb);return!1}Jbl(tb){const yb=tb.wo.value,rc=tb.vg.value;let fc,uc;({value:fc}=yb.Pna.Ab(k.a.Ra(t.a.yO)));({value:uc}=rc.Pna.Ab(k.a.Ra(t.a.yO)));return fc.pY||uc.pY?fc.pY&&uc.pY?(m.a.instance.xa(4273304,1,3,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",fc.oldValue,uc.newValue,fc.newValue),tb.jm.logger.Fg(Object.assign(new ya.a,{wj:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),
!0):bb.whi(tb.jm,fc,rc,"BaseConflict")||bb.whi(tb.jm,uc,yb,"BaseFavored")?!0:!1:!1}static ai(){return new bb}static get instance(){return bb.Gh.value}static whi(tb,yb,rc,fc){return yb.pY&&({value:yb}=rc.Pna.Ab(k.a.Ra(t.a.jf)),yb.pY)?(m.a.instance.xa(4273305,1,3,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",fc),tb.logger.Fg(Object.assign(new ya.a,{wj:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}bb.Gh=new c.a(bb.ai);
Object(C.a)(bb,"TableNodeComplexMerge",u.a,[]);class Eb extends u.a{constructor(){super()}get Dp(){return 25}get HF(){return 0}El(){const tb=super.El();tb.$(k.a.Ra(f.a.Ob),3);tb.$(k.a.Ra(t.a.jf),4);tb.$(k.a.Ra(f.a.Y9a),2);tb.$(k.a.Ra(f.a.ivb),2);tb.$(k.a.Ra(f.a.mLa),2);tb.$(k.a.Ra(la.a.U0e),2);tb.$(k.a.Ra(la.a.T0e),2);tb.$(k.a.Ra(f.a.MYa),5);return tb}static ai(){return new Eb}static get instance(){return Eb.Gh.value}}Eb.Gh=new c.a(Eb.ai);Object(C.a)(Eb,"TableRowNodeComplexMerge",u.a,[]);class hb extends u.a{constructor(){super()}El(){const tb=
super.El();tb.$(k.a.Ra(f.a.cIj),2);tb.$(k.a.Ra(t.a.jf),1);return tb}kG(tb,yb){if(yb===k.a.Ra(t.a.jf)){const fc=tb.Gl,uc=tb.Mc;m.a.instance.xa(42754251,1,3,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",fc.id,fc.Jb,yb);var rc=uc.getPropertyObjectIds(tb.vg.value.Uv,t.a.jf);const Uc=uc.getPropertyObjectIds(tb.vg.value.We,t.a.jf),tc=uc.getPropertyObjectIds(tb.wo.value.We,t.a.jf);if(rc=this.uwm(rc,Uc,tc))return 0<rc.length?uc.setPropertyObjectIds(fc,
t.a.jf,rc):fc.removeProperty(t.a.jf),tb.hg.add(k.a.Ra(t.a.jf)),!0}m.a.instance.xa(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.vg.value.We.id,yb);return!1}uwm(tb,yb,rc){const fc=new D.a(0);tb.forEach(Uc=>{fc.$(Uc,0);return!0});yb.forEach(Uc=>{fc.Na(Uc)?fc.$(Uc,1):fc.$(Uc,3);return!0});rc.forEach(Uc=>{let tc;({value:tc}=fc.Ab(Uc)).returnValue?1===tc?fc.$(Uc,5):3===tc?(m.a.instance.xa(42754253,1,2,"TaskNode was found added by both sides of merge"),
fc.$(Uc,3)):fc.$(Uc,2):fc.$(Uc,4);return!0});const uc=new M.a;fc.forEach((Uc,tc)=>{0!==tc&&2!==tc&&1!==tc&&uc.add(Uc);return!0});return uc}static ai(){return new hb}static get instance(){return hb.Gh.value}}hb.Gh=new c.a(hb.ai);Object(C.a)(hb,"TaskContentNodeComplexMerge",u.a,[]);class nb{equals(tb,yb){return tb&&yb?tb.UserId===yb.UserId&&tb.Provider===yb.Provider&&tb.DisplayName===yb.DisplayName&&tb.Email===yb.Email:!tb&&!yb}Nx(){return 0}}Object(C.a)(nb,"CommentTaskPersonComparer",null,[159]);class Pb{equals(tb,
yb){return tb&&yb?tb.startDate?tb.endDate?tb.startDate.getTime()===yb.startDate.getTime()&&tb.endDate.getTime()===yb.endDate.getTime():!yb.endDate:!yb.startDate:!tb&&!yb}Nx(){return 0}}Object(C.a)(Pb,"CommentTaskScheduleEqualityComparer",null,[159]);class bc{equals(tb,yb){if(!tb||!yb)return!tb&&!yb;if(!tb.extensions&&!yb.extensions)return!0;if(!tb.extensions||!yb.extensions||tb.extensions.count!==yb.extensions.count)return!1;let rc=!0;tb.extensions.forEach((fc,uc)=>{let Uc;return({value:Uc}=yb.extensions.Ab(fc)).returnValue&&
uc===Uc?!0:rc=!1});return rc}Nx(){return 0}}Object(C.a)(bc,"ExtensionListEqualityComparer",null,[159]);class gb{Fgl(tb,yb){return tb&&yb?tb.recordId===yb.recordId&&gb.Arh.equals(tb.user,yb.user)&&gb.Arh.equals(tb.assignee,yb.assignee)&&tb.type===yb.type&&tb.title===yb.title&&tb.priority===yb.priority&&tb.isLossy===yb.isLossy&&tb.completion===yb.completion&&tb.commentId===yb.commentId&&tb.time===yb.time&&gb.E5j.equals(tb.schedule,yb.schedule):!tb&&!yb}equals(tb,yb){return this.Fgl(tb,yb)}Nx(){return 0}}
gb.Arh=new nb;gb.E5j=new Pb;new bc;Object(C.a)(gb,"HistoryRecordEqualityComparer",null,[159]);var Lb=b(1802),Ic=b(1358);class vb extends u.a{constructor(tb){super();this.O1a=tb}El(){const tb=super.El();tb.$(k.a.Ra(f.a.JOb),5);tb.$(k.a.Ra(f.a.taskId),2);tb.$(k.a.Ra(f.a.WHj),2);tb.$(k.a.Ra(f.a.ZHj),2);tb.$(k.a.Ra(f.a.yDa),1);return tb}Lbh(tb){if(!tb.wo.value.Uv&&!tb.vg.value.Uv){const yb=tb.vg.value.We.AF();yb.removeProperty(f.a.yDa);const rc=tb.vg.value.We,fc=tb.wo.value.We;tb.vg=new c.a(()=>new Ic.a(yb,
rc));tb.wo=new c.a(()=>new Ic.a(yb,fc))}return super.Lbh(tb)}kG(tb,yb){if(yb!==k.a.Ra(f.a.yDa))return m.a.instance.xa(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.vg.value.We.id,yb),!1;const rc=tb.Gl,fc=tb.Mc;m.a.instance.xa(42754255,1,3,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",rc.id,rc.Jb,yb);yb=fc.getPropertyString(tb.vg.value.Uv,f.a.yDa);const uc=
fc.getPropertyString(tb.vg.value.We,f.a.yDa),Uc=fc.getPropertyString(tb.wo.value.We,f.a.yDa);yb=this.twm(yb,uc,Uc);if(!yb)return!1;0<yb.length?fc.setPropertyString(rc,f.a.yDa,yb):rc.removeProperty(f.a.yDa);tb.hg.add(k.a.Ra(f.a.yDa));return!0}twm(tb,yb,rc){tb=this.O1a.PCc(tb);yb=this.O1a.PCc(yb);rc=this.O1a.PCc(rc);if(!vb.GTi(tb,yb))return m.a.instance.xa(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),null;if(!vb.GTi(tb,rc))return m.a.instance.xa(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),
null;rc=vb.UUk(tb.length,yb,rc);return this.O1a.s_g(rc)}static ai(){const tb=new Lb.a;return new vb(tb)}static get instance(){return vb.Gh.value}static UUk(tb,yb,rc){const fc=new M.a;for(let uc=0;uc<yb.length;uc++)fc.add(yb.J(uc));for(;tb<rc.length;tb++)fc.add(rc.J(tb));return fc}static GTi(tb,yb){const rc=tb.length;if(rc>yb.length)return!1;for(let fc=0;fc<rc;fc++)if(!vb.Oak.equals(yb.J(fc),tb.J(fc)))return yb.J(fc).recordId===tb.J(fc).recordId&&m.a.instance.xa(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),
!1;return!0}}vb.Gh=new c.a(vb.ai);vb.Oak=new gb;Object(C.a)(vb,"TaskSingleNodeComplexMerge",u.a,[]);class xb extends u.a{constructor(){super()}get Dp(){return 26}El(){const tb=super.El();tb.$(k.a.Ra(t.a.jf),1);return tb}kG(tb,yb){const rc=t.a.jf;if(yb===k.a.Ra(rc)){yb=tb.Gl;const uc=tb.Mc;var fc=uc.getPropertyObjectIds(tb.vg.value.Uv,rc);const Uc=uc.getPropertyObjectIds(tb.vg.value.We,rc),tc=uc.getPropertyObjectIds(tb.wo.value.We,rc);fc=this.ywm(fc,Uc,tc);uc.setPropertyObjectIds(yb,rc,fc);tb.hg.add(k.a.Ra(rc));
return!0}return!1}ywm(tb,yb,rc){return this.O6a(tb,yb,rc)}static ai(){return new xb}static get instance(){return xb.Gh.value}}xb.Gh=new c.a(xb.ai);Object(C.a)(xb,"VectorClockContainerNodeComplexMerge",u.a,[]);class Db extends u.a{constructor(){super()}get Dp(){return 27}El(){const tb=super.El();tb.$(k.a.Ra(f.a.I5),1);return tb}kG(tb,yb){const rc=f.a.I5;if(yb===k.a.Ra(rc)){yb=tb.Gl;const fc=tb.Mc,uc=fc.getPropertyUint32(tb.vg.value.We,rc)||0,Uc=fc.getPropertyUint32(tb.wo.value.We,rc)||0;fc.setPropertyUint32(yb,
rc,this.KFl(uc,Uc));tb.hg.add(k.a.Ra(rc));return!0}return!1}KFl(tb,yb){return tb>yb?tb:yb}static ai(){return new Db}static get instance(){return Db.Gh.value}}Db.Gh=new c.a(Db.ai);Object(C.a)(Db,"VectorClockNodeComplexMerge",u.a,[]);class ab extends u.a{constructor(){super()}get Dp(){return 28}get HF(){return 0}El(){const tb=super.El();tb.$(k.a.Ra(f.a.Are),3);tb.$(k.a.Ra(f.a.Ob),3);tb.$(k.a.Ra(f.a.Shi),5);tb.$(k.a.Ra(f.a.ALe),5);tb.$(k.a.Ra(f.a.Wca),5);return tb}static ai(){return new ab}static get instance(){return ab.Gh.value}}
ab.Gh=new c.a(ab.ai);Object(C.a)(ab,"WordSectionNodeComplexMerge",u.a,[]);b.d(L,"a",function(){return dc});class dc{ici(tb,yb){switch(tb.Jb){case 131073:return tb.hasProperty(f.a.imageType)?this.ks(Ma.instance,yb):this.ks(ib.instance,yb);case 1074135140:return this.ks(r.instance,yb);case 1074135137:return this.ks(x.instance,yb);case 1074135139:return this.ks(w.instance,yb);case 1074135138:return this.ks(G.instance,yb);case 1074135136:return this.ks(A.instance,yb);case 1074135157:return this.ks(N.instance,
yb);case 1074135152:return this.ks(B.instance,yb);case 1074135153:return this.ks(P.instance,yb);case 1074135126:return this.ks(T.instance,yb);case 1074135127:return this.ks(V.instance,yb);case 1074135145:return this.ks(ha.instance,yb);case 1074135144:return this.ks(I.instance,yb);case 1074135142:return this.ks(na.instance,yb);case 1074135143:return this.ks(da.instance,yb);case 1074135163:return this.ks(ia.instance,yb);case 1074135164:return this.ks(ma.instance,yb);case 1074135124:return this.ks(qa.instance,
yb);case 1074135125:return this.ks(ka.instance,yb);case 1074135122:return this.ks(va.instance,yb);case 393233:return this.ks(Ma.instance,yb);case 1073872970:return this.ks(Ma.instance,yb);case 1074135170:return this.ks(Ha.instance,yb);case 1074135168:return this.ks(X.instance,yb);case 1074135166:return this.ks(W.instance,yb);case 1074135167:return this.ks(fa.instance,yb);case 1074135169:return this.ks(ra.instance,yb);case 1074135165:return this.ks(Aa.instance,yb);case 393234:return this.ks(Ba.instance,
yb);case 393229:return this.ks(xa.instance,yb);case 393241:return this.ks(za.instance,yb);case 393227:return this.ks(Pa.instance,yb);case 131120:return this.ks(db.instance,yb);case 393271:return this.ks(fb.instance,yb);case 393230:return this.ks(Qa.a.instance,yb);case 131140:return this.ks(Ta.instance,yb);case 1179649:return this.ks(jb.instance,yb);case 1073872969:return this.ks($a.instance,yb);case 393252:return this.ks(Fa.instance,yb);case 393250:return this.ks(bb.instance,yb);case 393251:return this.ks(Eb.instance,
yb);case 1074135154:return this.ks(xb.instance,yb);case 1074135161:return this.ks(hb.instance,yb);case 1074135162:return this.ks(vb.instance,yb);case 1074135155:return this.ks(Db.instance,yb);case 1073872968:return this.ks(ab.instance,yb)}return this.ks(u.a.instance,yb)}ks(tb,yb){tb.Ka=yb?yb():null;return tb}}Object(C.a)(dc,"GraphNodeComplexMergeFactory",null,[1871])},1719:function(C,L,b){b.r(L);C=b(0);var f=b(1334),c=b(75),u=b(265),r=b(70),t=b(1306);class k{constructor(J,F,A,N=0){this.NHi=J;this.groupType=
F;this.bfg=N;this.LRd=A}}Object(C.a)(k,"SortingGroup",null,[]);class m{constructor(J,F,A,N){this.order=J;this.fga=F;this.wUl=A;this.groupType=N}}Object(C.a)(m,"SortingProp",null,[]);var l=b(1295),x=b(1299),w=b(1294),G=b(1285);class D{constructor(J,F){this.t2i={};this.s2i={};this.o2i=this.A2i=1;this.y2h(J,F)}Ixn(J,F,A){var N=w.a.O7(A)?this.t2i:this.s2i;A=new c.a;for(var B of F)F=Object(r.a)(m,N[f.a[B.groupType].toLowerCase()]),G.c(F)||A.add(new u.a(F,B));A.Sc((P,T)=>P.key.order<T.key.order?-1:1);Array.clear(J);
B=l.TellMeActor.instance.y6;for(F=0;F<A.count;){N=A.J(F).key.fga;var E=A.J(F).value;const P=new t.a(A.J(F).key.groupType);G.c(B)||B.Location===x.a.contextMenu||(P.displayName=A.J(F).key.wUl);for(const T of E.results)P.DB(T);for(E=++F;E<A.count&&A.J(E).key.fga===N;)this.NBf(P,A.J(E).value),E=++F;J.push(P)}}dPn(J,F){this.o2i=this.A2i=1;this.y2h(J,F)}y2h(J,F){this.eEj(J);for(var A=0;A<J.length;A++){let N=J[A];for(const B of N.LRd)this.Zuk(B,A,N.NHi,N.groupType)}this.eEj(F);for(J=0;J<F.length;J++){A=
F[J];for(const N of A.LRd)this.Yuk(N,J,A.NHi,A.groupType)}}eEj(J){J.sort((F,A)=>Object(r.a)(k,F).bfg>Object(r.a)(k,A).bfg?-1:1)}Zuk(J,F,A,N){this.t2i[f.a[J].toLowerCase()]=new m(this.A2i++,F,A,N)}Yuk(J,F,A,N){this.s2i[f.a[J].toLowerCase()]=new m(this.o2i++,F,A,N)}NBf(J,F){for(let A=0;A<F.results.length;A++)J.DB(F.results[A])}}Object(C.a)(D,"BaseGroupingSorter",null,[]);class H{constructor(){this.TKe=[new k(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new k(CommonUIStrings.l_TellMeSuggestionsProviderTitle,
28,[18,16,7,15,19,3]),new k("",13,[13]),new k("",22,[22])];this.PKe=[new k(CommonUIStrings.l_TellMeCommandProviderTitle,26,[17,0,1,8]),new k(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,27,[2,19,23]),new k(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,28,[15,14,20,9,12,10,11,24]),new k("",13,[13]),new k("",22,[22])];this.b2i=new D(this.TKe,this.PKe)}oWd(J,F,A,N=null,B=null){let E=!1;if(N){for(const P of w.a.O7(A)?this.TKe:this.PKe)this.BZm(P,N);E=!0}if(B){for(const P of w.a.O7(A)?
this.TKe:this.PKe)this.ePn(F,P,B);E=!0}E&&this.b2i.dPn(this.TKe,this.PKe);this.b2i.Ixn(J,F,A)}BZm(J,F){const A=new c.a;for(var N of J.LRd){const B=F[f.a[N].toLowerCase()];A.add(new u.a(G.c(B)?Number.MAX_VALUE:B,N))}if(A.count){A.Sc((B,E)=>B.key<E.key?-1:1);F=Array(A.count);for(N=0;N<A.count;N++)F[N]=A.J(N).value;J.LRd=F}}ePn(J,F,A){let N=0;for(const B of F.LRd)if(f.a[B].toLowerCase()in A&&A[f.a[B].toLowerCase()])for(const E of J)if(E.groupType===B){N+=A[f.a[B].toLowerCase()];break}F.bfg=N}}Object(C.a)(H,
"SimplifiedGroupingSorter",null,[]);b.d(L,"GroupsPlacementInfo",function(){return M});class M{constructor(J){this.r2i={};this.p2i={};this.q2i={};this.u2i={};this.Byg={};this.v2i=this.Qsm=this.Ksm=this.Msm=1;this.x2i=null;this.bO=J;this.PKk();this.GRm();this.sKk();this.kJk();J.K8&&(this.x2i=new H)}gP(J){this.r2i[f.a[J].toLowerCase()]=this.Msm++}qU(J,F){this.p2i[f.a[J].toLowerCase()]=F}h2a(J){this.q2i[f.a[J].toLowerCase()]=this.Ksm++}kaa(J){this.u2i[f.a[J].toLowerCase()]=this.Qsm++}NJ(J){this.Byg[f.a[J].toLowerCase()]=
this.v2i++}PKk(){const J=!!this.bO&&this.bO.lpb,F=!!this.bO&&this.bO.dLd,A=!!this.bO&&this.bO.mpb,N=!!this.bO&&this.bO.Jsg&&!w.a.$cc(),B=!!this.bO&&this.bO.UEd,E=!!this.bO&&this.bO.Tlg;this.gP(4);this.gP(18);this.gP(16);this.gP(7);this.gP(17);this.gP(0);this.gP(1);B&&this.gP(23);J||this.gP(2);J&&!F||this.gP(8);this.gP(15);A&&this.gP(20);this.gP(14);this.gP(9);this.gP(12);this.gP(10);this.gP(11);J&&this.gP(2);J&&!F&&this.gP(8);this.gP(19);E&&this.gP(24);this.gP(21);this.gP(13);N&&this.gP(22)}GRm(){this.qU(21,
1);this.qU(4,3);this.qU(18,3);this.qU(16,3);this.qU(7,3);this.qU(17,5);this.qU(0,5);this.qU(1,1);this.qU(2,1);this.qU(8,2);this.qU(15,3);this.qU(14,2);this.qU(24,3);this.qU(9,1);this.qU(12,1);this.qU(10,1);this.qU(11,1);this.qU(19,1);this.qU(23,1);this.qU(13,1);this.qU(20,2);this.qU(22,1)}sKk(){this.h2a(4);this.h2a(0);this.h2a(17);this.h2a(7);this.h2a(16);this.h2a(18);this.h2a(15);this.h2a(20);this.h2a(8);this.h2a(14)}kJk(){this.kaa(14);this.kaa(10);this.kaa(12);this.kaa(9);this.kaa(11);this.kaa(20);
this.kaa(15);this.kaa(8);this.kaa(2);this.kaa(1);this.kaa(24);this.kaa(7);this.kaa(18);this.kaa(16);this.kaa(17);this.kaa(0);this.kaa(4)}Yan(){this.Byg={};this.v2i=1}eNl(J,F,A){this.Yan();const N=!!this.bO&&this.bO.lpb,B=!!this.bO&&this.bO.dLd,E=!!this.bO&&this.bO.mpb,P=!!this.bO&&this.bO.Jsg&&!w.a.$cc(),T=!!this.bO&&this.bO.UEd,V=!!this.bO&&this.bO.Tlg;J=J&&B;this.NJ(4);this.NJ(18);this.NJ(16);this.NJ(7);this.NJ(17);this.NJ(0);this.NJ(1);T&&this.NJ(23);N&&!B||!J||this.NJ(8);F&&this.NJ(15);N||this.NJ(2);
V&&this.NJ(24);A&&this.NJ(14);N&&!B||J||this.NJ(8);F||this.NJ(15);E&&this.NJ(20);A||this.NJ(14);this.NJ(9);this.NJ(12);this.NJ(10);this.NJ(11);N&&this.NJ(2);N&&!B&&this.NJ(8);this.NJ(19);this.NJ(21);this.NJ(13);P&&this.NJ(22);return this.Byg}WU(){return this.bO}}Object(C.a)(M,"GroupsPlacementInfo",null,[])},1721:function(C,L,b){C=b(0);var f=b(1596),c=b(51);class u{constructor(){this.source=0;this.gl=this.VLa=this.nda=null;this.rca=0;this.mIc=!1;this.mode=this.r9a=0;this.jrd=null;this.mfc=c.a.create()}}
Object(C.a)(u,"InputState",null,[]);class r{constructor(){this.timeout=this.succeeded=this.crash=!1;this.NS=null}}Object(C.a)(r,"OutputState",null,[]);class t{constructor(){this.hNi=this.bZe=this.oVd=!1;this.Ka=this.yLe=this.pLg=this.Iic=this.C9g=this.c5b=this.O2a=this.hG=this.GJb=this.qTc=this.xch=this.Qil=this.zm=this.hVf=this.Kr=this.Zu=this.pk=this.c3e=this.Tte=this.MRa=null}}Object(C.a)(t,"RuntimeState",null,[]);b.d(L,"a",function(){return k});class k{constructor(){this.input=new u;this.runtime=
new t;this.output=new r;this.logger=new f.a(this)}}Object(C.a)(k,"MergeState",null,[])},1722:function(C,L,b){b.r(L);C=b(0);var f=b(577),c=b(199),u=b(146),r=b(244),t=b(1446),k=b(1550),m=b(1576),l=b(6),x=b(1713);class w{constructor(A,N){this.start=A;this.end=N}}Object(C.a)(w,"MergeDiffIdx",null,[]);class G{constructor(A,N,B,E=!1,P=null,T=null,V=!0){this.z5d=this.y5d=this.Tth=this.I7c=0;this.zxc=this.R9e=null;this.Kyb=P||new x.a;this.Mg=B;this.vEa=A.I8();this.nrk=N.I8();this.VV=new w(0,0);this.$Z=new w(0,
0);this.Chf=E;this.A3c=V;this.YEa=T;this.rMk();this.umn()}get mP(){return this.vEa}get FO(){return this.nrk}get cC(){return this.I7c}get ZC(){return this.Tth}get oHa(){return this.y5d}get Yya(){return this.z5d}get V$k(){const A=new c.a;for(let N=this.R9e.start;N<this.R9e.end;N++)A.add(this.mP.Rf(N));return A}get MWf(){const A=new c.a;for(let N=this.zxc.start;N<this.zxc.end;N++)A.add(this.FO.Rf(N));return A}$Xf(A){if(this.ZC<A.ZC){if(this.ZC+this.oHa>A.ZC)return!0}else if(this.ZC>A.ZC){if(A.ZC+A.oHa>
this.ZC)return!0}else if(2===this.cC&&3===A.cC||3===this.cC&&2===A.cC||2===this.cC&&2===A.cC||3===this.cC&&3===A.cC)return!0;return!1}Hpj(A,N,B,E){A.wI(N);A.$B(N,B);return E+=B.length-1}xEj(A,N,B,E,P){let T=this.mP.Rf(A),V=this.FO.Rf(N);if(!T||!V||!T.pub&&!V.pub)return{returnValue:!1,jRa:E,zZa:P};let I=new c.a,R=new c.a;T.pub&&(I=T.HWd(),T=I.Rf(B?0:I.length-1));V.pub&&(R=V.HWd(),V=R.Rf(B?0:R.length-1));if(!T.jD(V,this.Kyb,this.YEa,this.Chf,this.A3c))return{returnValue:!1,jRa:E,zZa:P};I.length&&(E=
this.Hpj(this.mP,A,I,E));R.length&&(P=this.Hpj(this.FO,N,R,P));return{returnValue:!0,jRa:E,zZa:P}}ykl(A,N,B,E,P,T){for(;P<=B&&T<=E;){const V=A.Rf(P),I=N.Rf(T);if(!V.jD(I,this.Kyb,this.YEa,this.Chf,this.A3c))break;this.VV.start+=V.length;this.$Z.start+=I.length;P++;T++}return{OGf:P,vdh:T}}wkl(A,N,B,E,P,T){for(;P>=B&&T>=E;){const V=A.Rf(P),I=N.Rf(T);if(!V.jD(I,this.Kyb,this.YEa,this.Chf,this.A3c))return{returnValue:!0,jRa:P,zZa:T};P--;T--}return{returnValue:!1,jRa:P,zZa:T}}xkl(A,N,B,E){let P=!1;do({OGf:A,
vdh:N}=this.ykl(this.mP,this.FO,B,E,A,N)),{jRa:B,zZa:E,returnValue:P}=this.xEj(A,N,!0,B,E);while(P);return{OGf:A,vdh:N,jRa:B,zZa:E}}vkl(A,N,B,E){let P=!1;do{if(!({jRa:B,zZa:E}=this.wkl(this.mP,this.FO,A,N,B,E)).returnValue)break;({jRa:B,zZa:E,returnValue:P}=this.xEj(B,E,!1,B,E))}while(P);return{jRa:B,zZa:E}}rMk(){var A=0,N=0,B=this.mP.length-1,E=this.FO.length-1;0<=B&&this.mP.Rf(B);0<=E&&this.FO.Rf(E);({OGf:A,vdh:N,jRa:B,zZa:E}=this.xkl(A,N,B,E));if(A<B||N<E)({jRa:B,zZa:E}=this.vkl(A,N,B,E));B++;
E++;this.R9e=new w(A,B);this.zxc=new w(N,E);this.VV.end=this.VV.start;this.$Z.end=this.$Z.start;for(var P=A;P<B;P++){var T=this.mP.Rf(P);this.VV.end+=T.length}for(P=N;P<E;P++)T=this.FO.Rf(P),this.$Z.end+=T.length;u.a.instance.xa(3993809,1,3,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",A,B,N,E);u.a.instance.xa(3993810,1,3,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",
this.VV.start,this.VV.end,this.$Z.start,this.$Z.end);this.VV.start<=this.VV.end&&this.$Z.start<=this.$Z.end&&(A=this.mP.Rf(A),N=this.FO.Rf(N),P=this.mP.Rf(B),T=this.FO.Rf(E),B=this.mP.Rf(B-1),E=this.FO.Rf(E-1),u.a.instance.xa(3993811,1,3,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",A,P,N,T,B,E))}umn(){this.Tth=this.VV.start;this.y5d=this.z5d=0;this.VV.start===this.VV.end&&this.$Z.start===
this.$Z.end?this.I7c=0:this.VV.start===this.VV.end&&this.$Z.start<this.$Z.end?(this.I7c=1,this.z5d=this.$Z.end-this.$Z.start):this.$Z.start===this.$Z.end&&this.VV.start<this.VV.end?(this.I7c=2,this.y5d=this.VV.end-this.VV.start):(this.I7c=3,this.y5d=this.VV.end-this.VV.start,this.z5d=this.$Z.end-this.$Z.start);u.a.instance.xa(3993814,1,3,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",this.cC,this.ZC,this.oHa,this.Yya)}xcm(A,N){return A.eca()&&
N.eca()?A.runId===N.runId&&A.zf===N.zf:!1}agm(A){if(!A.eca()||"\ufffc"!==A.text)return!1;A=A.t8b;return A?A.hasProperty(l.a.vi)||A.hasProperty(l.a.Nhb)||A.hasProperty(l.a.Hpd)||A.hasProperty(l.a.Vfa)||A.hasProperty(l.a.imageType)||A.hasProperty(l.a.Bga)||A.hasProperty(l.a.h6a)||A.hasProperty(l.a.Jp)&&(A=this.Mg.getPropertyInt32(A,l.a.Jp))&&(36===A||35===A||24===A||23===A||33===A||34===A||44===A||45===A||42===A||43===A)?!0:!1:!1}zDd(A){return A.eca()&&!this.agm(A)}MNk(){if(2===this.cC)return!1;var A=
this.zxc.start;if(!A)return!1;let N=null;for(var B=this.zxc.start;B<this.zxc.end;B++){const E=this.FO.Rf(B);if(this.zDd(E)){N=E;break}}if(!N)return!1;--A;for(B=this.FO.Rf(A);B&&!this.zDd(B);)A--,B=this.FO.Rf(A);return B&&this.xcm(B,N)?!0:!1}Pxi(A){const N=new c.a;for(let B=0;B<A.length;B++)A.J(B).pub?N.$B(N.length,A.J(B).HWd()):N.insert(N.length,A.J(B));return N}zcm(){if(3!==this.cC||this.oHa!==this.Yya)return!1;const A=this.Pxi(this.V$k),N=this.Pxi(this.MWf);if(A.length!==N.length)return!1;for(let B=
0;B<A.length;B++)if(!A.J(B).jD(N.J(B),this.Kyb,this.YEa,!0,this.A3c))return!1;return!0}ycm(){if(0!==this.cC&&3!==this.cC||this.mP.length!==this.FO.length)return!1;let A=!1;for(let N=0;N<this.mP.length;N++){if(!this.mP.J(N).jD(this.FO.J(N),this.Kyb,this.YEa,!0,this.A3c))return!1;if(3===this.mP.J(N).type||1===this.mP.J(N).type){const B=this.mP.J(N),E=this.FO.J(N);A=B.runId!==E.runId||B.zf!==E.zf||A}}return A}}Object(C.a)(G,"MergeBlockDiff",null,[]);var D=b(1396);class H{constructor(A,N){this.id=A;this.index=
N}}Object(C.a)(H,"ParagraphStartIndex",null,[]);var M=b(1459),J=b(1377);b.d(L,"ParagraphMerge",function(){return F});class F{constructor(A,N,B,E,P,T,V){this.Zvc=this.GYb=this.nq=this.Az=null;this.wh=!1;this.XQh=this.Rvh=this.bph=this.iGa=this.$_a=this.vEa=null;this.Ld=A;this.nJ=N;this.nQa=E;this.yNa=B;this.XEa=P;this.YEa=T;this.Mg=V}WCi(A){const N=new f.a;A.mP.forEach(B=>{2===B.type&&N.add(B.Vj);return!0});A.FO.forEach(B=>{2===B.type&&N.remove(B.Vj);return!0});return N}gAi(A){const N=new c.a;A.FO.forEach(B=>
{2===B.type&&N.add(B.Vj);return!0});return N}A9h(A){const N=new c.a;let B=0,E=0;A.FO.forEach(P=>{2===P.type&&(N.add(new H(P.Vj,B<A.ZC?B:B<A.ZC+A.Yya?A.ZC:B-A.Yya+A.oHa)),B=E);E+=P.length;return!0});return N}yWk(A,N){var B=this.A9h(A);const E=this.A9h(N);A=this.WCi(A);const P=this.WCi(N);N=new c.a;const T=new f.a;let V=0;for(let I=0;I<B.length;I++){const R=B.J(I);if(V<E.length){let ba=E.J(V);for(;V<E.length&&ba.index<=R.index;){if(ba.id.equals(R.id)){V++;break}A.contains(ba.id)||T.contains(ba.id)||
(N.add(ba.id),T.add(ba.id));V++;ba=E.J(V)}}P.contains(R.id)||(N.add(R.id),T.add(R.id))}for(;V<E.length;)B=E.J(V),A.contains(B.id)||T.contains(B.id)||(N.add(B.id),T.add(B.id)),V++;return N}initialize(){if(this.wh){const A=!!this.Az&&!!this.nq;this.Ld.logger.Fg(Object.assign(new D.a,{wj:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return A}this.wh=!0;if(!({mP:this.vEa,ird:this.$_a,a_d:this.iGa,Fke:this.bph,Ute:this.Rvh,d3e:this.XQh}=J.a.Cci(this.Ld,this.Mg,this.nJ,this.yNa,
this.nQa,this.XEa,!1,!1)).returnValue)return!1;this.Az=new G(this.vEa,this.$_a,this.Mg,void 0,void 0,this.YEa);this.nq=new G(this.vEa,this.iGa,this.Mg,void 0,void 0,this.YEa);u.a.instance.xa(593272919,1,3,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",this.Az.oHa,this.Az.Yya,this.nq.oHa,this.nq.Yya));return!0}pZa(){u.a.instance.xa(593826836,1,3,"Attempting to merge with LCS");let A=!1;const N=new m.a(this.Mg,this.Ld);let B=null,
E=null;var P=null;const T=I=>this.Ld.runtime.pk.J(I),V=I=>this.Ld.runtime.Kr.J(I)||this.Ld.runtime.pk.J(I);this.Az=new G(this.vEa,this.$_a,this.Mg,void 0,void 0,this.YEa,!1);this.nq=new G(this.vEa,this.iGa,this.Mg,void 0,void 0,this.YEa,!1);({updateHints:B}=N.Sdi(this.nJ,T,this.yNa,I=>this.Ld.runtime.Zu.J(I)||this.Ld.runtime.pk.J(I),this.Az.ZC,this.Az.ZC+this.Az.oHa,this.Az.ZC+this.Az.Yya)).returnValue&&({updateHints:E}=N.Sdi(this.nJ,T,this.nQa,V,this.nq.ZC,this.nq.ZC+this.nq.oHa,this.nq.ZC+this.nq.Yya)).returnValue&&
(A=!0);A||(u.a.instance.xa(593826835,1,2,"Failed to create update hints with LCS"),A=!1);A&&(P=new M.a(this.Ld,this.nJ,this.yNa,this.nQa,I=>this.Ld.runtime.Ka?this.Ld.runtime.Ka.isFeatureEnabled(I):!1,this.Mg,null,B,E),({zm:P}=P.WUc()).returnValue||(u.a.instance.xa(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),this.Ld.logger.Fg(Object.assign(new D.a,{wj:"TryLCSMerge",eventId:"9zrqs"})),A=!1));u.a.instance.xa(593826833,1,A?3:2,"TryLCSMerge: [Success: {0}]",A);return{returnValue:A,
zm:P}}WUc(){let A;A=null;if(!this.initialize())return this.Ld.logger.A0("ParagraphMerge Initialize"),this.Qpb(),{returnValue:!1,zm:A};this.Ld.logger.A0("ParagraphMerge Initialize");let N;this.Ld.logger.RXe(2);let B=({pZa:N}=this.Wbl()).returnValue;B=B&&({zm:A,pZa:N}=this.nvd(this.Ld,this.Mg,this.XEa,this.Zvc,this.GYb)).returnValue;this.Ld.logger.q1g();if(!B){this.Ld.logger.A0("ParagraphMerge DoMergeInteral");if(N){this.Ld.logger.RXe(3);({zm:A,returnValue:B}=this.pZa());this.Ld.logger.q1g();if(B)return{returnValue:!0,
zm:A};this.Qpb();return{returnValue:!1,zm:A}}this.Qpb();return{returnValue:!1,zm:A}}if(!({zm:A,pZa:N}=this.nvd(this.Ld,this.Mg,this.XEa,this.Zvc,this.GYb)).returnValue)return this.Ld.logger.A0("ParagraphMerge DoMergeInteral"),this.Qpb(),{returnValue:!1,zm:A};this.Ld.logger.A0("ParagraphMerge DoMergeInteral");return{returnValue:!0,zm:A}}nvd(){let A;if(!({xQe:A}=J.a.nvd(this.Ld,this.Mg,this.XEa,this.Zvc,this.GYb)).returnValue)return this.Ld.logger.A0("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),
this.Qpb(),{returnValue:!1,zm:A,pZa:!0};this.Ld.logger.A0("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,zm:A,pZa:!1}}Qpb(A=!1){u.a.instance.Z8(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+A+"] BaseRevisionMergeBlocksList: {0}",this.bph);u.a.instance.Z8(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",this.Rvh);u.a.instance.Z8(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.XQh);A=new c.a;J.a.aMc(this.Mg,"BaseObjects_",this.nJ,A);J.a.aMc(this.Mg,"FavoredObjects_",
this.yNa,A);J.a.aMc(this.Mg,"ConflictObjects_",this.nQa,A);J.a.bnm(this.Ld,A)}M3h(A){let N,B;B=N=0;if(0===this.Az.cC)N=this.nq.ZC;else if(1===this.Az.cC)N=this.nq.ZC<this.Az.ZC?this.nq.ZC:this.nq.ZC===this.Az.ZC?A||1!==this.nq.cC?this.nq.ZC+this.Az.Yya:this.nq.ZC:this.nq.ZC+this.Az.Yya;else if(2===this.Az.cC||3===this.Az.cC)N=this.nq.ZC<=this.Az.ZC?this.nq.ZC:this.nq.ZC+(this.Az.Yya-this.Az.oHa);if(2===this.nq.cC||3===this.nq.cC)B=N+this.nq.oHa;return{tHi:N,fUl:B}}woi(A,N){let B;B=0;if(!N)return{returnValue:!0,
bJd:B};let E=0,P=0;for(;E<A.length;){let T;for(let V=E;V<A.length;V++){E=V;T=A.J(V);const I=T.length;P+=I;if(!(P<N)){if(P>N)if(T.pub)A.wI(E),A.$B(E,T.HWd()),P-=I;else return u.a.instance.xa(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",N),this.Ld.logger.Fg(Object.assign(new D.a,{wj:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,bJd:B};break}}if(P===N)return E++,
B=E,{returnValue:!0,bJd:B}}u.a.instance.xa(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",N);this.Ld.logger.Fg(Object.assign(new D.a,{wj:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,bJd:B}}sEk(A,N,B){let E=0;var P=0,T=!1;const V=this.nq.MWf.I8();if(this.nq.MNk())for(--N;0<=N;N--){let I=A.J(N);if(this.nq.zDd(I)){P=A.J(N);E=P.runId;P=P.zf;T=!0;break}}T||((P=A.J(B))&&this.nq.zDd(P)?
(E=P.runId,P=P.zf):P=E=0);for(A=0;A<V.length;A++)B=V.J(A),B.eca()&&(T=B,this.nq.zDd(B)?(T.runId=E,T.zf=P):(T.runId=0,T.zf=0));return V}jTi(A){if(2===A.length){const N=1===A.J(0).type?A.J(0):null;A=2===A.J(1).type;if(N&&A&&""===N.text)return!0}return!1}Wbl(){const A=this.Az.ycm();if(!A&&0===this.Az.cC)return this.Zvc=this.nq.FO.I8(),this.GYb=this.gAi(this.nq),{returnValue:!0,pZa:!1};if(0===this.nq.cC)return this.Zvc=this.Az.FO.I8(),this.GYb=this.gAi(this.Az),{returnValue:!0,pZa:!1};(this.jTi(this.Az.FO)||
this.jTi(this.nq.FO))&&this.Ld.logger.P_i(Object.assign(new D.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!A){var N=this.Az.$Xf(this.nq);N&&this.XEa(92)&&(u.a.instance.xa(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.Az=new G(this.vEa,this.$_a,this.Mg,!0,void 0,this.YEa),this.nq=new G(this.vEa,this.iGa,this.Mg,!0,void 0,this.YEa),N=this.Az.$Xf(this.nq));if(N)return u.a.instance.xa(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),
this.Ld.logger.Fg(Object.assign(new k.a,{wj:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,pZa:!0}}var B;N=0;this.GYb=this.yWk(this.Az,this.nq);({tHi:B,fUl:P}=this.M3h(!1));const E=this.Az.FO.I8();if(!({bJd:B}=this.woi(E,B)).returnValue||(2===this.nq.cC||3===this.nq.cC)&&!({bJd:N}=this.woi(E,P)).returnValue)return{returnValue:!1,pZa:!1};if(2===this.nq.cC||3===this.nq.cC){this.dSc(E,N);this.dSc(E,B-1);var P=null;for(var T=N-1;T>=B;T--)2===E.J(T).type&&(P=E.J(T)),E.wI(T);0<E.length&&(T=E.J(E.length-
1),2!==T.type&&4!==T.type&&P&&(this.Ld.runtime.Ka.hq(125),this.Ld.runtime.Ka.isFeatureEnabled(125)&&(E.add(P),this.GYb.add(P.Vj))));u.a.instance.xa(4019726,1,3,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",N-B-1,B)}if(1===this.nq.cC||3===this.nq.cC)P=this.nq.MWf,A&&(P=this.sEk(E,B,N)),this.dSc(E,B-1),this.dSc(E,B),this.dSc(P,0),this.dSc(P,P.length-1),E.$B(B,P),u.a.instance.xa(4019727,1,3,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",
B,A,P.Dr());this.Zvc=E;return{returnValue:!0,pZa:!1}}dSc(A,N){0>N||N>=A.length||(A=A.J(N),Object(r.a)(t.a,A)&&(A.$5a=!0))}v_d(A,N){let B;B=N;if(!this.initialize())return{returnValue:!1,Bsb:A,KCa:B};if(this.nq.$Xf(this.Az))return this.Qpb(!0),this.Ld.logger.Fg(Object.assign(new k.a,{wj:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,Bsb:A,KCa:B};if(0===this.nq.cC||3===this.nq.cC&&this.nq.zcm())return{returnValue:!0,Bsb:A,KCa:N};let E;({tHi:E}=this.M3h(!0));N<E||N===E&&(1!==this.nq.cC||1===
this.nq.cC&&1===this.Az.cC&&N===this.Az.ZC+this.Az.Yya)?B=N:(B=N+this.nq.Yya-this.nq.oHa,B<E&&(B=E));return{returnValue:!0,Bsb:A,KCa:B}}}Object(C.a)(F,"ParagraphMerge",null,[1780])},1723:function(C,L,b){b.r(L);C=b(0);var f=b(1469),c=b(1374),u=b(1334),r=b(1556),t=b(1373);class k{constructor(M="",J="",F="",A=-99999,N=-1,B=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=M?M:"";this.Description=J?J:"";this.Type=F?F:"";this.Score=A;this.Age=N;this.Count=B}}Object(C.a)(k,
"Suggestion",null,[]);class m{constructor(M,J){this.GroupType=this.Suggestions=null;this.Suggestions=M;this.GroupType=J}}Object(C.a)(m,"SuggestionGroup",null,[]);class l{}l.help="help";l.answer="answer";l.commands="commands";l.kin="servicecommands";l.template="template";Object(C.a)(l,"SuggestionGroupType",null,[]);var x=b(1295),w=b(1294),G=b(2),D=b(32);b.d(L,"InteractionLogger",function(){return H});class H{constructor(M,J,F){this.Bdf=0;this.Pwf=this.w6c=null;this.jd=M;this.bvf=this.qbf=this.Zhf=
!1;this.v6j=J;this.nf=G.AFrameworkApplication.Gd;this.Gb=F;this.b5d=this.rqf=0}get sKa(){return this.jd.sKa}aYe(M){this.jd.aYe(M)}b1i(){if(this.w6c){var M=0;for(const J of this.w6c)this.jd.wqm(J,M++);this.w6c=null}}beginQuery(M,J,F){this.jd.lqm(M,J,F)}cKb(M,J){this.jd.MGk(M,J);this.Zhf=!0;this.bvf=!1}QJa(){this.Zhf=!1;this.qbf||(this.b1i(),this.jd.jki(this.Bdf))}mqm(M,J){this.jd.nqm(M,J)}CDm(M,J,F,A,N){for(const B of this.v6j)if(M.startsWith(B)){this.bvf=!0;break}this.jd.Bmm(M,J,F,A,N)}dEm(M){this.qbf=
!1;this.Bdf=M;this.Zhf||this.bvf||(this.b1i(),this.jd.jki(this.Bdf,!1))}cEm(M,J){this.jd.Emm(M,J);this.qbf=!0}Vri(M,J){if(!M.count)return"";let F="";const A=Date.now();for(let N of M)M=(A-N.timeStamp)/1E3,M=w.a.fbh(M),0<F.length&&(F+=";"),F+=J?N.commandId:N.controlId,F+=":",F+=M.toString();return F}Qqb(){var M=this.Vri(f.a.instance.vtd(),!1);0<M.length&&this.jd.Amm(M);M=this.Vri(f.a.instance.ZEc(),!0);0<M.length&&this.jd.dmm(M);M=x.TellMeActor.instance.jGh;0<M.length&&this.jd.jqm(D.c(M))}Rqm(M){this.jd.kmm(M)}$ga(M,
J,F,A,N,B,E,P=null){this.jd.lom(M,J,F,A,N,B,E,P)}Gxg(M,J,F,A){this.jd.Gxg(M,J,F,A)}pD(M,J,F=null){this.jd.bna(M,J,F)}onError(M,J,F=null){this.jd.UGd(M,J,F)}Nln(M){this.w6c=M}BPl(M){const J=[];if(!M)return J;for(let F=0;F<M.length;F++){const A=u.a[M[F].groupType].toLowerCase(),N=[],B=M[F].results;if(B){for(let E=0;E<B.length;E++)"findindocument"===A?Array.add(N,new k("","",A,B[E].score,B[E].bje,B[E].count)):Array.add(N,new k(B[E].label,B[E].description,A,B[E].score,B[E].bje,B[E].count));"answer"===
A||"definition"===A||"wolframanswer"===A||"entity"===A?Array.add(J,new m(N,l.answer)):"classifier"===A||"appsforoffice"===A?Array.add(J,new m(N,l.commands)):"serviceclassifier"===A?Array.add(J,new m(N,l.kin)):"assistance"===A?Array.add(J,new m(N,l.help)):("document"===A||"people"===A||"findindocument"===A||"notes"===A||"image"===A||"template"===A)&&Array.add(J,new m(N,A))}}return J}pcg(M,J){const F={};F.Query=J;F.SuggestionGroups=D.c(this.BPl(M));return D.c(F)}rFi(M){const J={"Content-Type":"application/json",
Accept:"application/json"};J["X-Office-Version"]=G.AFrameworkApplication.buildVersion;J["X-Office-Application"]=G.AFrameworkApplication.K.Ga("Application");J["X-Office-Platform"]="WAC";J["X-TellMe-SqmUserId"]=G.AFrameworkApplication.K.Ga("LoggableUserId")||"";J["X-TellMe-SessionId"]=this.jd.sKa.gsa;J["X-TellMe-SuggestionTypes"]="Ranker";J["X-TellMe-Culture"]=G.AFrameworkApplication.uiCulture;J["X-TellMe-ProcessSessionId"]=G.AFrameworkApplication.userSessionId;J["X-TellMe-Flights"]=M;J["X-TellMe-PartialQueryIndex"]=
this.rqf;return J}Qgc(M,J,F){this.$ga(J.length,"RankerLogging",M.data.Ge.toString(),Math.round(window.performance.now()-F),t.a.lIj,!0,c.a.o5a)}ygc(M,J,F){this.$ga(J.length,"RankerLogging",M.data.Ge.toString(),Math.round(window.performance.now()-F),t.a.lIj,!1,c.a.o5a)}sFi(){this.Pwf||(this.Pwf=new r.a(this.Gb,null,6E3));return this.Pwf.T$a}Hxg(M){const J=this.pcg(this.w6c,M),F=this.rFi("RankerLogging"),A=window.performance.now();this.nf.Ni(this.sFi(),2,J,F,!1,0,N=>{this.Qgc(N,M,A)},N=>{this.ygc(N,
M,A)},null,null,!1,4E3,6E3);this.rqf++}Nan(){this.rqf=0}h0g(M){this.b5d=M}}Object(C.a)(H,"InteractionLogger",null,[])},1726:function(C,L,b){b.r(L);C=b(0);var f=b(17),c=b(6),u=b(146),r=b(199),t=b(51),k=b(1540),m=b(1445),l=b(1394),x=b(1377);class w{constructor(M,J,F=null){this.author=M;this.gId=J;this.fOg=F||t.a.nil}jD(M){return M?this.author===M.author&&this.gId===M.gId&&this.fOg===M.fOg:!1}}Object(C.a)(w,"RunMergeBlockTrackedChangeAttribute",null,[]);class G{constructor(M,J,F){this.insertion=M||G.jZf;
this.deletion=J||G.jZf;this.$Wa=F||G.jZf}get VYl(){return 0<this.insertion.author.length}get xYl(){return 0<this.deletion.author.length}get oZl(){return 0<this.$Wa.author.length}jD(M){return M?this.insertion.jD(M.insertion)&&this.deletion.jD(M.deletion)&&this.$Wa.jD(M.$Wa):!1}}G.jZf=new w("",0);Object(C.a)(G,"RunMergeBlockTrackedChangeInfo",null,[]);var D=b(1595);b.d(L,"ParagraphMergeBlockCreator",function(){return H});class H extends m.a{constructor(M,J,F,A,N,B,E){super();this.maxValue=Number.MAX_VALUE;
this.UD=new k.a;this.Oqc=null;this.eU=0;this.hBh=!1;this.H7c="";this.O8e=M;this.yu=J;this.Pm=F;this.hok=A;this.Z6d=N;this.HAh=B;this.Mg=E;if(this.Mg.hasProperty(this.yu,f.a.wk))if(this.Mg.hasProperty(this.yu,c.a.Ob))if(this.Mg.hasProperty(this.yu,c.a.Qo))if(this.Mg.hasProperty(this.yu,c.a.ir))if(this.Mg.hasProperty(this.yu,f.a.qn))if(this.HJ=this.Mg.getPropertyString(this.yu,f.a.wk),this.xzf=this.Mg.getPropertyUint32(this.yu,c.a.Ob),this.Qt=this.Mg.getPropertyUint32s(this.yu,c.a.Qo),this.xbe=this.Mg.getPropertyUint32s(this.yu,
c.a.ir),this.Iff=this.Mg.getPropertyObjectIds(this.yu,f.a.qn),this.HJ||""===this.HJ)if(this.HJ.length||1!==this.Iff.length||(this.Qt.length||(this.Qt.add(0),u.a.instance.xa(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),this.xbe.length||(this.xbe.add(0),u.a.instance.xa(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),this.xgk=this.Wve(this.yu,c.a.pMe,this.Qt.length),this.l$c=this.Wve(this.yu,f.a.E0,
this.Qt.length),this.QW=this.Wve(this.yu,f.a.gLa,this.Qt.length),this.nW=this.Wve(this.yu,c.a.Fba,this.Qt.length),this.IW=this.mSl(this.yu,c.a.w8,this.Qt.length),this.C2l(),M=this.Mg.hasProperty(this.yu,f.a.Vi)?this.Mg.getPropertyUint32s(this.yu,f.a.Vi):new r.a,this.Hde=x.a.Byj(M,this.HJ.length),this.Qt.length!==this.xbe.length)u.a.instance.xa(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",J.id);else if(this.Qt.length!==this.Iff.length)u.a.instance.xa(3993800,
1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",J.id);else{this.HAh&&(this.Mg.hasProperty(this.yu,c.a.Bv)?this.Oqc=this.Mg.getPropertyObjectIds(this.yu,c.a.Bv):(u.a.instance.xa(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",J.id),this.Oqc=this.Z6(this.Qt.length,t.a.nil)),this.Qt.length!==this.Oqc.length&&(u.a.instance.xa(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",
J.id,this.Qt.length,this.Oqc.length),this.Oqc=this.Z6(this.Qt.length,t.a.nil)));if(this.Qt.length!==this.l$c.length||this.Qt.length!==this.QW.length||this.Qt.length!==this.nW.length||this.Qt.length!==this.IW.length)this.Qt.length===this.l$c.length||this.Z6d||u.a.instance.xa(8266445,1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",J.id,this.Qt.length,this.l$c.length),this.Qt.length===this.QW.length||this.Z6d||
u.a.instance.xa(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",J.id,this.Qt.length,this.QW.length),this.Qt.length===this.nW.length||this.Z6d||u.a.instance.xa(20742792,1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",J.id,this.Qt.length,this.nW.length),this.Qt.length===this.IW.length||this.Z6d||
u.a.instance.xa(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",J.id,this.Qt.length,this.IW.length),M=this.Mg.getPropertyBool(this.yu,f.a.roe),u.a.instance.xa(17877020,1,3,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",J.id,N,null==M?!1:M),this.l$c=this.Z6(this.Qt.length,!0),this.QW=this.Z6(this.Qt.length,!1),this.nW=this.Z6(this.Qt.length,
!1),this.IW=this.Z6(this.Qt.length,0),this.Mg.setPropertyBool(this.yu,f.a.roe,!1);this.UD.gRn(this.Qt.length)?(this.Hde.length!==this.Qt.length+1&&u.a.instance.xa(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",J.id,this.Qt.length,this.Hde.length),this.Zdk=!0):u.a.instance.xa(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",J.id)}else u.a.instance.xa(4322133,
1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",J.id);else u.a.instance.xa(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",J.id);else u.a.instance.xa(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",J.id);else u.a.instance.xa(3993796,1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",J.id);else u.a.instance.xa(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",J.id);else u.a.instance.xa(3993794,1,
1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",J.id)}C2l(){this.Mg.hasProperty(this.yu,c.a.pga)?this.UD.SUa=this.Mg.getPropertyBools(this.yu,c.a.pga):this.UD.SUa=this.Z6(this.Qt.length,!1);this.Mg.hasProperty(this.yu,c.a.d7)?this.UD.tSa=this.Mg.getPropertyBools(this.yu,c.a.d7):this.UD.tSa=this.Z6(this.Qt.length,!1);this.Mg.hasProperty(this.yu,c.a.qga)?this.UD.YGb=this.Mg.getPropertyStrings(this.yu,c.a.qga):this.UD.YGb=this.Z6(this.Qt.length,"");this.Mg.hasProperty(this.yu,c.a.Ffa)?
this.UD.NDb=this.Mg.getPropertyStrings(this.yu,c.a.Ffa):this.UD.NDb=this.Z6(this.Qt.length,"");this.Mg.hasProperty(this.yu,c.a.rga)?this.UD.ZGb=this.Mg.getPropertyListOfMilliseconds(this.yu,c.a.rga):this.UD.ZGb=this.Z6(this.Qt.length,0);this.Mg.hasProperty(this.yu,c.a.Gfa)?this.UD.zjb=this.Mg.getPropertyListOfMilliseconds(this.yu,c.a.Gfa):this.UD.zjb=this.Z6(this.Qt.length,0);this.Mg.hasProperty(this.yu,c.a.nha)?this.UD.yrb=this.Mg.getPropertyBools(this.yu,c.a.nha):this.UD.yrb=this.Z6(this.Qt.length,
!1);this.Mg.hasProperty(this.yu,c.a.cia)?this.UD.YKb=this.Mg.getPropertyStrings(this.yu,c.a.cia):this.UD.YKb=this.Z6(this.Qt.length,"");this.Mg.hasProperty(this.yu,c.a.dia)?this.UD.$Kb=this.Mg.getPropertyListOfMilliseconds(this.yu,c.a.dia):this.UD.$Kb=this.Z6(this.Qt.length,0);this.Mg.hasProperty(this.yu,c.a.rda)?this.UD.ZKb=this.Mg.getPropertyObjectIds(this.yu,c.a.rda):this.UD.ZKb=this.Z6(this.Qt.length,t.a.nil)}Wve(M,J,F){return this.Mg.hasProperty(M,J)?this.Mg.getPropertyBools(M,J):this.Z6(F,!1)}mSl(M,
J,F){return this.Mg.hasProperty(M,J)?this.Mg.getPropertyUint32s(M,J):this.Z6(F,0)}Z6(M,J){const F=new r.a;for(let A=0;A<M;A++)F.add(J);return F}RQl(M){const J=this.Hde.Rf(M);M=this.Hde.Rf(M+1);return this.HJ.substring(J,M)}wAi(){if(this.hBh)return null;var M=this.eU<this.Qt.length?this.Qt.Rf(this.eU):this.maxValue;if(M===this.maxValue||this.hok&&!this.HJ.length)return this.hBh=!0,M=new l.a(this.Pm,this.yu.id,this.xzf),this.H7c=this.HEf(this.H7c,M.toString()),M;const J=this.xbe.Rf(this.eU),F=this.Iff.Rf(this.eU),
A=this.xgk.Rf(this.eU),N=this.l$c.Rf(this.eU),B=this.QW.Rf(this.eU),E=this.nW.Rf(this.eU),P=this.IW.Rf(this.eU),T=this.HAh?this.Oqc.Rf(this.eU):null;var V=null;this.UD.SUa.Rf(this.eU)&&(V=new w(this.UD.YGb.Rf(this.eU)||"",this.UD.ZGb.Rf(this.eU)));var I=null;this.UD.tSa.Rf(this.eU)&&(I=new w(this.UD.NDb.Rf(this.eU)||"",this.UD.zjb.Rf(this.eU)));var R=null;this.UD.yrb.Rf(this.eU)&&(R=new w(this.UD.YKb.Rf(this.eU)||"",this.UD.$Kb.Rf(this.eU),this.UD.ZKb.Rf(this.eU)));V=new G(V,I,R);I=this.RQl(this.eU);
this.eU++;R=I.startsWith("\ufddfHYPERLINK ");M=new D.a(this.O8e,this.Pm,this.yu.id,J,M,F,I,A,!R,N,B,E,P,V,T);this.H7c=this.HEf(this.H7c,M.toString());return M}eAi(){let M;M=null;var J="";if(!this.Zdk)return{Xzg:M,hqb:J};if(J=this.wAi())M=new r.a,M.add(J);for(;J=this.wAi();)M.add(J);J=this.H7c;return{Xzg:M,hqb:J}}}Object(C.a)(H,"ParagraphMergeBlockCreator",m.a,[])},1730:function(C,L,b){b.r(L);C=b(0);var f=b(199),c=b(1445),u=b(1393);class r extends u.a{constructor(k,m){super(4,k,m)}toString(){return String.format("{0} [GraphNodeId: {1}]",
super.toString(),this.Vj)}gFc(){return"Table"}clone(){return new r(this.source,this.Vj)}jD(k,m,l,x=!1){return super.jD(k,m,l,x)?this.Vj.equals(k.Vj):!1}get length(){return 1}}Object(C.a)(r,"TableMergeBlock",u.a,[]);b.d(L,"TableMergeBlockCreator",function(){return t});class t extends c.a{constructor(k,m){super();this.iph=new r(m,k.id)}eAi(){let k;k=new f.a;k.add(this.iph);return{Xzg:k,hqb:this.HEf("",this.iph.toString())}}}Object(C.a)(t,"TableMergeBlockCreator",c.a,[])},1794:function(C,L,b){b.r(L);
var f=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},c=b(0),u=b(41),r=b(62);class t extends Sys.EventArgs{constructor(U,Ea){super();this.J1e=U;this.actualValue=Ea}}Object(c.a)(t,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,
[]);var k=b(29);class m{constructor(){this.krc=[];this.nsh=this.Gbf=0;this.te=null;this.ka=new r.a}init(U,Ea,kb){this.te=U;this.Gbf=Ea;this.nsh=kb;this.te.hgd(Object(u.a)(this,this.qgc,"onCpuMeterFrameAvailable"));this.qyk(Object(u.a)(this,this.FZk,"cpuPercentThresholdExceeded"))}qgc(U,Ea){Ea.SId&&(Array.enqueue(this.krc,Ea.SId.CP),this.krc.length>this.nsh&&(Array.dequeue(this.krc),this.PPk()))}PPk(){var U=this.krc.length;let Ea=0;for(let kb=0;kb<U;kb++){const Nb=Array.dequeue(this.krc);Ea+=Nb;Array.enqueue(this.krc,
Nb)}U=Ea/U;U>this.Gbf&&this.ka.raiseEvent("CPTTE",new t(this.Gbf,U))}FZk(U,Ea){k.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.mpe(Ea.J1e,Ea.actualValue))}qyk(U){this.ka.addHandler("CPTTE",U)}mpe(U,Ea){const kb={};kb.ThresholdValue=U;kb.ActualValue=Ea;return kb}}Object(c.a)(m,"CpuMeterMonitor",null,[1810]);var l=b(407);class x{constructor(){this.S=this.T=this.M=this.C=0}}Object(c.a)(x,"ProfileInformation",null,[]);var w=b(7),G=b(25),D=b(192),H=b(73);class M{constructor(U=
0,Ea=0){this.TUb=!1;this.STb={};this.J$d=U;this.W$d=Ea;this.jyf=0;G.a.addHandler(window.self,w.a.JDf,()=>{this.TUb=!0});G.a.addHandler(window.self,w.a.KDf,()=>{this.TUb=!1})}DXh(U,Ea,kb){const Nb=M.generateKey(Ea,kb);Nb in this.STb?Ea=this.STb[Nb]:(Ea=new x,Ea.S=kb?1:0,this.STb[Nb]=Ea,this.jyf++);Ea.C++;Ea.M=U>Ea.M?U:Ea.M;Ea.T+=U}TQa(U,Ea){this.DXh(U,Ea,!1);this.TUb&&this.DXh(U,Ea,!0)}getData(){if(0<this.W$d&&this.jyf>this.W$d)return this.Pwl();const U=0<this.J$d,Ea={},kb=this.STb;for(let nc in kb){var Nb=
nc;const ad=kb[nc];this.rsj(ad);U&&ad.T>=this.J$d&&(Ea[Nb]=ad)}return U?H.a.le(Ea)?null:Ea:this.STb}Pwl(){var U=0<this.J$d,Ea=[];const kb=this.STb;for(let Nb in kb){const nc={key:Nb,value:kb[Nb]};let ad=nc.value;(!U||ad.T>=this.J$d)&&Array.add(Ea,nc)}if(Ea.length>this.W$d)Ea.sort((Nb,nc)=>nc.value.T-Nb.value.T),Ea=Ea.slice(0,this.W$d);else if(!Ea.length)return null;U={};for(const Nb of Ea)Ea=Nb.value,this.rsj(Ea),U[Nb.key]=Ea;return U}rsj(U){U.M=D.a.rO(U.M,0);U.T=D.a.rO(U.T,0)}reset(){this.STb={};
this.jyf=0}static generateKey(U,Ea){return Ea?U+" [it]":U}}Object(c.a)(M,"FunctionCallAggregator",null,[842]);var J=b(2),F=b(1064);class A{}Object(c.a)(A,"CpuMeterFrame",null,[]);class N extends Sys.EventArgs{constructor(U){super();this.SId=U}}Object(c.a)(N,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class B{}Object(c.a)(B,"MiniTaskItemInfo",null,[]);class E{}Object(c.a)(E,"TaskItemInfo",null,[]);var P=b(916),T=b(1218),V=b(185);class I{constructor(U,Ea,kb,Nb,nc){this.p0b=0;this.z$=null;this.Ide=
this.JOh=0;this.zMh=!1;this.Dsc=0;this.jzb=!1;this.p6=null;this.K8d=0;this.Yof=new r.a;this.Hfe=[];this.Vy=U;this.Xmf=Ea;this.Mff=kb;this.ZEh=Nb;J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("WrapSetTimeoutForTelemetryIsEnabled")&&this.Apb();this.I8j=nc;this.Nff=new M(100);this.pfk=P.a.QB(1,5,new T.a)}hgd(U){this.Yof.addHandler("OnCpuMeterFrameAvailable",U)}CUe(U){this.Yof.removeHandler("OnCpuMeterFrameAvailable",U)}zta(U,Ea,kb,Nb=null){kb=Nb?Nb.priority:7;const nc=this.Vy();this.start(Ea,
kb);try{U()}finally{this.stop(Ea,Nb),U=this.Vy()-nc,this.ZEh.track(U,Ea)}}Fd(U,Ea){const kb=this.Vy();try{U()}finally{U=this.Vy()-kb,this.Mff.TQa(U,Ea),0<this.p0b&&this.Nff.TQa(U,Ea),this.ZEh.track(U,Ea)}}nOc(U){const Ea=new E;Ea.TN=U.jHd;Ea.TP=U.priority;this.ljj(1,Ea)}gJb(U){this.K8d|=U}start(U,Ea){if(!this.p0b){this.Nff.reset();const kb=this.CVi(U);kb&&this.mMc(1);this.z$=new E;this.z$.TN=U;this.z$.TP=Ea;this.z$.ST=(new Date).toISOString();this.z$.STS=D.a.rO(this.Vy(),2);kb?this.z$.UI=1:this.Ecm(U)?
this.z$.UI=2:this.z$.UI=0}this.p0b++}mMc(U){this.Dsc|=U}CAc(U=!0,Ea=0){this.Dsc=U?0:this.Dsc&~Ea}stop(U,Ea=null){let kb;this.p0b--;0>=this.p0b&&this.z$&&(kb=this.Vy()-this.z$.STS,this.Ide+=kb,this.Xmf.TQa(kb,U),this.CVi(U)&&this.CAc(!1,1),this.z$.TRT=D.a.rO(kb,2),Ea&&(this.z$.TQT=D.a.rO(Ea.Aij,2),this.z$.TDT=D.a.rO(Ea.pIe,2)),this.I8j&&(this.ljj(0,this.z$),this.E$m()),this.p0b=0);0<=U.indexOf(F.a.tMj)&&this.gJb(2);0<=U.indexOf(F.a.NVg)&&this.gJb(4);1===(this.Dsc&1)&&this.gJb(1);2===(this.Dsc&2)&&
this.gJb(8)}E$m(){var U=this.z$.TRT;if(750<U){let kb=this.Nff.getData();if(kb){const Nb={};for(let nc in kb){var Ea=kb[nc];const ad=nc;ad.startsWith("SiOp_")||(Nb[ad]=D.a.rO(100*Ea.T/U,2))}kb=Nb}U=Object.assign(new B,{T:U,S:kb});this.pfk.track(U,this.z$.TN)}}yxn(){var U=this.Vy()-this.JOh,Ea=D.a.rO(this.Ide/U*100,2);U=new A;U.CP=Ea;U.II=this.K8d;Ea=this.Xmf.getData();H.a.count(Ea)&&(U.LRT=Ea);Ea=this.Mff.getData();H.a.count(Ea)&&(U.FP=Ea);this.Yof.raiseEvent("OnCpuMeterFrameAvailable",new N(U));this.jFj()}jFj(){this.Xmf.reset();
this.Mff.reset();this.Ide=this.p0b=0;this.JOh=this.Vy();this.K8d=0;this.z$=null}run(){this.zMh?this.yxn():(this.jFj(),this.zMh=!0);this.p6?this.p6(Object(u.a)(this,this.run,"run"),1E3):window.setTimeout(Object(u.a)(this,this.run,"run"),1E3)}jyc(U,Ea,kb){const Nb=Array(2);Nb[0]=Ea;Nb[1]=kb;this.Hfe[U]||(this.Hfe[U]=[]);this.Hfe[U].push(Nb)}ljj(U,Ea){U=this.Hfe[U];if(!V.a.le(U))for(let Nb=0;Nb<U.length;Nb++){var kb=U[Nb];const nc=kb[0];kb=kb[1];nc&&!nc(Ea)||kb(Ea)}}Apb(){if(!this.jzb){const U=window.setTimeout;
this.p6=(Ea,kb)=>U(Ea,kb);this.jzb=!0}}CVi(U){return U.startsWith("key")||U.startsWith("input")}Ecm(U){return U.startsWith("click")||U.startsWith("mouse")||U.startsWith("pointer")}}Object(c.a)(I,"CpuMeter",null,[165]);class R{constructor(U){this.jrc=null;this.Ko=new l.a;this.Vy=U}initialize(U,Ea,kb,Nb=!1){this.jrc||(this.jrc=new I(this.Vy,U,Ea,kb,Nb),this.Ko.mf(this.jrc));return this.jrc}}Object(c.a)(R,"CpuMeterProvider",null,[1808]);var ba=b(167),ha=b(148);class na{constructor(U=1){this.uy=[];this.t5d=
[];this.Ig=U}Hkl(){let U=0;for(let Ea=0;Ea<this.uy.length;Ea++)this.uy[Ea]<this.uy[U]&&(U=Ea);return U}TQa(U,Ea){U=D.a.rO(U,2);if(this.uy.length<this.Ig)Array.add(this.uy,U),Array.add(this.t5d,Ea);else{var kb=this.Hkl();U>this.uy[kb]&&(this.uy[kb]=U,this.t5d[kb]=Ea)}}getData(){return this.uy.length?{["Vals"]:this.uy,["Desc"]:this.t5d}:null}reset(){this.uy=[];this.t5d=[]}}Object(c.a)(na,"MaxDataAggregator",null,[842]);var da=b(36),ia=b(23);class ma{get name(){return"Common.App.CpuMeter"}Hb(U){U.register(R,
"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").singleInstance().zd(()=>new R(da.a.me));U.register(m,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").singleInstance().zd(()=>new m)}init(){const U=J.AFrameworkApplication.K;if(U.ea("CpuMeterIsEnabled")){const Ea=ia.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");ha.a.instance.Tyc.continueWith(()=>{ma.d3l(U,Ea)})}}dispose(){}static d3l(U,Ea){const kb=P.a.QB(10,5,new M(U.jb("TaskManagerLoggingThreshold",
0),U.jb("CpuMeterMaximumEntriesToLog",0)));Ea=Ea.initialize(new na(5),new M,kb,U.ea("CPUMeterExposeTaskDetailsIsEnabled"));Ea.run();U.ea("CpuMeterMonitorIsEnabled")&&ia.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(Ea,U.rE("CpuMeterAverageCpuPercentThreshold",80),U.jb("CpuMeterRollingAverageFramesCount",15));k.b(16827671,306,50,"Initializing CpuMeter")}static main(){ba.a.instance.Sb(new ma)}}Object(c.a)(ma,"CpuMeterPackage",null,[1,2]);var qa=b(8),ka=b(79),va=b(935),ja=b(921),Ma=
b(15),Ha=b(1219);class X{constructor(){this.IFa=this.DXc=null;this.Jxc=!0;this.r5c=!1}Hb(U){J.AFrameworkApplication.K.ea("EventTimingMeterIsEnabled")&&U.register(1767,"Common.IEventTimingMeter").singleInstance().zd(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var U=new ja.a(J.AFrameworkApplication.K.jb("EventTimingMeterEventSamplingPercent",0)/100);U=new va.a(Object(u.a)(U,U.Ptb,"shouldBeInSample"));const Ea=P.a.QB(16,1,U);this.IFa=new Ha.a("TypingDuration-SlowPercentileAtValue",
"Percentile",J.AFrameworkApplication.K.rE("AshaVetoForTypingThresholdInMS",150),J.AFrameworkApplication.K.rE("AshaVetoForTypingThresholdPercentile",95),this.Jxc);(this.r5c=!Ma.a.gJa)&&J.AFrameworkApplication.QH(()=>{this.JLf()});this.DXc=kb=>{kb=kb.rawEvent.detail;for(const Nb of kb)Ea.track(Nb,"EventTimingData"),"false"===Nb.metadata.altPressed.toString()&&"false"===Nb.metadata.ctrlPressed.toString()&&"false"===Nb.metadata.repeat.toString()&&this.r5c&&this.IFa.tKa(Nb.timeToRequestAnimationFrameMs)};
G.a.addHandler(window.self,w.a.IDf,this.DXc)}dispose(){this.DXc&&(G.a.removeHandler(window.self,w.a.IDf,this.DXc),this.DXc=null)}JLf(){this.IFa.k8a();this.IFa.Acj&&(qa.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),ka.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){ba.a.instance.Sb(new X)}}Object(c.a)(X,"EventTimingMeterPackage",null,[1,2]);var W=b(75),fa=b(70),ra=b(32);class Aa{constructor(U,
Ea,kb,Nb=null,nc=null){this.dR=U;this.r2c=Ea;this.k2c=kb;this.VJh=Nb;this.z$c=nc}l0f(U){const Ea=new Sys.StringBuilder(this.dR.eSd);Ea.append("RoamingServiceHandler.ashx?action=");Ea.append("getFirstRunExperienceSettings");Ea.append("&");Ea.append(this.cbg(U));Ea.append("&");Ea.append(J.AFrameworkApplication.Fk);J.AFrameworkApplication.Gd.Ni(Ea.toString(),1,null,null,!0,2,Object(u.a)(this,this.b$b,"getRequestSuccessCallback"),Object(u.a)(this,this.hmb,"getRequestFailureCallback"),null)}p0f(U){var Ea=
new Sys.StringBuilder(this.dR.eSd);Ea.append("RoamingServiceHandler.ashx?action=");Ea.append("saveFirstRunExperienceSettings");Ea.append("&");Ea.append(J.AFrameworkApplication.Fk);Ea=Ea.toString();U=ra.c(U);J.AFrameworkApplication.Gd.Ni(Ea,2,U,null,!0,4,Object(u.a)(this,this.jSm,"postRequestSuccessCallback"),Object(u.a)(this,this.Khc,"postRequestFailureCallback"),null)}b$b(U){let Ea=!1,kb=null;try{if(0<U.data.Rd.length){const Nb=Object(fa.a)(Object,ra.a(U.data.Rd)),nc=Nb?Nb[this.dR.uEf]:null;nc&&
(kb=Object(fa.a)(Object,ra.a(nc.toString())))}Ea=!0}catch(Nb){this.hmb(null)}Ea&&this.r2c&&this.r2c(U.data,kb)}hmb(U){this.k2c&&this.k2c(U?U.data:null)}jSm(U){this.VJh&&this.VJh(U?U.data:null)}Khc(U){this.z$c&&this.z$c(U?U.data:null)}cbg(U){const Ea=new Sys.StringBuilder("requestedsettings=");for(let kb=0;kb<U.count;kb++)Ea.append(U.J(kb)),kb<U.count-1&&Ea.append(";");return Ea.toString()}}Object(c.a)(Aa,"FirstRunExperienceRequestHandler",null,[]);class Ba{constructor(){this.J1c=this.K6d=this.dR=
null}Pun(U){U?(this.dR=U,this.Bcm()&&(qa.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),U=new W.a,U.add(this.dR.uEf),this.K6d=new Aa(this.dR,Object(u.a)(this,this.b$b,"getRequestSuccessCallback"),Object(u.a)(this,this.hmb,"getRequestFailureCallback"),null,Object(u.a)(this,this.Khc,"postRequestFailureCallback")),this.K6d.l0f(U)),(this.dR.kVi||J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",
!1))&&this.y5g()):qa.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}Bcm(){try{if(this.dR.kVi)return!0;if(!J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||J.AFrameworkApplication.K.ea("IsAnonymousUser"))return!1;if(this.dR.R9l||this.dR.jLc||J.AFrameworkApplication.K.ea("IsO365ConsumerHost"))return!0;const U=J.AFrameworkApplication.K.Ga("FlightId");return-1!==(U?U.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(U){qa.ULS.sendTraceTag(576582624,
306,10,"Error checking setting {0}",U?U.toString():null)}return!1}gtj(U){const Ea={},kb={};kb.FREDisplayedDate=(new Date).toUTCString();kb.VersionDisplayed=U;kb.RemindMeLater=!1;Ea[this.dR.uEf]=ra.c(kb);qa.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.K6d&&this.K6d.p0f(Ea)}b$b(U,Ea){U=U?+U.hE-+U.px:-1;U>this.dR.fsj?qa.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",
U,this.dR.fsj):Ea?this.Ttn(Ea)?(qa.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.dR.K4i),this.y5g()):qa.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required."):(qa.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.y5g())}hmb(U){qa.ULS.sendTraceTag(51675541,
306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",U?U.Ge:-1)}Khc(U){qa.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",U?U.Ge:-1)}y5g(){var U=ia.a.instance.sa("Common.ISystemInitiatedFeedback");U?this.pCj(U):(qa.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",
!0)&&((U=ia.a.instance.Ca("Common.ISystemInitiatedFeedback"))?U.execute(Ea=>{this.pCj(Ea)}):qa.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}pCj(U){if(U){var Ea=this.dR.Vml;Ea&&(J.AFrameworkApplication.Zi(Ea),J.AFrameworkApplication.y0(Ea));qa.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Ea);U.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.J1c=Object(u.a)(this,this.jFm,"onFirstRunExperienceCampaignEvent"),
window.addEventListener("FGWebSurfaceEvent",this.J1c,!0),window.addEventListener("FRELaunchedEvent",this.J1c,!0)):(qa.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.gtj(this.dR.currentVersion))}else qa.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}jFm(U){if(U){var Ea=U.detail;U=U.type;var kb=this.dR&&this.dR.i4h?this.dR.i4h.split("-")[0]:null;if("FRELaunchedEvent"===U||kb&&Ea&&Ea.id&&-1!==Ea.id.indexOf(kb))Ea.success&&(qa.ULS.sendTraceTag(51675546,
306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.gtj(this.dR.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.J1c,!0),window.removeEventListener("FRELaunchedEvent",this.J1c,!0))}}Ttn(U){if("RemindMeLater"in U&&"FREDisplayedDate"in U){if("true"===U.RemindMeLater.toString()&&(+new Date-+new Date(U.FREDisplayedDate.toString()))/36E5>this.dR.K4i)return!0}else if(J.AFrameworkApplication.K.ea("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in
U&&U.VersionDisplayed<this.dR.currentVersion)return qa.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}}Object(c.a)(Ba,"FirstRunExperienceLauncher",null,[1763]);class ta{constructor(){this.Z=null}get name(){return"Common.App.FirstRunExperienceLauncher"}Hb(U){this.Z=U;this.Z.register(1763,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").singleInstance().zd(()=>new Ba)}init(){}dispose(){}static main(){ba.a.instance.Sb(new ta)}}
Object(c.a)(ta,"FirstRunExperienceLauncherPackage",null,[1,2]);class xa{constructor(){this.y=this.x=0}}Object(c.a)(xa,"HammerPoint",null,[]);var za=b(13);class la{constructor(U,Ea,kb,Nb,nc){this.zDh=this.Fcb=this.z8d=1;this.Hge=this.fed=this.ogb=0;this.hof=this.A_a=null;this.mQb=this.Oef=this.zce=!1;this.Bg=U;this.Twa=Ea;this.u_b=kb;this.ga=Nb;nc&&(this.zce=nc.ea("PromoteLayerPinchToZoomIsEnabled"),this.Oef=nc.ea("FinalizeWithInitialPinchScaleIsEnabled"),this.mQb=nc.ea("AdjustPinchStartXWithPageMarginIsEnabled"))}get Xv(){return this.Twa}Pam(){return!!this.Bg.instance}EFm(U){this.ga&&
this.ga.processAction(za.a.K7g,2);const Ea=this.Bg.instance;this.zce&&Ea.$ij();this.Fcb=Ea.Ei;this.z8d=U.Esd.scale;this.zDh=1;this.hof=this.O3h();this.A_a=this.Twa.getBounds();if(!this.A_a)return qa.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;U=this.cCi(U);this.mQb?this.fyj(this.Twa.scrollWidth,this.A_a.width,U,this.Fcb,Ea):this.ogb=this.Twa.scrollWidth>this.A_a.width?this.xjd(this.u_b.scrollLeft,U.x,this.Fcb):null;this.Hge=this.Twa.scrollHeight>this.A_a.height?this.xjd(this.u_b.scrollTop,
U.y,this.Fcb):null;return!0}LWg(){this.ogb=null;this.fed=0}fyj(U,Ea,kb,Nb,nc){U>Ea?this.ogb?(U=nc.fvg,U!==this.fed&&(this.ogb-=this.fed-U,this.fed=U)):(this.ogb=this.xjd(this.u_b.scrollLeft,kb.x,Nb),this.fed=nc.fvg):this.LWg()}DFm(U){const Ea=this.cCi(U);if(!Ea)return qa.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;U=this.tkn(U.Esd.scale/this.z8d)*this.Fcb;this.XOn(Ea,U);this.YOn(Ea,U);return!0}XOn(U,Ea){const kb=this.Twa.scrollWidth,Nb=this.A_a.width;this.mQb?this.fyj(kb,Nb,
U,Ea,this.Bg.instance):!this.ogb&&kb>Nb&&(this.ogb=this.xjd(this.u_b.scrollLeft,U.x,Ea));if(U=this.V3h(U.x,this.ogb,kb,Nb,Ea))this.u_b.scrollLeft=U}YOn(U,Ea){const kb=this.Twa.scrollHeight,Nb=this.A_a.height;!this.Hge&&kb>Nb&&(this.Hge=this.xjd(this.u_b.scrollTop,U.y,Ea));if(U=this.V3h(U.y,this.Hge,kb,Nb,Ea))this.u_b.scrollTop=U}V3h(U,Ea,kb,Nb,nc){return kb<=Nb||!Ea||!Nb?null:Math.max(0,Math.min(Ea*nc-U,kb-Nb))}xjd(U,Ea,kb){return(U+Ea)/kb}CFm(U){U=U.Esd.scale;this.Oef&&(U/=this.z8d);this.Uni(U);
this.zce&&this.Bg.instance.RQg();this.ga&&this.ga.processAction(za.a.Fse,2);this.mQb&&this.LWg()}BFm(U){U=U.Esd.scale;this.Oef&&(U/=this.z8d);this.Uni(U,!0);this.zce&&this.Bg.instance.RQg();this.ga&&this.ga.processAction(za.a.Fse,2);this.mQb&&this.LWg()}tkn(U){const Ea=this.Bg.instance,kb=new Date>=this.hof;kb&&(this.hof=this.O3h());Math.abs(U-this.zDh)>=.01*U&&Ea.Dpn(U*this.Fcb,kb);return Ea.Ei/this.Fcb}Uni(U,Ea=!1){U*=this.Fcb;this.Bg.instance.T2g(U,!1);const kb={};kb.initialScale=this.Fcb;kb.finalScale=
U;kb.cancelled=Ea;qa.ULS.sendTraceTag(42821150,353,50,"Pinch zoom ended: {0}",kb)}cCi(U){return(U=U.Esd.center)&&this.A_a?Object.assign(new xa,{x:U.x-this.A_a.x,y:U.y-this.A_a.y}):null}O3h(){const U=(new Date).getTime();return new Date(U+1E3)}}Object(c.a)(la,"PinchZoomAdapter",null,[1839]);class Sa{constructor(U){this._element=U}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(c.a)(Sa,
"ScrollContainerElement",null,[1837]);var Pa=b(119);class fb{constructor(U,Ea,kb,Nb,nc,ad){this.Svf=this.eFa=null;this.Z=U;this.Ad=Ea;this.KVb=kb;this.ZBh=Nb;this.tdk=nc;this.etc=ad;this.r4d=new W.a}register(U,Ea){this.KVb&&(4===J.AFrameworkApplication.la.eb.Bm&&J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?Pa.a.get_instance().Ik(8,()=>{this.Xqj(U,Ea)}):this.Xqj(U,Ea))}Xqj(U,Ea){this.Z.Ca("Common.IGestureInputManager").execute(kb=>{this.pzn();
this.eFa=kb;this.r4d.add(U);if(this.ZBh){if(this.tdk&&0!==kb.fBl()){this.UFj();return}var Nb=this.Z.Ca("Common.IZoomManager");this.Z.resolve("Common.IAppSettingsManager");const nc=new Sa(U);Nb=new la(Nb,nc,Ea,J.AFrameworkApplication.pa,J.AFrameworkApplication.K);kb.g3m(U,Nb)}this.UFj()})}unregister(){if(this.eFa&&this.r4d){if(this.ZBh){for(let U of this.r4d)this.eFa.EJn(U);this.r4d.clear()}this.eFa=null}}pzn(){this.etc&&(this.Ad?this.Svf=this.Ad.Pe("Task","Register"):qa.ULS.sendTraceTag(590387076,
310,10,"_stopwatchBuilder is null"))}UFj(){this.etc&&(this.Svf?this.Svf.stop():qa.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(c.a)(fb,"GestureInputRegistrar",null,[1766]);class db{constructor(){this.Z=null;this.wh=!1}get name(){return"Common.App.GestureInput"}init(){this.wh||(this.Z.resolve("Common.IGestureInputRegistrar"),this.wh=!0)}dispose(){}Hb(U){this.Z=U;U.register(1766,"Common.IGestureInputRegistrar").singleInstance().zd(()=>new fb(U,J.AFrameworkApplication.la.Np,
J.AFrameworkApplication.Vob(),J.AFrameworkApplication.EGe(),!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("PinchZoomOnlyPointerEventsIsEnabled"),!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("HammerJsPerformanceTimersIsEnabled")))}static main(){ba.a.instance.Sb(new db)}}Object(c.a)(db,"GestureInputPackage",null,[1,2]);var Qa=b(304),wb=b(76);class ib{constructor(){this.DLb=this.rsi=null}}Object(c.a)(ib,"GestureAdapterInfo",null,[]);var Ta=b(353),jb=b(221);class $a{constructor(){this.mSb=
null}Svg(){if(!this.mSb){var U="hammer.min.js";J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UseIsServerFlavorAppSetting",!1)&&(U=J.AFrameworkApplication.K.ea("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");U=J.AFrameworkApplication.Yx(String.format("{0}",U),5);U=jb.a.create(U,null,null);Ta.a.BP(U);this.mSb=U.C6a}return this.mSb}static get instance(){$a.na||($a.na=new $a);return $a.na}}$a.na=null;Object(c.a)($a,"HammerJsDependencyLoader",null,[1838]);const ya=(U,
Ea,kb=null)=>{if(void 0===Ea||null===Ea)throw qa.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let Nb=null;switch(U){case w.a.pinch:Nb=new Hammer.Pinch(kb);break;case w.a.pan:Nb=new Hammer.Pan(kb)}Nb&&(Nb.manager=Ea);return Nb};var wa;(function(U){U[U.none=-1]="none";U[U.pinch=0]="pinch";U[U.pan=1]="pan";U[U.swipe=2]="swipe"})(wa||(wa={}));Object(c.b)("GestureEvent",wa);var Fa=b(50);class bb extends Fa.a{constructor(U,Ea,kb,Nb,nc,ad,Od,af){super(U,
kb,Nb,ad);this.pab=Ea;this.P$=Od;this.QQ=af;this.X9j=nc}get shiftKey(){return this.P$}get ctrlKey(){return this.QQ}get clientPoint(){return this.pab}get Esd(){return this.X9j}static create(U,Ea,kb,Nb,nc,ad){if(kb.rawEvent)if(ad){var Od=kb.rawEvent;Od=new Sys.UI.Point(Od.clientX,Od.clientY)}else Od=Fa.a.pFb(kb);else Od=new Sys.UI.Point(kb.clientX,kb.clientY);return new bb(U,Od,Ea,kb,Nb,nc,kb.shiftKey,kb.ctrlKey,ad)}}Object(c.a)(bb,"GestureEventArgs",Fa.a,[]);class Eb{constructor(){this.srcEvent=this.pointerType=
this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(c.a)(Eb,"GestureManagerData",null,[]);class hb{}hb.A_j=2;hb.B_j=4;hb.C_j=8;hb.D_j=8;Object(c.a)(hb,"HammerConstants",null,[]);var nb=b(67),Pb=b(107),
bc=b(16),gb=b(85);class Lb extends G.a{constructor(U,Ea){super();this.spa=Qa.a.ssi;this.Tqf=!!window.PointerEvent;this.uQh=window.hasOwnProperty("ontouchstart");this.WTb=this.X8c=null;this.p0a=!1;this.Bwa=new wb.a;this.x$c=new wb.a;this.uxh=new W.a;this.Qxb=null;this.gab=this.etc=this.vqh=this.Z$e=this.Lmf=this.JLh=this.Mqh=this.yed=!1;this.t7c=-1;this.curRecognizer=this.element=this.handlers=this.session=this.Tvf=null;this.uc=nb.EventHandlerManager.instance;this.Tqf?(qa.ULS.sendTraceTag(593893141,
310,50,"Using pointer events"),this.X8c=Object(u.a)(this,this.Kgc,"onPointerEvent"),this.WTb=w.a.usi):this.uQh?(qa.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.X8c=Object(u.a)(this,this.zna,"onTouchEvent"),this.WTb=w.a.touchEvents):(qa.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.X8c=Object(u.a)(this,this.Fgc,"onMouseEvent"),this.WTb=w.a.tsi);this.Ad=Ea;this.vJ=U;J.AFrameworkApplication.K&&(this.yed=J.AFrameworkApplication.K.ea("UsePointerCaptureIsEnabled"),this.Mqh=
J.AFrameworkApplication.K.ea("ClearCacheOnPrimaryPointerIsEnabled"),this.JLh=J.AFrameworkApplication.K.ea("ResetHandledBeforeInputHandlerIsEnabled"),this.Lmf=J.AFrameworkApplication.K.ea("LogCoalescedEventsIsEnabled"),this.Z$e=J.AFrameworkApplication.K.ea("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.vqh=J.AFrameworkApplication.K.ea("CheckIfHammerExistsAfterDownloadIsEnabled"),this.etc=J.AFrameworkApplication.K.ea("HammerJsPerformanceTimersIsEnabled"),this.gab=this.yed&&J.AFrameworkApplication.K.ea("CancelDragFromGestureInputManagerIsEnabled")&&
J.AFrameworkApplication.K.ea("UseGestureInputManagerPointerCacheIsEnabled"))}fBl(){return this.Tqf?0:this.uQh?1:2}Kk(U){super.Kk(U);this.uc.gY(this.WTb,U,0,this.X8c)}Hk(U){super.Hk(U);this.uc.Maa(U,this.WTb)}g3m(U,Ea){J.AFrameworkApplication.Vob()?$a.instance.Svg().continueWith(kb=>{this.ozn();if(kb.Vh||kb.Jm)qa.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",kb.status);else{qa.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",kb.status);if(this.vqh){kb=window.Hammer;
if("undefined"===typeof kb){qa.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.V_e();return}if("undefined"===typeof kb.inputHandler){qa.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.V_e();return}}if(!U)throw this.V_e(),Error.argumentNull("source element can not be null");kb=Pb.a.Ta(U,this.spa);if(void 0===kb||null===kb)kb=new wb.a,Pb.a.ql(U,this.spa,kb),this.h3m(U);if(!kb.Na(wa[0])){var Nb=Object.assign(new ib,{DLb:ya(wa[0],this,null),rsi:Ea});kb.add(wa[0],
Nb)}}this.V_e()}):qa.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}ozn(){this.etc&&(this.Ad?this.Tvf=this.Ad.Pe("Task","RegisterGestureAdapterAfterLoad"):qa.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}V_e(){this.etc&&(this.Tvf?this.Tvf.stop():qa.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}EJn(U){qa.ULS.sendTraceTag(42256223,310,U?100:10,"source element {0} ",U.id);const Ea=
Pb.a.Ta(U,this.spa);void 0!==Ea&&null!==Ea&&(Ea.remove(wa[0]),Ea.count||(Pb.a.WY(U,this.spa),this.curRecognizer=null,this.FJn(U)))}h3m(U){this.uxh.add(U);this.uc.gY(this.WTb,U,0,this.X8c)}FJn(U){this.uxh.remove(U);this.uc.Maa(U,this.WTb)}recognize(U){var Ea=Array(U.pointers.length);for(var kb=0;kb<U.pointers.length;kb++)Ea[kb]=U.pointers[kb].target;kb=null;for(this.Qxb=this.wFl(Ea);void 0!==this.Qxb&&null!==this.Qxb&&(kb=Pb.a.Ta(this.Qxb,this.spa),void 0===kb||null===kb);this.Qxb=this.Qxb.parentNode);
if(void 0!==kb&&null!==kb){this.curRecognizer&&this.curRecognizer.state===hb.D_j&&(this.curRecognizer=null);Ea=kb.keys;for(let Nb of Ea){Ea=kb.J(Nb);void 0!==Ea&&null!==Ea&&void 0!==Ea.DLb&&null!==Ea.DLb&&(void 0===this.curRecognizer||null===this.curRecognizer||Ea.DLb===this.curRecognizer||Ea.DLb.canRecognizeWith(this.curRecognizer))&&Ea.DLb.recognize(U);const nc=Ea.DLb.state;this.curRecognizer||hb.A_j!==nc&&hb.B_j!==nc&&hb.C_j!==nc||(this.curRecognizer=Ea.DLb)}}}emit(U,Ea){if("hammer.input"!==U){this.p0a=
!1;Ea=bb.create(U,this.Qxb,Ea.srcEvent,Ea,3,this.Tqf);var kb=Pb.a.Ta(this.Qxb,this.spa);if(this.Pdm(U))var Nb=0;else if(this.tdm(U))Nb=1;else if(this.hgm(U))Nb=2;else{qa.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:kb}=kb.Ab(wa[Nb]));void 0!==kb&&null!==kb&&((kb=kb.rsi,kb.Pam())?U.endsWith("start")?this.p0a=kb.EFm(Ea):U.endsWith("end")?(kb.CFm(Ea),this.p0a=!0):U.endsWith("cancel")?(kb.BFm(Ea),this.p0a=!0):U.endsWith("move")&&(this.p0a=kb.DFm(Ea)):
qa.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",U))}}get(U){return Object(fa.a)(Hammer.Recognizer,U)}wFl(U){if(1>U.length)return null;if(1===U.length)return U[0];var Ea=U[0],kb=!0;for(let Nb=1;Nb<U.length;Nb++){if(!U[Nb])return null;if(Ea!==U[Nb]){kb=!1;break}}if(kb)return Ea;Ea=this.Vsi(U[0]);kb=0;for(const Nb of U){U=this.Vsi(Nb);if(Ea.J(Ea.count-1)!==U.J(U.count-1))return null;for(let nc=Ea.count-2,ad=U.count-2;nc>=kb&&0<=ad;nc--,ad--)if(Ea.J(nc)!==U.J(ad)){kb=nc+
1;break}}return Ea.J(kb)}Vsi(U){const Ea=new W.a;for(;void 0!==U&&null!==U;U=U.parentNode)Ea.add(U);return Ea}Pyi(U){switch(U){case w.a.hw:case w.a.wqa:return 1;case w.a.hA:case w.a.Rzc:return 2;case w.a.vx:case w.a.qRa:return 4;case w.a.XOb:case w.a.Qzc:return 8}return 0}zna(U,Ea,kb){U=this.Pyi(U);Ea=this.mDl(kb);Hammer.inputHandler(this,U,Ea);this.p0a&&kb.preventDefault();return this.p0a}Qfg(){return 1<this.Bwa.count}k4b(){qa.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.yed)for(let U of this.Bwa)this.Hnj(U.key);
else this.Bwa=new wb.a;this.session=null}Mvk(U,Ea,kb){qa.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",U);if(!this.x$c.Na(U)){try{Ea.setPointerCapture(U)}catch(Nb){qa.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",Nb)}this.x$c.add(U,Ea)}this.Bwa.$(U,kb);this.gab&&1<this.Bwa.count&&this.vJ&&!this.vJ.i4b&&(this.vJ.i4b=!0)}Hnj(U){qa.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",U);if(this.x$c.Na(U)){try{this.x$c.J(U).releasePointerCapture(U)}catch(Ea){qa.ULS.sendTraceTag(594055956,
310,10,"Exception: {0}",Ea)}this.x$c.remove(U)}else qa.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",U);this.Bwa.remove(U);this.gab&&1>=this.Bwa.count&&this.vJ&&this.vJ.i4b&&(this.vJ.i4b=!1)}Kgc(U,Ea,kb){var Nb=kb.rawEvent.pointerType.toString();const nc=kb.rawEvent.pointerId.toString();if("touch"!==Nb)return!1;U=this.Pyi(U);if(1!==U&&!this.Bwa.Na(nc))return!1;this.Mqh&&1===U&&kb.rawEvent.isPrimary&&this.Bwa.count&&(qa.ULS.sendTraceTag(593839564,310,
10,"Pointer cache should be empty"),this.k4b());this.yed?this.Mvk(nc,Ea,kb):this.Bwa.$(nc,kb);this.Lmf&&2===U&&(!this.Z$e||this.Z$e&&"function"===typeof kb.rawEvent.getCoalescedEvents)&&(Ea=kb.rawEvent.getCoalescedEvents())&&this.Qfg()&&(this.t7c=Math.max(this.t7c,Ea.length));this.JLh&&(this.p0a=!1);Nb=this.lDl(this.Bwa,kb,Nb);Hammer.inputHandler(this,U,Nb);if(4===U||8===U)this.yed?this.Hnj(nc):this.Bwa.remove(nc),this.Bwa.count||(this.session=null,this.Lmf&&-1!==this.t7c&&(qa.ULS.sendTraceTag(593597138,
310,50,"Max number of coalesced events: {0}",this.t7c),this.t7c=-1));this.p0a&&kb.preventDefault();return this.p0a}Fgc(){return!1}mDl(U){const Ea=new Eb;var kb=U.rawEvent;const Nb=kb.touches;kb=kb.changedTouches;Ea.pointers=Array.clone(Nb);Ea.pointers=Array.clone(0<Nb.length?Nb:kb);Ea.changedPointers=Array.clone(kb);Ea.srcEvent=U;Ea.pointerType="touch";return Ea}lDl(U,Ea,kb){const Nb=new Eb;Nb.pointers=gb.toArray(U.values);Nb.changedPointers=[Ea];Nb.pointerType=kb;Nb.srcEvent=Ea;return Nb}Pdm(U){return bc.a.startsWith(U,
w.a.pinch)}tdm(U){return bc.a.startsWith(U,w.a.pan)}hgm(U){return bc.a.startsWith(U,w.a.swipe)}}Object(c.a)(Lb,"GestureInputManager",G.a,[1817,1818]);var Ic=b(224);class vb{constructor(){this.Z=null;this.wh=!1}get name(){return"Common.App.GestureInputManager"}Hb(U){U.register(Lb,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").singleInstance().zd(()=>new Lb(Ic.a.instance,J.AFrameworkApplication.la.Np));this.Z=U}init(){this.wh||(this.Z.resolve("Common.App.GestureManager.GestureInputManager"),
this.wh=!0)}dispose(){}static main(){ba.a.instance.Sb(new vb)}}Object(c.a)(vb,"GestureInputManagerPackage",null,[1,2]);var xb=b(245),Db=b(46),ab=b(1367);class dc{constructor(U,Ea,kb){this.quf=this.puf=null;this.Awc=new l.a;this.nf=U;this.I8c=kb;this.A6=Ea.appSettings[dc.kSn]||""}get Cqn(){return this.Awc.task}get oya(){return this.nf.value}X$m(){const U={};U[dc.gYl]=J.AFrameworkApplication.Fk;U["Content-Type"]="application/json; charset=utf-8";qa.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");
const Ea=Db.a.Qm(this.A6+dc.Dqn,dc.yBm,J.AFrameworkApplication.la.eb.Bm.toString());this.oya.Ni(Ea,1,"",U,!0,2,Object(u.a)(this,this.Rgc,"onSuccessCallback"),Object(u.a)(this,this.zgc,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}Tom(U){try{const Ea={};Ea.FlightName=U.FlightName;Ea.SessionID=U.SessionID;qa.ULS.sendTraceTag(594883776,215,50,ra.c(Ea))}catch(Ea){qa.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}Rgc(U){if((U=U.data.Rd)&&U.length)try{const Ea=ra.a(U);this.puf=
Ea.NavBarDataJson;qa.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.puf?({at:this.quf}=ra.d(Ea.NavBarDataJson)).returnValue?(this.Tom(this.quf),this.Awc.mf(this.quf)):(qa.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:ab.a.oZd(this.puf)}),this.Awc.SK()):(qa.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.Awc.SK())}catch(Ea){qa.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),
this.Awc.SK()}else qa.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}zgc(){this.Awc.SK();qa.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return dc.na||(dc.na=dc.H8b())}static H8b(){return new dc(new xb.a(()=>J.AFrameworkApplication.Gd),J.AFrameworkApplication.K,J.AFrameworkApplication.la.eb.Bm)}}dc.gYl="X-qs";dc.yBm="at";dc.Dqn="O365ShellServiceProxy.ashx";dc.na=null;dc.kSn="ShellWebServiceBase";Object(c.a)(dc,"O365ShellActor",
null,[1899]);class tb{constructor(){this.Z=null}get name(){return"Common.App.O365Shell"}Hb(U){this.Z=U;this.Z.register(dc,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").singleInstance().zd(()=>new dc(new xb.a(()=>J.AFrameworkApplication.Gd),J.AFrameworkApplication.K,J.AFrameworkApplication.la.eb.Bm))}init(){J.AFrameworkApplication.K.wq(Object(u.a)(this,this.Gw,"onFullAppSettingsReady"))}Gw(){J.AFrameworkApplication.t0d&&J.AFrameworkApplication.la.eb.eM&&this.Z.resolve("Common.App.O365Shell.O365ShellActor").X$m()}dispose(){}static main(){ba.a.instance.Sb(new tb)}}
Object(c.a)(tb,"PackageManager",null,[1,2]);class yb{xBa(){}init(){}dispose(){}}Object(c.a)(yb,"NoOpOfflineLogger",null,[1854,12]);var rc=b(563);class fc{}fc.lje=0;Object(c.a)(fc,"OfflineLoggerConstants",null,[]);var uc=b(81),Uc=b(214),tc=b(302);class Tb{constructor(U,Ea,kb,Nb,nc){this.Zcb=!1;this.Bea=null;this.e_c=this.juc=this.SRb=0;this.Yy=this.Dzb=this.RZ=null;this.kj=!1;this.KOa=kb;this.lQa=Nb;this.Zwa=nc;this.nf=Ea;this.fb=U}init(){this.g3g();this.Dlm();this.Zcb=!1;this.nf.KBb(this);this.RZ=
new uc.a(3,2,2500,Object(u.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.fb.rb(this.RZ)}hjd(U){return"OfflineLog|"+U}Dlm(){const U=this.KOa.getItem("OfflineLoggerManifest");void 0!==U&&null!==U&&0<U.length&&(this.Bea=Tb.eVc(U));this.Bea||(this.Bea={});if(void 0===this.Bea.end||null===this.Bea.end)this.Bea.end=0;if(void 0===this.Bea.offset||null===this.Bea.offset)this.Bea.offset=0;this.SRb=this.Bea.offset;isFinite(this.SRb)||(this.SRb=0);this.juc=this.Bea.end;isFinite(this.juc)||(this.juc=
0);this.e_c=this.juc}g3g(){this.Dzb=new tc.a;this.Yy=new Uc.a;this.lQa.ICf(Object(u.a)(this,this.OJg,"onUlsReadyToBeSent"));this.lQa.XCf(Object(u.a)(this,this.QJg,"onUlsSentSuccessfully"));this.lQa.WCf(Object(u.a)(this,this.PJg,"onUlsSentFailed"));this.lQa.ACf(Object(u.a)(this,this.PFg,"onAfterUlsHostDisposed"))}OJg(U,Ea){if(void 0!==Ea&&null!==Ea&&void 0!==Ea.args&&null!==Ea.args){U=!1;if(!this.Dzb.Na(Ea.args.tag)){if(!this.Dzb.Na(fc.lje))return;U=!0}this.Dzb.remove(U?fc.lje:Ea.args.tag);this.Yy.Na(Ea.iA)||
this.Yy.$(Ea.iA,new W.a);this.Yy.J(Ea.iA).add(Ea.args)}}QJg(U,Ea){this.Yy.remove(Ea.iA)}PJg(U,Ea){if(void 0!==Ea&&null!==Ea&&this.Yy.Na(Ea.iA)){U=this.Yy.J(Ea.iA);for(let kb=0,Nb=U.count;kb<Nb;++kb)Ea=Tb.serialize(U.J(kb),this.Zwa),this.CZd(this.hjd(this.e_c++),Ea)}}PFg(){this.dispose()}CZd(U,Ea){try{return this.KOa.setItem(U,Ea),!0}catch(kb){return qa.ULS.sendTraceTag(18614232,222,15,"OfflineLogger SetItem failed with exception: {0}",kb.message),!1}}sendOfflineLogs(){if(!this.Zcb){for(var U=this.SRb,
Ea=new W.a,kb=null;U<this.juc&&5>=Ea.count;++U){var Nb=this.hjd(U);const nc=this.KOa.getItem(Nb);this.KOa.removeItem(Nb);if(void 0===nc||null===nc)continue;const ad=({sessionId:Nb}=Tb.deserialize(nc)).returnValue;if(ad){if(!kb)kb=Nb;else if(Nb!==kb)break;Ea.add(ad)}else qa.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",nc)}0<Ea.count&&this.lQa.EWg(this,gb.toArray(Ea),kb);this.SRb=U;U>=this.juc&&(this.fb.ie(this.RZ),this.RZ=null)}}xBa(U,Ea,kb){!this.kj&&qa.ULS.jT(Ea,kb)&&
this.Dzb.$(U,!0)}dispose(){if(!this.kj){this.RZ&&this.fb.ie(this.RZ);var U=gb.toArray(this.Yy.keys);U.sort();for(const Ea of U){U=this.Yy.J(Ea);for(let kb=0,Nb=U.count;kb<Nb;++kb){const nc=Tb.serialize(U.J(kb),this.Zwa);this.CZd(this.hjd(this.e_c++),nc)}}this.SRb<this.e_c?(this.Bea.end=this.e_c,this.Bea.offset=this.SRb,this.CZd("OfflineLoggerManifest",JSON.stringify(this.Bea))):this.KOa.removeItem("OfflineLoggerManifest")}this.kj=!0}Zsa(){this.Zcb=!0}X6a(){this.Zcb=!1}static serialize(U,Ea){const kb=
{};kb.t=U.tag;kb.c=U.category;kb.l=U.level;kb.m=U.message;kb.lt=U.logType;kb.s=Ea;kb.ts=U.timestamp;kb.o=U.isMinified;kb.a=U.args;return JSON.stringify(kb)}static deserialize(U){return(U=Tb.eVc(U))?{returnValue:new rc.a(U.ts,U.c,U.t,U.l,U.m,U.lt,U.o,U.a),sessionId:U.s}:{returnValue:null,sessionId:null}}static eVc(U){try{return JSON.parse(U)}catch(Ea){qa.ULS.sendTraceTag(18614234,222,10,"OfflineLogger TryParseString failed with exception: {0}",Ea.message)}return null}}Object(c.a)(Tb,"OfflineLoggerImpl",
null,[1854,12,178]);class qb{constructor(U,Ea,kb,Nb){this.sessionId=U;this.version=Ea;this.$hd=kb;this.MPe=Nb;this.Ssa=new W.a}}Object(c.a)(qb,"CachedLogUpload",null,[]);class Jb{constructor(U){U.name&&(this.n=U.name);U.stack&&(this.s=U.stack);U.message&&(this.m=U.message);U.file&&(this.f=U.file);null!=U.line&&(this.l=U.line);null!=U.column&&(this.c=U.column)}}Object(c.a)(Jb,"LoggingExceptionArgsLocalStorage",null,[]);class Zb{constructor(U){this.t=U.tag;this.c=U.category;this.l=U.level;this.m=U.message;
this.lt=U.logType;this.ts=U.timestamp;this.o=U.isMinified;this.a=U.args;U.exceptionArgs&&(this.e=new Jb(U.exceptionArgs))}}Object(c.a)(Zb,"LoggingArgsLocalStorage",null,[]);var ec=b(339);class zc{constructor(U,Ea,kb,Nb,nc,ad){this.t=U;this.m=Ea;this.s=kb;this.v=Nb;this.i=nc;this.a=ad;this.op="Log"}}Object(c.a)(zc,"LoggingKeyLocalStorage",null,[]);var Oc=b(130);const ud=(U,Ea,kb)=>!(void 0===U||null===U)&&!(void 0===U.i||null===U.i)&&!(void 0===U.t||null===U.t)&&!(void 0===U.s||null===U.s)&&"Log"===
U.op&&U.t===Ea&&isFinite(U.t)&&Oc.a.Yb(U.s)&&(void 0===U.m||null===U.m||U.m===kb);class Ad{constructor(U,Ea,kb,Nb,nc,ad,Od,af,ve,eh,Ci){this.Zcb=this.REh=this.IEh=this.JEh=!1;this.Yy=this.Dzb=this.Bea=this.RZ=null;this.kj=!1;this.qWb=[];this.euc=[];this.KOa=kb;this.lQa=Nb;this.Zwa=nc;this.nf=Ea;this.fb=U;this.I8c=ad;this.Iof=Od;this.QLh=af;this.Lja=ve;this.bfk=eh;this.xkf=Ci}get manifest(){return this.Bea}get AGd(){return this.Dzb}get wJa(){return this.Yy}init(){this.g3g();this.Zcb=!1;this.nf.KBb(this);
this.RZ=new uc.a(3,1,2500,Object(u.a)(this,this.determineLogsToSendAtBoot,"determineLogsToSendAtBoot"),103);this.fb.rb(this.RZ)}determineLogsToSendAtBoot(){this.pgi(!0)}determineLogsToSendOnReconnect(){this.pgi(!1)}pgi(U){this.$se();this.qWb=[];U&&(this.euc=[]);for(var Ea=0;Ea<this.KOa.length;Ea++){const kb=this.KOa.key(Ea),Nb=Ad.eVc(kb,!1);ud(Nb,this.I8c,this.Iof)&&(Nb.s===this.Zwa?Array.add(this.qWb,kb):U&&Array.add(this.euc,kb))}if(this.qWb.length||U&&this.euc.length)if(Ea=this.xkf?Object(u.a)(this,
this.Axn,"sortDescendKeysToUpload"):Object(u.a)(this,this.Dxn,"sortKeysToUpload"),this.qWb.sort(Ea),U&&this.euc.sort(Ea),0<this.qWb.length||0<this.euc.length)this.RZ=new uc.a(3,2,2500,Object(u.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),105),this.fb.rb(this.RZ)}Dxn(U){return U.s!==U.s?U.s.localeCompare(U.s):U.i-U.i}Axn(U){return U.s!==U.s?U.s.localeCompare(U.s):U.i-U.i}hjd(U,Ea,kb,Nb){return JSON.stringify(new zc(this.I8c,this.Iof,Ea,kb,U,Nb))}g3g(){this.Dzb=new tc.a;this.Yy=new Uc.a;this.lQa.ICf(Object(u.a)(this,
this.OJg,"onUlsReadyToBeSent"));this.lQa.XCf(Object(u.a)(this,this.QJg,"onUlsSentSuccessfully"));this.lQa.WCf(Object(u.a)(this,this.PJg,"onUlsSentFailed"));this.lQa.ACf(Object(u.a)(this,this.PFg,"onAfterUlsHostDisposed"))}OJg(U,Ea){if(void 0!==Ea&&null!==Ea&&void 0!==Ea.args&&null!==Ea.args){if(this.AGd.Na(Ea.args.tag))this.AGd.remove(Ea.args.tag);else if(this.AGd.Na(fc.lje))this.AGd.remove(fc.lje);else if(!(this.bfk&&50>Ea.args.level))return;({value:U}=this.wJa.Ab(Ea.iA)).returnValue||(U=new qb(Ea.sessionId,
Ea.version,Ea.$hd,Ea.MPe),this.wJa.$(Ea.iA,U));this.wJa.J(Ea.iA).Ssa.add(Ea.args)}}QJg(U,Ea){this.wJa.remove(Ea.iA)}PJg(U,Ea){void 0!==Ea&&null!==Ea&&this.wJa.Na(Ea.iA)&&this.f5i(Ea.iA)&&!this.REh&&(this.REh=!0,qa.ULS.sendTraceTag(37290073,222,50,"Added logs to local storage."))}f5i(U){let Ea=!1;if(({value:Nb}=this.wJa.Ab(U)).returnValue&&Nb&&0<Nb.Ssa.count){if(Nb.$hd>=this.Lja)return!1;var kb=Nb.Ssa;const nc=Array(kb.count);for(let ad=0,Od=kb.count;ad<Od;++ad)nc[ad]=new Zb(kb.J(ad));kb=Ad.serialize(nc);
var Nb=this.hjd(Nb.MPe,Nb.sessionId,Nb.version,Nb.$hd);this.CZd(Nb,kb)&&(this.wJa.remove(U),Ea=!0)}return Ea}PFg(){this.dispose()}CZd(U,Ea){try{return this.KOa.setItem(U,Ea),!0}catch(kb){return qa.ULS.sendTraceTag(37290074,222,15,"OfflineLogger SetItem failed with exception: {0}",kb.message),!1}}sendOfflineLogs(){if(!this.Zcb){var U=0<this.qWb.length?this.qWb:this.euc,Ea=U.length;if(Ea)for(;0<Ea;){J.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordSendOfflineLogsV2ImprovementSettings");
Ea--;var kb=this.xkf?U.pop():U[0];this.xkf||Array.removeAt(U,0);const ad=Ad.eVc(kb,!0);if(ud(ad,this.I8c,this.Iof)){var Nb=this.KOa.getItem(kb);this.KOa.removeItem(kb);if(void 0!==Nb&&null!==Nb)if(ad.a>this.Lja)qa.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",ad.a,this.Lja);else if(kb=Ad.eVc(Nb,!0),void 0!==kb&&null!==kb&&isFinite(kb.length))if(kb.length){Nb=kb[kb.length-1];var nc=(new Date).getTime()-Nb.ts;if(nc<-Ad.TIj)qa.ULS.sendTraceTag(37290078,222,50,
"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",Nb.ts);else if(nc>this.QLh*Ad.TIj)qa.ULS.sendTraceTag(37290079,222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.QLh,Nb.ts);else{ad.s===this.Zwa?this.JEh||(this.JEh=!0,qa.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.IEh||(this.IEh=!0,qa.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",ad.s));
Ea=Array(kb.length);for(Nb=0;Nb<kb.length;Nb++){U=Nb;a:{nc=kb[Nb];if(void 0===nc||null===nc){nc=null;break a}let Od=null;nc.e&&(Od=new ec.a(null),Od.name=nc.e.n,Od.stack=nc.e.s,Od.message=nc.e.m,Od.file=nc.e.f,Od.line=nc.e.l,Od.column=nc.e.c);nc=new rc.a(nc.ts,nc.c,nc.t,nc.l,nc.m,nc.lt,nc.o,nc.a,Od)}Ea[U]=nc}this.lQa.EWg(this,Ea,ad.s,ad.v,ad.a+1,ad.i);break}}else qa.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",Nb);else qa.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",
Nb)}}else this.$se()}}xBa(U,Ea,kb){!this.kj&&qa.ULS.jT(Ea,kb)&&this.AGd.$(U,!0)}dispose(){if(!this.kj){this.RZ&&this.fb.ie(this.RZ);var U=gb.toArray(this.wJa.keys);for(const Ea of U)this.f5i(Ea)}this.kj=!0}Zsa(){this.Zcb=!0;this.$se()}X6a(){this.Zcb=!1;this.$se();this.RZ&&this.fb.ie(this.RZ);this.RZ=new uc.a(3,1,2500,Object(u.a)(this,this.determineLogsToSendOnReconnect,"determineLogsToSendOnReconnect"),102);this.fb.rb(this.RZ)}$se(){this.RZ&&(this.fb.ie(this.RZ),this.RZ=null)}static serialize(U){return JSON.stringify(U)}static eVc(U,
Ea){try{return JSON.parse(U)}catch(kb){Ea&&qa.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",kb.message)}return null}}Ad.TIj=864E5;Object(c.a)(Ad,"OfflineLoggerImplV2",null,[1854,12,178]);class xd{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(U){return this.handleError("Length",U),-1}}key(U){try{return localStorage.key(U)}catch(Ea){return this.handleError("Key",Ea),null}}getItem(U){try{return localStorage.getItem(U)}catch(Ea){return this.handleError("GetItem",
Ea),null}}setItem(U,Ea){try{return localStorage.setItem(U,Ea)}catch(kb){return this.handleError("SetItem",kb),null}}removeItem(U){try{localStorage.removeItem(U)}catch(Ea){this.handleError("RemoveItem",Ea)}}clear(){try{localStorage.clear()}catch(U){this.handleError("Clear",U)}}handleError(U,Ea){qa.ULS.sendTraceTag(19170128,222,10,"Invoking localStorage function[{0}] failed, message: {1}",U,Ea.message)}}Object(c.a)(xd,"OfflineStorage",null,[1853]);class re{create(U){let Ea=null;try{void 0!==localStorage&&
null!==localStorage&&(Ea=new xd)}catch(kb){qa.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",kb.message)}Object.getType(qa.ULS.host).implementsInterface(1E3)&&Ea||(qa.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",Ea?"supported":"not supported",Object.getType(qa.ULS.host).implementsInterface(1E3)?"supported":"not supported"),U=0);U=1===U?new Tb(J.AFrameworkApplication.tb,J.AFrameworkApplication.Gd,Ea,qa.ULS.host,
J.AFrameworkApplication.userSessionId):2===U?new Ad(J.AFrameworkApplication.tb,J.AFrameworkApplication.Gd,Ea,qa.ULS.host,J.AFrameworkApplication.userSessionId,J.AFrameworkApplication.la.eb.Bm,J.AFrameworkApplication.la.eb.tca,J.AFrameworkApplication.K.jb("OfflineLoggerRetentionInDays",30),J.AFrameworkApplication.K.jb("OfflineLoggerMaxAttempts",5),J.AFrameworkApplication.K.ea("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),J.AFrameworkApplication.K.ea("SendOfflineLogsV2ImprovementIsEnabled")):
new yb;U.init();return U}}Object(c.a)(re,"OfflineLoggerFactory",null,[]);class mc{Hb(){}get name(){return"Common.App.OfflineLogger"}init(){const U=J.AFrameworkApplication.K;let Ea=0;U.ea("OneNoteOfflineLoggerIsEnabled")?Ea=1:U.ea("OfflineLoggerV2IsEnabled")&&(Ea=2);0!==Ea&&(J.AFrameworkApplication.nYd=(new re).create(Ea))}dispose(){}}Object(c.a)(mc,"OfflineLoggerPackage",null,[1,2]);const Ab=U=>{try{return ra.a(U)}catch(Ea){}return null};class oc{constructor(U,Ea,kb,Nb,nc,ad){this.f6=!1;this.Ss=null;
this.Hqf=!1;this.ga=U;this.nf=Ea;this.yk=kb;this.XDh=Nb;this.va=nc;this.Mek=ad}init(U,Ea){Ea&&U.Ca("Common.Interface.IRtcBasicProvider").execute(Object(u.a)(this,this.CGf,"awaitRtc"))}CGf(U){const Ea=U.Vud();Ea.continueWith(()=>{this.Ss=Ea.result;this.Hqf&&(this.Ss.GV(2,null,!0),this.Hqf=!1);this.Ss.Wea((kb,Nb)=>{2===Nb.type&&this.Tb.processAction(za.a.fileNameUpdate,2)});this.Ss.QQa((kb,Nb)=>{2===Nb.newState&&this.Tb.processAction(za.a.fileNameUpdate,2)});2===this.Ss.connectionState&&this.Tb.processAction(za.a.fileNameUpdate,
2)})}VSa(U){this.ami(U,!0)}ami(U,Ea){const kb=this.iKk(U.PDj),Nb={};Nb[oc.T$h]=oc.U$h;this.jqj.Ni(kb,2,"",Nb,!1,2,Object(u.a)(this,this.dOc,"onRefreshFilenameSuccess"),Ea?Object(u.a)(this,this.MIm,"onRefreshFilenameFailureRetry"):Object(u.a)(this,this.iaj,"onRefreshFilenameFailureNoRetry"),U)}dOc(U){this.f6=!1;const Ea=Ab(U.data.Rd);U.data.state.onSuccess(Ea,this.XDh.value)}MIm(U){5!==U.data.status||this.f6?this.iaj(U):(this.f6=!0,this.ami(U.data.state,!1))}iaj(U){U.data.state.onFailure(-1)}BEb(U){this.bmi(U,
!0)}bmi(U,Ea){const kb=this.jKk(),Nb={};Nb[oc.T$h]=oc.U$h;Nb[oc.eYl]=bc.a.Xh(U.uqj);Nb[oc.cYl]=this.Mek.value.cUk;this.jqj.Ni(kb,2,"",Nb,!1,2,Object(u.a)(this,this.IKd,"onRenameFileSuccess"),Ea?Object(u.a)(this,this.RIm,"onRenameFileFailureRetry"):Object(u.a)(this,this.kaj,"onRenameFileFailureNoRetry"),U)}jKk(){return this.x2h()}iKk(U){let Ea=this.x2h();return Ea=Db.a.Qm(Ea,oc.iYl,U?"2":"1")}x2h(){let U=(this.va.value.appSettings.RenameWebServiceBase||"")+oc.dYl;U=Db.a.Qm(U,oc.fYl,bc.a.Xh(J.AFrameworkApplication.Fk));
this.Xp&&this.Xp.qog&&(U=Db.a.Qm(U,oc.hYl,"1"));return U}IKd(U){this.f6=!1;const Ea=Ab(U.data.Rd);U.data.state.onSuccess(Ea,this.XDh.value);this.a7i()}a7i(){this.Ss?this.Ss.GV(2,null,!0):this.Hqf=!0}RIm(U){5!==U.data.status||this.f6?this.kaj(U):(this.f6=!0,this.bmi(U.data.state,!1))}kaj(U){U.data.state.onFailure(-1)}get Tb(){return this.ga.value}get jqj(){return this.nf.value}get Xp(){return this.yk.value}static get instance(){return oc.na||(oc.na=oc.H8b())}static H8b(){return new oc(new xb.a(()=>
J.AFrameworkApplication.pa),new xb.a(()=>J.AFrameworkApplication.Gd),new xb.a(()=>J.AFrameworkApplication.Xp),new xb.a(()=>ia.a.instance.resolve("Postmessage.IHostPostmessenger")),new xb.a(()=>J.AFrameworkApplication.K),new xb.a(()=>ia.a.instance.resolve("Common.IRenameProps")))}}oc.T$h="Content-Type";oc.U$h="application/json; charset=utf-8";oc.dYl="renamehandler.ashx";oc.fYl="qs";oc.eYl="n";oc.hYl="sl";oc.cYl="X-CoauthLockId";oc.iYl="u";oc.na=null;Object(c.a)(oc,"ExecuteRenameFileHandler",null,[]);
class Mc{constructor(){this.onFailure=this.onSuccess=null;this.PDj=!1}}Object(c.a)(Mc,"ExecuteRefreshFilenameData",null,[]);class Ec{constructor(){this.onFailure=this.onSuccess=this.uqj=null}}Object(c.a)(Ec,"ExecuteRenameFileData",null,[]);class kd{constructor(){this.Z=null;this.ref=oc.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}Hb(U){this.Z=U}init(){J.AFrameworkApplication.K.wq(Object(u.a)(this,this.Gw,"onFullAppSettingsReady"))}Gw(){J.AFrameworkApplication.QKc()&&(oc.instance.init(this.Z,
J.AFrameworkApplication.DQc),J.AFrameworkApplication.BEb=Object(u.a)(this,this.BEb,"executeRenameFile"),J.AFrameworkApplication.VSa=Object(u.a)(this,this.VSa,"executeRefreshFilename"),J.AFrameworkApplication.SRc=Object(u.a)(this,this.SRc,"sendFileNameAndLocationUpdateNotification"))}BEb(U,Ea,kb){const Nb=new Ec;Nb.uqj=U;Nb.onSuccess=Ea;Nb.onFailure=kb;this.ref.BEb(Nb)}VSa(U,Ea,kb){const Nb=new Mc;Nb.onSuccess=U;Nb.onFailure=Ea;Nb.PDj=kb;this.ref.VSa(Nb)}SRc(){this.ref.a7i()}dispose(){}}Object(c.a)(kd,
"PackageManager",null,[1,2]);var Xd=b(129);class Bc{constructor(U,Ea,kb){this.K5g=this.L5g=this.M5g=!1;this.d6g=!U&&!Ea;this.e6g=!U&&!kb;this.d6g||this.e6g||(this.M5g=!U,this.L5g=!Ea,this.K5g=!kb)}}Object(c.a)(Bc,"RenameDisabledDialogInfo",null,[]);class jd extends Xd.StandardDialog{constructor(U,Ea,kb,Nb,nc){super();this.y$g=[];this.f$=new Bc(U,Ea,kb);this.uBb=Nb;this.mzb=nc;this.Je="RenameDisabledDialog";this.wc=0;this.ee(1,CommonUIStrings.l_DialogClose);this.Zon();this.i9m()}Zon(){this.f$.d6g?
this.LVd(this.uBb?this.mzb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.f$.e6g?this.LVd(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.svk();this.k2b(this.y$g)}LVd(U){Array.add(this.y$g,U)}svk(){const U=[];this.f$.M5g||Array.add(U,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.f$.L5g||Array.add(U,CommonUIStrings.l_RenameFileRenameDisabledPermission);
this.f$.K5g||Array.add(U,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<U.length&&Array.add(this.y$g,U)}}Object(c.a)(jd,"ReactRenameDisabledDialogBase",Xd.StandardDialog,[]);class Vc extends jd{constructor(U,Ea,kb,Nb,nc){super(U,Ea,kb,Nb,nc)}i9m(){this.P6a(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(c.a)(Vc,"ReactRenameDisabledDialog",jd,[]);var Ye=b(149);class Cd{static get Lf(){return Ye.a.oz(Cd.fm,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,
CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}Cd.fm="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(c.a)(Cd,"RenameDisabledDialogHtml",null,[]);class of extends Ye.a{constructor(U,Ea,kb,Nb,nc){super();this.f$=new Bc(U,Ea,kb);this.uBb=Nb;this.mzb=nc;this.Je="RenameDisabledDialog";this.wc=0;this.ee(1,CommonUIStrings.l_DialogClose);this.Lf=Cd.Lf;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.k5("RenameRow")}rV(){if(this.f$.d6g){let U;U=this.uBb?this.mzb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;of.LVd(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),U)}else this.f$.e6g?of.LVd(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.x_l()}x_l(){this.f$.M5g&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.f$.L5g&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.f$.K5g&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static LVd(U,Ea,kb){U.style.display="none";Ea.innerText=kb}}Object(c.a)(of,"RenameDisabledDialog",Ye.a,[]);var Je=b(66);class gd{constructor(U,Ea){this.rXb=0;this.ga=U;this.P_a=Ea}initialize(U){if(!this.ga||!this.P_a)return!1;this.rXb=U;this.lb();return!0}lb(){this.ga.ma(za.a.Sne,Je.a.frame,Object(u.a)(this,this.Sne,"commitNewDocumentTitle"))}Sne(U,Ea,kb,Nb,nc){if(1===kb)return this.ga.processAction(za.a.renameFile,
1);U=bc.a.HN(this.P_a.EB);nc=(0,nc.getNewDocumentTitle)();nc.length>this.rXb&&(nc=nc.substr(0,this.rXb));if(32!==this.ga.ob(za.a.renameFile,2,nc))return this.BVc(U),8;this.BVc(nc);return 32}BVc(U){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(U))}static al(){return new gd(J.AFrameworkApplication.pa,J.AFrameworkApplication.Bs)}}Object(c.a)(gd,"ReactRenameUIHandler",null,[1867]);var Te=b(904),cg=b(1425),Jg=b(550),Ga=b(92),Oa=b(190),Wb=b(59);class Ac{constructor(U,Ea,kb,Nb,nc,ad,Od,af,
ve,eh,Ci,Hj){this._initialized=!1;this._element=null;this.rXb=0;this.Ttf=this.Dhf=!1;this.ga=U;this.dva=Ea;this.Cc=kb;this.Pt=Nb;this.P_a=nc;this.DMh=ad;this.Vde=Od;this.oaf=af;this.Pyb=ve;this.QBh=eh;this.Sh=Ci;this.ejf=Hj}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(U,Ea,kb){if(!(this.ga&&this.P_a&&this.DMh&&this.Vde&&this.oaf&&Ea)||0>=U)return!1;this._element=Ea;this._element.title=kb;this._element.setAttribute(Wb.a.ig,Wb.a.l3);this._element.setAttribute("Unselectable",
"on");this.rXb=U;this.wD();return this._initialized=!0}wD(){this.dva&&(this.dva.Ea(w.a.blur,this._element,Object(u.a)(this,this.onBlur,"onBlur")),this.dva.Ea(w.a.paste,this._element,Object(u.a)(this,this.EKd,"onPaste")));this.Cc.Ea(w.a.Nf,this._element,Object(u.a)(this,this.onKeyDown,"onKeyDown"));this.Pt.Ea(w.a.pointerDown,this._element,Object(u.a)(this,this.ZF,"onPointerDown"));this.Pt.Ea(w.a.UE,this._element,Object(u.a)(this,this.kta,"onPointerUp"))}onBlur(){this.isActive&&!this.Dhf&&(this.QBh||
this.oaf(this._element),this.g9h(),this.sUf(!1));return this.Dhf=!1}EKd(){qa.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(U){return this.isActive?this.GGm(U):this.HGm(U)}GGm(U){let Ea=!1;switch(U.Ua.keyCode){case Sys.UI.Key.enter:this.g9h();this.sUf(this.Sh||this.ejf);Ea=!0;break;case Sys.UI.Key.tab:this.QBh&&this.oaf(this._element);break;case Sys.UI.Key.esc:this.mXg(),this.sUf(this.Sh||this.ejf),Ea=!0}return Ea}HGm(U){let Ea=!1;switch(U.Ua.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.kLj(this.ejf),
this.isActive&&this.Vde(this._element),Ea=!0}return Ea}ZF(){this.isActive||(this.kLj(!1),this.isActive&&(this._element.focus(),this.Vde(this._element),this.Ttf=!0));return!1}kta(){return this.Ttf?(this.Vde(this._element),this.Ttf=!1,!0):!1}PKc(){return 32===this.ga.processAction(za.a.renameFile,1)}g9h(){const U=bc.a.HN(this.P_a.EB);let Ea=this._element.innerText.trim();Ea.length>this.rXb&&(Ea=Ea.substr(0,this.rXb));Ea!==U&&""!==Ea?32!==this.ga.ob(za.a.renameFile,2,Ea)?this.mXg():this.BVc(Ea):this.mXg()}mXg(){this.BVc(bc.a.HN(this.P_a.EB))}BVc(U){this._initialized&&
(this._element.innerText=U,this.DMh())}kLj(U){this.PKc()?this.isActive||(U&&(this.Dhf=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Wb.a.ig,Wb.a.VFf),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,Te.CuiHelper.aji),this.Pyb&&this.Pyb.execute(Ea=>{Ea.djj(!0)}),U&&this._element.focus(),qa.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.processAction(za.a.smc,
2)}sUf(U){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Wb.a.ig,Wb.a.l3);Sys.UI.DomElement.removeCssClass(this._element,Te.CuiHelper.aji);this.Pyb&&this.Pyb.execute(Ea=>{Ea.djj(!1)});U&&(this._element.blur(),this._element.focus())}static PCa(){cg.a.PCa(J.AFrameworkApplication.isRtl)}static al(){return new Ac(J.AFrameworkApplication.pa,Jg.a.instance,Ga.KeyInputManager.instance,Oa.a.instance,J.AFrameworkApplication.Bs,Ac.PCa,
da.a.muj,da.a.qMf,ia.a.instance.Ca("Common.App.Header.HeaderEventSource"),Ma.a.Sx,Ma.a.tg,Ma.a.Og)}}Object(c.a)(Ac,"RenameUIHandler",null,[1867]);class sd{static get instance(){return J.AFrameworkApplication.la.eb.eM?sd.na||(sd.na=gd.al()):sd.na||(sd.na=Ac.al())}}sd.na=null;Object(c.a)(sd,"RenameUIHandlerFactory",null,[]);class Xe{constructor(){this.$Dg=this.$ym=this.$5k=null}}Object(c.a)(Xe,"RenameMruEntryProperties",null,[]);var xe=b(164),we=b(89),bf=b(1366),ch;(function(U){U[U.unknown=-1]="unknown";
U[U.success=0]="success";U[U.renameInvalidFileName=1]="renameInvalidFileName";U[U.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";U[U.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";U[U.permissionDenied=4]="permissionDenied";U[U.serverCommunicationFailure=5]="serverCommunicationFailure";U[U.fileNameTooLong=6]="fileNameTooLong"})(ch||(ch={}));Object(c.b)("CommonOperationResult",ch);class Pf{constructor(U,Ea,kb,Nb,nc,ad,Od,af,ve,eh,Ci,Hj){this.iCh=U;this.ga=Ea;this.yk=kb;this.UQ=
Nb;this.MWb=nc;this.xrk=ad;this.uBb=Od;this.jRh=af;this.Xkk=ve;this.mzb=eh;this.va=Ci;this.Wkk=Hj}lb(){J.AFrameworkApplication.la&&J.AFrameworkApplication.la.eb.eM||this.Tb.ma(za.a.abc,Je.a.frame,Object(u.a)(this,this.abc,"initializeRenameUIHandler"));this.Tb.ma(za.a.smc,Je.a.frame,Object(u.a)(this,this.smc,"showRenameDisabledDialog"));this.Tb.ma(za.a.renameFile,Je.a.frame,Object(u.a)(this,this.renameFile,"renameFile"));this.Tb.Aa(za.a.fileNameUpdate,Je.a.frame,Object(u.a)(this,this.H1m,"refreshFilename"),
64);this.Tb.Aa(za.a.zId,Je.a.frame,Object(u.a)(this,this.zId,"moveToFolderCompleteByHost"),64);this.Tb.ma(za.a.rqb,Je.a.frame,Object(u.a)(this,this.rqb,"moveToFolder"));J.AFrameworkApplication.la&&(J.AFrameworkApplication.K.ea("PostMessageEmbedded")||J.AFrameworkApplication.K.ea("IsJsApi"))&&J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0)&&J.AFrameworkApplication.jH().execute(U=>{U.ax(we.a.eBg);U.uD(we.a.eBg,Pf.B_m);U.ax(we.a.eue);U.uD(we.a.eue,
Pf.z_m)})}PKc(){return 0===this.Wkk.YCi()?32:8}zQn(){return this.Xp?this.uBb?this.Xp.qii:this.Xp.mlb:!0}abc(){return sd.instance.initialize(J.AFrameworkApplication.oEc,J.AFrameworkApplication.WXf,J.AFrameworkApplication.gVg||CommonUIStrings.l_RenameFileTooltip)?32:8}smc(){const U=this.zQn(),Ea=this.xrk();qa.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.MWb,Ea,U,this.uBb);J.AFrameworkApplication.la&&J.AFrameworkApplication.la.eb.wz&&J.AFrameworkApplication.K.ea("ReactRenameDisabledDialogIsEnabled")?new Vc(this.MWb,!Ea,!U,this.uBb,this.mzb()):new of(this.MWb,!Ea,!U,this.uBb,this.mzb());return 32}renameFile(U,Ea,kb,Nb,nc){if(1===kb)return this.PKc();if(!J.AFrameworkApplication.BEb)return 8;if(8===this.PKc())return this.Tb.processAction(za.a.smc,2),8;qa.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");J.AFrameworkApplication.BEb(nc,Object(u.a)(this,
this.IKd,"onRenameFileSuccess"),Object(u.a)(this,this.QIm,"onRenameFileFailure"));return 32}IKd(U,Ea){U?0!==U.OperationResult?this.$Hi(U.OperationResult):(this.hhn(Ea,U.NewName),this.GKn(U,Object(u.a)(J.AFrameworkApplication.la.eb,J.AFrameworkApplication.la.eb.ceh,"updateOpenInClientDocumentUrl")),J.AFrameworkApplication.K.ea("DocumentNameInJewelInfoMenuIsEnabled")&&J.AFrameworkApplication.la.updateCommandUI(),this.Xkk.rNj()):this.$Hi(5)}hhn(U,Ea){const kb={};kb[xe.a.Ini]=Ea;U.Eh(we.a.eue,kb)}GKn(U,
Ea){this.QKn(U);J.AFrameworkApplication.VCc=U.DirectInvokeDavUrl;Ea=Ea(U.EditDocInClientUrl);const kb=new Xe;kb.$Dg=this.UQ.EB;kb.$5k=Ea;kb.$ym=U.EditDocInClientUrl;this.Tb.ob(za.a.hVg,2,kb)}$Hi(U){switch(U){case 1:U=new Xd.StandardDialog,U.wc=0,U.kT(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.hrj()}}QKn(U){this.UQ.EB=Pf.yCk(this.UQ.EB,U.NewName);U.BreadcrumbFolderName&&(this.UQ.breadcrumbFolderName=U.BreadcrumbFolderName);U.BreadcrumbFolderUrl&&
(this.UQ.breadcrumbFolderUrl=U.BreadcrumbFolderUrl);this.jRh(U.NewName)}QIm(U){const Ea=new Xd.StandardDialog;Ea.wc=0;switch(U){case 1:qa.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");Ea.Qha(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:qa.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");Ea.Qha(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;
default:qa.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:U}),Ea.Qha(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}J.AFrameworkApplication.jH().execute(kb=>{kb.Eh(we.a.Hni,{["FailureMessage"]:ch[U]})});this.hrj()}H1m(U,Ea,kb){if(1===kb)return this.PKc();if(!J.AFrameworkApplication.VSa)return 8;J.AFrameworkApplication.VSa(Object(u.a)(this,this.dOc,"onRefreshFilenameSuccess"),Object(u.a)(this,this.COe,"onRefreshFilenameFailure"),
!1);return 32}rqb(U,Ea,kb,Nb,nc){if(1===kb)return J.AFrameworkApplication.K.ea("UiHostSupportsMoveToFolder")?32:8;if(2===kb){const ad={};U=J.AFrameworkApplication.qpb;Ea=J.AFrameworkApplication.K.ea("UiHostSupportsDocRebootFeatures");U=(!U||U&&Ea)&&J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);ad[xe.a.NGj]=U;nc&&nc.MoveButtonClickedTime&&(ad[xe.a.e5i]=nc.MoveButtonClickedTime.getTime());J.AFrameworkApplication.jH().execute(Od=>{Od.Eh(we.a.rqb,ad)});
if(nc&&nc.MoveButtonClickedTime){if(U=this.SG())nc=(new Date).getTime()-nc.MoveButtonClickedTime.getTime(),U.set("MovePostDuration",nc.toString());ka.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",U)}return 32}return 8}zId(U,Ea,kb,Nb,nc){if(1===kb)return J.AFrameworkApplication.K.ea("UiHostSupportsMoveToFolder")?this.PKc():8;if(2===kb){if(!J.AFrameworkApplication.SRc)return ka.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),
8;if(!nc)return ka.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(nc[xe.a.wQi])if(nc[xe.a.Yeh])if(U=nc[xe.a.Yeh].toLowerCase(),Ea=J.AFrameworkApplication.K.ea("UiHostSupportsDocRebootFeatures"),kb=J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),Ea&&J.AFrameworkApplication.qpb&&kb){const ad={};ad[xe.a.CLb]="1";ad[xe.a.documentUrl]=U;ad[xe.a.reason]=bf.a.EYg;ka.Health.instance.recordKpiSuccess("MoveToFolder",null);
J.AFrameworkApplication.jH().execute(Od=>{Od.Eh(we.a.Mjb,ad)})}else if(!J.AFrameworkApplication.qpb&&kb)ka.Health.instance.recordKpiSuccess("MoveToFolder",null),da.a.Tk(U,da.a.Mda(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return ka.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else ka.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else J.AFrameworkApplication.VSa(Object(u.a)(this,this.dOc,"onRefreshFilenameSuccess"),
Object(u.a)(this,this.COe,"onRefreshFilenameFailure"),!1),J.AFrameworkApplication.SRc(),ka.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}Dtn(U,Ea){return U&&Ea?U!==this.UQ.breadcrumbFolderName||Ea!==this.UQ.breadcrumbFolderUrl:!1}dOc(U,Ea){U&&(U.NewName!==bc.a.HN(this.UQ.EB)||this.Dtn(U.BreadcrumbFolderName,U.BreadcrumbFolderUrl))&&this.IKd(U,Ea)}COe(){}hrj(){this.jRh(bc.a.HN(this.UQ.EB))}get Tb(){return this.ga.value}get Xp(){return this.yk.value}SG(){try{return new Map}catch(U){return null}}static get instance(){return Pf.na||
(Pf.na=Pf.H8b())}static H8b(){return new Pf(J.AFrameworkApplication.QKc,new xb.a(()=>J.AFrameworkApplication.pa),new xb.a(()=>J.AFrameworkApplication.Xp),J.AFrameworkApplication.Bs,J.AFrameworkApplication.Ksa,()=>J.AFrameworkApplication.B0d,J.AFrameworkApplication.DQc,Object(u.a)(sd.instance,sd.instance.BVc,"updateTitle"),ia.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>J.AFrameworkApplication.$r,J.AFrameworkApplication.K,ia.a.instance.resolve("Common.IRenameProps"))}static yCk(U,
Ea){U=bc.a.yTa(U);return Ea+U}static B_m(U){const Ea=U.Values[xe.a.RSi];qa.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",Ea);Ea?J.AFrameworkApplication.pa.ob(za.a.zId,2,U.Values):ka.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static z_m(U){J.AFrameworkApplication.pa.ob(za.a.renameFile,2,U.Values.NewName)}}Pf.na=null;Object(c.a)(Pf,"RenameActor",null,[]);var Eg=b(143),th=b(1197),Ph=b(532),pf=b(354);class rk{constructor(U,
Ea){this.ga=U;this.Yxb=Ea}lb(){this.ga.ma(za.a.a6g,Je.a.frame,Object(u.a)(this,this.Qvn,"showRenameDialogAction"))}Qvn(U,Ea,kb){U=32;if(1===kb)return pf.SessionStatusManager.instance.oj||J.AFrameworkApplication.wsa?8:32;2===kb&&(32!==this.ga.processAction(za.a.renameFile,1)?(this.ga.processAction(za.a.smc,2),Eg.a.instance.mb(th.a.Yaa,{["Reason"]:Ph.a.Toj}),U=8):32===this.ga.processAction(za.a.KVd,1)?this.ga.processAction(za.a.KVd,2):this.Yxb.value.create().h9a());return U}}Object(c.a)(rk,"RenameDialogActor",
null,[1833]);class Xi{constructor(U,Ea,kb){this.dialog=null;this.ga=U;this.UQ=Ea;this.Byb=kb}aMl(){const U={};U.nameInputProps={["type"]:"AppInputProps",["id"]:Xi.rDc,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:bc.a.HN(this.UQ.EB),["maxLength"]:this.Byb};return U}h9a(){const U={["id"]:"RenameDialog",["bodyControls"]:this.aMl()};this.dialog=new Ye.a(!1,!1,!0);this.dialog.wc=1;this.dialog.Je="RenameDialog";this.dialog.Ih(CommonUIStrings.l_RenameDialogTitle,Object(u.a)(this,this.fVg,"renameDialogHandler"),
U)}fVg(U,Ea){if(Ea&&1===U){if(Ea[Xi.rDc]&&(U=bc.a.HN(this.UQ.EB),Ea=(Ea[Xi.rDc]||"").trim(),Ea!==U&&""!==Ea)){this.ga.ob(za.a.renameFile,2,Ea);return}Eg.a.instance.mb(th.a.S6b,{["Reason"]:Ph.a.o1f})}}}Xi.rDc="txtDocumentName";Object(c.a)(Xi,"ReactRenameDialog",null,[1868]);class Vf{static get Lf(){return Ye.a.oz(Vf.fm,CommonUIStrings.l_RenameDialogLabel)}}Vf.fm="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(c.a)(Vf,"RenameDialogHtml",null,[]);class Qc extends Ye.a{constructor(U,Ea,kb){super();this.ga=U;this.UQ=Ea;this.Byb=kb;this.Je="RenameDialog";this.Lf=Vf.Lf}h9a(){var U={["txtDocumentName"]:bc.a.HN(this.UQ.EB)};this.Ih(CommonUIStrings.l_RenameDialogTitle,Object(u.a)(this,this.fVg,"renameDialogHandler"),U);U=document.getElementById(Qc.rDc);0<this.Byb&&(U.maxLength=this.Byb);U.focus()}fVg(U,Ea){if(1===U&&(U=bc.a.HN(this.UQ.EB),Ea=(Ea[Qc.rDc]||"").trim(),Ea!==U&&""!==Ea)){this.ga.ob(za.a.renameFile,
2,Ea);return}Eg.a.instance.mb(th.a.S6b,{["Reason"]:Ph.a.o1f})}}Qc.rDc="txtDocumentName";Object(c.a)(Qc,"RenameDialog",Ye.a,[1868]);class pd{constructor(U){this.P_a=null;this.Byb=0;this.ga=U;this._initialized=!1}initialize(U,Ea){this.P_a=U;this.Byb=Ea;this._initialized=!0}create(){return this._initialized?J.AFrameworkApplication.la&&J.AFrameworkApplication.la.eb.wz&&J.AFrameworkApplication.K.ea("ReactRenameDialogIsEnabled")?new Xi(this.ga,this.P_a,this.Byb):new Qc(this.ga,this.P_a,this.Byb):null}}
Object(c.a)(pd,"RenameDialogFactory",null,[1832]);var mf=b(170);class ef{constructor(U){this.ga=U}lb(){this.ga.ma(za.a.KVd,Je.a.frame,Object(u.a)(this,this.Rvn,"showRenameFlyoutAction"))}hOk(){return mf.d("setDocumentTitleFlyoutOpened")&&J.AFrameworkApplication.la.eb.eM}Rvn(U,Ea,kb){if(1===kb)return this.hOk()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}}Object(c.a)(ef,"RenameFlyoutActor",null,[1831]);class Ae{constructor(U,Ea,kb,Nb,nc){this.cUk=null;
this.yk=nc;this.jCh=kb;this.iCh=Nb;this.zrk=U;this.mzb=Ea}get Xp(){return this.yk.value}YCi(){if(!this.iCh())return 5;if(this.mzb())return 1;if(this.Xp){if(this.jCh&&!this.Xp.qii)return 3;if(!this.jCh&&!this.Xp.mlb)return 4}return this.zrk()?0:2}}Object(c.a)(Ae,"RenameProps",null,[1830]);class id{constructor(U,Ea,kb,Nb,nc,ad){this.$h=!1;this.Clf=new wb.a;this.dsc=Ea;this.Vy=kb;this.Xqc=Nb;this.va=nc;this.dxa=ad}enable(){this.$h||(this.rNj(),this.N7g(),this.$h=!0)}generateKey(U,Ea,kb){return String.format("{0}/{1}/{2}",
kb,U,Ea)}LDl(){const U=bc.a.HN(this.dsc().EB);return this.generateKey(this.dsc().breadcrumbFolderName,this.dsc().breadcrumbFolderUrl,U)}MDl(U,Ea,kb){return U&&Ea?this.generateKey(U,Ea,kb):kb}U$k(U,Ea,kb){return U&&U!==this.dsc().breadcrumbFolderName||Ea&&Ea!==this.dsc().breadcrumbFolderUrl?!0:kb!==bc.a.HN(this.dsc().EB)}rNj(){const U=this.LDl();this.Clf.$(U,new Date)}CMg(U){this.osn(U)&&this.ZSh(U)}osn(U){const Ea=this.Xqc();return Ea?this.dxa&&this.dxa.Gp||!Ea.qog||!J.AFrameworkApplication.VSa?(this.VFj(U),
this.$h=!1):!0:!1}Waj(U,Ea,kb,Nb){const nc=this.U$k(U,Ea,kb);U=this.MDl(U,Ea,kb);Ea=this.Clf.Ab(U).returnValue;nc&&!Ea&&(this.bIi(Nb),qa.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.xxg));nc||this.Clf.$(U,this.Vy())}}Object(c.a)(id,"ARenamedFileChecker",null,[1803]);class Ah extends id{constructor(U,Ea,kb,Nb,nc,ad,Od,af){super(U,Ea,kb,Nb,nc,ad);this.bP=nc;this.Vkk=Od;this.khf=af}get xxg(){return"RenamedFileCheckerUsingSettingsRefresh"}N7g(){this.bP.TBb(Object(u.a)(this,this.yIi,
"handleSettingsRefresh"))}yIi(U,Ea){Ea&&Ea.wqb&&Ea.AFg&&(Ea.lJa("BreadcrumbDocName")||Ea.lJa("BreadcrumbFolderName")||Ea.lJa("BreadcrumbFolderUrl")||Ea.lJa("DirectInvokeDAVUrl")||Ea.lJa("EditDocInClientUrl"))&&(qa.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.xxg),this.CMg(Ea))}VFj(){this.bP.aVg(Object(u.a)(this,this.yIi,"handleSettingsRefresh"))}ZSh(U){if(U&&U.wqb){const Ea=U.wqb;this.Waj(Ea.Ga("BreadcrumbFolderName"),Ea.Ga("BreadcrumbFolderUrl"),Ea.Ga("BreadcrumbDocName"),
U)}}bIi(U){const Ea={OperationResult:0,classId:1};U=U.wqb;Ea.BreadcrumbFolderName=U.Ga("BreadcrumbFolderName");Ea.BreadcrumbFolderUrl=U.Ga("BreadcrumbFolderUrl");Ea.DirectInvokeDavUrl=U.Ga("DirectInvokeDAVUrl");Ea.EditDocInClientUrl=U.Ga("EditDocInClientUrl");U=U.Ga("BreadcrumbDocName");Ea.NewName=J.AFrameworkApplication.V6b?U:bc.a.HN(U);this.khf.execute(kb=>{this.H7l(Ea,kb)})}H7l(U,Ea){this.Vkk().IKd(U,Ea)}}Object(c.a)(Ah,"RenamedFileCheckerUsingSettingsRefresh",id,[]);class Bh extends id{constructor(U,
Ea,kb,Nb,nc,ad,Od,af,ve,eh){super(U,kb,Nb,nc,ad,ve);this.pad=this.QC=null;this.qjk=Ea;this.ga=Od;this.fb=af;eh&&eh.execute(Ci=>{this.V4m(Ci)})}get xxg(){return"RenamedFileCheckerUsingTask"}V4m(U){this.QC=U;this.QC.G2b(Object(u.a)(this,this.lma,"handleVisibilityChange"))}lma(U,Ea){!this.$h||0!==Ea.newState&&1!==Ea.newState||this.pad||(this.N7g(),this.CMg(this.pad))}N7g(){this.pad=new uc.a(3,2,this.qjk(),Object(u.a)(this,this.CMg,"performRenameFileCheckTick"),89);this.fb.rb(this.pad)}VFj(U){this.fb.ie(U)}ZSh(U){this.QC&&
2===this.QC.qaa?this.u6m(U):J.AFrameworkApplication.VSa(Object(u.a)(this,this.dOc,"onRefreshFilenameSuccess"),Object(u.a)(this,this.COe,"onRefreshFilenameFailure"),!0)}u6m(U){this.fb.ie(U);this.pad=null}dOc(U){U&&this.Waj(U.BreadcrumbFolderName,U.BreadcrumbFolderUrl,U.NewName,null)}bIi(){this.ga.processAction(za.a.fileNameUpdate,2)}COe(){}}Object(c.a)(Bh,"RenamedFileCheckerUsingTask",id,[]);class wg{constructor(){this.va=this.Z=null}get name(){return"Common.App.RenameFile"}Hb(U){this.Z=U;this.va=
J.AFrameworkApplication.K;this.Z.register(rk,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").zd(()=>new rk(J.AFrameworkApplication.pa,this.Z.vf("Common.App.Rename.IRenameDialogFactory"))).singleInstance();this.Z.register(pd,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").zd(()=>new pd(J.AFrameworkApplication.pa)).singleInstance();this.Z.register(1803,"Common.App.Rename.IRenamedFileChecker").zd(()=>this.D3k()).singleInstance();
this.Z.register(ef,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").zd(()=>new ef(J.AFrameworkApplication.pa)).singleInstance()}D3k(){if(this.va.ea("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const U=this.Z.sa("Common.IRefreshableAppSettings");if(U&&U.Arg)return new Ah(()=>U.jb("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>J.AFrameworkApplication.Bs,()=>new Date,()=>J.AFrameworkApplication.Xp,U,this.Z.sa("Common.ISessionStatus"),()=>Pf.instance,this.Z.Ca("Postmessage.IHostPostmessenger"))}return new Bh(()=>
this.va.jb("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.va.jb("RenamedFileCheckerPingIntervalInMs",12E4),()=>J.AFrameworkApplication.Bs,()=>new Date,()=>J.AFrameworkApplication.Xp,J.AFrameworkApplication.K,J.AFrameworkApplication.pa,J.AFrameworkApplication.tb,this.Z.sa("Common.ISessionStatus"),this.Z.Ca("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.va.wq(Object(u.a)(this,this.Gw,"onFullAppSettingsReady"))}Gw(){const U=J.AFrameworkApplication.la.eb.eM;J.AFrameworkApplication.QKc()&&
sd.instance.initialize(J.AFrameworkApplication.oEc,U?null:J.AFrameworkApplication.WXf,U?null:J.AFrameworkApplication.gVg||CommonUIStrings.l_RenameFileTooltip)&&(this.Z.register(Ae,"Common.App.Rename.RenameProps").as("Common.IRenameProps").zd(()=>new Ae(()=>J.AFrameworkApplication.B0d,()=>J.AFrameworkApplication.$r,J.AFrameworkApplication.DQc,J.AFrameworkApplication.QKc,new xb.a(()=>J.AFrameworkApplication.Xp))).singleInstance(),Pf.instance.lb(),this.va.ea("RenameDialogIsEnabled")&&(this.Z.resolve("Common.App.Rename.RenameDialogFactory").initialize(J.AFrameworkApplication.Bs,
J.AFrameworkApplication.oEc),this.Z.resolve("Common.App.Rename.IRenameDialogActor").lb()),this.Z.resolve("Common.App.Rename.IRenameFlyoutActor").lb(),J.AFrameworkApplication.DQc&&this.Z.resolve("Common.App.Rename.IRenamedFileChecker").enable())}dispose(){}}Object(c.a)(wg,"PackageManager",null,[1,2]);class li{static get Lf(){return Ye.a.oz(li.fm,CommonUIStrings.l_SaveACopyFileName)}}li.fm="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(c.a)(li,"FileNameDialogHtml",null,[]);class Hh extends Ye.a{constructor(U,Ea,kb,Nb){super();this.S6d=this.e0a=null;this.ga=U;this.oEa=Ea;this.ted=kb;this.ee(1,CommonUIStrings.l_SaveButtonLabel);this.Lf=li.Lf;this.Je="FileNameDialog-SaveACopy";this.Yn=Nb}BSa(U,Ea,kb){this.S6d=U;this.e0a=kb;U={["txtFileName"]:bc.a.HN(J.AFrameworkApplication.Bs.EB),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,Ea)};this.Ih(CommonUIStrings.l_SaveToOneDrive,Object(u.a)(this,this.bue,"fileNameDialogHandler"),
U);qa.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}bue(U,Ea){1!==U?qa.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(U=Ea.txtFileName.trim(),qa.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),Ea=bc.a.yTa(J.AFrameworkApplication.fileName),U&&""!==U&&""!==Ea&&(U+=Ea),this.ted.tYa(this.S6d,this.e0a,U,this.Yn))}}Object(c.a)(Hh,"FileNameDialog",
Ye.a,[1937]);class vj{constructor(U,Ea,kb){this.ga=U;this.oEa=Ea;this.ted=kb}create(U){return new Hh(this.ga,this.oEa,this.ted,U)}}Object(c.a)(vj,"FileNameDialogFactory",null,[1902]);class uh extends Xd.StandardDialog{constructor(U){super();this.wc=1;this.ee(1,CommonUIStrings.l_RetryButtonLabel);this.ee(0,CommonUIStrings.l_DialogClose);this.ga=U}v_(U){qa.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",U);this.aw(U,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
Object(u.a)(this,this.BXg,"retryDialogHandler"))}BXg(U){1===U?(qa.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ga.processAction(za.a.nkc,2)):qa.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(c.a)(uh,"RetryDialog",Xd.StandardDialog,[1901]);var ai=b(212);class pk{constructor(U,Ea,kb,Nb){this.ode=null;this.kmk=U;this.va=kb;this.kIh=Ea;this.rEh=new l.a;this.Ad=Nb}jLc(){return this.va.ea("SaveToCloudStorageUIIsEnabled")}iFb(){return za.a.pWe}Ble(){Ta.a.kQc(Object(u.a)(this,
this.vtj,"saveToCloudActionDispatcher"));Ta.a.v7b([new ai.a(za.a.pWe,Je.a.frame,0)],this.kIh.mGc())}lb(){const U=this.kIh.mGc();U?(U.QJ(()=>{this.rEh.mf(!0)}),this.Ble()):qa.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}zkj(){qa.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}vtj(U,Ea,kb,Nb,nc){return Ea.contextId!==Je.a.frame||U!==this.iFb()?2:this.jLc()?1===kb?pf.SessionStatusManager.instance.oj||J.AFrameworkApplication.wsa?
8:32:2===kb?(this.zkj(),nc&&nc.FileDownloadUrl&&qa.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Ad&&(this.ode=this.Ad.Pe("DialogShown","SaveToOneDriveReponseTime")),this.rEh.task.continueWith(()=>{this.ode&&(this.ode.stop(),this.ode=null);this.kmk.start(nc)}),32):8:8}}Object(c.a)(pk,"SaveToCloudStorageActor",null,[1906]);class fk extends pk{constructor(U,Ea,kb,Nb){super(U,Ea,kb,Nb);this.bik=Ea}jLc(){return this.va.ea("SaveACopyBrsIsEnabled")}iFb(){return za.a.nkc}Ble(){Ta.a.kQc(Object(u.a)(this,
this.vtj,"saveToCloudActionDispatcher"));Ta.a.v7b([new ai.a(za.a.nkc,Je.a.frame,0)],this.bik.mGc())}zkj(){qa.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(c.a)(fk,"SaveACopyActor",pk,[]);class ak{}ak.default=0;Object(c.a)(ak,"SaveToCloudErrorCodes",null,[]);class Kg{constructor(U,Ea,kb,Nb,nc,ad){this.Yn=null;this.Vnk=U;this.ZFa=Ea;this.ted=kb;this.va=Nb;this.i3d=nc;this.kL=ad}start(U){this.Yn=U;if("SharePointOnlineConsumer"===this.va.Ga("FileSource")){const Ea=
ia.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(Ea){Ea.start(null,U);return}}this.ZFa.nJc?(qa.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.nNk()):(qa.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.Yvn())}Yvn(){this.Vnk.create().BSa()}jq(){this.kL().v_(ak.default)}nNk(){try{qa.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let U={["client_id"]:this.va.appSettings.UploadToSkyDriveClientId,
["env"]:"INT"};if(1===this.i3d||2===this.i3d)U={["client_id"]:this.va.appSettings.UploadToSkyDriveClientId};WL.init(U);qa.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(u.a)(this,this.onSuccess,"onSuccess"),Object(u.a)(this,this.onFailure,"onFailure"))}catch(U){qa.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",U,U.stack),this.jq()}}onSuccess(U){qa.ULS.sendTraceTag(6590592,
216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");U&&U.data&&U.data.folders&&this.ted.tYa(U.data.folders[0].id,U.data.folders[0].urls.viewInBrowser,null,this.Yn)}onFailure(U){if(U&&U.error){if("user_canceled"===U.error.code){qa.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}qa.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",U.error.code,U.error.message)}else qa.ULS.sendTraceTag(6590595,
216,50,"File Dialog returned with no response");this.jq()}}Object(c.a)(Kg,"SaveToCloudManager",null,[1907]);class sk extends Kg{constructor(U,Ea,kb,Nb,nc,ad,Od){super(Ea,kb,Nb,nc,ad,Od);this.a9j=U}onSuccess(U){U&&U.data&&U.data.folders?(qa.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.a9j.create(this.Yn).BSa(U.data.folders[0].id,U.data.folders[0].name,U.data.folders[0].urls.viewInBrowser)):(qa.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),
this.jq())}onFailure(U){U&&U.error&&"user_canceled"===U.error.code&&qa.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(U)}jq(){qa.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.jq()}}Object(c.a)(sk,"SaveACopyManager",Kg,[]);var fh=b(175);class Hf{constructor(U,Ea,kb,Nb,nc){this.e0a=this.Ml=this.KYc=null;this.f6=!1;this.Yn=this.tgb=null;this.Eyf=U;this.Aeb=Ea;this.kL=kb;this.vh=Nb;this.Ad=nc}Xtb(){this.vh&&1===
this.vh.state||(this.Ml=this.Aeb(),this.Ml.message=CommonUIStrings.l_CommentProgressTooltip,this.Ml.wc=5,this.Ml.Hq=!1,this.Ml.yQ(CommonUIStrings.l_DefaultDialogTitle,null,null))}$ya(){this.Ml&&(this.Ml.close(),this.Ml=null)}dda(){1!==J.AFrameworkApplication.la.state&&this.kL().v_(ak.default)}Ric(){qa.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");da.a.Tk(this.e0a,da.a.Mda(3),void 0,"UploadToCloudManager.RedirectToFolder")}Qic(U){let Ea=!1,kb=!1;J.AFrameworkApplication.K&&(Ea=
J.AFrameworkApplication.K.ea("SaveACopyIsEnabledForUiHost"),kb=J.AFrameworkApplication.K.ea("UiHostSupportsDocRebootFeatures"));qa.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",U,Ea);if(Ea&&kb){qa.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Nb={};Nb[xe.a.CLb]="1";Nb[xe.a.documentUrl]=U;J.AFrameworkApplication.jH().execute(nc=>{nc.Eh(we.a.Mjb,Nb)})}else da.a.Tk(U,da.a.Mda(3),void 0,
"UploadToCloudManager.RedirectToEditUrl")}tYa(U,Ea,kb=null,Nb=null){qa.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Ad&&(this.tgb=this.Ad.Pe("DialogShown","SaveToOneDriveUploadTime"));this.Xtb();this.e0a=Ea;this.KYc=this.Eyf.create(U,kb,Nb);this.Yn=Nb;this.pra()}pra(){qa.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.KYc.execute(Object(u.a)(this,this.AJm,"onSaveToCloudUploadFinished"),Object(u.a)(this,this.zJm,"onSaveToCloudUploadFailed"))}AJm(U){this.$ya();
this.f6=!1;if(U&&U.data&&U.data.Rd){var Ea;if(({at:Ea}=ra.d(U.data.Rd)).returnValue)if(U=Ea,U.StatusCode!==fh.a.HD&&U.StatusCode!==fh.a.jCc)qa.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.dda();else{qa.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{U.NewDocumentUrl&&""!==U.NewDocumentUrl?this.Qic(U.NewDocumentUrl):this.Ric()}catch(kb){qa.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",kb.toString())}this.fMd()}else qa.ULS.sendTraceTag(7660114,
216,10,"Failed to deserialize : {0}",{["ResponseData"]:ab.a.oZd(U.data.Rd)}),this.dda()}else qa.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.dda()}zJm(U){5!==U.data.status&&12!==U.data.status||this.f6?(qa.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",U.data.status),this.$ya(),this.dda(),this.fMd()):(qa.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.f6=!0,this.pra())}fMd(){this.tgb&&
(this.tgb.stop(),this.tgb=null)}}Object(c.a)(Hf,"UploadToCloudManager",null,[1904]);class ui extends Hf{constructor(U,Ea,kb,Nb,nc,ad){super(Ea,kb,Nb,nc,ad);this.ga=U}Nrg(){return!!this.Yn&&!!this.Yn.SaveEntryPoint&&"VersionHistory"===this.Yn.SaveEntryPoint.toString()}dda(){qa.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.Nrg()&&this.ga.ob(za.a.oRd,2,{["FailureReason"]:"Unknown"});super.dda()}Ric(){qa.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");
this.Nrg()&&this.ga.processAction(za.a.OQc,2);super.Ric()}Qic(U){qa.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",U);this.Nrg()&&this.ga.processAction(za.a.OQc,2);super.Qic(U)}pra(){this.Yn&&"true"===this.Yn.SkipSaveToHost?super.pra():32!==this.ga.processAction(za.a.yMb,1)?(qa.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.pra()):this.ga.ob(za.a.yMb,2,[()=>{qa.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");
Hf.prototype.pra.call(this)},()=>{qa.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.dda()}])}}Object(c.a)(ui,"SaveACopyUploadToCloudManager",Hf,[]);var Nf=b(682),Mk=b(1051);class Nj{constructor(){this.Z=null}get name(){return"Common.App.SaveACopy"}init(){J.AFrameworkApplication.K.wq(Object(u.a)(this,this.Gw,"onFullAppSettingsReady"))}Gw(){J.AFrameworkApplication.K.ea("SaveACopyBrsIsEnabled")&&this.Z.resolve("Common.App.SaveACopy.SaveACopyActor").lb()}dispose(){}Hb(U){this.Z=
U;this.Z.register(ui,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").zd(()=>new ui(J.AFrameworkApplication.pa,U.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Mk.a).create(),()=>new uh(J.AFrameworkApplication.pa),J.AFrameworkApplication.la,J.AFrameworkApplication.la.Np)).singleInstance();this.Z.register(vj,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").zd(()=>new vj(J.AFrameworkApplication.pa,J.AFrameworkApplication.la.eb,
U.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).singleInstance();this.Z.register(fk,"Common.App.SaveACopy.SaveACopyActor").zd(()=>new fk(U.resolve("Common.App.SaveACopy.SaveACopyManager"),U.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),J.AFrameworkApplication.K,J.AFrameworkApplication.la.Np)).singleInstance();this.Z.register(sk,"Common.App.SaveACopy.SaveACopyManager").zd(()=>new sk(U.resolve("Common.App.SaveACopy.FileNameDialogFactory"),U.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),
Nf.a.instance,U.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),J.AFrameworkApplication.K,J.AFrameworkApplication.Fla,()=>new uh(J.AFrameworkApplication.pa))).singleInstance()}static main(){ba.a.instance.Sb(new Nj)}}Object(c.a)(Nj,"PackageManager",null,[1,2]);var nj=b(34);class $k extends Xd.StandardDialog{constructor(U,Ea){super();this.avc=!1;this.QT=null;this.ga=U;this.i1c=Ea;this.roa=!1}v_(U,Ea,kb){this.QT=Ea;this.avc=kb;qa.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",
U,kb);U=this.wLf(U);0===U?(this.wc=6,this.ee(0,CommonUIStrings.l_DialogClose)):(this.wc=0,this.ee(1,CommonUIStrings.l_DialogClose));0===U&&qa.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.aw(nj.a.Ysj,this.Uxl(U),this.Txl(U,Ea),Object(u.a)(this,this.BXg,"retryDialogHandler"),!0)}BXg(U){1===U?(qa.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.QT?this.ga.ob(za.a.vRc,2,[this.QT,this.avc]):this.ga.processAction(za.a.vRc,2)):qa.ULS.sendTraceTag(8194011,
216,50,"User cancel the error dialog.")}wLf(U){return 0>U||6<U?(qa.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",U),0):U}Txl(U,Ea){U=this.wLf(U);return this.i1c?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,Ea),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][U]:[CommonUIStrings.l_FailToSaveFile,
CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,Ea),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][U]}Uxl(U){U=this.wLf(U);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][U]}}
Object(c.a)($k,"ErrorRetryDialog",Xd.StandardDialog,[1942]);class ql{constructor(U,Ea){this.va=U;this.ga=Ea;this.i1c=this.va.ea("SaveToHostWithExtraCharsInFileName")}create(){return new $k(this.ga,this.i1c)}}Object(c.a)(ql,"ErrorRetryDialogFactory",null,[1912]);class Oj extends Ye.a{constructor(U,Ea,kb,Nb,nc,ad,Od=null){super();this.lea=null;this.ga=Ea;this.oEa=Nb;this.ugb=ad;this.va=U;this.kL=nc;this.vh=kb;this.i1c=this.va.ea("SaveToHostWithExtraCharsInFileName");this.Yn=Od;this.ee(1,CommonUIStrings.l_SaveButtonLabel)}get la(){return this.vh}Vgi(U,
Ea){this.Cha(1,!!U&&U!==Ea);this.lea=document.getElementById(Oj.Gni);G.a.addHandler(this.lea,"change",Object(u.a)(this,this.NNe,"onFileNameChange"));G.a.addHandler(this.lea,"input",Object(u.a)(this,this.NNe,"onFileNameChange"));this.lea.focus()}Fni(U){return this.i1c?(new RegExp("["+this.xli('\\/:*?"<>|')+"]")).test(U):(new RegExp("["+this.xli('\\/:*?"<>|#{}%~&')+"]")).test(U)}xli(U){return U.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}vfg(){const U=bc.a.HN(J.AFrameworkApplication.Bs.EB);
this.Cha(1,!!this.lea&&""!==this.lea.value&&this.lea.value!==U)}NNe(){this.lea&&window.setTimeout(()=>{this.vfg()},0)}bue(U,Ea){if(1!==U)qa.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{U=Ea[Oj.Gni];Ea=Oj.Fcj in Ea?Ea[Oj.Fcj]:!1;qa.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",bc.a.PTe(U),Ea);const kb=bc.a.yTa(J.AFrameworkApplication.fileName);(U=U?U.trim():null)&&""!==U&&""!==
kb||1===this.la.state?this.Fni(U)?this.kL.create().v_(1,U,Ea):this.ugb.tYa(U+kb,Ea,this.Yn):this.kL.create().v_(2,U,Ea)}}dispose(){this.lea&&(G.a.removeHandler(this.lea,"change",Object(u.a)(this,this.NNe,"onFileNameChange")),G.a.removeHandler(this.lea,"input",Object(u.a)(this,this.NNe,"onFileNameChange")),this.lea=null);super.dispose()}}Oj.Gni="txtFileName";Oj.Fcj="chkOverwrite";Object(c.a)(Oj,"FileNameDialogBase",Ye.a,[]);class wm{static get Lf(){return Ye.a.oz(wm.fm,CommonUIStrings.l_SaveACopyFileName,
CommonUIStrings.l_SaveAsToHostOverwrite)}}wm.fm="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(c.a)(wm,"FileNameDialogHtml",null,[]);class rl extends Oj{constructor(U,Ea,kb,Nb,nc,ad){super(U,Ea,kb,Nb,nc,ad);this.Lf=wm.Lf;this.Je="FileNameDialog-SaveAsToHost"}BSa(U,Ea){const kb=bc.a.HN(J.AFrameworkApplication.Bs.EB);Ea={["txtFileName"]:U||kb,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:Ea};this.Ih(CommonUIStrings.L_SaveAs,Object(u.a)(this,this.bue,"fileNameDialogHandler"),Ea);this.Vgi(U,kb)}}Object(c.a)(rl,"FileNameDialog",Oj,[1941]);class Hl{constructor(U,Ea,
kb,Nb,nc,ad){this.ga=Ea;this.va=U;this.oEa=Nb;this.ugb=ad;this.kL=nc;this.vh=kb}create(){return new rl(this.va,this.ga,this.vh,this.oEa,this.kL,this.ugb)}}Object(c.a)(Hl,"FileNameDialogFactory",null,[1911]);class vi{constructor(U,Ea,kb){this.ugb=kb;this.Kef=Ea;this.va=U}lb(){2===J.AFrameworkApplication.la.eb.Bm?J.AFrameworkApplication.pa.Aa(za.a.vRc,Je.a.frame,Object(u.a)(this,this.Xsj,"saveAsToHostActionDispatcher"),4):J.AFrameworkApplication.pa.ma(za.a.vRc,Je.a.frame,Object(u.a)(this,this.Xsj,"saveAsToHostActionDispatcher"))}Xsj(U,
Ea,kb,Nb,nc){return Ea.contextId!==Je.a.frame||U!==za.a.vRc?2:this.va.ea("SaveAsToHostBrsIsEnabled")?1===kb?pf.SessionStatusManager.instance.oj||J.AFrameworkApplication.wsa?8:32:2===kb?(qa.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),U=this.Kef.create(),nc&&Object.getType(nc)===Array&&2===nc.length?U.BSa(nc[0],!!nc[1]):U.BSa(null,!1),32):8:8}}Object(c.a)(vi,"SaveAsToHostActor",null,[]);class Pj{constructor(U,Ea,kb,Nb,nc,ad,Od,af){this.Ml=null;this.avc=
this.f6=!1;this.tgb=this.Yn=this.QT=null;this.va=Ea;this.A6=this.va.appSettings.SaveAsToHostWebServiceBase;this.DAh=Nb;this.Aeb=nc;this.nf=kb;this.kL=ad;this.Ad=af;this.vh=Od;this.ga=U;this.lcb=Ea.Ga("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}Xtb(){1!==this.vh.state&&(this.Ml=this.Aeb(),this.Ml.message=CommonUIStrings.l_CommentProgressTooltip,this.Ml.wc=5,this.Ml.Hq=!1,this.Ml.yQ(CommonUIStrings.l_DefaultDialogTitle,null,null))}dda(U=0){1!==this.vh.state&&this.kL.create().v_(U,bc.a.HN(this.QT),
this.avc)}Ric(){const U=this.va.appSettings.BreadcrumbFolderUrl;qa.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");da.a.Tk(U,da.a.Mda(3),void 0,"UploadToHostManager.RedirectToFolder")}Qic(U){let Ea=!1,kb=!1;this.va&&(Ea=this.va.ea("SaveACopyIsEnabledForUiHost"),kb=this.va.ea("UiHostSupportsDocRebootFeatures"));qa.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",U,Ea,kb);if(Ea&&kb){qa.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Nb={};Nb[xe.a.CLb]="1";Nb[xe.a.documentUrl]=U;Nb[xe.a.reason]=bf.a.EYg;J.AFrameworkApplication.jH().execute(nc=>{nc.Eh(we.a.Mjb,Nb)})}else Ea&&!kb&&J.AFrameworkApplication.R7?da.a.Tk(U,da.a.Mda(4),void 0,"UploadToHostManager.RedirectToEditUrl"):da.a.Tk(U,da.a.Mda(3),void 0,"UploadToHostManager.RedirectToEditUrl")}tYa(U,Ea,kb=null){qa.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.DAh&&!this.DAh()&&
this.nf&&(this.Ad&&(this.tgb=this.Ad.Pe("DialogShown","SaveAsToHostUploadTime")),this.Xtb(),this.avc=Ea,this.QT=U,(this.Yn=kb)&&"true"===this.Yn.SkipSaveToHost?this.qte():this.pra())}pra(){32!==this.ga.processAction(za.a.yMb,1)?(qa.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.qte()):this.ga.ob(za.a.yMb,2,[()=>{qa.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.qte()},(U,Ea)=>{qa.ULS.sendTraceTag(18989380,
219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.dda(Ea)}])}qLm(U){this.$ya();this.f6=!1;if(U&&U.data&&U.data.Rd)if(({at:Ea}=ra.d(U.data.Rd)).returnValue)if(U=Ea,U.StatusCode!==fh.a.HD&&U.StatusCode!==fh.a.jCc){qa.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var Ea={};Ea.FailureReason=U.StatusCode.toString();Ea.ExtraInfo=U.ExtraInfo;this.x8a(Ea);this.dda(parseInt(U.ExtraInfo))}else{qa.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.sWg();try{U.NewDocumentUrl&&""!==U.NewDocumentUrl?this.Qic(U.NewDocumentUrl):this.Ric()}catch(kb){qa.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",kb.toString())}this.fMd()}else qa.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:ab.a.oZd(U.data.Rd)}),this.x8a({["FailureReason"]:"Failed to deserialize response"}),this.dda();else qa.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.x8a({["FailureReason"]:"null response"}),this.dda()}pLm(U){5!==U.data.status&&12!==U.data.status||this.f6?(qa.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:U.data.status,["HttpStatus"]:U.data.Ge}),this.x8a({["FailureReason"]:U.data.Ge.toString()}),this.$ya(),this.dda(),this.fMd()):(qa.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.f6=!0,this.Yn&&"true"===this.Yn.SkipSaveToHost?this.qte():this.pra())}$ya(){this.Ml&&
(this.Ml.close(),this.Ml=null)}fMd(){this.tgb&&(this.tgb.stop(),this.tgb=null)}sWg(){this.Yn&&"VersionHistory"===this.Yn.SaveEntryPoint&&this.ga.processAction(za.a.OQc,2)}x8a(U){this.Yn&&"VersionHistory"===this.Yn.SaveEntryPoint&&this.ga.ob(za.a.oRd,2,U)}qte(){let U=this.A6+this.lcb;U=Db.a.Qm(U,"qs",bc.a.Xh(J.AFrameworkApplication.Fk));U=Db.a.Qm(U,"n",bc.a.Xh((new Date).getTime().toString()));U=Db.a.Qm(U,"ov",bc.a.Xh(this.avc.toString()));U=Db.a.Qm(U,"fn",bc.a.Xh(this.QT));this.Yn&&this.Yn.FileDownloadUrl&&
(U=Db.a.Qm(U,"furl",bc.a.Xh(this.Yn.FileDownloadUrl)));this.nf.Ni(U,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(u.a)(this,this.qLm,"onUploadFinished"),Object(u.a)(this,this.pLm,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(c.a)(Pj,"UploadToHostManager",null,[1797]);class kl{constructor(){this.Z=null}get name(){return"Common.App.SaveAsToHost"}init(){J.AFrameworkApplication.K.wq(Object(u.a)(this,this.Gw,"onFullAppSettingsReady"))}Gw(){J.AFrameworkApplication.K.ea("SaveAsToHostBrsIsEnabled")&&
this.Z.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").lb()}Hb(U){this.Z=U;this.Z.register(ql,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").zd(()=>new ql(J.AFrameworkApplication.K,J.AFrameworkApplication.pa)).singleInstance();this.Z.register(Pj,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").zd(()=>new Pj(J.AFrameworkApplication.pa,J.AFrameworkApplication.K,J.AFrameworkApplication.Gd,
()=>J.AFrameworkApplication.mi,()=>(new Mk.a).create(),U.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),J.AFrameworkApplication.la,J.AFrameworkApplication.la.Np)).singleInstance();this.Z.register(Hl,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").zd(()=>new Hl(J.AFrameworkApplication.K,J.AFrameworkApplication.pa,J.AFrameworkApplication.la,J.AFrameworkApplication.la.eb,U.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),U.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance();
this.Z.register(vi,"Common.App.SaveAsToHost.SaveAsToHostActor").zd(()=>new vi(J.AFrameworkApplication.K,U.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),U.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance()}dispose(){}static main(){ba.a.instance.Sb(new kl)}}Object(c.a)(kl,"SaveAsToHostPackage",null,[1,2]);class ag extends Xd.StandardDialog{constructor(){super();this.wc=0;this.ee(1,CommonUIStrings.l_DialogClose)}v_(U){this.aw(U,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(c.a)(ag,"ErrorDialog",Xd.StandardDialog,[1901]);var bo=b(196);class xh extends Xd.StandardDialog{constructor(U,Ea,kb){super();this.ga=U;this.ZFa=Ea;this.oEa=kb;this.XO=!1;this.wc=1;this.j5(1);this.ee(1,CommonUIStrings.l_SignIn);this.ee(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}BSa(){this.ZFa.rCf(Object(u.a)(this,this.Vaj,"onSignIn"));this.iu(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(u.a)(this,this.J4l,"inputHandler"))}J4l(U){0===
U?(qa.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.gMd()}HPk(){let U="2";if(this.oEa)switch(this.oEa.Bm){case 3:U="0";break;case 2:U="3";break;case 1:U="1"}return U}hide(){this.ZFa.koj(Object(u.a)(this,this.Vaj,"onSignIn"));super.hide()}gMd(){const U=new bo.QueryStringBuilder("Signin.aspx");U.Xd("prompt","1");U.Xd("cbcxt",this.HPk());J.AFrameworkApplication.Vea(U);da.a.Tk(U.toString(),"LoginWindow",void 0,"SignInDialog")}Vaj(){this.bca&&this.hide();qa.ULS.sendTraceTag(7143885,
216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ga.processAction(za.a.pWe,2)}}Object(c.a)(xh,"SignInDialog",Xd.StandardDialog,[1939]);class Xl{constructor(U,Ea,kb){this.ga=U;this.ZFa=Ea;this.oEa=kb}create(){return new xh(this.ga,this.ZFa,this.oEa)}}Object(c.a)(Xl,"SignInDialogFactory",null,[1905]);class Ih{constructor(U,Ea,kb,Nb,nc,ad,Od){this.A6=U;this.QT=Ea;this.Gsc=kb;this.S6d=Nb;this.Orf=nc;this.lcb=ad;this.Yn=Od}execute(U,Ea){if(!J.AFrameworkApplication.mi&&
J.AFrameworkApplication.Gd){var kb=this.A6+this.lcb;kb=Db.a.Qm(kb,"fo",bc.a.Xh(this.S6d));kb=Db.a.Qm(kb,"fn",bc.a.Xh(this.QT));kb=Db.a.Qm(kb,"qs",bc.a.Xh(this.Orf));kb=Db.a.Qm(kb,"n",bc.a.Xh((new Date).getTime().toString()));this.Yn&&this.Yn.FileDownloadUrl&&(kb=Db.a.Qm(kb,"furl",bc.a.Xh(this.Yn.FileDownloadUrl)));this.Gsc&&(kb=Db.a.Qm(kb,"fnn",bc.a.Xh(this.Gsc)));J.AFrameworkApplication.Gd.Ni(kb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,U,Ea,null)}}}Object(c.a)(Ih,"SkyDriveUploadCaller",
null,[1938]);class Aj{constructor(U){this.va=U;this.Ggb=U.appSettings.SkyDriveUploadWebServiceBase;this.QT=U.appSettings.FileName;this.lcb=U.Ga("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(U,Ea,kb){return new Ih(this.Ggb,this.QT,Ea,U,J.AFrameworkApplication.Fk,this.lcb,kb)}}Object(c.a)(Aj,"SkydriveUploadCallerFactory",null,[1903]);class Be{constructor(){this.Z=null}get name(){return"Common.App.SaveToCloudStorage"}init(){J.AFrameworkApplication.K.ea("SaveToCloudStorageUIIsEnabled")&&
this.Z.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").lb()}dispose(){}Hb(U){this.Z=U;this.Z.register(Xl,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").zd(()=>new Xl(J.AFrameworkApplication.pa,Nf.a.instance,J.AFrameworkApplication.la.eb)).singleInstance();this.Z.register(Aj,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").zd(()=>new Aj(J.AFrameworkApplication.K)).singleInstance();
this.Z.register(pk,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").zd(()=>new pk(U.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),U.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),J.AFrameworkApplication.K,J.AFrameworkApplication.la.Np)).singleInstance();this.Z.register(Hf,"Common.App.SaveToCloudStorage.UploadToCloudManager").zd(()=>new Hf(U.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Mk.a).create(),()=>new ag,J.AFrameworkApplication.la,
J.AFrameworkApplication.la.Np)).singleInstance();this.Z.register(Kg,"Common.App.SaveToCloudStorage.SaveToCloudManager").zd(()=>new Kg(U.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Nf.a.instance,U.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),J.AFrameworkApplication.K,J.AFrameworkApplication.Fla,()=>new ag)).singleInstance()}static main(){ba.a.instance.Sb(new Be)}}Object(c.a)(Be,"PackageManager",null,[1,2]);class Sd extends Xd.StandardDialog{constructor(){super();this.wc=
0;this.ee(1,CommonUIStrings.l_DialogClose)}v_(U,Ea){this.ihi(U,Ea,nj.a.$sj)}ihi(U,Ea,kb){qa.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",kb);this.aw(kb,U,Ea,null)}uXf(U,Ea){qa.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.aw(nj.a.btj,U,Ea,null,!0)}}Object(c.a)(Sd,"ErrorDialog",Xd.StandardDialog,[934]);class Rd{static get Lf(){return Ye.a.oz(Rd.fm,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,
"")}}Rd.fm="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(c.a)(Rd,"FileNameDialogHtml",null,[]);var ng=b(69);class Al extends Oj{constructor(U,Ea,kb,Nb,nc,ad,Od,af){super(U,Ea,kb,Nb,nc,ad,af);this.Yyb=this.Atf=this.MW=null;this.DLk=CommonUIStrings.l_SaveToAnotherFolder;this.Lf=Rd.Lf;this.Je="FileNameDialog-SaveToSharePoint";this.pbd=Od;this.oik=af}BSa(U){const Ea=bc.a.HN(J.AFrameworkApplication.Bs.EB),kb=J.AFrameworkApplication.breadcrumbFolderName,Nb=J.AFrameworkApplication.breadcrumbBrandName,nc={["txtFileName"]:U||Ea};let ad=CommonUIStrings.L_SaveAs;
2===J.AFrameworkApplication.la.eb.Bm&&(ad=CommonUIStrings.L_SaveACopy);this.Ih(ad,Object(u.a)(this,this.bue,"fileNameDialogHandler"),nc);this.Vgi(U,Ea);this.Sod.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");J.AFrameworkApplication.K.ea("HideSaveToAnotherFolderButtonforUIHost")||(this.MW=document.getElementById("anotherFolder"),U=document.getElementById("folderLocation"),this.Atf=Wb.a.Pgd(U,this.MW,"anotherFolderDescribedBy",""),
this.MW.className="WACButton WACDialogButtonNormal",U=!1,kb&&kb.length?(this.PTh(this.MW,this.Atf,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Nb,kb)),U=this.Ktk(Nb,kb)):this.PTh(this.MW,this.Atf,CommonUIStrings.l_CurrentOnlineFolder),this.fvk(this.MW),this.Ltk(this.MW),U?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.MW,"SaveToAnotherLocationTwo"),qa.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):
Sys.UI.DomElement.addCssClass(this.MW,"SaveToAnotherLocationOne"),G.a.addHandler(this.MW,w.a.click,Object(u.a)(this,this.eJg,"onSaveToAnotherLocationClick")),G.a.addHandler(this.MW,w.a.Nf,Object(u.a)(this,this.Daj,"onSaveToAnotherLocationKeyDown")))}Ktk(U,Ea){let kb;kb=!1;const Nb=document.getElementById("currentLocation");Nb.innerText="";const nc=this.sAi(Nb,U),ad=this.sAi(Nb,Ea);let Od=255,af=255;255<nc+ad&&(Od=Math.max(238,408-nc),af=Math.max(170,408-ad),kb=!0);this.Kwk(Nb,U,af,Ea,Od);return kb}sAi(U,
Ea){const kb=document.createElement("div");kb.innerText=Ea;kb.style.visibility="hidden";U.appendChild(kb);Ea=kb.clientWidth;U.removeChild(kb);return Ea}Kwk(U,Ea,kb,Nb,nc){Ea&&(this.OTh(U,Ea,kb),this.Fwk(U));Nb&&this.OTh(U,Nb,nc)}OTh(U,Ea,kb){const Nb=document.createElement("div");Nb.innerText=Ea;Nb.title=Ea;Nb.className="SaveToAnotherFolderBreadcrumb";Nb.style.maxWidth=kb.toString()+"px";U.appendChild(Nb)}Fwk(U){const Ea=document.createElement("span");Ea.id="FolderSeparator";const kb=document.createElementNS("http://www.w3.org/2000/svg",
"svg");kb.setAttribute("class","SeparatorCaret");const Nb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Nb.setAttribute("points","1 4 1 11 5 7.5");kb.appendChild(Nb);Ea.appendChild(kb);U.appendChild(Ea)}PTh(U,Ea,kb){kb=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,kb);Ea&&(Ea.innerText=kb);U.tabIndex=0;U.setAttribute(Wb.a.ig,Wb.a.l3)}Ltk(U){const Ea=document.createElement("span");Ea.id="anotherFolderText";Ea.innerText=this.DLk;Ea.className="AnotherFolderTextSpan";
U.appendChild(Ea)}fvk(U){const Ea=document.createElement("span");Ea.className="cui-img-cont-float cui-img-16by16 ";this.Yyb=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Yyb.setAttribute("class","FolderIconSVG");const kb=document.createElementNS("http://www.w3.org/2000/svg","path");kb.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.Yyb.appendChild(kb);Ea.appendChild(this.Yyb);U.appendChild(Ea)}Daj(U){!U||
U.keyCode!==ng.a.Ms&&U.keyCode!==ng.a.cpc||this.eJg(U)}eJg(){if(this.lea){const U=bc.a.yTa(J.AFrameworkApplication.fileName);let Ea=this.lea.value;this.hide();Ea&&""!==Ea&&""!==U||1===this.la.state?(""!==U&&(Ea+=U),this.Fni(Ea)?this.kL.create().v_(1,Ea,!1):this.pbd.start(Ea,this.oik)):this.kL.create().v_(2,Ea,!1)}}rPk(U){this.MW&&this.Yyb&&(U?(this.MW.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.MW,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Yyb,"DisabledFolderIconSVG")):(this.MW.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.MW,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Yyb,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.MW,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Yyb,"DisabledFolderIconSVG"))))}vfg(){super.vfg();this.rPk(!!this.lea&&""!==this.lea.value)}dispose(){this.MW&&(G.a.removeHandler(this.MW,w.a.click,Object(u.a)(this,this.eJg,"onSaveToAnotherLocationClick")),G.a.removeHandler(this.MW,w.a.Nf,Object(u.a)(this,this.Daj,
"onSaveToAnotherLocationKeyDown")),this.MW=null);super.dispose()}}Object(c.a)(Al,"FileNameDialog",Oj,[1029]);var sl=b(500),Bl=b(350),Ai=b(1361),Tf=b(1510);class de{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(c.a)(de,"SaveAsDialogInput",null,[]);class bk{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(c.a)(bk,"SaveLocation",null,[]);var fj=b(295);class Pe{constructor(U,Ea,kb,Nb,nc,ad,Od,af,ve){this.Tlf=
null;this.QT="";this.pbd=U;this.kL=Ea;this.Yn=ve;this.ugb=kb;this.vh=nc;this.UQ=Nb;this.C1b=Od;this.ywc=af;ad&&(this.Tlf=new xb.a(()=>new Ai.a(ad.value,null)))}$wl(){const U=new sl.a(Bl.a.Xi());U.$("type","currentHost");return Object.assign(new bk,{folderName:this.UQ.breadcrumbFolderName,friendlyPath:this.UQ.breadcrumbBrandName,properties:U})}xfm(U){return!!U&&"ClassicMru"===U.type&&!!U.service_info&&!!U.service_info.service_id&&-1!==U.service_info.service_id.indexOf("SHAREPOINT")}sOl(){if(!this.Tlf||
!this.C1b)return null;var U=this.Tlf.value.sk("SaveAsToSharePointDialog",!1);if(!U||3!==U.state||!U.D5i)return null;U=U.D5i;const Ea=new W.a;let kb=0,Nb=0;for(var nc=0;nc<U.length;nc++){var ad=U[nc];if(!this.xfm(ad))continue;kb++;if(!ad.sharepoint_info)continue;const Od=ad.url,af=ad.sharepoint_info.site_url,ve=ad.title;ad=Tf.b(ad,J.AFrameworkApplication.isRtl);if(!(Od&&af&&ve&&ad))continue;Nb++;const eh=new sl.a(Bl.a.Xi());eh.$("type","SharePoint");eh.$("siteUrl",af);eh.$("folderUrl",Od);Nb++;Ea.add(Object.assign(new bk,
{folderName:ve,friendlyPath:ad,properties:eh}))}nc=new Map;nc.set("NumPlaces",U.length.toString());nc.set("NumSharepointPlaces",kb.toString());nc.set("placesWithMetadata",Nb.toString());ka.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",nc);0<kb&&(Nb?.5>1*Nb/kb&&ka.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):ka.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return Ea}Sxl(){const U=
new W.a;U.add(this.$wl());const Ea=this.sOl();Ea&&U.addRange(Ea);return Object.assign(new de,{enableMoreLocations:!J.AFrameworkApplication.K.ea("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.QT,extension:bc.a.yTa(this.UQ.EB),saveLocations:U.toArray(),scenario:"SaveToSharePoint"})}Rxl(){const U=Object(u.a)(this,this.Sxl,"getDialogInput"),Ea={};Ea.inputPropsCallback=U;return Ea}BSa(U){this.QT=U;this.QT||(this.QT=String.format(CommonUIStrings.l_SaveACopy_Filename,bc.a.HN(this.UQ.EB)));U={["id"]:"SaveAsDialog",
["bodyControls"]:this.Rxl()};let Ea=CommonUIStrings.L_SaveAs;2===this.vh.eb.Bm&&(Ea=CommonUIStrings.L_SaveACopy);const kb=new Ye.a(!1,!1,!0);kb.wc=1;kb.Je="SaveAsDialog";kb.ee(1,CommonUIStrings.l_SaveButtonLabel);kb.Ih(Ea,Object(u.a)(this,this.len,"saveAsDialogHandler"),U)}wvn(U,Ea){U&&""!==U&&""!==Ea||1===this.vh.state?this.wfm()?this.Mlm(U,Ea):(""!==Ea&&(U+=Ea),this.pbd.start(U,this.Yn)):(qa.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.kL.create().v_(2,
U,!1))}Mlm(U,Ea){ka.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const kb=this.ywc.dci(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.ywc.gxi(kb).then(Nb=>{if(Nb&&0<Nb.length){const nc=Nb[0][xe.a.Aej];Nb=Nb[0][xe.a.Cej];if(""!==nc&&""!==Nb)this.C1b.tYa(Nb,U+Ea,nc,this.Yn),ka.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.kL.create().v_(0,U,!1);const ad=this.SG();ad&&(ad.set("SiteUrlAvailable",
""===nc?"false":"true"),ad.set("FolderUrlAvailable",""===Nb?"false":"true"));ka.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new fj.a,{extendedProperties:ad}))}}else this.kL.create().v_(0,U,!1),ka.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Nb=>{"Canceled"===Nb?((Nb=this.SG())&&Nb.set("IsCanceled","true"),ka.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new fj.a,{extendedProperties:Nb}))):
ka.Health.instance.recordKpiFailure("SaveACopySFP",Nb,!1,!1,null)})}wfm(){return this.ywc?this.ywc.DUi()&&(J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",!1)||"SharePointOnlineConsumer"===J.AFrameworkApplication.K.Ga("FileSource")):(qa.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}SG(){try{return new Map}catch(U){return null}}len(U,Ea){if(Ea&&1===U){U=Ea.fileName;var kb=bc.a.yTa(this.UQ.EB);Ea.moreLocationsSelected&&
this.wvn(U,kb);if(Ea.locationCallback){var Nb=Ea.locationCallback();Nb?Nb.properties&&"currentHost"===Nb.properties.J("type")?this.ugb.tYa(U+kb,!1,this.Yn):Nb.properties&&"SharePoint"===Nb.properties.J("type")?(Ea=Nb.properties.J("siteUrl"),Nb=Nb.properties.J("folderUrl"),this.C1b.tYa(Nb,U+kb,Ea,this.Yn)):qa.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):qa.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else qa.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}
Object(c.a)(Pe,"ReactSaveAsDialog",null,[1029]);class Jh{constructor(U,Ea,kb,Nb,nc,ad,Od,af=null,ve=null,eh=null){this.ga=Ea;this.va=U;this.oEa=Nb;this.ugb=ad;this.kL=nc;this.vh=kb;this.CMh=Od;this.Fek=af;this.C1b=ve;this.ywc=eh}create(U){return this.vh&&this.vh.eb.wz?new Pe(this.CMh,this.kL,this.ugb,J.AFrameworkApplication.Bs,this.vh,this.Fek,this.C1b,this.ywc,U):new Al(this.va,this.ga,this.vh,this.oEa,this.kL,this.ugb,this.CMh,U)}}Object(c.a)(Jh,"FileNameDialogFactory",null,[1010]);class Kj{constructor(U,
Ea,kb,Nb){this.Ty=this.h9c=null;this.BTb=U;this.vh=kb;this.pjk=Nb;this.kcb=new xb.a(()=>new Ai.a(Ea.value,Object(u.a)(this,this.H9b,"getMoreInfoEventReceived")))}get Cbj(){this.h9c||(this.kcb.value.sk("Save As",!0),this.Ty&&this.Ty.Mna&&this.Ty.Mna.length&&(this.h9c=this.VHl(this.Ty.Mna)));return this.h9c}start(U){if(!this.Cbj)if(J.AFrameworkApplication.breadcrumbFolderUrl&&J.AFrameworkApplication.breadcrumbFolderUrl.length)this.h9c=J.AFrameworkApplication.breadcrumbFolderUrl;else return qa.ULS.sendTraceTag(23881884,
216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Ty),!1;const Ea=this.pjk();Ea.Hvn();const kb=Ea.hKl();if(!kb)return qa.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.BTb.start((Nb,nc)=>{Ea.hide();U(Nb,nc)},()=>{this.lgc(Ea)},kb,this.h9c);return!0}lgc(U){U.hide();qa.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}VHl(U){U=U.toLowerCase();
U.endsWith("/")||(U+="/");const Ea=U.indexOf("/documents/");return-1!==Ea?U.substring(0,Ea+1)+"_layouts/15/onedrive.aspx":""}H9b(U){this.Ty||3!==U.state||(this.Ty=U)}}Object(c.a)(Kj,"OneDriveFilePickerHelper",null,[1009]);class $g extends Ye.a{constructor(){super()}Hvn(){this.Uxb="FilePickerDialog";this.Lf="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.Je="PickerDialog-MsoSp";this.showDialog("",null)}hKl(){return document.getElementById("FilePickerDiv")}IV(){}a5(){}}Object(c.a)($g,"PickerDialog",
Ye.a,[935]);class Nk{constructor(U,Ea,kb,Nb,nc,ad,Od){this.va=U;this.Kef=kb;this.ga=Ea;this.pbd=Nb;this.BTb=nc;this.g9c=ad;this.H4j=Od}lb(){const U=this.BTb.mGc();U?Ma.a.Fy||this.va.ea("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.ga.Aa(za.a.pkc,Je.a.frame,Object(u.a)(this,this.xtj,"saveToSharePointActionDispatcher"),64):(U.C6a.continueWith(Ea=>{Ea.Vh&&this.BTb.MHg(Ea)}),this.Ble()):qa.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}Ble(){Ta.a.kQc(Object(u.a)(this,
this.xtj,"saveToSharePointActionDispatcher"));Ta.a.v7b([new ai.a(za.a.pkc,Je.a.frame,0)],this.BTb.mGc())}get jLc(){return this.va.ea("SaveToAnotherFolderBrsIsEnabled")}get D4h(){return this.va.ea("UserCanWriteRelative")}xtj(U,Ea,kb,Nb,nc){return Ea.contextId!==Je.a.frame||U!==za.a.pkc?2:this.jLc&&(this.g9c.Cbj||this.D4h)?1===kb?pf.SessionStatusManager.instance.oj||J.AFrameworkApplication.wsa?8:this.H4j()?32:8:2===kb?(qa.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+
(nc&&nc.SaveEntryPoint&&"VersionHistory"===nc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.D4h?(qa.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.Kef.create(nc).BSa(null)):(qa.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.pbd.start(null,nc)),32):8:8}}Object(c.a)(Nk,"SaveToSharePointActor",null,[]);class df{constructor(U,Ea,kb,Nb){this.Yn=this.vGh=null;this.C1b=U;this.kL=Ea;this.g9c=kb;
this.vh=Nb}start(U,Ea){qa.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.vGh=U;this.Yn=Ea;this.g9c.start((kb,Nb)=>{this.XOg(kb,Nb)})||this.S5g()}XOg(U,Ea){if(U)this.onSuccess(Ea);else this.onFailure(Ea)}S5g(){1!==this.vh.state&&this.kL().uXf(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(U){qa.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(U&&U.data&&U.data.value&&U.data.value.length&&
U.data.value[0].sharePoint){const Ea=U.data.value[0].sharePoint.url;U=U.data.value[0].sharePoint.listUrl;let kb=null;if(Ea&&(kb=U?this.JOl(U):this.IOl(Ea))){this.C1b.tYa(Ea,this.vGh,kb,this.Yn);return}qa.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!Ea,!kb)}qa.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.S5g()}IOl(U){U.endsWith("/")||(U+="/");let Ea=0;for(let kb=0;kb<U.length;kb++)if("/"===
U.charAt(kb)&&5===++Ea)return U.substr(0,kb);return null}JOl(U){U.endsWith("/")&&(U=U.substring(0,U.length-1));const Ea=U.lastIndexOf("/");return-1!==Ea?U.substring(0,Ea):null}onFailure(U){qa.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");U&&U.error?qa.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",U.error.errorCode,U.error.message):qa.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.S5g()}}Object(c.a)(df,
"SaveToSharePointManager",null,[1916]);class tk{constructor(U,Ea,kb,Nb,nc,ad,Od,af){this.A6=U;this.QT=Ea;this.Gsc=Nb;this.Orf=ad;this.e0a=kb;this.fok=nc;this.lcb=Od;this.Yn=af}execute(U,Ea){if(!J.AFrameworkApplication.mi&&J.AFrameworkApplication.Gd){var kb=this.A6+this.lcb;kb=Db.a.Qm(kb,"fu",bc.a.Xh(this.e0a));kb=Db.a.Qm(kb,"su",bc.a.Xh(this.fok));kb=Db.a.Qm(kb,"fn",bc.a.Xh(this.QT));kb=Db.a.Qm(kb,"n",bc.a.Xh((new Date).getTime().toString()));this.Yn&&this.Yn.FileDownloadUrl&&(kb=Db.a.Qm(kb,"furl",
bc.a.Xh(this.Yn.FileDownloadUrl)));kb=kb+"&"+this.Orf;this.Gsc&&this.Gsc.length?kb=Db.a.Qm(kb,"fnn",bc.a.Xh(this.Gsc)):qa.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");qa.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");J.AFrameworkApplication.Gd.Ni(kb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,U,Ea,null,void 0,void 0,void 0,void 0,"9")}}}Object(c.a)(tk,"SharePointSaveAsCaller",null,[1943]);class Ng{constructor(U){this.Ggb=
U.appSettings.SaveAsToHostWebServiceBase;this.QT=U.appSettings.FileName;this.lcb=U.Ga("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(U,Ea,kb,Nb){return new tk(this.Ggb,this.QT,U,Ea,kb,J.AFrameworkApplication.Fk,this.lcb,Nb)}}Object(c.a)(Ng,"SharePointUploadCallerFactory",null,[1915]);var yh=b(1387);class Bj{constructor(U,Ea,kb,Nb,nc){this.Ml=this.KYc=null;this.T8e=!1;this.xtf=this.e0a=null;this.Eyf=Ea;this.Aeb=kb;this.kL=Nb;this.vh=nc;this.ga=U}tYa(U,Ea,kb,Nb){this.T8e=!1;qa.ULS.sendTraceTag(23881921,
216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.Xtb();this.e0a=U;Nb&&Nb.SaveEntryPoint&&(this.xtf=Nb.SaveEntryPoint);this.KYc=this.Eyf.create(U,Ea,kb,Nb);Nb&&"true"===Nb.SkipSaveToHost?this.pra():this.uol()}uol(){const U=()=>{qa.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.pra()};32!==this.ga.ob(za.a.yMb,2,[()=>{qa.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");
this.pra()},U])&&U()}pra(){qa.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.KYc.execute(Object(u.a)(this,this.CJm,"onSaveToSharePointUploadFinished"),Object(u.a)(this,this.BJm,"onSaveToSharePointUploadFailed"))}CJm(U){if(U&&U.data&&U.data.Rd){var Ea;if(({at:Ea}=ra.d(U.data.Rd)).returnValue)if(Ea.StatusCode!==fh.a.HD&&Ea.StatusCode!==fh.a.jCc)qa.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",U.data.status,
Ea.StatusCode),Ea.StatusCode!==fh.a.jVe&&this.Qhi(U.data.status)||(this.x8a(Ea.StatusCode.toString()),this.Jun(Ea.StatusCode));else{qa.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.sWg();try{Ea.NewDocumentUrl?this.Qic(Ea.NewDocumentUrl):this.Ric()}catch(kb){qa.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",kb.toString())}}else qa.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:ab.a.oZd(U.data.Rd)}),this.yre()||
(this.x8a("Failed to deserialize response"),this.PVd())}else qa.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.yre()||(this.x8a("Unknown"),this.PVd())}BJm(U){U&&U.data?this.Qhi(U.data.status)||(qa.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.x8a(yh.a[U.data.status]),this.PVd()):(qa.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.yre()||(this.x8a("Unknown"),this.PVd()))}yre(){if(!this.T8e)return qa.ULS.sendTraceTag(23881930,
216,10,"Upload fail. Retrying."),this.T8e=!0,this.pra(),!0;qa.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}Qhi(U){qa.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",U);return this.yre()}Ric(){qa.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");da.a.Tk(this.e0a,da.a.Mda(3),void 0,"UploadToSharePointManager.RedirectToFolder")}Qic(U){let Ea=!1,kb=!1;J.AFrameworkApplication.K&&(Ea=J.AFrameworkApplication.K.ea("SaveACopyIsEnabledForUiHost"),
kb=J.AFrameworkApplication.K.ea("UiHostSupportsDocRebootFeatures"));qa.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",U,Ea);if(Ea&&kb){qa.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Nb={};Nb[xe.a.CLb]="1";Nb[xe.a.documentUrl]=U;Nb[xe.a.reason]=bf.a.EYg;J.AFrameworkApplication.jH().execute(nc=>{nc.Eh(we.a.Mjb,Nb)})}else da.a.Tk(U,da.a.Mda(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}Xtb(){this.vh&&
1===this.vh.state||(this.Ml=this.Aeb(),this.Ml.message=CommonUIStrings.l_CommentProgressTooltip,this.Ml.wc=5,this.Ml.Hq=!1,this.Ml.yQ(CommonUIStrings.l_DefaultDialogTitle,null,null))}$ya(){this.Ml&&(this.Ml.close(),this.Ml=null)}PVd(){this.jq(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}xvn(){this.jq(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}Nun(){const U=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);
this.jq(CommonUIStrings.l_SaveAsFileTooLargeTitle,U,nj.a.Wsj)}jq(U,Ea,kb=nj.a.atj){qa.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",U,Ea);this.$ya();1!==this.vh.state&&this.kL().ihi(U,Ea,kb)}Jun(U){qa.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",U);switch(U){case fh.a.mVc:this.xvn();break;case fh.a.jVe:this.Nun();break;default:this.PVd()}}sWg(){"VersionHistory"===this.xtf&&this.ga.processAction(za.a.OQc,2)}x8a(U){"VersionHistory"===this.xtf&&
this.ga.ob(za.a.oRd,2,{["FailureReason"]:U})}}Object(c.a)(Bj,"UploadToSharePointManager",null,[1914]);var xi=b(679),Ue=b(113);class sf{constructor(){this.hcd=this.lae=this.gae=this.Z=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Hb(U){this.Z=U;this.gae=xi.a.ot(U.Ca("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.lae=xi.a.ot(U.Ca("Common.IEventEmitter<Common.IMruResult>"));J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",
!1)||"SharePointOnlineConsumer"===J.AFrameworkApplication.K.Ga("FileSource")?(this.hcd=xi.a.ot(U.Ca("Common.App.SharedFilePicker.ISharedFilePicker")),Ue.Task.WAA.call(null,this.gae,this.lae,this.hcd).continueWith(()=>{this.plj()})):(this.hcd=null,Ue.Task.WAA.call(null,this.gae,this.lae).continueWith(()=>{this.plj()}))}plj(){this.Z.register(Ng,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").zd(()=>new Ng(J.AFrameworkApplication.K)).singleInstance();
this.Z.register(Bj,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").zd(()=>new Bj(J.AFrameworkApplication.pa,this.Z.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Mk.a).create(),()=>new Sd,J.AFrameworkApplication.la)).singleInstance();this.Z.register(df,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").zd(()=>new df(this.Z.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
()=>new Sd,this.Z.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),J.AFrameworkApplication.la)).singleInstance();this.Z.register(Kj,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").zd(()=>new Kj(this.Z.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new xb.a(()=>this.gae.result),J.AFrameworkApplication.la,()=>new $g)).singleInstance();this.Z.register(Jh,"Common.App.SaveToSharePoint.FileNameDialogFactory").zd(()=>
new Jh(J.AFrameworkApplication.K,J.AFrameworkApplication.pa,J.AFrameworkApplication.la,J.AFrameworkApplication.la.eb,this.Z.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.Z.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.Z.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new xb.a(()=>this.lae.result),this.Z.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.hcd?this.hcd.result:null)).singleInstance();this.Z.register(Nk,"Common.App.SaveToSharePoint.SaveToSharePointActor").zd(()=>
new Nk(J.AFrameworkApplication.K,J.AFrameworkApplication.pa,this.Z.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.Z.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.Z.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.Z.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>J.AFrameworkApplication.la.w4h)).singleInstance();J.AFrameworkApplication.K.ea("SaveToAnotherFolderBrsIsEnabled")&&this.Z.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").lb()}static main(){ba.a.instance.Sb(new sf)}}
Object(c.a)(sf,"PackageManager",null,[1,2]);class lm{}Object(c.a)(lm,"StringDifference",null,[1908]);class Sc{constructor(U,Ea){this.charCode=U;this.description=Ea}}Object(c.a)(Sc,"UBTableEntry",null,[]);class De{}new Sc(8,"C0 Controls 1");new Sc(9,"Horizontal tab (HT)");new Sc(10,"Line feed (LF)");new Sc(12,"C0 Controls 2");new Sc(13,"Carriage return (CR)");new Sc(31,"C0 Controls 3");new Sc(32,"Space");new Sc(47,"ASCII Punctuation and Symbols 1");new Sc(57,"ASCII Digits");new Sc(64,"ASCII Punctuation and Symbols 2");
new Sc(90,"Uppercase Latin Alphabet");new Sc(96,"ASCII Punctuation and Symbols 3");new Sc(122,"Lowercase Latin Alphabet");new Sc(127,"U+0000..U+007F Basic Latin");new Sc(159,"C1 Controls");new Sc(160,"NB Space");new Sc(191,"Latin-1 Punctuation and Symbols");new Sc(255,"U+0080..U+00FF Latin-1 Supplement");new Sc(383,"U+0100..U+017F Latin Extended-A");new Sc(591,"U+0180..U+024F Latin Extended-B");new Sc(687,"U+0250..U+02AF IPA Extensions");new Sc(767,"U+02B0..U+02FF Spacing Modifier Letters");new Sc(879,
"U+0300..U+036F Combining Diacritical Marks");new Sc(1023,"U+0370..U+03FF Greek and Coptic");new Sc(1279,"U+0400..U+04FF Cyrillic");new Sc(1327,"U+0500..U+052F Cyrillic Supplement");new Sc(1423,"U+0530..U+058F Armenian");new Sc(1535,"U+0590..U+05FF Hebrew");new Sc(1791,"U+0600..U+06FF Arabic");new Sc(1871,"U+0700..U+074F Syriac");new Sc(1919,"U+0750..U+077F Arabic Supplement");new Sc(1983,"U+0780..U+07BF Thaana");new Sc(2047,"U+07C0..U+07FF NKo");new Sc(2111,"U+0800..U+083F Samaritan");new Sc(2143,
"U+0840..U+085F Mandaic");new Sc(2303,"U+08A0..U+08FF Arabic Extended-A");new Sc(2431,"U+0900..U+097F Devanagari");new Sc(2559,"U+0980..U+09FF Bengali");new Sc(2687,"U+0A00..U+0A7F Gurmukhi");new Sc(2815,"U+0A80..U+0AFF Gujarati");new Sc(2943,"U+0B00..U+0B7F Oriya");new Sc(3071,"U+0B80..U+0BFF Tamil");new Sc(3199,"U+0C00..U+0C7F Telugu");new Sc(3327,"U+0C80..U+0CFF Kannada");new Sc(3455,"U+0D00..U+0D7F Malayalam");new Sc(3583,"U+0D80..U+0DFF Sinhala");new Sc(3711,"U+0E00..U+0E7F Thai");new Sc(3839,
"U+0E80..U+0EFF Lao");new Sc(4095,"U+0F00..U+0FFF Tibetan");new Sc(4255,"U+1000..U+109F Myanmar");new Sc(4351,"U+10A0..U+10FF Georgian");new Sc(4607,"U+1100..U+11FF Hangul Jamo");new Sc(4991,"U+1200..U+137F Ethiopic");new Sc(5023,"U+1380..U+139F Ethiopic Supplement");new Sc(5119,"U+13A0..U+13FF Cherokee");new Sc(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new Sc(5791,"U+1680..U+169F Ogham");new Sc(5887,"U+16A0..U+16FF Runic");new Sc(5919,"U+1700..U+171F Tagalog");new Sc(5951,"U+1720..U+173F Hanunoo");
new Sc(5983,"U+1740..U+175F Buhid");new Sc(6015,"U+1760..U+177F Tagbanwa");new Sc(6143,"U+1780..U+17FF Khmer");new Sc(6319,"U+1800..U+18AF Mongolian");new Sc(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new Sc(6479,"U+1900..U+194F Limbu");new Sc(6527,"U+1950..U+197F Tai Le");new Sc(6623,"U+1980..U+19DF New Tai Lue");new Sc(6655,"U+19E0..U+19FF Khmer Symbols");new Sc(6687,"U+1A00..U+1A1F Buginese");new Sc(6831,"U+1A20..U+1AAF Tai Tham");new Sc(7039,"U+1B00..U+1B7F Balinese");
new Sc(7103,"U+1B80..U+1BBF Sundanese");new Sc(7167,"U+1BC0..U+1BFF Batak");new Sc(7247,"U+1C00..U+1C4F Lepcha");new Sc(7295,"U+1C50..U+1C7F Ol Chiki");new Sc(7375,"U+1CC0..U+1CCF Sundanese Supplement");new Sc(7423,"U+1CD0..U+1CFF Vedic Extensions");new Sc(7551,"U+1D00..U+1D7F Phonetic Extensions");new Sc(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new Sc(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new Sc(7935,"U+1E00..U+1EFF Latin Extended Additional");new Sc(8191,"U+1F00..U+1FFF Greek Extended");
new Sc(8303,"U+2000..U+206F General Punctuation");new Sc(8351,"U+2070..U+209F Superscripts and Subscripts");new Sc(8399,"U+20A0..U+20CF Currency Symbols");new Sc(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new Sc(8527,"U+2100..U+214F Letterlike Symbols");new Sc(8591,"U+2150..U+218F Number Forms");new Sc(8703,"U+2190..U+21FF Arrows");new Sc(8959,"U+2200..U+22FF Mathematical Operators");new Sc(9215,"U+2300..U+23FF Miscellaneous Technical");new Sc(9279,"U+2400..U+243F Control Pictures");
new Sc(9311,"U+2440..U+245F Optical Character Recognition");new Sc(9471,"U+2460..U+24FF Enclosed Alphanumerics");new Sc(9599,"U+2500..U+257F Box Drawing");new Sc(9631,"U+2580..U+259F Block Elements");new Sc(9727,"U+25A0..U+25FF Geometric Shapes");new Sc(9983,"U+2600..U+26FF Miscellaneous Symbols");new Sc(10175,"U+2700..U+27BF Dingbats");new Sc(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new Sc(10239,"U+27F0..U+27FF Supplemental Arrows-A");new Sc(10495,"U+2800..U+28FF Braille Patterns");
new Sc(10623,"U+2900..U+297F Supplemental Arrows-B");new Sc(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new Sc(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new Sc(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new Sc(11359,"U+2C00..U+2C5F Glagolitic");new Sc(11391,"U+2C60..U+2C7F Latin Extended-C");new Sc(11519,"U+2C80..U+2CFF Coptic");new Sc(11567,"U+2D00..U+2D2F Georgian Supplement");new Sc(11647,"U+2D30..U+2D7F Tifinagh");new Sc(11743,"U+2D80..U+2DDF Ethiopic Extended");
new Sc(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");new Sc(11903,"U+2E00..U+2E7F Supplemental Punctuation");new Sc(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new Sc(12255,"U+2F00..U+2FDF Kangxi Radicals");new Sc(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new Sc(12351,"U+3000..U+303F CJK Symbols and Punctuation");new Sc(12447,"U+3040..U+309F Hiragana");new Sc(12543,"U+30A0..U+30FF Katakana");new Sc(12591,"U+3100..U+312F Bopomofo");new Sc(12687,"U+3130..U+318F Hangul Compatibility Jamo");
new Sc(12703,"U+3190..U+319F Kanbun");new Sc(12735,"U+31A0..U+31BF Bopomofo Extended");new Sc(12783,"U+31C0..U+31EF CJK Strokes");new Sc(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new Sc(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new Sc(13311,"U+3300..U+33FF CJK Compatibility");new Sc(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new Sc(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new Sc(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new Sc(42127,"U+A000..U+A48F Yi Syllables");
new Sc(42191,"U+A490..U+A4CF Yi Radicals");new Sc(42239,"U+A4D0..U+A4FF Lisu");new Sc(42559,"U+A500..U+A63F Vai");new Sc(42655,"U+A640..U+A69F Cyrillic Extended-B");new Sc(42751,"U+A6A0..U+A6FF Bamum");new Sc(42783,"U+A700..U+A71F Modifier Tone Letters");new Sc(43007,"U+A720..U+A7FF Latin Extended-D");new Sc(43055,"U+A800..U+A82F Syloti Nagri");new Sc(43071,"U+A830..U+A83F Common Indic Number Forms");new Sc(43135,"U+A840..U+A87F Phags-pa");new Sc(43231,"U+A880..U+A8DF Saurashtra");new Sc(43263,"U+A8E0..U+A8FF Devanagari Extended");
new Sc(43311,"U+A900..U+A92F Kayah Li");new Sc(43359,"U+A930..U+A95F Rejang");new Sc(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new Sc(43487,"U+A980..U+A9DF Javanese");new Sc(43615,"U+AA00..U+AA5F Cham");new Sc(43647,"U+AA60..U+AA7F Myanmar Extended-A");new Sc(43743,"U+AA80..U+AADF Tai Viet");new Sc(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new Sc(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new Sc(44031,"U+ABC0..U+ABFF Meetei Mayek");new Sc(55215,"U+AC00..U+D7AF Hangul Syllables");new Sc(55295,
"U+D7B0..U+D7FF Hangul Jamo Extended-B");new Sc(56191,"U+D800..U+DB7F High Surrogates");new Sc(56319,"U+DB80..U+DBFF High Private Use Surrogates");new Sc(57343,"U+DC00..U+DFFF Low Surrogates");new Sc(63743,"U+E000..U+F8FF Private Use Area");new Sc(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new Sc(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new Sc(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new Sc(65039,"U+FE00..U+FE0F Variation Selectors");new Sc(65055,"U+FE10..U+FE1F Vertical Forms");
new Sc(65071,"U+FE20..U+FE2F Combining Half Marks");new Sc(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new Sc(65135,"U+FE50..U+FE6F Small Form Variants");new Sc(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new Sc(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new Sc(65535,"U+FFF0..U+FFFF Specials");new Sc(65663,"U+10000..U+1007F Linear B Syllabary");new Sc(65791,"U+10080..U+100FF Linear B Ideograms");new Sc(65855,"U+10100..U+1013F Aegean Numbers");new Sc(65935,"U+10140..U+1018F Ancient Greek Numbers");
new Sc(65999,"U+10190..U+101CF Ancient Symbols");new Sc(66047,"U+101D0..U+101FF Phaistos Disc");new Sc(66207,"U+10280..U+1029F Lycian");new Sc(66271,"U+102A0..U+102DF Carian");new Sc(66351,"U+10300..U+1032F Old Italic");new Sc(66383,"U+10330..U+1034F Gothic");new Sc(66463,"U+10380..U+1039F Ugaritic");new Sc(66527,"U+103A0..U+103DF Old Persian");new Sc(66639,"U+10400..U+1044F Deseret");new Sc(66687,"U+10450..U+1047F Shavian");new Sc(66735,"U+10480..U+104AF Osmanya");new Sc(67647,"U+10800..U+1083F Cypriot Syllabary");
new Sc(67679,"U+10840..U+1085F Imperial Aramaic");new Sc(67871,"U+10900..U+1091F Phoenician");new Sc(67903,"U+10920..U+1093F Lydian");new Sc(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new Sc(68095,"U+109A0..U+109FF Meoritic Cursive");new Sc(68191,"U+10A00..U+10A5F Kharoshthi");new Sc(68223,"U+10A60..U+10A7F Old South Arabian");new Sc(68415,"U+10B00..U+10B3F Avestan");new Sc(68447,"U+10B40..U+10B5F Inscriptional Parthian");new Sc(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new Sc(68687,"U+10C00..U+10C4F Old Turkic");
new Sc(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");new Sc(69759,"U+11000..U+1107F Brahmi");new Sc(69839,"U+11080..U+110CF Kaithi");new Sc(69887,"U+110D0..U+110FF Sora Sompeng");new Sc(69967,"U+11100..U+1114F Chakma");new Sc(70111,"U+11180..U+111DF Sharada");new Sc(71375,"U+11680..U+116CF Takri");new Sc(74751,"U+12000..U+123FF Cuneiform");new Sc(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new Sc(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new Sc(92735,"U+16800..U+16A3F Bamum Supplement");
new Sc(94111,"U+16F00..U+16F9F Miao");new Sc(110847,"U+1B000..U+1B0FF Kana Supplement");new Sc(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new Sc(119295,"U+1D100..U+1D1FF Musical Symbols");new Sc(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new Sc(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new Sc(119679,"U+1D360..U+1D37F Counting Rod Numerals");new Sc(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new Sc(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");
new Sc(127023,"U+1F000..U+1F02F Mahjong Tiles");new Sc(127135,"U+1F030..U+1F09F Domino Tiles");new Sc(127231,"U+1F0A0..U+1F0FF Playing Cards");new Sc(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new Sc(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new Sc(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new Sc(128591,"U+1F600..U+1F64F Emoticons");new Sc(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new Sc(128895,"U+1F700..U+1F77F Alchemical Symbols");
new Sc(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");new Sc(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new Sc(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new Sc(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new Sc(917631,"U+E0000..U+E007F Tags");new Sc(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new Sc(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new Sc(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");
Object(c.a)(De,"UnicodeBlocks",null,[1799]);class uk{constructor(){this.Z=null}Hb(U){this.Z=U;this.Z.register(lm,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").singleInstance();this.Z.register(De,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").singleInstance()}get name(){return"Common.App.SensitiveLogging"}init(){this.Z.resolve("Common.App.SensitiveLogging.IStringDifference");this.Z.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){ba.a.instance.Sb(new uk)}}
Object(c.a)(uk,"SensitiveLoggingPackage",null,[1,2]);var Th;(function(U){U[U.myFiles=0]="myFiles";U[U.recent=1]="recent";U[U.currentFolder=2]="currentFolder";U[U.yourPhone=3]="yourPhone"})(Th||(Th={}));Object(c.b)("SharedFilePickerLandingLocation",Th);class kc{constructor(U){this.kac=this.tPc=null;this._initialized=!1;this.Ohg=U}i_f(U){this._initialized||(U.ax(we.a.vRg),U.uD(we.a.vRg,Object(u.a)(this,this.JIm,"onReceivedPickerResponse")),this._initialized=!0)}gxi(U){return this.kac=new Promise((Ea,
kb)=>{const Nb={};Nb[xe.a.yej]=U;this.tPc=(nc,ad)=>{""===ad?(qa.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Ea(nc)):("Canceled"===ad?qa.ULS.sendTraceTag(572548164,306,50,ad):qa.ULS.sendTraceTag(556901065,306,10,ad),kb(ad))};this.Ohg.execute(nc=>{this.i_f(nc);nc.Eh(we.a.Tbj,Nb)})})}JIm(U){this.tPc(U.Values[xe.a.Iuj],void 0===U.Values[xe.a.VQe]||null===U.Values[xe.a.VQe]?"":U.Values[xe.a.VQe])}DUi(){return J.AFrameworkApplication.K.ea("UiHostCommonFilePicker")}dci(U,Ea,kb,
Nb,nc,ad,Od,af,ve=null){const eh={};eh[xe.a.puj]=U;eh[xe.a.titleText]=Ea;eh[xe.a.JXh]=kb;eh[xe.a.LXh]=Nb;eh[xe.a.OXh]=nc;eh[xe.a.ghi]=!0;eh[xe.a.Jni]=ad;eh[xe.a.Eej]=Od;eh[xe.a.Dej]=Th[af];mf.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(eh[xe.a.Fej]="Dark");ve&&(null!=ve.ygd&&(eh[xe.a.ygd]=ve.ygd),null!=ve.yIc&&(eh[xe.a.yIc]=ve.yIc));return eh}}Object(c.a)(kc,"SharedFilePickerManager",null,[1909]);class ei{constructor(){this.Z=null}get name(){return"Common.App.SharedFilePicker"}Hb(U){this.Z=
U;U.register(kc,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").singleInstance().zd(()=>new kc(U.Ca("Postmessage.IHostPostmessenger")))}init(){J.AFrameworkApplication.K.wq(()=>{this.Pac()})}Pac(){this.Z.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){ba.a.instance.Sb(new ei)}}Object(c.a)(ei,"SharedFilePickerPackage",null,[1,2]);class jg extends Sys.EventArgs{constructor(U){super();this.nzm=U}}Object(c.a)(jg,
"TypingSpeedMeterChangedEventArgs",Sys.EventArgs,[]);class gj{}Object(c.a)(gj,"TypingSpeedMeterWindow",null,[]);class Vk{constructor(U,Ea,kb,Nb,nc){this.MAg=null;this.Ksh=this.dge=this.ixf=this.mNc=0;this.cyf=new r.a;this.Vy=U;this.te=Ea;this.te.hgd(Object(u.a)(this,this.qgc,"onCpuMeterFrameAvailable"));this.Nqk=kb;this.Ifk=nc;this.iqk=Nb}fzk(U){this.cyf.addHandler("TypingSpeedWindowAvailable",U)}g8m(U){this.cyf.removeHandler("TypingSpeedWindowAvailable",U)}qgc(U,Ea){this.MAg=Ea.SId}nWi(){var U=this.Vy();
U-this.dge>this.iqk&&this.Tqj();this.mNc||(this.ixf=U);this.dge=U;this.mNc++;this.mNc>=this.Ifk&&(this.cyf.raiseEvent("TypingSpeedWindowAvailable",new jg(this.X3h())),U=new gj,U.TS=this.X3h(),this.MAg&&(U.CP=this.MAg.CP),U.EC=this.Ksh,this.Nqk.track(U),this.Tqj())}Tqj(){this.dge=this.ixf=this.mNc=0}X3h(){return 2>this.mNc?0:Math.round(6E4*(this.mNc-1)/(this.dge-this.ixf))}gOn(U){this.Ksh=U}dispose(){this.te.CUe(Object(u.a)(this,this.qgc,"onCpuMeterFrameAvailable"))}}Object(c.a)(Vk,"TypingSpeedMeter",
null,[1940]);class Ef{constructor(U){this.t1b=null;this.Ko=new l.a;this.Vy=U}initialize(U,Ea,kb,Nb){this.t1b||(this.t1b=new Vk(this.Vy,U,Ea,kb,Nb),this.Ko.mf(this.t1b));return this.t1b}}Object(c.a)(Ef,"TypingSpeedMeterProvider",null,[1910]);class tn{constructor(){this.byf=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(J.AFrameworkApplication.K.ea("TypingSpeedMeterIsEnabled")){const U=ia.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),Ea=xi.a.ot(ia.a.instance.Ca("Common.ICpuMeterProvider"));
Ea.continueWith(()=>{const kb=Ea.result.Ko.task;var Nb=new ja.a(J.AFrameworkApplication.K.jb("TypingSpeedMeterWindowSamplingPercent",0)/100);Nb=new va.a(Object(u.a)(Nb,Nb.Ptb,"shouldBeInSample"));const nc=P.a.QB(12,1,Nb),ad=J.AFrameworkApplication.K.jb("TypingSpeedMeterWindowTimeoutMs",5E3),Od=J.AFrameworkApplication.K.jb("TypingSpeedMeterMaxKeystrokesPerWindow",5);kb.CWR(()=>this.byf=U.initialize(kb.result,nc,ad,Od))})}}dispose(){this.byf&&this.byf.dispose()}Hb(U){U.register(Ef,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").singleInstance().zd(()=>
new Ef(da.a.me))}static main(){ba.a.instance.Sb(new tn)}}Object(c.a)(tn,"TypingSpeedMeterPackage",null,[1,2]);class kh{create(U){return new ja.a(U)}}Object(c.a)(kh,"RandomSamplerFactory",null,[852]);var Qe=b(12),Nn=b(1224);class xg{constructor(U,Ea,kb,Nb,nc){U.Hyk(()=>{Nb.iRd()});U.Xyk((ad,Od)=>{Nb.gRd(Od.revisionId,Od.Iqb)});U.VCf((ad,Od)=>{Nb.y1l(Od.Pcn,Od.Iqb,Od.WIj)});U.Gyk(()=>{Nb.MVg()});Ea.$yk((ad,Od)=>{Nb.cEn(Od.Mpj,Od.J1e,Od.actualValue)});Ea.iyk((ad,Od)=>{Nb.bEn(Od.Mpj,Od.J1e,Od.actualValue)});
nc.ggd(()=>{Nb.RZd()});kb.Wea((ad,Od)=>{6===Od.type&&Nb.pRc(Od.kia)})}}Object(c.a)(xg,"EventForwarder",null,[]);class el{constructor(U,Ea,kb){this.Jgk=U;this.rZ=kb;this.hxc=Ea}create(U,Ea){return new xg(this.Jgk,this.hxc,U,Ea,this.rZ)}}Object(c.a)(el,"EventForwarderFactory",null,[]);var jh=b(366);class gh{}gh.GIn="TypingToOutboundReplicationStart";gh.KMm="OutboundReplicationStartToOutboundReplicationEnd";gh.Bsj="RtcNotificationToInboundReplicationEnd";gh.uMj="TypingToInboundReplicationEnd";Object(c.a)(gh,
"PerfTrackerPhases",null,[]);class Ed{constructor(U,Ea,kb,Nb,nc,ad,Od,af,ve=null){this.Pmf=this.HEh=!1;this.Cof=5;this.QFh=50;this.lnf=20;this.Flf=this.Wmf=this.fMa=null;this.a_c=this.RZc=0;this.Evf=this.Jwf=!1;this.Gfe=Array(7);this.$Wc=null;this.ryh=!1;this.baf=null;this.tta={};this.u8d=U;this.dbb=Ea;this.xfk=kb;this.Lzh=Nb.create(gh.Bsj,nc,ad,20,!1);this.Bge=Nb.create(gh.uMj,Od,af,20,!0);if(this.va=J.AFrameworkApplication.K)this.HEh=this.va.ea("LogSteppedInboundFrameIsEnabled"),this.Pmf=this.va.ea("LogTasksDetailsFromCPUMeterIsEnabled"),
this.lnf=this.va.jb("InboundFrameMaxNumberOfLongRunningTasks",20),this.QFh=this.va.jb("InboundFrameMinLengthForLongRunningTasksInMs",50),this.Cof=this.va.jb("InboundFrameNumberOfLastShortTasks",5);this.yRb=ve}get HQk(){null==this.baf&&(this.baf=!!this.va&&this.va.ea("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));return this.baf}initialize(U){this.fMa=U}r$m(U,Ea,kb=null){this.P6h();qa.ULS.shipAssertTag(8229761,324,0<U.length);let Nb=!1;for(const ad of U){const Od=ad.toString();if(Od in
this.tta){var nc=this.tta[Od];if(!nc.$Rc){nc.zvj(U,Ea,kb);if(this.Pmf&&!Nb){const af=this.vil(),ve=this.kql(this.$Wc);Nb=!0;this.k1i(ad.toString(),nc,af,this.Flf,this.Gfe,ve)}else this.k1i(ad.toString(),nc,null,null,this.Gfe,null);delete this.tta[Od]}}else nc=this.u8d.create(this.Lzh,this.Bge),nc.zvj(U,Ea),this.tta[Od]=nc}this.Evf=!1}pRc(U){qa.ULS.shipAssertTag(8257930,304,U.IVi,"Expected data not sent on the wire");if(U.IVi){if(U.KVe in this.tta){var Ea=this.tta[U.KVe];Ea.YVe||(Ea.pRc(U.revisionId,
U.mcj,U.xBj,U.Iqb),delete this.tta[U.KVe])}else Ea=this.u8d.create(this.Lzh,this.Bge),Ea.pRc(U.revisionId,U.mcj,U.xBj,U.Iqb),this.tta[U.KVe]=Ea;this.P6h()}}y2l(){this.Jwf||(this.Wmf=Array(this.lnf),this.Flf=Array(this.Cof),this.a_c=this.RZc=0,this.Gfe=[0,0,0,0,0,0,0,0],this.$Wc=Array(3),this.$Wc[1]=[0,0],this.$Wc[2]=[0,0],this.Jwf=!0)}Lsn(U){return!U.TP&&U.TN===F.a.NVg&&(U=jh.a(this.tta))&&U[0]?!0:!1}iEm(U){this.Jwf=!1;const Ea=jh.a(this.tta);Ea&&Ea[0]&&(U.TRT>=this.QFh&&this.RZc<this.lnf?this.Wmf[this.RZc++]=
U:(this.Flf[this.a_c]=U,this.a_c=this.a_c<this.Cof-1?this.a_c+1:0),this.drm(U),this.urm(U))}hEm(){this.Pmf&&(this.y2l(),this.Evf=!0)}drm(U){this.Gfe[U.TP]++}urm(U){if(U&&U.UI){const Ea=this.$Wc[U.UI];Ea[0]+=1;Ea[1]+=U.TRT}}kql(U){const Ea={};U&&(U[1]&&(Ea.Typing=U[1]),U[2]&&(Ea.Clicking=U[2]));return Ea}vil(){return this.RZc?this.Wmf.slice(0,this.RZc-1):null}P6h(){var U=jh.a(this.tta);if(U&&(this.ryh||this.asm(U),U.length>this.xfk))for(const Ea of U){U=this.tta[Ea];const kb=U.createdTime,Nb=this.dbb();
6E4<Nb-kb&&(k.b(8438528,304,50,"{0}",{["Not Received"]:U.$Rc?"RtcNotification":"ServerRevision",["Duration"]:Nb-kb}),U.$Rc||k.b(42075798,304,15,"{0}",{["RevisionId"]:Ea,["Duration"]:Nb-kb}),delete this.tta[Ea])}}asm(U){if(this.HQk&&this.yRb)for(const Ea of U)if(U=this.tta[Ea],U.YVe&&!U.$Rc&&(U=U.createdTime,2E3<this.dbb()-U)){let kb=null;Qe.App.oa&&Qe.App.oa.za&&Qe.App.oa.za.jc&&(kb=Qe.App.oa.za.jc.contentReplicator);this.yRb.execute(Nb=>{Nb.flush(kb,1)});this.ryh=!0}}k1i(U,Ea,kb,Nb,nc,ad){this.HEh&&
(Ea=Ea.Wpl())&&(Ea.RevisionId=U,Ea.LRTWR=kb,Ea.LSTWR=Nb,Ea.TSD=nc,Ea.UIWR=ad,this.fMa&&this.fMa.track(Ea))}}Object(c.a)(Ed,"InboundMonitor",null,[1949]);class Vj{constructor(U,Ea,kb,Nb){this.PD=Ea;this.u8d=kb;this.gqk=Nb}create(U,Ea,kb,Nb,nc=null){return new Ed(this.u8d,this.PD,50,this.gqk,U,Ea,kb,Nb,nc)}}Object(c.a)(Vj,"InboundMonitorFactory",null,[1924]);var hj=b(288);class zf{}zf.h4e="UserCount";zf.Mcn="RevisionChainLength";Object(c.a)(zf,"PerfTrackerPivotNames",null,[]);class Ke{}Object(c.a)(Ke,
"PerfTrackingContext",null,[]);const Bg=U=>5>=U?"5AndFewer":10>=U?"6To10":15>=U?"11To15":20>=U?"15To20":25>=U?"21To25":30>=U?"26To30":"31AndAbove";class wj{}Object(c.a)(wj,"SteppedInboundFrame",null,[]);class Ok{constructor(U,Ea,kb,Nb,nc){this.bAb=this.w8d=null;this.Gzh=500;this.v8d=this.pFa=this.XUb=this.ptc=this.K2d=-1;this.mnh=null;this.fNh=this.rMh=!1;this.aMh=null;this.AIh=this.X0a=0;this.xvc=U;this.createdTime=Ea();this.xee=!1;this.Gpf=0;this.TXb=kb;this.Cbk=Nb;this.Bge=nc;J.AFrameworkApplication.K&&
(this.Gzh=J.AFrameworkApplication.K.jb("InboundFrameSamplingMinimalTotalTimeMs",500))}get YVe(){return this.rMh}get $Rc(){return this.fNh}get Irj(){return this.aMh}get Iqb(){return this.X0a}get JMm(){return this.AIh}get i7b(){return this.TXb()}pRc(U,Ea,kb,Nb){this.YVe||(this.xee=kb,this.Gpf=Ea,this.K2d=D.a.rO(da.a.me(),2),this.mnh=(new Date).toISOString(),this.bAb=U,this.AIh=Nb,this.rMh=!0,this.$Rc?this.uki():(this.zFj(),ha.a.instance.Vs(U.toString()+"Start"),hj.a.instance.mMc(2)))}zvj(U,Ea,kb=null){this.$Rc||
(this.X0a=Ea,this.fNh=!0,this.aMh=U,this.v8d=D.a.rO(da.a.me(),2),this.YVe&&(ha.a.instance.Vs(this.bAb.toString()+"End"),kb&&(this.ptc=kb.dan,this.XUb=kb.y8a,this.pFa=kb.s$m),hj.a.instance.CAc(),this.uki()))}Wpl(){if(!(0<this.K2d&&0<this.ptc&&0<this.XUb&&0<this.pFa&&0<this.v8d))return null;const U=new wj;U.TT=D.a.rO(this.v8d-this.K2d,2);if(U.TT<this.Gzh)return null;U.ST=this.mnh;U.UC=this.i7b;U.RS=D.a.rO(this.ptc-this.K2d,2);U.SR=D.a.rO(this.XUb-this.ptc,2);U.RRS=D.a.rO(this.pFa-this.XUb,2);U.RP=D.a.rO(this.v8d-
this.pFa,2);U.ResponseLanded=D.a.rO(this.XUb,2);0<U.RS?(ha.a.instance.iM("RTCToRequestSent",this.bAb.toString()+"Start","RequestInvoked"+this.ptc),ha.a.instance.iM("RequestSentToResponseReceived","RequestInvoked"+this.ptc,"RequestCompleted"+this.XUb),ha.a.instance.iM("ResponseReceivedToReplicationStart","RequestCompleted"+this.XUb,"ReplicationStart"+this.pFa)):ha.a.instance.iM("RTCToReplicationStart",this.bAb.toString()+"Start","ReplicationStart"+this.pFa);ha.a.instance.iM("Replication","ReplicationStart"+
this.pFa,this.bAb.toString()+"End");return U}zFj(){this.w8d=this.xvc.create();this.w8d.start(gh.Bsj,gh.uMj)}uki(){this.w8d||this.zFj();const U=this.w8d.end(this.xee,this.g3k());this.Cbk.fVe(U);this.Bge.fVe(U+this.Gpf)}g3k(){const U={};U[zf.h4e]=Bg(this.i7b);var Ea=this.Irj.length;U[zf.Mcn]=9>=Ea?Ea.toString():"10AndAbove";return Object.assign(new Ke,{P:U,FC:this.Iqb,CFC:this.JMm+this.Iqb,ID:this.bAb.toString(),CD:this.Gpf,UC:this.i7b,RCL:this.Irj.length})}}Object(c.a)(Ok,"InboundOperation",null,[1948]);
class Yb{constructor(U,Ea,kb){this.kea=U;this.dbb=Ea;this.TXb=kb}create(U,Ea){return new Ok(this.kea,this.dbb,this.TXb,U,Ea)}}Object(c.a)(Yb,"InboundOperationFactory",null,[1925]);class Ua{constructor(U,Ea,kb,Nb,nc,ad,Od,af,ve){this.yee=!0;this.EJh=this.Sbe=null;this.Fpf=U;this.r8j=Ea;this.ojk=kb;this.Jj=Nb;this.dyf=nc.create("TypingToOutboundReplicationStart",ad,Od,20,!1);this.zsf=nc.create("OutboundReplicationStartToOutboundReplicationEnd",af,ve,20,!1)}get wMg(){return this.Sbe}get JQe(){return this.EJh}RZd(){!this.wMg&&
this.yee&&(this.yee=this.r8j())&&(this.Sbe=this.Fpf.create(Object(u.a)(this,this.GV,"sendUpdateNotification"),this.ojk(),this.dyf,this.zsf),this.wMg.RZd())}iRd(){this.yee=!0;this.EJh=this.wMg;this.JQe&&(this.Sbe=null,this.JQe.iRd())}MVg(){this.Sbe=null}gRd(U,Ea){this.JQe&&this.JQe.gRd(U,Ea)}GV(U){this.Jj.GV(6,U)}}Object(c.a)(Ua,"OutboundMonitor",null,[]);class Hb{constructor(U,Ea){this.Fpf=U;this.sik=Ea}create(U,Ea,kb,Nb,nc,ad,Od){return new Ua(this.Fpf,U,Ea,kb,this.sik,Nb,nc,ad,Od)}}Object(c.a)(Hb,
"OutboundMonitorFactory",null,[]);var $b=b(51);class sc{constructor(U){this.qAb=U}get EZm(){return this.qAb}Na(U){return!!this.qAb&&U in this.qAb}get IVi(){return this.Na(sc.fse)&&this.Na(sc.Xjc)&&this.Na(sc.C4g)}get revisionId(){if(this.Na(sc.Xjc))return $b.a.qe(this.qAb[sc.Xjc]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");}get KVe(){if(this.Na(sc.Xjc))return this.qAb[sc.Xjc];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");
}get mcj(){if(this.Na(sc.fse))return Number.parseInvariant(this.qAb[sc.fse]);throw Error.create("Unable to parse DurationKey key from dictionary into int");}get xBj(){if(this.Na(sc.Xjc))return Boolean.parse(this.qAb[sc.C4g]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get Iqb(){if(this.Na(sc.eFg))return Number.parseInvariant(this.qAb[sc.eFg]);throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static b1k(U){return new sc(U)}static f1k(U,
Ea,kb,Nb){const nc={};nc[sc.fse]=U.toString();nc[sc.Xjc]=Ea.toString();nc[sc.C4g]=kb.toString();nc[sc.eFg]=Nb.toString();return new sc(nc)}}sc.Xjc="RevisionID";sc.fse="Duration";sc.C4g="ShouldSample";sc.eFg="NumSequentialFailures";Object(c.a)(sc,"ReplicationNotificationMessage",null,[1944]);class Wc{constructor(U,Ea,kb,Nb,nc,ad,Od){this.Pp=this.lh=0;this.rYb=this.ded=null;this.y8e=[];this.rKh=null;this.q6d={};this.X0a=0;this.xvc=U;this.zmk=Ea;this.dbb=kb;this.TXb=Nb;this.TNh=nc;this.bAb=null;this.q6d.TypingStartStage=
null;this.q6d.ReplicationStartStage="TypingStartStage";this.q6d.ReplicationEndStage="ReplicationStartStage";this.wRh=1<this.i7b;this.dyf=ad;this.zsf=Od}get i7b(){return this.TXb()}RZd(){this.uLf("TypingStartStage")&&(this.sSg("TypingStartStage"),qa.ULS.shipAssertTag(8257931,324,!this.rYb&&!this.Pp,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),this.lh=this.dbb(),this.ded=this.xvc.create(),this.rFj(this.ded,gh.GIn))}iRd(){if(this.uLf("ReplicationStartStage")){this.sSg("ReplicationStartStage");
qa.ULS.shipAssertTag(8257932,324,!!this.ded,"TypingStart not called");if(this.ded){const U=this.ski(this.ded,this.bAb);this.dyf.fVe(U)}this.rYb=this.xvc.create();this.rFj(this.rYb,gh.KMm)}}gRd(U,Ea){this.uLf("ReplicationEndStage")&&(this.sSg("ReplicationEndStage"),this.Pp=this.dbb(),this.X0a=Ea,qa.ULS.shipAssertTag(8257933,324,!!this.rYb,"ReplicationStart not called"),this.rYb&&(qa.ULS.shipAssertTag(8193425,324,!!this.rYb,"ReplicationStart not called"),Ea=this.ski(this.rYb,U),this.zsf.fVe(Ea)),qa.ULS.shipAssertTag(8257934,
324,!!this.lh,"StartTime not set. No message sent to other editors."),this.lh&&(U=sc.f1k(this.Pp-this.lh,U,this.TNh,this.X0a),this.zmk(U.EZm)))}uLf(U){if(this.q6d[U]===this.rKh)return!0;qa.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.ptk()});return!1}ptk(){const U=new Sys.StringBuilder;U.append("Actual Phase:");for(let Ea=0;Ea<this.y8e.length;Ea++)U.append(" "+this.y8e[Ea]);return U.toString()}sSg(U){this.y8e.push(U);this.rKh=U}rFj(U,Ea){this.wRh&&U.start(Ea)}ski(U,Ea){if(!this.wRh)return-1;
const kb={};kb[zf.h4e]=Bg(this.i7b);Ea=Object.assign(new Ke,{P:kb,FC:this.X0a,CFC:0,ID:Ea?Ea.toString():"",CD:0,UC:this.i7b,RCL:0});return U.end(this.TNh,Ea)}}Object(c.a)(Wc,"OutboundOperation",null,[1947]);class dd{constructor(U,Ea,kb){this.xvc=U;this.dbb=Ea;this.TXb=kb}create(U,Ea,kb,Nb){return new Wc(this.xvc,U,this.dbb,this.TXb,Ea,kb,Nb)}}Object(c.a)(dd,"OutboundOperationFactory",null,[1923]);class td{constructor(U,Ea){this.Grh=this._name=this.S$=null;this.Ad=U;this.fMa=Ea}start(U,Ea=null){this.S$=
this.Ad.Pe("UserAction",U);this._name=U;this.Grh=Ea}end(U,Ea){let kb=-1;U&&(kb=this.S$.ti,Ea.D=kb,Ea.CN=this.Grh,Ea.CD+=kb,this.fMa.track(Ea,this._name));return kb}}Object(c.a)(td,"PerfTracker",null,[1946]);class oe{constructor(U,Ea){this.Ad=U;this.fMa=Ea}create(){return new td(this.Ad,this.fMa)}}Object(c.a)(oe,"PerfTrackerFactory",null,[1922]);class Ld{constructor(U,Ea,kb){this.E9c=null;this.rik=U;this.Kzh=Ea;this.Pvc=kb}init(U,Ea,kb,Nb,nc,ad,Od){Ea=this.Pvc.create(Ea/100);kb=this.Pvc.create(kb/
100);this.E9c=this.rik.create(Object(u.a)(Ea,Ea.Ptb,"shouldBeInSample"),Object(u.a)(kb,kb.Ptb,"shouldBeInSample"),U,Nb,nc,ad,Od)}RZd(){this.E9c.RZd()}iRd(){this.E9c.iRd()}MVg(){this.E9c.MVg()}gRd(U,Ea){this.E9c.gRd(U,Ea)}y1l(U,Ea,kb=null){this.Kzh.r$m(U,Ea,kb)}pRc(U){U=sc.b1k(U);this.Kzh.pRc(U);ha.a.instance.Vs(U.revisionId+"Start")}cEn(U,Ea,kb){k.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.mpe(U,Ea,kb))}bEn(U,Ea,kb){k.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",
this.mpe(U,Ea,kb))}mpe(U,Ea,kb){const Nb={};Nb.PhaseName=U;Nb.ThresholdValue=Ea;Nb.ActualValue=kb;return Nb}}Object(c.a)(Ld,"ReplicationTelemetryManager",null,[]);var Mf=b(841);class Rf extends Mf.a{constructor(U,Ea){super(U,Ea);this.Ig=this.pfe=0}tKa(U){this.pfe+=U;this.Ig++}getValue(){return this.Ig?this.pfe/this.Ig:0}C8a(){this.Ig=this.pfe=0}}Object(c.a)(Rf,"AverageMetric",Mf.a,[]);class yi extends Mf.a{constructor(U,Ea){super(U,Ea);this.mwa=0}tKa(U){U>this.mwa&&(this.mwa=U)}getValue(){return this.mwa}C8a(){this.mwa=
0}}Object(c.a)(yi,"MaxMetric",Mf.a,[]);var $i=b(1684);class he extends Mf.a{constructor(U,Ea,kb=100){super(U,Ea);this.S$d=this.Puc=this.Wwc=0;this.zde=kb;this.dtf=new $i.a(this.zde)}tKa(U){if(this.Puc===this.zde){const Ea=this.dtf.dequeue();this.Wwc-=Ea;this.Puc--}this.dtf.enqueue(U);this.Wwc+=U;this.Puc++;U=this.Wwc/this.Puc;U>this.S$d&&this.Puc===this.zde&&(this.S$d=U)}getValue(){return this.S$d}C8a(){this.S$d=0;this.dtf=new $i.a(this.zde);this.Puc=this.Wwc=0}}Object(c.a)(he,"MaxRollingAverageMetric",
Mf.a,[]);class fi extends Mf.a{constructor(U,Ea){super(U,Ea);this.Ig=0}tKa(){this.Ig++}getValue(){return this.Ig}C8a(){this.Ig=0}}Object(c.a)(fi,"CounterMetric",Mf.a,[]);class Xg{constructor(U,Ea){this.Jxc=Ea;this.K9e=new Rf(U+"-AverageValue","Milliseconds");this.knf=new yi(U+"-MaxValue","Milliseconds");this.qnf=new he(U+"-MaxRollingAverageValue","Milliseconds");this.Ebf=new fi(U+"-NumberOfEvents","Count");this.IFa=new Ha.a(U+"-SlowPercentileAtValue","Percentile",J.AFrameworkApplication.K.rE("CoAuthLatencySlowTargetValue",
3E3),J.AFrameworkApplication.K.rE("CoAuthLatencySlowThresholdPercentile",95),this.Jxc);this.Lqf=new Ha.a(U+"-BrokenSlowPercentileAtValue","Percentile",J.AFrameworkApplication.K.rE("CoAuthLatencyBrokenSlowTargetValue",5E3),J.AFrameworkApplication.K.rE("CoAuthLatencyBrokenSlowThresholdPercentile",95),this.Jxc)}bA(U){this.K9e.tKa(U);this.knf.tKa(U);this.qnf.tKa(U);this.Ebf.tKa(U);this.IFa.tKa(U);this.Lqf.tKa(U)}HTe(){this.K9e.k8a();this.knf.k8a();this.qnf.k8a();this.Ebf.k8a();this.IFa.k8a();this.Lqf.k8a();
this.K9e.C8a();this.knf.C8a();this.qnf.C8a();this.Ebf.C8a();this.IFa.C8a();this.Lqf.C8a()}}Object(c.a)(Xg,"ReplicationLatencyMetrics",null,[]);class Lm{constructor(){this.Mlf=new wb.a}Skj(U,Ea,kb){if(!(0>Ea)){if(!({value:Nb}=this.Mlf.Ab(U,Nb)).returnValue){var Nb=new Xg(U,kb);this.Mlf.$(U,Nb)}Nb.bA(Ea)}}HTe(){for(const U of this.Mlf.values)U.HTe()}}Object(c.a)(Lm,"ReplicationTelemetryMetricsManager",null,[1920]);class Fi{Skj(){}HTe(){}}Object(c.a)(Fi,"ReplicationTelemetryMetricsManagerStub",null,
[1920]);class Ja{constructor(U,Ea,kb,Nb,nc,ad,Od){this.dgb=this.nge=0;this.Xfk=U;this.Oqf=kb;this.UPh=Nb;this.Yoh=nc;this.hxc=Ea;this.Yfk=ad;this.Jxc=Od}fVe(U){this.Xfk.Skj(this.Oqf,U,this.Jxc);U>this.UPh&&this.hxc.NDn(this.Oqf,this.UPh,U);this.nge+=U;this.dgb++;this.nge/this.dgb>this.Yoh&&this.dgb>this.Yfk&&this.hxc.hGk(this.Oqf,this.Yoh,this.nge/this.dgb)}}Object(c.a)(Ja,"TimeSpanVerifier",null,[1945]);class sb{constructor(U,Ea){this.llk=U;this.hxc=Ea}create(U,Ea,kb,Nb,nc){return new Ja(this.llk,
this.hxc,U,Ea,kb,Nb,nc)}}Object(c.a)(sb,"TimeSpanVerifierFactory",null,[1921]);class ub extends Sys.EventArgs{constructor(U,Ea,kb){super();this.Mpj=U;this.J1e=Ea;this.actualValue=kb}}Object(c.a)(ub,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class Cc{constructor(){this.ka=new r.a}NDn(U,Ea,kb){this.ka.raiseEvent("TSVTE",new ub(U,Ea,kb))}hGk(U,Ea,kb){this.ka.raiseEvent("TSVATE",new ub(U,Ea,kb))}$yk(U){this.ka.addHandler("TSVTE",U)}iyk(U){this.ka.addHandler("TSVATE",U)}}Object(c.a)(Cc,"TimeSpanVerifierNotifier",
null,[1795]);class ic{constructor(){this.Z=this.va=null}get name(){return"Box4.ReplicationTelemetry"}Hb(U){this.va=U.resolve("Common.IAppSettingsManager");this.Z=U;if(this.va.ea("Box4ReplicationTelemetryIsEnabled")){U.ha("ReplicationTelemetry.IPerfTrackerFactory",()=>new oe(Qe.App.oa.Np,P.a.QB(20,1,new T.a))).singleInstance();U.ha("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new Cc).singleInstance();this.va.ea("Box4ReplicationTelemetryMetricsIsEnabled")?U.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",
()=>new Lm).singleInstance():U.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new Fi).singleInstance();U.ha("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new sb(U.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),U.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).singleInstance();U.ha("ReplicationTelemetry.OutboundOperationFactory",()=>new dd(U.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),ic.Dwi)).singleInstance();
U.ha("ReplicationTelemetry.OutboundMonitorFactory",()=>new Hb(U.resolve("ReplicationTelemetry.OutboundOperationFactory"),U.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).singleInstance();U.ha("ReplicationTelemetry.InboundOperationFactory",()=>new Yb(U.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),ic.Dwi)).singleInstance();var Ea=new Vj(U.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),U.resolve("ReplicationTelemetry.InboundOperationFactory"),
U.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),kb=this.va.ea("ComponentStateLoggingPackageIsEnabled")?this.Z.Ca("Common.IComponentStateLogManager"):null;U.ha("ReplicationTelemetry.IInboundMonitor",()=>Ea.create(this.va.jb("Box4ReplicationTelemetryInboundOperationThreshold",0),this.va.jb("Box4ReplicationTelemetryInboundOperationAverageThreshold",0),this.va.jb("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.va.jb("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",
0),kb)).singleInstance();U.ha("Common.IRandomSamplerFactory",()=>new kh).singleInstance();U.ha("ReplicationTelemetry.ReplicationTelemetryManager",()=>new Ld(U.resolve("ReplicationTelemetry.OutboundMonitorFactory"),U.resolve("ReplicationTelemetry.IInboundMonitor"),U.resolve("Common.IRandomSamplerFactory"))).singleInstance();U.ha("ReplicationTelemetry.EventForwarderFactory",()=>new el(Nn.a.instance,U.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),U.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.va.ea("Box4ReplicationTelemetryIsEnabled")){var U=
this.va.jb("Box4ReplicationTelemetrySamplePercent",0),Ea=this.va.jb("Box4ReplicationTelemetryPhaseSamplePercent",0),kb=this.va.jb("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),Nb=this.va.jb("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),nc=this.va.jb("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",0),ad=this.va.jb("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),Od=this;this.Z.Ca("Box4.Presence.IRtcProxyProvider").execute(ve=>
{ve.LN().continueWith(()=>{const eh=ve.LN().result,Ci=Od.Z.resolve("ReplicationTelemetry.ReplicationTelemetryManager");Ci.init(eh,U,Ea,kb,Nb,nc,ad);Od.Z.resolve("ReplicationTelemetry.EventForwarderFactory").create(eh,Ci);if(Od.va.ea("LogSteppedInboundFrameIsEnabled")){const Hj=xi.a.ot(Od.Z.Ca("Common.ICpuMeterProvider"));Hj.continueWith(()=>{const Bf=Od.Z.resolve("ReplicationTelemetry.IInboundMonitor");var Vi=new va.a(()=>!0);Vi=P.a.QB(19,1,Vi);Bf.initialize(Vi);const Lj=Hj.result.Ko.task;Lj.continueWith(()=>
{Lj.result.jyc(0,()=>Bf.Evf,ro=>{Bf.iEm(ro)});Lj.result.jyc(1,ro=>Bf.Lsn(ro),()=>{Bf.hEm()})})})}qa.ULS.sendTraceTag(8257935,305,50,"ReplicationTelemetry init")})});var af=this;J.AFrameworkApplication.QH(()=>{af.Z.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").HTe()})}}dispose(){}static Dwi(){const U=Qe.App.lc;return U?U.iji:0}}Object(c.a)(ic,"ReplicationTelemetryPackage",null,[1,2]);var Ud=b(1194),ae=b(53),He=b(14),lf=b(136),Of=b(3),hf=b(90),rh=b(68),Li=b(219),Jj=b(19),Fg=b(24),
Ni=b(10),di=b(1788);class Il{static get Lf(){return Ye.a.oz(Il.fm,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}Il.fm="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";Object(c.a)(Il,"InsertSymbolsDialogHtml",null,[]);class Jc extends di.a{constructor(U,
Ea,kb){super();this.huc=this.L1a=this.XAb=null;this.rif=0;this.ga=U;this.ib=Ea;this.YAb=kb;this.ee(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.ee(0,CommonUIStrings.l_DialogClose);this.XO=!1;this.Lf=Il.Lf;this.Je="InsertSymbolsDialog"}dispose(){0<Jc.Exf&&qa.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.rif,Jc.Exf);Jc.Dth++;qa.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",Jc.Dth);this.ga=this.YAb=
null;super.dispose()}h9a(){this.Ih(Box4Intl.Box4Strings.L_SymbolSingle,Object(u.a)(this,this.m6l,"insertSymbolsDialogHandler"),null);this.rif=0;Jc.Gth++;qa.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",Jc.Gth);const U=this.ucg("symbol_d_"+Jc.q6c);U&&U.focus()}hide(){var U=document.getElementById("symbolsContainer");if(U&&(U=U.getElementsByTagName("a")))for(let Ea=0;Ea<U.length;Ea++)G.a.removeHandler(U[Ea],w.a.focus,Object(u.a)(this,this.iHj,"symbolFocusHandler"));super.hide()}m6l(U){1===
U?(this.DHg("symbol_d_"+Jc.q6c),this.ib.bG(this.OB,!0),this.ib.rk().Tf.ou(this.Tu),this.Tu.focus()):this.hide()}get EIb(){return Jc.v6c}set EIb(U){Jc.v6c=U}get AIb(){return Jc.i6c}set AIb(U){Jc.i6c=U}rV(){super.rV();var U=document.getElementById("symbolsContainer");if(U&&(U.innerHTML=this.YAb.hJk(),U=U.getElementsByTagName("a")))for(let Ea=0;Ea<U.length;Ea++)G.a.addHandler(U[Ea],w.a.focus,Object(u.a)(this,this.iHj,"symbolFocusHandler"))}Yka(){const U=document.getElementById("symbolsContainer");U&&
(this.XAb||(this.XAb=Object(u.a)(this,this.vBn,"symbolClickHandler"),this.Jl.Ea(w.a.click,U,this.XAb),this.Jl.Ea(w.a.nz,U,this.XAb)),this.L1a||(this.L1a=Object(u.a)(this,this.xBn,"symbolKeyHandler"),this.Cc.Ea(w.a.Nf,U,this.L1a),this.Cc.Ea(w.a.Bn,U,this.L1a),this.Cc.Ea(w.a.Of,U,this.L1a)));super.Yka()}ySa(){const U=document.getElementById("symbolsContainer");U&&(this.XAb&&(this.Jl.kb(w.a.click,U,this.XAb),this.Jl.kb(w.a.nz,U,this.XAb),this.XAb=null),this.L1a&&(this.Cc.kb(w.a.Nf,U,this.L1a),this.Cc.kb(w.a.Bn,
U,this.L1a),this.Cc.kb(w.a.Of,U,this.L1a),this.L1a=null));super.ySa()}OJm(U){this.Zyj("symbol_d_"+Jc.q6c,!1);Jc.q6c=parseInt(U.substr(U.lastIndexOf("_")+1));this.Zyj(U,!0);if(U=document.getElementById("SymbolNameValueLabel")){const Ea=this.Qze(Jc.q6c);U.innerText=Ea.altText}}Qze(U){const Ea=this.YAb.B0e.l9g.value,kb=jh.a(Ea);return Ea[kb[U]]}iHj(U){if(U.target!==this.huc){const Ea=this.ib.rk();Ea&&Ea.Tf&&(Ea.Tf.ou(U.target),this.huc=U.target)}this.OJm(U.target.id)}vBn(U){const Ea=U.Ec;if("a"!==Ea.tagName.toLowerCase())return!1;
U.eventName===w.a.nz&&this.DHg(Ea.id);this.ib.bG(this.OB,!0);this.ib.rk().Tf.ou(Ea);Ea.focus();return!0}xBn(U){var Ea=U.Ec;if("a"!==Ea.tagName.toLowerCase())return!1;const kb=parseInt(Ea.id.substr(Ea.id.lastIndexOf("_")+1));if(U.Ua.ctrlKey||U.Ua.altKey||U.Ua.keyCode>=ng.a.Ewb&&U.Ua.keyCode<=ng.a.z$a)return!1;if(U.eventName===w.a.Nf){U=U.Ua.keyCode;let Nb=-1;U===Sys.UI.Key.enter?(this.DHg(Ea.id),this.ib.bG(this.OB,!0),this.ib.rk().Tf.ou(Ea),Ea.focus()):U===Sys.UI.Key.up?Nb=kb-15:U===Sys.UI.Key.down?
Nb=kb+15:U===Sys.UI.Key.left?Nb=J.AFrameworkApplication.isRtl?kb+1:kb-1:U===Sys.UI.Key.right&&(Nb=J.AFrameworkApplication.isRtl?kb-1:kb+1);0<=Nb&&(Ea=this.ucg("symbol_d_"+Nb))&&Ea.focus()}return!0}DHg(U){this.rif++;Jc.Exf++;U=parseInt(U.substr(U.lastIndexOf("_")+1));const Ea=this.Qze(U),kb={};kb.SourceControlId="symbol_"+U+"_"+Ea.A0e;this.ga.ob(Of.a.Ynb,2,kb);qa.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",U)}ucg(U){const Ea=document.getElementById("symbolsContainer");
return Ea?Ea.querySelector("#"+U):null}Zyj(U,Ea){(U=this.ucg(U))&&(Ea?U.setAttribute("selected","true"):U.removeAttribute("selected"))}}Jc.q6c=0;Jc.v6c=null;Jc.i6c=null;Jc.Gth=0;Jc.Dth=0;Jc.Exf=0;Object(c.a)(Jc,"InsertSymbolsDialog",di.a,[]);class wf{constructor(U,Ea,kb,Nb,nc,ad,Od){this.ga=U;this.mc=Ea;this.fpk=new xb.a(Object(u.a)(this,this.OPl,"getSymbolsDropDownMenuProps"));this.Nb=kb;this.YAb=Nb;this.vn=nc;this.Da=ad;this.Wl=Od}OPl(){return this.YAb.hKk()}lb(){this.ga.Aa(Of.a.zSe,He.a.application,
Object(u.a)(this,this.zSe,"queryInsertSymbols"),96);this.ga.ma(Of.a.TKb,He.a.view,Object(u.a)(this,this.TKb,"populateSymbolsDropDown"));this.ga.ma(Of.a.AXd,He.a.view,Object(u.a)(this,this.kHj,"symbolsDropDownOpenHandler"));this.ga.ma(Of.a.EOd,He.a.view,Object(u.a)(this,this.mij,"querySymbolPositionHandler"));this.ga.ma(Of.a.Ynb,He.a.view,Object(u.a)(this,this.D5a,"insertSymbolViewHandler"));this.ga.ma(Of.a.TKb,He.a.Ub,Object(u.a)(this,this.TKb,"populateSymbolsDropDown"));this.ga.ma(Of.a.AXd,He.a.Ub,
Object(u.a)(this,this.kHj,"symbolsDropDownOpenHandler"));this.ga.ma(Of.a.EOd,He.a.Ub,Object(u.a)(this,this.mij,"querySymbolPositionHandler"));this.ga.ma(Of.a.Ynb,He.a.Ub,Object(u.a)(this,this.l6l,"insertSymbolHandler"));this.ga.$b(Of.a.TKb,1124);this.ga.$b(Of.a.AXd,1036);this.ga.$b(Of.a.EOd,1124);this.ga.$b(Of.a.Ynb,1036);J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("InsertMoreSymbolsIsEnabled")&&(this.ga.ma(Of.a.NIc,He.a.view,Object(u.a)(this,this.ECj,"showInsertMoreSymbolsDialogHandler")),
this.ga.ma(Of.a.NIc,He.a.Ub,Object(u.a)(this,this.ECj,"showInsertMoreSymbolsDialogHandler")),this.ga.$b(Of.a.NIc,1124))}mij(U,Ea,kb,Nb,nc){if(1===kb)return 32;U=this.YAb.Odj(nc);U=String.format(this.YAb.wBn,U.character);nc[Ud.a.InnerHTML]=U;nc[Ud.a.On]=!1;return 32}D5a(U,Ea,kb,Nb,nc){let ad;if(({Tc:ad,selected:Od,D5a:af}=this.dod(Ea,kb,ad,Od,af)).returnValue)return af;var Od=Jj.SelectionEditor.Cd(Od);var af=!0;U=8;kb=this.Nb.Wb(15);kb.Sa(ad.xc);Od||(U=this.ga.rf(Ea,Of.a.ara,2,!0,Nb,null),Ea=32===
U,qa.ULS.shipAssertTag(6407387,348,Ea,"DeleteForReplace did not succeed. Response is {0}",U),af=Ea);af&&(Ea=ad.Oa.Ag,Od=Jj.SelectionEditor.Cd(Ea),qa.ULS.shipAssertTag(6407388,348,Od,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",Ea.contextId),U=8,Od&&(U=this.ga.rf(Ea,Of.a.Ynb,2,!1,Nb,nc),qa.ULS.shipAssertTag(6407389,348,32===U,"Insertion at IP context did not succeed. Response is {0}",U),32===U&&ae.FocusManager.instance().wf(ad.qE)));kb.dispose();return U}dod(U,Ea,
kb,Nb,nc){kb=null;U.view.Yd&&(kb=U.view);Nb=null;if(!kb||!kb.Oa)return k.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",U.toString()),{returnValue:!0,Tc:kb,selected:Nb,D5a:8};Nb=kb.Oa.Ag;if(!Nb)return{returnValue:!0,Tc:kb,selected:Nb,D5a:2};if(this.vn.E3(Nb))return{returnValue:!0,Tc:kb,selected:Nb,D5a:8};if(kb.Oa.ya.EE||this.Wl&&this.Wl.instance&&this.Wl.instance.l0(Nb)||Jj.SelectionEditor.JIa(U.Am))return{returnValue:!0,
Tc:kb,selected:Nb,D5a:2};if(wf.jg.h9(Ni.ParagraphReader.wS,Nb))return nc=8,wf.Lb.mb(hf.a.af,{["Reason"]:rh.a.qP}),{returnValue:!0,Tc:kb,selected:Nb,D5a:nc};nc=32;return 1===Ea?{returnValue:!0,Tc:kb,selected:Nb,D5a:nc}:{returnValue:!1,Tc:kb,selected:Nb,D5a:nc}}l6l(U,Ea,kb,Nb,nc){if(1===kb)return 32;if(Jj.SelectionEditor.JIa(Ea))return 2;U=this.YAb.Odj(nc);Nb.vq=U.index;Nb=this.mc.Dg(Ea.node);kb=Nb.La(11);qa.ULS.shipAssertTag(6379466,324,kb,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",
lf.a[Ea.node.type]);kb=this.Nb.Wb(15);kb.Ir(Nb);wf.characterPropertiesEditor.replaceTextRange(Ea,U.character,!0,!1);Ea=Fg.SelectionFactory.Pc(Nb.currentNode,Ea.cpBegin+1);this.Da.setSelection(Ea);kb.dispose();return 32}TKb(U,Ea,kb,Nb,nc){if(1===kb)return 32;nc.MenuItems=this.fpk.value;return 32}kHj(U,Ea,kb){let Nb,nc,ad;({Tc:Nb,selected:nc,D5a:ad}=this.dod(Ea,kb,Nb,nc,ad));return ad}ECj(U,Ea,kb){2===kb&&(new Jc(this.ga,ae.FocusManager.instance(),ia.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).h9a();
return 32}zSe(){return 32}static get characterPropertiesEditor(){return wf.hc||(wf.hc=ia.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(U){wf.hc=U}static get jg(){return Li.ContextSetEditor.instance}static get Lb(){return Eg.a.instance}}wf.hc=null;Object(c.a)(wf,"SymbolsActor",null,[1762]);class Ze{constructor(U,Ea){this.A0e=U;this.altText=Ea}}Object(c.a)(Ze,"Symbol",null,[]);class Yh{constructor(){this.nwf=null;this.jPh=new xb.a(Yh.xSf)}get l9g(){return this.jPh}izi(U){this.nwf||
(this.nwf=jh.a(this.jPh.value));return Array.indexOf(this.nwf,U)}static xSf(){const U={};U["\u2022"]=new Ze("\u2022",Box4Intl.Box4Strings.L_Bullet);U["\u20ac"]=new Ze("\u20ac",Box4Intl.Box4Strings.L_EuroSign);U["\u00a3"]=new Ze("\u00a3",Box4Intl.Box4Strings.L_PoundSign);U["\u00a5"]=new Ze("\u00a5",Box4Intl.Box4Strings.L_YenSign);U["\u00a9"]=new Ze("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);U["\u00ae"]=new Ze("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);U["\u2122"]=new Ze("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);
U["\u00b1"]=new Ze("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);U["\u2260"]=new Ze("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);U["\u2264"]=new Ze("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);U["\u2265"]=new Ze("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);U["\u00f7"]=new Ze("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);U["\u00d7"]=new Ze("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);U["\u221e"]=new Ze("\u221e",Box4Intl.Box4Strings.L_Infinity);U["\u00b5"]=new Ze("\u00b5",Box4Intl.Box4Strings.L_MicroSign);
U["\u03b1"]=new Ze("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);U["\u03b2"]=new Ze("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);U["\u03c0"]=new Ze("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);U["\u03a9"]=new Ze("\u03a9",Box4Intl.Box4Strings.L_OhmSign);U["\u03a3"]=new Ze("\u03a3",Box4Intl.Box4Strings.L_NArySummation);U["\u00b0"]=new Ze("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);U["\u0394"]=new Ze("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);U["\u263a"]=new Ze("\u263a",
Box4Intl.Box4Strings.L_WhiteSmilingFace);U["\u2665"]=new Ze("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);U["\u20b9"]=new Ze("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);U["\u00bf"]=new Ze("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);U["\u00a1"]=new Ze("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);U["\u2014"]=new Ze("\u2014",Box4Intl.Box4Strings.L_EmDash);U["\u2026"]=new Ze("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);U["\u00c0"]=new Ze("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);
U["\u00c1"]=new Ze("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);U["\u00c2"]=new Ze("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);U["\u00c3"]=new Ze("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);U["\u00c4"]=new Ze("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);U["\u00c5"]=new Ze("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);U["\u00c6"]=new Ze("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);U["\u00c7"]=
new Ze("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);U["\u00c8"]=new Ze("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);U["\u00c9"]=new Ze("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);U["\u00ca"]=new Ze("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);U["\u00cb"]=new Ze("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);U["\u00cc"]=new Ze("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);U["\u00cd"]=new Ze("\u00cd",
Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);U["\u00ce"]=new Ze("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);U["\u00cf"]=new Ze("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);U["\u00d1"]=new Ze("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);U["\u00d2"]=new Ze("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);U["\u00d3"]=new Ze("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);U["\u00d4"]=new Ze("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);
U["\u00d5"]=new Ze("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);U["\u00d6"]=new Ze("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);U["\u00d9"]=new Ze("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);U["\u00da"]=new Ze("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);U["\u00db"]=new Ze("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);U["\u00dc"]=new Ze("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);U["\u00df"]=
new Ze("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);U["\u00e0"]=new Ze("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);U["\u00e1"]=new Ze("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);U["\u00e2"]=new Ze("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);U["\u00e3"]=new Ze("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);U["\u00e4"]=new Ze("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);U["\u00e5"]=new Ze("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);
U["\u00e6"]=new Ze("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);U["\u00e7"]=new Ze("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);U["\u00e8"]=new Ze("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);U["\u00e9"]=new Ze("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);U["\u00ea"]=new Ze("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);U["\u00eb"]=new Ze("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);U["\u00ec"]=new Ze("\u00ec",
Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);U["\u00ed"]=new Ze("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);U["\u00ee"]=new Ze("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);U["\u00ef"]=new Ze("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);U["\u00f1"]=new Ze("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);U["\u00f2"]=new Ze("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);U["\u00f3"]=new Ze("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);
U["\u00f4"]=new Ze("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);U["\u00f5"]=new Ze("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);U["\u00f6"]=new Ze("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);U["\u00f9"]=new Ze("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);U["\u00fa"]=new Ze("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);U["\u00fb"]=new Ze("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);U["\u00fc"]=new Ze("\u00fc",
Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);U["\u00ff"]=new Ze("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);U["\u011e"]=new Ze("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);U["\u011f"]=new Ze("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);U["\u0130"]=new Ze("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);U["\u0131"]=new Ze("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);U["\u0152"]=new Ze("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);
U["\u0153"]=new Ze("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);U["\u015e"]=new Ze("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);U["\u015f"]=new Ze("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);U["\u0178"]=new Ze("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return U}}Object(c.a)(Yh,"SymbolsLoader",null,[1761]);var en=b(410),wi=b(337),Uj=b(216),Dd=b(607),Kd=b(1272),Qd=b(230),Bd=b(97);class Ei{constructor(U){this.B0e=U}get wBn(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}Odj(U){U=
U.SourceControlId.split("_");const Ea={};2===U.length?(Ea.character=U[1],Ea.index=this.B0e.izi(Ea.character)):(Ea.character=U[2],Ea.index=parseInt(U[1]));return Ea}hKk(){return this.LEi()}build(){return this.PPl()}hJk(){const U=new Sys.StringBuilder;U.append('<table class="moreSymbolsTable">');const Ea=this.B0e.l9g.value,kb=jh.a(Ea);let Nb=0;for(;Nb<kb.length;){Nb%15||U.append('<tr role="presentation">');const nc=Ea[kb[Nb]];U.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+Nb,bc.a.FI(nc.A0e),bc.a.FI(nc.altText)));Nb++;Nb%15&&Nb!==kb.length||U.append("</tr>")}U.append("</table>");return U.toString()}PPl(){const U=this.LEi();return Qd.t(U)}LEi(){const U=Object.assign(new en.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});U.MenuSectionList.push(this.Twk());J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("InsertMoreSymbolsIsEnabled")&&U.MenuSectionList.push(this.Bvk());return U}Bvk(){const U=Object.assign(new wi.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",
ControlsId:"ctrlMoreSymbols",ControlList:[]}),Ea=Object.assign(new Uj.a,{Id:"btnMoreSymbols",Command:Of.a.NIc.toString(),LabelText:bc.a.Vd(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:bc.a.Vd(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:J.AFrameworkApplication.ln,Image16by16Class:Bd.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});U.ControlList.push(Ea);return U}Twk(){const U=Object.assign(new wi.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),
Ea=Object.assign(new Dd.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),kb=this.B0e.l9g.value,Nb=jh.a(kb),nc=Math.min(25,Nb.length);for(let Od=0;Od<nc;Od++){var ad=kb[Nb[Od]];ad=Object.assign(new Kd.a,{Id:String.format("{0}{1}_{2}","symbol_",Od,ad.A0e),Character:ad.A0e,Command:Of.a.Ynb.toString(),QueryCommand:Of.a.EOd.toString(),Alt:bc.a.Vd(ad.altText)});Ea.GalleryItems.push(ad)}U.ControlList.push(Ea);
return U}}Object(c.a)(Ei,"SymbolsUiBuilder",null,[1760]);var mo=b(49),Lg=b(231),co=b(644),Ch=b(367);class vk{constructor(){this.Z=null}get name(){return"Box4.Symbols"}init(){J.AFrameworkApplication.K.ea("InsertSymbolIsEnabled")&&this.Z.resolve("Box4.Symbols.ISymbolsActor").lb()}dispose(){}Hb(U){this.Z=U;this.Z.register(Yh,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").singleInstance();this.Z.ha("Box4.Symbols.SymbolsUiBuilder",()=>new Ei(this.Z.resolve("Box4.Symbols.ISymbolsLoader"))).as("Box4.Symbols.ISymbolsUIBuilder").singleInstance();
this.Z.ha("Box4.Symbols.SymbolsActor",()=>new wf(J.AFrameworkApplication.pa,new co.a,new Ch.a,this.Z.resolve("Box4.Symbols.ISymbolsUIBuilder"),Lg.a.instance,mo.a.instance,this.Z.Ca("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").singleInstance()}static main(){ba.a.instance.Sb(new vk)}}Object(c.a)(vk,"Box4SymbolsPackage",null,[1,2]);var qf=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",
Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},Mm=b(1444),Mh=b(1393),uo=b(1377),Ff=b(1713),ye=b(238),hg=b(408);class fe{constructor(){this.container=this.c_a=null}Hb(U){this.container=U}init(){this.c_a=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.c_a&&this.c_a.dispose()}}Object(c.a)(fe,"ALiveBooksAccessibilityCheckPackageManager",
null,[1,2]);class Mb{get KXk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get LXk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get MXk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get GMm(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get CKb(){return CommonUIStrings.l_AccCheckerPaneTitle}get zPm(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}Object(c.a)(Mb,"AccessibilityCheckStringsProvider",null,
[56]);class Nh{constructor(){this.Gsj=this.contentId=null}}Object(c.a)(Nh,"ResultIds",null,[]);class zg{constructor(U,Ea){this._element=null;this.ag=Ea;this.Cc=U}get element(){this._element||(this._element=this.y0k(),this.jC());return this._element}GUd(U){this._element=U}dispose(){this.element&&(this.jia(),this.GUd(null))}jC(){this.ag&&this.Cc?(this.ag.Ea(w.a.click,this.element,Object(u.a)(this,this.onClick,"onClick")),this.Cc.Ea(w.a.Nf,this.element,Object(u.a)(this,this.GK,"onKeyPress"))):qa.ULS.shipAssertTag(19789026,
334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}jia(){this.ag&&this.Cc&&(this.ag.kb(w.a.click,this.element,Object(u.a)(this,this.onClick,"onClick")),this.Cc.kb(w.a.Nf,this.element,Object(u.a)(this,this.GK,"onKeyPress")))}onClick(){this.eOe();return!0}GK(U){return this.Tbm(U.Ua.keyCode)?(this.eOe(),!0):!1}Tbm(U){return U===ng.a.cpc||U===ng.a.Ms}}Object(c.a)(zg,"AInteractivePaneElement",null,[714,12]);var aj=b(436),
oh=b(54);class Pk extends zg{constructor(U,Ea,kb){super(U,Ea);this.Zof=kb}hide(){this.element.removeAttribute(Wb.a.ig);Wb.a.Qq(this.element,Wb.a.Xu,Wb.a.Rm);this.element.style.display="none"}show(){Wb.a.Qq(this.element,Wb.a.Xu,Wb.a.yL);Wb.a.Qq(this.element,Wb.a.ig,Wb.a.Ihd);this.element.style.display="block"}y0k(){const U=aj.b("div",this.W6i,"AccCheckerNotification");Wb.a.Qq(U,Wb.a.bke,Wb.a.Rm);Wb.a.Qq(U,Wb.a.m3,this.JEg);U.tabIndex=0;const Ea=aj.b("span",this.V6i,"AccCheckerNotificationIcon");var kb=
Bd.createClusteredImage(16,16,"Info_16x16x32","",!0,"");Ea.appendChild(kb);kb=aj.b("span",this.JEg,"AccCheckerNotificationText");oh.a.dA(kb,this.X6i);U.appendChild(Ea);U.appendChild(kb);return U}eOe(){this.Zof()}}Object(c.a)(Pk,"APopupNotification",zg,[754,714,12]);class Ck extends Pk{constructor(U,Ea,kb,Nb){super(U,Ea,kb);this.cGa=Nb}get W6i(){return"AccCheckerOutOfSyncNotificationId"}get V6i(){return"AccCheckerOutOfSyncNotificationIconId"}get JEg(){return"AccCheckerOutOfSyncNotificationTextId"}get X6i(){return this.cGa.GMm}}
Object(c.a)(Ck,"OutOfSyncNotification",Pk,[]);class ck extends Pk{constructor(U,Ea,kb,Nb){super(U,Ea,kb);this.cGa=Nb}get W6i(){return"AccCheckerPartialResultNotificationId"}get V6i(){return"AccCheckerPartialResultNotificationIconId"}get JEg(){return"AccCheckerPartialResultNotificationTextId"}get X6i(){return this.cGa.zPm}}Object(c.a)(ck,"PartialResultNotification",Pk,[]);var gi=b(151),xj=b(131),Qh=b(35),Yl=b(168);class og{constructor(U,Ea,kb,Nb=null,nc=null,ad=null,Od=null){this.OLh=this.JC=this.Cc=
this.c_a=null;this.mBa=Nb;this.ag=U;this.ib=Ea;this.Bq=kb;this.cGa=Od||new Mb;this.Epf=nc||new Ck(this.mBa,this.ag,Object(u.a)(this,this.aal,"dimissOutOfSyncNotification"),this.cGa);this.tqf=ad||new ck(this.mBa,this.ag,Object(u.a)(this,this.bal,"dimissPartialResultNotification"),this.cGa)}show(){}hide(){}get mBa(){return this.Cc||(this.Cc=J.AFrameworkApplication.la.oB)}set mBa(U){this.Cc=U}Ibi(){}jAa(){}dispose(){}wvb(){}C7l(U){var Ea=this.OLh[U];U=Ea.contentId;if((Ea=Ea.Gsj+"")&&Ea.length){const kb=
[];Array.add(kb,Object.assign(new Qh.a,{name:"RuleID",string:Ea}));xj.a.sendTelemetryEvent(Object.assign(new Yl.a,{name:String.format("{0}.{1}",og.s$g,"ViolationSelected"),dataFields:kb}))}this.Kym(U)}Kym(U){U&&this.c_a.ykn(U)||(this.ib.bG(gi.AFrame.Tzf,!1),this.oun())}aal(){this.CVd(!1)}bal(){this.wCj(!1)}oun(){const U=Object.assign(new Xd.StandardDialog(!0),{Hq:J.AFrameworkApplication.kY,wc:1,roa:!1});U.j5(1);U.ee(1,this.cGa.KXk);U.ee(0,CommonUIStrings.l_DialogCancel);U.kT(this.cGa.MXk,this.cGa.LXk,
Ea=>{1===Ea&&this.Ilg()})}mKk(U){let Ea=null;if(U.Results&&0<U.Results.length){Ea={};let kb=0;for(const Nb of U.Results)Nb.ResultId=og.Dsk+ ++kb,U=new Nh,U.contentId=Nb.ContentId,U.Gsj=Nb.RuleId,Ea[Nb.ResultId]=U}return Ea}Xqm(){xj.a.addNamespaceMapping(og.s$g,og.JCn);xj.a.sendTelemetryEvent(Object.assign(new Yl.a,{name:String.format("{0}.{1}",og.s$g,"ShowTaskpane")}))}}og.Dsk="AccCheckResult";og.s$g="Office.UX.AccChecker";og.JCn="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";
Object(c.a)(og,"BaseAccessibilityCheckPane",null,[57,12]);class em{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(c.a)(em,"AccCheckerTaskPaneProps",null,[]);var Kb=b(1208),Hp=b(1652),zd=b(1380),ie=b(191);class Gi extends og{constructor(U,Ea,kb,Nb,nc=null,ad=null,Od,af=null,
ve=null){super(Ea,kb,Nb,ad,void 0,void 0,af);this.vnh=null;this.NKh=this.sqf=this.ibe=this.Mde=this.qde=!1;this.zyf=null;this.Mwf=!!J.AFrameworkApplication.la&&!!J.AFrameworkApplication.la.eb&&J.AFrameworkApplication.la.eb.yHe;this.$ef=this.Oda=null;this.$gf=0;this.Nyh=null;this.oZ=nc;ve&&(this.Oda=ve.LZn,this.$ef=ve.n2n,this.$gf=ve.C3n);this.YD=new Hp.a}get isVisible(){return this.NKh}VKa(U){this.NKh=U}rXf(U){U&&(this.vnh=U,U.IsSuccess&&(this.OLh=this.mKk(U),U.IsPartialResult&&this.wCj(!0)),this.qde=
!0,this.Mde=!1,this.Mw())}CVd(U){this.isVisible&&U!==this.ibe&&(this.ibe=U,this.Mw())}wCj(U){this.sqf=U;this.Mw()}HV(){this.Mde||ie.UISurfaces.Nv().then(U=>{ha.a.instance.Vs(Gi.UPb+":PaneOpen:Start");U.showTaskPane(Gi.UPb,this.GF());this.Ilg();return null});this.isVisible?ie.UISurfaces.Nv().then(U=>{U.setSelectedTaskPane(Gi.UPb);return null}):this.Xqm()}Mw(){ie.UISurfaces.Nv().then(U=>{U.updateTaskPane(Gi.UPb,this.GF());return null})}GF(){var U=new em;this.YD.klc(U);U=Object.assign(new zd.a,{title:this.cGa.CKb,
hideHeader:!1,width:320,location:2,contentProps:U,onOpen:()=>{this.Fha();this.VKa(!0);J.AFrameworkApplication.la.updateCommandUI()},onClose:()=>{this.hoa();this.VKa(!1);this.Mde=this.qde=!1;this.Mw();J.AFrameworkApplication.la.updateCommandUI()},isModernPane:!0});this.Mwf&&(U.enableResize=!0,U.minResizeWidth=268,U.maxResizeWidth=920);return U}initialize(U){const Ea=this.ib.Kc(Gi.UPb);Ea.parent=gi.AFrame.hp;Ea.uK=!0;this.c_a=U;this.stk()}dispose(){this.wvb();this.Epf&&(this.Epf.dispose(),this.Epf=
null);this.tqf&&(this.tqf.dispose(),this.tqf=null);super.dispose()}stk(){this.YD.vQ(this.onRecheckExecute());this.YD.vQ(this.vql());this.YD.vQ(this.qMl());this.YD.vQ(this.onInvokeNavigateExecute());this.YD.vQ(this.YBl());this.YD.vQ(this.hIl());this.YD.vQ(this.TJl());this.YD.vQ(this.updateLastScanTime());this.YD.vQ(this.showHelpPane())}onRecheckExecute(){return U=>{U.onRecheckExecute=()=>{this.Ilg()}}}vql(){return U=>{U.accessibilityCheckResultCollection=this.vnh}}qMl(){return U=>{U.resultsReady=this.qde}}onInvokeNavigateExecute(){return U=>
{U.onInvokeNavigateExecute=Ea=>{this.C7l(Ea)}}}YBl(){return U=>{U.helpLink=this.eil}}hIl(){return U=>{U.outOfSync=this.ibe}}TJl(){return U=>{U.partialResult=this.sqf}}updateLastScanTime(){return U=>{U.updateLastScanTime=Ea=>{this.zyf=Ea}}}showHelpPane(){return U=>{U.showHelpPane=()=>{if(this.oZ&&this.oZ.value){const kb=this.oZ.value;if(kb){var Ea={};Ea.query=Gi.rkk+Gi.Hak;Ea=Object.assign(new Kb.a,{N4:Ea});kb.qoa(Gi.Zgf,Ea)}}else this.Nyh?this.Nyh():this.Oda.value&&this.$ef&&this.$gf&&this.Oda.value.ob(this.$gf,
2,this.$ef)}}}Ilg(){this.sqf=this.ibe=this.qde=!1;this.zyf&&this.zyf();this.Mw();this.Mde=!0;this.c_a.oDm()}Fha(){this.ib.wf(Gi.UPb)}hoa(){this.jpb()&&this.ib.wf(this.ib.uI)}jpb(){return!!this.ib.Zd&&this.ib.Zd.name===Gi.UPb}}Gi.UPb="AccessibilityCheckerPane";Gi.Hak="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";Gi.Zgf="FA000000012";Gi.rkk="AssetID=";Object(c.a)(Gi,"ReactAccessibilityCheckPane",og,[]);class Ag extends Gi{constructor(U,Ea,kb,Nb,nc,ad,Od,af,ve=null){super(U,Ea,kb,Nb,nc,ad,void 0,ve);this.L8j=
af;this.YW=Od}get eil(){return this.L8j}HV(){this.YW.t3a();super.HV()}}Object(c.a)(Ag,"ReactLiveBooksAccessibilityCheckPane",Gi,[]);var dh=b(1575),Xc=b(123),ug=b(171),wk=b(77),dk=b(158),To=b(484),Jl;(function(U){U[U.error=0]="error";U[U.warning=1]="warning";U[U.tip=2]="tip";U[U.intelligentService=3]="intelligentService"})(Jl||(Jl={}));Object(c.b)("AccessibilityRuleCategory",Jl);class Cl{constructor(U,Ea,kb=null){this.b8e=null;this.GBh=this.NAh=!1;this.c2a=U;this.N2d=Ea;this.ga=kb;this.Tb.ma(za.a.Q7h,
Je.a.frame,Object(u.a)(this,this.VMf,"closePane"))}get Tb(){return this.ga||(this.ga=J.AFrameworkApplication.pa)}set Tb(U){this.ga=U}qfl(){this.NAh||(this.c2a.initialize(this),this.N2d.initialize(this),this.NAh=!0)}oDm(){k.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.N2d.Gdn()}HV(U,Ea,kb){if(1===kb)return pf.SessionStatusManager.instance.oj?8:32;this.c2a.isVisible||this.qfl();this.Fvn();return 32}VMf(U,Ea,kb){1!==kb&&this.c2a.jAa();return 32}VIg(){this.c2a.CVd(!0)}rXf(U){if(U){if(U.AccessibilityRules&&
Object.keys(U.AccessibilityRules).length){const kb=U.AccessibilityRules;for(let Nb in kb){var Ea=Nb;const nc=kb[Nb].RuleId+"";Ea!==nc&&k.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",Ea,nc)}this.b8e=kb}else!this.b8e&&U.Results&&0<U.Results.length?(k.b(18993251,200,15,"No accessibility rule definitions available"),U.IsSuccess=!1):U.AccessibilityRules=this.b8e;U.IsSuccess||k.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.G6m(U);this.Hqm(U);this.c2a.rXf(U)}}G6m(U){const Ea=
U.AccessibilityRules;if(U=U.Results)for(let kb=U.length-1;0<=kb;kb--){const Nb=U[kb];let nc="";const ad=Nb.RuleId;Nb.ContentName||(nc+="Result does not have content name. ");ad in Ea||(nc+=String.format("No accessibility check rule exists for ID {0}.",ad));0<nc.length&&(k.b(36214999,200,15,"Omitting invalid accessibility check result: "+nc),Array.removeAt(U,kb))}}tNl(){return J.AFrameworkApplication.K.ea("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):
ia.a.instance.resolve("Common.IDynamicScriptLoaderProvider").uG.loadScript("accessibility-checker-pane-strings")}Fvn(){this.GBh?this.c2a.HV():this.tNl().then(()=>{this.GBh=!0;this.c2a.HV()}).catch(U=>qa.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",U))}Hqm(U){var Ea={};const kb={};var Nb=U.Results,nc=[];Array.add(nc,Object.assign(new Qh.a,{name:"FinalViolationCount",int64:0}));Array.add(nc,Object.assign(new Qh.a,{name:"FinalErrorCount",
string:"0"}));Array.add(nc,Object.assign(new Qh.a,{name:"FinalWarningCount",string:"0"}));Array.add(nc,Object.assign(new Qh.a,{name:"FinalTipCount",string:"0"}));Array.add(nc,Object.assign(new Qh.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Nb){for(const af of Nb)if(U.AccessibilityRules){var ad=U.AccessibilityRules[af.RuleId];if(ad){if(Ea[Jl[ad.Category]]){let ve=Ea[Jl[ad.Category]];Ea[Jl[ad.Category]]=++ve}else Ea[Jl[ad.Category]]=1;kb[af.RuleId]?(ad=kb[af.RuleId],kb[af.RuleId]=++ad):
kb[af.RuleId]=1}}nc[0].int64=Nb.length;for(var Od in Ea)switch(U=Ea[Od],Nb=Od,Nb="Final"+Nb.charAt(0).toUpperCase()+Nb.substring(1,Nb.length)+"Count",Nb){case "FinalErrorCount":nc[1].string=U.toString();break;case "FinalWarningCount":nc[2].string=U.toString();break;case "FinalTipCount":nc[3].string=U.toString();break;case "FinalIntelligentServiceCount":nc[4].string=U.toString()}}xj.a.sendTelemetryEvent(Object.assign(new Yl.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),
dataFields:nc}));for(let af in kb)Ea=af,nc=kb[af],Od=[],Array.add(Od,Object.assign(new Qh.a,{name:"RuleID",string:Ea})),Array.add(Od,Object.assign(new Qh.a,{name:"FinalViolationCount",string:nc.toString()})),xj.a.sendTelemetryEvent(Object.assign(new Yl.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Od}))}dispose(){this.c2a&&this.c2a.dispose();this.N2d&&this.N2d.dispose()}}Object(c.a)(Cl,"AAccessibilityCheckManager",null,[55,12]);var Qk=b(435);
class Wf extends Cl{constructor(U,Ea,kb){super(Ea,kb,U);this.graph=null}pij(U,Ea,kb,Nb,nc){if(1===kb)return 32;nc[Qk.a.On]=this.c2a.isVisible;return 32}V3m(){for(const U of this.H6i){const Ea=this.graph.Oe(U);Ea.tq(Object(u.a)(this,this.Pf,"onPropertyChanged"));Ea.Rt(Object(u.a)(this,this.LI,"onConnected"));Ea.vy(Object(u.a)(this,this.RJd,"onDisconnected"))}}KJn(){for(const U of this.H6i){const Ea=this.graph.Oe(U);Ea.W0(Object(u.a)(this,this.Pf,"onPropertyChanged"));Ea.wQ(Object(u.a)(this,this.LI,
"onConnected"));Ea.Hta(Object(u.a)(this,this.RJd,"onDisconnected"))}}dispose(){super.dispose();this.KJn()}Pf(){this.VIg()}LI(){this.VIg()}RJd(){this.VIg()}}Object(c.a)(Wf,"ALiveBooksAccessibilityCheckManager",Cl,[]);class Ho extends Wf{constructor(U,Ea,kb,Nb,nc,ad){super(U,Ea,kb);this.Tb.ma(za.a.oZe,Je.a.frame,Object(u.a)(this,this.HV,"showPane"));this.Tb.Aa(za.a.oij,Je.a.frame,Object(u.a)(this,this.pij,"queryToggleAccCheckerPane"),96);this.graph=nc;this.kgk=Nb;this.kdk=ad;this.V3m()}get H6i(){return[12,
14,22,19,30,43,44]}ykn(U){if(this.kdk)return qa.ULS.sendTraceTag(20713608,334,15,"ODT file. Disable content navigation."),!0;qa.ULS.shipAssertTag(20272215,334,!!U);return this.kgk.Gym(U)}}Object(c.a)(Ho,"WordAccessibilityCheckManager",Wf,[]);var fn=b(88),Rk=b(30),oj=b(122),pb=b(21),pc=b(174),Tc=b(6),bd=b(20),Qb=b(461);class be{constructor(U,Ea,kb,Nb,nc,ad,Od){this.sq=null;this.i6b=0;this.mc=Ea;this.vA=kb;this.Da=Nb;this.ga=nc;this.ic=ad;this.xs=U;this.Ic=Od}get gZ(){if(!this.sq){const U=this.mc.Dg(this.xs.jc);
this.vA.J2e(U);if(U.La(7)||U.tc(7))this.sq=fn.a.Yo(U,U.origin)}return this.sq}Gym(U){if(!U||!U.zf||0>=U.zf.length)return qa.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var Ea=Array(U.zf.length);let kb=7,Nb=null;for(let ad=0;ad<U.zf.length;ad++)if(Nb=this.Skl(U.zf[ad])){if(7===kb)kb=this.i6b;else if(kb!==this.i6b)return qa.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),!1;var nc=this.Ic.F7a(Nb.characterData,Nb.ja);
const Od=U.cpBegin?this.Ic.G5b(nc,U.cpBegin):-1;nc=U.cpEnd?this.Ic.G5b(nc,U.cpEnd):-1;if(-1>Od||-1>nc)return qa.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;Ea[ad]=Rk.a.NR(Od,nc,!1,Nb);switch(U.contentType){case 5:if(!oj.HyperlinkReader.igg(Ea[ad],!1))return!1;break;case 6:if(!pb.ImageReader.m0(Ea[ad]))return!1;break;case 7:Ea[ad]=Rk.a.NR(-1,-1,!1,Nb)}}else return!1;Ea=new pc.Selection(Ea,!1);return this.ron(Nb,Ea,U.contentType)}Skl(U){if(this.gZ)for(this.gZ.reset(),
this.i6b=7;this.gZ.moveNext();){var Ea=this.gZ.currentNode.type;if(38===Ea||36===Ea||23===Ea)this.i6b=Ea;else if(12===Ea){Ea=this.gZ.currentNode;const kb=Ea.fa(Tc.a.Ob,0);if(U===kb)return Ea}}return null}i9g(U){this.ga.processAction(bd.a.e7,2);this.ga.processAction(bd.a.fra,2);let Ea=2;switch(this.i6b){case 23:Ea=32;break;case 38:Ea=this.ga.ob(bd.a.mKb,2,new Qb.a(U));break;case 36:Ea=this.ga.ob(bd.a.$dc,2,new Qb.a(U));break;default:qa.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",
this.i6b)}if(32===Ea)return!0;qa.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.i6b);return!1}ron(U,Ea,kb){if(this.i9g(U)){U=this.xs.tw;const Nb=this.Da.ya.Ba;Nb&&Nb.equals(Ea)&&this.ic.Nha(U,null);this.ic.Nha(U,Ea);switch(kb){case 0:case 1:this.ga.processAction(Of.a.PXa,2);break;case 2:this.ga.processAction(Of.a.FRc,2);break;case 3:this.ga.processAction(Of.a.yha,2)}return!0}return!1}}Object(c.a)(be,"WordAccessibilityCheckNavigateManager",null,[1794]);class Me{constructor(U){this.c_a=
null;this.zxh=U}get fileId(){return this.zxh?this.zxh():null}initialize(U){this.c_a=U}N8i(U){this.c_a.rXf(U)}}Object(c.a)(Me,"AAccessibilityCheckService",null,[58,12]);class tf{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(U){U=Sys.Serialization.JavaScriptSerializer.deserialize(U);const Ea=U.AccessibilityRules,kb={};if(Ea)for(let Nb=0;Nb<Ea.length;++Nb){const nc=Ea[Nb];kb[nc.Key]=nc.Value}U.AccessibilityRules=kb;return U}}Object(c.a)(tf,
"AccessibilityCheckResultCollection",null,[]);class uf extends Me{constructor(U){super(U)}onFailure(U,Ea){qa.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",Ea);U=Object.assign(new tf,{IsSuccess:!1});this.N8i(U)}onSuccess(U){U=uf.oMl(U);let Ea=null;if(U)try{Ea=this.t9k(U)}catch(kb){qa.ULS.shipAssertTag(20730843,334,!1,"AccChecker response data is invalid. [{0}]",kb.message),Ea=Object.assign(new tf,{IsSuccess:!1})}else qa.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),
Ea=Object.assign(new tf,{IsSuccess:!1});this.N8i(Ea)}dispose(){}static oMl(U){let Ea=null;U&&U.xj&&(Ea=U.xj[0]);return Ea?Ea.Body:null}}Object(c.a)(uf,"ALiveBooksAccessibilityCheckService",Me,[]);var Xf=b(954),Re=b(228);class bg extends Re.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1}Jk(){return 56}static construct(U,Ea){const kb=new bg;kb.FileId=U;kb.IsCoauthorable=Ea;return kb}}Object(c.a)(bg,"WordAccessibilityCheckRequest",Re.a,[]);class Qf{}Object(c.a)(Qf,"AccessibilityCheckRule",
null,[]);var vh=b(141);class al{static parse(U){switch(bc.a.He(U)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw U=String.format("Invalid Accessibility result category: {0}",U),vh.a.argument(U);}}}Object(c.a)(al,"AccessibilityRuleCategoryParser",null,[]);class Fh{constructor(){this.Category=this.Text=this.Id=null}static sEn(U){const Ea=new Qf;Ea.RuleId=U.Id;Ea.RuleName=U.Text;Ea.Category=al.parse(U.Category);return Ea}}Object(c.a)(Fh,
"WordAccessibilityCheckRule",null,[]);class rf{}Object(c.a)(rf,"AccessibilityCheckResult",null,[]);class Vd{constructor(){this.cpEnd=this.cpBegin=this.zf=null;this.contentType=0}}Object(c.a)(Vd,"WordAccessibilityCheckContentId",null,[]);const lh=U=>{switch(bc.a.He(U)){case "tableheading":return 0;case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;case "anchoredepicture":return 7;default:return 8}};
var Sg=b(1406);class un{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static qEn(U){const Ea=new rf;Ea.RuleId=U.RuleId;Ea.ContentName=U.Label;const kb=new Vd;kb.zf=U.ParaId;kb.cpBegin=Sg.b(U.OS);kb.cpEnd=Sg.b(U.OE);kb.contentType=lh(U.ContentType);Ea.ContentId=kb;return Ea}}Object(c.a)(un,"WordAccessibilityViolation",null,[]);class tl{constructor(){this.Violations=this.Rules=null}static rEn(U){const Ea=new tf;try{var kb={};if(U.Rules){for(let Nb=0;Nb<U.Rules.length;++Nb){const nc=
Fh.sEn(U.Rules[Nb]);kb[nc.RuleId]=nc}Ea.AccessibilityRules=kb}if(U.Violations){const Nb=Array(U.Violations.length);for(kb=0;kb<U.Violations.length;++kb)Nb[kb]=un.qEn(U.Violations[kb]);Ea.Results=Nb}Ea.IsPartialResult=!1;Ea.IsSuccess=!0}catch(Nb){qa.ULS.shipAssertTag(20272214,334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",Nb.message),Ea.IsSuccess=!1}return Ea}}Object(c.a)(tl,"WordAccessibilityCheckResult",null,[]);class bj extends uf{constructor(U,
Ea,kb){super(U);this.Qsc=Ea;this.pVb=kb}Gdn(){const U=Object.assign(new Xf.a,{Pq:bg.construct(this.fileId,this.pVb),status:1,RE:"AccessibilityCheck"});this.Qsc(12,!1,Object(u.a)(this,this.onSuccess,"onSuccess"),Object(u.a)(this,this.onFailure,"onFailure"),U,null,U)}t9k(U){U=ra.b(U);return tl.rEn(U)}}Object(c.a)(bj,"WordAccessibilityCheckService",uf,[]);class Uo extends fe{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}Hb(U){super.Hb(U);U.ha("Common.App.AccessibilityChecker.IAccessibilityCheckPane",
()=>new Ag(J.AFrameworkApplication.pa,ye.a.instance,ae.FocusManager.instance(),hg.a.instance,U.vf("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Ga.KeyInputManager.instance,dh.a.instance,J.AFrameworkApplication.K.Ga("AccessibilityCheckerHelpUrl"))).singleInstance();U.ha("Common.App.AccessibilityChecker.IAccessibilityCheckService",()=>new bj(()=>J.AFrameworkApplication.rootQuerySignature,To.a.LX,Xc.PageReader.instance.$ud(Qe.App.oa.za.jc))).singleInstance();U.ha("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",
()=>new be(Qe.App.oa.za,U.resolve("Box4.Graph.IGraphIteratorFactory"),ug.PageNavigator.instance,U.resolve("Box4.ISelectionManager"),J.AFrameworkApplication.pa,wk.InteractiveViewManager.instance,U.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).singleInstance();U.ha("Common.App.AccessibilityChecker.IAccessibilityCheckManager",()=>new Ho(J.AFrameworkApplication.pa,U.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),U.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),
U.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),Qe.App.jj.Cm,dk.App.KDd)).singleInstance()}init(){dk.App.P4e&&this.container.resolve("Box4.IFeatureHelper").tk.continueWith(()=>{fe.prototype.init.call(this)})}}Object(c.a)(Uo,"WordAccCheckerPackageManager",fe,[]);class vn{constructor(U,Ea){this.fPh=!1;this.yk=U;this.cP=Ea}$Jb(U){U.aV.Mzk(Object(u.a)(this,this.DGn,"triggerWebToWebActiveCoauthSurveysEventHandler"))}DGn(){this.CGn()}CGn(){!this.fPh&&this.yk&&(this.yk.LVa?
this.cP?this.cP.execute(U=>{U.logActivity("WordWebToWebActiveCoauth","WebToWebActiveCoauthFloodgateSurveyIsEnabled")}):qa.ULS.sendTraceTag(51389134,304,10,"Future ISystemInitiatedFeedback not available"):this.fPh=!0)}}Object(c.a)(vn,"CoauthSurveyManager",null,[1758]);class mm{constructor(){this.xs=this.Z=null}get name(){return"WordEditor.CoauthSurveys"}init(){Qe.App.oa&&(this.xs=Qe.App.oa.za)&&(this.xs.IIa?this.Zta():this.xs.mqa(()=>{this.Zta()}))}Zta(){var U=this.xs.jc;U&&(U=U.contentReplicator)&&
this.Z.resolve("WordEditor.CoauthSurveys.CoauthSurveyManager").$Jb(U)}dispose(){}Hb(U){this.Z=U;U.ha("WordEditor.CoauthSurveys.CoauthSurveyManager",()=>new vn(U.resolve("WordEditor.IWordEditorCoauthManager"),U.Ca("Common.ISystemInitiatedFeedback"))).as("WordEditor.CoauthSurveys.ICoauthSurveyManager").singleInstance()}static main(){J.AFrameworkApplication.K.ea("CoauthSurveysPackageIsEnabled")&&ba.a.instance.Sb(new mm)}}Object(c.a)(mm,"WordEditorCoauthSurveyManagerPackage",null,[1,2]);var On;(function(U){U[U.graphSpaceReplicatorNotSendingContent=
0]="graphSpaceReplicatorNotSendingContent";U[U.inboundRequestTakesTooLongToSendAfterRTC=1]="inboundRequestTakesTooLongToSendAfterRTC";U[U.docxSaveMonitorKickoutElapsed=2]="docxSaveMonitorKickoutElapsed"})(On||(On={}));Object(c.b)("ComponentLoggingScenario",On);var Kl=b(1257);class wn{flush(U,Ea){const kb=this.Qxl(U);kb.LoggingScenario=On[Ea];jh.a(kb).length?qa.ULS.sendTraceTag(594571986,3013,15,"{0}",kb):qa.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",
Kl.a[U.X2a])}Qxl(U){const Ea={};if(!U)return Ea;const kb=new $i.a;for(kb.enqueue(U);!kb.isEmpty;){U=kb.dequeue();const Nb=Kl.a[U.X2a];try{Ea[Nb]=U.R_()}catch(nc){qa.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",Nb.toString(),{["Kind"]:"Exception",["Stack"]:nc.stack,["Message"]:nc.message,["FileName"]:nc.fileName,["LineNumber"]:nc.lineNumber})}if((U=U.sld)&&U.length)for(let nc of U)!nc||Kl.a[nc.X2a]in Ea||kb.enqueue(nc)}return Ea}}
Object(c.a)(wn,"ComponentStateLogManager",null,[1757]);class Sl{flush(){}}Object(c.a)(Sl,"NoOpComponentStateLogManager",null,[1757]);class ll{constructor(){this.Z=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.Z.resolve("Common.IComponentStateLogManager")}dispose(){}Hb(U){this.Z=U;J.AFrameworkApplication.K.ea("ComponentStateLoggingPackageIsEnabled")?U.ha("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new wn).as("Common.IComponentStateLogManager").singleInstance():
U.ha("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new Sl).as("Common.IComponentStateLogManager").singleInstance()}static main(){ba.a.instance.Sb(new ll)}}Object(c.a)(ll,"WordEditorComponentStateLoggingPackage",null,[1,2]);var Vo=b(1789);class ul{constructor(U,Ea,kb){this.nf=U;this.Mee=Ea;this.MKh=kb}Ni(U,Ea,kb,Nb,nc,ad,Od,af,ve,eh=null,Ci=!1,Hj=null,Bf=null,Vi=null,Lj=null,ro=!1){return this.MKh?this.Mee.Ni(U,Ea,kb,Nb,nc,ad,Od,af,ve,eh,Ci,Bf,Vi):this.nf.Ni(U,Ea,kb,Nb,nc,ad,
Od,af,ve,eh,Ci,Hj,Bf,Vi,Lj,ro)}a$b(U){return this.MKh?this.Mee.a$b():this.nf.a$b(U)}}Object(c.a)(ul,"ClientRequestAdapter",null,[901]);var pj=b(172),ym=b(252),Wo=b(249),Mq=b(1226),Nm=b(1790),Wm=b(269),ml=b(48),Ej=b(666),qj=b(558),nm=b(121),Io=b(626),eo=b(441),fm;(function(U){U[U.none=0]="none";U[U.getCells=1]="getCells";U[U.hotStoreStatus=2]="hotStoreStatus";U[U.saveMonitor=3]="saveMonitor";U[U.saveMonitor_LineageTombstone=4]="saveMonitor_LineageTombstone";U[U.kickoutExecutor=5]="kickoutExecutor"})(fm||
(fm={}));Object(c.b)("MostRecentRevisionIdOrigin",fm);class Fn extends Sys.EventArgs{constructor(U,Ea,kb,Nb){super();this.zLc=U;this.PLm=Ea;this.httpStatusCode=kb;this.$F=Nb}}Object(c.a)(Fn,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class Bi{constructor(){this.Leb=0}get isEmpty(){return!this.Leb}oie(U){this.Leb|=U}PGe(U){return!!(this.Leb&U)}clear(){this.Leb=0}}Object(c.a)(Bi,"RetryAttempt",null,[]);var bi=b(1539),Ri;(function(U){U[U.O5n=-1]="noResultYet";U[U.Y$n=0]="upToDate";U[U.B8n=
1]="sessionLost";U[U.dao=2]="userSignedOut";U[U.m7n=3]="previousRequestPending";U[U.kVe=4]="requestFailed";U[U.U8n=5]="shuttingDown";U[U.W5n=6]="nullResponseData";U[U.j4n=7]="invalidResponseData";U[U.h2n=8]="failedRevisionLookup";U[U.e8n=9]="savedWithinThreshold";U[U.T5n=10]="notSavedWarning";U[U.A4n=11]="kickoutThreshold";U[U.K$n=12]="unknownRevision";U[U.m0n=13]="contentNotYetLoaded";U[U.sessionExpired=14]="sessionExpired";U[U.canaryError=15]="canaryError";U[U.timeout=16]="timeout";U[U.B4n=17]=
"kickoutThreshold_Offline";U[U.p1n=18]="dssSessionDeleted";U[U.q1n=19]="dssSessionExpired";U[U.mao=20]="waitingForSessionTokenRefresh";U[U.r1n=21]="dssSessionNotFound"})(Ri||(Ri={}));Object(c.b)("SaveMonitorResult",Ri);class rg{constructor(U,Ea,kb,Nb,nc,ad,Od,af,ve,eh,Ci,Hj,Bf,Vi,Lj,ro,gq,xq,Rp,lt,Is,gv,Wn,Ig,$m,Ys=null,Mj){this.T7c=0;this.Rtc=!1;this.Had=null;this.c6c=this.rF=-1;this.nrf=null;this.lce=0;this.mce=!1;this.WXb=null;this.P8c=0;this.Btf=this.eQh=null;this.qZ=this.EDh=this.mdf=0;this.Llf=
null;this.IBh=!1;this.QC=null;this.cvf=0;this.nfe=U;this.xyb=Ea;this.fzb=U;this.cSh=kb;this.tnk=Nb;this.hlf=nc;this.ukk=ad;this.Ztf=Od;this.Tuc=af;this.kuh=ve;this.saf=eh;this.ZM=Ci;this.Ija=Hj;this.s2c=Bf;this.Xdk=Vi;this.Vtc=Lj;this.ykf=ro;this.xB=gq;this.Vy=xq;this.qlk=Rp;this.IBh=$m;this.Oxb=new Bi;this.Ssf=new eo.a;this.Sff=Wn;this.BG=new Mq.a(-1);this.Ng=Ys;this.UZ=Mj;this.BG.dDf(Object(u.a)(this,this.Qbn,"resultStateChanged"));this.fde=lt;this.HWb=xq();this.Rzh=Is;this.l2j=gv;this.yRb=Ig;this.fQh=
this.cSh;this.Lnf=$b.a.nil;this.ka=new r.a;ia.a.instance.Ca("Common.App.VisibilityManagement.IVisibilityManager").execute(mt=>{this.QC=mt;this.QC.G2b((Dt,Et)=>{this.lma(Dt,Et)})});(this.snk=J.AFrameworkApplication.K?J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IgnoreOldErrorsAfterReconnectIsEnabled",!1):!1)&&this.Ng&&this.Ng.Die((mt,Dt)=>{this.hgc(mt,Dt)});this.ONh=J.AFrameworkApplication.K?J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.LastSavedToHostDetailsIsEnabled",
!1):!1}hgc(U,Ea){qa.ULS.sendTraceTag(528577692,rg.Ip,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",Nm.a[Ea.XMe],Nm.a[Ea.WMc]);1!==Ea.WMc&&3!==Ea.WMc&&(qa.ULS.sendTraceTag(528566343,rg.Ip,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",this.Oxb.PGe(1),this.Oxb.PGe(2)),this.Oxb.clear())}get Lre(){return this.mdf}get rId(){return this.Lnf}get nIb(){return!this.c9b()||this.rId.equals(this.c9b().id)}get mSi(){return this.Vy().getTime()-
this.HWb.getTime()>this.hlf}get iBc(){return this.qZ}get X2a(){return 3}get sld(){let U=null;Qe.App.oa&&Qe.App.oa.za&&Qe.App.oa.za.jc&&(U=Qe.App.oa.za.jc.contentReplicator);return[U,dk.App.T8]}lma(){var U,Ea,kb;const Nb={["VisibilityState"]:this.QC.qaa,["IsVisible"]:this.QC.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.Rtc,["KickoutIntervalElapsed"]:this.mSi,["LastSuccessfulIterationTime"]:null!==(U=this.HWb)&&void 0!==U?U:"null",["RequestStartTime"]:null!==(Ea=this.Had)&&void 0!==Ea?Ea:
"null",["SkippedKickouts"]:this.cvf,["LastSkippedKickoutAt"]:null!==(kb=this.qek)&&void 0!==kb?kb:"null"},["IsViable"]:this.Ng.jBa,["IsNetworkConnected"]:this.Ng.VN,["IsExpired"]:this.Ng.iVa,["HasEmergencyViewModeBeenDeployed"]:this.Ng.oj};qa.ULS.sendTraceTag(539874775,rg.Ip,50,ra.c(Nb))}start(){this.mdf=this.kuh.xDb(Object(u.a)(this,this.Rll,"fireRequestIfNecessary"),this.fzb)}mia(U){if(!this.Lre||this.fzb===U)return!1;const Ea=this.fzb;this.fzb=U;this.stop("changing save monitor interval from "+
Ea+"ms to "+U+"ms");this.start();return!0}sSc(U,Ea){if(Ea>=this.T7c&&U&&!$b.a.nil.equals(U)){var kb=!this.Lnf.equals(U);this.T7c=Ea;this.Lnf=U;const Nb=this.Vy();this.Btf=Nb;const nc=this.nIb;kb&&(Ea={["Id"]:U.toString(),["IsUpToDate"]:nc,["Origin"]:fm[Ea]},this.Llf&&(Ea.LastUpToDateTime=this.Llf.toISOString()),(kb=this.$6f())&&kb.store&&(U=kb.store.getRevision(U))&&(Ea.LastSavedCreationTime=U.creationTime.toISOString()),qa.ULS.sendTraceTag(557320151,rg.Ip,50,"Updating Last Saved Revision: {0}",Ea));
nc&&(this.Llf=Nb)}else Ea<this.T7c?qa.ULS.sendTraceTag(572051800,rg.Ip,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.T7c,Ea):qa.ULS.sendTraceTag(572051801,rg.Ip,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',Ea)}stop(U){this.ie(U)}ie(U){this.Lre&&(qa.ULS.sendTraceTag(5830084,rg.Ip,50,"Stopping DocxSaveMonitor because {0}!",U),this.kuh.ie(this.Lre),this.mdf=0)}Rll(){var U=this.HWb;this.HWb=this.Vy();if(this.xB())this.BG.event(5),this.stop("session has shut down");else{this.fzb===
rg.xrj&&this.mia(this.xyb);var Ea=this.s2c();if(Ea)if(this.ykf()&&J.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IWacWordDocxSaveMonitorWaitForTokenRefreshSettings"),this.nIb)this.BG.event(0);else if(this.Vtc())this.BG.event(1),this.stop("session is lost"),J.AFrameworkApplication.Yi("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.IBh&&!this.Ubm()&&(qa.ULS.sendTraceTag(554726995,rg.Ip,10,"DocxSaveMonitor: Session lost but not kicked out"),this.dB(ml.a.ZXf));else if(this.ykf())20!==
this.BG.currentState?(this.BG.event(20),this.eQh=this.Vy(),qa.ULS.sendTraceTag(593510691,rg.Ip,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",this.fQh)):this.Vy().getTime()-this.eQh.getTime()>this.fQh&&(this.BG.event(14),this.stop("Waited too long for session token to be refreshed"),this.dB(ml.a.rpd));else if(this.Xdk())if(this.HWb=U,this.Rtc)this.BG.event(3),this.Vy().getTime()-this.Had.getTime()>this.hlf&&(U=this.saf.a$b(this.rF),
qa.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.rF,yh.a[U]),this.fde&&this.fde.log(),this.stop("stuck on previousRequestPending"),this.dB());else if(U=qj.b(bi.a.construct(Ea)),this.Rtc=!0,this.Had=this.qlk(),this.rF=this.saf.Ni(rg.serviceUrl,2,U,{"Content-Type":"application/json; charset=utf-8"},!1,0,Object(u.a)(this,this.VQk,"checkSaveRequestSucceeded"),Object(u.a)(this,this.UQk,"checkSaveRequestFailed"),null,void 0,void 0,this.ukk,
this.Ztf,void 0,void 0,!0),0>=this.rF)this.Rtc=!1,qa.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.rF.toString());else{U=this.saf.a$b(this.rF);Ea=100;if(U&&1!==U||this.Rzh)Ea=50;qa.ULS.sendTraceTag(19161612,rg.Ip,Ea,"DocxSaveMonitor: Sending Request {0}",{["Id"]:this.rF,["Status"]:yh.a[U]});this.fde&&this.fde.start(this.rF)}else this.BG.event(2);else this.BG.event(13)}}NVl(){if(0>=this.Tuc)return!1;var U=this.OHl();if(!U)return this.nrf=null,
this.lce=0,this.mce=!1;this.WXb=U.Bue;this.WXb===this.nrf?this.lce++:(this.nrf=this.WXb,this.lce=1,this.mce=!1);if(this.lce<rg.hxm)return!1;this.P8c=+this.Vy()-+this.WXb;if(this.P8c<=this.Tuc)return!1;if(!this.mce)return this.mce=!0,this.ejj(),!1;if(this.yRb)this.yRb.execute(Ea=>{Ea.flush(this,0)});else{U="";try{this.Sff&&(U=this.Sff())}catch(Ea){U=ra.c({["Kind"]:"Exception",["Stack"]:Ea.stack,["Message"]:Ea.message,["FileName"]:Ea.fileName,["LineNumber"]:Ea.lineNumber}),qa.ULS.sendTraceTag(50426817,
rg.Ip,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",U)}qa.ULS.sendTraceTag(50426818,rg.Ip,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.WXb.toISOString(),this.P8c,this.Tuc,U)}this.Tuc=-1;this.stop("Exceeded oldest allowed local revision");this.dB(ml.a.pii);return!0}OHl(){let U=null,Ea=this.c9b();for(;Ea&&!Ea.kJa;)U=Ea,Ea=Ea.Bp;return U}rfm(){return this.Vtc()?(this.BG.event(1),
this.stop("session is lost"),!0):this.ykf()?(this.BG.event(14),qa.ULS.sendTraceTag(20029718,rg.Ip,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.dB(ml.a.rpd),!0):!1}$6f(){const U=this.s2c();return U?U.Ib:null}c9b(){const U=this.$6f();return U?U.Mn:null}t4h(U){return this.l2j.PGe(U)&&!this.Oxb.PGe(U)}UQk(U){this.qZ=this.iBc+1;let Ea=this.Rtc=!1,kb=!1;(U=U.data)?(13===U.status&&qa.ULS.sendTraceTag(22552772,rg.Ip,15,"Request expired in CRM queue {0}",{["Id"]:U.id,["ConsecutiveErrors"]:this.iBc}),
kb=7===U.status||13===U.status,this.t4h(2)&&kb?(this.Oxb.oie(2),Ea=!0,this.c6c=U.Ge,this.BG.event(16)):this.t4h(1)&&5===U.status?(this.Oxb.oie(1),Ea=!0,this.c6c=U.Ge,this.BG.event(15)):(this.BG.event(4),qa.ULS.sendTraceTag(22552773,rg.Ip,15,"Request failed {0}",{["Status"]:U.status,["HttpStatus"]:U.Ge,["Correlation"]:U.Ri?U.Ri[Wm.a.tP]:"",["Id"]:U.id,["ConsecutiveErrors"]:this.iBc}),this.c6c=U.Ge)):(this.BG.event(4),qa.ULS.sendTraceTag(23425240,rg.Ip,15,"RequestFailed and event data is null"));if(!Ea&&
(this.Oxb.clear(),kb?this.lug(17,ml.a.oii,"while offline"):this.lug(11,ml.a.Kre,"while online")))return;this.mia(Ea?this.Isl(kb):this.xyb)}Isl(U){return U?rg.mEn:rg.xrj}lug(U,Ea,kb){if(this.mSi)if(this.QC&&!this.QC.isVisible)qa.ULS.sendTraceTag(540669727,rg.Ip,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),this.cvf+=1,this.qek=this.Vy();else return this.BG.event(U,{}),this.stop("request failed after kickout interval "+kb),this.yRb&&this.yRb.execute(Nb=>
{Nb.flush(this,2)}),this.dB(Ea),!0;return!1}VQk(U){this.qZ=this.iBc+1;this.Rtc=!1;var Ea={};this.Oxb.clear();if(U=U.data){var kb=U.Ri?U.Ri[Wm.a.tP]:"";Ea.HttpStatus=U.Ge;Ea.Correlation=kb;Ea.Id=U.id;qa.ULS.sendTraceTag(23425242,rg.Ip,this.Rzh?50:100,"Request succeeded at the HTTP level {0}",Ea);this.c6c=U.Ge}else qa.ULS.sendTraceTag(23425241,rg.Ip,15,"Request succeeded with null response data");if(this.xB()||!this.Lre)this.BG.event(5),this.stop("session has shut down");else if(!this.rfm())if(U&&U.Rd)if(U=
this.bra(U.Rd))if(this.Ija.Jvb(U),U.StatusCode)this.mug(U,Ea)||this.BG.event(8,Ea);else{this.qZ=0;this.HWb=this.Vy();this.Ssf.clear();Ea={["LastSavedRevisionId"]:U.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:U.RevisionSequenceNumber};kb=nm.b(U.LastSavedRevisionId);this.ONh||this.UZ.uUe(kb.toString(),U.RevisionSequenceNumber);this.sSc(kb,3);var Nb=this.$6f().store.getRevision(kb);if(Nb){U=null;kb=this.c9b();Nb=(Nb=Nb.sFb(kb))?Nb.id:$b.a.nil;let nc=kb;for(;nc&&!nc.id.equals(Nb);)U=nc,nc=
nc.Bp;this.VWl(U,Ea,kb)||this.BG.event(9)}else this.NVl()||this.BG.event(12,Ea);this.mia(this.nfe)&&qa.ULS.sendTraceTag(22552774,rg.Ip,50,"Received response from server -- going back to normal interval")}else this.BG.event(7),this.nug("invalid response",Ea);else this.BG.event(6),this.nug("null response",Ea)}mug(U,Ea){const kb=U.StatusCode;return 88===kb||89===kb||236===kb?(Ea.KickoutDiagnostics=this.Sff(),88===kb?(Ea.Result="deleted DSS session",this.BG.event(18,Ea),this.stop("deleted DSS session"),
this.dB(ml.a.localCobaltDeletedSessionFault)):89===kb?(Ea.Result="expired DSS session",this.BG.event(19,Ea),this.stop("expired DSS session"),this.dB(ml.a.localCobaltExpiredSessionFault)):(J.AFrameworkApplication.Zi("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled"),J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",!1)&&(U=nm.b(U.LastSavedRevisionId),this.sSc(U,4)),Ea.Result="DSS session not found",
this.BG.event(21,Ea),this.stop("DSS session not found"),this.dB(ml.a.localCobaltSessionNotFound)),!0):14===kb?(this.stop("DSS returned an unspecified failure"),this.dB(ml.a.C_i),!0):104===kb?(this.stop("this operation is disabled on the server"),!0):this.nug("unrecognized OperationResult: "+kb,Ea)}nug(U,Ea){if(!this.Ssf.contains(U))this.Ssf.add(U);else if(this.lug(11,ml.a.Kre,U))return Ea.ConsecutiveErrors=this.iBc,Ea.Reason=U,qa.ULS.sendTraceTag(41997899,rg.Ip,15,"DocxSaveMonitor kickout. {0}",Ea),
!0;this.mia(this.xyb);return!1}VWl(U,Ea,kb){let Nb=!1;if(U){const nc=this.Vy().getTime()-U.creationTime.getTime();nc>=this.cSh&&(Nb=!0,rg.f4i(Ea,this.AMl(U,nc,kb)),nc>=this.hlf&&10===this.BG.currentState?(this.BG.event(11,Ea),this.stop("didn't save in time"),this.dB()):(this.BG.event(10,Ea),this.ejj(),this.u3f()))}return Nb}Myk(U){this.ka.addHandler(rg.xfj,U)}rWh(U){this.ka.addHandler(rg.y3f,U)}Goj(U){this.ka.removeHandler(rg.y3f,U)}ejj(){this.ka.raiseEvent(rg.xfj)}bra(U){let Ea;return({group:Ea}=
Io.a.b9(U,Ea)).returnValue?Ea.Responses[0]:null}AMl(U,Ea,kb){const Nb={};Nb.FirstUnsavedRevisionId=U.id.toString();Nb.FirstUnsavedRevisionLengthToRoot=U.IS;Nb.UnsavedTimeInMs=Ea;Nb.CurrentRevisionId=kb.id.toString();Nb.CurrentRevisionLengthToRoot=kb.IS;return Nb}u3f(){To.a.Gqi(8)}dB(U=ml.a.Kre){this.tnk?(this.stop(rg.Oim),U===ml.a.rpd?this.ZM.value.dB(U,Object.assign(new Ej.a,{IGa:4,kfa:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,yqa:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):
this.ZM.value.dB(U,new Ej.a)):qa.ULS.sendTraceTag(19247383,rg.Ip,50,"Kickout disabled")}Qbn(U,Ea){U={};U.DocxSaveMonitorState=Ri[Ea.newState];U.PreviousState=Ri[Ea.gOg];U.PreviousStateHits=Ea.hOg;U.PreviousStateTransitionTime=Ea.iOg.toISOString();U.LastHttpStatus=this.c6c;U.LastSuccessTime=this.HWb.toISOString();this.Had&&(U.LastRequestStartTime=this.Had.toISOString());U.LastSavedRevisionID=this.rId.toString();U.LastSavedRevisionIdOrigin=this.T7c;U.LastSavedRevisionIdSetTime=this.Btf?this.Btf.toISOString():
null;const kb=Ea.Czn;kb&&rg.f4i(U,kb);Ea=Ea.newState;switch(Ea){case 13:qa.ULS.sendTraceTag(5830086,rg.Ip,50,"{0}",U);break;case 1:qa.ULS.sendTraceTag(5884125,rg.Ip,50,"{0}",U);break;case 0:qa.ULS.sendTraceTag(5830087,rg.Ip,50,"{0}",U);break;case 2:qa.ULS.sendTraceTag(5830088,rg.Ip,50,"{0}",U);break;case 3:qa.ULS.sendTraceTag(5830089,rg.Ip,50,"{0}",U);break;case 4:qa.ULS.sendTraceTag(5884126,rg.Ip,50,"{0}",U);break;case 5:qa.ULS.sendTraceTag(5884127,rg.Ip,50,"{0}",U);break;case 6:qa.ULS.shipAssertTag(5830090,
rg.Ip,!1,"{0}",U);break;case 7:qa.ULS.shipAssertTag(5830091,rg.Ip,!1,"{0}",U);break;case 8:qa.ULS.sendTraceTag(5830092,rg.Ip,15,"{0}",U);break;case 10:qa.ULS.sendTraceTag(5830094,rg.Ip,15,"{0}",U);break;case 9:qa.ULS.sendTraceTag(5884128,rg.Ip,50,"{0}",U);break;case 11:qa.ULS.sendTraceTag(5830096,rg.Ip,15,"{0}",U);break;case 17:qa.ULS.sendTraceTag(37835678,rg.Ip,15,"{0}",U);break;case 12:qa.ULS.sendTraceTag(5830095,rg.Ip,15,"{0}",U);break;case 18:qa.ULS.sendTraceTag(38122832,rg.Ip,15,"{0}",U);break;
case 19:qa.ULS.sendTraceTag(38122833,rg.Ip,15,"{0}",U);break;case 21:qa.ULS.sendTraceTag(0,rg.Ip,15,"{0}",U);break;case 14:qa.ULS.sendTraceTag(6575508,rg.Ip,15,"{0}",U);break;case 15:qa.ULS.sendTraceTag(36739287,rg.Ip,50,"{0}",U);break;case 16:qa.ULS.sendTraceTag(36767649,rg.Ip,15,"{0}",U);break;case 20:qa.ULS.sendTraceTag(593510690,rg.Ip,15,"{0}",U);break;default:qa.ULS.shipAssertTag(5884129,rg.Ip,!1,"Bad state:{0} logInfo:{1}",Ea,U)}}R_(){const U={};this.WXb&&(U.ORT=this.WXb.toISOString());0<this.P8c&&
(U.AA=this.P8c);0<this.Tuc&&(U.MAA=this.Tuc);const Ea={};J.AFrameworkApplication.X7&&(Ea.S=1);Qe.App.lostSession&&(Ea.LS=1);this.Ng&&this.Ng.Gp&&(Ea.KO=1);U.AMD=Ea;return U}KBl(){const U={"Content-Type":"application/json; charset=utf-8","X-Requested-With":"Fetch"};J.AFrameworkApplication.buildVersion&&(U["X-OfficeVersion"]=bc.a.wE(J.AFrameworkApplication.buildVersion));J.AFrameworkApplication.accessToken&&(U["X-AccessToken"]=bc.a.wE(J.AFrameworkApplication.accessToken),U["X-AccessTokenTtl"]=J.AFrameworkApplication.D6.toString());
J.AFrameworkApplication.canary&&(U["X-Key"]=bc.a.wE(J.AFrameworkApplication.canary));J.AFrameworkApplication.userType&&(U["X-UserType"]=bc.a.wE(J.AFrameworkApplication.userType));const Ea=J.AFrameworkApplication.Gd.mG;Ea&&(U["X-WacCluster"]=bc.a.wE(Ea));J.AFrameworkApplication.userSessionId&&(U["X-UserSessionId"]=bc.a.wE(J.AFrameworkApplication.userSessionId));return U}v3f(){var U=this.Ng?this.Ng.networkState:null;if(1===U||3===U)qa.ULS.sendTraceTag(558158790,rg.Ip,15,"Not sending request because we dont have network.");
else if(U=this.s2c()){var Ea=new Sys.Net.WebRequest;Ea.set_httpVerb("POST");Ea.set_url(rg.serviceUrl);var kb={};kb.body=qj.b(bi.a.construct(U));kb.headers=this.KBl();kb.method=Ea.get_httpVerb();try{"function"===typeof window.fetch?window.fetch(Ea.getResolvedUrl(),kb).then(Nb=>{qa.ULS.sendTraceTag(561551382,rg.Ip,50,"Request succeeded at the HTTP level {0}",Nb.statusText);this.EDh=Nb.status;return Nb.json()},Nb=>{qa.ULS.sendTraceTag(561551383,rg.Ip,15,"Request failed at the HTTP level {0}",Nb);return null}).then(Nb=>
{Nb=JSON.stringify(Nb);this.NQk(Nb,this.EDh);return Nb},()=>{qa.ULS.sendTraceTag(561551385,rg.Ip,15,"Request succeeded with null response data");return""}):qa.ULS.sendTraceTag(561002076,rg.Ip,15,"Browser does not support Fetch.")}catch(Nb){qa.ULS.sendTraceTag(561551386,rg.Ip,15,String.format("Exception when attempting to get last revision save id : {0}",Nb))}}else qa.ULS.sendTraceTag(540079457,rg.Ip,15,"Target node is null, not sending last saved revision request.")}NQk(U,Ea){let kb=$b.a.nil,Nb=!1,
nc=-1;if(Ea===fh.a.HD)if(U=this.bra(U)){kb=nm.b(U.LastSavedRevisionId);const ad=U.RevisionSequenceNumber;this.ONh||this.UZ.uUe(kb.toString(),ad);U.StatusCode||(Nb=!0,nc=U.StatusCode)}else qa.ULS.sendTraceTag(561002077,rg.Ip,50,"Response is null when attempting to get last revision save id");this.ka.raiseEvent(rg.y3f,new Fn(kb,Nb,Ea,nc))}static f4i(U,Ea){for(let kb in Ea)U[kb]=Ea[kb]}Ubm(){return pf.SessionStatusManager.instance.Gp}}rg.xrj=0;rg.serviceUrl=Qe.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";
rg.Oim="kickout";rg.xfj="PS";rg.y3f="FLSR";rg.Ip=343;rg.hxm=5;rg.mEn=5E4;Object(c.a)(rg,"DocxSaveMonitor",null,[1759,152]);class Yf{constructor(U,Ea){this.A1a=U;this.zak=Ea}lb(U){U.ma(bd.a.sMg,He.a.view,Object(u.a)(this,this.sMg,"pendingAutosavesCheck"));U.ma(bd.a.v3e,He.a.view,Object(u.a)(this,this.v3e,"updateDocxSaveMonitorInterval"));U.$b(bd.a.v3e,101)}sMg(){const U=this.zak();return 32!==U?U:!this.A1a||this.A1a.nIb?32:2<=this.A1a.iBc?8:4}v3e(U,Ea,kb,Nb,nc){this.A1a&&this.A1a.mia(parseInt(nc.toString()));
return 32}}Object(c.a)(Yf,"DocxSaveMonitorActor",null,[]);class Si{xDb(U,Ea){return window.setInterval(U,Ea)}ie(U){window.clearInterval(U)}}Si.instance=new Si;Object(c.a)(Si,"DocxSaveMonitorTaskManager",null,[1754]);class Om{constructor(U){this.rF=0;this.bGa=U}start(U){this.bGa&&(this.rF=U,this.bGa.reset())}log(){if(this.bGa){var U={};U.RequstId=this.rF;U.InvokeCount=this.bGa.H5a;U.InvokeFailedCount=this.bGa.I5a;U.NoOpenConnectionCount=this.bGa.Z6a;U.SynchronousNotificationCount=this.bGa.C9a;U.ResponseNotAvailable=
this.bGa.E8a;qa.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",U)}}}Object(c.a)(Om,"RequestLifeCycleTelemetryManager",null,[1753]);class ze{constructor(){this.Z=this.A1a=null}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(Qe.App.Vt||Qe.App.ap)this.A1a=this.Z.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor"),(new Yf(this.A1a,()=>Wo.WoncaApp.gA.CJi())).lb(J.AFrameworkApplication.pa)}b4k(){var U=J.AFrameworkApplication.K;if(!U.ea("DocxSaveMonitorEnabled"))return null;
var Ea=U.ea("DocxSaveMonitorKickoutEnabled");const kb=U.jb("DocxSaveMonitorIntervalMs",6E4),Nb=U.jb("DocxSaveMonitorFailureIntervalMs",5E3),nc=U.jb("DocxSaveMonitorWarningTimeMs",12E4),ad=U.jb("DocxSaveMonitorKickoutTimeMs",3E5),Od=U.jb("DocxSaveMonitorQueueTimeoutMs",6E4),af=U.jb("DocxSaveMonitorSentTimeoutMs",12E4),ve=U.jb("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var eh=U.ea("DocxSaveMonitorTelemetryInfoEnabled");const Ci=U.ea("DocxSaveMonitorInfoRequestLoggingEnabled");var Hj=J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",
!1),Bf=U.ea("DocxSaveMonitorRawWebRequestsEnabled")||Hj;Hj=U.ea("ComponentStateLoggingPackageIsEnabled");U=U.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",!1);const Vi=J.AFrameworkApplication.Gd;var Lj=Bf?new Vo.a(J.AFrameworkApplication.userSessionId,Vi.mG,Vi.PUf):null;Lj=new ul(Vi,Lj,Bf);eh=eh&&Vi&&!Bf?new Om(Vi.gJ):null;Bf=new Bi;Bf.oie(1);Bf.oie(2);Hj=Hj?this.Z.Ca("Common.IComponentStateLogManager"):null;Ea=new rg(kb,Nb,nc,Ea,
ad,Od,af,ve,Si.instance,Lj,ia.a.instance.vf("Box4.IKickoutExecutor"),ym.a.instance,Object(u.a)(this,this.YGc,"getTargetNode"),()=>!J.AFrameworkApplication.SMc||Nf.a.instance.nJc,()=>Qe.App.lostSession,Object(u.a)(pj.a.instance,pj.a.instance.Dqa,"checkAndTriggerSessionHasExpired"),()=>J.AFrameworkApplication.mi,()=>new Date,()=>new Date,eh,Ci,Bf,Object(u.a)(this,this.$ql,"getAdditionalDiagnosticLog"),Hj,U,ia.a.instance.sa("Common.ISessionStatus")||pf.SessionStatusManager.instance,ia.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"));
Ea.start();qa.ULS.sendTraceTag(5884131,rg.Ip,50,"SaveMonitor initialized");return Ea}YGc(){const U=Qe.App.oa.za.Rb;return U?U.xc:null}$ql(){const U={};J.AFrameworkApplication.tb&&(U.TM=J.AFrameworkApplication.tb.R_());Wo.WoncaApp.gA&&(U.RS=Wo.WoncaApp.gA.R_());dk.App.T8&&(U.CRS=dk.App.T8.R_());Qe.App.oa&&Qe.App.oa.za&&Qe.App.oa.za.jc&&Qe.App.oa.za.jc.contentReplicator&&(U.GSR=Qe.App.oa.za.jc.contentReplicator.R_());J.AFrameworkApplication.X7&&(U.S=1);Qe.App.lostSession&&(U.LS=1);Qe.App.lc&&Qe.App.lc.oC.Gp&&
(U.KO=1);return Sys.Serialization.JavaScriptSerializer.serialize(U)}dispose(){this.A1a&&this.A1a.stop("WordEditorDocxSaveMonitorPackage is being disposed")}Hb(U){this.Z=U;(Qe.App.Vt||Qe.App.ap)&&U.ha("WordEditor.DocxSaveMonitor.DocxSaveMonitor",Object(u.a)(this,this.b4k,"createSaveMonitor")).as("Wonca.IDocxSaveMonitor").singleInstance()}static main(){ba.a.instance.Sb(new ze)}}Object(c.a)(ze,"WordEditorDocxSaveMonitorPackage",null,[1,2]);var rj;(function(U){U[U.version0=0]="version0";U[U.version1=
1]="version1"})(rj||(rj={}));Object(c.b)("FirstRunExperienceVersion",rj);class Ne{get uEf(){return"Word"}get i4h(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return rj.version0}get currentVersion(){return rj.version1}get R9l(){return Ne.isEnabled()&&J.AFrameworkApplication.K.ea("WordEditorFirstRunExperienceDataStoreIsEnabled")}get jLc(){return Ne.isEnabled()&&J.AFrameworkApplication.K.ea("WordEditorFirstRunExperienceUIV2IsEnabled")}get kVi(){return J.AFrameworkApplication.K.ea("WordEditorFirstRunExperienceTestIsEnabled")}get Vml(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get K4i(){return 24}get fsj(){return 4E3}get eSd(){return""}static isEnabled(){const U=
J.AFrameworkApplication.sessionStartInfoSettings?J.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==U&&"Automation"!==U}}Object(c.a)(Ne,"FirstRunExperienceLauncherSettings",null,[1793]);class cj{constructor(U){this.ywh=U}Oun(U){this.ywh&&this.ywh.Pun(U)}}Object(c.a)(cj,"FirstRunExperienceManager",null,[1792]);class Pm{constructor(){this.Z=null}get name(){return"WordEditor.FirstRunExperience"}Hb(U){this.Z=U;this.Z.ha("WordEditor.FirstRunExperience.IFirstRunExperienceManager",
()=>new cj(this.Z.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).singleInstance()}init(){const U=this.Z.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");U&&U.Oun(new Ne)}dispose(){}}Object(c.a)(Pm,"WordEditorFirstRunExperiencePackageManager",null,[1,2]);class fo{constructor(U,Ea,kb){this.ga=U;this.s0a=Ea;this.yCh=kb}dispose(){this.s0a&&this.s0a.dispose()}lb(){this.ga.ma(bd.a.P1e,He.a.view,Object(u.a)(this,this.P1e,"toggleFormatPicturePane"));this.ga.Aa(bd.a.jDa,
He.a.view,Object(u.a)(this,this.jDa,"showFormatPicturePane"),4);this.ga.ma(bd.a.BCe,He.a.view,Object(u.a)(this,this.BCe,"hideFormatPicturePane"));this.ga.Aa(bd.a.vZe,He.a.view,Object(u.a)(this,this.jDa,"showFormatPicturePane"),4);this.ga.ma(bd.a.wZe,He.a.view,Object(u.a)(this,this.jDa,"showFormatPicturePane"));this.ga.ma(bd.a.xZe,He.a.view,Object(u.a)(this,this.jDa,"showFormatPicturePane"));this.yCh&&(this.ga.Aa(bd.a.shj,He.a.view,Object(u.a)(this,this.rhj,"queryFormatPicturePane"),96),this.ga.ma(bd.a.A5g,
He.a.view,Object(u.a)(this,this.jDa,"showFormatPicturePane")),this.ga.Aa(bd.a.thj,He.a.view,Object(u.a)(this,this.rhj,"queryFormatPicturePane"),96),this.ga.ma(bd.a.B5g,He.a.view,Object(u.a)(this,this.jDa,"showFormatPicturePane")))}rhj(U,Ea,kb,Nb,nc){if(1===kb)return 32;switch(U){case bd.a.shj:nc[Qk.a.On]=1===this.s0a.IDb;break;case bd.a.thj:nc[Qk.a.On]=2===this.s0a.IDb}return 32}jDa(U,Ea,kb,Nb,nc){if(1===kb)return 32;if(2===kb){Ea=this.s0a.hh.isVisible;this.s0a.nt(!0,1===nc);kb=0;switch(U){case bd.a.A5g:nc=
1;break;case bd.a.B5g:nc=2;break;case bd.a.vZe:nc=2;kb=1;break;case bd.a.wZe:nc=1;kb=2;break;case bd.a.xZe:nc=1;kb=3;break;case bd.a.P1e:nc=this.s0a.IDb;this.yCh&&!nc&&(nc=1);break;default:kb=nc=0}Ea&&U===bd.a.jDa||this.s0a.Skn(nc,kb);return 32}return 8}BCe(U,Ea,kb,Nb,nc){this.toggleButton(nc,!1);return this.STk(kb)}STk(U){if(1===U)return 32;this.s0a.nt(!1);return 32}P1e(U,Ea,kb,Nb,nc){return this.s0a.hh.isVisible?this.BCe(U,Ea,kb,Nb,nc):this.jDa(U,Ea,kb,Nb,nc)}toggleButton(U,Ea){U&&(U[Qk.a.On]=Ea)}}
Object(c.a)(fo,"FormatPictureActor",null,[12]);class er{constructor(U){this.K0b=!1;this.hh=U}get IDb(){return this.hh.b6k}Skn(U,Ea){switch(U){case 0:case 1:this.hh.Ivn(Ea);break;case 2:this.hh.Ovn(Ea)}}nt(U,Ea=!1){this.K0b||this.bkg();U?this.hh.HV(Ea):this.hh.jAa()}dispose(){this.hh.dispose()}bkg(){this.K0b||(this.hh.initialize(),this.K0b=!0)}}Object(c.a)(er,"FormatPictureManager",null,[1756,12]);var Gm=b(349),vl=b(127),np=b(368);class xm{}xm.NV=np.a.nve;xm.HOc=1;xm.CKb=WordEditorIntl.WordEditorStrings.L_FormatPicture;
xm.lHa="FormatPictureTaskPaneData";Object(c.a)(xm,"FormatPicturePaneConstants",null,[]);class Yp{constructor(){this.type="FormatPictureTaskPaneProps";this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(c.a)(Yp,"FormatPictureTaskPaneProps",null,[]);class op{constructor(U,
Ea,kb,Nb){this.Ltf=0;this.Q_c=this.ZW=null;this.Dde=this.wde=this.x$d=this.B3d=this.kge=0;this.Sw=this.Yrc=!1;this.Wbf=0;this.YW=U;this.Bek=Ea;this.Qlf=kb;this.ag=Nb}initialize(){this.K6();this.Wta()}get isVisible(){return this.Sw}HV(U){this.JVd(U)}jAa(){this.hoa();this.r_l()}Ivn(U){this.$yj(U,1)}Ovn(U){this.$yj(U,2)}$yj(U,Ea){this.Wbf=Ea;this.Ltf=U}get b6k(){return this.Wbf}dispose(){}K6(){this.YW.t3a();this.Ltf=this.Wbf=0}get Wg(){return this.Bek.value}get Tb(){return this.Qlf.value}jpb(){return!!this.Wg.Zd&&
this.Wg.Zd.name===xm.NV}VJm(){this.Ywj()}Ywj(){this.Wg.wf(xm.NV)}Wta(){const U=this.Wg.Kc(xm.NV);U.parent=gi.AFrame.hp;U.naa(Object(u.a)(this,this.VJm,"onSetFocus"))}hoa(){this.jpb()&&this.Wg.wf(this.Wg.uI)}JVd(U){ie.UISurfaces.Nv().then(Ea=>{Ea.showTaskPane(xm.NV,this.GF(U));this.isVisible&&U&&this.Wg.wf(xm.NV);return null})}Mw(){ie.UISurfaces.Nv().then(U=>{U.updateTaskPane(xm.NV,this.GF(!1));return null})}r_l(){ie.UISurfaces.Nv().then(U=>{U.hideTaskPane(xm.NV,2);return null})}GF(){const U=new Yp;
this.jqn(U);return Object.assign(new zd.a,{title:xm.CKb,hideHeader:!1,width:320,location:2,contentProps:U,onOpen:Ea=>{this.Sw=!0;Qe.App.oa.m2a(Object(u.a)(this,this.Km,"pollForStateAndUpdate"));Qe.App.oa.updateCommandUI();this.Ywj();this.ag.IBb(xm.NV,Ea)},onClose:()=>{this.hoa();this.Sw=!1;Qe.App.oa.sjc(Object(u.a)(this,this.Km,"pollForStateAndUpdate"));Qe.App.oa.updateCommandUI()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}jqn(U){const Ea=mf.e().numberFormatInfo;U.section=
this.Ltf;U.numberFormatInfo="object"===typeof Ea?Ea:null;U.title=this.ZW;U.description=this.Q_c;U.topCrop=this.kge;U.bottomCrop=this.B3d;U.leftCrop=this.x$d;U.rightCrop=this.wde;U.rotationAngle=this.Dde;U.onTitleChange=this.onTitleChange();U.onDescriptionChange=this.onDescriptionChange();U.onCropSpinButtonChange=this.onCropSpinButtonChange();U.onRotationSpinButtonChange=this.onRotationSpinButtonChange();U.disabled=this.Yrc}onTitleChange(){return U=>{if(U!==this.ZW){this.ZW=U;var Ea=new Gm.DictionaryPropertySet;
Ea.setValue(vl.a.pnb,U);this.Tb.ob(Of.a.oSc,2,Ea);this.Mw()}}}onDescriptionChange(){return U=>{if(U!==this.Q_c){var Ea=new Gm.DictionaryPropertySet;Ea.setValue(vl.a.dY,U);this.Q_c=U;this.Tb.ob(Of.a.YMb,2,Ea);this.Mw()}}}onCropSpinButtonChange(){return(U,Ea)=>{const kb=new Gm.DictionaryPropertySet;switch(Ea){case 0:this.kge=U;kb.setValue(vl.a.tnb,U);this.Tb.ob(bd.a.nzd,2,kb);break;case 1:this.B3d=U;kb.setValue(vl.a.qnb,U);this.Tb.ob(bd.a.kzd,2,kb);break;case 2:this.x$d=U;kb.setValue(vl.a.rnb,U);this.Tb.ob(bd.a.lzd,
2,kb);break;case 3:this.wde=U,kb.setValue(vl.a.snb,U),this.Tb.ob(bd.a.mzd,2,kb)}this.Mw()}}onRotationSpinButtonChange(){return U=>{this.Dde=U;const Ea=new Gm.DictionaryPropertySet;Ea.setValue(vl.a.sIc,0);Ea.setValue(vl.a.pH,U);this.Tb.ob(Of.a.imageRotate,2,Ea);this.Mw()}}Km(){let U=!1;U=this.AXm()||U;U=this.$7a()||U;U=this.Z7a()||U;U=this.CPc()||U;(U=this.xXm()||U)&&this.Mw()}AXm(){const U=2===this.Tb.ob(Of.a.oSc,1,null),Ea=U!==this.Yrc;this.Yrc=U;return Ea}$7a(){var U=new Gm.DictionaryPropertySet;
this.Tb.ob(Of.a.$7a,2,U);U=U.fa(vl.a.pnb,"");const Ea=U!==this.ZW;this.ZW=U;return Ea}Z7a(){var U=new Gm.DictionaryPropertySet;this.Tb.ob(Of.a.Z7a,2,U);U=U.fa(vl.a.dY,"");const Ea=U!==this.Q_c;this.Q_c=U;return Ea}CPc(){var U=new Gm.DictionaryPropertySet;this.Tb.ob(bd.a.fOd,2,U);const Ea=U.fa(vl.a.tnb,0),kb=U.fa(vl.a.qnb,0),Nb=U.fa(vl.a.rnb,0);U=U.fa(vl.a.snb,0);const nc=Ea!==this.kge||kb!==this.B3d||Nb!==this.x$d||U!==this.wde;this.kge=Ea;this.B3d=kb;this.x$d=Nb;this.wde=U;return nc}xXm(){var U=
new Gm.DictionaryPropertySet;this.Tb.ob(Of.a.oLb,2,U);U=U.fa(vl.a.pH,0);const Ea=U!==this.Dde;this.Dde=U;return Ea}}Object(c.a)(op,"ReactFormatPicturePane",null,[1755,12]);class sa{constructor(){this.$6d=this.Z=null}get name(){return"WordEditor.FormatPicture"}Hb(U){this.Z=U;this.Z.ha("WordEditor.FormatPicture.IFormatPictureManager",()=>new er(this.Z.resolve("WordEditor.FormatPicture.IFormatPicturePane"),dk.App.kTj)).singleInstance();this.Z.ha("WordEditor.FormatPicture.IFormatPicturePane",()=>new op(dh.a.instance,
new xb.a(()=>ae.FocusManager.instance()),new xb.a(()=>J.AFrameworkApplication.pa),ye.a.instance)).singleInstance();this.Z.ha("WordEditor.FormatPicture.FormatPictureActor",()=>new fo(J.AFrameworkApplication.pa,this.Z.resolve("WordEditor.FormatPicture.IFormatPictureManager"),dk.App.kTj)).singleInstance()}init(){if(dk.App.U4e||dk.App.whh)this.$6d=this.Z.resolve("WordEditor.FormatPicture.FormatPictureActor"),this.$6d.lb(),Qe.App.oa.updateCommandUI()}dispose(){this.$6d&&this.$6d.dispose()}static main(){ba.a.instance.Sb(new sa)}}
Object(c.a)(sa,"WordEditorFormatPicturePackage",null,[1,2]);class Za{constructor(){this.Wsc=this.Cad=null;this.ade=0}get name(){return"WordEditor.FrameTiming"}Hb(){this.Wsc=new EventTiming.FrameTimingMeter;this.ade=J.AFrameworkApplication.K.jb("FrameTimingMeterReportingIntervalInSeconds",60);0>=this.ade&&(this.ade=60);this.Cad=U=>{(U=U.rawEvent)&&qa.ULS.sendTraceTag(24962208,306,50,ra.c(U.detail))};G.a.addHandler(window.self,w.a.$Vg,this.Cad)}init(){this.Wsc&&this.Wsc.start(this.ade)}dispose(){this.Wsc&&
(this.Wsc.stop(),this.Wsc=null);this.Cad&&(G.a.removeHandler(window.self,w.a.$Vg,this.Cad),this.Cad=null)}static main(){ba.a.instance.Sb(new Za)}}Object(c.a)(Za,"FrameTimingPackageManager",null,[1,2]);var Bb=b(1280),ac=b(523);class yc extends Re.a{constructor(){super();this.Prompt=0;this.FileId=null}Jk(){return 100}static construct(U,Ea){const kb=new yc;kb.FileId=U;kb.Prompt=Ea;return kb}}Object(c.a)(yc,"GraphMergeConsentChangedRequest",Re.a,[]);class Hc{constructor(U,Ea,kb,Nb,nc,ad=null,Od=null){this.kj=
!1;this.WT=null;this.ZMh=this.Ukf=!1;this.DZ=U;this.phe=kb;this.pMa=Nb;this.x_a=nc;this.phe&&this.phe.xyk(Object(u.a)(this,this.rIi,"handleOnGraphMergeComplete"));this.Ija=ad||ym.a.instance;if(!Od){const af=new ac.a;Od=ve=>af.Pla(0,ve)}this.C3j=Od}get Lhm(){return this.Ukf}get Uhn(){return this.ZMh}MOf(){if(this.pMa.tCe)this.Ukf=!0;else if(this.Ukf=!1,!this.Uhn){this.ZMh=!0;var U=this.x_a.mKa;qa.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",400===U);if(100===U||400===U)U=yc.construct(this.DZ(),
U),this.Zx(U)}}rIi(U,Ea){Ea&&Ea.dAg&&Ea.dAg.mRf&&!this.pMa.lVi&&(this.pMa.qNj(),this.pMa.tCe=!0,this.Zx(Ea.dAg.mRf))}Zx(U){const Ea=new Xf.a;Ea.Pq=U;Ea.status=1;Ea.RE="GraphMerge";const kb=this.C3j(()=>{this.GRd(Ea,33===U.Jk())});kb.PJ(Ea);kb.yP()}GRd(U,Ea){this.kj||(Ea&&(this.pMa.tCe=!1),2===U.statusCode&&!V.a.THb(U.xj)&&1===U.xj.length&&U.xj[0]?(U=U.xj[0],U.StatusCode?this.pMa.J1g():Ea&&this.x_a.gqj(Object(u.a)(this,this.MOf,"consentChoiceMade")),this.Ija.Jvb(U),this.Lhm&&this.MOf()):this.pMa.J1g())}$Jb(U){this.WT=
U;this.WT.xyc(Object(u.a)(this,this.pIi,"handleOnAfterReplication"));this.WT.yyc(Object(u.a)(this,this.qIi,"handleOnAfterResponseReceived"))}pIi(U,Ea){Ea&&Ea.d1d&&this.pMa.qNj()}qIi(U,Ea){Ea&&(Ea.ShowMergePrompt&&this.x_a.gqj(Object(u.a)(this,this.MOf,"consentChoiceMade")),J.AFrameworkApplication.qf&&(J.AFrameworkApplication.qf.SessionMergeInfo|=Ea.PartMergeInfo))}dispose(){this.kj||(this.phe&&this.phe.S7m(Object(u.a)(this,this.rIi,"handleOnGraphMergeComplete")),this.WT&&(this.WT.qjc(Object(u.a)(this,
this.pIi,"handleOnAfterReplication")),this.WT.JQd(Object(u.a)(this,this.qIi,"handleOnAfterResponseReceived"))),this.kj=!0)}}Object(c.a)(Hc,"GraphMergeBackupManager",null,[1790,12]);class cd{constructor(U,Ea=null,kb=null,Nb=null){this.P9e=0;this.Ujf=!1;this.dDh=new Date(0);this.tCe=!1;this.x_a=U;this.Vy=Ea||(()=>new Date);kb||(kb=J.AFrameworkApplication.K?J.AFrameworkApplication.K.jb("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.Zfk=kb;Nb||(Nb=J.AFrameworkApplication.K?J.AFrameworkApplication.K.jb("WordEditorGraphMergeMaxBackups",
1):1);this.kFh=Nb}get Jgm(){return+this.Vy()-+this.dDh<this.Zfk}get lVi(){return 500===this.x_a.mKa?!1:100===this.x_a.mKa?!0:this.Ujf||this.tCe||this.Jgm}qNj(){this.dDh=this.Vy();this.P9e++;this.P9e>=this.kFh&&this.J1g()}J1g(){this.Ujf||(this.Ujf=!0,qa.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.P9e,this.kFh))}}Object(c.a)(cd,"GraphMergeBackupThrottler",null,[1789]);class Hd{constructor(U,Ea,kb=null){this.myh=!1;
this.LD=U;this.u6d=Ea;null==kb&&(kb=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("WordEditorGraphMergeBypassConsentPrompt"));this.Brf=kb?500:300}get mKa(){return this.Brf}gqj(U){if(!this.myh&&300===this.mKa){var Ea=this.u6d.value;Ea&&Ea.isFeatureEnabled(83)&&(this.myh=!0,this.LD.execute(kb=>{kb.Xun(()=>{this.aXk(U)},()=>{this.consentDenied(U)})}))}}consentDenied(U){300===this.mKa&&(qa.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.Brf=100,U());
this.enj()}aXk(U){300===this.mKa&&(qa.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),this.Brf=400,U());this.enj()}enj(){this.LD.execute(U=>{U.k_l()})}}Object(c.a)(Hd,"GraphMergeCollectionConsentManager",null,[1788]);class le extends Sys.EventArgs{constructor(U){super();this.dAg=U}}Object(c.a)(le,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var mb=b(650),gc=b(910),Gc=b(589),Zc=b(769),vd=b(1583),Id=b(1580),Yd=b(199),nf=b(146);class Zf{constructor(U,Ea,kb,Nb,
nc,ad){this.xPg=this.hg=null;this.MEd=this.Qgh=!1;this.Gl=null;this.oVd=U.runtime.oVd;this.jm=U;this.Mc=Ea;this.vg=kb;this.wo=Nb;this.SWk=nc;this.graphNodeComplexMerge=ad}}Object(c.a)(Zf,"GraphNodeComplexMergeState",null,[]);var ig=b(1358),Qj=b(1341);class hh{constructor(U,Ea=null){this.Mg=U;this.Fuc=Ea||this.mvd()}get nJb(){return this.Fuc}get Mc(){return this.Mg}mvd(){return[Object(u.a)(this,this.Nwn,"simpleMerge"),Object(u.a)(this,this.jWk,"complexMerge")]}nqn(U,Ea,kb,Nb,nc,ad){Ea=new Zf(U,kb,
new xb.a(()=>new ig.a(Nb?Nb.Wj:null,nc)),new xb.a(()=>new ig.a(Nb?Nb.Wj:null,ad)),new xb.a(()=>new ig.a(ad,nc)),Ea.ici(nc,()=>U.runtime.Ka));Ea.hg=Nb.pxc;Ea.xPg=new Yd.a;return Ea}merge(U,Ea,kb,Nb,nc,ad){Ea=this.nqn(U,Ea,kb,Nb,nc,ad);kb=!0;for(Nb=0;Nb<this.nJb.length&&kb;Nb++)(kb=(0,this.nJb[Nb])(Ea))||U.logger.vKe("GraphNodeMerge.GetMergeFunctions()",Nb);if(U=Ea.MEd&&Ea.Gl?new Qj.a(Ea.Gl,!1):null)switch(U.gpn(Ea.hg),(U?U.Wj:nc).Jb){case 1074135145:Ea.jm.runtime.Iic.I$h.$(U.Wj.id,U.Wj);break;case 1074135153:Ea.jm.runtime.Iic.f1h.$(U.Wj.id,
U.Wj);break;case 1074135127:Ea.jm.runtime.Iic.V8h.$(U.Wj.id,U.Wj);break;case 393230:Ea.jm.runtime.yLe.add(U.Wj.id)}return{returnValue:Ea.MEd,Gl:U}}Nwn(U){if(U.jm.runtime.Ka&&U.jm.runtime.Ka.Cmb(1000005)&&0<U.hg.count)return!0;var Ea=U.graphNodeComplexMerge.RNd;return U.wo.value.qCd(Ea)&&U.SWk.value.qCd(Ea)?U.vg.value.qCd(Ea)?!0:(Ea=U.wo.value.We,U.MEd=!0,U.Gl=Ea.AF(),!1):(U.MEd=!0,!1)}jWk(U){const Ea=U.wo.value.We;U.oVd&&nf.a.instance.xa(4018183,1,3,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",
Ea.id,Ea.Jb);const kb=U.graphNodeComplexMerge.Lbh(U);U.MEd=kb;nf.a.instance.xa(4018184,1,kb?4:3,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",kb?"Succeeded":"Failed",Ea.id,Ea.Jb,!!U.Gl);return kb}}Object(c.a)(hh,"GraphNodeMerge",null,[1784]);class ah extends Re.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=
null;this.Prompt=this.Reason=this.Source=0}Jk(){return 33}static construct(U,Ea,kb,Nb,nc,ad,Od,af,ve,eh,Ci){const Hj=new ah;Hj.FileId=U;Hj.BaseRevisions=Ea;Hj.TheirRevisions=kb;Hj.YourRevisions=Nb;Hj.IgnoreConflictsInLastServerRevision=nc;Hj.MergeHint=ad;Hj.ObjectSpaceId=Od?nm.a(Od):null;Hj.RequestId=af?nm.a(af):null;Hj.Source=ve;Hj.Reason=eh;Hj.Prompt=Ci;return Hj}}Object(c.a)(ah,"CreateGraphMergeReplayRequest",Re.a,[]);var Dg=b(734),Oi=b(234),ij=b(17),yj=b(1721),wl=b(1680);class Jd{constructor(U,
Ea=null,kb=null){this.rL=U;this.nJ=U.pk;this.Kzb=U.yDn;this.yXb=U.yTn;this.efk=U.Xlm;this.Mg=Ea||new gc.a;this.Yik=kb||Object(u.a)(this,this.ccl,"doParagraphMergeForModifiedObject")}opd(U){const Ea=new Yd.a;for(let kb=0;kb<U.length;kb++){const Nb=this.Xbl(U.J(kb));Ea.add(Nb)}return Ea}npd(U,Ea,kb){const Nb=U.fi===U.vj&&U.startCp===U.endCp;Ea&&({zXa:U.fi,KCa:U.startCp}=this.EZa(U.fi,U.startCp,U.fi,U.startCp),Nb&&(U.vj=U.fi,U.endCp=U.startCp));kb&&!Nb&&({zXa:U.vj,KCa:U.endCp}=this.EZa(U.vj,U.endCp,
U.vj,U.endCp));return U}Xbl(U){if(U.fi===U.vj){var Ea=new Yd.a;Ea.add(U.startCp);Ea.add(U.endCp);({zXa:kb,Rjc:Nb}=this.Beh(U.fi,Ea,kb,Nb));return new Dg.a(kb,Nb.J(0),kb,Nb.J(1))}var kb=new Yd.a;var Nb=new Yd.a;let nc,ad,Od;kb.add(U.startCp);({zXa:Ea,Rjc:ad}=this.Beh(U.fi,kb,Ea,ad));Nb.add(U.endCp);({zXa:nc,Rjc:Od}=this.Beh(U.vj,Nb,nc,Od));return new Dg.a(Ea,ad.J(0),nc,Od.J(0))}Beh(U,Ea,kb,Nb){kb=U;Nb=Ea;if(!this.nJ.J(U))return qa.ULS.sendTraceTag(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",
U),{zXa:kb,Rjc:Nb};if(this.Kzb.get(U))({zXa:kb,Rjc:Nb}=this.Yik(U,Ea,kb,Nb));else if(this.rL.Tig&&!this.rL.Tig.J(this.rL.Tig.length-1).sY(U)){Nb=new Yd.a;for(let nc=0;nc<Ea.length;nc++){let ad;({zXa:kb,KCa:ad}=this.EZa(U,Ea.J(nc),kb,ad));Nb.add(ad)}}return{zXa:kb,Rjc:Nb}}Xzi(U){let Ea="";U.forEach(kb=>{Ea+=kb.cZa();Ea+=" ";return!0});return Ea}hAi(U){const Ea=ia.a.instance.sa("Box4.IFeatureHelper"),kb=new yj.a;kb.input.source=this.rL.Meg;kb.input.rca=this.rL.rca;kb.input.jrd=()=>Ea;kb.runtime.pk=
this.nJ;kb.runtime.MRa=this.rL.PVk;1===U?(kb.runtime.Zu=this.yXb,kb.runtime.Kr=this.Kzb,kb.runtime.Tte=this.rL.CWi,kb.runtime.c3e=this.rL.OWi):2===U&&(kb.runtime.Zu=this.Kzb,kb.runtime.Kr=this.yXb,kb.runtime.Tte=this.rL.OWi,kb.runtime.c3e=this.rL.CWi);kb.runtime.Ka=Ea;return kb}ccl(U,Ea,kb,Nb){kb=U;Nb=Ea;var nc=this.Kzb.get(U);if(!nc)return{zXa:kb,Rjc:Nb};Nb=new Yd.a;Nb.add(nc);var ad=this.yXb.get(U)||this.nJ.J(U);nc=new Yd.a;nc.add(ad);ad=new Yd.a;ad.add(this.nJ.J(U));qa.ULS.sendTraceTag(17409890,
318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.rL.Meg,this.rL.rca,this.Xzi(nc),this.Xzi(Nb));var Od=this.hAi(this.rL.rca);this.tml(Od,U,Nb);nc=new wl.a(Od,ad,1===Od.input.rca?nc:Nb,1===Od.input.rca?Nb:nc,this.hAi(1),nc,Nb);Nb=new Yd.a;for(ad=0;ad<Ea.length;ad++){this.rL.hG("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const af=({Bsb:kb,KCa:Od}=nc.v_d(U,Ea.J(ad))).returnValue;Nb.add(Od);af?qa.ULS.sendTraceTag(17409891,
318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",U,Ea.J(ad),kb,Od):qa.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",U)}return{zXa:kb,Rjc:Nb}}tml(U,Ea,kb){if(U.runtime.Zu.Na(Oi.a.DO)){var Nb=U.runtime.Zu.J(Oi.a.DO);Nb=this.Mg.getPropertyObjectIds(Nb,Tc.a.D5);if(1===Nb.length&&(Nb=Nb.J(0),U.runtime.Zu.Na(Nb)&&
(Nb=U.runtime.Zu.J(Nb),3===this.Mg.getPropertyInt32(Nb,Tc.a.BZa)))){const nc=this.Mg.getPropertyString(Nb,Tc.a.E5),ad=this.Mg.getPropertyString(Nb,Tc.a.mPb);Ea.toString()===nc&&nc===ad&&(Ea=this.Mg.getPropertyObjectId(Nb,Tc.a.vVc),U.runtime.Zu.Na(Ea)&&kb.add(U.runtime.Zu.J(Ea)))}}}jJl(U,Ea){let kb=0;for(let Nb=0;Nb<U.length;Nb++)if(Ea.equals(U.J(Nb)))return kb=Nb,{returnValue:!0,cY:kb};return{returnValue:!1,cY:kb}}EZa(U,Ea){const kb=this.efk&&!!this.yXb.J(U)&&!this.nJ.J(U);let Nb=U,nc=Ea,ad=!1,Od=
!1;(kb?this.yXb:this.Kzb).forEach((af,ve)=>{this.rL.hG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");if(this.yqg(ve.Jb)&&this.nJ.J(af)){ve=null;if(kb){ve=this.Nvd(Ci=>this.yXb.J(Ci)||this.nJ.J(Ci),af);var eh=this.rGe(ve,U)}else eh=this.Nvd(Ci=>this.nJ.J(Ci),af),eh=this.rGe(eh,U);if(eh&&(Od=!0,ve||(ve=this.Nvd(Ci=>this.yXb.J(Ci)||this.nJ.J(Ci),af)),af=this.Nvd(Ci=>this.Kzb.J(Ci)||this.nJ.J(Ci),af),eh=0,({cY:eh}=this.jJl(ve,U)).returnValue)){for(let Ci=eh+1;Ci<ve.length;Ci++)if(this.rGe(af,
ve.J(Ci)))return nc=0,Nb=ve.J(Ci),ad=!0,!1;for(--eh;0<=eh;eh--)if(this.rGe(af,ve.J(eh)))return nc=Number.MAX_VALUE,Nb=ve.J(eh),ad=!0,!1}}return!0});if(!ad&&(qa.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",U,Ea,kb,Od),5===this.rL.Meg)){qa.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",
Nb);let af;({dpi:af}=this.lAl(af)).returnValue?(Nb=af,nc=0,qa.ULS.sendTraceTag(17340241,318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",Nb)):qa.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",Nb)}return{zXa:Nb,KCa:nc}}lAl(U){U=$b.a.nil;let Ea=new Yd.a;this.Kzb.forEach((kb,
Nb)=>{this.rL.hG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");return this.yqg(Nb.Jb)?(Ea=this.Nvd(nc=>this.Kzb.J(nc)||this.nJ.J(nc),kb),!1):!0});return 0<Ea.length?(U=Ea.J(0),{returnValue:!0,dpi:U}):{returnValue:!1,dpi:U}}yqg(U){return 393241===U||393250===U||393251===U||393252===U}Nvd(U,Ea){var kb=U(Ea);Ea=new Yd.a;if(!this.yqg(kb.Jb))return Ea;kb=this.Mg.getPropertyObjectIds(kb,ij.a.jf);for(let Nb=0;Nb<kb.length;Nb++){const nc=new Yd.a;this.pag(U,kb.J(Nb),nc);Ea.$B(Ea.length,
nc)}return Ea}pag(U,Ea,kb){var Nb=U(Ea);if(Nb)if(393230===Nb.Jb)kb.add(Ea);else if(393229===Nb.Jb)Ea=this.Mg.getPropertyObjectIds(Nb,ij.a.rP).Rf(0),this.pag(U,Ea,kb);else if(393250===Nb.Jb||393251===Nb.Jb||393252===Nb.Jb)for(Ea=this.Mg.getPropertyObjectIds(Nb,ij.a.jf),Nb=0;Nb<Ea.length;Nb++)this.pag(U,Ea.J(Nb),kb)}rGe(U,Ea){for(let kb=0;kb<U.length;kb++)if(Ea.equals(U.J(kb)))return!0;return!1}}Object(c.a)(Jd,"GraphMergeSelectionRecordUpdater",null,[]);class fl extends vd.a{constructor(U=null,Ea=null,
kb=null,Nb=null,nc=null,ad=null,Od=null,af=null,ve=-1,eh=null,Ci=null,Hj=null){super();this.DZ=U||(()=>J.AFrameworkApplication.rootQuerySignature);Ea||(Ea=Bf=>new mb.a(Bf));this.YLh=Ea;this.Mg=kb||new gc.a;this.Hqh=Od||new Id.ChildNodeListMerge(this.Mc);this.$vc=af;this.Grj||(this.$vc=(Bf,Vi,Lj)=>new Gc.a(Bf,Vi,Lj));this.Fuc=Nb||this.mvd();this.Kyb=nc||new Ff.a;this.Yxh=ad||new hh(this.Mc);this.oFh=void 0===ve||null===ve||-1===ve?dk.App.lTj:ve;this.pMa=eh;this.x_a=Ci;this.SAe=this.p$k(Hj);this.Wvh=
()=>ia.a.instance.sa("Box4.IFeatureHelper")}p$k(U){U||(U=J.AFrameworkApplication.K?J.AFrameworkApplication.K.jb("WordEditorGraphMergeBackupCasesBrowser",0):0);return U}uTa(){return(new Date).getTime()}dGj(U,...Ea){return String.format.apply(null,[U].concat(Ea))}PDn(U){throw vh.a.invalidOperation(U);}axe(U){return String.format("Name: {0}, Message: {1}, Stack: {2}",U.name,U.message,U.stack)}MSm(U){if(this.pMa&&this.pMa.lVi||!this.cBn(U))return null;this.Com(U);let Ea;({vGk:Nb,xDn:nc,xTn:Ea}=this.i4k(U,
Object(u.a)(this,this.wdi,"createSerializedRevisionFrom")));const kb=vd.a.jBl(U);var Nb=ah.construct(this.DZ(),Nb.aia(),nc.aia(),Ea.aia(),U.input.mIc,U.input.rca,U.input.gl,U.input.mfc,U.input.source,kb,this.x_a.mKa);var nc=U.output.NS;3===kb&&0<nc.length&&(Nb.MergedRevision=this.wdi(U.output.NS.last()));return Nb}wdi(U){const Ea=U.uaa,kb=Qe.App.oa.za.jc;return new Zc.a(U,Ea,kb.kd,kb.fileId,kb.bjc,kb.contextId,Ea?Ea.id:$b.a.nil,this.Grj,!1,!0)}opd(U,Ea){return(new Jd(U)).opd(Ea)}npd(U,Ea,kb,Nb){return(new Jd(U)).npd(Ea,
kb,Nb)}}Object(c.a)(fl,"GraphMerger",vd.a,[]);class go extends fl{constructor(U,Ea=null,kb=null){super(U,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Ea,kb);this.ka=new r.a}get mKa(){return this.x_a?this.x_a.mKa:0}get delayedMergeOperation(){return null}set delayedMergeOperation(U){}xyk(U){this.ka.addHandler(go.Leg,U)}S7m(U){this.ka.removeHandler(go.Leg,U)}n4g(){return!1}zMc(U,Ea,kb,Nb,nc,ad,Od){(U=super.zMc(U,Ea,kb,Nb,nc,ad,Od))&&this.ka.raiseEvent(go.Leg,new le(U));return U}}go.Leg="GMC";
Object(c.a)(go,"WordEditorGraphMerger",fl,[1786,1272,1273]);class Zp{constructor(){this.Z=null}get name(){return"WordEditor.GraphMerge"}Hb(U){this.Z=U;this.Z.ha("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new Hd(this.Z.Ca("WordEditor.IBusinessBarController"),new xb.a(()=>U.sa("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").singleInstance();this.Z.ha("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new cd(this.Z.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").singleInstance();
this.Z.ha("WordEditor.GraphMerge.WordEditorGraphMerger",()=>new go(()=>J.AFrameworkApplication.rootQuerySignature,this.Z.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.Z.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").singleInstance();this.Z.ha("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new Hc(()=>J.AFrameworkApplication.rootQuerySignature,J.AFrameworkApplication.pa,this.Z.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),
this.Z.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.Z.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").singleInstance()}init(){Qe.App.OV||(Qe.App.OV=Bb.a.Afa());const U=this.Z.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");Qe.App.OV.eHk(U);this.Z.resolve("Box4.IGraphMergeBackupManager")}dispose(){let U=this.Z.sa("Box4.IGraphMergeBackupManager");U&&U.dispose()}}Object(c.a)(Zp,"GraphMergePackage",null,[1,2]);var zm=b(94);class yp{constructor(U){this.Quc=
0;this.hh=U}Iei(U){this.Quc=Math.max(0,--this.Quc);this.gpj(U);0<this.Quc&&window.setTimeout(()=>{this.Iei(U)},1E3)}gpj(U){U.style.backgroundColor="rgba(255,0,0,"+Math.min(1,this.Quc/20)+")"}b9m(U){this.hh&&this.hh.yOm&&(this.Quc++,this.gpj(U),this.hh.n7i=oh.a.Ksd(U,!1),1===this.Quc&&window.setTimeout(()=>{this.Iei(U)},1E3))}}Object(c.a)(yp,"ParagraphRenderVisualizationManager",null,[1787]);class xn{constructor(U,Ea,kb,Nb,nc){this.uad=this.J4d=this.ced=this.hh=null;this.Fbf=new W.a;this.xad=null;
this.TGh=0;this.ga=U;this.YW=Ea;this.ag=kb;this.hGa=Nb;this.msh=nc}get yOm(){return this.uad?this.uad.checked:!1}get n7i(){return this.TGh}set n7i(U){this.xad&&(this.xad.innerText=String.format("Total number of child elements in last rendered paragraph: {0}",U));this.TGh=U}lb(){this.ga.ma(bd.a.sbi,He.a.application,Object(u.a)(this,this.showTaskPane,"showTaskPane"))}dispose(){null!==this.hh&&(this.YW.Q6b(xn.nB,this.hh),this.hh=null);this.hGa.execute(U=>{this.Oli(U,Ea=>{Ea.g8m(Object(u.a)(this,this.sbj,
"onTypingSpeedMeterWindowAvailable"))})});this.msh.execute(U=>{this.Nli(U,Ea=>{Ea.CUe(Object(u.a)(this,this.qgc,"onCpuMeterFrameAvailable"))})})}sbj(U,Ea){this.ced&&(this.ced.innerText=Ea.nzm+" CPM")}qgc(U,Ea){this.J4d&&(this.J4d.innerText=Ea.SId.CP+"%",this.Fbf.add(Ea.SId.CP))}Lpe(){const U=new Te.CuiHelper(zm.a.A2a,Box4Intl.Box4Strings);this.hh=this.YW.GSf(xn.nB,0,xn.width,"InteractivePerfTaskPaneData",U);this.XZk();this.UZk();this.WZk()}showTaskPane(){if(!Qe.App.oa.L9a)return 16;this.hh||this.Lpe();
this.YW.showTaskPane(this.hh);this.hh.element.style.overflow="scroll";return 32}W8f(U){U=document.getElementById(U);return oh.a.qTa(oh.a.qTa(U,"cui-groupContainer"),"cui-groupBody")}Nli(U,Ea){const kb=U.Ko.task;kb.continueWith(()=>{Ea(kb.result)})}Oli(U,Ea){const kb=U.Ko.task;kb.continueWith(()=>{Ea(kb.result)})}XZk(){const U=this.W8f("TypingSpeedMeterGroup");U.style.margin="10px";U.style.fontSize="15px";const Ea=document.createElement("div");Ea.innerText="Typing Speed";this.ced=document.createElement("div");
this.ced.innerText="0 CPM";this.hGa.execute(kb=>{this.Oli(kb,Nb=>{Nb.fzk(Object(u.a)(this,this.sbj,"onTypingSpeedMeterWindowAvailable"))})});U.appendChild(Ea);U.appendChild(this.ced)}UZk(){const U=this.W8f("CpuMeterGroup");U.style.margin="10px";U.style.fontSize="15px";const Ea=document.createElement("div");Ea.innerText="CPU Meter";this.J4d=document.createElement("div");this.msh.execute(nc=>{this.Nli(nc,ad=>{ad.hgd(Object(u.a)(this,this.qgc,"onCpuMeterFrameAvailable"))})});const kb=document.createElement("div"),
Nb=document.createElement("button");Nb.innerText="View Cpu Percent";this.ag.Ea(w.a.click,Nb,Object(u.a)(this,this.jbl,"displayCpuPercentLogs"));kb.appendChild(Nb);U.appendChild(Ea);U.appendChild(this.J4d);U.appendChild(kb)}WZk(){const U=this.W8f("RenderGroup"),Ea=document.createElement("label");Ea.innerText="Enable render visualizations";this.uad=document.createElement("input");this.uad.setAttribute("type","checkbox");U.appendChild(this.uad);U.appendChild(Ea);this.xad=document.createElement("div");
this.xad.style.margin="10px";U.appendChild(this.xad);ia.a.instance.ha("Box4.IParagraphRenderVisualizationManager",()=>new yp(this))}jbl(){const U=da.a.Tk("","LogFile","","InteractivePerf.DisplayCpuPercentLogs").document;U.writeln("<HEAD>");U.writeln('<STYLE type="text/css">');U.writeln("* { padding: 0px; margin: 0px; font-family: monospace; }");U.writeln("</STYLE>");U.writeln("</HEAD>");U.writeln("<BODY style='BACKGROUND-COLOR: #f3f8fd;'>");const Ea=document.createElement("div");var kb=document.createElement("div");
kb.innerText=String.format("{0}, {1}","Frame","CpuPercent");Ea.appendChild(kb);for(kb=0;kb<this.Fbf.count;kb++){const Nb=this.RIk(kb,this.Fbf.J(kb));Nb&&Ea.appendChild(Nb)}U.writeln(Ea.innerHTML);U.writeln("</BODY>");U.close();return!0}RIk(U,Ea){U=U.toString();Ea=Ea.toString();const kb=document.createElement("div");kb.innerText=String.format("{0}, {1}",U,Ea);return kb}}xn.nB="InteractivePerfTaskPane";xn.width=400;Object(c.a)(xn,"InteractivePerfTaskPane",null,[]);class gm{constructor(){this.hh=null}get name(){return"WordEditor.InteractivePerfTaskPane"}Hb(U){U.ha("WordEditor.InteractivePerfTaskPane.InteractivePerfTaskPane",
()=>new xn(J.AFrameworkApplication.pa,dh.a.instance,J.AFrameworkApplication.la.Qu,U.Ca("Common.ITypingSpeedMeterProvider"),U.Ca("Common.ICpuMeterProvider"))).singleInstance()}init(){if(this.hh=ia.a.instance.sa("WordEditor.InteractivePerfTaskPane.InteractivePerfTaskPane"))this.hh.lb(),"1"===Db.a.UL(document.URL,"wdShowIPerfTaskPane")&&J.AFrameworkApplication.pa.processAction(bd.a.sbi,2)}dispose(){this.hh&&(this.hh.dispose(),this.hh=null)}static main(){ba.a.instance.Sb(new gm)}}Object(c.a)(gm,"InteractivePerfTaskPanePackageManager",
null,[1,2]);var ek=b(285);class wr{constructor(U){this.Haf="FontPicker";this.xjf=null;this.Ywb=U;this.v6d=this.Ywb.oXa(ek.a.MIb,Object(u.a)(this,this.T7b,"featureStateChangeCallback"));this.Ywb.isFeatureEnabled(ek.a.MIb,!1).then(Ea=>{this.xjf=Ea})}get isLicensed(){return this.xjf}T7b(U){this.xjf=U.isEnabled;U=appChrome.actions.updateFontPickerLicenseState(this.Haf,U.isEnabled);appChrome.api.dispatch(U)}dispose(){this.Ywb.vQc(ek.a.MIb,this.v6d)}}Object(c.a)(wr,"ModernFontPickerFeatureHelper",null,
[937,12]);var Tg=b(468),vo=b(602),Gn=b(1482);class Sk{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(c.a)(Sk,"FontInfoTaskPaneProps",null,[]);class om{constructor(U,Ea,kb,Nb=null){this.Vxf=this.lL=this.v6d=null;this._state=this.iuc=0;this.Qlf=U;this.Ywb=Ea;this.A3j=kb;this.ib=Nb}get Tb(){return this.Qlf.value}initialize(){this.Tb.ma(za.a.lVe,Je.a.frame,Object(u.a)(this,this.lVe,
"requestFontInfo"));this.v6d=this.Ywb.oXa(ek.a.MIb,Object(u.a)(this,this.T7b,"featureStateChangeCallback"));this.Wta()}HV(U=!1){const Ea=ie.UISurfaces.Nv(),kb=this.Ywb.isFeatureEnabled(ek.a.MIb,!1),Nb=[];Nb.push(Ea);Nb.push(kb);Promise.all(Nb).then(nc=>{nc[0].showTaskPane(Gn.a.o8b,this.GF(nc[1]));U&&this.iJ()})}fOn(U){ie.UISurfaces.Nv().then(Ea=>{Ea.updateTaskPane(Gn.a.o8b,this.GF(U));return null})}T7b(U){this.fOn(U.isEnabled)}lVe(U,Ea,kb,Nb,nc){this.lL=nc.CommandValueId;this.Vxf=nc.Trigger;this.iuc=
nc.InputMethod;this.HV(2===this._state&&1===this.iuc);return 32}GF(U){const Ea=new Sk;Ea.onUpsellButtonClicked=Object(u.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");Ea.fontName=this.lL;Ea.isLicensed=U;Ea.trigger=this.Vxf;Ea.helpArticleUrl=this.kXk();Ea.paneId=Gn.a.o8b;U=this.z2l();U.contentProps=Ea;return U}z2l(){return Object.assign(new zd.a,{title:Gn.a.CKb,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(u.a)(this,
this.onOpen,"onOpen"),onClose:Object(u.a)(this,this.onClose,"onClose"),onShow:Object(u.a)(this,this.onShow,"onShow"),onHide:Object(u.a)(this,this.onHide,"onHide")})}Wta(){if(this.ib){var U=this.ib.Kc(Gn.a.o8b);U.parent=gi.AFrame.hp;U.uK=!0}}onOpen(){this._state=2;this.iJ()}onShow(U){0!==this._state&&(this._state=2,1===U&&(this.iuc=U),this.iJ())}onClose(){this.iuc=this._state=0;this.blur()}onHide(){this._state=1;this.iuc=0}iJ(){this.ib&&1===this.iuc&&this.ib.wf(Gn.a.o8b)}blur(){this.ib&&this.ib.Zd&&
this.ib.Zd.name===Gn.a.o8b&&this.ib.wf(this.ib.uI)}onUpsellButtonClicked(){this.Ywb.launchUpsellExperience(Gn.a.experienceId)}dispose(){this.Ywb.vQc(ek.a.MIb,this.v6d)}kXk(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.A3j,this.XBl(),"WDWAENDUSER",J.AFrameworkApplication.lcid)}XBl(){switch(this.Vxf){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";
case "theme":return"hlpFontInfoThemeFont"}return om.uIk(this.lL)}static uIk(U){let Ea="hlpFontInfo";for(let kb=0;kb<U.length;++kb){const Nb=bc.a.charAt(U,kb);if(255<U.charCodeAt(kb)||bc.a.HEe(Nb))Ea+=Nb}return Ea}}Object(c.a)(om,"FontInfoPane",null,[936,12]);class Hn extends om{constructor(U,Ea,kb,Nb,nc){super(U,Ea,Nb.Ga("FontInfoHelpBaseUrl"),nc);this.YW=kb}HV(U){this.K6();super.HV(U)}T7b(U){super.T7b(U);Qe.App.oa.updateCommandUI()}K6(){this.YW.t3a()}}Object(c.a)(Hn,"WordEditorFontInfoPane",om,[]);
class no{constructor(){this.Osc=this.Z$d=this.Q1c=this.Z=null}get name(){return"WordEditor.ModernFontPicker"}Hb(U){this.Z=U;U.ha("Common.ModernFontPicker.IModernFontPickerFeatureHelper",()=>new wr(this.Z.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).singleInstance();U.ha("Common.ModernFontPicker.IFontInfoPane",()=>new Hn(new xb.a(()=>J.AFrameworkApplication.pa),this.Z.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),dh.a.instance,J.AFrameworkApplication.K,
ae.FocusManager.instance())).singleInstance()}init(){this.Z$d=this.Z.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");this.Q1c=this.Z.resolve("Common.ModernFontPicker.IFontInfoPane");this.Q1c.initialize();J.AFrameworkApplication.K.ea("IsAnonymousUser")||((this.Osc=this.Z.sa(vo.a))?this.Osc.initialize():qa.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));Qe.App.oa.updateCommandUI()}dispose(){this.Q1c&&(this.Q1c.dispose(),this.Q1c=null);this.Z$d&&(this.Z$d.dispose(),
this.Z$d=null);this.Osc&&(this.Osc.Akd(),this.Osc=null)}static main(){Object(Tg.a)()&&ba.a.instance.Sb(new no)}}Object(c.a)(no,"ModernFontPickerPackage",null,[1,2]);var $p=b(125),Qm=b(5),gl=b(40),ph=b(18),Mr=b(969);class Ti{constructor(U,Ea,kb,Nb,nc,ad,Od,af,ve,eh,Ci,Hj=null){this.Sy=kb;this.mc=U;this.Nb=Ea;this.Ee=nc;this.n_a=ad;this.mF=Od;this.nqh=af;this.mqh=ve;this.kk=eh;this.L4d=Hj||Ti.kz}get ye(){return this.kk?this.kk.ye:!1}tNi(U){return this.OUa(U,0)}R4l(U){return this.OUa(U,1)}OUa(U,Ea){let kb=
null;if(this.ye&&this.mF&&(this.mqh.instance&&this.mqh.instance.rZa(U),Ea?1===Ea&&(kb=this.mF.b$f(U.node)):kb=this.mF.rwe(U.node,U.cpBegin,U.Ma),kb&&!kb.fa(Tc.a.J7,!1)))return qa.ULS.shipAssertTag(24749379,368,!1,"Try to insert page break to inconvertible inline content control"),2;const Nb=Qm.GraphIterator.dH(this.mc.Sl());Nb.set(U.node);Nb.La(10);const nc=this.Nb.Wb(15);nc.Ir(Nb);Ea?gl.OutlineElementNavigator.Uc(Nb):(this.splitParagraph(Nb,U),this.Sy.fVc(U.node,ng.a.Ms));U=Ni.ParagraphReader.Im(Nb.currentNode);
this.V5l(Nb);this.ye&&kb&&this.nqh&&(Ea=new W.a,Ea.add(Nb.currentNode),this.nqh.JTh(Ea,kb.id));this.Fln(U);nc.dispose();return 32}Fln(U){U=Fg.SelectionFactory.Pc(U,0);mo.a.instance.setSelection(U)}V5l(U){this.Ee.BE(U,!0,!0,null,!1,!1);U=gl.OutlineElementNavigator.Sd(U);this.S4l(U)}splitParagraph(U,Ea){const kb=gl.OutlineElementNavigator.Uc(U);if(Ea.cpBegin||this.ye&&(!this.ye||-1!==Ea.Ma)){ph.a.instance.J(4)&&Qe.App.lc.eq&&Ea.cpBegin!==Ni.ParagraphReader.textLength(Ea.node)&&Qe.App.lc.Mp.MJ(Ea.node);
this.Ee.BE(U,!1,!0,null,!1,!0);var Nb=Qm.GraphIterator.dH(this.mc.Sl());Nb.set(kb);this.Ee.voa(Nb,U,Ea,!0,!0,!0)}}S4l(U){U=this.L4d(U);this.n_a.PNi(U)}static FF(){return new Ti(new co.a,new Ch.a,ia.a.instance.resolve("Box4.IAutoCorrectScheduler"),Mr.a.instance,ia.a.instance.resolve("Box4.IOutlineElementEditor"),ia.a.instance.resolve("Box4.IBlobEditor"),ia.a.instance.sa("Box4.IContentControlReader"),ia.a.instance.sa("Box4.IContentControlEditor"),ia.a.instance.Ca("Box4.IContentControlConverter"),ia.a.instance.sa("Box4.ContentControlConfigSettings"),
ia.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return Ti.na||(Ti.na=Ti.FF())}static kz(U){return Rk.a.kz(U)}}Ti.na=null;Object(c.a)(Ti,"PageBreakInserter",null,[1813]);class pi{constructor(U,Ea,kb,Nb,nc,ad,Od,af){this.ga=U;this.sif=Ea;this.Nb=kb;this.Wl=Nb;this.vkf=nc;this.vn=ad;this.cdk=Od;this.Eb=af}lb(){this.ga.ma(bd.a.OUa,He.a.view,Object(u.a)(this,this.Y5l,"insertPageBreakViewHandler"));this.ga.ma(bd.a.OUa,He.a.Ub,Object(u.a)(this,this.X5l,"insertPageBreakIpHandler"));
this.ga.ma(bd.a.OUa,He.a.table,Object(u.a)(this,this.W5l,"insertPageBreakBeforeTableHandler"));this.ga.$b(bd.a.OUa,4)}DV(){const U=ae.FocusManager.instance().Kc($p.AppFrame.lE);gi.AFrame.lj(U,Ga.KeyInputManager.$a(ng.a.Ms,Ga.KeyInputManager.mh),bd.a.OUa)}Y5l(U,Ea,kb,Nb){var nc=Ea.view,ad=nc.Oa.Ag;if(!ad)return 2;if(!this.sLf(Ea))return 8;if(1===kb)return 32;let Od=!0;kb=8;const af=this.vkf(ad);ad=this.Nb.Wb(15);ad.Sa(nc.xc);ad.om=U;af||(kb=this.ga.rf(Ea,Of.a.ara,2,!0,Nb,null),U=32===kb,qa.ULS.shipAssertTag(4208012,
314,U),Od=U);Od&&(nc=nc.Oa.Ag,U=this.vkf(nc),qa.ULS.shipAssertTag(4208013,314,U,"{0}",{["ContextId"]:Ea.contextId}),kb=8,U&&(kb=this.sif.tNi(nc),qa.ULS.shipAssertTag(4208014,314,32===kb)));ad.dispose();32===kb&&this.Eb.Ws(10);return kb}Rbm(U){return this.Pv(U.iterator)}kem(U){U=U.J(0);const Ea=Jj.SelectionEditor.Xf(U,!0,!1);if(this.Pv(Ea.ra.iterator))return!0;U=Jj.SelectionEditor.Xf(U,!1,!1);return this.Pv(U.ra.iterator)}Pv(U){return U.La(14)}X5l(U,Ea,kb){if(!Ea||Ea.contextId!==He.a.Ub)return 8;if(1===
kb)return Ea.contextId===He.a.Ub?32:8;if(2===kb){if(!this.sLf(Ea))return 8;U=this.sif.tNi(Ea);32===U&&this.Eb.Ws(10);return U}return 32}W5l(U,Ea,kb){if(!Ea||Ea.contextId!==He.a.table)return 8;if(1===kb)return 32;if(2===kb){if(!this.sLf(Ea))return 8;U=this.sif.R4l(Ea);32===U&&this.Eb.Ws(10);return U}return 32}sLf(U){let Ea=null,kb=U;if(kb.contextId===He.a.view){Ea=kb.view;if(!Ea.features.q0e)return!1;kb=Ea.Oa.Ag;if(!kb)return!1}else{const Nb=Qm.GraphIterator.ua(kb.node);if(Nb.La(36)||Nb.La(38)||Nb.La(40)||
Nb.La(14))return!1}return Qe.App.A4b(U)?!1:kb.contextId===He.a.table?this.vn.$Ri(kb.node):!this.vn.ZRi(kb)||this.Wl&&this.Wl.instance&&this.Wl.instance.l0(kb)?!1:((U=this.vkf(kb))?this.Rbm(kb):this.kem(Ea.Oa.ya))||U&&this.cdk(kb,!0)?!1:!0}static FF(){return new pi(J.AFrameworkApplication.pa,Ti.instance,new Ch.a,ia.a.instance.Ca("Box4.IExternalSelectionManager"),Jj.SelectionEditor.Cd,Lg.a.instance,oj.HyperlinkReader.s4,ia.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return pi.na||
(pi.na=pi.FF())}}pi.na=null;Object(c.a)(pi,"PageBreakActor",null,[1782]);class wo{constructor(){this.Rpf=this.Z=null}get name(){return"WordEditor.PageBreak"}Hb(U){this.Z=U}init(){this.Z.resolve("Box4.IFeatureHelper").tk.continueWith(()=>{this.Po()})}Po(){this.Rpf=pi.instance;this.Rpf.lb();this.Rpf.DV();Qe.App.oa.updateCommandUI()}dispose(){}}Object(c.a)(wo,"PackageManager",null,[1,2]);var rq=b(1282),ho=b(78),In=b(1283),Og=b(241),xr=b(162),fr=b(246),Nr=b(277),ms=b(355);class Nq{constructor(U,Ea,kb,
Nb,nc,ad,Od){this.UYb=null;this.ka=new r.a;this.acf=1;this.g$d=-1;this.beb=null;this.Da=Ea;this.fb=kb;this.H5d=Nb;this.aN=nc;this.Un=ad;this.tL=Od;this.enable()}get Lnd(){return this.acf}Jzj(U){this.acf!==U&&(this.acf=U,this.ka.raiseEvent("X"),this.Cqg&&this.deh())}get Cqg(){const U=ia.a.instance.sa("WordEditor.Pagination.IPageEndMarkers");return U?U.Cqg:!0}get ef(){return this.aN.value}get mj(){return hj.a.instance}Nxk(U){this.ka.addHandler("X",U)}deh(){this.mj.Fd(()=>{this.tL.yV(ms.a.Ncj)},"CPC:UPN")}enable(){this.Da.dE(Object(u.a)(this,
this.Aca,"onProcessSetSelectionFinished"));this.NJf()}Aca(){this.NJf()}NJf(){if(!this.beb||1>=this.beb.count)this.Jzj(1);else{var U=this.Da.ya.Ba;if(U){var Ea=U.Ac?U.Fb:U.ra;!Ea||0>Ea.cpBegin||(U=Ea.node)&&Ni.ParagraphReader.nb(U)&&this.ubm(U)&&(this.UYb&&(this.fb.ie(this.UYb),this.UYb=null),this.UYb=new uc.a(2,1,400,kb=>{this.findCurrentPageFromIp(kb,Ea)},62),this.fb.rb(this.UYb))}}}ubm(U){U=Qm.GraphIterator.ua(U);return U.La(35)||U.La(37)||U.La(39)?!1:!0}tPj(U){this.beb=U;this.iOj()}iOj(){if(-1!==
this.g$d){var U=this.jkl(this.g$d);-1!==U&&this.Jzj(U)}}findCurrentPageFromIp(U,Ea){this.UYb===U&&(this.UYb=null,this.g$d=this.rql(Ea),-1!==this.g$d&&this.iOj())}jkl(U){if(!this.beb)return-1;for(let Ea=0;Ea<this.beb.count;Ea++){const kb=this.beb.J(Ea);if(U>kb.HSh&&U<kb.HSh+kb.height)return kb.Nj}return-1}rql(U){var Ea=this.wJl(U);if(!Ea||!Ea.htmlElement)return-1;const kb=Ea.getBounds();U=this.wwl(U,Ea);if(!U)return-1;Ea=da.a.TTa(this.H5d.xKb,Ea.htmlElement).y;return U.y+Math.floor(U.height/2)-kb.y+
Ea}wJl(U){return U.node.Qd(this.ef.Za)}wwl(U,Ea){U=this.Un?this.Un.GU(U,!0):U.cpBegin;return Nr.a.xl(Ea,U)}disable(){this.Da.Vna(Object(u.a)(this,this.Aca,"onProcessSetSelectionFinished"))}}Object(c.a)(Nq,"CurrentPageCalculator",null,[1936,1931]);class zp{constructor(U){zp.X5=U}get ATf(){return zp.X5}get Lnd(){return this.ATf.Lnd}Bel(){this.ATf.enable()}gal(){this.ATf.disable()}}zp.X5=null;Object(c.a)(zp,"CurrentPageManager",null,[1935]);var Uh=b(109);class pm extends Sys.EventArgs{constructor(U,
Ea){super();this.g6i=Ea}}Object(c.a)(pm,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class Mi extends Sys.EventArgs{constructor(U,Ea,kb){super();this.delta=U;this.g6i=kb}}Object(c.a)(Mi,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class oo{constructor(U,Ea,kb){this.lKh=this.vce=-1;this.K9c=null;this.ka=new r.a;this.cof=!1;this.aN=U;this.Rbb=Ea;this.Ydb=new W.a;this.ef.DCf(Object(u.a)(this,this.PNm,"pageViewOnAfterValidate"));this.Chg();this.XBa=this.XBa.bind(this);kb.Ayc(this.XBa)}get ef(){return this.aN.value}XBa(){this.K9c=
null}get xKb(){this.K9c||(this.K9c=this.ef.xc.Qd(this.ef.Za).xKb,qa.ULS.shipAssertTag(34136386,336,!!this.K9c));return this.K9c}Iyk(U){this.ka.addHandler("OnPageContentSizeChangeKey",U)}PNm(U,Ea){this.cof=this.jQk();Ea.y7a||this.Rbb.value.measure(Object(u.a)(this,this.eQk,"checkForDocumentSizeChanges"))}eQk(){const U=this.xKb.clientHeight;this.dQk(U);this.mQk(U)}dQk(U){U!==this.lKh&&(this.ka.raiseEvent("OnDocumentBottomChangeKey",new pm(U,this.cof)),this.lKh=U)}mQk(U){U!==this.vce&&(-1!==this.vce&&
this.ka.raiseEvent("OnPageContentSizeChangeKey",new Mi(U-this.vce,U,this.cof)),this.vce=this.xKb.clientHeight)}jQk(){let U=!1;for(let Ea=this.Ydb.count-1;0<=Ea;Ea--)this.Ydb.J(Ea).hasChildNodes()&&(this.Ydb.removeAt(Ea),U=!0);return U}Chg(){Qe.App.jj.Cm.Oe(23).tq(Object(u.a)(this,this.EKg,"outlineGroupOnPropertyChanged"))}EKg(U,Ea){Ea.property===Uh.a.NB&&(U=Ea.node)&&U.fa(Uh.a.NB,!1)&&(U=U.Qd(this.ef.Za))&&(U=U.htmlElement)&&this.Ydb.add(U)}}Object(c.a)(oo,"DocumentSizeManager",null,[]);var Am=b(58),
yg=b(262);class nl{constructor(U){this.aN=U}get ef(){const U=this.aN.value;qa.ULS.shipAssertTag(37820298,336,U.gj,"OutlineManager.PageView is not a PageView.");return U}UXe(U,Ea){const kb=Am.a.Rh(nl.pi.Kv(U),1);Ea+=kb;U.Qd(this.ef.Za).htmlElement.firstChild.style.minHeight=Ea+"px"}vxi(){const U=Qm.GraphIterator.ua(this.ef.xc);U.tn();U.Rc();qa.ULS.shipAssertTag(37820299,336,10===U.Hm.type);return U.Hm}uzi(){const U=Qm.GraphIterator.ua(this.ef.xc);U.tn();U.QN();qa.ULS.shipAssertTag(37820300,336,10===
U.Hm.type);return U.Hm}YKl(U){const Ea=Qm.GraphIterator.ua(this.ef.xc);Ea.tn();Ea.Rc();let kb=Ea.Hm,Nb=null;for(;U!==kb&&Ea.yg();)Nb=kb,kb=Ea.Hm;qa.ULS.shipAssertTag(37820301,336,10===Ea.Hm.type);return Nb}static get pi(){return yg.a.instance}}Object(c.a)(nl,"OutlineManager",null,[1934]);class Jo{constructor(U){this.yOa=0;this.r9=null;this.fb=U}pPe(){this.r9||(this.r9=this.lnd())}fne(){this.r9&&0<Jo.Xsd(this.r9).length&&this.fb.rb(this.r9);this.r9=null}lnd(){return Object.assign(new uc.a(3,1,250,
Object(u.a)(this,this.h5g,"showAdornmentTextBatched"),166),{customData:[]})}p1g(U){this.yOa=U}uVd(U){if(U){U.style.width=this.yOa+"px";if(this.r9)var Ea=this.r9;else Ea=this.lnd(),this.fb.rb(Ea);Jo.Xsd(Ea).push(U)}}Cyd(U){U&&(U.style.width="0px",this.Sgg(U))}m_d(U,Ea){Ea?this.uVd(U):this.Cyd(U)}h5g(U){for(let Ea of U.customData)this.showAdornmentText(Ea)}showAdornmentText(U){U.style.width===this.yOa+"px"&&(this.ntd(U).style.visibility="visible")}Sgg(U){U&&(this.ntd(U).style.visibility="hidden")}ntd(U){U=
U.childNodes;qa.ULS.shipAssertTag(24958351,336,1===U.length,"Expected 1 child div in the page adornment, found "+U.length);return U[0]}static Xsd(U){return U.customData}}Object(c.a)(Jo,"PageAdornmentAnimationManager",null,[1933]);class Ip{constructor(U){this.Zm=U;this.Tja=new Uc.a;this.Uja=new Uc.a}ORa(U){U=Qm.GraphIterator.ua(U);if(U.tn()&&U.Sr()){U.Rc();do 10===U.Yc&&this.fNg(U.currentNode),U.Fs();while(8!==U.Yc)}}Tlc(U){const Ea=U.Nj;var kb=this.f$b(U.Wnc);if(!this.Tja.Na(kb))return qa.ULS.sendTraceTag(24958352,
336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+kb),!1;U=this.Tja.J(kb);qa.ULS.shipAssertTag(24958353,336,this.Uja.Na(kb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");kb=this.Uja.J(kb);return this.Igg(U,Ea,kb)}Slc(U){const Ea=U.Nj;var kb=this.f$b(U.Wnc);if(!this.Tja.Na(kb))return qa.ULS.sendTraceTag(24958354,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+
kb),!1;U=this.Tja.J(kb);qa.ULS.shipAssertTag(24958355,336,this.Uja.Na(kb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");kb=this.Uja.J(kb);return this.$2f(U,Ea,kb)}Lcg(U){if(!U)return qa.ULS.sendTraceTag(24979136,336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var Ea=U.$ke;if(!Ea)return qa.ULS.sendTraceTag(24979137,336,10,String.format("Container of page number {0} has a null EndSectionNode.",U.Nj)),
0;Ea=this.Zm.v9b(Ea);if(!Ea)return qa.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),0;Ea=this.Zm.Uza(Ea);const kb=1===U.Nj;U=!(U.Nj%2);return 1===Ea?1:2===Ea?kb?2:1:3===Ea?U?3:4:kb?2:U?3:4}fNg(U){if(10===U.type){var Ea=new Uc.a,kb=this.Zm.v9b(U);qa.ULS.shipAssertTag(24958356,336,!!kb,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var Nb=this.Zm.Uza(kb);U=this.f$b(U);this.weh(U,
Nb);this.veh(U,Ea);kb=Qm.GraphIterator.ua(kb);if(kb.Sr()){kb.Rc();do U=kb.currentNode,Nb=this.Zm.zxe(U),U=this.Zm.WJi(U),Ea.add(Nb,U),kb.Fs();while(36===kb.Yc)}}}weh(U,Ea){this.Uja.Na(U)?this.Uja.$(U,Ea):this.Uja.add(U,Ea)}veh(U,Ea){this.Tja.Na(U)?this.Tja.$(U,Ea):this.Tja.add(U,Ea)}f$b(U){qa.ULS.shipAssertTag(24958358,336,10===U.type,"Expected node of type Outline but received node of type "+U.type);return U.fa(Tc.a.Wca,0)}Igg(U,Ea,kb){const Nb=1===Ea;Ea=!(Ea%2);switch(kb){case 2:if(Nb){if(U.Na(2))return U.J(2)}else if(U.Na(0))return U.J(0);
break;case 3:if(Ea){if(U.Na(1))return U.J(1)}else if(U.Na(0))return U.J(0);break;case 4:if(Nb){if(U.Na(2))return U.J(2)}else if(Ea){if(U.Na(1))return U.J(1)}else if(U.Na(0))return U.J(0);break;case 1:if(U.Na(0))return U.J(0)}return!1}$2f(U,Ea,kb){const Nb=1===Ea;Ea=!(Ea%2);switch(kb){case 2:if(Nb){if(U.Na(5))return U.J(5)}else if(U.Na(3))return U.J(3);break;case 3:if(Ea){if(U.Na(4))return U.J(4)}else if(U.Na(3))return U.J(3);break;case 4:if(Nb){if(U.Na(5))return U.J(5)}else if(Ea){if(U.Na(4))return U.J(4)}else if(U.Na(3))return U.J(3);
break;case 1:if(U.Na(3))return U.J(3)}return!1}}Object(c.a)(Ip,"PageAdornmentContentManager",null,[1932]);var Xo=b(1011);class Xm{constructor(U,Ea,kb,Nb,nc,ad,Od,af,ve){this.egh(U,Ea,kb,ad,Od,af,ve);this.Nj=U;this.yt=Ea;this.Ex=kb;this.Wnc=Nb;this.$ke=nc;this.iDb=ad;this.MHc=Od;this.KEc=af;this.Ycj=ve}get top(){return this.yt}get height(){return this.Ex}CUd(U){this.yt!==U&&(this.iDb.style.top=U+"px",this.yt=U)}NTd(U){this.height!==U&&(this.iDb.style.height=U+"px",this.Ex=U)}egh(U,Ea,kb,Nb,nc,ad,Od){qa.ULS.shipAssertTag(37244961,
336,0<U,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",U);qa.ULS.shipAssertTag(37244962,336,0<=Ea,"PageAdornmentContainer: top parameter value {0} is unexpected value.",Ea);qa.ULS.shipAssertTag(37244963,336,0<=kb,"PageAdornmentContainer: height parameter value {0} is unexpected value.",kb,Ea);qa.ULS.shipAssertTag(37244992,336,!!Nb,"PageAdornmentContainer: containerDomElement parameter is null.");qa.ULS.shipAssertTag(37244993,336,!!nc,"PageAdornmentContainer: headerLabelDomElement parameter is null.");
qa.ULS.shipAssertTag(37244994,336,!!ad,"PageAdornmentContainer: footerLabelDomElement parameter is null.");qa.ULS.shipAssertTag(37244995,336,!!Od,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}Object(c.a)(Xm,"PageAdornmentContainer",null,[1951]);class If{constructor(U,Ea,kb,Nb,nc,ad,Od,af,ve,eh,Ci,Hj,Bf){this.Kyh="headerFooterTab";this.Lfe=null;this.Sw=!0;this.Vgf=0;this.slf=null;this.Wmb=!1;this.aN=U;this.ag=Ea;this.PQ=kb;this.dva=Nb;this.ga=nc;this.mk=ad;this.B1=Od;this.UMa=
af;this.q0a=ve;this.fb=eh;this.va=Ci;this.msf=[];this.p9=new Map;this.j6=Hj;this.Gz=Bf;this.q0a.Fie(Object(u.a)(this,this.U$b,"headerFooterDismissedEvent"));this.uv=!!J.AFrameworkApplication.la&&J.AFrameworkApplication.la.eb.T7;if(this.d9d=(this.Fif=!!this.va&&this.va.ea("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&!!this.va&&this.va.ea("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===Qe.App.oa.Di.getLayoutBreakpoint()&&(this.Sw=!1),Qe.App.oa.Di.registerLayoutBreakpointChanged(this.Kyh,
Vi=>{switch(Vi){case "Small":this.nKi();break;default:this.SCj()}})}get ef(){return this.aN.value}SCj(){try{this.Bvn()}catch(U){qa.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",U.message,U.stack)}}nKi(){try{this.n_l()}catch(U){qa.ULS.shipAssertTag(37244998,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",U.message,U.stack)}}X6m(){for(const U of this.p9.keys())this.gUe(U)}ORa(){try{this.vWk()}catch(U){qa.ULS.shipAssertTag(37244999,
336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",U.message,U.stack)}}tPj(U){try{this.aOn(U)}catch(Ea){qa.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",Ea.message)}}dispose(){try{this.wJn(),this.RJn(),this.q0a&&this.q0a.Doj(Object(u.a)(this,this.U$b,"headerFooterDismissedEvent"))}catch(U){qa.ULS.shipAssertTag(37245001,336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",U.message,U.stack)}}Bgc(U){this.TBm(U.qk);
return!0}TBm(U){const Ea=this.LCd(U),kb=this.mvi(U);kb?(U=this.UMa.Lcg(kb),this.ga.ob(Ea?bd.a.B4e:bd.a.V0d,2,U),this.Wmb=!0):(qa.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+U.id),this.ga.processAction(bd.a.UDe,2))}AH(){return!0}U$b(){this.mQf()&&(this.Wmb=!1,this.AKn(),this.slf=new Date)}Hgc(U){this.Wmb||this.B1.uVd(U.qk);return!0}Ggc(U){this.Wmb||(U=U.qk,this.P4g(U)||this.B1.Cyd(U));return!0}wJn(){this.p9.forEach(U=>{this.pVc(U)})}RJn(){this.uv&&
(this.d9d&&(Qe.App.oa.Di.unregisterLayoutBreakpointChanged(this.Kyh),this.d9d=!1),this.uv=!1)}pVc(U){if(U){var Ea=U.MHc;U=U.KEc;oh.a.a8(Ea)&&oh.a.a8(U)?(this.mk.kb(w.a.xz,Ea,Object(u.a)(this,this.Hgc,"onMouseHoverOver")),this.mk.kb(w.a.xz,U,Object(u.a)(this,this.Hgc,"onMouseHoverOver")),this.mk.kb(w.a.Fw,Ea,Object(u.a)(this,this.Ggc,"onMouseHoverLeave")),this.mk.kb(w.a.Fw,U,Object(u.a)(this,this.Ggc,"onMouseHoverLeave")),this.ag.kb(w.a.click,Ea,Object(u.a)(this,this.Bgc,"onHeaderFooterClickEvent")),
this.ag.kb(w.a.click,U,Object(u.a)(this,this.Bgc,"onHeaderFooterClickEvent")),this.PQ.kb(Ea,If.pgc),this.PQ.kb(U,If.pgc),this.dva.kb(w.a.Mq,Ea,Object(u.a)(this,this.AH,"onMouseDown")),this.dva.kb(w.a.Mq,U,Object(u.a)(this,this.AH,"onMouseDown"))):qa.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}$Xm(U){Array.enqueue(this.msf,U);this.Lfe||(this.Lfe=new uc.a(2,1,50,Object(u.a)(this,this.F2m,"registerEventHandlersTask")),this.fb.rb(this.Lfe))}F2m(){let U=
Array.dequeue(this.msf);for(;U;)this.Tna(U),U=Array.dequeue(this.msf);this.Lfe=null}Tna(U){if(U){var Ea=U.MHc;U=U.KEc;oh.a.a8(Ea)&&oh.a.a8(U)?(this.mk.Ea(w.a.xz,Ea,Object(u.a)(this,this.Hgc,"onMouseHoverOver")),this.mk.Ea(w.a.xz,U,Object(u.a)(this,this.Hgc,"onMouseHoverOver")),this.mk.Ea(w.a.Fw,Ea,Object(u.a)(this,this.Ggc,"onMouseHoverLeave")),this.mk.Ea(w.a.Fw,U,Object(u.a)(this,this.Ggc,"onMouseHoverLeave")),this.ag.Ea(w.a.click,Ea,Object(u.a)(this,this.Bgc,"onHeaderFooterClickEvent")),this.ag.Ea(w.a.click,
U,Object(u.a)(this,this.Bgc,"onHeaderFooterClickEvent")),this.PQ.Ea(Ea,If.pgc),this.PQ.Ea(U,If.pgc),this.dva.Ea(w.a.Mq,Ea,Object(u.a)(this,this.AH,"onMouseDown")),this.dva.Ea(w.a.Mq,U,Object(u.a)(this,this.AH,"onMouseDown"))):qa.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}Bvn(){if(!this.Sw){for(let U of this.p9.values())U.iDb.style.display="block";this.Sw=!0}}n_l(){this.Sw&&(this.p9.forEach(U=>{U.iDb.style.display="none"}),this.Sw=
!1)}vWk(){this.UMa.ORa(this.ef.xc)}aOn(U){this.B1.pPe();var Ea=0;const kb=new W.a;this.ORa();const Nb=this.YDl();for(var nc of U)U=nc.Nj,this.sNm(nc)||this.gUe(nc.Nj),this.p9.has(U)?this.BLn(nc):this.U_k(nc),Ea=U,kb.add(U);for(nc=1;nc<=Ea;nc++)kb.contains(nc)||this.gUe(nc);for(Ea+=1;Ea<=Nb;Ea++)this.gUe(Ea);this.B1.fne()}sNm(U){return this.p9.has(U.Nj)?this.p9.get(U.Nj).Wnc.id===U.Wnc.id:!1}YDl(){let U=0;this.p9.forEach((Ea,kb)=>{kb>U&&(U=kb)});return U}U_k(U){const Ea=U.Wnc.Qd(this.ef.Za);if(Ea){var kb=
U.Nj;U=this.Vmd(kb,U.top,U.height,Ea.aza,U.Wnc,U.$ke);this.$Xm(U);this.adh(U);this.Ueh(U);this.d9d&&!this.Sw&&(U.iDb.style.display="none");this.p9.set(kb,U)}}Vmd(U,Ea,kb,Nb,nc,ad){const Od=aj.b("div","","PageAdornmentContainer");Od.style.top=Ea+"px";Od.style.height=kb+"px";Nb.appendChild(Od);this.SJf(Od,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);Nb=this.aSf(U);Od.appendChild(Nb);const af=this.pRf(U);Od.appendChild(af);const ve=this.iRf(U);Od.appendChild(ve);
J.AFrameworkApplication.isRtl&&(Od.classList.add("Rtl"),af.classList.add("Rtl"),ve.classList.add("Rtl"));return new Xm(U,Ea,kb,nc,ad,Od,af,ve,Nb)}pRf(U){U=aj.b("div","h"+U,this.Gz?"PageAdornmentHeaderLabelThemed":"PageAdornmentHeaderLabel");this.j6&&(this.Gz?U.classList.add("PageAdornmentHeaderFooterBorderThemed"):U.style.borderColor=Xo.a.M4e);const Ea=aj.b("span","","");Ea.innerText=WordEditorIntl.WordEditorStrings.l_Header;Ea.style.whiteSpace="nowrap";U.appendChild(Ea);return U}iRf(U){U=aj.b("div",
"f"+U,this.Gz?"PageAdornmentFooterLabelThemed":"PageAdornmentFooterLabel");this.j6&&(this.Gz?U.classList.add("PageAdornmentHeaderFooterBorderThemed"):U.style.borderColor=Xo.a.M4e);const Ea=aj.b("span","","");Ea.innerText=WordEditorIntl.WordEditorStrings.l_Footer;Ea.style.whiteSpace="nowrap";U.appendChild(Ea);return U}aSf(U){const Ea=aj.b("div","","PageAdornmentNumberLabel");Ea.innerText=U.toString();return Ea}SJf(U,Ea,kb){if(!this.Vgf){const Nb=aj.b("p","","");Nb.innerText=Ea;Nb.style.whiteSpace=
"nowrap";Nb.style.visibility="hidden";U.appendChild(Nb);Ea=aj.b("p","","");Ea.innerText=kb;Ea.style.whiteSpace="nowrap";Ea.style.visibility="hidden";U.appendChild(Ea);this.Vgf=U.clientWidth;this.B1.p1g(this.Vgf);U.removeChild(Nb);U.removeChild(Ea)}}gUe(U){if(this.p9.has(U)){var Ea=this.p9.get(U);this.pVc(Ea);oh.a.Fr(Ea.iDb);this.p9.delete(U)}}BLn(U){if(this.p9.has(U.Nj)){var Ea=this.p9.get(U.Nj);Ea.CUd(U.top);Ea.NTd(U.height);this.adh(Ea);this.Ueh(Ea)}else qa.ULS.sendTraceTag(37245005,324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}AKn(){this.B1.pPe();
this.ORa();this.p9.forEach(U=>{this.adh(U);this.Ueh(U)});this.B1.fne()}adh(U){const Ea=U.MHc,kb=U.KEc,Nb=this.UMa.Tlc(U),nc=this.UMa.Slc(U);this.RPn(U,Nb,nc);this.B1.m_d(Ea,Nb);this.B1.m_d(kb,nc)}RPn(U,Ea=!0,kb=!0){const Nb=U.MHc;U=U.KEc;3!==J.AFrameworkApplication.pa.mode?(Nb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,U.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(Nb.title=Ea?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,U.title=kb?WordEditorIntl.WordEditorStrings.l_EditFooter:
WordEditorIntl.WordEditorStrings.l_AddFooter)}P4g(U){const Ea=this.mvi(U);return Ea?this.LCd(U)?this.UMa.Tlc(Ea):this.UMa.Slc(Ea):(qa.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}mvi(U){U=U.id;U=U.substring(1,U.length);U=Number.parseInvariant(U);return this.p9.has(U)?this.p9.get(U):(qa.ULS.sendTraceTag(37245007,336,10,"Adornment container map does not contain the page number "+U),null)}LCd(U){return U.id.length?"h"===U.id.substring(0,1):(qa.ULS.sendTraceTag(37245008,
336,10,"Empty ID found for adornment"),!0)}Ueh(U){const Ea=U.height;Ea<If.qxm?(U.MHc.classList.add(If.EGb),U.KEc.classList.add(If.EGb)):(U.MHc.classList.remove(If.EGb),U.KEc.classList.remove(If.EGb));Ea<If.rxm?(U.Ycj.classList.add(If.EGb),U.iDb.classList.add(If.EGb)):(U.Ycj.classList.remove(If.EGb),U.iDb.classList.remove(If.EGb))}mQf(){return!this.slf||D.a.vCe(this.slf,500)}static pgc(){return!0}}If.EGb="Hidden";If.qxm=120;If.rxm=50;Object(c.a)(If,"PageAdornmentManager",null,[1930,12,1931]);class sq{constructor(U,
Ea){this.XPe=new W.a;this.XPe.add(U);this.XPe.add(Ea)}}Object(c.a)(sq,"PageElementManagerList",null,[]);var Jp=b(61);class Rm{constructor(U,Ea,kb){this.Ek=U;this.dvc=[];this.oL=Ea;this.j6=kb}ymj(){for(let U=0,Ea=this.dvc.length;U<Ea;U++)oh.a.Fr(this.dvc[U]);Array.clear(this.dvc)}Awi(U,Ea,kb,Nb,nc,ad){let Od=Math.min(Nb.x-ad.x,nc.x-ad.x);Nb=Math.min(ad.x+ad.width-(Nb.x+Nb.width),ad.x+ad.width-(nc.x+nc.width));Ea+=nc.y-ad.y;({qta:Ea,leftMargin:Od,rightMargin:Nb}=this.EAk(Ea,Od,Nb));U=this.DIl(U,Od,
Nb,Od,Nb,kb);U.style.top=Ea+"px";U.style.zIndex="0";this.dvc.push(U);Jp.c(U,!0);return U}Eye(U){return U?U.querySelector(".PageBreakBorderSpan"):null}DIl(U,Ea,kb,Nb,nc,ad){return U?this.nQl(Ea,kb,Nb,nc,ad):this.UIl(Nb,nc,ad)}EAk(U,Ea,kb){Ea/=this.Ek.instance.Ei;kb/=this.Ek.instance.Ei;U/=this.Ek.instance.Ei;return{qta:U,leftMargin:Ea,rightMargin:kb}}Yam(U){return this.GVi(U)&&this.Tcj(U)?(U=this.S9b(U))&&U.offsetParent?!1:!0:!1}Xam(U){return!this.GVi(U)||this.Tcj(U)?!1:!0}DY(){}S9b(U){if(!U.KLg)return null;
let Ea=null;U.HHb&&!U.Pma?(U=this.Eye(U.KLg))&&(Ea=U):Ea=U.KLg;return Ea}GVi(U){return U.HHb&&!U.Pma&&U.paragraphNode?!0:!1}Tcj(U){U=U.paragraphNode;return!!U&&!!U.anchor}U3h(U,Ea){U=da.a.oTa(U);Ea=da.a.oTa(Ea);return(U-Ea)/this.Ek.instance.Ei}UJf(U,Ea){U=da.a.oTa(U);Ea=da.a.oTa(Ea);return(U-Ea)/this.Ek.instance.Ei}ZKe(){this.vPj(!1)}YKe(){this.vPj(!0)}vPj(U){for(let Ea=0,kb=this.dvc.length;Ea<kb;Ea++){const Nb=this.dvc[Ea];"PageEndMarker.Para"===Nb.id?Rm.yPj(Nb,U):"PageEndMarker.Table"===Nb.id&&
Rm.mQj(Nb,U)}}UIl(U,Ea,kb){if(!Rm.Dxc){Rm.Dxc=aj.b("div","PageEndMarker.Para","PageEndMarker");var Nb=aj.b("div","","Current FullWidth");this.j6&&(Nb.style.borderTopColor=this.oL.bIa());Rm.Dxc.appendChild(Nb);Nb=aj.b("div","","Stale LeftWing");const nc=aj.b("div","","Stale RightWing");this.j6&&(Nb.style.borderTopColor=this.oL.bIa(),nc.style.borderTopColor=this.oL.bIa());Rm.Dxc.appendChild(Nb);Rm.Dxc.appendChild(nc)}Nb=Rm.Dxc.cloneNode(!0);Nb.childNodes[1].style.width=U-10+"px";Nb.childNodes[2].style.width=
Ea-10+"px";Rm.yPj(Nb,kb);return Nb}nQl(U,Ea,kb,Nb,nc){if(!Rm.B1b){Rm.B1b=aj.b("div","PageEndMarker.Table","PageEndMarker");var ad=aj.b("div","","Current LeftWing"),Od=aj.b("div","","Current RightWing");this.j6&&(ad.style.borderTopColor=this.oL.bIa(),Od.style.borderTopColor=this.oL.bIa());Rm.B1b.appendChild(ad);Rm.B1b.appendChild(Od);ad=aj.b("div","","Stale LeftWing");Od=aj.b("div","","Stale RightWing");this.j6&&(ad.style.borderTopColor=this.oL.bIa(),Od.style.borderTopColor=this.oL.bIa());Rm.B1b.appendChild(ad);
Rm.B1b.appendChild(Od)}ad=Rm.B1b.cloneNode(!0);ad.childNodes[0].style.width=U+"px";ad.childNodes[1].style.width=Ea+"px";ad.childNodes[2].style.width=kb-10+"px";ad.childNodes[3].style.width=Nb-10+"px";Rm.mQj(ad,nc);return ad}static yPj(U,Ea){Ea?Rm.gtm(U):Rm.htm(U)}static htm(U){U.childNodes[0].style.display="none";U.childNodes[1].style.display="block";U.childNodes[2].style.display="block"}static gtm(U){U.childNodes[0].style.display="block";U.childNodes[1].style.display="none";U.childNodes[2].style.display=
"none"}static mQj(U,Ea){Ea?Rm.ktm(U):Rm.ltm(U)}static ltm(U){U.childNodes[0].style.display="none";U.childNodes[1].style.display="none";U.childNodes[2].style.display="block";U.childNodes[3].style.display="block"}static ktm(U){U.childNodes[0].style.display="block";U.childNodes[1].style.display="block";U.childNodes[2].style.display="none";U.childNodes[3].style.display="none"}}Rm.Dxc=null;Rm.B1b=null;Object(c.a)(Rm,"PageEndDOMHelper",null,[]);class po{constructor(U,Ea){this.iZb=this.qKh=null;this.Ek=
U;this.te=Ea}j8g(U,Ea){try{this.lAn(U,Ea)}catch(kb){qa.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",kb.message)}}YVk(U,Ea,kb,Nb,nc,ad,Od){this.te.Fd(()=>{try{this.ZVk(U,Ea,kb,Nb,nc,ad,Od)}catch(af){qa.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",af.message)}},"PEMPC:CP")}lAn(U,Ea){this.qKh=U;this.iZb=Ea}ZVk(U,Ea,kb,Nb,nc,ad,Od){var af=this.qKh;if(af&&
U){var ve=af.count,eh=U.count;if(ve&&eh){var Ci=this.Gkl(af,U);if(Ci.count){var Hj=this.Ek.Ei,Bf=this.fBc(Ci)/Hj,Vi=this.C9h(Ci)/Hj;U=this.xue(af,U);if(U.count){af=this.fBc(U)/Hj;Hj=this.C9h(U)/Hj;var Lj=!0;for(var ro=0;ro<Ci.count;ro++)if(Ci.J(ro)){Lj=!1;break}var gq=ro=0;this.iZb&&Ea&&(ro=this.kMk(this.iZb,Ea),gq=Ea.count-this.iZb.count);qa.ULS.sendTraceTag(35005343,336,50,"{0}",{["FlightEnabled"]:kb,["HardPageBreakExists"]:nc,["EstimatedPageCount"]:ve,["CalculatedPageCount"]:eh,["InOrderAverageDelta"]:Bf,
["InOrderStandardDeviation"]:Vi,["ShortestAverageDelta"]:af,["ShortestStandardDeviation"]:Hj,["PositionsShouldBeUpdated"]:Nb,["DocumentHeightChanged"]:ad,["DeltasAllZero"]:Lj,["HeaderFooterOpenSinceLastResponse"]:Od,["DeltaInViewport"]:ro,["ChangeInViewportMarkerCount"]:gq});ad||Od||Lj||(qa.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),Ea=Ci.toArray().toString(),kb=U.toArray().toString(),qa.ULS.sendTraceTag(35726603,
336,50,"{0} {1}",Ea,kb))}}}}else qa.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}kMk(U,Ea){const kb=new W.a;for(let Nb of U)kb.add(Nb.top);if(!kb.count)return-1;U=new W.a;for(let Nb of Ea)U.add(Nb.top);if(!U.count)return-1;Ea=this.xue(kb,U);return this.fBc(Ea)/this.Ek.Ei}fBc(U){if(!U.count)return 0;let Ea=0;for(let kb=0;kb<U.count;kb++)Ea+=U.J(kb);return Ea/U.count}C9h(U){if(!U.count)return 0;const Ea=
this.fBc(U);let kb=0;for(let Nb=0;Nb<U.count;Nb++){const nc=U.J(Nb)-Ea;kb+=nc*nc}return Math.sqrt(kb/U.count)}Gkl(U,Ea){const kb=new W.a;if(!U.count||!Ea.count)return kb;U.Sc((nc,ad)=>nc-ad);Ea.Sc((nc,ad)=>nc-ad);const Nb=Math.min(U.count,Ea.count);for(let nc=0;nc<Nb;nc++){const ad=Math.abs(U.J(nc)-Ea.J(nc));kb.add(ad)}return kb}xue(U,Ea){const kb=new W.a;if(!U.count||!Ea.count)return kb;var Nb=U.count<=Ea.count;const nc=Nb?U:Ea;U=Nb?Ea:U;for(Ea=0;Ea<nc.count;Ea++){Nb=nc.J(Ea);let Od=Math.abs(Nb-
U.J(0)),af=0;for(let ve=1;ve<U.count;ve++){var ad=U.J(ve);ad=Math.abs(Nb-ad);ad<Od&&(Od=ad,af=ve)}kb.add(Od);U.removeAt(af)}return kb}}Object(c.a)(po,"PageEndMarkerPositionComparer",null,[1929]);var Ws=b(402),Oq=b(481);class gn{constructor(U,Ea,kb,Nb,nc,ad,Od,af,ve,eh){this.yt=U;this._pageNumber=Ea;this.HHb=kb;this.Pma=Nb;this.KLg=nc;this.outlineNode=ad;this.outlineGroupNode=Od;this.DIh=af;this.paragraphNode=ve;this.M0=eh}get top(){return this.yt}get Nj(){return this._pageNumber}get VMm(){return this.DIh}CUd(U){this.yt=
U}VXe(U){this._pageNumber=U}hyj(U){this.DIh=U}}Object(c.a)(gn,"PageEndMarker",null,[]);class gr{constructor(){this.Fe=null;this.m6i=0}}Object(c.a)(gr,"PageEndMarkerToRestore",null,[]);class Pn{constructor(U,Ea,kb,Nb,nc,ad,Od){this.aN=U;this.Ek=Ea;this.d1a=kb;this.tA=Nb;this.Vpf=nc;this.q6=ad;this.Nm=Od;this.wv=new W.a;this.evc=new W.a;this.w1b=new Uc.a;this.dhe=new Oq.a(new Ws.a);this.Ydb=new W.a;this.hvc=!!nc;this.Chg()}get ef(){const U=this.aN.value;qa.ULS.shipAssertTag(37052750,336,U.gj,"PageEndMarkerPositionUpdater.PageView is not a PageView.");
return U}K_d(U){try{this.HNn(U)}catch(Ea){this.tA.DY(Ea.message+" "+Ea.stack),qa.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",Ea.message)}}lwk(U){try{this.mwk(U)}catch(Ea){this.tA.DY(Ea.message+" "+Ea.stack),qa.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",Ea.message)}}$Mk(U){try{return this.aNk(U)}catch(Ea){this.tA.DY(Ea.message+" "+Ea.stack),qa.ULS.sendTraceTag(37052752,
336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",Ea.message)}return!1}Lbn(){try{this.Mbn()}catch(U){this.tA.DY(U.message+" "+U.stack),qa.ULS.sendTraceTag(37052753,336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",U.message)}}jwd(){try{return this.dMl()}catch(U){return this.tA.DY(U.message+" "+U.stack),qa.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",
U.message),null}}ueh(){try{this.ZOn()}catch(U){this.tA.DY(U.message+" "+U.stack),qa.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",U.message)}}OLf(){try{return this.sRk()}catch(U){return this.tA.DY(U.message+" "+U.stack),qa.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",U.message),!1}}N5l(U){try{this.O5l(U)}catch(Ea){this.tA.DY(Ea.message+
" "+Ea.stack),qa.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",Ea.message)}}HNn(U){if(U){this.JSk();for(let Ea=0;Ea<U.length;Ea++){const kb=Ea+1,Nb=this.tXk(U[Ea],kb);this.wv.add(Nb);this.w1b.add(kb,Nb)}}}O5l(U){let Ea=!1;for(let kb of U)if(kb)if(0<kb.NE)for(let Nb of kb.Rkg)Ea=this.mie(Nb,kb.outlineGroupNode)||Ea;else if(0>kb.NE){Ea=!0;for(let Nb of kb.Oqe)this.P8k(Nb.Nj)}Ea&&this.vVg()}mwk(U){const Ea=this.ovi(U.paragraphNode);
this.mie(U,Ea)&&this.vVg()}P8k(U){const Ea=U-1;0>Ea||this.wv.count<=Ea||(this.wv.removeAt(Ea),this.w1b.Na(U)&&this.w1b.remove(U))}dMl(){const U=new W.a;for(let Ea of this.wv)this.EKc(Ea)&&U.add(Ea);return U}mie(U,Ea){if(!U)return qa.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),!1;Ea=this.qXk(U,Ea);U=U.N8l?-1:U.Nj;let kb=!1,Nb;this.w1b.Na(U)?(Nb=this.w1b.J(U).Nj,Ea.VXe(Nb),this.wv.$(Nb-1,Ea),this.w1b.remove(U)):(Nb=Ea.Nj,this.wv.insert(Nb-
1,Ea),kb=!0);return kb}tXk(U,Ea){return new gn(0,Ea,U.HardBreak,!1,null,null,null,0,null,null)}qXk(U,Ea){const kb=U.zKb,Nb=U.Nj,nc=U.M0,ad=!!nc&&nc.HardBreak,Od=U.Pma,af=U.paragraphNode,ve=this.mBi(Ea),eh=U.outlineNode;var Ci=this.hag(eh);if(!Ci)return qa.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),null;let Hj=null;ad&&(Hj=this.tA.Eye(U.zKb));U=this.tA.U3h(Hj||kb,ve);Ci=this.tA.UJf(Hj||kb,Ci);return new gn(Ci,Nb,ad,Od,kb,eh,Ea,U,af,
nc)}aNk(U){this.evc=new W.a;this.hvc&&this.Vpf.reset();this.h6m();this.Exn();this.FAk();this.QMk(U);return 0<this.evc.count}h6m(){for(let U=0;U<this.wv.count;U++){const Ea=this.wv.J(U);this.tA.Yam(Ea)?this.Rrm(Ea):(this.tA.Xam(Ea)||this.EKc(Ea)&&!this.hag(Ea.outlineNode))&&this.Bnj(Ea)}}FAk(){let U=0,Ea=null;var kb=0;let Nb=0;for(let nc=0;nc<this.wv.count;nc++){const ad=this.wv.J(nc);this.EKc(ad)&&(ad.HHb&&(Nb+=this.Q3h(ad,kb,Nb)),Ea&&Ea.id===ad.outlineNode.id||(Ea=ad.outlineNode,Nb=U=0),ad.HHb&&
!ad.Pma&&(U=this.OMk(ad)),kb=ad.top+U+Nb,ad.CUd(kb))}this.Q3h(null,kb,Nb);this.$5m()}Q3h(U,Ea,kb){let Nb=null;this.hvc&&(Nb=this.Vpf.RMk(U,Ea,kb));return Nb?Nb.delta:0}Mbn(){if(this.evc){for(let U=0;U<this.evc.count;U++){const Ea=this.evc.J(U);oh.a.Owj(Ea.Fe,Ea.m6i)}this.hvc&&this.Vpf.Ibn()}}ZOn(){if(!this.hvc){var U=this.d1a.uzi();if(this.wv.count){var Ea=this.d1a.vxi();for(let nc=0;nc<this.wv.count;nc++){var kb=this.wv.J(nc);if(this.EKc(kb)&&kb.Pma){kb=this.d1a.YKl(kb.outlineNode);var Nb=0<nc?this.wv.J(nc-
1).outlineNode:Ea;Nb=nc&&kb.id===Nb.id?this.wv.J(nc-1).top:0;this.d1a.UXe(kb,Nb)}}Ea=this.wv.J(this.wv.count-1);Ea.Pma?this.d1a.UXe(U,0):this.d1a.UXe(U,Ea.top)}else this.d1a.UXe(U,0)}}Exn(){this.wv.Sc((U,Ea)=>U.Nj-Ea.Nj)}vVg(){for(let U=0;U<this.wv.count;U++)this.wv.J(U).VXe(U+1)}OMk(U){return U?this.T3h(U)-U.top:(qa.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}YMk(U){if(!U)return 0;const Ea=this.mBi(U.outlineGroupNode);return Ea?this.tA.U3h(this.tA.S9b(U),
Ea):0}T3h(U){if(!U)return 0;const Ea=this.tA.S9b(U);U=this.hag(U.outlineNode);return U?this.tA.UJf(Ea,U):(qa.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),0)}$5m(){let U=0,Ea=!1,kb=null,Nb=!1;for(let nc=this.wv.count-1;0<=nc;nc--){const ad=this.wv.J(nc);this.EKc(ad)&&(kb&&kb.id===ad.outlineNode.id||(Ea=!kb,kb=ad.outlineNode,U=this.nIl(kb)),ad.HHb?(Ea=!1,U=ad.top):this.hvc&&Ea||!(ad.top>U)||(this.Bnj(ad),
oh.a.Fr(this.tA.S9b(ad)),Nb=!0))}Nb&&this.vVg()}Bnj(U){this.wv.contains(U)&&(this.hvc&&this.q6.Y6m(U),this.wv.remove(U))}EKc(U){return U?(U=this.tA.S9b(U))&&U.offsetParent?!0:!1:(qa.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),!1)}sRk(){let U=!1;for(let Ea=this.Ydb.count-1;0<=Ea;Ea--)this.Ydb.J(Ea).hasChildNodes()&&(this.Ydb.removeAt(Ea),U=!0);return U}Rrm(U){(U=this.ovi(U.paragraphNode))&&(this.dhe.contains(U.id)||this.dhe.add(U.id))}Chg(){this.Nm&&this.Nm.Oe(23).tq(Object(u.a)(this,
this.EKg,"outlineGroupOnPropertyChanged"))}EKg(U,Ea){Ea.property===Uh.a.NB&&(U=Ea.node)&&U.fa(Uh.a.NB,!1)&&this.dhe.contains(U.id)&&(Ea=U.Qd(this.ef.Za))&&(Ea=Ea.htmlElement)&&(this.dhe.remove(U.id),this.Ydb.add(Ea))}QMk(U){for(let Ea=this.wv.count-1;0<=Ea;Ea--){const kb=this.wv.J(Ea);this.EKc(kb)&&this.PMk(kb,U)}}PMk(U,Ea){const kb=this.T3h(U),Nb=this.YMk(U);U.HHb?(U.CUd(kb),U.hyj(Nb)):(Ea=Ea?kb-U.top:Nb-U.VMm,U.CUd(kb-Ea),U.hyj(Nb-Ea),1<Math.abs(Ea)&&this.Mnn(this.tA.S9b(U),Ea))}hag(U){if(!U)return null;
U=U.Qd(this.ef.Za);return U?U.htmlElement:(qa.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}mBi(U){return U?(U=U.Qd(this.ef.Za))?U.htmlElement:null:null}ovi(U){U=Qm.GraphIterator.ua(U);return U.La(23)?U.tc(23):null}mIl(U){if(!U)return null;U=U.Qd(this.ef.Za);return U?da.a.getElementBounds(U.htmlElement):(qa.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}nIl(U){return(U=this.mIl(U))?U.height/
this.Ek.Ei:0}Mnn(U,Ea){Ea=(oh.a.Hwi(U)-Ea)*this.Ek.Ei;this.evc.add(Object.assign(new gr,{Fe:U,m6i:Ea}))}JSk(){this.wv=new W.a;this.w1b=new Uc.a}}Object(c.a)(Pn,"PageEndMarkerPositionUpdater",null,[1928]);var Hm=b(362),sj=b(38),Gh=b(33),ol=b(802),Zl=b(347),hl=b(22);class hn{constructor(U,Ea,kb,Nb,nc,ad,Od=!1,af=!1,ve=!1,eh=!1,Ci=!1){this.egh(Ea,kb,Nb,nc,ad,ve,Ci);this.position=U;this.Nj=Ea;this.paragraphNode=kb;this.M0=Nb;this.zKb=nc;this.outlineNode=ad;this.Rob=Od;this.nVi=af;this.N8l=ve;this.Pma=
eh;this.Nqg=Ci}VXe(U){this.Nj=U}egh(U,Ea,kb,Nb,nc,ad,Od){Od||(qa.ULS.shipAssertTag(38326881,336,!!nc,"PageEndDetails: outlineNode parameter value is null."),qa.ULS.shipAssertTag(24126528,336,0<=U,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",U),qa.ULS.shipAssertTag(24126529,336,!!Ea||ad,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),qa.ULS.shipAssertTag(24126530,336,!!kb||ad,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),
qa.ULS.shipAssertTag(24126531,336,!!Nb||ad,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static H1k(U,Ea){return hn.MQf(0,U,null,Ea,!0,!1)}static I1k(U){return hn.MQf(0,0,null,U,!1,!0)}static MQf(U,Ea,kb,Nb,nc,ad){return new hn(U,Ea,null,null,kb,Nb,nc,ad,!0)}static ZBc(U,Ea){return new hn(0,U,null,Ea,null,null,void 0,void 0,void 0,void 0,!0)}}Object(c.a)(hn,"PageEndDetails",null,[]);class sg{constructor(U,Ea,kb,Nb,nc,ad,Od,af,ve,eh,Ci,Hj,Bf,Vi,Lj,ro,gq,
xq,Rp,lt,Is){this.DFa=!0;this.Bbf=0;this.vbe=this.Wgf=this.Xgf=this.idf=this.Tpf=this.Kgf=!1;this.Tce=this.PZb=null;this.Qjf=!0;this.aN=U;this.aj=Ea;this.Vja=kb;this.dU=Nb;this.MIh=nc;this.xwa=ad;sg.tA=af;this.Ixh=ve;this.eN=eh;this.fb=Ci;this.v$j=Hj;this.Ad=Vi;this.q6=ro;this.Wpf=gq;this.kvc=xq;this.X5=Rp;this.Nuc=new Hm.a;this.fvc=new W.a;this.rta=new W.a;this.Zdb=new Hm.a;this.rZ=Bf;this.l6=Is;this.bQe=this.bQe.bind(this);this.dQe=this.dQe.bind(this);this.QTe=this.QTe.bind(this);this.XBa=this.XBa.bind(this);
this.rZ.ggd(Object(u.a)(this,this.j7a,"onContentDirtied"));this.Upf=!1;this.NIh=lt;Lj&&(Lj.HWh(Object(u.a)(this,this.sHg,"onHeaderFooterShow")),Lj.Fie(Object(u.a)(this,this.rHg,"onHeaderFooterDismiss")));Od&&Od.Iyk(Object(u.a)(this,this.NHm,"onPageContentSizeChange"));this.l6.Ayc(this.XBa)}get Cqg(){return this.Qjf}get ef(){return this.aN.value}get $i(){return this.aj.value}j7a(){this.ZKe()}rHg(){this.Xgf=!1}sHg(){this.Wgf=this.Xgf=!0}K_d(U,Ea){const kb=this.Ad.Pe("Task","UpdateMarkers");this.jAn();
this.DFa=Ea;sg.tA.ymj();this.Nuc=new Hm.a;this.fvc.clear();this.rta.clear();this.Zdb=new Hm.a;this.Qjf=this.Kgf=!1;this.dU&&this.dU.K_d(U);this.Yfl();this.Bbf=U.length;this.q6&&this.q6.reset(U);this.Vja&&this.Vja.ORa();for(let Nb of U)this.rta.add(Nb),this.lVg(Nb);Ea&&this.dU&&this.Wpf&&this.Wpf.isEnabled&&(U=this.dU.jwd(),this.Wpf.Vhb(U));this.XVk();this.idf=this.Tpf=!1;this.Wgf=this.Xgf;Wo.WoncaApp.instance.Anb&&sg.yig&&this.dU.ueh();this.xwa.$Nn(this.dU.jwd(),this.rta.count);this.Qjf=!0;this.X5.deh();
kb.stop();qa.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:kb.ti,["RenderedLineCount"]:this.Bbf,["AvgDurationPerPageInMs"]:kb.ti/this.wBi()})}zBi(){const U=this.dU.jwd();if(!U)return null;const Ea=oh.a.ima(),kb=new W.a;for(let Nb of U)this.qdm(Nb,Ea)&&kb.add(Nb);return kb}qdm(U,Ea){if(!U)return!1;U=sg.tA.S9b(U);if(!U)return!1;U=da.a.oTa(U);return 0<=U&&U<=Ea}xsi(){const U=new W.a;if(!this.Zdb)return qa.ULS.sendTraceTag(35005382,336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),
U;const Ea=this.Zdb.keys;for(let nc=0;nc<Ea.length;nc++){var kb=Ea.J(nc);if(kb=this.Zdb.J(kb))for(let ad=0;ad<kb.count;ad++){var Nb=kb.J(ad);Nb.M0.HardBreak||Object(sj.a)(Nb.zKb,"Hidden")||(Nb=da.a.oTa(Nb.zKb),U.add(Nb))}}return U}jAn(){const U=this.xsi(),Ea=this.zBi();this.MIh.j8g(U,Ea);this.kvc&&this.kvc.isEnabled&&this.kvc.j8g(Ea)}XVk(){if(!(25<this.wBi())){var U=this.xsi(),Ea=this.zBi();this.MIh.YVk(U,Ea,this.NIh,this.Tpf,this.Kgf,this.idf,this.Wgf);this.kvc&&this.kvc.isEnabled&&this.kvc.Vhb(Ea)}}XBa(){this.Vja.X6m();
this.lgi()}lgi(){this.vbe&&(this.ef.woj(this.bQe),this.ef.Noj(this.dQe),this.ef.Ioj(this.QTe),this.vbe=!1)}Yfl(){this.vbe||(this.ef.DCf(this.bQe),this.ef.NWh(this.dQe),this.ef.QCf(this.QTe),this.vbe=!0)}lVg(U){if(this.Upf)return!0;U=this.d9m(U);if(!U)return!1;this.q6&&this.q6.FWl(U);this.dU&&(this.dU.lwk(U),this.xwa.qPj(this.dU.jwd()),Wo.WoncaApp.instance.Anb&&sg.yig&&this.dU.ueh());return!0}d9m(U){let Ea=this.Mra(U.ParaId);if(!Ea)return null;if(!Ea.anchor||!Ea.Bf)return this.tVh(U,Ea),null;let kb,
Nb;if(U.HardBreak){var nc=Ni.ParagraphReader.qh(Ea,!0,!0,!0);this.kOm(nc)&&(Ea=nc);if(!({qta:nc,outlineGroupNode:kb,wKb:Nb}=this.uHn(U,Ea)).returnValue)return null;this.Kgf=!0}else if(!({YPe:nc,outlineGroupNode:kb,wKb:Nb}=this.e9m(U,Ea,nc,kb,Nb)).returnValue)return null;return this.mie(Ea,U,nc,kb,Nb)}kOm(U){return U?(U=U.Qd(this.ef.Za))?!!sg.tA.Eye(U.htmlElement):!1:!1}e9m(U,Ea,kb,Nb,nc){var ad=U.PageEndType;let Od;kb=0;nc=Nb=null;if(!ad){if(!({qta:U,tLg:Od}=this.ABi(U,Ea)).returnValue)return{returnValue:!1,
YPe:kb,outlineGroupNode:Nb,wKb:nc}}else if(!({qta:U,R0e:Od}=this.EIl(U,Ea)).returnValue)return{returnValue:!1,YPe:kb,outlineGroupNode:Nb,wKb:nc};var af=Qm.GraphIterator.ua(Ea);af.kc();Nb=af.tc(23);Ea=Nb.Qd(this.ef.Za).getBounds();af=af.vha().Qd(this.ef.Za);if(!af)return qa.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",this.ef.Za),{returnValue:!1,YPe:kb,outlineGroupNode:Nb,wKb:nc};nc=af.getBounds();kb=U-Ea.y;ad=sg.tA.Awi(ad,kb,this.DFa,Od,Ea,nc);af.aza.appendChild(ad);
return{returnValue:!0,YPe:kb,outlineGroupNode:Nb,wKb:ad}}uHn(U,Ea){let kb=null;const Nb=Ea.Qd(this.ef.Za);var nc=0;let ad=null;if(this.SHe(U,Nb,Ea))return{returnValue:!1,qta:nc,outlineGroupNode:kb,wKb:ad};kb=sg.Q5i(Ea);const Od=kb.Qd(this.ef.Za);if(!Od)return qa.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.ef.Za),{returnValue:!1,qta:nc,outlineGroupNode:kb,wKb:ad};nc=Od.getBounds();nc=Nr.a.xl(Nb,U.CP).y-nc.y;ad=this.CBl(Ea);return{returnValue:!0,qta:nc,outlineGroupNode:kb,
wKb:ad}}CBl(U){return U.Qd(this.ef.Za).htmlElement}Mra(U){const Ea=this.eN.UFb(U);if(Ea!==$b.a.nil){const kb=this.$i.Ta(Ea);if(kb)return kb}qa.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",U,Ea);return null}ABi(U,Ea){const kb=U.CP;let Nb=0,nc=null;const ad=Ea.Qd(this.ef.Za);if(this.SHe(U,ad,Ea))return{returnValue:!1,qta:Nb,tLg:nc};nc=ad.getBounds();Nb=kb?this.Ixh(Object(fa.a)(92,ad),kb):nc.y-this.v$j(ad);return{returnValue:!0,qta:Nb,tLg:nc}}EIl(U,
Ea){let kb=null,Nb=0;var nc=U.PageEndType;let ad=Qm.GraphIterator.ua(Ea);ad.kc();if(!Gh.TableReader.Pv(ad))return qa.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",U.ParaId),{returnValue:({qta:Nb,tLg:kb}=this.ABi(U,Ea)).returnValue,qta:Nb,R0e:kb};if(1===nc){hl.returnToContainingRow(ad);nc=ad.currentNode.Qd(this.ef.Za);if(this.SHe(U,nc,Ea))return{returnValue:!1,qta:Nb,R0e:kb};Nb=nc.getBounds().y}else{nc=Ea.Qd(this.ef.Za);
if(this.SHe(U,nc,Ea))return{returnValue:!1,qta:Nb,R0e:kb};Nb=this.Ixh(Object(fa.a)(92,nc),U.CP)}--Nb;Ea=null;do U=Ea,Ea=ad.tc(14);while(Ea);ad=Qm.GraphIterator.ua(U);ad.kc();hl.moveToFirstRow(ad);kb=ad.currentNode.Qd(this.ef.Za).getBounds();return{returnValue:!0,qta:Nb,R0e:kb}}SHe(U,Ea,kb){if(!Ea||Ea.W6a(16))return this.tVh(U,kb),!0;Ea=Ea.getBounds();return Ea.width||Ea.height?!1:(this.PUh(U),!0)}PUh(U){this.fvc.contains(U)||this.fvc.add(U)}tVh(U,Ea){Ea=Ea.id;let kb;({value:kb}=this.Nuc.Ab(Ea)).returnValue||
(kb=new W.a,this.Nuc.$(Ea,kb));kb.add(U)}bQe(){const U=new W.a;for(let Ea=this.fvc.count-1;0<=Ea;Ea--){const kb=this.fvc.J(Ea);this.lVg(kb)||U.add(kb)}this.fvc=U;this.OLf()}OLf(){this.dU&&this.dU.OLf()&&this.uPj(!1)}NHm(U,Ea){1>=Math.abs(Ea.delta)||(this.idf=!0,this.uPj(!Ea.g6i))}uPj(U){this.dU&&(this.dU.$Mk(U)&&(this.Tpf=!0),this.NIh&&this.dU.Lbn(),this.xwa.qPj(this.dU.jwd()),Wo.WoncaApp.instance.Anb&&sg.yig&&this.dU.ueh())}dQe(U,Ea){try{const kb=Ea.id;if(this.Nuc.Na(kb)){const Nb=this.Nuc.J(kb);
for(U=0;U<Nb.count;U++)this.PUh(Nb.J(U));this.Nuc.remove(kb)}}catch(kb){}}ZKe(){this.DFa&&(this.DFa=!1,sg.tA.ZKe())}YKe(){this.DFa||(this.DFa=!0,sg.tA.YKe())}Cvn(){this.Upf=!1;this.rta&&this.K_d(this.rta.toArray(),this.DFa);this.Vja&&this.Vja.SCj()}o_l(){this.Upf=!0;sg.tA.ymj();this.Vja&&this.Vja.nKi();this.q6&&this.q6.p_l()}mie(U,Ea,kb,Nb,nc){const ad=this.rta.indexOf(Ea)+1;if(0>ad)return null;const Od=fr.WordSectionNavigator.instance.BK(U),af=this.Pma(Ea,U);U=new hn(kb,ad,U,Ea,nc,Od,!U||!Ea||!nc,
!1,!1,af);this.Zdb.Na(Nb.id)||this.Zdb.$(Nb.id,new W.a);this.Zdb.J(Nb.id).add(U);return U}Pma(U,Ea){if(!U||!U.HardBreak)return!1;U=Qm.GraphIterator.ua(Ea);U.La(7);if(U.lx())return!1;U.tc(23);return U.lx()?!1:!0}Zkj(U){this.DFa&&(U.anchor&&U.Bf?!(U=sg.Q5i(U))||this.PZb&&this.PZb.customData&&this.PZb.customData.id===U.id||(this.PZb=Object.assign(new uc.a(3,1,500,Object(u.a)(this,this.q1m,"redrawPageEndsForOutlineGroup")),{customData:U}),this.fb.rb(this.PZb)):qa.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}q1m(U){U===
this.PZb&&(this.PZb=null);if(this.DFa){var Ea=U.customData;if(U=this.Zdb.get(Ea.id))for(this.Zdb.$(Ea.id,new W.a),qa.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",U.count,Ea.id),this.Vja&&this.Vja.ORa(),Ea=0;Ea<U.count;Ea++){const kb=U.J(Ea),Nb=kb.M0;Nb.HardBreak||(oh.a.Fr(kb.zKb),this.lVg(Nb))}}}QTe(){this.DFa&&!this.Tce&&this.rta&&0<this.rta.count&&(this.Tce=new uc.a(3,1,500,Object(u.a)(this,this.p1m,"redrawAllPageEndsInDocument")),
this.fb.rb(this.Tce))}p1m(){this.Tce=null;this.DFa&&this.rta&&0<this.rta.count&&(qa.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.K_d(this.rta.toArray(),this.DFa))}dispose(){this.ef&&this.lgi();this.l6.VUg(this.XBa);this.rZ.BUe(Object(u.a)(this,this.j7a,"onContentDirtied"))}static get yig(){null==sg.Nhf&&(sg.Nhf=J.AFrameworkApplication.K.ea("ImageOverflowUpdateHeightIsEnabled"));return sg.Nhf}static zBl(U){let Ea=0;try{const kb=U.htmlElement,Nb=oh.a.kO(kb.firstChild.style.marginTop);
U=0;const nc=sg.Sag(kb.parentNode);if(nc){const ad=nc.firstChild;ad&&Object(sj.a)(ad,"ParaWrappingDiv")&&(U=oh.a.kO(ad.firstChild.style.marginBottom))}Ea=Math.max(Nb,U)/2}catch(kb){}return Ea}static Sag(U){let Ea=U.previousSibling;if(!Ea){var kb=U.parentNode;oh.a.fGe(kb)&&(kb=kb.parentNode)&&(Ea=kb.previousSibling)}if(!Ea&&(U=U.parentNode,Object(sj.a)(U,ol.a.ucj)||qa.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",U.tagName,U.className),(U=
U.previousSibling)&&U.hasChildNodes())){Ea=U.lastChild;do{if(Object(sj.a)(Ea,"OutlineElement")||oh.a.fGe(Ea)&&Object(sj.a)(Ea,Zl.a.QLc))break;Ea=Ea.previousSibling}while(Ea)}if(Ea){if(Object(sj.a)(Ea,Zl.a.QLc))return Ea.lastChild.lastChild;if(oh.a.fGe(Ea))return Ea.lastChild}return Ea}static Q5i(U){U=Qm.GraphIterator.ua(U);return U.La(23)?U.tc(23):null}wBi(){return this.Bbf+1}}sg.tA=null;sg.Nhf=null;Object(c.a)(sg,"PageEndMarkers",null,[1926,1927,12]);var Yo=b(132);class io{constructor(U,Ea,kb){this.TMm=
".Outline";this.aN=U;this.Ek=Ea;this.tA=kb}get ef(){const U=this.aN.value;qa.ULS.shipAssertTag(38416594,336,U.gj,"Invalid PageView.");return U}vFc(U){return(U=U.outlineNode)?this.kBi(U):(qa.ULS.shipAssertTag(38336522,336,!0,"Error getting last Outline DOM."),null)}kBi(U){let Ea,kb;return(Ea=U.Qd(this.ef.Za))&&(kb=Ea.htmlElement)?kb.querySelector(this.TMm):(qa.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}nvi(U){U=gl.OutlineElementNavigator.Fl(U.paragraphNode);let Ea;return U&&
(Ea=U.Qd(this.ef.Za))?Ea.htmlElement:(qa.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}J3h(U,Ea){const kb=this.oTl(U);return this.VMk(U,Ea)-kb}uwi(U){return this.pBi(U.outlineNode,U.Nj)}pBi(U,Ea){if(!U)return-1;var kb=U.fa(Tc.a.My,-1);kb=Am.a.Rh(kb,1);var Nb=U.fa(Tc.a.marginTop,-1);Nb=Am.a.Rh(Nb,1);U=U.fa(Tc.a.marginBottom,-1);U=Am.a.Rh(U,1);return 1===Ea?kb-U:kb-(Nb+U)}N8k(U){U&&oh.a.Fr(U.zKb)}Jag(U){if(U.nVi||U.Pma)return 0;if(U.Rob)return U=this.vFc(U),da.a.getElementBounds(U).height/
this.Ek.Ei;const Ea=this.vFc(U);return this.tA.UJf(this.yBi(U),Ea)}H_k(U,Ea,kb){kb=kb.Qd(this.ef.Za).getBounds();U=U.Qd(this.ef.Za);const Nb=U.getBounds();kb.y=Nb.y;Ea=this.tA.Awi(0,Ea*this.Ek.Ei,!1,kb,kb,Nb);U.aza.appendChild(Ea);return Ea}dOi(U,Ea){if(U&&!U.Nqg)if(U.Rob){if(U=this.vFc(U))U.style.paddingBottom=Ea+"px"}else if(U.M0&&U.M0.HardBreak)if(U.Pma){if(U=this.vCi(U))U.style.paddingBottom=Ea+"px"}else{if(U=this.nvi(U))U.style.paddingTop=Ea+"px"}else qa.ULS.shipAssertTag(39077394,336,!1,"Applying blank space on a page which is not hard break or last page.")}nXh(U,
Ea){Ea=this.vFc(Ea);U=this.vFc(U);return da.a.oTa(Ea)-da.a.oTa(U)}wCi(U){U=Qm.GraphIterator.ua(U.outlineNode);U.La(7);return U.lx()}oTi(U){if(!U||U.Nqg)return!1;if(U.Rob||U.nVi)return!0;U=this.yBi(U);return!!U&&oh.a.Ela(U)}DY(U){this.tA.DY(U)}vCi(U){return(U=this.wCi(U))?(U=U.Mh(this.ef.Za).htmlElement,U?U:(qa.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}yBi(U){return U.M0&&U.M0.HardBreak&&!U.Pma?this.tA.Eye(U.zKb):U.zKb}oTl(U){if(U.Rob){U=this.vFc(U);if(!U)return qa.ULS.shipAssertTag(38336528,
336,!0,"Last outline dom is null."),-1;U=Yo.a.Hv(U);return oh.a.dga(U.paddingBottom)}if(U.M0&&U.M0.HardBreak){if(U.Pma)return(U=this.vCi(U))?oh.a.dga(U.style.paddingBottom):-1;U=this.nvi(U);return U?oh.a.dga(U.style.paddingTop):(qa.ULS.shipAssertTag(38336529,336,!0,"Containing outline element Dom is null."),-1)}return 0}VMk(U,Ea){return this.Jag(U)-Ea}}Object(c.a)(io,"PageFullHeightDOMHelper",null,[]);class Ap{constructor(){this.delta=this.ISj=this.NE=0;this.pta=null;this.W3a=this.Wfj=0;this.outlineGroupNode=
null;this.RRa=0;this.Rkg=new W.a;this.Oqe=new W.a;this.lzm=new W.a}}Object(c.a)(Ap,"PageFullHeightInfo",null,[]);class bl{constructor(U,Ea){this.SOa=U;this.uA=Ea}R3h(U,Ea){try{return this.SMk(U,Ea)}catch(kb){return this.uA.DY(kb.message+" "+kb.stack),qa.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",kb.message),null}}SMk(U,Ea){qa.ULS.shipAssertTag(38416596,336,U.Rob||U.M0.HardBreak);const kb=this.uA.Jag(U),Nb=this.uA.J3h(U,Ea),nc=this.SOa.G3h(U,
Nb);U=Object.assign(new Ap,{RRa:Nb,W3a:nc,pta:U});this.WMn(U);U.ISj=U.W3a-U.RRa;U.delta=Ea+nc+U.delta-kb;return U}WMn(U){U.RRa>U.W3a?this.XMn(U):0>U.RRa&&this.Sdh(U)}Sdh(U){let Ea=U.pta.Nj;for(;0>U.RRa;)U.NE--,U.delta-=this.SOa.cud(Ea),U.RRa+=this.SOa.cud(Ea-1),Ea--;U.W3a=this.SOa.cud(Ea)}XMn(U){const Ea=this.uA.uwi(U.pta);U.NE=Math.floor((U.RRa-U.W3a)/Ea)+1;U.delta=U.NE*Ea;U.RRa-=U.W3a+(U.NE-1)*Ea;U.W3a=Ea}}Object(c.a)(bl,"PageFullHeightInfoCalculator",null,[]);class $l{constructor(U,Ea,kb,Nb){this.egb=
0;this.$1a=null;this.SOa=U;this.AYb=Ea;this.a_=kb;this.uA=Nb;this.qLh=new W.a}get d5(){return this.qLh}FWl(U){try{this.Dfg(U)}catch(Ea){this.uA.DY(Ea.message+" "+Ea.stack),qa.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",Ea.message)}}reset(U){try{this.Dan(U)}catch(Ea){this.uA.DY(Ea.message+" "+Ea.stack),qa.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",Ea.message)}}p_l(){try{this.q_l()}catch(U){this.uA.DY(U.message+
" "+U.stack),qa.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",U.message)}}P5l(U){try{this.Q5l(U)}catch(Ea){this.uA.DY(Ea.message+" "+Ea.stack),qa.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",Ea.message)}}Y6m(U){try{this.Z6m(U)}catch(Ea){this.uA.DY("Pagination: "+Ea.message+" "+Ea.stack),qa.ULS.sendTraceTag(39387716,336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",
Ea.message)}}o3l(){var U=this.a_.oxe(),Ea=this.a_.I9f();U=hn.I1k(U);Ea=hn.H1k(this.egb,Ea);this.d5.$(0,U);this.Dfg(Ea)}Fan(){var U=fr.WordSectionNavigator.instance.I9f();(U=this.uA.kBi(U).parentNode)&&""!==U.style.minHeight&&(U.style.minHeight="")}$3l(U){this.qLh=new W.a;this.d5.add(null);for(let Ea=0;Ea<U.length;Ea++){const kb=hn.ZBc(Ea+1,U[Ea]);this.d5.add(kb)}this.d5.add(hn.ZBc(U.length+1,null))}P3l(U){this.SOa.Lan(U)}gbn(){if(this.d5)for(let U of this.d5)U&&this.GRi(U)&&this.uA.dOi(U,0)}Dfg(U){const Ea=
this.VKl(U);if(this.uA.oTi(Ea)){let kb=this.uA.Jag(Ea);U.outlineNode!==Ea.outlineNode&&(kb+=this.uA.nXh(U,Ea));this.jMk(U,kb);this.GRi(U)&&this.mVg(U,kb)}else this.$1a.add(U),20<this.$1a.count&&qa.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.$1a.count);this.d5.$(U.Nj,U);this.yWl(U)}q_l(){this.gbn()}Dan(U){this.egb=U.length+1;this.$1a=new W.a;this.$3l(U);this.P3l(this.egb);this.o3l();this.Fan()}Q5l(U){this.SOa.cOn(U);for(let Ea of U){if(!Ea){qa.ULS.sendTraceTag(38916955,
336,10,"info is null.");return}if(0<Ea.NE){U=Ea.pta.Nj;for(let kb of Ea.Rkg)this.d5.insert(U,kb),U++}else if(0>Ea.NE)for(let kb of Ea.Oqe)this.d5.remove(kb),this.$1a.contains(kb)&&this.$1a.remove(kb)}this.Fpj()}Z6m(U){U=U.Nj;this.SOa.$6m(U);this.d5.removeAt(U);for(let Ea of this.$1a)Ea.Nj===U&&this.$1a.remove(Ea);this.Fpj()}jMk(U,Ea){Ea=this.uA.J3h(U,Ea);this.SOa.G3h(U,Ea)}mVg(U,Ea){U.M0&&U.M0.HardBreak||this.AYb.mVg(U,Ea)}yWl(U){U=U.Nj+1;for(let Ea of this.$1a)if(Ea&&Ea.Nj===U){this.Dfg(Ea);this.$1a.remove(Ea);
break}}Fpj(){for(let U=0;U<this.d5.count;U++){const Ea=this.d5.J(U);Ea&&Ea.VXe(U)}}GRi(U){U=this.yIl(U);return 2===U||1===U}VKl(U){return this.d5.J(U.Nj-1)}yIl(U){return U.Rob?2:U.M0&&U.M0.HardBreak?1:0}}Object(c.a)($l,"PageFullHeightManager",null,[1950]);class xk{constructor(U,Ea,kb,Nb){this.AYb=U;this.SOa=Ea;this.a_=kb;this.uA=Nb}create(){return new $l(this.SOa,this.AYb,this.a_,this.uA)}}Object(c.a)(xk,"PageFullHeightManagerFactory",null,[]);var Kp=b(964),aq=b(554);class Lp{constructor(U,Ea,kb,
Nb,nc){this.gvc=null;this.q6=U;this.dU=Ea;this.M9c=kb;this.AYb=Nb;this.uA=nc}reset(){this.gvc=new W.a}RMk(U,Ea,kb){try{return this.TMk(U,Ea,kb)}catch(Nb){return qa.ULS.sendTraceTag(38897350,336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",Nb.message),null}}Ibn(){try{this.Jbn()}catch(U){qa.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",U.message)}}TMk(U,Ea,kb){if(!this.q6.d5.count)return null;
const Nb=this.CIl(U,!U);if(!Nb||Nb.Nqg)return qa.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),null;if(Nb.M0&&Nb.M0.HardBreak)return null;var nc=this.q6.d5.J(Nb.Nj-1);return this.uA.oTi(nc)&&(Ea-=kb,Nb.outlineNode!==nc.outlineNode&&(Ea+=this.uA.nXh(Nb,nc)),(nc=this.M9c.R3h(Nb,Ea))&&1<Math.abs(nc.delta))?(nc.Wfj=Ea,nc.outlineGroupNode=this.kIl(U,Nb),this.gvc.add(nc),this.Sdh(nc),nc):null}kIl(U,Ea){return Ea&&Ea.Rob?(U=Object(fa.a)(aq.a,Ni.ParagraphReader.OL(Ea.outlineNode)),
U=Qm.GraphIterator.ua(U),U.tn(),Object(fa.a)(Kp.a,U.tc(23))):U&&U.HHb?U.outlineGroupNode:null}Jbn(){this.gvc.Sc((U,Ea)=>Ea.pta.Nj-U.pta.Nj);for(let U of this.gvc)this.AYb.lpj(U);this.eOn()}eOn(){this.dU.value.N5l(this.gvc);this.q6.P5l(this.gvc)}CIl(U,Ea){return Ea?this.q6.d5.J(this.q6.d5.count-1):this.q6.d5.J(U.Nj)}Sdh(U){let Ea=U.pta.Nj;const kb=-U.NE;for(let Nb=0;Nb<kb;Nb++)Ea--,U.Oqe.add(this.q6.d5.J(Ea))}}Object(c.a)(Lp,"PageFullHeightPositionUpdater",null,[1816]);class Ko{constructor(U,Ea,kb,
Nb,nc){this.q6=U;this.dU=Ea;this.M9c=kb;this.AYb=Nb;this.uA=nc}create(){return new Lp(this.q6,this.dU,this.M9c,this.AYb,this.uA)}}Object(c.a)(Ko,"PageFullHeightPositionUpdaterFactory",null,[]);class Pq{constructor(U,Ea){this.uA=U;this.M9c=Ea}mVg(U,Ea){try{this.h9m(U,Ea)}catch(kb){this.uA.DY(kb.message+" "+kb.stack),qa.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",kb.message)}}lpj(U){try{this.g9m(U)}catch(Ea){this.uA.DY(Ea.message+" "+Ea.stack),qa.ULS.sendTraceTag(38855577,
336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",Ea.message)}}h9m(U,Ea){qa.ULS.shipAssertTag(38285913,336,U.Rob||U.M0.HardBreak);U=this.M9c.R3h(U,Ea);this.lpj(U)}g9m(U){this.f9m(U);this.Y8m(U)}Y8m(U){0<U.NE?this.Z5l(U):0>U.NE&&this.O8k(U)}f9m(U){this.uA.dOi(U.pta,U.ISj)}Z5l(U){let Ea=U.Wfj+U.W3a;for(let Nb=0;Nb<U.NE;Nb++){var kb=U.pta.Nj+Nb;const nc=U.pta.Pma?this.uA.wCi(U.pta):U.pta.outlineNode;kb=this.G_k(nc,U.outlineGroupNode,Ea,kb);U.Rkg.add(kb);U.lzm.add(Ea);Ea+=U.W3a}}O8k(U){for(let Ea of U.Oqe)this.uA.N8k(Ea)}G_k(U,
Ea,kb,Nb){Ea=this.uA.H_k(U,kb,Ea);return hn.MQf(kb,Nb,Ea,U,!1,!1)}}Object(c.a)(Pq,"PageFullHeightRenderer",null,[]);class Sm{constructor(U){this.ZQg=U}}Object(c.a)(Sm,"PageHeightDeltaResult",null,[1814]);class cl{constructor(U,Ea,kb){this.Vo=null;this.uA=U;this.te=Ea;kb.execute(Nb=>{Nb.register(this)})}get pAg(){return"PageHeightDelta"}get result(){return this.Vo}get CEg(){return 1}get bZg(){return 500}get isEnabled(){return!0}KEg(){this.Vo=null}Vhb(U){this.te.Fd(()=>{try{this.yjd(U)}catch(Ea){qa.ULS.sendTraceTag(39188045,
324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",Ea.message)}},"PHDM:C")}yjd(U){this.Vo=null;U=this.Ajd(U);-1!==U&&(this.Vo=new Sm(U))}Ajd(U){if(!U.count)return-1;let Ea=0,kb=0;for(let Nb of U)U=this.UMk(Nb),-1!==U&&(Ea+=U,kb++);return kb?Ea/kb:-1}UMk(U){if(!U.Z$l)return-1;const Ea=this.uA.pBi(U.$ke,U.Nj);return-1===Ea?-1:Math.abs(U.height-Ea)}}Object(c.a)(cl,"PageHeightDeltaMetric",null,[1785]);class am{constructor(U){this.Nbb=null;this.uA=U}cud(U){return this.Nbb.J(U-
1)}Lan(U){this.Nbb=new W.a;for(let Ea=0;Ea<U;Ea++)this.Nbb.add(-1)}G3h(U,Ea){if(this.rdm(U))return this.Nbb.J(U.Nj-1);Ea=this.vMk(U,Ea);this.kAn(U,Ea);return Ea}cOn(U){for(let Ea of U)this.bOn(Ea)}kAn(U,Ea){this.Nbb.$(U.Nj-1,Ea)}$6m(U){this.Nbb.removeAt(U-1)}bOn(U){if(U)if(0<U.NE){var Ea=U.pta.Nj;for(var kb=0;kb<U.NE;kb++)this.Nbb.insert(Ea,U.W3a)}else if(0>U.NE)for(Ea=-U.NE,U=U.pta.Nj-Ea,kb=0;kb<Ea;kb++)this.Nbb.removeAt(U)}rdm(U){return-1!==this.Nbb.J(U.Nj-1)}vMk(U,Ea){if(U.Rob||U.M0.HardBreak)U=
this.uA.uwi(U),Ea=Ea<U?U:Ea;return Ea}}Object(c.a)(am,"PageHeightStorage",null,[]);var Tl=b(244);class Qn{constructor(U){this.ZQg=U}}Object(c.a)(Qn,"PageLevelDeltaResult",null,[1814]);class il{constructor(U,Ea,kb,Nb){this.Vo=null;this.aN=U;this.JG=Ea;this.te=kb;Nb.execute(nc=>{nc.register(this)})}get ef(){const U=this.aN.value;qa.ULS.shipAssertTag(39081438,336,U.gj,"PageLevelDeltaMetric.PageView is not a PageView.");return U}get pAg(){return"PageLevelDelta"}get result(){return this.Vo}get CEg(){return 0}get bZg(){return 60}get isEnabled(){return!0}KEg(){this.Vo=
null}Vhb(U){this.te.Fd(()=>{try{this.yjd(U)}catch(Ea){qa.ULS.sendTraceTag(39081440,324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",Ea.message)}},"PLDM:C")}yjd(U){this.Vo=null;U=this.Ajd(U);-1!==U&&(this.Vo=new Qn(U))}Ajd(U){if(!U.count)return-1;let Ea=0,kb=0;for(let Nb of U)U=this.WMk(Nb),-1!==U&&(Ea+=U,kb++);return kb?Ea/kb:-1}WMk(U){if(U.HHb)return-1;var Ea=U.M0.CP;U=U.paragraphNode;qa.ULS.shipAssertTag(39081441,336,!!U);U=U.Qd(this.ef.Za);qa.ULS.shipAssertTag(39081442,
324,Object(Tl.a)(92,U));let kb;({dbi:Ea,wXi:U,$rj:kb}=this.IMk(U,oh.a.SA(U.htmlElement).length,Ea));return U&&kb?Math.min(Ea.x-U.x,kb.x-Ea.x):(qa.ULS.sendTraceTag(39081443,336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}IMk(U,Ea,kb){let Nb,nc,ad,Od=nc=kb,af=ad=Nb=null;if(kb>Ea)return qa.ULS.sendTraceTag(39081472,336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{dbi:af,nkm:Od,wXi:ad,Ycn:nc,$rj:Nb};
af=this.JG.xl(U,kb);for(var ve=0,eh=kb;ve<=eh;){let Ci=Math.floor((ve+eh)/2),Hj=this.JG.xl(U,Ci);if(ve===eh){Od=Ci;ad=Hj;break}Hj.y+Hj.height<=af.y?ve=Ci+1:eh=Ci}for(;kb<=Ea;){ve=Math.ceil((kb+Ea)/2);eh=this.JG.xl(U,ve);if(kb===Ea){nc=ve;Nb=eh;break}eh.y>=af.y+af.height?Ea=ve-1:kb=ve}return{dbi:af,nkm:Od,wXi:ad,Ycn:nc,$rj:Nb}}}Object(c.a)(il,"PageLevelDeltaMetric",null,[1785]);class Lo{constructor(U,Ea,kb,Nb,nc,ad,Od){this.Nj=U;this.top=Ea;this.HSh=kb;this.height=Nb;this.Wnc=nc;this.$ke=ad;this.Z$l=
Od}}Object(c.a)(Lo,"Page",null,[]);class yk{constructor(U,Ea,kb,Nb,nc){this.Zuc=null;this.iPh=0;this.aN=U;this.H5d=Ea;this.LIh=kb;this.d1a=Nb;this.OIh=nc;this.beb=new W.a}get ef(){const U=this.aN.value;qa.ULS.shipAssertTag(37007393,336,U.gj,"PageManager.PageView is not a PageView.");return U}get pages(){return this.beb}qPj(U){U=this.bkj(U);this.sPj(U)}$Nn(U,Ea){this.iPh=Ea;U=this.bkj(U);this.sPj(U);this.OIh.isEnabled&&this.OIh.Vhb(U)}bkj(U){this.beb=new W.a;this.Zuc=new Hm.a(0);const Ea=new W.a;if(!U)return this.pages;
var kb=0,Nb=null;for(let nc=0;nc<U.count;nc++){const ad=U.J(nc);kb=ad.Nj;Nb=this.Ape(kb,Nb,ad);this.pages.add(Nb);!yk.$nf&&0>Nb.height&&Ea.add(Nb);Nb=ad}U=this.Ape(kb+1,Nb,null);this.pages.add(U);!yk.$nf&&0>U.height&&Ea.add(U);for(let nc of Ea)yk.$nf=!0,qa.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+nc.Nj);return this.pages}Ape(U,Ea,kb){const Nb=Ea?Ea.outlineNode:this.d1a.vxi(),nc=kb?kb.outlineNode:this.d1a.uzi();var ad=this.qBi(Nb);const Od=this.qBi(nc),
af=Ea?this.P3h(Ea):0;ad=af+ad;const ve=kb?this.P3h(kb):this.H5d.xKb.clientHeight-Od;return new Lo(U,af,ad,Nb.id===nc.id?ve-af:ve+Od-ad,Nb,nc,(kb?kb.Nj:this.iPh+1)===(Ea?Ea.Nj:0)+1)}P3h(U){return U.Pma?0:U.top}sPj(U){if(this.LIh.XPe)for(let Ea of this.LIh.XPe)Ea&&Ea.tPj(U)}qBi(U){this.Zuc||(this.Zuc=new Hm.a(0));if(this.Zuc.Na(U.id))return this.Zuc.J(U.id);var Ea=U.Qd(this.ef.Za);if(!Ea)return qa.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),0;Ea=da.a.TTa(this.H5d.xKb,
Ea.htmlElement).y;this.Zuc.$(U.id,Ea);return Ea}}yk.$nf=!1;Object(c.a)(yk,"PageManager",null,[1791]);var Qq=b(1193);class yr{constructor(U,Ea,kb,Nb,nc,ad,Od){this.wfh=this.grb=!1;this.ga=U;this.tL=Ea;this.Zab=kb;this.wv=Nb;this.vh=nc;this.PIh=ad;this.EJ=Od;this.grb=0===this.EJ.XG?!0:!1;this.RFg=this.RFg.bind(this);this.EJ.ZVh(this.RFg)}lb(){this.ga.Aa(bd.a.LOd,He.a.application,this.LOd.bind(this),96);this.ga.Aa(bd.a.lTe,He.a.application,this.lTe.bind(this),96);this.ga.Aa(bd.a.T1e,He.a.application,
this.T1e.bind(this),96);this.ga.Aa(bd.a.R1e,He.a.application,this.R1e.bind(this),8)}T1e(U,Ea,kb){return 1===kb?32:this.ga.processAction(bd.a.$ub,2)}R1e(U,Ea,kb,Nb){if(1===kb)return 0===this.EJ.XG?32:8;this.grb?(this.Tgi(),this.wfh=!0):(this.cki(),this.wfh=!1);this.vh.updateCommandUI();Nb.vq=this.grb?1:0;return 32}LOd(U,Ea,kb,Nb,nc){if(1===kb)return 32;U=this.PIh.Vwd();-1===U?U="":this.grb||1===this.EJ.XG?(Ea=this.PIh.Svi(),Ea>U&&(U=Ea),U=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,
Ea,U)):U=1===U?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,U):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,U);nc[Qq.a.Visible]=!0;nc[Qq.a.LabelText]=U;return 32}lTe(U,Ea,kb,Nb,nc){if(1===kb)return 32;nc[Qk.a.On]=this.grb;return 32}RFg(U,Ea){0!==Ea.Mfc||this.wfh?this.Tgi():this.cki()}cki(){this.grb||(this.Zab.Bel(),this.wv.Cvn(),this.grb=!0)}Tgi(){this.grb&&(this.Zab.gal(),this.wv.o_l(),this.grb=!1)}}Object(c.a)(yr,"PaginationActor",null,[]);class bq{constructor(U){this.ZQg=
U}}Object(c.a)(bq,"PaginationDeltaResult",null,[1814]);class Or{constructor(U,Ea){this.iZb=this.x6d=null;this.te=U;Ea.execute(kb=>{kb.register(this)})}get pAg(){return"PaginationDelta"}get result(){return this.x6d}get CEg(){return 1}get bZg(){return 200}get isEnabled(){return!0}KEg(){this.x6d=null}Vhb(U){this.te.Fd(()=>{try{this.yjd(U)}catch(Ea){qa.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",Ea.message)}},"PDM:C")}j8g(U){this.iZb=U}yjd(U){this.x6d=
null;U=this.Ajd(this.iZb,U);-1!==U&&(this.x6d=new bq(U))}Ajd(U,Ea){if(!(U&&Ea&&U.count&&Ea.count))return-1;const kb=new W.a;for(let Nb of U)kb.add(Nb.top);U=new W.a;for(let Nb of Ea)U.add(Nb.top);Ea=this.xue(kb,U);return this.fBc(Ea)}fBc(U){if(!U.count)return 0;let Ea=0;for(let kb=0;kb<U.count;kb++)Ea+=U.J(kb);return Ea/U.count}xue(U,Ea){const kb=new W.a;if(!U.count||!Ea.count)return kb;var Nb=U.count<=Ea.count;const nc=Nb?U:Ea;U=Nb?Ea:U;for(Ea=0;Ea<nc.count;Ea++){Nb=nc.J(Ea);let Od=Math.abs(Nb-U.J(0)),
af=0;for(let ve=1;ve<U.count;ve++){var ad=U.J(ve);ad=Math.abs(Nb-ad);ad<Od&&(Od=ad,af=ve)}kb.add(Od);U.removeAt(af)}return kb}}Object(c.a)(Or,"PaginationDeltaMetric",null,[1785]);var jn=b(383),pp=b(1216),Zo=b(1782);class Mo extends jn.a{constructor(U,Ea,kb,Nb,nc,ad,Od,af=null){super();this.WT=null;this.Abf=0;this.egb=-1;this.LNa=!1;this.l6=U;this.XBa=this.XBa.bind(this);this.l6.Ayc(this.XBa);this.ga=Ea;this.wv=kb;this.X5=Nb;this.Hwa=nc;this.dmf=af||ym.a.instance;this.nuc=this.J0a=$b.a.nil;this.zek=
Od;ad.CWR(()=>ad.result.oC.RBb(Object(u.a)(this,this.CWa,"onKickedOut")));this.XCc();this.vk=new pp.a(1E3);this.vk.rjb();this.Hwa.register(this)}get MBa(){return"Pagination"}get pDc(){return this.zek.value}get qjm(){return this.J0a}get NJj(){return this.egb}Opn(U){this.egb!==U&&(this.egb=U,this.X5.deh())}XBa(){this.J0a=this.nuc=$b.a.nil;this.XCc()}CWa(){qa.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.Ugi()}$Jb(U){this.WT=U;this.WT.xyc(Object(u.a)(this,
this.nHg,"onGraphSpaceReplication"));this.JBb(this.WT.node)}nHg(){if(0==this.l6.XG){var U=this.WT.Bw;$b.a.Ap(U,this.nuc)||(this.nuc=U,this.LGm(this.J0a,this.nuc))}}LGm(U,Ea){$b.a.Ap(U,Ea)?(this.wv.YKe(),this.XCc()):(this.wv.ZKe(),this.rzn())}Kel(){this.enabled=2}XCc(){this.enabled=0}rzn(){this.Abf=0;this.Kel();this.BI(null,null,null)}$za(){return Qe.App.lostSession||Qe.App.lc.oC.Gp?!1:!!(this.enabled&2)&&this.vk.h4()}BI(){this.vk.eFb();this.Hwa.Y0()}forceOutbound(){}Jba(){return 0===this.enabled?
!1:this.Md&&2===this.Md.status?!0:this.$za()}u8a(){if(1===this._state)this.Md.Pq=Zo.a.JR(J.AFrameworkApplication.rootQuerySignature,this.J0a),this.Md.RE="Pagination",this.Md.status=1,this._state=3;else if(3===this._state&&this.Md&&2===this.Md.status)if(J.AFrameworkApplication.mi)this._state=4;else if(this.vk.e9(),this.vk.nga(),this._state=1,this.Abf++,2!==this.Md.statusCode)this.YCc();else if(1!==(this.Md.xj?this.Md.xj.length:0))this.YCc();else{var U=this.Md.xj[0];this.dmf.Jvb(U);104===U.StatusCode?
this.Ugi():101===U.StatusCode?this.YCc():3===U.StatusCode?this.YCc():U.StatusCode?this.YCc():U.PageEnds?(this.Opn(U.PageEnds.length+1),this.J0a=nm.b(U.LastKnownPaginationRevision),qa.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.egb,this.J0a),this.wv.K_d(U.PageEnds,$b.a.Ap(this.J0a,this.nuc)),this.pDc.rta=U.PageEnds,this.X5.NJf(),qa.ULS.sendTraceTag(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",
this.egb,this.J0a),this.nal()):this.YCc()}}Ugi(){this.WT&&this.WT.qjc(Object(u.a)(this,this.nHg,"onGraphSpaceReplication"));this.XCc()}YCc(){60<this.Abf&&this.XCc()}nal(){$b.a.Ap(this.J0a,this.nuc)&&this.XCc()}dispose(){this.WT&&(this.WT.qjc(Object(u.a)(this,this.nHg,"onGraphSpaceReplication")),this.WT.node&&this.VLb(this.WT.node),this.WT=null);this.l6.VUg(this.XBa)}JBb(U){U&&(U.addListener(this),this.LNa=!0)}VLb(U){this.LNa&&U&&(U.removeListener(this),this.LNa=!1)}aKb(U){this.VLb(U)}onBeforeLoadContent(){}onAfterLoadContent(U){(U=
U.kd.Mn)&&this.$Dm(this.J0a,U.id)}onAfterFirstSaveContent(){}$Dm(U,Ea){$b.a.Ap(U,Ea)&&this.wv.YKe()}}Object(c.a)(Mo,"PaginationReplicator",jn.a,[1783,12,113]);class hr{constructor(){this.Vja=this.wv=this.X5=this.Zab=this.ry=this.Ja=this.Z=null;this.aU=!1}get name(){return"WordEditor.Pagination"}get LSn(){return J.AFrameworkApplication.K.ea("WordEditorPageEndMarkerPositionUpdaterIsEnabled")}Hb(U){this.Z=U;this.Ja=this.Z.resolve("Box4.IFeatureHelper");this.Z.ha("WordEditor.Pagination.PageElementManagerList",
()=>new sq(this.Z.resolve("WordEditor.Pagination.PageAdornmentManager"),this.Z.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();this.Z.ha("WordEditor.Pagination.OutlineManager",()=>new nl(new xb.a(()=>Qe.App.oa.za.Rb))).as("WordEditor.Pagination.IOutlineManager").singleInstance();this.Z.ha("WordEditor.Pagination.PageManager",()=>new yk(new xb.a(()=>Qe.App.oa.za.Rb),this.Z.resolve("WordEditor.Pagination.DocumentSizeManager"),this.Z.resolve("WordEditor.Pagination.PageElementManagerList"),
this.Z.resolve("WordEditor.Pagination.OutlineManager"),this.Z.resolve("WordEditor.Pagination.PageHeightDeltaMetric"))).as("WordEditor.Pagination.IPageManager").singleInstance();this.Z.ha("WordEditor.IPaginationReplicator",()=>new Mo(this.Z.resolve("WordEditor.IMainViewModeManager"),J.AFrameworkApplication.pa,this.Z.resolve("WordEditor.Pagination.IPageEndMarkers"),this.Z.resolve("WordEditor.Pagination.CurrentPageCalculator"),dk.App.T8,Qe.App.Sra(),new xb.a(()=>this.Z.resolve("WordEditor.TableOfContents.IDocumentHeadings")))).singleInstance();
this.Z.ha("WordEditor.ICurrentPageManager",()=>new zp(this.Z.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();this.Z.ha("WordEditor.Pagination.PageLevelDeltaMetric",()=>new il(new xb.a(()=>Qe.App.oa.za.Rb),this.Z.resolve("Box4.ITextMetricsAdapter"),hj.a.instance,this.Z.Ca("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.Z.ha("WordEditor.Pagination.PageHeightDeltaMetric",()=>new cl(this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),
hj.a.instance,this.Z.Ca("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.Z.ha("WordEditor.Pagination.PaginationDeltaMetric",()=>new Or(hj.a.instance,this.Z.Ca("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.Z.ha("WordEditor.Pagination.PageHeightStorage",()=>new am(this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.Z.ha("WordEditor.Pagination.PageFullHeightDOMHelper",()=>new io(new xb.a(()=>Qe.App.oa.za.Rb),
this.Z.resolve("Common.IZoomManager"),this.Z.resolve("WordEditor.Pagination.PageEndDOMHelper"))).singleInstance();this.Z.ha("WordEditor.Pagination.PageFullHeightInfoCalculator",()=>new bl(this.Z.resolve("WordEditor.Pagination.PageHeightStorage"),this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.Z.ha("WordEditor.Pagination.PageFullHeightRenderer",()=>new Pq(this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),this.Z.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"))).singleInstance();
this.Z.ha("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory",()=>new Ko(this.Z.resolve("WordEditor.Pagination.PageFullHeightManager"),this.Z.vf("WordEditor.Pagination.PageEndMarkerPositionUpdater"),this.Z.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"),this.Z.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.Z.ha("WordEditor.Pagination.PageFullHeightPositionUpdater",()=>this.Z.resolve("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory").create()).singleInstance();
this.Z.ha("WordEditor.Pagination.PageEndMarkerPositionUpdater",()=>new Pn(new xb.a(()=>Qe.App.oa.za.Rb),this.Z.resolve("Common.IZoomManager"),this.Z.resolve("WordEditor.Pagination.OutlineManager"),this.Z.resolve("WordEditor.Pagination.PageEndDOMHelper"),this.Z.resolve("WordEditor.Pagination.PageFullHeightPositionUpdater"),this.Z.resolve("WordEditor.Pagination.PageFullHeightManager"),Qe.App.jj.Cm)).as("WordEditor.Pagination.IPageEndMarkerPositionUpdater").singleInstance();this.Z.ha("WordEditor.Pagination.PageFullHeightManagerFactory",
()=>new xk(this.Z.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.Z.resolve("WordEditor.Pagination.PageHeightStorage"),fr.WordSectionNavigator.instance,this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.Z.ha("WordEditor.Pagination.PageFullHeightManager",()=>this.Z.resolve("WordEditor.Pagination.PageFullHeightManagerFactory").create()).singleInstance();this.Z.ha("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new po(this.Z.resolve("Common.IZoomManager"),
hj.a.instance)).as("WordEditor.Pagination.IPageEndMarkerPositionComparer").singleInstance();this.Z.ha("WordEditor.Pagination.PaginationActor",()=>new yr(J.AFrameworkApplication.pa,this.Z.resolve("WordEditor.IStatusBarUser"),this.Z.resolve("WordEditor.ICurrentPageManager"),this.Z.resolve("WordEditor.Pagination.IPageEndMarkers"),J.AFrameworkApplication.la,this.Z.resolve("WordEditor.IPageNumberFinder"),this.Z.resolve("WordEditor.IMainViewModeManager"))).singleInstance();this.Z.ha("WordEditor.Pagination.DocumentSizeManager",
()=>new oo(new xb.a(()=>Qe.App.oa.za.Rb),rq.a.get_instance(),this.Z.resolve("WordEditor.IMainViewModeManager"))).singleInstance();this.Z.ha("WordEditor.Pagination.CurrentPageCalculator",()=>new Nq(J.AFrameworkApplication.pa,mo.a.instance,ho.a.instance,this.Z.resolve("WordEditor.Pagination.DocumentSizeManager"),new xb.a(()=>Qe.App.oa.za.Rb),this.Z.sa("Box4.CpConversionManagerImpl"),this.Z.resolve("WordEditor.IStatusBarUser"))).as("Common.ICurrentPageCalculator").singleInstance();this.Z.ha("WordEditor.Pagination.PageEndMarkers",
()=>this.wv=new sg(new xb.a(()=>Qe.App.oa.za.Rb),new xb.a(()=>Qe.App.oa.za.jc.kd),this.Z.resolve("WordEditor.Pagination.IPageAdornmentManager"),this.Z.resolve("WordEditor.Pagination.IPageEndMarkerPositionUpdater"),this.Z.resolve("WordEditor.Pagination.IPageEndMarkerPositionComparer"),this.Z.resolve("WordEditor.Pagination.IPageManager"),this.Z.resolve("WordEditor.Pagination.DocumentSizeManager"),this.Z.resolve("WordEditor.Pagination.PageEndDOMHelper"),Nr.a.Kvd,this.Z.resolve("WordEditor.ParagraphWordIdMapping"),
ho.a.instance,sg.zBl,this.Z.resolve("Box4.ContentEditableViewEventSource"),new In.a,this.Z.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),this.Z.resolve("WordEditor.Pagination.PageFullHeightManager"),null,this.Z.resolve("WordEditor.Pagination.PaginationDeltaMetric"),this.Z.resolve("Common.ICurrentPageCalculator"),this.LSn,this.Z.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.Pagination.IPageEndMarkers").as("Box4.IPaginationRefreshHelper").singleInstance();this.Z.ha("WordEditor.Pagination.PageEndDOMHelper",
()=>new Rm(this.Z.Ca("Common.IZoomManager"),this.Z.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Qe.App.instance&&Qe.App.instance.jQ)).singleInstance();this.Z.ha("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new Jo(J.AFrameworkApplication.tb)).as("WordEditor.Pagination.IPageAdornmentAnimationManager").singleInstance();this.Z.ha("WordEditor.Pagination.PageAdornmentContentManager",()=>new Ip(this.Z.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Pagination.IPageAdornmentContentManager").singleInstance();
this.Z.ha("WordEditor.Pagination.PageAdornmentManager",()=>this.Vja=new If(new xb.a(()=>Qe.App.oa.za.Rb),ye.a.instance,Og.a.instance,Jg.a.instance,J.AFrameworkApplication.pa,xr.a.instance,this.Z.resolve("WordEditor.Pagination.IPageAdornmentAnimationManager"),this.Z.resolve("WordEditor.Pagination.IPageAdornmentContentManager"),this.Z.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),ho.a.instance,J.AFrameworkApplication.K,!!Qe.App.instance&&Qe.App.instance.jQ,!!Qe.App.instance&&Qe.App.instance.Bsa)).as("WordEditor.Pagination.IPageAdornmentManager").singleInstance()}init(){this.Ja.tk.continueWith(()=>
{this.Po()})}Po(){const U=Qe.App.oa.za;U.IIa?this.wYh():U.mqa(Object(u.a)(this,this.nCk,"appIsInteractiveEventHandling"))}nCk(){this.wYh()}wYh(){this.aU||(this.aU=!0,this.Zab=ia.a.instance.resolve("WordEditor.ICurrentPageManager"),this.X5=ia.a.instance.resolve("Common.ICurrentPageCalculator"),this.ry=ia.a.instance.resolve("WordEditor.IPaginationReplicator"),ia.a.instance.resolve("WordEditor.Pagination.PaginationActor").lb())}dispose(){this.Vja&&(this.Vja.dispose(),this.Vja=null);this.wv&&(this.wv.dispose(),
this.wv=null);this.ry&&(this.ry.dispose(),this.ry=null);this.X5&&(this.X5.disable(),this.X5=null);this.Zab&&(this.Zab=null)}}Object(c.a)(hr,"PackageManager",null,[1,2]);class Tk{constructor(){this.Z=null}Hb(U){this.Z=U||ia.a.instance}dispose(){}}Object(c.a)(Tk,"TellMePackage",null,[1,2]);var lk=b(1295),No=b(1299),qm=b(265),Bm=b(1294),Cm=b(1204);class zr{constructor(U=null,Ea=null,kb=null,Nb,nc=null){this.E8e=null;this.Mnh=!1;this.lwh=this.qqc=null;this.Mnk=this.LNh=this.toh=this.mwh=!1;this.A4d=null;
this.W2j=null==Ea?J.AFrameworkApplication.Bhb:Ea;this.Vbk=null==kb?J.AFrameworkApplication.hY:kb;this.ook=null==nc?J.AFrameworkApplication.bLa:nc;this.Jak=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("TellMeHelpOnHelpIsEnabled");this.Rpk=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("TellMeCommandHookIsEnabled");this.Mpn(!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("TellMeIgnoreQueryForHelp"));this.Ipk=!!J.AFrameworkApplication.la&&J.AFrameworkApplication.la.eb.gLc;
this.Jpk=!Bm.a.Fy()&&!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("TellMePeopleSuggestionIsEnabled");this.Hpk=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("TellMeFileSuggestionIsEnabled");this.X8j=!!J.AFrameworkApplication.la&&J.AFrameworkApplication.la.eb.GNb;this.Kpk=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.pnk=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("HelpShowsTopSearchResult");this.fik=this.cVd||
this.RSc;this.dik=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("OnlineCommandSuggestionsIsEnabled");this.eik=this.aqg;this.Jdk=!!J.AFrameworkApplication.K&&this.M9a&&J.AFrameworkApplication.K.ea("StyledHeaderInLabelIsEnabled");this.m$j=J.AFrameworkApplication.K?J.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.S$j=J.AFrameworkApplication.K?J.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",
1400):1400;this.a$j=J.AFrameworkApplication.K?parseFloat(J.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.Hdk=!!J.AFrameworkApplication.K&&(J.AFrameworkApplication.K.ea("SmartLookupNoteSearchIsEnabled")||J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.Uok=J.AFrameworkApplication.K?J.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl",
"https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.V$j=J.AFrameworkApplication.K?J.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.qnk=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.cok=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",
!1);this.Hnk=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("ShowFindInDocumentInZeroTermSearchBox")||this.K8;this.Rdk=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1);this.Adk=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("TellMeIsRuleBasedSortingEnabled")&&"en-US"===J.AFrameworkApplication.uiCulture;this.Pdk=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",
!1);this.bek=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("TellMeZeroTermContextualCommandSuggestionsEnabled");this.J2j=this.M9a&&!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.rak=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.gok=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",
!1);this.d4j=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.srk=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UsePerformanceMarker",!1);this.lck=!!J.AFrameworkApplication.K&&J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);J.AFrameworkApplication.K&&J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",
!1);this.R$j=J.AFrameworkApplication.K?J.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.Lpk=this.hVi&&(this.cKg||this.dKg||this.dLd||this.M9a&&Bm.a.AVa()&&!!J.AFrameworkApplication.K&&(this.WSc||this.JNb||this.KNb||this.LNb||this.MNb||J.AFrameworkApplication.K.ea("ShowAnswerSearchResults")||J.AFrameworkApplication.K.ea("ShowDefinitionSearchResults")||J.AFrameworkApplication.K.ea("ShowEntitySearchResults")||J.AFrameworkApplication.K.ea("ShowWolframSearchResults")));
this.c3l(U||{});this.Htf="2918242107";this.Gtf="1454393937";this.KYb={};this.lBb=[];this.gYk=[Bm.a.L2e]}get application(){return this.qqc}get Bhb(){return this.W2j}get Bfn(){return this.Htf}get Afn(){return this.Gtf}get J1f(){return this.lwh}get noi(){return this.mwh}get hY(){return this.Vbk}get bLa(){return this.ook}get uhb(){return this.toh}get d_l(){return this.Jak}get XCn(){return this.Rpk}get hVi(){return!0}get NCn(){return this.Lpk}get Yrn(){return this.LNh}Mpn(U){this.LNh=U}get M9a(){return this.Ipk}get dYd(){return this.Jpk}get bYd(){return this.Hpk}get hjl(){return this.X8j}get LCn(){return this.Kpk}get r2e(){return!1}get dLd(){return this.fik}get cKg(){return this.dik}get dKg(){return this.eik}get lpb(){return!1}get zHe(){return!1}get osg(){return this.Jdk}get iZe(){return this.Mnk}get WSc(){return!1}get btn(){return!1}get mkm(){return""}get aqg(){return!1}get f$f(){return 2}get CLl(){return 4}get DLl(){return 5}get ODi(){return""}get Bzl(){return this.m$j}get bEi(){return this.S$j}get QDi(){return 1E3}get PDi(){return 1E-6}get GAn(){return this.Uok}get M8g(){return!1}get GGj(){return!1}get Uem(){return this.Adk}get mGe(){return!1}get cHe(){return!1}get dHe(){return!1}get OSi(){return!1}get NSi(){return!1}get mpb(){return!1}get jVi(){return!1}get nue(){return!1}get Qtb(){return!1}get JNb(){return!1}get KNb(){return!1}get LNb(){return!1}get MNb(){return!1}get cVd(){return this.pnk}get SSc(){return this.qnk}get RSc(){return!1}get d7f(){return null}get ZGe(){return!1}get YYe(){return this.Hnk}get UAi(){return 0}get Cul(){return this.a$j}get EEi(){return this.V$j}get Efm(){return this.Hdk}get HGl(){return-3.9}get K8(){return this.cok}get UEd(){return this.Rdk}get Jsg(){return this.Pdk}get Ghd(){return this.J2j}get Vhm(){return this.bek}get Fmb(){return this.rak}get RDj(){return this.gok}get $Hk(){return this.d4j}get d4e(){return this.srk}get Tlg(){return this.lck}get WA(){return this.R$j}get epb(){return!!J.AFrameworkApplication.la&&
J.AFrameworkApplication.la.eb.lo}get lo(){return!!J.AFrameworkApplication.la&&J.AFrameworkApplication.la.eb.lo}get Fcm(){return!!J.AFrameworkApplication.la&&J.AFrameworkApplication.la.eb.$lc}get Dzm(){return Bd.getImageClass("OfficeAssistant_32x32x32")}kxe(){return Promise.reject("GetFindMatchCount method is not overridden")}NHe(U){return Array.contains(appChrome.selectors.getVisibleControlIds(),U)}fFe(){return!1}rlj(){}Rve(){return null}get h5a(){return"NoOpHeaderUi"}get ZXk(){return this.A4d}get parameterData(){return this.KYb}get eIn(){return this.lBb}wgl(){if(this.E8e&&
!this.Mnh&&(this.Mnh=!0,this.vNb(this.E8e),this.lo)){var U=ia.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");U=(new Cm.a(U)).Kve(this.E8e.dL);appChrome.api.dispatch(U)}}get lZg(){return""}vNb(){}E$k(U){const Ea=[];for(let kb=0;kb<U.length;++kb)U[kb].Jtn?Ea.push(new qm.a(U[kb].alternate,Bm.a.XLj+kb.toString())):Ea.push(new qm.a(U[kb].standard,Bm.a.L2e+kb.toString()));return Ea}c3l(U){const Ea={};for(let kb in U){const Nb=kb,nc=U[kb];for(let ad in nc){const Od=ad,af=nc[ad];(Ea[Od]||
(Ea[Od]={}))[Nb]=af}}this.A4d=Ea}get oIj(){return""}get nIj(){return""}get mIj(){return""}get PCj(){return!1}}Object(c.a)(zr,"TellMeApplicationData",null,[1014]);class ir{constructor(U,Ea=null,kb=!1){this.standard=U;this.alternate=Ea;this.Jtn=kb}}Object(c.a)(ir,"TryQuerySet",null,[]);var Rj=b(1449);class Dc{get F8a(){return Rj.a.AppsForOffice_Query}Iaa(U){return Qd.a(String.format("{0}|{1}|",3,bc.a.Vd(U.value)),za.a.FLc.toString(),Dc.CBm)}}Dc.CBm="Explore Office Store";Object(c.a)(Dc,"AppsForOfficeQueryMenuItemFactory",
null,[1034]);var tq=b(1285);class hm{constructor(){this.icon=this.description=this.assetId=this.name=null;this.installed=!1;this.storeId=this.currentStoreType=this.assetStoreId=this.appVersion=null;this.targetType=0}}Object(c.a)(hm,"OfficeAppItem",null,[]);class rm{constructor(){this.j3d=null}get phb(){this.j3d||(this.j3d={},this.NWm());return this.j3d}TKk(U){if(U)for(let Ea of U)U=Ea[1],U in this.phb&&(U=this.phb[U],U.installed=!0,U.name=Ea[0],U.description=Ea[2],U.targetType=Ea[3],U.appVersion=
Ea[4],U.currentStoreType=Ea[6],U.icon=Ea[9],U.storeId=Ea[11],U.assetStoreId=Ea[12])}Bgl(U,Ea,kb,Nb,nc){!tq.b(U)&&U in this.phb&&(U=this.phb[U],U.installed=!0,U.appVersion=Ea,U.storeId=kb,U.assetStoreId=Nb,U.targetType=nc)}G6(U,Ea,kb,Nb){const nc=new hm;nc.assetId=Ea;nc.name=U;nc.icon=kb;nc.description=Nb;nc.installed=!1;this.j3d[Ea]=nc}NWm(){this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_Translator,"WA104124372",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_Translator,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_Translator);
this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_TextMaster,"WA104079622",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_TextMaster,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_TextMaster);this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_ConsistencyChecker,"WA104041485",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_ConsistencyChecker,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_ConsistencyChecker);this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_EFax,
"WA102919521",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_EFax,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_EFax);this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_ProWordCloud,"WA104038830",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_ProWordCloud,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_ProWordCloud);this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_FontFinder,"WA104211266",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_FontFinder,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_FontFinder);
this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_PicHit,"WA104178141",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_PicHit,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_PicHit);this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_IMGEffector,"WA104070070",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_IMGEffector,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_IMGEffector);this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_LucidChart,"WA103633427",
WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_LucidChart,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_LucidChart);this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_DocuSign,"WA104218065",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_DocuSign,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_DocuSign);this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_GeoGebraTube,"WA104199813",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_GeoGebraTube,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_GeoGebraTube);
this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_WordCalc,"WA103699714",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_WordCalc,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_WordCalc);this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_QR4Office,"WA104051163",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_QR4Office,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_QR4Office);this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_SymbolsCharacters,"WA104379279",
WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_SymbolsCharacters,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_SymbolsCharacters);this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_WordToHTML,"WA104320163",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_WordToHTML,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_WordToHTML);this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_MapIt,"WA104374368",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_MapIt,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_MapIt);
this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_AbbreviationList,"WA104043061",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_AbbreviationList,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_AbbreviationList);this.G6(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_HandyCalculator,"WA104379673",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_HandyCalculator,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_HandyCalculator)}static get instance(){return rm.na}}rm.na=
new rm;Object(c.a)(rm,"AppData",null,[]);const Hk=(U,Ea,kb,Nb=null)=>{const nc=bc.a.Vd(U.name);var ad="TellMe_OfficeAddin_Control";kb.sGe()?ad="TellMe_OfficeAddin_SingleFlyoutLayout":kb.hTi()&&(ad="TellMe_OfficeAddin_StandaloneFlyoutLayout");kb=U.installed?String.format("{0}|{1}|{2}|{3}|{4}|{5}|{6}",U.assetId,U.appVersion,U.storeId,U.assetStoreId,U.targetType,bc.a.Vd(U.name),ad):String.format("{0}|{1}||{2}",2,U.assetId,ad);ad=bc.a.Vd(U.description);return Qd.b(kb,U.installed?za.a.wAd.toString():za.a.FLc.toString(),
nc,U.icon,Ea?"cui-img-16by16":"cui-img-32by32",null,Nb?Nb.sessionId+"|"+Nb.gsa+"|"+U.name:"",nc,Ea?"Menu16":"Menu32",null,za.a.u$g.toString(),ad,null,null)},qi=(U,Ea,kb,Nb,nc)=>Qd.h(U,null,null,null,!1,!0,null,null,"Image16by16",Ea,kb,Nb,null,Nb,null,!1,!1,!0,nc);class yn{constructor(U){this.Gb=U}get F8a(){return Rj.a.AppsForOffice_Recommandation}Iaa(U,Ea=null){if(this.Gb.sGe()){var kb=[];U=U.value.split("|");for(let Nb of U)if(!tq.b(Nb)){let nc=Hk(rm.instance.phb[Nb],!1,this.Gb,Ea);kb.push(nc)}Ea=
CommonUIStrings.l_TellMeAppsForOfficeMenuSectionTitle;kb=Qd.e("TellMeDropdownControlsForApps_SingleFlyoutLayout",kb);Ea=Qd.j("TellMeDropdownMenuSectionForApps_SingleFlyoutLayout",kb,"Menu32",Ea);U=String.format(CommonUIStrings.l_TellMeAppsForOfficeFlyoutAnchorTitle,U.length-1);return qi("TellMeFlyoutAnchorForApps_SingleFlyoutLayout",J.AFrameworkApplication.ln,Bd.getImageClass("AppForOfficeLogo_16x16x32"),U,[Ea])}U=rm.instance.phb[U.value];return this.Gb.hTi()?(Ea=[Hk(U,!1,this.Gb,Ea)],Ea=Qd.e("TellMeControlsForApps_StandardFlyoutLayout",
Ea),Ea=Qd.j("TellMeMenuSectionForApps_StandardFlyoutLayout",Ea,"Menu32"),kb=String.format(CommonUIStrings.l_TellMeAppsForOfficeInsertAppHint,bc.a.Vd(U.name)),qi("TellMeFlyoutAnchorForApps_StandardFlyoutLayout"+U.assetId,U.icon,"cui-img-16by16",kb,[Ea])):Hk(U,!0,this.Gb,Ea)}}Object(c.a)(yn,"AppsForOfficeRecommendationMenuItemFactory",null,[1034]);var Wk=b(1300);class Dm{constructor(){this.GZc=0;this.hoh=!1}bOd(){this.hoh||(this.Xic(),this.hoh=!0);if(!this.GZc||4===this.GZc){const U=new uc.a(2,1,0,
Object(u.a)(this,this.acn,"retrieveData"));J.AFrameworkApplication.tb.rb(U);this.GZc=1}}Xic(){const U={};U.callback=Object(u.a)(this,this.xCm,"onAppForOfficeActivated");J.AFrameworkApplication.pa.ob(za.a.Xic,2,U)}acn(){const U={};U.callback=Object(u.a)(this,this.mEm,"onDataReady");J.AFrameworkApplication.pa.ob(za.a.Hrb,2,U)}xCm(U,Ea){rm.instance.Bgl(Ea[0],Ea[1],Ea[2],Ea[3],Ea[4])}mEm(U){U?(U.errorCode||rm.instance.TKk(U.value),this.GZc=U.errorCode&&-1!==U.errorCode?-2147208619===U.errorCode?4:3:2):
this.GZc=3}static get instance(){return Dm.na}}Dm.na=new Dm;Object(c.a)(Dm,"AppEntitlementQuery",null,[]);class jj{constructor(U){this.Pdd=this.VKh=null;this.Gb=U}initialize(){Dm.instance.bOd();this.Gb.sGe()&&(this.VKh=[]);this.Pdd=null}JOn(U,Ea){U in rm.instance.phb&&(rm.instance.phb[U].installed?Ea.DB(new Wk.a(U,Rj.a.AppsForOffice_Installed)):(this.Pdd||(this.Pdd=U),this.Gb.sGe()&&this.VKh.push(U)))}kxk(U,Ea){this.Pdd&&!tq.b(Ea)&&(U.DB(new Wk.a(this.Pdd,Rj.a.AppsForOffice_Recommandation)),U.DB(new Wk.a(Ea,
Rj.a.AppsForOffice_Query)))}}Object(c.a)(jj,"AppsForOfficeResultsProvider",null,[1815]);class kj{constructor(){this.$Fh=this.aGh=null}get Lxm(){return this.$Fh}Iaa(U){this.aGh=U;return this.PRf(U)}xAm(){this.$Fh=this.aGh}Wxe(U){return 8===U.type?String.format(CommonUIStrings.l_FindInDocumentText,U.aG):U.aG}C6f(U){return U.aG}}Object(c.a)(kj,"ParameterizedCommand",null,[]);class zn extends kj{constructor(U){super();this.IEd=U}get commandId(){return this.IEd?"DefinitionsParameterized":"DefinitionButton"}get HLg(){return"Definition"}PRf(U){const Ea=
bc.a.Vd(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,U.aG));return Qd.a(Bm.a.SSf(U.value),za.a.zqe.toString(),Ea,Bm.a.Tkg,null,bc.a.Vd(Bm.a.Z5b(U.aG)),Ea,null,null)}Wxe(U){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,U.aG)}C6f(U){return Bm.a.Z5b(U.aG)}}Object(c.a)(zn,"DefinitionsParameterizedCommand",kj,[]);class Pg extends kj{constructor(U){super();this.IEd=U}get commandId(){return this.IEd?J.AFrameworkApplication.la.eb.fRi?
"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get HLg(){return"Find"}PRf(U){const Ea=bc.a.Vd(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,U.aG));return Qd.a(Bm.a.SSf(U.value),za.a.findInDocument.toString(),Ea,"Find_16x16x32",null,bc.a.Vd(U.aG),Ea,null,null)}Wxe(U){return String.format(CommonUIStrings.l_TextWithQuotation,U.aG)}}Object(c.a)(Pg,"FindParameterizedCommand",kj,[]);class kn{constructor(U){this.Gb=U}get F8a(){return Rj.a.AppsForOffice_Installed}Iaa(U,
Ea=null){return Hk(rm.instance.phb[U.value],!0,this.Gb,Ea)}}Object(c.a)(kn,"InstalledAppsForOfficeMenuItemFactory",null,[1034]);class Wj extends kj{constructor(U){super();this.IEd=U}get commandId(){return this.IEd?"SynonymsParameterized":"SynonymButton"}get HLg(){return"Synonym"}PRf(U){const Ea=bc.a.Vd(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,U.aG));return Qd.a(Bm.a.SSf(U.value),za.a.zqe.toString(),Ea,Bm.a.Tkg,null,bc.a.Vd(Bm.a.Z5b(U.aG)),Ea,null,null)}Wxe(U){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,
U.aG)}C6f(U){return Bm.a.Z5b(U.aG)}}Object(c.a)(Wj,"SynonymsParameterizedCommand",kj,[]);var An=b(1791),Y=b(1716),pa=b(1803),lb=b(1786),Sb=b(1787),jc=b(1392);class Lc extends An.a{constructor(){super(...arguments);this.SZ=null;this.Zfb=Y.FindManager.createInstance(this,pa.a.instance,jc.a.instance,!0,!0)}static get instance(){return Lc.na}rEc(){this.SZ(this.Zfb.Yj.qua);this.Zfb.Zhb(!0)}kxe(U){const Ea=new Promise((kb,Nb)=>{this.SZ=kb;setTimeout(()=>{Nb("Find manager execution timed out");this.Zfb.Zhb(!0)},
500)});U=lb.a.createQuery(U,Sb.a.none);this.Zfb.find(U);return Ea}}Lc.na=new Lc;Object(c.a)(Lc,"TellMeFindStatusSpy",An.a,[]);class rd extends zr{constructor(U){super({});this.m9e=null;this.qqc="Word";this.z$j=U;J.AFrameworkApplication.K.ea("TellMeFindInDocumentIsEnabled")&&(this.mwh=!0,this.lwh=this.nue?"FindWithMatchesParameterized":"FindParameterized");this.toh=J.AFrameworkApplication.K.ea("SearchOfficeAddinIsEnabled")&&!J.AFrameworkApplication.K.ea("AppsForOfficeThirdPartyIsDisabled");U=new zn(this.epb);
const Ea=new Wj(this.epb);this.parameterData[U.commandId]=U;this.parameterData[Ea.commandId]=Ea;J.AFrameworkApplication.K.ea("WordEditorTellMeParameterizedFindIsEnabled")&&(U=new Pg(this.epb),this.parameterData[U.commandId]=U);J.AFrameworkApplication.K.ea("TellMeTryQueriesIsEnabled")&&(U=[new ir(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new ir(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new ir(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new ir(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,
"",!1),new ir(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.lBb=this.E$k(U))}kxe(U){return Lc.instance.kxe(U)}get AKa(){return $p.AppFrame.Uca}get h5a(){return $p.AppFrame.Yra}Rve(){this.uhb&&!this.m9e&&(this.m9e=new jj(this));return this.m9e}rlj(U){this.uhb&&(U.ha(new kn(this)),U.ha(new yn(this)),U.ha(new Dc))}get lZg(){return"Microsoft.Office.Web.SessionSettings.IWacWordSharedHeaderSearchBoxSettings"}vNb(U){var Ea=J.AFrameworkApplication.K;U=U.dL;U.WordCountFlyout=!this.z$j();
U.SelectAllButton=!Ea.ea("TellMeSelectAllResultIsEnabled");const kb=Ea.ea("TellMeDesktopUpSellIsEnabled");let Nb=J.AFrameworkApplication.iVi;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!Nb));Nb=!1;U.TextBoxUpSellButton=!kb||Nb;U.TableOfContentsUpSellButton=!kb||Nb;U.SmartArtUpSellButton=!kb||Nb;U.WordArtUpSellButton=!kb||Nb;U.MultiColumnLayoutUpSellButton=!kb||Nb;U.InsertEquationUpSellButton=!kb||Nb;U.TrackChangesUpSellButton=!kb||Nb;U.ShapesUpSellButton=!kb||
Nb;U.LabelsUpSellButton=!kb||Nb;U.InsertCitationUpSellButton=!kb||Nb;U.TextBoxUpSellButtonEnterprise=!kb||!Nb;U.TableOfContentsUpSellButtonEnterprise=!kb||!Nb;U.SmartArtUpSellButtonEnterprise=!kb||!Nb;U.WordArtUpSellButtonEnterprise=!kb||!Nb;U.MultiColumnLayoutUpSellButtonEnterprise=!kb||!Nb;U.InsertEquationUpSellButtonEnterprise=!kb||!Nb;U.TrackChangesUpSellButtonEnterprise=!kb||!Nb;U.ShapesUpSellButtonEnterprise=!kb||!Nb;U.LabelsUpSellButtonEnterprise=!kb||!Nb;U.InsertCitationUpSellButtonEnterprise=
!kb||!Nb;Ea=!Ea.ea("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!J.AFrameworkApplication.hY;U.SynonymButton=Ea;U.DefinitionButton=Ea}sGe(){return J.AFrameworkApplication.K.jb("OfficeAddInSearchResultLayoutVariant",rd.F7i)===rd.wBm}hTi(){return J.AFrameworkApplication.K.jb("OfficeAddInSearchResultLayoutVariant",rd.F7i)===rd.xBm}get oIj(){return J.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermModelName","")}get nIj(){return J.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName",
"")}get M8g(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",!1)}get mIj(){return J.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName","")}get WSc(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get aqg(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",
!1)}get f$f(){return J.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get PCj(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",!1)}get zHe(){return J.AFrameworkApplication.K.ea("TellMeRankerLoggingIsEnabled")&&J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get mGe(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",
!1)}get cHe(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get dHe(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",!1)}get QDi(){return J.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",1E3)}get PDi(){return 1E-6*J.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",
1)}get OSi(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get NSi(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",!1)}get ODi(){return J.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName","")}get mpb(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNotesSuggestionIsEnabled",
!1)}get jVi(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get UAi(){return J.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get hVi(){return J.AFrameworkApplication.K.ea("TellMeServiceForSearchIsEnabled")}get r2e(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",!1)}get lpb(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",
!1)}get iZe(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",!1)}get GGj(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get ZGe(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",!1)}get JNb(){return J.AFrameworkApplication.K.ea("ShowAnswerSearchResults")}get KNb(){return J.AFrameworkApplication.K.ea("ShowDefinitionSearchResults")}get LNb(){return J.AFrameworkApplication.K.ea("ShowEntitySearchResults")}get MNb(){return J.AFrameworkApplication.K.ea("ShowWolframSearchResults")}get d7f(){return J.AFrameworkApplication.K.ea("ModernFontPickerIsEnabled")?
{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}rd.F7i=1;rd.xBm=2;rd.wBm=3;Object(c.a)(rd,"WordEditorTellMeApplicationData",zr,[]);var Fd=b(1370),pe;(function(U){U[U.none=0]="none";U[U.waitAll=1]="waitAll";U[U.synchronizeFast=2]="synchronizeFast";U[U.synchronizeSlow=3]="synchronizeSlow"})(pe||(pe={}));Object(c.b)("ProviderSynchronizationType",pe);var Ie;(function(U){U[U.immediate=0]="immediate";U[U.waitAll=1]="waitAll";U[U.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";U[U.synchronizeAndWaitForRanker=
3]="synchronizeAndWaitForRanker"})(Ie||(Ie={}));Object(c.b)("MenuUpdatePolicy",Ie);var pg=b(1305),Rg=b(1306),qe=b(1334),Wh=b(96),Ik=b(232);class Sj extends An.a{constructor(U){super();this.ksk=U}rEc(){this.ksk.update()}}Object(c.a)(Sj,"TellMeFindStatusManager",An.a,[]);class xl{constructor(U){this.gBb=this.Tph=null;this.lh=0;this.L8d="TellMeWAC.";const Ea=U.J1f;this.Gb=U;this.C6d=Ea;this.Nlf=Object.assign(new Fd.a,{landingTab:"Indoc",data:null});U=new Sj(this);this.Zfb=Y.FindManager.createInstance(U,
pa.a.instance,jc.a.instance,!0,!0)}ZX(){return"WordFindInDocument"}Bba(){return this.Gb.f$f?this.Gb.f$f===Ie.waitAll?pe.waitAll:pe.synchronizeSlow:pe.none}HS(U,Ea){this.vhm(U)?(this.gBb=U,this.Tph=Ea,U=lb.a.createQuery(U.Qg,Sb.a.none),this.lh=window.performance.now(),this.Zfb.find(U)):Ea.resultsUpdated(new pg.a(U))}update(){this.Dhn(Math.round(window.performance.now()-this.lh));var U=String.format(CommonUIStrings.l_TextWithQuotation,this.gBb.Qg);var Ea=J.AFrameworkApplication.la&&J.AFrameworkApplication.la.eb.Qtb?
Bm.a.ejb(this.gBb.Qg,15,this.Nlf):bc.a.Vd(this.gBb.Qg);const kb=[];kb.push(appChrome.actions.setControlLabel(this.C6d,U));kb.push(appChrome.actions.setCompoundButtonCommandValueId(this.C6d,Ea));kb.push(appChrome.actions.updateCompoundButtonDescription(this.C6d,this.fdg()));appChrome.api.dispatch(kb);U=new Wk.a(this.C6d,Rj.a.FindInDocument,this.gBb.Qg,this.Zfb.Yj.qua.toString());Ea=new Rg.a(qe.a.FindInDocument);Ea.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;Ea.DB(U);const Nb=new pg.a(this.gBb);
Nb.DA(Ea);window.requestAnimationFrame(()=>{this.Tph.resultsUpdated(Nb)});this.Zfb.Zhb(!0);this.Ehn(Math.round(window.performance.now()-this.lh))}fdg(){const U=this.Zfb.Yj.qua.toString();return"1"===U?String.format(CommonUIStrings.l_SearchResultText,U):String.format(CommonUIStrings.l_SearchResultsText,U)}vhm(U){return!!U&&!!U.Qg&&""!==U.Qg.trim()}Dhn(U){const Ea={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",
["QueryLength"]:this.gBb.Qg.length};this.sendActivityEvent(Ea,U)}Ehn(U){const Ea={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.gBb.Qg.length};this.sendActivityEvent(Ea,U)}sendActivityEvent(U,Ea){U=Wh.a.KU(U);xj.a.KKa(Object.assign(new Ik.a,{name:"Latency",dataFields:U,durationMs:Ea}),this.L8d)}}Object(c.a)(xl,"WordFindInDocumentWithMatchesProvider",null,[1035]);class Yi{constructor(U,Ea){this.Tb=U;this.pEe=
Ea}Unb(U,Ea,kb){return this.pEe.Unb(0,U,Ea,kb)}insertHtmlText(U){return U?32===this.ykg(U):!1}ykg(U){return this.executeCommand(Of.a.fRa,U)}executeCommand(U,Ea){const kb=new Gm.DictionaryPropertySet;kb.setValue(vl.a.wV,Ea);kb.setValue(vl.a.IKa,!1);Ea=this.Tb.processAction(U,1);32===Ea&&(Ea=this.Tb.ob(U,2,kb));return Ea}}Object(c.a)(Yi,"WordInsertContentHandler",null,[1781]);class dq extends Tk{constructor(){super()}get name(){return"WordEditor.TellMe"}init(){J.AFrameworkApplication.K.wq(Object(u.a)(this,
this.Gw,"onFullAppSettingsReady"))}Gw(){if(J.AFrameworkApplication.cYd){var U=Qe.App.oa.eb.zwd(za.a.tellMe);U.IJc?this.$ej():U.QJ(Object(u.a)(this,this.qfn,"scriptResource_LoadFinished"));var Ea=new rd(()=>!1);lk.TellMeActor.instance.initialize(Ea,null,null,null,null,null,Object(u.a)(Qe.App.oa,Qe.App.oa.jve,"forceUpdateRibbonControls"),J.AFrameworkApplication.K,this.Z.Ca("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Z.Ca("Common.IActionContextProvider"),this.Z.Ca("Common.ISystemInitiatedFeedback"));
lk.TellMeActor.instance.T1m(U);lk.TellMeActor.instance.t3m(new Yi(J.AFrameworkApplication.pa,this.Z.sa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));Ea.noi&&Ea.nue&&lk.TellMeActor.instance.iP(new xl(Ea),No.a.tellMe)}}$ej(){Qe.App.oa.updateCommandUI()}qfn(){this.$ej()}}Object(c.a)(dq,"WordEditorTellMePackage",Tk,[]);class Op{constructor(){this.Z=null}get name(){return"WordEditor.TestFeature"}init(){this.Z.resolve("Box4.IFeatureHelper").tk.continueWith(()=>{this.Po()})}dispose(){}Po(){if(this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(219)){J.AFrameworkApplication.pa.Aa(bd.a.wordTestFeature,
He.a.view,Object(u.a)(this,this.WCn,"testFeature"),96);var U=ae.FocusManager.instance().Kc($p.AppFrame.lE);gi.AFrame.lj(U,Ga.KeyInputManager.$a(ng.a.Mua,5|Ga.KeyInputManager.mh),bd.a.wordTestFeature)}}WCn(U,Ea,kb){2===kb&&(U=new Xd.StandardDialog,U.wc=0,U.Qha(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}Hb(U){this.Z=U}static main(){ba.a.instance.Sb(new Op)}}Object(c.a)(Op,"WordEditorTestFeaturePackage",null,[1,2]);
var wq=b(112);class Un{constructor(U,Ea){this.Csj=U;this.Tb=Ea;this.QPd()}QPd(){this.Tb.ma(bd.a.UWe,Je.a.frame,Object(u.a)(this,this.UWe,"sendTrackChangeSettingUpdateNotification"));this.Csj.Wea(Object(u.a)(this,this.Ana,"onUpdateNotificationReceived"))}UWe(U,Ea,kb,Nb,nc){if(1===kb)return 32;this.Csj.GV(9,nc,!1);return 32}Ana(U,Ea){if(9===Ea.type){var kb;(U=Ea.kia)?("string"===typeof U?kb=U:"data"===U.type&&(kb=wq.a.xdi(U.FTm,U.newState,U.Ppn)),kb&&Un.Rfd(kb)):qa.ULS.sendTraceTag(556103040,376,15,
"TrackChangeSettingUpdateNotificationEventArgs is null")}}dispose(){}static Rfd(U){U=Qe.App.oa.notificationBar.Qqa(U,!1);U.image=5;U.b0="CoAuth_AuthorStatus_16x16x32";Qe.App.oa.notificationBar.BB(U)}}Object(c.a)(Un,"TrackChangeNotificationActor",null,[]);class eq{constructor(){this.Jj=this.Nxf=this.Z=null}get name(){return"WordEditor.TrackChangeNotificationActor"}Hb(U){this.Z=U}init(){this.Z.resolve("Box4.IFeatureHelper").tk.continueWith(()=>{this.Po()})}Po(){Qe.App.txd().continueWith(Object(u.a)(this,
this.NKd,"onRtcProxyReady"))}NKd(){if(this.Jj=Qe.App.txd().result)this.Z.ha("WordEditor.TrackChange.TrackChangeNotificationActor",()=>new Un(this.Jj,J.AFrameworkApplication.pa)).singleInstance(),this.Nxf=this.Z.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}dispose(){this.Nxf&&this.Nxf.dispose()}}Object(c.a)(eq,"WordEditorTrackChangeNotificationActorPackageManager",null,[1,2]);var fq=b(71),Jn=b(1277),Sq=b(1778);class Gj{}Gj.Sch="UnsavedChanges";Gj.Tch="UnsavedChangesThemed";Gj.Gen=
"SavedChanges";Gj.aNj="UnsavedChangesOpenPipe";Gj.fKn="UnsavedChangesOpenPipeCssClassNameThemed";Gj.$Mj="UnsavedChangesClosePipe";Gj.cKn="UnsavedChangesClosePipeThemed";Gj.dKn="UnsavedChanges";Gj.eKn="UnsavedChangesThemed";Gj.Uch="UnsavedChangesIndicatorPositionRef";Object(c.a)(Gj,"UnsavedChangesHighlightUtils",null,[]);class Na extends Jn.a{constructor(U,Ea){super();this.mpa=U;this.Gz=Ea;this.lja=[this.Gz?new Sq.a(Gj.Tch,Gj.eKn):new Sq.a(Gj.Sch,Gj.dKn)]}get kAa(){return!0}get eac(){return 4}get HGb(){return this.lja}o7a(U,
Ea){if(this.mpa){var kb=this.mpa.HAg;if(kb&&kb.count&&kb.contains(U.id))for(U=Ea.xic("span"),Ea=0;Ea<U.length;Ea++)kb=U[Ea],Ea||kb.classList.add(this.Gz?Gj.fKn:Gj.aNj),Ea===U.length-1&&kb.classList.add(this.Gz?Gj.cKn:Gj.$Mj),kb.classList.add(this.Gz?Gj.Tch:Gj.Sch)}}VFb(){}}Object(c.a)(Na,"UnsavedChangesHighlightActor",Jn.a,[]);var cb=b(914);class Cb{constructor(U){this.ccf=null;this.mpa=U;this.vjf=!1}get key(){return"UnsavedChangesHighlight"}get jz(){return"UnsavedChanges"}reset(U){if(this.mpa){U=
U.node;if(Ni.ParagraphReader.nb(U)){const Ea=this.mpa.HAg;if(Ea&&Ea.contains(U.id)){this.vjf=!0;this.ccf=U.id;return}}this.vjf=!1;this.ccf=$b.a.nil}}oZa(){let U=null;return this.vjf?(U=Object.assign(new cb.a,{PK:this.key,contentObject:this.ccf,description:null}),{returnValue:!0,wL:U}):{returnValue:!1,wL:U}}}Object(c.a)(Cb,"UnsavedChangesHighlightCpContentDetailsProvider",null,[287,288]);var hc=b(236),vc=b(1278);class hd{constructor(U,Ea,kb,Nb,nc,ad,Od){this.ZFh=null;this.CCh=!1;this.Vda=U;this.Ng=
Ea;this.O2=kb;this.qW=Nb;this.qQh=nc;this.Gz=ad;this.Ng.RBb(this.CWa.bind(this));this.CCh=Od}get HAg(){return this.ZFh}E_l(){if(this.Vda){if(1===this.Vda.sNf){if(0===this.Vda.Gug&&this.Vda.Gbj()){this.ZFh=this.Vda.LLe;const U=this.Vda.qoc;this.Vda.Hen.forEach(this.Y$k.bind(this));U.forEach(this.F_l.bind(this));0<U.length&&this.pbl(this.O2);return 0}return this.l_m(this.Vda.Gug)}return 2}return 1}l_m(U){switch(U){case 0:return this.Vda.LJi()?5:6;case 3:case 5:case 11:return 4;default:return 6}}tKi(U,
Ea,kb){if(Ea)if(kb){kb=Ea.querySelectorAll("span");for(let Nb=0;Nb<kb.length;Nb++){const nc=kb[Nb];Nb||nc.classList.add(Gj.aNj);Nb===kb.length-1&&nc.classList.add(Gj.$Mj);nc.classList.add(this.Gz?Gj.Tch:Gj.Sch)}Ea.classList.add(Gj.Uch);U&&this.qW.H_d(U)}else Ea.classList.add(Gj.Gen)}aIc(U,Ea){const kb=this.xRl(U);if(U&&(U=U.Qd(dk.App.oa.za.Rb.Za)))if(U.Oh&&U.Oh.Bj&&0!==U.Oh.Bj.count)for(let Nb of U.Oh.Bj)this.tKi(kb,Nb,Ea);else this.tKi(kb,U.htmlElement,Ea)}xRl(U){return this.qQh&&(U=this.qQh.lAe(U))&&
U&&(U=U.Qd(dk.App.oa.za.Rb.Za))?U:null}F_l(U){this.aIc(U,!0);return!0}Y$k(U){this.aIc(U,!1);return!0}pbl(U){U&&U.continueWith(()=>{U.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}CWa(U,Ea){Ea===Sys.EventArgs.Empty?qa.ULS.sendTraceTag(572364513,306,50,"HighlightUnsavedChanges Not Run: Empty Event Args"):Ea&&Ea.errorCode?vc.a.RN.RN()&&(U=this.E_l(),qa.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",U),this.CCh&&
(ka.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==U&&4!==U&&this.MFn(U))):qa.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",Ea?"Error Code":"Kickout Event Args")}MFn(U){let Ea;const kb=new hc.a;kb.extendedProperties=new Map;kb.extendedProperties.set("HighlightUnsavedChangesResult",U.toString());kb.extendedProperties.set("UnsavedChangesCollectionResult","-1");switch(U){case 1:case 2:case 6:Ea="HighlightInternalError";break;case 5:Ea="ChangeOutsideCanvas"}6!==
U&&5!==U||kb.extendedProperties.set("UnsavedChangesCollectionResult",this.Vda.Gug.toString());Ea&&(ka.Health.instance.recordQosError(Ea,["UnsavedContentNotHighlighted"],!0,!0,!1,!1,kb),ka.Health.instance.recordKpiFailure("UnsavedChangesHighlight",Ea,!0,!0,kb))}dispose(){this.Ng.AQc(this.CWa.bind(this))}}Object(c.a)(hd,"UnsavedChangesHighlighter",null,[12]);var od=b(638),Md=b(549),jf=b(1275);class cf extends jf.a{constructor(U,Ea){super();this.mpa=U;this.Gz=Ea}Olc(U){if(!this.mpa)return!1;const Ea=
this.mpa.HAg;return Ea?Ea.contains(U.Ia.id)||U.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}HMk(U,Ea){Ea=U.Kac?U.Kac[Ea]?U.Kac[Ea].style?U.Kac[Ea].style.marginLeft:null:null:null;var kb=U.leftMargin;U=1440<=kb?-(kb/1440*96):U.V3b(0,96,this.zoom);kb=0;Ea&&(Ea=Ea.match(/^(\d+)px/))&&Ea[1]&&(kb=Number(Ea[1]));return U-kb}iNk(U,Ea,kb){return Sys.UI.DomElement.getBounds(U).y-kb.IUa[Ea].y}yMk(U){return Sys.UI.DomElement.getBounds(U).height}Zci(U,Ea,kb,Nb){let nc;nc=this.HMk(kb,Ea);Ea=this.iNk(U,
Ea,kb);U=this.yMk(U);Nb=od.a.createElement(Nb,Md.a.div);Nb.className=this.Gz?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";Nb.style.left=nc+"px";Nb.style.top=Ea+"px";Nb.style.height=U+"px";return Nb}pci(U,Ea,kb,Nb){const nc=[];let ad=U.querySelectorAll("."+Gj.Uch);if(0===ad.length&&Object(sj.a)(U,Gj.Uch))kb=this.Zci(U,Ea,kb,Nb),kb.Fib=Ea,Array.add(nc,kb);else for(U=0;U<ad.length;U++){let Od=this.Zci(ad[U],Ea,kb,Nb);Od.Fib=Ea;Array.add(nc,Od)}return nc}Q5b(U){let Ea=[];var kb=U.bha;const Nb=
kb.Cf.ownerDocument;if(kb.nn){let nc=0;for(let ad of kb.Oh.Bj)(kb=this.pci(ad,nc,U,Nb))&&(Ea=Ea.concat(kb)),nc+=1}else Ea=this.pci(kb.htmlElement,0,U,Nb);return Ea}}Object(c.a)(cf,"UnsavedChangesIndicatorActor",jf.a,[]);class kg{constructor(){this.uea=this.Fz=this.i0a=this.qW=this.y8d=this.mpa=null}get name(){return"WordEditor.UnsavedChangesHighlight"}Hb(){}init(){this.qW=ia.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance;this.mpa=new hd(ia.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),
pf.SessionStatusManager.instance,xi.a.ot(ia.a.instance.Ca("Common.ISystemInitiatedFeedbackWithTimeLapse")),this.qW,ia.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),!!Qe.App.instance&&Qe.App.instance.Bsa,J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TrackUnsavedHighlightFailure",!1));this.i0a=ia.a.instance.Ca("Box4.Accessibility.IAccessibilityContextManager");this.uea=ia.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance;this.y8d=
new cf(this.mpa,!!Qe.App.instance&&Qe.App.instance.Bsa);this.qW.MLb(this.y8d);this.i0a&&this.i0a.execute(U=>{U.Pca(new Cb(this.mpa))});this.Fz=new Na(this.mpa,!!Qe.App.instance&&Qe.App.instance.Bsa);this.uea.LLb(this.Fz)}dispose(){this.qW&&this.y8d&&this.qW.j3e(this.y8d);this.uea&&this.Fz&&this.uea.Mch(this.Fz);fq.a.np(this.mpa)}static main(){ba.a.instance.Sb(new kg)}}Object(c.a)(kg,"WordEditorUnsavedChangesHighlightPackage",null,[1,2,12]);var sh=b(324);class Cj{constructor(U,Ea,kb,Nb){U=new wordVersionHistory.AppBootSettings;
U.logger=new sh.a;U.forcePdfDevEnv=kb.Fy;U.userSessionId=J.AFrameworkApplication.userSessionId;U.wacCluster=Nb;U.publicScriptPath=J.AFrameworkApplication.BQ;U.userType=J.AFrameworkApplication.userType;this.x4e=new wordVersionHistory.AppVersionControllerImpl(U,Ea)}onVersionSelected(U,Ea,kb,Nb){this.x4e.onVersionSelected(U,Ea,kb,Nb)}onDownloadTokenReady(U,Ea){this.x4e.onDownloadTokenReady(U,Ea)}getRenderFailureEvent(){return this.x4e.getRenderFailureEvent()}getLoadFinishEvent(){return this.x4e.getLoadFinishEvent()}}
Object(c.a)(Cj,"AppVersionControllerImplWrapper",null,[1619]);class zj{create(U,Ea,kb,Nb){return new Cj(U,Ea,kb,Nb)}}Object(c.a)(zj,"AppVersionControllerImplWrapperFactory",null,[1594]);class Oo{getVersionHistoryControllerInstance(U){return versionHistory?versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(U):null}}Object(c.a)(Oo,"VersionHistoryControllerFactory",null,[1592]);class mn{static addAppPLTEventToLog(U){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(U)}catch(Ea){}}static setIsPageLoadForFirstTime(U){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(U)}catch(Ea){}}}
Object(c.a)(mn,"VersionHistoryLogConnector",null,[]);var $e=b(555),me=b(1263),vf=b(1433);class Gg{constructor(){this.revisionId=null;this.oXg=0}}Object(c.a)(Gg,"ForceSaveData",null,[]);class dg extends Re.a{constructor(){super();this.ExclusiveLockId=this.VersionToken=this.FileId=null}Jk(){return 106}static construct(U,Ea,kb){const Nb=new dg;Nb.FileId=U;Nb.VersionToken=Ea;Nb.ExclusiveLockId=nm.a(kb);return Nb}}Object(c.a)(dg,"RestoreVersionRequest",Re.a,[]);class Hg{constructor(U,Ea,kb,Nb,nc,ad,Od,
af,ve,eh,Ci,Hj,Bf,Vi,Lj){this.Tb=U;this.Wg=Ea;this.HP=kb;this.clickInputManager=Nb;this.wol=nc;this.xr=ad;this.E_i=Od;this.C1d=af;this.jle=ve;this.sRn=eh;this.K=Ci;this.uCk=Hj;this.RGf=Bf;this.KPb=Vi;this.Gf=Lj;this.UVc=this.Grd=this.xVd=this.LZe=this.R5g=this.hch=this.perfTelemetryInfos=this.baseVersion=this.currentVersion=this.controller=null;this.mWe=0;this.qhb=this.w4e=null;this.ugh=me.b.None;this.SKc=!1;this.gil={0:"GeneralSaveError",1:"InvalidFileName",2:"EmptyFileName",3:"InvalidPermission",
4:"OverwriteTarget",5:"TargetFileLocked",6:"InvalidFileNameDisallowPercentOctothorpe"};this.Bnc={};this.$x={};this.YZe=!1;this.T7=!!J.AFrameworkApplication.la&&J.AFrameworkApplication.la.eb.T7}qmb(){return(new Date).getTime()}yme(){null===this.Grd&&(this.Grd=this.qmb())}gDb(U){const Ea=new hc.a;null===U?qa.ULS.sendTraceTag(541693581,3005,10,"constructKpiAdditionalValuesWithDuration called with null startTime"):(Ea.durationMs=this.qmb()-U,Ea.extendedProperties=new Map);return Ea}cNi(){null===this.UVc&&
(this.UVc=this.qmb());this.Gf.Lq("WordVersionHistorySelectVersion",0,{uRi:!0})}cSg(){const U=[],Ea=Object.assign(new hc.a,{extendedProperties:new Map});if(null!=this.LZe&&null!=this.R5g){var kb=this.LZe-this.R5g;Array.add(U,Object.assign(new Qh.a,{name:"showPaneDuration",string:kb.toString()}));Ea.extendedProperties.set("showPaneDuration",kb.toString())}null!=this.Grd&&null!=this.xVd&&(kb=this.Grd-this.xVd,Array.add(U,Object.assign(new Qh.a,{name:"firstActionDuration",string:kb.toString()})),Ea.extendedProperties.set("firstActionDuration",
kb.toString()));(kb=this.ugh===me.b.None)?this.Gf.cMc("WordVersionHistory",{EA:Ea}):this.Gf.fl("WordVersionHistory",me.b[this.ugh],{isIntentional:!1,EA:Ea},{name:Hg.WVc,Zo:"VersionHistoryLaunchFailed",isIntentional:!1});this.Gf.hM(bd.a.WTk,{succeeded:kb,customData:U})}lb(){this.Tb.ma(za.a.ZZe,Je.a.frame,Object(u.a)(this,this.oDj,"showVersionHistoryDialogAction"));this.Tb.ma(za.a.OQc,Je.a.frame,Object(u.a)(this,this.I$m,"reportVersionHistorySaveACopySuccessAction"));this.Tb.ma(za.a.oRd,Je.a.frame,
Object(u.a)(this,this.H$m,"reportVersionHistorySaveACopyFailureAction"))}oDj(U,Ea,kb){if(1===kb)return pf.SessionStatusManager.instance.oj?8:32;if(2===kb){this.w4e=Oc.a.create().toString();qa.ULS.sendTraceTag(592196993,3005,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.w4e);J.AFrameworkApplication.Zi("Microsoft.Office.Web.SessionSettings.IDocsWordVersionHistorySaveACopyOverFlowMenuSettings");J.AFrameworkApplication.y0("WoVer882;WoVer882cf");Object(vf.a)();this.Gf.Lq("WordVersionHistory",
0,{uRi:!0});this.Gf.hM(bd.a.qMm,{succeeded:!0});this.Bnc.ShowVersionHistoryDialog=(new Date).getTime().toString();this.$x.VersionHistoryLaunchSessionId=this.w4e;this.perfTelemetryInfos=[];this.controller||(this.controller=this.sRn.getVersionHistoryControllerInstance({ulsLogger:new sh.a,serviceBase:this.K.appSettings.VersionHistoryWebServiceBase,docId:J.AFrameworkApplication.Fk,appSettings:{appName:me.a.Word,wdEnableDownloadTokens:this.C1d.AVj,wdEnableSaveACopy:!0,wdEnableRestore:this.C1d.yVj,userSessionId:J.AFrameworkApplication.userSessionId,
wacCluster:this.K.Ga("WacCluster"),uiLocale:J.AFrameworkApplication.uiCulture?J.AFrameworkApplication.uiCulture:"en-us",wdEnableHiddenButtonsUntilVersionLoadComplete:!0,wdEnableShowVersionChanges:!0,disabledChangeGates:J.AFrameworkApplication.K.Ga("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.C1d.zVj,isRtl:J.AFrameworkApplication.isRtl,wdEnableAppColorUpdate:this.K.ea("AppColorUpdateIsEnabled"),useXhr:Ma.a.Fy,retryCount:0,wdEnableDeleteVersions:!1,wdEnableIterator:!1,viewerRootPositionRelative:!1,
disableSaveACopy:!1},perfTelemetryInfos:this.perfTelemetryInfos}));if(!this.controller)return this.Gf.fl("WordVersionHistory","scriptDependencyUnavailable",{isIntentional:!1},{name:Hg.WVc,Zo:"VersionHistoryLaunchFailed",isIntentional:!1}),8;this.controller.setDisableSaveACopy(this.mrn()||this.krn());this.wwn()}return 32}I$m(U,Ea,kb){if(1===kb)return pf.SessionStatusManager.instance.VN?32:8;2===kb&&(U=this.gDb(this.mWe),this.Gf.cMc("WordVersionHistorySaveACopy",{EA:U}),this.cSg());return 32}H$m(U,
Ea,kb,Nb,nc){var ad,Od,af;if(1===kb)return pf.SessionStatusManager.instance.VN?32:8;2===kb&&(U="Unknown",Ea="",nc&&(U=null!==(ad=nc.FailureReason)&&void 0!==ad?ad:U,nc=null!==(Od=nc.ExtraInfo)&&void 0!==Od?Od:"",Ea=null!==(af=this.gil[nc])&&void 0!==af?af:nc),Od=this.gDb(this.mWe),""!==Ea&&Od.extendedProperties.set("ExtraInfo",Ea),af=this.KPb.mGb(U,3,Ea),this.Gf.fl("WordVersionHistorySaveACopy",U,{isIntentional:af.isIntentional,EA:Od},af),qa.ULS.sendTraceTag(592197004,3005,10,"Save failed with {0} {1}",
U,Ea));return 32}wwn(){this.R5g=this.qmb();this.Grd=this.xVd=this.LZe=null;if(document.getElementById("VersionHistoryOverlay"))this.bE();else{this.a3m();this.$2m();this.N2m();this.R2m();this.Y2m();this.Q2m();this.C1d.BVj&&this.P2m();this.X2m();this.Z2m();const U=document.createElement("div");let Ea=U.id="VersionHistoryOverlay",kb=null;this.S2m(U);if(this.T7&&(kb=J.AFrameworkApplication.la.Di?J.AFrameworkApplication.la.Di.getRegion(J.AFrameworkApplication.la.Di.BV.J("Header")):null)){const Nb=document.getElementById("AppHeaderPanel");
Ea=Nb&&"none"===Nb.style.display?String.format("{0} {1} {2}",Ea,"RegionComposer","NoAppHeader"):String.format("{0} {1}",Ea,"RegionComposer")}kb||(kb=document.getElementById("WACInnerFrame"));U.className=Ea;kb.appendChild(U);this.hch=this.controller.createVersionHistoryDialog(U);this.Wta()}document.getElementById("VersionHistoryOverlay").style.display="block";this.controller.getVersions("")}mrn(){if(J.AFrameworkApplication.WS)return qa.ULS.sendTraceTag(570770272,3005,15,"Version History is disabling Save a Copy because this is a protected file."),
!0;const U=32==this.Tb.processAction(za.a.nkc,1);let Ea=32==this.Tb.processAction(za.a.pkc,1);return U||Ea?!1:(qa.ULS.sendTraceTag(545403476,3005,15,"Version History is disabling Save a Copy because the save commands are disabled."),!0)}krn(){return J.AFrameworkApplication.WS?(qa.ULS.sendTraceTag(545387291,3005,15,"Version History is disabling download version because this is a protected file."),!0):32!=this.Tb.processAction(za.a.downloadACopy,1)?(qa.ULS.sendTraceTag(545403477,3005,15,"Version History is disabling download version because the download command is disabled."),
!0):!1}R2m(){this.controller.getFullAppErrorEvent().addListener(U=>{let Ea=U?me.b[U]:"";this.$x[Hg.GCn]=Ea;this.ugh=U;qa.ULS.sendTraceTag(592196994,3005,10,"Full App Error Event: {0}, VersionHistoryLaunchSessionId: {1}",Ea,this.w4e)})}a3m(){this.controller.getVersionsReadyEvent().addListener(U=>{this.LZe=this.qmb();this.lan(U.containerDiv);this.bE()})}Wqm(){this.Gf.Lq("WordVersionHistoryShowChanges",0);let U;if(this.baseVersion)if(this.baseVersion.DownloadUrl)if(0==this.baseVersion.DownloadUrl.length)U=
"download token is empty string";else return;else U="download token is null";else U="base is null";qa.ULS.sendTraceTag(538027592,3005,10,"{0}, RevisionID: {1}",U,this.currentVersion.RevisionID);this.Gf.fl("WordVersionHistoryShowChanges",U,{isIntentional:!1},{name:Hg.WVc,Zo:"ShowChangesFailed",isIntentional:!1})}$2m(){this.controller.getVersionSelectedEvent().addListener(U=>{this.currentVersion=U.currentVersion;this.baseVersion=U.baseVersion;if(this.qhb){U.noBaseToCompareTo||this.YZe||this.Wqm();try{this.JVj();
if(this.baseVersion||U.noBaseToCompareTo)this.cNi(),this.qhb.onVersionSelected(U.currentVersion,U.baseVersion,this.Bnc,!this.YZe);this.perfTelemetryInfos=[];this.Bnc={}}catch(Ea){qa.ULS.sendTraceTag(592196997,3005,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",Ea)}}})}P2m(){this.controller.getDownloadTokenReadyEvent().addListener(U=>{try{qa.ULS.sendTraceTag(592196998,3005,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.ZVl(U)}catch(Ea){qa.ULS.sendTraceTag(592197002,
3005,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",Ea)}})}ZVl(U){U&&U.versionSelected?(this.currentVersion=U.versionSelected.currentVersion,this.baseVersion=U.versionSelected.baseVersion,this.cNi(),this.qhb.onVersionSelected(this.currentVersion,this.baseVersion,this.Bnc,!this.YZe)):qa.ULS.sendTraceTag(591697922,3005,10,"handleGetDownloadTokenReadyEvent: downloadTokenReadyObject.versionSelected was null")}N2m(){this.controller.getCloseSelectedEvent().addListener(()=>
{this.XTk();this.Wjm()})}N3l(U){const Ea={};Ea.FileDownloadUrl=U;Ea.SaveEntryPoint="VersionHistory";return Ea}pNl(U){let Ea="Dialog Failure - ActionResponse "+U.toString();2===U?Ea="DialogNotHandled":8===U&&(Ea="DialogFailed");return Ea}Y2m(){this.controller.getSaveACopySelectedEvent().addListener(U=>{this.mWe=this.qmb();this.Gf.Lq("WordVersionHistorySaveACopy",0);this.yme();qa.ULS.sendTraceTag(592197003,3005,50,"VersionHistoryPaneActor: RegisterForSaveACopySelectedEvent");this.e7i();var Ea=this.N3l(U);
U=32==this.Tb.processAction(za.a.nkc,1);Ea=this.Tb.ob(U?za.a.nkc:za.a.pkc,2,Ea);const kb=this.gDb(this.mWe),Nb=32===Ea;if(!Nb){const nc=this.pNl(Ea),ad=this.KPb.mGb(nc,2);this.Gf.fl("WordVersionHistorySaveACopy",nc,{isIntentional:ad.isIntentional,EA:kb},ad);qa.ULS.sendTraceTag(578033103,3005,10,U?"SaveACopy":"SaveToSharePoint failed with ActionResponse: "+Ea.toString())}this.Gf.hM(bd.a.dTk,{succeeded:Nb})})}Q2m(){this.controller.getDownloadVersionSelectedEvent().addListener(U=>{var Ea=this.qmb();
this.Gf.Lq("WordVersionHistoryDownloadVersion",0);this.yme();U=new bo.QueryStringBuilder(U);U.Xd("fn",J.AFrameworkApplication.fileName);U=this.Tb.ob(za.a.downloadACopy,2,{["FileDownloadUrl"]:U.toString()});Ea=this.gDb(Ea);const kb=32===U;kb?this.Gf.cMc("WordVersionHistoryDownloadVersion",{EA:Ea}):(this.Gf.fl("WordVersionHistoryDownloadVersion",U.toString(),{isIntentional:!1,EA:Ea},{name:Hg.WVc,Zo:"DownloadVersionFailed"}),qa.ULS.sendTraceTag(592197005,3005,10,"Download version failed with result: "+
U.toString()));this.Gf.hM(bd.a.cTk,{succeeded:kb})})}EIe(){this.e7i();this.cSg();this.xr&&this.xr.refreshDocument(null)}eXl(U,Ea){this.SKc=!1;if(2===U.statusCode&&U.xj&&0<U.xj.length&&U.xj[0])if(U=U.xj[0],Ea=this.gDb(Ea),this.E_i&&U.ShouldAvoidLockRelease&&this.E_i.UMb(!1,"VersionHistory"),191===U.StatusCode)U=this.KPb.mGb("MultipleClientsInCoauthSession",5),this.Gf.fl("WordVersionHistoryRestore","multipleClientsInCoauthSession",{isIntentional:!0,EA:Ea},U),this.Gf.hM(bd.a.Jkd,{succeeded:!1}),qa.ULS.sendTraceTag(592197006,
3005,10,"RestoreVersionRequest failed with MultipleClientsInCoauthSession"),this.controller.setCoauthRestoreError(),Hg.Xjm();else if(U.StatusCode){Ea.extendedProperties.set("status",$e.a[U.StatusCode]);const kb=this.KPb.mGb("ServerOperationFailed",5);this.Gf.fl("WordVersionHistoryRestore","restoreVersionResponseFailed",{isIntentional:!1,EA:Ea},kb);this.Gf.hM(bd.a.Jkd,{succeeded:!1});qa.ULS.sendTraceTag(592197007,3005,10,"RestoreVersionRequest failed with "+$e.a[U.StatusCode]);this.controller.setRestoreFailedAtServer(Object(u.a)(this,
this.EIe,"launchSurveyRefreshDocument"))}else this.Gf.cMc("WordVersionHistoryRestore",{EA:Ea}),this.Gf.hM(bd.a.Jkd,{succeeded:!0}),qa.ULS.sendTraceTag(592197008,3005,50,"Restore Version Successful."),this.EIe();else Ea=this.KPb.mGb("ServerOperationFailed",5),this.Gf.fl("WordVersionHistoryRestore","serverOperationFailed",{isIntentional:Ea.isIntentional},Ea),qa.ULS.sendTraceTag(592197009,3005,10,"serverOperation failed with "+yh.a[U.statusCode]),this.controller.setRestoreFailedAtServer(Object(u.a)(this,
this.EIe,"launchSurveyRefreshDocument"))}yol(U){qa.ULS.sendTraceTag(592197010,3005,50,"DocumentSavedSuccessfully");var Ea=U.revisionId;const kb=$b.a.create();Ea=dg.construct(J.AFrameworkApplication.rootQuerySignature,Ea,kb);const Nb=Object.assign(new Xf.a,{Pq:Ea,status:1,RE:"RestoreVersion"});Ea=this.RGf.Pla(0,()=>{this.eXl(Nb,U.oXg)});Ea.PJ(Nb);Ea.yP()}Hqi(U,Ea){this.SKc=!1;const kb=this.gDb(U.oXg);kb.extendedProperties.set("status",$e.a[Ea]);const Nb=this.KPb.mGb("ForceSaveFailed",5);this.Gf.fl("WordVersionHistoryRestore",
"forceSaveFailed",{isIntentional:Nb.isIntentional,EA:kb},Nb);this.Gf.hM(bd.a.Jkd,{succeeded:!1});qa.ULS.sendTraceTag(592197011,3005,10,"ForceSaveFailed with status"+$e.a[Ea]+" for version "+U);this.controller.setRestoreFailedAtServer(Object(u.a)(this,this.EIe,"launchSurveyRefreshDocument"))}X2m(){this.controller.getRestoreVersionSelectedEvent().addListener(U=>{if(this.SKc)qa.ULS.sendTraceTag(536998742,3005,50,"restore already in progress");else{this.SKc=!0;this.yme();var Ea=this.qmb();this.Gf.Lq("WordVersionHistoryRestore",
0);var kb=null;U&&(kb=U.split("-")[0]);kb&&""!==kb?(U=Object.assign(new Gg,{revisionId:kb,oXg:Ea}),qa.ULS.sendTraceTag(592197013,3005,50,"VersionHistoryPaneActor: RegisterForRestoreVersionSelectedEvent: {0}",kb),this.controller.setRestoreInProgress(),this.wol(19,!1,Object(u.a)(this,this.yol,"forceSaveSucceeded"),Object(u.a)(this,this.Hqi,"forceSaveFailed"),U,null,null)):(kb=this.KPb.mGb("InvalidRevisionId",5),this.Gf.fl("WordVersionHistoryRestore","invalidRevisionId",{isIntentional:kb.isIntentional},
kb),this.Gf.hM(bd.a.Jkd,{succeeded:!1}),qa.ULS.shipAssertTag(592197012,3005,!1),this.SKc=!1)}})}b3m(){this.qhb.getRenderFailureEvent().addListener(U=>{const Ea=this.KPb.mGb(U,1),kb=this.gDb(this.UVc);this.UVc=null;this.Gf.fl("WordVersionHistorySelectVersion",U,{isIntentional:Ea.isIntentional,EA:kb},Ea);try{this.$x.ViewerErrorCode="ViewerErrorCode"in this.$x?this.$x.ViewerErrorCode+("; "+U):U,this.controller.setViewerError(!0),qa.ULS.sendTraceTag(592197014,3005,10,"Versions viewer error code: {0}",
U)}catch(Nb){qa.ULS.sendTraceTag(592197015,3005,10,"Failed to set viewer error: {0}",Nb)}})}T2m(){this.qhb.getLoadFinishEvent().addListener(()=>{null==this.xVd&&(this.xVd=this.qmb());const U=this.gDb(this.UVc);this.UVc=null;this.Gf.cMc("WordVersionHistorySelectVersion",{EA:U});this.controller.setVersionLoadComplete()})}Z2m(){this.controller.getShowVersionChangesToggledEvent().addListener(U=>{this.YZe=!U;this.bE();try{this.currentVersion&&this.currentVersion.DownloadUrl&&this.qhb&&(this.JVj(),this.qhb.onVersionSelected(this.currentVersion,
this.baseVersion,this.Bnc,U),this.perfTelemetryInfos=[],this.Bnc={})}catch(Ea){qa.ULS.sendTraceTag(592197016,3005,10,"VersionHistoryPaneActor: Exception in ShowVersionChangesToggledEvent callback: {0}",Ea)}})}allowKeytips(U){mf.a("allowKeytips")&&appChrome.api.allowKeytips(U)}bE(){this.HP.gx($p.AppFrame.Uca);this.allowKeytips(!1);this.HP.gx(gi.AFrame.ao);this.HP.gx($p.AppFrame.Vha);this.Wg.bG("VersionHistoryViewer",!1);this.HP.bE("VersionHistoryViewer");this.Wg.bG("VersionHistoryHeader",!0);this.HP.bE("VersionHistoryHeader");
this.Wg.bG("VersionHistoryOverlay",!0);this.HP.bE("VersionHistoryOverlay")}gx(){this.HP.bE($p.AppFrame.Uca);this.allowKeytips(!0);this.HP.bE(gi.AFrame.ao);this.HP.bE($p.AppFrame.Vha);this.HP.gx("VersionHistoryOverlay");this.Wg.QI("VersionHistoryOverlay");this.HP.gx("VersionHistoryHeader");this.Wg.QI("VersionHistoryHeader");this.HP.gx("VersionHistoryViewer");this.Wg.QI("VersionHistoryViewer")}XTk(){this.SKc&&qa.ULS.sendTraceTag(536998743,3005,10,"restore did not complete!");this.cSg();document.getElementById("VersionHistoryOverlay").style.display=
"none";this.$x.browser=Ma.a.qI;Ma.a.dV&&(this.$x.electronBrowserVersion=Ma.a.kji);this.gx();qa.ULS.sendTraceTag(592197017,3005,50,ra.c(this.$x))}JVj(){for(let U of this.perfTelemetryInfos)U.TelemetryEventKey&&U.TelemetryEventData&&(this.Bnc[U.TelemetryEventKey]=U.TelemetryEventData)}lan(U){try{if(this.qhb)mn.setIsPageLoadForFirstTime(!1);else{mn.setIsPageLoadForFirstTime(!0);const Ea=this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsVersionHistoryBadGatewayFixEnabled",!1)?this.K.Ga("WacCluster"):
"";this.qhb=this.uCk.create(this.C1d,U,this.jle,Ea);this.b3m();this.T2m()}}catch(Ea){qa.ULS.sendTraceTag(592197018,3005,10,"WordVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",Ea)}}hRf(U){const Ea=this.Wg.Kc(U);Ea.parent=gi.AFrame.hp;this.HP.Ixa(U);Ea.uK=!0;return Ea}Wta(){this.hRf("VersionHistoryOverlay").maa((U,Ea)=>{try{this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsSaveACopyA11yFixEnabled",!1)&&null!=U&&"dialog/modal"==U.name?this.controller.setSaveACopyCanceled():
"VersionHistoryOverlay"===Ea.name&&this.hch.then(kb=>{kb.enterFocusTrapZone();return null})}catch(kb){qa.ULS.sendTraceTag(592197019,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",kb)}});this.clickInputManager.IBb("VersionHistoryOverlay",document.getElementById("VersionHistoryOverlay"));this.hRf("VersionHistoryHeader").maa((U,Ea)=>{try{"VersionHistoryHeader"===Ea.name&&this.hch.then(kb=>{kb.enterHeaderFocusTrapZone();return null})}catch(kb){qa.ULS.sendTraceTag(592197020,
3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",kb)}});this.clickInputManager.IBb("VersionHistoryHeader",document.getElementById("vhHeader"));this.hRf("VersionHistoryViewer").maa((U,Ea)=>{try{"VersionHistoryViewer"===Ea.name&&ae.FocusManager.iJ(document.getElementById("vhViewer"))}catch(kb){qa.ULS.sendTraceTag(592197021,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",kb)}});this.clickInputManager.IBb("VersionHistoryViewer",document.getElementById("vhViewer"))}Wjm(){const U=
ia.a.instance.sa("Common.ISystemInitiatedFeedback");U?(U.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"),U.logActivity("VersionHistoryCheckExited","WordVersionHistoryFGIsEnabled")):qa.ULS.sendTraceTag(592197022,3005,10,"ISystemInitiatedFeedback was null")}e7i(){const U=ia.a.instance.sa("Common.ISystemInitiatedFeedback");U?U.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"):qa.ULS.sendTraceTag(592197023,3005,10,"ISystemInitiatedFeedback was null")}static Xjm(){const U=
ia.a.instance.sa("Common.ISystemInitiatedFeedback");U?U.logActivity("VersionHistoryRestoreCoauthFailed","VersionHistoryRestoreSurveyEnabled"):qa.ULS.sendTraceTag(578359496,3005,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}S2m(U){U&&U.addEventListener("keydown",Ea=>{Ea.ctrlKey&&"KeyC"===Ea.code&&(this.yme(),this.Gf.Lq("WordVersionHistoryCopyText",0));Ea.ctrlKey&&"KeyF"===Ea.code&&this.Gf.Lq("WordVersionHistorySearchText",0)})}}Hg.GCn="ErrorCode";Hg.WVc=
"VersionHistoryExperienceDegraded";Object(c.a)(Hg,"VersionHistoryPaneActor",null,[1593]);class ji{constructor(){this.zVj=this.yVj=this.BVj=this.AVj=!1}}Object(c.a)(ji,"WordVersionHistorySettings",null,[]);class Xk{mGb(U,Ea,kb){let Nb={name:"VersionHistoryExperienceDegraded",isIntentional:!1};0==Ea?Nb.Zo="VersionHistoryLaunchFailed":1==Ea?U.includes("Failed to fetch")?Nb.Zo="SelectVersionFailedBecauseFetchFailed":U.includes("Unexpected server response (500) while retrieving PDF")?Nb.Zo="SelectVersionFailedServerResponseInternalError":
U.includes("Unexpected server response (502) while retrieving PDF")?Nb.Zo="SelectVersionFailedServerResponseBadGateway":U.includes("Unexpected server response (415) while retrieving PDF")?(Nb.Zo="SelectVersionFailedServerResponseUnsupportedMediaType",Nb.isIntentional=!0):U.includes("Unexpected server response (408) while retrieving PDF")?Nb.Zo="SelectVersionFailedServerResponseRequestTimeout":U.includes("Unexpected server response (400) while retrieving PDF")?Nb.Zo="SelectVersionFailedServerResponseBadRequest":
U.includes("Unexpected server response (413) while retrieving PDF")?(Nb.Zo="SelectVersionFailedServerResponseRequestEntityTooLarge",Nb.isIntentional=!0):Nb.Zo="SelectVersionFailed":5==Ea?(Nb.Zo="RestoreVersionFailed"+U,Nb.isIntentional="MultipleClientsInCoauthSession"===U):4==Ea?Nb.Zo="DownloadVersionFailed"+U:2==Ea?Nb.Zo=Xk.KYg+U:3==Ea&&(kb?(Nb.Zo=Xk.KYg+kb,Nb.isIntentional="OverwriteTarget"===kb||"TargetFileLocked"===kb):(U=this.pCl(U),Nb.Zo=U?"SaveVersionFailedServerResponse"+U:Xk.KYg));return Nb}pCl(U){switch(U){case "400":return"BadRequest";
case "401":return"Unauthorized";case "403":return"Forbidden";case "404":return"NotFound";case "408":return"Timeout";case "500":return"InternalError";default:return""}}}Xk.KYg="SaveVersionFailed";Object(c.a)(Xk,"WordVersionHistoryVetoHelper",null,[1591]);var pl=b(917),mk=b(908);class sm{constructor(){this.K=this.container=null;this.lQn={fjb:"webasynccollabeng",featureName:"VersionHistory",GUc:"VersionHistoryFeatureUsage",gpc:7}}get name(){return"WordEditor.VersionHistory"}init(){J.AFrameworkApplication.PHe()?
(qa.ULS.sendTraceTag(39966528,3005,50,"WordVersionHistoryPackage:init - Initializing the React VersionHistory package"),Pa.a.get_instance().Ik(7,()=>{const U=this.container.resolve("Common.IDynamicScriptLoaderProvider").uG;(J.AFrameworkApplication.K.ea("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("wordVersionHistory"):U.loadScript("wordVersionHistory")).catch(Ea=>qa.ULS.sendTraceTag(39966529,3005,10,"Failed to load the resources for the versionHistory feature: {0}",Ea)).then(()=>this.sLm()).catch(Ea=>
qa.ULS.sendTraceTag(39966530,3005,10,"Failed to initialize the versionHistory feature: {0}",Ea))})):qa.ULS.sendTraceTag(39966498,3005,50,"WordVersionHistoryPackage:init - Not initializing the React VersionHistory package because the feature is disabled")}sLm(){qa.ULS.sendTraceTag(541942913,3005,50,"Finished loading resources for the versionHistory feature");this.container.resolve("IVersionHistoryPaneActor").lb();return null}dispose(){}Hb(U){this.container=U;this.K=this.container.resolve("Common.IAppSettingsManager");
if(this.K.ea("AppSupportsVersionHistory")){var Ea=this.container.resolve("Common.IBrowserUtils"),kb=new ji;kb.AVj=this.K.ea("WordWdDownloadTokenIsEnabled");kb.BVj=this.K.ea("WordWdDownloadTokenRegisterIsEnabled");kb.yVj=this.K.ea("WordVersionHistoryEnableRestore");kb.zVj=this.K.ea("WordVersionHistorySaveACopyOverFlowMenuIsEnabled");this.container.ha("IVersionHistoryPaneActor",()=>new Hg(J.AFrameworkApplication.pa,ae.FocusManager.instance(),hg.a.instance,ye.a.instance,To.a.LX,Qe.App.oa,Qe.App.y5,kb,
Ea,new Oo,J.AFrameworkApplication.K,new zj,new ac.a,new Xk,new pl.a(ka.Health.instance,new mk.a,this.lQn))).singleInstance()}}static main(){let U=!1;J.AFrameworkApplication.K&&J.AFrameworkApplication.K.ea("IsOnDemandVersionHistoryEnabled")&&J.AFrameworkApplication.PHe()&&(U=!0);ba.a.instance.Sb(new sm,0,U)}}Object(c.a)(sm,"WordVersionHistoryPackage",null,[1,2]);var Ao=b(99);class Tq{constructor(U,Ea,kb){this.ga=U;this.Ek=Ea;this.va=kb}lb(){this.va.ea("ZoomPopupDialogIsEnabled")&&(this.ga.ma(za.a.xmc,
Je.a.frame,Object(u.a)(this.Ek,this.Ek.xmc,"showZoomDialog")),this.ga.Aa(za.a.uij,Je.a.frame,Object(u.a)(this.Ek,this.Ek.faj,"onQueryZoomText"),96),this.ga.ma(za.a.qWc,Je.a.frame,Object(u.a)(this.Ek,this.Ek.RVj,"zoomDialogTabFocusHandler")),this.ga.ma(za.a.pWc,Je.a.frame,Object(u.a)(this.Ek,this.Ek.RVj,"zoomDialogTabFocusHandler")));this.va.ea("ZoomSliderIsEnabled")&&(this.ga.Aa(za.a.wQg,Je.a.frame,Object(u.a)(this.Ek,this.Ek.CIm,"onQueryZoomPercentage"),96),this.ga.Aa(za.a.eih,Je.a.frame,Object(u.a)(this.Ek,
this.Ek.GLm,"onZoomToPercentage"),96),this.ga.ma(za.a.UVj,Je.a.frame,Ao.ActionManager.Ke))}}Object(c.a)(Tq,"CommonZoomActor",null,[927]);class Br extends Tq{constructor(U,Ea,kb){super(U,Ea,kb);this.fqa=Ea}lb(){super.lb();this.va.ea("ZoomPopupDialogIsEnabled")&&(this.ga.ma(bd.a.dih,Je.a.frame,Ao.ActionManager.Ke),this.ga.ma(bd.a.u5e,Je.a.frame,Object(u.a)(this.fqa,this.fqa.LTn,"zoomTo100")));this.ga.ma(bd.a.zoomToPageWidth,Je.a.frame,Object(u.a)(this.fqa,this.fqa.zoomToPageWidth,"zoomToPageWidth"));
this.ga.ma(za.a.Cnb,Je.a.frame,Object(u.a)(this.fqa,this.fqa.Cnb,"increaseZoom"));this.ga.ma(za.a.sjb,Je.a.frame,Object(u.a)(this.fqa,this.fqa.sjb,"decreaseZoom"));this.ga.ma(bd.a.FZg,Je.a.frame,Object(u.a)(this.fqa,this.fqa.Epn,"setZoomLevelFromRibbon"));this.ga.Aa(bd.a.jLb,Je.a.frame,Object(u.a)(this.fqa,this.fqa.faj,"onQueryZoomText"),96);this.ga.Aa(bd.a.rTe,He.a.application,Object(u.a)(this.fqa,this.fqa.BIm,"onQueryZoomLevelLabelText"),96);this.ga.ma(Of.a.lTf,Je.a.frame,Ao.ActionManager.Ke);this.ga.ma(Of.a.kTf,
Je.a.frame,Ao.ActionManager.Ke);this.ga.ma(Of.a.pTf,Je.a.frame,Ao.ActionManager.Ke);this.ga.ma(Of.a.mTf,Je.a.frame,Ao.ActionManager.Ke);this.ga.ma(bd.a.xua,Je.a.frame,Ao.ActionManager.Ke)}}Object(c.a)(Br,"WordEditorZoomActor",Tq,[]);class yl{constructor(U,Ea){this.zoom=U;this.wBk=Ea}}Object(c.a)(yl,"SetCustomZoomArgs",null,[]);var fv=b(1005);class tm{constructor(U,Ea){this.m7k=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.n7k=[tm.fWf,tm.$qe,"200","150",
"100","75","50"];this.Pya=3;this.KT=0;this.delta=.1;this.fvg=0;this.Zc=new r.a;this.$d=null;this.K=U;this.Tb=Ea;this.Lzj(1)}get Ei(){return this.KT}Lzj(U){this.KT=U}get Qnd(){return Math.round(100*this.Ei)}get tzm(){return Math.floor(this.Qnd/10)/10+this.delta}get szm(){return Math.ceil(this.Qnd/10)/10-this.delta}get ga(){return J.AFrameworkApplication.pa}Xzk(U){this.Zc.addHandler("ZoomChanged",U)}v8m(U){this.Zc.removeHandler("ZoomChanged",U)}pha(U){this.Xzk(U)}XLb(U){this.v8m(U)}Wlj(){}Gnj(){}Vlj(){}Fnj(){}J1d(U){this.SVj(U,
this.Ei)}SVj(U,Ea){null!==U&&Yo.a.Dyj(U,Ea)}T2g(U,Ea=!0){let kb=U*=100;this.K&&this.K.ea("DoNotAutoScrollAfterPinchIsEnabled")&&(kb=new yl(U,Ea));this.Fwj(kb)}Dpn(U,Ea=!1){this.xua(U,3|(Ea?0:4))}ELm(U,Ea,kb){if(1===U)return 32;U=kb/100;U<this.lId?U=this.lId:U>this.RHd&&(U=this.RHd);this.xua(U,1);Ea&&(Ea.vq=Math.floor(100*U));return 32}faj(U,Ea,kb,Nb,nc){if(1===kb)return 32;U=bc.a.xza(this.Qnd,6,J.AFrameworkApplication.numberFormat);nc.Value=U;nc.LabelText=U;return 32}GLm(U,Ea,kb,Nb,nc){return 1===
kb?32:this.ELm(kb,Nb,nc.value)}CIm(U,Ea,kb,Nb,nc){nc.MinValue=100*this.lId;nc.MaxValue=100*this.RHd;nc.value=this.Qnd;return 32}NGi(){return this.m7k}OGi(){return this.n7k}hxl(){let U=Math.floor(100*this.Ei).toString();1===this.Pya?U=tm.fWf:2===this.Pya&&(U=tm.$qe);return U}Cnb(U,Ea,kb){if(1===kb)return 32;this.gHd(this.Tb?this.Tb.gz:0,"IncreaseZoom");this.Pya=0;this.xua(this.tzm);return 32}sjb(U,Ea,kb){if(1===kb)return 32;this.gHd(this.Tb?this.Tb.gz:0,"DecreaseZoom");this.Pya=0;this.xua(this.szm);
return 32}Epn(U,Ea,kb,Nb,nc){if(1===kb)return 32;this.gHd(this.Tb?this.Tb.gz:0,"SetZoomLevelFromRibbon");U=nc.Value;if(U.toLowerCase().startsWith("fit"))return U=new uc.a(0,1,0,()=>{this.zoomToPageWidth(0,null,2,null,null)},138,void 0,!0),ho.a.instance.rb(U),32;U=parseInt(U)/100;if(isNaN(U))return 2;this.Pya=0;this.xua(U);return 32}gHd(U,Ea){qa.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",U,Ea,J.AFrameworkApplication.la.eb.lo)}xmc(U,Ea,kb){if(1===
kb)return 32;qa.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const U=this.hxl();this.$d=new fv.a(this.NGi(),this.OGi(),Object(u.a)(this,this.aYl,"handleZoomDialogResult"),ae.FocusManager.instance(),!0);this.$d.xmc(CommonUIStrings.l_ZoomDialogTitle,U)}i$l(U){return U.toLowerCase()===tm.fWf.toLowerCase()}j$l(U){return U.toLowerCase()===tm.$qe.toLowerCase()}aYl(U){if(U){if(this.i$l(U)){this.Pya=1;var Ea=32}else if(this.j$l(U))this.Pya=
2,Ea=this.zoomToPageWidth(0,null,2,null,null);else if(Ea=Number.parseInvariant(U)){this.Pya=0;let kb=Ea;this.K&&this.K.ea("DoNotAutoScrollAfterPinchIsEnabled")&&(kb=new yl(Ea,!0));Ea=this.Fwj(kb)}else Ea=8;32===Ea?qa.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:U}):qa.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{["DialogResult"]:U})}else qa.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:U})}AZm(){this.Zc.raiseEvent("ZoomChanged",null)}$ij(){}RQg(){}RVj(U){if(!this.$d)return 2;
var Ea=this.$d.Wg.rk().Tf.VG;if(Ea===this.$d.Lm&&U===za.a.qWc||Ea===this.$d.Tu&&U===za.a.pWc)this.$d.Cxa||this.$d.Vfn(),this.$d.Wg.rk().Tf.ou(this.$d.Cxa);else if(Ea.id.startsWith(this.$d.VOd)||Ea.className.startsWith(this.$d.Fij))Ea=null,U===za.a.qWc?Ea=this.$d.Tu:U===za.a.pWc&&(Ea=this.$d.Lm),this.$d.Wg.rk().Tf.ou(Ea),Sys.UI.DomElement.removeCssClass(this.$d.Cxa.parentNode,this.$d.FQg);else if(U===za.a.qWc)this.$d.Wg.rk().oWa();else if(U===za.a.pWc)this.$d.Wg.rk().nWa();else return 2;return 32}}
tm.fWf="FullPage";tm.$qe="PageWidth";Object(c.a)(tm,"ZoomManager",null,[817]);b(1199);var Cr;(function(U){U[U.normal=0]="normal";U[U.quiet=1]="quiet";U[U.disableScrollUpdate=2]="disableScrollUpdate";U[U.disableUiControlUpdate=4]="disableUiControlUpdate"})(Cr||(Cr={}));Object(c.b)("ZoomUpdateFlags",Cr);var ns;(function(U){U[U.manual=0]="manual";U[U.fitToFullPage=1]="fitToFullPage";U[U.fitWidth=2]="fitWidth";U[U.onBoot=3]="onBoot"})(ns||(ns={}));Object(c.b)("ZoomStatus",ns);var im=b(276),Fu=b(332),
Dr=b(1052);class Gs extends tm{constructor(U,Ea,kb,Nb,nc,ad,Od){super(U,Ea);this.GSn=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.HSn=[tm.$qe,"200","150","125","100","75","50"];this.Cyf=this.Uqj=!1;this.Soh="AutoFitForAdaptiveLayout";this.v9j="FitPageWidthFailure";this.mrk="UpdateZoomFailure";this.vsk="wwf";this.tL=this.Nzf=null;this.a_=kb;this.mk=Nb;this.ib=nc;this.ag=ad;this.l2c=Od;this.PCh=U.ea("KeepViewAfterZoomIsEnabled");this.wsk=U.ea("ZoomShortCutIsEnabled");this.usk=
U.ea("ZoomCtrlScrollIsEnabled");this.wrk=U.ea("DoNotAutoScrollAfterPinchIsEnabled");this.rck=(this.Fif=U.ea("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&U.ea("AutoFitForSmallScreenModeIsEnabled");this.H7j=U.ea("DoNotProcessUpdateZoomActionIsEnabled");this.xsk=U.ea("ZoomSliderIsEnabled");this.lrk=!!U&&U.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateUiAfterChromeReadyIsEnabled",!1);this.jC()}get appName(){return"WordEditor"}get RHd(){return 4}get lId(){return.1}get T5k(){return wacBoot.CtrlWheelMetrics}ozk(U){this.Zc.addHandler("PinchStart",
U)}m8m(U){this.Zc.removeHandler("PinchStart",U)}nzk(U){this.Zc.addHandler("PinchEnd",U)}l8m(U){this.Zc.removeHandler("PinchEnd",U)}get PH(){return this.tL||(this.tL=ia.a.instance.sa("WordEditor.IStatusBarUser"))}AQj(U){U=!(U&Cr.disableUiControlUpdate);const Ea=!this.lrk||Pa.a.get_instance().isCompleted(7);return U&&Ea?(U={SelectZoomOption:"ComboBoxModel"},Qe.App.oa&&Qe.App.oa.jF(U),this.fQn(),!0):!1}xua(U,Ea=Cr.normal){let kb=!0;this.H7j||J.AFrameworkApplication.pa.processAction(bd.a.xua,2);if(this.Ei===
U)return this.Cyf||(this.Cyf=this.AQj(Ea)),kb;U>this.RHd?U=this.RHd:U<this.lId&&(U=this.lId);var Nb=!!(Ea&Cr.quiet);1===U||Nb||J.AFrameworkApplication.pa.processAction(bd.a.dih,2);try{Nb=null;Qe.App.oa&&Object(Tl.a)(Dr.PageView,Qe.App.oa.za.Rb)&&(Nb=Qe.App.oa.za.Rb);let nc=-1,ad=-1,Od=-1;const af=!(Ea&Cr.disableScrollUpdate);this.PCh&&af&&(nc=Jj.SelectionEditor.xGi(mo.a.instance.ya.Ba,Nb),ad=Nb.Xv.scrollLeft,Od=Nb.Xv.scrollTop);const ve=this.Ei;this.Lzj(U);this.AZm();this.Cyf=this.AQj(Ea);af&&this.WOn(Nb,
nc,ad,Od,ve)}catch(nc){kb=!1,qa.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",nc)}return kb}WOn(U,Ea,kb,Nb,nc){U&&U.isActive?this.PCh?0<=Ea&&100>=Ea?U.xy.YY(100-Ea,!0,!0):U.xy.iWi(kb,Nb,nc,this.Ei):U.xy.YY():qa.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}LTn(U,Ea,kb){2===kb&&(this.gHd(this.Tb?this.Tb.gz:0,"ZoomTo100"),this.Pya=ns.manual,this.xua(1));return 32}Fwj(U){this.Pya=ns.manual;let Ea,kb=!0;if(this.wrk){if(!Object(Tl.a)(yl,U))return qa.ULS.sendTraceTag(51644238,
353,10,"actiondata is not a SetCustomZoomArgs"),8;Ea=U.zoom/100;kb=U.wBk}else Ea=Number.parseInvariant(String.format("{0}",U))/100;qa.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",Ea);U=Cr.normal;kb||(U=Cr.disableScrollUpdate);this.xua(Ea,U);return 32}zoomToPageWidth(U,Ea,kb){if(1===kb)return 32;qa.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");this.Pya=ns.fitWidth;this.egl();return this.n2f()}BIm(U,Ea,kb,Nb,nc){if(1===kb)return 32;U=bc.a.xza(this.Qnd,
6,J.AFrameworkApplication.numberFormat);nc[im.a.labelText]=U;return 32}NGi(){return this.GSn}OGi(){return this.HSn}egl(){this.Uqj||(Qe.App.oa?(Qe.App.oa.sU(Object(u.a)(this,this.ISg,"refitToPageWidth")),this.Uqj=!0):qa.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}n2f(){var U=Qe.App.oa?Qe.App.oa.za.Rb:null;if(U&&Qe.App.oa.Ow){var Ea=null;(U=this.fxl(U))&&(Ea=this.a_.BK(U));Ea||(Ea=this.a_.oxe());if(null!==Ea)return Ea=yg.a.instance.Gt(Ea),
Ea=Am.a.Rh(Ea,0),U=this.l2c(),Ea+=U&&U.QYe()?wacBoot.ShiftUtils.getFloatingObjectsContainerWidth():0,Ea+=2*Fu.a.b5e,this.xua(Qe.App.oa.Ow.offsetWidth/Ea),32;qa.ULS.sendTraceTag(7185433,353,10,"Zoom to page width: cannot find word section node.")}else qa.ULS.sendTraceTag(7185434,353,10,"Zoom to page width: cannot find editing view node.");return 8}fxl(U){return U&&U.Oa&&U.Oa.ya.Ba&&U.Oa.ya.Ba.ra&&U.Oa.ya.Ba.ra.node?U.Oa.ya.Ba.ra.node:null}ISg(){this.Pya===ns.fitWidth&&this.n2f()}fQn(){this.PH&&(this.xsk?
(this.PH.yV(ms.a.HTn),this.PH.yV(ms.a.ITn)):this.PH.yV(ms.a.JTn))}Wzn(U){U||(U=window.self.CtrlWheelMetrics);if(U){var Ea=U.ctrlWheelOccurred;if("boolean"!==typeof Ea)qa.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");else{qa.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",Ea);try{U.stop()}catch(kb){qa.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",kb)}}}else qa.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}jC(){this.Wzn(this.T5k);if(this.mk){var U=
document.getElementById($p.AppFrame.W6b);U&&this.mk.Ea(w.a.KBa,U,Object(u.a)(this,this.S5k,"ctrlScrollZoomHandler"))}this.ib&&(U=this.ib.Kc($p.AppFrame.lE),this.wsk&&(U.bindAction(Ga.KeyInputManager.$a(ng.a.Vvb,Ga.KeyInputManager.mh),za.a.Cnb),U.bindAction(Ga.KeyInputManager.$a(ng.a.yPb,Ga.KeyInputManager.mh),za.a.Cnb),U.bindAction(Ga.KeyInputManager.$a(ng.a.Wvb,Ga.KeyInputManager.mh),za.a.sjb),U.bindAction(Ga.KeyInputManager.$a(ng.a.Yvb,Ga.KeyInputManager.mh),za.a.sjb),U.bindAction(Ga.KeyInputManager.$a(ng.a.Spc,
Ga.KeyInputManager.mh),bd.a.u5e)));this.ag&&(this.Nzf=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.ag.Ea(w.a.click,this.Nzf,Object(u.a)(this,this.FLm,"onZoomLabelClickEvent"));this.rck&&(Qe.App.oa.Di.registerLayoutBreakpointChanged("canvas",Ea=>{this.yGf(Ea)}),Qe.App.oa.Di.registerBoundingWindowRectsChanged("canvas",()=>{this.yGf(Qe.App.oa.Di.getLayoutBreakpoint())}))}yGf(U){let Ea=!0,kb="";if(this.Pya!==ns.onBoot)return Ea;ka.Health.instance.recordKpiUsage(this.Soh,0,this.vsk,
null);switch(U){case "Small":8===this.n2f()&&(kb=this.v9j,Ea=!1);break;default:1===this.Ei||this.xua(1)||(kb=this.mrk,Ea=!1)}Ea||ka.Health.instance.recordKpiFailure(this.Soh,kb,!0,!0,null);return Ea}S5k(U){if(U.ctrlKey&&(J.AFrameworkApplication.pa.processAction(Of.a.mTf,2),this.usk)){U=U.HSj;if(!U)return!1;this.xua(this.Ei-U);this.gHd(6,"CtrlScroll");return!0}return!1}FLm(){qa.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0}Wlj(U){this.ozk(U)}Gnj(U){this.m8m(U)}Vlj(U){this.nzk(U)}Fnj(U){this.l8m(U)}$ij(){this.Zc.raiseEvent("PinchStart",
null)}RQg(){this.Zc.raiseEvent("PinchEnd",null)}}Object(c.a)(Gs,"WordEditorZoomManager",tm,[1564,817]);class Vn{constructor(){this.Z=null}get name(){return"WordEditor.Zoom"}init(){if(J.AFrameworkApplication.K.ea("ZoomPopupDialogIsEnabled")){const U=this.Z.resolve("WordEditor.Zoom.WordEditorZoomActor"),Ea=this.Z.resolve("WordEditor.Zoom.WordEditorZoomManager");U.lb();Sys.UI.DomElement.overrideGetBounds=!0;J.AFrameworkApplication.K.ea("AdaptiveLayoutForSmallScreenModeIsEnabled")&&J.AFrameworkApplication.K.ea("AutoFitForSmallScreenModeIsEnabled")&&
Ea&&Pa.a.get_instance().Ik(4,()=>{Ea.yGf(Qe.App.oa.Di.getLayoutBreakpoint())||qa.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}Hb(U){this.Z=U;J.AFrameworkApplication.K.ea("ZoomPopupDialogIsEnabled")&&(this.Z.ha("WordEditor.Zoom.WordEditorZoomManager",()=>new Gs(J.AFrameworkApplication.K,J.AFrameworkApplication.pa,fr.WordSectionNavigator.instance,xr.a.instance,ae.FocusManager.instance(),ye.a.instance,()=>U.sa("Box4.IFloatingObjectUpdater"))).singleInstance().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),
this.Z.ha("WordEditor.Zoom.WordEditorZoomActor",()=>new Br(J.AFrameworkApplication.pa,this.Z.resolve("WordEditor.Zoom.WordEditorZoomManager"),J.AFrameworkApplication.K)).singleInstance())}static main(){ba.a.instance.Sb(new Vn)}}Object(c.a)(Vn,"ZoomPackage",null,[1,2]);var Pp=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",
ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",
attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",
IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",
MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",
IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},
children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",
attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},
children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",
attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",
attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]},Qr=window.InteractivePerfTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InteractivePerfTaskPane",
Title:"Interactive Perf TaskPane",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"TypingSpeedMeterGroup"}},{name:"Group",attrs:{Id:"CpuMeterGroup"}},{name:"Group",attrs:{Id:"RenderGroup"}}]}]}]};class ap extends Ye.a{constructor(U){super(!1,!1,!0);this.O2d=U}start(){const U={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.O2d.Rhg}};this.Ih("",Object(u.a)(this,this.Obn,"resultHandler"),U)}Obn(U,Ea){1===U&&(this.O2d.Rhg=Ea.tooltipPersistenceEnabled)}}
Object(c.a)(ap,"AccessibilitySettingsDialog",Ye.a,[]);class Hs{constructor(U,Ea){this.ga=U;this.O2d=Ea}lb(){this.ga.ma(za.a.SBj,Je.a.frame,Object(u.a)(this,this.Ztn,"showAccessibilitySettingsDialogHandler"))}Ztn(){(new ap(this.O2d)).start();return 32}}Object(c.a)(Hs,"AccessibilitySettingsDialogActor",null,[1588]);const jr=U=>{const Ea=new l.a;J.AFrameworkApplication.Gd.Ni(os(U),1,null,null,!0,2,kb=>{200===kb.data.Ge?Ea.mf("true"===kb.data.Rd.toLowerCase()):Ea.mf(!1)},()=>{Ea.mf(!1)},null,void 0,void 0,
void 0,void 0,"7");return Ea.task},os=U=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",J.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",U,J.AFrameworkApplication.Fk);class bp{constructor(){this.htc=null}get Rhg(){return!!this.htc}set Rhg(U){U!==this.htc&&(this.htc=U,mf.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(U),this.fUi()&&J.AFrameworkApplication.Gd.Ni(os("saveHoverableRibbonTooltipIsEnabled"),2,U.toString().toLowerCase(),
null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}Alm(){const U=new l.a;if(this.htc)U.mf(this.htc);else if(this.fUi()){const Ea=jr("getHoverableRibbonTooltipIsEnabled");Ea.continueWith(()=>{this.htc=Ea.result;mf.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Ea.result);U.mf(Ea.result)},8)}else U.mf(!1)}fUi(){const U=J.AFrameworkApplication.K.ea("IsRoamingServiceEnabled"),Ea=J.AFrameworkApplication.K.ea("IsAnonymousUser");return U&&!Ea}}Object(c.a)(bp,"AccessibilitySettingsInfo",
null,[1587]);class ps{constructor(){this.Z=null}get name(){return"Common.App.AccessibilitySettings"}Hb(U){this.Z=U;this.Z.register(bp,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").zd(()=>new bp).singleInstance();this.Z.register(Hs,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").zd(()=>new Hs(J.AFrameworkApplication.pa,this.Z.sa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).singleInstance()}init(){const U=
this.Z.sa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),Ea=this.Z.sa("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");U&&Ea?(Ea.lb(),U.Alm()):k.b(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){ba.a.instance.Sb(new ps)}}Object(c.a)(ps,"AccessibilitySettingsPackage",null,[1,2]);class Qp{constructor(){this.events=[];this.uWg=!1}static dug(U){return U.ctrlKey&&
"Control"!==U.key||U.altKey&&"Alt"!==U.key||!!Qp.Cim[U.key]}static JJk(U,Ea){let kb;kb=Qp.dug(U)?U.key:" "===U.key?"Space":"CharacterKey";return null!=Ea?(Ea.altPressed=(!!U.altKey).toString(),Ea.ctrlPressed=(!!U.ctrlKey).toString(),Ea.key=kb,Ea.repeat=(!!U.repeat).toString(),Ea.shiftPressed=(!!U.shiftKey).toString(),Ea):{["altPressed"]:(!!U.altKey).toString(),["ctrlPressed"]:(!!U.ctrlKey).toString(),["key"]:kb,["repeat"]:(!!U.repeat).toString(),["shiftPressed"]:(!!U.shiftKey).toString()}}static CTi(U){return window.performance&&
window.performance.now&&U.timeStamp<performance.now()}static Fli(U){return!!U&&Qp.CTi(U)&&Qp.dug(U)}static Gli(U){return!!U&&Qp.CTi(U)&&!Qp.dug(U)}keyPressedEventHandlerStart(U,Ea){Qp.Gli(U)&&this.yFj(U,Ea)}keyPressedEventHandlerEnd(U){Qp.Gli(U)&&this.YFj(U)}keyDownEventHandlerStart(U,Ea){Qp.Fli(U)&&this.yFj(U,Ea)}keyDownEventHandlerEnd(U){Qp.Fli(U)&&this.YFj(U)}yFj(U,Ea){U={["metadata"]:Qp.JJk(U,Ea),["timeStamp"]:this.VUc(U.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.VUc(performance.now()-
U.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};this.events.push(U);this.n4m()}YFj(U){if(0!==this.events.length){var Ea=this.VUc(U.timeStamp);for(let kb=this.events.length-1;0<=kb;--kb){const Nb=this.events[kb];if(Nb.timeStamp===Ea){Nb.timeToHandlerFinishMs=this.VUc(performance.now()-U.timeStamp);Nb.eventDurationMs=this.VUc(Nb.timeToHandlerFinishMs-Nb.timeToHandlerStartMs);break}}}}VUc(U){return Number(U.toFixed(2))}n4m(){if(!this.uWg){const U=document.createEvent("CustomEvent");
U.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(U);requestAnimationFrame(()=>{this.uWg=!1;const Ea=performance.now();this.events.forEach(Nb=>{Nb.timeToRequestAnimationFrameMs=this.VUc(Ea-Nb.timeStamp)});var kb=document.createEvent("CustomEvent");kb.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(kb);this.events=[];kb=document.createEvent("CustomEvent");kb.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(kb)});this.uWg=!0}}}
Qp.Cim={oih:!0,BWj:!0,CWj:!0,pih:!0,ZTn:!0,Delete:!0,End:!0,Uih:!0,GXj:!0,EVn:!0,FWn:!0,GWn:!0,Tab:!0};class Vl{constructor(){this.hVe=this.gqb=this.Iga=this.qMc=null;this.cdc=!1;this.tsb=null;this.ssd=[];this.Foc=()=>{Vl.sdm()&&null==this.gqb?(this.Iga=null,this.gqb=requestAnimationFrame(this.lJb)):null!=this.gqb&&(cancelAnimationFrame(this.gqb),this.gqb=null)};this.lJb=U=>{if(null!=this.Iga){const Ea=U-this.Iga;if(null==this.qMc||this.qMc<Ea)this.qMc=Ea;for(let kb=0;kb<Vl.gPd.length;++kb)if(Ea<
Vl.gPd[kb]){++this.ssd[kb];break}}this.Iga=U;this.gqb=requestAnimationFrame(this.lJb)};this.Spj=()=>{if(null!=this.qMc){var U={};for(var Ea=0;Ea<Vl.gPd.length;++Ea)U[Vl.gPd[Ea]]=this.ssd[Ea],this.ssd[Ea]=0;Ea=performance.now();U={["intervalStart"]:this.tsb,["intervalEnd"]:Ea,["maxFrameLengthMs"]:this.qMc,["frameData"]:U};var kb=document.createEvent("CustomEvent");kb.initCustomEvent("reportframetiming",!1,!1,U);dispatchEvent(kb);this.qMc=null;this.tsb=Ea}}}static ZDd(){return!!window.performance&&
!!window.performance.now}start(U){!this.cdc&&Vl.ZDd()&&(this.Tpn(),this.hVe=setInterval(this.Spj,1E3*U),this.tsb=performance.now(),this.Foc(),document.addEventListener("visibilitychange",this.Foc),this.cdc=!0)}stop(){this.cdc&&(document.removeEventListener("visibilitychange",this.Foc),null!=this.hVe&&(clearInterval(this.hVe),this.hVe=null),null!=this.gqb&&(cancelAnimationFrame(this.gqb),this.gqb=null),this.Spj(),this.cdc=!1)}get bpb(){return this.cdc}Tpn(){this.ssd=[];for(let U=0;U<Vl.gPd.length;++U)this.ssd.push(0)}}
Vl.sdm=()=>"visible"===document.visibilityState;Vl.gPd=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");
Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.InteractivePerfTaskPane");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");Type.registerNamespace("Common.App.VersionHistory");
Type.registerNamespace("WordEditor.VersionHistory");ba.a.instance.Sb(new sm);vk.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");f;Type.registerNamespace("CACPU");ma.main();Type.registerNamespace("CAEventTimingMeter");X.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");ta.main();Type.registerNamespace("Common.App.GestureInput");db.main();Type.registerNamespace("Common.App.GestureManager");vb.main();Type.registerNamespace("Common.ModernFontPicker");
Type.registerNamespace("Common.App.OfflineLogger");ba.a.instance.Sb(new mc);Type.registerNamespace("Common.App.O365Shell");tb.main();Type.registerNamespace("Common.App.SensitiveLogging");uk.main();Type.registerNamespace("Common.App.Rename");ba.a.instance.Sb(new wg,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");ba.a.instance.Sb(new kd);Type.registerNamespace("Common.App.SaveAsToHost");kl.main();Type.registerNamespace("Common.App.SaveToCloudStorage");Be.main();Type.registerNamespace("Common.App.SaveACopy");
Nj.main();Type.registerNamespace("Common.App.SaveToSharePoint");sf.main();Type.registerNamespace("Common.App.SharedFilePicker");ei.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Type.registerNamespace("CATypingSpeedMeter");tn.main();qf;Za.main();ba.a.instance.Sb(new hr);ze.main();Pp;sa.main();ba.a.instance.Sb(new Pm);no.main();Mm.a.prototype.toString=Mh.a.prototype.toString;
uo.a.xHi=new Ff.a;ba.a.instance.Sb(new Zp);Vn.main();ba.a.instance.Sb(new Uo);ba.a.instance.Sb(new wo);ba.a.instance.Sb(new dq);Op.main();mm.main();ll.main();kg.main();Type.registerNamespace("NLRT");ba.a.instance.Sb(new ic);Type.registerNamespace("Common.App.AccessibilitySettings");ps.main();Qr;gm.main();ba.a.instance.Sb(new eq);window.EventTiming={EventTimingMeter:Qp,FrameTimingMeter:Vl}}}]);

//# sourceMappingURL=https://wordwebclientbuilds.blob.core.windows.net/ooui/c5f763da10f22c3478db857ec7ab2f59faeda6ad/WordEditorDS.box4.dll2.js.map